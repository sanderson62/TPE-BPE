* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page   3
* EL050.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63
    64 77  FILLER   PIC X(32) VALUE '********************************'.
    65 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    66 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    67
    68 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    69 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    70                                   USAGE POINTER.
    71 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    74                                   USAGE IS POINTER.
    75 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    77                                   USAGE IS POINTER.
    78 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    79 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    80                                   USAGE IS POINTER.
    81
    82 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    83 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    84                                   USAGE IS POINTER.
    85
    86*    COPY ELC50WS.
    87*****************************************************************
    88*                                                               *
    89*                            ELC50WS.                           *
    90*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    91*                            VMOD=2.061.                        *
    92*                                                               *
    93*   THIS IS THE WORKING STORAGE FOR EL050                       *
    94*                                   EL517                       *
    95*****************************************************************
    96******************************************************************
    97*                   C H A N G E   L O G
    98*
    99* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   100*-----------------------------------------------------------------
   101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   102* EFFECTIVE    NUMBER
   103*-----------------------------------------------------------------
   104* 123102                   PEMA  ADD DCC PROCESSING
   105* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   106* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   107* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   108* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   109* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   110* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   111* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   112* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   113* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   114* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   115* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   116* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   117* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   118* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page   4
* EL050.cbl
   119* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   120* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   121* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   122* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   123* 030309  CR2009021700001  PEMA  ADD ER-2883
   124* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   125* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   126* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   127* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   128* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   129* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   130* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   131* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   132* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   133* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   134* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   135* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   136* 061412  CR2011022800001  AJRA  NAPERSOFT
   137* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   138* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   139* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   140* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   141* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   142* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   143* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   144* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   145* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   146* 091114  IR2014091000001  TANA  ADD ERROR 2898
   147* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   148* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   149* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   150*-----------------------------------------------------------------
   151
   152 01  WORK-AREAS.
   153
   154*****************************************************************
   155*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   156*****************************************************************
   157
   158     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   159     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   160     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   161     12  WS-NAME-EDIT-WORK-AREA.
   162         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   163         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   164             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   165         16  WS-WORK-NAME.
   166             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   167             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   168             20  FILLER           PIC X(10)     VALUE SPACES.
   169         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   170             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   171
   172*****************************************************************
   173*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   174*****************************************************************
   175
   176     12  WS-ERRESC-KEY.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page   5
* EL050.cbl
   177         16 WS-ERRESC-SEARCH-KEY.
   178             20  WS-ERRESC-COMPANY-CD PIC  X.
   179             20  WS-ERRESC-CARRIER    PIC  X.
   180             20  WS-ERRESC-GROUP      PIC X(6).
   181             20  WS-ERRESC-STATE      PIC XX.
   182             20  WS-ERRESC-ACCOUNT    PIC X(10).
   183         16 WS-ERRESC-RESIDUAL-KEY.
   184             20  WS-ERRESC-AGENT      PIC X(10).
   185             20  WS-ERRESC-RES-STATE  PIC XX.
   186             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   187*                                          YYYYMMDD
   188     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   189     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   190
   191*RESIDENT STATE TAX MASTER(ERRESS)
   192*
   193     12  WS-ERRESS-KEY.
   194         16  WS-ERRESS-COMPANY-CD      PIC  X.
   195         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   196         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   197         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   198*                                          YYYYMMDD
   199
   200     12  WS-CONTRACT-DATE              PIC 9(8).
   201*                                          YYYYMMDD
   202     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   203     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   204         16 WS-YEAR-YY                 PIC   9999.
   205         16 FILLER                     PIC 9(4).
   206*                                          YYYYMMDD
   207     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   208     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   209     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   210     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   211
   212     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   213         88  DPRB-1ST-TIME                      VALUE ' '.
   214
   215*****************************************************************
   216*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   217*****************************************************************
   218
   219     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   220     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   221     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   222     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   223     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   224     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   225     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   226     12  ws-st-agent-sig-edit    pic x          value spaces.
   227     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   228     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   229     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   230     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   231         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   232         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   233     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   234         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page   6
* EL050.cbl
   235         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   236     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   237
   238     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   239     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   240
   241     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   242     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   253     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   255     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   256     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   274     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   275     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   276     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   277     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   278     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   279     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   280     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   289     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   290     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   291     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   292     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page   7
* EL050.cbl
   293     12  WS-2671-SW               PIC X         VALUE SPACE.
   294     12  WS-2672-SW               PIC X         VALUE SPACE.
   295     12  ws-9813-sw               pic x         value spaces.
   296     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   297         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   298     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   299         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   300     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   301
   302     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   303         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   304         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   305         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   306         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   307
   308     12  WS-CREDIT-EDIT-CONTROLS.
   309         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   310         16  WS-MIN-AGE           PIC 99                VALUE  0.
   311         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   312         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   313         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   314         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   315
   316     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   317     12  WS-AGE-FIELDS.
   318         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   319         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   320         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   321         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   322
   323     12  WS-SAVE-ALLOWABLE-BENEFIT.
   324         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   325         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   326         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   327         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   328         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   329         16  FILLER                      PIC XX.
   330
   331     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   332     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   333     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   334     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   335     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   336     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   337     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   338     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   339     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   340     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   341
   342     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   343     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   344     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   345     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   346     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   347     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   348     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   349     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   350         88  WS-REDUCING              VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page   8
* EL050.cbl
   351         88  WS-LEVEL                 VALUE 'L' 'P'.
   352     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   353
   354     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   355     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   356     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   357     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   358     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   359     12  ws-ah-max-bens           pic 99        value zeros.
   360     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   361     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   362     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   363     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   364
   365     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   366     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   367     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   368     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   369     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   370     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   371     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   372     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   373     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   374     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   375     12  WS-ACCT-SIG-SW.
   376         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   377         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   378     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   379     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   380     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   382     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   385     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   386     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   387     12  WS-INITIALS.
   388         16  WS-INIT-1            PIC X         VALUE SPACES.
   389         16  WS-INIT-2            PIC X         VALUE SPACES.
   390
   391     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   392     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   393     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   394     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   395     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   396*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   397     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   398     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   399     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   401     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   402     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   403     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   404     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   405     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   406     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   407     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   408     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page   9
* EL050.cbl
   409     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   410     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   411     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   412     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   413     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   414     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   417     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   418     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   419******** FLA
   420     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   421     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   422     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   423     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   424     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   425********
   426     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   427     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   428     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   429     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   430     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   431     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   432     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   433     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   434     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   435     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   436
   437     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   438         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   439                                         '0' THRU '9'.
   440
   441     12  NUMBER-OF-MONTHS.
   442         16  SK-MO OCCURS 12 TIMES PIC X.
   443
   444     12  WS-WORK-DATE.
   445         16  WS-YEAR            PIC 99    VALUE 00.
   446         16  WS-MONTH           PIC 99    VALUE 00.
   447         16  WS-DAY             PIC 99    VALUE 00.
   448
   449     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   450     12  WS-WORK-CRIT-DEV       REDEFINES
   451         WS-WORK-LF-CRIT-PER    PIC X(03).
   452
   453     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   454     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   455
   456     12  WS-WORK-DATE-FROM.
   457         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   458         16  FILLER             PIC X  VALUE SPACE.
   459         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   460         16  FILLER             PIC X         VALUE SPACE.
   461         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   462
   463     12  WS-WORK-DATE-THRU.
   464         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   465         16  FILLER             PIC X         VALUE SPACE.
   466         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  10
* EL050.cbl
   467         16  FILLER             PIC X         VALUE SPACE.
   468         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   469
   470     12  WS-LF-INPUT-CD.
   471         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   472         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   473
   474     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   475     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   476         16  WS-AH-INPUT-CD-1   PIC X.
   477         16  WS-AH-INPUT-CD-2-3 PIC XX.
   478
   479     12  WS-SWITCHES.
   480         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   481         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   482             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   483         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   484             88  BANK-ACCT-FOUND          VALUE 'Y'.
   485         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   486             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   487         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   488             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   489         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   490             88  COMP-MASTER-FOUND        VALUE 'Y'.
   491         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   492             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   493         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   494             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   495         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   496             88  STAT-MASTER-FOUND        VALUE 'Y'.
   497         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   498             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   499         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   500             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   501         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   502             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   503         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   504             88  FORM-MASTER-FOUND        VALUE 'Y'.
   505         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   506             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   507         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   508             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   509         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   510             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   511         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   512             88  NO-BENEFIT-FOUND         VALUE 'N'.
   513         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   514             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   515         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   516             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   517         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   518             88  AH-BENEFIT-FOUND         VALUE ' '.
   519             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   520         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   521             88  LF-BENEFIT-FOUND         VALUE ' '.
   522             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   523         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   524             88  NO-STATE-RECORD          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  11
* EL050.cbl
   525         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   526             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   527         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   528             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   529         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   530             88  CERT-WAS-FOUND           VALUE ' '.
   531             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   532         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   533             88  BROWSE-STARTED           VALUE 'Y'.
   534         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   535             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   536         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   537             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   538         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   539             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   540         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   541             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   542         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   543             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   544         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   545             88  APP-CERT-USED            VALUE 'Y' 'A'.
   546         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   547             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   548             88  FIRST-TIME-THROUGH       VALUE '1'.
   549             88  CTBL-NOT-FOUND           VALUE '2'.
   550
   551         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   552             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   553
   554         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   555             88  DLO-ERROR-FOUND          VALUE 'Y'.
   556
   557********FLA
   558     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   559     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   560********
   561     12  RC-SW-1                  PIC X           VALUE '0'.
   562     12  RC-SW-2                  PIC X           VALUE '0'.
   563     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   564     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   565     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   566     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   567     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   570     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   571     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   572     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   573     12  LIT-SPACES               PIC X           VALUE SPACES.
   574     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   575     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   576     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   577     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   578     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   579     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   580     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   581         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   582         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  12
* EL050.cbl
   583     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   584         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   585
   586 01  WS-EXTRA-PERIODS-BY-STATE.
   587     12  WS-INT-PERIODS          PIC 9.
   588     12  WS-EXTRA-PMTS           PIC 9.
   589 01  ws-net-only-state           pic x value 'N'.
   590 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   591     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   592     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   593 01  WS-CRI-SSN-WORK-AREA.
   594     05  WS-CRI-SOC-SEC-NO.
   595         10  WS-SS-REPT-CD       PIC X(5).
   596         10  WS-SS-LAST-NAME     PIC X(5).
   597         10  WS-SS-INITIAL       PIC X.
   598
   599     05  WS-CRI-REPORT-CODE.
   600         10  FILLER              PIC X(5).
   601         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   602
   603     05  WS-CRI-LAST-NAME.
   604         10  WS-CRI-NAME-MOVE    PIC X(5).
   605         10  FILLER              PIC X(10).
   606
   607 01  WS-NUM-TABLE                PIC X(26)  VALUE
   608     '12345678012345070923456789'.
   609 01  FILLER REDEFINES WS-NUM-TABLE.
   610     05  WS-NUM OCCURS 26        PIC 9.
   611 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   612 01  V1                          PIC S999 COMP-3.
   613 01  V2                          PIC S999 COMP-3.
   614 01  V3                          PIC S999 COMP-3.
   615 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   616 01  FILLER REDEFINES WS-WORK-VIN.
   617     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   618 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   619 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   620 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   621 01  WS-HEX-WORK.
   622     05  FILLER                  PIC X  VALUE LOW-VALUES.
   623     05  WS-HEX-BYTE             PIC X.
   624 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   625 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   626 01  WS-WORK-HIN-ROW-B.
   627     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   628
   629 01  ws-benefit-cd-chg-sw      pic x value spaces.
   630     88  benefit-code-chg           value 'Y'.
   631 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   632 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   633     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   634 01  WS-ROW-D-TABLE.
   635     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   636
   637 01  WS-HIN-TABLE-B.
   638     05  F                       PIC XX VALUE 'A2'.
   639     05  F                       PIC XX VALUE 'B3'.
   640     05  F                       PIC XX VALUE 'C4'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  13
* EL050.cbl
   641     05  F                       PIC XX VALUE 'D5'.
   642     05  F                       PIC XX VALUE 'E6'.
   643     05  F                       PIC XX VALUE 'F7'.
   644     05  F                       PIC XX VALUE 'G8'.
   645     05  F                       PIC XX VALUE 'H9'.
   646     05  F                       PIC XX VALUE 'I1'.
   647     05  F                       PIC XX VALUE 'J2'.
   648     05  F                       PIC XX VALUE 'K3'.
   649     05  F                       PIC XX VALUE 'L4'.
   650     05  F                       PIC XX VALUE 'M5'.
   651     05  F                       PIC XX VALUE 'N6'.
   652     05  F                       PIC XX VALUE 'O0'.
   653     05  F                       PIC XX VALUE 'P7'.
   654     05  F                       PIC XX VALUE 'Q0'.
   655     05  F                       PIC XX VALUE 'R8'.
   656     05  F                       PIC XX VALUE 'S9'.
   657     05  F                       PIC XX VALUE 'T2'.
   658     05  F                       PIC XX VALUE 'U3'.
   659     05  F                       PIC XX VALUE 'V4'.
   660     05  F                       PIC XX VALUE 'W5'.
   661     05  F                       PIC XX VALUE 'X6'.
   662     05  F                       PIC XX VALUE 'Y7'.
   663     05  F                       PIC XX VALUE 'Z8'.
   664 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   665     05  WS-VAL-IN               PIC X.
   666     05  WS-VAL-OUT              PIC 9.
   667 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   668 01  WS-COMPARE-BINARY-DATES.
   669     05  WS-971231                PIC XX VALUE X'92FF'.
   670     05  WS-931231                PIC XX VALUE X'8CFF'.
   671     05  WS-791231                PIC XX VALUE X'77FF'.
   672     05  WS-771001                PIC XX VALUE X'74A1'.
   673     05  WS-820301                PIC XX VALUE X'7B41'.
   674     05  WS-831031                PIC XX VALUE X'7DBF'.
   675     05  WS-831231                PIC XX VALUE X'7DFF'.
   676     05  WS-810831                PIC XX VALUE X'7A7F'.
   677     05  WS-830901                PIC XX VALUE X'7D81'.
   678
   679 01  FILE-ACCESS-IDS.
   680     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   681     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   682     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   683     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   684     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   685     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   686     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   687     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   688     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   689     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   690     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   691     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   692     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   693     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   694     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   695     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   696     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   697 01  DD-IU-SW                    PIC X   VALUE ' '.
   698     88  DD-IU-PRESENT                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  14
* EL050.cbl
   699
   700 01  ACCESS-KEYS.
   701     12  ELMSTR-KEY.
   702         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   704     12  W-CLAIM-KEY.
   705         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   706         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   707
   708     12  ELCNTL-KEY.
   709         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   710         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   711         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   712         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   713
   714     12  ELCERT-KEY.
   715         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   716         16  CERT-CARRIER         PIC X       VALUE SPACE.
   717         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   718         16  CERT-STATE           PIC XX      VALUE SPACES.
   719         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   720         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   721         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   722
   723     12  ELCERT2-KEY.
   724         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   725         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   726
   727     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   728
   729     12  ELCERT-SAVE.
   730         16  FILLER                      PIC XX    VALUE SPACES.
   731
   732         16  WCS-CONTROL-PRIMARY.
   733             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   734             20  WCS-CARRIER             PIC X     VALUE SPACE.
   735             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   736             20  WCS-STATE               PIC XX    VALUE SPACES.
   737             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   738             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   739             20  WCS-CERT-NO.
   740                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   741                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   742
   743         16  CS-CONTROL-BY-NAME.
   744             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   745             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   746             20  CS-INSURED-INITIALS.
   747                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   748                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   749
   750         16  CS-CONTROL-BY-SSN.
   751             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   752             20  CS-SOC-SEC-NO.
   753                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   754                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   755                 24  CS-SSN-LN3.
   756                     28 CS-INSURED-INITIALS-A2   PIC XX
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  15
* EL050.cbl
   757                                     VALUE SPACES.
   758                     28 CS-PART-LAST-NAME-A2     PIC X
   759                                     VALUE SPACE.
   760
   761         16  CS-CONTROL-BY-CERT-NO.
   762             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   763             20  CS-CERT-NO-A4           PIC X(11)
   764                                     VALUE SPACES.
   765
   766         16  CS-CONTROL-BY-MEMB.
   767             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   768             20  CS-MEMBER-NO.
   769                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   770                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   771                 24  CS-MEMB-LN4.
   772                     28 CS-INSURED-INITIALS-A5   PIC XX
   773                                      VALUE SPACES.
   774                     28 CS-PART-LAST-NAME-A5     PIC XX
   775                                      VALUE SPACES.
   776
   777         16  FILLER              PIC X(360) VALUE SPACES.
   778
   779     12  ERACCT-KEY.
   780         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   782         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   783         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   784         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   785         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   786
   787     12  ERCOMP-KEY.
   788         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   789         16  COMP-CARRIER         PIC X     VALUE SPACES.
   790         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   791         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   792         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   793         16  COMP-TYPE            PIC X     VALUE SPACES.
   794
   795     12  ERLOFC-KEY.
   796         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   797         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   798         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   799         16  LOFC-STATE           PIC XX    VALUE SPACES.
   800         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   801         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   802
   803     12  WS-ELCRTT-KEY.
   804         16  WS-ELCRTT-PRIMARY       PIC X(33).
   805         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   806
   807     12  ERBXRF-KEY.
   808         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   809         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   810         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   811         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   812
   813     12  ERAGTC-KEY.
   814         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  16
* EL050.cbl
   815         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   816         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   817         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   818         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   819         16  AGTC-TYPE            PIC X     VALUE SPACES.
   820
   821     12  ERPLAN-KEY.
   822         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   823         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   824         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   825         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   826         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   827         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   828         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   829         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   830
   831     12  ERFORM-KEY.
   832         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   833         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   834         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   835         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   836
   837     12  ERREIN-KEY.
   838         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   839         16  REIN-TYPE            PIC X     VALUE SPACES.
   840         16  REIN-TABLE-CO.
   841             20  REIN-CODE-1      PIC X     VALUE SPACE.
   842             20  REIN-CODE-2      PIC X     VALUE SPACE.
   843             20  REIN-CODE-3      PIC X     VALUE SPACE.
   844         16  FILLER               PIC X(3)  VALUE SPACES.
   845
   846     12  ERCTBL-KEY.
   847         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   848         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   849         16  CTBL-CNTRL-2.
   850             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   851             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   852
   853     12  ELCRTO-KEY.
   854         16  ELCRTO-COMPANY-CD       PIC X.
   855         16  ELCRTO-CARRIER          PIC X.
   856         16  ELCRTO-GROUPING         PIC X(6).
   857         16  ELCRTO-STATE            PIC XX.
   858         16  ELCRTO-ACCOUNT          PIC X(10).
   859         16  ELCRTO-CERT-EFF-DT      PIC XX.
   860         16  ELCRTO-CERT-NO.
   861             20  ELCRTO-CERT-PRIME   PIC X(10).
   862             20  ELCRTO-CERT-SFX     PIC X.
   863         16  ELCRTO-RECORD-TYPE      PIC X.
   864         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   865
   866
   867     12  WS-ACCESS.
   868         16  FILLER               PIC XX    VALUE SPACES.
   869         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   870
   871     12  WS-CARR-ACCESS.
   872         16  FILLER               PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  17
* EL050.cbl
   873         16  WS-CARR              PIC X     VALUE SPACE.
   874*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   875*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   876     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   877         88  WS-DMD-LF-RATING   VALUE 'Y'.
   878         88  WS-DMD-AH-RATING   VALUE 'Y'.
   879         88  WS-DMD-NO-RATING   VALUE 'N'.
   880
   881     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   882         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   883                                         'NJ' 'NL'
   884                                         'PJ' 'PL'
   885                                         'SJ' 'SL'.
   886     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   887         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   888                                         'NI' 'NJ' 'NL' 'NU'
   889                                         'PJ' 'PL' 'PI' 'PU'
   890                                         'SI' 'SJ' 'SL' 'SU'
   891                                         'MX' 'MY' 'MZ'.
   892 01  ERPDEF-KEY-SAVE             PIC X(18).
   893 01  ERPDEF-KEY.
   894     12  ERPDEF-COMPANY-CD       PIC X.
   895     12  ERPDEF-STATE            PIC XX.
   896     12  ERPDEF-PROD-CD          PIC XXX.
   897     12  F                       PIC X(7).
   898     12  ERPDEF-BEN-TYPE         PIC X.
   899     12  ERPDEF-BEN-CODE         PIC XX.
   900     12  ERPDEF-EXP-DT           PIC XX.
   901
   902 01  ELSTAT-KEY-SAVE             PIC X(20).
   903 01  ELSTAT-KEY.
   904     12  ELSTAT-COMPANY-ID       PIC XXX.
   905     12  ELSTAT-CARRIER          PIC X.
   906     12  ELSTAT-GROUP            PIC X(6).
   907     12  ELSTAT-STATE            PIC XX.
   908     12  ELSTAT-EXP-DT           PIC 9(8).
   909 01  WS-ERROR-VALUES.
   910     12  ER-1570                     PIC S9(4)   VALUE +1570.
   911     12  ER-1571                     PIC S9(4)   VALUE +1571.
   912     12  er-1572                     pic s9(4)   value +1572.
   913     12  er-1573                     pic s9(4)   value +1573.
   914     12  er-1574                     pic s9(4)   value +1574.
   915     12  ER-1575                     PIC S9(4)   VALUE +1575.
   916     12  er-1576                     pic s9(4)   value +1576.
   917     12  er-1583                     pic s9(4)   value +1583.
   918     12  er-1743                     pic s9(4)   value +1743.
   919     12  er-1744                     pic s9(4)   value +1744.
   920     12  er-1745                     pic s9(4)   value +1745.
   921     12  er-1746                     pic s9(4)   value +1746.
   922     12  er-1747                     pic s9(4)   value +1747.
   923     12  er-1748                     pic s9(4)   value +1748.
   924     12  ER-1891                     PIC S9(4)   VALUE +1891.
   925     12  ER-1892                     PIC S9(4)   VALUE +1892.
   926     12  ER-1893                     PIC S9(4)   VALUE +1893.
   927     12  ER-1894                     PIC S9(4)   VALUE +1894.
   928     12  ER-1895                     PIC S9(4)   VALUE +1895.
   929     12  ER-1896                     PIC S9(4)   VALUE +1896.
   930     12  ER-1897                     PIC S9(4)   VALUE +1897.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  18
* EL050.cbl
   931     12  ER-1898                     PIC S9(4)   VALUE +1898.
   932     12  ER-1899                     PIC S9(4)   VALUE +1899.
   933     12  ER-1900                     PIC S9(4)   VALUE +1900.
   934     12  ER-1901                     PIC S9(4)   VALUE +1901.
   935     12  ER-1902                     PIC S9(4)   VALUE +1902.
   936     12  ER-1903                     PIC S9(4)   VALUE +1903.
   937     12  ER-1904                     PIC S9(4)   VALUE +1904.
   938     12  ER-1905                     PIC S9(4)   VALUE +1905.
   939     12  ER-1906                     PIC S9(4)   VALUE +1906.
   940     12  ER-1907                     PIC S9(4)   VALUE +1907.
   941     12  ER-1909                     PIC S9(4)   VALUE +1909.
   942     12  ER-1910                     PIC S9(4)   VALUE +1910.
   943     12  ER-1911                     PIC S9(4)   VALUE +1911.
   944     12  ER-1912                     PIC S9(4)   VALUE +1912.
   945     12  ER-1913                     PIC S9(4)   VALUE +1913.
   946     12  ER-1914                     PIC S9(4)   VALUE +1914.
   947     12  ER-1915                     PIC S9(4)   VALUE +1915.
   948     12  ER-1916                     PIC S9(4)   VALUE +1916.
   949     12  ER-1917                     PIC S9(4)   VALUE +1917.
   950     12  ER-1918                     PIC S9(4)   VALUE +1918.
   951     12  ER-1919                     PIC S9(4)   VALUE +1919.
   952     12  ER-1920                     PIC S9(4)   VALUE +1920.
   953     12  ER-1921                     PIC S9(4)   VALUE +1921.
   954     12  ER-1922                     PIC S9(4)   VALUE +1922.
   955     12  ER-1923                     PIC S9(4)   VALUE +1923.
   956     12  ER-1924                     PIC S9(4)   VALUE +1924.
   957     12  ER-1925                     PIC S9(4)   VALUE +1925.
   958     12  ER-1926                     PIC S9(4)   VALUE +1926.
   959     12  ER-1927                     PIC S9(4)   VALUE +1927.
   960     12  ER-2393                     PIC S9(4)   VALUE +2393.
   961     12  ER-2600                     PIC S9(4)   VALUE +2600.
   962     12  ER-2601                     PIC S9(4)   VALUE +2601.
   963     12  ER-2602                     PIC S9(4)   VALUE +2602.
   964     12  ER-2603                     PIC S9(4)   VALUE +2603.
   965     12  ER-2604                     PIC S9(4)   VALUE +2604.
   966     12  ER-2605                     PIC S9(4)   VALUE +2605.
   967     12  ER-2606                     PIC S9(4)   VALUE +2606.
   968     12  ER-2607                     PIC S9(4)   VALUE +2607.
   969     12  ER-2608                     PIC S9(4)   VALUE +2608.
   970     12  ER-2609                     PIC S9(4)   VALUE +2609.
   971     12  ER-2610                     PIC S9(4)   VALUE +2610.
   972     12  ER-2611                     PIC S9(4)   VALUE +2611.
   973     12  ER-2612                     PIC S9(4)   VALUE +2612.
   974     12  ER-2613                     PIC S9(4)   VALUE +2613.
   975     12  ER-2614                     PIC S9(4)   VALUE +2614.
   976     12  ER-2615                     PIC S9(4)   VALUE +2615.
   977     12  ER-2616                     PIC S9(4)   VALUE +2616.
   978     12  ER-2617                     PIC S9(4)   VALUE +2617.
   979     12  ER-2618                     PIC S9(4)   VALUE +2618.
   980     12  ER-2619                     PIC S9(4)   VALUE +2619.
   981     12  ER-2620                     PIC S9(4)   VALUE +2620.
   982     12  ER-2621                     PIC S9(4)   VALUE +2621.
   983     12  ER-2622                     PIC S9(4)   VALUE +2622.
   984     12  ER-2623                     PIC S9(4)   VALUE +2623.
   985     12  ER-2624                     PIC S9(4)   VALUE +2624.
   986     12  ER-2625                     PIC S9(4)   VALUE +2625.
   987     12  ER-2626                     PIC S9(4)   VALUE +2626.
   988     12  ER-2627                     PIC S9(4)   VALUE +2627.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  19
* EL050.cbl
   989     12  ER-2628                     PIC S9(4)   VALUE +2628.
   990     12  ER-2629                     PIC S9(4)   VALUE +2629.
   991     12  ER-2630                     PIC S9(4)   VALUE +2630.
   992     12  ER-2631                     PIC S9(4)   VALUE +2631.
   993     12  ER-2632                     PIC S9(4)   VALUE +2632.
   994     12  ER-2633                     PIC S9(4)   VALUE +2633.
   995     12  ER-2634                     PIC S9(4)   VALUE +2634.
   996     12  ER-2635                     PIC S9(4)   VALUE +2635.
   997     12  ER-2636                     PIC S9(4)   VALUE +2636.
   998     12  ER-2637                     PIC S9(4)   VALUE +2637.
   999     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1000     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1001     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1002     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1003     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1004     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1005     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1006     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1007     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1008     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1009     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1010     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1011     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1012     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1013     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1014     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1015     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1016     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1017     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1018     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1019     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1020     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1021     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1022     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1023     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1024     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1025     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1026     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1027     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1028     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1029     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1030     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1031     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1032     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1033     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1034     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1035     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1036     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1037     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1038     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1039     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1040     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1041     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1042     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1043     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1044     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1045     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1046     12  ER-2685                     PIC S9(4)   VALUE +2685.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  20
* EL050.cbl
  1047     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1048     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1049     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1050     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1051     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1052     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1053     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1054     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1055     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1056     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1057     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1058     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1059     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1060     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1061     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1062     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1063     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1064     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1065     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1066     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1067     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1068     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1069     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1070     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1071     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1072     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1073     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1074     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1075     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1076     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1077     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1078     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1079     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1080     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1081     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1082     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1083     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1084     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1085     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1086     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1087     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1088     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1089     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1090     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1091     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1092     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1093     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1094     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1095     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1096     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1097     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1098     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1099     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1100     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1101     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1102     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1103     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1104     12  ER-2753                     PIC S9(4)   VALUE +2753.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  21
* EL050.cbl
  1105     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1106     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1107     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1108     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1109     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1110     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1111     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1112     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1113     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1114     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1115     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1116     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1117     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1118     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1119     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1120     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1121     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1122     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1123     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1124     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1125     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1126     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1127     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1128     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1129     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1130     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1131     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1132     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1133     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1134     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1135     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1136     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1137     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1138     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1139     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1140     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1141     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1142     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1143     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1144     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1145     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1146     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1147     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1148     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1149     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1150     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1151     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1152     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1153     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1154     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1155     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1156     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1157     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1158     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1159     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1160     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1161     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1162     12  ER-2898                     PIC S9(4)   VALUE +2898.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  22
* EL050.cbl
  1163     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1164     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1165     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1166     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1167     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1168     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1169     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1170     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1171     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1172     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1173     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1174     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1175     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1176     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1177     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1178     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1179     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1180     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1181     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1182     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1183     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1184     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1185     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1186     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1187     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1188     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1189     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1190     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1191     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1192     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1193     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1194     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1195     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1196     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1197     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1198     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1199     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1200     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1201     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1202     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1203     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1204     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1205     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1206     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1207     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1208     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1209     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1210     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1211     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1212     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1213     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1214     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1215     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1216     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1217     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1218     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1219     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1220     12  ER-8080                     PIC S9(4)   VALUE +8080.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  23
* EL050.cbl
  1221     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1222     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1223     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1224     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1225     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1226     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1227     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1228     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1229     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1230     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1231     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1232     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1233     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1234     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1235     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1236     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1237     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1238     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1239     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1240     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1241     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1242     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1243     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1244     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1245     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1246     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1247     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1248     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1249     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1250     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1251     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1252     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1253     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1254     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1255     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1256     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1257     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1258     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1259     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1260     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1261     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1262     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1263     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1264     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1265     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1266     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1267     12  er-9823                     pic s9(4)   value +9823.
  1268     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1269******************************************************************
  1270***************   END OF ELC50WS     ****************************
  1271******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  24
* EL050.cbl
  1274 01  WORKING-STORAGE-WORK-AREAS.
  1275     12  WS-RESPONSE             PIC S9(8)  COMP.
  1276         88  WS-RESP-NORMAL           VALUE +00.
  1277         88  WS-RESP-ERROR            VALUE +01.
  1278         88  WS-RESP-NOTFND           VALUE +13.
  1279         88  WS-RESP-DUPREC           VALUE +14.
  1280         88  WS-RESP-ENDFILE          VALUE +20.
  1281     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1282     12  WORK-AREAS.
  1283         16  WK-CONV-GREG.
  1284             24  WCG-CENT             PIC XX.
  1285             24  WCG-REST             PIC X(4).
  1286         16  WORK-GREGORIAN-DATE.
  1287             24  WK-GREG-CENT         PIC XX.
  1288             24  WK-GREG-DATE-YYMMDD.
  1289                 28  WK-GREG-YYMM     PIC X(4).
  1290                 28  WK-GREG-DD       PIC XX.
  1291
  1292         16  WORK-SELECT-DATE.
  1293             24  WK-SELECT-CENT            PIC XX.
  1294             24  WK-SELECT-DATE-YYMMDD.
  1295                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1296                 28  FILLER                PIC XX.
  1297
  1298         16  WK-FORM-NO.
  1299             24  WK-FORM-BANK-ID       PIC X(5).
  1300             24  WK-FORM-UNDRWRTR      PIC X(1).
  1301             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1302
  1303         16  WK-MEMBER-NO.
  1304             24  WK-MEMBER-1-6        PIC X(6).
  1305             24  WK-MEMBER-7-12       PIC X(6).
  1306
  1307         16  WK-FULL-CERT-NO.
  1308             24  WK-CERT-POS-1-2      PIC X(2).
  1309             24  WK-CERT-POS-3        PIC X(1).
  1310             24  WK-CERT-POS-4        PIC X(1).
  1311             24  WK-CERT-POS-5-6      PIC X(2).
  1312             24  WK-CERT-POS-7        PIC X(1).
  1313             24  WK-CERT-POS-8-11     PIC X(4).
  1314
  1315         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1316             88  VALID-RATE-CODE        VALUE 'Y'.
  1317             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1318
  1319         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1320         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1321         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1322         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1323         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1324         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1325         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1326         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1327         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1328         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1329
  1330* DLO001
  1331 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  25
* EL050.cbl
  1332     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1333     12  DMPF-RETURN-CODE          PIC XX.
  1334         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1335         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1336         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1337         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1338         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1339         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1340
  1341* DLO002
  1342 01  WS-DLO-INTERNAL-POLICY-FORM.
  1343     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1344     12  DIPF-RETURN-CODE          PIC XX.
  1345         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1346         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1347         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1348         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1349         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1350         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1351
  1352* DLO003
  1353 01  WS-DLO-VALID-BANK-ID.
  1354     12  DVBI-BANK-ID              PIC X(5).
  1355     12  DVBI-BANK-ID-TYPE         PIC X.
  1356         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1357         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1358         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1359         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1360         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1361     12  DVBI-RETURN-CODE          PIC XX.
  1362         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1363         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1364         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1365         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1366         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1367         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1368         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1369         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1370         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1371
  1372* DLO007
  1373 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1374     12  DCUA-RES-STATE            PIC XX.
  1375     12  DCUA-BEN-TYPE             PIC XX.
  1376     12  DCUA-SYS-IDENT            PIC X.
  1377         88  DCUA-CLAIM                        VALUE 'C'.
  1378         88  DCUA-PREMIUM                      VALUE 'P'.
  1379     12  DCUA-COVERAGE-RULE        PIC X.
  1380     12  DCUA-CLIENT-ID            PIC X(10).
  1381     12  DCUA-EFF-DATE             PIC X(8).
  1382     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1383     12  DCUA-RETURN-CODE          PIC XX.
  1384         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1385     12  DCUA-CERT-NUMBER          PIC X(11).
  1386     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1387     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1388
  1389* DLO011
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  26
* EL050.cbl
  1390 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1391     12  DPRB-RATE-CODE            PIC X(4).
  1392     12  DPRB-COVERAGE-CATEG       PIC X.
  1393     12  DPRB-RETURN-CODE          PIC XX.
  1394         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1395         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1396         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1397         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1398         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1399         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1400         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1401         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1402         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1403     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1404     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1405     12  DPRB-BEN-TYPE             PIC XX.
  1406
  1407* DLO017
  1408 01  WS-DLO-VALID-RATE-CODE.
  1409     12  DVRC-RATE-CODE            PIC X(4).
  1410     12  DVRC-RETURN-CODE          PIC XX.
  1411         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1413         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1414         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1415         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1416         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1417
  1418* DLO019
  1419 01  WS-DLO-ORIG-COV-CAT.
  1420     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1421     12  DOCC-RETURN-CODE          PIC XX.
  1422     12  DOCC-ORIG-COV-CAT         PIC X.
  1423     12  DOCC-UNDERWITER           PIC XX.
  1424     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1425     12  DOCC-FILLER               PIC X(6).
  1426
  1427* DLO021
  1428 01  WS-DLO-VALID-LOAN-OFFICER.
  1429     12  DVLO-LOAN-OFFICER.
  1430         16  DVLO-BILL-TYPE        PIC X.
  1431         16  DVLO-BILL-SOURCE      PIC X.
  1432         16  DVLO-BATCH-TYPE       PIC X.
  1433     12  DVLO-RETURN-CODE          PIC XX.
  1434         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1435         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1436         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1437         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1438         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1439         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1440
  1441* DLO022
  1442 01  WS-DLO-VALID-STATE-CODE.
  1443     12  DVSC-STATE-CODE           PIC XX.
  1444     12  DVSC-RETURN-CODE          PIC XX.
  1445         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1446
  1447* DLO023
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  27
* EL050.cbl
  1448 01  WS-DLO-VALID-CODE-VALUES.
  1449     12  DVCV-SYSTEM-ID            PIC XX.
  1450         88  DVCV-CLAIMS                       VALUE 'CL'.
  1451         88  DVCV-CREDIT                       VALUE 'CR'.
  1452     12  DVCV-RECORD-TYPE          PIC XX.
  1453         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1454         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1455         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1456         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1457         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1458         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1459         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1460         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1461     12  DVCV-RECORD-KEY           PIC X(6).
  1462     12  DVCV-RETURN-CODE          PIC XX.
  1463         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1464         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1465         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1466         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1467         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1468         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1469         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1470     12  DVCV-CODE-DESC            PIC X(60).
  1471     12  DVCV-GEN-DESC-1           PIC X(20).
  1472     12  DVCV-GEN-DESC-2           PIC X(20).
  1473     12  DVCV-GEN-DESC-3           PIC X(20).
  1474
  1475 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1476 01  hldi-pass-area.
  1477     03  PA-VIN                  PIC X(17).
  1478     03  PA-ErrorCode            PIC X(10).
  1479     03  PA-ErrorDesc            PIC X(30).
  1480     03  PA-ModelYear            PIC 9(7).
  1481     03  PA-MakeName             PIC X(50).
  1482     03  PA-ModelName            PIC X(50).
  1483     03  PA-SeriesName           PIC X(50).
  1484****  this is for aggregate report.
  1485****  Length is erpndb + 100 of passed-key-area
  1486 01  ws-passed-key-length        pic s9(4) comp value +587.
  1487 01  ws-pass-to-pemaggo.
  1488     05  ws-passed-erpndb        pic x(585).
  1489     05  ws-exceed-limit-yn      pic x.
  1490     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  28
* EL050.cbl
  1492*    COPY ERCBXRF.
  1493******************************************************************
  1494*                                                                *
  1495*                                                                *
  1496*                            ERCBXRF                             *
  1497*                                                                *
  1498*   ONLINE CREDIT SYSTEM                                         *
  1499*                                                                *
  1500*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1501*                                                                *
  1502*   FILE TYPE = VSAM,KSDS                                        *
  1503*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1504*                                                                *
  1505*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1506*       ALTERNATE PATH = NONE                                    *
  1507*                                                                *
  1508*   LOG = NO                                                     *
  1509*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1510*                                                                *
  1511******************************************************************
  1512
  1513 01  BANK-CROSS-REFERENCE.
  1514     12  BK-RECORD-ID                PIC XX.
  1515         88  VALID-BK-ID             VALUE 'BK'.
  1516
  1517     12  BK-CONTROL-PRIMARY.
  1518         16  BK-COMPANY-CD           PIC X.
  1519         16  BK-CARRIER              PIC X.
  1520         16  BK-GROUPING             PIC X(6).
  1521         16  BK-BANK-NO              PIC X(10).
  1522
  1523     12  BK-MAINT-INFORMATION.
  1524         16  BK-LAST-MAINT-DT        PIC XX.
  1525         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1526         16  BK-LAST-MAINT-USER      PIC X(4).
  1527         16  FILLER                  PIC X(9).
  1528
  1529     12  FILLER                      PIC X(37).
  1530
  1531     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1532
  1533     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1534                            DEPENDING ON BK-BANK-POINTER-CNT.
  1535         16  BK-AM-ACCOUNT           PIC X(10).
  1536         16  BK-AM-EXP-DT            PIC XX.
  1537         16  BK-AM-EFF-DT            PIC XX.
  1538         16  BK-AM-STATE             PIC XX.
  1539         16  FILLER                  PIC X(20).
  1540
  1541******************************************************************
  1542
  1543*    COPY ERCCOMP.
  1544******************************************************************
  1545*                                                                *
  1546*                                                                *
  1547*                            ERCCOMP                             *
  1548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1549*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  29
* EL050.cbl
  1550*                                                                *
  1551*   ONLINE CREDIT SYSTEM                                         *
  1552*                                                                *
  1553*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1554*                                                                *
  1555*   FILE TYPE = VSAM,KSDS                                        *
  1556*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1557*                                                                *
  1558*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1559*       ALTERNATE PATH = NONE                                    *
  1560*                                                                *
  1561*   LOG = NO                                                     *
  1562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1563*                                                                *
  1564******************************************************************
  1565*                   C H A N G E   L O G
  1566*
  1567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1568*-----------------------------------------------------------------
  1569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1570* EFFECTIVE    NUMBER
  1571*-----------------------------------------------------------------
  1572* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1573* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1574* 092205    2005050300006  PEMA  ADD LEASE FEE
  1575* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1576* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1577* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1578* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1579* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1580* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1581******************************************************************
  1582
  1583 01  COMPENSATION-MASTER.
  1584     12  CO-RECORD-ID                          PIC XX.
  1585         88  VALID-CO-ID                          VALUE 'CO'.
  1586
  1587     12  CO-CONTROL-PRIMARY.
  1588         16  CO-COMPANY-CD                     PIC X.
  1589         16  CO-CONTROL.
  1590             20  CO-CTL-1.
  1591                 24  CO-CARR-GROUP.
  1592                     28  CO-CARRIER            PIC X.
  1593                     28  CO-GROUPING.
  1594                         32  CO-GROUP-PREFIX   PIC XXX.
  1595                         32  CO-GROUP-PRIME    PIC XXX.
  1596                 24  CO-RESP-NO.
  1597                     28  CO-RESP-PREFIX        PIC X(4).
  1598                     28  CO-RESP-PRIME         PIC X(6).
  1599             20  CO-CTL-2.
  1600                 24  CO-ACCOUNT.
  1601                     28  CO-ACCT-PREFIX        PIC X(4).
  1602                     28  CO-ACCT-PRIME         PIC X(6).
  1603         16  CO-TYPE                           PIC X.
  1604             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1605             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1606             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1607
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  30
* EL050.cbl
  1608     12  CO-MAINT-INFORMATION.
  1609         16  CO-LAST-MAINT-DT                  PIC XX.
  1610         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1611         16  CO-LAST-MAINT-USER                PIC X(4).
  1612     12  FILLER                                PIC XX.
  1613     12  CO-STMT-TYPE                          PIC XXX.
  1614     12  CO-COMP-TYPE                          PIC X.
  1615         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1616     12  CO-STMT-OWNER                         PIC X(4).
  1617     12  CO-BALANCE-CONTROL                    PIC X.
  1618         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1619         88  CO-NO-BALANCE                        VALUE 'N'.
  1620
  1621     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1622         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1623         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1624         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1625
  1626     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1627         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1628         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1629
  1630     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1631     12  CO-GA-DIRECT-DEP                      PIC X.
  1632     12  CO-FUTURE-SPACE                       PIC X.
  1633         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1634
  1635     12  CO-ACCT-NAME                          PIC X(30).
  1636     12  CO-MAIL-NAME                          PIC X(30).
  1637     12  CO-ADDR-1                             PIC X(30).
  1638     12  CO-ADDR-2                             PIC X(30).
  1639     12  CO-ADDR-3.
  1640         16  CO-ADDR-CITY                      PIC X(27).
  1641         16  CO-ADDR-STATE                     PIC XX.
  1642     12  CO-CSO-1099                           PIC X.
  1643     12  CO-ZIP.
  1644         16  CO-ZIP-PRIME.
  1645             20  CO-ZIP-PRI-1ST                PIC X.
  1646                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1647             20  FILLER                        PIC X(4).
  1648         16  CO-ZIP-PLUS4                      PIC X(4).
  1649     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1650         16  CO-CAN-POSTAL-1                   PIC XXX.
  1651         16  CO-CAN-POSTAL-2                   PIC XXX.
  1652         16  FILLER                            PIC XXX.
  1653     12  CO-SOC-SEC                            PIC X(13).
  1654     12  CO-TELEPHONE.
  1655         16  CO-AREA-CODE                      PIC XXX.
  1656         16  CO-PREFIX                         PIC XXX.
  1657         16  CO-PHONE                          PIC X(4).
  1658
  1659     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1660
  1661     12  CO-AR-BAL-LEVEL                       PIC X.
  1662         88  CO-AR-REF-LVL                        VALUE '1'.
  1663         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1664         88  CO-AR-BILL-LVL                       VALUE '2'.
  1665         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  31
* EL050.cbl
  1666         88  CO-AR-FR-LVL                         VALUE '4'.
  1667
  1668     12  CO-AR-NORMAL-PRINT                    PIC X.
  1669         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1670         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1671
  1672     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1673
  1674     12  CO-AR-REPORTING                       PIC X.
  1675         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1676         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1677
  1678     12  CO-AR-PULL-CHECK                      PIC X.
  1679         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1680         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1681
  1682     12  CO-AR-BALANCE-PRINT                   PIC X.
  1683         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1684
  1685     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1686         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1687         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1688         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1689
  1690     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1691
  1692     12  CO-USER-CODE                          PIC X.
  1693     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1694
  1695******************************************************************
  1696*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1697*    THE LAST MONTH END RUN.
  1698******************************************************************
  1699
  1700     12  CO-LAST-ACTIVITY-DATE.
  1701         16  CO-ACT-YEAR                       PIC 99.
  1702         16  CO-ACT-MONTH                      PIC 99.
  1703         16  CO-ACT-DAY                        PIC 99.
  1704
  1705     12  CO-LAST-STMT-DT.
  1706         16  CO-LAST-STMT-YEAR                 PIC 99.
  1707         16  CO-LAST-STMT-MONTH                PIC 99.
  1708         16  CO-LAST-STMT-DAY                  PIC 99.
  1709
  1710     12  CO-MO-END-TOTALS.
  1711         16  CO-MONTHLY-TOTALS.
  1712             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1713             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1714             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1715             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1716             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1717
  1718         16  CO-AGING-TOTALS.
  1719             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1720             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1721             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1722             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1723
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  32
* EL050.cbl
  1724         16  CO-YTD-TOTALS.
  1725             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1726             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1727
  1728         16  CO-OVER-UNDER-TOTALS.
  1729             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1730             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1731
  1732     12  CO-MISCELLANEOUS-TOTALS.
  1733         16  CO-FICA-TOTALS.
  1734             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1735             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1736
  1737         16  CO-CLAIM-TOTALS.
  1738             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1739             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1740
  1741******************************************************************
  1742*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1743*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1744******************************************************************
  1745
  1746     12  CO-CURRENT-TOTALS.
  1747         16  CO-CURRENT-LAST-STMT-DT.
  1748             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1749             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1750             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1751
  1752         16  CO-CURRENT-MONTHLY-TOTALS.
  1753             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1754             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1755             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1756             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1757             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1758
  1759         16  CO-CURRENT-AGING-TOTALS.
  1760             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1761             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1762             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1763             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1764
  1765         16  CO-CURRENT-YTD-TOTALS.
  1766             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1767             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1768
  1769     12  CO-PAID-COMM-TOTALS.
  1770         16  CO-YTD-PAID-COMMS.
  1771             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1772             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1773
  1774     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1775         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1776         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1777
  1778     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1779         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1780         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1781         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  33
* EL050.cbl
  1782         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1783         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1784         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1785         88  CO-FINAL-LETTER                  VALUE 'F'.
  1786         88  CO-RECONCILING                   VALUE 'R'.
  1787         88  CO-PHONE-CALL                    VALUE 'P'.
  1788         88  CO-LEGAL                         VALUE 'L'.
  1789         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1790         88  CO-WRITE-OFF                     VALUE 'W'.
  1791         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1792
  1793     12  CO-CSR-CODE                       PIC X(4).
  1794
  1795     12  CO-GA-STATUS-INFO.
  1796         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1797         16  CO-GA-TERMINATION-DT          PIC XX.
  1798         16  CO-GA-STATUS-CODE             PIC X.
  1799             88  CO-GA-ACTIVE                 VALUE 'A'.
  1800             88  CO-GA-INACTIVE               VALUE 'I'.
  1801             88  CO-GA-PENDING                VALUE 'P'.
  1802         16  CO-GA-COMMENTS.
  1803             20  CO-GA-COMMENT-1           PIC X(40).
  1804             20  CO-GA-COMMENT-2           PIC X(40).
  1805             20  CO-GA-COMMENT-3           PIC X(40).
  1806             20  CO-GA-COMMENT-4           PIC X(40).
  1807
  1808     12  CO-RPTCD2                         PIC X(10).
  1809     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1810         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1811         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1812
  1813     12  CO-TYPE-AGENT                     PIC X(01).
  1814         88  CO-CORPORATION                   VALUE 'C'.
  1815         88  CO-PARTNERSHIP                   VALUE 'P'.
  1816         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1817         88  CO-TRUST                         VALUE 'T'.
  1818         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1819
  1820     12  CO-FAXNO.
  1821         16  CO-FAX-AREA-CODE                  PIC XXX.
  1822         16  CO-FAX-PREFIX                     PIC XXX.
  1823         16  CO-FAX-PHONE                      PIC X(4).
  1824
  1825     12  CO-BANK-INFORMATION.
  1826         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1827         16  CO-BANK-TRANSIT-NON REDEFINES
  1828             CO-BANK-TRANSIT-NO                PIC 9(8).
  1829
  1830         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1831     12  CO-MISC-DEDUCT-INFO REDEFINES
  1832                  CO-BANK-INFORMATION.
  1833         16  CO-MD-GL-ACCT                     PIC X(10).
  1834         16  CO-MD-DIV                         PIC XX.
  1835         16  CO-MD-CENTER                      PIC X(4).
  1836         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1837         16  CO-CREATE-AP-CHECK                PIC X.
  1838         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1839         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  34
* EL050.cbl
  1840     12  CO-ACH-STATUS                         PIC X.
  1841         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1842         88  CO-ACH-PENDING                        VALUE 'P'.
  1843
  1844     12  CO-BILL-SW                            PIC X.
  1845     12  CO-CONTROL-NAME                       PIC X(30).
  1846     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1847     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1848     12  CO-CLP-STATE                          PIC XX.
  1849     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1850     12  CO-SPP-REFUND-EDIT                    PIC X.
  1851
  1852******************************************************************
  1853
  1854*    COPY ERCAGTC.
  1855******************************************************************
  1856*                                                                *
  1857*                                                                *
  1858*                            ERCAGTC                             *
  1859*                            VMOD=2.001                          *
  1860*                                                                *
  1861*   ONLINE CREDIT SYSTEM                                         *
  1862*                                                                *
  1863*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1864*                                                                *
  1865*   FILE TYPE = VSAM,KSDS                                        *
  1866*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1867*                                                                *
  1868*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1869*       ALTERNATE PATH = NONE                                    *
  1870*                                                                *
  1871*   LOG = NO                                                     *
  1872*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1873*                                                                *
  1874******************************************************************
  1875*                   C H A N G E   L O G
  1876*
  1877* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1878*-----------------------------------------------------------------
  1879*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1880* EFFECTIVE    NUMBER
  1881*-----------------------------------------------------------------
  1882* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1883* 111004                         NEW FILE AND COPYBOOK
  1884* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1885******************************************************************
  1886 01  AGENT-COMMISSIONS.
  1887     12  AG-RECORD-ID                          PIC XX.
  1888         88  VALID-CO-ID                          VALUE 'AG'.
  1889     12  AG-CONTROL-PRIMARY.
  1890         16  AG-COMPANY-CD                     PIC X.
  1891         16  AG-CONTROL.
  1892             20  AG-CTL-1.
  1893                 24  AG-CARR-GROUP.
  1894                     28  AG-CARRIER            PIC X.
  1895                     28  AG-GROUPING           PIC X(6).
  1896                 24  AG-BANK                   PIC X(10).
  1897             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  35
* EL050.cbl
  1898                 24  AG-EXP-DT                 PIC XX.
  1899         16  AG-TYPE                           PIC X.
  1900             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1901             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1902     12  AG-MAINT-INFORMATION.
  1903         16  AG-LAST-MAINT-DT                  PIC XX.
  1904         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1905         16  AG-LAST-MAINT-USER                PIC X(4).
  1906         16  FILLER                            PIC X(10).
  1907     12  AG-EFF-DT                             PIC XX.
  1908     12  AG-COMM-STRUCTURE.
  1909         16  AG-AGT-COMMS OCCURS 10.
  1910             20  AG-AGT                PIC X(10).
  1911             20  AG-COM-TYP            PIC X.
  1912             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1913             20  AG-RECALC-LV-INDIC    PIC X.
  1914             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1915             20  AG-LRCALC-LV-INDIC    PIC X.
  1916             20  FILLER                PIC X(05).
  1917     12  FILLER                  PIC X(145).
  1918******************************************************************
  1919*    COPY ERCRESS.
  1920******************************************************************
  1921*                                                                *
  1922*                            ERCRESS                             *
  1923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1924*                            VMOD=2.002                          *
  1925*                                                                *
  1926*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1927*                                                                *
  1928*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1929*   VSAM RESIDENT STATE TAX MASTER                              *
  1930*                                                                *
  1931*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1932*                                                                *
  1933*   FILE TYPE = VSAM,KSDS                                        *
  1934*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1935*                                                                *
  1936*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1937*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1938*                                                                *
  1939*   LOG = NO                                                     *
  1940*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1941*                                                                *
  1942*                                                                *
  1943******************************************************************
  1944
  1945 01  RESIDENT-STATE-TAX-MASTER.
  1946
  1947     10  ERRESS-PRIMARY-KEY.
  1948         15  RES-COMPANY-CD        PIC X.
  1949         15  RES-RESIDENT-STATE    PIC XX.
  1950         15  RES-COVERAGE-CATEGORY PIC X.
  1951         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1952*                                      YYYYMMDD
  1953*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1954
  1955     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  36
* EL050.cbl
  1956
  1957         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1958         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1959         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1960         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1961
  1962     10 RES-RECALC-SW              PIC   X.
  1963         88 RECALC                VALUE 'Y'.
  1964         88 NO-RECALC             VALUE 'N'.
  1965     10  RES-MAINT-BY              PIC X(4).
  1966     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1967     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1968*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  37
* EL050.cbl
  1970*    COPY ERCRESC.
  1971******************************************************************
  1972*                                                                *
  1973*                            ERCRESC                             *
  1974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1975*                            VMOD=2.003                          *
  1976*                                                                *
  1977*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1978*                                                                *
  1979*   FILE TYPE = VSAM,KSDS                                        *
  1980*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1981*                                                                *
  1982*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1983*       ALTERNATE PATH1 = NONE                                   *
  1984*                                                                *
  1985*   LOG = NO                                                     *
  1986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1987*                                                                *
  1988******************************************************************
  1989
  1990 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1991
  1992     10  ERRESC-RECORD-KEY.
  1993         15  RESC-COMPANY-CD           PIC   X.
  1994         15  RESC-CARRIER              PIC   X.
  1995         15  RESC-GROUP                PIC   X(6).
  1996         15  RESC-STATE                PIC   XX.
  1997         15  RESC-ACCOUNT              PIC   X(10).
  1998         15  RESC-AGENT                PIC   X(10).
  1999         15  RESC-RESIDENT-STATE       PIC   XX.
  2000         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2001*                                           YYYYMMDD
  2002     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2003
  2004     10  RESC-COMM-RECORD-DATA.
  2005         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2006             20 RESC-COVERAGE-CAT      PIC    X.
  2007             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2008             20 RESC-COMMISSION-TAB REDEFINES
  2009                RESC-COMMISSION-PER    PIC  XXX.
  2010
  2011     10  RESC-MAINT-BY                 PIC X(4).
  2012     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2013     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2014*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  38
* EL050.cbl
  2016*    COPY ERCPLAN.
  2017******************************************************************
  2018*                                                                *
  2019*                                                                *
  2020*                            ERCPLAN                             *
  2021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2022*                            VMOD=2.003                          *
  2023*                                                                *
  2024*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2025*                                                                *
  2026*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2027*   PLAN MASTER                                                  *
  2028*                                                                *
  2029*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2030*                                                                *
  2031*   FILE TYPE = VSAM,KSDS                                        *
  2032*   RECORD SIZE = 420   RECFORM = FIX                            *
  2033*                                                                *
  2034*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2035*       ALTERNATE PATH1 = N/A                                    *
  2036*                                                                *
  2037*   LOG = NO                                                     *
  2038*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2039*                                                                *
  2040*                                                                *
  2041******************************************************************
  2042
  2043 01  PLAN-MASTER.
  2044     12  PL-RECORD-ID                      PIC XX.
  2045         88  VALID-PL-ID                      VALUE 'PL'.
  2046
  2047     12  PL-CONTROL-PRIMARY.
  2048         16  PL-COMPANY-CD                 PIC X.
  2049         16  PL-MSTR-CNTRL.
  2050             20  PL-CONTROL-A.
  2051                 24  PL-CARRIER            PIC X.
  2052                 24  PL-GROUPING           PIC X(6).
  2053                 24  PL-STATE              PIC XX.
  2054                 24  PL-ACCOUNT            PIC X(10).
  2055             20  PL-BENEFIT-TYPE           PIC X.
  2056             20  PL-BENEFIT-CODE           PIC XX.
  2057             20  PL-REVISION-NO            PIC X(3).
  2058
  2059     12  PL-CONTROL-BY-VAR-GRP.
  2060         16  PL-COMPANY-CD-A1              PIC X.
  2061         16  PL-VG-CARRIER                 PIC X.
  2062         16  PL-VG-GROUPING                PIC X(6).
  2063         16  PL-VG-STATE                   PIC XX.
  2064         16  PL-VG-ACCOUNT                 PIC X(10).
  2065         16  PL-BENEFIT-TYPE-A1            PIC X.
  2066         16  PL-BENEFIT-CODE-A1            PIC XX.
  2067         16  PL-REVISION-NO-A1             PIC 999.
  2068
  2069     12  PL-MAINT-INFORMATION.
  2070         16  PL-LAST-MAINT-DT              PIC XX.
  2071         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2072         16  PL-LAST-MAINT-USER            PIC X(4).
  2073         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  39
* EL050.cbl
  2074
  2075     12  PL-LIABILITY-LIMITS.
  2076         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2077         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2078             20  PL-LM-AGE                 PIC S99        COMP-3.
  2079             20  PL-LM-DUR                 PIC S999       COMP-3.
  2080             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2081             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2082
  2083     12  FILLER                            PIC X(30).
  2084
  2085     12  PL-GL-ACCOUNT-NOS.
  2086         16  PL-PREMIUM-GL                 PIC X(8).
  2087         16  PL-COMM-GL                    PIC X(8).
  2088         16  PL-CLAIM-GL                   PIC X(8).
  2089     12  FILLER                            PIC X(24).
  2090     12  PL-TOLERANCES.
  2091         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2092         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2093         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2094         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2095         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2096         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2097     12  PL-OVER-SHORT.
  2098         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2099         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2100     12  FILLER                            PIC X(24).
  2101     12  PLAN-MISC.
  2102         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2103         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2104         16  PL-IG                         PIC X.
  2105         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2106         16  PL-POLICY-FORM                PIC X(12).
  2107         16  PL-EDIT-FOR-FORM              PIC X(01).
  2108         16  PL-DEV-CODE                   PIC XXX.
  2109         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2110         16  PL-CALC-METHOD                PIC X.
  2111         16  PL-BENEFIT-GROUP              PIC X(05).
  2112         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2113
  2114         16  FILLER                        PIC X(99).
  2115******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  40
* EL050.cbl
  2117*    COPY ELCCERT.
  2118******************************************************************
  2119*                                                                *
  2120*                            ELCCERT.                            *
  2121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2122*                            VMOD=2.013                          *
  2123*                                                                *
  2124*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2125*                                                                *
  2126*   FILE TYPE = VSAM,KSDS                                        *
  2127*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2128*                                                                *
  2129*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2130*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2131*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2132*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2133*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2134*                                                                *
  2135*   LOG = YES                                                    *
  2136*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2137******************************************************************
  2138*                   C H A N G E   L O G
  2139*
  2140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2141*-----------------------------------------------------------------
  2142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2143* EFFECTIVE    NUMBER
  2144*-----------------------------------------------------------------
  2145* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2146* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2147* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2148* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2149* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2150* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2151* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2152* 032612  CR2011110200001  PEMA  AHL CHANGES
  2153* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2154* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2155******************************************************************
  2156
  2157 01  CERTIFICATE-MASTER.
  2158     12  CM-RECORD-ID                      PIC XX.
  2159         88  VALID-CM-ID                      VALUE 'CM'.
  2160
  2161     12  CM-CONTROL-PRIMARY.
  2162         16  CM-COMPANY-CD                 PIC X.
  2163         16  CM-CARRIER                    PIC X.
  2164         16  CM-GROUPING.
  2165             20  CM-GROUPING-PREFIX        PIC X(3).
  2166             20  CM-GROUPING-PRIME         PIC X(3).
  2167         16  CM-STATE                      PIC XX.
  2168         16  CM-ACCOUNT.
  2169             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2170             20  CM-ACCOUNT-PRIME          PIC X(6).
  2171         16  CM-CERT-EFF-DT                PIC XX.
  2172         16  CM-CERT-NO.
  2173             20  CM-CERT-PRIME             PIC X(10).
  2174             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  41
* EL050.cbl
  2175
  2176     12  CM-CONTROL-BY-NAME.
  2177         16  CM-COMPANY-CD-A1              PIC X.
  2178         16  CM-INSURED-LAST-NAME          PIC X(15).
  2179         16  CM-INSURED-INITIALS.
  2180             20  CM-INSURED-INITIAL1       PIC X.
  2181             20  CM-INSURED-INITIAL2       PIC X.
  2182
  2183     12  CM-CONTROL-BY-SSN.
  2184         16  CM-COMPANY-CD-A2              PIC X.
  2185         16  CM-SOC-SEC-NO.
  2186             20  CM-SSN-STATE              PIC XX.
  2187             20  CM-SSN-ACCOUNT            PIC X(6).
  2188             20  CM-SSN-LN3.
  2189                 25  CM-INSURED-INITIALS-A2.
  2190                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2191                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2192                 25 CM-PART-LAST-NAME-A2         PIC X.
  2193
  2194     12  CM-CONTROL-BY-CERT-NO.
  2195         16  CM-COMPANY-CD-A4              PIC X.
  2196         16  CM-CERT-NO-A4                 PIC X(11).
  2197
  2198     12  CM-CONTROL-BY-MEMB.
  2199         16  CM-COMPANY-CD-A5              PIC X.
  2200         16  CM-MEMBER-NO.
  2201             20  CM-MEMB-STATE             PIC XX.
  2202             20  CM-MEMB-ACCOUNT           PIC X(6).
  2203             20  CM-MEMB-LN4.
  2204                 25  CM-INSURED-INITIALS-A5.
  2205                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2206                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2207                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2208
  2209     12  CM-INSURED-PROFILE-DATA.
  2210         16  CM-INSURED-FIRST-NAME.
  2211             20  CM-INSURED-1ST-INIT       PIC X.
  2212             20  FILLER                    PIC X(9).
  2213         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2214         16  CM-INSURED-SEX                PIC X.
  2215             88  CM-SEX-MALE                  VALUE 'M'.
  2216             88  CM-SEX-FEMAL                 VALUE 'F'.
  2217         16  CM-INSURED-JOINT-AGE          PIC 99.
  2218         16  CM-JOINT-INSURED-NAME.
  2219             20  CM-JT-LAST-NAME           PIC X(15).
  2220             20  CM-JT-FIRST-NAME.
  2221                 24  CM-JT-1ST-INIT        PIC X.
  2222                 24  FILLER                PIC X(9).
  2223             20  CM-JT-INITIAL             PIC X.
  2224
  2225     12  CM-LIFE-DATA.
  2226         16  CM-LF-BENEFIT-CD              PIC XX.
  2227         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2228         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2229         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2230         16  CM-LF-DEV-CODE                PIC XXX.
  2231         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2232         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  42
* EL050.cbl
  2233         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2234         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2235         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2236         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2237         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2238         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2239         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2240         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2241         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2242         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2243         16  cm-temp-epiq                  pic xx.
  2244             88  EPIQ-CLASS                  value 'EQ'.
  2245*        16  FILLER                        PIC XX.
  2246
  2247     12  CM-AH-DATA.
  2248         16  CM-AH-BENEFIT-CD              PIC XX.
  2249         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2250         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2251         16  CM-AH-DEV-CODE                PIC XXX.
  2252         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2253         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2254         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2255         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2256         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2257         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2258         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2259         16  CM-AH-PAID-THRU-DT            PIC XX.
  2260             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2261         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2262         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2263         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2264         16  FILLER                        PIC X.
  2265
  2266     12  CM-LOAN-INFORMATION.
  2267         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2268         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2269                                           PIC S9(5)V99  COMP-3.
  2270         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2271         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2272         16  CM-PAY-FREQUENCY              PIC S99.
  2273         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2274         16  CM-RATE-CLASS                 PIC XX.
  2275         16  CM-BENEFICIARY                PIC X(25).
  2276         16  CM-POLICY-FORM-NO             PIC X(12).
  2277         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2278         16  CM-LAST-ADD-ON-DT             PIC XX.
  2279         16  CM-DEDUCTIBLE-AMOUNTS.
  2280             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2281             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2282         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2283             20  CM-RESIDENT-STATE         PIC XX.
  2284             20  CM-RATE-CODE              PIC X(4).
  2285             20  FILLER                    PIC XX.
  2286         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2287             20  CM-LOAN-OFFICER           PIC X(5).
  2288             20  FILLER                    PIC XXX.
  2289         16  CM-CSR-CODE                   PIC XXX.
  2290         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  43
* EL050.cbl
  2291             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2292         16  CM-POST-CARD-IND              PIC X.
  2293         16  CM-NH-INTERFACE-SW            PIC X.
  2294         16  CM-PREMIUM-TYPE               PIC X.
  2295             88  CM-SING-PRM                  VALUE '1'.
  2296             88  CM-O-B-COVERAGE              VALUE '2'.
  2297             88  CM-OPEN-END                  VALUE '3'.
  2298         16  CM-IND-GRP-TYPE               PIC X.
  2299             88  CM-INDIVIDUAL                VALUE 'I'.
  2300             88  CM-GROUP                     VALUE 'G'.
  2301         16  CM-SKIP-CODE                  PIC X.
  2302             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2303             88  SKIP-JULY                    VALUE '1'.
  2304             88  SKIP-AUGUST                  VALUE '2'.
  2305             88  SKIP-SEPTEMBER               VALUE '3'.
  2306             88  SKIP-JULY-AUG                VALUE '4'.
  2307             88  SKIP-AUG-SEPT                VALUE '5'.
  2308             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2309             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2310             88  SKIP-JUNE                    VALUE '8'.
  2311             88  SKIP-JUNE-JULY               VALUE '9'.
  2312             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2313             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2314         16  CM-PAYMENT-MODE               PIC X.
  2315             88  PAY-MONTHLY                  VALUE SPACE.
  2316             88  PAY-WEEKLY                   VALUE '1'.
  2317             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2318             88  PAY-BI-WEEKLY                VALUE '3'.
  2319             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2320         16  CM-LOAN-NUMBER                PIC X(8).
  2321         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2322         16  CM-OLD-LOF                    PIC XXX.
  2323*        16  CM-LOAN-OFFICER               PIC XXX.
  2324         16  CM-REIN-TABLE                 PIC XXX.
  2325         16  CM-SPECIAL-REIN-CODE          PIC X.
  2326         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2327         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2328         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2329
  2330     12  CM-STATUS-DATA.
  2331         16  CM-ENTRY-STATUS               PIC X.
  2332         16  CM-ENTRY-DT                   PIC XX.
  2333
  2334         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2335         16  CM-LF-CANCEL-DT               PIC XX.
  2336         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2337
  2338         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2339         16  CM-LF-DEATH-DT                PIC XX.
  2340         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2341
  2342         16  CM-LF-CURRENT-STATUS          PIC X.
  2343             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2344                                                'M' '4' '5' '9'.
  2345             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2346             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2347             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2348             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  44
* EL050.cbl
  2349             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2350             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2351             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2352             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2353             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2354             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2355             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2356             88  CM-LF-DECLINED               VALUE 'D'.
  2357             88  CM-LF-VOIDED                 VALUE 'V'.
  2358
  2359         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2360         16  CM-AH-CANCEL-DT               PIC XX.
  2361         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2362
  2363         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2364         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2365         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2366
  2367         16  CM-AH-CURRENT-STATUS          PIC X.
  2368             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2369                                                'M' '4' '5' '9'.
  2370             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2371             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2372             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2373             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2374             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2375             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2376             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2377             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2378             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2379             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2380             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2381             88  CM-AH-DECLINED               VALUE 'D'.
  2382             88  CM-AH-VOIDED                 VALUE 'V'.
  2383
  2384         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2385             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2386             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2387             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2388         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2389
  2390         16  CM-ENTRY-BATCH                PIC X(6).
  2391         16  CM-LF-EXIT-BATCH              PIC X(6).
  2392         16  CM-AH-EXIT-BATCH              PIC X(6).
  2393         16  CM-LAST-MONTH-END             PIC XX.
  2394
  2395     12  CM-NOTE-SW                        PIC X.
  2396         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2397         88  CERT-NOTES-PRESENT               VALUE '1'.
  2398         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2399         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2400         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2401         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2402         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2403         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2404     12  CM-COMP-EXCP-SW                   PIC X.
  2405         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2406         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  45
* EL050.cbl
  2407     12  CM-INSURED-ADDRESS-SW             PIC X.
  2408         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2409         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2410
  2411*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2412     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2413     12  FILLER                            PIC X.
  2414
  2415*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2416     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2417     12  FILLER                            PIC X.
  2418*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2419     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2420
  2421     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2422         88  CERT-ADDED-BATCH                 VALUE ' '.
  2423         88  CERT-ADDED-ONLINE                VALUE '1'.
  2424         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2425         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2426         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2427     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2428         88  CERT-AS-LOADED                   VALUE ' '.
  2429         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2430         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2431         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2432         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2433         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2434         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2435         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2436
  2437     12  CM-ACCOUNT-COMM-PCTS.
  2438         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2439         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2440
  2441     12  CM-USER-FIELD                     PIC X.
  2442     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2443     12  CM-CLP-STATE                      PIC XX.
  2444     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2445     12  CM-USER-RESERVED                  PIC XXX.
  2446     12  FILLER REDEFINES CM-USER-RESERVED.
  2447         16  CM-AH-CLASS-CD                PIC XX.
  2448         16  F                             PIC X.
  2449******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  46
* EL050.cbl
  2451*    COPY ERCMAIL.
  2452******************************************************************
  2453*                                                                *
  2454*                                                                *
  2455*                            ERCMAIL                             *
  2456*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2457*                            VMOD=2.003                          *
  2458*                                                                *
  2459*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2460*                                                                *
  2461*   FILE TYPE = VSAM,KSDS                                        *
  2462*   RECORD SIZE = 374   RECFORM = FIX                            *
  2463*                                                                *
  2464*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2465*   ALTERNATE PATH    = NOT USED                                 *
  2466*                                                                *
  2467*   LOG = YES                                                    *
  2468*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2469******************************************************************
  2470*                   C H A N G E   L O G
  2471*
  2472* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2473*-----------------------------------------------------------------
  2474*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2475* EFFECTIVE    NUMBER
  2476*-----------------------------------------------------------------
  2477* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2478* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2479* 111108                   PEMA  ADD CRED BENE ADDR2
  2480******************************************************************
  2481
  2482 01  MAILING-DATA.
  2483     12  MA-RECORD-ID                      PIC XX.
  2484         88  VALID-MA-ID                       VALUE 'MA'.
  2485
  2486     12  MA-CONTROL-PRIMARY.
  2487         16  MA-COMPANY-CD                 PIC X.
  2488         16  MA-CARRIER                    PIC X.
  2489         16  MA-GROUPING.
  2490             20  MA-GROUPING-PREFIX        PIC XXX.
  2491             20  MA-GROUPING-PRIME         PIC XXX.
  2492         16  MA-STATE                      PIC XX.
  2493         16  MA-ACCOUNT.
  2494             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2495             20  MA-ACCOUNT-PRIME          PIC X(6).
  2496         16  MA-CERT-EFF-DT                PIC XX.
  2497         16  MA-CERT-NO.
  2498             20  MA-CERT-PRIME             PIC X(10).
  2499             20  MA-CERT-SFX               PIC X.
  2500
  2501     12  FILLER                            PIC XX.
  2502
  2503     12  MA-ACCESS-CONTROL.
  2504         16  MA-SOURCE-SYSTEM              PIC XX.
  2505             88  MA-FROM-CREDIT                VALUE 'CR'.
  2506             88  MA-FROM-VSI                   VALUE 'VS'.
  2507             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2508             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  47
* EL050.cbl
  2509         16  MA-RECORD-ADD-DT              PIC XX.
  2510         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2511         16  MA-LAST-MAINT-DT              PIC XX.
  2512         16  MA-LAST-MAINT-BY              PIC XXXX.
  2513         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2514
  2515     12  MA-PROFILE-INFO.
  2516         16  MA-QUALIFY-CODE-1             PIC XX.
  2517         16  MA-QUALIFY-CODE-2             PIC XX.
  2518         16  MA-QUALIFY-CODE-3             PIC XX.
  2519         16  MA-QUALIFY-CODE-4             PIC XX.
  2520         16  MA-QUALIFY-CODE-5             PIC XX.
  2521
  2522         16  MA-INSURED-LAST-NAME          PIC X(15).
  2523         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2524         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2525         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2526         16  MA-INSURED-BIRTH-DT           PIC XX.
  2527         16  MA-INSURED-SEX                PIC X.
  2528             88  MA-SEX-MALE                   VALUE 'M'.
  2529             88  MA-SEX-FEMALE                 VALUE 'F'.
  2530         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2531
  2532         16  MA-ADDRESS-CORRECTED          PIC X.
  2533         16  MA-JOINT-BIRTH-DT             PIC XX.
  2534*        16  FILLER                        PIC X(12).
  2535
  2536         16  MA-ADDRESS-LINE-1             PIC X(30).
  2537         16  MA-ADDRESS-LINE-2             PIC X(30).
  2538         16  MA-CITY-STATE.
  2539             20  MA-CITY                   PIC X(28).
  2540             20  MA-ADDR-STATE             PIC XX.
  2541         16  MA-ZIP.
  2542             20  MA-ZIP-CODE.
  2543                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2544                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2545                 24  FILLER                PIC X(4).
  2546             20  MA-ZIP-PLUS4              PIC X(4).
  2547         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2548             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2549             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2550             20  FILLER                    PIC X(3).
  2551
  2552         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2553
  2554         16  FILLER                        PIC XXX.
  2555*        16  FILLER                        PIC X(10).
  2556
  2557     12  MA-CRED-BENE-INFO.
  2558         16  MA-CRED-BENE-NAME                 PIC X(25).
  2559         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2560         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2561         16  MA-CRED-BENE-CTYST.
  2562             20  MA-CRED-BENE-CITY             PIC X(28).
  2563             20  MA-CRED-BENE-STATE            PIC XX.
  2564         16  MA-CRED-BENE-ZIP.
  2565             20  MA-CB-ZIP-CODE.
  2566                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  48
* EL050.cbl
  2567                     88  MA-CB-CANADIAN-POST-CODE
  2568                                           VALUE 'A' THRU 'Z'.
  2569                 24  FILLER                    PIC X(4).
  2570             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2571         16  MA-CB-CANADIAN-POSTAL-CODE
  2572                            REDEFINES MA-CRED-BENE-ZIP.
  2573             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2574             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2575             20  FILLER                        PIC X(3).
  2576     12  MA-POST-CARD-MAIL-DATA.
  2577         16  MA-MAIL-DATA OCCURS 7.
  2578             20  MA-MAIL-TYPE              PIC X.
  2579                 88  MA-12MO-MAILING           VALUE '1'.
  2580                 88  MA-EXP-MAILING            VALUE '2'.
  2581             20  MA-MAIL-STATUS            PIC X.
  2582                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2583                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2584                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2585             20  MA-MAIL-DATE              PIC XX.
  2586     12  FILLER                            PIC XX.
  2587     12  FILLER                            PIC XX.
  2588*    12  FILLER                            PIC X(30).
  2589******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  49
* EL050.cbl
  2591*    COPY ERCPNDM.
  2592******************************************************************
  2593*                                                                *
  2594*                                                                *
  2595*                            ERCPNDM                             *
  2596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2597*                            VMOD=2.003                          *
  2598*                                                                *
  2599*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2600*                                                                *
  2601*   FILE TYPE = VSAM,KSDS                                        *
  2602*   RECORD SIZE = 374   RECFORM = FIX                            *
  2603*                                                                *
  2604*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2605*   ALTERNATE PATH    = NOT USED                                 *
  2606*                                                                *
  2607*   LOG = YES                                                    *
  2608*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2609******************************************************************
  2610*                   C H A N G E   L O G
  2611*
  2612* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2613*-----------------------------------------------------------------
  2614*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2615* EFFECTIVE    NUMBER
  2616*-----------------------------------------------------------------
  2617* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2618* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2619* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2620******************************************************************
  2621
  2622 01  PENDING-MAILING-DATA.
  2623     12  PM-RECORD-ID                      PIC XX.
  2624         88  VALID-MA-ID                       VALUE 'PM'.
  2625
  2626     12  PM-CONTROL-PRIMARY.
  2627         16  PM-COMPANY-CD                 PIC X.
  2628         16  PM-ENTRY-BATCH                PIC X(6).
  2629         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2630         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2631
  2632     12  FILLER                            PIC X(14).
  2633
  2634     12  PM-ACCESS-CONTROL.
  2635         16  PM-SOURCE-SYSTEM              PIC XX.
  2636             88  PM-FROM-CREDIT                VALUE 'CR'.
  2637             88  PM-FROM-VSI                   VALUE 'VS'.
  2638             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2639             88  PM-FROM-OTHER                 VALUE 'OT'.
  2640         16  PM-RECORD-ADD-DT              PIC XX.
  2641         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2642         16  PM-LAST-MAINT-DT              PIC XX.
  2643         16  PM-LAST-MAINT-BY              PIC XXXX.
  2644         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2645
  2646     12  PM-PROFILE-INFO.
  2647         16  PM-QUALIFY-CODE-1             PIC XX.
  2648         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  50
* EL050.cbl
  2649         16  PM-QUALIFY-CODE-3             PIC XX.
  2650         16  PM-QUALIFY-CODE-4             PIC XX.
  2651         16  PM-QUALIFY-CODE-5             PIC XX.
  2652
  2653         16  PM-INSURED-LAST-NAME          PIC X(15).
  2654         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2655         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2656         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2657         16  PM-INSURED-BIRTH-DT           PIC XX.
  2658         16  PM-INSURED-SEX                PIC X.
  2659             88  PM-SEX-MALE                   VALUE 'M'.
  2660             88  PM-SEX-FEMALE                 VALUE 'F'.
  2661         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2662
  2663         16  PM-ADDRESS-CORRECTED          PIC X.
  2664         16  PM-JOINT-BIRTH-DT             PIC XX.
  2665*        16  FILLER                        PIC X(12).
  2666
  2667         16  PM-ADDRESS-LINE-1             PIC X(30).
  2668         16  PM-ADDRESS-LINE-2             PIC X(30).
  2669         16  PM-CITY-STATE.
  2670             20  PM-CITY                   PIC X(28).
  2671             20  PM-STATE                  PIC XX.
  2672         16  PM-ZIP.
  2673             20  PM-ZIP-CODE.
  2674                 24  PM-ZIP-1              PIC X.
  2675                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2676                 24  FILLER                PIC X(4).
  2677             20  PM-ZIP-PLUS4              PIC X(4).
  2678         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2679             20  PM-CAN-POST1              PIC XXX.
  2680             20  PM-CAN-POST2              PIC XXX.
  2681             20  FILLER                    PIC XXX.
  2682
  2683         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2684
  2685         16  FILLER                        PIC X(03).
  2686
  2687     12  PM-CRED-BENE-INFO.
  2688         16  PM-CRED-BENE-NAME             PIC X(25).
  2689         16  PM-CRED-BENE-ADDR             PIC X(30).
  2690         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2691         16  PM-CRED-BENE-CTYST.
  2692             20  PM-CRED-BENE-CITY         PIC X(28).
  2693             20  PM-CRED-BENE-STATE        PIC XX.
  2694         16  PM-CRED-BENE-ZIP.
  2695             20  PM-CB-ZIP-CODE.
  2696                 24  PM-CB-ZIP-1           PIC X.
  2697                     88  PM-CB-CANADIAN-POST-CODE
  2698                                  VALUE 'A' THRU 'Z'.
  2699                 24  FILLER                PIC X(4).
  2700             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2701         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2702             20  PM-CB-CAN-POST1           PIC XXX.
  2703             20  PM-CB-CAN-POST2           PIC XXX.
  2704             20  FILLER                    PIC XXX.
  2705     12  PM-POST-CARD-MAIL-DATA.
  2706         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  51
* EL050.cbl
  2707             20  PM-MAIL-TYPE              PIC X.
  2708                 88  PM-12MO-MAILING           VALUE '1'.
  2709                 88  PM-EXP-MAILING            VALUE '2'.
  2710             20  PM-MAIL-STATUS            PIC X.
  2711                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2712                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2713                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2714             20  PM-MAIL-DATE              PIC XX.
  2715     12  FILLER                            PIC XX.
  2716     12  FILLER                            PIC X(12).
  2717*    12  FILLER                            PIC X(30).
  2718
  2719******************************************************************
  2720*                                COPY ERCLOFC.
  2721******************************************************************
  2722*                                                                *
  2723*                                                                *
  2724*                            ERCLOFC                             *
  2725*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2726*                            VMOD=2.003                          *
  2727*                                                                *
  2728*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2729*                                                                *
  2730*   FILE TYPE = VSAM,KSDS                                        *
  2731*   RECORD SIZE = 670   RECFORM = FIX                            *
  2732*                                                                *
  2733*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2734*                                                                *
  2735*   LOG = YES                                                    *
  2736*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2737*                                                                *
  2738******************************************************************
  2739
  2740 01  LOAN-OFFICER-MASTER.
  2741     12  LO-RECORD-ID                PIC XX.
  2742         88  VALID-LO-ID                VALUE 'LO'.
  2743
  2744     12  LO-CONTROL-PRIMARY.
  2745         16  LO-COMPANY-CD           PIC X.
  2746         16  LO-CARRIER              PIC X.
  2747         16  LO-GROUPING.
  2748             20  LO-GROUPING-PREFIX  PIC XXX.
  2749             20  LO-GROUPING-PRIME   PIC XXX.
  2750         16  LO-STATE                PIC XX.
  2751         16  LO-ACCOUNT.
  2752             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2753             20  LO-ACCOUNT-PRIME    PIC X(6).
  2754         16  LO-OFFICER-CODE         PIC X(5).
  2755
  2756     12  LO-OFFICER-NAME             PIC X(30).
  2757
  2758     12  LO-LAST-MAINT-DT            PIC XX.
  2759     12  LO-LAST-USER                PIC X(4).
  2760     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2761
  2762     12  LO-COMP-CONTROL             PIC X.
  2763             88  LO-SHOW-COMP           VALUE 'Y'.
  2764             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  52
* EL050.cbl
  2765     12  LO-DETAIL-CONTROL           PIC X.
  2766             88  LO-PRINT-DETAIL        VALUE 'D'.
  2767             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2768
  2769     12  LO-SV-CARRIER               PIC X.
  2770     12  LO-SV-GROUPING              PIC X(6).
  2771     12  LO-SV-STATE                 PIC XX.
  2772
  2773     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2774     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2775
  2776     12  LO-OFFICER-INFO.
  2777         16  FILLER OCCURS 12 TIMES.
  2778             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2779             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2780             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2781             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2782             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2783             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2784             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2785             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2786     12  FILLER                      PIC X(198).
  2787******************************************************************
  2788*                                COPY ERCPDEF.
  2789******************************************************************
  2790*                                                                *
  2791*                                                                *
  2792*                            ERCPDEF.                            *
  2793*                                                                *
  2794*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2795*                                                                *
  2796*    FILE TYPE = VSAM,KSDS                                       *
  2797*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2798*                                                                *
  2799*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2800*                                                                *
  2801*    LOG = YES                                                   *
  2802*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2803******************************************************************
  2804*                   C H A N G E   L O G
  2805*
  2806* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2807*-----------------------------------------------------------------
  2808*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2809* EFFECTIVE    NUMBER
  2810*-----------------------------------------------------------------
  2811* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2812* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2813* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2814******************************************************************
  2815 01  PRODUCT-MASTER.
  2816    12  PD-RECORD-ID                 PIC X(02).
  2817        88  VALID-PD-ID                  VALUE 'PD'.
  2818    12  PD-CONTROL-PRIMARY.
  2819        16  PD-COMPANY-CD            PIC X.
  2820        16  PD-STATE                 PIC XX.
  2821        16  PD-PRODUCT-CD            PIC XXX.
  2822        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  53
* EL050.cbl
  2823        16  PD-BEN-TYPE              PIC X.
  2824        16  PD-BEN-CODE              PIC XX.
  2825        16  PD-PROD-EXP-DT           PIC XX.
  2826    12  FILLER                       PIC X(50).
  2827    12  PD-PRODUCT-DATA OCCURS 8.
  2828        16  PD-PROD-CODE             PIC X.
  2829            88  PD-PROD-LIFE           VALUE 'L'.
  2830            88  PD-PROD-PROP           VALUE 'P'.
  2831            88  PD-PROD-AH             VALUE 'A'.
  2832            88  PD-PROD-IU             VALUE 'I'.
  2833            88  PD-PROD-GAP            VALUE 'G'.
  2834            88  PD-PROD-FAML           VALUE 'F'.
  2835        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2836        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2837        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2838        16  PD-MAX-TERM              PIC S999        COMP-3.
  2839        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2840        16  FILLER                   PIC X.
  2841        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2842        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2843        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2844        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2845        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2846        16  PD-REC-CRIT-PERIOD       PIC 99.
  2847        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2848            20  PD-RECURRING-YN      PIC X.
  2849            20  FILLER               PIC X.
  2850        16  PD-RTW-MOS               PIC 99.
  2851        16  PD-MAX-EXTENSION         PIC 99.
  2852        16  pd-ben-pct               pic sv999 comp-3.
  2853*       16  FILLER                   PIC XX.
  2854    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2855    12  PD-TERM-LIMITS OCCURS 15.
  2856        16  PD-LOW-TERM              PIC S999        COMP-3.
  2857        16  PD-HI-TERM               PIC S999        COMP-3.
  2858*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2859    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2860        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2861        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2862    12  PD-EARN-FACTORS.
  2863        16  FILLER OCCURS 15.
  2864            20  FILLER OCCURS 15.
  2865                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2866    12  PD-PRODUCT-DESC              PIC X(80).
  2867    12  PD-TRUNCATED                 PIC X.
  2868    12  FILLER                       PIC X(59).
  2869    12  PD-MAINT-INFORMATION.
  2870        16  PD-LAST-MAINT-DT         PIC X(02).
  2871        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2872        16  PD-LAST-MAINT-BY         PIC X(04).
  2873*                                COPY ELCSTATE.
  2874******************************************************************
  2875*                                                                *
  2876*                                                                *
  2877*                            ELCSTATE.                           *
  2878*                                                                *
  2879*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2880*                                                                *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  54
* EL050.cbl
  2881*   FILE TYPE = VSAM,KSDS                                        *
  2882*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2883*                                                                *
  2884*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2885*       ALTERNATE INDEX = NONE                                   *
  2886*                                                                *
  2887*   LOG = YES                                                    *
  2888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2889******************************************************************
  2890*                   C H A N G E   L O G
  2891*
  2892* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2893*-----------------------------------------------------------------
  2894*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2895* EFFECTIVE    NUMBER
  2896*-----------------------------------------------------------------
  2897* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2898******************************************************************
  2899*
  2900 01  STATE-FILE.
  2901     12  SF-RECORD-ID                       PIC XX.
  2902         88  VALID-CF-ID                        VALUE 'SF'.
  2903     12  SF-CONTROL-PRIMARY.
  2904         16  SF-COMPANY-ID                  PIC XXX.
  2905         16  SF-CARRIER-CODE                PIC X.
  2906         16  SF-GROUPING                    PIC X(6).
  2907         16  SF-STATE-CODE                  PIC XX.
  2908         16  SF-EXPIRE-DATE                 PIC 9(8).
  2909****************************************************************
  2910*             STATE CONTROLS
  2911****************************************************************
  2912     12  SF-LAST-MAINT-DT                   PIC XX.
  2913     12  SF-LAST-MAINT-BY                   PIC X(4).
  2914     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2915     12  SF-STATE-RT-CONTROLS.
  2916         16  SF-ST-RT-CALC                  PIC X.
  2917     12  SF-ST-TAX-CONTROLS.
  2918         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2919         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2920         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2921     12  SF-ST-REFUND-OPTIONS.
  2922         16  SF-ST-RF-LR-CALC               PIC X.
  2923         16  SF-ST-RF-LL-CALC               PIC X.
  2924         16  SF-ST-RF-LN-CALC               PIC X.
  2925         16  SF-ST-RF-AH-CALC               PIC X.
  2926         16  SF-ST-RF-CP-CALC               PIC X.
  2927     12  SF-ST-UNEARN-PREM-OPTIONS.
  2928         16  SF-ST-LUEP-R78                 PIC X.
  2929         16  SF-ST-LUEP-PRO                 PIC X.
  2930         16  SF-ST-LUEP-ST                  PIC X.
  2931         16  SF-ST-LUEP-DOM                 PIC X.
  2932         16  SF-ST-AUEP-R78                 PIC X.
  2933         16  SF-ST-AUEP-PRO                 PIC X.
  2934         16  SF-ST-AUEP-ST                  PIC X.
  2935         16  SF-ST-AUEP-DOM                 PIC X.
  2936         16  SF-ST-CUEP-R78                 PIC X.
  2937         16  SF-ST-CUEP-PRO                 PIC X.
  2938         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  55
* EL050.cbl
  2939         16  SF-ST-CUEP-DOM                 PIC X.
  2940     12  SF-ST-EARN-PREM-OPTIONS.
  2941         16  SF-ST-LEP-R78                  PIC X.
  2942         16  SF-ST-LEP-PRO                  PIC X.
  2943         16  SF-ST-LEP-ST                   PIC X.
  2944         16  SF-ST-LEP-DOM                  PIC X.
  2945         16  SF-ST-AEP-R78                  PIC X.
  2946         16  SF-ST-AEP-PRO                  PIC X.
  2947         16  SF-ST-AEP-ST                   PIC X.
  2948         16  SF-ST-AEP-DOM                  PIC X.
  2949         16  SF-ST-CEP-R78                  PIC X.
  2950         16  SF-ST-CEP-PRO                  PIC X.
  2951         16  SF-ST-CEP-ST                   PIC X.
  2952         16  SF-ST-CEP-DOM                  PIC X.
  2953     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  56
* EL050.cbl
  2955*    COPY ELCCRTT.
  2956******************************************************************
  2957*                                                                *
  2958*                            ELCCRTT.                            *
  2959*                                                                *
  2960*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2961*                                                                *
  2962*   FILE TYPE = VSAM,KSDS                                        *
  2963*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2964*                                                                *
  2965*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2966*                                                                *
  2967*   LOG = YES                                                    *
  2968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2969******************************************************************
  2970*                   C H A N G E   L O G
  2971*
  2972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2973*-----------------------------------------------------------------
  2974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2975* EFFECTIVE    NUMBER
  2976*-----------------------------------------------------------------
  2977* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2978* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2979* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2980* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2981* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2982* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2983* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2984* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2985* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2986******************************************************************
  2987
  2988 01  CERTIFICATE-TRAILERS.
  2989     12  CS-RECORD-ID                      PIC XX.
  2990         88  VALID-CS-ID                      VALUE 'CS'.
  2991
  2992     12  CS-CONTROL-PRIMARY.
  2993         16  CS-COMPANY-CD                 PIC X.
  2994         16  CS-CARRIER                    PIC X.
  2995         16  CS-GROUPING                   PIC X(6).
  2996         16  CS-STATE                      PIC XX.
  2997         16  CS-ACCOUNT                    PIC X(10).
  2998         16  CS-CERT-EFF-DT                PIC XX.
  2999         16  CS-CERT-NO.
  3000             20  CS-CERT-PRIME             PIC X(10).
  3001             20  CS-CERT-SFX               PIC X.
  3002         16  CS-TRAILER-TYPE               PIC X.
  3003             88  COMM-TRLR           VALUE 'A'.
  3004             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3005             88  CERT-DATA-TRLR      VALUE 'C'.
  3006
  3007     12  CS-DATA-AREA                      PIC X(516).
  3008
  3009     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3010         16  CS-BANK-COMMISSION-AREA.
  3011             20  CS-BANK-COMMS       OCCURS 10.
  3012                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  57
* EL050.cbl
  3013                 24  CS-COM-TYP            PIC X.
  3014                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3015                 24  CS-RECALC-LV-INDIC    PIC X.
  3016                 24  FILLER                PIC X(10).
  3017         16  FILLER                        PIC X(256).
  3018
  3019     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3020****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3021         16  CS-MB-CLAIM-DATA OCCURS 24.
  3022             20  CS-CLAIM-NO               PIC X(7).
  3023             20  CS-CLAIM-TYPE             PIC X.
  3024                 88  CS-AH-CLM               VALUE 'A'.
  3025                 88  CS-IU-CLM               VALUE 'I'.
  3026                 88  CS-GP-CLM               VALUE 'G'.
  3027                 88  CS-LF-CLM               VALUE 'L'.
  3028                 88  CS-PR-CLM               VALUE 'P'.
  3029                 88  CS-FL-CLM               VALUE 'F'.
  3030             20  CS-INSURED-TYPE           PIC X.
  3031                 88  CS-PRIM-INSURED          VALUE 'P'.
  3032                 88  CS-CO-BORROWER           VALUE 'C'.
  3033             20  CS-BENEFIT-PERIOD         PIC 99.
  3034             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3035             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3036             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3037         16  FILLER                        PIC X(12).
  3038     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3039         16  CS-VIN-NUMBER                 PIC X(17).
  3040         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3041         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3042         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3043         16  cs-agent-name.
  3044             20  cs-agent-fname            pic x(20).
  3045             20  cs-agent-mi               pic x.
  3046             20  cs-agent-lname            pic x(25).
  3047         16  cs-license-no                 pic x(15).
  3048         16  cs-npn-number                 pic x(10).
  3049         16  cs-agent-edit-status          pic x.
  3050             88  cs-ae-refer-to-manager      value 'M'.
  3051             88  cs-ae-cover-sheet           value 'C'.
  3052             88  cs-ae-sig-form              value 'S'.
  3053             88  cs-ae-verified              value 'V'.
  3054             88  cs-unidentified-signature   value 'U'.
  3055             88  cs-cert-returned            value 'R'.
  3056             88  cs-accept-no-commission     value 'N'.
  3057         16  cs-year                       pic 9999.
  3058         16  cs-make                       pic x(20).
  3059         16  cs-model                      pic x(20).
  3060         16  cs-future                     pic x(20).
  3061         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3062         16  FILLER                        PIC X(356). *> was 420
  3063*        16  FILLER                        PIC X(496).
  3064*    COPY ELCCRTO.
  3065******************************************************************
  3066*                                                                *
  3067*                            ELCCRTO.                            *
  3068*                                                                *
  3069*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3070*                                                                *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  58
* EL050.cbl
  3071*   FILE TYPE = VSAM,KSDS                                        *
  3072*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3073*                                                                *
  3074*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3075*                                                                *
  3076*   LOG = YES                                                    *
  3077*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3078******************************************************************
  3079*                   C H A N G E   L O G
  3080*
  3081* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3082*-----------------------------------------------------------------
  3083*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3084* EFFECTIVE    NUMBER
  3085*-----------------------------------------------------------------
  3086* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3087* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3088* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3089* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3090* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3091******************************************************************
  3092 01  ORIGINAL-CERTIFICATE.
  3093     12  OC-RECORD-ID                      PIC XX.
  3094         88  VALID-OC-ID                      VALUE 'OC'.
  3095     12  OC-CONTROL-PRIMARY.
  3096         16  OC-COMPANY-CD                 PIC X.
  3097         16  OC-CARRIER                    PIC X.
  3098         16  OC-GROUPING                   PIC X(6).
  3099         16  OC-STATE                      PIC XX.
  3100         16  OC-ACCOUNT                    PIC X(10).
  3101         16  OC-CERT-EFF-DT                PIC XX.
  3102         16  OC-CERT-NO.
  3103             20  OC-CERT-PRIME             PIC X(10).
  3104             20  OC-CERT-SFX               PIC X.
  3105         16  OC-RECORD-TYPE                PIC X.
  3106         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3107     12  OC-LAST-MAINT-DT                  PIC XX.
  3108     12  OC-LAST-MAINT-BY                  PIC X(4).
  3109     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3110     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3111     12  FILLER                            PIC X(49).
  3112     12  OC-ORIG-REC.
  3113         16  OC-INS-LAST-NAME              PIC X(15).
  3114         16  OC-INS-FIRST-NAME             PIC X(10).
  3115         16  OC-INS-MIDDLE-INIT            PIC X.
  3116         16  OC-INS-AGE                    PIC S999     COMP-3.
  3117         16  OC-JNT-LAST-NAME              PIC X(15).
  3118         16  OC-JNT-FIRST-NAME             PIC X(10).
  3119         16  OC-JNT-MIDDLE-INIT            PIC X.
  3120         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3121         16  OC-LF-BENCD                   PIC XX.
  3122         16  OC-LF-TERM                    PIC S999      COMP-3.
  3123         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3124         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3125         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3126         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3127         16  OC-LF-EXP-DT                  PIC XX.
  3128         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  59
* EL050.cbl
  3129         16  OC-LF-CANCEL-DT               PIC XX.
  3130         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3131         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3132         16  OC-AH-BENCD                   PIC XX.
  3133         16  OC-AH-TERM                    PIC S999      COMP-3.
  3134         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3135         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3136         16  OC-AH-EXP-DT                  PIC XX.
  3137         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3138         16  OC-AH-CP                      PIC 99.
  3139         16  OC-AH-CANCEL-DT               PIC XX.
  3140         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3141         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3142         16  OC-CRED-BENE-NAME             PIC X(25).
  3143         16  OC-1ST-PMT-DT                 PIC XX.
  3144         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3145         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3146         16  OC-ISSUE-TRAN-IND             PIC X.
  3147         16  OC-CANCEL-TRAN-IND            PIC X.
  3148         16  FILLER                        PIC X(211).
  3149
  3150     12  FILLER                            PIC X(50).
  3151******************************************************************
  3152
  3153*    COPY ELCDATE.
  3154******************************************************************
  3155*                                                                *
  3156*                                                                *
  3157*                            ELCDATE.                            *
  3158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3159*                            VMOD=2.003
  3160*                                                                *
  3161*                                                                *
  3162*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3163*                 LENGTH = 200                                   *
  3164******************************************************************
  3165
  3166 01  DATE-CONVERSION-DATA.
  3167     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3168     12  DC-OPTION-CODE                PIC X.
  3169         88  BIN-TO-GREG                VALUE ' '.
  3170         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3171         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3172         88  YMD-GREG-TO-BIN            VALUE '3'.
  3173         88  MDY-GREG-TO-BIN            VALUE '4'.
  3174         88  JULIAN-TO-BIN              VALUE '5'.
  3175         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3176         88  FIND-CENTURY               VALUE '7'.
  3177         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3178         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3179         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3180         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3181         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3182         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3183         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3184         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3185         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3186         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  60
* EL050.cbl
  3187         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3188         88  BIN-3-TO-GREG              VALUE 'I'.
  3189         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3190         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3191         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3192         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3193         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3194         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3195         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3196         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3197         88  THREE-CHARACTER-BIN
  3198                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3199         88  GREGORIAN-TO-BIN
  3200                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3201         88  BIN-TO-GREGORIAN
  3202                  VALUES ' ' '1' 'I' '8' 'G'.
  3203         88  JULIAN-TO-BINARY
  3204                  VALUES '5' 'C' 'E' 'F'.
  3205     12  DC-ERROR-CODE                 PIC X.
  3206         88  NO-CONVERSION-ERROR        VALUE ' '.
  3207         88  DATE-CONVERSION-ERROR
  3208                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3209         88  DATE-IS-ZERO               VALUE '1'.
  3210         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3211         88  DATE-IS-INVALID            VALUE '3'.
  3212         88  DATE1-GREATER-DATE2        VALUE '4'.
  3213         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3214         88  DATE-INVALID-OPTION        VALUE '9'.
  3215         88  INVALID-CENTURY            VALUE 'A'.
  3216         88  ONLY-CENTURY               VALUE 'B'.
  3217         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3218         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3219     12  DC-END-OF-MONTH               PIC X.
  3220         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3221     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3222         88  USE-NORMAL-PROCESS         VALUE ' '.
  3223         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3224         88  ADJUST-UP-100-YRS          VALUE '2'.
  3225     12  FILLER                        PIC X.
  3226     12  DC-CONVERSION-DATES.
  3227         16  DC-BIN-DATE-1             PIC XX.
  3228         16  DC-BIN-DATE-2             PIC XX.
  3229         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3230         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3231                       DC-GREG-DATE-1-EDIT.
  3232             20  DC-EDIT1-MONTH        PIC 99.
  3233             20  SLASH1-1              PIC X.
  3234             20  DC-EDIT1-DAY          PIC 99.
  3235             20  SLASH1-2              PIC X.
  3236             20  DC-EDIT1-YEAR         PIC 99.
  3237         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3238         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3239                     DC-GREG-DATE-2-EDIT.
  3240             20  DC-EDIT2-MONTH        PIC 99.
  3241             20  SLASH2-1              PIC X.
  3242             20  DC-EDIT2-DAY          PIC 99.
  3243             20  SLASH2-2              PIC X.
  3244             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  61
* EL050.cbl
  3245         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3246         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3247                     DC-GREG-DATE-1-YMD.
  3248             20  DC-YMD-YEAR           PIC 99.
  3249             20  DC-YMD-MONTH          PIC 99.
  3250             20  DC-YMD-DAY            PIC 99.
  3251         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3252         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3253                      DC-GREG-DATE-1-MDY.
  3254             20  DC-MDY-MONTH          PIC 99.
  3255             20  DC-MDY-DAY            PIC 99.
  3256             20  DC-MDY-YEAR           PIC 99.
  3257         16  DC-GREG-DATE-1-ALPHA.
  3258             20  DC-ALPHA-MONTH        PIC X(10).
  3259             20  DC-ALPHA-DAY          PIC 99.
  3260             20  FILLER                PIC XX.
  3261             20  DC-ALPHA-CENTURY.
  3262                 24 DC-ALPHA-CEN-N     PIC 99.
  3263             20  DC-ALPHA-YEAR         PIC 99.
  3264         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3265         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3266         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3267         16  DC-JULIAN-DATE            PIC 9(05).
  3268         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3269                                       PIC 9(05).
  3270         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3271             20  DC-JULIAN-YEAR        PIC 99.
  3272             20  DC-JULIAN-DAYS        PIC 999.
  3273         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3274         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3275         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3276     12  DATE-CONVERSION-VARIBLES.
  3277         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3278         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3279             20  FILLER                PIC 9(3).
  3280             20  HOLD-CEN-1-CCYY.
  3281                 24  HOLD-CEN-1-CC     PIC 99.
  3282                 24  HOLD-CEN-1-YY     PIC 99.
  3283             20  HOLD-CEN-1-MO         PIC 99.
  3284             20  HOLD-CEN-1-DA         PIC 99.
  3285         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3286             20  HOLD-CEN-1-R-MO       PIC 99.
  3287             20  HOLD-CEN-1-R-DA       PIC 99.
  3288             20  HOLD-CEN-1-R-CCYY.
  3289                 24  HOLD-CEN-1-R-CC   PIC 99.
  3290                 24  HOLD-CEN-1-R-YY   PIC 99.
  3291             20  FILLER                PIC 9(3).
  3292         16  HOLD-CENTURY-1-X.
  3293             20  FILLER                PIC X(3)  VALUE SPACES.
  3294             20  HOLD-CEN-1-X-CCYY.
  3295                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3296                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3297             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3298             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3299         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3300             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3301             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3302             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  62
* EL050.cbl
  3303                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3304                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3305             20  FILLER                PIC XXX.
  3306         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3307         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3308         16  DC-JULIAN-DATE-1          PIC 9(07).
  3309         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3310             20  DC-JULIAN-1-CCYY.
  3311                 24  DC-JULIAN-1-CC    PIC 99.
  3312                 24  DC-JULIAN-1-YR    PIC 99.
  3313             20  DC-JULIAN-DA-1        PIC 999.
  3314         16  DC-JULIAN-DATE-2          PIC 9(07).
  3315         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3316             20  DC-JULIAN-2-CCYY.
  3317                 24  DC-JULIAN-2-CC    PIC 99.
  3318                 24  DC-JULIAN-2-YR    PIC 99.
  3319             20  DC-JULIAN-DA-2        PIC 999.
  3320         16  DC-GREG-DATE-A-EDIT.
  3321             20  DC-EDITA-MONTH        PIC 99.
  3322             20  SLASHA-1              PIC X VALUE '/'.
  3323             20  DC-EDITA-DAY          PIC 99.
  3324             20  SLASHA-2              PIC X VALUE '/'.
  3325             20  DC-EDITA-CCYY.
  3326                 24  DC-EDITA-CENT     PIC 99.
  3327                 24  DC-EDITA-YEAR     PIC 99.
  3328         16  DC-GREG-DATE-B-EDIT.
  3329             20  DC-EDITB-MONTH        PIC 99.
  3330             20  SLASHB-1              PIC X VALUE '/'.
  3331             20  DC-EDITB-DAY          PIC 99.
  3332             20  SLASHB-2              PIC X VALUE '/'.
  3333             20  DC-EDITB-CCYY.
  3334                 24  DC-EDITB-CENT     PIC 99.
  3335                 24  DC-EDITB-YEAR     PIC 99.
  3336         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3337         16  DC-GREG-DATE-CYMD-R REDEFINES
  3338                              DC-GREG-DATE-CYMD.
  3339             20  DC-CYMD-CEN           PIC 99.
  3340             20  DC-CYMD-YEAR          PIC 99.
  3341             20  DC-CYMD-MONTH         PIC 99.
  3342             20  DC-CYMD-DAY           PIC 99.
  3343         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3344         16  DC-GREG-DATE-MDCY-R REDEFINES
  3345                              DC-GREG-DATE-MDCY.
  3346             20  DC-MDCY-MONTH         PIC 99.
  3347             20  DC-MDCY-DAY           PIC 99.
  3348             20  DC-MDCY-CEN           PIC 99.
  3349             20  DC-MDCY-YEAR          PIC 99.
  3350    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3351        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3352    12  DC-EL310-DATE                  PIC X(21).
  3353    12  FILLER                         PIC X(28).
  3354
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  63
* EL050.cbl
  3356*    COPY ELCCALC.
  3357******************************************************************
  3358*                                                                *
  3359*                           ELCCALC.                            *
  3360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3361*                            VMOD=2.025                          *
  3362*                                                                *
  3363*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3364*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3365*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3366*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3367*                                                                *
  3368*  PASSED TO ELRTRM                                              *
  3369*  -----------------                                             *
  3370*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3371*  ORIGINAL TERM                                                 *
  3372*  BEGINNING DATE                                                *
  3373*  ENDING DATE                                                   *
  3374*  COMPANY I.D.                                                  *
  3375*  ACCOUNT MASTER USER FIELD                                     *
  3376*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3377*  FREE LOOK DAYS                                                *
  3378*                                                                *
  3379*  RETURNED FROM ELRTRM                                          *
  3380*  ---------------------                                         *
  3381*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3382*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3383*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3384*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3385*----------------------------------------------------------------*
  3386*  PASSED TO ELRAMT                                              *
  3387*  ----------------                                              *
  3388*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3389*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3390*  ORIGINAL AMOUNT                                               *
  3391*  ALTERNATE BENEFIT (BALLON)                                    *
  3392*  A.P.R. - NET PAY ONLY                                         *
  3393*  METHOD
  3394*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3395*  COMPANY I.D.                                                  *
  3396*  BENEFIT TYPE                                                  *
  3397*                                                                *
  3398*  RETURNED FROM ELRAMT                                          *
  3399*  --------------------                                          *
  3400*  REMAINING AMOUNT 1 - CURRENT                                  *
  3401*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3402*  REMAINING AMOUNT FACTOR
  3403*----------------------------------------------------------------*
  3404*  PASSED TO ELRESV                                              *
  3405*  -----------------                                             *
  3406*  CERTIFICATE EFFECTIVE DATE                                    *
  3407*  VALUATION DATE                                                *
  3408*  PAID THRU DATE                                                *
  3409*  BENEFIT                                                       *
  3410*  INCURRED DATE                                                 *
  3411*  REPORTED DATE                                                 *
  3412*  ISSUE AGE                                                     *
  3413*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  64
* EL050.cbl
  3414*  CDT PERCENT                                                   *
  3415*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3416* *CLAIM TYPE (LIFE, A/H)                                        *
  3417* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3418* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3419*                                                                *
  3420*  RETURNED FROM ELRESV                                          *
  3421*  --------------------                                          *
  3422*  CDT TABLE USED                                                *
  3423*  CDT FACTOR USED                                               *
  3424*  PAY TO CURRENT RESERVE                                        *
  3425*  I.B.N.R. - A/H ONLY                                           *
  3426*  FUTURE (ACCRUED) AH ONLY                                      *
  3427*----------------------------------------------------------------*
  3428*  PASSED TO ELRATE                                              *
  3429*  ----------------                                              *
  3430*  CERT ISSUE DATE                                               *
  3431*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3432*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3433*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3434*  STATE CODE (CLIENT DEFINED)                                   *
  3435*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3436*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3437*  DEVIATION CODE                                                *
  3438*  ISSUE AGE                                                     *
  3439*  ORIGINAL BENEFIT AMOUNT                                       *
  3440*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3441*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3442*  BENEFIT KIND (LIFE OR A/H)                                    *
  3443*  A.P.R.                                                        *
  3444*  METHOD
  3445*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3446*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3447*  COMPANY I.D. (3 CHARACTER)                                    *
  3448*  BENEFIT CODE                                                  *
  3449*  BENEFIT OVERRIDE CODE                                         *
  3450*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3451*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3452*  JOINT INDICATOR (CSL ONLY)                                    *
  3453*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3454*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3455*                                                                *
  3456*  RETURNED FROM ELRATE                                          *
  3457*  --------------------                                          *
  3458*  CALCULATED PREMIUM                                            *
  3459*  PREMIUM RATE                                                  *
  3460*  MORTALITY CODE                                                *
  3461*  MAX ATTAINED AGE                                              *
  3462*  MAX AGE                                                       *
  3463*  MAX TERM                                                      *
  3464*  MAX MONTHLY BENEFIT                                           *
  3465*  MAX TOTAL BENIFIT                                             *
  3466*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3467*----------------------------------------------------------------*
  3468*  PASSED TO ELRFND                                              *
  3469*  ----------------                                              *
  3470*  CERT ISSUE DATE                                               *
  3471*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  65
* EL050.cbl
  3472*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3473*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3474*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3475*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3476*  STATE CODE (CLIENT DEFINED)                                   *
  3477*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3478*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3479*  DEVIATION CODE                                                *
  3480*  ISSUE AGE                                                     *
  3481*  ORIGINAL BENEFIT AMOUNT                                       *
  3482*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3483*  PROCESS TYPE (CANCEL)                                         *
  3484*  BENEFIT KIND (LIFE OR A/H)                                    *
  3485*  A.P.R.                                                        *
  3486*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3487*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3488*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3489*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3490*  COMPANY I.D. (3 CHARACTER)                                    *
  3491*  BENEFIT CODE                                                  *
  3492*  BENEFIT OVERRIDE CODE                                         *
  3493*                                                                *
  3494*  RETURNED FROM ELRFND                                          *
  3495*  --------------------                                          *
  3496*  CALCULATED REFUND                                             *
  3497*----------------------------------------------------------------*
  3498*  PASSED TO ELEARN                                              *
  3499*  ----------------                                              *
  3500*  CERT ISSUE DATE                                               *
  3501*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3502*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3503*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3504*  STATE CODE (CLIENT DEFINED)                                   *
  3505*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3506*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3507*  DEVIATION CODE                                                *
  3508*  ISSUE AGE                                                     *
  3509*  ORIGINAL BENEFIT AMOUNT                                       *
  3510*  BENEFIT KIND (LIFE OR A/H)                                    *
  3511*  A.P.R.                                                        *
  3512*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3513*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3514*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3515*  COMPANY I.D. (3 CHARACTER)                                    *
  3516*  BENEFIT CODE                                                  *
  3517*  BENEFIT OVERRIDE CODE                                         *
  3518*                                                                *
  3519*  RETURNED FROM ELEARN                                          *
  3520*  --------------------                                          *
  3521*  INDICATED  EARNINGS                                           *
  3522*----------------------------------------------------------------*
  3523*                 LENGTH = 450                                   *
  3524*                                                                *
  3525******************************************************************
  3526******************************************************************
  3527*                   C H A N G E   L O G
  3528*
  3529* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  66
* EL050.cbl
  3530*-----------------------------------------------------------------
  3531*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3532* EFFECTIVE    NUMBER
  3533*-----------------------------------------------------------------
  3534* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3535* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3536* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3537* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3538* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3539* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3540* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3541* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3542* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3543* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3544* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3545******************************************************************
  3546
  3547 01  CALCULATION-PASS-AREA.
  3548     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3549                                     COMP.
  3550
  3551     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3552       88  NO-CP-ERROR                             VALUE ZERO.
  3553       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3554                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3555       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3556       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3557       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3558       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3559       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3560       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3561       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3562       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3563       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3564       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3565       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3566       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3567       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3568       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3569       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3570       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3571       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3572
  3573     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3574       88  NO-CP-ERROR-2                           VALUE ZERO.
  3575***********************  INPUT AREAS ****************************
  3576
  3577     12  CP-CALCULATION-AREA.
  3578         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3579         16  CP-CERT-EFF-DT        PIC XX.
  3580         16  CP-VALUATION-DT       PIC XX.
  3581         16  CP-PAID-THRU-DT       PIC XX.
  3582         16  CP-BENEFIT-TYPE       PIC X.
  3583           88  CP-AH                               VALUE 'A' 'D'
  3584                                                   'I' 'U'.
  3585           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3586           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3587         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  67
* EL050.cbl
  3588         16  CP-REPORTED-DT        PIC XX.
  3589         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3590         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3591         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-CDT-METHOD         PIC X.
  3596           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3597           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3598           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3599         16  CP-CLAIM-TYPE         PIC X.
  3600           88  CP-AH-CLAIM                         VALUE 'A'.
  3601           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3602         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3603                                     COMP-3.
  3604         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3605                                     COMP-3.
  3606         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3607                                     COMP-3.
  3608         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3609                                     COMP-3.
  3610         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3611                                     COMP-3.
  3612         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3613                                     COMP-3.
  3614         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3615                                     COMP-3.
  3616         16  CP-REM-TERM-METHOD    PIC X.
  3617           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3618           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3619           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3620           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3621           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3622           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3623           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3624         16  CP-EARNING-METHOD     PIC X.
  3625           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3626           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3627           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3628           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3629           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3630           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3631           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3632           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3633           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3634           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3635           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3636           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3637           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3638           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3639         16  CP-PROCESS-TYPE       PIC X.
  3640           88  CP-CLAIM                            VALUE '1'.
  3641           88  CP-CANCEL                           VALUE '2'.
  3642           88  CP-ISSUE                            VALUE '3'.
  3643         16  CP-SPECIAL-CALC-CD    PIC X.
  3644           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3645           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  68
* EL050.cbl
  3646           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3647           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3648           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3649           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3650           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3651           88  CP-FARM-PLAN                    VALUE 'F'.
  3652           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3653           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3654           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3655           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3656           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3657           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3658           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3659           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3660           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3661           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3662                                                     'W' 'X'.
  3663           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3664           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3665           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3666           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3667           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3668           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3669           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3670           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3671           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3672           88  CP-CSL-METH-1                   VALUE '5'.
  3673           88  CP-CSL-METH-2                   VALUE '6'.
  3674           88  CP-CSL-METH-3                   VALUE '7'.
  3675           88  CP-CSL-METH-4                   VALUE '8'.
  3676
  3677         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3680         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3681         16  CP-STATE              PIC XX          VALUE SPACE.
  3682         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3683         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3684           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3685               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3686         16  CP-R78-OPTION         PIC X.
  3687           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3688           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3689
  3690         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3691         16  CP-IBNR-RESERVE-SW    PIC X.
  3692         16  CP-CLAIM-STATUS       PIC X.
  3693         16  CP-RATE-FILE          PIC X.
  3694         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3695                                     COMP-3.
  3696
  3697         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3698         16  CP-AH-OVERRIDE-CODE   PIC X.
  3699
  3700         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3701                                     COMP-3.
  3702         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3703                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  69
* EL050.cbl
  3704         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3709                                     COMP-3.
  3710         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3711                                  PIC S9(7)V99 COMP-3.
  3712
  3713         16  CP-PAID-FROM-DATE     PIC X(02).
  3714         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3715         16  CP-EXT-DAYS-CALC      PIC X.
  3716           88  CP-EXT-NO-CHG                   VALUE ' '.
  3717           88  CP-EXT-CHG-LF                   VALUE '1'.
  3718           88  CP-EXT-CHG-AH                   VALUE '2'.
  3719           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3720         16  CP-DOMICILE-STATE     PIC XX.
  3721         16  CP-CARRIER            PIC X.
  3722         16  CP-REIN-FLAG          PIC X.
  3723         16  CP-REM-TRM-CALC-OPTION PIC X.
  3724           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3725                      '2' '3' '4' '5'.
  3726           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3727           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3728           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3729           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3730           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3731           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3732           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3733           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3734         16  CP-SIG-SWITCH         PIC X.
  3735         16  CP-RATING-METHOD      PIC X.
  3736           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3737           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3738           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3739           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3740           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3741           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3742           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3743           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3744           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3745         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3746                                     COMP-3.
  3747         16  CP-BEN-CATEGORY       PIC X.
  3748         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3749         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3750                                   PIC S99V9(5) COMP-3.
  3751         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3752         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3753                                   PIC S99V9(5) COMP-3.
  3754         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3755         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3756         16  CP-EXPIRE-DT          PIC XX.
  3757         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3758         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3759         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3760         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3761         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  70
* EL050.cbl
  3762             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3763             88  CP-CALC-CLP              VALUE 'C'.
  3764         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3765         16  CP-CANCEL-REASON      PIC X.
  3766         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3767         16  CP-PMT-MODE           PIC X.
  3768         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3769         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3770         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3771         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3772         16  FILLER                PIC X.
  3773
  3774***************    OUTPUT FROM ELRESV   ************************
  3775
  3776         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3777
  3778         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3783                                     COMP-3.
  3784         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3785                                     COMP-3.
  3786         16  FILLER                PIC X(09).
  3787***************    OUTPUT FROM ELRTRM   *************************
  3788
  3789         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3794                                     COMP-3.
  3795         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3796                                     COMP-3.
  3797         16  FILLER                PIC X(12).
  3798
  3799***************    OUTPUT FROM ELRAMT   *************************
  3800
  3801         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3804                                     COMP-3.
  3805         16  FILLER                PIC X(12).
  3806
  3807***************    OUTPUT FROM ELRATE   *************************
  3808
  3809         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-MORTALITY-CODE     PIC X(4).
  3814         16  CP-RATE-EDIT-FLAG     PIC X.
  3815             88  CP-RATES-NEED-APR                  VALUE '1'.
  3816         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3819         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  71
* EL050.cbl
  3820         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3821                                   PIC S9(7)V99 COMP-3.
  3822         16  FILLER                PIC X(07).
  3823
  3824***************    OUTPUT FROM ELRFND   *************************
  3825
  3826         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-REFUND-TYPE-USED   PIC X.
  3829           88  CP-R-AS-R78                         VALUE '1'.
  3830           88  CP-R-AS-PRORATA                     VALUE '2'.
  3831           88  CP-R-AS-CALIF                       VALUE '3'.
  3832           88  CP-R-AS-TEXAS                       VALUE '4'.
  3833           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3834           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3835           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3836           88  CP-R-AS-MEAN                        VALUE '8'.
  3837           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3838           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3839           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3840           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3841           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3842           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3843         16  FILLER                PIC X(12).
  3844
  3845***************    OUTPUT FROM ELEARN   *************************
  3846
  3847         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3848                                     COMP-3.
  3849         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3850                                     COMP-3.
  3851         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3852                                     COMP-3.
  3853         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3854                                     COMP-3.
  3855         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3858                                     COMP-3.
  3859         16  CP-EARNING-TYPE-USED  PIC X.
  3860           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3861           88  CP-E-AS-R78                         VALUE '1'.
  3862           88  CP-E-AS-PRORATA                     VALUE '2'.
  3863           88  CP-E-AS-TEXAS                       VALUE '4'.
  3864           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3865           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3866           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3867           88  CP-E-AS-MEAN                        VALUE '8'.
  3868           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3869         16  FILLER                PIC X(12).
  3870
  3871***************    OUTPUT FROM ELPMNT   *************************
  3872
  3873         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3876                                     COMP-3.
  3877         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  72
* EL050.cbl
  3878
  3879***************   MISC WORK AREAS    *****************************
  3880         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3881                                     COMP-3.
  3882         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3883                                     COMP-3.
  3884         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3885                                     COMP-3.
  3886         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3887                                     COMP-3.
  3888         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3889                                     COMP-3.
  3890         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3891                                     COMP-3.
  3892         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3893             88  OPEN-RATE-FILE                   VALUE 'O'.
  3894             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3895             88  IO-ERROR                         VALUE 'E'.
  3896
  3897         16  CP-FIRST-PAY-DATE     PIC XX.
  3898
  3899         16  CP-JOINT-INDICATOR    PIC X.
  3900
  3901         16  CP-RESERVE-REMAINING-TERM
  3902                                   PIC S9(4)V9    VALUE ZERO
  3903                                     COMP-3.
  3904
  3905         16  CP-INSURED-BIRTH-DT   PIC XX.
  3906
  3907         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3908                                     COMP-3.
  3909
  3910         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3911                                     COMP-3.
  3912
  3913         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3914                                     COMP-3.
  3915
  3916         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3917                                     COMP-3.
  3918
  3919         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3920                                     COMP-3.
  3921
  3922         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3923                                     COMP-3.
  3924
  3925         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3926                                     COMP-3.
  3927
  3928         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3929             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3930
  3931         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3932                                     COMP-3.
  3933         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3934                                     COMP-3.
  3935         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  73
* EL050.cbl
  3936         16  cp-extra-periods      pic 9 value zeros.
  3937         16  cp-net-only-state     pic x value spaces.
  3938         16  FILLER                PIC X(13).
  3939******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  74
* EL050.cbl
  3941******************************************************************
  3942*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3943*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3944*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3945*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3946*** MODIFICATION.                                              ***
  3947*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3948*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3949******************************************************************
  3950*    COPY ERCPNDB.
  3951******************************************************************
  3952*                                                                *
  3953*                                                                *
  3954*                            ERCPNDB.                            *
  3955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3956*                            VMOD=2.025                          *
  3957*                                                                *
  3958*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3959*                                                                *
  3960******************************************************************
  3961*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3962*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3963******************************************************************
  3964*                                                                *
  3965*                                                                *
  3966*   FILE TYPE = VSAM,KSDS                                        *
  3967*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3968*                                                                *
  3969*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3970*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3971*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3972*                                                 RKP=13,LEN=36  *
  3973*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3974*                                      AND CHG-SEQ.)             *
  3975*                                                RKP=49,LEN=11   *
  3976*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3977*                                      AND CHG-SEQ.)             *
  3978*                                                RKP=60,LEN=15   *
  3979*                                                                *
  3980*   LOG = NO                                                     *
  3981*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3982******************************************************************
  3983******************************************************************
  3984*                   C H A N G E   L O G
  3985*
  3986* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3987*-----------------------------------------------------------------
  3988*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3989* EFFECTIVE    NUMBER
  3990*-----------------------------------------------------------------
  3991* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3992* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3993* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3994* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3995* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3996* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3997* 032306                   PEMA  ADD BOW LOAN NUMBER
  3998* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  75
* EL050.cbl
  3999* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4000* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4001* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4002* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4003* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4004* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4005* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4006* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4007* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4008* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4009******************************************************************
  4010
  4011 01  PENDING-BUSINESS.
  4012     12  PB-RECORD-ID                     PIC XX.
  4013         88  VALID-PB-ID                        VALUE 'PB'.
  4014
  4015     12  PB-CONTROL-PRIMARY.
  4016         16  PB-COMPANY-CD                PIC X.
  4017         16  PB-ENTRY-BATCH               PIC X(6).
  4018         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4019         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4020
  4021     12  PB-CONTROL-BY-ACCOUNT.
  4022         16  PB-COMPANY-CD-A1             PIC X.
  4023         16  PB-CARRIER                   PIC X.
  4024         16  PB-GROUPING.
  4025             20  PB-GROUPING-PREFIX       PIC XXX.
  4026             20  PB-GROUPING-PRIME        PIC XXX.
  4027         16  PB-STATE                     PIC XX.
  4028         16  PB-ACCOUNT.
  4029             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4030             20  PB-ACCOUNT-PRIME         PIC X(6).
  4031         16  PB-CERT-EFF-DT               PIC XX.
  4032         16  PB-CERT-NO.
  4033             20  PB-CERT-PRIME            PIC X(10).
  4034             20  PB-CERT-SFX              PIC X.
  4035         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4036
  4037         16  PB-RECORD-TYPE               PIC X.
  4038             88  PB-MAILING-DATA                VALUE '0'.
  4039             88  PB-ISSUE                       VALUE '1'.
  4040             88  PB-CANCELLATION                VALUE '2'.
  4041             88  PB-BATCH-TRAILER               VALUE '9'.
  4042
  4043     12  PB-CONTROL-BY-ORIG-BATCH.
  4044         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4045         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4046         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4047         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4048
  4049     12  PB-CONTROL-BY-CSR.
  4050         16  PB-CSR-COMPANY-CD            PIC X.
  4051         16  PB-CSR-ID                    PIC X(4).
  4052         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4053         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4054         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4055******************************************************************
  4056*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  76
* EL050.cbl
  4057******************************************************************
  4058
  4059     12  PB-LAST-MAINT-DT                 PIC XX.
  4060     12  PB-LAST-MAINT-BY                 PIC X(4).
  4061     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4062
  4063     12  PB-RECORD-BODY                   PIC X(375).
  4064
  4065     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4066         16  PB-CERT-ORIGIN               PIC X.
  4067             88  CLASIC-CREATED-CERT         VALUE '1'.
  4068         16  PB-I-NAME.
  4069             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4070             20  PB-I-INSURED-FIRST-NAME.
  4071                 24  PB-I-INSURED-1ST-INIT PIC X.
  4072                 24  FILLER                PIC X(9).
  4073             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4074         16  PB-I-AGE                     PIC S99   COMP-3.
  4075         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4076         16  PB-I-BIRTHDAY                PIC XX.
  4077         16  PB-I-INSURED-SEX             PIC X.
  4078             88  PB-SEX-MALE     VALUE 'M'.
  4079             88  PB-SEX-FEMALE   VALUE 'F'.
  4080
  4081         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4082         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4083         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4084         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4085         16  PB-I-SKIP-CODE               PIC X.
  4086             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4087             88  PB-SKIP-JULY              VALUE '1'.
  4088             88  PB-SKIP-AUGUST            VALUE '2'.
  4089             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4090             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4091             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4092             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4093             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4094             88  PB-SKIP-JUNE              VALUE '8'.
  4095             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4096             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4097             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4098         16  PB-I-TERM-TYPE               PIC X.
  4099             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4100             88  PB-PAID-WEEKLY            VALUE 'W'.
  4101             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4102             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4103             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4104         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4105         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4106         16  PB-I-DATA-ENTRY-SW           PIC X.
  4107             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4108             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4109             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4110             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4111         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4112         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4113*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4114         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  77
* EL050.cbl
  4115         16  FILLER                       PIC X.
  4116
  4117         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4118             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4119             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4120                                                   '90' THRU '99'.
  4121         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4122                                          PIC XX.
  4123         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4124         16  PB-I-AMOUNT-FINANCED REDEFINES
  4125                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4126         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4127         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4128                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4129         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4130         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4131         16  PB-I-CLP-AMOUNT REDEFINES
  4132                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4133         16  PB-I-LF-CALC-FLAG            PIC X.
  4134             88 PB-COMP-LF-PREM               VALUE '?'.
  4135         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4136         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4137         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4138         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4139         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4140         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4141         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4142         16  PB-I-LF-ABBR                 PIC XXX.
  4143         16  PB-I-LF-INPUT-CD             PIC XX.
  4144
  4145         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4146             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4147             88  PB-INVALID-AH               VALUE '  ' '00'
  4148                                                   '90' THRU '99'.
  4149         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4150         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4151         16  PB-I-AH-CALC-FLAG            PIC X.
  4152             88 PB-COMP-AH-PREM                  VALUE '?'.
  4153         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4154         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4155         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4156         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4157         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4158         16  PB-I-AH-ABBR                 PIC XXX.
  4159         16  PB-I-AH-INPUT-CD             PIC XXX.
  4160
  4161         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4162         16  PB-I-REIN-TABLE              PIC XXX.
  4163         16  PB-I-BUSINESS-TYPE           PIC 99.
  4164         16  PB-I-INDV-GRP-CD             PIC X.
  4165         16  PB-I-MORT-CODE.
  4166             20  PB-I-TABLE               PIC X.
  4167             20  PB-I-INTEREST            PIC XX.
  4168             20  PB-I-MORT-TYP            PIC X.
  4169         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4170         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4171         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4172         16  PB-I-INDV-GRP-OVRD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  78
* EL050.cbl
  4173         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4174         16  PB-I-SIG-SW                  PIC X.
  4175             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4176         16  PB-I-RATE-CLASS              PIC XX.
  4177         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4178         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4179         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4180         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4181         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4182         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4183         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4184         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4185         16  PB-I-OB-FLAG                 PIC X.
  4186             88  PB-I-OB                      VALUE 'B'.
  4187             88  PB-I-SUMMARY                 VALUE 'Z'.
  4188         16  PB-I-ENTRY-STATUS            PIC X.
  4189             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4190                                              'M' '5' '9' '2'.
  4191             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4192             88  PB-I-POLICY-PENDING          VALUE '2'.
  4193             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4194             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4195             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4196             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4197             88  PB-I-REIN-ONLY               VALUE '9'.
  4198             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4199             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4200             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4201             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4202         16  PB-I-INT-CODE                PIC X.
  4203             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4204             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4205         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4206         16  PB-I-SOC-SEC-NO              PIC X(11).
  4207         16  PB-I-MEMBER-NO               PIC X(12).
  4208         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4209*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4210         16  PB-I-OLD-LOF                 PIC XXX.
  4211         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4212         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4213         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4214         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4215         16  PB-I-LIFE-INDICATOR          PIC X.
  4216             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4217         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4218         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4219                                          PIC S9(5)V99    COMP-3.
  4220         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4221             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4222             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4223         16  PB-I-1ST-PMT-DT              PIC XX.
  4224         16  PB-I-JOINT-INSURED.
  4225             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4226             20 PB-I-JOINT-FIRST-NAME.
  4227                24  PB-I-JOINT-FIRST-INIT PIC X.
  4228                24  FILLER                PIC X(9).
  4229             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4230*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  79
* EL050.cbl
  4231         16  PB-I-BENEFICIARY-NAME.
  4232             20  PB-I-BANK-NUMBER         PIC X(10).
  4233             20  FILLER                   PIC X(15).
  4234         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4235         16  PB-I-REFERENCE               PIC X(12).
  4236         16  FILLER REDEFINES PB-I-REFERENCE.
  4237             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4238             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4239             20  PB-I-CLP-STATE           PIC XX.
  4240         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4241             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4242             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4243             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4244         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4245         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4246         16  PB-I-RESIDENT-STATE          PIC XX.
  4247         16  PB-I-RATE-CODE               PIC X(4).
  4248         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4249         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4250         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4251         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4252         16  PB-I-BANK-NOCHRGB            PIC 99.
  4253         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4254         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4255
  4256     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4257         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4258             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4259         16  PB-C-CANCEL-ORIGIN           PIC X.
  4260             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4261         16  PB-C-LF-CANCEL-DT            PIC XX.
  4262         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4263         16  PB-C-LF-CALC-REQ             PIC X.
  4264             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4265         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4266         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4267         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4268             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4269         16  PB-C-AH-CANCEL-DT            PIC XX.
  4270         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4271         16  PB-C-AH-CALC-REQ             PIC X.
  4272             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4273         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4274         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4275         16  PB-C-LAST-NAME               PIC X(15).
  4276         16  PB-C-REFUND-SW               PIC X.
  4277             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4278             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4279         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4280         16  PB-C-PAYEE-CODE              PIC X(6).
  4281         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4282         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4283         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4284         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4285         16  PB-C-REFERENCE               PIC X(12).
  4286         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4287         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4288         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  80
* EL050.cbl
  4289         16  PB-C-CANCEL-REASON           PIC X.
  4290         16  PB-C-REF-INTERFACE-SW        PIC X.
  4291         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4292         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4293         16  FILLER                       PIC X(01).
  4294*        16  FILLER                       PIC X(18).
  4295         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4296*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4297         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4298         16  PB-CANCELED-CERT-DATA.
  4299             20  PB-CI-INSURED-NAME.
  4300                 24  PB-CI-LAST-NAME      PIC X(15).
  4301                 24  PB-CI-INITIALS       PIC XX.
  4302             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4303             20  PB-CI-INSURED-SEX        PIC X.
  4304             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4305             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4306             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4307             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4308             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4309             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4310             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4311             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4312             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4313             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4314             20  PB-CI-RATE-CLASS         PIC XX.
  4315             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4316             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4317             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4318             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4319             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4320             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4321             20  PB-CI-LF-ABBR            PIC X(3).
  4322             20  PB-CI-AH-ABBR            PIC X(3).
  4323             20  PB-CI-OB-FLAG            PIC X.
  4324                 88  PB-CI-OB                VALUE 'B'.
  4325             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4326                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4327                                           'M' '4' '5' '9' '2'.
  4328                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4329                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4330                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4331                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4332                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4333                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4334                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4335                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4336                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4337                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4338                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4339                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4340                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4341             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4342                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4343                                           'M' '4' '5' '9' '2'.
  4344                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4345                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4346                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  81
* EL050.cbl
  4347                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4348                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4349                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4350                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4351                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4352                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4353                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4354                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4355                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4356                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4357             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4358             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4359             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4360             20  PB-CI-MEMBER-NO          PIC X(12).
  4361             20  PB-CI-INT-CODE           PIC X.
  4362                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4363                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4364             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4365             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4366             20  PB-CI-COMP-EXCP-SW       PIC X.
  4367                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4368                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4369             20  PB-CI-ENTRY-STATUS       PIC X.
  4370             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4371             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4372             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4373             20  PB-CI-DEATH-DT           PIC XX.
  4374             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4375             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4376             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4377             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4378             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4379             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4380             20  PB-CI-ENTRY-DT              PIC XX.
  4381             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4382             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4383             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4384             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4385             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4386             20  PB-CI-OLD-LOF               PIC XXX.
  4387*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4388             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4389             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4390             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4391             20  PB-CI-INDV-GRP-CD           PIC X.
  4392             20  PB-CI-BENEFICIARY-NAME.
  4393                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4394                 24  FILLER                  PIC X(15).
  4395             20  PB-CI-NOTE-SW               PIC X.
  4396             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4397             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4398             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4399             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4400             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4401             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4402             20  PB-CI-FIRST-NAME            PIC X(10).
  4403             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4404
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  82
* EL050.cbl
  4405         16  FILLER                       PIC X(13).
  4406*032306  16  FILLER                       PIC X(27).
  4407*        16  FILLER                       PIC X(46).
  4408
  4409     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4410         16  FILLER                       PIC X(10).
  4411         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4412         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4413         16  PB-M-INSURED-MID-INIT        PIC X.
  4414         16  PB-M-INSURED-AGE             PIC 99.
  4415         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4416         16  PB-M-INSURED-SEX             PIC X.
  4417         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4418         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4419         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4420         16  PB-M-INSURED-CITY-STATE.
  4421             20  PB-M-INSURED-CITY        PIC X(28).
  4422             20  PB-M-INSURED-STATE       PIC XX.
  4423         16  PB-M-INSURED-ZIP-CODE.
  4424             20  PB-M-INSURED-ZIP-PRIME.
  4425                 24  PB-M-INSURED-ZIP-1   PIC X.
  4426                     88  PB-M-CANADIAN-POST-CODE
  4427                                             VALUE 'A' THRU 'Z'.
  4428                 24  FILLER               PIC X(4).
  4429             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4430         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4431                                        PB-M-INSURED-ZIP-CODE.
  4432             20  PM-M-INS-CAN-POST1       PIC XXX.
  4433             20  PM-M-INS-CAN-POST2       PIC XXX.
  4434             20  FILLER                   PIC XXX.
  4435         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4436         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4437         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4438         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4439         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4440         16  PB-M-CRED-BENE-CITYST.
  4441             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4442             20  PB-M-CRED-BENE-STATE     PIC XX.
  4443         16  FILLER                       PIC X(92).
  4444
  4445     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4446         16  FILLER                       PIC X(10).
  4447         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4448         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4449         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4450         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4451         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4452         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4453         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4454         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4455         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4456         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4457         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4458         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4459         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4460         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4461         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4462         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  83
* EL050.cbl
  4463         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4464         16  PB-ACCOUNT-NAME              PIC X(30).
  4465         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4466         16  PB-REFERENCE                 PIC X(12).
  4467         16  PB-B-RECEIVED-DT             PIC XX.
  4468         16  FILLER                       PIC X(234).
  4469
  4470     12  PB-RECORD-STATUS.
  4471         16  PB-CREDIT-SELECT-DT          PIC XX.
  4472         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4473         16  PB-BILLED-DT                 PIC XX.
  4474         16  PB-BILLING-STATUS            PIC X.
  4475             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4476             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4477             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4478         16  PB-RECORD-BILL               PIC X.
  4479             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4480             88  PB-RECORD-RETURNED           VALUE 'R'.
  4481             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4482             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4483             88  PB-OVERRIDE-AH               VALUE 'A'.
  4484             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4485         16  PB-BATCH-ENTRY               PIC X.
  4486             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4487             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4488             88  PB-REISSUED-CERT             VALUE 'E'.
  4489             88  PB-CASH-CERT                 VALUE 'C'.
  4490             88  PB-MONTHLY-CERT              VALUE 'M'.
  4491             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4492             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4493             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4494         16  PB-FORCE-CODE                PIC X.
  4495             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4496             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4497             88  PB-CANCEL-FORCE              VALUE '8'.
  4498             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4499             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4500             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4501             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4502             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4503             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4504             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4505             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4506         16  PB-FATAL-FLAG                PIC X.
  4507             88  PB-FATAL-ERRORS              VALUE 'X'.
  4508         16  PB-FORCE-ER-CD               PIC X.
  4509             88  PB-FORCE-ERRORS              VALUE 'F'.
  4510             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4511         16  PB-WARN-ER-CD                PIC X.
  4512             88  PB-WARNING-ERRORS            VALUE 'W'.
  4513         16  FILLER                       PIC X.
  4514         16  PB-OUT-BAL-CD                PIC X.
  4515             88  PB-OUT-OF-BAL                VALUE 'O'.
  4516         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4517         16  PB-AH-OVERRIDE-L1            PIC X.
  4518         16  PB-INPUT-DT                  PIC XX.
  4519         16  PB-INPUT-BY                  PIC X(4).
  4520         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  84
* EL050.cbl
  4521         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4522         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4523         16  PB-LF-EARNING-METHOD         PIC X.
  4524         16  PB-AH-EARNING-METHOD         PIC X.
  4525         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4526         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4527         16  PB-REIN-CD                   PIC XXX.
  4528         16  PB-LF-REFUND-TYPE            PIC X.
  4529         16  PB-AH-REFUND-TYPE            PIC X.
  4530         16  PB-ACCT-EFF-DT               PIC XX.
  4531         16  PB-ACCT-EXP-DT               PIC XX.
  4532         16  PB-COMPANY-ID                PIC X(3).
  4533         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4534         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4535         16  PB-SV-CARRIER                PIC X.
  4536         16  PB-SV-GROUPING               PIC X(6).
  4537         16  PB-SV-STATE                  PIC XX.
  4538         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4539         16  PB-GA-BILLING-INFO.
  4540             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4541                                          PIC XX.
  4542         16  PB-SV-REMIT-TO  REDEFINES
  4543             PB-GA-BILLING-INFO           PIC X(10).
  4544         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4545         16  PB-I-LOAN-OFFICER            PIC X(5).
  4546         16  PB-I-VIN                     PIC X(17).
  4547
  4548         16  FILLER                       PIC X(04).
  4549         16  IMNET-BYPASS-SW              PIC X.
  4550
  4551******************************************************************
  4552*                COMMON EDIT ERRORS                              *
  4553******************************************************************
  4554
  4555     12  PB-COMMON-ERRORS.
  4556         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4557                                           PIC S9(4)     COMP.
  4558
  4559******************************************************************
  4560
  4561* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4562*    COPY ELC50W1.
  4563******************************************************************
  4564*                                                                *
  4565*                                                                *
  4566*                             ELC50W1                            *
  4567*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4568*                            VMOD=2.004                          *
  4569*                                                                *
  4570*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4571*                                                                *
  4572*                                                                *
  4573******************************************************************
  4574
  4575     12  WK-WORK-AREA.
  4576         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4577         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4578         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  85
* EL050.cbl
  4579         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4580         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4581         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4582         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4583         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4584         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4585         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4586         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4587         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4588         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4589         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4590         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4591         16  WK-CREDIT-EDIT-CONTROLS.
  4592             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4593             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4594             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4595             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4596             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4597             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4598         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4599         16  WK-SAVE-REIN-DATA.
  4600             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4601             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4602             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4603         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4604             88  ENTRY-FROM-EL6311       VALUE '6'.
  4605         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4606         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4607     12  WK-RECORD-ADDRESSES.
  4608         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4609         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4610         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4611         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4612         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4613         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4614         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4615         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4616     12  WK-OVER-SHORT-AREA.
  4617         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4618         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4619         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4620             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4621         16  FILLER                   PIC X(5) VALUE SPACES.
  4622
  4623*    COPY ELCEDITC.
  4624******************************************************************
  4625*                                                                *
  4626*                                                                *
  4627*                            ELCEDITC                            *
  4628*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4629*                            VMOD=2.012                          *
  4630*                                                                *
  4631*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4632*                     EL6313, EL050 AND EL517.                   *
  4633*                                                                *
  4634******************************************************************
  4635******************************************************************
  4636*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  86
* EL050.cbl
  4637*
  4638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4639*-----------------------------------------------------------------
  4640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4641* EFFECTIVE    NUMBER
  4642*-----------------------------------------------------------------
  4643* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4644******************************************************************
  4645
  4646     12  EDIT-CRITERIA-DATA.
  4647         16  EC-CO-MONTH-END-DT       PIC XX.
  4648         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4649         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4650         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4651         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4652         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4653         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4654         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4655         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4656         16  EC-CO-REM-TERM-CALC      PIC X.
  4657               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4658               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4659               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4660               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4661
  4662         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4663               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4664               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4665               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4666               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4667               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4668               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4669               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4670               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4671               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4672               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4673
  4674         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4675               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4676               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4677               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4678               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4679               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4680               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4681               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4682               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4683
  4684         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4685                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4686                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4687
  4688         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4689                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4690                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4691                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4692                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4693                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4694                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  87
* EL050.cbl
  4695                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4696                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4697
  4698         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4699               88  EC-BR-REDUCING                   VALUE 'R'.
  4700               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4701
  4702         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4703         16  EC-BR-LF-DESC             PIC X(10).
  4704         16  EC-BR-AH-DESC             PIC X(10).
  4705         16  EC-BR-LF-COMMENT          PIC X(10).
  4706         16  EC-BR-AH-COMMENT          PIC X(10).
  4707
  4708         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4709               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4710               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4711               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4712               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4713
  4714         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4715               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4716               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4717               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4718               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4719
  4720         16  EC-BR-LF-REFUND-CALC      PIC X.
  4721                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4722                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4723                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4724                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4725                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4726                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4727                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4728
  4729         16  EC-BR-AH-REFUND-CALC      PIC X.
  4730                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4731                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4732                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4733                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4734                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4735                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4736                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4737                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4738
  4739         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4740                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4741                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4742                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4743
  4744         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4745                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4746                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4747                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4748
  4749         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4750         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4751         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4752         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  88
* EL050.cbl
  4753
  4754         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4755         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4756                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4757                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4758                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4759                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4760
  4761         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4762               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4763               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4764               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4765               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4766               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4767
  4768         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4769               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4770               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4771               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4772               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4773               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4774
  4775         16  EC-ST-LF-REFUND-CALC      PIC X.
  4776                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4777                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4778                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4779                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4780                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4781                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4782                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4783                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4784
  4785         16  EC-ST-AH-REFUND-CALC      PIC X.
  4786                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4787                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4788                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4789                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4790                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4791                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4792                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4793                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4794
  4795         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4796         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4797         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4798         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4799         16  EC-AM-EXPIRATION-DT       PIC XX.
  4800         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4801         16  EC-AM-CLASS-CD            PIC XX.
  4802         16  EC-AM-LF-DEVIATION        PIC XXX.
  4803         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4804         16  EC-AM-AH-DEVIATION        PIC XXX.
  4805         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4806         16  EC-AM-PHONE-NO            PIC X(10).
  4807
  4808         16  EC-AM-LF-REFUND-CALC      PIC X.
  4809                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4810                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  89
* EL050.cbl
  4811                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4812                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4813                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4814                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4815                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4816
  4817         16  EC-AM-AH-REFUND-CALC      PIC X.
  4818                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4819                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4820                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4821                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4822                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4823                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4824                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4825
  4826         16  EC-AM-BEN-I-G-CD          PIC X.
  4827                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4828                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4829                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4830
  4831         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4832         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4833         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4834         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4835         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4836         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4837         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4838         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4839         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4840
  4841         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4842         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4843         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4844         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4845         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4846         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4847         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4848         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4849         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4850         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4851         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4852         16  EC-RT-LF-NSP-ST           PIC XX.
  4853         16  EC-RT-AH-NSP-ST           PIC XX.
  4854         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4855         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4856
  4857         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4858             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4859                                             'M' '5' '9' '2'.
  4860             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4861             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4862             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4863             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4864             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4865             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4866             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4867             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4868             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  90
* EL050.cbl
  4869             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4870
  4871         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4872             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4873                                             'M' '5' '9' '2'.
  4874             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4875             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4876             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4877             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4878             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4879             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4880             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4881             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4882             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4883             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4884
  4885         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4886         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4887         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4888         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4889         16  EC-CM-DEATH-DT            PIC XX.
  4890
  4891*DMD CUSTOM CODING FIELDS BELOW
  4892*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4893         16  EC-BR-DMD-RATING-SW       PIC X.
  4894                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4895                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4896                 88  NO-DMD-RATING               VALUE 'N'.
  4897
  4898         16  EC-NEW-CERT               PIC X(11).
  4899         16  EC-NEW-STATE              PIC XX.
  4900         16  FILLER                    PIC X.
  4901*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4902         16  OVER-SHORT-EDIT-FIELDS.
  4903             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4904             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4905             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4906             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4907             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4908             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4909             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4910             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4911             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4912         16  FILLER                    PIC X(71).
  4913******************************************************************
  4914
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  91
* EL050.cbl
  4916*    COPY ELCDIFRD.
  4917******************************************************************
  4918*                                                                *
  4919*                                                                *
  4920*                            ELCDIFRD.                           *
  4921*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4922*                            VMOD=2.004                          *
  4923*                                                                *
  4924*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4925*                                                                *
  4926******************************************************************
  4927*
  4928  01  WS-DIFFERENCE-CALCULATION.
  4929        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4930        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4931        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4932        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4933        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4934        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4935        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4936        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4937        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4938        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4939        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4940
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  92
* EL050.cbl
  4942****************************************************************
  4943*
  4944* Copyright (c) 2007-2013 Dell Inc.
  4945* All rights reserved.
  4946*
  4947****************************************************************
  4948 01  DFHEIV.
  4949   02  DFHEIV0               PIC X(35).
  4950   02  DFHEIV1               PIC X(08).
  4951   02  DFHEIV2               PIC X(08).
  4952   02  DFHEIV3               PIC X(08).
  4953   02  DFHEIV4               PIC X(06).
  4954   02  DFHEIV5               PIC X(04).
  4955   02  DFHEIV6               PIC X(04).
  4956   02  DFHEIV7               PIC X(02).
  4957   02  DFHEIV8               PIC X(02).
  4958   02  DFHEIV9               PIC X(01).
  4959   02  DFHEIV10              PIC S9(7) COMP-3.
  4960   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4961   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4962   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4963   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4964   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4965   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4966   02  DFHEIV17              PIC X(04).
  4967   02  DFHEIV18              PIC X(04).
  4968   02  DFHEIV19              PIC X(04).
  4969   02  DFHEIV20              USAGE IS POINTER.
  4970   02  DFHEIV21              USAGE IS POINTER.
  4971   02  DFHEIV22              USAGE IS POINTER.
  4972   02  DFHEIV23              USAGE IS POINTER.
  4973   02  DFHEIV24              USAGE IS POINTER.
  4974   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4975   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4976   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4977   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4978   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4979   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4980   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4981   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4982   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4983   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4984   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4985   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4986   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4987   02  FILLER                PIC X(02).
  4988   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4989   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4990   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4991   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4992   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4993   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4994   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4995 LINKAGE  SECTION.
  4996*****************************************************************
  4997*                                                               *
  4998* Copyright (c) 2007-2013 Dell Inc.                             *
  4999* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  93
* EL050.cbl
  5000*                                                               *
  5001*****************************************************************
  5002 01  dfheiblk.
  5003     02  eibtime          pic s9(7) comp-3.
  5004     02  eibdate          pic s9(7) comp-3.
  5005     02  eibtrnid         pic x(4).
  5006     02  eibtaskn         pic s9(7) comp-3.
  5007     02  eibtrmid         pic x(4).
  5008     02  dfheigdi         pic s9(4) comp.
  5009     02  eibcposn         pic s9(4) comp.
  5010     02  eibcalen         pic s9(4) comp.
  5011     02  eibaid           pic x(1).
  5012     02  eibfiller1       pic x(1).
  5013     02  eibfn            pic x(2).
  5014     02  eibfiller2       pic x(2).
  5015     02  eibrcode         pic x(6).
  5016     02  eibfiller3       pic x(2).
  5017     02  eibds            pic x(8).
  5018     02  eibreqid         pic x(8).
  5019     02  eibrsrce         pic x(8).
  5020     02  eibsync          pic x(1).
  5021     02  eibfree          pic x(1).
  5022     02  eibrecv          pic x(1).
  5023     02  eibsend          pic x(1).
  5024     02  eibatt           pic x(1).
  5025     02  eibeoc           pic x(1).
  5026     02  eibfmh           pic x(1).
  5027     02  eibcompl         pic x(1).
  5028     02  eibsig           pic x(1).
  5029     02  eibconf          pic x(1).
  5030     02  eiberr           pic x(1).
  5031     02  eibrldbk         pic x(1).
  5032     02  eiberrcd         pic x(4).
  5033     02  eibsynrb         pic x(1).
  5034     02  eibnodat         pic x(1).
  5035     02  eibfiller5       pic x(2).
  5036     02  eibresp          pic s9(8) comp.
  5037     02  eibresp2         pic s9(8) comp.
  5038     02  dfheigdj         pic s9(4) comp.
  5039     02  dfheigdk         pic s9(4) comp.
  5040
  5041 01  DFHCOMMAREA                   PIC X(1036).
  5042
  5043*01 PARMLIST .
  5044*    02  FILLER                    PIC S9(8)   COMP.
  5045*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5046*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5047*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5048*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5049*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5050*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5051*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5052
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  94
* EL050.cbl
  5054*    COPY ELCCNTL.
  5055******************************************************************
  5056*                                                                *
  5057*                                                                *
  5058*                            ELCCNTL.                            *
  5059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5060*                            VMOD=2.059                          *
  5061*                                                                *
  5062*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5063*                                                                *
  5064*   FILE TYPE = VSAM,KSDS                                        *
  5065*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5066*                                                                *
  5067*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5068*       ALTERNATE INDEX = NONE                                   *
  5069*                                                                *
  5070*   LOG = YES                                                    *
  5071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5072******************************************************************
  5073*                   C H A N G E   L O G
  5074*
  5075* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5076*-----------------------------------------------------------------
  5077*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5078* EFFECTIVE    NUMBER
  5079*-----------------------------------------------------------------
  5080* 082503                   PEMA  ADD BENEFIT GROUP
  5081* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5082* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5083* 092705    2005050300006  PEMA  ADD SPP LEASES
  5084* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5085* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5086* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5087* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5088* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5089* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5090* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5091* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5092* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5093* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5094******************************************************************
  5095*
  5096 01  CONTROL-FILE.
  5097     12  CF-RECORD-ID                       PIC XX.
  5098         88  VALID-CF-ID                        VALUE 'CF'.
  5099
  5100     12  CF-CONTROL-PRIMARY.
  5101         16  CF-COMPANY-ID                  PIC XXX.
  5102         16  CF-RECORD-TYPE                 PIC X.
  5103             88  CF-COMPANY-MASTER              VALUE '1'.
  5104             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5105             88  CF-STATE-MASTER                VALUE '3'.
  5106             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5107             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5108             88  CF-CARRIER-MASTER              VALUE '6'.
  5109             88  CF-MORTALITY-MASTER            VALUE '7'.
  5110             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5111             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  95
* EL050.cbl
  5112             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5113             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5114             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5115             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5116             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5117             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5118             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5119             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5120             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5121         16  CF-ACCESS-CD-GENL              PIC X(4).
  5122         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5123             20  CF-PROCESSOR               PIC X(4).
  5124         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5125             20  CF-STATE-CODE              PIC XX.
  5126             20  FILLER                     PIC XX.
  5127         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5128             20  FILLER                     PIC XX.
  5129             20  CF-HI-BEN-IN-REC           PIC XX.
  5130         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5131             20  FILLER                     PIC XXX.
  5132             20  CF-CARRIER-CNTL            PIC X.
  5133         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5134             20  FILLER                     PIC XX.
  5135             20  CF-HI-TYPE-IN-REC          PIC 99.
  5136         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5137             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5138                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5139             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5140             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5141         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5142             20  FILLER                     PIC X.
  5143             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5144         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5145             20  FILLER                     PIC XX.
  5146             20  CF-MORTGAGE-PLAN           PIC XX.
  5147         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5148
  5149     12  CF-LAST-MAINT-DT                   PIC XX.
  5150     12  CF-LAST-MAINT-BY                   PIC X(4).
  5151     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5152
  5153     12  CF-RECORD-BODY                     PIC X(728).
  5154
  5155
  5156****************************************************************
  5157*             COMPANY MASTER RECORD                            *
  5158****************************************************************
  5159
  5160     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5161         16  CF-COMPANY-ADDRESS.
  5162             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5163             20  CF-CL-IN-CARE-OF           PIC X(30).
  5164             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5165             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5166             20  CF-CL-CITY-STATE           PIC X(30).
  5167             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5168             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5169         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  96
* EL050.cbl
  5170         16  CF-COMPANY-PASSWORD            PIC X(8).
  5171         16  CF-SECURITY-OPTION             PIC X.
  5172             88  ALL-SECURITY                   VALUE '1'.
  5173             88  COMPANY-VERIFY                 VALUE '2'.
  5174             88  PROCESSOR-VERIFY               VALUE '3'.
  5175             88  NO-SECURITY                    VALUE '4'.
  5176             88  ALL-BUT-TERM                   VALUE '5'.
  5177         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5178             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5179         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5180             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5181         16  CF-INFORCE-LOCATION            PIC X.
  5182             88  CERTS-ARE-ONLINE               VALUE '1'.
  5183             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5184             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5185         16  CF-LOWER-CASE-LETTERS          PIC X.
  5186         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5187             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5188             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5189             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5190             88  CF-ACCNT-CNTL                  VALUE '3'.
  5191             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5192
  5193         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5194         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5195
  5196         16  CF-LGX-CREDIT-USER             PIC X.
  5197             88  CO-IS-NOT-USER                 VALUE 'N'.
  5198             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5199
  5200         16 CF-CREDIT-CALC-CODES.
  5201             20  CF-CR-REM-TERM-CALC PIC X.
  5202               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5203               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5204               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5205               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5206               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5207               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5208               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5209             20  CF-CR-R78-METHOD           PIC X.
  5210               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5211               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5212
  5213         16  CF-CLAIM-CONTROL-COUNTS.
  5214             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5215                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5216
  5217             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5218                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5219
  5220             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5221                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5222
  5223             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5224                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5225
  5226         16  CF-CURRENT-MONTH-END           PIC XX.
  5227
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  97
* EL050.cbl
  5228         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5229             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5230             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5231             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5232             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5233                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5234                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5235             20  CF-CO-PREM-REJECT-SW       PIC X.
  5236                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5237                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5238             20  CF-CO-REF-REJECT-SW        PIC X.
  5239                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5240                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5241
  5242         16  CF-CO-REPORTING-DT             PIC XX.
  5243         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5244         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5245           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5246           88  CF-CO-MONTH-END                  VALUE '1'.
  5247
  5248         16  CF-LGX-CLAIM-USER              PIC X.
  5249             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5250             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5251
  5252         16  CF-CREDIT-EDIT-CONTROLS.
  5253             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5254             20  CF-MIN-AGE                 PIC 99.
  5255             20  CF-DEFAULT-AGE             PIC 99.
  5256             20  CF-MIN-TERM                PIC S999      COMP-3.
  5257             20  CF-MAX-TERM                PIC S999      COMP-3.
  5258             20  CF-DEFAULT-SEX             PIC X.
  5259             20  CF-JOINT-AGE-INPUT         PIC X.
  5260                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5261             20  CF-BIRTH-DATE-INPUT        PIC X.
  5262                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5263             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5264                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5265                 88  CF-ZERO-CARRIER            VALUE '1'.
  5266                 88  CF-ZERO-GROUPING           VALUE '2'.
  5267                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5268             20  CF-EDIT-SW                 PIC X.
  5269                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5270             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5271             20  CF-CR-PR-METHOD            PIC X.
  5272               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5273               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5274             20  FILLER                     PIC X.
  5275
  5276         16  CF-CREDIT-MISC-CONTROLS.
  5277             20  CF-REIN-TABLE-SW           PIC X.
  5278                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5279             20  CF-COMP-TABLE-SW           PIC X.
  5280                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5281             20  CF-EXPERIENCE-RETENTION-AGE
  5282                                            PIC S9        COMP-3.
  5283             20  CF-CONVERSION-DT           PIC XX.
  5284             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5285             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  98
* EL050.cbl
  5286                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5287                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5288
  5289             20  CF-CR-CHECK-NO-CONTROL.
  5290                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5291                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5292                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5293                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5294                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5295                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5296
  5297                 24  CF-CR-CHECK-COUNT       REDEFINES
  5298                     CF-CR-CHECK-COUNTER      PIC X(4).
  5299
  5300                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5301                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5302
  5303                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5304                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5305                 24  CF-MAIL-PROCESSING       PIC X.
  5306                     88  MAIL-PROCESSING          VALUE 'Y'.
  5307
  5308         16  CF-MISC-SYSTEM-CONTROL.
  5309             20  CF-SYSTEM-C                 PIC X.
  5310                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5311             20  CF-SYSTEM-D                 PIC X.
  5312                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5313             20  CF-SOC-SEC-NO-SW            PIC X.
  5314                 88  SOC-SEC-NO-USED             VALUE '1'.
  5315             20  CF-MEMBER-NO-SW             PIC X.
  5316                 88  MEMBER-NO-USED              VALUE '1'.
  5317             20  CF-TAX-ID-NUMBER            PIC X(11).
  5318             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5319             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5320                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5321                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5322                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5323                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5324             20  CF-SYSTEM-E                 PIC X.
  5325                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5326
  5327         16  CF-LGX-LIFE-USER               PIC X.
  5328             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5329             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5330
  5331         16  CF-CR-MONTH-END-DT             PIC XX.
  5332
  5333         16  CF-FILE-MAINT-DATES.
  5334             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5335                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5336             20  CF-LAST-BATCH       REDEFINES
  5337                 CF-LAST-BATCH-NO               PIC X(4).
  5338             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5339             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5340             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5341             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5342             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5343             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page  99
* EL050.cbl
  5344             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5345             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5346             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5347             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5348
  5349         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5350         16  FILLER                         PIC X.
  5351
  5352         16  CF-ALT-MORT-CODE               PIC X(4).
  5353         16  CF-MEMBER-CAPTION              PIC X(10).
  5354
  5355         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5356             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5357             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5358             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5359             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5360             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5361
  5362         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5363
  5364         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5365         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5366         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5367         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5368
  5369         16  CF-AH-OVERRIDE-L1              PIC X.
  5370         16  CF-AH-OVERRIDE-L2              PIC XX.
  5371         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5372         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5373
  5374         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5375         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5376
  5377         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5378         16  CF-AR-LAST-EL860-DT            PIC XX.
  5379         16  CF-MP-MONTH-END-DT             PIC XX.
  5380
  5381         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5382         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5383             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5384
  5385         16  CF-AR-MONTH-END-DT             PIC XX.
  5386
  5387         16  CF-CRDTCRD-USER                PIC X.
  5388             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5389             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5390
  5391         16  CF-CC-MONTH-END-DT             PIC XX.
  5392
  5393         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5394
  5395         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5396             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5397             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5398             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5399         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5400         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5401         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 100
* EL050.cbl
  5402         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5403             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5404             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5405         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5406         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5407         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5408             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5409         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5410
  5411         16  CF-CL-ZIP-CODE.
  5412             20  CF-CL-ZIP-PRIME.
  5413                 24  CF-CL-ZIP-1ST          PIC X.
  5414                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5415                 24  FILLER                 PIC X(4).
  5416             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5417         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5418             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5419             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5420             20  FILLER                     PIC XXX.
  5421
  5422         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5423         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5424         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5425         16  CF-CO-OPTION-START-DATE        PIC XX.
  5426         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5427           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5428                                                      '3' '4'.
  5429           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5430           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5431           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5432           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5433           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5434           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5435
  5436         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5437
  5438         16  CF-PAYMENT-APPROVAL-LEVELS.
  5439             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5440             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5441             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5442             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5443             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5444             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5445
  5446         16  CF-END-USER-REPORTING-USER     PIC X.
  5447             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5448             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5449
  5450         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5451             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5452             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5453
  5454         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5455
  5456         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5457         16  FILLER                         PIC X.
  5458
  5459         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 101
* EL050.cbl
  5460             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5461             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5462             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5463
  5464         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5465
  5466         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5467             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5468             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5469
  5470         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5471             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5472             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5473
  5474         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5475
  5476         16  CF-CO-ACH-ID-CODE              PIC  X.
  5477             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5478             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5479             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5480         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5481         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5482         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5483         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5484         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5485         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5486         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5487         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5488         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5489                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5490         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5491                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5492
  5493         16  CF-CO-OVER-SHORT.
  5494             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5495             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5496
  5497*         16  FILLER                         PIC X(102).
  5498         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5499             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5500             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5501
  5502         16  CF-AH-APPROVAL-DAYS.
  5503             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5504             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5505             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5506             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5507
  5508         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5509
  5510         16  CF-APPROV-LEV-5.
  5511             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5512             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5513             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5514
  5515         16  FILLER                         PIC X(68).
  5516****************************************************************
  5517*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 102
* EL050.cbl
  5518****************************************************************
  5519
  5520     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5521         16  CF-PROCESSOR-NAME              PIC X(30).
  5522         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5523         16  CF-PROCESSOR-TITLE             PIC X(26).
  5524         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5525                 88  MESSAGE-YES                VALUE 'Y'.
  5526                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5527
  5528*****************************************************
  5529****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5530****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5531****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5532****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5533*****************************************************
  5534
  5535         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5536             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5537             20  CF-APPLICATION-FORCE       PIC X.
  5538             20  CF-INDIVIDUAL-APP.
  5539                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5540                     28  CF-BROWSE-APP      PIC X.
  5541                     28  CF-UPDATE-APP      PIC X.
  5542
  5543         16  CF-CURRENT-TERM-ON             PIC X(4).
  5544         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5545             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5546             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5547             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5548             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5549             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5550             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5551             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5552         16  CF-PROCESSOR-CARRIER           PIC X.
  5553             88  NO-CARRIER-SECURITY            VALUE ' '.
  5554         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5555             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5556         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5557             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5558         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5559             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5560
  5561         16  CF-PROC-SYS-ACCESS-SW.
  5562             20  CF-PROC-CREDIT-CLAIMS-SW.
  5563                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5564                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5565                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5566                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5567             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5568                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5569                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5570             20  CF-PROC-LIFE-GNRLDGR-SW.
  5571                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5572                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5573                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5574                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5575             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 103
* EL050.cbl
  5576                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5577                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5578         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5579             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5580             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5581         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5582
  5583         16  CF-APPROVAL-LEVEL                  PIC X.
  5584             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5585             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5586             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5587             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5588             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5589
  5590         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5591
  5592         16  CF-LANGUAGE-TYPE                   PIC X.
  5593             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5594             88  CF-LANG-IS-FR                      VALUE 'F'.
  5595
  5596         16  CF-CSR-IND                         PIC X.
  5597         16  FILLER                             PIC X(239).
  5598
  5599****************************************************************
  5600*             PROCESSOR/REMINDERS RECORD                       *
  5601****************************************************************
  5602
  5603     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5604         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5605             20  CF-START-REMIND-DT         PIC XX.
  5606             20  CF-END-REMIND-DT           PIC XX.
  5607             20  CF-REMINDER-TEXT           PIC X(50).
  5608         16  FILLER                         PIC X(296).
  5609
  5610
  5611****************************************************************
  5612*             STATE MASTER RECORD                              *
  5613****************************************************************
  5614
  5615     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5616         16  CF-STATE-ABBREVIATION          PIC XX.
  5617         16  CF-STATE-NAME                  PIC X(25).
  5618         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5619         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5620             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5621             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5622             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5623             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5624                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5625                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5626             20  CF-ST-PREM-REJECT-SW       PIC X.
  5627                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5628                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5629             20  CF-ST-REF-REJECT-SW        PIC X.
  5630                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5631                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5632         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5633         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 104
* EL050.cbl
  5634         16  CF-ST-REFUND-RULES.
  5635             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5636             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5637             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5638         16  CF-ST-FST-PMT-EXTENSION.
  5639             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5640             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5641                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5642                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5643                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5644                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5645         16  CF-ST-STATE-CALL.
  5646             20  CF-ST-CALL-UNEARNED        PIC X.
  5647             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5648             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5649         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5650             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5651             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5652         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5653         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5654         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5655         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5656         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5657         16  FILLER                         PIC X.
  5658         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5659             20  CF-ST-BENEFIT-CD           PIC XX.
  5660             20  CF-ST-BENEFIT-KIND         PIC X.
  5661                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5662                 88  CF-ST-AH-KIND              VALUE 'A'.
  5663             20  CF-ST-REM-TERM-CALC        PIC X.
  5664                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5665                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5666                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5667                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5668                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5669                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5670                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5671                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5672
  5673             20  CF-ST-REFUND-CALC          PIC X.
  5674                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5675                 88  ST-REFD-BY-R78             VALUE '1'.
  5676                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5677                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5678                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5679                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5680                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5681                 88  ST-REFD-UTAH               VALUE '7'.
  5682                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5683                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5684                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5685
  5686             20  CF-ST-EARNING-CALC         PIC X.
  5687                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5688                 88  ST-EARN-BY-R78             VALUE '1'.
  5689                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5690                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5691                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 105
* EL050.cbl
  5692                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5693                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5694                 88  ST-EARN-MEAN               VALUE '8'.
  5695                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5696
  5697             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5698                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5699                 88  ST-OVRD-BY-R78             VALUE '1'.
  5700                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5701                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5702                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5703                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5704                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5705                 88  ST-OVRD-MEAN               VALUE '8'.
  5706                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5707             20  cf-st-extra-periods        pic 9.
  5708*            20  FILLER                     PIC X.
  5709
  5710         16  CF-ST-COMMISSION-CAPS.
  5711             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5712             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5713             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5714             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5715         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5716                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5717
  5718         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5719
  5720         16  CF-ST-STATUTORY-INTEREST.
  5721             20  CF-ST-STAT-DATE-FROM       PIC X.
  5722                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5723                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5724             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5725             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5726             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5727             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5728             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5729
  5730         16  CF-ST-OVER-SHORT.
  5731             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5732             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5733
  5734         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5735
  5736         16  CF-ST-RT-CALC                  PIC X.
  5737
  5738         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5739         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5740         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5741         16  CF-ST-RF-LR-CALC               PIC X.
  5742         16  CF-ST-RF-LL-CALC               PIC X.
  5743         16  CF-ST-RF-LN-CALC               PIC X.
  5744         16  CF-ST-RF-AH-CALC               PIC X.
  5745         16  CF-ST-RF-CP-CALC               PIC X.
  5746*        16  FILLER                         PIC X(206).
  5747*CIDMOD         16  FILLER                         PIC X(192).
  5748         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5749             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 106
* EL050.cbl
  5750         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5751         16  CF-ST-VFY-2ND-BENE             PIC X.
  5752         16  CF-ST-CAUSAL-STATE             PIC X.
  5753         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5754         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5755         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5756             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5757         16  CF-ST-NET-ONLY-STATE           PIC X.
  5758             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5759         16  FILLER                         PIC X(181).
  5760
  5761****************************************************************
  5762*             BENEFIT MASTER RECORD                            *
  5763****************************************************************
  5764
  5765     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5766         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5767             20  CF-BENEFIT-CODE            PIC XX.
  5768             20  CF-BENEFIT-NUMERIC  REDEFINES
  5769                 CF-BENEFIT-CODE            PIC XX.
  5770             20  CF-BENEFIT-ALPHA           PIC XXX.
  5771             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5772             20  CF-BENEFIT-COMMENT         PIC X(10).
  5773
  5774             20  CF-LF-COVERAGE-TYPE        PIC X.
  5775                 88  CF-REDUCING                VALUE 'R'.
  5776                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5777
  5778             20  CF-SPECIAL-CALC-CD         PIC X.
  5779                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5780                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5781                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5782                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5783                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5784                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5785                 88  CF-FARM-PLAN               VALUE 'F'.
  5786                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5787                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5788                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5789                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5790                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5791                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5792                 88  CF-PRUDENTIAL              VALUE 'P'.
  5793                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5794                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5795                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5796                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5797                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5798                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5799
  5800             20  CF-JOINT-INDICATOR         PIC X.
  5801                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5802
  5803*            20  FILLER                     PIC X(12).
  5804             20  cf-maximum-benefits        pic s999 comp-3.
  5805             20  FILLER                     PIC X(09).
  5806             20  CF-BENEFIT-CATEGORY        PIC X.
  5807             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 107
* EL050.cbl
  5808
  5809             20  CF-CO-REM-TERM-CALC        PIC X.
  5810                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5811                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5812                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5813                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5814                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5815
  5816             20  CF-CO-EARNINGS-CALC        PIC X.
  5817                 88  CO-EARN-BY-R78             VALUE '1'.
  5818                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5819                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5820                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5821                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5822                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5823                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5824                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5825
  5826             20  CF-CO-REFUND-CALC          PIC X.
  5827                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5828                 88  CO-REFD-BY-R78             VALUE '1'.
  5829                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5830                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5831                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5832                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5833                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5834                 88  CO-REFD-MEAN               VALUE '8'.
  5835                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5836                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5837                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5838
  5839             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5840                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5841                 88  CO-OVRD-BY-R78             VALUE '1'.
  5842                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5843                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5844                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5845                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5846                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5847                 88  CO-OVRD-MEAN               VALUE '8'.
  5848                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5849
  5850             20  CF-CO-BEN-I-G-CD           PIC X.
  5851                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5852                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5853                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5854
  5855         16  FILLER                         PIC X(304).
  5856
  5857
  5858****************************************************************
  5859*             CARRIER MASTER RECORD                            *
  5860****************************************************************
  5861
  5862     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5863         16  CF-ADDRESS-DATA.
  5864             20  CF-MAIL-TO-NAME            PIC X(30).
  5865             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 108
* EL050.cbl
  5866             20  CF-ADDRESS-LINE-1          PIC X(30).
  5867             20  CF-ADDRESS-LINE-2          PIC X(30).
  5868             20  CF-CITY-STATE              PIC X(30).
  5869             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5870             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5871
  5872         16  CF-CLAIM-NO-CONTROL.
  5873             20  CF-CLAIM-NO-METHOD         PIC X.
  5874                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5875                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5876                 88  CLAIM-NO-SEQ               VALUE '3'.
  5877                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5878             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5879                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5880                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5881                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5882
  5883         16  CF-CHECK-NO-CONTROL.
  5884             20  CF-CHECK-NO-METHOD         PIC X.
  5885                 88  CHECK-NO-MANUAL            VALUE '1'.
  5886                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5887                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5888                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5889             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5890                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5891
  5892         16  CF-DOMICILE-STATE              PIC XX.
  5893
  5894         16  CF-EXPENSE-CONTROLS.
  5895             20  CF-EXPENSE-METHOD          PIC X.
  5896                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5897                 88  DOLLARS-PER-PMT            VALUE '2'.
  5898                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5899                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5900             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5901             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5902
  5903         16  CF-CORRESPONDENCE-CONTROL.
  5904             20  CF-LETTER-RESEND-OPT       PIC X.
  5905                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5906                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5907             20  FILLER                     PIC X(4).
  5908
  5909         16  CF-RESERVE-CONTROLS.
  5910             20  CF-MANUAL-SW               PIC X.
  5911                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5912             20  CF-FUTURE-SW               PIC X.
  5913                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5914             20  CF-PTC-SW                  PIC X.
  5915                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5916             20  CF-IBNR-SW                 PIC X.
  5917                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5918             20  CF-PTC-LF-SW               PIC X.
  5919                 88  CF-LF-PTC-USED             VALUE '1'.
  5920             20  CF-CDT-ACCESS-METHOD       PIC X.
  5921                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5922                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5923                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 109
* EL050.cbl
  5924             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5925
  5926         16  CF-CLAIM-CALC-METHOD           PIC X.
  5927             88  360-PLUS-MONTHS                VALUE '1'.
  5928             88  365-PLUS-MONTHS                VALUE '2'.
  5929             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5930             88  360-DAILY                      VALUE '4'.
  5931             88  365-DAILY                      VALUE '5'.
  5932
  5933         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5934         16  FILLER                         PIC X(11).
  5935
  5936         16  CF-LIMIT-AMOUNTS.
  5937             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5938             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5939             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5940             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5941             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5942             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5943             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5944             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5945             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5946             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5947
  5948         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5949         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5950         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5951
  5952         16  CF-ZIP-CODE.
  5953             20  CF-ZIP-PRIME.
  5954                 24  CF-ZIP-1ST             PIC X.
  5955                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5956                 24  FILLER                 PIC X(4).
  5957             20  CF-ZIP-PLUS4               PIC X(4).
  5958         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5959             20  CF-CAN-POSTAL-1            PIC XXX.
  5960             20  CF-CAN-POSTAL-2            PIC XXX.
  5961             20  FILLER                     PIC XXX.
  5962
  5963         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5964         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5965         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5966
  5967         16  CF-RATING-SWITCH               PIC X.
  5968             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5969             88  CF-NO-RATING                   VALUE 'N'.
  5970
  5971         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5972
  5973         16  CF-CARRIER-OVER-SHORT.
  5974             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5975             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5976
  5977         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5978         16  CF-SECPAY-SWITCH               PIC X.
  5979             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5980             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5981         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 110
* EL050.cbl
  5982         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5983         16  FILLER                         PIC X(444).
  5984*        16  FILLER                         PIC X(452).
  5985
  5986
  5987****************************************************************
  5988*             MORTALITY MASTER RECORD                          *
  5989****************************************************************
  5990
  5991     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5992         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5993                                INDEXED BY CF-MORT-NDX.
  5994             20  CF-MORT-TABLE              PIC X(5).
  5995             20  CF-MORT-TABLE-TYPE         PIC X.
  5996                 88  CF-MORT-JOINT              VALUE 'J'.
  5997                 88  CF-MORT-SINGLE             VALUE 'S'.
  5998                 88  CF-MORT-COMBINED           VALUE 'C'.
  5999                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6000                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6001             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6002             20  CF-MORT-AGE-METHOD         PIC XX.
  6003                 88  CF-AGE-LAST                VALUE 'AL'.
  6004                 88  CF-AGE-NEAR                VALUE 'AN'.
  6005             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6006             20  CF-MORT-ADJUSTMENT-DIRECTION
  6007                                            PIC X.
  6008                 88  CF-MINUS                   VALUE '-'.
  6009                 88  CF-PLUS                    VALUE '+'.
  6010             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6011             20  CF-MORT-JOINT-CODE         PIC X.
  6012                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6013             20  CF-MORT-PC-Q               PIC X.
  6014                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6015             20  CF-MORT-TABLE-CODE         PIC X(4).
  6016             20  CF-MORT-COMMENTS           PIC X(15).
  6017             20  FILLER                     PIC X(14).
  6018
  6019         16  FILLER                         PIC X(251).
  6020
  6021
  6022****************************************************************
  6023*             BUSSINESS TYPE MASTER RECORD                     *
  6024****************************************************************
  6025
  6026     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6027* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6028* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6029* AND RECORD 05 IS TYPES 81-99
  6030         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6031             20  CF-BUSINESS-TITLE          PIC  X(19).
  6032             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6033                                            PIC S9V9(4) COMP-3.
  6034             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6035             20  FILLER                     PIC  X.
  6036         16  FILLER                         PIC  X(248).
  6037
  6038
  6039****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 111
* EL050.cbl
  6040*             TERMINAL MASTER RECORD                           *
  6041****************************************************************
  6042
  6043     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6044
  6045         16  CF-COMPANY-TERMINALS.
  6046             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6047                                  PIC X(4).
  6048         16  FILLER               PIC X(248).
  6049
  6050
  6051****************************************************************
  6052*             LIFE EDIT MASTER RECORD                          *
  6053****************************************************************
  6054
  6055     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6056         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6057             20  CF-LIFE-CODE-IN            PIC XX.
  6058             20  CF-LIFE-CODE-OUT           PIC XX.
  6059         16  FILLER                         PIC X(248).
  6060
  6061
  6062****************************************************************
  6063*             AH EDIT MASTER RECORD                            *
  6064****************************************************************
  6065
  6066     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6067         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6068             20  CF-AH-CODE-IN              PIC XXX.
  6069             20  CF-AH-CODE-OUT             PIC XX.
  6070         16  FILLER                         PIC X(248).
  6071
  6072
  6073****************************************************************
  6074*             CREDIBILITY TABLES                               *
  6075****************************************************************
  6076
  6077     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6078         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6079                             INDEXED BY CF-CRDB-NDX.
  6080             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6081             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6082             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6083         16  FILLER                         PIC  X(332).
  6084
  6085
  6086****************************************************************
  6087*             REPORT CUSTOMIZATION RECORD                      *
  6088****************************************************************
  6089
  6090     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6091         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6092             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6093             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6094             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6095**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6096****       A T-TRANSFER.                                   ****
  6097             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 112
* EL050.cbl
  6098
  6099         16  FILLER                         PIC XX.
  6100
  6101         16  CF-CARRIER-CNTL-OPT.
  6102             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6103                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6104                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6105             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6106                                            PIC X.
  6107         16  CF-GROUP-CNTL-OPT.
  6108             20  CF-GROUP-OPT-SEQ           PIC 9.
  6109                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6110                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6111             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6112                                            PIC X(6).
  6113         16  CF-STATE-CNTL-OPT.
  6114             20  CF-STATE-OPT-SEQ           PIC 9.
  6115                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6116                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6117             20  CF-STATE-SELECT OCCURS 3 TIMES
  6118                                            PIC XX.
  6119         16  CF-ACCOUNT-CNTL-OPT.
  6120             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6121                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6122                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6123             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-BUS-TYP-CNTL-OPT.
  6126             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6127                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6128                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6129             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6130                                            PIC XX.
  6131         16  CF-LF-TYP-CNTL-OPT.
  6132             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6133                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6134                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6135             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6136                                            PIC XX.
  6137         16  CF-AH-TYP-CNTL-OPT.
  6138             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6139                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6140                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6141             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6142                                            PIC XX.
  6143         16  CF-REPTCD1-CNTL-OPT.
  6144             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6145                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6146                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6147             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6148                                            PIC X(10).
  6149         16  CF-REPTCD2-CNTL-OPT.
  6150             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6151                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6152                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6153             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6154                                            PIC X(10).
  6155         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 113
* EL050.cbl
  6156             20  CF-USER1-OPT-SEQ           PIC 9.
  6157                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6158                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6159             20  CF-USER1-SELECT OCCURS 3 TIMES
  6160                                            PIC X(10).
  6161         16  CF-USER2-CNTL-OPT.
  6162             20  CF-USER2-OPT-SEQ           PIC 9.
  6163                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6164                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6165             20  CF-USER2-SELECT OCCURS 3 TIMES
  6166                                            PIC X(10).
  6167         16  CF-USER3-CNTL-OPT.
  6168             20  CF-USER3-OPT-SEQ           PIC 9.
  6169                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6170                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6171             20  CF-USER3-SELECT OCCURS 3 TIMES
  6172                                            PIC X(10).
  6173         16  CF-USER4-CNTL-OPT.
  6174             20  CF-USER4-OPT-SEQ           PIC 9.
  6175                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6176                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6177             20  CF-USER4-SELECT OCCURS 3 TIMES
  6178                                            PIC X(10).
  6179         16  CF-USER5-CNTL-OPT.
  6180             20  CF-USER5-OPT-SEQ           PIC 9.
  6181                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6182                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6183             20  CF-USER5-SELECT OCCURS 3 TIMES
  6184                                            PIC X(10).
  6185         16  CF-REINS-CNTL-OPT.
  6186             20  CF-REINS-OPT-SEQ           PIC 9.
  6187                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6188                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6189             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6190                 24  CF-REINS-PRIME         PIC XXX.
  6191                 24  CF-REINS-SUB           PIC XXX.
  6192
  6193         16  CF-AGENT-CNTL-OPT.
  6194             20  CF-AGENT-OPT-SEQ           PIC 9.
  6195                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6196                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6197             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6198                                            PIC X(10).
  6199
  6200         16  FILLER                         PIC X(43).
  6201
  6202         16  CF-LOSS-RATIO-SELECT.
  6203             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6204             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6205         16  CF-ENTRY-DATE-SELECT.
  6206             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6207             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6208         16  CF-EFFECTIVE-DATE-SELECT.
  6209             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6210             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6211
  6212         16  CF-EXCEPTION-LIST-IND          PIC X.
  6213             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 114
* EL050.cbl
  6214
  6215         16  FILLER                         PIC X(318).
  6216
  6217****************************************************************
  6218*                  EXCEPTION REPORTING RECORD                  *
  6219****************************************************************
  6220
  6221     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6222         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6223             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6224
  6225         16  CF-COMBINED-LIFE-AH-OPT.
  6226             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6227             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6228             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6229             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6230
  6231         16  CF-LIFE-OPT.
  6232             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6233             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6234             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6235             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6236             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6237             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6238             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6239             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6240             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6241             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6242
  6243         16  CF-AH-OPT.
  6244             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6245             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6246             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6247             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6248             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6249             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6250             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6251             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6252             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6253             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6254
  6255         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6256             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6257             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6258             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6259
  6260         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6261
  6262         16  FILLER                         PIC X(673).
  6263
  6264
  6265****************************************************************
  6266*             MORTGAGE SYSTEM PLAN RECORD                      *
  6267****************************************************************
  6268
  6269     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6270         16  CF-PLAN-TYPE                   PIC X.
  6271             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 115
* EL050.cbl
  6272             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6273             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6274         16  CF-PLAN-ABBREV                 PIC XXX.
  6275         16  CF-PLAN-DESCRIPT               PIC X(10).
  6276         16  CF-PLAN-NOTES                  PIC X(20).
  6277         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6278         16  CF-PLAN-UNDERWRITING.
  6279             20  CF-PLAN-TERM-DATA.
  6280                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6281                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6282             20  CF-PLAN-AGE-DATA.
  6283                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6284                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6285                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6286             20  CF-PLAN-BENEFIT-DATA.
  6287                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6288                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6289                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6290                                            PIC S9(7)V99  COMP-3.
  6291         16  CF-PLAN-POLICY-FORMS.
  6292             20  CF-POLICY-FORM             PIC X(12).
  6293             20  CF-MASTER-APPLICATION      PIC X(12).
  6294             20  CF-MASTER-POLICY           PIC X(12).
  6295         16  CF-PLAN-RATING.
  6296             20  CF-RATE-CODE               PIC X(5).
  6297             20  CF-SEX-RATING              PIC X.
  6298                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6299                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6300             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6301             20  CF-SUB-STD-TYPE            PIC X.
  6302                 88  CF-PCT-OF-PREM            VALUE '1'.
  6303                 88  CF-PCT-OF-BENE            VALUE '2'.
  6304         16  CF-PLAN-PREM-TOLERANCES.
  6305             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6306             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6307         16  CF-PLAN-PYMT-TOLERANCES.
  6308             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6309             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6310         16  CF-PLAN-MISC-DATA.
  6311             20  FILLER                     PIC X.
  6312             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6313             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6314         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6315         16  CF-PLAN-IND-GRP                PIC X.
  6316             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6317                                                     '1'.
  6318             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6319                                                     '2'.
  6320         16  CF-MIB-SEARCH-SW               PIC X.
  6321             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6322             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6323             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6324             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6325         16  CF-ALPHA-SEARCH-SW             PIC X.
  6326             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6327             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6328             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6329             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 116
* EL050.cbl
  6330             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6331             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6332             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6333             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6334             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6335             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6336                                                     'A' 'B' 'C'
  6337                                                     'X' 'Y' 'Z'.
  6338         16  CF-EFF-DT-RULE-SW              PIC X.
  6339             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6340             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6341             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6342             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6343             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6344         16  FILLER                         PIC X(4).
  6345         16  CF-HEALTH-QUESTIONS            PIC X.
  6346             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6347         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6348         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6349         16  CF-PLAN-SNGL-JNT               PIC X.
  6350             88  CF-COMBINED-PLAN              VALUE 'C'.
  6351             88  CF-JNT-PLAN                   VALUE 'J'.
  6352             88  CF-SNGL-PLAN                  VALUE 'S'.
  6353         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6354         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6355         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6356         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6357         16  CF-RERATE-CNTL                 PIC  X.
  6358             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6359             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6360             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6361             88  CF-AUTO-RECALC                 VALUE '4'.
  6362         16  CF-BENEFIT-TYPE                PIC  X.
  6363             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6364             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6365         16  CF-POLICY-FEE                  PIC S999V99
  6366                                                    COMP-3.
  6367         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6368         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6369         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6370         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6371         16  FILLER                         PIC  X(32).
  6372         16  CF-TERMINATION-FORM            PIC  X(04).
  6373         16  FILLER                         PIC  X(08).
  6374         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6375                                                       COMP-3.
  6376         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6377         16  CF-ISSUE-LETTER                PIC  X(4).
  6378         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6379         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6380             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6381             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6382         16  CF-MP-REFUND-CALC              PIC X.
  6383             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6384             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6385             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6386             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6387             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 117
* EL050.cbl
  6388             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6389             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6390             88  CF-MP-REFD-MEAN                VALUE '8'.
  6391         16  CF-ALT-RATE-CODE               PIC  X(5).
  6392
  6393
  6394         16  FILLER                         PIC X(498).
  6395****************************************************************
  6396*             MORTGAGE COMPANY MASTER RECORD                   *
  6397****************************************************************
  6398
  6399     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6400         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6401         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6402             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6403             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6404             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6405             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6406             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6407
  6408         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6409         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6410         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6411         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6412         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6413
  6414         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6415             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6416         16  CF-MP-RECON-USE-IND            PIC X(1).
  6417             88  CF-MP-USE-RECON             VALUE 'Y'.
  6418         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6419             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6420         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6421             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6422             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6423         16  FILLER                         PIC X(1).
  6424         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6425             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6426         16  CF-MORTG-MIB-VERSION           PIC X.
  6427             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6428             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6429             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6430         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6431             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6432                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6433             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6434                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6435             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6436                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6437             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6438                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6439             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6440                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6441             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6442                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6443         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6444         16  FILLER                         PIC X(7).
  6445         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 118
* EL050.cbl
  6446             20  CF-MORTG-MIB-COMM          PIC X(5).
  6447             20  CF-MORTG-MIB-TERM          PIC X(5).
  6448         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6449             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6450         16  FILLER                         PIC X(03).
  6451         16  CF-MP-CHECK-NO-CONTROL.
  6452             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6453                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6454                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6455                                                ' ' LOW-VALUES.
  6456                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6457                                               VALUE '3'.
  6458         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6459         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6460         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6461             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6462                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6463             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6464                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6465             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6466                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6467             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6468                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6469             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6470                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6471             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6472                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6473         16  CF-MORTG-BILLING-AREA.
  6474             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6475                                            PIC X.
  6476         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6477         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6478         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6479         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6480             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6481             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6482         16  FILLER                         PIC X.
  6483         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6484             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6485             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6486         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6487         16  FILLER                         PIC X(8).
  6488         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6489         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6490         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6491         16  CF-ACH-COMPANY-ID.
  6492             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6493                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6494                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6495                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6496             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6497         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6498             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6499         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6500             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6501             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6502         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6503         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 119
* EL050.cbl
  6504         16  FILLER                         PIC X(536).
  6505
  6506****************************************************************
  6507*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6508****************************************************************
  6509
  6510     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6511         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6512             20  CF-FEMALE-HEIGHT.
  6513                 24  CF-FEMALE-FT           PIC 99.
  6514                 24  CF-FEMALE-IN           PIC 99.
  6515             20  CF-FEMALE-MIN-WT           PIC 999.
  6516             20  CF-FEMALE-MAX-WT           PIC 999.
  6517         16  FILLER                         PIC X(428).
  6518
  6519     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6520         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6521             20  CF-MALE-HEIGHT.
  6522                 24  CF-MALE-FT             PIC 99.
  6523                 24  CF-MALE-IN             PIC 99.
  6524             20  CF-MALE-MIN-WT             PIC 999.
  6525             20  CF-MALE-MAX-WT             PIC 999.
  6526         16  FILLER                         PIC X(428).
  6527******************************************************************
  6528*             AUTOMATIC ACTIVITY RECORD                          *
  6529******************************************************************
  6530     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6531         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6532             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6533             20  CF-SYS-LETTER-ID           PIC X(04).
  6534             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6535             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6536             20  CF-SYS-RESET-SW            PIC X(01).
  6537             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6538             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6539
  6540         16  FILLER                         PIC X(50).
  6541
  6542         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6543             20  CF-USER-ACTIVE-SW          PIC X(01).
  6544             20  CF-USER-LETTER-ID          PIC X(04).
  6545             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6546             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6547             20  CF-USER-RESET-SW           PIC X(01).
  6548             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6549             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6550             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6551
  6552         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 120
* EL050.cbl
  6554*    COPY ERCACCT.
  6555******************************************************************
  6556*                                                                *
  6557*                                                                *
  6558*                            ERCACCT                             *
  6559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6560*                            VMOD=2.031                          *
  6561*                                                                *
  6562*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6563*                                                                *
  6564*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6565*   VSAM ACCOUNT MASTER FILES.                                   *
  6566*                                                                *
  6567*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6568*                                                                *
  6569*   FILE TYPE = VSAM,KSDS                                        *
  6570*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6571*                                                                *
  6572*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6573*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6574*                                                                *
  6575*   LOG = NO                                                     *
  6576*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6577*                                                                *
  6578*                                                                *
  6579******************************************************************
  6580*                   C H A N G E   L O G
  6581*
  6582* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6583*-----------------------------------------------------------------
  6584*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6585* EFFECTIVE    NUMBER
  6586*-----------------------------------------------------------------
  6587* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6588* 092705    2005050300006  PEMA  ADD SPP LEASES
  6589* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6590* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6591* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6592* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6593* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6594* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6595******************************************************************
  6596
  6597 01  ACCOUNT-MASTER.
  6598     12  AM-RECORD-ID                      PIC XX.
  6599         88  VALID-AM-ID                      VALUE 'AM'.
  6600
  6601     12  AM-CONTROL-PRIMARY.
  6602         16  AM-COMPANY-CD                 PIC X.
  6603         16  AM-MSTR-CNTRL.
  6604             20  AM-CONTROL-A.
  6605                 24  AM-CARRIER            PIC X.
  6606                 24  AM-GROUPING.
  6607                     28 AM-GROUPING-PREFIX PIC XXX.
  6608                     28 AM-GROUPING-PRIME  PIC XXX.
  6609                 24  AM-STATE              PIC XX.
  6610                 24  AM-ACCOUNT.
  6611                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 121
* EL050.cbl
  6612                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6613             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6614                                           PIC X(19).
  6615             20  AM-CNTRL-B.
  6616                 24  AM-EXPIRATION-DT      PIC XX.
  6617                 24  FILLER                PIC X(4).
  6618             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6619                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6620
  6621     12  AM-CONTROL-BY-VAR-GRP.
  6622         16  AM-COMPANY-CD-A1              PIC X.
  6623         16  AM-VG-CARRIER                 PIC X.
  6624         16  AM-VG-GROUPING                PIC X(6).
  6625         16  AM-VG-STATE                   PIC XX.
  6626         16  AM-VG-ACCOUNT                 PIC X(10).
  6627         16  AM-VG-DATE.
  6628             20  AM-VG-EXPIRATION-DT       PIC XX.
  6629             20  FILLER                    PIC X(4).
  6630         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6631                                           PIC 9(11)      COMP-3.
  6632     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6633         16  FILLER                        PIC X(10).
  6634         16  AM-VG-KEY3.
  6635             20  AM-VG3-ACCOUNT            PIC X(10).
  6636             20  AM-VG3-EXP-DT             PIC XX.
  6637         16  FILLER                        PIC X(4).
  6638     12  AM-MAINT-INFORMATION.
  6639         16  AM-LAST-MAINT-DT              PIC XX.
  6640         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6641         16  AM-LAST-MAINT-USER            PIC X(4).
  6642         16  FILLER                        PIC XX.
  6643
  6644     12  AM-EFFECTIVE-DT                   PIC XX.
  6645     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6646
  6647     12  AM-PREV-DATES  COMP-3.
  6648         16  AM-PREV-EXP-DT                PIC 9(11).
  6649         16  AM-PREV-EFF-DT                PIC 9(11).
  6650
  6651     12  AM-REPORT-CODE-1                  PIC X(10).
  6652     12  AM-REPORT-CODE-2                  PIC X(10).
  6653
  6654     12  AM-CITY-CODE                      PIC X(4).
  6655     12  AM-COUNTY-PARISH                  PIC X(6).
  6656
  6657     12  AM-NAME                           PIC X(30).
  6658     12  AM-PERSON                         PIC X(30).
  6659     12  AM-ADDRS                          PIC X(30).
  6660     12  AM-CITY.
  6661         16  AM-ADDR-CITY                  PIC X(28).
  6662         16  AM-ADDR-STATE                 PIC XX.
  6663     12  AM-ZIP.
  6664         16  AM-ZIP-PRIME.
  6665             20  AM-ZIP-PRI-1ST            PIC X.
  6666                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6667             20  FILLER                    PIC X(4).
  6668         16  AM-ZIP-PLUS4                  PIC X(4).
  6669     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 122
* EL050.cbl
  6670         16  AM-CAN-POSTAL-1               PIC XXX.
  6671         16  AM-CAN-POSTAL-2               PIC XXX.
  6672         16  FILLER                        PIC XXX.
  6673     12  AM-TEL-NO.
  6674         16  AM-AREA-CODE                  PIC 999.
  6675         16  AM-TEL-PRE                    PIC 999.
  6676         16  AM-TEL-NBR                    PIC 9(4).
  6677     12  AM-TEL-LOC                        PIC X.
  6678         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6679         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6680
  6681     12  AM-COMM-STRUCTURE.
  6682         16  AM-DEFN-1.
  6683             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6684                 24  AM-AGT.
  6685                     28  AM-AGT-PREFIX     PIC X(4).
  6686                     28  AM-AGT-PRIME      PIC X(6).
  6687                 24  AM-COM-TYP            PIC X.
  6688                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6689                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6690                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6691                 24  AM-RECALC-LV-INDIC    PIC X.
  6692                 24  AM-RETRO-LV-INDIC     PIC X.
  6693                 24  AM-GL-CODES           PIC X.
  6694                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6695                 24  FILLER                PIC X(01).
  6696         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6697             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6698                 24  FILLER                PIC X(11).
  6699                 24  AM-L-COMA             PIC XXX.
  6700                 24  AM-J-COMA             PIC XXX.
  6701                 24  AM-A-COMA             PIC XXX.
  6702                 24  FILLER                PIC X(6).
  6703
  6704     12  AM-COMM-CHANGE-STATUS             PIC X.
  6705         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6706
  6707     12  AM-CSR-CODE                       PIC X(4).
  6708
  6709     12  AM-BILLING-STATUS                 PIC X.
  6710         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6711         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6712     12  AM-AUTO-REFUND-SW                 PIC X.
  6713         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6714         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6715     12  AM-GPCD                           PIC 99.
  6716     12  AM-IG                             PIC X.
  6717         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6718         88  AM-HAS-GROUP                     VALUE '2'.
  6719     12  AM-STATUS                         PIC X.
  6720         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6721         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6722         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6723         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6724         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6725         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6726         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6727         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 123
* EL050.cbl
  6728         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6729         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6730     12  AM-REMIT-TO                       PIC 99.
  6731     12  AM-ID-NO                          PIC X(11).
  6732
  6733     12  AM-CAL-TABLE                      PIC XX.
  6734     12  AM-LF-DEVIATION                   PIC XXX.
  6735     12  AM-AH-DEVIATION                   PIC XXX.
  6736     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6737     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6738     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6739     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6740     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6741     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6742
  6743     12  AM-USER-FIELDS.
  6744         16  AM-FLD-1                      PIC XX.
  6745         16  AM-FLD-2                      PIC XX.
  6746         16  AM-FLD-3                      PIC XX.
  6747         16  AM-FLD-4                      PIC XX.
  6748         16  AM-FLD-5                      PIC XX.
  6749
  6750     12  AM-1ST-PROD-DATE.
  6751         16  AM-1ST-PROD-YR                PIC XX.
  6752         16  AM-1ST-PROD-MO                PIC XX.
  6753         16  AM-1ST-PROD-DA                PIC XX.
  6754     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6755     12  AM-CERTS-PURGED-DATE.
  6756         16  AM-PUR-YR                     PIC XX.
  6757         16  AM-PUR-MO                     PIC XX.
  6758         16  AM-PUR-DA                     PIC XX.
  6759     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6760     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6761     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6762     12  AM-INACTIVE-DATE.
  6763         16  AM-INA-MO                     PIC 99.
  6764         16  AM-INA-DA                     PIC 99.
  6765         16  AM-INA-YR                     PIC 99.
  6766     12  AM-AR-HI-CERT-DATE                PIC XX.
  6767
  6768     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6769     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6770
  6771     12  AM-OB-PAYMENT-MODE                PIC X.
  6772         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6773         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6774         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6775         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6776
  6777     12  AM-AH-ONLY-INDICATOR              PIC X.
  6778         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6779         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6780
  6781     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6782
  6783     12  AM-OVER-SHORT.
  6784         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6785         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 124
* EL050.cbl
  6786
  6787     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6788     12  AM-DCC-CLP-STATE                  PIC XX.
  6789
  6790     12  AM-RECALC-COMM                    PIC X.
  6791     12  AM-RECALC-REIN                    PIC X.
  6792
  6793     12  AM-REI-TABLE                      PIC XXX.
  6794     12  AM-REI-ET-LF                      PIC X.
  6795     12  AM-REI-ET-AH                      PIC X.
  6796     12  AM-REI-PE-LF                      PIC X.
  6797     12  AM-REI-PE-AH                      PIC X.
  6798     12  AM-REI-PRT-ST                     PIC X.
  6799     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6800     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6801     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6802     12  AM-REI-GROUP-A                    PIC X(6).
  6803     12  AM-REI-MORT                       PIC X(4).
  6804     12  AM-REI-PRT-OW                     PIC X.
  6805     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6806     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6807     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6808     12  AM-REI-GROUP-B                    PIC X(6).
  6809
  6810     12  AM-TRUST-TYPE                     PIC X(2).
  6811
  6812     12  AM-EMPLOYER-STMT-USED             PIC X.
  6813     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6814
  6815     12  AM-STD-AH-TYPE                    PIC XX.
  6816     12  AM-EARN-METHODS.
  6817         16  AM-EARN-METHOD-R              PIC X.
  6818             88 AM-REF-RL-R78                 VALUE 'R'.
  6819             88 AM-REF-RL-PR                  VALUE 'P'.
  6820             88 AM-REF-RL-MEAN                VALUE 'M'.
  6821             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6822         16  AM-EARN-METHOD-L              PIC X.
  6823             88 AM-REF-LL-R78                 VALUE 'R'.
  6824             88 AM-REF-LL-PR                  VALUE 'P'.
  6825             88 AM-REF-LL-MEAN                VALUE 'M'.
  6826             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6827         16  AM-EARN-METHOD-A              PIC X.
  6828             88 AM-REF-AH-R78                 VALUE 'R'.
  6829             88 AM-REF-AH-PR                  VALUE 'P'.
  6830             88 AM-REF-AH-MEAN                VALUE 'M'.
  6831             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6832             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6833             88 AM-REF-AH-NET                 VALUE 'N'.
  6834
  6835     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6836     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6837     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6838
  6839     12  AM-RET-Y-N                        PIC X.
  6840     12  AM-RET-P-E                        PIC X.
  6841     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6842     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6843     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 125
* EL050.cbl
  6844     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6845         16  AM-POOL-PRIME                 PIC XXX.
  6846         16  AM-POOL-SUB                   PIC XXX.
  6847     12  AM-RETRO-EARNINGS.
  6848         16  AM-RET-EARN-R                 PIC X.
  6849         16  AM-RET-EARN-L                 PIC X.
  6850         16  AM-RET-EARN-A                 PIC X.
  6851     12  AM-RET-ST-TAX-USE                 PIC X.
  6852         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6853         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6854     12  AM-RETRO-BEG-EARNINGS.
  6855         16  AM-RET-BEG-EARN-R             PIC X.
  6856         16  AM-RET-BEG-EARN-L             PIC X.
  6857         16  AM-RET-BEG-EARN-A             PIC X.
  6858     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6859     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6860
  6861     12  AM-USER-SELECT-OPTIONS.
  6862         16  AM-USER-SELECT-1              PIC X(10).
  6863         16  AM-USER-SELECT-2              PIC X(10).
  6864         16  AM-USER-SELECT-3              PIC X(10).
  6865         16  AM-USER-SELECT-4              PIC X(10).
  6866         16  AM-USER-SELECT-5              PIC X(10).
  6867
  6868     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6869
  6870     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6871
  6872     12  AM-RPT045A-SWITCH                 PIC X.
  6873         88  RPT045A-OFF                   VALUE 'N'.
  6874
  6875     12  AM-INSURANCE-LIMITS.
  6876         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6877         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6878
  6879     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6880         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6881
  6882     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6883         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6884         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6885
  6886     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6887
  6888     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6889     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6890     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6891     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6892     12  AM-DCC-UEF-STATE                  PIC XX.
  6893     12  FILLER                            PIC XXX.
  6894     12  AM-REPORT-CODE-3                  PIC X(10).
  6895*    12  FILLER                            PIC X(22).
  6896
  6897     12  AM-RESERVE-DATE.
  6898         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6899         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6900         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6901
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 126
* EL050.cbl
  6902     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6903     12  AM-NOTIFICATION-TYPES.
  6904         16  AM-NOTIF-OF-LETTERS           PIC X.
  6905         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6906         16  AM-NOTIF-OF-REPORTS           PIC X.
  6907         16  AM-NOTIF-OF-STATUS            PIC X.
  6908
  6909     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6910         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6911         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6912         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6913         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6914
  6915     12  AM-BENEFIT-CONTROLS.
  6916         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6917             20  AM-BENEFIT-CODE           PIC XX.
  6918             20  AM-BENEFIT-TYPE           PIC X.
  6919             20  AM-BENEFIT-REVISION       PIC XXX.
  6920             20  AM-BENEFIT-REM-TERM       PIC X.
  6921             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6922             20  FILLER                    PIC XX.
  6923         16  FILLER                        PIC X(80).
  6924
  6925     12  AM-TRANSFER-DATA.
  6926         16  AM-TRANSFERRED-FROM.
  6927             20  AM-TRNFROM-CARRIER        PIC X.
  6928             20  AM-TRNFROM-GROUPING.
  6929                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6930                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6931             20  AM-TRNFROM-STATE          PIC XX.
  6932             20  AM-TRNFROM-ACCOUNT.
  6933                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6934                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6935             20  AM-TRNFROM-DTE            PIC XX.
  6936         16  AM-TRANSFERRED-TO.
  6937             20  AM-TRNTO-CARRIER          PIC X.
  6938             20  AM-TRNTO-GROUPING.
  6939                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6940                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6941             20  AM-TRNTO-STATE            PIC XX.
  6942             20  AM-TRNTO-ACCOUNT.
  6943                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6944                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6945             20  AM-TRNTO-DTE              PIC XX.
  6946         16  FILLER                        PIC X(10).
  6947
  6948     12  AM-SAVED-REMIT-TO                 PIC 99.
  6949
  6950     12  AM-COMM-STRUCTURE-SAVED.
  6951         16  AM-DEFN-1-SAVED.
  6952             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6953                 24  AM-AGT-SV             PIC X(10).
  6954                 24  AM-COM-TYP-SV         PIC X.
  6955                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6956                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6957                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6958                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6959                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 127
* EL050.cbl
  6960                 24  AM-GL-CODES-SV        PIC X.
  6961                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6962                 24  FILLER                PIC X.
  6963         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6964             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6965                 24  FILLER                PIC X(11).
  6966                 24  AM-L-COMA-SV          PIC XXX.
  6967                 24  AM-J-COMA-SV          PIC XXX.
  6968                 24  AM-A-COMA-SV          PIC XXX.
  6969                 24  FILLER                PIC X(6).
  6970
  6971     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6972         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6973            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6974            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6975            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6976
  6977     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6978     12  FILLER                            PIC X(120).
  6979
  6980     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6981         16  AM-CONTROL-NAME               PIC X(30).
  6982         16  AM-EXECUTIVE-ONE.
  6983             20  AM-EXEC1-NAME             PIC X(15).
  6984             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6985                                                          COMP-3.
  6986             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6987                                                          COMP-3.
  6988         16  AM-EXECUTIVE-TWO.
  6989             20  AM-EXEC2-NAME             PIC X(15).
  6990             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6991                                                          COMP-3.
  6992             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6993                                                          COMP-3.
  6994
  6995     12  AM-RETRO-ADDITIONAL-DATA.
  6996         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6997         16  AM-RETRO-PREM-P-E             PIC X.
  6998         16  AM-RETRO-CLMS-P-I             PIC X.
  6999         16  AM-RETRO-RET-BRACKET-LF.
  7000             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7001                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7002                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7003             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7004                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7005                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7006             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7007                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7008                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7009         16  AM-RETRO-RET-BRACKET-AH.
  7010             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7011                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7012                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7013                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7014             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7015                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7016                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7017             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 128
* EL050.cbl
  7018                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7019                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7020
  7021     12  AM-COMMENTS.
  7022         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7023
  7024     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7025         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7026         16  AM-FLI-BILLING-CODE           PIC X.
  7027         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7028         16  AM-FLI-UNITED-IDENT           PIC X.
  7029         16  AM-FLI-INTEREST-LOST-DATA.
  7030             20  AM-FLI-BANK-NO            PIC X(5).
  7031             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7032             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7033             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7034         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7035             20  AM-FLI-AGT                PIC X(9).
  7036             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7037             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7038         16  FILLER                        PIC X(102).
  7039
  7040     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7041         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7042             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7043             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7044             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7045             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7046             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7047         16  FILLER                          PIC X(10).
  7048******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 129
* EL050.cbl
  7050*    COPY ERCREIN.
  7051******************************************************************
  7052*                                                                *
  7053*                            ERCREIN                             *
  7054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7055*                            VMOD=2.010                          *
  7056*                                                                *
  7057*   ONLINE CREDIT SYSTEM                                         *
  7058*                                                                *
  7059*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7060*                                                                *
  7061*   FILE TYPE = VSAM,KSDS                                        *
  7062*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7063*                                                                *
  7064*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7065*       ALTERNATE PATH = NONE                                    *
  7066*                                                                *
  7067*   LOG = NO                                                     *
  7068*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7069*                                                                *
  7070******************************************************************
  7071*                   C H A N G E   L O G
  7072*
  7073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7074*-----------------------------------------------------------------
  7075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7076* EFFECTIVE    NUMBER
  7077*-----------------------------------------------------------------
  7078* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7079* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7080******************************************************************
  7081 01  REINSURANCE-RECORD.
  7082     12  RE-RECORD-ID                      PIC XX.
  7083         88  VALID-RE-ID                      VALUE 'RE'.
  7084
  7085     12  RE-CONTROL-PRIMARY.
  7086         16  RE-COMPANY-CD                 PIC X.
  7087         16  RE-KEY.
  7088             20  RE-CODE                   PIC X.
  7089                 88  RE-TABLE-RECORD          VALUE 'A'.
  7090                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7091             20  RE-TABLE                  PIC XXX.
  7092             20  FILLER                    PIC XXX.
  7093         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7094             20  FILLER                    PIC X.
  7095             20  RE-COMPANY.
  7096                 24  RE-COMP-PRIME         PIC XXX.
  7097                 24  RE-COMP-SUB           PIC XXX.
  7098
  7099     12  RE-MAINT-INFORMATION.
  7100         16  RE-LAST-MAINT-DT              PIC XX.
  7101         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7102         16  RE-LAST-MAINT-USER            PIC X(4).
  7103         16  FILLER                        PIC X(10).
  7104
  7105     12  RE-TABLE-DATA.
  7106         16  RE-100-COMP                   PIC 99.
  7107
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 130
* EL050.cbl
  7108         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7109             20  RE-REI-COMP-NO.
  7110                 24  RE-REI-COMP           PIC XXX.
  7111                 24  RE-REI-COMP-SUB       PIC XXX.
  7112             20  RE-LF-QC                  PIC X.
  7113             20  RE-AH-QC                  PIC X.
  7114             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7115             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7116             20  RE-LFAGE-LO               PIC 99.
  7117             20  RE-LFAGE-HI               PIC 99.
  7118             20  RE-AHAGE-LO               PIC 99.
  7119             20  RE-AHAGE-HI               PIC 99.
  7120             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7121             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7122             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7123             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7124             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7125             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7126             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7127             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7128             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7129             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7130             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7131             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7132             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7133             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7134             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7135             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7136             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7137             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7138             20  RE-LF-BEN-CODE            PIC X.
  7139             20  RE-AH-BEN-CODE            PIC X.
  7140             20  RE-INTERACTIVE            PIC X.
  7141             20  RE-REMAINING              PIC X.
  7142             20  RE-LF-RUNOFF-SW           PIC X.
  7143             20  RE-AH-RUNOFF-SW           PIC X.
  7144             20  FILLER                    PIC X(19).
  7145
  7146         16  RE-COMP-INFO-END              PIC X(6).
  7147         16  RE-NSP-ST-CD-LF               PIC XX.
  7148         16  RE-NSP-ST-CD-AH               PIC XX.
  7149         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7150             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7151
  7152         16  FILLER                        PIC X(27).
  7153
  7154     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7155         16  RE-NAME                       PIC X(30).
  7156         16  RE-LF-PE                      PIC X.
  7157         16  RE-AH-PE                      PIC X.
  7158         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7159         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7160         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7161         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7162         16  RE-PRT-ST                     PIC X.
  7163         16  RE-PRT-OW                     PIC X.
  7164         16  RE-MORT-CODE                  PIC X(4).
  7165         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 131
* EL050.cbl
  7166         16  RE-ZERO-LF-FEE                PIC X.
  7167         16  RE-ZERO-AH-FEE                PIC X.
  7168         16  RE-CEDE-NAME                  PIC X(30).
  7169         16  RE-LF-COMM                    PIC X.
  7170         16  RE-AH-COMM                    PIC X.
  7171         16  RE-LF-TAX                     PIC X.
  7172         16  RE-AH-TAX                     PIC X.
  7173         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7174         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7175         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7176
  7177         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7178             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7179
  7180         16  RE-LF-CEDING-FEE-BRACKETS.
  7181             20  RE-LF-FEE-METHOD          PIC X.
  7182                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7183                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7184                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7185                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7186             20  RE-LF-FEE-BASIS           PIC X.
  7187                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7188                 88  RE-LF-NET-CEDED               VALUE '2'.
  7189                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7190                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7191                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7192                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7193                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7194                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7195             20  FILLER                    PIC XXX.
  7196             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7197                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7198                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7199
  7200         16  RE-AH-CEDING-FEE-BRACKETS.
  7201             20  RE-AH-FEE-METHOD          PIC X.
  7202                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7203                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7204                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7205                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7206             20  RE-AH-FEE-BASIS           PIC X.
  7207                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7208                 88  RE-AH-NET-CEDED               VALUE '2'.
  7209                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7210                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7211                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7212                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7213                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7214                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7215             20  FILLER                    PIC XXX.
  7216             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7217                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7218                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7219
  7220         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7221
  7222         16  RE-OLD-CEDING-STMT            PIC X.
  7223
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 132
* EL050.cbl
  7224         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7225         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7226         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7227         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7228         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7229         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7230         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7231         16  RE-MORT-SW                    PIC X.
  7232         16  RE-CEDING-TYPE-FLAG           PIC X.
  7233             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7234             88  RE-CEDED                          VALUE 'C'.
  7235             88  RE-ASSUMED                        VALUE 'A'.
  7236             88  RE-PHANTOM                        VALUE 'P'.
  7237
  7238         16  RE-CEDING-STMT-OPT-A          PIC X.
  7239             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7240         16  RE-CEDING-STMT-OPT-B          PIC X.
  7241             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7242         16  RE-CEDING-STMT-OPT-C          PIC X.
  7243             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7244         16  RE-CEDING-STMT-OPT-D          PIC X.
  7245             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7246         16  RE-CEDING-STMT-OPT-E          PIC X.
  7247             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7248
  7249         16  RE-PRT-CRSV                   PIC X.
  7250
  7251         16  RE-GL-CENTER                  PIC X(4).
  7252
  7253         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7254
  7255         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7256
  7257         16  RE-EARN-STOP-CODE             PIC X.
  7258             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7259             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7260
  7261         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7262             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7263
  7264         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7265         16  FILLER                        PIC X(2281).
  7266
  7267         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7268
  7269******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 133
* EL050.cbl
  7271*    COPY ERCCTBL.
  7272******************************************************************
  7273*                                                                *
  7274*                                                                *
  7275*                            ERCCTBL                             *
  7276*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7277*                            VMOD=2.003
  7278*                                                                *
  7279*   ONLINE CREDIT SYSTEM                                         *
  7280*                                                                *
  7281*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7282*                                                                *
  7283*   FILE TYPE = VSAM,KSDS                                        *
  7284*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7285*                                                                *
  7286*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7287*       ALTERNATE PATH = NONE                                    *
  7288*                                                                *
  7289*   LOG = NO                                                     *
  7290*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7291*                                                                *
  7292*                                                                *
  7293******************************************************************
  7294
  7295 01  COMM-TABLE-RECORD.
  7296     12  CT-RECORD-ID                      PIC XX.
  7297         88  VALID-CT-ID                      VALUE 'CT'.
  7298
  7299     12  CT-CONTROL-PRIMARY.
  7300         16  CT-COMPANY-CD                 PIC X.
  7301         16  CT-TABLE                      PIC XXX.
  7302         16  CT-CNTRL-2.
  7303             20  CT-BEN-TYPE               PIC X.
  7304             20  CT-BEN-CODE               PIC XX.
  7305
  7306     12  CT-MAINT-INFORMATION.
  7307         16  CT-LAST-MAINT-DT              PIC XX.
  7308         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7309         16  CT-LAST-MAINT-USER            PIC X(4).
  7310         16  FILLER                        PIC X(31).
  7311
  7312     12  CT-LIMITS.
  7313         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7314
  7315         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7316
  7317         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7318
  7319     12  CT-RATES.
  7320         16  CT-RTX          OCCURS 27 TIMES.
  7321             20  CT-RT                     PIC SV9(5)     COMP-3.
  7322             20  CT-RT-R   REDEFINES
  7323                 CT-RT                     PIC XXX.
  7324
  7325     12  FILLER                            PIC  X(42).
  7326
  7327******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 134
* EL050.cbl
  7329*    COPY ERCFORM.
  7330******************************************************************
  7331*                                                                *
  7332*                                                                *
  7333*                            ERCFORM.                            *
  7334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7335*                            VMOD=2.003                          *
  7336*                                                                *
  7337*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7338*                                                                *
  7339*    FILE TYPE = VSAM,KSDS                                       *
  7340*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7341*                                                                *
  7342*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7343*                                                                *
  7344*    LOG = YES                                                   *
  7345*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7346******************************************************************
  7347 01  FORM-MASTER.
  7348    12  FO-RECORD-ID                 PIC X(02).
  7349        88  VALID-FO-ID                  VALUE 'FO'.
  7350
  7351    12  FO-CONTROL-PRIMARY.
  7352        16  FO-COMPANY-CD            PIC X(01).
  7353        16  FO-STATE                 PIC X(02).
  7354        16  FO-FORM-ID               PIC X(12).
  7355        16  FO-FORM-EXP-DT           PIC X(02).
  7356
  7357    12  FO-POLICY-FORM-DATA.
  7358        16  FO-IND-GRP-CD            PIC X(01).
  7359        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7360        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7361        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7362        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7363        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7364        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7365        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7366        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7367        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7368        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7369        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7370        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7371        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7372        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7373        16  FO-APP-CERT-USE-CD       PIC X(01).
  7374
  7375    12  FILLER                       PIC X(29).
  7376
  7377    12  FO-FORM-PLAN-TABLE.
  7378        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7379            20  FO-PLAN-TYPE         PIC X(01).
  7380            20  FO-PLAN-ID           PIC X(02).
  7381            20  FO-PLAN-TERM         PIC 9(03).
  7382            20  FO-PLAN-REFUND-METHOD
  7383                                     PIC X.
  7384
  7385    12  FILLER                       PIC X(30).
  7386
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 135
* EL050.cbl
  7387    12  FO-COMMENTS-AREA.
  7388        16  FO-COMMENT-LINE-1        PIC X(78).
  7389
  7390    12  FILLER                       PIC X(20).
  7391
  7392    12  FO-MAINT-INFORMATION.
  7393        16  FO-LAST-MAINT-DT         PIC X(02).
  7394        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7395        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 136
* EL050.cbl
  7397*    COPY ELCMSTR.
  7398******************************************************************
  7399*                                                                *
  7400*                            ELCMSTR.                            *
  7401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7402*                            VMOD=2.012                          *
  7403*                                                                *
  7404*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7405*                                                                *
  7406*   FILE TYPE = VSAM,KSDS                                        *
  7407*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7408*                                                                *
  7409*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7410*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7411*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7412*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7413*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7414*                                                 RKP=75,LEN=21  *
  7415*                                                                *
  7416*   **** NOTE ****                                               *
  7417*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7418*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7419*                                                                *
  7420*   LOG = YES                                                    *
  7421*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7422******************************************************************
  7423*                   C H A N G E   L O G
  7424*
  7425* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7426*-----------------------------------------------------------------
  7427*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7428* EFFECTIVE    NUMBER
  7429*-----------------------------------------------------------------
  7430* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7431* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7432* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7433* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7434* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7435******************************************************************
  7436 01  CLAIM-MASTER.
  7437     12  CL-RECORD-ID                PIC XX.
  7438         88  VALID-CL-ID         VALUE 'CL'.
  7439
  7440     12  CL-CONTROL-PRIMARY.
  7441         16  CL-COMPANY-CD           PIC X.
  7442         16  CL-CARRIER              PIC X.
  7443         16  CL-CLAIM-NO             PIC X(7).
  7444         16  CL-CERT-NO.
  7445             20  CL-CERT-PRIME       PIC X(10).
  7446             20  CL-CERT-SFX         PIC X.
  7447
  7448     12  CL-CONTROL-BY-NAME.
  7449         16  CL-COMPANY-CD-A1        PIC X.
  7450         16  CL-INSURED-LAST-NAME    PIC X(15).
  7451         16  CL-INSURED-NAME.
  7452             20  CL-INSURED-1ST-NAME PIC X(12).
  7453             20  CL-INSURED-MID-INIT PIC X.
  7454
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 137
* EL050.cbl
  7455     12  CL-CONTROL-BY-SSN.
  7456         16  CL-COMPANY-CD-A2        PIC X.
  7457         16  CL-SOC-SEC-NO.
  7458             20  CL-SSN-STATE        PIC XX.
  7459             20  CL-SSN-ACCOUNT      PIC X(6).
  7460             20  CL-SSN-LN3          PIC X(3).
  7461
  7462     12  CL-CONTROL-BY-CERT-NO.
  7463         16  CL-COMPANY-CD-A4        PIC X.
  7464         16  CL-CERT-NO-A4.
  7465             20  CL-CERT-A4-PRIME    PIC X(10).
  7466             20  CL-CERT-A4-SFX      PIC X.
  7467
  7468     12  CL-CONTROL-BY-CCN.
  7469         16  CL-COMPANY-CD-A5        PIC X.
  7470         16  CL-CCN-A5.
  7471             20  CL-CCN.
  7472                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7473                 24  CL-CCN-PRIME-A5 PIC X(12).
  7474             20  CL-CCN-FILLER-A5    PIC X(4).
  7475
  7476     12  CL-INSURED-PROFILE-DATA.
  7477         16  CL-INSURED-BIRTH-DT     PIC XX.
  7478         16  CL-INSURED-SEX-CD       PIC X.
  7479             88  INSURED-IS-MALE        VALUE 'M'.
  7480             88  INSURED-IS-FEMALE      VALUE 'F'.
  7481             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7482         16  CL-INSURED-OCC-CD       PIC X(6).
  7483         16  FILLER                  PIC X(5).
  7484
  7485     12  CL-PROCESSING-INFO.
  7486         16  CL-PROCESSOR-ID         PIC X(4).
  7487         16  CL-CLAIM-STATUS         PIC X.
  7488             88  CLAIM-IS-OPEN          VALUE 'O'.
  7489             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7490         16  CL-CLAIM-TYPE           PIC X.
  7491*            88  AH-CLAIM               VALUE 'A'.
  7492*            88  LIFE-CLAIM             VALUE 'L'.
  7493*            88  PROPERTY-CLAIM         VALUE 'P'.
  7494*            88  IUI-CLAIM              VALUE 'I'.
  7495*            88  GAP-CLAIM              VALUE 'G'.
  7496*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7497         16  CL-CLAIM-PREM-TYPE      PIC X.
  7498             88  SINGLE-PREMIUM         VALUE '1'.
  7499             88  O-B-COVERAGE           VALUE '2'.
  7500             88  OPEN-END-COVERAGE      VALUE '3'.
  7501         16  CL-INCURRED-DT          PIC XX.
  7502         16  CL-REPORTED-DT          PIC XX.
  7503         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7504         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7505         16  CL-LAST-PMT-DT          PIC XX.
  7506         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7507         16  CL-PAID-THRU-DT         PIC XX.
  7508         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7509         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7510         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7511         16  CL-PMT-CALC-METHOD      PIC X.
  7512             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 138
* EL050.cbl
  7513             88  CL-365-DAY-YR          VALUE '2'.
  7514             88  CL-FULL-MONTHS         VALUE '3'.
  7515         16  CL-CAUSE-CD             PIC X(6).
  7516
  7517         16  CL-PRIME-CERT-NO.
  7518             20  CL-PRIME-CERT-PRIME PIC X(10).
  7519             20  CL-PRIME-CERT-SFX   PIC X.
  7520
  7521         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7522             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7523             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7524
  7525         16  CL-MICROFILM-NO         PIC X(10).
  7526         16  FILLER REDEFINES CL-MICROFILM-NO.
  7527             20  CL-BENEFIT-PERIOD   PIC 99.
  7528             20  FILLER              PIC X(8).
  7529         16  CL-PROG-FORM-TYPE       PIC X.
  7530         16  CL-LAST-ADD-ON-DT       PIC XX.
  7531
  7532         16  CL-LAST-REOPEN-DT       PIC XX.
  7533         16  CL-LAST-CLOSE-DT        PIC XX.
  7534         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7535             88  FINAL-PAID             VALUE '1'.
  7536             88  CLAIM-DENIED           VALUE '2'.
  7537             88  AUTO-CLOSE             VALUE '3'.
  7538             88  MANUAL-CLOSE           VALUE '4'.
  7539             88  BENEFITS-CHANGED       VALUE 'C'.
  7540             88  SETUP-ERRORS           VALUE 'E'.
  7541         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7542         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7543         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7544             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7545         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7546         16  FILLER                  PIC X.
  7547
  7548     12  CL-CERTIFICATE-DATA.
  7549         16  CL-CERT-ORIGIN          PIC X.
  7550             88  CERT-WAS-ONLINE        VALUE '1'.
  7551             88  CERT-WAS-CREATED       VALUE '2'.
  7552             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7553         16  CL-CERT-KEY-DATA.
  7554             20  CL-CERT-CARRIER     PIC X.
  7555             20  CL-CERT-GROUPING    PIC X(6).
  7556             20  CL-CERT-STATE       PIC XX.
  7557             20  CL-CERT-ACCOUNT.
  7558                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7559                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7560             20  CL-CERT-EFF-DT      PIC XX.
  7561
  7562     12  CL-STATUS-CONTROLS.
  7563         16  CL-PRIORITY-CD          PIC X.
  7564             88  CONFIDENTIAL-DATA      VALUE '8'.
  7565             88  HIGHEST-PRIORITY       VALUE '9'.
  7566         16  CL-SUPV-ATTN-CD         PIC X.
  7567             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7568             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7569         16  CL-PURGED-DT            PIC XX.
  7570         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 139
* EL050.cbl
  7571         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7572         16  CL-NEXT-RESEND-DT       PIC XX.
  7573         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7574         16  CL-CRITICAL-PERIOD      PIC 99.
  7575*        16  FILLER                  PIC XX.
  7576         16  CL-LAST-MAINT-DT        PIC XX.
  7577         16  CL-LAST-MAINT-USER      PIC X(4).
  7578         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7579         16  CL-LAST-MAINT-TYPE      PIC X.
  7580             88  CLAIM-SET-UP           VALUE ' '.
  7581             88  PAYMENT-MADE           VALUE '1'.
  7582             88  LETTER-SENT            VALUE '2'.
  7583             88  MASTER-WAS-ALTERED     VALUE '3'.
  7584             88  MASTER-WAS-RESTORED    VALUE '4'.
  7585             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7586             88  FILE-CONVERTED         VALUE '6'.
  7587             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7588             88  ERROR-CORRECTION       VALUE 'E'.
  7589         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7590         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7591         16  CL-BENEFICIARY          PIC X(10).
  7592         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7593         16  CL-DENIAL-TYPE          PIC X.
  7594             88  CL-TYPE-DENIAL          VALUE '1'.
  7595             88  CL-TYPE-RESCISSION      VALUE '2'.
  7596             88  CL-TYPE-REFORMATION     VALUE '3'.
  7597             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7598             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7599         16  filler                  pic x(5).
  7600*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7601*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7602*        16  CL-RTW-DT               PIC XX.
  7603
  7604     12  CL-TRAILER-CONTROLS.
  7605         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7606             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7607             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7608             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7609         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7610         16  FILLER                  PIC XX.
  7611         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7612         16  CL-ADDRESS-TRAILER-CNT.
  7613             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7614                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7615             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7616                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7617             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7618                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7619             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7620                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7621             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7622                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7623             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7624                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7625             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7626                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7627
  7628     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 140
* EL050.cbl
  7629         16  CL-CV-REFNO-PRIME       PIC X(18).
  7630         16  CL-CV-REFNO-SFX         PIC XX.
  7631
  7632     12  CL-FILE-LOCATION            PIC X(4).
  7633
  7634     12  CL-PROCESS-ERRORS.
  7635         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7636             88  NO-FATAL-ERRORS        VALUE ZERO.
  7637         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7638             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7639
  7640     12  CL-PRODUCT-CD               PIC X.
  7641
  7642     12  CL-CURRENT-KEY-DATA.
  7643         16  CL-CURRENT-CARRIER      PIC X.
  7644         16  CL-CURRENT-GROUPING     PIC X(6).
  7645         16  CL-CURRENT-STATE        PIC XX.
  7646         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7647
  7648     12  CL-ASSOCIATES               PIC X.
  7649         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7650         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7651         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7652         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7653
  7654     12  CL-ACTIVITY-CODE            PIC 99.
  7655     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7656     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7657
  7658     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7659     12  CL-LAG-REPORT-CODE          PIC 9.
  7660     12  CL-LOAN-TYPE                PIC XX.
  7661     12  CL-LEGAL-STATE              PIC XX.
  7662
  7663     12  CL-YESNOSW                  PIC X.
  7664     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7665         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7666         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7667         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7668     12  cl-insured-type             pic x.
  7669         88  cl-claim-on-primary         value 'P'.
  7670         88  cl-claim-on-co-borrower     value 'C'.
  7671     12  cl-benefit-expiration-dt    PIC XX.
  7672
  7673 01  PLAN-RECORDS.
  7674     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7675     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7676
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 141
* EL050.cbl
  7678 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7679                          ACCOUNT-MASTER REINSURANCE-RECORD
  7680                          COMM-TABLE-RECORD FORM-MASTER
  7681                          CLAIM-MASTER PLAN-RECORDS.
  7682 0000-DFHEXIT SECTION.
  7683     MOVE '9#                    $   ' TO DFHEIV0.
  7684     MOVE 'EL050' TO DFHEIV1.
  7685     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7686
  7687     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7688
  7689
  7690* EXEC CICS  HANDLE CONDITION
  7691*           ERROR    (9300-ABEND)
  7692*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7693*    END-EXEC.
  7694*    MOVE '"$.J                  ! " #00007685' TO DFHEIV0
  7695     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7697     MOVE X'2220233030303037363835' TO DFHEIV0(25:11)
  7698     CALL 'kxdfhei1' USING DFHEIV0
  7699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7700
  7701
  7702 0000-COPY-PROCEDURE-DIV.
  7703*                          COPY ELC50PD.
  7704******************************************************************
  7705*                                                                *
  7706*                            ELC50PD                             *
  7707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7708*                            VMOD=2.188                          *
  7709*                                                                *
  7710******************************************************************
  7711*                   C H A N G E   L O G
  7712*
  7713* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7714*-----------------------------------------------------------------
  7715*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7716* EFFECTIVE    NUMBER
  7717*-----------------------------------------------------------------
  7718* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7719* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7720* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7721*                             2709 AND 2718
  7722* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7723* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7724* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7725* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7726* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7727*                                IS OPEN OR CNC DT < PD THRU
  7728* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7729* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7730* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7731* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7732* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7733* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7734* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7735* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 142
* EL050.cbl
  7736* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7737* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7738* 020906                   PEMA  EXPAND LOAN OFFICER
  7739* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7740* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7741* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7742* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7743* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7744* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7745* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7746* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7747* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7748* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7749* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7750* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7751* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7752* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7753* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7754* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7755* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7756* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7757* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7758* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7759* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7760* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7761* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7762* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7763* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7764*                                UPDATE VIN ON CERT TRAILER
  7765* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7766* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7767* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7768* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7769* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7770* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7771* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7772* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7773* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7774* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7775* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7776* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7777* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7778* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7779* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7780* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7781* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7782* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7783* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7784* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7785* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7786* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7787* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7788* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7789* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7790* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7791* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7792* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7793* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 143
* EL050.cbl
  7794* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7795* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7796* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7797* 032912  CR2011110200001  PEMA  AHL CHANGES
  7798* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7799* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7800* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7801* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7802* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7803* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7804* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7805* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7806* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7807* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7808* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7809* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7810* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7811* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7812* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7813* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7814* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7815* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7816* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7817* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7818* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7819* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7820* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7821* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7822* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7823* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7824* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7825*                                CERT #, ADD 2898 FORCIBLE ERROR
  7826* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7827* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7828* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7829* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7830* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7831* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7832* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7833* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7834* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7835* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7836* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7837* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7838* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7839* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7840******************************************************************
  7841************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7842******************************************************************
  7843
  7844     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7845
  7846     MOVE SPACES                 TO PB-FATAL-FLAG
  7847                                    PB-FORCE-ER-CD
  7848                                    PB-WARN-ER-CD
  7849                                    PB-OUT-BAL-CD.
  7850
  7851     MOVE SPACE                  TO WS-IG-OVRD-AH
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 144
* EL050.cbl
  7852                                    WS-IG-OVRD-LF
  7853                                    WS-IG-OVRD-AM
  7854                                    WS-IG-OVRD
  7855                                    WS-IG-OVRD-AH-PL
  7856                                    WS-IG-OVRD-LF-PL
  7857                                    WS-IG-OVRD-AH-BEN
  7858                                    WS-IG-OVRD-LF-BEN.
  7859
  7860******************************************************************
  7861*************       INITIALIZE COMMON ERRORS       ***************
  7862******************************************************************
  7863
  7864     MOVE +0                     TO PB-NO-OF-ERRORS.
  7865     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7866
  7867******************************************************************
  7868
  7869     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7870     SET JULIAN-TO-BIN           TO TRUE.
  7871*    MOVE 5                      TO DC-OPTION-CODE.
  7872     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7873     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7874
  7875     MOVE ZERO                   TO  SUB4.
  7876
  7877 0040-INITIALIZE-GA-BILL-DT.
  7878
  7879     ADD +1                      TO  SUB4.
  7880
  7881     IF  SUB4 GREATER THAN +5
  7882         GO TO 0050-CHECK-CNTL-FOUND.
  7883
  7884     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7885         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7886
  7887     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7888
  7889 0050-CHECK-CNTL-FOUND.
  7890
  7891     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7892        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7893                                         WS-AH-REM-TERM-CALC
  7894                                         EC-CO-REM-TERM-CALC
  7895        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7896        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7897        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7898                                         WS-TOL-AH-CLAIM
  7899        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7900                                         WS-TOL-AH-PREM
  7901                                         EC-CO-TOL-PREM
  7902        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7903                                         WS-TOL-AH-REFUND
  7904                                         EC-CO-TOL-REFUND
  7905        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7906                                         WS-AH-REFUND-OVS-AMT
  7907                                         EC-CO-OVR-SHT-AMT
  7908        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7909                                         WS-TOL-AH-PREM-PCT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 145
* EL050.cbl
  7910                                         EC-CO-TOL-PREM-PCT
  7911        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7912                                         WS-TOL-AH-REFUND-PCT
  7913                                         EC-CO-TOL-REFUND-PCT
  7914        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7915                                         WS-AH-REFUND-OVS-PCT
  7916                                         EC-CO-OVR-SHT-PCT
  7917        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7918        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7919        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7920        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7921        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7922        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7923        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7924        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7925        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7926        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7927        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7928        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7929                                         EC-CO-MONTH-END-DT
  7930        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7931          GO TO 0100-READ-ACCT.
  7932
  7933     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7934     MOVE SPACES                 TO CNTL-ACCESS.
  7935     MOVE '1'                    TO CNTL-REC-TYPE.
  7936     MOVE +0                     TO CNTL-SEQ-NO.
  7937
  7938     MOVE '1' TO RC-SW-1.
  7939     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7940     IF NOT CF-COMPANY-MASTER
  7941         MOVE ZEROS             TO WK-CO-TOL-PREM
  7942                                   WK-CO-TOL-CLAIM
  7943                                   WK-CO-TOL-REFUND
  7944                                   WK-REFUND-OVS-AMT
  7945                                   WK-REFUND-OVS-PCT
  7946                                   WK-CO-TOL-PREM-PCT
  7947                                   WK-CO-TOL-REFUND-PCT
  7948                                   WK-DEFAULT-APR
  7949                                   WK-CO-MAX-CAP
  7950        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7951                                   WK-CR-R78-METHOD
  7952                                   WK-CO-REF-REJECT-SW
  7953                                   WK-CO-PREM-REJECT-SW
  7954                                   WK-REM-TRM-CALC-OPTION
  7955                                   WK-BIRTH-DATE-INPUT
  7956                                   WK-JOINT-AGE-INPUT
  7957        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7958        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7959        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7960        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7961          GO TO 0099-COMPANY-NOT-FOUND.
  7962
  7963     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7964        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7965     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7966        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7967     IF CF-CO-TOL-CAP NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 146
* EL050.cbl
  7968        MOVE +0                    TO CF-CO-TOL-CAP.
  7969     IF CF-DEFAULT-APR NOT NUMERIC
  7970        MOVE +0                    TO CF-DEFAULT-APR.
  7971
  7972     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7973     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7974     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7975     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7976     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7977     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7978     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7979     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7980     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7981     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7982     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7983     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7984
  7985     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7986          CF-CO-OVR-SHT-AMT > +0
  7987        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7988
  7989     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7990          CF-CO-OVR-SHT-PCT > +0
  7991        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7992
  7993     IF CF-VALID-REM-TRM-OPTION
  7994         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7995     ELSE
  7996         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7997
  7998     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7999     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8000     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8001     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8002
  8003     GO TO 0050-CHECK-CNTL-FOUND.
  8004
  8005 0099-COMPANY-NOT-FOUND.
  8006
  8007     MOVE ER-2616                TO WS-ERROR.
  8008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8009
  8010 0100-READ-ACCT.
  8011
  8012     MOVE SPACES                 TO DATE-RANGE-SW.
  8013
  8014     IF WK-ACCT-ADDR = ZEROS
  8015        GO TO 0102-ACCT-GETMAIN.
  8016
  8017     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8018     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8019     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8020
  8021     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8022        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8023        GO TO 0105-READ-ACCT
  8024     END-IF
  8025
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 147
* EL050.cbl
  8026     IF PB-CARRIER NOT = SPACES
  8027        IF PB-CARRIER NOT = AM-VG-CARRIER
  8028           GO TO 0105-READ-ACCT.
  8029
  8030     IF PB-STATE NOT = SPACES
  8031        IF PB-STATE NOT = AM-VG-STATE
  8032           GO TO 0105-READ-ACCT.
  8033
  8034     IF PB-GROUPING NOT = SPACES
  8035        IF PB-GROUPING NOT = AM-VG-GROUPING
  8036           GO TO 0105-READ-ACCT.
  8037
  8038     MOVE 'X'                 TO DATE-RANGE-SW.
  8039
  8040     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8041        MOVE 'X'                 TO DATE-RANGE-SW
  8042        GO TO 0105-READ-ACCT.
  8043
  8044     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8045        GO TO 0105-READ-ACCT.
  8046
  8047     GO TO 0180-ACCOUNT-FOUND.
  8048
  8049 0102-ACCT-GETMAIN.
  8050     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8051     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8052
  8053 0105-READ-ACCT.
  8054     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8055     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8056     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8057     MOVE PB-STATE               TO ACCT-STATE.
  8058     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8059     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8060
  8061     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8062
  8063     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8064
  8065 0110-FIND-ACCT-TOLERANCES-LOOP.
  8066     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8067
  8068     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8069        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8070        GO TO 0199-ACCT-NOT-FOUND
  8071     END-IF
  8072     IF PB-CARRIER NOT = SPACES
  8073        IF PB-CARRIER NOT = AM-VG-CARRIER
  8074           GO TO 0199-ACCT-NOT-FOUND.
  8075
  8076     IF PB-STATE NOT = SPACES
  8077        IF PB-STATE NOT = AM-VG-STATE
  8078           GO TO 0199-ACCT-NOT-FOUND.
  8079
  8080     IF PB-GROUPING NOT = SPACES
  8081        IF PB-GROUPING NOT = AM-VG-GROUPING
  8082           GO TO 0199-ACCT-NOT-FOUND.
  8083
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 148
* EL050.cbl
  8084     MOVE 'X'                    TO DATE-RANGE-SW.
  8085
  8086     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8087        MOVE 'X'                 TO DATE-RANGE-SW
  8088        GO TO 0199-ACCT-NOT-FOUND.
  8089
  8090     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8091        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8092
  8093 0180-ACCOUNT-FOUND.
  8094     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8095     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8096     MOVE AM-STATE               TO PB-SV-STATE.
  8097     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8098
  8099     IF AM-CANCEL-FEE  NOT NUMERIC
  8100        MOVE ZEROS TO AM-CANCEL-FEE.
  8101
  8102     IF AM-MAX-MON-BEN NOT NUMERIC
  8103        MOVE ZEROS TO AM-MAX-MON-BEN.
  8104
  8105     IF AM-MAX-TOT-BEN NOT NUMERIC
  8106        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8107
  8108     IF AM-CLP-TOL-PCT NOT NUMERIC
  8109        MOVE +0                  TO AM-CLP-TOL-PCT
  8110     END-IF
  8111     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8112        MOVE +0                  TO AM-SPP-LEASE-COMM
  8113     END-IF
  8114     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8115        MOVE ER-2611             TO   WS-ERROR
  8116        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8117
  8118     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8119        MOVE ER-2621             TO   WS-ERROR
  8120        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8121
  8122     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8123        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8124        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8125        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8126         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8127
  8128     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8129     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8130     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8131     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8132     IF AM-CLP-TOL-PCT NOT = ZEROS
  8133        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8134     END-IF
  8135     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8136        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8137     END-IF
  8138*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8139*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8140*                                   WS-ADMIN-FEES
  8141*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 149
* EL050.cbl
  8142*          (SUB5 > +10)
  8143*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8144*             AND (AM-A-COM (SUB5) NUMERIC)
  8145*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8146*                + (AM-A-COM (SUB5) * 1000)
  8147*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8148*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8149*                + (AM-A-COM (SUB5) * 1000)
  8150*             END-IF
  8151*             IF AM-COM-TYP (SUB5) = 'N'
  8152*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8153*                + (AM-A-COM (SUB5) * 1000)
  8154*             END-IF
  8155*          END-IF
  8156*       END-PERFORM
  8157*    END-IF
  8158     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8159        AND (PB-ISSUE)
  8160        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8161                                    ws-cred-union-fees
  8162        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8163           (SUB5 > +10)
  8164           MOVE +0 TO WS-WK-RATE
  8165           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8166                                   'O' OR 'S')
  8167              IF (AM-A-COM (SUB5) NUMERIC)
  8168                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8169                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8170              ELSE
  8171                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8172                 IF PB-ISSUE
  8173                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8174                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8175                 ELSE
  8176                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8177                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8178                 END-IF
  8179                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8180                 MOVE ZEROS             TO WS-SUB1
  8181                                           WS-COMMISSION
  8182                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8183                 MOVE '0530'               TO CTBL-SW
  8184                 MOVE ' '                  TO WS-CTBL-READ-SW
  8185                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8186                 IF FIRST-TIME-THROUGH
  8187                    MOVE 'AA'              TO CTBL-BEN-CODE
  8188                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8189                 END-IF
  8190                 IF CTBL-TABLE-FOUND
  8191                    IF PB-ISSUE
  8192                       COMPUTE WS-COMM-CK-AMT =
  8193                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8194                    ELSE
  8195                       COMPUTE WS-COMM-CK-AMT =
  8196                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8197                    END-IF
  8198                    PERFORM 8800-GET-COMP-RATE
  8199                              THRU 8800-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 150
* EL050.cbl
  8200                 END-IF
  8201              END-IF
  8202              if am-com-typ (sub5) = 'O' or 'S'
  8203                 compute ws-cred-union-fees rounded =
  8204                    ws-cred-union-fees +
  8205                    (pb-i-ah-premium-amt * ws-wk-rate)
  8206              else
  8207                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8208                + (WS-WK-RATE * 1000)
  8209              end-if
  8210           END-IF
  8211        END-PERFORM
  8212     END-IF
  8213     IF PB-COMPANY-ID EQUAL 'CRI'
  8214         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8215
  8216     IF PB-COMPANY-ID EQUAL 'NCL'
  8217         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8218     END-IF
  8219
  8220     GO TO 0200-READ-CERT.
  8221
  8222 0199-ACCT-NOT-FOUND.
  8223
  8224     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8225
  8226     IF DATE-RANGE-SW NOT = SPACES
  8227        MOVE ER-2601             TO WS-ERROR
  8228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8229     ELSE
  8230        MOVE ER-2619             TO WS-ERROR
  8231        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8232
  8233     GO TO 9990-RETURN.
  8234
  8235 0200-READ-CERT.
  8236
  8237     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8238     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8239     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8240     MOVE PB-SV-STATE            TO CERT-STATE.
  8241     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8242     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8243     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8244
  8245     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8246
  8247     IF CERT-WAS-NOT-FOUND
  8248        GO TO 0299-CERT-NOT-FOUND.
  8249
  8250     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8251        MOVE ER-2759             TO WS-ERROR
  8252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8253        GO TO 0298-UNLOCK-RETURN.
  8254
  8255     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8256         MOVE ER-2758            TO WS-ERROR
  8257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 151
* EL050.cbl
  8258         GO TO 0298-UNLOCK-RETURN.
  8259
  8260     IF PB-ISSUE
  8261        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8262           IF CERT-WAS-CREATED-FOR-CLAIM
  8263              NEXT SENTENCE
  8264            ELSE
  8265              MOVE ER-2626       TO WS-ERROR
  8266              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8267              GO TO 0298-UNLOCK-RETURN.
  8268
  8269     IF NOT PB-CANCELLATION
  8270        GO TO 0300-CONTINUE-EDIT.
  8271
  8272     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8273     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8274     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8275     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8276     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8277     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8278
  8279     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8280     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8281     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8282     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8283     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8284     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8285     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8286     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8287     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8288
  8289     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8290     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8291     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8292     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8293     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8294     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8295     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8296
  8297     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8298     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8299
  8300     MOVE CM-CREDIT-INTERFACE-SW-1
  8301                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8302     MOVE CM-CREDIT-INTERFACE-SW-2
  8303                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8304
  8305     IF CM-O-B-COVERAGE
  8306         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8307
  8308     IF CM-LIVES NOT NUMERIC
  8309         MOVE ZERO                TO CM-LIVES.
  8310
  8311     IF CM-BILLED NOT NUMERIC
  8312         MOVE ZERO                TO CM-BILLED.
  8313
  8314     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8315         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 152
* EL050.cbl
  8316         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8317         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8318         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8319         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8320         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8321         MOVE CM-LIVES             TO PB-CI-LIVES
  8322*The next line causes a problem with my change  I dont think it is
  8323*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8324
  8325     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8326     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8327     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8328     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8329     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8330     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8331
  8332     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8333     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8334     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8335     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8336
  8337     IF CM-LIFE-COMM-PCT NUMERIC
  8338         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8339     ELSE
  8340         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8341
  8342     IF CM-AH-COMM-PCT NUMERIC
  8343         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8344     ELSE
  8345         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8346
  8347     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8348
  8349     IF CM-LOAN-APR       NOT NUMERIC
  8350           MOVE ZERO               TO CM-LOAN-APR.
  8351
  8352     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8353           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8354
  8355     IF CM-LOAN-TERM      NOT NUMERIC
  8356           MOVE ZERO               TO CM-LOAN-TERM.
  8357
  8358     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8359           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8360
  8361     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8362           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8363
  8364     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8365     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8366     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8367     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8368     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8369     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8370     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8371     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8372     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8373     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 153
* EL050.cbl
  8374     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8375     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8376
  8377     IF CM-STATE = CM-SSN-STATE
  8378         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8379
  8380     IF CM-STATE NOT = CM-MEMB-STATE
  8381         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8382
  8383     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8384
  8385     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8386        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8387        IF CM-ADDL-CLP NOT NUMERIC
  8388           MOVE +0               TO CM-ADDL-CLP
  8389        END-IF
  8390        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8391        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8392           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8393        END-IF
  8394     END-IF
  8395     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8396        MOVE +0                  TO WS-ADMIN-FEES
  8397                                    WS-CSO-ADMIN-FEE
  8398                                    WS-COMM-AND-MFEE
  8399                                    WS-1ST-YR-ALLOW
  8400        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8401           (SUB5 > +10)
  8402           MOVE +0 TO WS-WK-RATE
  8403           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8404              IF (AM-A-COM (SUB5) NUMERIC)
  8405                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8406                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8407              ELSE
  8408                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8409                 IF PB-ISSUE
  8410                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8411                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8412                 ELSE
  8413                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8414                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8415                 END-IF
  8416                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8417                 MOVE ZEROS             TO WS-SUB1
  8418                                           WS-COMMISSION
  8419                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8420                 MOVE '0530'               TO CTBL-SW
  8421                 MOVE ' '                  TO WS-CTBL-READ-SW
  8422                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8423                 IF FIRST-TIME-THROUGH
  8424                    MOVE 'AA'              TO CTBL-BEN-CODE
  8425                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8426                 END-IF
  8427                 IF CTBL-TABLE-FOUND
  8428                    IF PB-ISSUE
  8429                       COMPUTE WS-COMM-CK-AMT =
  8430                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8431                    ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 154
* EL050.cbl
  8432                       COMPUTE WS-COMM-CK-AMT =
  8433                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8434                    END-IF
  8435                    PERFORM 8800-GET-COMP-RATE
  8436                              THRU 8800-EXIT
  8437                 END-IF
  8438              END-IF
  8439              IF AM-COM-TYP (SUB5) = 'I'
  8440                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8441                   + (WS-WK-RATE * 1000)
  8442              END-IF
  8443              IF AM-COM-TYP (SUB5) = 'N'
  8444                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8445                   + (WS-WK-RATE * 1000)
  8446              END-IF
  8447              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8448                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8449                   + (WS-WK-RATE * 1000)
  8450              END-IF
  8451              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8452                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8453                   + (WS-WK-RATE * 1000)
  8454              END-IF
  8455           END-IF
  8456        END-PERFORM
  8457     END-IF
  8458     GO TO 0300-CONTINUE-EDIT.
  8459
  8460 0298-UNLOCK-RETURN.
  8461      PERFORM 9250-UNLOCK-RETURN
  8462      GO TO 9990-RETURN.
  8463
  8464 0299-CERT-NOT-FOUND.
  8465
  8466     MOVE '1'                     TO CERT-STATUS-SW.
  8467
  8468     IF PB-COMPANY-ID = 'UCL'
  8469         IF WS-ERROR = ER-2799
  8470             GO TO 3000-CONTINUE-EDIT.
  8471
  8472     IF NOT PB-CANCELLATION
  8473         GO TO 0300-CONTINUE-EDIT.
  8474
  8475     MOVE ER-2726                  TO  WS-ERROR.
  8476     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8477     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8478     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8479                                    PB-CI-LF-TERM
  8480                                    PB-C-LF-REM-TERM
  8481                                    PB-CI-AH-TERM
  8482                                    PB-C-AH-REM-TERM
  8483                                    PB-CI-LF-BENEFIT-CD
  8484                                    PB-CI-LF-BENEFIT-AMT
  8485                                    PB-CI-LF-ALT-BENEFIT-AMT
  8486                                    PB-CI-LF-PREMIUM-AMT
  8487                                    PB-CI-LF-ALT-PREMIUM-AMT
  8488                                    PB-CI-AH-BENEFIT-CD
  8489                                    PB-CI-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 155
* EL050.cbl
  8490                                    PB-CI-AH-PREMIUM-AMT
  8491                                    PB-CI-PAY-FREQUENCY
  8492                                    PB-CI-LOAN-APR
  8493                                    PB-CI-LOAN-TERM
  8494                                    PB-CI-LIFE-COMMISSION
  8495                                    PB-CI-AH-COMMISSION
  8496                                    PB-CI-CURR-SEQ
  8497                                    PB-CI-AH-CANCEL-AMT
  8498                                    PB-CI-LF-CANCEL-AMT
  8499                                    PB-CI-RATE-DEV-PCT-LF
  8500                                    PB-CI-RATE-DEV-PCT-AH
  8501                                    PB-CI-EXTENTION-DAYS
  8502                                    PB-CI-TERM-IN-DAYS
  8503                                    PB-CI-LIVES
  8504                                    PB-CI-LF-CRIT-PER
  8505                                    PB-CI-AH-CRIT-PER
  8506                                    PB-CI-ADDL-CLP
  8507                                    PB-CI-DDF-IU-RATE-UP.
  8508
  8509     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8510                                    PB-CI-AH-SETTLEMENT-DT
  8511                                    PB-CI-DEATH-DT
  8512                                    PB-CI-LF-PRIOR-CANCEL-DT
  8513                                    PB-CI-AH-PRIOR-CANCEL-DT
  8514                                    PB-CI-ENTRY-DT
  8515                                    PB-CI-LF-EXPIRE-DT
  8516                                    PB-CI-AH-EXPIRE-DT
  8517                                    PB-CI-LOAN-1ST-PMT-DT.
  8518
  8519     IF ACCOUNT-MAST-FOUND
  8520        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8521        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8522
  8523
  8524 0300-CONTINUE-EDIT.
  8525
  8526     IF PB-ISSUE
  8527        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8528            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8529
  8530     IF PB-ISSUE
  8531        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8532            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8533
  8534     IF PB-ISSUE
  8535       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8536          (AM-NO-AH-ONLY)
  8537           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8538               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8539                   MOVE ER-2679 TO WS-ERROR
  8540                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8541
  8542     IF PB-ISSUE
  8543        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8544        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8545        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8546     ELSE
  8547        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 156
* EL050.cbl
  8548        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8549        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8550
  8551     MOVE 'N'                    TO PLAN-MASTER-SW
  8552                                    PLAN-MASTER-LIFE-SW
  8553                                    FORM-MASTER-SW
  8554                                    WS-APP-CERT-SW.
  8555
  8556     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8557                                    WS-PL-TOL-LF-REFUND
  8558                                    WS-PL-REF-OVS-AMT
  8559                                    WS-PL-TOL-LF-PREM-PCT
  8560                                    WS-PL-TOL-LF-REFUND-PCT
  8561                                    WS-PL-REF-OVS-PCT
  8562                                    WS-PL-TOL-LF-CLAIM.
  8563
  8564     IF PB-COMPANY-ID = 'NCL'
  8565       IF PB-ISSUE
  8566         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8567             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8568             IF FORM-MASTER-FOUND
  8569                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8570
  8571     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8572        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8573
  8574********************** MON CODE **********************
  8575     IF PB-COMPANY-ID = 'MON'
  8576     IF PB-ISSUE
  8577     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8578        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8579             PB-I-LOAN-APR = ZERO)
  8580               MOVE 14.0         TO PB-I-LOAN-APR.
  8581******************************************************
  8582
  8583     IF PB-COMPANY-ID = 'NCL'
  8584       IF PB-ISSUE
  8585           IF FORM-MASTER-FOUND
  8586             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8587                AM-DISMBR-COVERAGE
  8588                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8589                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8590                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8591                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8592                                           PB-I-LIFE-BENEFIT-CD.
  8593
  8594     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8595
  8596     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8597         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8598         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8599         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8600         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8601         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8602           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8603             GO TO 0301-LIFE-BENEFIT-SEARCH
  8604         ELSE
  8605             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 157
* EL050.cbl
  8606     ELSE
  8607         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8608
  8609     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8610     MOVE '4'                    TO CNTL-REC-TYPE.
  8611     MOVE +0                     TO CNTL-SEQ-NO.
  8612     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8613
  8614     MOVE '1' TO RC-SW-2.
  8615     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8616
  8617     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8618        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8619         GO TO 0305-BENEFIT-NOT-FOUND.
  8620
  8621     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8622
  8623 0301-LIFE-BENEFIT-SEARCH.
  8624
  8625     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8626
  8627     IF NO-BENEFIT-FOUND
  8628        GO TO 0305-BENEFIT-NOT-FOUND.
  8629
  8630     IF WS-BEN-CD = '99'
  8631        GO TO 0305-BENEFIT-NOT-FOUND.
  8632
  8633     IF PB-COMPANY-ID = 'NCL'
  8634         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8635             GO TO 0304-LIFE-BENEFIT-FOUND.
  8636
  8637     MOVE +1                     TO SUB5.
  8638     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8639
  8640* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8641* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8642     IF PB-COMPANY-ID = 'DMD'
  8643         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8644
  8645 0302-EDIT-ACCT-LF-BENEFITS.
  8646
  8647     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8648        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8649           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8650                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8651           GO TO 03XX-GET-LIFE-ERPLAN.
  8652
  8653     IF SUB5 LESS THAN +20
  8654        ADD +1                   TO SUB5
  8655        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8656
  8657     MOVE +1                     TO SUB5.
  8658
  8659     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8660        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8661
  8662 0303-EDIT-DMD-EXTRA-BENEFITS.
  8663
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 158
* EL050.cbl
  8664     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8665        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8666           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8667                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8668           GO TO 03XX-GET-LIFE-ERPLAN.
  8669
  8670     IF SUB5 LESS THAN +30
  8671        ADD +1                   TO SUB5
  8672        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8673
  8674     MOVE +1                     TO SUB5.
  8675
  8676 03XX-EDIT-FOR-NINETY-LF.
  8677
  8678***************************************************************
  8679*                                                             *
  8680*    NINETY BENEFIT PLAN TYPES:                               *
  8681*                                                             *
  8682*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8683*      92 = ALL GROUP REDUCING BENEFITS                       *
  8684*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8685*      94 = ALL GROUP LEVEL BENEFITS                          *
  8686*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8687*           BENEFIT CONTROLS.                                 *
  8688*      99 = ALL BENEFITS                                      *
  8689*                                                             *
  8690***************************************************************
  8691
  8692     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8693                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8694
  8695     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8696       AND
  8697        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8698        GO TO 03XX-GET-LIFE-ERPLAN.
  8699
  8700     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8701       AND
  8702        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8703        IF CF-REDUCING (SUB3)
  8704           IF (PB-I-INDV-GRP-OVRD = 'I')
  8705              OR
  8706           ((AM-IG = '1') AND
  8707           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8708              OR
  8709           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8710           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8711           (AM-IG NOT = '2'))
  8712              GO TO 03XX-GET-LIFE-ERPLAN.
  8713
  8714     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8715       AND
  8716        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8717        IF CF-REDUCING (SUB3)
  8718           IF (PB-I-INDV-GRP-OVRD = 'G')
  8719              OR
  8720           ((AM-IG = '2') AND
  8721           (PB-I-INDV-GRP-OVRD NOT = 'I'))
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 159
* EL050.cbl
  8722              OR
  8723           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8724           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8725           (AM-IG NOT = '1'))
  8726              GO TO 03XX-GET-LIFE-ERPLAN.
  8727
  8728     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8729       AND
  8730        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8731        IF CF-LEVEL    (SUB3)
  8732           IF (PB-I-INDV-GRP-OVRD = 'I')
  8733              OR
  8734           ((AM-IG = '1') AND
  8735           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8736              OR
  8737           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8738           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8739            (AM-IG NOT = '2'))
  8740              GO TO 03XX-GET-LIFE-ERPLAN.
  8741
  8742     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8743       AND
  8744        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8745        IF CF-LEVEL    (SUB3)
  8746           IF (PB-I-INDV-GRP-OVRD = 'G')
  8747              OR
  8748           ((AM-IG = '2') AND
  8749           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8750              OR
  8751           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8752           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8753           (AM-IG NOT = '1'))
  8754              GO TO 03XX-GET-LIFE-ERPLAN.
  8755
  8756     IF SUB5 LESS THAN +20
  8757        ADD +1                   TO SUB5
  8758        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8759
  8760     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8761
  8762     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8763        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8764
  8765     MOVE +1                     TO SUB5.
  8766
  8767 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8768
  8769     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8770                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8771
  8772     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8773       AND
  8774        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8775        GO TO 03XX-GET-LIFE-ERPLAN.
  8776
  8777     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8778       AND
  8779        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 160
* EL050.cbl
  8780        IF CF-REDUCING (SUB3)
  8781           IF (PB-I-INDV-GRP-OVRD = 'I')
  8782              OR
  8783           ((AM-IG = '1') AND
  8784           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8785              OR
  8786           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8787           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8788           (AM-IG NOT = '2'))
  8789              GO TO 03XX-GET-LIFE-ERPLAN.
  8790
  8791     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8792       AND
  8793        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8794        IF CF-REDUCING (SUB3)
  8795           IF (PB-I-INDV-GRP-OVRD = 'G')
  8796              OR
  8797           ((AM-IG = '2') AND
  8798           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8799              OR
  8800           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8801           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8802           (AM-IG NOT = '1'))
  8803              GO TO 03XX-GET-LIFE-ERPLAN.
  8804
  8805     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8806       AND
  8807        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8808        IF CF-LEVEL    (SUB3)
  8809           IF (PB-I-INDV-GRP-OVRD = 'I')
  8810              OR
  8811           ((AM-IG = '1') AND
  8812           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8813              OR
  8814           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8815           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8816            (AM-IG NOT = '2'))
  8817              GO TO 03XX-GET-LIFE-ERPLAN.
  8818
  8819     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8820       AND
  8821        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8822        IF CF-LEVEL    (SUB3)
  8823           IF (PB-I-INDV-GRP-OVRD = 'G')
  8824              OR
  8825           ((AM-IG = '2') AND
  8826           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8827              OR
  8828           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8829           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8830           (AM-IG NOT = '1'))
  8831              GO TO 03XX-GET-LIFE-ERPLAN.
  8832
  8833     IF SUB5 LESS THAN +30
  8834        ADD +1                   TO SUB5
  8835        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8836
  8837     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 161
* EL050.cbl
  8838
  8839 03XX-EDIT-FOR-NINETY-LF-CONT.
  8840
  8841     MOVE +99                    TO SUB5.
  8842
  8843     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8844        IF PB-ISSUE
  8845           MOVE ER-1924          TO  WS-ERROR
  8846           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8847
  8848     GO TO 0304-LIFE-BENEFIT-FOUND.
  8849
  8850 03XX-GET-LIFE-ERPLAN.
  8851
  8852     IF WK-PLAN-ADDR EQUAL +0
  8853        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8854
  8855     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8856     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8857     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8858     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8859     MOVE 'Y'                    TO PLAN-MASTER-SW
  8860                                    PLAN-MASTER-LIFE-SW.
  8861     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8862
  8863 03XX-ERPLAN-LIFE-GETMAIN.
  8864
  8865     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8866     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8867
  8868 03XX-ERPLAN-LIFE-READ.
  8869
  8870     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8871     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8872     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8873     MOVE PB-SV-STATE            TO PLAN-STATE.
  8874     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8875     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8876     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8877     MOVE WS-SAVE-BENEFIT-REVISION
  8878                                 TO PLAN-REVISION-NO.
  8879
  8880     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8881     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8882
  8883     IF PB-COMPANY-ID = 'NCL'
  8884       IF NOT LF-PLAN-MASTER-FOUND
  8885         IF NOT PB-POLICY-IS-DECLINED  AND
  8886            NOT PB-POLICY-IS-VOIDED
  8887             MOVE  ER-1921         TO  WS-ERROR
  8888             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8889             GO TO 0304-LIFE-BENEFIT-FOUND.
  8890
  8891     IF NOT LF-PLAN-MASTER-FOUND
  8892        GO TO 0304-LIFE-BENEFIT-FOUND.
  8893
  8894 XXXX-CHECK-LF-PLAN-KEY.
  8895
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 162
* EL050.cbl
  8896     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8897        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8898        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8899        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8900        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8901        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8902        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8903        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8904        MOVE 'N'                 TO PLAN-MASTER-SW
  8905          GO TO 03XX-ERPLAN-LIFE-READ.
  8906
  8907     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8908
  8909     IF  PB-CANCELLATION
  8910         GO TO  0303-LF-ACCT-BEN-FOUND.
  8911
  8912     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8913        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8914           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8915           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8916              MOVE ER-2644             TO WS-ERROR
  8917              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8918           ELSE
  8919              NEXT SENTENCE
  8920        ELSE
  8921           IF PB-COMPANY-ID NOT = 'NCL'
  8922              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8923                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8924
  8925 0303-LF-ACCT-BEN-FOUND.
  8926
  8927     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8928
  8929     IF PL-DEV-CODE NOT = SPACES
  8930        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8931
  8932     IF PL-DEV-PCT NUMERIC AND
  8933        PL-DEV-PCT NOT = ZEROS
  8934        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8935
  8936     IF PL-TOL-PREM-AMT GREATER THAN +0
  8937        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8938
  8939     IF PL-TOL-REF-AMT GREATER THAN +0
  8940        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8941
  8942     IF PL-TOL-PREM-PCT GREATER THAN +0
  8943        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8944
  8945     IF PL-TOL-REF-PCT GREATER THAN +0
  8946        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8947
  8948     IF PL-TOL-CLM-AMT GREATER THAN +0
  8949        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8950
  8951     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8952                          PL-OVER-SHORT-AMT > +0
  8953        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 163
* EL050.cbl
  8954
  8955     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8956                          PL-OVER-SHORT-PCT > +0
  8957        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8958
  8959     IF PL-SALES-TAX NUMERIC AND
  8960                          PL-SALES-TAX > +0
  8961         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8962
  8963     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8964        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8965                                    WS-IG-OVRD-AM.
  8966
  8967 0304-LIFE-BENEFIT-FOUND.
  8968
  8969     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8970
  8971     IF PB-ISSUE
  8972        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8973     ELSE
  8974        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8975
  8976     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8977     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8978     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8979     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8980     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8981                                         WS-LF-REFUND-CALC.
  8982     if (ws-lf-earnings-calc = '5')
  8983        and (pb-i-loan-apr = zeros)
  8984        and (benefit-code-chg)
  8985        move +99.9999 to pb-i-loan-apr
  8986     end-if
  8987
  8988     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8989        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8990
  8991     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8992        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8993     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8994
  8995     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8996     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8997     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8998     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8999     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9000     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9001
  9002     IF PB-COMPANY-ID = 'NCL'  AND
  9003        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9004         NEXT SENTENCE
  9005     ELSE
  9006         IF SUB5 NOT GREATER THAN +20
  9007            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9008               MOVE WS-SAVE-BENEFIT-REM-TERM
  9009                                      TO WS-AM-LF-BENE-REM-TERM
  9010                                         EC-BR-LF-REM-TERM-CALC.
  9011
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 164
* EL050.cbl
  9012     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9013     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9014
  9015     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9016
  9017 0305-BENEFIT-NOT-FOUND.
  9018
  9019     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9020     MOVE ER-2604                TO WS-ERROR.
  9021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9022
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 165
* EL050.cbl
  9024
  9025 0310-FIND-AH-BENEFIT-RECORD.
  9026
  9027     MOVE 'N'                    TO PLAN-MASTER-SW
  9028                                    PLAN-MASTER-AH-SW.
  9029
  9030     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9031                                    WS-PL-TOL-AH-REFUND
  9032                                    WS-AH-PL-REF-OVS-AMT
  9033                                    WS-PL-TOL-AH-PREM-PCT
  9034                                    WS-PL-TOL-AH-REFUND-PCT
  9035                                    WS-AH-PL-REF-OVS-PCT
  9036                                    WS-PL-TOL-AH-CLAIM.
  9037     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9038
  9039
  9040     if pb-issue
  9041        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9042           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9043        end-if
  9044        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9045           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9046           GO TO 0399-BENEFIT-NOT-FOUND
  9047        end-if
  9048     end-if
  9049
  9050     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9051        GO TO 0400-FIND-CARRIER.
  9052
  9053     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9054
  9055     IF WK-AH-BEN-ADDR NOT = ZEROS
  9056         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9057         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9058         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9059         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9060           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9061             GO TO 0311-AH-BENEFIT-SEARCH
  9062         ELSE
  9063             NEXT SENTENCE
  9064     ELSE
  9065         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9066
  9067     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9068     MOVE '5'                    TO CNTL-REC-TYPE.
  9069     MOVE +0                     TO CNTL-SEQ-NO.
  9070     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9071
  9072     MOVE '2' TO RC-SW-2.
  9073     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9074
  9075     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9076        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9077          GO TO 0399-BENEFIT-NOT-FOUND.
  9078
  9079     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9080
  9081 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 166
* EL050.cbl
  9082
  9083     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9084
  9085     IF NO-BENEFIT-FOUND
  9086         GO TO 0399-BENEFIT-NOT-FOUND.
  9087
  9088     IF WS-BEN-CD = '99'
  9089        GO TO 0399-BENEFIT-NOT-FOUND.
  9090
  9091     IF PB-COMPANY-ID  =  'NCL'
  9092         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9093             GO TO 0314-A-H-BENEFIT-FOUND.
  9094
  9095     MOVE +1                     TO SUB5.
  9096     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9097
  9098* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9099* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9100     IF PB-COMPANY-ID = 'DMD'
  9101         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9102
  9103 0312-EDIT-ACCT-AH-BENEFITS.
  9104
  9105     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9106        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9107           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9108                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9109           GO TO 03XX-GET-AH-ERPLAN.
  9110
  9111     IF SUB5 LESS THAN +20
  9112        ADD +1                   TO SUB5
  9113        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9114
  9115     MOVE +1                     TO SUB5.
  9116
  9117     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9118        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9119
  9120 0313-EDIT-DMD-EXTRA-BENEFITS.
  9121
  9122     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9123        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9124           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9125                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9126           GO TO 03XX-GET-AH-ERPLAN.
  9127
  9128     IF SUB5 LESS THAN +30
  9129        ADD +1                   TO SUB5
  9130        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9131
  9132     MOVE +1                     TO SUB5.
  9133
  9134 03XX-EDIT-FOR-NINETY-AH.
  9135
  9136***************************************************************
  9137*                                                             *
  9138*    NINETY BENEFIT PLAN TYPES:                               *
  9139*                                                             *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 167
* EL050.cbl
  9140*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9141*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9142*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9143*           BENEFIT CONTROLS.                                 *
  9144*      99 = ALL BENEFITS.                                     *
  9145*                                                             *
  9146***************************************************************
  9147
  9148     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9149                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9150
  9151     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9152       AND
  9153        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9154        GO TO 03XX-GET-AH-ERPLAN.
  9155
  9156     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9157       AND
  9158        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9159           IF (PB-I-INDV-GRP-OVRD = 'I')
  9160              OR
  9161           ((AM-IG = '1') AND
  9162           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9163              OR
  9164           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9165           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9166           (AM-IG NOT = '2'))
  9167              GO TO 03XX-GET-AH-ERPLAN.
  9168
  9169     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9170       AND
  9171        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9172           IF (PB-I-INDV-GRP-OVRD = 'G')
  9173              OR
  9174           ((AM-IG = '2') AND
  9175           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9176              OR
  9177           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9178           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9179           (AM-IG NOT = '1'))
  9180              GO TO 03XX-GET-AH-ERPLAN.
  9181
  9182     IF SUB5 LESS THAN +20
  9183        ADD +1                   TO SUB5
  9184        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9185
  9186     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9187        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9188
  9189     MOVE +1                    TO SUB5.
  9190
  9191 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9192
  9193     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9194                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9195
  9196     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9197       AND
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 168
* EL050.cbl
  9198        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9199        GO TO 03XX-GET-AH-ERPLAN.
  9200
  9201     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9202       AND
  9203        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9204           IF (PB-I-INDV-GRP-OVRD = 'I')
  9205              OR
  9206           ((AM-IG = '1') AND
  9207           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9208              OR
  9209           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9210           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9211           (AM-IG NOT = '2'))
  9212              GO TO 03XX-GET-AH-ERPLAN.
  9213
  9214     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9215       AND
  9216        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9217           IF (PB-I-INDV-GRP-OVRD = 'G')
  9218              OR
  9219           ((AM-IG = '2') AND
  9220           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9221              OR
  9222           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9223           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9224           (AM-IG NOT = '1'))
  9225              GO TO 03XX-GET-AH-ERPLAN.
  9226
  9227     IF SUB5 LESS THAN +30
  9228        ADD +1                   TO SUB5
  9229        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9230
  9231 03XX-EDIT-FOR-NINETY-AH-CONT.
  9232
  9233     MOVE +99                    TO SUB5.
  9234
  9235     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9236
  9237     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9238        IF PB-ISSUE
  9239           MOVE ER-1925          TO  WS-ERROR
  9240           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9241
  9242     GO TO 0314-A-H-BENEFIT-FOUND.
  9243
  9244 03XX-GET-AH-ERPLAN.
  9245
  9246     IF WK-PLAN-ADDR EQUAL +0
  9247         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9248
  9249     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9250     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9251     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9252     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9253     MOVE 'Y'                    TO PLAN-MASTER-SW
  9254                                    PLAN-MASTER-AH-SW.
  9255*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 169
* EL050.cbl
  9256     GO TO 03XX-ERPLAN-AH-READ.
  9257
  9258 03XX-ERPLAN-AH-GETMAIN.
  9259
  9260     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9261     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9262
  9263 03XX-ERPLAN-AH-READ.
  9264
  9265     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9266     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9267     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9268     MOVE PB-SV-STATE            TO PLAN-STATE.
  9269     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9270     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9271     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9272     MOVE WS-SAVE-BENEFIT-REVISION
  9273                                 TO PLAN-REVISION-NO.
  9274
  9275     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9276     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9277
  9278     IF PB-COMPANY-ID = 'NCL'
  9279       IF NOT AH-PLAN-MASTER-FOUND
  9280         IF NOT PB-POLICY-IS-DECLINED  AND
  9281            NOT PB-POLICY-IS-VOIDED
  9282             MOVE  ER-1922         TO  WS-ERROR
  9283             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9284             GO TO 0314-A-H-BENEFIT-FOUND.
  9285
  9286     IF NOT AH-PLAN-MASTER-FOUND
  9287        GO TO 0314-A-H-BENEFIT-FOUND.
  9288
  9289 XXXX-CHECK-AH-PLAN-KEY.
  9290
  9291     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9292        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9293        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9294        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9295        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9296        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9297        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9298        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9299        MOVE 'N'                 TO PLAN-MASTER-SW
  9300          GO TO 03XX-ERPLAN-AH-READ.
  9301
  9302     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9303
  9304     IF  PB-CANCELLATION
  9305         GO TO  0313-AH-ACCT-BEN-FOUND.
  9306
  9307     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9308       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9309          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9310          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9311             MOVE ER-2644             TO WS-ERROR
  9312             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9313          ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 170
* EL050.cbl
  9314             NEXT SENTENCE
  9315       ELSE
  9316          IF PB-COMPANY-ID NOT = 'NCL'
  9317             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9318                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9319
  9320 0313-AH-ACCT-BEN-FOUND.
  9321
  9322     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9323
  9324     IF PL-DEV-CODE NOT = SPACES
  9325        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9326
  9327     IF PL-DEV-PCT NUMERIC AND
  9328        PL-DEV-PCT NOT = ZEROS
  9329        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9330
  9331     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9332        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9333
  9334     IF PL-TOL-REF-AMT NOT EQUAL +0
  9335        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9336
  9337     IF PL-TOL-PREM-PCT GREATER THAN +0
  9338        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9339
  9340     IF PL-TOL-REF-PCT GREATER THAN +0
  9341        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9342
  9343     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9344        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9345
  9346     IF PL-OVER-SHORT-AMT NUMERIC AND
  9347                          PL-OVER-SHORT-AMT > +0
  9348        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9349
  9350     IF PL-OVER-SHORT-PCT NUMERIC AND
  9351                          PL-OVER-SHORT-PCT > +0
  9352        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9353
  9354     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9355        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9356        IF WS-IG-OVRD-AM EQUAL SPACES
  9357            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9358
  9359 0314-A-H-BENEFIT-FOUND.
  9360
  9361     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9362
  9363     IF PB-ISSUE
  9364        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9365       ELSE
  9366        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9367
  9368     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9369     if cf-maximum-benefits (sub3) numeric
  9370        move cf-maximum-benefits (sub3)
  9371                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 171
* EL050.cbl
  9372     else
  9373        move zeros               to ws-ah-max-bens
  9374     end-if
  9375     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9376     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9377     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9378                                         WS-AH-REFUND-CALC.
  9379
  9380     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9381        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9382
  9383     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9384        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9385     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9386
  9387     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9388     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9389     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9390     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9391     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9392     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9393
  9394     IF PB-COMPANY-ID = 'NCL'  AND
  9395        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9396         NEXT SENTENCE
  9397     ELSE
  9398         IF SUB5 NOT GREATER THAN +20
  9399            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9400                MOVE WS-SAVE-BENEFIT-REM-TERM
  9401                                      TO WS-AM-AH-BENE-REM-TERM
  9402                                         EC-BR-AH-REM-TERM-CALC.
  9403
  9404     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9405     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9406
  9407     GO TO 0400-FIND-CARRIER.
  9408
  9409 0399-BENEFIT-NOT-FOUND.
  9410
  9411     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9412     MOVE ER-2605                TO WS-ERROR.
  9413     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9414
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 172
* EL050.cbl
  9416
  9417 0400-FIND-CARRIER.
  9418
  9419     MOVE PB-SV-CARRIER          TO WS-CARR.
  9420
  9421     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9422     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9423     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9424     MOVE '6'                    TO CNTL-REC-TYPE.
  9425
  9426*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9427     MOVE SPACE                  TO WS-DMD-RATING-SW
  9428                                    EC-BR-DMD-RATING-SW.
  9429
  9430     MOVE '2'                    TO RC-SW-1.
  9431     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9432
  9433     IF NOT CF-CARRIER-MASTER
  9434        GO TO 0400-CARRIER-NOT-FOUND.
  9435
  9436 0400-BUILD-CARR-TOL.
  9437
  9438     IF CF-CR-TOL-PREM NUMERIC AND
  9439        CF-CR-TOL-PREM GREATER THAN +0
  9440        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9441                                    WS-TOL-AH-PREM.
  9442
  9443     IF CF-CR-TOL-REFUND NUMERIC AND
  9444        CF-CR-TOL-REFUND GREATER THAN +0
  9445        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9446                                    WS-TOL-AH-REFUND.
  9447
  9448     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9449        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9450        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9451                                    WS-AH-REFUND-OVS-AMT.
  9452
  9453     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9454        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9455        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9456                                    WS-AH-REFUND-OVS-PCT.
  9457
  9458     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9459        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9460        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9461                                    WS-TOL-AH-PREM-PCT.
  9462
  9463     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9464        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9465        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9466                                     WS-TOL-AH-REFUND-PCT.
  9467
  9468     IF CF-COMPANY-ID EQUAL 'DMD'
  9469         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9470                                    EC-BR-DMD-RATING-SW.
  9471
  9472     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9473     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 173
* EL050.cbl
  9474        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9475     END-IF
  9476     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9477        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9478     END-IF
  9479     IF WS-TOL-CLP-PCT = ZEROS
  9480        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9481     END-IF
  9482
  9483     IF WS-SPP-LEASE-COMM = ZEROS
  9484        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9485     END-IF
  9486     GO TO 0400-FIND-ERPDEF.
  9487
  9488 0400-CARRIER-NOT-FOUND.
  9489
  9490     MOVE ER-2602                TO WS-ERROR.
  9491     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9492
  9493 0400-FIND-ERPDEF.
  9494*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9495     IF (PB-COMPANY-ID = 'DCC')
  9496        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9497        CONTINUE
  9498     ELSE
  9499        GO TO 0400-FIND-ERCOMP
  9500     END-IF
  9501     MOVE ' '                    TO PDEF-MASTER-SW
  9502     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9503     MOVE PB-STATE               TO ERPDEF-STATE
  9504     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9505        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9506     END-IF
  9507     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9508     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9509     IF PB-ISSUE
  9510        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9511     ELSE
  9512        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9513     END-IF
  9514     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9515     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9516     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9517     IF PDEF-MASTER-FOUND
  9518        MOVE 'N'                 TO PDEF-MASTER-SW
  9519        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9520        IF PDEF-MASTER-FOUND
  9521           IF (ERPDEF-KEY-SAVE (1:16) =
  9522                        PD-CONTROL-PRIMARY (1:16))
  9523              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9524              CONTINUE
  9525           ELSE
  9526              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9527              IF (ERPDEF-KEY-SAVE (1:16) =
  9528                        PD-CONTROL-PRIMARY (1:16))
  9529                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9530                 CONTINUE
  9531              ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 174
* EL050.cbl
  9532                 MOVE 'N'        TO PDEF-MASTER-SW
  9533              END-IF
  9534           END-IF
  9535        END-IF
  9536        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9537     END-IF
  9538     IF PDEF-MASTER-FOUND
  9539        IF PD-TRUNCATED = 'Y'
  9540           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9541        END-IF
  9542     END-IF
  9543     .
  9544 0400-FIND-ERCOMP.
  9545     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9546        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9547           (WS-SUB1 > +10)
  9548           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9549                 OR 'A' OR 'N'
  9550              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9551              MOVE PB-CARRIER    TO COMP-CARRIER
  9552              MOVE PB-GROUPING   TO COMP-GROUPING
  9553              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9554              MOVE AM-AGT (WS-SUB1)
  9555                                 TO COMP-FIN-RESP
  9556              MOVE 'G'           TO COMP-TYPE
  9557              PERFORM 8582-READ-COMPENSATION-MASTER
  9558                                 THRU 8582-EXIT
  9559              IF COMP-MASTER-FOUND
  9560                 IF CO-GA-INACTIVE
  9561                    MOVE ER-2763 TO WS-ERROR
  9562                    PERFORM 9900-ERROR-FORMAT
  9563                                 THRU 9900-EXIT
  9564                    MOVE +11     TO WS-SUB1
  9565                 END-IF
  9566                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9567                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9568                    MOVE ER-2788 TO WS-ERROR
  9569                    PERFORM 9900-ERROR-FORMAT
  9570                                 THRU 9900-EXIT
  9571                    MOVE +11     TO WS-SUB1
  9572                 END-IF
  9573              END-IF
  9574           END-IF
  9575        END-PERFORM
  9576     END-IF
  9577     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9578        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9579           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9580                                    WS-CLP-STATE
  9581        ELSE
  9582           MOVE SPACES           TO PB-I-CLP-STATE
  9583                                    WS-CLP-STATE
  9584        END-IF
  9585     END-IF
  9586
  9587     IF (PB-COMPANY-ID = 'DCC')
  9588        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9589        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 175
* EL050.cbl
  9590        CONTINUE
  9591     ELSE
  9592        GO TO 0400-FIND-STATE-RECORD
  9593     END-IF
  9594     MOVE SPACES                 TO WS-CLP-STATE
  9595     MOVE +0                     TO WS-BANK-FEE
  9596                                    WS-BANK-LFEE
  9597                                    WS-BANK-NOCHRGB
  9598
  9599     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9600     IF (PB-ISSUE)
  9601        AND (PB-I-BANK-NUMBER NOT =
  9602            SPACES AND ZEROS AND LOW-VALUES)
  9603        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9604     ELSE
  9605        IF (PB-CANCELLATION)
  9606           AND (PB-CI-BANK-NUMBER NOT =
  9607                SPACES AND ZEROS AND LOW-VALUES)
  9608           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9609        END-IF
  9610     END-IF
  9611     IF COMP-FIN-RESP NOT = LOW-VALUES
  9612        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9613        MOVE PB-CARRIER          TO COMP-CARRIER
  9614        MOVE PB-GROUPING         TO COMP-GROUPING
  9615        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9616        MOVE 'B'                 TO COMP-TYPE
  9617        PERFORM 8582-READ-COMPENSATION-MASTER
  9618                                 THRU 8582-EXIT
  9619        IF COMP-MASTER-FOUND
  9620           IF CO-MAX-BANK-FEE NOT NUMERIC
  9621              MOVE +0            TO CO-MAX-BANK-FEE
  9622           END-IF
  9623           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9624              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9625           END-IF
  9626           IF CO-GA-INACTIVE
  9627              MOVE ER-2763       TO WS-ERROR
  9628              PERFORM 9900-ERROR-FORMAT
  9629                                 THRU 9900-EXIT
  9630           END-IF
  9631           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9632              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9633              MOVE ER-2788 TO WS-ERROR
  9634              PERFORM 9900-ERROR-FORMAT
  9635                                 THRU 9900-EXIT
  9636              MOVE +11     TO WS-SUB1
  9637           END-IF
  9638           IF WS-AH-BEN-CATEGORY = 'G'
  9639              MOVE CO-MAX-BANK-FEE
  9640                                 TO WS-BANK-FEE
  9641                                    PB-I-BANK-FEE
  9642           ELSE
  9643              MOVE CO-MAX-BANK-FEE-LEASE
  9644                                 TO WS-BANK-LFEE
  9645                                    PB-I-BANK-FEE
  9646           END-IF
  9647           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 176
* EL050.cbl
  9648              AND (WS-AH-REFUND-CALC = 'G'))
  9649                        OR
  9650              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9651              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9652              CONTINUE
  9653           ELSE
  9654              MOVE ER-2789 TO WS-ERROR
  9655              PERFORM 9900-ERROR-FORMAT
  9656                                 THRU 9900-EXIT
  9657           END-IF
  9658           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9659                                    PB-I-CLP-STATE
  9660           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9661           MOVE CO-CARRIER       TO BXRF-CARRIER
  9662           MOVE CO-GROUPING      TO BXRF-GROUPING
  9663           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9664           MOVE BXRF-MAX-REC-LENGTH
  9665                                 TO BXRF-REC-LENGTH
  9666           PERFORM 8584-READ-BANK-CROSS-REF
  9667                                 THRU 8584-EXIT
  9668           IF BXRF-MASTER-FOUND
  9669              MOVE ' '           TO BANK-ACCT-SW
  9670              MOVE BK-BANK-POINTER-CNT
  9671                                 TO BK-BANK-POINTER-CNT
  9672              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9673                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9674                 OR (BANK-ACCT-FOUND)
  9675                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9676                    AND (BK-AM-EXP-DT (WS-SUB1)
  9677                                 > PB-CERT-EFF-DT)
  9678                    AND (BK-AM-EFF-DT (WS-SUB1)
  9679                                 NOT > PB-CERT-EFF-DT)
  9680                    SET BANK-ACCT-FOUND TO TRUE
  9681                 END-IF
  9682              END-PERFORM
  9683              IF NOT BANK-ACCT-FOUND
  9684                 MOVE ZEROS      TO WS-BANK-FEE
  9685                                    WS-BANK-LFEE
  9686                 MOVE ER-2869    TO WS-ERROR
  9687                 PERFORM 9900-ERROR-FORMAT
  9688                                 THRU 9900-EXIT
  9689              ELSE
  9690                 PERFORM 5000-PROCESS-REPS
  9691                                 THRU 5000-EXIT
  9692                 IF AGENT-MASTER-FOUND
  9693                    MOVE +0      TO WS-BANK-FEE
  9694                                    WS-BANK-LFEE
  9695*                   MOVE AG-SPP-FEES (1)
  9696*                                TO PB-I-BANK-FEE
  9697*                                   WS-BANK-FEE
  9698                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9699                       (WS-SUB1 > +10)
  9700                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9701                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9702                       END-IF
  9703                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9704                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9705                       END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 177
* EL050.cbl
  9706                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9707                          AG-SPP-FEES (WS-SUB1)
  9708                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9709                          AG-SPP-LFEES (WS-SUB1)
  9710                    END-PERFORM
  9711                    IF WS-AH-BEN-CATEGORY = 'G'
  9712                       MOVE WS-BANK-FEE
  9713                                 TO PB-I-BANK-FEE
  9714                    ELSE
  9715                       MOVE WS-BANK-LFEE
  9716                                 TO PB-I-BANK-FEE
  9717                    END-IF
  9718                 END-IF
  9719              END-IF
  9720           END-IF
  9721        ELSE
  9722           MOVE ER-2879          TO WS-ERROR
  9723           PERFORM 9900-ERROR-FORMAT
  9724                                 THRU 9900-EXIT
  9725        END-IF
  9726     ELSE
  9727        MOVE ER-2879             TO WS-ERROR
  9728        PERFORM 9900-ERROR-FORMAT
  9729                                 THRU 9900-EXIT
  9730     END-IF
  9731     IF WS-AH-BEN-CATEGORY = 'G'
  9732        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9733        + WS-BANK-FEE
  9734     ELSE
  9735        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9736        + WS-BANK-LFEE
  9737     END-IF
  9738     .
  9739 0400-FIND-STATE-RECORD.
  9740
  9741     IF WK-STATE-ADDR NOT = ZEROS
  9742         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9743         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9744         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9745         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9746         IF PB-SV-STATE = CF-STATE-CODE
  9747             GO TO 0405-CONTINUE-EDIT
  9748         ELSE
  9749             NEXT SENTENCE
  9750     ELSE
  9751         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9752
  9753     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9754     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9755     MOVE '3'                    TO CNTL-REC-TYPE.
  9756     MOVE +0                     TO CNTL-SEQ-NO.
  9757
  9758     MOVE '3'                    TO RC-SW-2.
  9759     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9760
  9761     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9762        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9763        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 178
* EL050.cbl
  9764        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9765                                    WS-TOL-AH-CLAIM
  9766                                    WS-MINIMUM-REFUND
  9767                                    WS-TOL-LF-PREM
  9768                                    WS-TOL-AH-PREM
  9769                                    WS-TOL-LF-REFUND
  9770                                    WS-TOL-AH-REFUND
  9771                                    EC-ST-TOL-PREM-PCT
  9772                                    WS-TOL-LF-PREM-PCT
  9773                                    WS-TOL-AH-PREM-PCT
  9774                                    EC-ST-TOL-REFUND-PCT
  9775                                    WS-TOL-LF-REFUND-PCT
  9776                                    WS-TOL-AH-REFUND-PCT
  9777                                    EC-ST-TOL-PREM
  9778                                    EC-ST-TOL-REFUND
  9779                                    EC-ST-FST-PMT-DAYS-MAX
  9780                                    WS-FREE-LOOK-PERIOD
  9781                                    WS-ST-LF-PREM-TAX
  9782                                    WS-ST-AH-PREM-TAX-I
  9783                                    WS-ST-AH-PREM-TAX-G
  9784                                    WS-BANK-FEE
  9785                                    WS-BANK-LFEE
  9786                                    WS-TOL-CLP-PCT
  9787                                    WS-SPP-LEASE-COMM
  9788                                    WS-INT-PERIODS
  9789                                    WS-EXTRA-PMTS
  9790        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9791                                    EC-ST-FST-PMT-DAYS-CHG
  9792                                    WS-LF-REM-TERM-CALC
  9793                                    WS-LF-REFUND-CALC
  9794                                    EC-ST-LF-REM-TERM-CALC
  9795                                    EC-ST-LF-REFUND-CALC
  9796                                    WS-AH-REM-TERM-CALC
  9797                                    WS-AH-REFUND-CALC
  9798                                    WS-LF-BEN-CATEGORY
  9799                                    WS-AH-BEN-CATEGORY
  9800                                    WS-CLP-STATE
  9801                                    WS-ST-REFUND-CLAIM-FLAG
  9802                                    WS-ST-CAUSAL-STATE
  9803                                    ws-st-agent-sig-edit
  9804                                    EC-ST-AH-REM-TERM-CALC
  9805                                    EC-ST-AH-REFUND-CALC
  9806          GO TO 0499-STATE-NOT-FOUND.
  9807
  9808     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9809
  9810 0405-CONTINUE-EDIT.
  9811
  9812     if pb-company-id = 'AHL'
  9813        continue
  9814     else
  9815        IF PB-CERT-PRIME NOT NUMERIC
  9816           MOVE ER-2722          TO WS-ERROR
  9817           PERFORM 9900-ERROR-FORMAT
  9818                                 THRU 9900-EXIT
  9819        end-if
  9820     END-IF
  9821*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 179
* EL050.cbl
  9822*       MOVE +0                  TO SUB3
  9823*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9824*       IF SUB3 > +0
  9825*          MOVE ER-2722          TO WS-ERROR
  9826*          PERFORM 9900-ERROR-FORMAT
  9827*                                THRU 9900-EXIT
  9828*       END-IF
  9829*    END-IF
  9830*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9831*       IF PB-CERT-PRIME NOT NUMERIC
  9832*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9833*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9834*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9835*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9836*
  9837*          MOVE ER-2722          TO WS-ERROR
  9838*          PERFORM 9900-ERROR-FORMAT
  9839*                                THRU 9900-EXIT
  9840*       END-IF
  9841*    END-IF
  9842
  9843     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9844
  9845     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9846        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9847                                    WS-TOL-AH-CLAIM.
  9848
  9849     IF CF-ST-REFUND-MIN NOT NUMERIC
  9850        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9851
  9852     IF CF-ST-REFUND-MIN NOT = ZEROS
  9853        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9854
  9855     IF CF-ST-TOL-PREM  NOT = ZEROS
  9856        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9857                                    WS-TOL-AH-PREM
  9858        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9859
  9860     IF CF-ST-TOL-REFUND NOT = ZEROS
  9861        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9862                                    WS-TOL-AH-REFUND
  9863        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9864
  9865     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9866        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9867        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9868                                    WS-AH-REFUND-OVS-AMT
  9869                                    EC-ST-OVR-SHT-AMT.
  9870
  9871     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9872        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9873        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9874                                    WS-TOL-LF-PREM-PCT
  9875                                    WS-TOL-AH-PREM-PCT.
  9876
  9877     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9878        CF-ST-TOL-REF-PCT GREATER THAN +0
  9879        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 180
* EL050.cbl
  9880                                    WS-TOL-LF-REFUND-PCT
  9881                                    WS-TOL-AH-REFUND-PCT.
  9882
  9883     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9884        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9885        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9886                                    WS-AH-REFUND-OVS-PCT
  9887                                    EC-ST-OVR-SHT-PCT.
  9888
  9889     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9890     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9891
  9892     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9893          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9894
  9895     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9896     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9897     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9898
  9899     IF CF-ST-LF-PREM-TAX NUMERIC
  9900        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9901     END-IF
  9902     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9903        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9904     END-IF
  9905     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9906        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9907     END-IF
  9908
  9909     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9910         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9911     END-IF.
  9912
  9913     IF CF-ST-CAUSAL-STATE > SPACES
  9914         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9915     END-IF.
  9916     if cf-st-extra-interest-periods not numeric
  9917        move zeros               to cf-st-extra-interest-periods
  9918     end-if
  9919     if cf-st-extra-payments not numeric
  9920        move zeros               to cf-st-extra-payments
  9921     end-if
  9922
  9923     move cf-st-extra-interest-periods
  9924                                 to ws-int-periods
  9925     move cf-st-extra-payments   to ws-extra-pmts
  9926     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9927     move cf-st-net-only-state   to ws-net-only-state
  9928     IF WS-LF-BENEFIT-CD = ZEROS
  9929        GO TO 0410-CHECK-AH.
  9930
  9931     IF CF-ST-RT-CALC NOT = SPACES
  9932        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9933                                    EC-ST-LF-REM-TERM-CALC
  9934     END-IF
  9935
  9936     IF WS-LF-COVERAGE-TYPE = 'R'
  9937        IF WS-LF-EARNINGS-CALC = '5'
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 181
* EL050.cbl
  9938           IF CF-ST-RF-LN-CALC > '0'
  9939              MOVE CF-ST-RF-LN-CALC
  9940                                 TO WS-LF-REFUND-CALC
  9941                                    EC-ST-LF-REFUND-CALC
  9942           END-IF
  9943        ELSE
  9944           IF CF-ST-RF-LR-CALC > '0'
  9945              MOVE CF-ST-RF-LR-CALC
  9946                                 TO WS-LF-REFUND-CALC
  9947                                    EC-ST-LF-REFUND-CALC
  9948           END-IF
  9949        END-IF
  9950     ELSE
  9951        IF CF-ST-RF-LL-CALC > '0'
  9952           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9953                                    EC-ST-LF-REFUND-CALC
  9954        END-IF
  9955     END-IF
  9956
  9957     IF CF-ST-RT-CALC NOT = SPACES
  9958        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9959                                    EC-ST-LF-REM-TERM-CALC
  9960     END-IF
  9961
  9962     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9963     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9964
  9965     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9966
  9967     IF NO-BENEFIT-FOUND
  9968        GO TO 0410-CHECK-AH.
  9969
  9970     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9971        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9972                                 TO EC-ST-LF-REM-TERM-CALC
  9973                                    WS-LF-REM-TERM-CALC
  9974     END-IF
  9975
  9976     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9977        MOVE CF-ST-REFUND-CALC (SUB3)
  9978                                 TO WS-LF-REFUND-CALC
  9979                                    EC-ST-LF-REFUND-CALC
  9980     END-IF
  9981*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9982     if cf-st-extra-periods (sub3) not numeric
  9983        move zeros               to cf-st-extra-periods (sub3)
  9984     end-if
  9985     if cf-st-extra-periods (sub3) > zeros
  9986        if ws-lf-ben-category = 'P'
  9987           move cf-st-extra-periods (sub3)
  9988                                 to ws-extra-pmts
  9989        else
  9990           if ws-lf-ben-category = 'I'
  9991              move cf-st-extra-periods (sub3)
  9992                                 to ws-int-periods
  9993           end-if
  9994        end-if
  9995     end-if
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 182
* EL050.cbl
  9996     .
  9997 0410-CHECK-AH.
  9998
  9999     IF WS-AH-BENEFIT-CD = ZEROS
 10000        GO TO 0500-SET-ACCOUNT.
 10001
 10002     IF CF-ST-RT-CALC NOT = SPACES
 10003        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10004                                    EC-ST-AH-REM-TERM-CALC
 10005     END-IF
 10006
 10007     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10008        IF CF-ST-RF-CP-CALC > '0'
 10009           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10010                                    EC-ST-AH-REFUND-CALC
 10011        END-IF
 10012     ELSE
 10013        IF CF-ST-RF-AH-CALC > '0'
 10014           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10015                                    EC-ST-AH-REFUND-CALC
 10016        END-IF
 10017     END-IF
 10018     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10019     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10020
 10021     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10022
 10023     IF NO-BENEFIT-FOUND
 10024        GO TO 0500-SET-ACCOUNT.
 10025
 10026     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10027        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10028                                 TO WS-AH-REM-TERM-CALC
 10029                                    EC-ST-AH-REM-TERM-CALC
 10030     END-IF
 10031
 10032     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10033        MOVE CF-ST-REFUND-CALC (SUB3)
 10034                                 TO WS-AH-REFUND-CALC
 10035                                    EC-ST-AH-REFUND-CALC
 10036     END-IF
 10037
 10038*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10039
 10040     GO TO 0500-SET-ACCOUNT.
 10041
 10042 0499-STATE-NOT-FOUND.
 10043
 10044     MOVE ER-2603                TO WS-ERROR.
 10045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10046
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 183
* EL050.cbl
 10048
 10049 0500-SET-ACCOUNT.
 10050*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10051     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10052        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10053        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10054        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10055        MOVE '3'                 TO CNTL-REC-TYPE
 10056        MOVE +0                  TO CNTL-SEQ-NO
 10057
 10058        MOVE '3'                 TO RC-SW-2
 10059        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10060
 10061        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10062           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10063           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10064           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10065                                    WS-ST-AH-PREM-TAX-I
 10066                                    WS-ST-AH-PREM-TAX-G
 10067        ELSE
 10068           IF CF-ST-LF-PREM-TAX NUMERIC
 10069              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10070           END-IF
 10071           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10072              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10073           END-IF
 10074           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10075              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10076           END-IF
 10077        END-IF
 10078        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10079     END-IF
 10080*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10081*  FOR DCC ONLY
 10082     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10083
 10084        MOVE ' '                 TO STAT-MASTER-SW
 10085        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10086        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10087        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10088        MOVE PB-STATE            TO ELSTAT-STATE
 10089        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10090           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10091        END-IF
 10092
 10093        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10094        SET BIN-TO-GREG          TO TRUE
 10095        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10096        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10097        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10098
 10099        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10100        IF STAT-MASTER-FOUND
 10101           MOVE 'N'              TO STAT-MASTER-SW
 10102           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10103           IF STAT-MASTER-FOUND
 10104              IF (ELSTAT-KEY-SAVE (1:12) =
 10105                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 184
* EL050.cbl
 10106                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10107                    MOVE 'F'        TO STAT-MASTER-SW
 10108                 ELSE
 10109                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10110                    IF (STAT-MASTER-FOUND)
 10111                       AND (ELSTAT-KEY-SAVE (1:12) =
 10112                           SF-CONTROL-PRIMARY (1:12))
 10113                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10114                       MOVE 'F'     TO STAT-MASTER-SW
 10115                    END-IF
 10116                 END-IF
 10117              END-IF
 10118           END-IF
 10119        END-IF
 10120
 10121        IF STAT-MASTER-SW = 'F'
 10122           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10123              and (sf-st-lf-prem-tax > zeros)
 10124              MOVE SF-ST-LF-PREM-TAX
 10125                                 TO WS-ST-LF-PREM-TAX
 10126           END-IF
 10127           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10128              and (sf-st-ah-prem-tax-i > zeros)
 10129              MOVE SF-ST-AH-PREM-TAX-I
 10130                                 TO WS-ST-AH-PREM-TAX-I
 10131           END-IF
 10132           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10133              and (sf-st-ah-prem-tax-g > zeros)
 10134              MOVE SF-ST-AH-PREM-TAX-G
 10135                                 TO WS-ST-AH-PREM-TAX-G
 10136           END-IF
 10137        END-IF
 10138     END-IF
 10139     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10140        AND (PB-ISSUE)
 10141        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10142        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10143        AND (AM-GPCD = 06)
 10144        MOVE 'Y'                 TO WS-GOOD-HIN
 10145        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10146           MOVE PB-I-VIN         TO WS-WORK-VIN
 10147           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10148              (V1 > 16)
 10149              IF WS-WORK-VIN (V1:1) NUMERIC
 10150                 MOVE WS-WORK-VIN-N (V1)
 10151                                 TO WS-ROW-B-VAL (V1)
 10152              ELSE
 10153                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10154                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10155                    OR (V2 > 26)
 10156                 END-PERFORM
 10157                 IF V2 < 27
 10158                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10159                 ELSE
 10160                    MOVE 'N'     TO WS-GOOD-HIN
 10161                 END-IF
 10162              END-IF
 10163              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 185
* EL050.cbl
 10164                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10165              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10166                 WS-ROW-D-VAL (V1)
 10167           END-PERFORM
 10168           MOVE ZEROS            TO WS-VIN-REMAINDER
 10169           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10170             REMAINDER WS-VIN-REMAINDER
 10171           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10172              CONTINUE
 10173           ELSE
 10174              MOVE 'N'           TO WS-GOOD-HIN
 10175           END-IF
 10176        ELSE
 10177           MOVE 'N'              TO WS-GOOD-HIN
 10178        END-IF
 10179        IF WS-GOOD-HIN NOT = 'Y'
 10180           MOVE ER-3826           TO WS-ERROR
 10181           PERFORM 9900-ERROR-FORMAT
 10182                                 THRU 9900-EXIT
 10183        END-IF
 10184     END-IF
 10185     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10186        AND (PB-ISSUE)
 10187        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10188        AND (AM-GPCD NOT = 06)
 10189        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10190           perform 3400-edit-vin thru 3400-exit
 10191        ELSE
 10192          MOVE ER-3826           TO WS-ERROR
 10193          PERFORM 9900-ERROR-FORMAT
 10194                                 THRU 9900-EXIT
 10195        END-IF
 10196     END-IF
 10197     if (pb-company-id = 'CID')
 10198        and (pb-issue)
 10199        and (pb-i-vin not = spaces and low-values and zeros)
 10200        perform 3400-edit-vin    thru 3400-exit
 10201     end-if
 10202******************************************************************
 10203******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10204******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10205******* METHODS.
 10206******************************************************************
 10207     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10208        IF PB-CANCELLATION
 10209           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10210              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10211                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10212                IF FORM-MASTER-FOUND
 10213                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10214******************************************************************
 10215
 10216     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10217     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10218
 10219     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10220     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10221     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 186
* EL050.cbl
 10222     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10223
 10224
 10225     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10226     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10227     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10228
 10229     IF AM-LF-OB-RATE NOT NUMERIC
 10230         MOVE ZERO               TO AM-LF-OB-RATE.
 10231
 10232     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10233         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10234
 10235     IF AM-AH-OB-RATE NOT NUMERIC
 10236         MOVE ZERO               TO AM-AH-OB-RATE.
 10237
 10238     IF WS-LF-JOINT-INDICATOR = 'J'
 10239         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10240     ELSE
 10241         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10242
 10243     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10244
 10245     IF WS-IG-OVRD-AM  EQUAL SPACE
 10246         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10247
 10248     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10249         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10250                                       WS-IG-OVRD
 10251     ELSE
 10252         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10253             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10254                                       WS-IG-OVRD
 10255         ELSE
 10256             MOVE AM-IG             TO WS-IG-OVRD-AH
 10257                                       WS-IG-OVRD.
 10258
 10259     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10260         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10261                                       WS-IG-OVRD
 10262     ELSE
 10263         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10264             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10265                                       WS-IG-OVRD
 10266         ELSE
 10267             MOVE AM-IG             TO WS-IG-OVRD-LF
 10268                                       WS-IG-OVRD.
 10269
 10270     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10271     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10272     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10273     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10274*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10275     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10276                                              TO 'PRLDSFCTIA'.
 10277
 10278     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10279     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 187
* EL050.cbl
 10280     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10281     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10282
 10283     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10284     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10285     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10286     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10287     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10288     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10289     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10290
 10291     IF WS-ACCT-AH-DEV-PCT > +0
 10292        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10293     ELSE
 10294        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10295
 10296     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10297        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10298     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10299        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10300
 10301        IF AM-EARN-METHOD-L = 'S'
 10302            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10303                                        WS-LF-REFUND-CALC.
 10304
 10305        IF AM-EARN-METHOD-R = 'S'
 10306            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10307                                        WS-LF-REFUND-CALC.
 10308
 10309     IF WS-LF-COVERAGE-TYPE = 'R'
 10310         IF AM-EARN-METHOD-R = 'R'
 10311            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10312                                    WS-LF-REFUND-CALC.
 10313     IF WS-LF-COVERAGE-TYPE = 'R'
 10314         IF AM-EARN-METHOD-R = 'P'
 10315            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10316                                    WS-LF-REFUND-CALC.
 10317     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10318         IF AM-EARN-METHOD-L = 'R'
 10319            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10320                                    WS-LF-REFUND-CALC.
 10321     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10322         IF AM-EARN-METHOD-L = 'P'
 10323            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10324                                    WS-LF-REFUND-CALC.
 10325     IF WS-LF-COVERAGE-TYPE = 'R'
 10326         IF AM-EARN-METHOD-R = 'A'
 10327            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10328                                    WS-LF-REFUND-CALC.
 10329     IF WS-LF-COVERAGE-TYPE = 'R'
 10330         IF AM-EARN-METHOD-R = 'M'
 10331            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10332                                    WS-LF-REFUND-CALC.
 10333     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10334         IF AM-EARN-METHOD-L = 'A'
 10335            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10336                                    WS-LF-REFUND-CALC.
 10337     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 188
* EL050.cbl
 10338         IF AM-EARN-METHOD-L = 'M'
 10339            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10340                                    WS-LF-REFUND-CALC.
 10341
 10342     IF AM-EARN-METHOD-A = 'R'
 10343        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10344                                    WS-AH-REFUND-CALC.
 10345     IF AM-EARN-METHOD-A = 'P'
 10346        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10347                                    WS-AH-REFUND-CALC.
 10348     IF AM-EARN-METHOD-A = 'C'
 10349        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10350                                    WS-AH-REFUND-CALC.
 10351     IF AM-EARN-METHOD-A = 'A'
 10352        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10353                                    WS-AH-REFUND-CALC.
 10354     IF AM-EARN-METHOD-A = 'M'
 10355        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10356                                    WS-AH-REFUND-CALC.
 10357     IF AM-EARN-METHOD-A = 'N'
 10358        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10359                                    WS-AH-REFUND-CALC.
 10360     IF AM-EARN-METHOD-A = 'S'
 10361        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10362                                    WS-AH-REFUND-CALC.
 10363
 10364     IF AM-TOL-PREM NOT = ZEROS
 10365        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10366                                    WS-TOL-AH-PREM.
 10367
 10368     IF AM-OVR-SHT-AMT NUMERIC AND
 10369                  AM-OVR-SHT-AMT > 0
 10370        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10371                                    EC-AM-LF-OVR-SHT-AMT
 10372                                    WS-AH-REFUND-OVS-AMT
 10373                                    EC-AM-AH-OVR-SHT-AMT.
 10374
 10375     IF AM-OVR-SHT-PCT NUMERIC AND
 10376                    AM-OVR-SHT-PCT > 0
 10377        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10378                                    EC-AM-LF-OVR-SHT-PCT
 10379                                    WS-AH-REFUND-OVS-PCT
 10380                                    EC-AM-AH-OVR-SHT-PCT.
 10381
 10382     IF AM-TOL-REF-PCT NUMERIC AND
 10383                  AM-TOL-REF-PCT > 0
 10384        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10385                                    WS-TOL-AH-REFUND-PCT.
 10386
 10387     IF AM-TOL-REF  NOT = ZEROS  AND
 10388                  AM-TOL-REF NUMERIC
 10389        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10390                                    EC-AM-LF-TOL-REFUND
 10391                                    WS-TOL-AH-REFUND
 10392                                    EC-AM-AH-TOL-REFUND.
 10393
 10394     IF AM-TOL-CLM  NOT = ZEROS
 10395        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 189
* EL050.cbl
 10396                                    WS-TOL-AH-CLAIM.
 10397
 10398     IF AM-CLP-TOL-PCT NOT NUMERIC
 10399        MOVE +0                  TO AM-CLP-TOL-PCT
 10400     END-IF
 10401
 10402     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10403        MOVE +0                  TO AM-SPP-LEASE-COMM
 10404     END-IF
 10405     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10406        MOVE WS-PL-TOL-LF-PREM-PCT
 10407                                 TO WS-TOL-LF-PREM-PCT.
 10408
 10409     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10410        MOVE WS-PL-TOL-AH-PREM-PCT
 10411                                 TO WS-TOL-AH-PREM-PCT.
 10412
 10413     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10414        MOVE WS-PL-TOL-LF-REFUND-PCT
 10415                                 TO WS-TOL-LF-REFUND-PCT.
 10416
 10417     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10418        MOVE WS-PL-TOL-AH-REFUND-PCT
 10419                                 TO WS-TOL-AH-REFUND-PCT.
 10420
 10421     IF WS-PL-REF-OVS-AMT > +0
 10422        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10423
 10424     IF WS-PL-REF-OVS-PCT > +0
 10425        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10426
 10427     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10428        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10429     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10430        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10431     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10432        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10433     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10434        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10435     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10436        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10437     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10438        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10439
 10440     IF WS-AH-PL-REF-OVS-AMT > +0
 10441        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10442
 10443     IF WS-AH-PL-REF-OVS-PCT > +0
 10444        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10445
 10446     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10447     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10448
 10449     IF PB-CANCELLATION
 10450        GO TO 3000-CONTINUE-EDIT.
 10451
 10452     MOVE +1 TO SUB1.
 10453     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 190
* EL050.cbl
 10454     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10455
 10456     IF CF-COMPANY-ID = 'DMD'
 10457       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10458         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10459        ELSE
 10460         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10461
 10462  0525-FIND-ACCT-COMM.
 10463     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10464        NEXT SENTENCE
 10465      ELSE
 10466         ADD +1 TO SUB1
 10467         IF SUB1 LESS +11
 10468            GO TO 0525-FIND-ACCT-COMM
 10469          ELSE
 10470             GO TO 0560-EDIT-CONTINUE.
 10471
 10472     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10473     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10474                                    PB-I-LIFE-COMMISSION.
 10475***  IF PB-COMPANY-ID = 'CRI'
 10476     IF PB-PREM-ACCTNG-ONLY
 10477         GO TO 0560-EDIT-CONTINUE.
 10478
 10479     MOVE '0530' TO CTBL-SW.
 10480     MOVE ' '    TO WS-CTBL-READ-SW.
 10481
 10482
 10483 0530-GET-AH-COMP.
 10484     IF NO-AH-COVERAGE  OR
 10485        NO-AH-BENEFIT-MATCH
 10486           GO TO 0540-NEXT-READ-STEP.
 10487
 10488     IF AM-A-COM (SUB1) NUMERIC
 10489        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10490         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10491         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10492         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10493         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10494     ELSE
 10495          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10496          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10497          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10498          MOVE ZEROS             TO WS-SUB1
 10499                                    WS-COMMISSION
 10500          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10501          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10502          IF WS-COMMISSION > ZEROS
 10503             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10504             GO TO 0540-NEXT-READ-STEP
 10505          END-IF
 10506          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10507          IF CTBL-TABLE-FOUND
 10508             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10509                                        PB-I-AH-TERM
 10510             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10511             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 191
* EL050.cbl
 10512             GO TO 0540-NEXT-READ-STEP
 10513          ELSE
 10514             IF FIRST-TIME-THROUGH
 10515                 GO TO 0530-GET-AH-COMP
 10516             ELSE
 10517                 MOVE ER-2609                TO WS-ERROR
 10518                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10519
 10520 0540-NEXT-READ-STEP.
 10521     MOVE '0540' TO CTBL-SW.
 10522     MOVE ' '    TO WS-CTBL-READ-SW.
 10523
 10524 0540-GET-LF-COMP.
 10525     IF NO-LIFE-COVERAGE  OR
 10526        NO-LF-BENEFIT-MATCH
 10527           GO TO 0560-EDIT-CONTINUE.
 10528
 10529     IF WS-LF-JOINT-INDICATOR = 'J'
 10530        IF AM-J-COM (SUB1) NUMERIC
 10531           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10532           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10533           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10534           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10535           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10536        ELSE
 10537           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10538           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10539           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10540           MOVE ZEROS                TO WS-SUB1
 10541                                        WS-COMMISSION
 10542           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10543           IF WS-COMMISSION > ZEROS
 10544              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10545              GO TO 0560-EDIT-CONTINUE
 10546           END-IF
 10547           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10548           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10549           IF CTBL-TABLE-FOUND
 10550              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10551              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10552              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10553              GO TO 0560-EDIT-CONTINUE
 10554           ELSE
 10555              IF FIRST-TIME-THROUGH
 10556                  GO TO 0540-GET-LF-COMP
 10557              ELSE
 10558                  MOVE ER-2609                TO WS-ERROR
 10559                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10560                  GO TO 0560-EDIT-CONTINUE.
 10561
 10562     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10563        IF AM-L-COM (SUB1) NUMERIC
 10564           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10565           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10566           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10567           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10568           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10569        ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 192
* EL050.cbl
 10570           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10571           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10572           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10573           MOVE ZEROS                TO WS-SUB1
 10574                                        WS-COMMISSION
 10575           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10576           IF WS-COMMISSION IS GREATER THAN ZEROS
 10577              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10578              GO TO 0560-EDIT-CONTINUE
 10579           END-IF
 10580           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10581           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10582           IF CTBL-TABLE-FOUND
 10583              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10584              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10585              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10586              GO TO 0560-EDIT-CONTINUE
 10587           ELSE
 10588              IF FIRST-TIME-THROUGH
 10589                  GO TO 0540-GET-LF-COMP
 10590              ELSE
 10591                  MOVE ER-2609                TO WS-ERROR
 10592                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10593
 10594*    GO TO 0560-EDIT-CONTINUE.
 10595
 10596 0560-EDIT-CONTINUE.
 10597     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10598                                    WS-AH-PMF-COMM
 10599*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10600*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10601     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10602        (SUB1 > +10)
 10603        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10604           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10605           MOVE '0530'           TO CTBL-SW
 10606           MOVE ' '              TO WS-CTBL-READ-SW
 10607           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10608           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10609           MOVE '0540'           TO CTBL-SW
 10610           MOVE ' '              TO WS-CTBL-READ-SW
 10611           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10612        END-IF
 10613     END-PERFORM
 10614     GO TO 0564-EDIT-CONTINUE
 10615     .
 10616 0561-CHECK-AH.
 10617     IF (NO-AH-COVERAGE)
 10618        OR (NO-AH-BENEFIT-MATCH)
 10619        CONTINUE
 10620     ELSE
 10621        IF (AM-A-COM (SUB1) NUMERIC)
 10622           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10623           IF (AM-COM-TYP (SUB1) = 'A')
 10624              AND (WS-AH-PMF-COMM = ZEROS)
 10625              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10626           END-IF
 10627           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 193
* EL050.cbl
 10628        ELSE
 10629           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10630           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10631           MOVE PB-AH-OVERRIDE-L1
 10632                                 TO CTBL-BEN-TYPE
 10633           MOVE ZEROS            TO WS-SUB1
 10634                                    WS-COMMISSION
 10635           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10636           PERFORM 8300-READ-CTBL-TABLE
 10637                                 THRU 8300-EXIT
 10638           IF CTBL-TABLE-FOUND
 10639              IF (AM-COM-TYP (SUB1) = 'A')
 10640                 AND (WS-AH-PMF-COMM = ZEROS)
 10641                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10642                                        PB-I-AH-TERM
 10643                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10644                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10645              END-IF
 10646              CONTINUE
 10647           ELSE
 10648              IF FIRST-TIME-THROUGH
 10649                 GO TO 0561-CHECK-AH
 10650              ELSE
 10651                 MOVE ER-2609    TO WS-ERROR
 10652                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10653              END-IF
 10654           END-IF
 10655        END-IF
 10656     END-IF
 10657     .
 10658 0561-EXIT.
 10659     EXIT.
 10660 0563-CHECK-LF.
 10661     IF (NO-LIFE-COVERAGE)
 10662        OR (NO-LF-BENEFIT-MATCH)
 10663        CONTINUE
 10664     ELSE
 10665        IF WS-LF-JOINT-INDICATOR = 'J'
 10666           IF AM-J-COM (SUB1) NUMERIC
 10667              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10668              IF (AM-COM-TYP (SUB1) = 'A')
 10669                 AND (WS-LF-PMF-COMM = ZEROS)
 10670                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10671              END-IF
 10672              CONTINUE
 10673           ELSE
 10674              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10675              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10676              MOVE PB-LIFE-OVERRIDE-L1
 10677                                 TO CTBL-BEN-TYPE
 10678              MOVE ZEROS         TO WS-SUB1
 10679                                    WS-COMMISSION
 10680              MOVE AM-J-COMA (SUB1)
 10681                                 TO CTBL-TABLE
 10682              PERFORM 8300-READ-CTBL-TABLE
 10683                                 THRU 8300-EXIT
 10684              IF CTBL-TABLE-FOUND
 10685                 IF (AM-COM-TYP (SUB1) = 'A')
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 194
* EL050.cbl
 10686                    AND (WS-LF-PMF-COMM = ZEROS)
 10687                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10688                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10689                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10690                 END-IF
 10691                 CONTINUE
 10692              ELSE
 10693                 IF FIRST-TIME-THROUGH
 10694                    GO TO 0563-CHECK-LF
 10695                 ELSE
 10696                    MOVE ER-2609 TO WS-ERROR
 10697                    PERFORM 9900-ERROR-FORMAT
 10698                                 THRU 9900-EXIT
 10699*                   GO TO 0560-EDIT-CONTINUE
 10700                 END-IF
 10701              END-IF
 10702           END-IF
 10703        ELSE
 10704           IF AM-L-COM (SUB1) NUMERIC
 10705              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10706              IF (AM-COM-TYP (SUB1) = 'A')
 10707                 AND (WS-LF-PMF-COMM = ZEROS)
 10708                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10709              END-IF
 10710              CONTINUE
 10711           ELSE
 10712              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10713              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10714              MOVE PB-LIFE-OVERRIDE-L1
 10715                                 TO CTBL-BEN-TYPE
 10716              MOVE ZEROS         TO WS-SUB1
 10717                                    WS-COMMISSION
 10718              MOVE AM-L-COMA (SUB1)
 10719                                 TO CTBL-TABLE
 10720              PERFORM 8300-READ-CTBL-TABLE
 10721                                 THRU 8300-EXIT
 10722              IF CTBL-TABLE-FOUND
 10723                 CONTINUE
 10724              ELSE
 10725                 IF FIRST-TIME-THROUGH
 10726                    GO TO 0563-CHECK-LF
 10727                 ELSE
 10728                    MOVE ER-2609 TO WS-ERROR
 10729                    PERFORM 9900-ERROR-FORMAT
 10730                                 THRU 9900-EXIT
 10731                 END-IF
 10732              END-IF
 10733           END-IF
 10734        END-IF
 10735     END-IF
 10736     .
 10737 0563-EXIT.
 10738     EXIT.
 10739 0564-EDIT-CONTINUE.
 10740
 10741     IF  PB-COMPANY-ID EQUAL 'DMD'
 10742         IF PB-I-NUM-BILLED EQUAL ZEROS
 10743            MOVE ER-8148       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 195
* EL050.cbl
 10744            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10745
 10746*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10747*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10748*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10749*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10750*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10751*         IF NO-CONVERSION-ERROR
 10752*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10753*         ELSE
 10754*             IF PB-COMPANY-ID EQUAL 'HAN'
 10755*                 MOVE ZEROS     TO PB-I-AGE.
 10756     IF PB-I-BIRTHDAY > LOW-VALUES
 10757        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10758        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10759        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10760        PERFORM 8500-DATE-CONVERT
 10761                                 THRU 8500-EXIT
 10762        IF NO-CONVERSION-ERROR
 10763           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10764           IF PB-I-AGE > ZEROS
 10765              IF WS-WORK-AGE NOT = PB-I-AGE
 10766                 MOVE ER-9501    TO WS-ERROR
 10767                 PERFORM 9900-ERROR-FORMAT
 10768                                 THRU 9900-EXIT
 10769              END-IF
 10770           ELSE
 10771              MOVE WS-WORK-AGE   TO PB-I-AGE
 10772           END-IF
 10773        END-IF
 10774     END-IF
 10775     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10776                                   WS-INS-AGE-SET
 10777     IF PB-I-AGE = ZEROS
 10778        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10779           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10780                                   WS-INS-AGE-SET
 10781           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10782
 10783     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10784                                   WS-AH-EDIT-AGE.
 10785
 10786     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10787        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10788        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10789        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10790        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10791        IF NO-CONVERSION-ERROR
 10792           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10793           IF PB-I-JOINT-AGE > 0
 10794              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10795                 MOVE ER-9503    TO WS-ERROR
 10796                 PERFORM 9900-ERROR-FORMAT
 10797                                 THRU 9900-EXIT
 10798              END-IF
 10799           ELSE
 10800              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10801           END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 196
* EL050.cbl
 10802        ELSE
 10803           MOVE ZEROS            TO PB-I-JOINT-AGE
 10804        END-IF
 10805     END-IF
 10806     IF PB-I-JOINT-AGE NOT NUMERIC
 10807        MOVE ZERO               TO PB-I-JOINT-AGE.
 10808
 10809     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10810                                   WS-JNT-AGE-SET
 10811     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 10812        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10813           (WS-AH-JOINT-INDICATOR = 'J')
 10814           IF PB-I-JOINT-AGE = ZEROS
 10815               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10816                                          WS-JNT-AGE-SET
 10817               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10818           END-IF
 10819        END-IF
 10820     END-IF
 10821
 10822     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10823     IF WS-LF-JOINT-INDICATOR = 'J'
 10824        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10825        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10826            IF  PB-I-JOINT-AGE = ZERO
 10827                MOVE ER-2686       TO WS-ERROR
 10828                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10829            ELSE
 10830                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10831                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10832                    IF PB-COMPANY-ID NOT = 'LBL'
 10833                        MOVE ER-2685    TO WS-ERROR
 10834                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10835
 10836     IF WS-AH-JOINT-INDICATOR = 'J'
 10837        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10838            IF  PB-I-JOINT-AGE = ZERO
 10839                MOVE ER-2686       TO WS-ERROR
 10840                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10841            ELSE
 10842                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10843                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10844                                           WS-EDIT-AGE
 10845                    IF PB-COMPANY-ID NOT = 'LBL'
 10846                        MOVE ER-2685    TO WS-ERROR
 10847                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10848
 10849******************************************************************
 10850*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10851******************************************************************
 10852
 10853     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10854        (WS-AH-SPECIAL-CALC-CD = 'O')
 10855        NEXT SENTENCE
 10856     ELSE
 10857        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10858          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10859           (WS-LF-JOINT-INDICATOR = 'J'  OR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 197
* EL050.cbl
 10860            WS-AH-JOINT-INDICATOR = 'J')  AND
 10861           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10862            MOVE ER-2627             TO WS-ERROR
 10863            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10864
 10865     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10866        (WS-AH-SPECIAL-CALC-CD = 'O')
 10867         NEXT SENTENCE
 10868     ELSE
 10869         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10870            WS-AH-JOINT-INDICATOR = 'J'
 10871             IF PB-I-JOINT-INSURED = SPACES
 10872                 IF PB-COMPANY-ID NOT = 'JAL'
 10873                     MOVE ER-2696    TO WS-ERROR
 10874                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10875
 10876     IF PB-COMPANY-ID NOT = 'BOA'
 10877        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10878           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10879           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10880               PB-I-JOINT-INSURED NOT = SPACES)
 10881                MOVE ER-2691         TO WS-ERROR
 10882                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10883
 10884     IF PB-COMPANY-ID = 'BOA'
 10885        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10886           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10887            IF PB-I-JOINT-AGE NOT = ZEROS
 10888                MOVE ER-2691         TO WS-ERROR
 10889                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10890
 10891     IF PB-COMPANY-ID = 'CRI'
 10892        IF PB-I-SIG-SW = 'J'
 10893           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10894              WS-AH-JOINT-INDICATOR NOT = 'J'
 10895              MOVE ER-2675       TO WS-ERROR
 10896              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10897
 10898     IF PB-COMPANY-ID = 'CRI'
 10899        IF PB-I-SIG-SW = 'S'
 10900           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10901              WS-AH-JOINT-INDICATOR = 'J'
 10902              MOVE ER-2676       TO WS-ERROR
 10903              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10904
 10905     IF PB-COMPANY-ID = 'CVL'
 10906         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10907            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10908              MOVE ER-2783           TO WS-ERROR
 10909              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10910     IF (WS-LF-JOINT-INDICATOR = 'J')
 10911        AND (WS-AH-JOINT-INDICATOR = 'J')
 10912        AND (PB-I-LF-TERM > 120)
 10913        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10914        MOVE ER-2783             TO WS-ERROR
 10915        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10916     END-IF
 10917     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 198
* EL050.cbl
 10918
 10919     IF PB-I-INDV-GRP-OVRD = 'I'
 10920        MOVE ER-2666             TO WS-ERROR
 10921        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10922        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10923
 10924     IF PB-I-INDV-GRP-OVRD = 'G'
 10925        MOVE ER-2666             TO WS-ERROR
 10926        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10927        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10928
 10929     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10930        NEXT SENTENCE
 10931     ELSE
 10932        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10933
 10934     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10935        IF WS-ERROR = ER-2666
 10936           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10937           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10938
 10939     IF PB-COMPANY-ID = 'CID'
 10940        IF PB-STATE = 'UT' OR 'MO'
 10941           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10942                 OR '76' OR '77')
 10943                      OR
 10944               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10945                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10946                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10947                   OR '2K' OR '2L'))
 10948              AND PB-I-INDV-GRP-CD = 'I'
 10949              MOVE ER-2721             TO WS-ERROR
 10950              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10951           END-IF
 10952        END-IF
 10953     END-IF
 10954
 10955     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10956     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10957        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10958     ELSE
 10959        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10960     END-IF
 10961
 10962*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10963*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10964     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10965                                    ACCOUNT-AH-CK-SW.
 10966
 10967     IF PB-REISSUED-CERT       OR
 10968        PB-REIN-ONLY-CERT      OR
 10969        PB-POLICY-IS-DECLINED  OR
 10970        PB-POLICY-IS-VOIDED
 10971*       OR PB-MONTHLY-CERT
 10972         GO TO 3000-CONTINUE-EDIT.
 10973
 10974     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10975        IF WS-EDIT-AGE           > +65
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 199
* EL050.cbl
 10976           MOVE ER-2709          TO WS-ERROR
 10977           PERFORM 9900-ERROR-FORMAT
 10978                                 THRU 9900-EXIT
 10979        ELSE
 10980           IF WS-EDIT-AGE        > +55
 10981              MOVE ER-2718       TO WS-ERROR
 10982              PERFORM 9900-ERROR-FORMAT
 10983                                 THRU 9900-EXIT
 10984           END-IF
 10985        END-IF
 10986     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10987        IF WS-EDIT-AGE           > +65
 10988           MOVE ER-2709          TO WS-ERROR
 10989           PERFORM 9900-ERROR-FORMAT
 10990                                 THRU 9900-EXIT
 10991        END-IF
 10992     END-IF
 10993     .
 10994
 10995 0565-LIFE-PLAN-LIMIT-EDITS.
 10996
 10997     IF NOT LF-PLAN-MASTER-FOUND
 10998        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10999                                    EC-AM-LF-MAX-TOT-BEN
 11000        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11001
 11002     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11003
 11004     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11005         IF PL-LM-AGE (1) = ZEROS
 11006             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11007
 11008     IF NO-LF-BENEFIT-MATCH          OR
 11009        WS-LF-BENEFIT-CD = ZEROS     OR
 11010        WS-LF-SPECIAL-CALC-CD = 'M'
 11011        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11012
 11013     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11014     MOVE +1                     TO SUB2.
 11015
 11016     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11017        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11018           MOVE +5   TO SUB2
 11019           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11020              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11021              (PL-LM-AGE (SUB2) EQUAL +0)
 11022              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11023              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11024
 11025     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11026
 11027     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11028                               + PB-I-LF-ALT-BENEFIT-AMT.
 11029
 11030 0568-CHECK-LIFE-ATT-AGE.
 11031
 11032     IF PL-ATT-AGE NUMERIC AND
 11033        PL-ATT-AGE > +0
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 200
* EL050.cbl
 11034        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11035     END-IF
 11036*    IF PL-ATT-AGE NUMERIC AND
 11037*       PL-ATT-AGE > +0
 11038*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11039*       IF PB-I-BIRTHDAY > LOW-VALUES
 11040*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11041*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11042*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11043*          SET BIN-PLUS-ELAPSED  TO TRUE
 11044*          PERFORM 8500-DATE-CONVERT
 11045*                                THRU 8500-EXIT
 11046*          IF NO-CONVERSION-ERROR
 11047*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11048*             MOVE ER-2669       TO WS-ERROR
 11049*             PERFORM 9900-ERROR-FORMAT
 11050*                                THRU 9900-EXIT
 11051*          END-IF
 11052*       ELSE
 11053*          IF WS-ATT-AGE >= PL-ATT-AGE
 11054*             MOVE ER-2669       TO WS-ERROR
 11055*             PERFORM 9900-ERROR-FORMAT
 11056*                                THRU 9900-EXIT
 11057*          END-IF
 11058*       END-IF
 11059*    END-IF
 11060     .
 11061 0570-CHECK-LIFE-LIMITS.
 11062
 11063     IF PB-COMPANY-ID EQUAL 'CRI'
 11064        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11065           IF SUB2 GREATER THAN +4
 11066              MOVE ER-2637 TO WS-ERROR
 11067              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11068              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11069
 11070     IF PB-COMPANY-ID  =  'NCL'
 11071        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11072            SUB2 GREATER THAN +8
 11073             MOVE 'U'         TO PB-BATCH-ENTRY
 11074             MOVE ER-2637     TO WS-ERROR
 11075             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11076             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11077
 11078     IF SUB2 > +8
 11079        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11080           AND (PB-I-SIG-SW = 'Y')
 11081           CONTINUE
 11082        ELSE
 11083           MOVE ER-2637          TO WS-ERROR
 11084           PERFORM 9900-ERROR-FORMAT
 11085                                 THRU 9900-EXIT
 11086        END-IF
 11087        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11088     END-IF
 11089     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11090     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11091     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 201
* EL050.cbl
 11092
 11093     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11094        ADD +1  TO SUB2
 11095        GO TO 0570-CHECK-LIFE-LIMITS.
 11096
 11097     IF PB-COMPANY-ID = 'NCL'
 11098         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11099
 11100     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11101        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11102        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11103           AND (PB-I-SIG-SW = 'Y')
 11104           CONTINUE
 11105        ELSE
 11106           MOVE ER-2637          TO WS-ERROR
 11107           PERFORM 9900-ERROR-FORMAT
 11108                                 THRU 9900-EXIT
 11109        END-IF
 11110     END-IF
 11111     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11112
 11113
 11114 0570-CHECK-NCL-LIFE-LIMITS.
 11115
 11116     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11117        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11118         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11119
 11120     IF APP-CERT-USED
 11121         IF SUB2  LESS THAN  +5
 11122             MOVE +5          TO SUB2
 11123             GO TO 0570-CHECK-LIFE-LIMITS.
 11124
 11125     MOVE ER-2637             TO WS-ERROR.
 11126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11127
 11128     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11129
 11130 0575-CHECK-NCL-SIG-SWITCH.
 11131
 11132     IF NOT APP-CERT-USED
 11133         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11134
 11135     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11136        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11137        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11138        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11139         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11140
 11141     IF SUB2 GREATER THAN +4
 11142         IF PL-LM-AGE (5) = ZEROS  AND
 11143            PL-LM-AGE (6) = ZEROS  AND
 11144            PL-LM-AGE (7) = ZEROS  AND
 11145            PL-LM-AGE (8) = ZEROS
 11146             MOVE  ER-1927        TO WS-ERROR
 11147             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11148             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11149         ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 202
* EL050.cbl
 11150             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11151                 MOVE  ER-1920    TO WS-ERROR
 11152                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11153
 11154     IF PB-I-SIG-SW  = 'Y'
 11155       IF NOT PB-I-POLICY-ACCEPTED  AND
 11156          NOT PB-I-POLICY-DECLINED
 11157           MOVE 'U'               TO PB-BATCH-ENTRY
 11158           MOVE  ER-1926          TO WS-ERROR
 11159           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11160
 11161
 11162 0580-AH-PLAN-LIMIT-EDITS.
 11163
 11164     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11165        IF PB-I-AH-BENEFIT-AMT > +1250
 11166           MOVE ER-2702          TO WS-ERROR
 11167           PERFORM 9900-ERROR-FORMAT
 11168                                 THRU 9900-EXIT
 11169        END-IF
 11170     END-IF
 11171
 11172     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11173        AND (PB-MONTHLY-CERT)
 11174        IF PB-I-AH-BENEFIT-AMT > +3000
 11175           MOVE ER-2881          TO WS-ERROR
 11176           PERFORM 9900-ERROR-FORMAT
 11177                                 THRU 9900-EXIT
 11178        END-IF
 11179     END-IF
 11180     IF NOT AH-PLAN-MASTER-FOUND
 11181        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11182        GO TO 3000-CONTINUE-EDIT.
 11183
 11184     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11185
 11186     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11187         IF PL-LM-AGE (1) = ZEROS
 11188             GO TO 3000-CONTINUE-EDIT.
 11189
 11190     IF NO-AH-BENEFIT-MATCH          OR
 11191        WS-AH-BENEFIT-CD = ZEROS     OR
 11192        WS-AH-SPECIAL-CALC-CD = 'M'
 11193        GO TO 3000-CONTINUE-EDIT.
 11194
 11195     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11196     MOVE +1                     TO SUB2.
 11197
 11198     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11199        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11200           MOVE +5 TO SUB2
 11201           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11202              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11203              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11204              (PL-LM-AGE (SUB2) EQUAL +0)
 11205              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11206              GO TO 3000-CONTINUE-EDIT.
 11207
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 203
* EL050.cbl
 11208     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11209
 11210 0590-CHECK-AH-ATT-AGE.
 11211
 11212     IF PL-ATT-AGE NUMERIC AND
 11213        PL-ATT-AGE GREATER THAN +0
 11214        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11215     END-IF
 11216*       IF WS-ATT-AGE >= PL-ATT-AGE
 11217*          MOVE ER-3054          TO WS-ERROR
 11218*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11219     .
 11220 0597-CHECK-AH-LIMITS.
 11221
 11222     IF PB-COMPANY-ID EQUAL 'CRI'
 11223        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11224           IF SUB2 GREATER THAN +4
 11225              MOVE ER-2638       TO WS-ERROR
 11226              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11227              GO TO 3000-CONTINUE-EDIT.
 11228
 11229     IF PB-COMPANY-ID  =  'NCL'
 11230        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11231            SUB2 GREATER THAN +8
 11232             MOVE 'U'            TO PB-BATCH-ENTRY
 11233             MOVE ER-2638        TO WS-ERROR
 11234             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11235             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11236
 11237     IF SUB2 > +8
 11238        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11239           AND (PB-I-SIG-SW = 'Y')
 11240           CONTINUE
 11241        ELSE
 11242           MOVE ER-2638          TO WS-ERROR
 11243           PERFORM 9900-ERROR-FORMAT
 11244                                 THRU 9900-EXIT
 11245        END-IF
 11246        GO TO 3000-CONTINUE-EDIT
 11247     END-IF
 11248
 11249     IF PB-COMPANY-ID = 'CRI'
 11250        IF WS-ERROR = ER-2638
 11251           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11252
 11253     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11254     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11255     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11256     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11257
 11258     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11259        ADD +1                   TO SUB2
 11260        GO TO 0597-CHECK-AH-LIMITS.
 11261
 11262     IF PB-COMPANY-ID = 'NCL'
 11263         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11264
 11265     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 204
* EL050.cbl
 11266        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11267        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11268                                 > PL-LM-AMT (SUB2))
 11269        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11270           AND (PB-I-SIG-SW = 'Y')
 11271           CONTINUE
 11272        ELSE
 11273           MOVE ER-2638          TO WS-ERROR
 11274           PERFORM 9900-ERROR-FORMAT
 11275                                 THRU 9900-EXIT
 11276        END-IF
 11277     END-IF
 11278
 11279     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11280         IF  WS-ERROR    EQUAL    ER-2638
 11281             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11282                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11283                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11284                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11285                MOVE  ER-1910    TO  WS-ERROR
 11286                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11287
 11288     IF PB-COMPANY-ID = 'CRI'
 11289        IF WS-ERROR = ER-2638
 11290            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11291            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11292            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11293
 11294     GO TO 3000-CONTINUE-EDIT.
 11295
 11296 0597-CHECK-NCL-AH-LIMITS.
 11297
 11298     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11299        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11300        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11301                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11302         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11303
 11304     IF APP-CERT-USED
 11305         IF SUB2  LESS THAN  +5
 11306             MOVE +5             TO SUB2
 11307             GO TO 0597-CHECK-AH-LIMITS.
 11308
 11309     MOVE ER-2638                TO WS-ERROR.
 11310     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11311
 11312     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11313
 11314 0599-CHECK-NCL-SIG-SWITCH.
 11315
 11316     IF NOT APP-CERT-USED
 11317         GO TO 3000-CONTINUE-EDIT.
 11318
 11319     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11320        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11321        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11322        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11323         GO TO 3000-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 205
* EL050.cbl
 11324
 11325     IF SUB2 GREATER THAN +4
 11326         IF PL-LM-AGE (5) = ZEROS  AND
 11327            PL-LM-AGE (6) = ZEROS  AND
 11328            PL-LM-AGE (7) = ZEROS  AND
 11329            PL-LM-AGE (8) = ZEROS
 11330             MOVE  ER-1927        TO WS-ERROR
 11331             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11332             GO TO 3000-CONTINUE-EDIT
 11333         ELSE
 11334             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11335                 MOVE  ER-1920    TO WS-ERROR
 11336                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11337
 11338     IF PB-I-SIG-SW  = 'Y'
 11339       IF NOT PB-I-POLICY-ACCEPTED  AND
 11340          NOT PB-I-POLICY-DECLINED
 11341           MOVE 'U'               TO PB-BATCH-ENTRY
 11342           MOVE  ER-1926          TO WS-ERROR
 11343           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11344
 11345******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 206
* EL050.cbl
 11347
 11348 3000-CONTINUE-EDIT.
 11349
 11350     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11351     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11352     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11353     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11354     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11355
 11356     IF BROWSE-STARTED
 11357        PERFORM 9990-RETURN THRU 9990-EXIT
 11358        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11359
 11360     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11361        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11362        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11363        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11364*       MOVE 1                   TO DC-OPTION-CODE
 11365        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11366        IF DATE-CONVERSION-ERROR
 11367           MOVE ER-2622          TO WS-ERROR
 11368           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11369        ELSE
 11370           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11371              MOVE ER-2623       TO WS-ERROR
 11372              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11373           ELSE
 11374              MOVE ER-2622       TO WS-ERROR
 11375              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11376
 11377     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11378     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11379     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11380*    MOVE 1                      TO DC-OPTION-CODE.
 11381     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11382     IF DATE-CONVERSION-ERROR
 11383        GO TO 3005-EDIT-CONTINUE
 11384     ELSE
 11385        IF DC-ELAPSED-DAYS GREATER +180
 11386           MOVE ER-2613          TO WS-ERROR
 11387           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11388        ELSE
 11389           IF DC-ELAPSED-DAYS GREATER +90
 11390              MOVE ER-2612       TO WS-ERROR
 11391              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11392           ELSE
 11393             IF DC-ELAPSED-DAYS GREATER +60
 11394                MOVE ER-2614     TO WS-ERROR
 11395                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11396
 11397 3005-EDIT-CONTINUE.
 11398
 11399     IF PB-CANCELLATION
 11400         GO TO 3700-EDIT-CANCEL.
 11401
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 207
* EL050.cbl
 11403******************************************************************
 11404*                  E D I T   I S S U E                           *
 11405******************************************************************
 11406
 11407 3020-EDIT-ISSUE.
 11408
 11409      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11410      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11411      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11412      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11413      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11414
 11415     IF PB-ISSUE-FORCE
 11416        OR PB-ISSUE-DATE-FORCED
 11417        OR PB-FORCE-OFF
 11418        OR PB-OVERCHARGE-FORCE
 11419        or pb-exceeded-limit-forced
 11420        CONTINUE
 11421     ELSE
 11422        MOVE ER-2670             TO WS-ERROR
 11423        PERFORM 9900-ERROR-FORMAT
 11424                                 THRU 9900-EXIT
 11425     END-IF
 11426     .
 11427 3022-SET-POLICY-STATUS.
 11428
 11429     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11430
 11431     IF (PB-REISSUED-CERT)
 11432             OR
 11433        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11434         AND (PB-MONTHLY-CERT))
 11435         MOVE '5'                TO PB-I-ENTRY-STATUS
 11436         MOVE 'E'                TO PB-BATCH-ENTRY
 11437     END-IF
 11438
 11439     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11440        IF PB-MONTHLY-CERT
 11441           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11442        END-IF
 11443        IF PB-CASH-CERT
 11444           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11445        END-IF
 11446     END-IF
 11447     IF PB-POLICY-IS-DECLINED
 11448         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11449     IF PB-POLICY-IS-VOIDED
 11450         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11451     IF PB-NEEDS-UNDERWRITING
 11452         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11453     IF PB-REIN-ONLY-CERT
 11454         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11455     IF PB-PREM-ACCTNG-ONLY
 11456         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11457
 11458     MOVE SPACE                  TO PB-I-OB-FLAG.
 11459
 11460     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 208
* EL050.cbl
 11461         MOVE ER-2665            TO WS-ERROR
 11462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11463         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11464
 11465     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11466        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11467           MOVE 'Z'             TO PB-I-OB-FLAG.
 11468
 11469     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11470        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11471           MOVE 'Z'             TO PB-I-OB-FLAG.
 11472
 11473     IF ACCOUNT-MAST-FOUND
 11474         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11475         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11476         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11477         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11478         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11479         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11480         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11481     END-IF
 11482
 11483     IF ACCOUNT-MAST-FOUND
 11484        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11485         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11486
 11487     IF (ACCOUNT-MAST-FOUND)
 11488*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11489        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11490        IF PB-REISSUED-CERT
 11491           CONTINUE
 11492        ELSE
 11493           MOVE ER-2608          TO WS-ERROR
 11494           PERFORM 9900-ERROR-FORMAT
 11495                                 THRU 9900-EXIT
 11496         END-IF
 11497     END-IF
 11498
 11499     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11500        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11501        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11502
 11503**********   DMD CUSTOM CODE FOLLOWS  **********
 11504 3024-EDIT-DMD-FIELDS.
 11505     IF PB-COMPANY-ID NOT = 'DMD'
 11506        GO TO 3025-EDIT-REINSURANCE.
 11507
 11508*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11509*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11510*** ERROR IF THEY ARE NOT EQUAL.
 11511
 11512     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11513     SET BIN-TO-GREG               TO TRUE.
 11514     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11515     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11516**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11517
 11518     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 209
* EL050.cbl
 11519     SET BIN-TO-GREG               TO TRUE.
 11520     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11521     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11522**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11523
 11524     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11525        MOVE ER-8116               TO WS-ERROR
 11526        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11527
 11528     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11529
 11530     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11531                                      WK-FULL-CERT-NO.
 11532     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11533
 11534     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11535
 11536     IF PB-VALID-LIFE
 11537        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11538     ELSE
 11539        IF PB-VALID-AH
 11540          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11541
 11542
 11543     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11544     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11545     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11546                                      DCUA-UNDRWRTR-CODE
 11547                                      DCUA-UNDRWRTR-GROUP-CODE
 11548                                      DCUA-RETURN-CODE.
 11549
 11550****************************************************************
 11551*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11552***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11553***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11554***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11555***   TO THIS RECORD.                                        ***
 11556****************************************************************
 11557     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11558     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11559     IF DCUA-SUCCESSFUL-PROCESS
 11560        GO TO 3024-EDIT-DL7-CONT.
 11561
 11562     IF DCUA-RETURN-CODE EQUAL '01'
 11563        MOVE ER-8110               TO WS-ERROR
 11564        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11566        GO TO 3024-EDIT-DL7-CONT.
 11567
 11568     IF DCUA-RETURN-CODE EQUAL '02'
 11569        MOVE ER-8111               TO WS-ERROR
 11570        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11572        GO TO 3024-EDIT-DL7-CONT.
 11573
 11574     IF DCUA-RETURN-CODE EQUAL '03'
 11575        MOVE ER-8074               TO WS-ERROR
 11576        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 210
* EL050.cbl
 11577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11578        GO TO 3024-EDIT-DL7-CONT.
 11579
 11580     IF DCUA-RETURN-CODE EQUAL '04'
 11581        MOVE ER-8075               TO WS-ERROR
 11582        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11583        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11584        GO TO 3024-EDIT-DL7-CONT.
 11585
 11586     IF DCUA-RETURN-CODE EQUAL '05'
 11587        MOVE ER-8076               TO WS-ERROR
 11588        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590        GO TO 3024-EDIT-DL7-CONT.
 11591
 11592     IF DCUA-RETURN-CODE EQUAL '06'
 11593        MOVE ER-8077               TO WS-ERROR
 11594        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11596        GO TO 3024-EDIT-DL7-CONT.
 11597
 11598     IF DCUA-RETURN-CODE EQUAL '07'
 11599        MOVE ER-8078               TO WS-ERROR
 11600        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11602        GO TO 3024-EDIT-DL7-CONT.
 11603
 11604     IF DCUA-RETURN-CODE EQUAL 'E1'
 11605        MOVE ER-8079               TO WS-ERROR
 11606        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11608        GO TO 3024-EDIT-DL7-CONT.
 11609
 11610     IF DCUA-RETURN-CODE EQUAL 'E2'
 11611        MOVE ER-8080               TO WS-ERROR
 11612        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL7-CONT.
 11615
 11616     IF DCUA-RETURN-CODE EQUAL 'E3'
 11617        MOVE ER-8098               TO WS-ERROR
 11618        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL7-CONT.
 11621
 11622     IF DCUA-RETURN-CODE EQUAL 'C1'
 11623        MOVE ER-8099               TO WS-ERROR
 11624        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11626        GO TO 3024-EDIT-DL7-CONT.
 11627
 11628     IF DCUA-RETURN-CODE EQUAL 'U1'
 11629        MOVE ER-8109               TO WS-ERROR
 11630        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11632        GO TO 3024-EDIT-DL7-CONT.
 11633
 11634     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 211
* EL050.cbl
 11635        MOVE ER-8112               TO WS-ERROR
 11636        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11638        GO TO 3024-EDIT-DL7-CONT.
 11639
 11640     IF DCUA-RETURN-CODE EQUAL 'N2'
 11641        MOVE ER-8113               TO WS-ERROR
 11642        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644        GO TO 3024-EDIT-DL7-CONT.
 11645
 11646     IF DCUA-RETURN-CODE EQUAL 'N3'
 11647        MOVE ER-8114               TO WS-ERROR
 11648        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11649        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11650        GO TO 3024-EDIT-DL7-CONT.
 11651
 11652     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11653     MOVE ER-8097                  TO WS-ERROR.
 11654     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11655     GO TO 3024-EDIT-DL7-CONT.
 11656
 11657 3024-EDIT-DL7-CONT.
 11658
 11659     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11660     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11661     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11662        NEXT SENTENCE
 11663     ELSE
 11664        MOVE ER-9263               TO WS-ERROR
 11665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11666
 11667******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11668******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11669     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11670        NEXT SENTENCE
 11671     ELSE
 11672        MOVE ER-8039               TO WS-ERROR
 11673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11674
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 212
* EL050.cbl
 11676****************************************************************
 11677*** VALIDATE STATE  : DLO022                                 ***
 11678****************************************************************
 11679     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11680     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11681
 11682     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11683     IF DVSC-SUCCESSFUL-EDIT
 11684        GO TO 3024-EDIT-DL22-CONT.
 11685
 11686     IF DVSC-RETURN-CODE EQUAL '01'
 11687        MOVE ER-8300               TO WS-ERROR
 11688        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11689        GO TO 3024-EDIT-DL22-CONT.
 11690
 11691     IF DVSC-RETURN-CODE EQUAL '02'
 11692        MOVE ER-8301               TO WS-ERROR
 11693        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11694        GO TO 3024-EDIT-DL22-CONT.
 11695
 11696     IF DVSC-RETURN-CODE EQUAL '03'
 11697        MOVE ER-8302               TO WS-ERROR
 11698        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699        GO TO 3024-EDIT-DL22-CONT.
 11700
 11701     IF DVSC-RETURN-CODE EQUAL 'N1'
 11702        MOVE ER-8304               TO WS-ERROR
 11703        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11704        GO TO 3024-EDIT-DL22-CONT.
 11705
 11706     MOVE ER-8303                  TO WS-ERROR
 11707     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11708
 11709 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 213
* EL050.cbl
 11711****************************************************************
 11712*** VALIDATE LOAN OFFICER : DLO021                           ***
 11713****************************************************************
 11714
 11715     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11716     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11717     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11718     IF DVLO-SUCCESSFUL-EDIT
 11719        GO TO 3024-EDIT-DL21-CONT.
 11720
 11721     IF DVLO-RETURN-CODE EQUAL '01'
 11722        MOVE ER-8081               TO WS-ERROR
 11723        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11724        GO TO 3024-EDIT-DL21-CONT.
 11725
 11726     IF DVLO-RETURN-CODE EQUAL '02'
 11727        MOVE ER-8082               TO WS-ERROR
 11728        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11729        GO TO 3024-EDIT-DL21-CONT.
 11730
 11731     IF DVLO-RETURN-CODE EQUAL '03'
 11732        MOVE ER-8083               TO WS-ERROR
 11733        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11734        GO TO 3024-EDIT-DL21-CONT.
 11735
 11736     IF DVLO-RETURN-CODE EQUAL '04'
 11737        MOVE ER-8084               TO WS-ERROR
 11738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11739        GO TO 3024-EDIT-DL21-CONT.
 11740
 11741     IF DVLO-RETURN-CODE EQUAL '05'
 11742        MOVE ER-8085               TO WS-ERROR
 11743        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11744        GO TO 3024-EDIT-DL21-CONT.
 11745
 11746     MOVE ER-7825                  TO WS-ERROR
 11747     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11748     GO TO 3024-EDIT-DL21-CONT.
 11749
 11750 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 214
* EL050.cbl
 11752
 11753****************************************************************
 11754*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11755****************************************************************
 11756
 11757     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11758     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11759     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11760     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11761     IF DIPF-SUCCESSFUL-EDIT
 11762        GO TO 3024-EDIT-DL02-CONT.
 11763
 11764     IF DIPF-RETURN-CODE EQUAL '01'
 11765        MOVE ER-8086               TO WS-ERROR
 11766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11767        GO TO 3024-EDIT-DL02-CONT.
 11768
 11769     IF DIPF-RETURN-CODE EQUAL '02'
 11770        MOVE ER-8087               TO WS-ERROR
 11771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11772        GO TO 3024-EDIT-DL02-CONT.
 11773
 11774     IF DIPF-RETURN-CODE EQUAL '03'
 11775        MOVE ER-8088               TO WS-ERROR
 11776        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11777        GO TO 3024-EDIT-DL02-CONT.
 11778
 11779     MOVE ER-8095                  TO WS-ERROR
 11780     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11781     GO TO 3024-EDIT-DL02-CONT.
 11782
 11783 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 215
* EL050.cbl
 11785
 11786****************************************************************
 11787*** VALIDATE BANK ID : DLO003                                ***
 11788****************************************************************
 11789
 11790     MOVE WK-GREG-CENT           TO WCG-CENT.
 11791     MOVE WK-GREG-YYMM           TO WCG-REST.
 11792     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11793        MOVE ER-8040               TO WS-ERROR
 11794        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11795
 11796     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11797     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11798     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11799     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11800     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11801     IF DVBI-SUCCESSFUL-EDIT
 11802        GO TO 3024-EDIT-DL03-CONT.
 11803
 11804     IF DVBI-RETURN-CODE EQUAL '01'
 11805        MOVE ER-8089               TO WS-ERROR
 11806        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11807        GO TO 3024-EDIT-DL03-CONT.
 11808
 11809     IF DVBI-RETURN-CODE EQUAL '02'
 11810        MOVE ER-8090               TO WS-ERROR
 11811        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11812        GO TO 3024-EDIT-DL03-CONT.
 11813
 11814     IF DVBI-RETURN-CODE EQUAL '03'
 11815        MOVE ER-8091               TO WS-ERROR
 11816        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11817        GO TO 3024-EDIT-DL03-CONT.
 11818
 11819     IF DVBI-RETURN-CODE EQUAL '04'
 11820        MOVE ER-8092               TO WS-ERROR
 11821        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11822        GO TO 3024-EDIT-DL03-CONT.
 11823
 11824     IF DVBI-RETURN-CODE EQUAL '05'
 11825        MOVE ER-8093               TO WS-ERROR
 11826        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11827        GO TO 3024-EDIT-DL03-CONT.
 11828
 11829     IF DVBI-RETURN-CODE EQUAL '06'
 11830        MOVE ER-8094               TO WS-ERROR
 11831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11832        GO TO 3024-EDIT-DL03-CONT.
 11833
 11834     MOVE ER-8096                  TO WS-ERROR
 11835     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11836     GO TO 3024-EDIT-DL03-CONT.
 11837
 11838 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 216
* EL050.cbl
 11840
 11841     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11842        NEXT SENTENCE
 11843     ELSE
 11844        MOVE ER-8042               TO WS-ERROR
 11845        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11846
 11847     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11848     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11849     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11850
 11851     IF DMPF-RETURN-CODE = '01'
 11852        MOVE ER-8067               TO WS-ERROR
 11853        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11854        GO TO 3024-EDIT-DL01-CONT.
 11855
 11856     IF DMPF-RETURN-CODE = '02'
 11857        MOVE ER-8068               TO WS-ERROR
 11858        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11859        GO TO 3024-EDIT-DL01-CONT.
 11860
 11861     IF DMPF-RETURN-CODE = '03'
 11862        MOVE ER-8069               TO WS-ERROR
 11863        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11864        GO TO 3024-EDIT-DL01-CONT.
 11865
 11866     IF DMPF-RETURN-CODE = 'E1'
 11867        MOVE ER-8070               TO WS-ERROR
 11868        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11869        GO TO 3024-EDIT-DL01-CONT.
 11870
 11871     IF DMPF-RETURN-CODE = 'N1'
 11872        MOVE ER-8071               TO WS-ERROR
 11873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11874        GO TO 3024-EDIT-DL01-CONT.
 11875
 11876     IF DMPF-RETURN-CODE NOT = 'OK'
 11877        MOVE ER-8072               TO WS-ERROR
 11878        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11879
 11880 3024-EDIT-DL01-CONT.
 11881******************************************************************
 11882***  VALIDATES RATE CODES : DLO017                             ***
 11883******************************************************************
 11884
 11885      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11886      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11887      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11888      IF DVRC-SUCCESSFUL-EDIT
 11889        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11890        GO TO 3024-CHECK-VALID-RATE.
 11891
 11892      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11893
 11894      IF DVRC-RETURN-CODE EQUAL '01'
 11895         MOVE ER-7817                   TO WS-ERROR
 11896         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11897         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 217
* EL050.cbl
 11898
 11899      IF DVRC-RETURN-CODE EQUAL '02'
 11900         MOVE ER-7818                   TO WS-ERROR
 11901         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11902         GO TO 3025-EDIT-REINSURANCE.
 11903
 11904      IF DVRC-RETURN-CODE EQUAL '03'
 11905         MOVE ER-7819                   TO WS-ERROR
 11906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11907         GO TO 3025-EDIT-REINSURANCE.
 11908
 11909       MOVE ER-7820                     TO WS-ERROR.
 11910       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11911       GO TO 3025-EDIT-REINSURANCE.
 11912
 11913******************************************************************
 11914***  GET PREMIUM RATES : DLO011                                ***
 11915******************************************************************
 11916
 11917 3024-CHECK-VALID-RATE.
 11918
 11919     IF VALID-RATE-CODE
 11920        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11921        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11922        MOVE SPACES                TO DPRB-RETURN-CODE
 11923        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11924     ELSE
 11925         GO TO 3025-EDIT-REINSURANCE.
 11926
 11927      IF DPRB-SUCCESSFUL-PROCESS
 11928         IF PB-VALID-LIFE
 11929             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11930             GO TO 3025-EDIT-REINSURANCE
 11931         ELSE
 11932             IF PB-VALID-AH
 11933                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11934                 GO TO 3025-EDIT-REINSURANCE.
 11935
 11936      IF DPRB-RETURN-CODE EQUAL '01'
 11937         MOVE ER-7812                   TO WS-ERROR
 11938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11939         GO TO 3025-EDIT-REINSURANCE.
 11940
 11941      IF DPRB-RETURN-CODE EQUAL '02'
 11942         MOVE ER-7813                   TO WS-ERROR
 11943         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11944         GO TO 3025-EDIT-REINSURANCE.
 11945
 11946      IF DPRB-RETURN-CODE EQUAL '03'
 11947         MOVE ER-7814                   TO WS-ERROR
 11948         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11949         GO TO 3025-EDIT-REINSURANCE.
 11950
 11951      IF DPRB-RETURN-CODE EQUAL '04'
 11952         IF NOT DPRB-1ST-TIME
 11953            MOVE ER-7815                   TO WS-ERROR
 11954            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11955            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 218
* EL050.cbl
 11956          ELSE
 11957         IF PB-VALID-LIFE
 11958            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11959          ELSE
 11960            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11961         END-IF
 11962         MOVE SPACES                TO DOCC-RETURN-CODE
 11963         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11964         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11965         IF DOCC-RETURN-CODE = 'OK'
 11966             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11967             GO TO 3024-CHECK-VALID-RATE
 11968           ELSE
 11969             MOVE ER-7823               TO WS-ERROR
 11970             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11971             GO TO 3025-EDIT-REINSURANCE.
 11972
 11973       MOVE ER-7816                     TO WS-ERROR.
 11974       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11975       GO TO 3025-EDIT-REINSURANCE.
 11976
 11977**********   DMD CUSTOM CODE ABOVE    **********
 11978
 11979 3025-EDIT-REINSURANCE.
 11980     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11981         GO TO 3027-EDIT-CONTINUE.
 11982
 11983     MOVE LOW-VALUES               TO ERREIN-KEY.
 11984     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11985     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11986                                      REIN-CODE-2
 11987                                      REIN-CODE-3.
 11988     MOVE 'A'                      TO REIN-TYPE.
 11989
 11990     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11991
 11992     MOVE '3026' TO REIN-SW.
 11993     MOVE ' '                   TO WS-REIN-READ-SW.
 11994
 11995     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11996     IF REIN-TABLE-NOT-FOUND
 11997         GO TO 3026-NO-SPEC-TABLE.
 11998
 11999     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12000     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12001                                   WS-NSP-ST-CD-LF.
 12002     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12003                                   WS-NSP-ST-CD-AH.
 12004
 12005     GO TO 3040-EDIT-CONTINUE.
 12006
 12007 3026-NO-SPEC-TABLE.
 12008
 12009     MOVE ER-2664                TO WS-ERROR.
 12010     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12011     GO TO 3040-EDIT-CONTINUE.
 12012
 12013 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 219
* EL050.cbl
 12014
 12015     IF PB-I-REIN-TABLE = SPACES
 12016       GO TO 3040-EDIT-CONTINUE.
 12017
 12018     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12019          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12020          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12021           GO TO 3040-EDIT-CONTINUE.
 12022
 12023     MOVE LOW-VALUES            TO ERREIN-KEY.
 12024     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12025     MOVE 'A'                   TO REIN-TYPE.
 12026     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12027
 12028     MOVE '3028'                TO REIN-SW.
 12029     MOVE ' '                   TO WS-REIN-READ-SW.
 12030
 12031     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12032     IF REIN-TABLE-NOT-FOUND
 12033         GO TO 3028-NO-REIN-TABLE.
 12034
 12035     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12036     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12037                                   WS-NSP-ST-CD-LF.
 12038     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12039                                   WS-NSP-ST-CD-AH.
 12040
 12041     GO TO 3040-EDIT-CONTINUE.
 12042
 12043 3028-NO-REIN-TABLE.
 12044
 12045     MOVE ER-2615                TO WS-ERROR.
 12046     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12047     GO TO 3040-EDIT-CONTINUE.
 12048
 12049 3040-EDIT-CONTINUE.
 12050
 12051     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12052         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12053
 12054     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12055         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12056
 12057     IF (NOT PB-REISSUED-CERT)
 12058        AND (NOT PB-MONTHLY-CERT)
 12059        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12060            MOVE '001'           TO PB-I-LF-TERM
 12061            MOVE 'M'             TO PB-I-INSURED-SEX.
 12062
 12063     IF (NOT PB-REISSUED-CERT)
 12064        AND (NOT PB-MONTHLY-CERT)
 12065        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12066            MOVE '001'           TO PB-I-AH-TERM
 12067            MOVE 'M'             TO PB-I-INSURED-SEX.
 12068
 12069 3040-EDIT-1ST-PMT-DT.
 12070     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12071     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 220
* EL050.cbl
 12072         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12073
 12074******************************************************************
 12075*                                                                *
 12076*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12077*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12078*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12079*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12080*                                                                *
 12081******************************************************************
 12082
 12083     IF PB-EFF-DT-PROCESSING
 12084        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12085                                    PB-I-LF-EXPIRE-DT
 12086                                    PB-I-AH-EXPIRE-DT
 12087        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12088        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12089        MOVE ZERO                TO DC-ELAPSED-DAYS
 12090        MOVE +1                  TO DC-ELAPSED-MONTHS
 12091        SET BIN-PLUS-ELAPSED     TO TRUE
 12092*       MOVE 6                   TO DC-OPTION-CODE
 12093        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12094        IF NO-CONVERSION-ERROR
 12095           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12096
 12097******************************************************************
 12098*                                                                *
 12099*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12100*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12101*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12102*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12103*                                                                *
 12104******************************************************************
 12105
 12106     IF PB-EXT-DAYS-PROCESSING
 12107          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12108                                         PB-I-LF-EXPIRE-DT
 12109                                         PB-I-AH-EXPIRE-DT
 12110          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12111          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12112          MOVE +1                     TO DC-ELAPSED-MONTHS
 12113          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12114          SET BIN-PLUS-ELAPSED        TO TRUE
 12115*         MOVE 6                      TO DC-OPTION-CODE
 12116          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12117          IF NO-CONVERSION-ERROR
 12118             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12119
 12120******************************************************************
 12121*                                                                *
 12122*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12123*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12124*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12125*        (EXPIRE DATE - (TERM -1))  *  -1.
 12126*                                                                *
 12127******************************************************************
 12128
 12129     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 221
* EL050.cbl
 12130        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12131           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12132              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12133              MOVE PB-I-AH-TERM      TO WS-TERM
 12134           ELSE
 12135              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12136              MOVE PB-I-LF-TERM      TO WS-TERM
 12137        ELSE
 12138           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12139              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12140              MOVE PB-I-LF-TERM      TO WS-TERM
 12141           ELSE
 12142              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12143              MOVE PB-I-AH-TERM      TO WS-TERM.
 12144
 12145     IF PB-EXPIRE-DT-PROCESSING
 12146        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12147        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12148        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12149        MOVE ZERO                TO DC-ELAPSED-DAYS
 12150                                    DC-ODD-DAYS-OVER
 12151          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12152          SET BIN-PLUS-ELAPSED    TO TRUE
 12153*         MOVE 6                  TO DC-OPTION-CODE
 12154          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12155          IF NO-CONVERSION-ERROR
 12156             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12157
 12158******************************************************************
 12159*                                                                *
 12160*            1ST PAYMENT DATE PROCESSING                         *
 12161*                                                                *
 12162******************************************************************
 12163
 12164     IF PB-1ST-PMT-DT-PROCESSING
 12165        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12166                                    PB-I-AH-EXPIRE-DT
 12167        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12168
 12169     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12170         NEXT SENTENCE
 12171     ELSE
 12172         MOVE ER-2680                 TO WS-ERROR
 12173         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12174         GO TO 3060-ORIG-TERM-CHECK.
 12175
 12176     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12177     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12178     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12179*    MOVE 1                      TO DC-OPTION-CODE.
 12180     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12181                                    DC-ELAPSED-DAYS
 12182                                    DC-ODD-DAYS-OVER.
 12183
 12184     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12185
 12186     IF DATE-CONVERSION-ERROR
 12187        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 222
* EL050.cbl
 12188
 12189     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12190     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12191        AND (WS-LF-COVERAGE-TYPE = 'L')
 12192        IF (DC-ELAPSED-MONTHS > 1)
 12193                      OR
 12194           ((DC-ELAPSED-MONTHS = 1)
 12195           AND (DC-ODD-DAYS-OVER > 0))
 12196           MOVE ER-2882          TO WS-ERROR
 12197           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12198        END-IF
 12199     END-IF
 12200     if dc-elapsed-months > 0
 12201        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12202        + dc-odd-days-over
 12203     end-if
 12204     IF PB-EXT-DAYS-PROCESSING
 12205        CONTINUE
 12206     ELSE
 12207        IF DC-ELAPSED-MONTHS = +0
 12208           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12209        ELSE
 12210           IF (WS-LF-EARNINGS-CALC = '4')
 12211              AND (DC-ELAPSED-MONTHS > ZERO)
 12212              AND (DC-ELAPSED-DAYS > ZERO)
 12213              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12214           ELSE
 12215              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12216                                 THRU 6499-EXIT
 12217              MOVE WS-ODD-DAYS-OVER
 12218                                 TO PB-I-EXTENTION-DAYS
 12219           END-IF
 12220        END-IF
 12221     END-IF
 12222******************************************************************
 12223*                                                                *
 12224*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12225*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12226*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12227*            AND ANY ODD DAYS.                                   *
 12228*                                                                *
 12229******************************************************************
 12230
 12231     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12232                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12233     IF WS-LF-EARNINGS-CALC NOT = '4'
 12234        IF DC-ELAPSED-DAYS > ZEROS
 12235           MOVE ER-2681          TO WS-ERROR
 12236           PERFORM 9900-ERROR-FORMAT
 12237                                 THRU 9900-EXIT
 12238        END-IF
 12239     END-IF
 12240
 12241     IF WS-LF-EARNINGS-CALC NOT = '4'
 12242        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12243           MOVE ER-2681          TO WS-ERROR
 12244           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12245
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 223
* EL050.cbl
 12246     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12247        (PB-I-LF-TERM NOT = ZERO) AND
 12248         NOT NO-LIFE-COVERAGE
 12249          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12250          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12251          IF WS-LF-EARNINGS-CALC = '4'
 12252             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12253             PB-I-PAY-FREQUENCY
 12254          END-IF
 12255          MOVE ZERO              TO DC-ELAPSED-DAYS
 12256                                    DC-ODD-DAYS-OVER
 12257          MOVE 1                 TO DC-END-OF-MONTH
 12258          SET BIN-PLUS-ELAPSED        TO TRUE
 12259*         MOVE 6                 TO DC-OPTION-CODE
 12260          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12261          IF NO-CONVERSION-ERROR
 12262             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12263             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12264                (WS-LF-SPECIAL-CALC-CD = 'L')
 12265                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12266                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12267                  MOVE +1             TO DC-ELAPSED-MONTHS
 12268                  SET BIN-PLUS-ELAPSED  TO TRUE
 12269*                 MOVE 6              TO DC-OPTION-CODE
 12270                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12271                  IF NO-CONVERSION-ERROR
 12272                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12273
 12274* okay, i had to move the new att age edit down here because the
 12275* expiration date could get recalculated and i need the exp date
 12276     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12277        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12278        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12279        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12280           AND ZEROS
 12281           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12282           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12283           SET ELAPSED-BETWEEN-BIN TO TRUE
 12284           PERFORM 8500-DATE-CONVERT
 12285                                 THRU 8500-EXIT
 12286           IF NO-CONVERSION-ERROR
 12287              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12288                 MOVE ER-2669       TO WS-ERROR
 12289*                PERFORM 9900-ERROR-FORMAT
 12290*                                THRU 9900-EXIT
 12291              END-IF
 12292           END-IF
 12293        ELSE
 12294           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12295           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12296              MOVE ER-2669       TO WS-ERROR
 12297*             PERFORM 9900-ERROR-FORMAT
 12298*                                THRU 9900-EXIT
 12299           ELSE
 12300              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12301                 MOVE ER-1570    TO WS-ERROR
 12302                 PERFORM 9900-ERROR-FORMAT
 12303                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 224
* EL050.cbl
 12304              END-IF
 12305           END-IF
 12306        END-IF
 12307        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12308           AND ZEROS
 12309           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12310           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12311           SET ELAPSED-BETWEEN-BIN TO TRUE
 12312           PERFORM 8500-DATE-CONVERT
 12313                                 THRU 8500-EXIT
 12314           IF NO-CONVERSION-ERROR
 12315              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12316                 MOVE ER-2669       TO WS-ERROR
 12317*                PERFORM 9900-ERROR-FORMAT
 12318*                                THRU 9900-EXIT
 12319              END-IF
 12320           END-IF
 12321        ELSE
 12322           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12323             (PB-I-LF-TERM / 12)
 12324           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12325              MOVE ER-2669       TO WS-ERROR
 12326*             PERFORM 9900-ERROR-FORMAT
 12327*                                THRU 9900-EXIT
 12328           ELSE
 12329              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12330                 MOVE ER-1571    TO WS-ERROR
 12331                 PERFORM 9900-ERROR-FORMAT
 12332                                 THRU 9900-EXIT
 12333              END-IF
 12334           END-IF
 12335        END-IF
 12336        IF WS-ERROR = ER-2669
 12337           PERFORM 9900-ERROR-FORMAT
 12338                                 THRU 9900-EXIT
 12339        END-IF
 12340     END-IF
 12341     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12342        (PB-I-AH-TERM NOT = ZERO) AND
 12343         NOT NO-AH-COVERAGE
 12344          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12345             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12346             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12347             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12348          ELSE
 12349             IF WS-LF-EARNINGS-CALC = '4'
 12350                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12351                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12352                PB-I-PAY-FREQUENCY
 12353             ELSE
 12354                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12355                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12356             END-IF
 12357          END-IF
 12358          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12359                                         DC-ODD-DAYS-OVER
 12360          MOVE 1                      TO DC-END-OF-MONTH
 12361          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 225
* EL050.cbl
 12362*         MOVE 6                      TO DC-OPTION-CODE
 12363          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12364          IF NO-CONVERSION-ERROR
 12365             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12366     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12367        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12368        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12369        IF PB-I-BIRTHDAY > LOW-VALUES
 12370           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12371           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12372           SET ELAPSED-BETWEEN-BIN TO TRUE
 12373           PERFORM 8500-DATE-CONVERT
 12374                                 THRU 8500-EXIT
 12375           IF NO-CONVERSION-ERROR
 12376              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12377                 MOVE ER-3054       TO WS-ERROR
 12378*                PERFORM 9900-ERROR-FORMAT
 12379*                                THRU 9900-EXIT
 12380              END-IF
 12381           END-IF
 12382        ELSE
 12383           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12384           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12385              MOVE ER-3054       TO WS-ERROR
 12386*             PERFORM 9900-ERROR-FORMAT
 12387*                                THRU 9900-EXIT
 12388           END-IF
 12389        END-IF
 12390        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12391           AND ZEROS
 12392           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12393           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12394           SET ELAPSED-BETWEEN-BIN TO TRUE
 12395           PERFORM 8500-DATE-CONVERT
 12396                                 THRU 8500-EXIT
 12397           IF NO-CONVERSION-ERROR
 12398              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12399                 MOVE ER-3054       TO WS-ERROR
 12400*                PERFORM 9900-ERROR-FORMAT
 12401*                                THRU 9900-EXIT
 12402              END-IF
 12403           END-IF
 12404        ELSE
 12405           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12406             (PB-I-AH-TERM / 12)
 12407           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12408              MOVE ER-3054       TO WS-ERROR
 12409*             PERFORM 9900-ERROR-FORMAT
 12410*                                THRU 9900-EXIT
 12411           END-IF
 12412        END-IF
 12413        IF WS-ERROR = ER-3054
 12414           PERFORM 9900-ERROR-FORMAT
 12415                                 THRU 9900-EXIT
 12416        END-IF
 12417     END-IF
 12418     MOVE SPACE                       TO DC-END-OF-MONTH.
 12419
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 226
* EL050.cbl
 12420     IF PB-COMPANY-ID = 'NCB'
 12421        GO TO 3040-EDIT-EXTENSION-DAYS.
 12422
 12423     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12424       AND
 12425        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12426        NEXT SENTENCE
 12427     ELSE
 12428        GO TO 3040-EDIT-EXTENSION-DAYS.
 12429
 12430     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12431        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12432        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12433     ELSE
 12434        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12435        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12436
 12437     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12438*    MOVE '1'      TO DC-OPTION-CODE
 12439     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12440     IF (NO-CONVERSION-ERROR)
 12441        AND (DC-ELAPSED-MONTHS > +1)
 12442        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12443        MOVE ER-2668   TO WS-ERROR
 12444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12445
 12446 3040-EDIT-EXTENSION-DAYS.
 12447
 12448     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12449        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12450         GO TO 3050-EDIT-TERM-IN-DAYS
 12451     ELSE
 12452         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12453
 12454     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12455         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12456     ELSE
 12457        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12458           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12459           MOVE ER-2681         TO WS-ERROR
 12460           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12461
 12462     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12463        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12464        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12465         GO TO 3060-ORIG-TERM-CHECK.
 12466
 12467     GO TO 3060-ORIG-TERM-CHECK.
 12468
 12469 3050-EDIT-TERM-IN-DAYS.
 12470
 12471     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12472
 12473     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12474         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12475     ELSE
 12476         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12477            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 227
* EL050.cbl
 12478            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12479
 12480     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12481                                       REMAINDER WS-WORK-TERM.
 12482     IF WS-WORK-TERM GREATER THAN ZERO
 12483         ADD +1 TO PB-I-LF-TERM.
 12484
 12485     IF NOT NO-AH-COVERAGE
 12486         MOVE ER-2684            TO WS-ERROR
 12487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12488
 12489
 12490 3060-ORIG-TERM-CHECK.
 12491
 12492******************************************************************
 12493*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12494******************************************************************
 12495
 12496     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12497        NEXT SENTENCE
 12498     ELSE
 12499        IF NOT NO-LIFE-COVERAGE
 12500           IF PB-I-LF-TERM NUMERIC
 12501              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12502              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12503              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12504                  NEXT SENTENCE
 12505           ELSE
 12506              MOVE ER-2647       TO WS-ERROR
 12507              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12508
 12509     IF NOT NO-AH-COVERAGE
 12510         IF PB-I-AH-TERM NUMERIC
 12511            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12512            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12513            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12514             NEXT SENTENCE
 12515          ELSE
 12516              MOVE ER-2658       TO WS-ERROR
 12517              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12518
 12519     IF PB-COMPANY-ID = 'NCB'
 12520        GO TO 3070-LOAN-TERM-CHECK.
 12521
 12522     IF POLICY-HAS-AH
 12523       AND
 12524        POLICY-HAS-LIFE
 12525       AND
 12526        PB-I-LF-TERM NUMERIC
 12527       AND
 12528        PB-I-AH-TERM NUMERIC
 12529        NEXT SENTENCE
 12530     ELSE
 12531        GO TO 3070-LOAN-TERM-CHECK.
 12532
 12533     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12534     IF WS-TEX-FACT-2 LESS THAN +0
 12535        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 228
* EL050.cbl
 12536
 12537     IF WS-TEX-FACT-2 GREATER THAN +1
 12538        MOVE ER-2668             TO WS-ERROR
 12539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12540
 12541 3070-LOAN-TERM-CHECK.
 12542
 12543     IF (WS-LF-BENEFIT-CD = ZERO)
 12544         OR (NO-LF-BENEFIT-MATCH)
 12545            GO TO 3125-EDIT-PMT-FREQ.
 12546*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12547*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12548*          AND 'V' AND 'W' AND 'X'
 12549*          GO TO 3125-EDIT-PMT-FREQ
 12550*       END-IF
 12551*    ELSE
 12552*       IF WS-AH-DCC-TRUNC = 'T'
 12553*          CONTINUE
 12554*       ELSE
 12555*          GO TO 3125-EDIT-PMT-FREQ
 12556*       END-IF
 12557*    END-IF
 12558     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12559                    OR
 12560        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12561        AND (WS-AH-DCC-TRUNC = 'T'))
 12562        CONTINUE
 12563     ELSE
 12564        GO TO 3125-EDIT-PMT-FREQ
 12565     END-IF
 12566     IF PB-I-LOAN-TERM NOT NUMERIC
 12567         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12568
 12569     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12570        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12571*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12572        PB-I-LOAN-TERM NOT GREATER THAN +360
 12573         NEXT SENTENCE
 12574     ELSE
 12575         MOVE ER-2648            TO WS-ERROR
 12576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12577
 12578     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12579        MOVE ER-3058             TO WS-ERROR
 12580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12581     end-if
 12582
 12583     IF WS-STATE-ABBREVIATION = 'NC'
 12584        IF PB-I-LOAN-TERM > +59
 12585           CONTINUE
 12586        ELSE
 12587           MOVE ER-2792          TO WS-ERROR
 12588           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12589        END-IF
 12590     END-IF
 12591
 12592     .
 12593 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 229
* EL050.cbl
 12594     IF (WS-LF-BENEFIT-CD = ZERO)
 12595         OR (NO-LF-BENEFIT-MATCH)
 12596            GO TO 3127-EDIT-LOAN-OFFICER.
 12597     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12598                    OR
 12599        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12600        AND (WS-AH-DCC-TRUNC = 'T'))
 12601                    OR
 12602         (PB-COMPANY-ID = 'AHL')
 12603        CONTINUE
 12604     ELSE
 12605        IF (PB-I-LOAN-TERM > ZEROS)
 12606           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12607           MOVE ER-1575          TO WS-ERROR
 12608           PERFORM 9900-ERROR-FORMAT
 12609                                 THRU 9900-EXIT
 12610        END-IF
 12611     END-IF
 12612     IF WS-LF-EARNINGS-CALC NOT = '4'
 12613         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12614            MOVE ER-2653         TO WS-ERROR
 12615            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12616            GO TO 3127-EDIT-LOAN-OFFICER
 12617         ELSE
 12618            GO TO 3127-EDIT-LOAN-OFFICER.
 12619
 12620     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12621         MOVE ER-2655            TO WS-ERROR
 12622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12623         GO TO 3127-EDIT-LOAN-OFFICER.
 12624
 12625     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12626         MOVE ER-2654            TO WS-ERROR
 12627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12628         GO TO 3127-EDIT-LOAN-OFFICER.
 12629
 12630     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12631         GIVING WS-TEX-FACT-2
 12632             REMAINDER WS-TEX-FACT-3.
 12633
 12634*    IF WS-TEX-FACT-3 NOT = ZERO
 12635*       MOVE ER-2654             TO WS-ERROR
 12636*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12637
 12638
 12639 3127-EDIT-LOAN-OFFICER.
 12640
 12641     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12642        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12643           MOVE ER-2690          TO WS-ERROR
 12644           PERFORM 9900-ERROR-FORMAT
 12645                                 THRU 9900-EXIT
 12646        ELSE
 12647           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12648           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12649           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12650           MOVE PB-SV-STATE      TO LOFC-STATE
 12651           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 230
* EL050.cbl
 12652           MOVE PB-I-LOAN-OFFICER
 12653                                 TO LOFC-CODE
 12654           PERFORM 8586-READ-LOAN-OFFICER
 12655                                 THRU 8586-EXIT
 12656           IF (NOT LOFC-MASTER-FOUND)
 12657              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12658              MOVE ER-3006       TO WS-ERROR
 12659              PERFORM 9900-ERROR-FORMAT
 12660                                 THRU 9900-EXIT
 12661           END-IF
 12662        END-IF
 12663     END-IF
 12664     .
 12665 3129-EDIT-APR.
 12666
 12667     IF (WS-LF-BENEFIT-CD = ZERO)
 12668        OR (NO-LF-BENEFIT-MATCH)
 12669        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12670           GO TO 3130-EDIT-AGE
 12671*       ELSE
 12672*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12673*             GO TO 3130-EDIT-AGE
 12674*          END-IF
 12675        END-IF
 12676     END-IF
 12677
 12678     IF (WS-STATE-ABBREVIATION = 'OH')
 12679         AND (PB-I-RATE-CLASS NOT = 'L ')
 12680         AND (PB-I-LF-TERM GREATER THAN 60)
 12681         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12682         GO TO 3129-APR-CONT.
 12683
 12684     IF (WS-STATE-ABBREVIATION = 'RI')
 12685         AND (PB-I-LF-TERM GREATER THAN 60)
 12686         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12687         GO TO 3129-APR-CONT.
 12688
 12689     IF (WS-STATE-ABBREVIATION = 'UT')
 12690         AND (PB-I-LF-TERM GREATER THAN 62)
 12691         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12692         AND (PB-CERT-EFF-DT LESS WS-830901)
 12693         GO TO 3129-APR-CONT.
 12694
 12695     IF PB-COMPANY-ID = 'LAP'
 12696        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12697           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12698              MOVE ER-2656         TO WS-ERROR
 12699              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12700              GO TO 3130-EDIT-AGE.
 12701
 12702     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12703        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12704        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12705        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12706        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12707        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12708         GO TO 3130-EDIT-AGE.
 12709
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 231
* EL050.cbl
 12710 3129-APR-CONT.
 12711     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12712         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12713         GO TO 3130-EDIT-AGE.
 12714
 12715     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12716         WS-AH-BENEFIT-CD (1:1) = 'S')
 12717        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12718        AND (PB-I-LOAN-APR = ZERO)
 12719        MOVE ER-2657             TO WS-ERROR
 12720        PERFORM 9900-ERROR-FORMAT
 12721                                 THRU 9900-EXIT
 12722        GO TO 3130-EDIT-AGE
 12723     END-IF
 12724*    IF PB-I-LOAN-APR = ZERO
 12725*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12726*    END-IF
 12727
 12728     if pb-i-loan-apr = +99.9999
 12729        move er-2656             to ws-error
 12730        PERFORM 9900-ERROR-FORMAT
 12731                                 THRU 9900-EXIT
 12732        GO TO 3130-EDIT-AGE
 12733     end-if
 12734*    IF PB-I-LOAN-APR = ZERO
 12735*       MOVE ER-2656             TO WS-ERROR
 12736*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12737*       GO TO 3130-EDIT-AGE.
 12738
 12739*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12740     if pb-i-loan-apr not = +99.9999
 12741        IF PB-I-LOAN-APR > +30.000
 12742           MOVE ER-2657          TO WS-ERROR
 12743           PERFORM 9900-ERROR-FORMAT
 12744                                 THRU 9900-EXIT
 12745        end-if
 12746     end-if
 12747     .
 12748 3130-EDIT-AGE.
 12749
 12750******************************************************************
 12751*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12752******************************************************************
 12753
 12754     IF NOT NO-LIFE-COVERAGE
 12755        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12756           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12757               MOVE ER-2628             TO WS-ERROR
 12758               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12759
 12760     IF NOT NO-AH-COVERAGE
 12761        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12762           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12763               MOVE ER-2628         TO WS-ERROR
 12764               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12765
 12766 3133-SEX-CODE.
 12767     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 232
* EL050.cbl
 12768         IF WS-DEFAULT-SEX = 'M'
 12769             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12770          ELSE
 12771             IF WS-DEFAULT-SEX = 'F'
 12772             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12773
 12774     IF PB-I-INSURED-SEX = '1'
 12775         MOVE 'M' TO PB-I-INSURED-SEX.
 12776
 12777     IF PB-I-INSURED-SEX = '2'
 12778         MOVE 'F' TO PB-I-INSURED-SEX.
 12779
 12780 3134-SIG-SW-EDIT.
 12781     IF PB-I-SIG-SW = SPACE
 12782         MOVE 'N'                TO  PB-I-SIG-SW.
 12783
 12784     IF PB-COMPANY-ID = 'NCL'
 12785         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12786             NEXT SENTENCE
 12787         ELSE
 12788             MOVE ER-1923        TO  WS-ERROR
 12789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12790     ELSE
 12791     IF PB-COMPANY-ID = 'CRI'
 12792         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12793             NEXT SENTENCE
 12794         ELSE
 12795             MOVE ER-2606        TO  WS-ERROR
 12796             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12797     ELSE
 12798     IF PB-COMPANY-ID = 'TMS'
 12799         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12800             NEXT SENTENCE
 12801         ELSE
 12802             MOVE ER-2689        TO  WS-ERROR
 12803             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12804     ELSE
 12805         IF PB-I-SIG-SW = 'Y' OR 'N'
 12806             NEXT SENTENCE
 12807         ELSE
 12808             MOVE ER-2651        TO  WS-ERROR
 12809             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12810
 12811     IF PB-COMPANY-ID = 'FLA'
 12812         IF (WS-EDIT-AGE GREATER 54  OR
 12813             WS-AH-EDIT-AGE GREATER 54)  AND
 12814            PB-I-SIG-SW = 'N'
 12815            MOVE ER-2651         TO  WS-ERROR
 12816            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12817
 12818 3135-NAME-EDIT.
 12819
 12820     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12821        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12822        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12823           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12824                                 TO PB-I-JOINT-FIRST-NAME
 12825        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 233
* EL050.cbl
 12826     END-IF
 12827     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12828        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12829        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12830           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12831                                 TO PB-I-JOINT-LAST-NAME
 12832        END-PERFORM
 12833     END-IF
 12834     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12835        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12836        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12837           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12838                                 TO PB-I-INSURED-FIRST-NAME
 12839        END-PERFORM
 12840     END-IF
 12841     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12842        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12843        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12844           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12845                                 TO PB-I-INSURED-LAST-NAME
 12846        END-PERFORM
 12847     END-IF
 12848     IF PB-I-INSURED-LAST-NAME = SPACES
 12849       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12850       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12851           MOVE ER-2660    TO WS-ERROR
 12852           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12853
 12854 3136-EDIT-SEX.
 12855
 12856******************************************************************
 12857*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12858******************************************************************
 12859
 12860     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12861        (WS-AH-SPECIAL-CALC-CD = 'O')
 12862        NEXT SENTENCE
 12863     ELSE
 12864        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12865           NEXT SENTENCE
 12866        ELSE
 12867           MOVE ER-2629            TO WS-ERROR
 12868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12869
 12870 3137-EDIT-EFF-DATE.
 12871
 12872     IF PB-REISSUED-CERT       OR
 12873        PB-POLICY-IS-DECLINED  OR
 12874        PB-POLICY-IS-VOIDED
 12875         GO TO 3139-EDIT-COVERAGE-CODES.
 12876
 12877     MOVE SPACE                  TO WS-2671-SW
 12878                                    WS-2672-SW.
 12879
 12880     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12881         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12882             MOVE ER-2703        TO WS-ERROR
 12883             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 234
* EL050.cbl
 12884             GO TO 3139-EDIT-COVERAGE-CODES.
 12885
 12886     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12887         GO TO 3139-EDIT-COVERAGE-CODES.
 12888
 12889     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12890     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12891*    MOVE '1'                    TO DC-OPTION-CODE.
 12892     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12893     MOVE +0                     TO DC-ELAPSED-MONTHS
 12894                                    DC-ELAPSED-DAYS.
 12895     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12896
 12897     IF DATE-CONVERSION-ERROR
 12898         GO TO 3139-EDIT-COVERAGE-CODES.
 12899
 12900     IF DC-ELAPSED-DAYS GREATER +180
 12901         MOVE ER-2672            TO WS-ERROR
 12902         MOVE 'Y'                TO WS-2672-SW
 12903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12904     END-IF
 12905
 12906     IF WS-ERROR = ER-2671  AND
 12907        PB-COMPANY-ID  = 'LBL'
 12908        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12909        MOVE SPACE               TO WS-2671-SW
 12910        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12911
 12912     IF PB-ISSUE-DATE-FORCED  AND
 12913      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12914         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12915         MOVE ER-2673            TO WS-ERROR
 12916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12917         MOVE SPACE              TO WS-2671-SW
 12918                                    WS-2672-SW.
 12919
 12920     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12921         IF PB-ISSUE-DATE-FORCED
 12922             MOVE ER-2600          TO  WS-ERROR
 12923             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12924         ELSE
 12925             MOVE ER-2692          TO  WS-ERROR
 12926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12927
 12928
 12929 3139-EDIT-COVERAGE-CODES.
 12930
 12931     if pb-company-id not = 'AHL'
 12932        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12933           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12934           MOVE ER-2787          TO WS-ERROR
 12935           PERFORM 9900-ERROR-FORMAT
 12936                                 THRU 9900-EXIT
 12937        END-IF
 12938     end-if
 12939     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12940        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12941                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 235
* EL050.cbl
 12942           MOVE ER-2719          TO WS-ERROR
 12943           PERFORM 9900-ERROR-FORMAT
 12944                                 THRU 9900-EXIT
 12945        END-IF
 12946     END-IF
 12947
 12948     IF PB-POLICY-IS-DECLINED  OR
 12949        PB-POLICY-IS-VOIDED
 12950         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12951
 12952     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12953        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12954         MOVE ER-2630                TO WS-ERROR
 12955         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12956
 12957     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12958        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12959        PB-I-LF-PREMIUM-AMT = ZERO
 12960         GO TO 3140-CHECK-AH-FOR-ZERO.
 12961
 12962     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12963        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12964        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12965         GO TO 3140-CHECK-AH-FOR-ZERO.
 12966
 12967     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12968        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12969        MOVE ER-2631             TO WS-ERROR
 12970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12971     END-IF
 12972
 12973
 12974******************************************************************
 12975*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12976******************************************************************
 12977
 12978     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12979        NEXT SENTENCE
 12980     ELSE
 12981        IF PB-I-LF-BENEFIT-AMT = ZERO
 12982           MOVE ER-2632             TO WS-ERROR
 12983           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12984
 12985
 12986******************************************************************
 12987*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12988******************************************************************
 12989
 12990     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12991        CONTINUE
 12992     ELSE
 12993        IF PB-I-LF-PREMIUM-AMT = ZERO
 12994           IF (NOT PB-COMP-LF-PREM)
 12995              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12996              and (ws-lf-ben-category not = 'C')
 12997              MOVE ER-2633       TO WS-ERROR
 12998              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12999           END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 236
* EL050.cbl
 13000        END-IF
 13001     END-IF
 13002     .
 13003 3140-CHECK-AH-FOR-ZERO.
 13004
 13005     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13006        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13007        PB-I-AH-PREMIUM-AMT = ZERO
 13008         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13009
 13010     IF PB-COMPANY-ID = 'CSL'  AND
 13011        PB-I-AH-BENEFIT-CD = ZERO  AND
 13012        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13013        PB-I-AH-PREMIUM-AMT = ZERO
 13014         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13015
 13016     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13017        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13018        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13019         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13020
 13021     IF PB-I-AH-BENEFIT-CD = ZERO
 13022         MOVE ER-2634            TO WS-ERROR
 13023         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13024
 13025******************************************************************
 13026*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13027******************************************************************
 13028
 13029     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13030        NEXT SENTENCE
 13031     ELSE
 13032        IF PB-I-AH-BENEFIT-AMT = ZERO
 13033           MOVE ER-2635             TO WS-ERROR
 13034           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13035
 13036******************************************************************
 13037*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13038******************************************************************
 13039
 13040     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13041        NEXT SENTENCE
 13042     ELSE
 13043        IF PB-I-AH-PREMIUM-AMT = ZERO
 13044            IF NOT PB-COMP-AH-PREM
 13045                MOVE ER-2636    TO WS-ERROR
 13046                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13047
 13048
 13049 3140-EDIT-MAX-AMT-SIZES.
 13050* CUSTOM CODE FOR CLIENT    'DMD'
 13051     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13052                                     WS-RES-MUNI-TAX
 13053                                     PB-I-STATE-TAX
 13054                                     PB-I-MUNI-TAX.
 13055
 13056     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13057
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 237
* EL050.cbl
 13058     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13059        GO TO 3150-RATE-OUTSTAND-BAL.
 13060
 13061     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13062        GO TO 3150-RATE-OUTSTAND-BAL.
 13063
 13064     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13065        GO TO 3150-RATE-OUTSTAND-BAL.
 13066
 13067     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13068                             OR 'RIC')
 13069        GO TO 3150-RATE-OUTSTAND-BAL.
 13070
 13071     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13072        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13073            GO TO 3150-RATE-OUTSTAND-BAL
 13074        ELSE
 13075           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13076               GO TO 3150-RATE-OUTSTAND-BAL.
 13077
 13078     IF NOT PB-NO-MONTHS-SKIPPED
 13079        GO TO 3150-RATE-OUTSTAND-BAL.
 13080
 13081     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13082        GO TO 3150-RATE-OUTSTAND-BAL.
 13083
 13084     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13085        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13086           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13087             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13088           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13089           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13090              MOVE ER-2693     TO WS-ERROR
 13091              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13092              GO TO 3150-RATE-OUTSTAND-BAL
 13093           ELSE
 13094              GO TO 3150-RATE-OUTSTAND-BAL.
 13095
 13096 3150-RATE-OUTSTAND-BAL.
 13097
 13098* DMD RATING TEST
 13099     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13100         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13101         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13102         MOVE ER-2687                 TO WS-ERROR
 13103         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13104         MOVE 'B'                     TO PB-I-OB-FLAG
 13105         GO TO 3260-EDIT-CONTINUE.
 13106
 13107     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13108         IF  WS-ERROR    EQUAL    ER-2693
 13109             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13110                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13111                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13112                 MOVE  +0            TO  WS-ERROR.
 13113
 13114     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13115         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 238
* EL050.cbl
 13116             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13117                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13118                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13119                 MOVE  +0            TO  WS-ERROR.
 13120
 13121     IF PLAN-MASTER-AH-SW = 'Y'
 13122        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13123            IF  WS-ERROR    EQUAL    ER-2693
 13124              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13125                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13126                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13127                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13128                 MOVE  ER-1910           TO  WS-ERROR
 13129                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13130
 13131     IF PLAN-MASTER-AH-SW = 'Y'
 13132        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13133            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13134               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13135               MOVE  ER-1910           TO  WS-ERROR
 13136               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13137
 13138     IF PLAN-MASTER-AH-SW = 'Y'
 13139        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13140            IF  WS-ERROR    EQUAL    ER-2693
 13141                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13142                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13143                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13144                 MOVE  +0       TO  WS-ERROR.
 13145
 13146     IF WS-ERROR = ER-2693
 13147        IF PB-COMPANY-ID = 'JAL' AND
 13148           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13149           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13150           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13151
 13152     IF WS-ERROR = ER-2693
 13153        IF PB-COMPANY-ID = 'NCL'  AND
 13154           PB-I-AH-BENEFIT-CD = 'OA'
 13155           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13156           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13157
 13158     IF WS-ERROR = ER-2693
 13159        IF PB-COMPANY-ID = 'CNL' AND
 13160           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13161           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13162           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13163
 13164     IF WS-ERROR = ER-2693
 13165        IF PB-COMPANY-ID = 'HER'
 13166           IF WS-LEVEL
 13167              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13168              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13169
 13170     IF ((LF-BENEFIT-FOUND) AND
 13171         (NOT NO-LIFE-COVERAGE)  AND
 13172         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13173       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 239
* EL050.cbl
 13174             (NOT NO-AH-COVERAGE)    AND
 13175             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13176         NEXT SENTENCE
 13177     ELSE
 13178         GO TO 3215-EDIT-RATES.
 13179
 13180     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13181        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13182           MOVE ER-2674          TO WS-ERROR
 13183           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13184           GO TO 3215-EDIT-RATES.
 13185
 13186     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13187        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13188           MOVE ER-2674          TO WS-ERROR
 13189           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13190           GO TO 3215-EDIT-RATES.
 13191
 13192     MOVE 'B'                    TO PB-I-OB-FLAG.
 13193
 13194     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13195         NEXT SENTENCE
 13196     ELSE
 13197         IF NOT NO-LIFE-COVERAGE
 13198             IF WS-ACCT-LF-OB-RT = ZERO
 13199                MOVE ER-2641    TO WS-ERROR
 13200                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13201
 13202     IF PB-COMPANY-ID = 'CRI'
 13203       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13204         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13205         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13206         IF WS-ERROR = ER-2675
 13207            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13208            MOVE ER-2687              TO WS-ERROR
 13209            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13210         ELSE
 13211            MOVE ER-2687              TO WS-ERROR
 13212            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13213
 13214
 13215     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13216         NEXT SENTENCE
 13217     ELSE
 13218       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13219            NEXT SENTENCE
 13220       ELSE
 13221         IF NOT NO-AH-COVERAGE
 13222             IF WS-ACCT-AH-OB-RT = ZERO
 13223                MOVE ER-2642    TO WS-ERROR
 13224                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13225
 13226     IF PB-COMPANY-ID = 'CRI'
 13227       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13228         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13229         IF WS-ERROR = ER-2676
 13230            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13231            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 240
* EL050.cbl
 13232            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13233         ELSE
 13234            MOVE ER-2687              TO WS-ERROR
 13235            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13236
 13237     IF PB-COMPANY-ID NOT = 'GIC'
 13238         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13239            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13240     ELSE
 13241         IF PB-I-LF-PREM-CALC = ZEROS
 13242             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13243                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13244
 13245     IF PB-COMPANY-ID NOT = 'GIC'
 13246         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13247            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13248     ELSE
 13249         IF PB-I-AH-PREM-CALC = ZEROS
 13250             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13251                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13252
 13253     MOVE ZEROS TO PB-I-MORT-CODE.
 13254
 13255     GO TO 3260-EDIT-CONTINUE.
 13256
 13257
 13258 3215-EDIT-RATES.
 13259     IF ACCOUNT-MAST-FOUND
 13260         NEXT SENTENCE
 13261     ELSE
 13262         GO TO 3999-END-EDIT.
 13263
 13264 3220-CHECK-LF-RATES.
 13265
 13266     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13267        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13268        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13269        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13270           AND (NOT WS-LF-CASH))
 13271                           OR
 13272           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13273           AND (NOT WS-AH-CASH)))
 13274                       AND
 13275           (PB-I-ENTRY-STATUS NOT = '5')
 13276           MOVE 'M'              TO PB-BATCH-ENTRY
 13277                                    PB-I-ENTRY-STATUS
 13278        END-IF
 13279     END-IF
 13280     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13281                                    PB-I-AH-PREM-CALC
 13282                                    PB-I-LF-ALT-PREM-CALC
 13283                                    PB-I-LF-ALT-RATE
 13284                                    PB-I-LF-REI-RATE
 13285                                    PB-I-LF-ALT-REI-RATE
 13286                                    PB-I-AH-REI-RATE
 13287                                    PB-I-TOT-FEES-CALC.
 13288
 13289     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 241
* EL050.cbl
 13290        NEXT SENTENCE
 13291     ELSE
 13292        MOVE ZEROS               TO PB-I-LF-RATE
 13293                                    PB-I-AH-RATE.
 13294
 13295     IF PB-I-TOT-FEES NOT NUMERIC
 13296        MOVE ZEROS               TO PB-I-TOT-FEES
 13297     END-IF
 13298     IF PB-I-LIVES NOT NUMERIC
 13299         MOVE ZERO               TO PB-I-LIVES.
 13300
 13301     IF PB-I-NUM-BILLED NOT NUMERIC
 13302         MOVE ZERO               TO PB-I-NUM-BILLED.
 13303
 13304     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13305        MOVE +0                  TO PB-I-LF-PREM-TAX
 13306     END-IF
 13307
 13308     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13309        MOVE +0                  TO PB-I-AH-PREM-TAX
 13310     END-IF
 13311
 13312     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13313        PB-I-PAY-FREQUENCY = ZEROS
 13314            MOVE 12 TO CP-PAY-FREQUENCY
 13315     ELSE
 13316            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13317
 13318     IF PB-I-STATE-TAX NOT NUMERIC
 13319         MOVE ZEROS               TO PB-I-STATE-TAX.
 13320
 13321     IF PB-I-MUNI-TAX NOT NUMERIC
 13322         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13323
 13324     MOVE SPACES                 TO CP-BEN-CATEGORY
 13325     IF PB-COMPANY-ID  = 'CSL'  AND
 13326        PB-I-LF-TERM NOT = ZERO
 13327        COMPUTE WS-PAYMENT-AMT =
 13328             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13329        COMPUTE WS-CSL-AMT1 =
 13330             PB-I-LF-TERM * AM-MAX-MON-BEN
 13331        COMPUTE WS-CSL-AMT2 =
 13332             WS-PAYMENT-AMT * PB-I-LF-TERM
 13333        IF CP-PAY-FREQUENCY NOT = 12
 13334           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13335           MOVE '8' TO WS-CSL-CALC-CD
 13336        ELSE
 13337           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13338              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13339               AM-MAX-TOT-BEN
 13340               MOVE '6' TO WS-CSL-CALC-CD
 13341           ELSE
 13342              IF (WS-CSL-AMT1  GREATER THAN
 13343                 AM-MAX-TOT-BEN) AND
 13344                 (WS-CSL-AMT2  GREATER THAN
 13345                 AM-MAX-TOT-BEN)
 13346                 MOVE '7' TO WS-CSL-CALC-CD
 13347              ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 242
* EL050.cbl
 13348                 MOVE '5' TO WS-CSL-CALC-CD.
 13349
 13350     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13351         NEXT SENTENCE
 13352     ELSE
 13353         GO TO 3300-CHECK-AH-RATES.
 13354
 13355*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13356
 13357     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13358        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13359              OR
 13360           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13361           MOVE ER-2618          TO WS-ERROR
 13362           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13363           GO TO 3300-CHECK-AH-RATES.
 13364
 13365     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13366           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13367                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13368
 13369     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13370         MOVE ER-2687             TO WS-ERROR
 13371         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13372         MOVE 'Z000'              TO PB-I-MORT-CODE
 13373         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13374         GO TO 3300-CHECK-AH-RATES.
 13375
 13376     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13377        IF PB-I-LIVES = ZERO
 13378           MOVE ER-2688          TO WS-ERROR
 13379           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13380
 13381     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13382
 13383     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13384     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13385     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13386     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13387     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13388     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13389     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13390     MOVE '3'                    TO CP-PROCESS-TYPE.
 13391     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13392     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13393
 13394******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13395     IF PB-COMPANY-ID EQUAL 'CDL'
 13396         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13397            CP-EARN-AS-NET-PAY)
 13398             IF PB-CERT-EFF-DT GREATER  WS-931231
 13399                 MOVE '1'        TO CP-EARNING-METHOD.
 13400*******
 13401
 13402     MOVE PB-SV-STATE            TO CP-STATE.
 13403     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13404     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13405     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 243
* EL050.cbl
 13406     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13407     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13408                                    CP-RATING-BENEFIT-AMT.
 13409     IF CP-STATE-STD-ABBRV = 'OR'
 13410         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13411                                         PB-I-LF-ALT-BENEFIT-AMT.
 13412     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13413     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13414     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13415     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13416     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13417     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13418     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13419     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13420     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13421                                    CP-REMAINING-TERM
 13422                                    CP-LOAN-TERM.
 13423
 13424     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13425         NEXT SENTENCE
 13426     ELSE
 13427         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13428             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13429                                           PB-I-LF-PREMIUM-AMT.
 13430
 13431     IF PB-COMPANY-ID EQUAL 'CSL'
 13432        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13433           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13434                                         PB-I-LF-PREMIUM-AMT.
 13435
 13436     IF PB-COMPANY-ID EQUAL 'NCB'
 13437         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13438            CP-EARN-AS-NET-PAY
 13439             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13440                 PB-I-LF-PREMIUM-AMT.
 13441
 13442     IF (CP-TRUNCATED-LIFE)
 13443        or ((pb-company-id = 'AHL')
 13444           and (pb-i-loan-term > pb-i-lf-term))
 13445        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13446
 13447     IF PB-COMPANY-ID EQUAL 'CRI'
 13448        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13449
 13450     IF CP-TERM-IS-DAYS
 13451         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13452     ELSE
 13453         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13454     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13455        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13456        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13457        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13458        IF WS-LF-BEN-CATEGORY = 'D'
 13459           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13460           MOVE PB-I-LIFE-COMMISSION
 13461                                 TO CP-DCC-ACT-COMM
 13462           MOVE WS-LF-BEN-CATEGORY
 13463                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 244
* EL050.cbl
 13464        END-IF
 13465        IF (CP-BENEFIT-CD (1:1) = 'P')
 13466           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13467           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13468           add pb-i-ah-premium-amt to cp-original-premium
 13469        END-IF
 13470     END-IF
 13471     IF PB-COMPANY-ID = 'CSL'
 13472         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13473         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13474         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13475
 13476     IF PB-COMPANY-ID = 'CSL'
 13477        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13478
 13479     IF (CP-SPECIAL-CALC-CD = 'H')
 13480        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13481         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13482                                    TO CP-ALTERNATE-BENEFIT
 13483         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13484     if (pb-company-id = 'CID')
 13485        and (ws-lf-earnings-calc = '4')
 13486        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13487        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13488        move pb-i-term-type      to cp-pmt-mode
 13489        move pb-i-no-of-payments to cp-no-of-pmts
 13490     end-if
 13491     move ws-net-only-state      to cp-net-only-state
 13492     IF (PB-COMPANY-ID = 'CID')
 13493        AND (WS-LF-EARNINGS-CALC = 'B')
 13494        AND (CP-STATE-STD-ABBRV = 'MN')
 13495        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13496                                 TO CP-ALTERNATE-BENEFIT
 13497        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13498     END-IF
 13499     IF (PB-COMPANY-ID = 'CID')
 13500        AND (WS-LF-EARNINGS-CALC = 'B')
 13501        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13502                                 TO CP-ALTERNATE-BENEFIT
 13503        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13504        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13505*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13506*         pb-i-lf-alt-premium-amt
 13507        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13508        IF WS-LF-BEN-CATEGORY = 'P'
 13509           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13510        ELSE
 13511           IF WS-LF-BEN-CATEGORY = 'I'
 13512              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13513           END-IF
 13514        END-IF
 13515     END-IF
 13516     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13517     MOVE 'R'                   TO CP-RATE-FILE.
 13518     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13519
 13520     IF CP-ERROR-RATE-NOT-FOUND
 13521        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 245
* EL050.cbl
 13522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13523        GO TO 3300-CHECK-AH-RATES.
 13524
 13525     IF PB-COMPANY-ID EQUAL 'CRI'
 13526        IF CP-ERROR-NO-LIMITS-CRI
 13527           IF NOT ACCOUNT-LIFE-CHECKED
 13528              MOVE ER-2607      TO WS-ERROR
 13529              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13530
 13531******************************************************************
 13532*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13533*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13534******************************************************************
 13535
 13536* CALC LIFE AGE AT EXPIRATION.
 13537
 13538     COMPUTE WS-AGE-AT-EXPIRE =
 13539          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13540
 13541*    IF PB-STATE = 'CO' OR 'UT'
 13542*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13543*        MOVE 'F'            TO PB-FATAL-FLAG
 13544*        MOVE ER-2709        TO WS-ERROR
 13545*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13546*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13547
 13548*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13549*        MOVE 'X'            TO PB-FATAL-FLAG
 13550*        MOVE ER-2718        TO WS-ERROR
 13551*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13552*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13553
 13554* CALC A & H AGE AT EXPIRATION.
 13555
 13556     COMPUTE WS-AGE-AT-EXPIRE =
 13557          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13558
 13559*    IF PB-STATE = 'CO' OR 'UT'
 13560*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13561*        MOVE 'F'            TO PB-FATAL-FLAG
 13562*        MOVE ER-2709        TO WS-ERROR
 13563*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13564*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13565
 13566*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13567*        MOVE 'X'            TO PB-FATAL-FLAG
 13568*        MOVE ER-2718        TO WS-ERROR
 13569*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13570*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13571
 13572     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13573        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13574
 13575     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13576        and (not pb-monthly-cert)
 13577        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13578     end-if
 13579
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 246
* EL050.cbl
 13580     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13581        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13582
 13583     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13584         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13585         MOVE ER-2639        TO WS-ERROR
 13586         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13587
 13588
 13589******************************************************************
 13590*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13591******************************************************************
 13592
 13593 PREMIUM-EDITING-IS-BYPASSED.
 13594     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13595        AND (CP-R-MAX-ATT-AGE > +0)
 13596        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13597        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13598           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13599           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13600           MOVE '1'              TO DC-OPTION-CODE
 13601           PERFORM 8500-DATE-CONVERT
 13602                                 THRU 8500-EXIT
 13603           IF NO-CONVERSION-ERROR
 13604              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13605                 MOVE ER-2661       TO WS-ERROR
 13606*                PERFORM 9900-ERROR-FORMAT
 13607*                                THRU 9900-EXIT
 13608              END-IF
 13609           END-IF
 13610        ELSE
 13611           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13612           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13613              MOVE ER-2661       TO WS-ERROR
 13614*             PERFORM 9900-ERROR-FORMAT
 13615*                                THRU 9900-EXIT
 13616           ELSE
 13617              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13618                 MOVE ER-1570    TO WS-ERROR
 13619                 PERFORM 9900-ERROR-FORMAT
 13620                                 THRU 9900-EXIT
 13621              END-IF
 13622           END-IF
 13623        END-IF
 13624        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13625           MOVE PB-I-JOINT-BIRTHDAY
 13626                                 TO DC-BIN-DATE-1
 13627           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13628           MOVE '1'              TO DC-OPTION-CODE
 13629           PERFORM 8500-DATE-CONVERT
 13630                                 THRU 8500-EXIT
 13631           IF NO-CONVERSION-ERROR
 13632              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13633                 MOVE ER-2661       TO WS-ERROR
 13634*                PERFORM 9900-ERROR-FORMAT
 13635*                                THRU 9900-EXIT
 13636              END-IF
 13637           ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 247
* EL050.cbl
 13638              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13639           END-IF
 13640        ELSE
 13641           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13642             (PB-I-LF-TERM / 12)
 13643           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13644              MOVE ER-2661       TO WS-ERROR
 13645*             PERFORM 9900-ERROR-FORMAT
 13646*                                THRU 9900-EXIT
 13647           ELSE
 13648              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13649                 MOVE ER-1571    TO WS-ERROR
 13650                 PERFORM 9900-ERROR-FORMAT
 13651                                 THRU 9900-EXIT
 13652              END-IF
 13653           END-IF
 13654        END-IF
 13655        IF WS-ERROR = ER-2661
 13656           PERFORM 9900-ERROR-FORMAT
 13657                                 THRU 9900-EXIT
 13658        END-IF
 13659     END-IF
 13660*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13661*       MOVE ER-2661             TO WS-ERROR
 13662*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13663
 13664     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13665        MOVE ER-2662             TO WS-ERROR
 13666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13667
 13668     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13669        MOVE ER-2677             TO WS-ERROR
 13670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13671
 13672     IF CP-ERROR-LOAN-TERM
 13673        MOVE ER-2648             TO WS-ERROR
 13674        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13675
 13676 3221-CHECK-ERROR-RATE-OPEN.
 13677
 13678     IF CP-ERROR-RATE-FILE-NOTOPEN
 13679         GO TO 3990-FILES-NOT-OPEN.
 13680
 13681     IF PB-COMPANY-ID NOT = 'DMD'
 13682        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13683     END-IF
 13684     .
 13685 3221-CONTINUE.
 13686     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13687                                    WS-DCC-AH-RATE
 13688     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13689        IF WS-LF-BEN-CATEGORY = 'D'
 13690           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13691              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13692        END-IF
 13693     END-IF
 13694     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13695*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 248
* EL050.cbl
 13696     IF (PB-COMPANY-ID = 'CID')
 13697        AND (WS-LF-EARNINGS-CALC = 'B')
 13698        AND (CP-STATE-STD-ABBRV = 'MN')
 13699        AND (PB-CERT-EFF-DT > X'A4FF')
 13700        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13701     END-IF
 13702     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 13703
 13704     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13705     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13706        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13707        AND (PB-I-POLICY-IS-MONTHLY)
 13708        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13709        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13710     END-IF
 13711     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13712     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13713     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13714     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13715     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13716        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13717        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13718        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13719        MOVE ER-2786             TO WS-ERROR
 13720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13721     END-IF
 13722
 13723     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13724
 13725******************************************************************
 13726*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13727******************************************************************
 13728     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13729        and ((not pb-monthly-cert)
 13730        or (ws-lf-ben-category = 'C'))
 13731        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13732
 13733     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13734        GO TO 3225-CHECK-ALT-LIFE-RATE
 13735     ELSE
 13736       IF PB-I-LF-RATE = ZERO
 13737          MOVE ER-2641          TO WS-ERROR
 13738          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13739
 13740 3225-CHECK-ALT-LIFE-RATE.
 13741
 13742     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13743        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13744        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13745         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13746
 13747     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13748         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13749             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 13750                   OR
 13751              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13752              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13753              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 249
* EL050.cbl
 13754             MOVE ER-2720        TO  WS-ERROR
 13755             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13756             GO TO 3225-RATING-CONT
 13757         ELSE
 13758             GO TO 3225-RATING-CONT.
 13759     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13760        AND (AM-GPCD = 01 OR 06 OR 15)
 13761        MOVE ER-2798             TO WS-ERROR
 13762        PERFORM 9900-ERROR-FORMAT
 13763                                 THRU 9900-EXIT
 13764*       GO TO 3225-RATING-CONT
 13765     END-IF
 13766     if (pb-company-id = 'CID')
 13767        and (ws-lf-earnings-calc = 'B')
 13768        and (ws-lf-ben-category = 'P' or 'I')
 13769        and (ws-net-only-state = 'Y')
 13770        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13771        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13772        go to 3225-rating-cont
 13773     end-if
 13774     IF (PB-COMPANY-ID = 'CID')
 13775        AND (WS-LF-EARNINGS-CALC = 'B')
 13776        AND (CP-STATE-STD-ABBRV = 'MN')
 13777        AND (PB-CERT-EFF-DT > X'A4FF')
 13778        GO TO 3225-RATING-CONT
 13779     END-IF
 13780     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13781        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13782           AND (PB-I-POLICY-IS-MONTHLY)
 13783           GO TO 3225-RATING-CONT
 13784        END-IF
 13785     END-IF
 13786
 13787     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13788        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13789        CP-EARN-AS-REG-BALLOON
 13790        NEXT SENTENCE
 13791     ELSE
 13792        MOVE '2'                 TO CP-EARNING-METHOD.
 13793
 13794 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13795
 13796     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13797
 13798     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13799        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13800        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13801         NEXT SENTENCE
 13802     ELSE
 13803         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13804
 13805     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13806     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13807     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13808                                     CP-RATING-BENEFIT-AMT.
 13809     IF CP-STATE-STD-ABBRV = 'OR'
 13810         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13811                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 250
* EL050.cbl
 13812     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13813        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13814     END-IF
 13815     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13816     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13817     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13818                                    CP-REMAINING-TERM
 13819                                    CP-LOAN-TERM.
 13820     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13821        ADD +1                   TO CP-ORIGINAL-TERM
 13822                                    CP-REMAINING-TERM
 13823                                    CP-LOAN-TERM.
 13824
 13825     MOVE 'R'                   TO CP-RATE-FILE.
 13826     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13827
 13828     IF CP-ERROR-RATE-NOT-FOUND
 13829         MOVE ER-2641            TO WS-ERROR
 13830         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13831         GO TO 3300-CHECK-AH-RATES.
 13832
 13833     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13834     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13835
 13836     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13837         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13838
 13839     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13840                               + PB-I-LF-ALT-BENEFIT-AMT.
 13841
 13842     IF ACCOUNT-LIFE-CHECKED  OR
 13843        PB-POLICY-IS-VOIDED   OR
 13844        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13845        and (not pb-monthly-cert))
 13846        GO TO 3225-CONTINUE.
 13847
 13848     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13849        GO TO 3225-CONTINUE.
 13850
 13851     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13852                             EC-RT-LF-MAX-TOT-BEN
 13853        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13854        MOVE ER-2639       TO WS-ERROR
 13855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13856
 13857 3225-CONTINUE.
 13858     IF PB-I-LF-ALT-RATE = ZERO
 13859         MOVE ER-2659            TO WS-ERROR
 13860         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13861
 13862     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13863        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13864        MOVE ER-2698             TO WS-ERROR
 13865        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13866
 13867 3225-RATING-CONT.
 13868
 13869     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 251
* EL050.cbl
 13870        and (not pb-monthly-cert)
 13871         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13872         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13873         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13874            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13875            CONTINUE
 13876         ELSE
 13877            MOVE ER-2687         TO WS-ERROR
 13878            PERFORM 9900-ERROR-FORMAT
 13879                                 THRU 9900-EXIT
 13880         END-IF
 13881         GO TO 3290-EDIT-LF-REIN-RATE
 13882     END-IF
 13883
 13884* DMD RATING TEST
 13885     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13886         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13887         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13888         MOVE ER-2687                 TO WS-ERROR
 13889         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13890         GO TO 3290-EDIT-LF-REIN-RATE.
 13891
 13892 3230-CLIENT-MORT-CD-SPECIALS.
 13893
 13894     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13895     SET BIN-TO-GREG          TO TRUE.
 13896*    MOVE ' '                 TO DC-OPTION-CODE.
 13897     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13898     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13899
 13900 C-POS-3230-MORT-CD.
 13901     IF PB-COMPANY-ID = 'POS' AND
 13902        PB-SV-CARRIER = '2'
 13903         NEXT SENTENCE
 13904     ELSE
 13905         GO TO C-POS-3240-MORT-CD.
 13906
 13907     IF PB-SV-GROUPING = '030'
 13908        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13909         MOVE '2350' TO PB-I-MORT-CODE
 13910      ELSE
 13911         MOVE '3300' TO PB-I-MORT-CODE.
 13912
 13913
 13914 C-POS-3240-MORT-CD.
 13915     IF PB-COMPANY-ID = 'POS' AND
 13916        PB-SV-CARRIER = '1'
 13917         NEXT SENTENCE
 13918     ELSE
 13919         GO TO 3230-CONTINUE.
 13920
 13921     IF PB-SV-STATE = '45' OR '47'
 13922        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13923         MOVE '5200' TO PB-I-MORT-CODE
 13924     ELSE
 13925         MOVE '8300' TO PB-I-MORT-CODE.
 13926
 13927 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 252
* EL050.cbl
 13928
 13929     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13930        GO TO 3240-CONTINUE
 13931     END-IF
 13932
 13933     IF PB-CERT-EFF-DT > WS-971231
 13934        GO TO 3240-CONTINUE
 13935     END-IF
 13936
 13937     IF LF-BENEFIT-FOUND AND
 13938        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13939         MOVE 'F250'       TO PB-I-MORT-CODE
 13940     ELSE
 13941         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13942             MOVE '7250'   TO PB-I-MORT-CODE
 13943         ELSE
 13944             MOVE '4251'   TO PB-I-MORT-CODE
 13945         END-IF
 13946     END-IF
 13947
 13948     .
 13949 3240-CONTINUE.
 13950
 13951     IF PB-COMPANY-ID NOT = 'GNL'
 13952         GO TO 3256-CONTINUE.
 13953
 13954     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13955         MOVE 'A300' TO PB-I-MORT-CODE
 13956     ELSE
 13957         MOVE '8350' TO PB-I-MORT-CODE.
 13958
 13959 3256-CONTINUE.
 13960     IF PB-COMPANY-ID NOT = 'ABL'
 13961         GO TO 3260-EDIT-CONTINUE.
 13962
 13963     IF PB-I-LF-TERM GREATER THAN 59
 13964         MOVE 'F550' TO PB-I-MORT-CODE
 13965     ELSE
 13966         MOVE 'E550' TO PB-I-MORT-CODE.
 13967
 13968 3260-EDIT-CONTINUE.
 13969     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13970
 13971 3290-EDIT-LF-REIN-RATE.
 13972     IF LF-REIN-NSP-NOT-USED
 13973         GO TO 3290-RATING-CONT.
 13974
 13975     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13976        GO TO 3290-RATING-CONT.
 13977     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13978     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13979     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13980     MOVE '3'                   TO CP-PROCESS-TYPE.
 13981     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13982
 13983******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13984     IF PB-COMPANY-ID EQUAL 'CDL'
 13985         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 253
* EL050.cbl
 13986            CP-EARN-AS-NET-PAY)
 13987             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13988*            MOVE SPACE          TO DC-OPTION-CODE
 13989             SET BIN-TO-GREG     TO TRUE
 13990             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13991***  Y2K PROJ 7744
 13992             IF DC-GREG-DATE-CYMD GREATER 19931231
 13993                 MOVE '1'        TO CP-EARNING-METHOD.
 13994***  Y2K PROJ 7744
 13995*******
 13996
 13997     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13998     MOVE PB-SV-STATE           TO CP-STATE.
 13999     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14000     MOVE ZERO                  TO CP-DEVIATION-CODE
 14001                                   CP-RATE-DEV-PCT.
 14002     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14003     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14004                                   CP-RATING-BENEFIT-AMT.
 14005
 14006************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14007     IF PB-COMPANY-ID EQUAL 'NCB'
 14008         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14009            CP-EARN-AS-NET-PAY
 14010             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14011                 PB-I-LF-PREMIUM-AMT.
 14012************
 14013
 14014     IF CP-STATE-STD-ABBRV = 'OR'
 14015         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14016                                         PB-I-LF-ALT-BENEFIT-AMT.
 14017     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14018     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14019     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14020     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14021     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14022     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14023     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14024     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14025                                   CP-REMAINING-TERM
 14026                                   CP-LOAN-TERM.
 14027     IF CP-TRUNCATED-LIFE
 14028        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14029
 14030     IF CP-TERM-IS-DAYS
 14031         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14032     ELSE
 14033         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14034
 14035     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14036        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14037     END-IF
 14038     IF PB-COMPANY-ID NOT = 'TIC'
 14039          MOVE ZERO          TO CP-CLASS-CODE.
 14040
 14041     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14042
 14043     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 254
* EL050.cbl
 14044     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14045
 14046     IF CP-ERROR-RATE-NOT-FOUND
 14047        IF PB-I-OB
 14048           MOVE ER-2625      TO WS-ERROR
 14049           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14050           GO TO 3299-EDIT-CONTINUE
 14051        ELSE
 14052           MOVE ER-2643      TO WS-ERROR
 14053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14054           GO TO 3299-EDIT-CONTINUE.
 14055
 14056     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14057
 14058     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14059     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14060
 14061     IF PB-I-LF-REI-RATE = ZERO
 14062         MOVE ER-2643        TO WS-ERROR
 14063         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14064
 14065 3290-CHECK-ALT-REIN-RATE.
 14066
 14067     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14068        GO TO 3290-RATING-CONT.
 14069
 14070     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14071     MOVE '2'                    TO CP-EARNING-METHOD.
 14072     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14073     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14074     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14075     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14076                                     CP-RATING-BENEFIT-AMT.
 14077     IF CP-STATE-STD-ABBRV = 'OR'
 14078         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14079                                         PB-I-LF-ALT-BENEFIT-AMT.
 14080     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14081        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14082     END-IF
 14083     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14084     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14085     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14086                                    CP-REMAINING-TERM
 14087                                    CP-LOAN-TERM.
 14088     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14089        ADD +1                   TO CP-ORIGINAL-TERM
 14090                                    CP-REMAINING-TERM
 14091                                    CP-LOAN-TERM.
 14092
 14093     MOVE 'R'                   TO CP-RATE-FILE.
 14094     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14095
 14096     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14097
 14098     IF PB-I-LF-ALT-REI-RATE = ZERO
 14099         MOVE ER-2643            TO WS-ERROR
 14100         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14101
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 255
* EL050.cbl
 14102 3290-RATING-CONT.
 14103
 14104     IF PB-I-OB
 14105*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14106        GO TO 3300-CHECK-AH-RATES.
 14107
 14108 3299-EDIT-CONTINUE.
 14109
 14110     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14111         NEXT SENTENCE
 14112     ELSE
 14113         MOVE ER-2620           TO WS-ERROR
 14114         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14115
 14116 3300-CHECK-AH-RATES.
 14117     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14118         NEXT SENTENCE
 14119     ELSE
 14120         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14121
 14122     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14123        and (not pb-monthly-cert))
 14124                  or
 14125        ((CF-COMPANY-ID = 'DMD') AND
 14126                (NO-DMD-RATING))
 14127         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14128            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14129            CONTINUE
 14130         ELSE
 14131            MOVE ER-2687         TO WS-ERROR
 14132            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14133         END-IF
 14134         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14135         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14136     END-IF
 14137
 14138     IF PB-I-OB
 14139        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14140
 14141     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14142         MOVE ER-2687             TO WS-ERROR
 14143         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14144         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14145         GO TO 3999-END-EDIT.
 14146
 14147*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14148     if pb-company-id = 'AHL'
 14149        go to 3300-skip-crit-per
 14150     end-if
 14151     if (pb-i-ah-crit-per not = zeros)
 14152        and (ws-ah-special-calc-cd not = 'C')
 14153        MOVE ER-1572             TO WS-ERROR
 14154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14155        go to 3300-skip-crit-per
 14156     END-IF
 14157     if (pb-company-id = 'DCC' or 'VPP')
 14158        and (am-dcc-product-code not = spaces)
 14159        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 256
* EL050.cbl
 14160     end-if
 14161     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14162        IF PB-I-AH-CRIT-PER = ZERO
 14163           move ws-ah-max-bens   to pb-i-ah-crit-per
 14164*          MOVE ER-2618       TO WS-ERROR
 14165*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14166*          GO TO 3999-END-EDIT
 14167        END-IF
 14168     END-IF
 14169     if (ws-ah-special-calc-cd = 'C')
 14170        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14171        MOVE ER-1576             TO WS-ERROR
 14172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14173     end-if
 14174
 14175     .
 14176 3300-skip-crit-per.
 14177     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14178     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14179     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14180     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14181     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14182     MOVE PB-SV-STATE            TO CP-STATE.
 14183     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14184     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14185     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14186*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14187     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14188     MOVE '3'                    TO CP-PROCESS-TYPE.
 14189     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14190     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14191                                    CP-RATING-BENEFIT-AMT.
 14192     IF PB-COMPANY-ID = 'CID'
 14193               OR
 14194        CP-STATE-STD-ABBRV = 'OR'
 14195         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14196                                         PB-I-AH-TERM.
 14197     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14198        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14199           AND (PB-I-POLICY-IS-MONTHLY)
 14200           MOVE PB-I-LF-BENEFIT-AMT
 14201                                 TO CP-NET-BENEFIT-AMT
 14202           move pb-i-ah-premium-amt to cp-original-premium
 14203           add pb-i-lf-premium-amt to cp-original-premium
 14204        END-IF
 14205     END-IF
 14206     MOVE SPACES                 TO CP-BEN-CATEGORY
 14207     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14208        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14209        EVALUATE TRUE
 14210           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14211              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14212              MOVE PB-I-LF-BENEFIT-AMT
 14213                                 TO CP-RATING-BENEFIT-AMT
 14214              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14215           WHEN WS-AH-BEN-CATEGORY = 'G'
 14216              MOVE PB-I-UNPAID-CASH-PRICE
 14217                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 257
* EL050.cbl
 14218           WHEN WS-AH-BEN-CATEGORY = 'D'
 14219              MOVE WS-AH-PMF-COMM
 14220                                 TO CP-DCC-PMF-COMM
 14221              MOVE PB-I-AH-COMMISSION
 14222                                 TO CP-DCC-ACT-COMM
 14223        END-EVALUATE
 14224     END-IF
 14225     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14226     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14227     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14228     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14229     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14230     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14231     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14232                                    CP-REMAINING-TERM
 14233                                    WS-WORK-TERM.
 14234     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14235
 14236     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14237     SET BIN-TO-GREG             TO TRUE.
 14238*    MOVE ' '                    TO DC-OPTION-CODE.
 14239     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14240     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14241
 14242     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14243     IF NOT VALID-SKIP-CODE
 14244         MOVE ER-2683            TO WS-ERROR
 14245         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14246         GO TO 3320-RATE-CONTINUE.
 14247
 14248     IF PB-NO-MONTHS-SKIPPED
 14249         GO TO 3320-RATE-CONTINUE.
 14250
 14251     MOVE SPACE TO NUMBER-OF-MONTHS.
 14252
 14253     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14254         MOVE 'S'                TO SK-MO (6).
 14255     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14256         MOVE 'S'                TO SK-MO (7).
 14257     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14258         MOVE 'S'                TO SK-MO (8).
 14259     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14260         MOVE 'S'                TO SK-MO (9).
 14261     IF PB-I-SKIP-CODE = 'A'
 14262         MOVE 'S'                TO SK-MO (10).
 14263
 14264     MOVE 1                      TO SUB2.
 14265     MOVE PB-I-AH-TERM           TO SUB3.
 14266     MOVE WS-MONTH               TO SUB1.
 14267     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14268     GO TO 3320-RATE-CONTINUE.
 14269
 14270 3310-GET-SKIP-MO.
 14271     IF SUB1 = 13
 14272         MOVE 1                  TO SUB1.
 14273
 14274     IF SK-MO (SUB1) = 'S'
 14275         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 258
* EL050.cbl
 14276
 14277     ADD 1 TO SUB2
 14278              SUB1.
 14279
 14280 3320-RATE-CONTINUE.
 14281
 14282     IF WS-WORK-TERM = ZERO
 14283         MOVE 1                  TO WS-WORK-TERM.
 14284
 14285     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14286                                    CP-LOAN-TERM.
 14287
 14288     IF PB-COMPANY-ID EQUAL 'DMD'
 14289         NEXT SENTENCE
 14290     ELSE
 14291         MOVE ZERO               TO PB-I-AH-RATE
 14292                                    PB-I-AH-REI-RATE.
 14293
 14294
 14295     IF PB-COMPANY-ID EQUAL 'CRI'
 14296        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14297
 14298     IF PB-COMPANY-ID = 'CSL'
 14299         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14300         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14301         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14302         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14303
 14304     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14305        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14306           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14307              PB-I-RATE-DEV-PCT-LF
 14308        END-IF
 14309        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14310                                 TO CP-ALTERNATE-BENEFIT
 14311        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14312        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14313        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14314     END-IF
 14315*    if ws-clp-state not = spaces
 14316*       move ws-clp-state to cp-state
 14317*    end-if
 14318     IF (PB-COMPANY-ID = 'CID')
 14319        AND (WS-LF-EARNINGS-CALC = 'B')
 14320        AND (CP-STATE-STD-ABBRV = 'MN')
 14321        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14322     ELSE
 14323        MOVE ' '                 TO CP-AH-BALLOON-SW
 14324     END-IF
 14325     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14326     MOVE 'R'                   TO CP-RATE-FILE.
 14327     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14328
 14329     IF (CP-ERROR-RATE-NOT-FOUND)
 14330        and (not pb-monthly-cert)
 14331        IF PB-I-OB
 14332           MOVE ER-2624          TO WS-ERROR
 14333           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 259
* EL050.cbl
 14334           GO TO 3340-CALCULATE-PREMIUM-AMT
 14335        ELSE
 14336          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14337              NEXT SENTENCE
 14338          ELSE
 14339           MOVE ER-2642          TO WS-ERROR
 14340           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14341           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14342
 14343     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14344        CP-ERROR-DIV-BY-ZERO
 14345           MOVE ER-3782          TO WS-ERROR
 14346           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14347
 14348     IF PB-COMPANY-ID EQUAL 'CRI'
 14349        IF CP-ERROR-NO-LIMITS-CRI
 14350           IF NOT ACCOUNT-AH-CHECKED
 14351              MOVE ER-2607          TO WS-ERROR
 14352              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14353
 14354     IF ACCOUNT-AH-CHECKED
 14355        NEXT SENTENCE
 14356     ELSE
 14357       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14358          MOVE ER-2640           TO WS-ERROR
 14359          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14360
 14361     IF PB-COMPANY-ID = 'CRI'
 14362         IF WS-ERROR = ER-2640
 14363             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14364     IF ACCOUNT-AH-CHECKED
 14365        CONTINUE
 14366     ELSE
 14367        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14368           AND (CP-R-MAX-ATT-AGE > +0)
 14369           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14370           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14371              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14372              MOVE PB-I-AH-EXPIRE-DT
 14373                                 TO DC-BIN-DATE-2
 14374              MOVE '1'           TO DC-OPTION-CODE
 14375              PERFORM 8500-DATE-CONVERT
 14376                                 THRU 8500-EXIT
 14377              IF NO-CONVERSION-ERROR
 14378                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14379                    MOVE ER-2661       TO WS-ERROR
 14380*                   PERFORM 9900-ERROR-FORMAT
 14381*                                THRU 9900-EXIT
 14382                 END-IF
 14383              END-IF
 14384           ELSE
 14385              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14386              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14387                 MOVE ER-2661    TO WS-ERROR
 14388*                PERFORM 9900-ERROR-FORMAT
 14389*                                THRU 9900-EXIT
 14390              ELSE
 14391                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 260
* EL050.cbl
 14392                    MOVE ER-1570 TO WS-ERROR
 14393                    PERFORM 9900-ERROR-FORMAT
 14394                                 THRU 9900-EXIT
 14395                 END-IF
 14396              END-IF
 14397           END-IF
 14398           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14399              MOVE PB-I-JOINT-BIRTHDAY
 14400                                    TO DC-BIN-DATE-1
 14401              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14402              MOVE '1'              TO DC-OPTION-CODE
 14403              PERFORM 8500-DATE-CONVERT
 14404                                    THRU 8500-EXIT
 14405              IF NO-CONVERSION-ERROR
 14406                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14407                    MOVE ER-2661       TO WS-ERROR
 14408*                   PERFORM 9900-ERROR-FORMAT
 14409*                                   THRU 9900-EXIT
 14410                 END-IF
 14411              END-IF
 14412           ELSE
 14413              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14414                (PB-I-AH-TERM / 12)
 14415              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14416                 MOVE ER-2661       TO WS-ERROR
 14417*                PERFORM 9900-ERROR-FORMAT
 14418*                                   THRU 9900-EXIT
 14419              ELSE
 14420                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14421                    MOVE ER-1571 TO WS-ERROR
 14422                    PERFORM 9900-ERROR-FORMAT
 14423                                 THRU 9900-EXIT
 14424                 END-IF
 14425              END-IF
 14426           END-IF
 14427           IF WS-ERROR = ER-2661
 14428              PERFORM 9900-ERROR-FORMAT
 14429                                    THRU 9900-EXIT
 14430           END-IF
 14431        END-IF
 14432     END-IF
 14433*    IF ACCOUNT-AH-CHECKED
 14434*       NEXT SENTENCE
 14435*    ELSE
 14436*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14437*          MOVE ER-2661          TO WS-ERROR
 14438*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14439
 14440     IF ACCOUNT-AH-CHECKED
 14441        NEXT SENTENCE
 14442     ELSE
 14443        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14444           MOVE ER-2663          TO WS-ERROR
 14445           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14446
 14447     IF ACCOUNT-AH-CHECKED OR
 14448        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14449         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 261
* EL050.cbl
 14450        NEXT SENTENCE
 14451     ELSE
 14452        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14453           MOVE ER-2667            TO WS-ERROR
 14454           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14455
 14456     IF PB-COMPANY-ID = 'CRI'
 14457         IF WS-ERROR = ER-2667
 14458             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14459
 14460     IF ACCOUNT-AH-CHECKED
 14461        NEXT SENTENCE
 14462     ELSE
 14463        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14464           MOVE ER-2678            TO WS-ERROR
 14465           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14466
 14467     IF CP-ERROR-RATE-FILE-NOTOPEN
 14468         GO TO 3990-FILES-NOT-OPEN.
 14469
 14470 3321-CONTINUE.
 14471     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14472     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14473     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14474*    IF (PB-COMPANY-ID = 'DCC')
 14475        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14476        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14477                                    PB-I-LF-ALT-PREM-CALC
 14478        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14479        IF WS-AH-BEN-CATEGORY = 'G'
 14480           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14481           + PB-I-ADDL-CLP)
 14482           * (1 + WS-TOL-CLP-PCT)
 14483*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14484        ELSE
 14485           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14486           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14487*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14488        END-IF
 14489        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14490                                 TO PB-I-AH-PREM-CALC
 14491        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14492           MOVE ER-8152          TO WS-ERROR
 14493           PERFORM 9900-ERROR-FORMAT
 14494                                 THRU 9900-EXIT
 14495        ELSE
 14496           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14497                 PB-I-ADDL-CLP)
 14498              MOVE ER-8148       TO WS-ERROR
 14499              PERFORM 9900-ERROR-FORMAT
 14500                                 THRU 9900-EXIT
 14501           END-IF
 14502        END-IF
 14503     END-IF
 14504     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14505        AND (PB-I-POLICY-IS-MONTHLY)
 14506        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14507        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 262
* EL050.cbl
 14508        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14509           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14510        END-IF
 14511     END-IF
 14512     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14513        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14514        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14515        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14516        MOVE ER-2786             TO WS-ERROR
 14517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14518     END-IF
 14519     MOVE +0                     TO PB-I-AH-CLP
 14520     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14521        evaluate true
 14522           when WS-AH-BEN-CATEGORY = 'D'
 14523              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14524                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14525           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14526              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14527           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14528              compute ws-cred-union-fees rounded =
 14529                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14530                    pb-i-ah-commission)
 14531              COMPUTE PB-I-AH-CLP =
 14532                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14533        end-evaluate
 14534     END-IF
 14535     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14536
 14537     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14538         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14539
 14540     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14541         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14542
 14543     if (ws-ah-special-calc-cd = 'E')
 14544        and (pb-monthly-cert)
 14545        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14546     end-if
 14547     IF PB-COMPANY-ID = 'CRI'
 14548         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14549            PB-I-PAYMENT-AMOUNT = ZERO
 14550             NEXT SENTENCE
 14551         ELSE
 14552             COMPUTE PB-I-AH-PREM-CALC =
 14553                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14554                 (CP-PREMIUM-RATE / 100)
 14555             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14556                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14557                                             PB-I-RATE-DEV-PCT-AH.
 14558
 14559     IF (PB-I-AH-RATE  = ZERO)
 14560        and (not pb-monthly-cert)
 14561       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14562           NEXT SENTENCE
 14563       ELSE
 14564         MOVE ER-2642            TO WS-ERROR
 14565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 263
* EL050.cbl
 14566
 14567     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14568     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14569     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14570     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14571     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14572     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14573
 14574     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14575        AND (WS-AH-BEN-CATEGORY = 'G')
 14576        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14577        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14578        IF CP-DEVIATION-CODE NOT = '000'
 14579           MOVE '000'            TO CP-DEVIATION-CODE
 14580           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14581           IF NO-CP-ERROR
 14582              COMPUTE PB-I-DDF-IU-RATE-UP =
 14583              PB-I-AH-CLP - CP-CALC-PREMIUM
 14584           ELSE
 14585              MOVE ER-3057        TO WS-ERROR
 14586              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14587           END-IF
 14588        END-IF
 14589     END-IF
 14590     .
 14591 3335-EDIT-AH-REIN-NSP-RATE.
 14592     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14593        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14594              compute ws-cred-union-fees rounded =
 14595                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14596                    pb-i-ah-commission)
 14597              COMPUTE PB-I-AH-CLP =
 14598                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14599        end-if
 14600     END-IF
 14601     IF AH-REIN-NSP-NOT-USED
 14602         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14603
 14604     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14605     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14606         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14607     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14608     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14609     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14610     MOVE PB-SV-STATE            TO CP-STATE.
 14611     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14612     MOVE ZERO                   TO CP-DEVIATION-CODE
 14613                                    CP-RATE-DEV-PCT.
 14614*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14615     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14616     MOVE '3'                    TO CP-PROCESS-TYPE.
 14617     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14618     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14619                                    CP-RATING-BENEFIT-AMT.
 14620     IF CP-STATE-STD-ABBRV = 'OR'
 14621         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14622                                         PB-I-AH-TERM.
 14623     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 264
* EL050.cbl
 14624     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14625     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14626     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14627     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14628     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14629                                    CP-REMAINING-TERM
 14630                                    WS-WORK-TERM.
 14631     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14632     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14633        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14634     END-IF
 14635     IF  PB-COMPANY-ID = 'TIC'
 14636         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14637            MOVE ZERO TO CP-CLASS-CODE.
 14638
 14639     IF PB-COMPANY-ID NOT = 'TIC'
 14640          MOVE ZERO          TO CP-CLASS-CODE.
 14641
 14642     MOVE ZERO               TO CP-DEVIATION-CODE.
 14643
 14644     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14645
 14646     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14647
 14648     MOVE 'R'                   TO CP-RATE-FILE.
 14649     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14650
 14651     IF CP-ERROR-RATE-NOT-FOUND
 14652         MOVE ER-2645        TO WS-ERROR
 14653         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14654         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14655
 14656     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14657
 14658     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14659     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14660
 14661     IF PB-I-AH-REI-RATE = ZERO
 14662         MOVE ER-2645        TO WS-ERROR
 14663         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14664
 14665
 14666 3340-CALCULATE-PREMIUM-AMT.
 14667
 14668     IF PB-COMPANY-ID = 'NCL'
 14669         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14670             WS-AH-SPECIAL-CALC-CD = 'O')
 14671             GO TO 3999-END-EDIT.
 14672
 14673     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14674                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14675                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 14676                         OR 'AHL'
 14677         NEXT SENTENCE
 14678     ELSE
 14679         IF WS-STATE-ABBREVIATION = 'CT'
 14680             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14681                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 265
* EL050.cbl
 14682                 COMPUTE PB-I-LF-PREM-CALC =
 14683                                     PB-I-LF-PREM-CALC * .90
 14684                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14685                                     PB-I-LF-ALT-PREM-CALC * .90
 14686                 COMPUTE PB-I-AH-PREM-CALC =
 14687                                     PB-I-AH-PREM-CALC * .90.
 14688
 14689     IF PB-COMP-LF-PREM
 14690        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14691        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14692
 14693     IF PB-COMP-AH-PREM
 14694        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14695
 14696 3340-CHECK-DCC-TOT-FEES.
 14697     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14698        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14699        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14700        AND (PB-I-POLICY-IS-MONTHLY)
 14701        CONTINUE
 14702     ELSE
 14703        GO TO 3340-EDIT-LF-AH-TOL
 14704     END-IF
 14705     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14706     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14707     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14708        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14709           PB-I-RATE-DEV-PCT-LF
 14710     END-IF
 14711     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14712        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14713           PB-I-RATE-DEV-PCT-AH
 14714     END-IF
 14715     MOVE 'N'                    TO CP-BEN-CATEGORY
 14716     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14717
 14718     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14719     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14720     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14721     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14722     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14723     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14724     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14725     MOVE '3'                    TO CP-PROCESS-TYPE.
 14726     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14727     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14728
 14729     MOVE PB-SV-STATE            TO CP-STATE.
 14730     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14731     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14732     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14733     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14734     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14735                                    CP-RATING-BENEFIT-AMT.
 14736     IF CP-STATE-STD-ABBRV = 'OR'
 14737         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14738                                         PB-I-LF-ALT-BENEFIT-AMT.
 14739     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 266
* EL050.cbl
 14740     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14741     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14742     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14743     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14744     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14745     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14746     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14747     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14748                                    CP-REMAINING-TERM
 14749                                    CP-LOAN-TERM.
 14750     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14751        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14752           PB-I-LF-PREMIUM-AMT
 14753     end-if
 14754
 14755     IF CP-TRUNCATED-LIFE
 14756        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14757
 14758     IF CP-TERM-IS-DAYS
 14759         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14760     ELSE
 14761         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14762
 14763     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14764     IF CP-SPECIAL-CALC-CD = 'H'
 14765         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14766                                    TO CP-ALTERNATE-BENEFIT
 14767         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14768     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14769     MOVE 'R'                    TO CP-RATE-FILE
 14770     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14771     IF NOT CP-ERROR-RATE-NOT-FOUND
 14772        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14773        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14774           AND (CP-BENEFIT-CD (1:1) = 'S')
 14775           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14776                                    PB-I-LF-PREMIUM-AMT
 14777        END-IF
 14778     ELSE
 14779        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14780     END-IF
 14781     .
 14782 3340-EDIT-LF-AH-TOL.
 14783
 14784***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14785***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14786***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14787***
 14788     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14789         PB-I-AH-PREMIUM-AMT
 14790          GIVING WS-CALC-WORK.
 14791
 14792     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14793        AND WS-CALC-WORK NOT = ZERO
 14794         MOVE ER-2649            TO WS-ERROR
 14795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14796
 14797     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 267
* EL050.cbl
 14798             FROM PB-I-LF-PREMIUM-AMT
 14799                 GIVING WS-UNSIGN-WRK1.
 14800
 14801     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14802             FROM PB-I-LF-ALT-PREMIUM-AMT
 14803                 GIVING WS-UNSIGN-WRK4.
 14804
 14805     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14806                                + WS-UNSIGN-WRK4.
 14807
 14808     SUBTRACT PB-I-AH-PREM-CALC
 14809             FROM PB-I-AH-PREMIUM-AMT
 14810                 GIVING WS-UNSIGN-WRK2.
 14811
 14812******************************************************************
 14813*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14814******************************************************************
 14815
 14816     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14817         MOVE ZERO TO WS-UNSIGN-WRK1.
 14818
 14819     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14820         MOVE ZERO TO WS-UNSIGN-WRK2.
 14821
 14822     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14823             GIVING WS-UNSIGN-WRK3.
 14824
 14825 3342-CONTINUE.
 14826
 14827     IF (PB-I-LF-RATE = ZERO  AND
 14828         PB-I-AH-RATE = ZERO)
 14829         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14830            WS-AH-SPECIAL-CALC-CD = 'O'
 14831              NEXT SENTENCE
 14832         ELSE
 14833             GO TO 3345-EDIT-CONTINUE.
 14834
 14835     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14836         NEXT SENTENCE
 14837     ELSE
 14838     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14839        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14840           IF (PB-REISSUED-CERT         OR
 14841               PB-POLICY-IS-DECLINED    OR
 14842               PB-POLICY-IS-VOIDED)
 14843              NEXT SENTENCE
 14844           ELSE
 14845              IF WS-PREM-REJECT-SW = SPACE
 14846                 MOVE ER-2652    TO WS-ERROR
 14847                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14848                 GO TO 3344-CHECK-AH
 14849              ELSE
 14850                 MOVE ER-2650    TO WS-ERROR
 14851                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14852                 GO TO 3344-CHECK-AH.
 14853
 14854***
 14855***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 268
* EL050.cbl
 14856***
 14857
 14858     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14859         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14860            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14861             (1 + WS-TOL-LF-PREM-PCT)
 14862         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14863            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14864             (1 - WS-TOL-LF-PREM-PCT)
 14865     ELSE
 14866         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14867         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14868
 14869***
 14870***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14871***
 14872
 14873     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14874         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14875          WS-TOL-LF-PREM.
 14876
 14877     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14878         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14879          WS-TOL-LF-PREM.
 14880
 14881     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14882        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14883
 14884     IF PB-REISSUED-CERT
 14885        or PB-POLICY-IS-DECLINED
 14886        or PB-POLICY-IS-VOIDED
 14887        continue
 14888     ELSE
 14889        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14890              > WS-TOL-LF-HIGH-PREM-AMT)
 14891           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14892              < WS-TOL-LF-LOW-PREM-AMT))
 14893                      or
 14894           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14895              > WS-TOL-LF-HIGH-PREM-PCT)
 14896           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14897              < WS-TOL-LF-LOW-PREM-PCT))
 14898           IF WS-PREM-REJECT-SW = SPACE
 14899              MOVE ER-2652       TO WS-ERROR
 14900              PERFORM 9900-ERROR-FORMAT
 14901                                 THRU 9900-EXIT
 14902           ELSE
 14903              MOVE ER-2650       TO WS-ERROR
 14904              PERFORM 9900-ERROR-FORMAT
 14905                                 THRU 9900-EXIT
 14906           end-if
 14907        end-if
 14908     end-if
 14909
 14910*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14911*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14912*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14913*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 269
* EL050.cbl
 14914
 14915     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14916        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14917                      OR
 14918           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 14919           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14920           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14921           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14922        END-IF
 14923     END-IF
 14924
 14925     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14926        IF WS-COMP-MAX-CAP GREATER THAN +0
 14927           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14928              IF (PB-REISSUED-CERT         OR
 14929                  PB-POLICY-IS-DECLINED    OR
 14930                  PB-POLICY-IS-VOIDED)
 14931                 NEXT SENTENCE
 14932              ELSE
 14933                  MOVE ER-2646   TO  WS-ERROR
 14934                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14935
 14936 3344-CVL-TOLERANCE-CHECK.
 14937
 14938      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14939          GO TO 3344-CHECK-AH.
 14940
 14941      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14942          GO TO 3344-CHECK-AH.
 14943
 14944      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14945                                     WS-UNSIGN-WRK6.
 14946
 14947      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14948          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14949                                 + PB-I-LF-PREMIUM-AMT
 14950                                 - PB-I-LF-PREM-CALC.
 14951
 14952      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14953          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14954                                 + PB-I-LF-ALT-PREMIUM-AMT
 14955                                 - PB-I-LF-ALT-PREM-CALC.
 14956
 14957      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14958          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14959              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14960                 MOVE ER-2652    TO  WS-ERROR
 14961                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14962              ELSE
 14963                 MOVE ER-2650    TO  WS-ERROR
 14964                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14965
 14966      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14967          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14968              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14969                 MOVE ER-2652    TO  WS-ERROR
 14970                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14971              ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 270
* EL050.cbl
 14972                 MOVE ER-2650    TO  WS-ERROR
 14973                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14974
 14975 3344-CHECK-AH.
 14976
 14977****************************************************************
 14978***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14979***
 14980
 14981     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14982         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14983             (1 + WS-TOL-AH-PREM-PCT)
 14984         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14985             (1 - WS-TOL-AH-PREM-PCT)
 14986     ELSE
 14987         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14988         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14989
 14990***
 14991***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14992***
 14993
 14994     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14995         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14996
 14997     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14998         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14999
 15000     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15001        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15002
 15003     IF (PB-REISSUED-CERT)
 15004        OR (PB-POLICY-IS-DECLINED)
 15005        OR (PB-POLICY-IS-VOIDED)
 15006        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15007        CONTINUE
 15008     ELSE
 15009        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15010              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15011                          or
 15012           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15013              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15014           IF WS-PREM-REJECT-SW = SPACE
 15015              MOVE ER-3052       TO WS-ERROR
 15016              PERFORM 9900-ERROR-FORMAT
 15017                                 THRU 9900-EXIT
 15018           ELSE
 15019              MOVE ER-3050       TO WS-ERROR
 15020              PERFORM 9900-ERROR-FORMAT
 15021                                 THRU 9900-EXIT
 15022           END-IF
 15023        END-IF
 15024     END-IF
 15025     if (pb-company-id = 'DCC' or 'VPP')
 15026        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15027        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15028        and (pb-i-policy-is-monthly)
 15029        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 271
* EL050.cbl
 15030           pb-i-tot-fees-calc + ws-tol-ah-prem
 15031        compute ws-tol-ah-low-prem-amt =
 15032           pb-i-tot-fees-calc - ws-tol-ah-prem
 15033        if ws-tol-ah-prem-pct > zeros
 15034           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15035              (1 + ws-tol-ah-prem-pct)
 15036           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15037              (1 - ws-tol-ah-prem-pct)
 15038        else
 15039           move +9999999.99      to ws-tol-ah-high-prem-pct
 15040           move +0               to ws-tol-ah-low-prem-pct
 15041        end-if
 15042        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15043            or
 15044           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15045                          or
 15046           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15047           or
 15048           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15049            move er-3049         to ws-error
 15050           perform 9900-error-format
 15051                                 thru 9900-exit
 15052
 15053        end-if
 15054     end-if
 15055     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15056         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15057             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15058             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15059
 15060     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15061        IF WS-COMP-MAX-CAP GREATER THAN +0
 15062           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15063              IF (PB-REISSUED-CERT         OR
 15064                  PB-POLICY-IS-DECLINED    OR
 15065                  PB-POLICY-IS-VOIDED)
 15066                 NEXT SENTENCE
 15067              ELSE
 15068                  MOVE ER-2646   TO  WS-ERROR
 15069                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15070
 15071     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15072        (WS-COMP-MAX-CAP EQUAL +0)
 15073           GO TO 3345-EDIT-CONTINUE.
 15074
 15075     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15076        GREATER THAN WS-COMP-MAX-CAP
 15077           MOVE ER-2646          TO  WS-ERROR
 15078           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15079
 15080 3345-EDIT-CONTINUE.
 15081
 15082*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15083*       IF PB-ENTRY-BATCH   NUMERIC
 15084*          IF PB-ISSUE
 15085*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15086*          ELSE
 15087*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 272
* EL050.cbl
 15088*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15089
 15090*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15091*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15092*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15093*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15094*        ELSE
 15095*            MOVE  ER-1909            TO  WS-ERROR
 15096*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15097
 15098     IF PB-I-POLICY-ACCEPTED
 15099        IF PB-POLICY-IS-DECLINED  OR
 15100           PB-REISSUED-CERT  OR
 15101           PB-REIN-ONLY-CERT  OR
 15102           PB-POLICY-IS-VOIDED
 15103            MOVE  ER-1891         TO  WS-ERROR
 15104            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15105        ELSE
 15106            MOVE SPACE            TO  PB-BATCH-ENTRY
 15107            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15108
 15109     IF PB-I-POLICY-DECLINED
 15110        IF PB-REISSUED-CERT  OR
 15111           PB-REIN-ONLY-CERT  OR
 15112           PB-POLICY-IS-VOIDED
 15113            MOVE  ER-1906         TO  WS-ERROR
 15114            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15115        ELSE
 15116            MOVE  'D'             TO  PB-BATCH-ENTRY
 15117                                      PB-I-ENTRY-STATUS.
 15118
 15119     IF PB-I-NEEDS-UNDERWRITING
 15120        IF PB-POLICY-IS-DECLINED OR
 15121           PB-REISSUED-CERT  OR
 15122           PB-REIN-ONLY-CERT  OR
 15123           PB-POLICY-IS-VOIDED
 15124            MOVE  ER-1907         TO  WS-ERROR
 15125            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15126        ELSE
 15127            MOVE 'U'              TO  PB-BATCH-ENTRY
 15128                                      PB-I-ENTRY-STATUS.
 15129
 15130     IF PB-NEEDS-UNDERWRITING
 15131        MOVE  ER-1901             TO  WS-ERROR
 15132        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15133     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15134        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15135        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15136        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15137           AND (NOT WS-LF-CASH))
 15138                           OR
 15139           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15140           AND (NOT WS-AH-CASH)))
 15141                       AND
 15142           (PB-I-ENTRY-STATUS NOT = '5')
 15143           MOVE 'M'              TO PB-BATCH-ENTRY
 15144                                    PB-I-ENTRY-STATUS
 15145        END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 273
* EL050.cbl
 15146     END-IF
 15147     move pending-business       to ws-passed-erpndb
 15148     move ' '                    to ws-exceed-limit-yn
 15149     perform 7780-call-agg       thru 7780-exit
 15150*    display ' el050 exceed ' ws-exceed-limit-yn
 15151     if ws-exceed-limit-yn = 'Y'
 15152        MOVE  ER-9813            TO WS-ERROR
 15153        move 'Y'                 to ws-9813-sw
 15154        PERFORM  9900-ERROR-FORMAT
 15155                                 THRU 9900-EXIT
 15156     end-if
 15157     if (PB-EXCEEDED-LIMIT-FORCED)
 15158        and (ws-9813-sw = 'Y')
 15159        subtract +1 from PB-NO-OF-ERRORS
 15160        move er-9823             to ws-error
 15161        PERFORM  9900-ERROR-FORMAT
 15162                                 THRU 9900-EXIT
 15163     end-if
 15164     IF  PB-COMPANY-ID NOT = 'NCL'
 15165         GO TO 3999-END-EDIT.
 15166
 15167     IF PB-REISSUED-CERT  OR
 15168        PB-POLICY-IS-DECLINED  OR
 15169        PB-POLICY-IS-VOIDED  OR
 15170        PB-I-OB
 15171         GO TO 3999-END-EDIT.
 15172
 15173     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15174         MOVE  ER-2644            TO  WS-ERROR
 15175         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15176         GO TO 3999-END-EDIT.
 15177
 15178     MOVE 'N'                     TO  FORM-MASTER-SW.
 15179     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15180
 15181     IF NOT FORM-MASTER-FOUND
 15182         GO TO 3999-END-EDIT.
 15183
 15184     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15185                                      FORM-MASTER-AH-SW.
 15186
 15187     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15188         MOVE  +1                 TO SUB6
 15189         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15190
 15191     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15192         MOVE  +1                 TO SUB6
 15193         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15194
 15195     IF LF-FORM-MASTER-FOUND  OR
 15196        AH-FORM-MASTER-FOUND
 15197         GO TO 3360-CHECK-FORM-LIMITS
 15198     ELSE
 15199         GO TO 3999-END-EDIT.
 15200
 15201******************************************************************
 15202*                  3350-GET-ERFORM                               *
 15203*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 274
* EL050.cbl
 15204*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15205******************************************************************
 15206
 15207 3350-GET-ERFORM.
 15208
 15209     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15210         GO TO  3350-ERFORM-GETMAIN.
 15211
 15212     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15213     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15214     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15215     MOVE 'Y'                     TO FORM-MASTER-SW.
 15216
 15217     IF PB-CANCELLATION
 15218         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15219            PB-SV-STATE          EQUAL   FO-STATE       AND
 15220            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15221              GO TO 3350-EXIT
 15222         ELSE
 15223             NEXT SENTENCE
 15224     ELSE
 15225         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15226            PB-SV-STATE          EQUAL   FO-STATE       AND
 15227            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15228              GO TO 3350-EXIT.
 15229
 15230 3350-ERFORM-GETMAIN.
 15231
 15232     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15233     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15234
 15235 3350-ERFORM-READ.
 15236
 15237     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15238     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15239     IF PB-CANCELLATION
 15240         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15241     ELSE
 15242         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15243     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15244
 15245     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15246
 15247     IF FORM-MASTER-FOUND
 15248       IF PB-CANCELLATION
 15249          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15250             PB-SV-STATE          EQUAL   FO-STATE       AND
 15251             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15252              GO  TO 3350-EXIT
 15253          ELSE
 15254              NEXT SENTENCE
 15255       ELSE
 15256          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15257             PB-SV-STATE          EQUAL   FO-STATE       AND
 15258             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15259              GO  TO 3350-EXIT.
 15260
 15261     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 275
* EL050.cbl
 15262     MOVE  ER-1895                TO  WS-ERROR.
 15263     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15264
 15265 3350-EXIT.
 15266      EXIT.
 15267
 15268******************************************************************
 15269*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15270*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15271*   VALID FOR THE POLICY FORM USED.                              *
 15272******************************************************************
 15273
 15274 3355-EDIT-FORM-LF-BENEFITS.
 15275
 15276     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15277        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15278         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15279         GO TO   3355-EXIT.
 15280
 15281     IF  SUB6    LESS THAN   +40
 15282         ADD  +1      TO  SUB6
 15283         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15284
 15285     MOVE  ER-1896         TO  WS-ERROR.
 15286     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15287
 15288 3355-EXIT.
 15289      EXIT.
 15290
 15291******************************************************************
 15292*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15293*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15294*   VALID FOR THE POLICY FORM USED.                              *
 15295******************************************************************
 15296
 15297 3356-EDIT-FORM-AH-BENEFITS.
 15298
 15299     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15300        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15301         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15302         GO TO  3356-EXIT.
 15303
 15304      IF  SUB6    LESS THAN     +40
 15305          ADD  +1      TO  SUB6
 15306          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15307
 15308     MOVE  ER-1897         TO  WS-ERROR.
 15309     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15310
 15311 3356-EXIT.
 15312      EXIT.
 15313
 15314******************************************************************
 15315*                  3357-BENEFIT-SEARCH                           *
 15316*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15317*   CANCELLATIONS ONLY.                                          *
 15318******************************************************************
 15319 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 276
* EL050.cbl
 15320     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15321         MOVE +1                          TO SUB6
 15322         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15323
 15324     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15325         MOVE +1                          TO SUB6
 15326         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15327
 15328 3357-EXIT.
 15329     EXIT.
 15330
 15331******************************************************************
 15332*                  3358-BENEFIT-LIFE-SEARCH                      *
 15333*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15334*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15335*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15336******************************************************************
 15337 3358-BENEFIT-LIFE-SEARCH.
 15338     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15339       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15340         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15341           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15342              IF FO-PLAN-REFUND-METHOD (SUB6)
 15343                     IS GREATER THAN SPACES
 15344                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15345                                          WS-LF-REFUND-CALC
 15346                 GO TO 3358-EXIT.
 15347
 15348     IF SUB6 LESS THAN +40
 15349         ADD +1                 TO SUB6
 15350         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15351
 15352 3358-EXIT.
 15353     EXIT.
 15354******************************************************************
 15355*                  3359-BENEFIT-AH-SEARCH                        *
 15356*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15357*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15358*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15359******************************************************************
 15360 3359-BENEFIT-AH-SEARCH.
 15361     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15362       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15363         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15364           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15365              IF FO-PLAN-REFUND-METHOD (SUB6)
 15366                      IS GREATER THAN SPACES
 15367                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15368                                          WS-AH-REFUND-CALC
 15369                 GO TO 3359-EXIT.
 15370
 15371     IF SUB6 LESS THAN +40
 15372         ADD +1                 TO SUB6
 15373         GO TO 3359-BENEFIT-AH-SEARCH.
 15374
 15375 3359-EXIT.
 15376     EXIT.
 15377
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 277
* EL050.cbl
 15378******************************************************************
 15379*                  3360-CHECK-FORM-LIMITS                        *
 15380*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15381*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15382******************************************************************
 15383
 15384 3360-CHECK-FORM-LIMITS.
 15385
 15386     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15387         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15388
 15389     IF NOT LF-FORM-MASTER-FOUND
 15390         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15391
 15392 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15393
 15394     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15395       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15396        WS-LF-JOINT-INDICATOR = 'J'  AND
 15397        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15398         IF PB-COMPANY-ID = 'NCL'
 15399            MOVE  ER-1911          TO  WS-ERROR
 15400            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15401         ELSE
 15402            MOVE  ER-1892          TO  WS-ERROR
 15403            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15404
 15405 3360-CHECK-FORM-LF-ATT-AGE.
 15406
 15407     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15408
 15409     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15410         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15411         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15412            IF PB-COMPANY-ID = 'NCL'
 15413                MOVE  ER-1913      TO  WS-ERROR
 15414                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15415            ELSE
 15416                MOVE  ER-1894      TO  WS-ERROR
 15417                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15418
 15419 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15420
 15421     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15422         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15423         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15424            IF PB-COMPANY-ID = 'NCL'
 15425                MOVE  ER-1914      TO  WS-ERROR
 15426                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15427            ELSE
 15428                MOVE  ER-1899      TO  WS-ERROR
 15429                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15430
 15431 3360-CHECK-FORM-LF-TERM-BAMT.
 15432
 15433     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15434         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15435         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 278
* EL050.cbl
 15436           IF  PB-COMPANY-ID = 'NCL'
 15437               MOVE  ER-1916       TO  WS-ERROR
 15438               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15439           ELSE
 15440               MOVE  ER-1902       TO  WS-ERROR
 15441               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15442
 15443     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15444                                    PB-I-LF-ALT-BENEFIT-AMT.
 15445
 15446     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15447         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15448         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15449             IF  PB-COMPANY-ID = 'NCL'
 15450                 MOVE  ER-1918     TO  WS-ERROR
 15451                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15452             ELSE
 15453                 MOVE  ER-1904     TO  WS-ERROR
 15454                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15455
 15456******************************************************************
 15457*                  3360-CHECK-FORM-AH-LIMITS                     *
 15458*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15459*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15460******************************************************************
 15461
 15462 3360-CHECK-FORM-AH-LIMITS.
 15463
 15464     IF NOT AH-FORM-MASTER-FOUND
 15465         GO TO 3999-END-EDIT.
 15466
 15467 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15468
 15469     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15470       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15471        WS-AH-JOINT-INDICATOR = 'J'  AND
 15472        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15473         IF PB-COMPANY-ID = 'NCL'
 15474            MOVE  ER-1912          TO  WS-ERROR
 15475            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15476         ELSE
 15477            MOVE  ER-1893          TO  WS-ERROR
 15478            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15479
 15480 3360-CHECK-FORM-AH-ATT-AGE.
 15481
 15482     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15483
 15484     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15485         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15486         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15487            IF PB-COMPANY-ID = 'NCL'
 15488                MOVE  ER-1913      TO  WS-ERROR
 15489                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15490            ELSE
 15491                MOVE  ER-1894      TO  WS-ERROR
 15492                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15493
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 279
* EL050.cbl
 15494 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15495
 15496     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15497         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15498         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15499            IF PB-COMPANY-ID = 'NCL'
 15500                MOVE  ER-1915      TO  WS-ERROR
 15501                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15502            ELSE
 15503                MOVE  ER-1900      TO  WS-ERROR
 15504                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15505
 15506 3360-CHECK-FORM-AH-TERM-BAMT.
 15507
 15508     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15509         FO-AH-MAX-TERM    GREATER THAN  +0
 15510         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15511             IF  PB-COMPANY-ID = 'NCL'
 15512                 MOVE  ER-1917     TO  WS-ERROR
 15513                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15514             ELSE
 15515                  MOVE  ER-1903    TO  WS-ERROR
 15516                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15517
 15518     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15519         FO-MAX-AH-AMT    GREATER THAN  +0
 15520         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15521             IF  PB-COMPANY-ID = 'NCL'
 15522                 MOVE  ER-1919     TO  WS-ERROR
 15523                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15524             ELSE
 15525                 MOVE  ER-1905     TO  WS-ERROR
 15526                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15527
 15528     GO TO 3999-END-EDIT.
 15529
 15530******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 280
* EL050.cbl
 15532 3400-edit-vin.
 15533
 15534     move spaces                 to hldi-pass-area
 15535     MOVE PB-I-VIN               TO WS-WORK-VIN
 15536     MOVE +8                     TO V2
 15537     MOVE ZEROS                  TO WS-VIN-TOTAL
 15538     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15539      (V1 > 17)
 15540        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15541           MOVE ER-3825          TO WS-ERROR
 15542           PERFORM 9900-ERROR-FORMAT
 15543                                 THRU 9900-EXIT
 15544        ELSE
 15545           IF V1 = 8
 15546              MOVE 10            TO V2
 15547           END-IF
 15548           IF V1 = 9
 15549              MOVE 0             TO V2
 15550           END-IF
 15551           IF V1 = 10
 15552              MOVE 9             TO V2
 15553           END-IF
 15554           IF WS-WORK-VIN (V1:1) NUMERIC
 15555              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15556               + (WS-WORK-VIN-N (V1) * V2)
 15557           ELSE
 15558              MOVE WS-WORK-VIN (V1:1)
 15559                            TO WS-HEX-BYTE
 15560              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15561              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15562               + (WS-NUM (V3) * V2)
 15563           END-IF
 15564           COMPUTE V2 = V2 - 1
 15565        END-IF
 15566     END-PERFORM
 15567     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15568     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15569        REMAINDER WS-VIN-REMAINDER
 15570     IF ((WS-WORK-VIN (9:1) = 'X')
 15571        AND (WS-VIN-REMAINDER = 10))
 15572                OR
 15573        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15574        if pb-company-id = 'VPP'
 15575           perform 3410-check-with-hldi
 15576                                 thru 3410-exit
 15577        end-if
 15578     ELSE
 15579        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15580           MOVE ER-3826          TO WS-ERROR
 15581           PERFORM 9900-ERROR-FORMAT
 15582                                 THRU 9900-EXIT
 15583        ELSE
 15584           MOVE ER-3827          TO WS-ERROR
 15585           PERFORM 9900-ERROR-FORMAT
 15586                                 THRU 9900-EXIT
 15587        END-IF
 15588     END-IF
 15589
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 281
* EL050.cbl
 15590     .
 15591 3400-exit.
 15592     exit.
 15593 3410-check-with-hldi.
 15594     move spaces                 to hldi-pass-area
 15595     move pb-i-vin               to pa-vin
 15596     perform 7785-call-hldi      thru 7785-exit
 15597*    display 'PA-VIN        ' PA-VIN
 15598*    display 'PA-ErrorCode  ' PA-ErrorCode
 15599*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15600*    display 'PA-ModelYear  ' PA-ModelYear
 15601*    display 'PA-MakeName   ' PA-MakeName
 15602*    display 'PA-ModelName  ' PA-ModelName
 15603*    display 'PA-SeriesName ' PA-SeriesName
 15604     if pa-errorcode (1:1) not = '0'
 15605        move spaces              to hldi-pass-area
 15606        move pb-i-vin            to pa-vin
 15607*       move pa-errordesc        to pa-seriesname
 15608*       perform 7786-call-hldim  thru 7786-exit
 15609*       display 'PA-VIN        ' PA-VIN
 15610*       display 'PA-ErrorCode  ' PA-ErrorCode
 15611*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15612*       display 'PA-ModelYear  ' PA-ModelYear
 15613*       display 'PA-MakeName   ' PA-MakeName
 15614*       display 'PA-ModelName  ' PA-ModelName
 15615*       display 'PA-SeriesName ' PA-SeriesName
 15616     end-if
 15617     .
 15618 3410-exit.
 15619     exit.
 15620******************************************************************
 15621*                  E D I T   C A N C E L                         *
 15622******************************************************************
 15623
 15624 3700-EDIT-CANCEL.
 15625     IF PB-COMPANY-ID = 'DMD'
 15626         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15627                                         WS-RES-MUNI-TAX
 15628                                         PB-CI-STATE-TAX
 15629                                         PB-CI-MUNI-TAX
 15630         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15631
 15632*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15633*       IF PB-ENTRY-BATCH  NUMERIC
 15634*          IF PB-CANCELLATION
 15635*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15636*          ELSE
 15637*             IF PB-ISSUE
 15638*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15639
 15640     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15641        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15642     END-IF
 15643*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15644*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15645
 15646     IF CM-ENTRY-STATUS = 'V'
 15647        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 282
* EL050.cbl
 15648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15649        GO TO 3999-END-EDIT.
 15650
 15651     IF CM-ENTRY-STATUS = 'D'
 15652        MOVE ER-2781             TO WS-ERROR
 15653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15654        GO TO 3999-END-EDIT.
 15655
 15656     IF CM-ENTRY-STATUS = 'U'
 15657        MOVE ER-2782             TO WS-ERROR
 15658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15659
 15660***************************************************************
 15661*                                                             *
 15662*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15663*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15664*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15665*   OF ANOTHER COVERAGE.                                      *
 15666*                                                             *
 15667***************************************************************
 15668
 15669     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15670                                    PB-C-AH-CANCEL-VOID-SW.
 15671
 15672     IF PB-C-LF-CANCEL-AMT = ZERO
 15673        NEXT SENTENCE
 15674     ELSE
 15675        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15676           AND
 15677           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15678               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15679               MOVE ER-2745           TO WS-ERROR
 15680               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15681
 15682     IF PB-C-AH-CANCEL-AMT = ZERO
 15683        NEXT SENTENCE
 15684     ELSE
 15685        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15686           AND
 15687           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15688               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15689               MOVE ER-2745           TO WS-ERROR
 15690               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15691
 15692     IF WS-LF-EARNINGS-CALC = '4'
 15693        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15694
 15695     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15696     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15697     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15698     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15699     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15700     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15701
 15702     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15703                                      PB-C-AH-REF-CALC.
 15704     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15705
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 283
* EL050.cbl
 15706******************************************************************
 15707*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15708*             TO VALIDATE COVERAGE.                              *
 15709******************************************************************
 15710
 15711     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15712        PB-C-LF-CANCEL-AMT = ZEROS
 15713          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15714      ELSE
 15715          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15716
 15717     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15718        PB-C-AH-CANCEL-AMT = ZEROS
 15719          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15720      ELSE
 15721          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15722
 15723     EVALUATE TRUE
 15724         WHEN PB-CANCEL-FORCE             OR
 15725              PB-CANCEL-DATE-FORCED       OR
 15726              PB-FORCE-OFF
 15727                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15728                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15729                  END-IF
 15730         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15731               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15732              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 15733                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15734         WHEN OTHER
 15735              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15736                 MOVE ER-2794              TO WS-ERROR
 15737              ELSE
 15738                 MOVE ER-2749              TO WS-ERROR
 15739              END-IF
 15740              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15741     END-EVALUATE.
 15742
 15743
 15744*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15745*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15746*            MOVE  ER-1909            TO  WS-ERROR
 15747*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15748*        ELSE
 15749*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15750
 15751     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15752     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15753        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15754     ELSE
 15755        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15756     END-IF
 15757     .
 15758 3705-EDIT-CANCEL-DT.
 15759
 15760     IF LF-COVERAGE-CANCELLED
 15761        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15762         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15763         MOVE WS-CURRENT-MONTH-END
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 284
* EL050.cbl
 15764                                 TO DC-BIN-DATE-2
 15765         SET ELAPSED-BETWEEN-BIN TO TRUE
 15766*        MOVE 1                  TO DC-OPTION-CODE
 15767         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15768         IF DATE-CONVERSION-ERROR
 15769            NEXT SENTENCE
 15770          ELSE
 15771             IF DC-ELAPSED-DAYS GREATER +180
 15772                IF PB-CANCEL-DATE-FORCED  OR
 15773                   PB-CANCEL-DATE-FORCED-NO-FEE
 15774                      MOVE ER-2751  TO WS-ERROR
 15775                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15776                 ELSE
 15777                   MOVE ER-2752  TO WS-ERROR
 15778                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15779
 15780     IF AH-COVERAGE-CANCELLED
 15781        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15782         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15783         MOVE WS-CURRENT-MONTH-END
 15784                                 TO DC-BIN-DATE-2
 15785         SET ELAPSED-BETWEEN-BIN TO TRUE
 15786*        MOVE 1                  TO DC-OPTION-CODE
 15787         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15788         IF DATE-CONVERSION-ERROR
 15789            NEXT SENTENCE
 15790          ELSE
 15791             IF DC-ELAPSED-DAYS GREATER +180
 15792                IF PB-CANCEL-DATE-FORCED OR
 15793                   PB-CANCEL-DATE-FORCED-NO-FEE
 15794                      MOVE ER-2751  TO WS-ERROR
 15795                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15796                 ELSE
 15797                   MOVE ER-2752  TO WS-ERROR
 15798                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15799
 15800     IF WS-ERROR = ER-2752
 15801        AND (PB-COMPANY-ID = 'ABL'
 15802         OR  PB-COMPANY-ID = 'FGL'
 15803         OR  PB-COMPANY-ID = 'IST'
 15804         OR  PB-COMPANY-ID = 'JHL'
 15805         OR  PB-COMPANY-ID = 'LAP'
 15806         OR  PB-COMPANY-ID = 'LBL'
 15807         OR  PB-COMPANY-ID = 'NCB'
 15808         OR  PB-COMPANY-ID = 'NLI'
 15809         OR  PB-COMPANY-ID = 'OFI'
 15810         OR  PB-COMPANY-ID = 'PLI'
 15811         OR  PB-COMPANY-ID = 'TAO'
 15812         OR  PB-COMPANY-ID = 'TIC'
 15813         OR  PB-COMPANY-ID = 'HER'
 15814         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15815         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15816            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15817            MOVE ER-2762     TO WS-ERROR
 15818            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15819
 15820     IF LF-COVERAGE-CANCELLED
 15821        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 285
* EL050.cbl
 15822        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15823             MOVE ER-2733         TO WS-ERROR
 15824             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15825
 15826     IF AH-COVERAGE-CANCELLED
 15827        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15828        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15829              MOVE ER-2733        TO WS-ERROR
 15830              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15831
 15832     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15833        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15834        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15835           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15836            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15837              IF PB-COMPANY-ID NOT = 'LAP'
 15838               MOVE ER-2704            TO WS-ERROR
 15839               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15840
 15841     IF CERT-WAS-NOT-FOUND
 15842         GO TO 3999-END-EDIT.
 15843
 15844     IF PB-COMPANY-ID EQUAL 'CDC'
 15845        IF LF-COVERAGE-CANCELLED
 15846           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15847            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15848            MOVE PB-C-LF-CANCEL-DT
 15849                                 TO DC-BIN-DATE-2
 15850            SET ELAPSED-BETWEEN-BIN TO TRUE
 15851*           MOVE 1               TO DC-OPTION-CODE
 15852            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15853            IF DATE-CONVERSION-ERROR
 15854               NEXT SENTENCE
 15855             ELSE
 15856                IF DC-ELAPSED-DAYS GREATER +60
 15857                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15858
 15859     IF PB-COMPANY-ID EQUAL 'CDC'
 15860        IF AH-COVERAGE-CANCELLED
 15861           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15862            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15863            MOVE PB-C-AH-CANCEL-DT
 15864                                 TO DC-BIN-DATE-2
 15865            MOVE +0              TO DC-ELAPSED-DAYS
 15866                                    DC-ELAPSED-MONTHS
 15867            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15868*           MOVE 1               TO DC-OPTION-CODE
 15869            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15870            IF DATE-CONVERSION-ERROR
 15871               NEXT SENTENCE
 15872             ELSE
 15873                IF DC-ELAPSED-DAYS GREATER +60
 15874                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15875
 15876     MOVE +0                     TO DC-ELAPSED-DAYS
 15877                                    DC-ELAPSED-MONTHS.
 15878
 15879     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 286
* EL050.cbl
 15880        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15881          MOVE 'Z'                TO PB-CI-OB-FLAG
 15882          MOVE ER-2767            TO WS-ERROR
 15883          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15884          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15885          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15886          GO TO 3775-OVER-REF-CHK
 15887        ELSE
 15888          MOVE ZEROS              TO PB-CI-LIVES
 15889                                     PB-C-LIVES
 15890          IF PB-CI-OB-FLAG NOT = 'B'
 15891             MOVE SPACE           TO PB-CI-OB-FLAG.
 15892
 15893     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15894         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15895     ELSE
 15896         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15897
 15898     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15899        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15900            MOVE ER-2760         TO WS-ERROR
 15901            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15902
 15903     IF LF-COVERAGE-CANCELLED
 15904        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15905         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15906            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15907               MOVE ER-2774       TO WS-ERROR
 15908               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15909
 15910     IF AH-COVERAGE-CANCELLED
 15911        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15912         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15913            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15914               MOVE ER-2775       TO WS-ERROR
 15915               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15916
 15917     IF LF-COVERAGE-CANCELLED
 15918        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15919         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15920            MOVE ER-2776         TO WS-ERROR
 15921            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15922
 15923     IF AH-COVERAGE-CANCELLED
 15924        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15925         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15926            MOVE ER-2777         TO WS-ERROR
 15927            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15928
 15929     IF LF-COVERAGE-CANCELLED
 15930        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15931        if pb-ci-lf-expire-dt = low-values or spaces
 15932           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15933           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15934           MOVE PB-CI-EXTENTION-DAYS
 15935                                 TO DC-ELAPSED-DAYS
 15936           SET BIN-PLUS-ELAPSED  TO TRUE
 15937           PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 287
* EL050.cbl
 15938                                 THRU 8500-EXIT
 15939           IF DATE-CONVERSION-ERROR
 15940              move low-values    to dc-bin-date-2
 15941           end-if
 15942        else
 15943           move pb-ci-lf-expire-dt
 15944                                 to dc-bin-date-2
 15945        end-if
 15946        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15947           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15948                             OR  'FIA'
 15949              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15950           ELSE
 15951              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15952              MOVE ER-2731       TO WS-ERROR
 15953              PERFORM 9900-ERROR-FORMAT
 15954                                 THRU 9900-EXIT
 15955           end-if
 15956        end-if
 15957     end-if
 15958*    IF LF-COVERAGE-CANCELLED
 15959*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15960*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15961*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15962*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15963*        SET BIN-PLUS-ELAPSED      TO TRUE
 15964*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15965*        IF DATE-CONVERSION-ERROR
 15966*           NEXT SENTENCE
 15967*         ELSE
 15968*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15969*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15970*                            OR  'FIA'
 15971*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15972*              ELSE
 15973*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15974*               MOVE ER-2731       TO WS-ERROR
 15975*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15976     .
 15977 3705-EDIT-AH-CANCEL-DT.
 15978     IF AH-COVERAGE-CANCELLED
 15979        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15980        if pb-ci-AH-expire-dt = low-values or spaces
 15981           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15982           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15983           MOVE PB-CI-EXTENTION-DAYS
 15984                                 TO DC-ELAPSED-DAYS
 15985           SET BIN-PLUS-ELAPSED  TO TRUE
 15986           PERFORM 8500-DATE-CONVERT
 15987                                 THRU 8500-EXIT
 15988           IF DATE-CONVERSION-ERROR
 15989              move low-values    to dc-bin-date-2
 15990           end-if
 15991        else
 15992           move pb-ci-ah-expire-dt
 15993                                 to dc-bin-date-2
 15994        end-if
 15995        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 288
* EL050.cbl
 15996           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15997                             OR  'FIA'
 15998              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15999           ELSE
 16000              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16001              MOVE ER-2771       TO WS-ERROR
 16002              PERFORM 9900-ERROR-FORMAT
 16003                                 THRU 9900-EXIT
 16004           end-if
 16005        end-if
 16006     end-if
 16007*    IF AH-COVERAGE-CANCELLED
 16008*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16009*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16010*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16011*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16012**       MOVE 6                    TO DC-OPTION-CODE
 16013*        SET BIN-PLUS-ELAPSED      TO TRUE
 16014*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16015*        IF DATE-CONVERSION-ERROR
 16016*           NEXT SENTENCE
 16017*         ELSE
 16018*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16019*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16020*                             OR 'FIA'
 16021*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16022*             ELSE
 16023*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16024*              MOVE ER-2771       TO WS-ERROR
 16025*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16026     .
 16027 3705-EDIT-CONTINUED.
 16028
 16029*    IF LF-COVERAGE-CANCELLED
 16030*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16031*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16032*            MOVE ER-2727         TO WS-ERROR
 16033*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16034*
 16035*    IF AH-COVERAGE-CANCELLED
 16036*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16037*        IF PB-COMPANY-ID = 'ACE'
 16038*           MOVE ER-2727        TO WS-ERROR
 16039*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16040*        ELSE
 16041*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16042*              MOVE ER-2727     TO WS-ERROR
 16043*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16044
 16045     IF PB-COMPANY-ID = 'ACE'
 16046       IF AH-COVERAGE-CANCELLED
 16047         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16048           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16049              MOVE ER-2732      TO WS-ERROR
 16050              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16051
 16052     IF PB-COMPANY-ID      EQUAL   'HER'
 16053        IF WS-ERROR        EQUAL   ER-2727
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 289
* EL050.cbl
 16054            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16055            MOVE  ER-2725          TO  WS-ERROR
 16056            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16057
 16058     IF PB-C-CLAIM-CREATED-CANCEL
 16059            MOVE ER-2748         TO WS-ERROR
 16060            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16061
 16062     IF PB-C-LAST-NAME NOT = SPACES
 16063         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16064            MOVE ER-2747         TO WS-ERROR
 16065            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16066
 16067 3710-EDIT-LUMP-SUM-PRIOR.
 16068
 16069     IF AH-COVERAGE-CANCELLED
 16070         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16071             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16072                MOVE ER-2735    TO WS-ERROR
 16073                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16074
 16075     IF LF-COVERAGE-CANCELLED
 16076         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16077             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16078                MOVE ER-2735    TO WS-ERROR
 16079                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16080
 16081 3710-EDIT-PRIOR-DEATH.
 16082
 16083*    IF LF-COVERAGE-CANCELLED
 16084*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16085*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16086*           (NOT PB-CI-OB)
 16087*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16088*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16089*                   MOVE ER-2732  TO WS-ERROR
 16090*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16091*
 16092*    IF AH-COVERAGE-CANCELLED
 16093*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16094*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16095*           (NOT PB-CI-OB)
 16096*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16097*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16098*                   MOVE ER-2732  TO WS-ERROR
 16099*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16100
 16101     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16102         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16103            (NOT PB-COMP-LF-CANCEL)
 16104             NEXT SENTENCE
 16105         ELSE
 16106           IF PB-C-LF-CANCEL-VOIDED
 16107              NEXT SENTENCE
 16108           ELSE
 16109              MOVE ER-2753      TO WS-ERROR
 16110              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16111
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 290
* EL050.cbl
 16112     IF CANCEL-FUTURE-DT
 16113         GO TO 3999-END-EDIT.
 16114
 16115 3715-GET-REMAIN-TERM-LF.
 16116
 16117     IF NO-LF-BENEFIT-MATCH  OR
 16118        WS-LF-BENEFIT-CD = ZEROS
 16119        GO TO 3730-GET-AH-REMAIN-TERM.
 16120
 16121     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16122     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16123     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16124     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16125     MOVE PB-SV-STATE            TO CP-STATE.
 16126     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16127     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16128     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16129     MOVE '2'                    TO CP-PROCESS-TYPE.
 16130     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16131     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16132     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16133     IF (PB-COMPANY-ID = 'CID')
 16134        AND (CP-STATE-STD-ABBRV = 'WI')
 16135        MOVE '7'                 TO CP-REM-TERM-METHOD
 16136        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16137     ELSE
 16138        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16139        MOVE WS-REM-TRM-CALC-OPTION
 16140                                 TO CP-REM-TRM-CALC-OPTION
 16141     END-IF
 16142**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16143     IF (PB-COMPANY-ID = 'CID')
 16144        AND (CP-STATE-STD-ABBRV = 'MO')
 16145        AND (PB-CERT-EFF-DT >= X'9B41')
 16146        AND (PB-CERT-EFF-DT <= X'A2FB')
 16147        MOVE '7'                 TO CP-REM-TERM-METHOD
 16148        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16149     END-IF
 16150     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16151                                    CP-LOAN-TERM.
 16152     IF CP-TRUNCATED-LIFE
 16153        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16154
 16155     IF CP-TERM-IS-DAYS
 16156         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16157     ELSE
 16158         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16159
 16160     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16161
 16162     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16163
 16164     IF LF-COVERAGE-CANCELLED
 16165        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16166        NEXT SENTENCE
 16167      ELSE
 16168          GO TO 3730-GET-AH-REMAIN-TERM.
 16169
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 291
* EL050.cbl
 16170 3720-GET-LF-REFUND.
 16171
 16172     IF PB-C-LF-CANCEL-VOIDED
 16173        GO TO 3730-GET-AH-REMAIN-TERM
 16174     end-if
 16175
 16176     IF PB-COMPANY-ID EQUAL 'BOA'
 16177         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16178         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16179         GO TO 3730-GET-AH-REMAIN-TERM.
 16180
 16181     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16182        (WS-AH-SPECIAL-CALC-CD = 'M')
 16183         MOVE ER-2767            TO WS-ERROR
 16184         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16185         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16186         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16187         GO TO 3780-UPDATE-CANCEL-CERT.
 16188
 16189*    if (ws-lf-earnings-calc = '6')
 16190*       or (pb-c-lf-refund-override = '6')
 16191*       move cp-remaining-term-1 to cp-remaining-term-2
 16192*    end-if
 16193     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16194
 16195     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16196     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16197     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16198     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16199     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16200     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16201     IF PB-COMPANY-ID = 'DCC'
 16202        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16203        IF PDEF-MASTER-FOUND
 16204           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16205              (V1 > +8)
 16206              OR (PD-PROD-CODE (V1) = 'L')
 16207           END-PERFORM
 16208           IF V1 < +9
 16209              MOVE PD-MAX-AMT (V1)
 16210                           TO CP-R-MAX-TOT-BEN
 16211                              EC-AM-LF-MAX-TOT-BEN
 16212           END-IF
 16213        ELSE
 16214        MOVE ' '                 TO PDEF-MASTER-SW
 16215        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16216        MOVE PB-STATE            TO ERPDEF-STATE
 16217        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16218           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16219        END-IF
 16220        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16221        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16222        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16223        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16224        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16225        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16226        IF PDEF-MASTER-FOUND
 16227           MOVE 'N'              TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 292
* EL050.cbl
 16228           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16229           IF PDEF-MASTER-FOUND
 16230              IF (ERPDEF-KEY-SAVE (1:16) =
 16231                           PD-CONTROL-PRIMARY (1:16))
 16232                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16233                 CONTINUE
 16234              ELSE
 16235                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16236                 IF (ERPDEF-KEY-SAVE (1:16) =
 16237                           PD-CONTROL-PRIMARY (1:16))
 16238                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16239                    CONTINUE
 16240                 ELSE
 16241                    MOVE 'N'     TO PDEF-MASTER-SW
 16242                 END-IF
 16243              END-IF
 16244
 16245              IF PDEF-MASTER-FOUND
 16246                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16247                    (V1 > +8)
 16248                    OR (PD-PROD-CODE (V1) = 'L')
 16249                 END-PERFORM
 16250                 IF V1 < +9
 16251                    MOVE PD-MAX-AMT (V1)
 16252                                 TO CP-R-MAX-TOT-BEN
 16253                                    EC-AM-LF-MAX-TOT-BEN
 16254                 END-IF
 16255              END-IF
 16256           END-IF
 16257           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16258        END-IF
 16259        END-IF
 16260     END-IF
 16261     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16262
 16263     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16264
 16265     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16266                                    PB-C-LF-REM-TERM.
 16267
 16268     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16269     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16270
 16271     IF PB-COMPANY-ID EQUAL 'FLC'
 16272        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16273           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16274           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16275                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16276                    - CM-LF-ITD-DEATH-AMT
 16277           IF PB-C-LF-REF-CALC LESS THAN +0
 16278              MOVE +0            TO PB-C-LF-REF-CALC
 16279              GO TO 3730-GET-AH-REMAIN-TERM
 16280           ELSE
 16281              GO TO 3730-GET-AH-REMAIN-TERM.
 16282
 16283     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16284                            OR '4' OR '5' OR '6' OR '8'
 16285                            OR '9' OR 'G'
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 293
* EL050.cbl
 16286        MOVE PB-C-LF-REFUND-OVERRIDE
 16287                                 TO CP-EARNING-METHOD.
 16288
 16289     if pb-company-id = 'AHL'
 16290        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16291        if cp-class-code = spaces
 16292           move zeros            to cp-class-code
 16293        end-if
 16294     ELSE
 16295        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16296     END-IF
 16297*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16298     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16299     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16300                                    CP-RATING-BENEFIT-AMT.
 16301     IF CP-STATE-STD-ABBRV = 'OR'
 16302         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16303                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16304     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16305     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16306     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16307     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16308     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16309     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16310     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16311     IF WS-DEFAULT-APR NOT NUMERIC
 16312         MOVE ZEROS TO WS-DEFAULT-APR.
 16313****   N O T E   ****
 16314*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16315*      THE OH HARD CODING IN ELCRFNDP
 16316
 16317     IF PB-COMPANY-ID = 'CID'
 16318        IF CP-STATE-STD-ABBRV = 'OH'
 16319           MOVE WS-LF-EARNINGS-CALC
 16320                                 TO CP-EARNING-METHOD
 16321        END-IF
 16322     END-IF
 16323
 16324****   N O T E   ****
 16325
 16326*    IF CP-EARN-AS-NET-PAY
 16327*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16328*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16329*               MOVE WS-DEFAULT-APR
 16330*                                TO  CP-LOAN-APR
 16331*               MOVE ER-3780     TO  WS-ERROR
 16332*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16333*           ELSE
 16334*               MOVE ER-3781     TO  WS-ERROR
 16335*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16336*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16337     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16338
 16339     IF CP-REFUND-TYPE-USED NOT = SPACE
 16340         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16341
 16342     IF CP-ERROR-RATE-IS-ZERO OR
 16343        CP-ERROR-RATE-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 294
* EL050.cbl
 16344        MOVE ER-2740             TO WS-ERROR
 16345        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16346
 16347     IF CP-ERROR-RATE-FILE-NOTOPEN
 16348        MOVE ER-2617             TO WS-ERROR
 16349        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16350
 16351     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16352        AND PB-CI-ENTRY-STATUS = 'M'
 16353        MOVE +0                  TO PB-C-LF-REF-CALC
 16354     ELSE
 16355        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16356     END-IF
 16357
 16358     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16359         GO TO 3730-GET-AH-REMAIN-TERM.
 16360
 16361*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16362*       ADD +1                   TO PB-C-LF-REM-TERM
 16363*                                   CP-REMAINING-TERM
 16364*                                   CP-ORIGINAL-TERM.
 16365
 16366     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16367     MOVE '2'                    TO CP-EARNING-METHOD
 16368                                    CP-RATING-METHOD.
 16369     IF PB-COMPANY-ID = 'CID'
 16370        IF (CP-STATE-STD-ABBRV = 'MN')
 16371           AND (PB-CERT-EFF-DT > X'A4FF')
 16372           AND (WS-LF-EARNINGS-CALC = 'B')
 16373           MOVE '5'              TO CP-EARNING-METHOD
 16374           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16375        END-IF
 16376     END-IF
 16377     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16378                                        CP-REMAINING-BENEFIT
 16379                                        CP-RATING-BENEFIT-AMT.
 16380     IF CP-STATE-STD-ABBRV = 'OR'
 16381         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16382                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16383     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16384     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16385
 16386     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16387
 16388     IF CP-ERROR-RATE-IS-ZERO OR
 16389        CP-ERROR-RATE-NOT-FOUND
 16390        MOVE ER-2740             TO WS-ERROR
 16391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16392
 16393     IF CP-ERROR-RATE-FILE-NOTOPEN
 16394        MOVE ER-2617             TO WS-ERROR
 16395        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16396
 16397     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16398
 16399******************************************************************
 16400
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 295
* EL050.cbl
 16402 3730-GET-AH-REMAIN-TERM.
 16403     IF NO-AH-BENEFIT-MATCH  OR
 16404        WS-AH-BENEFIT-CD = ZEROS
 16405         GO TO 3770-CHECK-REFUNDS.
 16406
 16407     IF PB-CI-AH-LUMP-SUM-DISAB
 16408         IF  PB-C-AH-CANCEL-AMT = ZERO
 16409            IF NOT PB-COMP-AH-CANCEL
 16410             GO TO 3770-CHECK-REFUNDS.
 16411
 16412     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16413     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16414     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16415     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16416     MOVE PB-SV-STATE            TO CP-STATE.
 16417     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16418     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16419     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16420     MOVE '2'                    TO CP-PROCESS-TYPE.
 16421     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16422     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16423     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16424     IF (PB-COMPANY-ID = 'CID')
 16425        AND (CP-STATE-STD-ABBRV = 'WI')
 16426        MOVE '7'                 TO CP-REM-TERM-METHOD
 16427        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16428     ELSE
 16429        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16430        MOVE WS-REM-TRM-CALC-OPTION
 16431                                 TO CP-REM-TRM-CALC-OPTION
 16432     END-IF
 16433     IF (PB-COMPANY-ID = 'CID')
 16434        AND (CP-STATE-STD-ABBRV = 'MO')
 16435        AND (PB-CERT-EFF-DT >= X'9B41')
 16436        AND (PB-CERT-EFF-DT <= X'A2FB')
 16437        MOVE '7'                 TO CP-REM-TERM-METHOD
 16438        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16439     END-IF
 16440     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16441                                    CP-LOAN-TERM.
 16442     IF NOT CP-TERM-IS-DAYS
 16443         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16444
 16445     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16446
 16447     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16448
 16449     IF AH-COVERAGE-CANCELLED
 16450        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16451        NEXT SENTENCE
 16452      ELSE
 16453         GO TO 3770-CHECK-REFUNDS.
 16454
 16455 3740-GET-AH-REFUND.
 16456
 16457     IF PB-C-AH-CANCEL-VOIDED
 16458        GO TO 3780-UPDATE-CANCEL-CERT
 16459     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 296
* EL050.cbl
 16460
 16461     IF PB-COMPANY-ID = 'BOA'
 16462         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16463         GO TO 3770-CHECK-REFUNDS.
 16464
 16465     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16466*    MOVE ' '                    TO DC-OPTION-CODE
 16467     SET BIN-TO-GREG             TO TRUE
 16468     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16469     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16470                                    PB-C-AH-REM-TERM.
 16471     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16472     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16473
 16474     IF PB-COMPANY-ID EQUAL 'FLC'
 16475        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16476           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16477           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16478                    - CM-AH-ITD-AH-PMT)
 16479           IF PB-C-AH-REF-CALC LESS THAN +0
 16480              MOVE +0            TO PB-C-AH-REF-CALC
 16481              GO TO 3770-CHECK-REFUNDS
 16482           ELSE
 16483              GO TO 3770-CHECK-REFUNDS.
 16484
 16485     IF PB-COMPANY-ID = 'DCC'
 16486        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16487            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16488           MOVE 'S'              TO CP-EARNING-METHOD
 16489        END-IF
 16490     END-IF
 16491     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16492                            OR '4' OR '5' OR '6' OR '8'
 16493                            OR '9' OR 'G' OR 'S'
 16494        MOVE PB-C-AH-REFUND-OVERRIDE
 16495                                 TO CP-EARNING-METHOD.
 16496
 16497     if pb-company-id = 'AHL'
 16498        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16499        if cp-class-code = spaces
 16500           move zeros            to cp-class-code
 16501        end-if
 16502     ELSE
 16503        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16504     END-IF
 16505*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16506     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16507     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16508                                    CP-RATING-BENEFIT-AMT.
 16509     IF CP-STATE-STD-ABBRV = 'OR'
 16510         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16511                                         PB-CI-AH-TERM.
 16512     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16513     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16514     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16515     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16516     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16517     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 297
* EL050.cbl
 16518
 16519     IF CP-STATE-STD-ABBRV = 'OH'
 16520        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16521                                AND 'CID' AND 'DCC' and 'VPP'
 16522                                AND 'AHL')
 16523           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16524              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16525              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16526              MOVE '6' TO CP-EARNING-METHOD
 16527           END-IF
 16528        END-IF
 16529        IF PB-COMPANY-ID = 'CID'
 16530           IF NO-LIFE-COVERAGE
 16531              IF CP-CRITICAL-PERIOD
 16532                 MOVE '2'       TO CP-EARNING-METHOD
 16533              ELSE
 16534                 MOVE '6'       TO CP-EARNING-METHOD
 16535              END-IF
 16536           ELSE
 16537              IF WS-LF-COVERAGE-TYPE = 'L'
 16538                 MOVE '2'       TO CP-EARNING-METHOD
 16539              ELSE
 16540                 IF (PB-CI-LF-TERM > +60) OR
 16541                    (WS-LF-EARNINGS-CALC = '5')
 16542                    IF CP-CRITICAL-PERIOD
 16543                       MOVE '2'  TO CP-EARNING-METHOD
 16544                    ELSE
 16545                       MOVE '6'  TO CP-EARNING-METHOD
 16546                    END-IF
 16547                 ELSE
 16548                    MOVE '1'     TO CP-EARNING-METHOD
 16549                 END-IF
 16550              END-IF
 16551           END-IF
 16552        END-IF
 16553     END-IF
 16554
 16555*    IF CP-STATE-STD-ABBRV = 'VA'
 16556*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16557*          IF CP-ORIGINAL-TERM GREATER 61
 16558*             MOVE '6' TO CP-EARNING-METHOD
 16559*          ELSE
 16560*             MOVE '1' TO CP-EARNING-METHOD.
 16561
 16562     IF WS-DEFAULT-APR NOT NUMERIC
 16563         MOVE ZEROS TO WS-DEFAULT-APR.
 16564     IF CP-EARN-AS-NET-PAY
 16565         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16566            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16567                MOVE WS-DEFAULT-APR
 16568                                 TO  CP-LOAN-APR
 16569                MOVE ER-3780     TO  WS-ERROR
 16570                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16571            ELSE
 16572                MOVE ER-3781     TO  WS-ERROR
 16573                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16574     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16575     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 298
* EL050.cbl
 16576        AND CP-CANCEL-REASON = 'R'
 16577        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16578        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16579     END-IF
 16580     IF PB-COMPANY-ID = 'DCC'
 16581        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16582        AND (CP-EARNING-METHOD = 'D')
 16583        AND (CP-CANCEL-REASON NOT = 'R')
 16584        CONTINUE
 16585     ELSE
 16586        GO TO 3750-CONTINUE
 16587     END-IF
 16588     MOVE ' '                    TO DD-IU-SW
 16589     IF NOT PDEF-MASTER-FOUND
 16590        MOVE ' '                 TO PDEF-MASTER-SW
 16591        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16592        MOVE PB-STATE            TO ERPDEF-STATE
 16593        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16594           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16595        END-IF
 16596        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16597        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16598        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16599        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16600        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16601        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16602        IF PDEF-MASTER-FOUND
 16603           MOVE 'N'              TO PDEF-MASTER-SW
 16604           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16605           IF PDEF-MASTER-FOUND
 16606              IF (ERPDEF-KEY-SAVE (1:16) =
 16607                           PD-CONTROL-PRIMARY (1:16))
 16608                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16609                 CONTINUE
 16610              ELSE
 16611                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16612                 IF (ERPDEF-KEY-SAVE (1:16) =
 16613                           PD-CONTROL-PRIMARY (1:16))
 16614                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16615                    CONTINUE
 16616                 ELSE
 16617                    MOVE ER-2740 TO WS-ERROR
 16618                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16619                    GO TO 3770-CHECK-REFUNDS
 16620                 END-IF
 16621              END-IF
 16622           END-IF
 16623           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16624        END-IF
 16625     END-IF
 16626     IF PDEF-MASTER-FOUND
 16627        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16628           (V1 > +8)
 16629           OR (PD-PROD-CODE (V1) = 'I')
 16630        END-PERFORM
 16631        IF V1 < +9
 16632           SET DD-IU-PRESENT        TO TRUE
 16633        END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 299
* EL050.cbl
 16634        IF WS-AH-DCC-TRUNC = 'T'
 16635           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16636        ELSE
 16637           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16638        END-IF
 16639        EVALUATE TRUE
 16640           WHEN WS-TERM > +168
 16641              MOVE 15               TO V1
 16642           WHEN WS-TERM > +156
 16643              MOVE 14               TO V1
 16644           WHEN WS-TERM > +144
 16645              MOVE 13               TO V1
 16646           WHEN WS-TERM > +132
 16647              MOVE 12               TO V1
 16648           WHEN WS-TERM > +120
 16649              MOVE 11               TO V1
 16650           WHEN WS-TERM > +108
 16651              MOVE 10               TO V1
 16652           WHEN WS-TERM > +96
 16653              MOVE 9                TO V1
 16654           WHEN WS-TERM > +84
 16655              MOVE 8                TO V1
 16656           WHEN WS-TERM > +72
 16657              MOVE 7                TO V1
 16658           WHEN WS-TERM > +60
 16659              MOVE 6                TO V1
 16660           WHEN WS-TERM > +48
 16661              MOVE 5                TO V1
 16662           WHEN WS-TERM > +36
 16663              MOVE 4                TO V1
 16664           WHEN WS-TERM > +24
 16665              MOVE 3                TO V1
 16666           WHEN WS-TERM > +12
 16667              MOVE 2                TO V1
 16668           WHEN OTHER
 16669              MOVE 1                TO V1
 16670        END-EVALUATE
 16671
 16672        EVALUATE TRUE
 16673*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16674*             < +13)
 16675*             AND (DD-IU-PRESENT)
 16676*             MOVE 2                TO V2
 16677*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16678*             MOVE 1                TO V2
 16679           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16680              MOVE 2                TO V2
 16681           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16682              MOVE 3                TO V2
 16683           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16684              MOVE 4                TO V2
 16685           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16686              MOVE 5                TO V2
 16687           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16688              MOVE 6                TO V2
 16689           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16690              MOVE 7                TO V2
 16691           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 300
* EL050.cbl
 16692              MOVE 8                TO V2
 16693           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16694              MOVE 9                TO V2
 16695           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16696              MOVE 10               TO V2
 16697           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16698              MOVE 11               TO V2
 16699           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16700              MOVE 12               TO V2
 16701           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16702              MOVE 13               TO V2
 16703           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16704              MOVE 14               TO V2
 16705           WHEN OTHER
 16706              MOVE 15               TO V2
 16707        END-EVALUATE
 16708
 16709        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16710                                 TO CP-DDF-LO-FACT
 16711        MOVE PD-UEP-FACTOR (V1 V2)
 16712                                 TO CP-DDF-HI-FACT
 16713
 16714        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16715        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16716        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16717           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16718        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16719        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16720        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16721           + PD-1ST-YR-ADMIN-ALLOW
 16722
 16723        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16724*       IF PI-CLP-YN = 'Y'
 16725*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16726*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16727*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16728*       END-IF
 16729
 16730        IF DD-IU-PRESENT
 16731           MOVE 'I'              TO CP-EARNING-METHOD
 16732        END-IF
 16733        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16734                                     CP-CLP-RATE-UP
 16735        IF CP-IU-RATE-UP NOT = ZEROS
 16736           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16737              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16738           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16739              / (1 - WS-WORK-FACT)
 16740        END-IF
 16741     END-IF
 16742     .
 16743 3750-CONTINUE.
 16744     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16745
 16746     IF CP-REFUND-TYPE-USED NOT = SPACE
 16747         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16748
 16749     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 301
* EL050.cbl
 16750        CP-ERROR-RATE-NOT-FOUND
 16751        MOVE ER-2740             TO WS-ERROR
 16752        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16753
 16754     IF CP-ERROR-RATE-FILE-NOTOPEN
 16755        MOVE ER-2617             TO WS-ERROR
 16756        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16757     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16758        AND (PB-CI-ENTRY-STATUS = 'M')
 16759        MOVE +0                  TO PB-C-AH-REF-CALC
 16760     ELSE
 16761        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16762     END-IF
 16763     if pb-company-id = 'VPP'
 16764        MOVE cm-ah-clp           to cp-original-premium
 16765        move zeros               to cp-calc-refund
 16766        perform 7600-get-refund  thru 7600-exit
 16767        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 16768           move cp-calc-refund   to pb-c-ah-rfnd-clp
 16769        else
 16770           move zeros            to pb-c-ah-rfnd-clp
 16771        end-if
 16772        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 16773           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 16774           pb-ci-cancel-fee
 16775     end-if
 16776     IF PB-COMPANY-ID = 'DCC'
 16777        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16778        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16779        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16780        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16781        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16782        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16783        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16784        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16785*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16786     END-IF
 16787     .
 16788 3770-CHECK-REFUNDS.
 16789
 16790     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16791        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16792           MOVE ER-2766          TO WS-ERROR
 16793           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16794           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16795           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16796              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16797
 16798     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16799        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16800           MOVE ER-2766          TO WS-ERROR
 16801           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16802           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16803           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16804              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16805
 16806     IF PB-COMP-LF-CANCEL
 16807        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 302
* EL050.cbl
 16808        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16809           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16810              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16811
 16812     IF PB-COMP-AH-CANCEL
 16813        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16814        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16815           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16816              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16817
 16818     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16819             GIVING WS-UNSIGN-WRK1
 16820     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16821             GIVING WS-UNSIGN-WRK2.
 16822
 16823     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16824         MOVE ZERO TO WS-UNSIGN-WRK1.
 16825
 16826     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16827         MOVE ZERO TO WS-UNSIGN-WRK2.
 16828
 16829     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16830
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 303
* EL050.cbl
 16832
 16833 3772-CONTINUE.
 16834
 16835**********************************
 16836*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16837*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16838*** DOUBLES THE TOLERANCE AMOUNT.
 16839***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16840**********************************
 16841     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 16842     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16843         IF WS-REF-REJECT-SW = SPACE
 16844             MOVE ER-2754        TO WS-ERROR
 16845             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16846           ELSE
 16847             MOVE ER-2736        TO WS-ERROR
 16848             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16849**********************************
 16850
 16851 3773-CONTINUE.
 16852
 16853     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16854        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16855           MOVE ER-2723          TO WS-ERROR
 16856           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16857
 16858     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16859        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16860           MOVE ER-2724          TO WS-ERROR
 16861           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16862
 16863     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16864         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16865             (1 + WS-LF-REFUND-OVS-PCT)
 16866     ELSE
 16867         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16868
 16869     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16870         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16871             (1 - WS-TOL-LF-REFUND-PCT)
 16872     ELSE
 16873         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16874
 16875     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16876        AND (PB-CI-ENTRY-STATUS = 'M')
 16877        AND (PB-C-LF-CANCEL-AMT > +0)
 16878        MOVE ER-3843             TO WS-ERROR
 16879        PERFORM 9900-ERROR-FORMAT
 16880                                 THRU 9900-EXIT
 16881     END-IF
 16882     EVALUATE TRUE
 16883        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16884           CONTINUE
 16885        WHEN PB-C-LF-CANCEL-AMT = +0
 16886                 AND PB-C-LF-REF-CALC > +0
 16887           CONTINUE
 16888        WHEN WS-LF-REFUND-OVS-AMT = 0
 16889                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 304
* EL050.cbl
 16890           CONTINUE
 16891        WHEN OTHER
 16892           IF WS-TOL-LF-REFUND  = +0
 16893              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16894           END-IF
 16895           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16896                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16897                          (PB-C-LF-CANCEL-AMT))
 16898              CONTINUE
 16899           ELSE
 16900              IF WS-LF-REFUND-OVS-AMT = +0
 16901                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16902              END-IF
 16903              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16904                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16905                                       PB-C-LF-CANCEL-AMT)
 16906                 CONTINUE
 16907              ELSE
 16908                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16909                   MOVE ER-2754   TO  WS-ERROR
 16910                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16911                 ELSE
 16912                    MOVE ER-2736   TO  WS-ERROR
 16913                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16914                 END-IF
 16915              END-IF
 16916           END-IF
 16917     END-EVALUATE.
 16918
 16919     EVALUATE TRUE
 16920        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16921           CONTINUE
 16922        WHEN PB-C-LF-CANCEL-AMT = +0
 16923                 AND PB-C-LF-REF-CALC > +0
 16924           CONTINUE
 16925        WHEN OTHER
 16926           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16927               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16928              CONTINUE
 16929           ELSE
 16930              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16931               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16932                CONTINUE
 16933              ELSE
 16934                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16935                     MOVE ER-2754   TO  WS-ERROR
 16936                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16937                 ELSE
 16938                     MOVE ER-2736   TO  WS-ERROR
 16939                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16940                 END-IF
 16941              END-IF
 16942           END-IF
 16943     END-EVALUATE.
 16944
 16945     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16946         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16947             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 305
* EL050.cbl
 16948     ELSE
 16949         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16950
 16951     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16952         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16953             (1 - WS-TOL-AH-REFUND-PCT)
 16954     ELSE
 16955         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16956
 16957     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16958        AND (PB-CI-ENTRY-STATUS = 'M')
 16959        AND (PB-C-AH-CANCEL-AMT > +0)
 16960        MOVE ER-3843             TO WS-ERROR
 16961        PERFORM 9900-ERROR-FORMAT
 16962                                 THRU 9900-EXIT
 16963     END-IF
 16964     EVALUATE TRUE
 16965        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16966           CONTINUE
 16967*       WHEN PB-C-AH-REF-CALC = +0 AND
 16968*                  PB-C-AH-CANCEL-AMT > +0
 16969        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16970                   PB-C-AH-REF-CALC > +0
 16971           CONTINUE
 16972        WHEN WS-AH-REFUND-OVS-AMT = +0
 16973                AND WS-TOL-AH-REFUND = +0
 16974           CONTINUE
 16975        WHEN OTHER
 16976           IF WS-TOL-AH-REFUND = +0
 16977              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16978           END-IF
 16979           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16980               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16981                                         PB-C-AH-CANCEL-AMT)
 16982              CONTINUE
 16983           ELSE
 16984              IF WS-AH-REFUND-OVS-AMT = +0
 16985                 MOVE +9999999.99 TO
 16986                         WS-AH-REFUND-OVS-AMT
 16987              END-IF
 16988              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16989                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16990                                         PB-C-AH-CANCEL-AMT)
 16991                 CONTINUE
 16992              ELSE
 16993                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16994                    MOVE ER-2754   TO  WS-ERROR
 16995                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16996                 ELSE
 16997                    MOVE ER-2736   TO  WS-ERROR
 16998                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16999                 END-IF
 17000              END-IF
 17001           END-IF
 17002     END-EVALUATE.
 17003
 17004     EVALUATE TRUE
 17005        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 306
* EL050.cbl
 17006           CONTINUE
 17007*       WHEN PB-C-AH-REF-CALC > +0 AND
 17008*                  PB-C-AH-CANCEL-AMT = +0
 17009        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17010                   PB-C-AH-REF-CALC = +0
 17011           CONTINUE
 17012        WHEN OTHER
 17013           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17014               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17015              CONTINUE
 17016           ELSE
 17017              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17018                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17019                 CONTINUE
 17020              ELSE
 17021                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17022                     MOVE ER-2754   TO  WS-ERROR
 17023                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17024                 ELSE
 17025                     MOVE ER-2736   TO  WS-ERROR
 17026                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17027                 END-IF
 17028              END-IF
 17029           END-IF
 17030     END-EVALUATE.
 17031
 17032     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17033        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17034        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17035           AND  PB-C-LF-REF-CALC < +1.00
 17036           AND  PB-C-AH-REF-CALC < +1.00
 17037           CONTINUE
 17038        ELSE
 17039           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17040              AND (PB-CI-ENTRY-STATUS = 'M')
 17041              CONTINUE
 17042           ELSE
 17043              MOVE ER-2741       TO WS-ERROR
 17044              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17045           END-IF
 17046        END-IF
 17047     END-IF
 17048
 17049     IF (PB-C-LF-CANCEL-AMT = ZERO
 17050        AND WS-LF-BENEFIT-CD NOT = ZERO
 17051        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17052        AND PB-C-LF-REF-CALC NOT = ZERO)
 17053        OR
 17054        (PB-C-LF-CANCEL-AMT = ZERO
 17055        AND WS-LF-BENEFIT-CD NOT = ZERO
 17056        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17057             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17058                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17059                NEXT SENTENCE
 17060             ELSE
 17061                MOVE ER-2739        TO WS-ERROR
 17062                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17063
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 307
* EL050.cbl
 17064     IF (PB-C-AH-CANCEL-AMT = ZERO
 17065        AND WS-AH-BENEFIT-CD NOT = ZERO
 17066        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17067        AND PB-C-AH-REF-CALC NOT = ZERO)
 17068        OR
 17069        (PB-C-AH-CANCEL-AMT = ZERO
 17070        AND WS-AH-BENEFIT-CD NOT = ZERO
 17071        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17072             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17073                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17074                NEXT SENTENCE
 17075             ELSE
 17076                MOVE ER-2738        TO WS-ERROR
 17077                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17078
 17079 3775-OVER-REF-CHK.
 17080
 17081     IF PB-CI-ENTRY-STATUS = '5'
 17082        GO TO 3780-UPDATE-CANCEL-CERT.
 17083
 17084     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17085                              PB-CI-LF-ALT-PREMIUM-AMT.
 17086
 17087     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17088        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17089                                 PB-C-LF-REF-CALC
 17090      ELSE
 17091        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17092                                 PB-C-LF-CANCEL-AMT.
 17093
 17094     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17095        MOVE ER-2755             TO WS-ERROR
 17096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17097
 17098     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17099
 17100     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17101        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17102                                 PB-C-AH-REF-CALC
 17103      ELSE
 17104        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17105                                 PB-C-AH-CANCEL-AMT.
 17106
 17107     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17108        MOVE ER-2778             TO WS-ERROR
 17109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17110
 17111     IF PB-CI-OB-FLAG NOT = 'Z'
 17112        NEXT SENTENCE
 17113       ELSE
 17114         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17115            MOVE ER-2757           TO WS-ERROR
 17116            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17117
 17118 3780-UPDATE-CANCEL-CERT.
 17119
 17120     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17121        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 308
* EL050.cbl
 17122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17123
 17124     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17125         MOVE ER-2729              TO WS-ERROR
 17126         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17127
 17128     IF PB-CI-LF-BENEFIT-CD = ZERO
 17129         GO TO 3780-UPDATE-CONT-1.
 17130
 17131     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17132         GO TO 3780-UPDATE-CONT-1.
 17133
 17134     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17135       AND
 17136        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17137       AND
 17138        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17139       AND
 17140        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17141            NEXT SENTENCE
 17142       ELSE
 17143        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17144          AND
 17145***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17146***       AND
 17147           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17148            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17149               MOVE ER-2730      TO WS-ERROR
 17150               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17151               GO TO 3999-END-EDIT
 17152            ELSE
 17153               GO TO 3999-END-EDIT
 17154        ELSE
 17155            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17156               MOVE ER-2765           TO WS-ERROR
 17157               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17158               GO TO 3785-CHECK-NH.
 17159*              GO TO 3999-END-EDIT.
 17160
 17161 3780-UPDATE-CONT-1.
 17162     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17163
 17164     IF PB-CI-AH-BENEFIT-CD = ZERO
 17165         GO TO 3780-UPDATE-CONT-2.
 17166
 17167     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17168         GO TO 3780-UPDATE-CONT-2.
 17169
 17170     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17171
 17172     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17173       AND
 17174        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17175       AND
 17176        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17177       AND
 17178        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17179            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 309
* EL050.cbl
 17180       ELSE
 17181        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17182          AND
 17183***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17184***       AND
 17185           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17186           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17187            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17188               MOVE ER-2773      TO WS-ERROR
 17189               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17190               GO TO 3999-END-EDIT
 17191            ELSE
 17192               GO TO 3999-END-EDIT
 17193            END-IF
 17194           ELSE
 17195             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17196                IF MSTR-CERT-NO = W-CL-CERT-NO
 17197                   MOVE ER-2890 TO WS-ERROR
 17198                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17199                   GO TO 3999-END-EDIT
 17200                ELSE
 17201                   MOVE ER-2898 TO WS-ERROR
 17202                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17203                   GO TO 3999-END-EDIT
 17204                END-IF
 17205             ELSE
 17206                GO TO 3785-CHECK-NH
 17207             END-IF
 17208           END-IF
 17209          ELSE
 17210            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17211              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17212                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17213                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17214                      MOVE ER-2890 TO WS-ERROR
 17215                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17216                      GO TO 3999-END-EDIT
 17217                   ELSE
 17218                      MOVE ER-2898 TO WS-ERROR
 17219                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17220                      GO TO 3999-END-EDIT
 17221                   END-IF
 17222                ELSE
 17223                   MOVE ER-2765 TO WS-ERROR
 17224                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17225                   GO TO 3785-CHECK-NH
 17226                END-IF
 17227              ELSE
 17228               MOVE ER-2765      TO WS-ERROR
 17229               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17230               GO TO 3785-CHECK-NH.
 17231*              GO TO 3999-END-EDIT.
 17232
 17233 3780-UPDATE-CONT-2.
 17234
 17235     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17236        AND WS-LF-BENEFIT-CD = ZERO
 17237           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 310
* EL050.cbl
 17238           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17239
 17240     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17241        AND WS-AH-BENEFIT-CD = ZERO
 17242           MOVE ER-2744           TO WS-ERROR
 17243           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17244
 17245     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17246        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17247        AND
 17248        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17249         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17250           MOVE ER-2746           TO WS-ERROR
 17251           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17252
 17253     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17254       AND
 17255        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17256             MOVE ER-2737        TO WS-ERROR
 17257             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17258
 17259     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17260       AND
 17261        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17262             MOVE ER-2737        TO WS-ERROR
 17263             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17264
 17265     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17266         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17267             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17268             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17269         ELSE
 17270             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17271                 MOVE ER-2768    TO WS-ERROR
 17272                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17273             ELSE
 17274                 MOVE ER-2756    TO WS-ERROR
 17275                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17276
 17277     IF CERT-PEND-ISSUE-RETURNED
 17278        MOVE ER-2772             TO WS-ERROR
 17279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17280 3785-CHECK-NH.
 17281*    IF PB-STATE NOT = 'NH' and 'TN'
 17282     IF PB-STATE NOT = 'NH'
 17283        GO TO 3999-END-EDIT
 17284     END-IF
 17285
 17286     MOVE ER-2796                TO WS-ERROR
 17287     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17288     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17289        OR (CM-NH-INTERFACE-SW = 'Y')
 17290        MOVE ER-2793             TO WS-ERROR
 17291        PERFORM 9900-ERROR-FORMAT
 17292                                 THRU 9900-EXIT
 17293     END-IF
 17294     MOVE +0                     TO WS-PAYMENT-AMT
 17295     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 311
* EL050.cbl
 17296        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17297               PB-C-AH-CANCEL-DT
 17298           GO TO 3999-END-EDIT
 17299        END-IF
 17300     end-if
 17301***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17302***-_-
 17303***-_-   For TN it's only flat cancels
 17304***-_-
 17305***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17306     if pb-state = 'TN'
 17307        if ((pb-c-lf-cancel-dt <> low-values)
 17308           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17309                      or
 17310           ((pb-c-ah-cancel-dt <> low-values)
 17311           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17312           GO TO 3999-END-EDIT
 17313        END-IF
 17314     end-if
 17315     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17316        GO TO 3999-END-EDIT
 17317     END-IF
 17318***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17319***-_-
 17320***-_-   if cancel date within 15 days of effective date, bypass
 17321***-_-
 17322***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17323     IF PB-STATE NOT = 'NH'
 17324        GO TO 3785-CONTINUE
 17325     END-IF
 17326     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17327     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17328     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17329        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17330     END-IF
 17331     MOVE '1'                    TO DC-OPTION-CODE
 17332     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17333     IF NO-CONVERSION-ERROR
 17334        IF DC-ELAPSED-DAYS < +16
 17335           GO TO 3999-END-EDIT
 17336        END-IF
 17337     END-IF
 17338***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17339***-_-
 17340***-_-   if cancel date within 30 days of current date then
 17341***-_-   bypass else subtract 15 days from period
 17342***-_-
 17343***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17344     MOVE +0                     TO DC-ELAPSED-DAYS
 17345     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17346     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17347     MOVE '1'                    TO DC-OPTION-CODE
 17348     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17349     IF NO-CONVERSION-ERROR
 17350        IF DC-ELAPSED-DAYS > +30
 17351           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17352        ELSE
 17353           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 312
* EL050.cbl
 17354        END-IF
 17355     ELSE
 17356        GO TO 3999-END-EDIT
 17357     END-IF
 17358     .
 17359 3785-CONTINUE.
 17360     if pb-state = 'TN'
 17361        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17362        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17363        MOVE '1'                 TO DC-OPTION-CODE
 17364        PERFORM 8500-DATE-CONVERT
 17365                                 THRU 8500-EXIT
 17366        IF no-CONVERSION-ERROR
 17367           IF DC-ELAPSED-DAYS < +16
 17368              GO TO 3999-END-EDIT
 17369           END-IF
 17370        END-IF
 17371     end-if
 17372***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17373***-_-
 17374***-_-   'NH' is 10%, TN is 3.5%
 17375***-_-
 17376***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17377     if pb-state = 'NH'
 17378        move +1.10               to ws-work-rate
 17379     else
 17380        move +1.035              to ws-work-rate
 17381     end-if
 17382     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17383        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17384           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17385     IF WS-PAYMENT-AMT < 600.00
 17386        GO TO 3999-END-EDIT
 17387     END-IF
 17388     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17389
 17390     IF (ERMAIL-FOUND = ' ')
 17391         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17392         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17393        GO TO 3999-END-EDIT
 17394     END-IF
 17395     MOVE ER-2795                TO WS-ERROR
 17396     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17397
 17398     GO TO 3999-END-EDIT.
 17399******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 313
* EL050.cbl
 17401 3990-FILES-NOT-OPEN.
 17402
 17403     MOVE ER-2617                TO WS-ERROR.
 17404     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17405     GO TO 9990-RETURN.
 17406
 17407 3999-END-EDIT.
 17408
 17409     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17410
 17411     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17412         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17413         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17414             PERFORM 9250-UNLOCK-RETURN
 17415             GO TO 9990-RETURN
 17416          ELSE
 17417             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17418             GO TO 9990-RETURN.
 17419
 17420     IF PB-CANCELLATION
 17421          GO TO 9990-RETURN.
 17422
 17423     IF CERT-WAS-NOT-FOUND
 17424        MOVE SPACES              TO CERTIFICATE-MASTER.
 17425
 17426     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17427
 17428     IF CERT-WAS-FOUND
 17429         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17430             PERFORM 9250-UNLOCK-RETURN
 17431          ELSE
 17432            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17433      ELSE
 17434         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17435
 17436*    if pb-company-id = 'VPP'
 17437*       perform 8150-read-elcrtt thru 8150-exit
 17438*       if ws-vehicle-odometer numeric
 17439*          if ws-vehicle-odometer > 6000
 17440*             move er-1583       to ws-error
 17441*             PERFORM 9900-ERROR-FORMAT
 17442*                                THRU 9900-EXIT
 17443*          end-if
 17444*       end-if
 17445*    end-if
 17446     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17447        IF ((PB-COMPANY-ID = 'DCC')
 17448           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17449                         or
 17450            (pb-company-id = 'CID' or 'VPP')
 17451            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17452        END-IF
 17453     END-IF.
 17454
 17455     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17456         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17457     END-IF.
 17458     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 314
* EL050.cbl
 17459     perform 8150-read-elcrtt    thru 8150-exit
 17460     if ws-ins-age-defaulted = 'Y'
 17461        move er-1573             to ws-error
 17462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17463     end-if
 17464
 17465     if ws-jnt-age-defaulted = 'Y'
 17466        move er-1574             to ws-error
 17467        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17468     end-if
 17469***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17470***                                                           ****
 17471***  Set an error if the state requires verification of agent ****
 17472***  and agent hasn't verified yet and the status is not =    ****
 17473***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17474***  and the entry date > 09/01/2015.                         ****
 17475***                                                           ****
 17476***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17477     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17478        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17479        and (pb-account (9:2) not = 'OB')
 17480        if (ws-st-agent-sig-edit = 'Y')
 17481           and (am-report-code-1 not = 'CONLEY')
 17482           evaluate true
 17483              when cs-agent-edit-status = 'C'
 17484                 move er-1743    to ws-error
 17485                 perform 9900-error-format
 17486                                 thru 9900-exit
 17487              when cs-agent-edit-status = 'S'
 17488                 move er-1744    to ws-error
 17489                 perform 9900-error-format
 17490                                 thru 9900-exit
 17491              when cs-agent-edit-status = 'M'
 17492                 move er-1745    to ws-error
 17493                 perform 9900-error-format
 17494                                 thru 9900-exit
 17495              when cs-agent-edit-status = 'R'
 17496                 move er-1747    to ws-error
 17497                 perform 9900-error-format
 17498                                 thru 9900-exit
 17499              when cs-agent-edit-status = 'N'
 17500                 move er-1748    to ws-error
 17501                 perform 9900-error-format
 17502                                 thru 9900-exit
 17503              when cs-agent-edit-status <> 'V' and 'U' and
 17504                                           'R' and 'N'
 17505                 move er-1746    to ws-error
 17506                 perform 9900-error-format
 17507                                 thru 9900-exit
 17508           end-evaluate
 17509        end-if
 17510     end-if
 17511     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17512     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17513        AND (WS-NO-SECURE-PAY))
 17514                  OR
 17515        (WS-LF-SPECIAL-CALC-CD = 'O'
 17516        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 315
* EL050.cbl
 17517        SET SKIP-ADDR-EDIT       TO TRUE
 17518     END-IF
 17519     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17520        AND (NOT SKIP-ADDR-EDIT)
 17521        MOVE ER-2963             TO WS-ERROR
 17522        PERFORM 9900-ERROR-FORMAT
 17523                                 THRU 9900-EXIT
 17524        GO TO 9990-RETURN
 17525     END-IF
 17526     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17527     IF ERPNDM-FOUND NOT = 'X'
 17528        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17529           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17530           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17531           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17532           AND (NOT SKIP-ADDR-EDIT)
 17533           MOVE ER-2694          TO WS-ERROR
 17534           PERFORM 9900-ERROR-FORMAT
 17535                                 THRU 9900-EXIT
 17536        END-IF
 17537        MOVE ' '                 TO STATE-RECORD-ERROR
 17538        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17539        MOVE PM-STATE            TO CNTL-ACCESS
 17540        MOVE '3'                 TO CNTL-REC-TYPE
 17541        MOVE +0                  TO CNTL-SEQ-NO
 17542        MOVE '0'                 TO RC-SW-2
 17543        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17544        IF (NO-STATE-RECORD)
 17545           OR (CF-RECORD-TYPE NOT = '3')
 17546           OR (PM-STATE NOT = CF-STATE-CODE)
 17547           IF (PM-STATE = SPACES)
 17548              AND (SKIP-ADDR-EDIT)
 17549              CONTINUE
 17550           ELSE
 17551              MOVE ER-2963       TO WS-ERROR
 17552              PERFORM 9900-ERROR-FORMAT
 17553                                 THRU 9900-EXIT
 17554           END-IF
 17555        END-IF
 17556        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17557           MOVE ER-2883          TO WS-ERROR
 17558           PERFORM 9900-ERROR-FORMAT
 17559                                 THRU 9900-EXIT
 17560        END-IF
 17561        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17562           MOVE ' '                 TO STATE-RECORD-ERROR
 17563           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17564           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17565           MOVE '3'                 TO CNTL-REC-TYPE
 17566           MOVE +0                  TO CNTL-SEQ-NO
 17567           MOVE '0'                 TO RC-SW-2
 17568           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17569           IF NO-STATE-RECORD
 17570              OR (CF-RECORD-TYPE NOT = '3')
 17571              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17572              MOVE ER-2964          TO WS-ERROR
 17573              PERFORM 9900-ERROR-FORMAT
 17574                                    THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 316
* EL050.cbl
 17575           END-IF
 17576        END-IF
 17577     ELSE
 17578        IF NOT SKIP-ADDR-EDIT
 17579           MOVE ER-2393          TO WS-ERROR
 17580           PERFORM 9900-ERROR-FORMAT
 17581                                 THRU 9900-EXIT
 17582        END-IF
 17583     END-IF
 17584
 17585     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17586
 17587     IF (ERMAIL-FOUND = ' ' AND
 17588        ERPNDM-FOUND = ' ')
 17589        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17590           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17591           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17592          OR
 17593           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17594          OR
 17595           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17596           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17597           GO TO 3999-UNLOCK-ERMAIL.
 17598
 17599     IF ERPNDM-FOUND = 'X'
 17600        GO TO 3999-UNLOCK-ERMAIL.
 17601
 17602     IF PM-INSURED-LAST-NAME      = SPACES
 17603        AND PM-INSURED-FIRST-NAME = SPACES
 17604        AND PM-ADDRESS-LINE-1     = SPACES
 17605        AND PM-ADDRESS-LINE-2     = SPACES
 17606        AND PM-CITY-STATE         = SPACES
 17607        AND PM-CRED-BENE-NAME     = SPACES
 17608        AND PM-CRED-BENE-ADDR     = SPACES
 17609        AND PM-CRED-BENE-CTYST    = SPACES
 17610        GO TO 3999-UNLOCK-ERMAIL
 17611     END-IF
 17612
 17613     MOVE SPACES                 TO MAILING-DATA.
 17614
 17615     MOVE 'MA'                   TO MA-RECORD-ID.
 17616     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17617     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17618     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17619     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17620     MOVE PB-SV-STATE            TO MA-STATE.
 17621     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17622     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17623
 17624     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17625     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17626
 17627     IF ERMAIL-FOUND = ' '
 17628        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17629     ELSE
 17630        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17631        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17632        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 317
* EL050.cbl
 17633
 17634     GO TO 9990-RETURN.
 17635
 17636 3999-UNLOCK-ERMAIL.
 17637     IF ERMAIL-FOUND = ' '
 17638        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17639
 17640     GO TO 9990-RETURN.
 17641******************************************************************
 17642
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 318
* EL050.cbl
 17644 4000-UPDATE-CANCELLED-CERT.
 17645     IF CERT-WAS-NOT-FOUND
 17646        GO TO 4299-EXIT.
 17647
 17648*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17649     IF PB-C-NH-INT-ON-REFS > ZEROS
 17650        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17651     END-IF
 17652     IF PB-C-REF-INTERFACE-SW = 'Y'
 17653        MOVE PB-C-REF-INTERFACE-SW
 17654                                 TO CM-NH-INTERFACE-SW
 17655     END-IF
 17656     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17657     IF ERMAIL-FOUND = 'X'
 17658        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17659        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17660        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17661        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17662           MOVE ER-2694          TO WS-ERROR
 17663           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17664     END-IF
 17665
 17666     IF PB-C-POST-CARD-IND = 'Y'
 17667        MOVE +8                  TO SUB
 17668*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17669        IF ERMAIL-FOUND = ' '
 17670           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17671              (SUB > +7)
 17672              OR (MA-MAIL-STATUS (SUB) = '1')
 17673           END-PERFORM
 17674        END-IF
 17675        IF (SUB > +7)
 17676           OR (ERMAIL-FOUND = 'X')
 17677           MOVE ER-3789          TO WS-ERROR
 17678           PERFORM 9900-ERROR-FORMAT
 17679                                 THRU 9900-EXIT
 17680        END-IF
 17681     ELSE
 17682        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17683     END-IF
 17684
 17685     IF ERMAIL-FOUND = ' '
 17686        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17687     END-IF.
 17688
 17689     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17690
 17691     IF PB-CI-OB-FLAG = 'Z'
 17692        GO TO 4150-SUMMARY-CERT-CANCEL.
 17693
 17694     IF PB-C-LF-CANCEL-VOIDED
 17695         PERFORM 4200-REVERSE-LF-CANCEL.
 17696     IF PB-C-AH-CANCEL-VOIDED
 17697         PERFORM 4200-REVERSE-AH-CANCEL.
 17698
 17699 4100-APPLY-LF-CANCEL.
 17700
 17701     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 319
* EL050.cbl
 17702
 17703 4100-CHECK-LF-ERRORS.
 17704
 17705     ADD +1                       TO WS-SUB.
 17706
 17707     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17708        IF LF-COVERAGE-CANCELLED
 17709           GO TO 4100-LF-CANCEL-CONT
 17710        ELSE
 17711           GO TO 4100-UPDATE-LF-COVERAGE.
 17712
 17713     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17714                                   ER-2729 OR
 17715                                   ER-2730 OR
 17716                                   ER-2731 OR
 17717                                   ER-2732 OR
 17718                                   ER-2737 OR
 17719                                   ER-2740 OR
 17720                                   ER-2743 OR
 17721                                   ER-2749 OR
 17722                                   ER-2750 OR
 17723                                   ER-2755 OR
 17724                                   ER-2757 OR
 17725                                   ER-2760 OR
 17726                                   ER-2772 OR
 17727                                   ER-2774 OR
 17728                                   ER-2776 OR
 17729                                   ER-2794
 17730        GO TO 4100-UPDATE-LF-COVERAGE.
 17731
 17732     GO TO 4100-CHECK-LF-ERRORS.
 17733
 17734 4100-UPDATE-LF-COVERAGE.
 17735
 17736     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17737     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17738     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17739        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17740     END-IF
 17741     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17742                                      TO CM-CREDIT-INTERFACE-SW-2.
 17743     IF CM-LF-CANCEL-DT = LOW-VALUE
 17744         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17745
 17746     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17747         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17748                                         CM-LF-STATUS-AT-CANCEL.
 17749
 17750     GO TO 4100-APPLY-AH-CANCEL.
 17751
 17752 4100-LF-CANCEL-CONT.
 17753     IF PB-C-LF-CANCEL-VOIDED
 17754         GO TO 4100-APPLY-AH-CANCEL.
 17755
 17756     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17757         GO TO 4100-APPLY-AH-CANCEL.
 17758
 17759     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 320
* EL050.cbl
 17760        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17761           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17762        ELSE
 17763           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17764
 17765     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17766     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17767
 17768     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17769         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17770
 17771     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17772        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17773         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17774         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17775
 17776     IF PB-RECORD-RETURNED
 17777        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17778      ELSE
 17779        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17780
 17781 4100-APPLY-AH-CANCEL.
 17782
 17783     MOVE +0                      TO WS-SUB.
 17784
 17785 4100-CHECK-AH-ERRORS.
 17786
 17787     ADD +1                       TO WS-SUB.
 17788
 17789     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17790        IF AH-COVERAGE-CANCELLED
 17791           GO TO 4100-AH-CANCEL-CONT
 17792        ELSE
 17793           GO TO 4100-UPDATE-AH-COVERAGE.
 17794
 17795     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17796                                   ER-2729 OR
 17797                                   ER-2732 OR
 17798                                   ER-2737 OR
 17799                                   ER-2740 OR
 17800                                   ER-2744 OR
 17801                                   ER-2749 OR
 17802                                   ER-2750 OR
 17803                                   ER-2755 OR
 17804                                   ER-2757 OR
 17805                                   ER-2760 OR
 17806                                   ER-2771 OR
 17807                                   ER-2772 OR
 17808                                   ER-2773 OR
 17809                                   ER-2775 OR
 17810                                   ER-2777 OR
 17811                                   ER-2778 OR
 17812                                   ER-2794
 17813        GO TO 4100-UPDATE-AH-COVERAGE.
 17814
 17815     GO TO 4100-CHECK-AH-ERRORS.
 17816
 17817 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 321
* EL050.cbl
 17818
 17819     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17820     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17821     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17822     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17823                                      TO CM-CREDIT-INTERFACE-SW-2.
 17824     IF CM-AH-CANCEL-DT = LOW-VALUE
 17825         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17826
 17827     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17828         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17829                                         CM-AH-STATUS-AT-CANCEL.
 17830
 17831     IF LF-COVERAGE-CANCELLED
 17832         IF PB-RECORD-RETURNED
 17833              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17834          ELSE
 17835              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17836
 17837     GO TO 4299-EXIT.
 17838
 17839 4100-AH-CANCEL-CONT.
 17840     IF PB-C-AH-CANCEL-VOIDED
 17841         GO TO 4299-EXIT.
 17842
 17843     if cm-credit-interface-sw-2 = ' '
 17844        if pb-fatal-errors or pb-unforced-errors
 17845           move '4'              to cm-credit-interface-sw-2
 17846        else
 17847           move '1'              to cm-credit-interface-sw-2
 17848        end-if
 17849     end-if
 17850     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17851         GO TO 4299-EXIT.
 17852
 17853     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17854        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17855           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17856        ELSE
 17857           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17858
 17859     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17860     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17861
 17862     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17863         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17864
 17865     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17866         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17867         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17868
 17869     IF PB-RECORD-RETURNED
 17870        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17871      ELSE
 17872        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17873
 17874     GO TO 4299-EXIT.
 17875
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 322
* EL050.cbl
 17876 4150-SUMMARY-CERT-CANCEL.
 17877     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17878
 17879     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17880        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17881                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17882     ELSE
 17883        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17884                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17885
 17886     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17887        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17888                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17889     ELSE
 17890        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17891                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17892
 17893     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17894        NEXT SENTENCE
 17895     ELSE
 17896        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17897
 17898     GO TO 4299-EXIT.
 17899
 17900 4200-REVERSE-LF-CANCEL.
 17901     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17902
 17903     IF CM-LF-CANCEL-APPLIED
 17904        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17905        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17906        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17907
 17908     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17909
 17910     IF PB-RECORD-RETURNED
 17911        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17912       ELSE
 17913        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17914
 17915 4200-REVERSE-LF-EXIT.
 17916       EXIT.
 17917
 17918 4200-REVERSE-AH-CANCEL.
 17919     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17920
 17921     IF CM-AH-CANCEL-APPLIED
 17922        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17923        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17924        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17925
 17926     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17927
 17928     IF PB-RECORD-RETURNED
 17929        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17930       ELSE
 17931        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17932
 17933 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 323
* EL050.cbl
 17934       EXIT.
 17935
 17936 4299-EXIT.
 17937       EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 324
* EL050.cbl
 17939
 17940 4500-UPDATE-NEW-CERT.
 17941     IF CERT-WAS-FOUND
 17942         NEXT SENTENCE
 17943       ELSE
 17944         GO TO 4520-BUILD-NEW-KEY.
 17945
 17946     IF  CLASIC-CREATED-CERT
 17947         GO TO 4999-EXIT.
 17948
 17949     IF  CERT-WAS-CREATED-FOR-CLAIM
 17950         GO TO 4520-BUILD-NEW-KEY.
 17951
 17952     IF CERT-ADDED-BATCH
 17953        IF CM-RECORD-ID = 'CM'
 17954            GO TO 4999-EXIT.
 17955
 17956 4520-BUILD-NEW-KEY.
 17957* BUILD CONTROL PRIMARY
 17958
 17959     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17960                                       CM-COMPANY-CD-A1
 17961                                       CM-COMPANY-CD-A2
 17962                                       CM-COMPANY-CD-A4
 17963                                       CM-COMPANY-CD-A5.
 17964
 17965     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17966     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17967     MOVE PB-SV-STATE               TO CM-STATE.
 17968     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17969     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17970     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17971     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17972
 17973     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17974
 17975     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17976     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17977     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17978     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17979
 17980     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17981        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17982
 17983     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17984         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17985         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17986         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17987         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17988     ELSE
 17989         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17990
 17991     IF PB-COMPANY-ID   EQUAL  'CRI'
 17992         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17993         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17994         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17995         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17996         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 325
* EL050.cbl
 17997
 17998     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17999        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18000         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18001
 18002     IF PB-COMPANY-ID  = 'LBL'
 18003        IF PB-I-JOINT-COVERAGE
 18004            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18005                                           PB-I-MEMBER-NO
 18006            GO TO 4550-CONT-CERT-PROCESS.
 18007
 18008     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18009        NEXT SENTENCE
 18010     ELSE
 18011        GO TO 4540-BUILD-MEMBER-NO.
 18012
 18013******************************************************************
 18014*                                                                *
 18015*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18016*    FOR 'MON'.                                                  *
 18017*                                                                *
 18018******************************************************************
 18019
 18020     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18021     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18022     MOVE +1                     TO WS-SUB1
 18023                                    WS-SUB2.
 18024
 18025 4530-EDIT-MEMB-NAME.
 18026
 18027     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18028        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18029        ADD +1                       TO WS-SUB2.
 18030
 18031     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18032        ADD +1                       TO WS-SUB1
 18033        GO TO 4530-EDIT-MEMB-NAME.
 18034
 18035     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18036     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18037     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18038*    MOVE SPACE                      TO DC-OPTION-CODE.
 18039     SET  BIN-TO-GREG                TO TRUE.
 18040     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18041     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18042
 18043     GO TO 4550-CONT-CERT-PROCESS.
 18044
 18045******************************************************************
 18046*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18047******************************************************************
 18048
 18049 4540-BUILD-MEMBER-NO.
 18050
 18051     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18052         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18053         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18054         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 326
* EL050.cbl
 18055         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18056     ELSE
 18057         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18058
 18059     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18060        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18061         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18062
 18063 4550-CONT-CERT-PROCESS.
 18064
 18065*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18066*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18067*    ELSE
 18068*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18069
 18070     IF CERT-WAS-CREATED-FOR-CLAIM
 18071        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18072        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18073
 18074     IF CERT-AND-CLAIM-ONLINE
 18075        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18076        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18077
 18078     MOVE 'CM'                     TO CM-RECORD-ID.
 18079     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18080
 18081     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18082        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18083        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18084     ELSE
 18085        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18086        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18087
 18088     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18089     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18090     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18091     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18092     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18093     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18094     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18095                                      CM-LF-ITD-CANCEL-AMT
 18096                                      CM-LF-ITD-DEATH-AMT
 18097                                      CM-AH-ITD-AH-PMT
 18098                                      CM-AH-ITD-LUMP-PMT
 18099                                      CM-AH-ITD-CANCEL-AMT
 18100                                      CM-LF-NSP-PREMIUM-AMT
 18101                                      CM-AH-NSP-PREMIUM-AMT.
 18102*                                     CM-CLAIM-DEDUCT-WITHHELD
 18103*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18104     if pb-i-loan-apr = +99.9999
 18105        move zeros                 to cm-loan-apr
 18106     else
 18107        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18108     end-if
 18109     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18110     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18111     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18112     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 327
* EL050.cbl
 18113     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18114     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18115     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18116     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18117     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18118     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18119     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18120
 18121     IF PB-I-LIVES NOT NUMERIC
 18122         MOVE ZERO                 TO PB-I-LIVES.
 18123
 18124     IF PB-I-NUM-BILLED NOT NUMERIC
 18125         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18126
 18127     MOVE PB-I-LIVES               TO CM-LIVES.
 18128     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18129
 18130     IF PB-COMPANY-ID EQUAL  'DMD'
 18131         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18132         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18133
 18134     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18135     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18136     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18137     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18138     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18139     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18140
 18141     IF PB-I-LF-POLICY-FEE NUMERIC
 18142        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18143     ELSE
 18144        MOVE +0                    TO CM-LF-POLICY-FEE.
 18145
 18146     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18147        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18148        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18149     ELSE
 18150        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18151
 18152     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18153     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18154     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18155     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18156     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18157     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18158     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18159     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18160     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18161
 18162     IF PB-I-CANCEL-FEE NUMERIC
 18163        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18164     ELSE
 18165        MOVE +0                  TO CM-CANCEL-FEE
 18166     END-IF
 18167
 18168     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18169        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18170     ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 328
* EL050.cbl
 18171        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18172
 18173     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18174     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18175
 18176     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18177                                      CM-LF-DEATH-EXIT-DT
 18178                                      CM-AH-SETTLEMENT-EXIT-DT.
 18179
 18180*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18181*                       'TIH' OR 'OFL' OR 'FLA' OR
 18182*                       'TII' OR 'TMS' OR 'CRI' OR
 18183*                       'NCL'
 18184     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18185
 18186     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18187         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18188            MOVE '2'                TO CM-PREMIUM-TYPE.
 18189
 18190     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18191         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18192            MOVE '2'                TO CM-PREMIUM-TYPE.
 18193
 18194     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18195         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18196     ELSE
 18197         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18198         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18199
 18200     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18201     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18202     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18203     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18204     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18205     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18206     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18207     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18208
 18209     IF PB-NO-MONTHS-SKIPPED
 18210         MOVE SPACE                 TO CM-SKIP-CODE
 18211     ELSE
 18212         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18213
 18214     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18215     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18216                                       CM-LF-STATUS-AT-CANCEL.
 18217
 18218     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18219     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18220                                       CM-AH-STATUS-AT-CANCEL.
 18221
 18222     MOVE '1'                       TO CM-ENTRY-STATUS.
 18223
 18224     IF PB-REISSUED-CERT
 18225        MOVE '5'                    TO CM-ENTRY-STATUS.
 18226
 18227     IF PB-MONTHLY-CERT
 18228        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 329
* EL050.cbl
 18229
 18230     IF PB-CASH-CERT
 18231        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18232
 18233     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18234     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18235     IF PB-POLICY-IS-DECLINED
 18236        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18237
 18238     IF PB-POLICY-IS-VOIDED
 18239        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18240
 18241     IF PB-NEEDS-UNDERWRITING
 18242        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18243
 18244     IF PB-REIN-ONLY-CERT
 18245        MOVE '9'                    TO CM-ENTRY-STATUS.
 18246
 18247     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18248         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18249     ELSE
 18250         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18251
 18252     IF PB-RECORD-RETURNED
 18253        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18254      ELSE
 18255        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18256
 18257     IF PB-I-MAIL-ADDRS-PRESENT
 18258        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18259
 18260     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18261                                       CM-ENTRY-DT.
 18262
 18263 4999-EXIT.
 18264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 330
* EL050.cbl
 18266
 18267 5000-PROCESS-REPS.
 18268     MOVE ' '                    TO AGTC-MASTER-SW
 18269     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18270     MOVE CO-TYPE                TO AGTC-TYPE
 18271     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18272     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18273     IF (AGTC-MASTER-SW NOT = 'N')
 18274        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18275        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18276        PERFORM 8583-READ-ERAGTC-NEXT
 18277                                 THRU 8583-EXIT
 18278     END-IF
 18279     IF AGTC-MASTER-SW = 'N'
 18280        CONTINUE
 18281     ELSE
 18282        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18283           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18284              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18285              MOVE 'Y'           TO AGTC-MASTER-SW
 18286           END-IF
 18287        END-IF
 18288     END-IF
 18289     .
 18290 5000-EXIT.
 18291     EXIT.
 18292 6370-EDIT-INPUT-LF-CODE.
 18293     move ' ' to ws-benefit-cd-chg-sw
 18294     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18295        MOVE +1                  TO SUB
 18296        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18297        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18298        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18299        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18300        GO TO 6370-SEARCH-LOOP.
 18301
 18302     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18303
 18304     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18305     MOVE SPACES                 TO CNTL-ACCESS.
 18306*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18307     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18308     MOVE +0                     TO CNTL-SEQ-NO.
 18309     MOVE '4' TO RC-SW-2.
 18310     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18311
 18312     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18313        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18314        GO TO 6370-NO-LF-FOUND.
 18315
 18316     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18317     MOVE +1                     TO SUB.
 18318
 18319 6370-SEARCH-LOOP.
 18320     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18321         GO TO 6370-NO-LF-FOUND.
 18322
 18323     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 331
* EL050.cbl
 18324        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18325           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18326           set benefit-code-chg to true
 18327        end-if
 18328        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18329        GO TO 6370-HER-NET-PAY-CHECK.
 18330
 18331     ADD 1   TO SUB.
 18332*    IF SUB GREATER 120
 18333     IF SUB GREATER 200
 18334         GO TO 6370-NO-LF-FOUND.
 18335
 18336     GO TO 6370-SEARCH-LOOP.
 18337
 18338 6370-NO-LF-FOUND.
 18339
 18340     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18341        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18342        set benefit-code-chg to true
 18343     end-if
 18344     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18345
 18346 6370-HER-NET-PAY-CHECK.
 18347
 18348     IF PB-COMPANY-ID = 'CID'
 18349        IF PB-SV-STATE = 'CA' OR 'MN'
 18350           IF PB-I-LF-BENEFIT-CD = '02'
 18351              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18352           ELSE
 18353              IF PB-I-LF-BENEFIT-CD = '04'
 18354                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18355              END-IF
 18356           END-IF
 18357        END-IF
 18358     END-IF
 18359
 18360     IF PB-COMPANY-ID NOT = 'HER'
 18361         GO TO 6370-EXIT.
 18362
 18363     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18364         GO TO 6370-EXIT.
 18365
 18366     IF PB-I-LF-TERM NOT NUMERIC
 18367         MOVE ZEROS              TO PB-I-LF-TERM.
 18368
 18369     IF PB-I-LOAN-TERM NOT NUMERIC
 18370         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18371
 18372     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18373         GO TO 6370-EXIT.
 18374
 18375     IF PB-I-LF-BENEFIT-CD = '33'
 18376         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18377
 18378     IF PB-I-LF-BENEFIT-CD = '34'
 18379         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18380
 18381 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 332
* EL050.cbl
 18382     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 333
* EL050.cbl
 18384
 18385 6380-EDIT-INPUT-AH-CODE.
 18386     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18387        MOVE +1                  TO SUB
 18388        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18389        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18390        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18391        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18392        GO TO 6380-SEARCH-LOOP.
 18393
 18394     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18395
 18396     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18397     MOVE SPACES                 TO CNTL-ACCESS.
 18398     MOVE 'A'                    TO CNTL-REC-TYPE.
 18399*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18400     MOVE +0                     TO CNTL-SEQ-NO.
 18401     MOVE '5' TO RC-SW-2.
 18402     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18403
 18404     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18405        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18406        GO TO 6380-NO-AH-FOUND.
 18407
 18408     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18409     MOVE +1 TO SUB.
 18410
 18411 6380-SEARCH-LOOP.
 18412     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18413         GO TO 6380-NO-AH-FOUND.
 18414
 18415     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18416         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18417         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18418
 18419     ADD 1   TO SUB.
 18420     IF SUB GREATER THAN 96
 18421*    IF SUB GREATER THAN 300
 18422         GO TO 6380-NO-AH-FOUND.
 18423
 18424     GO TO 6380-SEARCH-LOOP.
 18425
 18426 6380-NO-AH-FOUND.
 18427
 18428     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18429
 18430     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18431         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18432     ELSE
 18433         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18434
 18435 6380-CSO-AH-ONLY-CHECKS.
 18436
 18437     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18438        NEXT SENTENCE
 18439      ELSE
 18440        GO TO 6380-EXIT.
 18441
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 334
* EL050.cbl
 18442     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18443         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18444
 18445
 18446     GO TO 6380-EXIT
 18447     .
 18448 6380-CSO-LIFE-WITH-AH-CHECKS.
 18449
 18450
 18451     .
 18452 6380-EXIT.
 18453     EXIT.
 18454
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 335
* EL050.cbl
 18456
 18457 6400-COMPUTE-EXTENSION-DAYS.
 18458
 18459******************************************************************
 18460*                                                                *
 18461*                   COMPUTE EXTENSION DAYS                       *
 18462*                                                                *
 18463*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18464*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18465*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18466*    THE EXTENSION DAYS.                                         *
 18467*                                                                *
 18468******************************************************************
 18469
 18470     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18471     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18472
 18473******************************************************************
 18474*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18475*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18476******************************************************************
 18477
 18478     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18479        COMPUTE WS-ODD-DAYS-OVER =
 18480               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18481     ELSE
 18482        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18483
 18484     IF WS-ODD-DAYS-OVER = ZEROS
 18485           GO TO 6499-EXIT
 18486     ELSE
 18487        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18488           IF WS-WDF-MONTH = 02
 18489              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18490              ADD 2       TO  WS-ODD-DAYS-OVER
 18491              GO TO 6499-EXIT
 18492           ELSE
 18493              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18494                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18495                 GO TO 6499-EXIT
 18496               ELSE
 18497                 GO TO 6499-EXIT
 18498        ELSE
 18499           GO TO 6499-EXIT.
 18500
 18501 6412-CHECK-TO-DAY.
 18502
 18503        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18504           IF WS-WDT-DAY = 28
 18505              ADD 2              TO WS-ODD-DAYS-OVER
 18506           ELSE
 18507              IF WS-WDT-DAY = 29
 18508                 ADD 1           TO WS-ODD-DAYS-OVER
 18509              ELSE
 18510                 NEXT SENTENCE
 18511        ELSE
 18512           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18513              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 336
* EL050.cbl
 18514
 18515     GO TO 6499-EXIT.
 18516
 18517
 18518 6415-CHECK-LEAP-YEAR.
 18519
 18520     IF DC-DAYS-IN-MONTH = 29
 18521        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18522
 18523 6415-EXIT.
 18524     EXIT.
 18525
 18526 6499-EXIT.
 18527      EXIT.
 18528
 18529 6500-END.
 18530     EXIT.
 18531
 18532
 18533******************************************************************
 18534************* PROCEDURE DIVISION FOR EL050 ***********************
 18535********************** ELC50PD END *******************************
 18536
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 337
* EL050.cbl
 18538
 18539**START***********************************************************
 18540*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18541*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18542******************************************************************
 18543*
 18544 6600-GET-STATE-MUNICIPAL-TAX.
 18545
 18546     IF PB-COMPANY-ID NOT = 'DMD'
 18547         GO TO 6640-EXIT.
 18548
 18549     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18550     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18551     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18552*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18553*
 18554***  Y2K PROJ 7744
 18555     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18556     SET BIN-TO-GREG          TO TRUE.
 18557     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18558
 18559     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18560
 18561     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18562     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18563
 18564
 18565* EXEC CICS HANDLE CONDITION
 18566*        INVREQ    (6610-START-BROWSE)
 18567*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18568*        NOTFND    (6630-END-OF-FILE)
 18569*    END-EXEC.
 18570*    MOVE '"$8JI                 ! # #00018554' TO DFHEIV0
 18571     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18573     MOVE X'2320233030303138353534' TO DFHEIV0(25:11)
 18574     CALL 'kxdfhei1' USING DFHEIV0
 18575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18576
 18577
 18578 6610-START-BROWSE.
 18579
 18580
 18581* EXEC CICS HANDLE CONDITION
 18582*        NOTFND    (6630-END-OF-FILE)
 18583*        DISABLED  (6630-ERRESS-PROBLEM)
 18584*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18585*        ENDFILE   (6630-END-OF-FILE)
 18586*    END-EXEC.
 18587*    MOVE '"$IcJ''                ! $ #00018562' TO DFHEIV0
 18588     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18589     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18590     MOVE X'2420233030303138353632' TO DFHEIV0(25:11)
 18591     CALL 'kxdfhei1' USING DFHEIV0
 18592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18593
 18594
 18595
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 338
* EL050.cbl
 18596* EXEC CICS STARTBR
 18597*        DATASET (FILE-ID-ERRESS)
 18598*        RIDFLD  (WS-ERRESS-KEY)
 18599*        GTEQ
 18600*    END-EXEC.
 18601     MOVE 0
 18602       TO DFHEIV11
 18603*    MOVE '&,         G          &   #00018569' TO DFHEIV0
 18604     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18605     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18606     MOVE X'2020233030303138353639' TO DFHEIV0(25:11)
 18607     CALL 'kxdfhei1' USING DFHEIV0,
 18608           FILE-ID-ERRESS,
 18609           WS-ERRESS-KEY,
 18610           DFHEIV99,
 18611           DFHEIV11,
 18612           DFHEIV99
 18613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18614
 18615
 18616 6620-READ-NEXT-ERRESS-MASTER.
 18617
 18618
 18619* EXEC CICS HANDLE CONDITION
 18620*        NOTFND    (6630-END-OF-FILE)
 18621*        ENDFILE   (6630-END-OF-FILE)
 18622*        DISABLED  (6630-ERRESS-PROBLEM)
 18623*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18624*    END-EXEC.
 18625*    MOVE '"$I''cJ                ! % #00018577' TO DFHEIV0
 18626     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18628     MOVE X'2520233030303138353737' TO DFHEIV0(25:11)
 18629     CALL 'kxdfhei1' USING DFHEIV0
 18630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18631
 18632
 18633
 18634* EXEC CICS READNEXT
 18635*        DATASET (FILE-ID-ERRESS)
 18636*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18637*        RIDFLD  (WS-ERRESS-KEY)
 18638*    END-EXEC.
 18639     MOVE LENGTH OF
 18640      RESIDENT-STATE-TAX-MASTER
 18641       TO DFHEIV12
 18642     MOVE 0
 18643       TO DFHEIV11
 18644*    MOVE '&.IL                  )   #00018584' TO DFHEIV0
 18645     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18646     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18647     MOVE X'2020233030303138353834' TO DFHEIV0(25:11)
 18648     CALL 'kxdfhei1' USING DFHEIV0,
 18649           FILE-ID-ERRESS,
 18650           RESIDENT-STATE-TAX-MASTER,
 18651           DFHEIV12,
 18652           WS-ERRESS-KEY,
 18653           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 339
* EL050.cbl
 18654           DFHEIV11,
 18655           DFHEIV99,
 18656           DFHEIV99
 18657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18658
 18659
 18660     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18661
 18662* EXEC CICS ENDBR
 18663*            DATASET (FILE-ID-ERRESS)
 18664*       END-EXEC
 18665     MOVE 0
 18666       TO DFHEIV11
 18667*    MOVE '&2                    $   #00018591' TO DFHEIV0
 18668     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18669     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18670     MOVE X'2020233030303138353931' TO DFHEIV0(25:11)
 18671     CALL 'kxdfhei1' USING DFHEIV0,
 18672           FILE-ID-ERRESS,
 18673           DFHEIV11,
 18674           DFHEIV99
 18675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18676        GO TO 6630-END-OF-FILE.
 18677
 18678     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18679        NEXT SENTENCE
 18680      ELSE
 18681        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18682
 18683*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18684*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18685*
 18686     MOVE +2                     TO WS-SUB1.
 18687
 18688     IF PB-ISSUE
 18689     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18690        MOVE +1                  TO WS-SUB1.
 18691
 18692     IF PB-CANCELLATION
 18693     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18694        MOVE +1                  TO WS-SUB1.
 18695*
 18696*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18697*
 18698***  Y2K PROJ 7744
 18699     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18700***  Y2K PROJ 7744
 18701
 18702*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18703* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18704* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18705
 18706     ADD 1                    TO WS-YEAR-YY.
 18707
 18708     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18709         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18710                              TO WS-RES-STATE-TAX
 18711         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 340
* EL050.cbl
 18712                              TO WS-RES-MUNI-TAX
 18713     ELSE
 18714         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18715                              TO WS-RES-STATE-TAX
 18716         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18717                              TO WS-RES-MUNI-TAX.
 18718
 18719*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18720
 18721     IF PB-CANCELLATION
 18722         GO TO 6640-CANCEL-TAX.
 18723
 18724     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18725         COMPUTE PB-I-STATE-TAX ROUNDED =
 18726                                   PB-I-LF-PREMIUM-AMT
 18727                                 * WS-RES-STATE-TAX
 18728         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18729                                   PB-I-LF-PREMIUM-AMT
 18730                                 * WS-RES-MUNI-TAX
 18731     ELSE
 18732     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18733         COMPUTE PB-I-STATE-TAX ROUNDED =
 18734                                   PB-I-AH-PREMIUM-AMT
 18735                                 * WS-RES-STATE-TAX
 18736         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18737                                   PB-I-AH-PREMIUM-AMT
 18738                                 * WS-RES-MUNI-TAX.
 18739
 18740
 18741* EXEC CICS ENDBR
 18742*         DATASET (FILE-ID-ERRESS)
 18743*    END-EXEC.
 18744     MOVE 0
 18745       TO DFHEIV11
 18746*    MOVE '&2                    $   #00018658' TO DFHEIV0
 18747     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18748     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18749     MOVE X'2020233030303138363538' TO DFHEIV0(25:11)
 18750     CALL 'kxdfhei1' USING DFHEIV0,
 18751           FILE-ID-ERRESS,
 18752           DFHEIV11,
 18753           DFHEIV99
 18754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18755
 18756
 18757     GO TO 6640-EXIT.
 18758
 18759 6640-CANCEL-TAX.
 18760     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18761
 18762     IF PB-C-LF-CANCEL-AMT > ZEROS
 18763         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18764                                   PB-C-LF-CANCEL-AMT
 18765                                 * WS-RES-STATE-TAX
 18766         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18767                                   PB-C-LF-CANCEL-AMT
 18768                                *  WS-RES-MUNI-TAX
 18769     ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 341
* EL050.cbl
 18770     IF PB-C-AH-CANCEL-AMT > ZEROS
 18771         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18772                                   PB-C-AH-CANCEL-AMT
 18773                                 * WS-RES-STATE-TAX
 18774         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18775                                   PB-C-AH-CANCEL-AMT
 18776                                *  WS-RES-MUNI-TAX.
 18777
 18778
 18779* EXEC CICS ENDBR
 18780*         DATASET (FILE-ID-ERRESS)
 18781*    END-EXEC.
 18782     MOVE 0
 18783       TO DFHEIV11
 18784*    MOVE '&2                    $   #00018683' TO DFHEIV0
 18785     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18786     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18787     MOVE X'2020233030303138363833' TO DFHEIV0(25:11)
 18788     CALL 'kxdfhei1' USING DFHEIV0,
 18789           FILE-ID-ERRESS,
 18790           DFHEIV11,
 18791           DFHEIV99
 18792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18793
 18794
 18795     GO TO 6640-EXIT.
 18796
 18797 6630-END-OF-FILE.
 18798     MOVE ER-8002              TO WS-ERROR.
 18799     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18800
 18801     GO TO 6640-EXIT.
 18802
 18803 6630-ERRESS-PROBLEM.
 18804     MOVE ER-8044              TO WS-ERROR.
 18805     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18806
 18807 6640-EXIT.
 18808     EXIT.
 18809
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 342
* EL050.cbl
 18811 6650-GET-RES-STATE-COMM.
 18812
 18813     IF PB-COMPANY-ID NOT = 'DMD'
 18814         GO TO 6700-COMM-EXIT.
 18815
 18816     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18817     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18818     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18819     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18820     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18821     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18822     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18823
 18824*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18825*
 18826***  Y2K PROJ 7744
 18827     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18828     SET BIN-TO-GREG          TO TRUE.
 18829     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18830
 18831     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18832***  Y2K PROJ 7744
 18833
 18834     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18835
 18836
 18837* EXEC CICS HANDLE CONDITION
 18838*        INVREQ    (6660-START-BROWSE)
 18839*        DISABLED  (6690-ERRESC-PROBLEM)
 18840*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18841*        NOTFND    (6690-END-OF-FILE)
 18842*    END-EXEC.
 18843*    MOVE '"$8cJI                ! & #00018728' TO DFHEIV0
 18844     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18846     MOVE X'2620233030303138373238' TO DFHEIV0(25:11)
 18847     CALL 'kxdfhei1' USING DFHEIV0
 18848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18849
 18850
 18851
 18852* EXEC CICS RESETBR
 18853*        DATASET (FILE-ID-ERRESC)
 18854*        RIDFLD  (WS-ERRESC-KEY)
 18855*    END-EXEC.
 18856     MOVE 0
 18857       TO DFHEIV11
 18858*    MOVE '&4         G          &   #00018735' TO DFHEIV0
 18859     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18860     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18861     MOVE X'2020233030303138373335' TO DFHEIV0(25:11)
 18862     CALL 'kxdfhei1' USING DFHEIV0,
 18863           FILE-ID-ERRESC,
 18864           WS-ERRESC-KEY,
 18865           DFHEIV99,
 18866           DFHEIV11,
 18867           DFHEIV99
 18868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 343
* EL050.cbl
 18869
 18870
 18871 6660-START-BROWSE.
 18872
 18873
 18874* EXEC CICS HANDLE CONDITION
 18875*        NOTFND    (6690-END-OF-FILE)
 18876*        DISABLED  (6690-ERRESC-PROBLEM)
 18877*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18878*        ENDFILE   (6690-END-OF-FILE)
 18879*    END-EXEC.
 18880*    MOVE '"$IcJ''                ! '' #00018742' TO DFHEIV0
 18881     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18883     MOVE X'2720233030303138373432' TO DFHEIV0(25:11)
 18884     CALL 'kxdfhei1' USING DFHEIV0
 18885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18886
 18887
 18888
 18889* EXEC CICS STARTBR
 18890*        DATASET (FILE-ID-ERRESC)
 18891*        RIDFLD  (WS-ERRESC-KEY)
 18892*        GTEQ
 18893*    END-EXEC.
 18894     MOVE 0
 18895       TO DFHEIV11
 18896*    MOVE '&,         G          &   #00018749' TO DFHEIV0
 18897     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18898     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18899     MOVE X'2020233030303138373439' TO DFHEIV0(25:11)
 18900     CALL 'kxdfhei1' USING DFHEIV0,
 18901           FILE-ID-ERRESC,
 18902           WS-ERRESC-KEY,
 18903           DFHEIV99,
 18904           DFHEIV11,
 18905           DFHEIV99
 18906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18907
 18908
 18909     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18910
 18911 6670-READ-NEXT-ERRESC-MASTER.
 18912
 18913
 18914* EXEC CICS HANDLE CONDITION
 18915*        NOTFND    (6690-END-OF-FILE)
 18916*        DISABLED  (6690-ERRESC-PROBLEM)
 18917*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18918*        ENDFILE   (6690-END-OF-FILE)
 18919*    END-EXEC.
 18920*    MOVE '"$IcJ''                ! ( #00018759' TO DFHEIV0
 18921     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18923     MOVE X'2820233030303138373539' TO DFHEIV0(25:11)
 18924     CALL 'kxdfhei1' USING DFHEIV0
 18925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18926
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 344
* EL050.cbl
 18927
 18928
 18929* EXEC CICS READNEXT
 18930*        DATASET (FILE-ID-ERRESC)
 18931*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18932*        RIDFLD  (ERRESC-RECORD-KEY)
 18933*    END-EXEC.
 18934     MOVE LENGTH OF
 18935      ACCOUNT-RESIDENT-ST-COMMISSION
 18936       TO DFHEIV12
 18937     MOVE 0
 18938       TO DFHEIV11
 18939*    MOVE '&.IL                  )   #00018766' TO DFHEIV0
 18940     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18941     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18942     MOVE X'2020233030303138373636' TO DFHEIV0(25:11)
 18943     CALL 'kxdfhei1' USING DFHEIV0,
 18944           FILE-ID-ERRESC,
 18945           ACCOUNT-RESIDENT-ST-COMMISSION,
 18946           DFHEIV12,
 18947           ERRESC-RECORD-KEY,
 18948           DFHEIV99,
 18949           DFHEIV11,
 18950           DFHEIV99,
 18951           DFHEIV99
 18952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18953
 18954
 18955     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18956        NEXT SENTENCE
 18957     ELSE
 18958
 18959* EXEC CICS ENDBR
 18960*            DATASET (FILE-ID-ERRESC)
 18961*       END-EXEC
 18962     MOVE 0
 18963       TO DFHEIV11
 18964*    MOVE '&2                    $   #00018775' TO DFHEIV0
 18965     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18966     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18967     MOVE X'2020233030303138373735' TO DFHEIV0(25:11)
 18968     CALL 'kxdfhei1' USING DFHEIV0,
 18969           FILE-ID-ERRESC,
 18970           DFHEIV11,
 18971           DFHEIV99
 18972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18973        GO TO 6690-END-OF-FILE.
 18974
 18975     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18976
 18977* EXEC CICS ENDBR
 18978*            DATASET (FILE-ID-ERRESC)
 18979*       END-EXEC
 18980     MOVE 0
 18981       TO DFHEIV11
 18982*    MOVE '&2                    $   #00018781' TO DFHEIV0
 18983     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18984     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 345
* EL050.cbl
 18985     MOVE X'2020233030303138373831' TO DFHEIV0(25:11)
 18986     CALL 'kxdfhei1' USING DFHEIV0,
 18987           FILE-ID-ERRESC,
 18988           DFHEIV11,
 18989           DFHEIV99
 18990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18991        GO TO 6690-END-OF-FILE.
 18992
 18993     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18994        NEXT SENTENCE
 18995      ELSE
 18996        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18997
 18998* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18999*
 19000     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19001
 19002     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19003
 19004     IF WS-SUB1 > ZERO
 19005         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19006             PERFORM 6680-SET-COMMISSION
 19007         ELSE
 19008             PERFORM 6680-SET-TABLE-CODE.
 19009
 19010
 19011* EXEC CICS ENDBR
 19012*         DATASET (FILE-ID-ERRESC)
 19013*    END-EXEC.
 19014     MOVE 0
 19015       TO DFHEIV11
 19016*    MOVE '&2                    $   #00018803' TO DFHEIV0
 19017     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19018     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19019     MOVE X'2020233030303138383033' TO DFHEIV0(25:11)
 19020     CALL 'kxdfhei1' USING DFHEIV0,
 19021           FILE-ID-ERRESC,
 19022           DFHEIV11,
 19023           DFHEIV99
 19024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19025
 19026
 19027     GO TO 6700-COMM-EXIT.
 19028
 19029 6680-SET-TABLE-CODE.
 19030     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19031        MOVE ZEROS             TO WS-SUB1
 19032     ELSE
 19033* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19034* TO COMPUTE AH COMMISSION.
 19035        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19036        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19037        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19038        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19039        PERFORM 6680-READ-CTBL-TABLE
 19040        IF WS-CTBL-READ-SW NOT = 'Y'
 19041           MOVE ZEROS          TO WS-SUB1.
 19042
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 346
* EL050.cbl
 19043 6680-READ-CTBL-TABLE.
 19044*
 19045* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19046* TO COMPUTE LIFE COMMISSION
 19047
 19048     IF CTBL-SW = '0540'
 19049        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19050        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19051        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19052
 19053     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19054
 19055     IF CTBL-TABLE-FOUND
 19056        IF CTBL-SW = '0530'
 19057             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19058                                    * PB-I-AH-TERM
 19059             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19060             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19061        ELSE
 19062             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19063             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19064             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19065     ELSE
 19066        IF FIRST-TIME-THROUGH
 19067            GO TO 6680-READ-CTBL-TABLE
 19068        ELSE
 19069            MOVE ZEROS         TO WS-SUB1.
 19070
 19071 6680-SET-COMMISSION.
 19072     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19073           MOVE ZEROS          TO WS-SUB1
 19074       ELSE
 19075           MOVE RESC-COMMISSION-PER (WS-SUB)
 19076                               TO WS-COMMISSION
 19077           IF CTBL-SW = '0530'
 19078               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19079           ELSE
 19080               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19081
 19082 6680-SEARCH-CATEGORY.
 19083     ADD +1                   TO WS-SUB.
 19084     IF WS-SUB > +12
 19085         GO TO 6680-EXIT.
 19086
 19087     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19088          MOVE WS-SUB         TO WS-SUB1
 19089          GO TO 6680-EXIT.
 19090
 19091     GO TO 6680-SEARCH-CATEGORY.
 19092
 19093 6680-EXIT.
 19094     EXIT.
 19095
 19096 6690-END-OF-FILE.
 19097     GO TO 6700-COMM-EXIT.
 19098
 19099 6690-ERRESC-PROBLEM.
 19100      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 347
* EL050.cbl
 19101      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19102
 19103      GO TO 6700-COMM-EXIT.
 19104
 19105 6700-COMM-EXIT.
 19106     EXIT.
 19107
 19108 7000-GET-RATE.
 19109
 19110* EXEC CICS LINK
 19111*        PROGRAM    ('ELRATE')
 19112*        COMMAREA   (CALCULATION-PASS-AREA)
 19113*        LENGTH     (CP-COMM-LENGTH)
 19114*    END-EXEC.
 19115     MOVE 'ELRATE' TO DFHEIV1
 19116*    MOVE '."C                   (   #00018889' TO DFHEIV0
 19117     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19119     MOVE X'2020233030303138383839' TO DFHEIV0(25:11)
 19120     CALL 'kxdfhei1' USING DFHEIV0,
 19121           DFHEIV1,
 19122           CALCULATION-PASS-AREA,
 19123           CP-COMM-LENGTH,
 19124           DFHEIV99,
 19125           DFHEIV99,
 19126           DFHEIV99,
 19127           DFHEIV99
 19128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19129
 19130
 19131 7000-EXIT.
 19132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 348
* EL050.cbl
 19134 7100-FIND-BENEFIT-IN-STATE.
 19135     MOVE 'N'                    TO BEN-SEARCH-SW.
 19136
 19137     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19138         VARYING SUB3 FROM 1 BY 1 UNTIL
 19139            ((SUB3 GREATER 50) OR
 19140              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19141               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19142
 19143     IF SUB3 NOT = 51
 19144         MOVE 'Y'                TO BEN-SEARCH-SW.
 19145
 19146     GO TO 7199-EXIT.
 19147
 19148 7100-BENEFIT-DUMMY.
 19149
 19150 7100-DUMMY-EXIT.
 19151     EXIT.
 19152
 19153 7199-EXIT.
 19154     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 349
* EL050.cbl
 19156 7200-FIND-BENEFIT.
 19157     MOVE 'N'                    TO BEN-SEARCH-SW.
 19158
 19159     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19160         VARYING SUB3 FROM 1 BY 1 UNTIL
 19161            ((SUB3 GREATER 8) OR
 19162            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19163
 19164     IF SUB3 NOT = 9
 19165         MOVE 'Y'                TO BEN-SEARCH-SW.
 19166
 19167     GO TO 7200-EXIT.
 19168
 19169 7200-BENEFIT-DUMMY.
 19170
 19171 7200-DUMMY-EXIT.
 19172     EXIT.
 19173
 19174 7200-EXIT.
 19175     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 350
* EL050.cbl
 19177 7250-LOOK-FOR-RESCINDED-CLAIM.
 19178     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19179                                    W-CL-COMP-CD.
 19180     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19181                                    W-CL-CERT-NO.
 19182
 19183
 19184* EXEC CICS HANDLE CONDITION
 19185*        NOTFND  (7250-CONTINUE)
 19186*        ENDFILE (7250-CONTINUE)
 19187*    END-EXEC.
 19188*    MOVE '"$I''                  ! ) #00018947' TO DFHEIV0
 19189     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19191     MOVE X'2920233030303138393437' TO DFHEIV0(25:11)
 19192     CALL 'kxdfhei1' USING DFHEIV0
 19193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19194
 19195
 19196
 19197* EXEC CICS IGNORE CONDITION
 19198*        DUPKEY
 19199*    END-EXEC.
 19200*    MOVE '"*$                   !   #00018952' TO DFHEIV0
 19201     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19203     MOVE X'2020233030303138393532' TO DFHEIV0(25:11)
 19204     CALL 'kxdfhei1' USING DFHEIV0
 19205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19206
 19207
 19208
 19209* EXEC CICS STARTBR
 19210*        DATASET   (CLMS-ID)
 19211*        RIDFLD    (ELMSTR-KEY)
 19212*        GENERIC   EQUAL
 19213*        KEYLENGTH (ELMSTR-LENGTH)
 19214*    END-EXEC.
 19215     MOVE 0
 19216       TO DFHEIV11
 19217*    MOVE '&,   KG    E          &   #00018956' TO DFHEIV0
 19218     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19219     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19220     MOVE X'2020233030303138393536' TO DFHEIV0(25:11)
 19221     CALL 'kxdfhei1' USING DFHEIV0,
 19222           CLMS-ID,
 19223           ELMSTR-KEY,
 19224           ELMSTR-LENGTH,
 19225           DFHEIV11,
 19226           DFHEIV99
 19227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19228
 19229
 19230     MOVE 'Y'                    TO W-BROWSE-SW.
 19231
 19232 7250-NEXT-CLAIM.
 19233
 19234
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 351
* EL050.cbl
 19235* EXEC CICS READNEXT
 19236*        DATASET   (CLMS-ID)
 19237*        RIDFLD    (ELMSTR-KEY)
 19238*        SET       (ADDRESS OF CLAIM-MASTER)
 19239*    END-EXEC.
 19240     MOVE 0
 19241       TO DFHEIV11
 19242*    MOVE '&.S                   )   #00018967' TO DFHEIV0
 19243     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19244     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19245     MOVE X'2020233030303138393637' TO DFHEIV0(25:11)
 19246     CALL 'kxdfhei1' USING DFHEIV0,
 19247           CLMS-ID,
 19248           DFHEIV20,
 19249           DFHEIV99,
 19250           ELMSTR-KEY,
 19251           DFHEIV99,
 19252           DFHEIV11,
 19253           DFHEIV99,
 19254           DFHEIV99
 19255     SET ADDRESS OF CLAIM-MASTER TO
 19256         DFHEIV20
 19257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19258
 19259
 19260     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19261        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19262         GO TO 7250-CONTINUE
 19263     END-IF.
 19264
 19265     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19266        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19267        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19268        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19269        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19270         GO TO 7250-NEXT-CLAIM
 19271     END-IF.
 19272
 19273     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19274        OR (CL-CLAIM-TYPE = 'I')
 19275        OR (CL-CLAIM-TYPE = 'G')
 19276        OR (CL-CLAIM-TYPE = 'F')
 19277          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19278              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19279              GO TO 7250-CONTINUE
 19280          END-IF
 19281     END-IF.
 19282
 19283     GO TO 7250-NEXT-CLAIM.
 19284
 19285 7250-CONTINUE.
 19286
 19287     IF W-BROWSE-SW = 'Y'
 19288
 19289* EXEC CICS ENDBR
 19290*            DATASET   (CLMS-ID)
 19291*        END-EXEC
 19292     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 352
* EL050.cbl
 19293       TO DFHEIV11
 19294*    MOVE '&2                    $   #00019001' TO DFHEIV0
 19295     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19296     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19297     MOVE X'2020233030303139303031' TO DFHEIV0(25:11)
 19298     CALL 'kxdfhei1' USING DFHEIV0,
 19299           CLMS-ID,
 19300           DFHEIV11,
 19301           DFHEIV99
 19302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19303         MOVE 'N' TO W-BROWSE-SW
 19304     END-IF.
 19305
 19306 7250-EXIT.
 19307     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 353
* EL050.cbl
 19309 7300-CHECK-FOR-OPEN-CLMS.
 19310
 19311*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19312*    MOVE SPACES                 TO CNTL-ACCESS.
 19313*    MOVE '1'                    TO CNTL-REC-TYPE.
 19314*    MOVE +0                     TO CNTL-SEQ-NO.
 19315
 19316*    MOVE '3'                    TO RC-SW-1.
 19317*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19318
 19319*    IF NOT CF-COMPANY-MASTER
 19320*         PERFORM 0099-COMPANY-NOT-FOUND
 19321*         GO TO 7300-EXIT.
 19322
 19323     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19324                                    W-CL-COMP-CD.
 19325     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19326                                    W-CL-CERT-NO.
 19327
 19328
 19329* EXEC CICS HANDLE CONDITION
 19330*        NOTFND  (7300-CONTINUE)
 19331*        ENDFILE (7300-CONTINUE)
 19332*    END-EXEC.
 19333*    MOVE '"$I''                  ! * #00019029' TO DFHEIV0
 19334     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19336     MOVE X'2A20233030303139303239' TO DFHEIV0(25:11)
 19337     CALL 'kxdfhei1' USING DFHEIV0
 19338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19339
 19340
 19341
 19342* EXEC CICS IGNORE CONDITION
 19343*        DUPKEY
 19344*    END-EXEC.
 19345*    MOVE '"*$                   !   #00019034' TO DFHEIV0
 19346     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19348     MOVE X'2020233030303139303334' TO DFHEIV0(25:11)
 19349     CALL 'kxdfhei1' USING DFHEIV0
 19350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19351
 19352
 19353
 19354* EXEC CICS STARTBR
 19355*        DATASET   (CLMS-ID)
 19356*        RIDFLD    (ELMSTR-KEY)
 19357*        GENERIC   EQUAL
 19358*        KEYLENGTH (ELMSTR-LENGTH)
 19359*    END-EXEC.
 19360     MOVE 0
 19361       TO DFHEIV11
 19362*    MOVE '&,   KG    E          &   #00019038' TO DFHEIV0
 19363     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19364     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19365     MOVE X'2020233030303139303338' TO DFHEIV0(25:11)
 19366     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 354
* EL050.cbl
 19367           CLMS-ID,
 19368           ELMSTR-KEY,
 19369           ELMSTR-LENGTH,
 19370           DFHEIV11,
 19371           DFHEIV99
 19372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19373
 19374
 19375     MOVE 'Y'                    TO W-BROWSE-SW.
 19376
 19377 7300-NEXT-CLAIM.
 19378
 19379
 19380* EXEC CICS READNEXT
 19381*        DATASET   (CLMS-ID)
 19382*        RIDFLD    (ELMSTR-KEY)
 19383*        SET       (ADDRESS OF CLAIM-MASTER)
 19384*    END-EXEC.
 19385     MOVE 0
 19386       TO DFHEIV11
 19387*    MOVE '&.S                   )   #00019049' TO DFHEIV0
 19388     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19389     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19390     MOVE X'2020233030303139303439' TO DFHEIV0(25:11)
 19391     CALL 'kxdfhei1' USING DFHEIV0,
 19392           CLMS-ID,
 19393           DFHEIV20,
 19394           DFHEIV99,
 19395           ELMSTR-KEY,
 19396           DFHEIV99,
 19397           DFHEIV11,
 19398           DFHEIV99,
 19399           DFHEIV99
 19400     SET ADDRESS OF CLAIM-MASTER TO
 19401         DFHEIV20
 19402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19403
 19404
 19405     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19406        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19407         GO TO 7300-CONTINUE.
 19408
 19409     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19410        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19411        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19412        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19413        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19414         GO TO 7300-NEXT-CLAIM.
 19415
 19416*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19417     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19418        OR (CL-CLAIM-TYPE = 'I')
 19419        OR (CL-CLAIM-TYPE = 'G')
 19420        OR (CL-CLAIM-TYPE = 'F')
 19421        IF CLAIM-IS-OPEN
 19422           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19423             AND PB-C-AH-CANCEL-DT > SPACES
 19424              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 355
* EL050.cbl
 19425              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19426           END-IF
 19427           EVALUATE TRUE
 19428             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19429                 MOVE ER-2884      TO WS-ERROR
 19430             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19431                 MOVE ER-2887      TO WS-ERROR
 19432             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19433                 MOVE ER-2886      TO WS-ERROR
 19434             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19435                 MOVE ER-2888      TO WS-ERROR
 19436             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19437                 MOVE ER-2885      TO WS-ERROR
 19438             WHEN OTHER
 19439                 MOVE ER-2768      TO WS-ERROR
 19440           END-EVALUATE
 19441           IF PB-C-AH-CANCEL-VOIDED OR
 19442              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19443                NOT AH-COVERAGE-CANCELLED)
 19444               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19445               MOVE ER-2768      TO WS-ERROR
 19446           END-IF
 19447           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19448           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19449              PB-FORCE-CODE NOT EQUAL '8'
 19450               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19451           END-IF
 19452           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19453           GO TO 7300-NEXT-CLAIM
 19454        ELSE
 19455           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19456*****THIS IS A RESCISSION OR REFORMATION
 19457              IF AH-COVERAGE-CANCELLED
 19458                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19459                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19460                    MOVE 1                   TO DC-ELAPSED-DAYS
 19461                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19462                    SET BIN-PLUS-ELAPSED     TO TRUE
 19463                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19464                    IF NO-CONVERSION-ERROR
 19465                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19466                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19467                          MOVE ER-2897 TO WS-ERROR
 19468                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19469                          GO TO 7300-NEXT-CLAIM
 19470                       END-IF
 19471                    END-IF
 19472                 ELSE
 19473                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19474                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19475                         MOVE ER-2890 TO WS-ERROR
 19476                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19477                         GO TO 7300-NEXT-CLAIM
 19478                      ELSE
 19479                         MOVE ER-2898 TO WS-ERROR
 19480                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19481                         GO TO 7300-NEXT-CLAIM
 19482                      END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 356
* EL050.cbl
 19483                   END-IF
 19484                 END-IF
 19485              END-IF
 19486           ELSE
 19487              IF CL-DENIAL-TYPE = '1'  AND
 19488                 CL-TOTAL-PAID-AMT = 0
 19489                    GO TO 7300-NEXT-CLAIM
 19490              END-IF
 19491              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19492               AND PB-C-AH-CANCEL-DT > SPACES
 19493                 MOVE ER-2756        TO WS-ERROR
 19494                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19495                 GO TO 7300-NEXT-CLAIM
 19496              END-IF
 19497           END-IF
 19498        END-IF
 19499     ELSE
 19500*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19501        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19502           IF (CLAIM-IS-OPEN)
 19503              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19504                 <> zeros
 19505              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19506                 <> zeros)
 19507              MOVE ER-2889      TO WS-ERROR
 19508              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19509              GO TO 7300-NEXT-CLAIM
 19510           ELSE
 19511              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19512*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19513                 IF (LF-COVERAGE-CANCELLED AND
 19514                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19515                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19516                         MOVE ER-2890 TO WS-ERROR
 19517                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19518                         GO TO 7300-NEXT-CLAIM
 19519                      ELSE
 19520                         MOVE ER-2898 TO WS-ERROR
 19521                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19522                         GO TO 7300-NEXT-CLAIM
 19523                      END-IF
 19524                 END-IF
 19525              ELSE
 19526                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19527                    and (CL-TOTAL-PAID-AMT = 0)
 19528                    GO TO 7300-NEXT-CLAIM
 19529                 END-IF
 19530                 IF (
 19531                      (AH-COVERAGE-CANCELLED)
 19532                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19533                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19534                      and (pb-ci-ah-cancel-amt +
 19535                         pb-c-ah-cancel-amt) <> zeros
 19536                    )
 19537                               OR
 19538                    (
 19539                      (LF-COVERAGE-CANCELLED)
 19540                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 357
* EL050.cbl
 19541                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19542                      and (pb-ci-lf-cancel-amt +
 19543                         pb-c-lf-cancel-amt) <> zeros
 19544                    )
 19545                       MOVE ER-2965 TO WS-ERROR
 19546                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19547                       GO TO 7300-NEXT-CLAIM
 19548                 END-IF
 19549                 IF LF-COVERAGE-CANCELLED
 19550                  IF CL-TOTAL-PAID-AMT > 0
 19551                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19552                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19553                        MOVE ER-2891 TO WS-ERROR
 19554                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19555                        GO TO 7300-NEXT-CLAIM
 19556                      END-IF
 19557                    ELSE
 19558****only show this error if cert num matches exactly
 19559                      IF PB-CERT-NO = CL-CERT-NO
 19560                         MOVE ER-2892 TO WS-ERROR
 19561                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19562                         GO TO 7300-NEXT-CLAIM
 19563                      END-IF
 19564                    END-IF
 19565                  END-IF
 19566                 END-IF
 19567              END-IF
 19568           END-IF
 19569        END-IF
 19570     END-IF
 19571
 19572     GO TO 7300-NEXT-CLAIM.
 19573
 19574 7300-CONTINUE.
 19575
 19576     IF W-BROWSE-SW = 'Y'
 19577
 19578* EXEC CICS ENDBR
 19579*            DATASET   (CLMS-ID)
 19580*        END-EXEC.
 19581     MOVE 0
 19582       TO DFHEIV11
 19583*    MOVE '&2                    $   #00019227' TO DFHEIV0
 19584     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19585     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19586     MOVE X'2020233030303139323237' TO DFHEIV0(25:11)
 19587     CALL 'kxdfhei1' USING DFHEIV0,
 19588           CLMS-ID,
 19589           DFHEIV11,
 19590           DFHEIV99
 19591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19592
 19593
 19594 7300-EXIT.
 19595     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 358
* EL050.cbl
 19597
 19598 7400-GET-REMAIN-TERM.
 19599
 19600* EXEC CICS LINK
 19601*        PROGRAM    ('ELRTRM')
 19602*        COMMAREA   (CALCULATION-PASS-AREA)
 19603*        LENGTH     (CP-COMM-LENGTH)
 19604*    END-EXEC.
 19605     MOVE 'ELRTRM' TO DFHEIV1
 19606*    MOVE '."C                   (   #00019236' TO DFHEIV0
 19607     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19608     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19609     MOVE X'2020233030303139323336' TO DFHEIV0(25:11)
 19610     CALL 'kxdfhei1' USING DFHEIV0,
 19611           DFHEIV1,
 19612           CALCULATION-PASS-AREA,
 19613           CP-COMM-LENGTH,
 19614           DFHEIV99,
 19615           DFHEIV99,
 19616           DFHEIV99,
 19617           DFHEIV99
 19618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19619
 19620
 19621 7400-EXIT.
 19622     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 359
* EL050.cbl
 19624
 19625 7500-GET-REMAIN-AMOUNT.
 19626
 19627* EXEC CICS LINK
 19628*        PROGRAM    ('ELRAMT')
 19629*        COMMAREA   (CALCULATION-PASS-AREA)
 19630*        LENGTH     (CP-COMM-LENGTH)
 19631*    END-EXEC.
 19632     MOVE 'ELRAMT' TO DFHEIV1
 19633*    MOVE '."C                   (   #00019247' TO DFHEIV0
 19634     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19635     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19636     MOVE X'2020233030303139323437' TO DFHEIV0(25:11)
 19637     CALL 'kxdfhei1' USING DFHEIV0,
 19638           DFHEIV1,
 19639           CALCULATION-PASS-AREA,
 19640           CP-COMM-LENGTH,
 19641           DFHEIV99,
 19642           DFHEIV99,
 19643           DFHEIV99,
 19644           DFHEIV99
 19645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19646
 19647
 19648 7500-EXIT.
 19649     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 360
* EL050.cbl
 19651
 19652 7600-GET-REFUND.
 19653
 19654* EXEC CICS LINK
 19655*        PROGRAM    ('ELRFND')
 19656*        COMMAREA   (CALCULATION-PASS-AREA)
 19657*        LENGTH     (CP-COMM-LENGTH)
 19658*    END-EXEC.
 19659     MOVE 'ELRFND' TO DFHEIV1
 19660*    MOVE '."C                   (   #00019258' TO DFHEIV0
 19661     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19663     MOVE X'2020233030303139323538' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           DFHEIV1,
 19666           CALCULATION-PASS-AREA,
 19667           CP-COMM-LENGTH,
 19668           DFHEIV99,
 19669           DFHEIV99,
 19670           DFHEIV99,
 19671           DFHEIV99
 19672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19673
 19674
 19675 7600-EXIT.
 19676     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 361
* EL050.cbl
 19678 7700-CALL-DL1.
 19679
 19680* EXEC CICS LINK
 19681*        PROGRAM    ('DLO001')
 19682*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19683*        LENGTH     (DLO001-COMM-LENGTH)
 19684*    END-EXEC.
 19685     MOVE 'DLO001' TO DFHEIV1
 19686*    MOVE '."C                   (   #00019268' TO DFHEIV0
 19687     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19689     MOVE X'2020233030303139323638' TO DFHEIV0(25:11)
 19690     CALL 'kxdfhei1' USING DFHEIV0,
 19691           DFHEIV1,
 19692           WS-DLO-MASTER-POLICY-FORM,
 19693           DLO001-COMM-LENGTH,
 19694           DFHEIV99,
 19695           DFHEIV99,
 19696           DFHEIV99,
 19697           DFHEIV99
 19698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19699
 19700
 19701 7700-EXIT.
 19702     EXIT.
 19703
 19704 7710-CALL-DL2.
 19705
 19706* EXEC CICS LINK
 19707*        PROGRAM    ('DLO002')
 19708*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19709*        LENGTH     (DLO002-COMM-LENGTH)
 19710*    END-EXEC.
 19711     MOVE 'DLO002' TO DFHEIV1
 19712*    MOVE '."C                   (   #00019278' TO DFHEIV0
 19713     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19715     MOVE X'2020233030303139323738' TO DFHEIV0(25:11)
 19716     CALL 'kxdfhei1' USING DFHEIV0,
 19717           DFHEIV1,
 19718           WS-DLO-INTERNAL-POLICY-FORM,
 19719           DLO002-COMM-LENGTH,
 19720           DFHEIV99,
 19721           DFHEIV99,
 19722           DFHEIV99,
 19723           DFHEIV99
 19724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19725
 19726
 19727 7710-EXIT.
 19728     EXIT.
 19729
 19730 7720-CALL-DL3.
 19731
 19732* EXEC CICS LINK
 19733*        PROGRAM    ('DLO003')
 19734*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19735*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 362
* EL050.cbl
 19736*    END-EXEC.
 19737     MOVE 'DLO003' TO DFHEIV1
 19738*    MOVE '."C                   (   #00019288' TO DFHEIV0
 19739     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19740     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19741     MOVE X'2020233030303139323838' TO DFHEIV0(25:11)
 19742     CALL 'kxdfhei1' USING DFHEIV0,
 19743           DFHEIV1,
 19744           WS-DLO-VALID-BANK-ID,
 19745           DLO003-COMM-LENGTH,
 19746           DFHEIV99,
 19747           DFHEIV99,
 19748           DFHEIV99,
 19749           DFHEIV99
 19750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19751
 19752
 19753 7720-EXIT.
 19754     EXIT.
 19755
 19756 7730-CALL-DL7.
 19757
 19758* EXEC CICS LINK
 19759*        PROGRAM    ('DLO007')
 19760*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19761*        LENGTH     (DLO007-COMM-LENGTH)
 19762*    END-EXEC.
 19763     MOVE 'DLO007' TO DFHEIV1
 19764*    MOVE '."C                   (   #00019298' TO DFHEIV0
 19765     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19766     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19767     MOVE X'2020233030303139323938' TO DFHEIV0(25:11)
 19768     CALL 'kxdfhei1' USING DFHEIV0,
 19769           DFHEIV1,
 19770           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19771           DLO007-COMM-LENGTH,
 19772           DFHEIV99,
 19773           DFHEIV99,
 19774           DFHEIV99,
 19775           DFHEIV99
 19776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19777
 19778
 19779 7730-EXIT.
 19780     EXIT.
 19781
 19782 7740-CALL-DL11.
 19783
 19784* EXEC CICS LINK
 19785*        PROGRAM    ('DLO011')
 19786*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19787*        LENGTH     (DLO011-COMM-LENGTH)
 19788*    END-EXEC.
 19789     MOVE 'DLO011' TO DFHEIV1
 19790*    MOVE '."C                   (   #00019308' TO DFHEIV0
 19791     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19792     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19793     MOVE X'2020233030303139333038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 363
* EL050.cbl
 19794     CALL 'kxdfhei1' USING DFHEIV0,
 19795           DFHEIV1,
 19796           WS-DLO-PREM-RATES-BEN-TYPE,
 19797           DLO011-COMM-LENGTH,
 19798           DFHEIV99,
 19799           DFHEIV99,
 19800           DFHEIV99,
 19801           DFHEIV99
 19802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19803
 19804
 19805 7740-EXIT.
 19806     EXIT.
 19807
 19808 7750-CALL-DL17.
 19809
 19810* EXEC CICS LINK
 19811*        PROGRAM    ('DLO017')
 19812*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19813*        LENGTH     (DLO017-COMM-LENGTH)
 19814*    END-EXEC.
 19815     MOVE 'DLO017' TO DFHEIV1
 19816*    MOVE '."C                   (   #00019318' TO DFHEIV0
 19817     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19818     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19819     MOVE X'2020233030303139333138' TO DFHEIV0(25:11)
 19820     CALL 'kxdfhei1' USING DFHEIV0,
 19821           DFHEIV1,
 19822           WS-DLO-VALID-RATE-CODE,
 19823           DLO017-COMM-LENGTH,
 19824           DFHEIV99,
 19825           DFHEIV99,
 19826           DFHEIV99,
 19827           DFHEIV99
 19828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19829
 19830
 19831 7750-EXIT.
 19832     EXIT.
 19833
 19834 7755-CALL-DL19.
 19835
 19836* EXEC CICS LINK
 19837*        PROGRAM    ('DLO019')
 19838*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19839*        LENGTH     (DLO019-COMM-LENGTH)
 19840*    END-EXEC.
 19841     MOVE 'DLO019' TO DFHEIV1
 19842*    MOVE '."C                   (   #00019328' TO DFHEIV0
 19843     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19844     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19845     MOVE X'2020233030303139333238' TO DFHEIV0(25:11)
 19846     CALL 'kxdfhei1' USING DFHEIV0,
 19847           DFHEIV1,
 19848           WS-DLO-ORIG-COV-CAT,
 19849           DLO019-COMM-LENGTH,
 19850           DFHEIV99,
 19851           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 364
* EL050.cbl
 19852           DFHEIV99,
 19853           DFHEIV99
 19854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19855
 19856
 19857 7755-EXIT.
 19858     EXIT.
 19859
 19860 7760-CALL-DL21.
 19861
 19862* EXEC CICS LINK
 19863*        PROGRAM    ('DLO021')
 19864*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19865*        LENGTH     (DLO021-COMM-LENGTH)
 19866*    END-EXEC.
 19867     MOVE 'DLO021' TO DFHEIV1
 19868*    MOVE '."C                   (   #00019338' TO DFHEIV0
 19869     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19870     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19871     MOVE X'2020233030303139333338' TO DFHEIV0(25:11)
 19872     CALL 'kxdfhei1' USING DFHEIV0,
 19873           DFHEIV1,
 19874           WS-DLO-VALID-LOAN-OFFICER,
 19875           DLO021-COMM-LENGTH,
 19876           DFHEIV99,
 19877           DFHEIV99,
 19878           DFHEIV99,
 19879           DFHEIV99
 19880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19881
 19882
 19883 7760-EXIT.
 19884     EXIT.
 19885
 19886 7770-CALL-DL22.
 19887
 19888* EXEC CICS LINK
 19889*        PROGRAM    ('DLO022')
 19890*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19891*        LENGTH     (DLO022-COMM-LENGTH)
 19892*    END-EXEC.
 19893     MOVE 'DLO022' TO DFHEIV1
 19894*    MOVE '."C                   (   #00019348' TO DFHEIV0
 19895     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19897     MOVE X'2020233030303139333438' TO DFHEIV0(25:11)
 19898     CALL 'kxdfhei1' USING DFHEIV0,
 19899           DFHEIV1,
 19900           WS-DLO-VALID-STATE-CODE,
 19901           DLO022-COMM-LENGTH,
 19902           DFHEIV99,
 19903           DFHEIV99,
 19904           DFHEIV99,
 19905           DFHEIV99
 19906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19907
 19908
 19909 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 365
* EL050.cbl
 19910     EXIT.
 19911
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 366
* EL050.cbl
 19913
 19914 7780-CALL-AGG.
 19915
 19916* EXEC CICS LINK
 19917*        PROGRAM    ('ELAGGO')
 19918*        COMMAREA   (WS-PASS-to-pemaggo)
 19919*        LENGTH     (ws-passed-key-LENGTH)
 19920*    END-EXEC.
 19921     MOVE 'ELAGGO' TO DFHEIV1
 19922*    MOVE '."C                   (   #00019360' TO DFHEIV0
 19923     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19924     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19925     MOVE X'2020233030303139333630' TO DFHEIV0(25:11)
 19926     CALL 'kxdfhei1' USING DFHEIV0,
 19927           DFHEIV1,
 19928           WS-PASS-to-pemaggo,
 19929           ws-passed-key-LENGTH,
 19930           DFHEIV99,
 19931           DFHEIV99,
 19932           DFHEIV99,
 19933           DFHEIV99
 19934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19935
 19936 7780-EXIT.
 19937     EXIT.
 19938 7785-CALL-HLDI.
 19939
 19940* EXEC CICS LINK
 19941*        PROGRAM    ('ELHLDI')
 19942*        COMMAREA   (HLDI-PASS-AREA)
 19943*        LENGTH     (HLDI-PASS-AREA-LEN)
 19944*    END-EXEC.
 19945     MOVE 'ELHLDI' TO DFHEIV1
 19946*    MOVE '."C                   (   #00019368' TO DFHEIV0
 19947     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19949     MOVE X'2020233030303139333638' TO DFHEIV0(25:11)
 19950     CALL 'kxdfhei1' USING DFHEIV0,
 19951           DFHEIV1,
 19952           HLDI-PASS-AREA,
 19953           HLDI-PASS-AREA-LEN,
 19954           DFHEIV99,
 19955           DFHEIV99,
 19956           DFHEIV99,
 19957           DFHEIV99
 19958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19959
 19960 7785-EXIT.
 19961     EXIT.
 19962 7786-CALL-HLDIM.
 19963
 19964* EXEC CICS LINK
 19965*        PROGRAM    ('ELHLDIM')
 19966*        COMMAREA   (HLDI-PASS-AREA)
 19967*        LENGTH     (HLDI-PASS-AREA-LEN)
 19968*    END-EXEC.
 19969     MOVE 'ELHLDIM' TO DFHEIV1
 19970*    MOVE '."C                   (   #00019376' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 367
* EL050.cbl
 19971     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19973     MOVE X'2020233030303139333736' TO DFHEIV0(25:11)
 19974     CALL 'kxdfhei1' USING DFHEIV0,
 19975           DFHEIV1,
 19976           HLDI-PASS-AREA,
 19977           HLDI-PASS-AREA-LEN,
 19978           DFHEIV99,
 19979           DFHEIV99,
 19980           DFHEIV99,
 19981           DFHEIV99
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19983
 19984 7786-EXIT.
 19985     EXIT.
 19986 7800-REWRITE-CERT.
 19987******************************************************************
 19988*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19989*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19990******************************************************************
 19991
 19992     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19993        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19994        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19995        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19996
 19997* EXEC CICS REWRITE
 19998*                  DATASET (CERT-ID)
 19999*                  FROM    (CERTIFICATE-MASTER)
 20000*              END-EXEC
 20001     MOVE LENGTH OF
 20002      CERTIFICATE-MASTER
 20003       TO DFHEIV11
 20004*    MOVE '&& L                  %   #00019393' TO DFHEIV0
 20005     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20006     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20007     MOVE X'2020233030303139333933' TO DFHEIV0(25:11)
 20008     CALL 'kxdfhei1' USING DFHEIV0,
 20009           CERT-ID,
 20010           CERTIFICATE-MASTER,
 20011           DFHEIV11,
 20012           DFHEIV99
 20013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20014        GO TO 7800-EXIT.
 20015
 20016       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20017       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20018
 20019 7800-EXIT.
 20020      EXIT.
 20021
 20022 7900-DELETE-CERT.
 20023
 20024* EXEC CICS DELETE
 20025*        DATASET (CERT-ID)
 20026*    END-EXEC.
 20027*    MOVE '&(                    &   #00019406' TO DFHEIV0
 20028     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 368
* EL050.cbl
 20029     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20030     MOVE X'2020233030303139343036' TO DFHEIV0(25:11)
 20031     CALL 'kxdfhei1' USING DFHEIV0,
 20032           CERT-ID,
 20033           DFHEIV99,
 20034           DFHEIV99,
 20035           DFHEIV99,
 20036           DFHEIV99
 20037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20038
 20039
 20040 7900-EXIT.
 20041     EXIT.
 20042
 20043 8000-WRITE-CERT.
 20044
 20045* EXEC CICS HANDLE CONDITION
 20046*        DUPKEY    (8000-FREE-MAIN)
 20047*    END-EXEC.
 20048*    MOVE '"$$                   ! + #00019414' TO DFHEIV0
 20049     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20051     MOVE X'2B20233030303139343134' TO DFHEIV0(25:11)
 20052     CALL 'kxdfhei1' USING DFHEIV0
 20053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20054
 20055
 20056
 20057* EXEC CICS WRITE
 20058*        DATASET     (CERT-ID)
 20059*        FROM        (CERTIFICATE-MASTER)
 20060*        RIDFLD      (ELCERT-KEY)
 20061*    END-EXEC.
 20062     MOVE LENGTH OF
 20063      CERTIFICATE-MASTER
 20064       TO DFHEIV11
 20065*    MOVE '&$ L                  ''   #00019418' TO DFHEIV0
 20066     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20067     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20068     MOVE X'2020233030303139343138' TO DFHEIV0(25:11)
 20069     CALL 'kxdfhei1' USING DFHEIV0,
 20070           CERT-ID,
 20071           CERTIFICATE-MASTER,
 20072           DFHEIV11,
 20073           ELCERT-KEY,
 20074           DFHEIV99,
 20075           DFHEIV99
 20076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20077
 20078
 20079 8000-FREE-MAIN.
 20080
 20081 8000-EXIT.
 20082      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 369
* EL050.cbl
 20084
 20085 8100-READ-ERPNDM.
 20086
 20087* EXEC CICS HANDLE CONDITION
 20088*         NOTFND     (8100-NOTFND)
 20089*         ENDFILE    (8100-NOTFND)
 20090*    END-EXEC.
 20091*    MOVE '"$I''                  ! , #00019431' TO DFHEIV0
 20092     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20093     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20094     MOVE X'2C20233030303139343331' TO DFHEIV0(25:11)
 20095     CALL 'kxdfhei1' USING DFHEIV0
 20096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20097
 20098
 20099     MOVE SPACES                 TO ERPNDM-FOUND.
 20100     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20101
 20102
 20103* EXEC CICS READ
 20104*         DATASET   (FILE-ERPNDM)
 20105*         RIDFLD    (PM-CONTROL-PRIMARY)
 20106*         INTO      (PENDING-MAILING-DATA)
 20107*    END-EXEC.
 20108     MOVE LENGTH OF
 20109      PENDING-MAILING-DATA
 20110       TO DFHEIV11
 20111*    MOVE '&"IL       E          (   #00019439' TO DFHEIV0
 20112     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20114     MOVE X'2020233030303139343339' TO DFHEIV0(25:11)
 20115     CALL 'kxdfhei1' USING DFHEIV0,
 20116           FILE-ERPNDM,
 20117           PENDING-MAILING-DATA,
 20118           DFHEIV11,
 20119           PM-CONTROL-PRIMARY,
 20120           DFHEIV99,
 20121           DFHEIV99,
 20122           DFHEIV99
 20123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20124
 20125
 20126     GO TO 8100-EXIT.
 20127
 20128 8100-NOTFND.
 20129
 20130     MOVE 'X'                    TO ERPNDM-FOUND.
 20131     MOVE ER-2694                TO WS-ERROR.
 20132     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20133     MOVE ER-2883                TO WS-ERROR
 20134     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20135     .
 20136 8100-EXIT.
 20137     EXIT.
 20138
 20139 8110-READ-ERMAIL.
 20140
 20141* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 370
* EL050.cbl
 20142*         NOTFND     (8110-NOTFND)
 20143*         ENDFILE    (8110-NOTFND)
 20144*    END-EXEC.
 20145*    MOVE '"$I''                  ! - #00019459' TO DFHEIV0
 20146     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20148     MOVE X'2D20233030303139343539' TO DFHEIV0(25:11)
 20149     CALL 'kxdfhei1' USING DFHEIV0
 20150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20151
 20152
 20153     MOVE SPACES                 TO ERMAIL-FOUND.
 20154     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20155     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20156     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20157     MOVE PB-SV-STATE            TO MA-STATE.
 20158
 20159
 20160* EXEC CICS READ
 20161*         UPDATE
 20162*         DATASET   (FILE-ERMAIL)
 20163*         RIDFLD    (MA-CONTROL-PRIMARY)
 20164*         INTO      (MAILING-DATA)
 20165*    END-EXEC.
 20166     MOVE LENGTH OF
 20167      MAILING-DATA
 20168       TO DFHEIV11
 20169*    MOVE '&"IL       EU         (   #00019470' TO DFHEIV0
 20170     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20171     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20172     MOVE X'2020233030303139343730' TO DFHEIV0(25:11)
 20173     CALL 'kxdfhei1' USING DFHEIV0,
 20174           FILE-ERMAIL,
 20175           MAILING-DATA,
 20176           DFHEIV11,
 20177           MA-CONTROL-PRIMARY,
 20178           DFHEIV99,
 20179           DFHEIV99,
 20180           DFHEIV99
 20181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20182
 20183
 20184     GO TO 8110-EXIT.
 20185
 20186 8110-NOTFND.
 20187     MOVE 'X'                    TO ERMAIL-FOUND.
 20188
 20189 8110-EXIT.
 20190     EXIT.
 20191
 20192 8120-REWRITE-ERMAIL.
 20193
 20194* EXEC CICS REWRITE
 20195*         DATASET    (FILE-ERMAIL)
 20196*         FROM       (MAILING-DATA)
 20197*    END-EXEC.
 20198     MOVE LENGTH OF
 20199      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 371
* EL050.cbl
 20200       TO DFHEIV11
 20201*    MOVE '&& L                  %   #00019486' TO DFHEIV0
 20202     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20203     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20204     MOVE X'2020233030303139343836' TO DFHEIV0(25:11)
 20205     CALL 'kxdfhei1' USING DFHEIV0,
 20206           FILE-ERMAIL,
 20207           MAILING-DATA,
 20208           DFHEIV11,
 20209           DFHEIV99
 20210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20211
 20212
 20213 8120-EXIT.
 20214     EXIT.
 20215
 20216 8130-WRITE-ERMAIL.
 20217
 20218* EXEC CICS HANDLE CONDITION
 20219*         DUPKEY   (8130-EXIT)
 20220*    END-EXEC.
 20221*    MOVE '"$$                   ! . #00019495' TO DFHEIV0
 20222     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20224     MOVE X'2E20233030303139343935' TO DFHEIV0(25:11)
 20225     CALL 'kxdfhei1' USING DFHEIV0
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228
 20229
 20230* EXEC CICS WRITE
 20231*         DATASET     (FILE-ERMAIL)
 20232*         RIDFLD      (MA-CONTROL-PRIMARY)
 20233*         FROM        (MAILING-DATA)
 20234*    END-EXEC.
 20235     MOVE LENGTH OF
 20236      MAILING-DATA
 20237       TO DFHEIV11
 20238*    MOVE '&$ L                  ''   #00019499' TO DFHEIV0
 20239     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20240     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20241     MOVE X'2020233030303139343939' TO DFHEIV0(25:11)
 20242     CALL 'kxdfhei1' USING DFHEIV0,
 20243           FILE-ERMAIL,
 20244           MAILING-DATA,
 20245           DFHEIV11,
 20246           MA-CONTROL-PRIMARY,
 20247           DFHEIV99,
 20248           DFHEIV99
 20249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20250
 20251
 20252 8130-EXIT.
 20253     EXIT.
 20254
 20255 8140-UNLOCK-ERMAIL.
 20256
 20257* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 372
* EL050.cbl
 20258*         DATASET   (FILE-ERMAIL)
 20259*    END-EXEC.
 20260*    MOVE '&*                    #   #00019509' TO DFHEIV0
 20261     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20262     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20263     MOVE X'2020233030303139353039' TO DFHEIV0(25:11)
 20264     CALL 'kxdfhei1' USING DFHEIV0,
 20265           FILE-ERMAIL,
 20266           DFHEIV99
 20267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20268
 20269
 20270 8140-EXIT.
 20271     EXIT.
 20272
 20273 8150-read-elcrtt.
 20274
 20275
 20276* EXEC CICS HANDLE CONDITION
 20277*        NOTFND   (8150-exit)
 20278*    END-EXEC
 20279*    MOVE '"$I                   ! / #00019518' TO DFHEIV0
 20280     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20282     MOVE X'2F20233030303139353138' TO DFHEIV0(25:11)
 20283     CALL 'kxdfhei1' USING DFHEIV0
 20284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20285
 20286     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20287     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20288
 20289
 20290* EXEC CICS READ
 20291*        DATASET  (CRTT-ID)
 20292*        RIDFLD   (WS-ELCRTT-KEY)
 20293*        INTO     (CERTIFICATE-TRAILERS)
 20294*    END-EXEC
 20295     MOVE LENGTH OF
 20296      CERTIFICATE-TRAILERS
 20297       TO DFHEIV11
 20298*    MOVE '&"IL       E          (   #00019525' TO DFHEIV0
 20299     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20301     MOVE X'2020233030303139353235' TO DFHEIV0(25:11)
 20302     CALL 'kxdfhei1' USING DFHEIV0,
 20303           CRTT-ID,
 20304           CERTIFICATE-TRAILERS,
 20305           DFHEIV11,
 20306           WS-ELCRTT-KEY,
 20307           DFHEIV99,
 20308           DFHEIV99,
 20309           DFHEIV99
 20310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20311
 20312     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20313     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20314     move cs-vehicle-odometer    to ws-vehicle-odometer
 20315
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 373
* EL050.cbl
 20316     .
 20317 8150-exit.
 20318     exit.
 20319 8180-UPDATE-VIN-NUMBER.
 20320
 20321* EXEC CICS HANDLE CONDITION
 20322*        NOTFND   (8180-NOTFND)
 20323*    END-EXEC.
 20324*    MOVE '"$I                   ! 0 #00019539' TO DFHEIV0
 20325     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20326     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20327     MOVE X'3020233030303139353339' TO DFHEIV0(25:11)
 20328     CALL 'kxdfhei1' USING DFHEIV0
 20329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20330
 20331
 20332     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20333     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20334
 20335
 20336* EXEC CICS READ
 20337*        UPDATE
 20338*        DATASET  (CRTT-ID)
 20339*        RIDFLD   (WS-ELCRTT-KEY)
 20340*        INTO     (CERTIFICATE-TRAILERS)
 20341*    END-EXEC.
 20342     MOVE LENGTH OF
 20343      CERTIFICATE-TRAILERS
 20344       TO DFHEIV11
 20345*    MOVE '&"IL       EU         (   #00019546' TO DFHEIV0
 20346     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20347     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20348     MOVE X'2020233030303139353436' TO DFHEIV0(25:11)
 20349     CALL 'kxdfhei1' USING DFHEIV0,
 20350           CRTT-ID,
 20351           CERTIFICATE-TRAILERS,
 20352           DFHEIV11,
 20353           WS-ELCRTT-KEY,
 20354           DFHEIV99,
 20355           DFHEIV99,
 20356           DFHEIV99
 20357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20358
 20359
 20360     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20361        or (hldi-pass-area not = spaces)
 20362        move pa-modelyear        to cs-year
 20363        move pa-makename         to cs-make
 20364        move pa-modelname        to cs-model
 20365        move pa-seriesname       to cs-future
 20366        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20367
 20368* EXEC CICS REWRITE
 20369*           DATASET  (CRTT-ID)
 20370*           FROM     (CERTIFICATE-TRAILERS)
 20371*        END-EXEC
 20372     MOVE LENGTH OF
 20373      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 374
* EL050.cbl
 20374       TO DFHEIV11
 20375*    MOVE '&& L                  %   #00019560' TO DFHEIV0
 20376     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20377     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20378     MOVE X'2020233030303139353630' TO DFHEIV0(25:11)
 20379     CALL 'kxdfhei1' USING DFHEIV0,
 20380           CRTT-ID,
 20381           CERTIFICATE-TRAILERS,
 20382           DFHEIV11,
 20383           DFHEIV99
 20384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20385     ELSE
 20386
 20387* EXEC CICS UNLOCK
 20388*          DATASET  (CRTT-ID)
 20389*       END-EXEC
 20390*    MOVE '&*                    #   #00019565' TO DFHEIV0
 20391     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20392     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20393     MOVE X'2020233030303139353635' TO DFHEIV0(25:11)
 20394     CALL 'kxdfhei1' USING DFHEIV0,
 20395           CRTT-ID,
 20396           DFHEIV99
 20397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20398     END-IF.
 20399
 20400     GO TO 8180-EXIT.
 20401
 20402 8180-NOTFND.
 20403
 20404     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20405     MOVE 'CS'         TO CS-RECORD-ID.
 20406     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20407     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20408     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20409     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20410
 20411* EXEC CICS WRITE
 20412*       DATASET  (CRTT-ID)
 20413*       RIDFLD   (WS-ELCRTT-KEY)
 20414*       FROM     (CERTIFICATE-TRAILERS)
 20415*    END-EXEC.
 20416     MOVE LENGTH OF
 20417      CERTIFICATE-TRAILERS
 20418       TO DFHEIV11
 20419*    MOVE '&$ L                  ''   #00019580' TO DFHEIV0
 20420     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20421     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20422     MOVE X'2020233030303139353830' TO DFHEIV0(25:11)
 20423     CALL 'kxdfhei1' USING DFHEIV0,
 20424           CRTT-ID,
 20425           CERTIFICATE-TRAILERS,
 20426           DFHEIV11,
 20427           WS-ELCRTT-KEY,
 20428           DFHEIV99,
 20429           DFHEIV99
 20430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20431
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 375
* EL050.cbl
 20432
 20433 8180-EXIT.
 20434     EXIT.
 20435
 20436 8190-UPDATE-REFUND-CLAIM-FLAG.
 20437
 20438* EXEC CICS HANDLE CONDITION
 20439*        NOTFND   (8190-NOTFND)
 20440*    END-EXEC.
 20441*    MOVE '"$I                   ! 1 #00019590' TO DFHEIV0
 20442     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20444     MOVE X'3120233030303139353930' TO DFHEIV0(25:11)
 20445     CALL 'kxdfhei1' USING DFHEIV0
 20446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20447
 20448
 20449     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20450     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20451
 20452
 20453* EXEC CICS READ
 20454*        UPDATE
 20455*        DATASET  (CRTT-ID)
 20456*        RIDFLD   (WS-ELCRTT-KEY)
 20457*        INTO     (CERTIFICATE-TRAILERS)
 20458*    END-EXEC.
 20459     MOVE LENGTH OF
 20460      CERTIFICATE-TRAILERS
 20461       TO DFHEIV11
 20462*    MOVE '&"IL       EU         (   #00019597' TO DFHEIV0
 20463     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20464     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20465     MOVE X'2020233030303139353937' TO DFHEIV0(25:11)
 20466     CALL 'kxdfhei1' USING DFHEIV0,
 20467           CRTT-ID,
 20468           CERTIFICATE-TRAILERS,
 20469           DFHEIV11,
 20470           WS-ELCRTT-KEY,
 20471           DFHEIV99,
 20472           DFHEIV99,
 20473           DFHEIV99
 20474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20475
 20476
 20477     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20478
 20479* EXEC CICS REWRITE
 20480*       DATASET  (CRTT-ID)
 20481*       FROM     (CERTIFICATE-TRAILERS)
 20482*    END-EXEC.
 20483     MOVE LENGTH OF
 20484      CERTIFICATE-TRAILERS
 20485       TO DFHEIV11
 20486*    MOVE '&& L                  %   #00019605' TO DFHEIV0
 20487     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20488     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20489     MOVE X'2020233030303139363035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 376
* EL050.cbl
 20490     CALL 'kxdfhei1' USING DFHEIV0,
 20491           CRTT-ID,
 20492           CERTIFICATE-TRAILERS,
 20493           DFHEIV11,
 20494           DFHEIV99
 20495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20496
 20497
 20498     GO TO 8190-EXIT.
 20499
 20500 8190-NOTFND.
 20501
 20502     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20503     MOVE 'CS'         TO CS-RECORD-ID.
 20504     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20505     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20506     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20507     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20508
 20509* EXEC CICS WRITE
 20510*       DATASET  (CRTT-ID)
 20511*       RIDFLD   (WS-ELCRTT-KEY)
 20512*       FROM     (CERTIFICATE-TRAILERS)
 20513*    END-EXEC.
 20514     MOVE LENGTH OF
 20515      CERTIFICATE-TRAILERS
 20516       TO DFHEIV11
 20517*    MOVE '&$ L                  ''   #00019620' TO DFHEIV0
 20518     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20519     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20520     MOVE X'2020233030303139363230' TO DFHEIV0(25:11)
 20521     CALL 'kxdfhei1' USING DFHEIV0,
 20522           CRTT-ID,
 20523           CERTIFICATE-TRAILERS,
 20524           DFHEIV11,
 20525           WS-ELCRTT-KEY,
 20526           DFHEIV99,
 20527           DFHEIV99
 20528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20529
 20530
 20531 8190-EXIT.
 20532     EXIT.
 20533
 20534 8195-UPDATE-AGE-FLAGS.
 20535
 20536* EXEC CICS HANDLE CONDITION
 20537*        NOTFND   (8195-NOTFND)
 20538*    END-EXEC.
 20539*    MOVE '"$I                   ! 2 #00019630' TO DFHEIV0
 20540     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20542     MOVE X'3220233030303139363330' TO DFHEIV0(25:11)
 20543     CALL 'kxdfhei1' USING DFHEIV0
 20544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20545
 20546
 20547     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 377
* EL050.cbl
 20548     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20549
 20550
 20551* EXEC CICS READ
 20552*        UPDATE
 20553*        DATASET  (CRTT-ID)
 20554*        RIDFLD   (WS-ELCRTT-KEY)
 20555*        INTO     (CERTIFICATE-TRAILERS)
 20556*    END-EXEC.
 20557     MOVE LENGTH OF
 20558      CERTIFICATE-TRAILERS
 20559       TO DFHEIV11
 20560*    MOVE '&"IL       EU         (   #00019637' TO DFHEIV0
 20561     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20562     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20563     MOVE X'2020233030303139363337' TO DFHEIV0(25:11)
 20564     CALL 'kxdfhei1' USING DFHEIV0,
 20565           CRTT-ID,
 20566           CERTIFICATE-TRAILERS,
 20567           DFHEIV11,
 20568           WS-ELCRTT-KEY,
 20569           DFHEIV99,
 20570           DFHEIV99,
 20571           DFHEIV99
 20572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20573
 20574
 20575     IF WS-INS-AGE-SET = 'Y'
 20576        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20577     END-IF
 20578     IF WS-JNT-AGE-SET = 'Y'
 20579        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20580     END-IF
 20581
 20582
 20583* EXEC CICS REWRITE
 20584*       DATASET  (CRTT-ID)
 20585*       FROM     (CERTIFICATE-TRAILERS)
 20586*    END-EXEC.
 20587     MOVE LENGTH OF
 20588      CERTIFICATE-TRAILERS
 20589       TO DFHEIV11
 20590*    MOVE '&& L                  %   #00019651' TO DFHEIV0
 20591     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20592     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20593     MOVE X'2020233030303139363531' TO DFHEIV0(25:11)
 20594     CALL 'kxdfhei1' USING DFHEIV0,
 20595           CRTT-ID,
 20596           CERTIFICATE-TRAILERS,
 20597           DFHEIV11,
 20598           DFHEIV99
 20599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20600
 20601
 20602     GO TO 8195-EXIT.
 20603
 20604 8195-NOTFND.
 20605
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 378
* EL050.cbl
 20606     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20607     MOVE 'CS'         TO CS-RECORD-ID.
 20608     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20609     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20610     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20611     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20612     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20613
 20614* EXEC CICS WRITE
 20615*       DATASET  (CRTT-ID)
 20616*       RIDFLD   (WS-ELCRTT-KEY)
 20617*       FROM     (CERTIFICATE-TRAILERS)
 20618*    END-EXEC.
 20619     MOVE LENGTH OF
 20620      CERTIFICATE-TRAILERS
 20621       TO DFHEIV11
 20622*    MOVE '&$ L                  ''   #00019667' TO DFHEIV0
 20623     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20624     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20625     MOVE X'2020233030303139363637' TO DFHEIV0(25:11)
 20626     CALL 'kxdfhei1' USING DFHEIV0,
 20627           CRTT-ID,
 20628           CERTIFICATE-TRAILERS,
 20629           DFHEIV11,
 20630           WS-ELCRTT-KEY,
 20631           DFHEIV99,
 20632           DFHEIV99
 20633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20634
 20635
 20636 8195-EXIT.
 20637     EXIT.
 20638
 20639 8200-READ-REIN-TABLE.
 20640
 20641* EXEC CICS HANDLE CONDITION
 20642*         NOTFND   (8200-NOTFND)
 20643*    END-EXEC.
 20644*    MOVE '"$I                   ! 3 #00019677' TO DFHEIV0
 20645     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20647     MOVE X'3320233030303139363737' TO DFHEIV0(25:11)
 20648     CALL 'kxdfhei1' USING DFHEIV0
 20649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20650
 20651
 20652
 20653* EXEC CICS READ
 20654*        DATASET     (REIN-ID)
 20655*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20656*        RIDFLD      (ERREIN-KEY)
 20657*    END-EXEC.
 20658*    MOVE '&"S        E          (   #00019681' TO DFHEIV0
 20659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20660     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20661     MOVE X'2020233030303139363831' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0,
 20663           REIN-ID,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 379
* EL050.cbl
 20664           DFHEIV20,
 20665           DFHEIV99,
 20666           ERREIN-KEY,
 20667           DFHEIV99,
 20668           DFHEIV99,
 20669           DFHEIV99
 20670     SET ADDRESS OF REINSURANCE-RECORD TO
 20671         DFHEIV20
 20672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20673
 20674
 20675     GO TO 8200-EXIT.
 20676
 20677 8200-NOTFND.
 20678     MOVE 'N'             TO WS-REIN-READ-SW.
 20679
 20680 8200-EXIT.
 20681      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 380
* EL050.cbl
 20683
 20684 8300-READ-CTBL-TABLE.
 20685
 20686* EXEC CICS HANDLE CONDITION
 20687*        NOTFND    (8300-NOTFND)
 20688*        DISABLED  (8300-ERRESS-PROBLEM)
 20689*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20690*        ENDFILE   (8300-NOTFND)
 20691*    END-EXEC.
 20692*    MOVE '"$IcJ''                ! 4 #00019697' TO DFHEIV0
 20693     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20695     MOVE X'3420233030303139363937' TO DFHEIV0(25:11)
 20696     CALL 'kxdfhei1' USING DFHEIV0
 20697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20698
 20699
 20700
 20701* EXEC CICS READ
 20702*        DATASET     (CTBL-ID)
 20703*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20704*        RIDFLD      (ERCTBL-KEY)
 20705*    END-EXEC.
 20706*    MOVE '&"S        E          (   #00019704' TO DFHEIV0
 20707     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20708     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20709     MOVE X'2020233030303139373034' TO DFHEIV0(25:11)
 20710     CALL 'kxdfhei1' USING DFHEIV0,
 20711           CTBL-ID,
 20712           DFHEIV20,
 20713           DFHEIV99,
 20714           ERCTBL-KEY,
 20715           DFHEIV99,
 20716           DFHEIV99,
 20717           DFHEIV99
 20718     SET ADDRESS OF COMM-TABLE-RECORD TO
 20719         DFHEIV20
 20720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20721
 20722
 20723     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20724
 20725     GO TO 8300-EXIT.
 20726
 20727 8300-NOTFND.
 20728
 20729     IF CTBL-SW = '0530'
 20730         MOVE 'AA'                     TO WS-AH-COMP-CD
 20731         MOVE '0550'                   TO CTBL-SW
 20732         MOVE '1'                      TO WS-CTBL-READ-SW
 20733         GO TO 8300-EXIT.
 20734
 20735     IF CTBL-SW = '0540'
 20736         MOVE 'AA'                     TO WS-LF-COMP-CD
 20737         MOVE '0550'                   TO CTBL-SW
 20738         MOVE '1'                      TO WS-CTBL-READ-SW
 20739         GO TO 8300-EXIT.
 20740
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 381
* EL050.cbl
 20741     IF CTBL-SW = '0550'
 20742         MOVE '2'                      TO WS-CTBL-READ-SW
 20743         GO TO 8300-EXIT.
 20744
 20745     GO TO 8300-EXIT.
 20746
 20747 8300-ERRESS-PROBLEM.
 20748
 20749      MOVE ER-8050              TO WS-ERROR.
 20750      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20751
 20752     GO TO 8300-EXIT.
 20753
 20754 8300-EXIT.
 20755      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 382
* EL050.cbl
 20757
 20758
 20759 8400-GETMAIN-ERFORM.
 20760
 20761
 20762* EXEC CICS   GETMAIN
 20763*        LENGTH  (500)
 20764*        SET     (ADDRESS OF FORM-MASTER)
 20765*    END-EXEC.
 20766     MOVE 500
 20767       TO DFHEIV11
 20768*    MOVE '," L                  $   #00019748' TO DFHEIV0
 20769     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20770     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20771     MOVE X'2020233030303139373438' TO DFHEIV0(25:11)
 20772     CALL 'kxdfhei1' USING DFHEIV0,
 20773           DFHEIV20,
 20774           DFHEIV11,
 20775           DFHEIV99
 20776     SET ADDRESS OF FORM-MASTER TO
 20777         DFHEIV20
 20778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20779
 20780
 20781     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20782
 20783 8400-EXIT.
 20784      EXIT.
 20785
 20786 8450-READ-FORM-MASTER.
 20787
 20788
 20789* EXEC CICS  HANDLE CONDITION
 20790*        NOTFND   (8450-FORM-NOT-FOUND)
 20791*        ENDFILE  (8450-FORM-NOT-FOUND)
 20792*    END-EXEC.
 20793*    MOVE '"$I''                  ! 5 #00019760' TO DFHEIV0
 20794     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20796     MOVE X'3520233030303139373630' TO DFHEIV0(25:11)
 20797     CALL 'kxdfhei1' USING DFHEIV0
 20798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20799
 20800
 20801
 20802* EXEC CICS   READ
 20803*        DATASET   (FORM-ID)
 20804*        RIDFLD    (ERFORM-KEY)
 20805*        INTO      (FORM-MASTER)
 20806*        GTEQ
 20807*    END-EXEC.
 20808     MOVE LENGTH OF
 20809      FORM-MASTER
 20810       TO DFHEIV11
 20811*    MOVE '&"IL       G          (   #00019765' TO DFHEIV0
 20812     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20813     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20814     MOVE X'2020233030303139373635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 383
* EL050.cbl
 20815     CALL 'kxdfhei1' USING DFHEIV0,
 20816           FORM-ID,
 20817           FORM-MASTER,
 20818           DFHEIV11,
 20819           ERFORM-KEY,
 20820           DFHEIV99,
 20821           DFHEIV99,
 20822           DFHEIV99
 20823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20824
 20825
 20826     MOVE  'Y'           TO  FORM-MASTER-SW.
 20827
 20828     GO TO  8450-EXIT.
 20829
 20830 8450-FORM-NOT-FOUND.
 20831
 20832     MOVE  'N'           TO  FORM-MASTER-SW.
 20833
 20834 8450-EXIT.
 20835      EXIT.
 20836
 20837 8500-DATE-CONVERT.
 20838
 20839* EXEC CICS LINK
 20840*        PROGRAM    ('ELDATCV')
 20841*        COMMAREA   (DATE-CONVERSION-DATA)
 20842*        LENGTH     (DC-COMM-LENGTH)
 20843*    END-EXEC.
 20844     MOVE 'ELDATCV' TO DFHEIV1
 20845*    MOVE '."C                   (   #00019784' TO DFHEIV0
 20846     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20847     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20848     MOVE X'2020233030303139373834' TO DFHEIV0(25:11)
 20849     CALL 'kxdfhei1' USING DFHEIV0,
 20850           DFHEIV1,
 20851           DATE-CONVERSION-DATA,
 20852           DC-COMM-LENGTH,
 20853           DFHEIV99,
 20854           DFHEIV99,
 20855           DFHEIV99,
 20856           DFHEIV99
 20857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20858
 20859
 20860 8500-EXIT.
 20861     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 384
* EL050.cbl
 20863
 20864 8555-RELOAD-CONTROL-FILE.
 20865     CONTINUE.
 20866
 20867 8555-EXIT.
 20868     EXIT.
 20869
 20870 8557-GETMAIN-ERPLAN.
 20871
 20872
 20873* EXEC CICS GETMAIN
 20874*        LENGTH    (840)
 20875*        SET       (ADDRESS OF PLAN-RECORDS)
 20876*    END-EXEC.
 20877     MOVE 840
 20878       TO DFHEIV11
 20879*    MOVE '," L                  $   #00019802' TO DFHEIV0
 20880     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20881     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20882     MOVE X'2020233030303139383032' TO DFHEIV0(25:11)
 20883     CALL 'kxdfhei1' USING DFHEIV0,
 20884           DFHEIV20,
 20885           DFHEIV11,
 20886           DFHEIV99
 20887     SET ADDRESS OF PLAN-RECORDS TO
 20888         DFHEIV20
 20889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20890
 20891
 20892     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20893
 20894 8557-EXIT.
 20895     EXIT.
 20896
 20897 8560-GETMAIN.
 20898
 20899* EXEC CICS GETMAIN
 20900*        LENGTH    (2000)
 20901*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20902*    END-EXEC.
 20903     MOVE 2000
 20904       TO DFHEIV11
 20905*    MOVE '," L                  $   #00019813' TO DFHEIV0
 20906     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20907     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20908     MOVE X'2020233030303139383133' TO DFHEIV0(25:11)
 20909     CALL 'kxdfhei1' USING DFHEIV0,
 20910           DFHEIV20,
 20911           DFHEIV11,
 20912           DFHEIV99
 20913     SET ADDRESS OF ACCOUNT-MASTER TO
 20914         DFHEIV20
 20915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20916
 20917
 20918     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20919
 20920 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 385
* EL050.cbl
 20921     EXIT.
 20922
 20923 8570-START-ACCOUNT-MASTER.
 20924
 20925* EXEC CICS HANDLE CONDITION
 20926*        NOTFND    (0199-ACCT-NOT-FOUND)
 20927*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20928*    END-EXEC.
 20929*    MOVE '"$I''                  ! 6 #00019824' TO DFHEIV0
 20930     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20932     MOVE X'3620233030303139383234' TO DFHEIV0(25:11)
 20933     CALL 'kxdfhei1' USING DFHEIV0
 20934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20935
 20936
 20937
 20938* EXEC CICS STARTBR
 20939*        DATASET    (ACCT-ID)
 20940*        RIDFLD     (ERACCT-KEY)
 20941*        GTEQ
 20942*    END-EXEC.
 20943     MOVE 0
 20944       TO DFHEIV11
 20945*    MOVE '&,         G          &   #00019829' TO DFHEIV0
 20946     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20947     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20948     MOVE X'2020233030303139383239' TO DFHEIV0(25:11)
 20949     CALL 'kxdfhei1' USING DFHEIV0,
 20950           ACCT-ID,
 20951           ERACCT-KEY,
 20952           DFHEIV99,
 20953           DFHEIV11,
 20954           DFHEIV99
 20955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20956
 20957
 20958 8570-EXIT.
 20959     EXIT.
 20960
 20961 8580-READ-ACCOUNT-MASTER.
 20962
 20963* EXEC CICS HANDLE CONDITION
 20964*        NOTFND    (0199-ACCT-NOT-FOUND)
 20965*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20966*    END-EXEC.
 20967*    MOVE '"$I''                  ! 7 #00019839' TO DFHEIV0
 20968     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20970     MOVE X'3720233030303139383339' TO DFHEIV0(25:11)
 20971     CALL 'kxdfhei1' USING DFHEIV0
 20972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20973
 20974
 20975
 20976* EXEC CICS READNEXT
 20977*        DATASET     (ACCT-ID)
 20978*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 386
* EL050.cbl
 20979*        RIDFLD      (ERACCT-KEY)
 20980*    END-EXEC.
 20981     MOVE LENGTH OF
 20982      ACCOUNT-MASTER
 20983       TO DFHEIV12
 20984     MOVE 0
 20985       TO DFHEIV11
 20986*    MOVE '&.IL                  )   #00019844' TO DFHEIV0
 20987     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20988     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20989     MOVE X'2020233030303139383434' TO DFHEIV0(25:11)
 20990     CALL 'kxdfhei1' USING DFHEIV0,
 20991           ACCT-ID,
 20992           ACCOUNT-MASTER,
 20993           DFHEIV12,
 20994           ERACCT-KEY,
 20995           DFHEIV99,
 20996           DFHEIV11,
 20997           DFHEIV99,
 20998           DFHEIV99
 20999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21000
 21001
 21002 8580-EXIT.
 21003     EXIT.
 21004
 21005 8582-READ-COMPENSATION-MASTER.
 21006
 21007* EXEC CICS HANDLE CONDITION
 21008*        NOTFND    (8582-COMP-NOT-FOUND)
 21009*        ENDFILE   (8582-COMP-NOT-FOUND)
 21010*    END-EXEC.
 21011*    MOVE '"$I''                  ! 8 #00019854' TO DFHEIV0
 21012     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21014     MOVE X'3820233030303139383534' TO DFHEIV0(25:11)
 21015     CALL 'kxdfhei1' USING DFHEIV0
 21016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21017
 21018
 21019
 21020* EXEC CICS READ
 21021*        DATASET     (COMP-ID)
 21022*        INTO        (COMPENSATION-MASTER)
 21023*        RIDFLD      (ERCOMP-KEY)
 21024*    END-EXEC.
 21025     MOVE LENGTH OF
 21026      COMPENSATION-MASTER
 21027       TO DFHEIV11
 21028*    MOVE '&"IL       E          (   #00019859' TO DFHEIV0
 21029     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21031     MOVE X'2020233030303139383539' TO DFHEIV0(25:11)
 21032     CALL 'kxdfhei1' USING DFHEIV0,
 21033           COMP-ID,
 21034           COMPENSATION-MASTER,
 21035           DFHEIV11,
 21036           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 387
* EL050.cbl
 21037           DFHEIV99,
 21038           DFHEIV99,
 21039           DFHEIV99
 21040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21041
 21042
 21043     MOVE 'Y'                    TO COMP-MASTER-SW
 21044
 21045     GO TO 8582-EXIT
 21046     .
 21047 8582-COMP-NOT-FOUND.
 21048
 21049     MOVE 'N'                    TO COMP-MASTER-SW.
 21050
 21051 8582-EXIT.
 21052     EXIT.
 21053
 21054 8583-READ-ERAGTC.
 21055
 21056* EXEC CICS HANDLE CONDITION
 21057*        NOTFND    (8583-AGTC-NOT-FOUND)
 21058*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21059*    END-EXEC.
 21060*    MOVE '"$I''                  ! 9 #00019877' TO DFHEIV0
 21061     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21063     MOVE X'3920233030303139383737' TO DFHEIV0(25:11)
 21064     CALL 'kxdfhei1' USING DFHEIV0
 21065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21066
 21067
 21068
 21069* EXEC CICS STARTBR
 21070*        DATASET    (AGTC-ID)
 21071*        RIDFLD     (ERAGTC-KEY)
 21072*        GTEQ
 21073*    END-EXEC.
 21074     MOVE 0
 21075       TO DFHEIV11
 21076*    MOVE '&,         G          &   #00019882' TO DFHEIV0
 21077     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21078     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21079     MOVE X'2020233030303139383832' TO DFHEIV0(25:11)
 21080     CALL 'kxdfhei1' USING DFHEIV0,
 21081           AGTC-ID,
 21082           ERAGTC-KEY,
 21083           DFHEIV99,
 21084           DFHEIV11,
 21085           DFHEIV99
 21086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21087
 21088
 21089 8583-READ-ERAGTC-NEXT.
 21090
 21091* EXEC CICS READNEXT
 21092*        DATASET     (AGTC-ID)
 21093*        INTO        (AGENT-COMMISSIONS)
 21094*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 388
* EL050.cbl
 21095*    END-EXEC.
 21096     MOVE LENGTH OF
 21097      AGENT-COMMISSIONS
 21098       TO DFHEIV12
 21099     MOVE 0
 21100       TO DFHEIV11
 21101*    MOVE '&.IL                  )   #00019889' TO DFHEIV0
 21102     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21103     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21104     MOVE X'2020233030303139383839' TO DFHEIV0(25:11)
 21105     CALL 'kxdfhei1' USING DFHEIV0,
 21106           AGTC-ID,
 21107           AGENT-COMMISSIONS,
 21108           DFHEIV12,
 21109           ERAGTC-KEY,
 21110           DFHEIV99,
 21111           DFHEIV11,
 21112           DFHEIV99,
 21113           DFHEIV99
 21114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21115
 21116
 21117*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21118
 21119     GO TO 8583-EXIT
 21120     .
 21121 8583-AGTC-NOT-FOUND.
 21122
 21123     MOVE 'N'                    TO AGTC-MASTER-SW.
 21124
 21125 8583-EXIT.
 21126     EXIT.
 21127
 21128 8584-READ-BANK-CROSS-REF.
 21129
 21130* EXEC CICS HANDLE CONDITION
 21131*        NOTFND    (8584-BXRF-NOT-FOUND)
 21132*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21133*    END-EXEC.
 21134*    MOVE '"$I''                  ! : #00019907' TO DFHEIV0
 21135     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21136     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21137     MOVE X'3A20233030303139393037' TO DFHEIV0(25:11)
 21138     CALL 'kxdfhei1' USING DFHEIV0
 21139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21140
 21141
 21142
 21143* EXEC CICS READ
 21144*        DATASET     (BXRF-ID)
 21145*        INTO        (BANK-CROSS-REFERENCE)
 21146*        RIDFLD      (ERBXRF-KEY)
 21147*        LENGTH      (BXRF-REC-LENGTH)
 21148*    END-EXEC.
 21149*    MOVE '&"IL       E          (   #00019912' TO DFHEIV0
 21150     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21151     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21152     MOVE X'2020233030303139393132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 389
* EL050.cbl
 21153     CALL 'kxdfhei1' USING DFHEIV0,
 21154           BXRF-ID,
 21155           BANK-CROSS-REFERENCE,
 21156           BXRF-REC-LENGTH,
 21157           ERBXRF-KEY,
 21158           DFHEIV99,
 21159           DFHEIV99,
 21160           DFHEIV99
 21161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21162
 21163
 21164     MOVE 'Y'                    TO BXRF-MASTER-SW
 21165
 21166     GO TO 8584-EXIT
 21167     .
 21168 8584-BXRF-NOT-FOUND.
 21169
 21170     MOVE 'N'                    TO BXRF-MASTER-SW.
 21171
 21172 8584-EXIT.
 21173     EXIT.
 21174
 21175 8585-READ-PLAN-MASTER.
 21176
 21177
 21178* EXEC CICS HANDLE CONDITION
 21179*        NOTFND    (8585-PLAN-NOT-FOUND)
 21180*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21181*    END-EXEC.
 21182*    MOVE '"$I''                  ! ; #00019932' TO DFHEIV0
 21183     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21184     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21185     MOVE X'3B20233030303139393332' TO DFHEIV0(25:11)
 21186     CALL 'kxdfhei1' USING DFHEIV0
 21187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21188
 21189
 21190
 21191* EXEC CICS READ
 21192*        DATASET     (PLAN-ID)
 21193*        INTO        (PLAN-MASTER)
 21194*        RIDFLD      (ERPLAN-KEY)
 21195*    END-EXEC.
 21196     MOVE LENGTH OF
 21197      PLAN-MASTER
 21198       TO DFHEIV11
 21199*    MOVE '&"IL       E          (   #00019937' TO DFHEIV0
 21200     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21201     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21202     MOVE X'2020233030303139393337' TO DFHEIV0(25:11)
 21203     CALL 'kxdfhei1' USING DFHEIV0,
 21204           PLAN-ID,
 21205           PLAN-MASTER,
 21206           DFHEIV11,
 21207           ERPLAN-KEY,
 21208           DFHEIV99,
 21209           DFHEIV99,
 21210           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 390
* EL050.cbl
 21211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21212
 21213
 21214     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21215
 21216     GO TO 8585-EXIT.
 21217
 21218 8585-PLAN-NOT-FOUND.
 21219
 21220     MOVE 'N'                    TO PLAN-MASTER-SW.
 21221
 21222 8585-EXIT.
 21223     EXIT.
 21224
 21225 8586-READ-LOAN-OFFICER.
 21226
 21227* EXEC CICS READ
 21228*        DATASET     (LOFC-ID)
 21229*        INTO        (LOAN-OFFICER-MASTER)
 21230*        RIDFLD      (ERLOFC-KEY)
 21231*        RESP        (WS-RESPONSE)
 21232*    END-EXEC
 21233     MOVE LENGTH OF
 21234      LOAN-OFFICER-MASTER
 21235       TO DFHEIV11
 21236*    MOVE '&"IL       E          (  N#00019955' TO DFHEIV0
 21237     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21239     MOVE X'204E233030303139393535' TO DFHEIV0(25:11)
 21240     CALL 'kxdfhei1' USING DFHEIV0,
 21241           LOFC-ID,
 21242           LOAN-OFFICER-MASTER,
 21243           DFHEIV11,
 21244           ERLOFC-KEY,
 21245           DFHEIV99,
 21246           DFHEIV99,
 21247           DFHEIV99
 21248     MOVE EIBRESP  TO WS-RESPONSE
 21249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21250
 21251     IF WS-RESP-NORMAL
 21252        MOVE 'Y'                 TO LOFC-MASTER-SW
 21253     ELSE
 21254        MOVE 'N'                 TO LOFC-MASTER-SW
 21255     END-IF
 21256     .
 21257 8586-EXIT.
 21258     EXIT.
 21259 8587-START-ERPDEF.
 21260
 21261* EXEC CICS STARTBR
 21262*       DATASET   (PDEF-ID)
 21263*       RIDFLD    (ERPDEF-KEY)
 21264*       GTEQ
 21265*       RESP      (WS-RESPONSE)
 21266*    END-EXEC
 21267     MOVE 0
 21268       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 391
* EL050.cbl
 21269*    MOVE '&,         G          &  N#00019971' TO DFHEIV0
 21270     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21271     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21272     MOVE X'204E233030303139393731' TO DFHEIV0(25:11)
 21273     CALL 'kxdfhei1' USING DFHEIV0,
 21274           PDEF-ID,
 21275           ERPDEF-KEY,
 21276           DFHEIV99,
 21277           DFHEIV11,
 21278           DFHEIV99
 21279     MOVE EIBRESP  TO WS-RESPONSE
 21280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21281     IF WS-RESP-NORMAL
 21282        MOVE 'Y'                 TO PDEF-MASTER-SW
 21283     ELSE
 21284        MOVE 'N'                 TO PDEF-MASTER-SW
 21285     END-IF
 21286     .
 21287 8587-EXIT.
 21288     EXIT.
 21289 8588-READ-ERPDEF.
 21290
 21291* EXEC CICS READNEXT
 21292*       DATASET   (PDEF-ID)
 21293*       RIDFLD    (ERPDEF-KEY)
 21294*       INTO      (PRODUCT-MASTER)
 21295*       RESP      (WS-RESPONSE)
 21296*    END-EXEC
 21297     MOVE LENGTH OF
 21298      PRODUCT-MASTER
 21299       TO DFHEIV12
 21300     MOVE 0
 21301       TO DFHEIV11
 21302*    MOVE '&.IL                  )  N#00019986' TO DFHEIV0
 21303     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21304     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21305     MOVE X'204E233030303139393836' TO DFHEIV0(25:11)
 21306     CALL 'kxdfhei1' USING DFHEIV0,
 21307           PDEF-ID,
 21308           PRODUCT-MASTER,
 21309           DFHEIV12,
 21310           ERPDEF-KEY,
 21311           DFHEIV99,
 21312           DFHEIV11,
 21313           DFHEIV99,
 21314           DFHEIV99
 21315     MOVE EIBRESP  TO WS-RESPONSE
 21316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21317     IF WS-RESP-NORMAL
 21318        MOVE 'Y'                 TO PDEF-MASTER-SW
 21319     ELSE
 21320        MOVE 'N'                 TO PDEF-MASTER-SW
 21321     END-IF
 21322     .
 21323 8588-EXIT.
 21324     EXIT.
 21325 8589-ENDBR-ERPDEF.
 21326
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 392
* EL050.cbl
 21327* EXEC CICS ENDBR
 21328*       DATASET   (PDEF-ID)
 21329*    END-EXEC
 21330     MOVE 0
 21331       TO DFHEIV11
 21332*    MOVE '&2                    $   #00020001' TO DFHEIV0
 21333     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21334     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21335     MOVE X'2020233030303230303031' TO DFHEIV0(25:11)
 21336     CALL 'kxdfhei1' USING DFHEIV0,
 21337           PDEF-ID,
 21338           DFHEIV11,
 21339           DFHEIV99
 21340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21341     .
 21342 8589-EXIT.
 21343     EXIT.
 21344 8590-READ-CERT-MASTER.
 21345     IF PB-COMPANY-ID = 'UCL'
 21346         GO TO 8690-READ-CERT-MASTER-UCL.
 21347
 21348
 21349* EXEC CICS HANDLE CONDITION
 21350*         NOTFND    (0299-CERT-NOT-FOUND)
 21351*    END-EXEC.
 21352*    MOVE '"$I                   ! < #00020011' TO DFHEIV0
 21353     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21355     MOVE X'3C20233030303230303131' TO DFHEIV0(25:11)
 21356     CALL 'kxdfhei1' USING DFHEIV0
 21357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21358
 21359
 21360
 21361* EXEC CICS READ
 21362*        DATASET     (CERT-ID)
 21363*        INTO        (CERTIFICATE-MASTER)
 21364*        RIDFLD      (ELCERT-KEY)
 21365*        UPDATE
 21366*    END-EXEC.
 21367     MOVE LENGTH OF
 21368      CERTIFICATE-MASTER
 21369       TO DFHEIV11
 21370*    MOVE '&"IL       EU         (   #00020015' TO DFHEIV0
 21371     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21372     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21373     MOVE X'2020233030303230303135' TO DFHEIV0(25:11)
 21374     CALL 'kxdfhei1' USING DFHEIV0,
 21375           CERT-ID,
 21376           CERTIFICATE-MASTER,
 21377           DFHEIV11,
 21378           ELCERT-KEY,
 21379           DFHEIV99,
 21380           DFHEIV99,
 21381           DFHEIV99
 21382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21383
 21384
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 393
* EL050.cbl
 21385 8590-EXIT.
 21386     EXIT.
 21387
 21388 8690-READ-CERT-MASTER-UCL.
 21389
 21390* EXEC CICS HANDLE CONDITION
 21391*         NOTFND    (8700-READ-CERT-MASTER)
 21392*    END-EXEC.
 21393*    MOVE '"$I                   ! = #00020026' TO DFHEIV0
 21394     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21396     MOVE X'3D20233030303230303236' TO DFHEIV0(25:11)
 21397     CALL 'kxdfhei1' USING DFHEIV0
 21398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21399
 21400
 21401 8690-READ-CERT-CONT.
 21402
 21403* EXEC CICS READ
 21404*        DATASET     (CERT-ID)
 21405*        INTO        (CERTIFICATE-MASTER)
 21406*        RIDFLD      (ELCERT-KEY)
 21407*        UPDATE
 21408*    END-EXEC.
 21409     MOVE LENGTH OF
 21410      CERTIFICATE-MASTER
 21411       TO DFHEIV11
 21412*    MOVE '&"IL       EU         (   #00020031' TO DFHEIV0
 21413     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21414     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21415     MOVE X'2020233030303230303331' TO DFHEIV0(25:11)
 21416     CALL 'kxdfhei1' USING DFHEIV0,
 21417           CERT-ID,
 21418           CERTIFICATE-MASTER,
 21419           DFHEIV11,
 21420           ELCERT-KEY,
 21421           DFHEIV99,
 21422           DFHEIV99,
 21423           DFHEIV99
 21424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21425
 21426
 21427     GO TO 8590-EXIT.
 21428
 21429 8700-READ-CERT-MASTER.
 21430     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21431     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21432
 21433* EXEC CICS HANDLE CONDITION
 21434*         DUPKEY    (8720-COMP-ACCOUNTS)
 21435*         ENDFILE   (8730-END-BROWSE)
 21436*         NOTFND    (8740-NOT-FOUND)
 21437*    END-EXEC.
 21438*    MOVE '"$$''I                 ! > #00020043' TO DFHEIV0
 21439     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21441     MOVE X'3E20233030303230303433' TO DFHEIV0(25:11)
 21442     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 394
* EL050.cbl
 21443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21444
 21445
 21446
 21447* EXEC CICS STARTBR
 21448*        DATASET     ('ELCERT5')
 21449*        RIDFLD      (ELCERT2-KEY)
 21450*        EQUAL
 21451*    END-EXEC.
 21452     MOVE 'ELCERT5' TO DFHEIV1
 21453     MOVE 0
 21454       TO DFHEIV11
 21455*    MOVE '&,         E          &   #00020049' TO DFHEIV0
 21456     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21457     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21458     MOVE X'2020233030303230303439' TO DFHEIV0(25:11)
 21459     CALL 'kxdfhei1' USING DFHEIV0,
 21460           DFHEIV1,
 21461           ELCERT2-KEY,
 21462           DFHEIV99,
 21463           DFHEIV11,
 21464           DFHEIV99
 21465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21466
 21467
 21468 8710-READ-NEXT.
 21469
 21470* EXEC CICS READNEXT
 21471*        DATASET     ('ELCERT5')
 21472*        INTO        (CERTIFICATE-MASTER)
 21473*        RIDFLD      (ELCERT2-KEY)
 21474*    END-EXEC.
 21475     MOVE LENGTH OF
 21476      CERTIFICATE-MASTER
 21477       TO DFHEIV12
 21478     MOVE 'ELCERT5' TO DFHEIV1
 21479     MOVE 0
 21480       TO DFHEIV11
 21481*    MOVE '&.IL                  )   #00020056' TO DFHEIV0
 21482     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21483     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21484     MOVE X'2020233030303230303536' TO DFHEIV0(25:11)
 21485     CALL 'kxdfhei1' USING DFHEIV0,
 21486           DFHEIV1,
 21487           CERTIFICATE-MASTER,
 21488           DFHEIV12,
 21489           ELCERT2-KEY,
 21490           DFHEIV99,
 21491           DFHEIV11,
 21492           DFHEIV99,
 21493           DFHEIV99
 21494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21495
 21496
 21497 8720-COMP-ACCOUNTS.
 21498
 21499* EXEC CICS ENTER
 21500*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 395
* EL050.cbl
 21501*         FROM (PB-C-LAST-NAME)
 21502*    END-EXEC.
 21503     MOVE 001
 21504       TO DFHEIV11
 21505*    MOVE ':$F                   %   #00020063' TO DFHEIV0
 21506     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21507     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21508     MOVE X'2020233030303230303633' TO DFHEIV0(25:11)
 21509     CALL 'kxdfhei1' USING DFHEIV0,
 21510           DFHEIV11,
 21511           PB-C-LAST-NAME,
 21512           DFHEIV99,
 21513           DFHEIV99
 21514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21515
 21516
 21517
 21518* EXEC CICS ENTER
 21519*         TRACEID (002)
 21520*         FROM (CM-INSURED-LAST-NAME)
 21521*    END-EXEC.
 21522     MOVE 002
 21523       TO DFHEIV11
 21524*    MOVE ':$F                   %   #00020068' TO DFHEIV0
 21525     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21526     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21527     MOVE X'2020233030303230303638' TO DFHEIV0(25:11)
 21528     CALL 'kxdfhei1' USING DFHEIV0,
 21529           DFHEIV11,
 21530           CM-INSURED-LAST-NAME,
 21531           DFHEIV99,
 21532           DFHEIV99
 21533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21534
 21535
 21536     IF PB-CERT-NO NOT = CM-CERT-NO
 21537         GO TO 8730-END-BROWSE.
 21538
 21539     IF PB-ACCOUNT = CM-ACCOUNT
 21540         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21541             MOVE ER-2799        TO WS-ERROR
 21542             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21543             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21544             GO TO 8730-END-BROWSE.
 21545
 21546     GO TO 8710-READ-NEXT.
 21547
 21548 8730-END-BROWSE.
 21549
 21550* EXEC CICS ENDBR
 21551*         DATASET    ('ELCERT5')
 21552*    END-EXEC.
 21553     MOVE 'ELCERT5' TO DFHEIV1
 21554     MOVE 0
 21555       TO DFHEIV11
 21556*    MOVE '&2                    $   #00020086' TO DFHEIV0
 21557     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21558     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 396
* EL050.cbl
 21559     MOVE X'2020233030303230303836' TO DFHEIV0(25:11)
 21560     CALL 'kxdfhei1' USING DFHEIV0,
 21561           DFHEIV1,
 21562           DFHEIV11,
 21563           DFHEIV99
 21564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21565
 21566
 21567 8740-NOT-FOUND.
 21568     GO TO 0299-CERT-NOT-FOUND.
 21569
 21570 8750-START-ELSTAT.
 21571
 21572* EXEC CICS STARTBR
 21573*       DATASET   (STAT-ID)
 21574*       RIDFLD    (ELSTAT-KEY)
 21575*       GTEQ
 21576*       RESP      (WS-RESPONSE)
 21577*    END-EXEC
 21578     MOVE 0
 21579       TO DFHEIV11
 21580*    MOVE '&,         G          &  N#00020094' TO DFHEIV0
 21581     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21582     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21583     MOVE X'204E233030303230303934' TO DFHEIV0(25:11)
 21584     CALL 'kxdfhei1' USING DFHEIV0,
 21585           STAT-ID,
 21586           ELSTAT-KEY,
 21587           DFHEIV99,
 21588           DFHEIV11,
 21589           DFHEIV99
 21590     MOVE EIBRESP  TO WS-RESPONSE
 21591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21592     IF WS-RESP-NORMAL
 21593        MOVE 'Y'                 TO STAT-MASTER-SW
 21594     ELSE
 21595        MOVE 'N'                 TO STAT-MASTER-SW
 21596     END-IF
 21597     .
 21598 8750-EXIT.
 21599     EXIT.
 21600 8752-READ-ELSTAT.
 21601
 21602* EXEC CICS READNEXT
 21603*       DATASET   (STAT-ID)
 21604*       RIDFLD    (ELSTAT-KEY)
 21605*       INTO      (STATE-FILE)
 21606*       RESP      (WS-RESPONSE)
 21607*    END-EXEC
 21608     MOVE LENGTH OF
 21609      STATE-FILE
 21610       TO DFHEIV12
 21611     MOVE 0
 21612       TO DFHEIV11
 21613*    MOVE '&.IL                  )  N#00020109' TO DFHEIV0
 21614     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21615     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21616     MOVE X'204E233030303230313039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 397
* EL050.cbl
 21617     CALL 'kxdfhei1' USING DFHEIV0,
 21618           STAT-ID,
 21619           STATE-FILE,
 21620           DFHEIV12,
 21621           ELSTAT-KEY,
 21622           DFHEIV99,
 21623           DFHEIV11,
 21624           DFHEIV99,
 21625           DFHEIV99
 21626     MOVE EIBRESP  TO WS-RESPONSE
 21627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21628     IF WS-RESP-NORMAL
 21629        MOVE 'Y'                 TO STAT-MASTER-SW
 21630     ELSE
 21631        MOVE 'N'                 TO STAT-MASTER-SW
 21632     END-IF
 21633     .
 21634 8752-EXIT.
 21635     EXIT.
 21636 8800-GET-COMP-RATE.
 21637     MOVE +1 TO IB.
 21638     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21639         ADD +9 TO IB
 21640         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21641             ADD +9 TO IB
 21642             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21643                MOVE ZEROS       TO WS-WK-RATE
 21644                GO TO 8800-EXIT.
 21645
 21646     IF PB-I-AGE GREATER CT-AGE (1)
 21647         ADD +3 TO IB
 21648         IF PB-I-AGE GREATER CT-AGE (2)
 21649             ADD +3 TO IB
 21650             IF PB-I-AGE GREATER CT-AGE (3)
 21651                MOVE ZEROS       TO WS-WK-RATE
 21652                GO TO 8800-EXIT.
 21653
 21654     IF WS-WORK-TERM GREATER CT-TRM (1)
 21655         ADD +1 TO IB
 21656         IF WS-WORK-TERM GREATER CT-TRM (2)
 21657             ADD +1 TO IB
 21658             IF WS-WORK-TERM GREATER CT-TRM (3)
 21659                MOVE ZEROS       TO WS-WK-RATE
 21660                GO TO 8800-EXIT.
 21661
 21662     IF CT-RT (IB) NOT NUMERIC
 21663         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21664         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21665         GO TO 8800-GET-COMP-RATE.
 21666
 21667     MOVE CT-RT (IB) TO WS-WK-RATE.
 21668
 21669 8800-EXIT.
 21670     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 398
* EL050.cbl
 21672 8900-ADDRESS-FILE.
 21673     IF ERACCT-FILE-ADDRESSED
 21674         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21675         GO TO 8900-ADDRESS-EXIT.
 21676
 21677     IF ELCNTL-FILE-ADDRESSED
 21678         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21679         GO TO 8900-ADDRESS-EXIT.
 21680
 21681     IF ERPLAN-FILE-ADDRESSED
 21682         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21683         GO TO 8900-ADDRESS-EXIT.
 21684
 21685     IF ERFORM-FILE-ADDRESSED
 21686         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21687         GO TO 8900-ADDRESS-EXIT.
 21688
 21689 8900-ADDRESS-EXIT.
 21690     EXIT.
 21691
 21692 9000-READ-CONTROL.
 21693
 21694* EXEC CICS HANDLE CONDITION
 21695*        NOTFND    (9000-NOTFND)
 21696*    END-EXEC.
 21697*    MOVE '"$I                   ! ? #00020180' TO DFHEIV0
 21698     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21700     MOVE X'3F20233030303230313830' TO DFHEIV0(25:11)
 21701     CALL 'kxdfhei1' USING DFHEIV0
 21702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21703
 21704
 21705
 21706* EXEC CICS READ
 21707*        DATASET     (CNTL-ID)
 21708*        SET         (ADDRESS OF CONTROL-FILE)
 21709*        RIDFLD      (ELCNTL-KEY)
 21710*        GTEQ
 21711*    END-EXEC.
 21712*    MOVE '&"S        G          (   #00020184' TO DFHEIV0
 21713     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21715     MOVE X'2020233030303230313834' TO DFHEIV0(25:11)
 21716     CALL 'kxdfhei1' USING DFHEIV0,
 21717           CNTL-ID,
 21718           DFHEIV20,
 21719           DFHEIV99,
 21720           ELCNTL-KEY,
 21721           DFHEIV99,
 21722           DFHEIV99,
 21723           DFHEIV99
 21724     SET ADDRESS OF CONTROL-FILE TO
 21725         DFHEIV20
 21726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21727
 21728
 21729     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 399
* EL050.cbl
 21730
 21731 9000-NOTFND.
 21732     IF RC-SW-1 = '1'
 21733        MOVE ER-2616              TO WS-ERROR
 21734        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21735        GO TO 9000-EXIT.
 21736
 21737     IF RC-SW-1 = '2'
 21738        MOVE ER-2602              TO WS-ERROR
 21739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21740
 21741 9000-EXIT.
 21742      EXIT.
 21743
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 400
* EL050.cbl
 21745 9100-READ-CONTROL.
 21746
 21747* EXEC CICS HANDLE CONDITION
 21748*        NOTFND  (9100-NOTFND)
 21749*        ENDFILE (9100-NOTFND)
 21750*    END-EXEC.
 21751*    MOVE '"$I''                  ! @ #00020208' TO DFHEIV0
 21752     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21754     MOVE X'4020233030303230323038' TO DFHEIV0(25:11)
 21755     CALL 'kxdfhei1' USING DFHEIV0
 21756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21757
 21758
 21759
 21760* EXEC CICS READ
 21761*        DATASET     (CNTL-ID)
 21762*        INTO        (CONTROL-FILE)
 21763*        RIDFLD      (ELCNTL-KEY)
 21764*        GTEQ
 21765*    END-EXEC.
 21766     MOVE LENGTH OF
 21767      CONTROL-FILE
 21768       TO DFHEIV11
 21769*    MOVE '&"IL       G          (   #00020213' TO DFHEIV0
 21770     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21772     MOVE X'2020233030303230323133' TO DFHEIV0(25:11)
 21773     CALL 'kxdfhei1' USING DFHEIV0,
 21774           CNTL-ID,
 21775           CONTROL-FILE,
 21776           DFHEIV11,
 21777           ELCNTL-KEY,
 21778           DFHEIV99,
 21779           DFHEIV99,
 21780           DFHEIV99
 21781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21782
 21783
 21784     GO TO 9100-EXIT.
 21785
 21786 9100-NOTFND.
 21787     IF RC-SW-2 = '0'
 21788        MOVE '1'                  TO STATE-RECORD-ERROR
 21789        GO TO 9100-EXIT
 21790     END-IF
 21791     IF RC-SW-2 = '1'
 21792        MOVE '1'                  TO LF-BENEFIT-ERROR
 21793        MOVE ER-2604              TO WS-ERROR
 21794        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21795        GO TO 9100-EXIT.
 21796
 21797     IF RC-SW-2 = '2'
 21798        MOVE '1'                  TO AH-BENEFIT-ERROR
 21799        MOVE ER-2605              TO WS-ERROR
 21800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21801        GO TO 9100-EXIT.
 21802
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 401
* EL050.cbl
 21803     IF RC-SW-2 = '3'
 21804         MOVE ER-2603           TO WS-ERROR
 21805         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21806         GO TO 9100-EXIT.
 21807
 21808     IF RC-SW-2 = '4'
 21809         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21810         GO TO 9100-EXIT.
 21811
 21812     IF RC-SW-2 = '5'
 21813         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21814         IF WS-AH-INPUT-CD-1 = SPACE
 21815             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21816         ELSE
 21817             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21818
 21819 9100-EXIT.
 21820      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 402
* EL050.cbl
 21822 9200-CONTROL-GETMAIN.
 21823
 21824* EXEC CICS GETMAIN
 21825*         LENGTH   (750)
 21826*         SET      (ADDRESS OF CONTROL-FILE)
 21827*    END-EXEC.
 21828     MOVE 750
 21829       TO DFHEIV11
 21830*    MOVE '," L                  $   #00020259' TO DFHEIV0
 21831     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21832     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21833     MOVE X'2020233030303230323539' TO DFHEIV0(25:11)
 21834     CALL 'kxdfhei1' USING DFHEIV0,
 21835           DFHEIV20,
 21836           DFHEIV11,
 21837           DFHEIV99
 21838     SET ADDRESS OF CONTROL-FILE TO
 21839         DFHEIV20
 21840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21841
 21842
 21843     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21844
 21845 9200-EXIT.
 21846     EXIT.
 21847
 21848 9250-UNLOCK-RETURN.
 21849
 21850* EXEC CICS UNLOCK
 21851*        DATASET   (CERT-ID)
 21852*    END-EXEC.
 21853*    MOVE '&*                    #   #00020270' TO DFHEIV0
 21854     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21855     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21856     MOVE X'2020233030303230323730' TO DFHEIV0(25:11)
 21857     CALL 'kxdfhei1' USING DFHEIV0,
 21858           CERT-ID,
 21859           DFHEIV99
 21860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21861
 21862
 21863 9300-ABEND.
 21864     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21865
 21866
 21867* EXEC CICS LINK
 21868*        PROGRAM   ('EL004')
 21869*        COMMAREA  (WS-ERROR-LINE)
 21870*        LENGTH    (72)
 21871*    END-EXEC.
 21872     MOVE 'EL004' TO DFHEIV1
 21873     MOVE 72
 21874       TO DFHEIV11
 21875*    MOVE '."C                   (   #00020277' TO DFHEIV0
 21876     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21878     MOVE X'2020233030303230323737' TO DFHEIV0(25:11)
 21879     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 403
* EL050.cbl
 21880           DFHEIV1,
 21881           WS-ERROR-LINE,
 21882           DFHEIV11,
 21883           DFHEIV99,
 21884           DFHEIV99,
 21885           DFHEIV99,
 21886           DFHEIV99
 21887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21888
 21889
 21890     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21891
 21892
 21893* EXEC CICS ABEND
 21894*        ABCODE ('EL50')
 21895*    END-EXEC.
 21896     MOVE 'EL50' TO DFHEIV5
 21897*    MOVE '.,A                   "   #00020285' TO DFHEIV0
 21898     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21899     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21900     MOVE X'2020233030303230323835' TO DFHEIV0(25:11)
 21901     CALL 'kxdfhei1' USING DFHEIV0,
 21902           DFHEIV5
 21903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21904
 21905
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 404
* EL050.cbl
 21907
 21908******************************************************************
 21909*                                                                *
 21910*            E R R O R   F O R M A T   R O U T I N E             *
 21911*                                                                *
 21912******************************************************************
 21913
 21914 9900-ERROR-FORMAT.
 21915
 21916     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21917                    PB-COMMON-ERROR (2) OR
 21918                    PB-COMMON-ERROR (3) OR
 21919                    PB-COMMON-ERROR (4) OR
 21920                    PB-COMMON-ERROR (5) OR
 21921                    PB-COMMON-ERROR (6) OR
 21922                    PB-COMMON-ERROR (7) OR
 21923                    PB-COMMON-ERROR (8) OR
 21924                    PB-COMMON-ERROR (9) OR
 21925                    PB-COMMON-ERROR (10)
 21926        GO TO 9900-EXIT.
 21927
 21928     IF PB-NO-OF-ERRORS = +10
 21929        GO TO 9900-EXIT.
 21930
 21931     ADD +1  TO PB-NO-OF-ERRORS.
 21932     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21933                                       (PB-NO-OF-ERRORS).
 21934 9900-EXIT.
 21935     EXIT.
 21936
 21937 9990-RETURN.
 21938     IF BROWSE-STARTED
 21939
 21940* EXEC CICS ENDBR
 21941*            DATASET  (ACCT-ID)
 21942*       END-EXEC.
 21943     MOVE 0
 21944       TO DFHEIV11
 21945*    MOVE '&2                    $   #00020322' TO DFHEIV0
 21946     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21947     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21948     MOVE X'2020233030303230333232' TO DFHEIV0(25:11)
 21949     CALL 'kxdfhei1' USING DFHEIV0,
 21950           ACCT-ID,
 21951           DFHEIV11,
 21952           DFHEIV99
 21953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21954
 21955
 21956 9990-EXIT.
 21957     EXIT.
 21958
 21959
 21960****Check for CRTO record, add one if not found.
 21961 9991-CHECK-FOR-ELCRTO.
 21962
 21963* EXEC CICS HANDLE CONDITION
 21964*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 405
* EL050.cbl
 21965*         ENDFILE (9991-CRTO-NOT-FOUND)
 21966*     END-EXEC.
 21967*    MOVE '"$I''                  ! A #00020332' TO DFHEIV0
 21968     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21970     MOVE X'4120233030303230333332' TO DFHEIV0(25:11)
 21971     CALL 'kxdfhei1' USING DFHEIV0
 21972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21973
 21974     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21975     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21976     MOVE +0                     TO ELCRTO-SEQ-NO
 21977
 21978
 21979* EXEC CICS READ
 21980*       DATASET   ('ELCRTO')
 21981*       INTO      (ORIGINAL-CERTIFICATE)
 21982*       RIDFLD    (ELCRTO-KEY)
 21983*       GTEQ
 21984*       RESP      (WS-RESPONSE)
 21985*    END-EXEC
 21986     MOVE LENGTH OF
 21987      ORIGINAL-CERTIFICATE
 21988       TO DFHEIV11
 21989     MOVE 'ELCRTO' TO DFHEIV1
 21990*    MOVE '&"IL       G          (  N#00020340' TO DFHEIV0
 21991     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21993     MOVE X'204E233030303230333430' TO DFHEIV0(25:11)
 21994     CALL 'kxdfhei1' USING DFHEIV0,
 21995           DFHEIV1,
 21996           ORIGINAL-CERTIFICATE,
 21997           DFHEIV11,
 21998           ELCRTO-KEY,
 21999           DFHEIV99,
 22000           DFHEIV99,
 22001           DFHEIV99
 22002     MOVE EIBRESP  TO WS-RESPONSE
 22003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22004
 22005     IF WS-RESP-NORMAL
 22006        AND (OC-CONTROL-PRIMARY (1:33) =
 22007                 PB-CONTROL-BY-ACCOUNT (1:33))
 22008        AND (OC-RECORD-TYPE =  'I')
 22009           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22010               GO TO 9991-CHECK-INDICATORS
 22011           ELSE
 22012               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22013               GO TO 9991-CRTO-ADD-REC
 22014           END-IF
 22015     END-IF.
 22016
 22017 9991-CRTO-NOT-FOUND.
 22018
 22019     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22020     MOVE 'OC'                TO OC-RECORD-ID
 22021     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22022                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 406
* EL050.cbl
 22023     MOVE +4096               TO OC-KEY-SEQ-NO.
 22024
 22025 9991-CRTO-ADD-REC.
 22026
 22027     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22028     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22029     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22030     MOVE 'I'                 TO OC-RECORD-TYPE
 22031     IF PB-ISSUE
 22032         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22033         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22034         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22035         MOVE PB-I-AGE               TO OC-INS-AGE
 22036         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22037         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22038         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22039         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22040         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22041         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22042         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22043         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22044         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22045         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22046         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22047         IF PB-I-JOINT-COMMISSION > +0
 22048             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22049         ELSE
 22050             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22051         END-IF
 22052         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22053         MOVE +0                     TO OC-LF-CANCEL-AMT
 22054                                        OC-LF-ITD-CANCEL-AMT
 22055         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22056         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22057         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22058         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22059         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22060         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22061         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22062         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22063         MOVE +0                     TO OC-AH-CANCEL-AMT
 22064                                        OC-AH-ITD-CANCEL-AMT
 22065         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22066         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22067         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22068     ELSE
 22069         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22070         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22071         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22072         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22073         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22074         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22075         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22076         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22077         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22078          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22079             MOVE SPACES             TO OC-LF-BENCD
 22080             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 407
* EL050.cbl
 22081                                        OC-LF-BEN-AMT
 22082                                        OC-LF-PRM-AMT
 22083                                        OC-LF-ALT-BEN-AMT
 22084                                        OC-LF-ALT-PRM-AMT
 22085                                        OC-LF-COMM-PCT
 22086                                        OC-LF-CANCEL-AMT
 22087             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22088             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22089         ELSE
 22090             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22091             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22092             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22093             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22094             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22095             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22096             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22097             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22098             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22099             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22100         END-IF
 22101         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22102         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22103          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22104             MOVE SPACES             TO OC-AH-BENCD
 22105             MOVE ZEROS              TO OC-AH-TERM
 22106                                        OC-AH-BEN-AMT
 22107                                        OC-AH-PRM-AMT
 22108                                        OC-AH-COMM-PCT
 22109                                        OC-AH-CANCEL-AMT
 22110                                        OC-AH-CP
 22111             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22112             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22113         ELSE
 22114             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22115             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22116             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22117             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22118             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22119             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22120             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22121             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22122             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22123         END-IF
 22124         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22125         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22126         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22127         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22128     END-IF
 22129     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22130
 22131     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22132
 22133
 22134* EXEC CICS READ
 22135*         DATASET   (FILE-ERMAIL)
 22136*         RIDFLD    (MA-CONTROL-PRIMARY)
 22137*         INTO      (MAILING-DATA)
 22138*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 408
* EL050.cbl
 22139*    END-EXEC
 22140     MOVE LENGTH OF
 22141      MAILING-DATA
 22142       TO DFHEIV11
 22143*    MOVE '&"IL       E          (  N#00020476' TO DFHEIV0
 22144     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22146     MOVE X'204E233030303230343736' TO DFHEIV0(25:11)
 22147     CALL 'kxdfhei1' USING DFHEIV0,
 22148           FILE-ERMAIL,
 22149           MAILING-DATA,
 22150           DFHEIV11,
 22151           MA-CONTROL-PRIMARY,
 22152           DFHEIV99,
 22153           DFHEIV99,
 22154           DFHEIV99
 22155     MOVE EIBRESP  TO WS-RESPONSE
 22156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22157
 22158     IF WS-RESP-NORMAL
 22159         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22160     END-IF.
 22161
 22162     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22163     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22164
 22165
 22166* EXEC CICS READ
 22167*         DATASET  (CRTT-ID)
 22168*         RIDFLD   (WS-ELCRTT-KEY)
 22169*         INTO     (CERTIFICATE-TRAILERS)
 22170*         RESP     (WS-RESPONSE)
 22171*    END-EXEC
 22172     MOVE LENGTH OF
 22173      CERTIFICATE-TRAILERS
 22174       TO DFHEIV11
 22175*    MOVE '&"IL       E          (  N#00020490' TO DFHEIV0
 22176     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22177     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22178     MOVE X'204E233030303230343930' TO DFHEIV0(25:11)
 22179     CALL 'kxdfhei1' USING DFHEIV0,
 22180           CRTT-ID,
 22181           CERTIFICATE-TRAILERS,
 22182           DFHEIV11,
 22183           WS-ELCRTT-KEY,
 22184           DFHEIV99,
 22185           DFHEIV99,
 22186           DFHEIV99
 22187     MOVE EIBRESP  TO WS-RESPONSE
 22188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22189
 22190     IF WS-RESP-NORMAL
 22191         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22192         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22193     END-IF.
 22194
 22195
 22196* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 409
* EL050.cbl
 22197*       DATASET   ('ELCRTO')
 22198*       FROM      (ORIGINAL-CERTIFICATE)
 22199*       RIDFLD    (OC-CONTROL-PRIMARY)
 22200*       RESP      (WS-RESPONSE)
 22201*    END-EXEC.
 22202     MOVE LENGTH OF
 22203      ORIGINAL-CERTIFICATE
 22204       TO DFHEIV11
 22205     MOVE 'ELCRTO' TO DFHEIV1
 22206*    MOVE '&$ L                  ''  N#00020502' TO DFHEIV0
 22207     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22208     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22209     MOVE X'204E233030303230353032' TO DFHEIV0(25:11)
 22210     CALL 'kxdfhei1' USING DFHEIV0,
 22211           DFHEIV1,
 22212           ORIGINAL-CERTIFICATE,
 22213           DFHEIV11,
 22214           OC-CONTROL-PRIMARY,
 22215           DFHEIV99,
 22216           DFHEIV99
 22217     MOVE EIBRESP  TO WS-RESPONSE
 22218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22219
 22220
 22221     GO TO 9991-EXIT.
 22222
 22223 9991-CHECK-INDICATORS.
 22224
 22225     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22226         GO TO 9991-EXIT
 22227     END-IF.
 22228
 22229     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22230         GO TO 9991-EXIT
 22231     END-IF.
 22232
 22233
 22234* EXEC CICS READ
 22235*       DATASET   ('ELCRTO')
 22236*       INTO      (ORIGINAL-CERTIFICATE)
 22237*       RIDFLD    (OC-CONTROL-PRIMARY)
 22238*       UPDATE
 22239*       RESP      (WS-RESPONSE)
 22240*    END-EXEC
 22241     MOVE LENGTH OF
 22242      ORIGINAL-CERTIFICATE
 22243       TO DFHEIV11
 22244     MOVE 'ELCRTO' TO DFHEIV1
 22245*    MOVE '&"IL       EU         (  N#00020521' TO DFHEIV0
 22246     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22247     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22248     MOVE X'204E233030303230353231' TO DFHEIV0(25:11)
 22249     CALL 'kxdfhei1' USING DFHEIV0,
 22250           DFHEIV1,
 22251           ORIGINAL-CERTIFICATE,
 22252           DFHEIV11,
 22253           OC-CONTROL-PRIMARY,
 22254           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 410
* EL050.cbl
 22255           DFHEIV99,
 22256           DFHEIV99
 22257     MOVE EIBRESP  TO WS-RESPONSE
 22258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22259     IF WS-RESP-NORMAL
 22260        IF PB-ISSUE
 22261          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22262          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22263          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22264          MOVE PB-I-AGE               TO OC-INS-AGE
 22265          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22266          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22267          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22268          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22269          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22270          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22271          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22272          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22273          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22274          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22275          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22276          IF PB-I-JOINT-COMMISSION > +0
 22277              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22278          ELSE
 22279              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22280          END-IF
 22281          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22282          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22283          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22284          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22285          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22286          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22287          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22288          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22289          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22290
 22291          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22292
 22293* EXEC CICS READ
 22294*             DATASET   (FILE-ERMAIL)
 22295*             RIDFLD    (MA-CONTROL-PRIMARY)
 22296*             INTO      (MAILING-DATA)
 22297*             RESP      (WS-RESPONSE)
 22298*         END-EXEC
 22299     MOVE LENGTH OF
 22300      MAILING-DATA
 22301       TO DFHEIV11
 22302*    MOVE '&"IL       E          (  N#00020561' TO DFHEIV0
 22303     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22304     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22305     MOVE X'204E233030303230353631' TO DFHEIV0(25:11)
 22306     CALL 'kxdfhei1' USING DFHEIV0,
 22307           FILE-ERMAIL,
 22308           MAILING-DATA,
 22309           DFHEIV11,
 22310           MA-CONTROL-PRIMARY,
 22311           DFHEIV99,
 22312           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 411
* EL050.cbl
 22313           DFHEIV99
 22314     MOVE EIBRESP  TO WS-RESPONSE
 22315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22316          IF WS-RESP-NORMAL
 22317             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22318          END-IF
 22319
 22320          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22321          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22322
 22323* EXEC CICS READ
 22324*             DATASET  (CRTT-ID)
 22325*             RIDFLD   (WS-ELCRTT-KEY)
 22326*             INTO     (CERTIFICATE-TRAILERS)
 22327*             RESP     (WS-RESPONSE)
 22328*         END-EXEC
 22329     MOVE LENGTH OF
 22330      CERTIFICATE-TRAILERS
 22331       TO DFHEIV11
 22332*    MOVE '&"IL       E          (  N#00020573' TO DFHEIV0
 22333     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22335     MOVE X'204E233030303230353733' TO DFHEIV0(25:11)
 22336     CALL 'kxdfhei1' USING DFHEIV0,
 22337           CRTT-ID,
 22338           CERTIFICATE-TRAILERS,
 22339           DFHEIV11,
 22340           WS-ELCRTT-KEY,
 22341           DFHEIV99,
 22342           DFHEIV99,
 22343           DFHEIV99
 22344     MOVE EIBRESP  TO WS-RESPONSE
 22345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22346          IF WS-RESP-NORMAL
 22347             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22348                               OC-INS-AGE-DEFAULT-FLAG
 22349             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22350                               OC-JNT-AGE-DEFAULT-FLAG
 22351          END-IF
 22352
 22353        ELSE
 22354          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22355             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22356             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22357             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22358          END-IF
 22359          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22360             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22361             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22362             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22363          END-IF
 22364          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22365        END-IF
 22366
 22367* EXEC CICS REWRITE
 22368*          DATASET   ('ELCRTO')
 22369*          FROM      (ORIGINAL-CERTIFICATE)
 22370*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 412
* EL050.cbl
 22371*       END-EXEC
 22372     MOVE LENGTH OF
 22373      ORIGINAL-CERTIFICATE
 22374       TO DFHEIV11
 22375     MOVE 'ELCRTO' TO DFHEIV1
 22376*    MOVE '&& L                  %  N#00020599' TO DFHEIV0
 22377     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22378     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22379     MOVE X'204E233030303230353939' TO DFHEIV0(25:11)
 22380     CALL 'kxdfhei1' USING DFHEIV0,
 22381           DFHEIV1,
 22382           ORIGINAL-CERTIFICATE,
 22383           DFHEIV11,
 22384           DFHEIV99
 22385     MOVE EIBRESP  TO WS-RESPONSE
 22386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22387     END-IF.
 22388
 22389 9991-EXIT.
 22390     EXIT.
 22391
 22392
 22393 9999-RETURN.
 22394     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22395
 22396
 22397* EXEC CICS RETURN
 22398*    END-EXEC.
 22399*    MOVE '.(                    ''   #00020613' TO DFHEIV0
 22400     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22401     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22402     MOVE X'2020233030303230363133' TO DFHEIV0(25:11)
 22403     CALL 'kxdfhei1' USING DFHEIV0,
 22404           DFHEIV99,
 22405           DFHEIV99,
 22406           DFHEIV99,
 22407           DFHEIV99,
 22408           DFHEIV99,
 22409           DFHEIV99
 22410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22411
 22412
 22413
 22414* GOBACK.
 22415     MOVE '9%                    "   ' TO DFHEIV0
 22416     MOVE 'EL050' TO DFHEIV1
 22417     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22418     GOBACK.
 22419
 22420 9999-DFHBACK SECTION.
 22421     MOVE '9%                    "   ' TO DFHEIV0
 22422     MOVE 'EL050' TO DFHEIV1
 22423     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22424     GOBACK.
 22425 9999-DFHEXIT.
 22426     IF DFHEIGDJ EQUAL 0001
 22427         NEXT SENTENCE
 22428     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 413
* EL050.cbl
 22429         GO TO 9300-ABEND,
 22430               3990-FILES-NOT-OPEN
 22431         DEPENDING ON DFHEIGDI
 22432     ELSE IF DFHEIGDJ EQUAL 3
 22433         GO TO 6610-START-BROWSE,
 22434               6630-ERRESS-PROBLEM,
 22435               6630-END-OF-FILE
 22436         DEPENDING ON DFHEIGDI
 22437     ELSE IF DFHEIGDJ EQUAL 4
 22438         GO TO 6630-END-OF-FILE,
 22439               6630-ERRESS-PROBLEM,
 22440               6630-ERRESS-PROBLEM,
 22441               6630-END-OF-FILE
 22442         DEPENDING ON DFHEIGDI
 22443     ELSE IF DFHEIGDJ EQUAL 5
 22444         GO TO 6630-END-OF-FILE,
 22445               6630-END-OF-FILE,
 22446               6630-ERRESS-PROBLEM,
 22447               6630-ERRESS-PROBLEM
 22448         DEPENDING ON DFHEIGDI
 22449     ELSE IF DFHEIGDJ EQUAL 6
 22450         GO TO 6660-START-BROWSE,
 22451               6690-ERRESC-PROBLEM,
 22452               6690-ERRESC-PROBLEM,
 22453               6690-END-OF-FILE
 22454         DEPENDING ON DFHEIGDI
 22455     ELSE IF DFHEIGDJ EQUAL 7
 22456         GO TO 6690-END-OF-FILE,
 22457               6690-ERRESC-PROBLEM,
 22458               6690-ERRESC-PROBLEM,
 22459               6690-END-OF-FILE
 22460         DEPENDING ON DFHEIGDI
 22461     ELSE IF DFHEIGDJ EQUAL 8
 22462         GO TO 6690-END-OF-FILE,
 22463               6690-ERRESC-PROBLEM,
 22464               6690-ERRESC-PROBLEM,
 22465               6690-END-OF-FILE
 22466         DEPENDING ON DFHEIGDI
 22467     ELSE IF DFHEIGDJ EQUAL 9
 22468         GO TO 7250-CONTINUE,
 22469               7250-CONTINUE
 22470         DEPENDING ON DFHEIGDI
 22471     ELSE IF DFHEIGDJ EQUAL 10
 22472         GO TO 7300-CONTINUE,
 22473               7300-CONTINUE
 22474         DEPENDING ON DFHEIGDI
 22475     ELSE IF DFHEIGDJ EQUAL 11
 22476         GO TO 8000-FREE-MAIN
 22477         DEPENDING ON DFHEIGDI
 22478     ELSE IF DFHEIGDJ EQUAL 12
 22479         GO TO 8100-NOTFND,
 22480               8100-NOTFND
 22481         DEPENDING ON DFHEIGDI
 22482     ELSE IF DFHEIGDJ EQUAL 13
 22483         GO TO 8110-NOTFND,
 22484               8110-NOTFND
 22485         DEPENDING ON DFHEIGDI
 22486     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 414
* EL050.cbl
 22487         GO TO 8130-EXIT
 22488         DEPENDING ON DFHEIGDI
 22489     ELSE IF DFHEIGDJ EQUAL 15
 22490         GO TO 8150-exit
 22491         DEPENDING ON DFHEIGDI
 22492     ELSE IF DFHEIGDJ EQUAL 16
 22493         GO TO 8180-NOTFND
 22494         DEPENDING ON DFHEIGDI
 22495     ELSE IF DFHEIGDJ EQUAL 17
 22496         GO TO 8190-NOTFND
 22497         DEPENDING ON DFHEIGDI
 22498     ELSE IF DFHEIGDJ EQUAL 18
 22499         GO TO 8195-NOTFND
 22500         DEPENDING ON DFHEIGDI
 22501     ELSE IF DFHEIGDJ EQUAL 19
 22502         GO TO 8200-NOTFND
 22503         DEPENDING ON DFHEIGDI
 22504     ELSE IF DFHEIGDJ EQUAL 20
 22505         GO TO 8300-NOTFND,
 22506               8300-ERRESS-PROBLEM,
 22507               8300-ERRESS-PROBLEM,
 22508               8300-NOTFND
 22509         DEPENDING ON DFHEIGDI
 22510     ELSE IF DFHEIGDJ EQUAL 21
 22511         GO TO 8450-FORM-NOT-FOUND,
 22512               8450-FORM-NOT-FOUND
 22513         DEPENDING ON DFHEIGDI
 22514     ELSE IF DFHEIGDJ EQUAL 22
 22515         GO TO 0199-ACCT-NOT-FOUND,
 22516               0199-ACCT-NOT-FOUND
 22517         DEPENDING ON DFHEIGDI
 22518     ELSE IF DFHEIGDJ EQUAL 23
 22519         GO TO 0199-ACCT-NOT-FOUND,
 22520               0199-ACCT-NOT-FOUND
 22521         DEPENDING ON DFHEIGDI
 22522     ELSE IF DFHEIGDJ EQUAL 24
 22523         GO TO 8582-COMP-NOT-FOUND,
 22524               8582-COMP-NOT-FOUND
 22525         DEPENDING ON DFHEIGDI
 22526     ELSE IF DFHEIGDJ EQUAL 25
 22527         GO TO 8583-AGTC-NOT-FOUND,
 22528               8583-AGTC-NOT-FOUND
 22529         DEPENDING ON DFHEIGDI
 22530     ELSE IF DFHEIGDJ EQUAL 26
 22531         GO TO 8584-BXRF-NOT-FOUND,
 22532               8584-BXRF-NOT-FOUND
 22533         DEPENDING ON DFHEIGDI
 22534     ELSE IF DFHEIGDJ EQUAL 27
 22535         GO TO 8585-PLAN-NOT-FOUND,
 22536               8585-PLAN-NOT-FOUND
 22537         DEPENDING ON DFHEIGDI
 22538     ELSE IF DFHEIGDJ EQUAL 28
 22539         GO TO 0299-CERT-NOT-FOUND
 22540         DEPENDING ON DFHEIGDI
 22541     ELSE IF DFHEIGDJ EQUAL 29
 22542         GO TO 8700-READ-CERT-MASTER
 22543         DEPENDING ON DFHEIGDI
 22544     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 07-Aug-17 08:04 Page 415
* EL050.cbl
 22545         GO TO 8720-COMP-ACCOUNTS,
 22546               8730-END-BROWSE,
 22547               8740-NOT-FOUND
 22548         DEPENDING ON DFHEIGDI
 22549     ELSE IF DFHEIGDJ EQUAL 31
 22550         GO TO 9000-NOTFND
 22551         DEPENDING ON DFHEIGDI
 22552     ELSE IF DFHEIGDJ EQUAL 32
 22553         GO TO 9100-NOTFND,
 22554               9100-NOTFND
 22555         DEPENDING ON DFHEIGDI
 22556     ELSE IF DFHEIGDJ EQUAL 33
 22557         GO TO 9991-CRTO-NOT-FOUND,
 22558               9991-CRTO-NOT-FOUND
 22559         DEPENDING ON DFHEIGDI.
 22560     MOVE '9%                    "   ' TO DFHEIV0
 22561     MOVE 'EL050' TO DFHEIV1
 22562     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22563     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41464     Code:       91909
