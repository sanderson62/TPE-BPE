* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page   1
* BSSRCH.cbl
* Options: int("BSSRCH.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("BSSRCH.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"BSSRCH.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"BSSRCH.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2013 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. BSSRCH.
     9*
    10*AUTHOR.    Pablo.
    11*           Colleyville, TEXAS.
    12********************************************
    13*   Balance sheet for month end balancing
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page   2
* BSSRCH.cbl
    14********************************************
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 082013  CR2013060600001  PEMA  ADJ TOL TO 10% FOR NON-PROC
    24* 100813  IR2013100100001  PEMA INCREASE NON-PROC REF TOL
    25 environment division.
    26 INPUT-OUTPUT SECTION.
    27 FILE-CONTROL.
    28 SELECT CID-ECS010-IN ASSIGN TO
    29    '/data/seqfiles/cilgm15.ECS010.ME50.BAL.AMTS'
    30    FILE STATUS IS ECS010-STATUS.
    31 SELECT AHL-ECS010-IN ASSIGN TO
    32    '/data/seqfiles/ahlgm15.ECS010.ME50.BAL.AMTS'
    33    FILE STATUS IS ECS010-STATUS.
    34 SELECT DCC-ECS010-IN ASSIGN TO
    35    '/data/seqfiles/cidclgm15.ECS010.ME50.BAL.AMTS'
    36    FILE STATUS IS ECS010-STATUS.
    37 SELECT CID-CHKPOINT-OUT ASSIGN TO
    38    '/data/seqfiles/cidmechkpts.txt'
    39    FILE STATUS IS CHKPNT-STATUS
    40                            ORGANIZATION IS LINE SEQUENTIAL.
    41 SELECT ahl-CHKPOINT-OUT ASSIGN TO
    42   '/data/seqfiles/ahlmechkpts.txt'
    43    FILE STATUS IS CHKPNT-STATUS
    44                            ORGANIZATION IS LINE SEQUENTIAL.
    45 SELECT dcc-CHKPOINT-OUT ASSIGN TO
    46    '/data/seqfiles/dccmechkpts.txt'
    47    FILE STATUS IS CHKPNT-STATUS
    48                            ORGANIZATION IS LINE SEQUENTIAL.
    49 data division.
    50 FILE SECTION.
    51 FD  CID-ECS010-IN
    52     BLOCK CONTAINS 0
    53     RECORDING MODE F.
    54 01  CID-ECS010-IN-REC           pic x(94).
    55 FD  AHL-ECS010-IN
    56     BLOCK CONTAINS 0
    57     RECORDING MODE F.
    58 01  AHL-ECS010-IN-REC           pic x(94).
    59 FD  DCC-ECS010-IN
    60     BLOCK CONTAINS 0
    61     RECORDING MODE F.
    62 01  DCC-ECS010-IN-REC           pic x(94).
    63 FD  cid-CHKPOINT-OUT
    64     BLOCK CONTAINS 0
    65     RECORDING MODE F.
    66 01  cid-CHKPOINT-OUT-REC        pic x(94).
    67 FD  ahl-CHKPOINT-OUT
    68     BLOCK CONTAINS 0
    69     RECORDING MODE F.
    70 01  ahl-CHKPOINT-OUT-REC        pic x(94).
    71 FD  dcc-CHKPOINT-OUT
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page   3
* BSSRCH.cbl
    72     BLOCK CONTAINS 0
    73     RECORDING MODE F.
    74 01  dcc-CHKPOINT-OUT-REC        pic x(94).
    75 working-storage section.
    76 01  DFH-START PIC X(04).
    77 77  s1 pic s999 comp-3 value +0.
    78 77  s2 pic s999 comp-3 value +0.
    79 77  ws-pass-amount              pic s9(11) comp-3 value +0.
    80 77  ws-low-amount               pic s9(11) value zeros.
    81 77  ws-hi-amount                pic s9(11) value zeros.
    82 77  ws-low-pct                  pic s9v9(4) value zeros comp-3.
    83 77  ws-high-pct                 pic s9v9(4) value zeros comp-3.
    84************************************************
    85* commarea passed to the business logic
    86************************************************
    87 01  srch-commarea.
    88*                                copy BSSRCH-COMMAREA.
    89*****************************************************************
    90*                                                               *
    91* Copyright (c) 2013 by CSO.                                    *
    92* All rights reserved.                                          *
    93*                                                               *
    94*****************************************************************
    95****************************************
    96*  commarea for QUERY by eom date and company id
    97*  (business logic input & output)
    98****************************************
    99     03  bl-input.
   100         05  bl-input-eom-date   pic x(10).
   101         05  bl-input-comp-id    pic xxx.
   102         05  bl-input-lo-resv    pic 9(9).
   103         05  bl-input-hi-resv    pic 9(9).
   104         05  bl-input-bld-file   pic xxx.
   105     03  bl-output.
   106         05  bl-status           pic x.
   107             88  bl-ok                 value "p".
   108             88  bl-fail               value "f".
   109         05  bl-output-message   pic x(50).
   110         05  bl-output-record.
   111            07  bl-out-company-name
   112                                 pic x(30).
   113            07  bl-out-formated-date
   114                                 pic x(20).
   115            07  filler occurs 3.
   116                09  bl-out-lf-prem  pic s9(9)v99 comp-3 value +0.
   117                09  bl-out-ah-prem  pic s9(9)v99 comp-3 value +0.
   118                09  bl-out-lf-ref   pic s9(9)v99 comp-3 value +0.
   119                09  bl-out-ah-ref   pic s9(9)v99 comp-3 value +0.
   120                09  bl-out-lf-net   pic s9(9)v99 comp-3 value +0.
   121                09  bl-out-ah-net   pic s9(9)v99 comp-3 value +0.
   122                09  bl-out-lf-iss-com
   123                                    pic s9(9)v99 comp-3 value +0.
   124                09  bl-out-ah-iss-com
   125                                    pic s9(9)v99 comp-3 value +0.
   126                09  bl-out-lf-ref-com
   127                                    pic s9(9)v99 comp-3 value +0.
   128                09  bl-out-ah-ref-com
   129                                    pic s9(9)v99 comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page   4
* BSSRCH.cbl
   130                09  bl-out-lf-net-com
   131                                    pic s9(9)v99 comp-3 value +0.
   132                09  bl-out-ah-net-com
   133                                    pic s9(9)v99 comp-3 value +0.
   134                09  bl-out-iss-com  pic s9(9)v99 comp-3 value +0.
   135                09  bl-out-ref-com  pic s9(9)v99 comp-3 value +0.
   136                09  bl-out-net-com  pic s9(9)v99 comp-3 value +0.
   137                09  bl-out-iss-cnt  pic s9(9)    comp-3 value +0.
   138                09  bl-out-can-cnt  pic s9(9)    comp-3 value +0.
   139                09  bl-out-net-cnt  pic s9(9)    comp-3 value +0.
   140                09  bl-out-tot-prm  pic s9(9)v99 comp-3 value +0.
   141                09  bl-out-tot-ref  pic s9(9)v99 comp-3 value +0.
   142                09  bl-out-net-tot  pic s9(9)v99 comp-3 value +0.
   143            07  bl-out-cm-cnt    pic s9(9)     comp-3 value +0.
   144            07  bl-out-lf-clms-pd
   145                                 pic s9(9)v99  comp-3 value +0.
   146            07  bl-out-lf-clms-void
   147                                 pic s9(9)v99  comp-3 value +0.
   148            07  bl-out-lf-tot-clms
   149                                 pic s9(9)v99  comp-3 value +0.
   150            07  bl-out-ah-clms-pd
   151                                 pic s9(9)v99  comp-3 value +0.
   152            07  bl-out-ah-clms-void
   153                                 pic s9(9)v99  comp-3 value +0.
   154            07  bl-out-ah-tot-clms
   155                                 pic s9(9)v99  comp-3 value +0.
   156            07  bl-out-clms-pd   pic s9(9)v99  comp-3 value +0.
   157            07  bl-out-clms-void pic s9(9)v99  comp-3 value +0.
   158            07  bl-out-tot-clms  pic s9(9)v99  comp-3 value +0.
   159            07  bl-out-lf-clms-cur
   160                                 pic s9(9)v99  comp-3 value +0.
   161            07  bl-out-ah-clms-cur
   162                                 pic s9(9)v99  comp-3 value +0.
   163            07  bl-out-tot-clms-cur
   164                                 pic s9(9)v99  comp-3 value +0.
   165*                                copy ELCFUNDT.
   166*****************************************************************
   167*                                                               *
   168*                            ELCFUNDT.                          *
   169*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   170*                            VMOD=2.001                         *
   171*                                                               *
   172*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   173*                                                               *
   174*****************************************************************
   175
   176
   177 01  FUNCTION-DATE.
   178     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   179     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   180         10  WS-FN-CCYR            PIC 9(4).
   181         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   182             15  WS-FN-CC          PIC 99.
   183             15  WS-FN-YR          PIC 99.
   184         10  WS-FN-MO              PIC 99.
   185         10  WS-FN-DA              PIC 99.
   186     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   187     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page   5
* BSSRCH.cbl
   188     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   189     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   190     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   191         88  WS-BEHIND-GMT                     VALUE '-'.
   192         88  WS-AFTER-GMT                      VALUE '+'.
   193         88  WS-NO-GMT                         VALUE ZERO.
   194     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   195     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   196*                                COPY ELCDATE.
   197******************************************************************
   198*                                                                *
   199*                                                                *
   200*                            ELCDATE.                            *
   201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   202*                            VMOD=2.003
   203*                                                                *
   204*                                                                *
   205*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   206*                 LENGTH = 200                                   *
   207******************************************************************
   208
   209 01  DATE-CONVERSION-DATA.
   210     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   211     12  DC-OPTION-CODE                PIC X.
   212         88  BIN-TO-GREG                VALUE ' '.
   213         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   214         88  EDIT-GREG-TO-BIN           VALUE '2'.
   215         88  YMD-GREG-TO-BIN            VALUE '3'.
   216         88  MDY-GREG-TO-BIN            VALUE '4'.
   217         88  JULIAN-TO-BIN              VALUE '5'.
   218         88  BIN-PLUS-ELAPSED           VALUE '6'.
   219         88  FIND-CENTURY               VALUE '7'.
   220         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   221         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   222         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   223         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   224         88  JULIAN-TO-BIN-3            VALUE 'C'.
   225         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   226         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   227         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   228         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   229         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   230         88  CHECK-LEAP-YEAR            VALUE 'H'.
   231         88  BIN-3-TO-GREG              VALUE 'I'.
   232         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   233         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   234         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   235         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   236         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   237         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   238         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   239         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   240         88  THREE-CHARACTER-BIN
   241                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   242         88  GREGORIAN-TO-BIN
   243                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   244         88  BIN-TO-GREGORIAN
   245                  VALUES ' ' '1' 'I' '8' 'G'.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page   6
* BSSRCH.cbl
   246         88  JULIAN-TO-BINARY
   247                  VALUES '5' 'C' 'E' 'F'.
   248     12  DC-ERROR-CODE                 PIC X.
   249         88  NO-CONVERSION-ERROR        VALUE ' '.
   250         88  DATE-CONVERSION-ERROR
   251                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   252         88  DATE-IS-ZERO               VALUE '1'.
   253         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   254         88  DATE-IS-INVALID            VALUE '3'.
   255         88  DATE1-GREATER-DATE2        VALUE '4'.
   256         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   257         88  DATE-INVALID-OPTION        VALUE '9'.
   258         88  INVALID-CENTURY            VALUE 'A'.
   259         88  ONLY-CENTURY               VALUE 'B'.
   260         88  ONLY-LEAP-YEAR             VALUE 'C'.
   261         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   262     12  DC-END-OF-MONTH               PIC X.
   263         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   264     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   265         88  USE-NORMAL-PROCESS         VALUE ' '.
   266         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   267         88  ADJUST-UP-100-YRS          VALUE '2'.
   268     12  FILLER                        PIC X.
   269     12  DC-CONVERSION-DATES.
   270         16  DC-BIN-DATE-1             PIC XX.
   271         16  DC-BIN-DATE-2             PIC XX.
   272         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   273         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   274                       DC-GREG-DATE-1-EDIT.
   275             20  DC-EDIT1-MONTH        PIC 99.
   276             20  SLASH1-1              PIC X.
   277             20  DC-EDIT1-DAY          PIC 99.
   278             20  SLASH1-2              PIC X.
   279             20  DC-EDIT1-YEAR         PIC 99.
   280         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   281         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   282                     DC-GREG-DATE-2-EDIT.
   283             20  DC-EDIT2-MONTH        PIC 99.
   284             20  SLASH2-1              PIC X.
   285             20  DC-EDIT2-DAY          PIC 99.
   286             20  SLASH2-2              PIC X.
   287             20  DC-EDIT2-YEAR         PIC 99.
   288         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   289         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   290                     DC-GREG-DATE-1-YMD.
   291             20  DC-YMD-YEAR           PIC 99.
   292             20  DC-YMD-MONTH          PIC 99.
   293             20  DC-YMD-DAY            PIC 99.
   294         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   295         16  DC-GREG-DATE-1-MDY-R REDEFINES
   296                      DC-GREG-DATE-1-MDY.
   297             20  DC-MDY-MONTH          PIC 99.
   298             20  DC-MDY-DAY            PIC 99.
   299             20  DC-MDY-YEAR           PIC 99.
   300         16  DC-GREG-DATE-1-ALPHA.
   301             20  DC-ALPHA-MONTH        PIC X(10).
   302             20  DC-ALPHA-DAY          PIC 99.
   303             20  FILLER                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page   7
* BSSRCH.cbl
   304             20  DC-ALPHA-CENTURY.
   305                 24 DC-ALPHA-CEN-N     PIC 99.
   306             20  DC-ALPHA-YEAR         PIC 99.
   307         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   308         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   309         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   310         16  DC-JULIAN-DATE            PIC 9(05).
   311         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   312                                       PIC 9(05).
   313         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   314             20  DC-JULIAN-YEAR        PIC 99.
   315             20  DC-JULIAN-DAYS        PIC 999.
   316         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   317         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   318         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   319     12  DATE-CONVERSION-VARIBLES.
   320         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   321         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   322             20  FILLER                PIC 9(3).
   323             20  HOLD-CEN-1-CCYY.
   324                 24  HOLD-CEN-1-CC     PIC 99.
   325                 24  HOLD-CEN-1-YY     PIC 99.
   326             20  HOLD-CEN-1-MO         PIC 99.
   327             20  HOLD-CEN-1-DA         PIC 99.
   328         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   329             20  HOLD-CEN-1-R-MO       PIC 99.
   330             20  HOLD-CEN-1-R-DA       PIC 99.
   331             20  HOLD-CEN-1-R-CCYY.
   332                 24  HOLD-CEN-1-R-CC   PIC 99.
   333                 24  HOLD-CEN-1-R-YY   PIC 99.
   334             20  FILLER                PIC 9(3).
   335         16  HOLD-CENTURY-1-X.
   336             20  FILLER                PIC X(3)  VALUE SPACES.
   337             20  HOLD-CEN-1-X-CCYY.
   338                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   339                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   340             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   341             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   342         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   343             20  HOLD-CEN-1-R-X-MO     PIC XX.
   344             20  HOLD-CEN-1-R-X-DA     PIC XX.
   345             20  HOLD-CEN-1-R-X-CCYY.
   346                 24  HOLD-CEN-1-R-X-CC PIC XX.
   347                 24  HOLD-CEN-1-R-X-YY PIC XX.
   348             20  FILLER                PIC XXX.
   349         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   350         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   351         16  DC-JULIAN-DATE-1          PIC 9(07).
   352         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   353             20  DC-JULIAN-1-CCYY.
   354                 24  DC-JULIAN-1-CC    PIC 99.
   355                 24  DC-JULIAN-1-YR    PIC 99.
   356             20  DC-JULIAN-DA-1        PIC 999.
   357         16  DC-JULIAN-DATE-2          PIC 9(07).
   358         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   359             20  DC-JULIAN-2-CCYY.
   360                 24  DC-JULIAN-2-CC    PIC 99.
   361                 24  DC-JULIAN-2-YR    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page   8
* BSSRCH.cbl
   362             20  DC-JULIAN-DA-2        PIC 999.
   363         16  DC-GREG-DATE-A-EDIT.
   364             20  DC-EDITA-MONTH        PIC 99.
   365             20  SLASHA-1              PIC X VALUE '/'.
   366             20  DC-EDITA-DAY          PIC 99.
   367             20  SLASHA-2              PIC X VALUE '/'.
   368             20  DC-EDITA-CCYY.
   369                 24  DC-EDITA-CENT     PIC 99.
   370                 24  DC-EDITA-YEAR     PIC 99.
   371         16  DC-GREG-DATE-B-EDIT.
   372             20  DC-EDITB-MONTH        PIC 99.
   373             20  SLASHB-1              PIC X VALUE '/'.
   374             20  DC-EDITB-DAY          PIC 99.
   375             20  SLASHB-2              PIC X VALUE '/'.
   376             20  DC-EDITB-CCYY.
   377                 24  DC-EDITB-CENT     PIC 99.
   378                 24  DC-EDITB-YEAR     PIC 99.
   379         16  DC-GREG-DATE-CYMD         PIC 9(08).
   380         16  DC-GREG-DATE-CYMD-R REDEFINES
   381                              DC-GREG-DATE-CYMD.
   382             20  DC-CYMD-CEN           PIC 99.
   383             20  DC-CYMD-YEAR          PIC 99.
   384             20  DC-CYMD-MONTH         PIC 99.
   385             20  DC-CYMD-DAY           PIC 99.
   386         16  DC-GREG-DATE-MDCY         PIC 9(08).
   387         16  DC-GREG-DATE-MDCY-R REDEFINES
   388                              DC-GREG-DATE-MDCY.
   389             20  DC-MDCY-MONTH         PIC 99.
   390             20  DC-MDCY-DAY           PIC 99.
   391             20  DC-MDCY-CEN           PIC 99.
   392             20  DC-MDCY-YEAR          PIC 99.
   393    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   394        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   395    12  DC-EL310-DATE                  PIC X(21).
   396    12  FILLER                         PIC X(28).
   397* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   398*     'BEGINJOB mode=''MVS'''.
   399* 01  TRAN-DATA-LINE2             PIC X(80)    VALUE
   400*     'LABEL name=PERL1'.
   401* 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   402*     'ASSGNDD ddname=''SYSIN'' type=''INSTREAM''  << !'.
   403* 01  TRAN-DATA-LINE4             PIC X(80)    VALUE
   404*     'perl /export/home/pema/bin/bal_sheet_ss.pl $SEQFILES/a1.txt
   405*-    '$SEQFILES/a2.xlsx'
   406* 01  TRAN-DATA-LINE5             PIC X(80)    VALUE '!'.
   407* 01  TRAN-DATA-LINE6             PIC X(80)    VALUE
   408*    'EXECPGM pgmname=''BPXBATCH'' stepname=''PERL1'' parm=''SH'''
   409* 01  TRAN-DATA-LINE7             PIC X(80)    VALUE
   410*     'LABEL name=EMAIL'.
   411* 01  TRAN-DATA-LINE8             PIC X(80)    VALUE
   412*     'ASSGNDD ddname=''SYSIN'' type=''INSTREAM''  << !'.
   413* 01  TRAN-DATA-LINE9             PIC X(80)    VALUE
   414*     'mutt -s ''AHL chkpts'' -a $SEQFILES/ahlmechkpts.xlsx pema@c
   415*-    'o.com < /dev/null'.
   416* 01  TRAN-DATA-LINE10            PIC X(80)    VALUE '!'.
   417* 01  TRAN-DATA-LINE11            PIC X(80)    VALUE
   418*    'EXECPGM pgmname=''BPXBATCH'' stepname=''EMAIL'' parm=''SH'''
   419* 01  TRAN-DATA-LINE12            PIC X(80)    VALUE
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page   9
* BSSRCH.cbl
   420*     'ENDJOB'.
   421 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   422     'cd /apps/prod/cid1p/jcl'.
   423 01  TRAN-DATA-LINE2.
   424     05  filler                  pic x(10) value 'unikixjob '.
   425     05  tran-comp-id            pic xxx   value '   '.
   426     05  filler                 pic x(15) value 'chkpts -k cid1p'.
   427     05  filler                  pic x(52) value spaces.
   428 01  ECS010-IN-REC.
   429     05  filler                  pic x(21).
   430     05  ecs010-cert-cnt         pic x(11).
   431     05  filler                  pic x(62).
   432 01  cpo-out-record.
   433     05  cpo-jobname             pic x(10)  value spaces.
   434     05  f                       pic x value ';'.
   435     05  cpo-stepname            pic x(6)   value spaces.
   436     05  f                       pic x value ';'.
   437     05  cpo-low-amount          pic -9(9)  value zeros.
   438     05  f                       pic x value ';'.
   439     05  cpo-hi-amount           pic -9(9)  value zeros.
   440     05  f                       pic x value ';'.
   441     05  cpo-desc                pic x(50)  value spaces.
   442 01  ahl-table.
   443     05 f                        pic x(68) value
   444         'AHLGM10   ;EL524 ;Total Claims Paid
   445-        '            '.
   446     05 f                        pic x(68) value
   447         'AHLGM10   ;EL523 ;Processable Written & Outstanding Bala
   448-        'nce         '.
   449     05 f                        pic x(68) value
   450         'AHLGM10   ;EL523 ;Non-Processable Written & Outstanding
   451-        'Balance     '.
   452     05 f                        pic x(68) value
   453         'AHLGM10   ;EL523 ;Total Written & Outstanding Balance
   454-        '            '.
   455     05 f                        pic x(68) value
   456         'AHLGM10   ;EL523 ;Processable Cancelled
   457-        '            '.
   458     05 f                        pic x(68) value
   459         'AHLGM10   ;EL523 ;Non-Processable Cancelled
   460-        '            '.
   461     05 f                        pic x(68) value
   462         'AHLGM10   ;EL523 ;Total Cancelled
   463-        '            '.
   464     05 f                        pic x(68) value
   465         'AHLGM10   ;EL523 ;Processable Net Premium
   466-        '            '.
   467     05 f                        pic x(68) value
   468         'AHLGM10   ;EL523 ;Non-Processable Net Premium
   469-        '            '.
   470     05 f                        pic x(68) value
   471         'AHLGM10   ;EL523 ;Total Net Premium
   472-        '            '.
   473     05 f                        pic x(68) value
   474         'AHLGM10   ;EL523 ;Processable Net Commission
   475-        '            '.
   476     05 f                        pic x(68) value
   477         'AHLGM10   ;EL523 ;Non-Processable Net Commission
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  10
* BSSRCH.cbl
   478-        '            '.
   479     05 f                        pic x(68) value
   480         'AHLGM10   ;EL523 ;Total Net Commission
   481-        '            '.
   482     05 f                        pic x(68) value
   483         'AHLGM15   ;ECS010;Life Claims Paid
   484-        '            '.
   485     05 f                        pic x(68) value
   486         'AHLGM15   ;ECS010;A&H Claims Paid
   487-        '            '.
   488     05 f                        pic x(68) value
   489         'AHLGM15   ;ECS010;Output Certificate Master Records Prio
   490-        'r Month     '.
   491     05 f                        pic x(68) value
   492         'AHLGM17   ;ECS080;Gross Reserve
   493-        '            '.
   494 01  dcc-table.
   495     05 f                        pic x(68) value
   496         'CIDCLGM10 ;EL524 ;Total Claims Paid
   497-        '            '.
   498     05 f                        pic x(68) value
   499         'CIDCLGM10 ;EL523 ;Processable Written & Outstanding Bala
   500-        'nce         '.
   501     05 f                        pic x(68) value
   502         'CIDCLGM10 ;EL523 ;Non-Processable Written & Outstanding
   503-        'Balance     '.
   504     05 f                        pic x(68) value
   505         'CIDCLGM10 ;EL523 ;Total Written & Outstanding Balance
   506-        '            '.
   507     05 f                        pic x(68) value
   508         'CIDCLGM10 ;EL523 ;Processable Cancelled
   509-        '            '.
   510     05 f                        pic x(68) value
   511         'CIDCLGM10 ;EL523 ;Non-Processable Cancelled
   512-        '            '.
   513     05 f                        pic x(68) value
   514         'CIDCLGM10 ;EL523 ;Total Cancelled
   515-        '            '.
   516     05 f                        pic x(68) value
   517         'CIDCLGM10 ;EL523 ;Processable Net Premium
   518-        '            '.
   519     05 f                        pic x(68) value
   520         'CIDCLGM10 ;EL523 ;Non-Processable Net Premium
   521-        '            '.
   522     05 f                        pic x(68) value
   523         'CIDCLGM10 ;EL523 ;Total Net Premium
   524-        '            '.
   525     05 f                        pic x(68) value
   526         'CIDCLGM10 ;EL523 ;Processable Net Commission
   527-        '            '.
   528     05 f                        pic x(68) value
   529         'CIDCLGM10 ;EL523 ;Non-Processable Net Commission
   530-        '            '.
   531     05 f                        pic x(68) value
   532         'CIDCLGM10 ;EL523 ;Total Net Commission
   533-        '            '.
   534     05 f                        pic x(68) value
   535         'CIDCLGM15 ;ECS010;Life Claims Paid
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  11
* BSSRCH.cbl
   536-        '            '.
   537     05 f                        pic x(68) value
   538         'CIDCLGM15 ;ECS010;A&H Claims Paid
   539-        '            '.
   540     05 f                        pic x(68) value
   541         'CIDCLGM15 ;ECS010;Output Certificate Master Records Prio
   542-        'r Month     '.
   543     05 f                        pic x(68) value
   544         'CIDCLGM17 ;ECS080;Gross Reserve
   545-        '            '.
   546 01  cid-table.
   547     05 f                        pic x(68) value
   548         'CILGM10   ;EL524 ;Total Claims Paid
   549-        '            '.
   550     05 f                        pic x(68) value
   551         'CILGM10   ;EL523 ;Processable Written & Outstanding Bala
   552-        'nce         '.
   553     05 f                        pic x(68) value
   554         'CILGM10   ;EL523 ;Non-Processable Written & Outstanding
   555-        'Balance     '.
   556     05 f                        pic x(68) value
   557         'CILGM10   ;EL523 ;Total Written & Outstanding Balance
   558-        '            '.
   559     05 f                        pic x(68) value
   560         'CILGM10   ;EL523 ;Processable Cancelled
   561-        '            '.
   562     05 f                        pic x(68) value
   563         'CILGM10   ;EL523 ;Non-Processable Cancelled
   564-        '            '.
   565     05 f                        pic x(68) value
   566         'CILGM10   ;EL523 ;Total Cancelled
   567-        '            '.
   568     05 f                        pic x(68) value
   569         'CILGM10   ;EL523 ;Processable Net Premium
   570-        '            '.
   571     05 f                        pic x(68) value
   572         'CILGM10   ;EL523 ;Non-Processable Net Premium
   573-        '            '.
   574     05 f                        pic x(68) value
   575         'CILGM10   ;EL523 ;Total Net Premium
   576-        '            '.
   577     05 f                        pic x(68) value
   578         'CILGM10   ;EL523 ;Processable Net Commission
   579-        '            '.
   580     05 f                        pic x(68) value
   581         'CILGM10   ;EL523 ;Non-Processable Net Commission
   582-        '            '.
   583     05 f                        pic x(68) value
   584         'CILGM10   ;EL523 ;Total Net Commission
   585-        '            '.
   586     05 f                        pic x(68) value
   587         'CILGM15   ;ECS010;Life Claims Paid
   588-        '            '.
   589     05 f                        pic x(68) value
   590         'CILGM15   ;ECS010;A&H Claims Paid
   591-        '            '.
   592     05 f                        pic x(68) value
   593         'CILGM15   ;ECS010;Output Certificate Master Records Prio
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  12
* BSSRCH.cbl
   594-        'r Month     '.
   595     05 f                        pic x(68) value
   596         'CILGM17   ;ECS080;Gross Reserve
   597-        '            '.
   598 01  filler redefines cid-table.
   599     05  filler occurs 17.
   600         10  tbl-jobname             pic x(10).
   601         10  f                       pic x.
   602         10  tbl-stepname            pic x(6).
   603         10  f                       pic x.
   604         10  tbl-desc                pic x(50).
   605 01  filler.
   606     05  filler occurs 17.
   607         10  tbl-low-amount      pic s9(9).
   608         10  tbl-hi-amount       pic s9(9).
   609************************************
   610* fields used to read web data
   611************************************
   612 01  w-form-name       pic x(80).
   613 01  w-form-value      pic x(80).
   614 01  w-form-name-len   pic s9(8) comp.
   615 01  w-form-value-len  pic s9(8) comp.
   616 01  w-resp            pic s9(8) comp.
   617 01  w-doctoken        pic x(16).
   618 01  filler.
   619     05  ECS010-STATUS           PIC XX VALUE ZEROS.
   620     05  CHKPNT-STATUS           pic xx value zeros.
   621     05  work-cert-cnt           pic x(11).
   622     05  numeric-cert-cnt        pic 9(9).
   623     05  work-mort-resv-lo       pic x(11).
   624     05  work-mort-resv-hi       pic x(11).
   625     05  numeric-mort-resv       pic 9(9).
   626*****************************************
   627* symbol list for the BSDETAIL template
   628*****************************************
   629 01 output-data.
   630    05  filler                   pic x(7) value"COMPID=".
   631    05  out-comp-id              pic xxx.
   632    05  filler                   pic x(8) value"&EOMDTE=".
   633    05  out-eom-date             pic x(10).
   634    05  filler                   pic x(9) value"&COMPNME=".
   635    05  out-comp-name            pic x(30).
   636    05  filler                   pic x(7) value"&FDATE=".
   637    05  out-format-date          pic x(20).
   638    05  filler                   pic x(10) value"&LFISSPRM=".
   639    05  out-lf-iss-prem          pic zz,z99,999.99.
   640    05  filler                   pic x(10) value"&LFREFPRM=".
   641    05  out-lf-ref-prem          pic zz,z99,999.99.
   642    05  filler                   pic x(10) value"&LFNETPRM=".
   643    05  out-lf-net-prem          pic -zz,zz9,999.99.
   644    05  filler                   pic x(10) value"&AHISSPRM=".
   645    05  out-ah-iss-prem          pic zz,zz9,999.99.
   646    05  filler                   pic x(10) value"&AHREFPRM=".
   647    05  out-ah-ref-prem          pic zz,z99,999.99.
   648    05  filler                   pic x(10) value"&AHNETPRM=".
   649    05  out-ah-net-prem          pic -zz,z99,999.99.
   650    05  filler                   pic x(10) value"&LFISSCOM=".
   651    05  out-lf-iss-comm          pic zz,zz9,999.99.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  13
* BSSRCH.cbl
   652    05  filler                   pic x(10) value"&LFREFCOM=".
   653    05  out-lf-ref-comm          pic zz,zz9,999.99.
   654    05  filler                   pic x(10) value"&LFNETCOM=".
   655    05  out-lf-net-comm          pic -zz,zz9,999.99.
   656    05  filler                   pic x(10) value"&AHISSCOM=".
   657    05  out-ah-iss-comm          pic zz,zzz,999.99.
   658    05  filler                   pic x(10) value"&AHREFCOM=".
   659    05  out-ah-ref-comm          pic zz,z99,999.99.
   660    05  filler                   pic x(10) value"&AHNETCOM=".
   661    05  out-ah-net-comm          pic -zz,z99,999.99.
   662    05  filler                   pic x(9) value "&TOTPREM=".
   663    05  out-tot-prem             pic zz,z99,999.99.
   664    05  filler                   pic x(9) value "&TOTREFS=".
   665    05  out-tot-refs             pic zz,z99,999.99.
   666    05  filler                   pic x(9) value"&TOTNETP=".
   667    05  out-tot-netp             pic -zz,z99,999.99.
   668    05  filler                   pic x(8) value"&ISSCOM=".
   669    05  out-iss-comm             pic zz,zz9,999.99.
   670    05  filler                   pic x(8) value"&REFCOM=".
   671    05  out-ref-comm             pic zz,z99,999.99.
   672    05  filler                   pic x(9) value"&TOTNCOM=".
   673    05  out-net-comm             pic -zz,z99,999.99.
   674    05  filler                   pic x(8) value "&ISSCNT=".
   675    05  out-iss-cnt              pic zzzz,z99.
   676    05  filler                   pic x(8) value "&REFCNT=".
   677    05  out-ref-cnt              pic zzzz,999.
   678    05  filler                   pic x(8) value "&NETCNT=".
   679    05  out-net-cnt              pic -zzzz,999.
   680    05  filler                   pic x(8) value"&LFCLMS=".
   681    05  out-lf-clms-pd           pic zz,z99,999.99.
   682    05  filler                   pic x(9) value"&LFVOIDS=".
   683    05  out-lf-clms-void         pic zz,zz9,999.99.
   684    05  filler                   pic x(11) value"&TOTLFCLMS=".
   685    05  out-lf-tot-clms          pic -zz,z99,999.99.
   686    05  filler                   pic x(8) value"&AHCLMS=".
   687    05  out-ah-clms-pd           pic zz,z99,999.99.
   688    05  filler                   pic x(9) value"&AHVOIDS=".
   689    05  out-ah-clms-void         pic zz,zz9,999.99.
   690    05  filler                   pic x(11) value"&TOTAHCLMS=".
   691    05  out-ah-tot-clms          pic -zz,z99,999.99.
   692    05  filler                   pic x(8) value"&PDCLMS=".
   693    05  out-clms-pd              pic zz,z99,999.99.
   694    05  filler                   pic x(8) value"&VDCLMS=".
   695    05  out-clms-void            pic zz,z99,999.99.
   696    05  filler                   pic x(9) value"&TOTCLMS=".
   697    05  out-tot-clms             pic -zz,z99,999.99.
   698    05  filler                   pic x(8) value"&LORESV=".
   699    05  out-lo-resv              pic zzz,z99,999.
   700    05  filler                   pic x(8) value"&HIRESV=".
   701    05  out-hi-resv              pic zzz,z99,999.
   702    05  filler                   pic x(8) value"&CRTCNT=".
   703    05  out-crt-cnt              pic z,zz9,999.
   704    05  filler                   pic x(5) value "&MSG=".
   705    05  output-msg               pic x(50).
   706 01 bl-index               pic s9(8) comp.
   707****************************************************************
   708*
   709* Copyright (c) 2007 by Clerity Solutions, Inc.
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  14
* BSSRCH.cbl
   710* All rights reserved.
   711*
   712****************************************************************
   713 01  DFHEIV.
   714   02  DFHEIV0               PIC X(35).
   715   02  DFHEIV1               PIC X(08).
   716   02  DFHEIV2               PIC X(08).
   717   02  DFHEIV3               PIC X(08).
   718   02  DFHEIV4               PIC X(06).
   719   02  DFHEIV5               PIC X(04).
   720   02  DFHEIV6               PIC X(04).
   721   02  DFHEIV7               PIC X(02).
   722   02  DFHEIV8               PIC X(02).
   723   02  DFHEIV9               PIC X(01).
   724   02  DFHEIV10              PIC S9(7) COMP-3.
   725   02  DFHEIV11              PIC S9(4) COMP SYNC.
   726   02  DFHEIV12              PIC S9(4) COMP SYNC.
   727   02  DFHEIV13              PIC S9(4) COMP SYNC.
   728   02  DFHEIV14              PIC S9(4) COMP SYNC.
   729   02  DFHEIV15              PIC S9(4) COMP SYNC.
   730   02  DFHEIV16              PIC S9(9) COMP SYNC.
   731   02  DFHEIV17              PIC X(04).
   732   02  DFHEIV18              PIC X(04).
   733   02  DFHEIV19              PIC X(04).
   734   02  DFHEIV20              USAGE IS POINTER.
   735   02  DFHEIV21              USAGE IS POINTER.
   736   02  DFHEIV22              USAGE IS POINTER.
   737   02  DFHEIV23              USAGE IS POINTER.
   738   02  DFHEIV24              USAGE IS POINTER.
   739   02  DFHEIV25              PIC S9(9) COMP SYNC.
   740   02  DFHEIV26              PIC S9(9) COMP SYNC.
   741   02  DFHEIV27              PIC S9(9) COMP SYNC.
   742   02  DFHEIV28              PIC S9(9) COMP SYNC.
   743   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   744   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   745   02  FILLER                PIC X(02).
   746   02  DFHEIV99              PIC X(08) VALUE SPACE.
   747   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   748   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   749   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   750   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   751 LINKAGE  SECTION.
   752*****************************************************************
   753*                                                               *
   754* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   755* All rights reserved.                                          *
   756*                                                               *
   757*****************************************************************
   758 01  dfheiblk.
   759     02  eibtime          pic s9(7) comp-3.
   760     02  eibdate          pic s9(7) comp-3.
   761     02  eibtrnid         pic x(4).
   762     02  eibtaskn         pic s9(7) comp-3.
   763     02  eibtrmid         pic x(4).
   764     02  dfheigdi         pic s9(4) comp.
   765     02  eibcposn         pic s9(4) comp.
   766     02  eibcalen         pic s9(4) comp.
   767     02  eibaid           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  15
* BSSRCH.cbl
   768     02  eibfiller1       pic x(1).
   769     02  eibfn            pic x(2).
   770     02  eibfiller2       pic x(2).
   771     02  eibrcode         pic x(6).
   772     02  eibfiller3       pic x(2).
   773     02  eibds            pic x(8).
   774     02  eibreqid         pic x(8).
   775     02  eibrsrce         pic x(8).
   776     02  eibsync          pic x(1).
   777     02  eibfree          pic x(1).
   778     02  eibrecv          pic x(1).
   779     02  eibsend          pic x(1).
   780     02  eibatt           pic x(1).
   781     02  eibeoc           pic x(1).
   782     02  eibfmh           pic x(1).
   783     02  eibcompl         pic x(1).
   784     02  eibsig           pic x(1).
   785     02  eibconf          pic x(1).
   786     02  eiberr           pic x(1).
   787     02  eibrldbk         pic x(1).
   788     02  eiberrcd         pic x(4).
   789     02  eibsynrb         pic x(1).
   790     02  eibnodat         pic x(1).
   791     02  eibfiller5       pic x(2).
   792     02  eibresp          pic 9(09) comp.
   793     02  eibresp2         pic 9(09) comp.
   794     02  dfheigdj         pic s9(4) comp.
   795     02  dfheigdk         pic s9(4) comp.
   796 01  DFHCOMMAREA       PIC X(01).
   797 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   798 0000-DFHEXIT SECTION.
   799     MOVE '9#                    $   ' TO DFHEIV0.
   800     MOVE 'BSSRCH' TO DFHEIV1.
   801     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   802 0000-begin.
   803     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
   804
   805* exec cics web
   806*       startbr formfield resp(w-resp)
   807*    end-exec
   808*    MOVE 'X(f                   &  N#00000800' TO DFHEIV0
   809     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
   810     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   811     MOVE X'204E233030303030383030' TO DFHEIV0(25:11)
   812     CALL 'kxdfhei1' USING DFHEIV0,
   813           DFHEIV99,
   814           DFHEIV99,
   815           DFHEIV99,
   816           DFHEIV99,
   817           DFHEIV99
   818     MOVE EIBRESP  TO w-resp
   819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   820     perform 0200-read-form      thru 0200-exit until
   821        w-resp not = 0
   822*   dfhresp(normal)
   823
   824* exec cics web
   825*       endbr formfield
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  16
* BSSRCH.cbl
   826*    end-exec
   827*    MOVE 'X,f                   #   #00000805' TO DFHEIV0
   828     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
   829     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
   830     MOVE X'2020233030303030383035' TO DFHEIV0(25:11)
   831     CALL 'kxdfhei1' USING DFHEIV0,
   832           DFHEIV99,
   833           DFHEIV99
   834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   835     display ' input date   ' bl-input-eom-date
   836     display ' comp id      ' bl-input-comp-id
   837     display ' mort resv lo ' work-mort-resv-lo
   838     display ' mort resv hi ' work-mort-resv-hi
   839     display ' build file   ' bl-input-bld-file
   840     evaluate bl-input-comp-id
   841        when 'AHL'
   842           open input AHL-ECS010-IN
   843           if ecs010-status not = '00'
   844              move ' Cant open AHL ecs010 file '
   845                                 to bl-output-message
   846              go to 0100-send-document
   847           end-if
   848           READ AHL-ECS010-IN into ecs010-in-rec
   849              display ' ecs010 cert cnt ' ecs010-cert-cnt
   850              move ecs010-cert-cnt
   851                                 to work-cert-cnt
   852           close ahl-ecs010-in
   853        when 'CID'
   854           open input CID-ECS010-IN
   855           if ecs010-status not = '00'
   856              move ' Cant open AHL ecs010 file '
   857                                 to bl-output-message
   858              go to 0100-send-document
   859           end-if
   860           READ CID-ECS010-IN into ecs010-in-rec
   861              display ' ecs010 cert cnt ' ecs010-cert-cnt
   862              move ecs010-cert-cnt
   863                                 to work-cert-cnt
   864           close cid-ecs010-in
   865        when 'DCC'
   866           open input DCC-ECS010-IN
   867           if ecs010-status not = '00'
   868              move ' Cant open AHL ecs010 file '
   869                                 to bl-output-message
   870              go to 0100-send-document
   871           end-if
   872           READ DCC-ECS010-IN into ecs010-in-rec
   873              display ' ecs010 cert cnt ' ecs010-cert-cnt
   874              move ecs010-cert-cnt
   875                                 to work-cert-cnt
   876           close dcc-ecs010-in
   877     end-evaluate
   878     move zeros                  to numeric-cert-cnt
   879     inspect work-cert-cnt replacing all spaces by zeros
   880     move +9 to s2
   881     perform varying s1 from +11 by -1 until s1 < +1
   882        if work-cert-cnt (s1:1) numeric
   883           move work-cert-cnt (s1:1)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  17
* BSSRCH.cbl
   884                                 to numeric-cert-cnt (s2:1)
   885           subtract +1 from s2
   886        end-if
   887     end-perform
   888     move numeric-cert-cnt       to bl-out-cm-cnt
   889     move zeros                  to numeric-mort-resv
   890*    inspect work-mort-resv replacing all spaces by zeros
   891     move +9 to s2
   892     perform varying s1 from +11 by -1 until s1 < +1
   893        if work-mort-resv-lo (s1:1) numeric
   894           move work-mort-resv-lo (s1:1)
   895                                 to numeric-mort-resv (s2:1)
   896           subtract +1 from s2
   897        end-if
   898     end-perform
   899     move numeric-mort-resv      to bl-input-lo-resv
   900     display ' bl lo reserve ' bl-input-lo-resv
   901     move zeros                  to numeric-mort-resv
   902*    inspect work-mort-resv replacing all spaces by zeros
   903     move +9 to s2
   904     perform varying s1 from +11 by -1 until s1 < +1
   905        if work-mort-resv-hi (s1:1) numeric
   906           move work-mort-resv-hi (s1:1)
   907                                 to numeric-mort-resv (s2:1)
   908           subtract +1 from s2
   909        end-if
   910     end-perform
   911     move numeric-mort-resv      to bl-input-hi-resv
   912     display ' bl hi reserve ' bl-input-hi-resv
   913
   914* exec cics link
   915*       program  ('BSSRCHBL')
   916*       commarea (srch-commarea)
   917*    end-exec
   918     MOVE LENGTH OF
   919      srch-commarea
   920       TO DFHEIV11
   921     MOVE 'BSSRCHBL' TO DFHEIV1
   922*    MOVE '."C                   (   #00000886' TO DFHEIV0
   923     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   924     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   925     MOVE X'2020233030303030383836' TO DFHEIV0(25:11)
   926     CALL 'kxdfhei1' USING DFHEIV0,
   927           DFHEIV1,
   928           srch-commarea,
   929           DFHEIV11,
   930           DFHEIV99,
   931           DFHEIV99,
   932           DFHEIV99,
   933           DFHEIV99
   934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   935     .
   936 0100-send-document.
   937***********************************************************
   938* Build output document.
   939***********************************************************
   940     move bl-input-comp-id       to out-comp-id
   941     move bl-input-eom-date      to out-eom-date
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  18
* BSSRCH.cbl
   942     move bl-input-lo-resv       to out-lo-resv
   943     move bl-input-hi-resv       to out-hi-resv
   944     move bl-out-company-name    to out-comp-name
   945     move bl-out-formated-date   to out-format-date
   946     move bl-out-lf-prem (1)     to out-lf-iss-prem
   947     move bl-out-ah-prem (1)     to out-ah-iss-prem
   948     move bl-out-tot-prm (1)     to out-tot-prem
   949     move bl-out-lf-ref  (1)     to out-lf-ref-prem
   950     move bl-out-ah-ref  (1)     to out-ah-ref-prem
   951     move bl-out-tot-ref (1)     to out-tot-refs
   952     move bl-out-lf-net  (1)     to out-lf-net-prem
   953     move bl-out-ah-net  (1)     to out-ah-net-prem
   954     move bl-out-lf-iss-com (1)  to out-lf-iss-comm
   955     move bl-out-ah-iss-com (1)  to out-ah-iss-comm
   956     move bl-out-lf-ref-com (1)  to out-lf-ref-comm
   957     move bl-out-ah-ref-com (1)  to out-ah-ref-comm
   958     move bl-out-lf-net-com (1)  to out-lf-net-comm
   959     move bl-out-ah-net-com (1)  to out-ah-net-comm
   960     move bl-out-iss-com    (1)  to out-iss-comm
   961     move bl-out-ref-com    (1)  to out-ref-comm
   962     move bl-out-net-com    (1)  to out-net-comm
   963     move bl-out-iss-cnt    (1)  to out-iss-cnt
   964     move bl-out-can-cnt    (1)  to out-ref-cnt
   965     move bl-out-net-cnt    (1)  to out-net-cnt
   966     move bl-out-net-tot    (1)  to out-tot-netp
   967     move bl-out-cm-cnt          to out-crt-cnt
   968     move bl-out-lf-clms-pd      to out-lf-clms-pd
   969     move bl-out-lf-clms-void    to out-lf-clms-void
   970     move bl-out-lf-tot-clms     to out-lf-tot-clms
   971     move bl-out-ah-clms-pd      to out-ah-clms-pd
   972     move bl-out-ah-clms-void    to out-ah-clms-void
   973     move bl-out-ah-tot-clms     to out-ah-tot-clms
   974     move bl-out-clms-pd         to out-clms-pd
   975     move bl-out-clms-void       to out-clms-void
   976     move bl-out-tot-clms        to out-tot-clms
   977     move bl-output-message      to output-msg
   978     if bl-input-bld-file = 'YES'
   979        move 'Balance File Created'
   980                                 to output-msg
   981     end-if
   982
   983* exec cics document create
   984*       doctoken   (w-doctoken)
   985*       template   ('BSDETAIL')
   986*       symbollist (output-data)
   987*       listlength (length of output-data)
   988*    end-exec
   989     MOVE 'BSDETAIL'
   990      TO DFHEIVL0
   991     MOVE LENGTH OF
   992      output-data TO DFHEIV16
   993*    MOVE '\"D tSL               )   #00000937' TO DFHEIV0
   994     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
   995     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
   996     MOVE X'2020233030303030393337' TO DFHEIV0(25:11)
   997     CALL 'kxdfhei1' USING DFHEIV0,
   998           w-doctoken,
   999           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  19
* BSSRCH.cbl
  1000           DFHEIVL0,
  1001           output-data,
  1002           DFHEIV16,
  1003           DFHEIV99,
  1004           DFHEIV99,
  1005           DFHEIV99
  1006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1007     move 1                      to bl-index
  1008*    exec cics document insert
  1009*       doctoken (w-doctoken)
  1010*       template ('BSFTR')
  1011*    end-exec
  1012    if bl-fail
  1013
  1014* exec cics syncpoint rollback
  1015*      end-exec
  1016*    MOVE '6"R                   !   #00000949' TO DFHEIV0
  1017     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  1018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1019     MOVE X'2020233030303030393439' TO DFHEIV0(25:11)
  1020     CALL 'kxdfhei1' USING DFHEIV0
  1021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1022    end-if
  1023****************************************
  1024* Send the document and return.
  1025****************************************
  1026
  1027* exec cics web send
  1028*       doctoken(w-doctoken)
  1029*    end-exec
  1030*    MOVE 'X$D                   *   #00000955' TO DFHEIV0
  1031     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1032     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1033     MOVE X'2020233030303030393535' TO DFHEIV0(25:11)
  1034     CALL 'kxdfhei1' USING DFHEIV0,
  1035           w-doctoken,
  1036           DFHEIV99,
  1037           DFHEIV99,
  1038           DFHEIV99,
  1039           DFHEIV99,
  1040           DFHEIV99,
  1041           DFHEIV99,
  1042           DFHEIV99,
  1043           DFHEIV99
  1044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1045     if bl-input-bld-file = 'YES'
  1046        evaluate bl-input-comp-id
  1047           when 'AHL'
  1048              move ahl-table     to cid-table
  1049              perform 0300-build-cid
  1050                                 thru 0300-exit
  1051              perform 0400-write-ahl
  1052                                 thru 0400-exit
  1053           when 'CID'
  1054              perform 0300-build-cid
  1055                                 thru 0300-exit
  1056              perform 0500-write-cid
  1057                                 thru 0500-exit
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  20
* BSSRCH.cbl
  1058           when 'DCC'
  1059              move dcc-table     to cid-table
  1060              perform 0300-build-cid
  1061                                 thru 0300-exit
  1062              perform 0600-write-dcc
  1063                                 thru 0600-exit
  1064        end-evaluate
  1065     end-if
  1066
  1067* exec cics return
  1068*    end-exec
  1069*    MOVE '.(                    ''   #00000979' TO DFHEIV0
  1070     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1071     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1072     MOVE X'2020233030303030393739' TO DFHEIV0(25:11)
  1073     CALL 'kxdfhei1' USING DFHEIV0,
  1074           DFHEIV99,
  1075           DFHEIV99,
  1076           DFHEIV99,
  1077           DFHEIV99,
  1078           DFHEIV99,
  1079           DFHEIV99
  1080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1081     .
  1082 0200-read-form.
  1083     move spaces                 to w-form-name
  1084     move length of w-form-name  to w-form-name-len
  1085     move spaces                 to w-form-value
  1086     move length of w-form-value to w-form-value-len
  1087
  1088* exec cics web readnext
  1089*       formfield   (w-form-name)
  1090*       namelength  (w-form-name-len)
  1091*       value       (w-form-value)
  1092*       valuelength (w-form-value-len)
  1093*       resp        (w-resp)
  1094*    end-exec
  1095*    MOVE 'X*FLVL                &  N#00000987' TO DFHEIV0
  1096     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  1097     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1098     MOVE X'204E233030303030393837' TO DFHEIV0(25:11)
  1099     CALL 'kxdfhei1' USING DFHEIV0,
  1100           w-form-name,
  1101           w-form-name-len,
  1102           w-form-value,
  1103           w-form-value-len,
  1104           DFHEIV99
  1105     MOVE EIBRESP  TO w-resp
  1106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1107     evaluate w-resp
  1108        when 0
  1109*   dfhresp(normal)
  1110           evaluate w-form-name(1:w-form-name-len)
  1111              when 'eom_dte'
  1112                 if w-form-value-len not = 0
  1113                    move w-form-value(1:w-form-value-len)
  1114                                 to bl-input-eom-date
  1115                 else
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  21
* BSSRCH.cbl
  1116                    move spaces  to bl-input-eom-date
  1117                end-if
  1118              when 'comp_id'
  1119                 if w-form-value-len not = 0
  1120                    move w-form-value(1:w-form-value-len)
  1121                                 to bl-input-comp-id
  1122                 else
  1123                    move spaces  to bl-input-comp-id
  1124                end-if
  1125              when 'lo_resv'
  1126                 if w-form-value-len not = 0
  1127                    move w-form-value(1:w-form-value-len)
  1128                                 to work-mort-resv-lo
  1129                 else
  1130                    move zeros   to work-mort-resv-lo
  1131                end-if
  1132              when 'hi_resv'
  1133                 if w-form-value-len not = 0
  1134                    move w-form-value(1:w-form-value-len)
  1135                                 to work-mort-resv-hi
  1136                 else
  1137                    move zeros   to work-mort-resv-hi
  1138                end-if
  1139              when 'bld_file'
  1140                 if w-form-value-len not = 0
  1141                    move w-form-value(1:w-form-value-len)
  1142                                 to bl-input-bld-file
  1143                 else
  1144                    move spaces  to bl-input-bld-file
  1145                end-if
  1146           end-evaluate
  1147        when other
  1148           continue
  1149     end-evaluate
  1150     .
  1151 0200-exit.
  1152     exit.
  1153 0300-build-cid.
  1154     move +.98                   to ws-low-pct
  1155     move +1.02                  to ws-high-pct
  1156     perform varying s1 from +1 by +1 until s1 > +17
  1157        move -999999999          to tbl-low-amount (s1)
  1158        move +999999999          to tbl-hi-amount  (s1)
  1159     end-perform
  1160     move bl-out-tot-clms        to ws-pass-amount
  1161     perform 0310-calc-tol       thru 0310-exit
  1162     move ws-low-amount          to tbl-low-amount (1)
  1163     move ws-hi-amount           to tbl-hi-amount (1)
  1164*** processable gross premium
  1165     move bl-out-tot-prm (1)     to ws-pass-amount
  1166     perform 0310-calc-tol       thru 0310-exit
  1167     move ws-low-amount          to tbl-low-amount (2)
  1168     move ws-hi-amount           to tbl-hi-amount (2)
  1169*** non-processable gross premium
  1170     move +.90                   to ws-low-pct
  1171     move +1.10                  to ws-high-pct
  1172     move bl-out-tot-prm (2)     to ws-pass-amount
  1173     perform 0310-calc-tol       thru 0310-exit
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  22
* BSSRCH.cbl
  1174     move ws-low-amount          to tbl-low-amount (3)
  1175     move ws-hi-amount           to tbl-hi-amount (3)
  1176*** total gross premium
  1177     move +.98                   to ws-low-pct
  1178     move +1.02                  to ws-high-pct
  1179     compute tbl-low-amount (4) =
  1180        tbl-low-amount (2) + tbl-low-amount (3)
  1181     compute tbl-hi-amount (4) =
  1182        tbl-hi-amount (2) + tbl-hi-amount (3)
  1183*** processable refunded premium
  1184     move bl-out-tot-ref (1)     to ws-pass-amount
  1185     perform 0310-calc-tol       thru 0310-exit
  1186     move ws-low-amount          to tbl-low-amount (5)
  1187     move ws-hi-amount           to tbl-hi-amount (5)
  1188*** non-processable refunded premium
  1189     move +.70                   to ws-low-pct
  1190     move +1.30                  to ws-high-pct
  1191     move bl-out-tot-ref (2)     to ws-pass-amount
  1192     perform 0310-calc-tol       thru 0310-exit
  1193     move ws-low-amount          to tbl-low-amount (6)
  1194     move ws-hi-amount           to tbl-hi-amount (6)
  1195*** total refunded premium
  1196     move +.98                   to ws-low-pct
  1197     move +1.02                  to ws-high-pct
  1198     compute tbl-low-amount (7) =
  1199        tbl-low-amount (5) + tbl-low-amount (6)
  1200     compute tbl-hi-amount (7) =
  1201        tbl-hi-amount (5) + tbl-hi-amount (6)
  1202*** processable net premium
  1203     move bl-out-net-tot (1)     to ws-pass-amount
  1204     perform 0310-calc-tol       thru 0310-exit
  1205     move ws-low-amount          to tbl-low-amount (8)
  1206     move ws-hi-amount           to tbl-hi-amount (8)
  1207*** non-processable net premium
  1208     move +.90                   to ws-low-pct
  1209     move +1.10                  to ws-high-pct
  1210     move bl-out-net-tot (2)     to ws-pass-amount
  1211     perform 0310-calc-tol       thru 0310-exit
  1212     move ws-low-amount          to tbl-low-amount (9)
  1213     move ws-hi-amount           to tbl-hi-amount (9)
  1214*** total net premium
  1215     move +.98                   to ws-low-pct
  1216     move +1.02                  to ws-high-pct
  1217     compute tbl-low-amount (10) =
  1218        tbl-low-amount (8) + tbl-low-amount (9)
  1219     compute tbl-hi-amount (10) =
  1220        tbl-hi-amount (8) + tbl-hi-amount (9)
  1221*** processable commission
  1222     move bl-out-net-com (1)     to ws-pass-amount
  1223     perform 0310-calc-tol       thru 0310-exit
  1224     move ws-low-amount          to tbl-low-amount (11)
  1225     move ws-hi-amount           to tbl-hi-amount (11)
  1226*** non-processable commission
  1227     move +.90                   to ws-low-pct
  1228     move +1.10                  to ws-high-pct
  1229     move bl-out-net-com (2)     to ws-pass-amount
  1230     perform 0310-calc-tol       thru 0310-exit
  1231     move ws-low-amount          to tbl-low-amount (12)
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  23
* BSSRCH.cbl
  1232     move ws-hi-amount           to tbl-hi-amount (12)
  1233*** total commission
  1234     move +.98                   to ws-low-pct
  1235     move +1.02                  to ws-high-pct
  1236     compute tbl-low-amount (13) =
  1237        tbl-low-amount (11) + tbl-low-amount (12)
  1238     compute tbl-hi-amount (13) =
  1239        tbl-hi-amount (11) + tbl-hi-amount (12)
  1240     move bl-out-lf-tot-clms     to ws-pass-amount
  1241     perform 0310-calc-tol       thru 0310-exit
  1242     move ws-low-amount          to tbl-low-amount (14)
  1243     move ws-hi-amount           to tbl-hi-amount (14)
  1244     move bl-out-ah-tot-clms     to ws-pass-amount
  1245     perform 0310-calc-tol       thru 0310-exit
  1246     move ws-low-amount          to tbl-low-amount (15)
  1247     move ws-hi-amount           to tbl-hi-amount (15)
  1248     move bl-out-cm-cnt          to tbl-low-amount (16)
  1249                                    tbl-hi-amount  (16)
  1250     move bl-input-lo-resv       to tbl-low-amount (17)
  1251     move bl-input-hi-resv       to tbl-hi-amount (17)
  1252     .
  1253 0300-exit.
  1254     exit.
  1255 0310-calc-tol.
  1256     if ws-pass-amount > zeros
  1257        compute ws-low-amount = ws-pass-amount * ws-low-pct
  1258        compute ws-hi-amount  = ws-pass-amount * ws-high-pct
  1259     else
  1260        compute ws-low-amount = ws-pass-amount * ws-high-pct
  1261        compute ws-hi-amount  = ws-pass-amount * ws-low-pct
  1262     end-if
  1263     .
  1264 0310-exit.
  1265     exit.
  1266 0400-write-ahl.
  1267     open output ahl-chkpoint-out
  1268     if chkpnt-status not = '00'
  1269        move ' Cant open AHL CHKPNT file '
  1270           to bl-output-message
  1271        go to 0100-send-document
  1272     end-if
  1273     move bl-input-eom-date      to cpo-jobname
  1274     move 'AHL'                  to cpo-stepname
  1275     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1276        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1277        delimited by size into cpo-desc
  1278     end-string
  1279     write ahl-chkpoint-out-rec  from cpo-out-record
  1280     move spaces                 to cpo-jobname
  1281                                    cpo-stepname
  1282     move 'Proc Cnt'             to cpo-desc
  1283     move bl-out-iss-cnt (1)     to cpo-low-amount
  1284     move bl-out-can-cnt (1)     to cpo-hi-amount
  1285     write ahl-chkpoint-out-rec  from cpo-out-record
  1286     move 'NonProcCnt'           to cpo-desc
  1287     move bl-out-iss-cnt (2)     to cpo-low-amount
  1288     move bl-out-can-cnt (2)     to cpo-hi-amount
  1289     write ahl-chkpoint-out-rec  from cpo-out-record
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  24
* BSSRCH.cbl
  1290     move 'Total Cnt'            to cpo-desc
  1291     move bl-out-iss-cnt (3)     to cpo-low-amount
  1292     move bl-out-can-cnt (3)     to cpo-hi-amount
  1293     write ahl-chkpoint-out-rec  from cpo-out-record
  1294     move bl-out-lf-clms-cur     to ws-pass-amount
  1295     perform 0310-calc-tol       thru 0310-exit
  1296     move 'LF Claims Paid Curr'  to cpo-desc
  1297     move ws-low-amount          to cpo-low-amount
  1298     move ws-hi-amount           to cpo-hi-amount
  1299     write ahl-chkpoint-out-rec  from cpo-out-record
  1300     move bl-out-ah-clms-cur     to ws-pass-amount
  1301     perform 0310-calc-tol       thru 0310-exit
  1302     move 'AH Claims Paid Curr'  to cpo-desc
  1303     move ws-low-amount          to cpo-low-amount
  1304     move ws-hi-amount           to cpo-hi-amount
  1305     write ahl-chkpoint-out-rec  from cpo-out-record
  1306     move bl-out-tot-clms-cur    to ws-pass-amount
  1307     perform 0310-calc-tol       thru 0310-exit
  1308     move 'TOT Claims Paid Curr' to cpo-desc
  1309     move ws-low-amount          to cpo-low-amount
  1310     move ws-hi-amount           to cpo-hi-amount
  1311     write ahl-chkpoint-out-rec  from cpo-out-record
  1312     perform varying s1 from 1 by 1 until s1 > 17
  1313        move tbl-jobname    (s1) to cpo-jobname
  1314        move tbl-stepname   (s1) to cpo-stepname
  1315        move tbl-desc       (s1) to cpo-desc
  1316        move tbl-low-amount (s1) to cpo-low-amount
  1317        move tbl-hi-amount  (s1) to cpo-hi-amount
  1318        write ahl-chkpoint-out-rec from cpo-out-record
  1319     end-perform
  1320     close ahl-chkpoint-out
  1321     perform 0700-submit-job     thru 0700-exit
  1322     .
  1323 0400-exit.
  1324     exit.
  1325 0500-write-cid.
  1326     open output cid-chkpoint-out
  1327     if chkpnt-status not = '00'
  1328        move ' Cant open CID CHKPNT file '
  1329           to bl-output-message
  1330        go to 0100-send-document
  1331     end-if
  1332     move bl-input-eom-date      to cpo-jobname
  1333     move 'CID'                  to cpo-stepname
  1334     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1335        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1336        delimited by size into cpo-desc
  1337     end-string
  1338     write cid-chkpoint-out-rec  from cpo-out-record
  1339     move spaces                 to cpo-jobname
  1340                                    cpo-stepname
  1341     move 'Proc Cnt'             to cpo-desc
  1342     move bl-out-iss-cnt (1)     to cpo-low-amount
  1343     move bl-out-can-cnt (1)     to cpo-hi-amount
  1344     write cid-chkpoint-out-rec  from cpo-out-record
  1345     move 'NonProcCnt'           to cpo-desc
  1346     move bl-out-iss-cnt (2)     to cpo-low-amount
  1347     move bl-out-can-cnt (2)     to cpo-hi-amount
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  25
* BSSRCH.cbl
  1348     write cid-chkpoint-out-rec  from cpo-out-record
  1349     move 'Total Cnt'            to cpo-desc
  1350     move bl-out-iss-cnt (3)     to cpo-low-amount
  1351     move bl-out-can-cnt (3)     to cpo-hi-amount
  1352     write cid-chkpoint-out-rec  from cpo-out-record
  1353     move bl-out-lf-clms-cur     to ws-pass-amount
  1354     perform 0310-calc-tol       thru 0310-exit
  1355     move 'LF Claims Paid Curr'  to cpo-desc
  1356     move ws-low-amount          to cpo-low-amount
  1357     move ws-hi-amount           to cpo-hi-amount
  1358     write cid-chkpoint-out-rec  from cpo-out-record
  1359     move bl-out-ah-clms-cur     to ws-pass-amount
  1360     perform 0310-calc-tol       thru 0310-exit
  1361     move 'AH Claims Paid Curr'  to cpo-desc
  1362     move ws-low-amount          to cpo-low-amount
  1363     move ws-hi-amount           to cpo-hi-amount
  1364     write cid-chkpoint-out-rec  from cpo-out-record
  1365     move bl-out-tot-clms-cur    to ws-pass-amount
  1366     perform 0310-calc-tol       thru 0310-exit
  1367     move 'TOT Claims Paid Curr' to cpo-desc
  1368     move ws-low-amount          to cpo-low-amount
  1369     move ws-hi-amount           to cpo-hi-amount
  1370     write cid-chkpoint-out-rec  from cpo-out-record
  1371     perform varying s1 from 1 by 1 until s1 > 17
  1372        move tbl-jobname    (s1) to cpo-jobname
  1373        move tbl-stepname   (s1) to cpo-stepname
  1374        move tbl-desc       (s1) to cpo-desc
  1375        move tbl-low-amount (s1) to cpo-low-amount
  1376        move tbl-hi-amount  (s1) to cpo-hi-amount
  1377        write cid-chkpoint-out-rec
  1378                                 from cpo-out-record
  1379     end-perform
  1380     close cid-chkpoint-out
  1381     perform 0700-submit-job     thru 0700-exit
  1382     .
  1383 0500-exit.
  1384     exit.
  1385 0600-write-dcc.
  1386     open output dcc-chkpoint-out
  1387     if chkpnt-status not = '00'
  1388        move ' Cant open DCC CHKPNT file '
  1389           to bl-output-message
  1390        go to 0100-send-document
  1391     end-if
  1392     move bl-input-eom-date      to cpo-jobname
  1393     move 'DCC'                  to cpo-stepname
  1394     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1395        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1396        delimited by size into cpo-desc
  1397     end-string
  1398     write dcc-chkpoint-out-rec  from cpo-out-record
  1399     move spaces                 to cpo-jobname
  1400                                    cpo-stepname
  1401     move 'Proc Cnt'             to cpo-desc
  1402     move bl-out-iss-cnt (1)     to cpo-low-amount
  1403     move bl-out-can-cnt (1)     to cpo-hi-amount
  1404     write dcc-chkpoint-out-rec  from cpo-out-record
  1405     move 'NonProcCnt'           to cpo-desc
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  26
* BSSRCH.cbl
  1406     move bl-out-iss-cnt (2)     to cpo-low-amount
  1407     move bl-out-can-cnt (2)     to cpo-hi-amount
  1408     write dcc-chkpoint-out-rec  from cpo-out-record
  1409     move 'Total Cnt'            to cpo-desc
  1410     move bl-out-iss-cnt (3)     to cpo-low-amount
  1411     move bl-out-can-cnt (3)     to cpo-hi-amount
  1412     write dcc-chkpoint-out-rec  from cpo-out-record
  1413     move bl-out-lf-clms-cur     to ws-pass-amount
  1414     perform 0310-calc-tol       thru 0310-exit
  1415     move 'LF Claims Paid Curr'  to cpo-desc
  1416     move ws-low-amount          to cpo-low-amount
  1417     move ws-hi-amount           to cpo-hi-amount
  1418     write dcc-chkpoint-out-rec  from cpo-out-record
  1419     move bl-out-ah-clms-cur     to ws-pass-amount
  1420     perform 0310-calc-tol       thru 0310-exit
  1421     move 'AH Claims Paid Curr'  to cpo-desc
  1422     move ws-low-amount          to cpo-low-amount
  1423     move ws-hi-amount           to cpo-hi-amount
  1424     write dcc-chkpoint-out-rec  from cpo-out-record
  1425     move bl-out-tot-clms-cur    to ws-pass-amount
  1426     perform 0310-calc-tol       thru 0310-exit
  1427     move 'TOT Claims Paid Curr' to cpo-desc
  1428     move ws-low-amount          to cpo-low-amount
  1429     move ws-hi-amount           to cpo-hi-amount
  1430     write dcc-chkpoint-out-rec  from cpo-out-record
  1431     perform varying s1 from 1 by 1 until s1 > 16
  1432        move tbl-jobname    (s1) to cpo-jobname
  1433        move tbl-stepname   (s1) to cpo-stepname
  1434        move tbl-desc       (s1) to cpo-desc
  1435        move tbl-low-amount (s1) to cpo-low-amount
  1436        move tbl-hi-amount  (s1) to cpo-hi-amount
  1437        write dcc-chkpoint-out-rec from cpo-out-record
  1438     end-perform
  1439     close dcc-chkpoint-out
  1440     perform 0700-submit-job     thru 0700-exit
  1441     .
  1442 0600-exit.
  1443     exit.
  1444 0700-submit-job.
  1445     move function lower-case(bl-input-comp-id)
  1446                                 to tran-comp-id
  1447
  1448* EXEC CICS WRITEQ TD
  1449*       QUEUE ('BTCH')
  1450*       FROM (TRAN-DATA-LINE1)
  1451*       LENGTH (80)
  1452*    END-EXEC
  1453     MOVE 80
  1454       TO DFHEIV11
  1455     MOVE 'BTCH' TO DFHEIV5
  1456*    MOVE '(" L                  &   #00001333' TO DFHEIV0
  1457     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  1458     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1459     MOVE X'2020233030303031333333' TO DFHEIV0(25:11)
  1460     CALL 'kxdfhei1' USING DFHEIV0,
  1461           DFHEIV5,
  1462           TRAN-DATA-LINE1,
  1463           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 09-Oct-13 09:02 Page  27
* BSSRCH.cbl
  1464           DFHEIV99,
  1465           DFHEIV99
  1466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1467
  1468* EXEC CICS WRITEQ TD
  1469*       QUEUE ('BTCH')
  1470*       FROM (TRAN-DATA-LINE2)
  1471*       LENGTH (80)
  1472*    END-EXEC
  1473     MOVE 80
  1474       TO DFHEIV11
  1475     MOVE 'BTCH' TO DFHEIV5
  1476*    MOVE '(" L                  &   #00001338' TO DFHEIV0
  1477     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  1478     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1479     MOVE X'2020233030303031333338' TO DFHEIV0(25:11)
  1480     CALL 'kxdfhei1' USING DFHEIV0,
  1481           DFHEIV5,
  1482           TRAN-DATA-LINE2,
  1483           DFHEIV11,
  1484           DFHEIV99,
  1485           DFHEIV99
  1486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1487     .
  1488 0700-exit.
  1489     exit.
  1490
  1491 9999-DFHBACK SECTION.
  1492     MOVE '9%                    "   ' TO DFHEIV0
  1493     MOVE 'BSSRCH' TO DFHEIV1
  1494     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1495     GOBACK.
  1496 9999-DFHEXIT.
  1497     IF DFHEIGDJ EQUAL 0001
  1498         NEXT SENTENCE.
  1499     MOVE '9%                    "   ' TO DFHEIV0
  1500     MOVE 'BSSRCH' TO DFHEIV1
  1501     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1502     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10184     Code:        7668
