* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page   1
* EL6317.cbl
* Options: int("EL6317.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6317.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6317.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6317.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6317.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page   2
* EL6317.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 071712 CR2011022800001  AJRA  NAPERSOFT CANCELS
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 100412   2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121112   2012101700002  AJRA  CHANGE PF KEYS
    35* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    36*-----------------------------------------------------------------
    37*REMARKS.
    38*        TRANSACTION - EXBD - CERTIFICATE VERIFICATION
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page   3
* EL6317.cbl
    40 ENVIRONMENT DIVISION.
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL6317 WORKING STORAGE    *'.
    46 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    47 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    48 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    49 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    50 77  s1                          pic s999 comp-3 value +0.
    51 77  s2                          pic s999 comp-3 value +0.
    52 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    53 77  WS-REASON-SW                PIC X  VALUE ' '.
    54     88  REASONS-FOUND                  VALUE 'Y'.
    55     88  REASONS-NOT-FOUND              VALUE 'N'.
    56 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    57     88  NO-CERT-RW                 VALUE 'N'.
    58     88  CERT-RW                    VALUE 'Y'.
    59 01  P pointer.
    60 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    61 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    62 01  var-ptr pointer.
    63 01  env-var-len                 pic 9(4)  binary.
    64 01  rc                          pic 9(9)  binary.
    65 01  WS-KIXHOST                  PIC X(10).
    66 01  WS-KIXSYS.
    67     05  WS-KIX-FIL1             PIC X(10).
    68     05  WS-KIX-APPS             PIC X(10).
    69     05  WS-KIX-ENV              PIC X(10).
    70     05  WS-KIX-MYENV            PIC X(10).
    71     05  WS-KIX-SYS              PIC X(10).
    72*                                COPY ELCSCTM.
    73******************************************************************
    74*                                                                *
    75*                                                                *
    76*                            ELCSCTM                             *
    77*                            VMOD=2.001                          *
    78*                                                                *
    79*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    80*                                                                *
    81******************************************************************
    82 01  SECURITY-MESSAGE.
    83     12  FILLER                          PIC X(30)
    84            VALUE '** LOGIC SECURITY VIOLATION -'.
    85     12  SM-READ                         PIC X(6).
    86     12  FILLER                          PIC X(5)
    87            VALUE ' PGM='.
    88     12  SM-PGM                          PIC X(6).
    89     12  FILLER                          PIC X(5)
    90            VALUE ' OPR='.
    91     12  SM-PROCESSOR-ID                 PIC X(4).
    92     12  FILLER                          PIC X(6)
    93            VALUE ' TERM='.
    94     12  SM-TERMID                       PIC X(4).
    95     12  FILLER                          PIC XX   VALUE SPACE.
    96     12  SM-JUL-DATE                     PIC 9(5).
    97     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page   4
* EL6317.cbl
    98     12  SM-TIME                         PIC 99.99.
    99
   100*                                COPY ELCSCRTY.
   101******************************************************************
   102*                                                                *
   103*                                                                *
   104*                            ELCSCRTY                            *
   105*                            VMOD=2.001                          *
   106*                                                                *
   107*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   108*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   109*        SAVED IN PI-SECURITY-ADDRESS.                           *
   110*                                                                *
   111******************************************************************
   112 01  SECURITY-CONTROL.
   113     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   114     12  FILLER                       PIC XX    VALUE 'SC'.
   115     12  SC-CREDIT-CODES.
   116         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   117             20  SC-CREDIT-DISPLAY    PIC X.
   118             20  SC-CREDIT-UPDATE     PIC X.
   119     12  SC-CLAIMS-CODES.
   120         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   121             20  SC-CLAIMS-DISPLAY    PIC X.
   122             20  SC-CLAIMS-UPDATE     PIC X.
   123 01 srch-commarea.
   124*                                copy ELCADLTRSPI.
   125******************************************************************
   126*                   C H A N G E   L O G
   127*
   128* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   129*-----------------------------------------------------------------
   130*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   131* EFFECTIVE    NUMBER
   132*-----------------------------------------------------------------
   133* 060611    2011022800001  PEMA  NEW COPYBOOK
   134* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   135* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   136******************************************************************
   137****************************************
   138*  commarea for NaperSoft On Demand Admin services letters
   139*  (business logic input & output)
   140****************************************
   141     03  BL-INPUT.
   142         05  BL-DATA-SRCE        PIC X.
   143         05  BL-LETTER-ID        PIC XXXX.
   144         05  BL-CARRIER          PIC X.
   145         05  BL-GROUP            PIC X(6).
   146         05  BL-STATE            PIC XX.
   147         05  BL-ACCOUNT          PIC X(10).
   148         05  BL-EFF-DT           PIC X(10).
   149         05  BL-CERT-NO          PIC X(11).
   150         05  BL-BATCH-NO         PIC X(6).
   151         05  BL-BATCH-SEQ        PIC 9(8).
   152         05  BL-RESP-NO          PIC X(10).
   153         05  BL-NO-OF-COPIES     PIC 99.
   154         05  BL-PROC-ID          PIC XXXX.
   155         05  BL-COMP-ID          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page   5
* EL6317.cbl
   156         05  BL-PRINT-NOW-SW     PIC X.
   157         05  BL-ENC-CD           PIC XXX.
   158         05  BL-RESEND-DT        PIC X(10).
   159         05  BL-FOLLOW-UP-DT     PIC X(10).
   160         05  BL-ARCHIVE-NO       PIC 9(8).
   161         05  BL-FUNC             PIC X(8).
   162         05  BL-COMMENTS         PIC X(100).
   163         05  FILLER REDEFINES BL-COMMENTS.
   164             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   165             10  BL-LETTER-TO-ACCT PIC X.
   166             10  BL-LETTER-TO-BENE PIC X.
   167             10  BL-WRITE-ERARCH   PIC X.
   168                 88  ERARCH-QWS      VALUE 'Q'.
   169                 88  ERARCH-BATCH    VALUE 'B'.
   170                 88  ERARCH-TEMP     VALUE 'T'.
   171             10  BL-PROCESS-TYPE PIC X(07).
   172             10  BL-CERT-FORM-ID PIC X(05).
   173             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   174             10  BL-SOURCE-SCREEN PIC X(8).
   175             10  FILLER          PIC X(25).
   176     03  BL-OUTPUT.
   177         05  BL-STATUS                   PIC X.
   178             88  BL-OK                      VALUE "P".
   179             88  BL-FAIL                  VALUE "F".
   180         05  BL-MESSAGE          PIC X(50).
   181     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   182     03  FILLER                  PIC X(31).
   183
   184*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   185*                                COPY ELCZREC.
   186******************************************************************
   187*                                                                *
   188*                                                                *
   189*                            ELCZREC.                            *
   190*                                                                *
   191*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   192*                                                                *
   193******************************************************************
   194*-----------------------------------------------------------------
   195*                   C H A N G E   L O G
   196*
   197* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   198*-----------------------------------------------------------------
   199*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   200* EFFECTIVE    NUMBER
   201*-----------------------------------------------------------------
   202* 122011    2011022800001  AJRA  NEW FILE
   203* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   204*-----------------------------------------------------------------
   205 01  W-Z-CONTROL-DATA.
   206     05  W-NUMBER-OF-COPIES      PIC  9.
   207     05  FILLER                  PIC  X.
   208     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   209     05  FILLER                  PIC  X.
   210     05  W-DAYS-TO-RESEND        PIC  999.
   211     05  FILLER                  PIC  X.
   212     05  W-FORM-TO-RESEND        PIC  X(4).
   213     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page   6
* EL6317.cbl
   214     05  W-PROMPT-LETTER         PIC  X.
   215     05  FILLER                  PIC  X.
   216     05  W-ENCLOSURE-CD          PIC  XXX.
   217     05  FILLER                  PIC  X.
   218     05  W-AUTO-CLOSE-IND        PIC  X.
   219     05  FILLER                  PIC  X.
   220     05  W-LETTER-TO-BENE        PIC  X.
   221     05  FILLER                  PIC  X.
   222     05  W-LETTER-TO-ACCT        PIC  X.
   223     05  FILLER                  PIC  X.
   224     05  W-LETTER-TYPE           PIC  X.
   225     05  FILLER                  PIC  X.
   226     05  W-PRINT-CERTIFICATE     PIC  X.
   227     05  FILLER                  PIC  X.
   228     05  W-REFUND-REQUIRED       PIC  X.
   229     05  FILLER                  PIC  X.
   230     05  W-ONBASE-CODE           PIC  XX.
   231     05  FILLER                  PIC  X.
   232     05  W-ACCT-SUMM             PIC  X.
   233     05  FILLER                  PIC  X.
   234     05  W-CSO-SUMM              PIC  X.
   235     05  FILLER                  PIC  X(31).
   236 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   237 01  STANDARD-AREAS.
   238     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   239     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   240                                 PIC  X(08).
   241     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   242     12  QID.
   243         16  QID-TERM        PIC X(4)    VALUE SPACES.
   244         16  FILLER          PIC X(4)    VALUE '631J'.
   245     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   246     12  TIME-MT                 PIC S9(7).
   247     12  TIME-MT-R  REDEFINES TIME-MT.
   248         16  FILLER              PIC X.
   249         16  TIME-LMT            PIC 99V99.
   250         16  FILLER              PIC X(2).
   251     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   252     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   253     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   254     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   255     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   256     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   257     12  W-CNTL-KEY.
   258         16  W-CNTL-COMPANY-ID   PIC  X(03).
   259         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   260         16  W-CNTL-GENL.
   261             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   262             20  W-CNTL-GEN2.
   263                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   264                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   265         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   266     12  WS-ELCERT-KEY.
   267         16  W-CERT-COMPANY-CD   PIC X.
   268         16  W-CERT-CARRIER      PIC X.
   269         16  W-CERT-GROUPING     PIC X(6).
   270         16  W-CERT-STATE        PIC XX.
   271         16  W-CERT-ACCOUNT      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page   7
* EL6317.cbl
   272         16  W-CERT-CERT-EFF-DT  PIC XX.
   273         16  W-CERT-CERT-PRIME   PIC X(10).
   274         16  W-CERT-CERT-SFX     PIC X.
   275     12  WS-ELEOBC-KEY.
   276         16  WS-EOBC-COMPANY-CD  PIC X.
   277         16  WS-EOBC-REC-TYPE    PIC X.
   278         16  WS-EOBC-CODE        PIC X(4).
   279         16  FILLER              PIC X(9).
   280     12  WS-ERNOTE-KEY.
   281         16  W-NOTE-COMPANY-CD   PIC X.
   282         16  W-NOTE-CARRIER      PIC X.
   283         16  W-NOTE-GROUPING     PIC X(6).
   284         16  W-NOTE-STATE        PIC XX.
   285         16  W-NOTE-ACCOUNT      PIC X(10).
   286         16  W-NOTE-CERT-EFF-DT  PIC XX.
   287         16  W-NOTE-CERT-PRIME   PIC X(10).
   288         16  W-NOTE-CERT-SFX     PIC X.
   289     12  ELLETR-KEY.
   290         16  LETR-PART-KEY.
   291             20  LETR-COMPANY-CD PIC X.
   292             20  LETR-LETTER-ID  PIC X(4).
   293         16  LETR-FILLER         PIC X(8).
   294         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   295     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   296     12  ERPNDB2-KEY.
   297         16  PNDB2-COMPANY-CD    PIC X.
   298         16  PNDB2-CARRIER       PIC X.
   299         16  PNDB2-GROUPING      PIC X(6).
   300         16  PNDB2-STATE         PIC XX.
   301         16  PNDB2-ACCOUNT       PIC X(10).
   302         16  PNDB2-CERT-EFF-DT   PIC XX.
   303         16  PNDB2-CERT-PRIME    PIC X(10).
   304         16  PNDB2-CERT-SFX      PIC X.
   305         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   306         16  PNDB2-RECORD-TYPE   PIC X.
   307     12  ERPNDB-KEY.
   308         16  PNDB-COMPANY-CD     PIC X.
   309         16  PNDB-BATCH-NO       PIC X(6).
   310         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   311         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   312     12  ERENDT-KEY.
   313         16  ENDT-COMPANY-CD       PIC X.
   314         16  ENDT-CARRIER          PIC X.
   315         16  ENDT-GROUPING         PIC X(6).
   316         16  ENDT-STATE            PIC XX.
   317         16  ENDT-ACCOUNT          PIC X(10).
   318         16  ENDT-CERT-EFF-DT      PIC XX.
   319         16  ENDT-CERT-PRIME       PIC X(10).
   320         16  ENDT-CERT-SFX         PIC X.
   321         16  ENDT-RECORD-TYPE      PIC X.
   322         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   323     12  ELCRTO-KEY.
   324         16  CRTO-COMPANY-CD     PIC X.
   325         16  CRTO-CARRIER        PIC X.
   326         16  CRTO-GROUPING       PIC X(6).
   327         16  CRTO-STATE          PIC XX.
   328         16  CRTO-ACCOUNT        PIC X(10).
   329         16  CRTO-CERT-EFF-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page   8
* EL6317.cbl
   330         16  CRTO-CERT-PRIME     PIC X(10).
   331         16  CRTO-CERT-SFX       PIC X.
   332         16  CRTO-RECORD-TYPE    PIC X.
   333         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   334     12  WS-ERMAIL-KEY.
   335         16  MAIL-COMPANY-CD     PIC X.
   336         16  MAIL-CARRIER        PIC X.
   337         16  MAIL-GROUPING       PIC X(6).
   338         16  MAIL-STATE          PIC XX.
   339         16  MAIL-ACCOUNT        PIC X(10).
   340         16  MAIL-CERT-EFF-DT    PIC XX.
   341         16  MAIL-CERT-PRIME     PIC X(10).
   342         16  MAIL-CERT-SFX       PIC X.
   343     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   344     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   345     12  WS-CURRENT-DT.
   346         16  FILLER              PIC X(6)    VALUE SPACES.
   347         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   348     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   349     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   350         88  CANCEL-REC            VALUE 'C'.
   351         88  ISSUE-REC             VALUE 'I'.
   352     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   353     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   354     12  ELCNTL-KEY.
   355         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   356         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   357         16  CNTL-ACCESS.
   358             20  CNTL-STATE      PIC XX    VALUE SPACES.
   359             20  FILLER          PIC X     VALUE SPACES.
   360             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   361         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   362     12  ERACCT-KEY.
   363         16  ERACCT-COMP-KEY.
   364             20  ACCT-CO         PIC X     VALUE SPACES.
   365             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   366             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   367             20  ACCT-STATE      PIC XX    VALUE SPACES.
   368             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   369         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   370         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   371     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   372     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   373     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   374     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   375     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   376     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   377     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   378     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   379     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   380     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   381     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   382     12  WS-RESPONSE             PIC S9(8)   COMP.
   383         88  RESP-NORMAL                  VALUE +00.
   384         88  RESP-NOTFND                  VALUE +13.
   385         88  RESP-DUPREC                  VALUE +14.
   386         88  RESP-DUPKEY                  VALUE +15.
   387         88  RESP-NOTOPEN                 VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page   9
* EL6317.cbl
   388         88  RESP-ENDFILE                 VALUE +20.
   389     12  MAP-NAME            PIC X(8)    VALUE 'EL631J'.
   390     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6317S'.
   391     12  SCREEN-NUMBER       PIC X(4)    VALUE '631J'.
   392     12  TRANS-ID            PIC X(4)    VALUE 'EXBD'.
   393     12  THIS-PGM            PIC X(8)    VALUE 'EL6317'.
   394     12  PGM-NAME            PIC X(8).
   395     12  TIME-IN             PIC S9(7).
   396     12  TIME-OUT-R  REDEFINES TIME-IN.
   397         16  FILLER          PIC X.
   398         16  TIME-OUT        PIC 99V99.
   399         16  FILLER          PIC X(2).
   400     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   401     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   402     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   403     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   404     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   405     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   406     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   407     12  WS-PHONE.
   408         16  WS-PH1              PIC XXX.
   409         16  WS-PH2              PIC XXX.
   410         16  WS-PH3              PIC XXXX.
   411     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   412     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   413
   414     12  WS-BILLING-NOTE.
   415         16  WS-BN-NOTE          PIC X(25).
   416         16  WS-BN-LTRID         PIC X(4).
   417         16  FILLER              PIC X(3).
   418         16  WS-BN-DATE          PIC X(8).
   419         16  FILLER              PIC X(3).
   420         16  WS-BN-USERID        PIC X(4).
   421         16  FILLER              PIC X(30).
   422     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   423         16  WS-MAN-BN-NOTE      PIC X(63).
   424         16  FILLER              PIC X(14).
   425     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   426
   427 01  NEW-ELCRTO-REC.
   428     12  NEW-ELCRTO-KEY.
   429         16  NCRTO-COMPANY-CD      PIC X.
   430         16  NCRTO-CARRIER         PIC X.
   431         16  NCRTO-GROUPING        PIC X(6).
   432         16  NCRTO-STATE           PIC XX.
   433         16  NCRTO-ACCOUNT         PIC X(10).
   434         16  NCRTO-CERT-EFF-DT     PIC XX.
   435         16  NCRTO-CERT-PRIME      PIC X(10).
   436         16  NCRTO-CERT-SFX        PIC X.
   437         16  NCRTO-RECORD-TYPE     PIC X.
   438         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   439     12  NEW-ORIG-REC.
   440         16  NCRTO-INS-LAST-NAME   PIC X(15).
   441         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   442         16  NCRTO-INS-MIDDLE-INIT PIC X.
   443         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   444         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   445         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  10
* EL6317.cbl
   446         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   447         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   448         16  NCRTO-LF-BENCD        PIC XX.
   449         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   450         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   451         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   452         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   453         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   454         16  NCRTO-LF-EXP-DT       PIC XX.
   455         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   456         16  NCRTO-LF-CANCEL-DT    PIC XX.
   457         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   458         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   459         16  NCRTO-AH-BENCD        PIC XX.
   460         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   461         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   462         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   463         16  NCRTO-AH-EXP-DT       PIC XX.
   464         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   465         16  NCRTO-AH-CP           PIC 99.
   466         16  NCRTO-AH-CANCEL-DT    PIC XX.
   467         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   468         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   469         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   470         16  NCRTO-1ST-PMT-DT      PIC XX.
   471         16  FILLER                PIC X(239).
   472
   473 01  CERT-NOTE-ENTRIES.
   474     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   475         16  CERT-NT-TEXT                PIC X(63).
   476         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   477         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   478         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   479
   480 01  ERCNOT-AREA.
   481     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   482     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   483     12  ERCNOT-KEY.
   484         16  ERCNOT-PARTIAL-KEY.
   485             20 ERCNOT-COMPANY-CD    PIC X.
   486             20 ERCNOT-CARRIER       PIC X.
   487             20 ERCNOT-GROUPING      PIC X(06).
   488             20 ERCNOT-STATE         PIC XX.
   489             20 ERCNOT-ACCOUNT       PIC X(10).
   490             20 ERCNOT-EFF-DT        PIC XX.
   491             20 ERCNOT-CERT-NO.
   492                25 ERCNOT-CERT-PRIME PIC X(10).
   493                25 ERCNOT-CERT-SFX   PIC X.
   494             20 ERCNOT-REC-TYP       PIC X.
   495         16 ERCNOT-SEQ           PIC S9(4) COMP.
   496     12  SV-PARTIAL-KEY.
   497         20 SV-COMPANY-CD            PIC X.
   498         20 SV-CARRIER               PIC X.
   499         20 SV-GROUPING              PIC X(06).
   500         20 SV-STATE                 PIC XX.
   501         20 SV-ACCOUNT               PIC X(10).
   502         20 SV-EFF-DT                PIC XX.
   503         20 SV-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  11
* EL6317.cbl
   504            25 SV-CERT-PRIME         PIC X(10).
   505            25 SV-CERT-SFX           PIC X(1).
   506         20 SV-REC-TYP               PIC X.
   507 01  ERROR-MESSAGES.
   508     12  ER-0000                 PIC X(4)  VALUE '0000'.
   509     12  ER-0004                 PIC X(4)  VALUE '0004'.
   510     12  ER-0008                 PIC X(4)  VALUE '0008'.
   511     12  ER-0023                 PIC X(4)  VALUE '0023'.
   512     12  ER-0029                 PIC X(4)  VALUE '0029'.
   513     12  ER-0068                 PIC X(4)  VALUE '0068'.
   514     12  ER-0132                 PIC X(4)  VALUE '0132'.
   515     12  ER-0142                 PIC X(4)  VALUE '0142'.
   516     12  ER-0148                 PIC X(4)  VALUE '0148'.
   517     12  ER-0215                 PIC X(4)  VALUE '0215'.
   518     12  ER-0280                 PIC X(4)  VALUE '0280'.
   519     12  ER-0348                 PIC X(4)  VALUE '0348'.
   520     12  ER-0419                 PIC X(4)  VALUE '0419'.
   521     12  ER-0894                 PIC X(4)  VALUE '0894'.
   522     12  ER-1101                 PIC X(4)  VALUE '1101'.
   523     12  ER-1236                 PIC X(4)  VALUE '1236'.
   524     12  ER-1818                 PIC X(4)  VALUE '1818'.
   525     12  ER-1820                 PIC X(4)  VALUE '1820'.
   526     12  ER-2056                 PIC X(4)  VALUE '2056'.
   527     12  ER-2079                 PIC X(4)  VALUE '2079'.
   528     12  ER-2208                 PIC X(4)  VALUE '2208'.
   529     12  ER-2209                 PIC X(4)  VALUE '2209'.
   530     12  ER-2237                 PIC X(4)  VALUE '2237'.
   531     12  ER-2238                 PIC X(4)  VALUE '2238'.
   532     12  ER-2253                 PIC X(4)  VALUE '2253'.
   533     12  ER-2619                 PIC X(4)  VALUE '2619'.
   534     12  ER-2651                 PIC X(4)  VALUE '2651'.
   535     12  ER-2784                 PIC X(4)  VALUE '2784'.
   536     12  ER-2785                 PIC X(4)  VALUE '2785'.
   537     12  ER-2786                 PIC X(4)  VALUE '2786'.
   538     12  ER-2791                 PIC X(4)  VALUE '2791'.
   539     12  ER-2845                 PIC X(4)  VALUE '2845'.
   540     12  ER-2848                 PIC X(4)  VALUE '2848'.
   541     12  ER-2851                 PIC X(4)  VALUE '2851'.
   542     12  ER-3830                 PIC X(4)  VALUE '3830'.
   543     12  ER-3833                 PIC X(4)  VALUE '3833'.
   544     12  ER-7345                 PIC X(4)  VALUE '7345'.
   545     12  ER-7638                 PIC X(4)  VALUE '7638'.
   546     12  ER-8888                 PIC X(4)  VALUE '8888'.
   547     12  ER-9999                 PIC X(4)  VALUE '9999'.
   548*    COPY ELCDATE.
   549******************************************************************
   550*                                                                *
   551*                                                                *
   552*                            ELCDATE.                            *
   553*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   554*                            VMOD=2.003
   555*                                                                *
   556*                                                                *
   557*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   558*                 LENGTH = 200                                   *
   559******************************************************************
   560
   561 01  DATE-CONVERSION-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  12
* EL6317.cbl
   562     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   563     12  DC-OPTION-CODE                PIC X.
   564         88  BIN-TO-GREG                VALUE ' '.
   565         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   566         88  EDIT-GREG-TO-BIN           VALUE '2'.
   567         88  YMD-GREG-TO-BIN            VALUE '3'.
   568         88  MDY-GREG-TO-BIN            VALUE '4'.
   569         88  JULIAN-TO-BIN              VALUE '5'.
   570         88  BIN-PLUS-ELAPSED           VALUE '6'.
   571         88  FIND-CENTURY               VALUE '7'.
   572         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   573         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   574         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   575         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   576         88  JULIAN-TO-BIN-3            VALUE 'C'.
   577         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   578         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   579         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   580         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   581         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   582         88  CHECK-LEAP-YEAR            VALUE 'H'.
   583         88  BIN-3-TO-GREG              VALUE 'I'.
   584         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   585         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   586         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   587         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   588         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   589         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   590         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   591         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   592         88  THREE-CHARACTER-BIN
   593                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   594         88  GREGORIAN-TO-BIN
   595                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   596         88  BIN-TO-GREGORIAN
   597                  VALUES ' ' '1' 'I' '8' 'G'.
   598         88  JULIAN-TO-BINARY
   599                  VALUES '5' 'C' 'E' 'F'.
   600     12  DC-ERROR-CODE                 PIC X.
   601         88  NO-CONVERSION-ERROR        VALUE ' '.
   602         88  DATE-CONVERSION-ERROR
   603                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   604         88  DATE-IS-ZERO               VALUE '1'.
   605         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   606         88  DATE-IS-INVALID            VALUE '3'.
   607         88  DATE1-GREATER-DATE2        VALUE '4'.
   608         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   609         88  DATE-INVALID-OPTION        VALUE '9'.
   610         88  INVALID-CENTURY            VALUE 'A'.
   611         88  ONLY-CENTURY               VALUE 'B'.
   612         88  ONLY-LEAP-YEAR             VALUE 'C'.
   613         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   614     12  DC-END-OF-MONTH               PIC X.
   615         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   616     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   617         88  USE-NORMAL-PROCESS         VALUE ' '.
   618         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   619         88  ADJUST-UP-100-YRS          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  13
* EL6317.cbl
   620     12  FILLER                        PIC X.
   621     12  DC-CONVERSION-DATES.
   622         16  DC-BIN-DATE-1             PIC XX.
   623         16  DC-BIN-DATE-2             PIC XX.
   624         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   625         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   626                       DC-GREG-DATE-1-EDIT.
   627             20  DC-EDIT1-MONTH        PIC 99.
   628             20  SLASH1-1              PIC X.
   629             20  DC-EDIT1-DAY          PIC 99.
   630             20  SLASH1-2              PIC X.
   631             20  DC-EDIT1-YEAR         PIC 99.
   632         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   633         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   634                     DC-GREG-DATE-2-EDIT.
   635             20  DC-EDIT2-MONTH        PIC 99.
   636             20  SLASH2-1              PIC X.
   637             20  DC-EDIT2-DAY          PIC 99.
   638             20  SLASH2-2              PIC X.
   639             20  DC-EDIT2-YEAR         PIC 99.
   640         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   641         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   642                     DC-GREG-DATE-1-YMD.
   643             20  DC-YMD-YEAR           PIC 99.
   644             20  DC-YMD-MONTH          PIC 99.
   645             20  DC-YMD-DAY            PIC 99.
   646         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   647         16  DC-GREG-DATE-1-MDY-R REDEFINES
   648                      DC-GREG-DATE-1-MDY.
   649             20  DC-MDY-MONTH          PIC 99.
   650             20  DC-MDY-DAY            PIC 99.
   651             20  DC-MDY-YEAR           PIC 99.
   652         16  DC-GREG-DATE-1-ALPHA.
   653             20  DC-ALPHA-MONTH        PIC X(10).
   654             20  DC-ALPHA-DAY          PIC 99.
   655             20  FILLER                PIC XX.
   656             20  DC-ALPHA-CENTURY.
   657                 24 DC-ALPHA-CEN-N     PIC 99.
   658             20  DC-ALPHA-YEAR         PIC 99.
   659         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   660         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   661         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   662         16  DC-JULIAN-DATE            PIC 9(05).
   663         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   664                                       PIC 9(05).
   665         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   666             20  DC-JULIAN-YEAR        PIC 99.
   667             20  DC-JULIAN-DAYS        PIC 999.
   668         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   669         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   670         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   671     12  DATE-CONVERSION-VARIBLES.
   672         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   673         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   674             20  FILLER                PIC 9(3).
   675             20  HOLD-CEN-1-CCYY.
   676                 24  HOLD-CEN-1-CC     PIC 99.
   677                 24  HOLD-CEN-1-YY     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  14
* EL6317.cbl
   678             20  HOLD-CEN-1-MO         PIC 99.
   679             20  HOLD-CEN-1-DA         PIC 99.
   680         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   681             20  HOLD-CEN-1-R-MO       PIC 99.
   682             20  HOLD-CEN-1-R-DA       PIC 99.
   683             20  HOLD-CEN-1-R-CCYY.
   684                 24  HOLD-CEN-1-R-CC   PIC 99.
   685                 24  HOLD-CEN-1-R-YY   PIC 99.
   686             20  FILLER                PIC 9(3).
   687         16  HOLD-CENTURY-1-X.
   688             20  FILLER                PIC X(3)  VALUE SPACES.
   689             20  HOLD-CEN-1-X-CCYY.
   690                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   691                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   692             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   693             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   694         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   695             20  HOLD-CEN-1-R-X-MO     PIC XX.
   696             20  HOLD-CEN-1-R-X-DA     PIC XX.
   697             20  HOLD-CEN-1-R-X-CCYY.
   698                 24  HOLD-CEN-1-R-X-CC PIC XX.
   699                 24  HOLD-CEN-1-R-X-YY PIC XX.
   700             20  FILLER                PIC XXX.
   701         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   702         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   703         16  DC-JULIAN-DATE-1          PIC 9(07).
   704         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   705             20  DC-JULIAN-1-CCYY.
   706                 24  DC-JULIAN-1-CC    PIC 99.
   707                 24  DC-JULIAN-1-YR    PIC 99.
   708             20  DC-JULIAN-DA-1        PIC 999.
   709         16  DC-JULIAN-DATE-2          PIC 9(07).
   710         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   711             20  DC-JULIAN-2-CCYY.
   712                 24  DC-JULIAN-2-CC    PIC 99.
   713                 24  DC-JULIAN-2-YR    PIC 99.
   714             20  DC-JULIAN-DA-2        PIC 999.
   715         16  DC-GREG-DATE-A-EDIT.
   716             20  DC-EDITA-MONTH        PIC 99.
   717             20  SLASHA-1              PIC X VALUE '/'.
   718             20  DC-EDITA-DAY          PIC 99.
   719             20  SLASHA-2              PIC X VALUE '/'.
   720             20  DC-EDITA-CCYY.
   721                 24  DC-EDITA-CENT     PIC 99.
   722                 24  DC-EDITA-YEAR     PIC 99.
   723         16  DC-GREG-DATE-B-EDIT.
   724             20  DC-EDITB-MONTH        PIC 99.
   725             20  SLASHB-1              PIC X VALUE '/'.
   726             20  DC-EDITB-DAY          PIC 99.
   727             20  SLASHB-2              PIC X VALUE '/'.
   728             20  DC-EDITB-CCYY.
   729                 24  DC-EDITB-CENT     PIC 99.
   730                 24  DC-EDITB-YEAR     PIC 99.
   731         16  DC-GREG-DATE-CYMD         PIC 9(08).
   732         16  DC-GREG-DATE-CYMD-R REDEFINES
   733                              DC-GREG-DATE-CYMD.
   734             20  DC-CYMD-CEN           PIC 99.
   735             20  DC-CYMD-YEAR          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  15
* EL6317.cbl
   736             20  DC-CYMD-MONTH         PIC 99.
   737             20  DC-CYMD-DAY           PIC 99.
   738         16  DC-GREG-DATE-MDCY         PIC 9(08).
   739         16  DC-GREG-DATE-MDCY-R REDEFINES
   740                              DC-GREG-DATE-MDCY.
   741             20  DC-MDCY-MONTH         PIC 99.
   742             20  DC-MDCY-DAY           PIC 99.
   743             20  DC-MDCY-CEN           PIC 99.
   744             20  DC-MDCY-YEAR          PIC 99.
   745    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   746        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   747    12  DC-EL310-DATE                  PIC X(21).
   748    12  FILLER                         PIC X(28).
   749*    COPY ELCTEXT.
   750******************************************************************
   751*                                                                *
   752*                                                                *
   753*                            ELCTEXT.                            *
   754*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   755*                            VMOD=2.008                          *
   756*                                                                *
   757*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   758*                                     FORM LETTERS,              *
   759*                                     CERT FORM DISPLAY.
   760*                                                                *
   761*   FILE TYPE = VSAM,KSDS                                        *
   762*   RECORD SIZE = 100   RECFORM = FIXED                          *
   763*                                                                *
   764*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   765*       ALTERNATE INDEX = NONE                                   *
   766*                                                                *
   767*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   768*       ALTERNATE INDEX = NONE                                   *
   769*                                                                *
   770*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   771*       ALTERNATE INDEX = NONE                                   *
   772*                                                                *
   773*   LOG = NO                                                     *
   774*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   775******************************************************************
   776 01  TEXT-FILES.
   777     12  TEXT-FILE-ID                PIC XX.
   778         88  FORMS-FILE-TEXT            VALUE 'TF'.
   779         88  LETTER-FILE-TEXT           VALUE 'TL'.
   780         88  HELP-FILE-TEXT             VALUE 'TH'.
   781
   782     12  TX-CONTROL-PRIMARY.
   783         16  TX-COMPANY-CD           PIC X.
   784             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   785         16  TX-ACCESS-CD-GENL       PIC X(12).
   786
   787         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   788             20  TX-LETTER-NO        PIC X(4).
   789             20  FILLER              PIC X(8).
   790
   791         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   792             20  TX-FORM-NO          PIC X(12).
   793
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  16
* EL6317.cbl
   794         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   795             20  TX-HELP-TYPE        PIC X.
   796                 88  HELP-FOR-GENERAL   VALUE ' '.
   797                 88  HELP-BY-SCREEN     VALUE 'S'.
   798                 88  HELP-BY-ERROR      VALUE 'E'.
   799             20  TX-SCREEN-OR-ERROR  PIC X(4).
   800                 88  GENERAL-INFO-HELP  VALUE '0000'.
   801             20  TX-HELP-FOR-COMPANY  PIC XXX.
   802                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   803             20  FILLER              PIC X(4).
   804
   805         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   806
   807     12  TX-PROCESS-CONTROL          PIC XX.
   808         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   809
   810     12  TX-TEXT-LINE                PIC X(70).
   811
   812     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   813         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   814         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   815         88  TX-VALID-FORM-SQUEEZE-VALUE
   816                                        VALUE 'Y' ' '.
   817
   818     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   819         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   820         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   821         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   822         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   823         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   824         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   825         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   826                                              'K' 'N' ' '
   827                                              'Z'.
   828
   829     12  TX-ARCHIVE-SW               PIC X.
   830         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   831         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   832         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   833
   834     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   835     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   836
   837     12  TX-BSR-CODE                 PIC X.
   838         88  TX-BSR-LETTER              VALUE 'B'.
   839         88  TX-NON-BSR-LETTER          VALUE ' '.
   840
   841     12  FILLER                      PIC X.
   842*****************************************************************
   843*    COPY ELCLOGOF.
   844******************************************************************
   845*                                                                *
   846*                                                                *
   847*                            ELCLOGOF.                           *
   848*                            VMOD=2.001                          *
   849*                                                                *
   850*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   851*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  17
* EL6317.cbl
   852******************************************************************
   853 01  CLASIC-LOGOFF.
   854     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   855     12  LOGOFF-TEXT.
   856         16  FILLER          PIC X(5)    VALUE SPACES.
   857         16  LOGOFF-MSG.
   858             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   859             20  FILLER      PIC X       VALUE SPACES.
   860             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   861         16  FILLER          PIC X(80)
   862           VALUE '* YOU ARE NOW LOGGED OFF'.
   863         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   864         16  FILLER          PIC X       VALUE QUOTE.
   865         16  LOGOFF-SYS-MSG  PIC X(17)
   866           VALUE 'S CLAS-IC SYSTEM '.
   867     12  TEXT-MESSAGES.
   868         16  UNACCESS-MSG    PIC X(29)
   869             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   870         16  PGMIDERR-MSG    PIC X(17)
   871             VALUE 'PROGRAM NOT FOUND'.
   872*    COPY ELCATTR.
   873******************************************************************
   874*                                                                *
   875*                            ELCATTR.                            *
   876*                            VMOD=2.001                          *
   877*                                                                *
   878*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   879*                                                                *
   880*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   881*                                                                *
   882*                   POS 1   P=PROTECTED                          *
   883*                           U=UNPROTECTED                        *
   884*                           S=ASKIP                              *
   885*                   POS 2   A=ALPHA/NUMERIC                      *
   886*                           N=NUMERIC                            *
   887*                   POS 3   N=NORMAL                             *
   888*                           B=BRIGHT                             *
   889*                           D=DARK                               *
   890*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   891*                           OF=MODIFIED DATA TAG OFF             *
   892*                                                                *
   893*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   894******************************************************************
   895 01  ATTRIBUTE-LIST.
   896     12  AL-PABOF            PIC X       VALUE 'Y'.
   897     12  AL-PABON            PIC X       VALUE 'Z'.
   898     12  AL-PADOF            PIC X       VALUE '%'.
   899     12  AL-PADON            PIC X       VALUE '_'.
   900     12  AL-PANOF            PIC X       VALUE '-'.
   901     12  AL-PANON            PIC X       VALUE '/'.
   902     12  AL-SABOF            PIC X       VALUE '8'.
   903     12  AL-SABON            PIC X       VALUE '9'.
   904     12  AL-SADOF            PIC X       VALUE '@'.
   905     12  AL-SADON            PIC X       VALUE QUOTE.
   906     12  AL-SANOF            PIC X       VALUE '0'.
   907     12  AL-SANON            PIC X       VALUE '1'.
   908     12  AL-UABOF            PIC X       VALUE 'H'.
   909     12  AL-UABON            PIC X       VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  18
* EL6317.cbl
   910     12  AL-UADOF            PIC X       VALUE '<'.
   911     12  AL-UADON            PIC X       VALUE '('.
   912     12  AL-UANOF            PIC X       VALUE ' '.
   913     12  AL-UANON            PIC X       VALUE 'A'.
   914     12  AL-UNBOF            PIC X       VALUE 'Q'.
   915     12  AL-UNBON            PIC X       VALUE 'R'.
   916     12  AL-UNDOF            PIC X       VALUE '*'.
   917     12  AL-UNDON            PIC X       VALUE ')'.
   918     12  AL-UNNOF            PIC X       VALUE '&'.
   919     12  AL-UNNON            PIC X       VALUE 'J'.
   920*    COPY ELCEMIB.
   921******************************************************************
   922*                                                                *
   923*                                                                *
   924*                            ELCEMIB.                            *
   925*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   926*                            VMOD=2.005                          *
   927*                                                                *
   928*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   929*                                                                *
   930******************************************************************
   931 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   932     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   933     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   934     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   935     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   936     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   937     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   938     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   939     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   940     12  EMI-SWITCH1             PIC X        VALUE '1'.
   941         88  EMI-NO-ERRORS                    VALUE '1'.
   942         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   943         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   944     12  EMI-SWITCH2             PIC X        VALUE '1'.
   945         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   946     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   947         88  EMI-AREA1-EMPTY                  VALUE '1'.
   948         88  EMI-AREA1-FULL                   VALUE '2'.
   949     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   950         88  EMI-AREA2-EMPTY                  VALUE '1'.
   951         88  EMI-AREA2-FULL                   VALUE '2'.
   952     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   953         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   954         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   955         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   956         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   957         88  EMI-BYPASS-FATALS                VALUE 'X'.
   958     12  EMI-ERROR-LINES.
   959         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   960         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   961         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   962         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   963             20  EMI-ERR-CODES OCCURS 10 TIMES.
   964                 24  EMI-ERR-NUM         PIC X(4).
   965                 24  EMI-FILLER          PIC X.
   966                 24  EMI-SEV             PIC X.
   967                 24  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  19
* EL6317.cbl
   968             20  FILLER                  PIC X(02).
   969     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   970         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   971             20  EMI-ERROR-NUMBER    PIC X(4).
   972             20  EMI-FILL            PIC X.
   973             20  EMI-SEVERITY        PIC X.
   974             20  FILLER              PIC X.
   975             20  EMI-ERROR-TEXT.
   976                 24  EMI-TEXT-VARIABLE   PIC X(10).
   977                 24  FILLER          PIC X(55).
   978     12  EMI-SEVERITY-SAVE           PIC X.
   979         88  EMI-NOTE                    VALUE 'N'.
   980         88  EMI-WARNING                 VALUE 'W'.
   981         88  EMI-FORCABLE                VALUE 'F'.
   982         88  EMI-FATAL                   VALUE 'X'.
   983     12  EMI-MESSAGE-FLAG            PIC X.
   984         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   985         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   986     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   987     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   988         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   989         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   990         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   991     12  FILLER                      PIC X(137)  VALUE SPACES.
   992     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   993     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   994     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   995     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   996*    COPY ELCINTF.
   997******************************************************************
   998*                                                                *
   999*                                                                *
  1000*                            ELCINTF.                            *
  1001*                            VMOD=2.017                          *
  1002*                                                                *
  1003*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1004*                                                                *
  1005*       LENGTH = 1024                                            *
  1006*                                                                *
  1007******************************************************************
  1008*                   C H A N G E   L O G
  1009*
  1010* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1011*-----------------------------------------------------------------
  1012*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1013* EFFECTIVE    NUMBER
  1014*-----------------------------------------------------------------
  1015* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1016******************************************************************
  1017 01  PROGRAM-INTERFACE-BLOCK.
  1018     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1019     12  PI-CALLING-PROGRAM              PIC X(8).
  1020     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1021     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1022     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1023     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1024     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1025     12  PI-SAVED-PROGRAM-6              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  20
* EL6317.cbl
  1026     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1027     12  PI-COMPANY-ID                   PIC XXX.
  1028     12  PI-COMPANY-CD                   PIC X.
  1029
  1030     12  PI-COMPANY-PASSWORD             PIC X(8).
  1031
  1032     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1033
  1034     12  PI-CONTROL-IN-PROGRESS.
  1035         16  PI-CARRIER                  PIC X.
  1036         16  PI-GROUPING                 PIC X(6).
  1037         16  PI-STATE                    PIC XX.
  1038         16  PI-ACCOUNT                  PIC X(10).
  1039         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1040                                         PIC X(10).
  1041         16  PI-CLAIM-CERT-GRP.
  1042             20  PI-CLAIM-NO             PIC X(7).
  1043             20  PI-CERT-NO.
  1044                 25  PI-CERT-PRIME       PIC X(10).
  1045                 25  PI-CERT-SFX         PIC X.
  1046             20  PI-CERT-EFF-DT          PIC XX.
  1047         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1048             20  PI-PLAN-CODE            PIC X(2).
  1049             20  PI-REVISION-NUMBER      PIC X(3).
  1050             20  PI-PLAN-EFF-DT          PIC X(2).
  1051             20  PI-PLAN-EXP-DT          PIC X(2).
  1052             20  FILLER                  PIC X(11).
  1053         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1054             20  PI-OE-REFERENCE-1.
  1055                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1056                 25  PI-OE-REF-1-SUFF    PIC XX.
  1057
  1058     12  PI-SESSION-IN-PROGRESS          PIC X.
  1059         88  CLAIM-SESSION                   VALUE '1'.
  1060         88  CREDIT-SESSION                  VALUE '2'.
  1061         88  WARRANTY-SESSION                VALUE '3'.
  1062         88  MORTGAGE-SESSION                VALUE '4'.
  1063         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1064
  1065
  1066*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1067
  1068     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1069     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1070
  1071     12  PI-CREDIT-USER                  PIC X.
  1072         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1073         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1074
  1075     12  PI-CLAIM-USER                   PIC X.
  1076         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1077         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1078
  1079     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1080         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1081         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1082         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1083         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  21
* EL6317.cbl
  1084         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1085
  1086     12  PI-PROCESSOR-ID                 PIC X(4).
  1087
  1088     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1089
  1090     12  PI-MEMBER-CAPTION               PIC X(10).
  1091
  1092     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1093         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1094
  1095     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1096     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1097     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1098     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1099
  1100     12  PI-AH-OVERRIDE-L1               PIC X.
  1101     12  PI-AH-OVERRIDE-L2               PIC XX.
  1102     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1103     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1104
  1105     12  PI-NEW-SYSTEM                   PIC X(2).
  1106
  1107     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1108     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1109         88  PI-USES-PAID-TO                 VALUE '1'.
  1110     12  PI-CRDTCRD-SYSTEM.
  1111         16  PI-CRDTCRD-USER             PIC X.
  1112             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1113             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1114         16  PI-CC-MONTH-END-DT          PIC XX.
  1115     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1116
  1117     12  PI-OE-REFERENCE-2.
  1118         16  PI-OE-REF-2-PRIME           PIC X(10).
  1119         16  PI-OE-REF-2-SUFF            PIC X.
  1120
  1121     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1122
  1123     12  PI-LANGUAGE-TYPE                PIC X.
  1124             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1125             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1126             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1127
  1128     12  PI-POLICY-LINKAGE-IND           PIC X.
  1129         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1130         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1131                                                   LOW-VALUES.
  1132
  1133     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1134     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1135         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1136         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1137
  1138     12  PI-PROCESSOR-CSR-IND            PIC X.
  1139         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1140         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1141
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  22
* EL6317.cbl
  1142     12  FILLER                          PIC X(3).
  1143
  1144     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1145
  1146     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1147         PI-SYSTEM-LEVEL.
  1148
  1149         16  PI-ENTRY-CODES.
  1150             20  PI-ENTRY-CD-1           PIC X.
  1151             20  PI-ENTRY-CD-2           PIC X.
  1152
  1153         16  PI-RETURN-CODES.
  1154             20  PI-RETURN-CD-1          PIC X.
  1155             20  PI-RETURN-CD-2          PIC X.
  1156
  1157         16  PI-UPDATE-STATUS-SAVE.
  1158             20  PI-UPDATE-BY            PIC X(4).
  1159             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1160
  1161         16  PI-LOWER-CASE-LETTERS       PIC X.
  1162             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1163
  1164*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1165*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1166*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1167
  1168         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1169             88  ST-ACCNT-CNTL               VALUE ' '.
  1170             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1171             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1172             88  ACCNT-CNTL                  VALUE '3'.
  1173             88  CARR-ACCNT-CNTL             VALUE '4'.
  1174
  1175         16  PI-PROCESSOR-CAP-LIST.
  1176             20  PI-SYSTEM-CONTROLS.
  1177                24 PI-SYSTEM-DISPLAY     PIC X.
  1178                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1179                24 PI-SYSTEM-MODIFY      PIC X.
  1180                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1181             20  FILLER                  PIC XX.
  1182             20  PI-DISPLAY-CAP          PIC X.
  1183                 88  DISPLAY-CAP             VALUE 'Y'.
  1184             20  PI-MODIFY-CAP           PIC X.
  1185                 88  MODIFY-CAP              VALUE 'Y'.
  1186             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1187                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1188             20  PI-FORCE-CAP            PIC X.
  1189                 88  FORCE-CAP               VALUE 'Y'.
  1190
  1191         16  PI-PROGRAM-CONTROLS.
  1192             20  PI-PGM-PRINT-OPT        PIC X.
  1193             20  PI-PGM-FORMAT-OPT       PIC X.
  1194             20  PI-PGM-PROCESS-OPT      PIC X.
  1195             20  PI-PGM-TOTALS-OPT       PIC X.
  1196
  1197         16  PI-HELP-INTERFACE.
  1198             20  PI-LAST-ERROR-NO        PIC X(4).
  1199             20  PI-CURRENT-SCREEN-NO    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  23
* EL6317.cbl
  1200
  1201         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1202             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1203
  1204         16  PI-CR-CONTROL-IN-PROGRESS.
  1205             20  PI-CR-CARRIER           PIC X.
  1206             20  PI-CR-GROUPING          PIC X(6).
  1207             20  PI-CR-STATE             PIC XX.
  1208             20  PI-CR-ACCOUNT           PIC X(10).
  1209             20  PI-CR-FIN-RESP          PIC X(10).
  1210             20  PI-CR-TYPE              PIC X.
  1211
  1212         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1213
  1214         16  PI-CR-MONTH-END-DT          PIC XX.
  1215
  1216         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1217             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1218             88  PI-ZERO-CARRIER             VALUE '1'.
  1219             88  PI-ZERO-GROUPING            VALUE '2'.
  1220             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1221
  1222         16  PI-CARRIER-SECURITY         PIC X.
  1223             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1224
  1225         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1226             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1227             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1228
  1229         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1230             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1231                                         INDEXED BY PI-ACCESS-NDX
  1232                                         PIC X.
  1233
  1234         16  PI-GA-BILLING-CONTROL       PIC X.
  1235             88  PI-GA-BILLING               VALUE '1'.
  1236
  1237         16  PI-MAIL-PROCESSING          PIC X.
  1238             88  PI-MAIL-YES                 VALUE 'Y'.
  1239
  1240         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1241
  1242         16  PI-AR-SYSTEM.
  1243             20  PI-AR-PROCESSING-CNTL   PIC X.
  1244                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1245             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1246             20  PI-AR-MONTH-END-DT      PIC XX.
  1247
  1248         16  PI-MP-SYSTEM.
  1249             20  PI-MORTGAGE-USER            PIC X.
  1250                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1251                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1252             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1253                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1254                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1255                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1256                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1257                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  24
* EL6317.cbl
  1258             20  PI-MP-MONTH-END-DT          PIC XX.
  1259             20  PI-MP-REFERENCE-NO.
  1260                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1261                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1262
  1263         16  PI-LABEL-CONTROL            PIC X(01).
  1264             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1265             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1266
  1267         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1268             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1269
  1270         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1271             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1272             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1273
  1274         16  FILLER                      PIC X(14).
  1275
  1276     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1277******************************************************************
  1278     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1279        16  PI-ISS-CAN-SW           PIC X.
  1280        16  PI-ERENDT-KEY.
  1281            20  PI-ENDT-COMPANY-CD  PIC X.
  1282            20  PI-ENDT-CARRIER     PIC X.
  1283            20  PI-ENDT-GROUPING    PIC X(6).
  1284            20  PI-ENDT-STATE       PIC XX.
  1285            20  PI-ENDT-ACCOUNT     PIC X(10).
  1286            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1287            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1288            20  PI-ENDT-CERT-SFX    PIC X.
  1289            20  PI-ENDT-RECORD-TYPE PIC X.
  1290            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1291        16  PI-ELCRTO-KEY.
  1292            20  PI-CRTO-COMPANY-CD  PIC X.
  1293            20  PI-CRTO-CARRIER     PIC X.
  1294            20  PI-CRTO-GROUPING    PIC X(6).
  1295            20  PI-CRTO-STATE       PIC XX.
  1296            20  PI-CRTO-ACCOUNT     PIC X(10).
  1297            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1298            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1299            20  PI-CRTO-CERT-SFX    PIC X.
  1300            20  PI-CRTO-RECORD-TYPE PIC X.
  1301            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1302        16  PI-ERPNDB-KEY           PIC X(11).
  1303        16  PI-DOCUMENT-PROCESSED   PIC X.
  1304            88  PI-VERI-PROCESSED      VALUE 'V'.
  1305            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1306        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1307        16  PI-RES-REF-CLM-TYPE     PIC X.
  1308        16  PI-CLM-REFORM-IND       PIC X.
  1309        16  PI-CLEAR-ERROR-SW       PIC X.
  1310            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1311        16  PI-PRINT-CERTIFICATE    PIC X.
  1312        16  PI-ENTERED.
  1313            20  PI-PRTSW-ENTERED    PIC X.
  1314            20  PI-SIGREQ-ENTERED   PIC X.
  1315            20  PI-MONEY-ENTERED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  25
* EL6317.cbl
  1316            20  PI-LTRID-ENTERED    PIC X(4).
  1317            20  PI-REASONS-ENTERED  PIC X(84).
  1318            20  PI-CERTNT1-ENTERED  PIC X(63).
  1319            20  PI-CERTNT2-ENTERED  PIC X(63).
  1320        16  FILLER                  PIC X(17).
  1321        16  PI-FINALIZED-IND        PIC X.
  1322        16  PI-BILLNT1-ENTERED      PIC X(63).
  1323        16  PI-BILLNT2-ENTERED      PIC X(63).
  1324        16  FILLER                  PIC X(154).
  1325    12  FILLER                      PIC X(276).
  1326*    COPY ELCAID.
  1327******************************************************************
  1328*                                                                *
  1329*                            ELCAID.                             *
  1330*                            VMOD=2.001                          *
  1331*                                                                *
  1332*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1333*                                                                *
  1334*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1335*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1336******************************************************************
  1337
  1338 01  DFHAID.
  1339   02  DFHNULL   PIC  X  VALUE  ' '.
  1340   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1341   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1342   02  DFHPEN    PIC  X  VALUE  '='.
  1343   02  DFHOPID   PIC  X  VALUE  'W'.
  1344   02  DFHPA1    PIC  X  VALUE  '%'.
  1345   02  DFHPA2    PIC  X  VALUE  '>'.
  1346   02  DFHPA3    PIC  X  VALUE  ','.
  1347   02  DFHPF1    PIC  X  VALUE  '1'.
  1348   02  DFHPF2    PIC  X  VALUE  '2'.
  1349   02  DFHPF3    PIC  X  VALUE  '3'.
  1350   02  DFHPF4    PIC  X  VALUE  '4'.
  1351   02  DFHPF5    PIC  X  VALUE  '5'.
  1352   02  DFHPF6    PIC  X  VALUE  '6'.
  1353   02  DFHPF7    PIC  X  VALUE  '7'.
  1354   02  DFHPF8    PIC  X  VALUE  '8'.
  1355   02  DFHPF9    PIC  X  VALUE  '9'.
  1356   02  DFHPF10   PIC  X  VALUE  ':'.
  1357   02  DFHPF11   PIC  X  VALUE  '#'.
  1358   02  DFHPF12   PIC  X  VALUE  '@'.
  1359   02  DFHPF13   PIC  X  VALUE  'A'.
  1360   02  DFHPF14   PIC  X  VALUE  'B'.
  1361   02  DFHPF15   PIC  X  VALUE  'C'.
  1362   02  DFHPF16   PIC  X  VALUE  'D'.
  1363   02  DFHPF17   PIC  X  VALUE  'E'.
  1364   02  DFHPF18   PIC  X  VALUE  'F'.
  1365   02  DFHPF19   PIC  X  VALUE  'G'.
  1366   02  DFHPF20   PIC  X  VALUE  'H'.
  1367   02  DFHPF21   PIC  X  VALUE  'I'.
  1368*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1369   02  DFHPF22   PIC  X  VALUE  '['.
  1370   02  DFHPF23   PIC  X  VALUE  '.'.
  1371   02  DFHPF24   PIC  X  VALUE  '<'.
  1372   02  DFHMSRE   PIC  X  VALUE  'X'.
  1373   02  DFHSTRF   PIC  X  VALUE  'h'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  26
* EL6317.cbl
  1374   02  DFHTRIG   PIC  X  VALUE  '"'.
  1375 01  FILLER    REDEFINES DFHAID.
  1376     12  FILLER              PIC X(8).
  1377     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1378*   COPY EL6317S.
  1379 01  EL631JI.
  1380     05  FILLER            PIC  X(0012).
  1381*    -------------------------------
  1382     05  DATEL PIC S9(0004) COMP.
  1383     05  DATEF PIC  X(0001).
  1384     05  FILLER REDEFINES DATEF.
  1385         10  DATEA PIC  X(0001).
  1386     05  DATEI PIC  X(0008).
  1387*    -------------------------------
  1388     05  TIMEL PIC S9(0004) COMP.
  1389     05  TIMEF PIC  X(0001).
  1390     05  FILLER REDEFINES TIMEF.
  1391         10  TIMEA PIC  X(0001).
  1392     05  TIMEI PIC  X(0005).
  1393*    -------------------------------
  1394     05  PROCIDL PIC S9(0004) COMP.
  1395     05  PROCIDF PIC  X(0001).
  1396     05  FILLER REDEFINES PROCIDF.
  1397         10  PROCIDA PIC  X(0001).
  1398     05  PROCIDI PIC  X(0004).
  1399*    -------------------------------
  1400     05  HOSTL PIC S9(0004) COMP.
  1401     05  HOSTF PIC  X(0001).
  1402     05  FILLER REDEFINES HOSTF.
  1403         10  HOSTA PIC  X(0001).
  1404     05  HOSTI PIC  X(0009).
  1405*    -------------------------------
  1406     05  SYSL PIC S9(0004) COMP.
  1407     05  SYSF PIC  X(0001).
  1408     05  FILLER REDEFINES SYSF.
  1409         10  SYSA PIC  X(0001).
  1410     05  SYSI PIC  X(0005).
  1411*    -------------------------------
  1412     05  COMPANYL PIC S9(0004) COMP.
  1413     05  COMPANYF PIC  X(0001).
  1414     05  FILLER REDEFINES COMPANYF.
  1415         10  COMPANYA PIC  X(0001).
  1416     05  COMPANYI PIC  X(0003).
  1417*    -------------------------------
  1418     05  DATASORL PIC S9(0004) COMP.
  1419     05  DATASORF PIC  X(0001).
  1420     05  FILLER REDEFINES DATASORF.
  1421         10  DATASORA PIC  X(0001).
  1422     05  DATASORI PIC  X(0001).
  1423*    -------------------------------
  1424     05  BATCHNOL PIC S9(0004) COMP.
  1425     05  BATCHNOF PIC  X(0001).
  1426     05  FILLER REDEFINES BATCHNOF.
  1427         10  BATCHNOA PIC  X(0001).
  1428     05  BATCHNOI PIC  X(0006).
  1429*    -------------------------------
  1430     05  BSEQNOL PIC S9(0004) COMP.
  1431     05  BSEQNOF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  27
* EL6317.cbl
  1432     05  FILLER REDEFINES BSEQNOF.
  1433         10  BSEQNOA PIC  X(0001).
  1434     05  BSEQNOI PIC  X(0008).
  1435*    -------------------------------
  1436     05  ARCHNOL PIC S9(0004) COMP.
  1437     05  ARCHNOF PIC  X(0001).
  1438     05  FILLER REDEFINES ARCHNOF.
  1439         10  ARCHNOA PIC  X(0001).
  1440     05  ARCHNOI PIC  X(0008).
  1441*    -------------------------------
  1442     05  PRTSWL PIC S9(0004) COMP.
  1443     05  PRTSWF PIC  X(0001).
  1444     05  FILLER REDEFINES PRTSWF.
  1445         10  PRTSWA PIC  X(0001).
  1446     05  PRTSWI PIC  X(0001).
  1447*    -------------------------------
  1448     05  CARRL PIC S9(0004) COMP.
  1449     05  CARRF PIC  X(0001).
  1450     05  FILLER REDEFINES CARRF.
  1451         10  CARRA PIC  X(0001).
  1452     05  CARRI PIC  X(0001).
  1453*    -------------------------------
  1454     05  GROUPL PIC S9(0004) COMP.
  1455     05  GROUPF PIC  X(0001).
  1456     05  FILLER REDEFINES GROUPF.
  1457         10  GROUPA PIC  X(0001).
  1458     05  GROUPI PIC  X(0006).
  1459*    -------------------------------
  1460     05  STATEL PIC S9(0004) COMP.
  1461     05  STATEF PIC  X(0001).
  1462     05  FILLER REDEFINES STATEF.
  1463         10  STATEA PIC  X(0001).
  1464     05  STATEI PIC  X(0002).
  1465*    -------------------------------
  1466     05  ACCTL PIC S9(0004) COMP.
  1467     05  ACCTF PIC  X(0001).
  1468     05  FILLER REDEFINES ACCTF.
  1469         10  ACCTA PIC  X(0001).
  1470     05  ACCTI PIC  X(0010).
  1471*    -------------------------------
  1472     05  EFFDTL PIC S9(0004) COMP.
  1473     05  EFFDTF PIC  X(0001).
  1474     05  FILLER REDEFINES EFFDTF.
  1475         10  EFFDTA PIC  X(0001).
  1476     05  EFFDTI PIC  X(0008).
  1477*    -------------------------------
  1478     05  CERTNOL PIC S9(0004) COMP.
  1479     05  CERTNOF PIC  X(0001).
  1480     05  FILLER REDEFINES CERTNOF.
  1481         10  CERTNOA PIC  X(0001).
  1482     05  CERTNOI PIC  X(0010).
  1483*    -------------------------------
  1484     05  CRTSFXL PIC S9(0004) COMP.
  1485     05  CRTSFXF PIC  X(0001).
  1486     05  FILLER REDEFINES CRTSFXF.
  1487         10  CRTSFXA PIC  X(0001).
  1488     05  CRTSFXI PIC  X(0001).
  1489*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  28
* EL6317.cbl
  1490     05  SEQNOL PIC S9(0004) COMP.
  1491     05  SEQNOF PIC  X(0001).
  1492     05  FILLER REDEFINES SEQNOF.
  1493         10  SEQNOA PIC  X(0001).
  1494     05  SEQNOI PIC  X(0006).
  1495*    -------------------------------
  1496     05  SIGREQL PIC S9(0004) COMP.
  1497     05  SIGREQF PIC  X(0001).
  1498     05  FILLER REDEFINES SIGREQF.
  1499         10  SIGREQA PIC  X(0001).
  1500     05  SIGREQI PIC  X(0001).
  1501*    -------------------------------
  1502     05  LTRIDL PIC S9(0004) COMP.
  1503     05  LTRIDF PIC  X(0001).
  1504     05  FILLER REDEFINES LTRIDF.
  1505         10  LTRIDA PIC  X(0001).
  1506     05  LTRIDI PIC  X(0004).
  1507*    -------------------------------
  1508     05  RCD01L PIC S9(0004) COMP.
  1509     05  RCD01F PIC  X(0001).
  1510     05  FILLER REDEFINES RCD01F.
  1511         10  RCD01A PIC  X(0001).
  1512     05  RCD01I PIC  X(0004).
  1513*    -------------------------------
  1514     05  RCD02L PIC S9(0004) COMP.
  1515     05  RCD02F PIC  X(0001).
  1516     05  FILLER REDEFINES RCD02F.
  1517         10  RCD02A PIC  X(0001).
  1518     05  RCD02I PIC  X(0004).
  1519*    -------------------------------
  1520     05  RCD03L PIC S9(0004) COMP.
  1521     05  RCD03F PIC  X(0001).
  1522     05  FILLER REDEFINES RCD03F.
  1523         10  RCD03A PIC  X(0001).
  1524     05  RCD03I PIC  X(0004).
  1525*    -------------------------------
  1526     05  RCD04L PIC S9(0004) COMP.
  1527     05  RCD04F PIC  X(0001).
  1528     05  FILLER REDEFINES RCD04F.
  1529         10  RCD04A PIC  X(0001).
  1530     05  RCD04I PIC  X(0004).
  1531*    -------------------------------
  1532     05  RCD05L PIC S9(0004) COMP.
  1533     05  RCD05F PIC  X(0001).
  1534     05  FILLER REDEFINES RCD05F.
  1535         10  RCD05A PIC  X(0001).
  1536     05  RCD05I PIC  X(0004).
  1537*    -------------------------------
  1538     05  RCD06L PIC S9(0004) COMP.
  1539     05  RCD06F PIC  X(0001).
  1540     05  FILLER REDEFINES RCD06F.
  1541         10  RCD06A PIC  X(0001).
  1542     05  RCD06I PIC  X(0004).
  1543*    -------------------------------
  1544     05  RCD07L PIC S9(0004) COMP.
  1545     05  RCD07F PIC  X(0001).
  1546     05  FILLER REDEFINES RCD07F.
  1547         10  RCD07A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  29
* EL6317.cbl
  1548     05  RCD07I PIC  X(0004).
  1549*    -------------------------------
  1550     05  RCD08L PIC S9(0004) COMP.
  1551     05  RCD08F PIC  X(0001).
  1552     05  FILLER REDEFINES RCD08F.
  1553         10  RCD08A PIC  X(0001).
  1554     05  RCD08I PIC  X(0004).
  1555*    -------------------------------
  1556     05  RCD09L PIC S9(0004) COMP.
  1557     05  RCD09F PIC  X(0001).
  1558     05  FILLER REDEFINES RCD09F.
  1559         10  RCD09A PIC  X(0001).
  1560     05  RCD09I PIC  X(0004).
  1561*    -------------------------------
  1562     05  RCD10L PIC S9(0004) COMP.
  1563     05  RCD10F PIC  X(0001).
  1564     05  FILLER REDEFINES RCD10F.
  1565         10  RCD10A PIC  X(0001).
  1566     05  RCD10I PIC  X(0004).
  1567*    -------------------------------
  1568     05  RCD11L PIC S9(0004) COMP.
  1569     05  RCD11F PIC  X(0001).
  1570     05  FILLER REDEFINES RCD11F.
  1571         10  RCD11A PIC  X(0001).
  1572     05  RCD11I PIC  X(0004).
  1573*    -------------------------------
  1574     05  RCD12L PIC S9(0004) COMP.
  1575     05  RCD12F PIC  X(0001).
  1576     05  FILLER REDEFINES RCD12F.
  1577         10  RCD12A PIC  X(0001).
  1578     05  RCD12I PIC  X(0004).
  1579*    -------------------------------
  1580     05  CRTNT1L PIC S9(0004) COMP.
  1581     05  CRTNT1F PIC  X(0001).
  1582     05  FILLER REDEFINES CRTNT1F.
  1583         10  CRTNT1A PIC  X(0001).
  1584     05  CRTNT1I PIC  X(0063).
  1585*    -------------------------------
  1586     05  CRTNT2L PIC S9(0004) COMP.
  1587     05  CRTNT2F PIC  X(0001).
  1588     05  FILLER REDEFINES CRTNT2F.
  1589         10  CRTNT2A PIC  X(0001).
  1590     05  CRTNT2I PIC  X(0063).
  1591*    -------------------------------
  1592     05  BILNT1L PIC S9(0004) COMP.
  1593     05  BILNT1F PIC  X(0001).
  1594     05  FILLER REDEFINES BILNT1F.
  1595         10  BILNT1A PIC  X(0001).
  1596     05  BILNT1I PIC  X(0063).
  1597*    -------------------------------
  1598     05  BILNT2L PIC S9(0004) COMP.
  1599     05  BILNT2F PIC  X(0001).
  1600     05  FILLER REDEFINES BILNT2F.
  1601         10  BILNT2A PIC  X(0001).
  1602     05  BILNT2I PIC  X(0063).
  1603*    -------------------------------
  1604     05  ERRMSG1L PIC S9(0004) COMP.
  1605     05  ERRMSG1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  30
* EL6317.cbl
  1606     05  FILLER REDEFINES ERRMSG1F.
  1607         10  ERRMSG1A PIC  X(0001).
  1608     05  ERRMSG1I PIC  X(0075).
  1609*    -------------------------------
  1610     05  ERRMSG2L PIC S9(0004) COMP.
  1611     05  ERRMSG2F PIC  X(0001).
  1612     05  FILLER REDEFINES ERRMSG2F.
  1613         10  ERRMSG2A PIC  X(0001).
  1614     05  ERRMSG2I PIC  X(0075).
  1615*    -------------------------------
  1616     05  PFENTRL PIC S9(0004) COMP.
  1617     05  PFENTRF PIC  X(0001).
  1618     05  FILLER REDEFINES PFENTRF.
  1619         10  PFENTRA PIC  X(0001).
  1620     05  PFENTRI PIC  9(2).
  1621 01  EL631JO REDEFINES EL631JI.
  1622     05  FILLER            PIC  X(0012).
  1623*    -------------------------------
  1624     05  FILLER            PIC  X(0003).
  1625     05  DATEO PIC  X(0008).
  1626*    -------------------------------
  1627     05  FILLER            PIC  X(0003).
  1628     05  TIMEO PIC  99.99.
  1629*    -------------------------------
  1630     05  FILLER            PIC  X(0003).
  1631     05  PROCIDO PIC  X(0004).
  1632*    -------------------------------
  1633     05  FILLER            PIC  X(0003).
  1634     05  HOSTO PIC  X(0009).
  1635*    -------------------------------
  1636     05  FILLER            PIC  X(0003).
  1637     05  SYSO PIC  X(0005).
  1638*    -------------------------------
  1639     05  FILLER            PIC  X(0003).
  1640     05  COMPANYO PIC  X(0003).
  1641*    -------------------------------
  1642     05  FILLER            PIC  X(0003).
  1643     05  DATASORO PIC  X(0001).
  1644*    -------------------------------
  1645     05  FILLER            PIC  X(0003).
  1646     05  BATCHNOO PIC  X(0006).
  1647*    -------------------------------
  1648     05  FILLER            PIC  X(0003).
  1649     05  BSEQNOO PIC  X(0008).
  1650*    -------------------------------
  1651     05  FILLER            PIC  X(0003).
  1652     05  ARCHNOO PIC  X(0008).
  1653*    -------------------------------
  1654     05  FILLER            PIC  X(0003).
  1655     05  PRTSWO PIC  X(0001).
  1656*    -------------------------------
  1657     05  FILLER            PIC  X(0003).
  1658     05  CARRO PIC  X(0001).
  1659*    -------------------------------
  1660     05  FILLER            PIC  X(0003).
  1661     05  GROUPO PIC  X(0006).
  1662*    -------------------------------
  1663     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  31
* EL6317.cbl
  1664     05  STATEO PIC  X(0002).
  1665*    -------------------------------
  1666     05  FILLER            PIC  X(0003).
  1667     05  ACCTO PIC  X(0010).
  1668*    -------------------------------
  1669     05  FILLER            PIC  X(0003).
  1670     05  EFFDTO PIC  X(0008).
  1671*    -------------------------------
  1672     05  FILLER            PIC  X(0003).
  1673     05  CERTNOO PIC  X(0010).
  1674*    -------------------------------
  1675     05  FILLER            PIC  X(0003).
  1676     05  CRTSFXO PIC  X(0001).
  1677*    -------------------------------
  1678     05  FILLER            PIC  X(0003).
  1679     05  SEQNOO PIC  999999.
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  SIGREQO PIC  X(0001).
  1683*    -------------------------------
  1684     05  FILLER            PIC  X(0003).
  1685     05  LTRIDO PIC  X(0004).
  1686*    -------------------------------
  1687     05  FILLER            PIC  X(0003).
  1688     05  RCD01O PIC  X(0004).
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  RCD02O PIC  X(0004).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  RCD03O PIC  X(0004).
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  RCD04O PIC  X(0004).
  1698*    -------------------------------
  1699     05  FILLER            PIC  X(0003).
  1700     05  RCD05O PIC  X(0004).
  1701*    -------------------------------
  1702     05  FILLER            PIC  X(0003).
  1703     05  RCD06O PIC  X(0004).
  1704*    -------------------------------
  1705     05  FILLER            PIC  X(0003).
  1706     05  RCD07O PIC  X(0004).
  1707*    -------------------------------
  1708     05  FILLER            PIC  X(0003).
  1709     05  RCD08O PIC  X(0004).
  1710*    -------------------------------
  1711     05  FILLER            PIC  X(0003).
  1712     05  RCD09O PIC  X(0004).
  1713*    -------------------------------
  1714     05  FILLER            PIC  X(0003).
  1715     05  RCD10O PIC  X(0004).
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  RCD11O PIC  X(0004).
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  RCD12O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  32
* EL6317.cbl
  1722*    -------------------------------
  1723     05  FILLER            PIC  X(0003).
  1724     05  CRTNT1O PIC  X(0063).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  CRTNT2O PIC  X(0063).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  BILNT1O PIC  X(0063).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  BILNT2O PIC  X(0063).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  ERRMSG1O PIC  X(0075).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  ERRMSG2O PIC  X(0075).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  PFENTRO PIC  X(0002).
  1743*    -------------------------------
  1744 01  filler redefines el631ji.
  1745     12  filler                   pic x(182).
  1746     12  REASONCDS.
  1747         16  filler occurs 12.
  1748             20  reacdl       pic s9(4) comp.
  1749             20  reacda       pic x.
  1750             20  reacd-in     pic x(4).
  1751    12  FILLER                   PIC X(293).
  1752****************************************************************
  1753*
  1754* Copyright (c) 2007 by Clerity Solutions, Inc.
  1755* All rights reserved.
  1756*
  1757****************************************************************
  1758 01  DFHEIV.
  1759   02  DFHEIV0               PIC X(35).
  1760   02  DFHEIV1               PIC X(08).
  1761   02  DFHEIV2               PIC X(08).
  1762   02  DFHEIV3               PIC X(08).
  1763   02  DFHEIV4               PIC X(06).
  1764   02  DFHEIV5               PIC X(04).
  1765   02  DFHEIV6               PIC X(04).
  1766   02  DFHEIV7               PIC X(02).
  1767   02  DFHEIV8               PIC X(02).
  1768   02  DFHEIV9               PIC X(01).
  1769   02  DFHEIV10              PIC S9(7) COMP-3.
  1770   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1771   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1772   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1773   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1774   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1775   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1776   02  DFHEIV17              PIC X(04).
  1777   02  DFHEIV18              PIC X(04).
  1778   02  DFHEIV19              PIC X(04).
  1779   02  DFHEIV20              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  33
* EL6317.cbl
  1780   02  DFHEIV21              USAGE IS POINTER.
  1781   02  DFHEIV22              USAGE IS POINTER.
  1782   02  DFHEIV23              USAGE IS POINTER.
  1783   02  DFHEIV24              USAGE IS POINTER.
  1784   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1785   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1786   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1787   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1788   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1789   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1790   02  FILLER                PIC X(02).
  1791   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1792   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1793   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1794   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1795   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1796 LINKAGE  SECTION.
  1797*****************************************************************
  1798*                                                               *
  1799* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1800* All rights reserved.                                          *
  1801*                                                               *
  1802*****************************************************************
  1803 01  dfheiblk.
  1804     02  eibtime          pic s9(7) comp-3.
  1805     02  eibdate          pic s9(7) comp-3.
  1806     02  eibtrnid         pic x(4).
  1807     02  eibtaskn         pic s9(7) comp-3.
  1808     02  eibtrmid         pic x(4).
  1809     02  dfheigdi         pic s9(4) comp.
  1810     02  eibcposn         pic s9(4) comp.
  1811     02  eibcalen         pic s9(4) comp.
  1812     02  eibaid           pic x(1).
  1813     02  eibfiller1       pic x(1).
  1814     02  eibfn            pic x(2).
  1815     02  eibfiller2       pic x(2).
  1816     02  eibrcode         pic x(6).
  1817     02  eibfiller3       pic x(2).
  1818     02  eibds            pic x(8).
  1819     02  eibreqid         pic x(8).
  1820     02  eibrsrce         pic x(8).
  1821     02  eibsync          pic x(1).
  1822     02  eibfree          pic x(1).
  1823     02  eibrecv          pic x(1).
  1824     02  eibsend          pic x(1).
  1825     02  eibatt           pic x(1).
  1826     02  eibeoc           pic x(1).
  1827     02  eibfmh           pic x(1).
  1828     02  eibcompl         pic x(1).
  1829     02  eibsig           pic x(1).
  1830     02  eibconf          pic x(1).
  1831     02  eiberr           pic x(1).
  1832     02  eibrldbk         pic x(1).
  1833     02  eiberrcd         pic x(4).
  1834     02  eibsynrb         pic x(1).
  1835     02  eibnodat         pic x(1).
  1836     02  eibfiller5       pic x(2).
  1837     02  eibresp          pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  34
* EL6317.cbl
  1838     02  eibresp2         pic 9(09) comp.
  1839     02  dfheigdj         pic s9(4) comp.
  1840     02  dfheigdk         pic s9(4) comp.
  1841 01  DFHCOMMAREA                 PIC X(1300).
  1842 01  var  pic x(30).
  1843*                                COPY ERCACCT.
  1844******************************************************************
  1845*                                                                *
  1846*                                                                *
  1847*                            ERCACCT                             *
  1848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1849*                            VMOD=2.031                          *
  1850*                                                                *
  1851*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1852*                                                                *
  1853*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1854*   VSAM ACCOUNT MASTER FILES.                                   *
  1855*                                                                *
  1856*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1857*                                                                *
  1858*   FILE TYPE = VSAM,KSDS                                        *
  1859*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1860*                                                                *
  1861*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1862*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1863*                                                                *
  1864*   LOG = NO                                                     *
  1865*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1866*                                                                *
  1867*                                                                *
  1868******************************************************************
  1869*                   C H A N G E   L O G
  1870*
  1871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1872*-----------------------------------------------------------------
  1873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1874* EFFECTIVE    NUMBER
  1875*-----------------------------------------------------------------
  1876* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1877* 092705    2005050300006  PEMA  ADD SPP LEASES
  1878* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1879* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1880* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1881* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1882* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1883******************************************************************
  1884
  1885 01  ACCOUNT-MASTER.
  1886     12  AM-RECORD-ID                      PIC XX.
  1887         88  VALID-AM-ID                      VALUE 'AM'.
  1888
  1889     12  AM-CONTROL-PRIMARY.
  1890         16  AM-COMPANY-CD                 PIC X.
  1891         16  AM-MSTR-CNTRL.
  1892             20  AM-CONTROL-A.
  1893                 24  AM-CARRIER            PIC X.
  1894                 24  AM-GROUPING.
  1895                     28 AM-GROUPING-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  35
* EL6317.cbl
  1896                     28 AM-GROUPING-PRIME  PIC XXX.
  1897                 24  AM-STATE              PIC XX.
  1898                 24  AM-ACCOUNT.
  1899                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1900                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1901             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1902                                           PIC X(19).
  1903             20  AM-CNTRL-B.
  1904                 24  AM-EXPIRATION-DT      PIC XX.
  1905                 24  FILLER                PIC X(4).
  1906             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1907                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1908
  1909     12  AM-CONTROL-BY-VAR-GRP.
  1910         16  AM-COMPANY-CD-A1              PIC X.
  1911         16  AM-VG-CARRIER                 PIC X.
  1912         16  AM-VG-GROUPING                PIC X(6).
  1913         16  AM-VG-STATE                   PIC XX.
  1914         16  AM-VG-ACCOUNT                 PIC X(10).
  1915         16  AM-VG-DATE.
  1916             20  AM-VG-EXPIRATION-DT       PIC XX.
  1917             20  FILLER                    PIC X(4).
  1918         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1919                                           PIC 9(11)      COMP-3.
  1920     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1921         16  FILLER                        PIC X(10).
  1922         16  AM-VG-KEY3.
  1923             20  AM-VG3-ACCOUNT            PIC X(10).
  1924             20  AM-VG3-EXP-DT             PIC XX.
  1925         16  FILLER                        PIC X(4).
  1926     12  AM-MAINT-INFORMATION.
  1927         16  AM-LAST-MAINT-DT              PIC XX.
  1928         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1929         16  AM-LAST-MAINT-USER            PIC X(4).
  1930         16  FILLER                        PIC XX.
  1931
  1932     12  AM-EFFECTIVE-DT                   PIC XX.
  1933     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1934
  1935     12  AM-PREV-DATES  COMP-3.
  1936         16  AM-PREV-EXP-DT                PIC 9(11).
  1937         16  AM-PREV-EFF-DT                PIC 9(11).
  1938
  1939     12  AM-REPORT-CODE-1                  PIC X(10).
  1940     12  AM-REPORT-CODE-2                  PIC X(10).
  1941
  1942     12  AM-CITY-CODE                      PIC X(4).
  1943     12  AM-COUNTY-PARISH                  PIC X(6).
  1944
  1945     12  AM-NAME                           PIC X(30).
  1946     12  AM-PERSON                         PIC X(30).
  1947     12  AM-ADDRS                          PIC X(30).
  1948     12  AM-CITY.
  1949         16  AM-ADDR-CITY                  PIC X(28).
  1950         16  AM-ADDR-STATE                 PIC XX.
  1951     12  AM-ZIP.
  1952         16  AM-ZIP-PRIME.
  1953             20  AM-ZIP-PRI-1ST            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  36
* EL6317.cbl
  1954                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1955             20  FILLER                    PIC X(4).
  1956         16  AM-ZIP-PLUS4                  PIC X(4).
  1957     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1958         16  AM-CAN-POSTAL-1               PIC XXX.
  1959         16  AM-CAN-POSTAL-2               PIC XXX.
  1960         16  FILLER                        PIC XXX.
  1961     12  AM-TEL-NO.
  1962         16  AM-AREA-CODE                  PIC 999.
  1963         16  AM-TEL-PRE                    PIC 999.
  1964         16  AM-TEL-NBR                    PIC 9(4).
  1965     12  AM-TEL-LOC                        PIC X.
  1966         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1967         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1968
  1969     12  AM-COMM-STRUCTURE.
  1970         16  AM-DEFN-1.
  1971             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1972                 24  AM-AGT.
  1973                     28  AM-AGT-PREFIX     PIC X(4).
  1974                     28  AM-AGT-PRIME      PIC X(6).
  1975                 24  AM-COM-TYP            PIC X.
  1976                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1977                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1978                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1979                 24  AM-RECALC-LV-INDIC    PIC X.
  1980                 24  AM-RETRO-LV-INDIC     PIC X.
  1981                 24  AM-GL-CODES           PIC X.
  1982                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1983                 24  FILLER                PIC X(01).
  1984         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1985             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1986                 24  FILLER                PIC X(11).
  1987                 24  AM-L-COMA             PIC XXX.
  1988                 24  AM-J-COMA             PIC XXX.
  1989                 24  AM-A-COMA             PIC XXX.
  1990                 24  FILLER                PIC X(6).
  1991
  1992     12  AM-COMM-CHANGE-STATUS             PIC X.
  1993         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1994
  1995     12  AM-CSR-CODE                       PIC X(4).
  1996
  1997     12  AM-BILLING-STATUS                 PIC X.
  1998         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1999         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2000     12  AM-AUTO-REFUND-SW                 PIC X.
  2001         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2002         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2003     12  AM-GPCD                           PIC 99.
  2004     12  AM-IG                             PIC X.
  2005         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2006         88  AM-HAS-GROUP                     VALUE '2'.
  2007     12  AM-STATUS                         PIC X.
  2008         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2009         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2010         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2011         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  37
* EL6317.cbl
  2012         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2013         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2014     12  AM-REMIT-TO                       PIC 99.
  2015     12  AM-ID-NO                          PIC X(11).
  2016
  2017     12  AM-CAL-TABLE                      PIC XX.
  2018     12  AM-LF-DEVIATION                   PIC XXX.
  2019     12  AM-AH-DEVIATION                   PIC XXX.
  2020     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2021     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2022     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2023     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2024     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2025     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2026
  2027     12  AM-USER-FIELDS.
  2028         16  AM-FLD-1                      PIC XX.
  2029         16  AM-FLD-2                      PIC XX.
  2030         16  AM-FLD-3                      PIC XX.
  2031         16  AM-FLD-4                      PIC XX.
  2032         16  AM-FLD-5                      PIC XX.
  2033
  2034     12  AM-1ST-PROD-DATE.
  2035         16  AM-1ST-PROD-YR                PIC XX.
  2036         16  AM-1ST-PROD-MO                PIC XX.
  2037         16  AM-1ST-PROD-DA                PIC XX.
  2038     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2039     12  AM-CERTS-PURGED-DATE.
  2040         16  AM-PUR-YR                     PIC XX.
  2041         16  AM-PUR-MO                     PIC XX.
  2042         16  AM-PUR-DA                     PIC XX.
  2043     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2044     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2045     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2046     12  AM-INACTIVE-DATE.
  2047         16  AM-INA-MO                     PIC 99.
  2048         16  AM-INA-DA                     PIC 99.
  2049         16  AM-INA-YR                     PIC 99.
  2050     12  AM-AR-HI-CERT-DATE                PIC XX.
  2051
  2052     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2053     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2054
  2055     12  AM-OB-PAYMENT-MODE                PIC X.
  2056         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2057         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2058         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2059         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2060
  2061     12  AM-AH-ONLY-INDICATOR              PIC X.
  2062         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2063         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2064
  2065     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2066
  2067     12  AM-OVER-SHORT.
  2068         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2069         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  38
* EL6317.cbl
  2070
  2071     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2072     12  AM-DCC-CLP-STATE                  PIC XX.
  2073
  2074     12  AM-RECALC-COMM                    PIC X.
  2075     12  AM-RECALC-REIN                    PIC X.
  2076
  2077     12  AM-REI-TABLE                      PIC XXX.
  2078     12  AM-REI-ET-LF                      PIC X.
  2079     12  AM-REI-ET-AH                      PIC X.
  2080     12  AM-REI-PE-LF                      PIC X.
  2081     12  AM-REI-PE-AH                      PIC X.
  2082     12  AM-REI-PRT-ST                     PIC X.
  2083     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2084     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2085     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2086     12  AM-REI-GROUP-A                    PIC X(6).
  2087     12  AM-REI-MORT                       PIC X(4).
  2088     12  AM-REI-PRT-OW                     PIC X.
  2089     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2090     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2091     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2092     12  AM-REI-GROUP-B                    PIC X(6).
  2093
  2094     12  AM-TRUST-TYPE                     PIC X(2).
  2095
  2096     12  AM-EMPLOYER-STMT-USED             PIC X.
  2097     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2098
  2099     12  AM-STD-AH-TYPE                    PIC XX.
  2100     12  AM-EARN-METHODS.
  2101         16  AM-EARN-METHOD-R              PIC X.
  2102             88 AM-REF-RL-R78                 VALUE 'R'.
  2103             88 AM-REF-RL-PR                  VALUE 'P'.
  2104             88 AM-REF-RL-MEAN                VALUE 'M'.
  2105             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2106         16  AM-EARN-METHOD-L              PIC X.
  2107             88 AM-REF-LL-R78                 VALUE 'R'.
  2108             88 AM-REF-LL-PR                  VALUE 'P'.
  2109             88 AM-REF-LL-MEAN                VALUE 'M'.
  2110             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2111         16  AM-EARN-METHOD-A              PIC X.
  2112             88 AM-REF-AH-R78                 VALUE 'R'.
  2113             88 AM-REF-AH-PR                  VALUE 'P'.
  2114             88 AM-REF-AH-MEAN                VALUE 'M'.
  2115             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2116             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2117             88 AM-REF-AH-NET                 VALUE 'N'.
  2118
  2119     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2120     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2121     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2122
  2123     12  AM-RET-Y-N                        PIC X.
  2124     12  AM-RET-P-E                        PIC X.
  2125     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2126     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2127     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  39
* EL6317.cbl
  2128     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2129         16  AM-POOL-PRIME                 PIC XXX.
  2130         16  AM-POOL-SUB                   PIC XXX.
  2131     12  AM-RETRO-EARNINGS.
  2132         16  AM-RET-EARN-R                 PIC X.
  2133         16  AM-RET-EARN-L                 PIC X.
  2134         16  AM-RET-EARN-A                 PIC X.
  2135     12  AM-RET-ST-TAX-USE                 PIC X.
  2136         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2137         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2138     12  AM-RETRO-BEG-EARNINGS.
  2139         16  AM-RET-BEG-EARN-R             PIC X.
  2140         16  AM-RET-BEG-EARN-L             PIC X.
  2141         16  AM-RET-BEG-EARN-A             PIC X.
  2142     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2143     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2144
  2145     12  AM-USER-SELECT-OPTIONS.
  2146         16  AM-USER-SELECT-1              PIC X(10).
  2147         16  AM-USER-SELECT-2              PIC X(10).
  2148         16  AM-USER-SELECT-3              PIC X(10).
  2149         16  AM-USER-SELECT-4              PIC X(10).
  2150         16  AM-USER-SELECT-5              PIC X(10).
  2151
  2152     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2153
  2154     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2155
  2156     12  AM-RPT045A-SWITCH                 PIC X.
  2157         88  RPT045A-OFF                   VALUE 'N'.
  2158
  2159     12  AM-INSURANCE-LIMITS.
  2160         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2161         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2162
  2163     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2164         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2165
  2166     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2167         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2168         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2169
  2170     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2171
  2172     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2173     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2174     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2175     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2176     12  AM-DCC-UEF-STATE                  PIC XX.
  2177     12  FILLER                            PIC XXX.
  2178     12  AM-REPORT-CODE-3                  PIC X(10).
  2179*    12  FILLER                            PIC X(22).
  2180
  2181     12  AM-RESERVE-DATE.
  2182         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2183         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2184         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2185
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  40
* EL6317.cbl
  2186     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2187     12  AM-NOTIFICATION-TYPES.
  2188         16  AM-NOTIF-OF-LETTERS           PIC X.
  2189         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2190         16  AM-NOTIF-OF-REPORTS           PIC X.
  2191         16  AM-NOTIF-OF-STATUS            PIC X.
  2192
  2193     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2194         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2195         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2196         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2197         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2198
  2199     12  AM-BENEFIT-CONTROLS.
  2200         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2201             20  AM-BENEFIT-CODE           PIC XX.
  2202             20  AM-BENEFIT-TYPE           PIC X.
  2203             20  AM-BENEFIT-REVISION       PIC XXX.
  2204             20  AM-BENEFIT-REM-TERM       PIC X.
  2205             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2206             20  FILLER                    PIC XX.
  2207         16  FILLER                        PIC X(80).
  2208
  2209     12  AM-TRANSFER-DATA.
  2210         16  AM-TRANSFERRED-FROM.
  2211             20  AM-TRNFROM-CARRIER        PIC X.
  2212             20  AM-TRNFROM-GROUPING.
  2213                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2214                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2215             20  AM-TRNFROM-STATE          PIC XX.
  2216             20  AM-TRNFROM-ACCOUNT.
  2217                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2218                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2219             20  AM-TRNFROM-DTE            PIC XX.
  2220         16  AM-TRANSFERRED-TO.
  2221             20  AM-TRNTO-CARRIER          PIC X.
  2222             20  AM-TRNTO-GROUPING.
  2223                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2224                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2225             20  AM-TRNTO-STATE            PIC XX.
  2226             20  AM-TRNTO-ACCOUNT.
  2227                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2228                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2229             20  AM-TRNTO-DTE              PIC XX.
  2230         16  FILLER                        PIC X(10).
  2231
  2232     12  AM-SAVED-REMIT-TO                 PIC 99.
  2233
  2234     12  AM-COMM-STRUCTURE-SAVED.
  2235         16  AM-DEFN-1-SAVED.
  2236             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2237                 24  AM-AGT-SV             PIC X(10).
  2238                 24  AM-COM-TYP-SV         PIC X.
  2239                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2240                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2241                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2242                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2243                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  41
* EL6317.cbl
  2244                 24  AM-GL-CODES-SV        PIC X.
  2245                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2246                 24  FILLER                PIC X.
  2247         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2248             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2249                 24  FILLER                PIC X(11).
  2250                 24  AM-L-COMA-SV          PIC XXX.
  2251                 24  AM-J-COMA-SV          PIC XXX.
  2252                 24  AM-A-COMA-SV          PIC XXX.
  2253                 24  FILLER                PIC X(6).
  2254
  2255     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2256         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2257            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2258            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2259            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2260
  2261     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2262     12  FILLER                            PIC X(120).
  2263
  2264     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2265         16  AM-CONTROL-NAME               PIC X(30).
  2266         16  AM-EXECUTIVE-ONE.
  2267             20  AM-EXEC1-NAME             PIC X(15).
  2268             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2269                                                          COMP-3.
  2270             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2271                                                          COMP-3.
  2272         16  AM-EXECUTIVE-TWO.
  2273             20  AM-EXEC2-NAME             PIC X(15).
  2274             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2275                                                          COMP-3.
  2276             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2277                                                          COMP-3.
  2278
  2279     12  AM-RETRO-ADDITIONAL-DATA.
  2280         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2281         16  AM-RETRO-PREM-P-E             PIC X.
  2282         16  AM-RETRO-CLMS-P-I             PIC X.
  2283         16  AM-RETRO-RET-BRACKET-LF.
  2284             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2285                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2286                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2287             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2288                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2289                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2290             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2291                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2292                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2293         16  AM-RETRO-RET-BRACKET-AH.
  2294             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2295                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2296                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2297                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2298             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2299                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2300                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2301             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  42
* EL6317.cbl
  2302                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2303                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2304
  2305     12  AM-COMMENTS.
  2306         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2307
  2308     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2309         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2310         16  AM-FLI-BILLING-CODE           PIC X.
  2311         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2312         16  AM-FLI-UNITED-IDENT           PIC X.
  2313         16  AM-FLI-INTEREST-LOST-DATA.
  2314             20  AM-FLI-BANK-NO            PIC X(5).
  2315             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2316             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2317             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2318         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2319             20  AM-FLI-AGT                PIC X(9).
  2320             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2321             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2322         16  FILLER                        PIC X(102).
  2323
  2324     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2325         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2326             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2327             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2328             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2329             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2330             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2331         16  FILLER                          PIC X(10).
  2332******************************************************************
  2333*                                COPY ELCCNTL.
  2334******************************************************************
  2335*                                                                *
  2336*                                                                *
  2337*                            ELCCNTL.                            *
  2338*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2339*                            VMOD=2.059                          *
  2340*                                                                *
  2341*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2342*                                                                *
  2343*   FILE TYPE = VSAM,KSDS                                        *
  2344*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2345*                                                                *
  2346*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2347*       ALTERNATE INDEX = NONE                                   *
  2348*                                                                *
  2349*   LOG = YES                                                    *
  2350*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2351******************************************************************
  2352*                   C H A N G E   L O G
  2353*
  2354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2355*-----------------------------------------------------------------
  2356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2357* EFFECTIVE    NUMBER
  2358*-----------------------------------------------------------------
  2359* 082503                   PEMA  ADD BENEFIT GROUP
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  43
* EL6317.cbl
  2360* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2361* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2362* 092705    2005050300006  PEMA  ADD SPP LEASES
  2363* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2364* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2365* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2366* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2367* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2368* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2369******************************************************************
  2370*
  2371 01  CONTROL-FILE.
  2372     12  CF-RECORD-ID                       PIC XX.
  2373         88  VALID-CF-ID                        VALUE 'CF'.
  2374
  2375     12  CF-CONTROL-PRIMARY.
  2376         16  CF-COMPANY-ID                  PIC XXX.
  2377         16  CF-RECORD-TYPE                 PIC X.
  2378             88  CF-COMPANY-MASTER              VALUE '1'.
  2379             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2380             88  CF-STATE-MASTER                VALUE '3'.
  2381             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2382             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2383             88  CF-CARRIER-MASTER              VALUE '6'.
  2384             88  CF-MORTALITY-MASTER            VALUE '7'.
  2385             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2386             88  CF-TERMINAL-MASTER             VALUE '9'.
  2387             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2388             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2389             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2390             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2391             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2392             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2393             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2394             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2395             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2396         16  CF-ACCESS-CD-GENL              PIC X(4).
  2397         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2398             20  CF-PROCESSOR               PIC X(4).
  2399         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2400             20  CF-STATE-CODE              PIC XX.
  2401             20  FILLER                     PIC XX.
  2402         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2403             20  FILLER                     PIC XX.
  2404             20  CF-HI-BEN-IN-REC           PIC XX.
  2405         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2406             20  FILLER                     PIC XXX.
  2407             20  CF-CARRIER-CNTL            PIC X.
  2408         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2409             20  FILLER                     PIC XX.
  2410             20  CF-HI-TYPE-IN-REC          PIC 99.
  2411         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2412             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2413                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2414             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2415             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2416         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2417             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  44
* EL6317.cbl
  2418             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2419         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2420             20  FILLER                     PIC XX.
  2421             20  CF-MORTGAGE-PLAN           PIC XX.
  2422         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2423
  2424     12  CF-LAST-MAINT-DT                   PIC XX.
  2425     12  CF-LAST-MAINT-BY                   PIC X(4).
  2426     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2427
  2428     12  CF-RECORD-BODY                     PIC X(728).
  2429
  2430
  2431****************************************************************
  2432*             COMPANY MASTER RECORD                            *
  2433****************************************************************
  2434
  2435     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2436         16  CF-COMPANY-ADDRESS.
  2437             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2438             20  CF-CL-IN-CARE-OF           PIC X(30).
  2439             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2440             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2441             20  CF-CL-CITY-STATE           PIC X(30).
  2442             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2443             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2444         16  CF-COMPANY-CD                  PIC X.
  2445         16  CF-COMPANY-PASSWORD            PIC X(8).
  2446         16  CF-SECURITY-OPTION             PIC X.
  2447             88  ALL-SECURITY                   VALUE '1'.
  2448             88  COMPANY-VERIFY                 VALUE '2'.
  2449             88  PROCESSOR-VERIFY               VALUE '3'.
  2450             88  NO-SECURITY                    VALUE '4'.
  2451             88  ALL-BUT-TERM                   VALUE '5'.
  2452         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2453             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2454         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2455             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2456         16  CF-INFORCE-LOCATION            PIC X.
  2457             88  CERTS-ARE-ONLINE               VALUE '1'.
  2458             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2459             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2460         16  CF-LOWER-CASE-LETTERS          PIC X.
  2461         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2462             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2463             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2464             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2465             88  CF-ACCNT-CNTL                  VALUE '3'.
  2466             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2467
  2468         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2469         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2470
  2471         16  CF-LGX-CREDIT-USER             PIC X.
  2472             88  CO-IS-NOT-USER                 VALUE 'N'.
  2473             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2474
  2475         16 CF-CREDIT-CALC-CODES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  45
* EL6317.cbl
  2476             20  CF-CR-REM-TERM-CALC PIC X.
  2477               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2478               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2479               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2480               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2481               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2482               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2483               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2484             20  CF-CR-R78-METHOD           PIC X.
  2485               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2486               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2487
  2488         16  CF-CLAIM-CONTROL-COUNTS.
  2489             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2490                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2491
  2492             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2493                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2494
  2495             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2496                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2497
  2498             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2499                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2500
  2501         16  CF-CURRENT-MONTH-END           PIC XX.
  2502
  2503         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2504             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2505             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2506             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2507             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2508                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2509                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2510             20  CF-CO-PREM-REJECT-SW       PIC X.
  2511                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2512                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2513             20  CF-CO-REF-REJECT-SW        PIC X.
  2514                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2515                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2516
  2517         16  CF-CO-REPORTING-DT             PIC XX.
  2518         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2519         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2520           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2521           88  CF-CO-MONTH-END                  VALUE '1'.
  2522
  2523         16  CF-LGX-CLAIM-USER              PIC X.
  2524             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2525             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2526
  2527         16  CF-CREDIT-EDIT-CONTROLS.
  2528             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2529             20  CF-MIN-AGE                 PIC 99.
  2530             20  CF-DEFAULT-AGE             PIC 99.
  2531             20  CF-MIN-TERM                PIC S999      COMP-3.
  2532             20  CF-MAX-TERM                PIC S999      COMP-3.
  2533             20  CF-DEFAULT-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  46
* EL6317.cbl
  2534             20  CF-JOINT-AGE-INPUT         PIC X.
  2535                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2536             20  CF-BIRTH-DATE-INPUT        PIC X.
  2537                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2538             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2539                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2540                 88  CF-ZERO-CARRIER            VALUE '1'.
  2541                 88  CF-ZERO-GROUPING           VALUE '2'.
  2542                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2543             20  CF-EDIT-SW                 PIC X.
  2544                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2545             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2546             20  CF-CR-PR-METHOD            PIC X.
  2547               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2548               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2549             20  FILLER                     PIC X.
  2550
  2551         16  CF-CREDIT-MISC-CONTROLS.
  2552             20  CF-REIN-TABLE-SW           PIC X.
  2553                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2554             20  CF-COMP-TABLE-SW           PIC X.
  2555                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2556             20  CF-EXPERIENCE-RETENTION-AGE
  2557                                            PIC S9        COMP-3.
  2558             20  CF-CONVERSION-DT           PIC XX.
  2559             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2560             20  CF-RUN-FREQUENCY-SW        PIC X.
  2561                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2562                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2563
  2564             20  CF-CR-CHECK-NO-CONTROL.
  2565                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2566                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2567                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2568                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2569                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2570                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2571
  2572                 24  CF-CR-CHECK-COUNT       REDEFINES
  2573                     CF-CR-CHECK-COUNTER      PIC X(4).
  2574
  2575                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2576                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2577
  2578                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2579                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2580                 24  CF-MAIL-PROCESSING       PIC X.
  2581                     88  MAIL-PROCESSING          VALUE 'Y'.
  2582
  2583         16  CF-MISC-SYSTEM-CONTROL.
  2584             20  CF-SYSTEM-C                 PIC X.
  2585                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2586             20  CF-SYSTEM-D                 PIC X.
  2587                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2588             20  CF-SOC-SEC-NO-SW            PIC X.
  2589                 88  SOC-SEC-NO-USED             VALUE '1'.
  2590             20  CF-MEMBER-NO-SW             PIC X.
  2591                 88  MEMBER-NO-USED              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  47
* EL6317.cbl
  2592             20  CF-TAX-ID-NUMBER            PIC X(11).
  2593             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2594             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2595                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2596                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2597                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2598                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2599             20  CF-SYSTEM-E                 PIC X.
  2600                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2601
  2602         16  CF-LGX-LIFE-USER               PIC X.
  2603             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2604             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2605
  2606         16  CF-CR-MONTH-END-DT             PIC XX.
  2607
  2608         16  CF-FILE-MAINT-DATES.
  2609             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2610                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2611             20  CF-LAST-BATCH       REDEFINES
  2612                 CF-LAST-BATCH-NO               PIC X(4).
  2613             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2614             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2615             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2616             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2617             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2618             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2619             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2620             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2621             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2622             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2623
  2624         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2625         16  FILLER                         PIC X.
  2626
  2627         16  CF-ALT-MORT-CODE               PIC X(4).
  2628         16  CF-MEMBER-CAPTION              PIC X(10).
  2629
  2630         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2631             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2632             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2633             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2634             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2635             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2636
  2637         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2638
  2639         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2640         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2641         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2642         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2643
  2644         16  CF-AH-OVERRIDE-L1              PIC X.
  2645         16  CF-AH-OVERRIDE-L2              PIC XX.
  2646         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2647         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2648
  2649         16  CF-REPORT-CD1-CAPTION          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  48
* EL6317.cbl
  2650         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2651
  2652         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2653         16  CF-AR-LAST-EL860-DT            PIC XX.
  2654         16  CF-MP-MONTH-END-DT             PIC XX.
  2655
  2656         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2657         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2658             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2659
  2660         16  CF-AR-MONTH-END-DT             PIC XX.
  2661
  2662         16  CF-CRDTCRD-USER                PIC X.
  2663             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2664             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2665
  2666         16  CF-CC-MONTH-END-DT             PIC XX.
  2667
  2668         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2669
  2670         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2671             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2672             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2673             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2674         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2675         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2676         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2677         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2678             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2679             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2680         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2681         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2682         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2683             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2684         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2685
  2686         16  CF-CL-ZIP-CODE.
  2687             20  CF-CL-ZIP-PRIME.
  2688                 24  CF-CL-ZIP-1ST          PIC X.
  2689                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2690                 24  FILLER                 PIC X(4).
  2691             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2692         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2693             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2694             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2695             20  FILLER                     PIC XXX.
  2696
  2697         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2698         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2699         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2700         16  CF-CO-OPTION-START-DATE        PIC XX.
  2701         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2702           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2703                                                      '3' '4'.
  2704           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2705           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2706           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2707           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  49
* EL6317.cbl
  2708           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2709           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2710
  2711         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2712
  2713         16  CF-PAYMENT-APPROVAL-LEVELS.
  2714             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2715             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2716             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2717             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2718             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2719             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2720
  2721         16  CF-END-USER-REPORTING-USER     PIC X.
  2722             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2723             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2724
  2725         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2726             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2727             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2728
  2729         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2730
  2731         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2732         16  FILLER                         PIC X.
  2733
  2734         16  CF-CREDIT-ARCHIVE-CNTL.
  2735             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2736             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2737             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2738
  2739         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2740
  2741         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2742             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2743             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2744
  2745         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2746             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2747             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2748
  2749         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2750
  2751         16  CF-CO-ACH-ID-CODE              PIC  X.
  2752             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2753             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2754             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2755         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2756         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2757         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2758         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2759         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2760         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2761         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2762         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2763         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2764                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2765         16  CF-CO-ACH-TRACE-SPACE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  50
* EL6317.cbl
  2766                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2767
  2768         16  CF-CO-OVER-SHORT.
  2769             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2770             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2771
  2772*         16  FILLER                         PIC X(102).
  2773         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2774             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2775             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2776
  2777         16  CF-AH-APPROVAL-DAYS.
  2778             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2779             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2780             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2781             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2782
  2783         16  FILLER                         PIC X(82).
  2784****************************************************************
  2785*             PROCESSOR/USER RECORD                            *
  2786****************************************************************
  2787
  2788     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2789         16  CF-PROCESSOR-NAME              PIC X(30).
  2790         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2791         16  CF-PROCESSOR-TITLE             PIC X(26).
  2792         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2793                 88  MESSAGE-YES                VALUE 'Y'.
  2794                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2795
  2796*****************************************************
  2797****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2798****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2799****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2800****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2801*****************************************************
  2802
  2803         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2804             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2805             20  CF-APPLICATION-FORCE       PIC X.
  2806             20  CF-INDIVIDUAL-APP.
  2807                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2808                     28  CF-BROWSE-APP      PIC X.
  2809                     28  CF-UPDATE-APP      PIC X.
  2810
  2811         16  CF-CURRENT-TERM-ON             PIC X(4).
  2812         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2813             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2814             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2815             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2816             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2817             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2818             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2819             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2820         16  CF-PROCESSOR-CARRIER           PIC X.
  2821             88  NO-CARRIER-SECURITY            VALUE ' '.
  2822         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2823             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  51
* EL6317.cbl
  2824         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2825             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2826         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2827             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2828
  2829         16  CF-PROC-SYS-ACCESS-SW.
  2830             20  CF-PROC-CREDIT-CLAIMS-SW.
  2831                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2832                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2833                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2834                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2835             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2836                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2837                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2838             20  CF-PROC-LIFE-GNRLDGR-SW.
  2839                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2840                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2841                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2842                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2843             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2844                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2845                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2846         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2847             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2848             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2849         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2850
  2851         16  CF-APPROVAL-LEVEL                  PIC X.
  2852             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2853             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2854             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2855             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2856
  2857         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2858
  2859         16  CF-LANGUAGE-TYPE                   PIC X.
  2860             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2861             88  CF-LANG-IS-FR                      VALUE 'F'.
  2862
  2863         16  CF-CSR-IND                         PIC X.
  2864         16  FILLER                             PIC X(239).
  2865
  2866****************************************************************
  2867*             PROCESSOR/REMINDERS RECORD                       *
  2868****************************************************************
  2869
  2870     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2871         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2872             20  CF-START-REMIND-DT         PIC XX.
  2873             20  CF-END-REMIND-DT           PIC XX.
  2874             20  CF-REMINDER-TEXT           PIC X(50).
  2875         16  FILLER                         PIC X(296).
  2876
  2877
  2878****************************************************************
  2879*             STATE MASTER RECORD                              *
  2880****************************************************************
  2881
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  52
* EL6317.cbl
  2882     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2883         16  CF-STATE-ABBREVIATION          PIC XX.
  2884         16  CF-STATE-NAME                  PIC X(25).
  2885         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2886         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2887             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2888             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2889             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2890             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2891                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2892                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2893             20  CF-ST-PREM-REJECT-SW       PIC X.
  2894                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2895                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2896             20  CF-ST-REF-REJECT-SW        PIC X.
  2897                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2898                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2899         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2900         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2901         16  CF-ST-REFUND-RULES.
  2902             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2903             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2904             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2905         16  CF-ST-FST-PMT-EXTENSION.
  2906             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2907             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2908                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2909                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2910                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2911                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2912         16  CF-ST-STATE-CALL.
  2913             20  CF-ST-CALL-UNEARNED        PIC X.
  2914             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2915             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2916         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2917             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2918             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2919         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2920         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2921         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2922         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2923         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2924         16  FILLER                         PIC X.
  2925         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2926             20  CF-ST-BENEFIT-CD           PIC XX.
  2927             20  CF-ST-BENEFIT-KIND         PIC X.
  2928                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2929                 88  CF-ST-AH-KIND              VALUE 'A'.
  2930             20  CF-ST-REM-TERM-CALC        PIC X.
  2931                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2932                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2933                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2934                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2935                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2936                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2937                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2938                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2939
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  53
* EL6317.cbl
  2940             20  CF-ST-REFUND-CALC          PIC X.
  2941                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2942                 88  ST-REFD-BY-R78             VALUE '1'.
  2943                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2944                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2945                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2946                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2947                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2948                 88  ST-REFD-UTAH               VALUE '7'.
  2949                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2950                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2951                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2952
  2953             20  CF-ST-EARNING-CALC         PIC X.
  2954                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2955                 88  ST-EARN-BY-R78             VALUE '1'.
  2956                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2957                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2958                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2959                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2960                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2961                 88  ST-EARN-MEAN               VALUE '8'.
  2962                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2963
  2964             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2965                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2966                 88  ST-OVRD-BY-R78             VALUE '1'.
  2967                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2968                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2969                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2970                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2971                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2972                 88  ST-OVRD-MEAN               VALUE '8'.
  2973                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2974             20  FILLER                     PIC X.
  2975
  2976         16  CF-ST-COMMISSION-CAPS.
  2977             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2978             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2979             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2980             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2981         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2982                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2983
  2984         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2985
  2986         16  CF-ST-STATUTORY-INTEREST.
  2987             20  CF-ST-STAT-DATE-FROM       PIC X.
  2988                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2989                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2990             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2991             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2992             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2993             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2994             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2995
  2996         16  CF-ST-OVER-SHORT.
  2997             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  54
* EL6317.cbl
  2998             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2999
  3000         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3001
  3002         16  CF-ST-RT-CALC                  PIC X.
  3003
  3004         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3005         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3006         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3007         16  CF-ST-RF-LR-CALC               PIC X.
  3008         16  CF-ST-RF-LL-CALC               PIC X.
  3009         16  CF-ST-RF-LN-CALC               PIC X.
  3010         16  CF-ST-RF-AH-CALC               PIC X.
  3011         16  CF-ST-RF-CP-CALC               PIC X.
  3012*        16  FILLER                         PIC X(206).
  3013*CIDMOD         16  FILLER                         PIC X(192).
  3014         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3015             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3016         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3017         16  CF-ST-VFY-2ND-BENE             PIC X.
  3018         16  FILLER                         PIC X(186).
  3019
  3020****************************************************************
  3021*             BENEFIT MASTER RECORD                            *
  3022****************************************************************
  3023
  3024     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3025         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3026             20  CF-BENEFIT-CODE            PIC XX.
  3027             20  CF-BENEFIT-NUMERIC  REDEFINES
  3028                 CF-BENEFIT-CODE            PIC XX.
  3029             20  CF-BENEFIT-ALPHA           PIC XXX.
  3030             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3031             20  CF-BENEFIT-COMMENT         PIC X(10).
  3032
  3033             20  CF-LF-COVERAGE-TYPE        PIC X.
  3034                 88  CF-REDUCING                VALUE 'R'.
  3035                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3036
  3037             20  CF-SPECIAL-CALC-CD         PIC X.
  3038                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3039                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3040                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3041                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3042                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3043                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3044                 88  CF-FARM-PLAN               VALUE 'F'.
  3045                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3046                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3047                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3048                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3049                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3050                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3051                 88  CF-PRUDENTIAL              VALUE 'P'.
  3052                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3053                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3054                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3055                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  55
* EL6317.cbl
  3056                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3057                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3058
  3059             20  CF-JOINT-INDICATOR         PIC X.
  3060                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3061
  3062*            20  FILLER                     PIC X(12).
  3063             20  FILLER                     PIC X(11).
  3064             20  CF-BENEFIT-CATEGORY        PIC X.
  3065             20  CF-LOAN-TYPE               PIC X(8).
  3066
  3067             20  CF-CO-REM-TERM-CALC        PIC X.
  3068                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3069                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3070                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3071                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3072                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3073
  3074             20  CF-CO-EARNINGS-CALC        PIC X.
  3075                 88  CO-EARN-BY-R78             VALUE '1'.
  3076                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3077                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3078                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3079                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3080                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3081                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3082                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3083
  3084             20  CF-CO-REFUND-CALC          PIC X.
  3085                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3086                 88  CO-REFD-BY-R78             VALUE '1'.
  3087                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3088                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3089                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3090                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3091                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3092                 88  CO-REFD-MEAN               VALUE '8'.
  3093                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3094                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3095                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3096
  3097             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3098                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3099                 88  CO-OVRD-BY-R78             VALUE '1'.
  3100                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3101                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3102                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3103                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3104                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3105                 88  CO-OVRD-MEAN               VALUE '8'.
  3106                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3107
  3108             20  CF-CO-BEN-I-G-CD           PIC X.
  3109                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3110                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3111                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3112
  3113         16  FILLER                         PIC X(304).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  56
* EL6317.cbl
  3114
  3115
  3116****************************************************************
  3117*             CARRIER MASTER RECORD                            *
  3118****************************************************************
  3119
  3120     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3121         16  CF-ADDRESS-DATA.
  3122             20  CF-MAIL-TO-NAME            PIC X(30).
  3123             20  CF-IN-CARE-OF              PIC X(30).
  3124             20  CF-ADDRESS-LINE-1          PIC X(30).
  3125             20  CF-ADDRESS-LINE-2          PIC X(30).
  3126             20  CF-CITY-STATE              PIC X(30).
  3127             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3128             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3129
  3130         16  CF-CLAIM-NO-CONTROL.
  3131             20  CF-CLAIM-NO-METHOD         PIC X.
  3132                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3133                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3134                 88  CLAIM-NO-SEQ               VALUE '3'.
  3135                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3136             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3137                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3138                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3139                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3140
  3141         16  CF-CHECK-NO-CONTROL.
  3142             20  CF-CHECK-NO-METHOD         PIC X.
  3143                 88  CHECK-NO-MANUAL            VALUE '1'.
  3144                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3145                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3146                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3147             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3148                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3149
  3150         16  CF-DOMICILE-STATE              PIC XX.
  3151
  3152         16  CF-EXPENSE-CONTROLS.
  3153             20  CF-EXPENSE-METHOD          PIC X.
  3154                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3155                 88  DOLLARS-PER-PMT            VALUE '2'.
  3156                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3157                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3158             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3159             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3160
  3161         16  CF-CORRESPONDENCE-CONTROL.
  3162             20  CF-LETTER-RESEND-OPT       PIC X.
  3163                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3164                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3165             20  FILLER                     PIC X(4).
  3166
  3167         16  CF-RESERVE-CONTROLS.
  3168             20  CF-MANUAL-SW               PIC X.
  3169                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3170             20  CF-FUTURE-SW               PIC X.
  3171                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  57
* EL6317.cbl
  3172             20  CF-PTC-SW                  PIC X.
  3173                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3174             20  CF-IBNR-SW                 PIC X.
  3175                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3176             20  CF-PTC-LF-SW               PIC X.
  3177                 88  CF-LF-PTC-USED             VALUE '1'.
  3178             20  CF-CDT-ACCESS-METHOD       PIC X.
  3179                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3180                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3181                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3182             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3183
  3184         16  CF-CLAIM-CALC-METHOD           PIC X.
  3185             88  360-PLUS-MONTHS                VALUE '1'.
  3186             88  365-PLUS-MONTHS                VALUE '2'.
  3187             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3188             88  360-DAILY                      VALUE '4'.
  3189             88  365-DAILY                      VALUE '5'.
  3190
  3191         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3192         16  FILLER                         PIC X(11).
  3193
  3194         16  CF-LIMIT-AMOUNTS.
  3195             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3196             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3197             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3198             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3199             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3200             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3201             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3202             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3203             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3204             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3205
  3206         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3207         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3208         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3209
  3210         16  CF-ZIP-CODE.
  3211             20  CF-ZIP-PRIME.
  3212                 24  CF-ZIP-1ST             PIC X.
  3213                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3214                 24  FILLER                 PIC X(4).
  3215             20  CF-ZIP-PLUS4               PIC X(4).
  3216         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3217             20  CF-CAN-POSTAL-1            PIC XXX.
  3218             20  CF-CAN-POSTAL-2            PIC XXX.
  3219             20  FILLER                     PIC XXX.
  3220
  3221         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3222         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3223         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3224
  3225         16  CF-RATING-SWITCH               PIC X.
  3226             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3227             88  CF-NO-RATING                   VALUE 'N'.
  3228
  3229         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  58
* EL6317.cbl
  3230
  3231         16  CF-CARRIER-OVER-SHORT.
  3232             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3233             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3234
  3235         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3236         16  CF-SECPAY-SWITCH               PIC X.
  3237             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3238             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3239         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3240         16  FILLER                         PIC X(448).
  3241*        16  FILLER                         PIC X(452).
  3242
  3243
  3244****************************************************************
  3245*             MORTALITY MASTER RECORD                          *
  3246****************************************************************
  3247
  3248     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3249         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3250                                INDEXED BY CF-MORT-NDX.
  3251             20  CF-MORT-TABLE              PIC X(5).
  3252             20  CF-MORT-TABLE-TYPE         PIC X.
  3253                 88  CF-MORT-JOINT              VALUE 'J'.
  3254                 88  CF-MORT-SINGLE             VALUE 'S'.
  3255                 88  CF-MORT-COMBINED           VALUE 'C'.
  3256                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3257                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3258             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3259             20  CF-MORT-AGE-METHOD         PIC XX.
  3260                 88  CF-AGE-LAST                VALUE 'AL'.
  3261                 88  CF-AGE-NEAR                VALUE 'AN'.
  3262             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3263             20  CF-MORT-ADJUSTMENT-DIRECTION
  3264                                            PIC X.
  3265                 88  CF-MINUS                   VALUE '-'.
  3266                 88  CF-PLUS                    VALUE '+'.
  3267             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3268             20  CF-MORT-JOINT-CODE         PIC X.
  3269                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3270             20  CF-MORT-PC-Q               PIC X.
  3271                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3272             20  CF-MORT-TABLE-CODE         PIC X(4).
  3273             20  CF-MORT-COMMENTS           PIC X(15).
  3274             20  FILLER                     PIC X(14).
  3275
  3276         16  FILLER                         PIC X(251).
  3277
  3278
  3279****************************************************************
  3280*             BUSSINESS TYPE MASTER RECORD                     *
  3281****************************************************************
  3282
  3283     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3284* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3285* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3286* AND RECORD 05 IS TYPES 81-99
  3287         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  59
* EL6317.cbl
  3288             20  CF-BUSINESS-TITLE          PIC  X(19).
  3289             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3290                                            PIC S9V9(4) COMP-3.
  3291             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3292             20  FILLER                     PIC  X.
  3293         16  FILLER                         PIC  X(248).
  3294
  3295
  3296****************************************************************
  3297*             TERMINAL MASTER RECORD                           *
  3298****************************************************************
  3299
  3300     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3301
  3302         16  CF-COMPANY-TERMINALS.
  3303             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3304                                  PIC X(4).
  3305         16  FILLER               PIC X(248).
  3306
  3307
  3308****************************************************************
  3309*             LIFE EDIT MASTER RECORD                          *
  3310****************************************************************
  3311
  3312     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3313         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3314             20  CF-LIFE-CODE-IN            PIC XX.
  3315             20  CF-LIFE-CODE-OUT           PIC XX.
  3316         16  FILLER                         PIC X(248).
  3317
  3318
  3319****************************************************************
  3320*             AH EDIT MASTER RECORD                            *
  3321****************************************************************
  3322
  3323     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3324         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3325             20  CF-AH-CODE-IN              PIC XXX.
  3326             20  CF-AH-CODE-OUT             PIC XX.
  3327         16  FILLER                         PIC X(248).
  3328
  3329
  3330****************************************************************
  3331*             CREDIBILITY TABLES                               *
  3332****************************************************************
  3333
  3334     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3335         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3336                             INDEXED BY CF-CRDB-NDX.
  3337             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3338             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3339             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3340         16  FILLER                         PIC  X(332).
  3341
  3342
  3343****************************************************************
  3344*             REPORT CUSTOMIZATION RECORD                      *
  3345****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  60
* EL6317.cbl
  3346
  3347     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3348         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3349             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3350             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3351             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3352**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3353****       A T-TRANSFER.                                   ****
  3354             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3355
  3356         16  FILLER                         PIC XX.
  3357
  3358         16  CF-CARRIER-CNTL-OPT.
  3359             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3360                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3361                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3362             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3363                                            PIC X.
  3364         16  CF-GROUP-CNTL-OPT.
  3365             20  CF-GROUP-OPT-SEQ           PIC 9.
  3366                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3367                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3368             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3369                                            PIC X(6).
  3370         16  CF-STATE-CNTL-OPT.
  3371             20  CF-STATE-OPT-SEQ           PIC 9.
  3372                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3373                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3374             20  CF-STATE-SELECT OCCURS 3 TIMES
  3375                                            PIC XX.
  3376         16  CF-ACCOUNT-CNTL-OPT.
  3377             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3378                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3379                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3380             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3381                                            PIC X(10).
  3382         16  CF-BUS-TYP-CNTL-OPT.
  3383             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3384                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3385                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3386             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3387                                            PIC XX.
  3388         16  CF-LF-TYP-CNTL-OPT.
  3389             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3390                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3391                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3392             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3393                                            PIC XX.
  3394         16  CF-AH-TYP-CNTL-OPT.
  3395             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3396                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3397                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3398             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3399                                            PIC XX.
  3400         16  CF-REPTCD1-CNTL-OPT.
  3401             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3402                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3403                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  61
* EL6317.cbl
  3404             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3405                                            PIC X(10).
  3406         16  CF-REPTCD2-CNTL-OPT.
  3407             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3408                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3409                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3410             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3411                                            PIC X(10).
  3412         16  CF-USER1-CNTL-OPT.
  3413             20  CF-USER1-OPT-SEQ           PIC 9.
  3414                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3415                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3416             20  CF-USER1-SELECT OCCURS 3 TIMES
  3417                                            PIC X(10).
  3418         16  CF-USER2-CNTL-OPT.
  3419             20  CF-USER2-OPT-SEQ           PIC 9.
  3420                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3421                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3422             20  CF-USER2-SELECT OCCURS 3 TIMES
  3423                                            PIC X(10).
  3424         16  CF-USER3-CNTL-OPT.
  3425             20  CF-USER3-OPT-SEQ           PIC 9.
  3426                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3427                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3428             20  CF-USER3-SELECT OCCURS 3 TIMES
  3429                                            PIC X(10).
  3430         16  CF-USER4-CNTL-OPT.
  3431             20  CF-USER4-OPT-SEQ           PIC 9.
  3432                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3433                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3434             20  CF-USER4-SELECT OCCURS 3 TIMES
  3435                                            PIC X(10).
  3436         16  CF-USER5-CNTL-OPT.
  3437             20  CF-USER5-OPT-SEQ           PIC 9.
  3438                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3439                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3440             20  CF-USER5-SELECT OCCURS 3 TIMES
  3441                                            PIC X(10).
  3442         16  CF-REINS-CNTL-OPT.
  3443             20  CF-REINS-OPT-SEQ           PIC 9.
  3444                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3445                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3446             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3447                 24  CF-REINS-PRIME         PIC XXX.
  3448                 24  CF-REINS-SUB           PIC XXX.
  3449
  3450         16  CF-AGENT-CNTL-OPT.
  3451             20  CF-AGENT-OPT-SEQ           PIC 9.
  3452                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3453                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3454             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3455                                            PIC X(10).
  3456
  3457         16  FILLER                         PIC X(43).
  3458
  3459         16  CF-LOSS-RATIO-SELECT.
  3460             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3461             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  62
* EL6317.cbl
  3462         16  CF-ENTRY-DATE-SELECT.
  3463             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3464             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3465         16  CF-EFFECTIVE-DATE-SELECT.
  3466             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3467             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3468
  3469         16  CF-EXCEPTION-LIST-IND          PIC X.
  3470             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3471
  3472         16  FILLER                         PIC X(318).
  3473
  3474****************************************************************
  3475*                  EXCEPTION REPORTING RECORD                  *
  3476****************************************************************
  3477
  3478     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3479         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3480             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3481
  3482         16  CF-COMBINED-LIFE-AH-OPT.
  3483             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3484             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3485             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3486             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3487
  3488         16  CF-LIFE-OPT.
  3489             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3490             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3491             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3492             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3493             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3494             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3495             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3496             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3497             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3498             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3499
  3500         16  CF-AH-OPT.
  3501             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3502             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3503             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3504             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3505             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3506             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3507             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3508             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3509             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3510             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3511
  3512         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3513             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3514             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3515             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3516
  3517         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3518
  3519         16  FILLER                         PIC X(673).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  63
* EL6317.cbl
  3520
  3521
  3522****************************************************************
  3523*             MORTGAGE SYSTEM PLAN RECORD                      *
  3524****************************************************************
  3525
  3526     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3527         16  CF-PLAN-TYPE                   PIC X.
  3528             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3529             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3530             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3531         16  CF-PLAN-ABBREV                 PIC XXX.
  3532         16  CF-PLAN-DESCRIPT               PIC X(10).
  3533         16  CF-PLAN-NOTES                  PIC X(20).
  3534         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3535         16  CF-PLAN-UNDERWRITING.
  3536             20  CF-PLAN-TERM-DATA.
  3537                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3538                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3539             20  CF-PLAN-AGE-DATA.
  3540                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3541                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3542                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3543             20  CF-PLAN-BENEFIT-DATA.
  3544                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3545                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3546                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3547                                            PIC S9(7)V99  COMP-3.
  3548         16  CF-PLAN-POLICY-FORMS.
  3549             20  CF-POLICY-FORM             PIC X(12).
  3550             20  CF-MASTER-APPLICATION      PIC X(12).
  3551             20  CF-MASTER-POLICY           PIC X(12).
  3552         16  CF-PLAN-RATING.
  3553             20  CF-RATE-CODE               PIC X(5).
  3554             20  CF-SEX-RATING              PIC X.
  3555                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3556                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3557             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3558             20  CF-SUB-STD-TYPE            PIC X.
  3559                 88  CF-PCT-OF-PREM            VALUE '1'.
  3560                 88  CF-PCT-OF-BENE            VALUE '2'.
  3561         16  CF-PLAN-PREM-TOLERANCES.
  3562             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3563             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3564         16  CF-PLAN-PYMT-TOLERANCES.
  3565             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3566             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3567         16  CF-PLAN-MISC-DATA.
  3568             20  FILLER                     PIC X.
  3569             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3570             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3571         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3572         16  CF-PLAN-IND-GRP                PIC X.
  3573             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3574                                                     '1'.
  3575             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3576                                                     '2'.
  3577         16  CF-MIB-SEARCH-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  64
* EL6317.cbl
  3578             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3579             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3580             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3581             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3582         16  CF-ALPHA-SEARCH-SW             PIC X.
  3583             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3584             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3585             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3586             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3587             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3588             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3589             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3590             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3591             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3592             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3593                                                     'A' 'B' 'C'
  3594                                                     'X' 'Y' 'Z'.
  3595         16  CF-EFF-DT-RULE-SW              PIC X.
  3596             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3597             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3598             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3599             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3600             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3601         16  FILLER                         PIC X(4).
  3602         16  CF-HEALTH-QUESTIONS            PIC X.
  3603             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3604         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3605         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3606         16  CF-PLAN-SNGL-JNT               PIC X.
  3607             88  CF-COMBINED-PLAN              VALUE 'C'.
  3608             88  CF-JNT-PLAN                   VALUE 'J'.
  3609             88  CF-SNGL-PLAN                  VALUE 'S'.
  3610         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3611         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3612         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3613         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3614         16  CF-RERATE-CNTL                 PIC  X.
  3615             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3616             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3617             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3618             88  CF-AUTO-RECALC                 VALUE '4'.
  3619         16  CF-BENEFIT-TYPE                PIC  X.
  3620             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3621             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3622         16  CF-POLICY-FEE                  PIC S999V99
  3623                                                    COMP-3.
  3624         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3625         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3626         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3627         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3628         16  FILLER                         PIC  X(32).
  3629         16  CF-TERMINATION-FORM            PIC  X(04).
  3630         16  FILLER                         PIC  X(08).
  3631         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3632                                                       COMP-3.
  3633         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3634         16  CF-ISSUE-LETTER                PIC  X(4).
  3635         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  65
* EL6317.cbl
  3636         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3637             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3638             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3639         16  CF-MP-REFUND-CALC              PIC X.
  3640             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3641             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3642             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3643             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3644             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3645             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3646             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3647             88  CF-MP-REFD-MEAN                VALUE '8'.
  3648         16  CF-ALT-RATE-CODE               PIC  X(5).
  3649
  3650
  3651         16  FILLER                         PIC X(498).
  3652****************************************************************
  3653*             MORTGAGE COMPANY MASTER RECORD                   *
  3654****************************************************************
  3655
  3656     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3657         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3658         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3659             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3660             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3661             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3662             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3663             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3664
  3665         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3666         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3667         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3668         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3669         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3670
  3671         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3672             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3673         16  CF-MP-RECON-USE-IND            PIC X(1).
  3674             88  CF-MP-USE-RECON             VALUE 'Y'.
  3675         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3676             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3677         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3678             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3679             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3680         16  FILLER                         PIC X(1).
  3681         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3682             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3683         16  CF-MORTG-MIB-VERSION           PIC X.
  3684             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3685             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3686             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3687         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3688             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3689                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3690             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3691                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3692             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3693                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  66
* EL6317.cbl
  3694             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3695                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3696             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3697                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3698             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3699                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3700         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3701         16  FILLER                         PIC X(7).
  3702         16  CF-MORTG-DESTINATION-SYMBOL.
  3703             20  CF-MORTG-MIB-COMM          PIC X(5).
  3704             20  CF-MORTG-MIB-TERM          PIC X(5).
  3705         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3706             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3707         16  FILLER                         PIC X(03).
  3708         16  CF-MP-CHECK-NO-CONTROL.
  3709             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3710                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3711                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3712                                                ' ' LOW-VALUES.
  3713                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3714                                               VALUE '3'.
  3715         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3716         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3717         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3718             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3719                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3720             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3721                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3722             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3723                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3724             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3725                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3726             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3727                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3728             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3729                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3730         16  CF-MORTG-BILLING-AREA.
  3731             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3732                                            PIC X.
  3733         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3734         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3735         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3736         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3737             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3738             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3739         16  FILLER                         PIC X.
  3740         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3741             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3742             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3743         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3744         16  FILLER                         PIC X(8).
  3745         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3746         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3747         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3748         16  CF-ACH-COMPANY-ID.
  3749             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3750                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3751                 88  CF-ACH-ICD-DUNS                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  67
* EL6317.cbl
  3752                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3753             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3754         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3755             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3756         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3757             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3758             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3759         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3760         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3761         16  FILLER                         PIC X(536).
  3762
  3763****************************************************************
  3764*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3765****************************************************************
  3766
  3767     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3768         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3769             20  CF-FEMALE-HEIGHT.
  3770                 24  CF-FEMALE-FT           PIC 99.
  3771                 24  CF-FEMALE-IN           PIC 99.
  3772             20  CF-FEMALE-MIN-WT           PIC 999.
  3773             20  CF-FEMALE-MAX-WT           PIC 999.
  3774         16  FILLER                         PIC X(428).
  3775
  3776     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3777         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3778             20  CF-MALE-HEIGHT.
  3779                 24  CF-MALE-FT             PIC 99.
  3780                 24  CF-MALE-IN             PIC 99.
  3781             20  CF-MALE-MIN-WT             PIC 999.
  3782             20  CF-MALE-MAX-WT             PIC 999.
  3783         16  FILLER                         PIC X(428).
  3784******************************************************************
  3785*             AUTOMATIC ACTIVITY RECORD                          *
  3786******************************************************************
  3787     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3788         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3789             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3790             20  CF-SYS-LETTER-ID           PIC X(04).
  3791             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3792             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3793             20  CF-SYS-RESET-SW            PIC X(01).
  3794             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3795             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3796
  3797         16  FILLER                         PIC X(50).
  3798
  3799         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3800             20  CF-USER-ACTIVE-SW          PIC X(01).
  3801             20  CF-USER-LETTER-ID          PIC X(04).
  3802             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3803             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3804             20  CF-USER-RESET-SW           PIC X(01).
  3805             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3806             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3807             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3808
  3809         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  68
* EL6317.cbl
  3810*                                COPY ERCPNDB.
  3811******************************************************************
  3812*                                                                *
  3813*                                                                *
  3814*                            ERCPNDB.                            *
  3815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3816*                            VMOD=2.025                          *
  3817*                                                                *
  3818*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3819*                                                                *
  3820******************************************************************
  3821*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3822*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3823******************************************************************
  3824*                                                                *
  3825*                                                                *
  3826*   FILE TYPE = VSAM,KSDS                                        *
  3827*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3828*                                                                *
  3829*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3830*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3831*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3832*                                                 RKP=13,LEN=36  *
  3833*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3834*                                      AND CHG-SEQ.)             *
  3835*                                                RKP=49,LEN=11   *
  3836*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3837*                                      AND CHG-SEQ.)             *
  3838*                                                RKP=60,LEN=15   *
  3839*                                                                *
  3840*   LOG = NO                                                     *
  3841*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3842******************************************************************
  3843******************************************************************
  3844*                   C H A N G E   L O G
  3845*
  3846* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3847*-----------------------------------------------------------------
  3848*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3849* EFFECTIVE    NUMBER
  3850*-----------------------------------------------------------------
  3851* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3852* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3853* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3854* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3855* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3856* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3857* 032306                   PEMA  ADD BOW LOAN NUMBER
  3858* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3859* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3860* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3861* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3862* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3863* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3864* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3865* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3866******************************************************************
  3867
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  69
* EL6317.cbl
  3868 01  PENDING-BUSINESS.
  3869     12  PB-RECORD-ID                     PIC XX.
  3870         88  VALID-PB-ID                        VALUE 'PB'.
  3871
  3872     12  PB-CONTROL-PRIMARY.
  3873         16  PB-COMPANY-CD                PIC X.
  3874         16  PB-ENTRY-BATCH               PIC X(6).
  3875         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3876         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3877
  3878     12  PB-CONTROL-BY-ACCOUNT.
  3879         16  PB-COMPANY-CD-A1             PIC X.
  3880         16  PB-CARRIER                   PIC X.
  3881         16  PB-GROUPING.
  3882             20  PB-GROUPING-PREFIX       PIC XXX.
  3883             20  PB-GROUPING-PRIME        PIC XXX.
  3884         16  PB-STATE                     PIC XX.
  3885         16  PB-ACCOUNT.
  3886             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3887             20  PB-ACCOUNT-PRIME         PIC X(6).
  3888         16  PB-CERT-EFF-DT               PIC XX.
  3889         16  PB-CERT-NO.
  3890             20  PB-CERT-PRIME            PIC X(10).
  3891             20  PB-CERT-SFX              PIC X.
  3892         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3893
  3894         16  PB-RECORD-TYPE               PIC X.
  3895             88  PB-MAILING-DATA                VALUE '0'.
  3896             88  PB-ISSUE                       VALUE '1'.
  3897             88  PB-CANCELLATION                VALUE '2'.
  3898             88  PB-BATCH-TRAILER               VALUE '9'.
  3899
  3900     12  PB-CONTROL-BY-ORIG-BATCH.
  3901         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3902         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3903         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3904         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3905
  3906     12  PB-CONTROL-BY-CSR.
  3907         16  PB-CSR-COMPANY-CD            PIC X.
  3908         16  PB-CSR-ID                    PIC X(4).
  3909         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3910         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3911         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3912******************************************************************
  3913*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3914******************************************************************
  3915
  3916     12  PB-LAST-MAINT-DT                 PIC XX.
  3917     12  PB-LAST-MAINT-BY                 PIC X(4).
  3918     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3919
  3920     12  PB-RECORD-BODY                   PIC X(375).
  3921
  3922     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3923         16  PB-CERT-ORIGIN               PIC X.
  3924             88  CLASIC-CREATED-CERT         VALUE '1'.
  3925         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  70
* EL6317.cbl
  3926             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3927             20  PB-I-INSURED-FIRST-NAME.
  3928                 24  PB-I-INSURED-1ST-INIT PIC X.
  3929                 24  FILLER                PIC X(9).
  3930             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3931         16  PB-I-AGE                     PIC S99   COMP-3.
  3932         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3933         16  PB-I-BIRTHDAY                PIC XX.
  3934         16  PB-I-INSURED-SEX             PIC X.
  3935             88  PB-SEX-MALE     VALUE 'M'.
  3936             88  PB-SEX-FEMALE   VALUE 'F'.
  3937
  3938         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3939         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3940         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3941         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3942         16  PB-I-SKIP-CODE               PIC X.
  3943             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3944             88  PB-SKIP-JULY              VALUE '1'.
  3945             88  PB-SKIP-AUGUST            VALUE '2'.
  3946             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3947             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3948             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3949             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3950             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3951             88  PB-SKIP-JUNE              VALUE '8'.
  3952             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3953             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3954             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3955         16  PB-I-TERM-TYPE               PIC X.
  3956             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3957             88  PB-PAID-WEEKLY            VALUE 'W'.
  3958             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3959             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3960             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3961         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3962         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3963         16  PB-I-DATA-ENTRY-SW           PIC X.
  3964             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3965             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3966             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3967             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3968         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3969         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3970*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3971         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3972         16  FILLER                       PIC X.
  3973
  3974         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3975             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3976             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3977                                                   '90' THRU '99'.
  3978         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3979                                          PIC XX.
  3980         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3981         16  PB-I-AMOUNT-FINANCED REDEFINES
  3982                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3983         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  71
* EL6317.cbl
  3984         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3985                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3986         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3987         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3988         16  PB-I-CLP-AMOUNT REDEFINES
  3989                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3990         16  PB-I-LF-CALC-FLAG            PIC X.
  3991             88 PB-COMP-LF-PREM               VALUE '?'.
  3992         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3993         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3994         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3995         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3996         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3997         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3998         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3999         16  PB-I-LF-ABBR                 PIC XXX.
  4000         16  PB-I-LF-INPUT-CD             PIC XX.
  4001
  4002         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4003             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4004             88  PB-INVALID-AH               VALUE '  ' '00'
  4005                                                   '90' THRU '99'.
  4006         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4007         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4008         16  PB-I-AH-CALC-FLAG            PIC X.
  4009             88 PB-COMP-AH-PREM                  VALUE '?'.
  4010         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4011         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4012         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4013         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4014         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4015         16  PB-I-AH-ABBR                 PIC XXX.
  4016         16  PB-I-AH-INPUT-CD             PIC XXX.
  4017
  4018         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4019         16  PB-I-REIN-TABLE              PIC XXX.
  4020         16  PB-I-BUSINESS-TYPE           PIC 99.
  4021         16  PB-I-INDV-GRP-CD             PIC X.
  4022         16  PB-I-MORT-CODE.
  4023             20  PB-I-TABLE               PIC X.
  4024             20  PB-I-INTEREST            PIC XX.
  4025             20  PB-I-MORT-TYP            PIC X.
  4026         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4027         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4028         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4029         16  PB-I-INDV-GRP-OVRD           PIC X.
  4030         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4031         16  PB-I-SIG-SW                  PIC X.
  4032             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4033         16  PB-I-RATE-CLASS              PIC XX.
  4034         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4035         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4036         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4037         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4038         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4039         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4040         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4041         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  72
* EL6317.cbl
  4042         16  PB-I-OB-FLAG                 PIC X.
  4043             88  PB-I-OB                      VALUE 'B'.
  4044             88  PB-I-SUMMARY                 VALUE 'Z'.
  4045         16  PB-I-ENTRY-STATUS            PIC X.
  4046             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4047                                              'M' '5' '9' '2'.
  4048             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4049             88  PB-I-POLICY-PENDING          VALUE '2'.
  4050             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4051             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4052             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4053             88  PB-I-REIN-ONLY               VALUE '9'.
  4054             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4055             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4056             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4057             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4058         16  PB-I-INT-CODE                PIC X.
  4059             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4060             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4061         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4062         16  PB-I-SOC-SEC-NO              PIC X(11).
  4063         16  PB-I-MEMBER-NO               PIC X(12).
  4064         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4065*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4066         16  PB-I-OLD-LOF                 PIC XXX.
  4067         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4068         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4069         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4070         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4071         16  PB-I-LIFE-INDICATOR          PIC X.
  4072             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4073         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4074         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4075                                          PIC S9(5)V99    COMP-3.
  4076         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4077             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4078             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4079         16  PB-I-1ST-PMT-DT              PIC XX.
  4080         16  PB-I-JOINT-INSURED.
  4081             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4082             20 PB-I-JOINT-FIRST-NAME.
  4083                24  PB-I-JOINT-FIRST-INIT PIC X.
  4084                24  FILLER                PIC X(9).
  4085             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4086*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4087         16  PB-I-BENEFICIARY-NAME.
  4088             20  PB-I-BANK-NUMBER         PIC X(10).
  4089             20  FILLER                   PIC X(15).
  4090         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4091         16  PB-I-REFERENCE               PIC X(12).
  4092         16  FILLER REDEFINES PB-I-REFERENCE.
  4093             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4094             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4095             20  PB-I-CLP-STATE           PIC XX.
  4096         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4097             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4098             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4099             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  73
* EL6317.cbl
  4100         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4101         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4102         16  PB-I-RESIDENT-STATE          PIC XX.
  4103         16  PB-I-RATE-CODE               PIC X(4).
  4104         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4105         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4106         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4107         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4108         16  PB-I-BANK-NOCHRGB            PIC 99.
  4109         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4110         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4111
  4112     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4113         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4114             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4115         16  PB-C-CANCEL-ORIGIN           PIC X.
  4116             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4117         16  PB-C-LF-CANCEL-DT            PIC XX.
  4118         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4119         16  PB-C-LF-CALC-REQ             PIC X.
  4120             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4121         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4122         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4123         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4124             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4125         16  PB-C-AH-CANCEL-DT            PIC XX.
  4126         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4127         16  PB-C-AH-CALC-REQ             PIC X.
  4128             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4129         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4130         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4131         16  PB-C-LAST-NAME               PIC X(15).
  4132         16  PB-C-REFUND-SW               PIC X.
  4133             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4134             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4135         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4136         16  PB-C-PAYEE-CODE              PIC X(6).
  4137         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4138         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4139         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4140         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4141         16  PB-C-REFERENCE               PIC X(12).
  4142         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4143         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4144         16  PB-C-POST-CARD-IND           PIC X.
  4145         16  PB-C-CANCEL-REASON           PIC X.
  4146         16  PB-C-REF-INTERFACE-SW        PIC X.
  4147         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4148         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4149         16  FILLER                       PIC X(01).
  4150*        16  FILLER                       PIC X(18).
  4151         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4152*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4153         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4154         16  PB-CANCELED-CERT-DATA.
  4155             20  PB-CI-INSURED-NAME.
  4156                 24  PB-CI-LAST-NAME      PIC X(15).
  4157                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  74
* EL6317.cbl
  4158             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4159             20  PB-CI-INSURED-SEX        PIC X.
  4160             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4161             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4162             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4163             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4164             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4165             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4166             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4167             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4168             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4169             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4170             20  PB-CI-RATE-CLASS         PIC XX.
  4171             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4172             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4173             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4174             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4175             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4176             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4177             20  PB-CI-LF-ABBR            PIC X(3).
  4178             20  PB-CI-AH-ABBR            PIC X(3).
  4179             20  PB-CI-OB-FLAG            PIC X.
  4180                 88  PB-CI-OB                VALUE 'B'.
  4181             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4182                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4183                                           'M' '4' '5' '9' '2'.
  4184                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4185                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4186                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4187                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4188                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4189                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4190                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4191                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4192                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4193                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4194                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4195                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4196             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4197                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4198                                           'M' '4' '5' '9' '2'.
  4199                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4200                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4201                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4202                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4203                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4204                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4205                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4206                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4207                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4208                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4209                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4210                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4211             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4212             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4213             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4214             20  PB-CI-MEMBER-NO          PIC X(12).
  4215             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  75
* EL6317.cbl
  4216                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4217                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4218             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4219             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4220             20  PB-CI-COMP-EXCP-SW       PIC X.
  4221                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4222                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4223             20  PB-CI-ENTRY-STATUS       PIC X.
  4224             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4225             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4226             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4227             20  PB-CI-DEATH-DT           PIC XX.
  4228             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4229             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4230             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4231             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4232             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4233             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4234             20  PB-CI-ENTRY-DT              PIC XX.
  4235             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4236             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4237             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4238             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4239             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4240             20  PB-CI-OLD-LOF               PIC XXX.
  4241*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4242             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4243             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4244             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4245             20  PB-CI-INDV-GRP-CD           PIC X.
  4246             20  PB-CI-BENEFICIARY-NAME.
  4247                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4248                 24  FILLER                  PIC X(15).
  4249             20  PB-CI-NOTE-SW               PIC X.
  4250             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4251             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4252             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4253             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4254             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4255             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4256             20  PB-CI-FIRST-NAME            PIC X(10).
  4257             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4258
  4259         16  FILLER                       PIC X(13).
  4260*032306  16  FILLER                       PIC X(27).
  4261*        16  FILLER                       PIC X(46).
  4262
  4263     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4264         16  FILLER                       PIC X(10).
  4265         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4266         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4267         16  PB-M-INSURED-MID-INIT        PIC X.
  4268         16  PB-M-INSURED-AGE             PIC 99.
  4269         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4270         16  PB-M-INSURED-SEX             PIC X.
  4271         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4272         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4273         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  76
* EL6317.cbl
  4274         16  PB-M-INSURED-CITY-STATE.
  4275             20  PB-M-INSURED-CITY        PIC X(28).
  4276             20  PB-M-INSURED-STATE       PIC XX.
  4277         16  PB-M-INSURED-ZIP-CODE.
  4278             20  PB-M-INSURED-ZIP-PRIME.
  4279                 24  PB-M-INSURED-ZIP-1   PIC X.
  4280                     88  PB-M-CANADIAN-POST-CODE
  4281                                             VALUE 'A' THRU 'Z'.
  4282                 24  FILLER               PIC X(4).
  4283             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4284         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4285                                        PB-M-INSURED-ZIP-CODE.
  4286             20  PM-M-INS-CAN-POST1       PIC XXX.
  4287             20  PM-M-INS-CAN-POST2       PIC XXX.
  4288             20  FILLER                   PIC XXX.
  4289         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4290         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4291         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4292         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4293         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4294         16  PB-M-CRED-BENE-CITYST.
  4295             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4296             20  PB-M-CRED-BENE-STATE     PIC XX.
  4297         16  FILLER                       PIC X(92).
  4298
  4299     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4300         16  FILLER                       PIC X(10).
  4301         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4302         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4303         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4304         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4305         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4306         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4307         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4308         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4309         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4310         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4311         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4312         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4313         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4314         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4315         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4316         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4317         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4318         16  PB-ACCOUNT-NAME              PIC X(30).
  4319         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4320         16  PB-REFERENCE                 PIC X(12).
  4321         16  PB-B-RECEIVED-DT             PIC XX.
  4322         16  FILLER                       PIC X(234).
  4323
  4324     12  PB-RECORD-STATUS.
  4325         16  PB-CREDIT-SELECT-DT          PIC XX.
  4326         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4327         16  PB-BILLED-DT                 PIC XX.
  4328         16  PB-BILLING-STATUS            PIC X.
  4329             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4330             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4331             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  77
* EL6317.cbl
  4332         16  PB-RECORD-BILL               PIC X.
  4333             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4334             88  PB-RECORD-RETURNED           VALUE 'R'.
  4335             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4336             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4337             88  PB-OVERRIDE-AH               VALUE 'A'.
  4338             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4339         16  PB-BATCH-ENTRY               PIC X.
  4340             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4341             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4342             88  PB-REISSUED-CERT             VALUE 'E'.
  4343             88  PB-MONTHLY-CERT              VALUE 'M'.
  4344             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4345             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4346             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4347         16  PB-FORCE-CODE                PIC X.
  4348             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4349             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4350             88  PB-CANCEL-FORCE              VALUE '8'.
  4351             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4352             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4353             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4354             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4355             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4356             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4357             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4358         16  PB-FATAL-FLAG                PIC X.
  4359             88  PB-FATAL-ERRORS              VALUE 'X'.
  4360         16  PB-FORCE-ER-CD               PIC X.
  4361             88  PB-FORCE-ERRORS              VALUE 'F'.
  4362             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4363         16  PB-WARN-ER-CD                PIC X.
  4364             88  PB-WARNING-ERRORS            VALUE 'W'.
  4365         16  FILLER                       PIC X.
  4366         16  PB-OUT-BAL-CD                PIC X.
  4367             88  PB-OUT-OF-BAL                VALUE 'O'.
  4368         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4369         16  PB-AH-OVERRIDE-L1            PIC X.
  4370         16  PB-INPUT-DT                  PIC XX.
  4371         16  PB-INPUT-BY                  PIC X(4).
  4372         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4373         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4374         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4375         16  PB-LF-EARNING-METHOD         PIC X.
  4376         16  PB-AH-EARNING-METHOD         PIC X.
  4377         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4378         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4379         16  PB-REIN-CD                   PIC XXX.
  4380         16  PB-LF-REFUND-TYPE            PIC X.
  4381         16  PB-AH-REFUND-TYPE            PIC X.
  4382         16  PB-ACCT-EFF-DT               PIC XX.
  4383         16  PB-ACCT-EXP-DT               PIC XX.
  4384         16  PB-COMPANY-ID                PIC X(3).
  4385         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4386         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4387         16  PB-SV-CARRIER                PIC X.
  4388         16  PB-SV-GROUPING               PIC X(6).
  4389         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  78
* EL6317.cbl
  4390         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4391         16  PB-GA-BILLING-INFO.
  4392             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4393                                          PIC XX.
  4394         16  PB-SV-REMIT-TO  REDEFINES
  4395             PB-GA-BILLING-INFO           PIC X(10).
  4396         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4397         16  PB-I-LOAN-OFFICER            PIC X(5).
  4398         16  PB-I-VIN                     PIC X(17).
  4399
  4400         16  FILLER                       PIC X(04).
  4401         16  IMNET-BYPASS-SW              PIC X.
  4402
  4403******************************************************************
  4404*                COMMON EDIT ERRORS                              *
  4405******************************************************************
  4406
  4407     12  PB-COMMON-ERRORS.
  4408         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4409                                           PIC S9(4)     COMP.
  4410
  4411******************************************************************
  4412*                                COPY ELCCERT.
  4413******************************************************************
  4414*                                                                *
  4415*                            ELCCERT.                            *
  4416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4417*                            VMOD=2.013                          *
  4418*                                                                *
  4419*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4420*                                                                *
  4421*   FILE TYPE = VSAM,KSDS                                        *
  4422*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4423*                                                                *
  4424*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4425*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4426*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4427*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4428*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4429*                                                                *
  4430*   LOG = YES                                                    *
  4431*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4432******************************************************************
  4433*                   C H A N G E   L O G
  4434*
  4435* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4436*-----------------------------------------------------------------
  4437*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4438* EFFECTIVE    NUMBER
  4439*-----------------------------------------------------------------
  4440* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4441* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4442* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4443* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4444* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4445* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4446* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4447* 032612  CR2011110200001  PEMA  AHL CHANGES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  79
* EL6317.cbl
  4448******************************************************************
  4449
  4450 01  CERTIFICATE-MASTER.
  4451     12  CM-RECORD-ID                      PIC XX.
  4452         88  VALID-CM-ID                      VALUE 'CM'.
  4453
  4454     12  CM-CONTROL-PRIMARY.
  4455         16  CM-COMPANY-CD                 PIC X.
  4456         16  CM-CARRIER                    PIC X.
  4457         16  CM-GROUPING.
  4458             20  CM-GROUPING-PREFIX        PIC X(3).
  4459             20  CM-GROUPING-PRIME         PIC X(3).
  4460         16  CM-STATE                      PIC XX.
  4461         16  CM-ACCOUNT.
  4462             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4463             20  CM-ACCOUNT-PRIME          PIC X(6).
  4464         16  CM-CERT-EFF-DT                PIC XX.
  4465         16  CM-CERT-NO.
  4466             20  CM-CERT-PRIME             PIC X(10).
  4467             20  CM-CERT-SFX               PIC X.
  4468
  4469     12  CM-CONTROL-BY-NAME.
  4470         16  CM-COMPANY-CD-A1              PIC X.
  4471         16  CM-INSURED-LAST-NAME          PIC X(15).
  4472         16  CM-INSURED-INITIALS.
  4473             20  CM-INSURED-INITIAL1       PIC X.
  4474             20  CM-INSURED-INITIAL2       PIC X.
  4475
  4476     12  CM-CONTROL-BY-SSN.
  4477         16  CM-COMPANY-CD-A2              PIC X.
  4478         16  CM-SOC-SEC-NO.
  4479             20  CM-SSN-STATE              PIC XX.
  4480             20  CM-SSN-ACCOUNT            PIC X(6).
  4481             20  CM-SSN-LN3.
  4482                 25  CM-INSURED-INITIALS-A2.
  4483                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4484                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4485                 25 CM-PART-LAST-NAME-A2         PIC X.
  4486
  4487     12  CM-CONTROL-BY-CERT-NO.
  4488         16  CM-COMPANY-CD-A4              PIC X.
  4489         16  CM-CERT-NO-A4                 PIC X(11).
  4490
  4491     12  CM-CONTROL-BY-MEMB.
  4492         16  CM-COMPANY-CD-A5              PIC X.
  4493         16  CM-MEMBER-NO.
  4494             20  CM-MEMB-STATE             PIC XX.
  4495             20  CM-MEMB-ACCOUNT           PIC X(6).
  4496             20  CM-MEMB-LN4.
  4497                 25  CM-INSURED-INITIALS-A5.
  4498                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4499                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4500                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4501
  4502     12  CM-INSURED-PROFILE-DATA.
  4503         16  CM-INSURED-FIRST-NAME.
  4504             20  CM-INSURED-1ST-INIT       PIC X.
  4505             20  FILLER                    PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  80
* EL6317.cbl
  4506         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4507         16  CM-INSURED-SEX                PIC X.
  4508             88  CM-SEX-MALE                  VALUE 'M'.
  4509             88  CM-SEX-FEMAL                 VALUE 'F'.
  4510         16  CM-INSURED-JOINT-AGE          PIC 99.
  4511         16  CM-JOINT-INSURED-NAME.
  4512             20  CM-JT-LAST-NAME           PIC X(15).
  4513             20  CM-JT-FIRST-NAME.
  4514                 24  CM-JT-1ST-INIT        PIC X.
  4515                 24  FILLER                PIC X(9).
  4516             20  CM-JT-INITIAL             PIC X.
  4517
  4518     12  CM-LIFE-DATA.
  4519         16  CM-LF-BENEFIT-CD              PIC XX.
  4520         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4521         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4522         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4523         16  CM-LF-DEV-CODE                PIC XXX.
  4524         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4525         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4526         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4527         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4528         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4529         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4530         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4531         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4532         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4533         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4534         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4535         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4536         16  FILLER                        PIC XX.
  4537
  4538     12  CM-AH-DATA.
  4539         16  CM-AH-BENEFIT-CD              PIC XX.
  4540         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4541         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4542         16  CM-AH-DEV-CODE                PIC XXX.
  4543         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4544         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4545         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4546         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4547         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4548         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4549         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4550         16  CM-AH-PAID-THRU-DT            PIC XX.
  4551             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4552         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4553         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4554         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4555         16  FILLER                        PIC X.
  4556
  4557     12  CM-LOAN-INFORMATION.
  4558         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4559         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4560                                           PIC S9(5)V99  COMP-3.
  4561         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4562         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4563         16  CM-PAY-FREQUENCY              PIC S99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  81
* EL6317.cbl
  4564         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4565         16  CM-RATE-CLASS                 PIC XX.
  4566         16  CM-BENEFICIARY                PIC X(25).
  4567         16  CM-POLICY-FORM-NO             PIC X(12).
  4568         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4569         16  CM-LAST-ADD-ON-DT             PIC XX.
  4570         16  CM-DEDUCTIBLE-AMOUNTS.
  4571             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4572             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4573         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4574             20  CM-RESIDENT-STATE         PIC XX.
  4575             20  CM-RATE-CODE              PIC X(4).
  4576             20  FILLER                    PIC XX.
  4577         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4578             20  CM-LOAN-OFFICER           PIC X(5).
  4579             20  FILLER                    PIC XXX.
  4580         16  CM-CSR-CODE                   PIC XXX.
  4581         16  CM-UNDERWRITING-CODE          PIC X.
  4582             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4583         16  CM-POST-CARD-IND              PIC X.
  4584         16  CM-NH-INTERFACE-SW            PIC X.
  4585         16  CM-PREMIUM-TYPE               PIC X.
  4586             88  CM-SING-PRM                  VALUE '1'.
  4587             88  CM-O-B-COVERAGE              VALUE '2'.
  4588             88  CM-OPEN-END                  VALUE '3'.
  4589         16  CM-IND-GRP-TYPE               PIC X.
  4590             88  CM-INDIVIDUAL                VALUE 'I'.
  4591             88  CM-GROUP                     VALUE 'G'.
  4592         16  CM-SKIP-CODE                  PIC X.
  4593             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4594             88  SKIP-JULY                    VALUE '1'.
  4595             88  SKIP-AUGUST                  VALUE '2'.
  4596             88  SKIP-SEPTEMBER               VALUE '3'.
  4597             88  SKIP-JULY-AUG                VALUE '4'.
  4598             88  SKIP-AUG-SEPT                VALUE '5'.
  4599             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4600             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4601             88  SKIP-JUNE                    VALUE '8'.
  4602             88  SKIP-JUNE-JULY               VALUE '9'.
  4603             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4604             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4605         16  CM-PAYMENT-MODE               PIC X.
  4606             88  PAY-MONTHLY                  VALUE SPACE.
  4607             88  PAY-WEEKLY                   VALUE '1'.
  4608             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4609             88  PAY-BI-WEEKLY                VALUE '3'.
  4610             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4611         16  CM-LOAN-NUMBER                PIC X(8).
  4612         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4613         16  CM-OLD-LOF                    PIC XXX.
  4614*        16  CM-LOAN-OFFICER               PIC XXX.
  4615         16  CM-REIN-TABLE                 PIC XXX.
  4616         16  CM-SPECIAL-REIN-CODE          PIC X.
  4617         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4618         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4619         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4620
  4621     12  CM-STATUS-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  82
* EL6317.cbl
  4622         16  CM-ENTRY-STATUS               PIC X.
  4623         16  CM-ENTRY-DT                   PIC XX.
  4624
  4625         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4626         16  CM-LF-CANCEL-DT               PIC XX.
  4627         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4628
  4629         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4630         16  CM-LF-DEATH-DT                PIC XX.
  4631         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4632
  4633         16  CM-LF-CURRENT-STATUS          PIC X.
  4634             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4635                                                'M' '4' '5' '9'.
  4636             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4637             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4638             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4639             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4640             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4641             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4642             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4643             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4644             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4645             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4646             88  CM-LF-DECLINED               VALUE 'D'.
  4647             88  CM-LF-VOIDED                 VALUE 'V'.
  4648
  4649         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4650         16  CM-AH-CANCEL-DT               PIC XX.
  4651         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4652
  4653         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4654         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4655         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4656
  4657         16  CM-AH-CURRENT-STATUS          PIC X.
  4658             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4659                                                'M' '4' '5' '9'.
  4660             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4661             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4662             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4663             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4664             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4665             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4666             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4667             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4668             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4669             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4670             88  CM-AH-DECLINED               VALUE 'D'.
  4671             88  CM-AH-VOIDED                 VALUE 'V'.
  4672
  4673         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4674             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4675             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4676             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4677         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4678
  4679         16  CM-ENTRY-BATCH                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  83
* EL6317.cbl
  4680         16  CM-LF-EXIT-BATCH              PIC X(6).
  4681         16  CM-AH-EXIT-BATCH              PIC X(6).
  4682         16  CM-LAST-MONTH-END             PIC XX.
  4683
  4684     12  CM-NOTE-SW                        PIC X.
  4685         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4686         88  CERT-NOTES-PRESENT               VALUE '1'.
  4687         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4688         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4689         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4690         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4691         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4692         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4693     12  CM-COMP-EXCP-SW                   PIC X.
  4694         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4695         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4696     12  CM-INSURED-ADDRESS-SW             PIC X.
  4697         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4698         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4699
  4700*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4701     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4702     12  FILLER                            PIC X.
  4703
  4704*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4705     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4706     12  FILLER                            PIC X.
  4707*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4708     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4709
  4710     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4711         88  CERT-ADDED-BATCH                 VALUE ' '.
  4712         88  CERT-ADDED-ONLINE                VALUE '1'.
  4713         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4714         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4715         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4716     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4717         88  CERT-AS-LOADED                   VALUE ' '.
  4718         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4719         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4720         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4721         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4722         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4723         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4724         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4725
  4726     12  CM-ACCOUNT-COMM-PCTS.
  4727         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4728         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4729
  4730     12  CM-USER-FIELD                     PIC X.
  4731     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4732     12  CM-CLP-STATE                      PIC XX.
  4733     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4734     12  CM-USER-RESERVED                  PIC XXX.
  4735     12  FILLER REDEFINES CM-USER-RESERVED.
  4736         16  CM-AH-CLASS-CD                PIC XX.
  4737         16  F                             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  84
* EL6317.cbl
  4738******************************************************************
  4739*                                COPY ELCCRTO.
  4740******************************************************************
  4741*                                                                *
  4742*                            ELCCRTO.                            *
  4743*                                                                *
  4744*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4745*                                                                *
  4746*   FILE TYPE = VSAM,KSDS                                        *
  4747*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4748*                                                                *
  4749*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4750*                                                                *
  4751*   LOG = YES                                                    *
  4752*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4753******************************************************************
  4754*                   C H A N G E   L O G
  4755*
  4756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4757*-----------------------------------------------------------------
  4758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4759* EFFECTIVE    NUMBER
  4760*-----------------------------------------------------------------
  4761* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4762* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4763* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4764******************************************************************
  4765 01  ORIGINAL-CERTIFICATE.
  4766     12  OC-RECORD-ID                      PIC XX.
  4767         88  VALID-OC-ID                      VALUE 'OC'.
  4768     12  OC-CONTROL-PRIMARY.
  4769         16  OC-COMPANY-CD                 PIC X.
  4770         16  OC-CARRIER                    PIC X.
  4771         16  OC-GROUPING                   PIC X(6).
  4772         16  OC-STATE                      PIC XX.
  4773         16  OC-ACCOUNT                    PIC X(10).
  4774         16  OC-CERT-EFF-DT                PIC XX.
  4775         16  OC-CERT-NO.
  4776             20  OC-CERT-PRIME             PIC X(10).
  4777             20  OC-CERT-SFX               PIC X.
  4778         16  OC-RECORD-TYPE                PIC X.
  4779         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4780     12  OC-LAST-MAINT-DT                  PIC XX.
  4781     12  OC-LAST-MAINT-BY                  PIC X(4).
  4782     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4783     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4784     12  FILLER                            PIC X(49).
  4785     12  OC-ORIG-REC.
  4786         16  OC-INS-LAST-NAME              PIC X(15).
  4787         16  OC-INS-FIRST-NAME             PIC X(10).
  4788         16  OC-INS-MIDDLE-INIT            PIC X.
  4789         16  OC-INS-AGE                    PIC S999     COMP-3.
  4790         16  OC-JNT-LAST-NAME              PIC X(15).
  4791         16  OC-JNT-FIRST-NAME             PIC X(10).
  4792         16  OC-JNT-MIDDLE-INIT            PIC X.
  4793         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4794         16  OC-LF-BENCD                   PIC XX.
  4795         16  OC-LF-TERM                    PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  85
* EL6317.cbl
  4796         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4797         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4798         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4799         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4800         16  OC-LF-EXP-DT                  PIC XX.
  4801         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4802         16  OC-LF-CANCEL-DT               PIC XX.
  4803         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4804         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4805         16  OC-AH-BENCD                   PIC XX.
  4806         16  OC-AH-TERM                    PIC S999      COMP-3.
  4807         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4808         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4809         16  OC-AH-EXP-DT                  PIC XX.
  4810         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4811         16  OC-AH-CP                      PIC 99.
  4812         16  OC-AH-CANCEL-DT               PIC XX.
  4813         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4814         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4815         16  OC-CRED-BENE-NAME             PIC X(25).
  4816         16  OC-1ST-PMT-DT                 PIC XX.
  4817         16  FILLER                        PIC X(215).
  4818
  4819     12  FILLER                            PIC X(50).
  4820******************************************************************
  4821*                                COPY ERCENDT.
  4822******************************************************************
  4823*                                                                *
  4824*                                                                *
  4825*                            ERCENDT.                            *
  4826*                            VMOD=2.001                          *
  4827*                                                                *
  4828*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4829*                                                                *
  4830*   FILE TYPE = VSAM,KSDS                                        *
  4831*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4832*                                                                *
  4833*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4834*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4835*                                                                *
  4836*   LOG = NO                                                     *
  4837*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4838******************************************************************
  4839*-----------------------------------------------------------------
  4840*                   C H A N G E   L O G
  4841*
  4842* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4843*-----------------------------------------------------------------
  4844*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4845* EFFECTIVE    NUMBER
  4846*-----------------------------------------------------------------
  4847* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4848*                                WITH OPEN CLAIMS
  4849* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4850* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4851*-----------------------------------------------------------------
  4852 01  ENDORSEMENT-RECORD.
  4853     12  EN-RECORD-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  86
* EL6317.cbl
  4854         88  VALID-EN-ID                VALUE 'EN'.
  4855     12  EN-CONTROL-PRIMARY.
  4856         16  EN-COMPANY-CD           PIC X.
  4857         16  EN-CARRIER              PIC X.
  4858         16  EN-GROUPING             PIC X(6).
  4859         16  EN-STATE                PIC XX.
  4860         16  EN-ACCOUNT              PIC X(10).
  4861         16  EN-CERT-EFF-DT          PIC XX.
  4862         16  EN-CERT-NO.
  4863             20  EN-CERT-PRIME       PIC X(10).
  4864             20  EN-CERT-SFX         PIC X.
  4865         16  EN-REC-TYPE             PIC X.
  4866             88  EN-ISSUE               VALUE 'I'.
  4867             88  EN-CANCELLATION        VALUE 'C'.
  4868         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4869     12  EN-CONTROL-BY-ARCH-NO.
  4870         16  EN-COMPANY-CD-A1              PIC X.
  4871         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4872     12  EN-LAST-MAINT-DT            PIC XX.
  4873     12  EN-LAST-MAINT-BY            PIC X(4).
  4874     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4875     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4876     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4877         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4878         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4879         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4880         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4881         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4882         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4883         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4884         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4885         16  EN-LF-ORIG-BENCD        PIC XX.
  4886         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4887         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4888         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4889         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4890         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4891         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4892*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4893         16  EN-ORIG-CRED-BENE       PIC X(25).
  4894         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4895         16  FILLER                  PIC X.
  4896         16  EN-AH-ORIG-BENCD        PIC XX.
  4897         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4898         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4899         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4900         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4901*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4902*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4903         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4904         16  F                       PIC X(09).
  4905         16  EN-AH-ORIG-CP           PIC 99.
  4906         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4907         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4908         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4909         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4910         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4911         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  87
* EL6317.cbl
  4912         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4913         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4914         16  EN-LF-NEW-BENCD         PIC XX.
  4915         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4916         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4917         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4918         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4919         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4920         16  EN-LF-NEW-EXP-DT        PIC XX.
  4921         16  EN-NEW-CRED-BENE        PIC X(25).
  4922         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4923         16  FILLER                  PIC X.
  4924         16  EN-AH-NEW-BENCD         PIC XX.
  4925         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  4926         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4927         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4928         16  EN-AH-NEW-EXP-DT        PIC XX.
  4929*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  4930*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  4931*        16  F                       PIC X(12).
  4932         16  EN-AH-NEW-CP            PIC 99.
  4933         16  EN-SIG-SW               PIC X.
  4934         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4935         16  FILLER                  PIC X(37).
  4936     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4937         16  EN-LF-ORIG-REF-DT       PIC XX.
  4938         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4939         16  EN-AH-ORIG-REF-DT       PIC XX.
  4940         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4941         16  EN-LF-NEW-REF-DT        PIC XX.
  4942         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4943         16  EN-AH-NEW-REF-DT        PIC XX.
  4944         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4945         16  EN-FLAG-CERT            PIC X.
  4946         16  EN-INS-LAST-NAME        PIC X(15).
  4947         16  EN-INS-FIRST-NAME       PIC X(10).
  4948         16  EN-INS-MIDDLE-INIT      PIC X.
  4949         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  4950         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  4951         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  4952         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  4953         16  FILLER                  PIC X(262).
  4954     12  EN-MONEY-SW             PIC X.
  4955     12  EN-HEALTH-APP           PIC X.
  4956     12  EN-VOUCHER-SW           PIC X.
  4957     12  EN-PAYEE                PIC X(14).
  4958     12  EN-INPUT-DT             PIC XX.
  4959     12  EN-PROCESS-DT           PIC XX.
  4960     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  4961     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  4962     12  EN-REASON-CODES.
  4963         16  F OCCURS 12.
  4964             20  EN-REASON-CODE  PIC X(4).
  4965     12  EN-TEMPLATE-USED        PIC X(8).
  4966     12  EN-DOCU-TYPE            PIC X.
  4967         88  EN-VERI-DOCU          VALUE 'V'.
  4968         88  EN-GCE-DOCU           VALUE 'G'.
  4969         88  EN-CANC-DOCU          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  88
* EL6317.cbl
  4970     12  EN-COMMENTS1            PIC X(13).
  4971     12  EN-COMMENTS2            PIC X(70).
  4972     12  EN-COMM-CHGBK           PIC X.
  4973         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  4974         88  EN-CHG-ACCT           VALUE 'Y'.
  4975     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  4976     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  4977     12  EN-BATCH-NUMBER         PIC X(6).
  4978     12  EN-ACCT-SUMM            PIC X.
  4979     12  EN-CSO-SUMM             PIC X.
  4980     12  FILLER                  PIC X(13).
  4981******************************************************************
  4982*                                COPY ERCNOTE.
  4983******************************************************************
  4984*                                                                *
  4985*                                                                *
  4986*                            ERCNOTE                             *
  4987*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4988*                            VMOD=2.003                          *
  4989*                                                                *
  4990*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  4991*                                                                *
  4992*        FILE TYPE= VSAM,KSDS                                    *
  4993*        RECORD SIZE = 825    RECFORM = FIXED                    *
  4994*                                                                *
  4995*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  4996*                                                                *
  4997*        LOG = YES                                               *
  4998*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4999*                                                                *
  5000******************************************************************
  5001*                   C H A N G E   L O G
  5002*
  5003* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5004*-----------------------------------------------------------------
  5005*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5006* EFFECTIVE    NUMBER
  5007*-----------------------------------------------------------------
  5008* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5009*                                FILE WILL CONTAIN BILLING NOTES O
  5010******************************************************************
  5011
  5012 01  CERTIFICATE-NOTE.
  5013     12  CN-RECORD-ID                PIC  XX.
  5014         88  VALID-CN-ID                  VALUE 'CN'.
  5015
  5016     12  CN-CONTROL-PRIMARY.
  5017         16  CN-COMPANY-CD           PIC X.
  5018         16  CN-CARRIER              PIC X.
  5019         16  CN-GROUPING.
  5020             20 CN-GROUPING-PREFIX   PIC XXX.
  5021             20 CN-GROUPING-PRIME    PIC XXX.
  5022         16  CN-STATE                PIC XX.
  5023         16  CN-ACCOUNT.
  5024             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5025             20 CN-ACCOUNT-PRIME     PIC X(6).
  5026         16  CN-CERT-EFF-DT          PIC XX.
  5027         16  CN-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  89
* EL6317.cbl
  5028             20  CN-CERT-PRIME       PIC X(10).
  5029             20  CN-CERT-SFX         PIC X.
  5030
  5031     12  CN-BILLING-START-LINE-NO    PIC 99.
  5032     12  CN-BILLING-END-LINE-NO      PIC 99.
  5033
  5034     12  CN-LINES.
  5035         16  CN-LINE OCCURS 10       PIC X(77).
  5036
  5037     12  CN-LAST-MAINT-DT            PIC XX.
  5038     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5039     12  CN-LAST-MAINT-USER          PIC X(4).
  5040     12  FILLER                      PIC X(6).
  5041******************************************************************
  5042*                                COPY ERCMAIL.
  5043******************************************************************
  5044*                                                                *
  5045*                                                                *
  5046*                            ERCMAIL                             *
  5047*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5048*                            VMOD=2.003                          *
  5049*                                                                *
  5050*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5051*                                                                *
  5052*   FILE TYPE = VSAM,KSDS                                        *
  5053*   RECORD SIZE = 374   RECFORM = FIX                            *
  5054*                                                                *
  5055*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5056*   ALTERNATE PATH    = NOT USED                                 *
  5057*                                                                *
  5058*   LOG = YES                                                    *
  5059*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5060******************************************************************
  5061*                   C H A N G E   L O G
  5062*
  5063* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5064*-----------------------------------------------------------------
  5065*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5066* EFFECTIVE    NUMBER
  5067*-----------------------------------------------------------------
  5068* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5069* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5070* 111108                   PEMA  ADD CRED BENE ADDR2
  5071******************************************************************
  5072
  5073 01  MAILING-DATA.
  5074     12  MA-RECORD-ID                      PIC XX.
  5075         88  VALID-MA-ID                       VALUE 'MA'.
  5076
  5077     12  MA-CONTROL-PRIMARY.
  5078         16  MA-COMPANY-CD                 PIC X.
  5079         16  MA-CARRIER                    PIC X.
  5080         16  MA-GROUPING.
  5081             20  MA-GROUPING-PREFIX        PIC XXX.
  5082             20  MA-GROUPING-PRIME         PIC XXX.
  5083         16  MA-STATE                      PIC XX.
  5084         16  MA-ACCOUNT.
  5085             20  MA-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  90
* EL6317.cbl
  5086             20  MA-ACCOUNT-PRIME          PIC X(6).
  5087         16  MA-CERT-EFF-DT                PIC XX.
  5088         16  MA-CERT-NO.
  5089             20  MA-CERT-PRIME             PIC X(10).
  5090             20  MA-CERT-SFX               PIC X.
  5091
  5092     12  FILLER                            PIC XX.
  5093
  5094     12  MA-ACCESS-CONTROL.
  5095         16  MA-SOURCE-SYSTEM              PIC XX.
  5096             88  MA-FROM-CREDIT                VALUE 'CR'.
  5097             88  MA-FROM-VSI                   VALUE 'VS'.
  5098             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5099             88  MA-FROM-OTHER                 VALUE 'OT'.
  5100         16  MA-RECORD-ADD-DT              PIC XX.
  5101         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5102         16  MA-LAST-MAINT-DT              PIC XX.
  5103         16  MA-LAST-MAINT-BY              PIC XXXX.
  5104         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5105
  5106     12  MA-PROFILE-INFO.
  5107         16  MA-QUALIFY-CODE-1             PIC XX.
  5108         16  MA-QUALIFY-CODE-2             PIC XX.
  5109         16  MA-QUALIFY-CODE-3             PIC XX.
  5110         16  MA-QUALIFY-CODE-4             PIC XX.
  5111         16  MA-QUALIFY-CODE-5             PIC XX.
  5112
  5113         16  MA-INSURED-LAST-NAME          PIC X(15).
  5114         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5115         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5116         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5117         16  MA-INSURED-BIRTH-DT           PIC XX.
  5118         16  MA-INSURED-SEX                PIC X.
  5119             88  MA-SEX-MALE                   VALUE 'M'.
  5120             88  MA-SEX-FEMALE                 VALUE 'F'.
  5121         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5122
  5123         16  MA-ADDRESS-CORRECTED          PIC X.
  5124         16  MA-JOINT-BIRTH-DT             PIC XX.
  5125*        16  FILLER                        PIC X(12).
  5126
  5127         16  MA-ADDRESS-LINE-1             PIC X(30).
  5128         16  MA-ADDRESS-LINE-2             PIC X(30).
  5129         16  MA-CITY-STATE.
  5130             20  MA-CITY                   PIC X(28).
  5131             20  MA-ADDR-STATE             PIC XX.
  5132         16  MA-ZIP.
  5133             20  MA-ZIP-CODE.
  5134                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5135                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5136                 24  FILLER                PIC X(4).
  5137             20  MA-ZIP-PLUS4              PIC X(4).
  5138         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5139             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5140             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5141             20  FILLER                    PIC X(3).
  5142
  5143         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  91
* EL6317.cbl
  5144
  5145         16  FILLER                        PIC XXX.
  5146*        16  FILLER                        PIC X(10).
  5147
  5148     12  MA-CRED-BENE-INFO.
  5149         16  MA-CRED-BENE-NAME                 PIC X(25).
  5150         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5151         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5152         16  MA-CRED-BENE-CTYST.
  5153             20  MA-CRED-BENE-CITY             PIC X(28).
  5154             20  MA-CRED-BENE-STATE            PIC XX.
  5155         16  MA-CRED-BENE-ZIP.
  5156             20  MA-CB-ZIP-CODE.
  5157                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5158                     88  MA-CB-CANADIAN-POST-CODE
  5159                                           VALUE 'A' THRU 'Z'.
  5160                 24  FILLER                    PIC X(4).
  5161             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5162         16  MA-CB-CANADIAN-POSTAL-CODE
  5163                            REDEFINES MA-CRED-BENE-ZIP.
  5164             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5165             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5166             20  FILLER                        PIC X(3).
  5167     12  MA-POST-CARD-MAIL-DATA.
  5168         16  MA-MAIL-DATA OCCURS 7.
  5169             20  MA-MAIL-TYPE              PIC X.
  5170                 88  MA-12MO-MAILING           VALUE '1'.
  5171                 88  MA-EXP-MAILING            VALUE '2'.
  5172             20  MA-MAIL-STATUS            PIC X.
  5173                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5174                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5175                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5176             20  MA-MAIL-DATE              PIC XX.
  5177     12  FILLER                            PIC XX.
  5178     12  FILLER                            PIC XX.
  5179*    12  FILLER                            PIC X(30).
  5180******************************************************************
  5181*                                COPY ERCARCH.
  5182******************************************************************
  5183*                                                                *
  5184*                            ERCARCH.                            *
  5185*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5186*                            VMOD=2.002                          *
  5187*                                                                *
  5188*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5189*                                                                *
  5190*   FILE TYPE = VSAM,KSDS                                        *
  5191*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5192*                                                                *
  5193*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5194*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5195*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5196*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5197*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5198*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5199*                                                                *
  5200*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5201******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  92
* EL6317.cbl
  5202*                   C H A N G E   L O G
  5203*
  5204* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5205*-----------------------------------------------------------------
  5206*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5207* EFFECTIVE    NUMBER
  5208*-----------------------------------------------------------------
  5209* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5210* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5211* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5212******************************************************************
  5213 01  LETTER-ARCHIVE.
  5214     12  LA-RECORD-ID                PIC  X(02).
  5215         88  LA-VALID-ID                VALUE 'LA'.
  5216
  5217     12  LA-CONTROL-PRIMARY.
  5218         16  LA-COMPANY-CD           PIC  X(01).
  5219         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5220
  5221     12  LA-CONTROL-BY-CERT-RESP.
  5222         16  LA-COMPANY-CD-A2        PIC  X(01).
  5223         16  LA-CERT-NO-A2.
  5224             20  LA-CERT-PRIME-A2    PIC  X(10).
  5225             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5226         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5227             20  LA-RESP-PERSON-A2   PIC  X(10).
  5228             20  LA-TYPE-A2          PIC  X(01).
  5229         16  LA-CARRIER-A2           PIC  X(01).
  5230         16  LA-GROUPING-A2          PIC  X(06).
  5231         16  LA-STATE-A2             PIC  X(02).
  5232         16  LA-ACCOUNT-A2           PIC  X(10).
  5233         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5234         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5235
  5236     12  LA-CONTROL-BY-FORM.
  5237         16  LA-COMPANY-CD-A3        PIC  X(01).
  5238         16  LA-FORM-A3              PIC  X(04).
  5239         16  LA-CARRIER-A3           PIC  X(01).
  5240         16  LA-GROUPING-A3          PIC  X(06).
  5241         16  LA-STATE-A3             PIC  X(02).
  5242         16  LA-ACCOUNT-A3           PIC  X(10).
  5243         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5244
  5245     12  LA-CONTROL-BY-PROCESSOR.
  5246         16  LA-COMPANY-CD-A4        PIC  X(01).
  5247         16  LA-PROCESSOR-CD         PIC  X(04).
  5248         16  LA-CARRIER-A4           PIC  X(01).
  5249         16  LA-GROUPING-A4          PIC  X(06).
  5250         16  LA-STATE-A4             PIC  X(02).
  5251         16  LA-ACCOUNT-A4           PIC  X(10).
  5252         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5253
  5254     12  LA-CONTROL-BY-KEY-FIELDS.
  5255         16  LA-COMPANY-CD-A5        PIC  X(01).
  5256         16  LA-CARRIER-A5           PIC  X(01).
  5257         16  LA-GROUPING-A5          PIC  X(06).
  5258         16  LA-STATE-A5             PIC  X(02).
  5259         16  LA-ACCOUNT-A5           PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  93
* EL6317.cbl
  5260         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5261
  5262     12  LA-CONTROL-BY-GROUP-CODE.
  5263         16  LA-COMPANY-CD-A6        PIC  X(01).
  5264         16  LA-ENTRY-A6.
  5265             20  LA-FILLER           PIC  X(02).
  5266             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5267         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5268
  5269     12  FILLER                      PIC  X(09).
  5270
  5271     12  LA-HEADER-RECORD.
  5272         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5273         16  LA-CREATION-DATE        PIC  X(02).
  5274         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5275         16  LA-FINAL-ACT-DATE       REDEFINES
  5276               LA-FOLLOW-UP-DATE     PIC  X(02).
  5277         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5278         16  LA-NO-OF-COPIES         PIC S9(01).
  5279         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5280         16  LA-REPLY-DATE           PIC  X(02).
  5281         16  LA-RESEND-DATES.
  5282             20  LA-RESEND-DATE      PIC  X(02).
  5283             20  LA-SENT-DATE        PIC  X(02).
  5284             20  FILLER              PIC  X(08).
  5285         16  LA-SOURCE-INFORMATION.
  5286             20  LA-DATA-SOURCE      PIC  X(01).
  5287             20  LA-ADDR-SOURCE      PIC  X(01).
  5288         16  LA-STATUS               PIC  X(01).
  5289             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5290             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5291             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5292             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5293             88  LA-STATUS-PURGED         VALUE 'P'.
  5294             88  LA-STATUS-VOIDED         VALUE 'V'.
  5295         16  LA-LAST-RESENT-PRINT-DATE
  5296                                     PIC  X(02).
  5297         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5298             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5299                                          VALUE 'C'.
  5300             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5301                                          VALUE 'F'.
  5302             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5303                                          VALUE 'P'.
  5304         16  LA-PURGED-DATE          PIC  X(02).
  5305         16  LA-VOIDED-DATE          PIC  X(02).
  5306         16  LA-RESEND-LETR          PIC  X(4).
  5307         16  FILLER                  PIC  X(08).
  5308*        16  LA-RESEND-LETR-2        PIC  X(4).
  5309*        16  LA-RESEND-LETR-3        PIC  X(4).
  5310*        16  FILLER                  PIC  X(59).
  5311         16  LA-ARCHIVE-STATUS       PIC  X.
  5312             88  LA-TEMP                VALUE 'T'.
  5313             88  LA-QWS                 VALUE 'Q'.
  5314             88  LA-BATCH               VALUE 'B'.
  5315         16  LA-FINAL-ACT-IND        PIC  X(1).
  5316         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5317         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  94
* EL6317.cbl
  5318         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5319                                     PIC X(4).
  5320         16  FILLER                  PIC  X(42).
  5321*        16  FILLER                  PIC  X(71).
  5322         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5323         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5324         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5325                                     PIC  X(4).
  5326         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5327
  5328******************************************************************
  5329*                                COPY ERCCNOT.
  5330******************************************************************
  5331*                                                                *
  5332*                            ERCCNOT                             *
  5333*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5334*                            VMOD=2.003                          *
  5335*                                                                *
  5336*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5337*                                                                *
  5338*        FILE TYPE= VSAM,KSDS                                    *
  5339*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5340*                                                                *
  5341*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5342*                                                                *
  5343*        LOG = YES                                               *
  5344*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5345*                                                                *
  5346******************************************************************
  5347*                   C H A N G E   L O G
  5348*
  5349* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5350*-----------------------------------------------------------------
  5351*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5352* EFFECTIVE    NUMBER
  5353*-----------------------------------------------------------------
  5354* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5355******************************************************************
  5356
  5357 01  CERT-NOTE-FILE.
  5358     12  CZ-RECORD-ID                PIC  XX.
  5359         88  VALID-CZ-ID                  VALUE 'CZ'.
  5360
  5361     12  CZ-CONTROL-PRIMARY.
  5362         16  CZ-COMPANY-CD           PIC X.
  5363         16  CZ-CARRIER              PIC X.
  5364         16  CZ-GROUPING.
  5365             20 CZ-GROUPING-PREFIX   PIC XXX.
  5366             20 CZ-GROUPING-PRIME    PIC XXX.
  5367         16  CZ-STATE                PIC XX.
  5368         16  CZ-ACCOUNT.
  5369             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5370             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5371         16  CZ-CERT-EFF-DT          PIC XX.
  5372         16  CZ-CERT-NO.
  5373             20  CZ-CERT-PRIME       PIC X(10).
  5374             20  CZ-CERT-SFX         PIC X.
  5375         16  CZ-RECORD-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  95
* EL6317.cbl
  5376             88  CERT-NOTE           VALUE '1'.
  5377             88  CLAIM-CERT-NOTE     VALUE '2'.
  5378         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5379
  5380     12  CZ-LAST-MAINT-DT            PIC XX.
  5381     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5382     12  CZ-LAST-MAINT-USER          PIC X(4).
  5383
  5384     12  CZ-NOTE-INFORMATION.
  5385         16  CZ-NOTE                 PIC X(63).
  5386         16  FILLER                  PIC X(39).
  5387******************************************************************
  5388*                                COPY ELCEOBC.
  5389******************************************************************
  5390*                                                                *
  5391*                                                                *
  5392*                            ELCEOBC                             *
  5393*                            VMOD=2.001                          *
  5394*                                                                *
  5395*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5396*                                                                *
  5397*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5398*   VSAM EOB CODE TABLE                                          *
  5399*                                                                *
  5400*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5401*                                                                *
  5402*   FILE TYPE = VSAM,KSDS                                        *
  5403*   RECORD SIZE = 350   RECFORM = FIX                            *
  5404*                                                                *
  5405*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5406*                                                                *
  5407*   LOG = NO                                                     *
  5408*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5409*                                                                *
  5410*                                                                *
  5411******************************************************************
  5412*                   C H A N G E   L O G
  5413*
  5414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5415*-----------------------------------------------------------------
  5416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5417* EFFECTIVE    NUMBER
  5418*-----------------------------------------------------------------
  5419* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5420* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5421******************************************************************
  5422 01  EOB-CODES.
  5423     12  EO-RECORD-ID                      PIC XX.
  5424         88  VALID-DN-ID                      VALUE 'EO'.
  5425     12  EO-CONTROL-PRIMARY.
  5426         16  EO-COMPANY-CD                 PIC X.
  5427         16  EO-RECORD-TYPE                PIC X.
  5428             88  EO-EOB-RECS                  VALUE '1'.
  5429             88  EO-VERIF-RECS                VALUE '2'.
  5430             88  EO-GCE-RECS                  VALUE '3'.
  5431         16  EO-EOB-CODE                   PIC X(4).
  5432         16  FILLER                        PIC X(9).
  5433     12  EO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  96
* EL6317.cbl
  5434         16  EO-LAST-MAINT-DT              PIC XX.
  5435         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5436         16  EO-LAST-MAINT-USER            PIC X(4).
  5437         16  FILLER                        PIC XX.
  5438     12  EO-DESCRIPTION                    PIC X(275).
  5439     12  FILLER                            PIC X(46).
  5440******************************************************************
  5441 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5442                          ACCOUNT-MASTER CONTROL-FILE
  5443                          PENDING-BUSINESS CERTIFICATE-MASTER
  5444                          ORIGINAL-CERTIFICATE
  5445                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5446                          MAILING-DATA LETTER-ARCHIVE
  5447                          CERT-NOTE-FILE EOB-CODES.
  5448 0000-DFHEXIT SECTION.
  5449     MOVE '9#                    $   ' TO DFHEIV0.
  5450     MOVE 'EL6317' TO DFHEIV1.
  5451     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5452     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5453     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5454     MOVE '5'                    TO DC-OPTION-CODE
  5455     PERFORM 9700-DATE-LINK
  5456     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5457     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5458     MOVE EIBTRMID               TO QID-TERM
  5459     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5460     IF EIBCALEN = 0
  5461        GO TO 8800-UNAUTHORIZED-ACCESS
  5462     END-IF
  5463     MOVE FUNCTION LENGTH(EL631JI) TO MAP-LENGTH
  5464     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5465        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5466           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5467           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5468           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5469           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5470           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5471           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5472           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5473           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5474           MOVE LOW-VALUES           TO EL631JI
  5475           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5476           GO TO 0350-BUILD-INIT-MAP
  5477        END-IF
  5478     END-IF
  5479     IF PI-CALLING-PROGRAM = 'EL614'
  5480        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5481                                 TO WS-PASSED-REASON-CODES
  5482        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5483        IF WS-PASSED-REASON-CODES NOT = SPACES
  5484           MOVE 'Y'              TO WS-SET-CODES-MDT
  5485        ELSE
  5486           MOVE 'N'              TO WS-SET-CODES-MDT
  5487        END-IF
  5488        PERFORM 0600-RECOVER-TEMP-STORAGE
  5489                                 THRU 0600-EXIT
  5490        GO TO 0350-BUILD-INIT-MAP
  5491     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  97
* EL6317.cbl
  5492     IF EIBAID = DFHCLEAR
  5493        IF PI-CLEAR-ERROR
  5494           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5495           MOVE ER-3833           TO EMI-ERROR
  5496           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5497           GO TO 0350-BUILD-INIT-MAP
  5498        ELSE
  5499           GO TO 9400-CLEAR
  5500        END-IF
  5501     END-IF
  5502     .
  5503 0200-RECEIVE.
  5504     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5505        MOVE ER-0008             TO EMI-ERROR
  5506        PERFORM 9900-ERROR-FORMAT
  5507                                 THRU 9900-EXIT
  5508        MOVE -1                  TO PFENTRL
  5509        GO TO 8100-SEND-INITIAL-MAP
  5510     END-IF
  5511
  5512* EXEC CICS RECEIVE
  5513*        MAP      (MAP-NAME)
  5514*        MAPSET   (MAPSET-NAME)
  5515*        INTO     (EL631JI)
  5516*    END-EXEC
  5517     MOVE LENGTH OF
  5518      EL631JI
  5519       TO DFHEIV11
  5520*    MOVE '8"T I  L              ''   #00005507' TO DFHEIV0
  5521     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5522     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5523     MOVE X'2020233030303035353037' TO DFHEIV0(25:11)
  5524     CALL 'kxdfhei1' USING DFHEIV0,
  5525           MAP-NAME,
  5526           EL631JI,
  5527           DFHEIV11,
  5528           MAPSET-NAME,
  5529           DFHEIV99,
  5530           DFHEIV99
  5531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5532     IF PFENTRL = 0
  5533         GO TO 0300-CHECK-PFKEYS
  5534     END-IF
  5535     IF EIBAID NOT = DFHENTER
  5536         MOVE ER-0004            TO EMI-ERROR
  5537         GO TO 0320-INPUT-ERROR
  5538     END-IF
  5539     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5540        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5541     ELSE
  5542        MOVE ER-0029            TO EMI-ERROR
  5543        GO TO 0320-INPUT-ERROR
  5544     END-IF
  5545     .
  5546 0300-CHECK-PFKEYS.
  5547     IF EIBAID = DFHPF3
  5548        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5549        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  98
* EL6317.cbl
  5550        MOVE 'EL614'             TO PGM-NAME
  5551        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5552        move +1                  to s2
  5553        perform varying s1 from +1 by +1 until s1 > +12
  5554           if reacd-in (s1) not = spaces and low-values
  5555              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5556              add +5 to s2
  5557           end-if
  5558        END-perform
  5559        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5560        GO TO 9300-XCTL
  5561     END-IF
  5562     IF EIBAID = DFHPF4 OR DFHPF8
  5563        GO TO 0360-FINALIZE
  5564     END-IF
  5565     IF EIBAID = DFHPF23
  5566        IF PI-CLEAR-ERROR
  5567           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5568           MOVE ER-3833           TO EMI-ERROR
  5569           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5570           GO TO 0350-BUILD-INIT-MAP
  5571        ELSE
  5572           GO TO 8810-PF23
  5573        END-IF
  5574     END-IF
  5575     IF EIBAID = DFHPF24
  5576        IF PI-CLEAR-ERROR
  5577           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5578           MOVE ER-3833           TO EMI-ERROR
  5579           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5580           GO TO 0350-BUILD-INIT-MAP
  5581        ELSE
  5582           GO TO 9200-RETURN-MAIN-MENU
  5583        END-IF
  5584     END-IF
  5585     IF EIBAID = DFHPF12
  5586        GO TO 9500-PF12
  5587     END-IF
  5588     IF EIBAID = DFHENTER
  5589        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5590        GO TO 0325-EDIT-SCREEN
  5591     END-IF
  5592     MOVE ER-0029                TO EMI-ERROR
  5593     .
  5594 0320-INPUT-ERROR.
  5595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5596     MOVE AL-UNBON               TO PFENTRA
  5597     MOVE -1                     TO PFENTRL
  5598     GO TO 8200-SEND-DATAONLY
  5599     .
  5600 0325-EDIT-SCREEN.
  5601     if prtswl > zeros
  5602        if prtswi = 'Y' OR 'N' OR 'P' OR ' '
  5603*          MOVE AL-UANON       TO PRTSWA
  5604*          IF PRTSWI = ' '
  5605              MOVE 'P'         TO PRTSWI
  5606*          END-IF
  5607*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page  99
* EL6317.cbl
  5608        END-IF
  5609     END-IF
  5610     IF (SIGREQL > ZEROS)
  5611        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5612        MOVE AL-UANON         TO SIGREQA
  5613        IF SIGREQI = ' '
  5614           MOVE 'N'           TO SIGREQI
  5615        END-IF
  5616        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5617     ELSE
  5618        MOVE ER-2651          TO EMI-ERROR
  5619        MOVE -1               TO SIGREQL
  5620        MOVE AL-UABON         TO SIGREQA
  5621        PERFORM 9900-ERROR-FORMAT
  5622                                 THRU 9900-EXIT
  5623     END-IF
  5624     IF LTRIDL > ZEROS
  5625        AND LTRIDI > SPACES
  5626        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5627        MOVE LTRIDI              TO LETR-LETTER-ID
  5628                                    PI-LTRID-ENTERED
  5629        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5630        MOVE SPACES              TO LETR-FILLER
  5631        MOVE 0                   TO LETR-SEQ-NO
  5632        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5633     ELSE
  5634        MOVE ER-1236          TO EMI-ERROR
  5635        MOVE -1               TO LTRIDL
  5636        MOVE AL-UABON         TO LTRIDA
  5637        PERFORM 9900-ERROR-FORMAT
  5638                                 THRU 9900-EXIT
  5639     END-IF
  5640
  5641     IF W-PROMPT-LETTER EQUAL 'Y'
  5642         MOVE ER-0894            TO EMI-ERROR
  5643         MOVE -1                 TO LTRIDL
  5644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5645     END-IF
  5646     SET REASONS-NOT-FOUND TO TRUE
  5647     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5648        IF REACDL (S1) = +4 OR
  5649          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5650              MOVE AL-SANON     TO REACDA (S1)
  5651              SET REASONS-FOUND TO TRUE
  5652        END-IF
  5653     END-PERFORM
  5654
  5655     IF REASONS-NOT-FOUND
  5656        MOVE ER-1820             TO EMI-ERROR
  5657        MOVE -1                  TO PFENTRL
  5658        PERFORM 9900-ERROR-FORMAT
  5659                                 THRU 9900-EXIT
  5660     ELSE
  5661        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5662     END-IF
  5663
  5664     IF CRTNT1L > ZEROS
  5665        IF CRTNT1I > SPACES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 100
* EL6317.cbl
  5666           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5667        END-IF
  5668     END-IF
  5669
  5670     IF CRTNT2L > ZEROS
  5671        IF CRTNT2I > SPACES
  5672           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5673        END-IF
  5674     END-IF
  5675
  5676     IF BILNT1L > ZEROS
  5677        IF BILNT1I > SPACES
  5678           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5679        END-IF
  5680     END-IF
  5681
  5682     IF BILNT2L > ZEROS
  5683        IF BILNT2I > SPACES
  5684           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  5685        END-IF
  5686     END-IF
  5687
  5688     .
  5689 0325-EXIT.
  5690     EXIT.
  5691
  5692 0326-GET-Z-RECORD.
  5693
  5694     MOVE SPACES  TO W-Z-CONTROL-DATA
  5695
  5696
  5697* EXEC CICS STARTBR
  5698*         DATASET    ('ELLETR')
  5699*         RIDFLD     (ELLETR-KEY)
  5700*         GTEQ
  5701*         RESP      (WS-RESPONSE)
  5702*    END-EXEC.
  5703     MOVE 'ELLETR' TO DFHEIV1
  5704     MOVE 0
  5705       TO DFHEIV11
  5706*    MOVE '&,         G          &  N#00005676' TO DFHEIV0
  5707     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5708     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5709     MOVE X'204E233030303035363736' TO DFHEIV0(25:11)
  5710     CALL 'kxdfhei1' USING DFHEIV0,
  5711           DFHEIV1,
  5712           ELLETR-KEY,
  5713           DFHEIV99,
  5714           DFHEIV11,
  5715           DFHEIV99
  5716     MOVE EIBRESP  TO WS-RESPONSE
  5717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5718
  5719     IF NOT RESP-NORMAL
  5720         MOVE ER-1236          TO EMI-ERROR
  5721         MOVE -1               TO LTRIDL
  5722         MOVE AL-UABON         TO LTRIDA
  5723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 101
* EL6317.cbl
  5724         GO TO 0326-ENDBR
  5725     END-IF.
  5726
  5727 0326-READNEXT.
  5728
  5729
  5730* EXEC CICS READNEXT
  5731*        DATASET   ('ELLETR')
  5732*        INTO      (TEXT-FILES)
  5733*        RIDFLD    (ELLETR-KEY)
  5734*        RESP      (WS-RESPONSE)
  5735*    END-EXEC
  5736     MOVE LENGTH OF
  5737      TEXT-FILES
  5738       TO DFHEIV12
  5739     MOVE 'ELLETR' TO DFHEIV1
  5740     MOVE 0
  5741       TO DFHEIV11
  5742*    MOVE '&.IL                  )  N#00005692' TO DFHEIV0
  5743     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5744     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5745     MOVE X'204E233030303035363932' TO DFHEIV0(25:11)
  5746     CALL 'kxdfhei1' USING DFHEIV0,
  5747           DFHEIV1,
  5748           TEXT-FILES,
  5749           DFHEIV12,
  5750           ELLETR-KEY,
  5751           DFHEIV99,
  5752           DFHEIV11,
  5753           DFHEIV99,
  5754           DFHEIV99
  5755     MOVE EIBRESP  TO WS-RESPONSE
  5756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5757     IF RESP-NORMAL
  5758        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5759           MOVE ER-1236          TO EMI-ERROR
  5760           MOVE -1               TO LTRIDL
  5761           MOVE AL-UABON         TO LTRIDA
  5762           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5763           GO TO 0326-ENDBR
  5764        END-IF
  5765
  5766        MOVE AL-UANON         TO LTRIDA
  5767        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5768           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5769        ELSE
  5770           GO TO 0326-READNEXT
  5771        END-IF
  5772     ELSE
  5773        MOVE ER-1236          TO EMI-ERROR
  5774        MOVE -1               TO LTRIDL
  5775        MOVE AL-UABON         TO LTRIDA
  5776        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5777        GO TO 0326-ENDBR
  5778     END-IF.
  5779
  5780 0326-ENDBR.
  5781
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 102
* EL6317.cbl
  5782
  5783* EXEC CICS ENDBR
  5784*        DATASET     ('ELLETR')
  5785*    END-EXEC.
  5786     MOVE 'ELLETR' TO DFHEIV1
  5787     MOVE 0
  5788       TO DFHEIV11
  5789*    MOVE '&2                    $   #00005723' TO DFHEIV0
  5790     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5791     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5792     MOVE X'2020233030303035373233' TO DFHEIV0(25:11)
  5793     CALL 'kxdfhei1' USING DFHEIV0,
  5794           DFHEIV1,
  5795           DFHEIV11,
  5796           DFHEIV99
  5797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5798
  5799
  5800 0326-EXIT.
  5801      EXIT.
  5802 0330-CHECK-ERRORS.
  5803     IF EMI-NO-ERRORS
  5804        GO TO 0350-BUILD-INIT-MAP
  5805     ELSE
  5806        GO TO 8200-SEND-DATAONLY
  5807     END-IF
  5808     .
  5809 0330-EXIT.
  5810     EXIT.
  5811 0350-BUILD-INIT-MAP.
  5812
  5813     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  5814        display 'coming from el1273 '
  5815        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  5816        MOVE PI-CARRIER             TO CRTO-CARRIER
  5817        MOVE PI-GROUPING            TO CRTO-GROUPING
  5818        MOVE PI-STATE               TO CRTO-STATE
  5819        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  5820        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  5821        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  5822        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  5823        MOVE 'I'                    TO CRTO-RECORD-TYPE
  5824        MOVE ZEROS                  TO CRTO-SEQ-NO
  5825        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  5826                                       PI-ERENDT-KEY
  5827     END-IF
  5828     MOVE PI-CRTO-CARRIER        TO CARRO
  5829     MOVE PI-CRTO-GROUPING       TO GROUPO
  5830     MOVE PI-CRTO-STATE          TO STATEO
  5831     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  5832     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  5833     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  5834     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  5835     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  5836     MOVE ' '                    TO DC-OPTION-CODE
  5837     PERFORM 9700-DATE-LINK
  5838     IF NO-CONVERSION-ERROR
  5839        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 103
* EL6317.cbl
  5840     END-IF
  5841
  5842*    IF PI-PRTSW-ENTERED > SPACES
  5843*       MOVE PI-PRTSW-ENTERED    TO PRTSWI
  5844*       MOVE AL-UANON            TO PRTSWA
  5845*       MOVE +1                  TO PRTSWL
  5846*    END-IF
  5847
  5848     IF PI-SIGREQ-ENTERED > SPACES
  5849        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  5850        MOVE AL-UANON            TO SIGREQA
  5851        MOVE +1                  TO SIGREQL
  5852     END-IF
  5853
  5854     IF PI-LTRID-ENTERED > SPACES
  5855        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5856        MOVE AL-UANON            TO LTRIDA
  5857        MOVE +4                  TO LTRIDL
  5858     END-IF
  5859
  5860     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5861     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5862        IF REACDL (S1) = +4 OR
  5863          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5864              MOVE AL-SANON      TO REACDA (S1)
  5865              MOVE +4            TO REACDL (S1)
  5866              SET REASONS-FOUND  TO TRUE
  5867        END-IF
  5868     END-PERFORM
  5869
  5870     IF PI-CERTNT1-ENTERED > SPACES
  5871        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5872        MOVE AL-UANON            TO CRTNT1A
  5873        MOVE +63                 TO CRTNT1L
  5874     END-IF
  5875
  5876     IF PI-CERTNT2-ENTERED > SPACES
  5877        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5878        MOVE AL-UANON            TO CRTNT2A
  5879        MOVE +63                 TO CRTNT2L
  5880     END-IF
  5881
  5882     IF PI-BILLNT1-ENTERED > SPACES
  5883        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  5884        MOVE AL-UANON            TO BILNT1A
  5885        MOVE +63                 TO BILNT1L
  5886     END-IF
  5887
  5888     IF PI-BILLNT2-ENTERED > SPACES
  5889        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  5890        MOVE AL-UANON            TO BILNT2A
  5891        MOVE +63                 TO BILNT2L
  5892     END-IF
  5893
  5894     GO TO 8100-SEND-INITIAL-MAP
  5895     .
  5896 0360-FINALIZE.
  5897     display ' made it to 0360 '
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 104
* EL6317.cbl
  5898     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  5899     IF NOT EMI-NO-ERRORS
  5900       AND EIBAID = DFHPF4
  5901        GO TO 8200-SEND-DATAONLY
  5902     END-IF
  5903     set P to address of KIXSYS
  5904     CALL "getenv" using by value P returning var-ptr
  5905     if var-ptr = null then
  5906        display ' kixsys not set '
  5907     else
  5908        set address of var to var-ptr
  5909        move 0 to env-var-len
  5910        inspect var tallying env-var-len
  5911          for characters before X'00'
  5912*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  5913        unstring var (1:env-var-len) delimited by '/'
  5914           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5915              WS-KIX-SYS
  5916        end-unstring
  5917*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  5918*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  5919     end-if
  5920     set P to address of KIXHOST
  5921     CALL "getenv" using by value P returning var-ptr
  5922     if var-ptr = null then
  5923        display ' kixhost not set '
  5924     else
  5925        set address of var to var-ptr
  5926        move 0 to env-var-len
  5927        inspect var tallying env-var-len
  5928          for characters before X'00'
  5929*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  5930        MOVE var(1:env-var-len)  to ws-kixhost
  5931        DISPLAY ' WS KIX HOST ' WS-KIXhost
  5932     end-if
  5933     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  5934     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  5935     IF RESP-NORMAL
  5936        AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  5937        DISPLAY ' RESP NORMAL AND = '
  5938        MOVE OC-KEY-SEQ-NO  TO CRTO-SEQ-NO
  5939                               PI-CRTO-SEQ-NO
  5940        MOVE LOW-VALUES     TO NEW-ELCRTO-REC
  5941        MOVE PI-ELCRTO-KEY  TO NEW-ELCRTO-KEY
  5942        SUBTRACT +1         FROM NCRTO-SEQ-NO
  5943        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  5944*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  5945        PERFORM 1100-CALL-NS-BUS-LOGIC
  5946                                 THRU 1100-EXIT
  5947        IF BL-OK
  5948           CONTINUE
  5949        ELSE
  5950           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  5951           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  5952           MOVE -1               TO CARRL
  5953        END-IF
  5954     ELSE
  5955        MOVE ER-9999             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 105
* EL6317.cbl
  5956        PERFORM 9900-ERROR-FORMAT
  5957                                 THRU 9900-EXIT
  5958        MOVE -1                  TO CARRL
  5959        GO TO 8100-SEND-INITIAL-MAP
  5960     END-IF
  5961     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  5962                                 TO SYSO
  5963     MOVE WS-KIXHOST             TO HOSTO
  5964     MOVE PI-COMPANY-ID          TO COMPANYO
  5965     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  5966         MOVE '2'                TO DATASORO
  5967     ELSE
  5968         MOVE '4'                TO DATASORO
  5969     END-IF
  5970     MOVE BL-BATCH-NO            TO BATCHNOO
  5971     MOVE BL-BATCH-SEQ           TO BSEQNOO
  5972     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  5973     MOVE PI-PROCESSOR-ID        TO PROCIDO
  5974*    MOVE -1                     TO PRTSWL
  5975*    MOVE AL-UANON               TO PRTSWA
  5976     MOVE -1                     TO SIGREQL
  5977     MOVE AL-UANON               TO SIGREQA
  5978     IF EIBAID = DFHPF4
  5979        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  5980        MOVE ER-0280             TO EMI-ERROR
  5981        PERFORM 9900-ERROR-FORMAT
  5982                                 THRU 9900-EXIT
  5983        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  5984        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  5985        MOVE 'Y'                 TO PI-FINALIZED-IND
  5986        GO TO 9400-CLEAR
  5987     ELSE
  5988        MOVE ER-1818             TO EMI-ERROR
  5989        PERFORM 9900-ERROR-FORMAT
  5990                                 THRU 9900-EXIT
  5991     END-IF
  5992     GO TO 0350-BUILD-INIT-MAP
  5993     .
  5994 0360-EXIT.
  5995     EXIT.
  5996 0362-READ-ELCRTO.
  5997     display ' made it to 0362 '
  5998
  5999* EXEC CICS READ
  6000*        DATASET   (WS-ELCRTO-FILE-ID)
  6001*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6002*        RIDFLD    (ELCRTO-KEY)
  6003*        GTEQ
  6004*        RESP      (WS-RESPONSE)
  6005*    END-EXEC
  6006*    MOVE '&"S        G          (  N#00005925' TO DFHEIV0
  6007     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6009     MOVE X'204E233030303035393235' TO DFHEIV0(25:11)
  6010     CALL 'kxdfhei1' USING DFHEIV0,
  6011           WS-ELCRTO-FILE-ID,
  6012           DFHEIV20,
  6013           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 106
* EL6317.cbl
  6014           ELCRTO-KEY,
  6015           DFHEIV99,
  6016           DFHEIV99,
  6017           DFHEIV99
  6018     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6019         DFHEIV20
  6020     MOVE EIBRESP  TO WS-RESPONSE
  6021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6022     .
  6023 0362-EXIT.
  6024     EXIT.
  6025 0363-READ-ELCRTO-UPD.
  6026     display ' made it to 0363 '
  6027
  6028* EXEC CICS READ
  6029*        DATASET   (WS-ELCRTO-FILE-ID)
  6030*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6031*        RIDFLD    (ELCRTO-KEY)
  6032*        UPDATE
  6033*        RESP      (WS-RESPONSE)
  6034*    END-EXEC
  6035*    MOVE '&"S        EU         (  N#00005937' TO DFHEIV0
  6036     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6037     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6038     MOVE X'204E233030303035393337' TO DFHEIV0(25:11)
  6039     CALL 'kxdfhei1' USING DFHEIV0,
  6040           WS-ELCRTO-FILE-ID,
  6041           DFHEIV20,
  6042           DFHEIV99,
  6043           ELCRTO-KEY,
  6044           DFHEIV99,
  6045           DFHEIV99,
  6046           DFHEIV99
  6047     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6048         DFHEIV20
  6049     MOVE EIBRESP  TO WS-RESPONSE
  6050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6051     .
  6052 0363-EXIT.
  6053     EXIT.
  6054 0365-READ-ERENDT.
  6055
  6056* EXEC CICS READ
  6057*        DATASET   (WS-ERENDT-FILE-ID)
  6058*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6059*        RIDFLD    (ERENDT-KEY)
  6060*        RESP      (WS-RESPONSE)
  6061*    END-EXEC
  6062*    MOVE '&"S        E          (  N#00005948' TO DFHEIV0
  6063     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6064     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6065     MOVE X'204E233030303035393438' TO DFHEIV0(25:11)
  6066     CALL 'kxdfhei1' USING DFHEIV0,
  6067           WS-ERENDT-FILE-ID,
  6068           DFHEIV20,
  6069           DFHEIV99,
  6070           ERENDT-KEY,
  6071           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 107
* EL6317.cbl
  6072           DFHEIV99,
  6073           DFHEIV99
  6074     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6075         DFHEIV20
  6076     MOVE EIBRESP  TO WS-RESPONSE
  6077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6078     .
  6079 0365-EXIT.
  6080     EXIT.
  6081 0400-ADD-ERENDT.
  6082     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6083     display ' made it to 0400 '
  6084
  6085* EXEC CICS GETMAIN
  6086*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6087*         LENGTH   (ERENDT-LENGTH)
  6088*         INITIMG  (GETMAIN-SPACE)
  6089*    END-EXEC
  6090*    MOVE ',"IL                  $   #00005960' TO DFHEIV0
  6091     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6092     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6093     MOVE X'2020233030303035393630' TO DFHEIV0(25:11)
  6094     CALL 'kxdfhei1' USING DFHEIV0,
  6095           DFHEIV20,
  6096           ERENDT-LENGTH,
  6097           GETMAIN-SPACE
  6098     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6099         DFHEIV20
  6100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6101     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6102     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6103     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6104     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6105                                    EN-INPUT-DT
  6106                                    EN-PROCESS-DT
  6107
  6108     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6109     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6110     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6111     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6112     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6113     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6114     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6115     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6116     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6117     IF OC-LF-BENCD NOT = '00' AND '  '
  6118        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6119        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6120        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6121        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6122        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6123        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6124        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6125     END-IF
  6126     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6127     IF OC-AH-BENCD NOT = '00' AND '  '
  6128        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6129        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 108
* EL6317.cbl
  6130        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6131        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6132        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6133        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6134     END-IF
  6135     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6136
  6137     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6138         display 'from el1273, using crto for new crto'
  6139
  6140        MOVE OC-INS-FIRST-NAME    TO EN-INS-NEW-FIRST-NAME
  6141                                     NCRTO-INS-FIRST-NAME
  6142        MOVE OC-INS-MIDDLE-INIT   TO EN-INS-NEW-MIDDLE-INIT
  6143                                     NCRTO-INS-MIDDLE-INIT
  6144        MOVE OC-INS-LAST-NAME     TO EN-INS-NEW-LAST-NAME
  6145                                     NCRTO-INS-LAST-NAME
  6146        MOVE OC-INS-AGE           TO EN-INS-NEW-AGE
  6147                                     NCRTO-INS-AGE
  6148        MOVE OC-JNT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6149                                     NCRTO-JNT-FIRST-NAME
  6150        MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6151                                     NCRTO-JNT-MIDDLE-INIT
  6152        MOVE OC-JNT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6153                                     NCRTO-JNT-LAST-NAME
  6154        MOVE OC-JNT-AGE           TO EN-JNT-NEW-AGE
  6155                                     NCRTO-JNT-AGE
  6156        MOVE OC-LF-BENCD          TO EN-LF-NEW-BENCD
  6157                                     NCRTO-LF-BENCD
  6158        IF OC-LF-BENCD NOT = '00' AND '  '
  6159           MOVE OC-LF-BEN-AMT       TO EN-LF-NEW-BEN-AMT
  6160                                       NCRTO-LF-BEN-AMT
  6161           MOVE OC-LF-PRM-AMT       TO EN-LF-NEW-PRM-AMT
  6162                                       NCRTO-LF-PRM-AMT
  6163           MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-NEW-ALT-BEN-AMT
  6164                                       NCRTO-LF-ALT-BEN-AMT
  6165           MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-NEW-ALT-PRM-AMT
  6166                                       NCRTO-LF-ALT-PRM-AMT
  6167           MOVE OC-LF-TERM          TO EN-LF-NEW-TERM
  6168                                       NCRTO-LF-TERM
  6169           MOVE OC-LF-EXP-DT        TO EN-LF-NEW-EXP-DT
  6170                                       NCRTO-LF-EXP-DT
  6171           MOVE OC-LF-COMM-PCT      TO EN-LF-NEW-COMM-PCT
  6172                                       NCRTO-LF-COMM-PCT
  6173           MOVE OC-LF-CANCEL-DT     TO NCRTO-LF-CANCEL-DT
  6174           MOVE OC-LF-CANCEL-AMT    TO NCRTO-LF-CANCEL-AMT
  6175           MOVE OC-LF-ITD-CANCEL-AMT TO NCRTO-LF-ITD-CANCEL-AMT
  6176        END-IF
  6177        MOVE OC-AH-BENCD          TO EN-AH-NEW-BENCD
  6178                                     NCRTO-AH-BENCD
  6179        IF OC-AH-BENCD NOT = '00' AND '  '
  6180           MOVE OC-AH-BEN-AMT       TO EN-AH-NEW-BEN-AMT
  6181                                       NCRTO-AH-BEN-AMT
  6182           MOVE OC-AH-PRM-AMT       TO EN-AH-NEW-PRM-AMT
  6183                                       NCRTO-AH-PRM-AMT
  6184           MOVE OC-AH-TERM          TO EN-AH-NEW-TERM
  6185                                       NCRTO-AH-TERM
  6186           MOVE OC-AH-EXP-DT        TO EN-AH-NEW-EXP-DT
  6187                                       NCRTO-AH-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 109
* EL6317.cbl
  6188           MOVE OC-AH-CP            TO EN-AH-NEW-CP
  6189                                       NCRTO-AH-CP
  6190           MOVE OC-AH-COMM-PCT      TO EN-AH-NEW-COMM-PCT
  6191                                       NCRTO-AH-COMM-PCT
  6192           MOVE OC-AH-CANCEL-DT     TO NCRTO-AH-CANCEL-DT
  6193           MOVE OC-AH-CANCEL-AMT    TO NCRTO-AH-CANCEL-AMT
  6194           MOVE OC-AH-ITD-CANCEL-AMT TO NCRTO-AH-ITD-CANCEL-AMT
  6195        END-IF
  6196        MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6197                                       NCRTO-CRED-BENE-NAME
  6198
  6199        GO TO 0400-WRITE-ENDT
  6200     END-IF
  6201
  6202* EXEC CICS GETMAIN
  6203*         SET      (ADDRESS OF PENDING-BUSINESS)
  6204*         LENGTH   (ERPNDB-LENGTH)
  6205*         INITIMG  (GETMAIN-SPACE)
  6206*    END-EXEC
  6207*    MOVE ',"IL                  $   #00006065' TO DFHEIV0
  6208     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6209     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6210     MOVE X'2020233030303036303635' TO DFHEIV0(25:11)
  6211     CALL 'kxdfhei1' USING DFHEIV0,
  6212           DFHEIV20,
  6213           ERPNDB-LENGTH,
  6214           GETMAIN-SPACE
  6215     SET ADDRESS OF PENDING-BUSINESS TO
  6216         DFHEIV20
  6217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6218     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6219     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6220
  6221* EXEC CICS READ
  6222*        DATASET   (WS-ERPNDB-FILE-ID)
  6223*        INTO      (PENDING-BUSINESS)
  6224*        RIDFLD    (ERPNDB-KEY)
  6225*        RESP      (WS-RESPONSE)
  6226*    END-EXEC
  6227     MOVE LENGTH OF
  6228      PENDING-BUSINESS
  6229       TO DFHEIV11
  6230*    MOVE '&"IL       E          (  N#00006072' TO DFHEIV0
  6231     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6232     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6233     MOVE X'204E233030303036303732' TO DFHEIV0(25:11)
  6234     CALL 'kxdfhei1' USING DFHEIV0,
  6235           WS-ERPNDB-FILE-ID,
  6236           PENDING-BUSINESS,
  6237           DFHEIV11,
  6238           ERPNDB-KEY,
  6239           DFHEIV99,
  6240           DFHEIV99,
  6241           DFHEIV99
  6242     MOVE EIBRESP  TO WS-RESPONSE
  6243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6244     IF NOT RESP-NORMAL
  6245        GO TO 0400-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 110
* EL6317.cbl
  6246     END-IF
  6247*    set found-pndb to true
  6248     display ' good read on erpndb '
  6249     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6250                                      NCRTO-INS-FIRST-NAME
  6251     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6252                                      NCRTO-INS-MIDDLE-INIT
  6253     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6254                                      NCRTO-INS-LAST-NAME
  6255     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6256                                      NCRTO-INS-AGE
  6257     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6258                                      NCRTO-JNT-FIRST-NAME
  6259     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6260                                      NCRTO-JNT-MIDDLE-INIT
  6261     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6262                                      NCRTO-JNT-LAST-NAME
  6263     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6264                                      NCRTO-JNT-AGE
  6265     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6266                                      NCRTO-LF-BENCD
  6267     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6268        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6269                                      NCRTO-LF-BEN-AMT
  6270        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6271                                      NCRTO-LF-PRM-AMT
  6272        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6273                                      NCRTO-LF-ALT-BEN-AMT
  6274        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6275                                      NCRTO-LF-ALT-PRM-AMT
  6276        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6277                                      NCRTO-LF-TERM
  6278        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6279                                      NCRTO-LF-EXP-DT
  6280        IF PB-I-JOINT-COMMISSION > +0
  6281           MOVE PB-I-JOINT-COMMISSION
  6282                                   TO EN-LF-NEW-COMM-PCT
  6283                                      NCRTO-LF-COMM-PCT
  6284        ELSE
  6285           MOVE PB-I-LIFE-COMMISSION
  6286                                   TO EN-LF-NEW-COMM-PCT
  6287                                      NCRTO-LF-COMM-PCT
  6288        MOVE LOW-VALUES            TO NCRTO-LF-CANCEL-DT
  6289        MOVE +0                    TO NCRTO-LF-CANCEL-AMT
  6290                                      NCRTO-LF-ITD-CANCEL-AMT
  6291        END-IF
  6292     END-IF
  6293     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6294                                      NCRTO-AH-BENCD
  6295     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6296        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6297                                      NCRTO-AH-BEN-AMT
  6298        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6299                                      NCRTO-AH-PRM-AMT
  6300        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6301                                      NCRTO-AH-TERM
  6302        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6303                                      NCRTO-AH-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 111
* EL6317.cbl
  6304        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6305                                      NCRTO-AH-CP
  6306        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6307                                      NCRTO-AH-COMM-PCT
  6308        MOVE LOW-VALUES            TO NCRTO-AH-CANCEL-DT
  6309        MOVE +0                    TO NCRTO-AH-CANCEL-AMT
  6310                                      NCRTO-AH-ITD-CANCEL-AMT
  6311     END-IF
  6312     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6313     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6314     move pb-control-by-account (1:33)
  6315                                 to ws-ermail-key
  6316
  6317* EXEC CICS READ
  6318*        DATASET   ('ERMAIL')
  6319*        SET       (ADDRESS OF MAILING-DATA)
  6320*        RIDFLD    (WS-ERMAIL-KEY)
  6321*        RESP      (WS-RESPONSE)
  6322*    END-EXEC
  6323     MOVE 'ERMAIL' TO DFHEIV1
  6324*    MOVE '&"S        E          (  N#00006150' TO DFHEIV0
  6325     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6327     MOVE X'204E233030303036313530' TO DFHEIV0(25:11)
  6328     CALL 'kxdfhei1' USING DFHEIV0,
  6329           DFHEIV1,
  6330           DFHEIV20,
  6331           DFHEIV99,
  6332           WS-ERMAIL-KEY,
  6333           DFHEIV99,
  6334           DFHEIV99,
  6335           DFHEIV99
  6336     SET ADDRESS OF MAILING-DATA TO
  6337         DFHEIV20
  6338     MOVE EIBRESP  TO WS-RESPONSE
  6339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6340     IF RESP-NORMAL
  6341        DISPLAY ' FOUND ERMAIL '
  6342        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6343                                    NCRTO-CRED-BENE-NAME
  6344     ELSE
  6345        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6346     END-IF
  6347      .
  6348 0400-WRITE-ENDT.
  6349
  6350     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6351        IF REACD-IN (S1) NOT = LOW-VALUES
  6352           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6353        END-IF
  6354     END-PERFORM
  6355     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6356     MOVE 'V'                    TO EN-DOCU-TYPE
  6357     MOVE ' '                    TO EN-MONEY-SW
  6358     MOVE SIGREQI                TO EN-SIG-SW
  6359     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6360     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6361     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 112
* EL6317.cbl
  6362*    IF NOT EMI-NO-ERRORS
  6363*       DISPLAY ' GOING TO 8200 FROM 0400 '
  6364*       GO TO 8200-SEND-DATAONLY
  6365*    END-IF
  6366     DISPLAY ' 0400 EXIT '
  6367     .
  6368 0400-EXIT.
  6369     EXIT.
  6370 0410-INIT-ERENDT.
  6371     display ' made it to 0410 '
  6372     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6373     MOVE ZEROS                  TO ENDT-SEQ-NO
  6374
  6375* EXEC CICS READ
  6376*        DATASET    (WS-ERENDT-FILE-ID)
  6377*        RIDFLD     (ERENDT-KEY)
  6378*        INTO       (ENDORSEMENT-RECORD)
  6379*        RESP       (WS-RESPONSE)
  6380*        GTEQ
  6381*    END-EXEC
  6382     MOVE LENGTH OF
  6383      ENDORSEMENT-RECORD
  6384       TO DFHEIV11
  6385*    MOVE '&"IL       G          (  N#00006190' TO DFHEIV0
  6386     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6388     MOVE X'204E233030303036313930' TO DFHEIV0(25:11)
  6389     CALL 'kxdfhei1' USING DFHEIV0,
  6390           WS-ERENDT-FILE-ID,
  6391           ENDORSEMENT-RECORD,
  6392           DFHEIV11,
  6393           ERENDT-KEY,
  6394           DFHEIV99,
  6395           DFHEIV99,
  6396           DFHEIV99
  6397     MOVE EIBRESP  TO WS-RESPONSE
  6398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6399     IF RESP-NORMAL
  6400        AND (EN-CONTROL-PRIMARY (1:34) =
  6401           OC-CONTROL-PRIMARY (1:34))
  6402        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6403     ELSE
  6404        MOVE +4096               TO WS-SEQ-NO
  6405     END-IF
  6406     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6407     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6408     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6409     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6410     INITIALIZE EN-ISSUE-RECORD
  6411     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6412                                    EN-AH-ORIG-EXP-DT
  6413                                    EN-LF-NEW-EXP-DT
  6414                                    EN-AH-NEW-EXP-DT
  6415                                    EN-PROCESS-DT
  6416     .
  6417 0410-EXIT.
  6418     EXIT.
  6419 0420-UPDATE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 113
* EL6317.cbl
  6420     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6421     IF RESP-NORMAL
  6422        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6423                                    OC-LAST-MAINT-DT
  6424        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6425        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6426
  6427* EXEC CICS REWRITE
  6428*          FROM     (ORIGINAL-CERTIFICATE)
  6429*          DATASET  ('ELCRTO')
  6430*       END-EXEC
  6431     MOVE LENGTH OF
  6432      ORIGINAL-CERTIFICATE
  6433       TO DFHEIV11
  6434     MOVE 'ELCRTO' TO DFHEIV1
  6435*    MOVE '&& L                  %   #00006224' TO DFHEIV0
  6436     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6437     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6438     MOVE X'2020233030303036323234' TO DFHEIV0(25:11)
  6439     CALL 'kxdfhei1' USING DFHEIV0,
  6440           DFHEIV1,
  6441           ORIGINAL-CERTIFICATE,
  6442           DFHEIV11,
  6443           DFHEIV99
  6444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6445     END-IF
  6446     .
  6447 0420-EXIT.
  6448     EXIT.
  6449
  6450 0425-ADD-NEW-ELCRTO.
  6451     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6452     MOVE 'OC'                   TO OC-RECORD-ID
  6453     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6454     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6455     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6456     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6457     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6458     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6459     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6460     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6461     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6462     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6463     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6464     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6465     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6466     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6467     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6468     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6469     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6470     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6471     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6472     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6473     MOVE NCRTO-LF-CANCEL-DT     TO OC-LF-CANCEL-DT
  6474     MOVE NCRTO-LF-CANCEL-AMT    TO OC-LF-CANCEL-AMT
  6475     MOVE NCRTO-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
  6476     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6477     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 114
* EL6317.cbl
  6478     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6479     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6480     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6481     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6482     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6483     MOVE NCRTO-AH-CANCEL-DT     TO OC-AH-CANCEL-DT
  6484     MOVE NCRTO-AH-CANCEL-AMT    TO OC-AH-CANCEL-AMT
  6485     MOVE NCRTO-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
  6486     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6487     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6488     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6489     .
  6490 0425-WRITE-ELCRTO.
  6491
  6492
  6493* EXEC CICS WRITE
  6494*       DATASET   ('ELCRTO')
  6495*       FROM      (ORIGINAL-CERTIFICATE)
  6496*       RIDFLD    (OC-CONTROL-PRIMARY)
  6497*       RESP      (WS-RESPONSE)
  6498*    END-EXEC
  6499     MOVE LENGTH OF
  6500      ORIGINAL-CERTIFICATE
  6501       TO DFHEIV11
  6502     MOVE 'ELCRTO' TO DFHEIV1
  6503*    MOVE '&$ L                  ''  N#00006275' TO DFHEIV0
  6504     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6506     MOVE X'204E233030303036323735' TO DFHEIV0(25:11)
  6507     CALL 'kxdfhei1' USING DFHEIV0,
  6508           DFHEIV1,
  6509           ORIGINAL-CERTIFICATE,
  6510           DFHEIV11,
  6511           OC-CONTROL-PRIMARY,
  6512           DFHEIV99,
  6513           DFHEIV99
  6514     MOVE EIBRESP  TO WS-RESPONSE
  6515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6516
  6517     display ' just wrote new crto ' ws-response
  6518                           ' ' oc-key-seq-no
  6519     IF RESP-DUPKEY
  6520        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6521        GO TO 0425-WRITE-ELCRTO
  6522     ELSE
  6523        IF NOT RESP-NORMAL
  6524           MOVE -1               TO SIGREQL
  6525           MOVE ER-3830          TO EMI-ERROR
  6526           PERFORM 9900-ERROR-FORMAT
  6527                                 THRU 9900-EXIT
  6528        ELSE
  6529           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6530        END-IF
  6531     END-IF
  6532
  6533     .
  6534 0425-EXIT.
  6535     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 115
* EL6317.cbl
  6536
  6537 0426-ADD-CERT-NOTES.
  6538
  6539     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6540     SET TB-INDX TO 1
  6541
  6542     IF PI-CERTNT1-ENTERED > SPACES
  6543         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6544         MOVE PI-PROCESSOR-ID    TO
  6545                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6546         MOVE EIBTIME            TO
  6547                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6548         MOVE WS-CURRENT-BIN-DT  TO
  6549                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6550         SET TB-INDX UP BY +1
  6551     END-IF
  6552
  6553     IF PI-CERTNT2-ENTERED > SPACES
  6554         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6555         MOVE PI-PROCESSOR-ID    TO
  6556                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6557         MOVE EIBTIME            TO
  6558                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6559         MOVE WS-CURRENT-BIN-DT  TO
  6560                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6561         SET TB-INDX UP BY +1
  6562     END-IF
  6563
  6564     IF CERT-NOTE-ENTRIES > SPACES
  6565         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6566         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6567     END-IF
  6568
  6569     IF PI-BILLNT1-ENTERED > SPACES
  6570         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6571         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6572         MOVE +63 TO WS-LEN
  6573         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6574     END-IF
  6575
  6576     IF PI-BILLNT2-ENTERED > SPACES
  6577         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6578         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6579         MOVE +63 TO WS-LEN
  6580         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6581     END-IF
  6582
  6583     .
  6584 0426-EXIT.
  6585     EXIT.
  6586
  6587 0427-LOAD-CURRENT-CERT-NOTES.
  6588
  6589     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6590     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6591     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6592     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6593     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 116
* EL6317.cbl
  6594     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6595     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6596     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6597     MOVE '1'                 TO ERCNOT-REC-TYP
  6598     MOVE +0                  TO ERCNOT-SEQ
  6599     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6600
  6601
  6602* EXEC CICS STARTBR
  6603*         DATASET(WS-ERCNOT-FILE-ID)
  6604*         RIDFLD(ERCNOT-KEY)
  6605*         KEYLENGTH(ERCNOT-START-LENGTH)
  6606*         RESP      (WS-RESPONSE)
  6607*         GENERIC
  6608*         GTEQ
  6609*    END-EXEC.
  6610     MOVE 0
  6611       TO DFHEIV11
  6612*    MOVE '&,   KG    G          &  N#00006366' TO DFHEIV0
  6613     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6614     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6615     MOVE X'204E233030303036333636' TO DFHEIV0(25:11)
  6616     CALL 'kxdfhei1' USING DFHEIV0,
  6617           WS-ERCNOT-FILE-ID,
  6618           ERCNOT-KEY,
  6619           ERCNOT-START-LENGTH,
  6620           DFHEIV11,
  6621           DFHEIV99
  6622     MOVE EIBRESP  TO WS-RESPONSE
  6623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6624
  6625
  6626     IF NOT RESP-NORMAL
  6627        GO TO 0427-ENDBR
  6628     END-IF.
  6629
  6630 0427-LOOP.
  6631
  6632* EXEC CICS READNEXT
  6633*         SET(ADDRESS OF CERT-NOTE-FILE)
  6634*         DATASET(WS-ERCNOT-FILE-ID)
  6635*         RIDFLD(ERCNOT-KEY)
  6636*    END-EXEC.
  6637     MOVE 0
  6638       TO DFHEIV11
  6639*    MOVE '&.S                   )   #00006380' TO DFHEIV0
  6640     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6641     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6642     MOVE X'2020233030303036333830' TO DFHEIV0(25:11)
  6643     CALL 'kxdfhei1' USING DFHEIV0,
  6644           WS-ERCNOT-FILE-ID,
  6645           DFHEIV20,
  6646           DFHEIV99,
  6647           ERCNOT-KEY,
  6648           DFHEIV99,
  6649           DFHEIV11,
  6650           DFHEIV99,
  6651           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 117
* EL6317.cbl
  6652     SET ADDRESS OF CERT-NOTE-FILE TO
  6653         DFHEIV20
  6654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6655
  6656
  6657     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6658         GO TO 0427-ENDBR
  6659     END-IF.
  6660
  6661     IF (CZ-CARRIER = SV-CARRIER)
  6662        AND (CZ-GROUPING = SV-GROUPING)
  6663        AND (CZ-STATE = SV-STATE)
  6664        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6665        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6666        AND (CZ-CERT-NO = SV-CERT-NO)
  6667        AND (CZ-RECORD-TYPE = '1')
  6668          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6669          MOVE CZ-LAST-MAINT-USER TO
  6670                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6671          MOVE CZ-LAST-MAINT-DT TO
  6672                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6673          MOVE CZ-LAST-MAINT-HHMMSS TO
  6674                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6675          SET TB-INDX UP BY 1
  6676          GO TO 0427-LOOP
  6677     END-IF.
  6678
  6679 0427-ENDBR.
  6680
  6681
  6682* EXEC CICS ENDBR
  6683*         DATASET(WS-ERCNOT-FILE-ID)
  6684*    END-EXEC.
  6685     MOVE 0
  6686       TO DFHEIV11
  6687*    MOVE '&2                    $   #00006410' TO DFHEIV0
  6688     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6689     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6690     MOVE X'2020233030303036343130' TO DFHEIV0(25:11)
  6691     CALL 'kxdfhei1' USING DFHEIV0,
  6692           WS-ERCNOT-FILE-ID,
  6693           DFHEIV11,
  6694           DFHEIV99
  6695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6696
  6697
  6698     .
  6699 0427-EXIT.
  6700     EXIT.
  6701
  6702 0430-WRITE-ERENDT.
  6703     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6704     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6705     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6706
  6707* EXEC CICS WRITE
  6708*         DATASET   (WS-ERENDT-FILE-ID)
  6709*         FROM      (ENDORSEMENT-RECORD)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 118
* EL6317.cbl
  6710*         RIDFLD    (EN-CONTROL-PRIMARY)
  6711*         RESP      (WS-RESPONSE)
  6712*    END-EXEC
  6713     MOVE LENGTH OF
  6714      ENDORSEMENT-RECORD
  6715       TO DFHEIV11
  6716*    MOVE '&$ L                  ''  N#00006422' TO DFHEIV0
  6717     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6719     MOVE X'204E233030303036343232' TO DFHEIV0(25:11)
  6720     CALL 'kxdfhei1' USING DFHEIV0,
  6721           WS-ERENDT-FILE-ID,
  6722           ENDORSEMENT-RECORD,
  6723           DFHEIV11,
  6724           EN-CONTROL-PRIMARY,
  6725           DFHEIV99,
  6726           DFHEIV99
  6727     MOVE EIBRESP  TO WS-RESPONSE
  6728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6729     IF RESP-NORMAL
  6730        MOVE 'V'                 TO PI-DOCUMENT-PROCESSED
  6731        display ' good write erendt '
  6732        IF EIBAID = DFHPF4
  6733           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6734           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6735           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6736           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6737        END-IF
  6738     ELSE
  6739        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6740        MOVE -1                  TO CARRL
  6741        MOVE ER-0132             TO EMI-ERROR
  6742        MOVE AL-UABON            TO CARRA
  6743        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6744     END-IF
  6745     .
  6746 0430-EXIT.
  6747     EXIT.
  6748 0440-ADD-BILLING-NOTE.
  6749
  6750* EXEC CICS GETMAIN
  6751*         SET      (ADDRESS OF EOB-CODES)
  6752*         LENGTH   (ELEOBC-LENGTH)
  6753*         INITIMG  (GETMAIN-SPACE)
  6754*    END-EXEC
  6755*    MOVE ',"IL                  $   #00006448' TO DFHEIV0
  6756     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6757     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6758     MOVE X'2020233030303036343438' TO DFHEIV0(25:11)
  6759     CALL 'kxdfhei1' USING DFHEIV0,
  6760           DFHEIV20,
  6761           ELEOBC-LENGTH,
  6762           GETMAIN-SPACE
  6763     SET ADDRESS OF EOB-CODES TO
  6764         DFHEIV20
  6765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6766
  6767     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 119
* EL6317.cbl
  6768     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6769     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6770
  6771
  6772* EXEC CICS STARTBR
  6773*        DATASET   ('ELEOBC')
  6774*        RIDFLD    (WS-ELEOBC-KEY)
  6775*        GTEQ
  6776*        RESP      (WS-RESPONSE)
  6777*    END-EXEC
  6778     MOVE 'ELEOBC' TO DFHEIV1
  6779     MOVE 0
  6780       TO DFHEIV11
  6781*    MOVE '&,         G          &  N#00006458' TO DFHEIV0
  6782     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6783     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6784     MOVE X'204E233030303036343538' TO DFHEIV0(25:11)
  6785     CALL 'kxdfhei1' USING DFHEIV0,
  6786           DFHEIV1,
  6787           WS-ELEOBC-KEY,
  6788           DFHEIV99,
  6789           DFHEIV11,
  6790           DFHEIV99
  6791     MOVE EIBRESP  TO WS-RESPONSE
  6792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6793
  6794     IF NOT RESP-NORMAL
  6795        GO TO 0440-EXIT
  6796     END-IF
  6797      .
  6798 0440-READNEXT-ELEOBC.
  6799
  6800
  6801* EXEC CICS READNEXT
  6802*       INTO    (EOB-CODES)
  6803*       DATASET ('ELEOBC')
  6804*       RIDFLD  (WS-ELEOBC-KEY)
  6805*       RESP    (WS-RESPONSE)
  6806*    END-EXEC
  6807     MOVE LENGTH OF
  6808      EOB-CODES
  6809       TO DFHEIV12
  6810     MOVE 'ELEOBC' TO DFHEIV1
  6811     MOVE 0
  6812       TO DFHEIV11
  6813*    MOVE '&.IL                  )  N#00006471' TO DFHEIV0
  6814     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6815     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6816     MOVE X'204E233030303036343731' TO DFHEIV0(25:11)
  6817     CALL 'kxdfhei1' USING DFHEIV0,
  6818           DFHEIV1,
  6819           EOB-CODES,
  6820           DFHEIV12,
  6821           WS-ELEOBC-KEY,
  6822           DFHEIV99,
  6823           DFHEIV11,
  6824           DFHEIV99,
  6825           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 120
* EL6317.cbl
  6826     MOVE EIBRESP  TO WS-RESPONSE
  6827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6828
  6829     IF RESP-NORMAL
  6830         IF EO-RECORD-TYPE NOT = '5'
  6831             GO TO 0440-EXIT
  6832         END-IF
  6833     ELSE
  6834         GO TO 0440-EXIT
  6835     END-IF
  6836
  6837     IF EO-RECORD-TYPE = '5' AND
  6838        EO-EOB-CODE = PI-LTRID-ENTERED
  6839           CONTINUE
  6840     ELSE
  6841         GO TO 0440-READNEXT-ELEOBC
  6842     END-IF
  6843
  6844     MOVE SPACES TO WS-BILLING-NOTE
  6845     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6846     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6847     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6848     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6849     MOVE +25 TO WS-LEN
  6850
  6851     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6852     .
  6853 0440-EXIT.
  6854     EXIT.
  6855
  6856 0441-UPDATE-BILLING-NOTE.
  6857
  6858
  6859* EXEC CICS GETMAIN
  6860*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  6861*         LENGTH   (ERNOTE-LENGTH)
  6862*         INITIMG  (GETMAIN-SPACE)
  6863*    END-EXEC
  6864*    MOVE ',"IL                  $   #00006507' TO DFHEIV0
  6865     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6866     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6867     MOVE X'2020233030303036353037' TO DFHEIV0(25:11)
  6868     CALL 'kxdfhei1' USING DFHEIV0,
  6869           DFHEIV20,
  6870           ERNOTE-LENGTH,
  6871           GETMAIN-SPACE
  6872     SET ADDRESS OF CERTIFICATE-NOTE TO
  6873         DFHEIV20
  6874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6875
  6876     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  6877
  6878
  6879* EXEC CICS READ
  6880*       DATASET    (WS-ERNOTE-FILE-ID)
  6881*       RIDFLD     (WS-ERNOTE-KEY)
  6882*       INTO       (CERTIFICATE-NOTE)
  6883*       RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 121
* EL6317.cbl
  6884*       UPDATE
  6885*    END-EXEC
  6886     MOVE LENGTH OF
  6887      CERTIFICATE-NOTE
  6888       TO DFHEIV11
  6889*    MOVE '&"IL       EU         (  N#00006515' TO DFHEIV0
  6890     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6891     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6892     MOVE X'204E233030303036353135' TO DFHEIV0(25:11)
  6893     CALL 'kxdfhei1' USING DFHEIV0,
  6894           WS-ERNOTE-FILE-ID,
  6895           CERTIFICATE-NOTE,
  6896           DFHEIV11,
  6897           WS-ERNOTE-KEY,
  6898           DFHEIV99,
  6899           DFHEIV99,
  6900           DFHEIV99
  6901     MOVE EIBRESP  TO WS-RESPONSE
  6902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6903
  6904     IF RESP-NORMAL
  6905       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  6906          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  6907       END-IF
  6908       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  6909          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  6910       END-IF
  6911       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6912           (NOTE-SUB > +10) OR
  6913           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  6914                             WS-BILLING-NOTE (1:WS-LEN))
  6915       END-PERFORM
  6916       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  6917                              WS-BILLING-NOTE (1:WS-LEN)
  6918
  6919* EXEC CICS UNLOCK
  6920*           DATASET    (WS-ERNOTE-FILE-ID)
  6921*        END-EXEC
  6922*    MOVE '&*                    #   #00006537' TO DFHEIV0
  6923     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6924     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6925     MOVE X'2020233030303036353337' TO DFHEIV0(25:11)
  6926     CALL 'kxdfhei1' USING DFHEIV0,
  6927           WS-ERNOTE-FILE-ID,
  6928           DFHEIV99
  6929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6930       ELSE
  6931         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6932           (NOTE-SUB > +10) OR
  6933           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  6934         END-PERFORM
  6935         IF (NOTE-SUB < +11)
  6936           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  6937              NOTE-SUB <= CN-BILLING-END-LINE-NO
  6938                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6939           ELSE
  6940             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  6941              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 122
* EL6317.cbl
  6942                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  6943                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  6944             ELSE
  6945               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  6946                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  6947                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6948                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  6949               ELSE
  6950                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  6951                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  6952                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  6953                                       CN-BILLING-START-LINE-NO
  6954                 ELSE
  6955                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  6956                 END-IF
  6957               END-IF
  6958             END-IF
  6959           END-IF
  6960           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6961           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6962           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6963
  6964* EXEC CICS REWRITE
  6965*             DATASET    (WS-ERNOTE-FILE-ID)
  6966*             FROM       (CERTIFICATE-NOTE)
  6967*             RESP       (WS-RESPONSE)
  6968*          END-EXEC
  6969     MOVE LENGTH OF
  6970      CERTIFICATE-NOTE
  6971       TO DFHEIV11
  6972*    MOVE '&& L                  %  N#00006573' TO DFHEIV0
  6973     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6974     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6975     MOVE X'204E233030303036353733' TO DFHEIV0(25:11)
  6976     CALL 'kxdfhei1' USING DFHEIV0,
  6977           WS-ERNOTE-FILE-ID,
  6978           CERTIFICATE-NOTE,
  6979           DFHEIV11,
  6980           DFHEIV99
  6981     MOVE EIBRESP  TO WS-RESPONSE
  6982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6983           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6984         END-IF
  6985       END-IF
  6986     ELSE
  6987        MOVE SPACES              TO CERTIFICATE-NOTE
  6988        MOVE 'CN'                TO CN-RECORD-ID
  6989        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  6990                                     WS-ERNOTE-KEY
  6991        MOVE 01                  TO CN-BILLING-START-LINE-NO
  6992                                    CN-BILLING-END-LINE-NO
  6993        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  6994        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6995        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6996        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6997
  6998* EXEC CICS WRITE
  6999*          DATASET    (WS-ERNOTE-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 123
* EL6317.cbl
  7000*          FROM       (CERTIFICATE-NOTE)
  7001*          RIDFLD     (WS-ERNOTE-KEY)
  7002*          RESP       (WS-RESPONSE)
  7003*       END-EXEC
  7004     MOVE LENGTH OF
  7005      CERTIFICATE-NOTE
  7006       TO DFHEIV11
  7007*    MOVE '&$ L                  ''  N#00006592' TO DFHEIV0
  7008     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7010     MOVE X'204E233030303036353932' TO DFHEIV0(25:11)
  7011     CALL 'kxdfhei1' USING DFHEIV0,
  7012           WS-ERNOTE-FILE-ID,
  7013           CERTIFICATE-NOTE,
  7014           DFHEIV11,
  7015           WS-ERNOTE-KEY,
  7016           DFHEIV99,
  7017           DFHEIV99
  7018     MOVE EIBRESP  TO WS-RESPONSE
  7019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7020
  7021        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7022     END-IF
  7023
  7024     .
  7025 0441-EXIT.
  7026     EXIT.
  7027
  7028
  7029 0442-SQUEEZE-IT-IN.
  7030
  7031     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7032        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7033           NOTE-SUB = +10
  7034           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7035           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7036             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7037             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7038             MOVE +9 TO NOTE-SUB
  7039           END-IF
  7040        END-PERFORM
  7041     ELSE
  7042        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7043           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7044             UNTIL NOTE-SUB = +1
  7045             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7046             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7047                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7048                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7049                MOVE +2          TO NOTE-SUB
  7050             END-IF
  7051           END-PERFORM
  7052        END-IF
  7053     END-IF
  7054
  7055     .
  7056 0442-EXIT.
  7057     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 124
* EL6317.cbl
  7058
  7059 0445-CERTIFICATE-UPDATE.
  7060    display 'billing note written, updating cert'
  7061     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7062     IF RESP-NORMAL
  7063        EVALUATE CM-NOTE-SW
  7064           WHEN '2'
  7065           WHEN '3'
  7066           WHEN '6'
  7067           WHEN '7'
  7068              SET NO-CERT-RW     TO TRUE
  7069           WHEN ' '
  7070              MOVE '2'           TO CM-NOTE-SW
  7071           WHEN '1'
  7072              MOVE '3'           TO CM-NOTE-SW
  7073           WHEN '4'
  7074              MOVE '6'           TO CM-NOTE-SW
  7075           WHEN '5'
  7076              MOVE '7'           TO CM-NOTE-SW
  7077        END-EVALUATE
  7078     END-IF
  7079     IF NOT NO-CERT-RW
  7080        PERFORM 1810-REWRITE-ELCERT
  7081                                 THRU 1810-EXIT
  7082     ELSE
  7083
  7084* EXEC CICS UNLOCK
  7085*          DATASET    (WS-ELCERT-FILE-ID)
  7086*       END-EXEC
  7087*    MOVE '&*                    #   #00006661' TO DFHEIV0
  7088     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7089     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7090     MOVE X'2020233030303036363631' TO DFHEIV0(25:11)
  7091     CALL 'kxdfhei1' USING DFHEIV0,
  7092           WS-ELCERT-FILE-ID,
  7093           DFHEIV99
  7094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7095     END-IF
  7096
  7097     .
  7098 0445-EXIT.
  7099     EXIT.
  7100
  7101 0500-CREATE-TEMP-STORAGE.
  7102     display ' about to write pi ' program-interface-block
  7103
  7104* EXEC CICS WRITEQ TS
  7105*        QUEUE (QID)
  7106*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7107*        LENGTH(PI-COMM-LENGTH)
  7108*    END-EXEC
  7109*    MOVE '*"                    ''   #00006672' TO DFHEIV0
  7110     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7111     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7112     MOVE X'2020233030303036363732' TO DFHEIV0(25:11)
  7113     CALL 'kxdfhei1' USING DFHEIV0,
  7114           QID,
  7115           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 125
* EL6317.cbl
  7116           PI-COMM-LENGTH,
  7117           DFHEIV99,
  7118           DFHEIV99,
  7119           DFHEIV99
  7120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7121     display ' about to write map ' el631ji
  7122
  7123* EXEC CICS WRITEQ TS
  7124*        QUEUE (QID)
  7125*        FROM  (EL631JI)
  7126*        LENGTH(MAP-LENGTH)
  7127*    END-EXEC.
  7128*    MOVE '*"                    ''   #00006678' TO DFHEIV0
  7129     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7131     MOVE X'2020233030303036363738' TO DFHEIV0(25:11)
  7132     CALL 'kxdfhei1' USING DFHEIV0,
  7133           QID,
  7134           EL631JI,
  7135           MAP-LENGTH,
  7136           DFHEIV99,
  7137           DFHEIV99,
  7138           DFHEIV99
  7139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7140
  7141 0500-EXIT.
  7142      EXIT.
  7143 0600-RECOVER-TEMP-STORAGE.
  7144     display ' about to recover pi '
  7145
  7146* EXEC CICS READQ TS
  7147*        QUEUE (QID)
  7148*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7149*        LENGTH(PI-COMM-LENGTH)
  7150*    END-EXEC
  7151*    MOVE '*$I    L              ''   #00006687' TO DFHEIV0
  7152     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7154     MOVE X'2020233030303036363837' TO DFHEIV0(25:11)
  7155     CALL 'kxdfhei1' USING DFHEIV0,
  7156           QID,
  7157           PROGRAM-INTERFACE-BLOCK,
  7158           PI-COMM-LENGTH,
  7159           DFHEIV99,
  7160           DFHEIV99,
  7161           DFHEIV99
  7162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7163     display ' pi ' pi-program-work-area
  7164     display ' about to recover map '
  7165
  7166* EXEC CICS READQ TS
  7167*        QUEUE (QID)
  7168*        INTO  (EL631JI)
  7169*        LENGTH(MAP-LENGTH)
  7170*    END-EXEC
  7171*    MOVE '*$I    L              ''   #00006694' TO DFHEIV0
  7172     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7173     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 126
* EL6317.cbl
  7174     MOVE X'2020233030303036363934' TO DFHEIV0(25:11)
  7175     CALL 'kxdfhei1' USING DFHEIV0,
  7176           QID,
  7177           EL631JI,
  7178           MAP-LENGTH,
  7179           DFHEIV99,
  7180           DFHEIV99,
  7181           DFHEIV99
  7182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7183     display ' map ' el631ji
  7184     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7185     MOVE AL-UANON            TO SIGREQA
  7186     MOVE AL-UANON            TO LTRIDA
  7187     IF WS-SET-CODES-MDT = 'Y'
  7188        move +1                  to s2
  7189        perform varying s1 from +1 by +5 until s1 > +60
  7190           MOVE WS-PASSED-REASON-CODES (s1:4)
  7191                                 TO reacd-in (s2)
  7192           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7193               MOVE AL-SANON     TO REACDA (S2)
  7194               MOVE +4           TO REACDL (S2)
  7195           END-IF
  7196           add +1                to s2
  7197        end-perform
  7198        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7199     END-IF
  7200
  7201     IF CRTNT1I > SPACES
  7202         MOVE AL-UANON       TO CRTNT1A
  7203     END-IF
  7204
  7205     IF CRTNT2I > SPACES
  7206         MOVE AL-UANON       TO CRTNT2A
  7207     END-IF
  7208
  7209     IF BILNT1I > SPACES
  7210         MOVE AL-UANON       TO BILNT1A
  7211     END-IF
  7212     .
  7213 0600-EXIT.
  7214      EXIT.
  7215 0800-DELETE-TS.
  7216
  7217* EXEC CICS DELETEQ TS
  7218*        QUEUE(QID)
  7219*    END-EXEC
  7220*    MOVE '*&                    #   #00006732' TO DFHEIV0
  7221     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7222     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7223     MOVE X'2020233030303036373332' TO DFHEIV0(25:11)
  7224     CALL 'kxdfhei1' USING DFHEIV0,
  7225           QID,
  7226           DFHEIV99
  7227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7228     .
  7229 0800-EXIT.
  7230      EXIT.
  7231 1000-BUILD-ERARCH.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 127
* EL6317.cbl
  7232     display ' made it to 1000 '
  7233     MOVE SPACES                 TO W-CNTL-KEY
  7234     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7235     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7236     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7237
  7238* EXEC CICS READ
  7239*         DATASET    (WS-ELCNTL-FILE-ID)
  7240*         SET        (ADDRESS OF CONTROL-FILE)
  7241*         RIDFLD     (W-CNTL-KEY)
  7242*         UPDATE
  7243*         RESP       (WS-RESPONSE)
  7244*    END-EXEC
  7245*    MOVE '&"S        EU         (  N#00006744' TO DFHEIV0
  7246     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7247     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7248     MOVE X'204E233030303036373434' TO DFHEIV0(25:11)
  7249     CALL 'kxdfhei1' USING DFHEIV0,
  7250           WS-ELCNTL-FILE-ID,
  7251           DFHEIV20,
  7252           DFHEIV99,
  7253           W-CNTL-KEY,
  7254           DFHEIV99,
  7255           DFHEIV99,
  7256           DFHEIV99
  7257     SET ADDRESS OF CONTROL-FILE TO
  7258         DFHEIV20
  7259     MOVE EIBRESP  TO WS-RESPONSE
  7260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7261     IF RESP-NORMAL
  7262        display ' good read elcntl '
  7263        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7264           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7265        END-IF
  7266        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7267        MOVE CF-CREDIT-LAST-ARCH-NUM
  7268                                 TO W-ARCH-NUMBER
  7269
  7270* EXEC CICS REWRITE
  7271*          FROM      (CONTROL-FILE)
  7272*          DATASET   (WS-ELCNTL-FILE-ID)
  7273*       END-EXEC
  7274     MOVE LENGTH OF
  7275      CONTROL-FILE
  7276       TO DFHEIV11
  7277*    MOVE '&& L                  %   #00006759' TO DFHEIV0
  7278     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7279     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7280     MOVE X'2020233030303036373539' TO DFHEIV0(25:11)
  7281     CALL 'kxdfhei1' USING DFHEIV0,
  7282           WS-ELCNTL-FILE-ID,
  7283           CONTROL-FILE,
  7284           DFHEIV11,
  7285           DFHEIV99
  7286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7287     END-IF
  7288
  7289* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 128
* EL6317.cbl
  7290*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7291*       LENGTH   (W-ARCH-LENGTH)
  7292*    END-EXEC
  7293*    MOVE '," L                  $   #00006764' TO DFHEIV0
  7294     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7295     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7296     MOVE X'2020233030303036373634' TO DFHEIV0(25:11)
  7297     CALL 'kxdfhei1' USING DFHEIV0,
  7298           DFHEIV20,
  7299           W-ARCH-LENGTH,
  7300           DFHEIV99
  7301     SET ADDRESS OF LETTER-ARCHIVE TO
  7302         DFHEIV20
  7303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7304     MOVE 'LA'                   TO LETTER-ARCHIVE
  7305     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7306                                    LA-ARCHIVE-NO-A2
  7307                                    LA-ARCHIVE-NO-A3
  7308                                    LA-ARCHIVE-NO-A4
  7309                                    LA-ARCHIVE-NO-A5
  7310                                    LA-ARCHIVE-NO-A6
  7311     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7312                                    LA-COMPANY-CD-A2
  7313                                    LA-COMPANY-CD-A3
  7314                                    LA-COMPANY-CD-A4
  7315                                    LA-COMPANY-CD-A5
  7316                                    LA-COMPANY-CD-A6
  7317     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7318                                    LA-CARRIER-A3
  7319                                    LA-CARRIER-A4
  7320                                    LA-CARRIER-A5
  7321     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7322     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7323                                    LA-GROUPING-A3
  7324                                    LA-GROUPING-A4
  7325                                    LA-GROUPING-A5
  7326     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7327                                    LA-ACCOUNT-A3
  7328                                    LA-ACCOUNT-A4
  7329                                    LA-ACCOUNT-A5
  7330     MOVE PB-STATE               TO LA-STATE-A2
  7331                                    LA-STATE-A3
  7332                                    LA-STATE-A4
  7333                                    LA-STATE-A5
  7334     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7335     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7336     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7337     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7338     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7339                                    LA-INITIAL-PRINT-DATE
  7340                                    LA-SENT-DATE
  7341                                    LA-REPLY-DATE
  7342                                    LA-RESEND-DATE
  7343                                    LA-FOLLOW-UP-DATE
  7344     MOVE 'A'                    TO LA-STATUS
  7345     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7346     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7347     MOVE LTRIDI                 TO LA-FORM-A3
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 129
* EL6317.cbl
  7348     MOVE '4'                    TO LA-DATA-SOURCE
  7349     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7350     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7351                                    LA-NO-OF-TEXT-RECORDS
  7352
  7353* EXEC CICS WRITE
  7354*         DATASET   ('ERARCH')
  7355*         FROM      (LETTER-ARCHIVE)
  7356*         RIDFLD    (LA-CONTROL-PRIMARY)
  7357*         RESP      (WS-RESPONSE)
  7358*    END-EXEC
  7359     MOVE LENGTH OF
  7360      LETTER-ARCHIVE
  7361       TO DFHEIV11
  7362     MOVE 'ERARCH' TO DFHEIV1
  7363*    MOVE '&$ L                  ''  N#00006816' TO DFHEIV0
  7364     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7365     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7366     MOVE X'204E233030303036383136' TO DFHEIV0(25:11)
  7367     CALL 'kxdfhei1' USING DFHEIV0,
  7368           DFHEIV1,
  7369           LETTER-ARCHIVE,
  7370           DFHEIV11,
  7371           LA-CONTROL-PRIMARY,
  7372           DFHEIV99,
  7373           DFHEIV99
  7374     MOVE EIBRESP  TO WS-RESPONSE
  7375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7376     IF RESP-NORMAL
  7377        display ' good write erarch '
  7378        MOVE ER-0280             TO EMI-ERROR
  7379        MOVE -1                  TO SIGREQL
  7380        PERFORM 9900-ERROR-FORMAT
  7381                                 THRU 9900-EXIT
  7382        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7383        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7384     ELSE
  7385        MOVE ER-7345             TO EMI-ERROR
  7386        MOVE -1                  TO SIGREQL
  7387        PERFORM 9900-ERROR-FORMAT
  7388                                 THRU 9900-EXIT
  7389     END-IF
  7390     .
  7391 1000-EXIT.
  7392     EXIT.
  7393 1100-CALL-NS-BUS-LOGIC.
  7394     DISPLAY ' MADE IT TO 1100 '
  7395     MOVE SPACES                 TO BL-INPUT
  7396     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7397     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  7398         MOVE '2'                TO BL-DATA-SRCE
  7399         MOVE SPACES             TO BL-BATCH-NO
  7400         MOVE ZEROS              TO BL-BATCH-SEQ
  7401     ELSE
  7402         MOVE '4'                TO BL-DATA-SRCE
  7403         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  7404         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  7405     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 130
* EL6317.cbl
  7406     MOVE PI-CARRIER             TO BL-CARRIER
  7407     MOVE PI-GROUPING            TO BL-GROUP
  7408     MOVE PI-STATE               TO BL-STATE
  7409     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  7410     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  7411        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  7412        MOVE ' '                 TO DC-OPTION-CODE
  7413        PERFORM 9700-date-link
  7414        IF NO-CONVERSION-ERROR
  7415           MOVE DC-GREG-DATE-1-EDIT
  7416                                 TO BL-EFF-DT
  7417        END-IF
  7418     END-IF
  7419     MOVE PI-CERT-NO             TO BL-CERT-NO
  7420     MOVE SPACES                 TO BL-RESP-NO
  7421     MOVE LTRIDI                 TO BL-LETTER-ID
  7422     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7423     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7424     MOVE 'CrtVerif'               TO BL-FUNC
  7425*    MOVE 'ALWA'                 TO BL-PROC-ID
  7426     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7427*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7428*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7429     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7430     MOVE 'VERIFY  '             TO BL-SOURCE-SCREEN
  7431     IF EIBAID = DFHPF4
  7432        MOVE 'B'                 TO BL-WRITE-ERARCH
  7433     ELSE
  7434        MOVE 'T'                 TO BL-WRITE-ERARCH
  7435     END-IF
  7436     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7437        MOVE REACD-IN (S1)       TO BL-REASON-CODE (S1)
  7438     END-PERFORM
  7439    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7440*****************************************
  7441* Invoke the LETTER business logic
  7442*****************************************
  7443
  7444* exec cics link
  7445*       program('NSRASBL')
  7446*       commarea(srch-commarea)
  7447*    end-exec.
  7448     MOVE LENGTH OF
  7449      srch-commarea
  7450       TO DFHEIV11
  7451     MOVE 'NSRASBL' TO DFHEIV1
  7452*    MOVE '."C                   (   #00006889' TO DFHEIV0
  7453     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7455     MOVE X'2020233030303036383839' TO DFHEIV0(25:11)
  7456     CALL 'kxdfhei1' USING DFHEIV0,
  7457           DFHEIV1,
  7458           srch-commarea,
  7459           DFHEIV11,
  7460           DFHEIV99,
  7461           DFHEIV99,
  7462           DFHEIV99,
  7463           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 131
* EL6317.cbl
  7464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7465
  7466     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7467        BL-MESSAGE
  7468     .
  7469 1100-EXIT.
  7470     EXIT.
  7471 1500-GET-ARCH-NO.
  7472     display ' made it to 1500 '
  7473     MOVE SPACES                 TO ELCNTL-KEY
  7474     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7475     MOVE '1'                    TO CNTL-REC-TYPE
  7476     MOVE ZEROS                  TO CNTL-SEQ
  7477
  7478* EXEC CICS READ
  7479*         DATASET    (WS-ELCNTL-FILE-ID)
  7480*         SET        (ADDRESS OF CONTROL-FILE)
  7481*         RIDFLD     (ELCNTL-KEY)
  7482*         UPDATE
  7483*         RESP       (WS-RESPONSE)
  7484*    END-EXEC
  7485*    MOVE '&"S        EU         (  N#00006904' TO DFHEIV0
  7486     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7487     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7488     MOVE X'204E233030303036393034' TO DFHEIV0(25:11)
  7489     CALL 'kxdfhei1' USING DFHEIV0,
  7490           WS-ELCNTL-FILE-ID,
  7491           DFHEIV20,
  7492           DFHEIV99,
  7493           ELCNTL-KEY,
  7494           DFHEIV99,
  7495           DFHEIV99,
  7496           DFHEIV99
  7497     SET ADDRESS OF CONTROL-FILE TO
  7498         DFHEIV20
  7499     MOVE EIBRESP  TO WS-RESPONSE
  7500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7501     IF RESP-NORMAL
  7502        display ' good read elcntl '
  7503        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7504           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7505        END-IF
  7506        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7507        MOVE CF-CREDIT-LAST-ARCH-NUM
  7508                                 TO W-ARCH-NUMBER
  7509        display ' new arch number ' w-arch-number
  7510
  7511* EXEC CICS REWRITE
  7512*          FROM      (CONTROL-FILE)
  7513*          DATASET   (WS-ELCNTL-FILE-ID)
  7514*       END-EXEC
  7515     MOVE LENGTH OF
  7516      CONTROL-FILE
  7517       TO DFHEIV11
  7518*    MOVE '&& L                  %   #00006920' TO DFHEIV0
  7519     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7520     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7521     MOVE X'2020233030303036393230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 132
* EL6317.cbl
  7522     CALL 'kxdfhei1' USING DFHEIV0,
  7523           WS-ELCNTL-FILE-ID,
  7524           CONTROL-FILE,
  7525           DFHEIV11,
  7526           DFHEIV99
  7527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7528     END-IF
  7529     .
  7530 1500-EXIT.
  7531     EXIT.
  7532
  7533
  7534 1700-WRITE-CERT-NOTE      SECTION.
  7535
  7536
  7537     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7538     MOVE ZERO           TO ERCNOT-SEQ.
  7539     SET TB-INDX         DOWN BY 1.
  7540     SET TB-INDX1        TO TB-INDX.
  7541
  7542****DELETE CURRENT CERT NOTES
  7543 1700-LOOP.
  7544
  7545* EXEC CICS READ
  7546*        DATASET (WS-ERCNOT-FILE-ID)
  7547*        RIDFLD  (ERCNOT-KEY)
  7548*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7549*        RESP    (WS-RESPONSE)
  7550*        GTEQ
  7551*    END-EXEC.
  7552*    MOVE '&"S        G          (  N#00006940' TO DFHEIV0
  7553     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7555     MOVE X'204E233030303036393430' TO DFHEIV0(25:11)
  7556     CALL 'kxdfhei1' USING DFHEIV0,
  7557           WS-ERCNOT-FILE-ID,
  7558           DFHEIV20,
  7559           DFHEIV99,
  7560           ERCNOT-KEY,
  7561           DFHEIV99,
  7562           DFHEIV99,
  7563           DFHEIV99
  7564     SET ADDRESS OF CERT-NOTE-FILE TO
  7565         DFHEIV20
  7566     MOVE EIBRESP  TO WS-RESPONSE
  7567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7568
  7569
  7570     IF NOT RESP-NORMAL
  7571        GO TO 1700-ENDDEL
  7572     END-IF
  7573
  7574     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7575
  7576     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7577         GO TO 1700-ENDDEL
  7578     END-IF.
  7579
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 133
* EL6317.cbl
  7580
  7581* EXEC CICS DELETE
  7582*        DATASET (WS-ERCNOT-FILE-ID)
  7583*        RIDFLD  (ERCNOT-KEY)
  7584*    END-EXEC.
  7585*    MOVE '&(  R                 &   #00006958' TO DFHEIV0
  7586     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7587     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7588     MOVE X'2020233030303036393538' TO DFHEIV0(25:11)
  7589     CALL 'kxdfhei1' USING DFHEIV0,
  7590           WS-ERCNOT-FILE-ID,
  7591           ERCNOT-KEY,
  7592           DFHEIV99,
  7593           DFHEIV99,
  7594           DFHEIV99
  7595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7596
  7597
  7598     GO TO 1700-LOOP.
  7599
  7600 1700-ENDDEL.
  7601
  7602
  7603* EXEC CICS GETMAIN
  7604*         LENGTH(ERCNOT-LENGTH)
  7605*         SET(ADDRESS OF CERT-NOTE-FILE)
  7606*         INITIMG(GETMAIN-SPACE)
  7607*    END-EXEC.
  7608*    MOVE ',"IL                  $   #00006967' TO DFHEIV0
  7609     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7610     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7611     MOVE X'2020233030303036393637' TO DFHEIV0(25:11)
  7612     CALL 'kxdfhei1' USING DFHEIV0,
  7613           DFHEIV20,
  7614           ERCNOT-LENGTH,
  7615           GETMAIN-SPACE
  7616     SET ADDRESS OF CERT-NOTE-FILE TO
  7617         DFHEIV20
  7618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7619
  7620
  7621     SET TB-INDX TO 1.
  7622     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7623     MOVE +0             TO ERCNOT-SEQ
  7624
  7625     PERFORM VARYING TB-INDX FROM 1 BY 1
  7626             UNTIL TB-INDX > TB-INDX1
  7627        MOVE SPACES                 TO  CERT-NOTE-FILE
  7628        ADD 1                       TO  ERCNOT-SEQ
  7629        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7630        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7631        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7632        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7633                                    TO  CZ-LAST-MAINT-USER
  7634        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7635                                    TO  CZ-LAST-MAINT-HHMMSS
  7636        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7637                                    TO  CZ-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 134
* EL6317.cbl
  7638
  7639
  7640* EXEC CICS WRITE
  7641*            DATASET(WS-ERCNOT-FILE-ID)
  7642*            FROM(CERT-NOTE-FILE)
  7643*            RIDFLD(ERCNOT-KEY)
  7644*       END-EXEC
  7645     MOVE LENGTH OF
  7646      CERT-NOTE-FILE
  7647       TO DFHEIV11
  7648*    MOVE '&$ L                  ''   #00006991' TO DFHEIV0
  7649     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7650     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7651     MOVE X'2020233030303036393931' TO DFHEIV0(25:11)
  7652     CALL 'kxdfhei1' USING DFHEIV0,
  7653           WS-ERCNOT-FILE-ID,
  7654           CERT-NOTE-FILE,
  7655           DFHEIV11,
  7656           ERCNOT-KEY,
  7657           DFHEIV99,
  7658           DFHEIV99
  7659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7660     END-PERFORM
  7661
  7662     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7663     IF RESP-NORMAL
  7664        EVALUATE CM-NOTE-SW
  7665           WHEN '1'
  7666           WHEN '3'
  7667           WHEN '5'
  7668           WHEN '7'
  7669              SET NO-CERT-RW     TO TRUE
  7670           WHEN ' '
  7671              MOVE '1'           TO CM-NOTE-SW
  7672           WHEN '2'
  7673              MOVE '3'           TO CM-NOTE-SW
  7674           WHEN '4'
  7675              MOVE '5'           TO CM-NOTE-SW
  7676           WHEN '6'
  7677              MOVE '7'           TO CM-NOTE-SW
  7678        END-EVALUATE
  7679     END-IF
  7680     IF NOT NO-CERT-RW
  7681        PERFORM 1810-REWRITE-ELCERT
  7682                                 THRU 1810-EXIT
  7683     ELSE
  7684
  7685* EXEC CICS UNLOCK
  7686*          DATASET    (WS-ELCERT-FILE-ID)
  7687*       END-EXEC
  7688*    MOVE '&*                    #   #00007020' TO DFHEIV0
  7689     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7690     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7691     MOVE X'2020233030303037303230' TO DFHEIV0(25:11)
  7692     CALL 'kxdfhei1' USING DFHEIV0,
  7693           WS-ELCERT-FILE-ID,
  7694           DFHEIV99
  7695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 135
* EL6317.cbl
  7696     END-IF
  7697
  7698     .
  7699 1799-EXIT.
  7700     EXIT.
  7701
  7702 1800-READ-ELCERT-UPDATE.
  7703
  7704     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7705     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7706     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7707     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7708     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7709     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7710     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7711     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7712
  7713
  7714* EXEC CICS READ
  7715*        UPDATE
  7716*        DATASET  (WS-ELCERT-FILE-ID)
  7717*        RIDFLD   (WS-ELCERT-KEY)
  7718*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7719*        RESP     (WS-RESPONSE)
  7720*    END-EXEC
  7721*    MOVE '&"S        EU         (  N#00007040' TO DFHEIV0
  7722     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7723     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7724     MOVE X'204E233030303037303430' TO DFHEIV0(25:11)
  7725     CALL 'kxdfhei1' USING DFHEIV0,
  7726           WS-ELCERT-FILE-ID,
  7727           DFHEIV20,
  7728           DFHEIV99,
  7729           WS-ELCERT-KEY,
  7730           DFHEIV99,
  7731           DFHEIV99,
  7732           DFHEIV99
  7733     SET ADDRESS OF CERTIFICATE-MASTER TO
  7734         DFHEIV20
  7735     MOVE EIBRESP  TO WS-RESPONSE
  7736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7737
  7738     .
  7739 1800-EXIT.
  7740     EXIT.
  7741
  7742 1810-REWRITE-ELCERT.
  7743
  7744
  7745* EXEC CICS REWRITE
  7746*        FROM     (CERTIFICATE-MASTER)
  7747*        DATASET  (WS-ELCERT-FILE-ID)
  7748*        RESP     (WS-RESPONSE)
  7749*    END-EXEC.
  7750     MOVE LENGTH OF
  7751      CERTIFICATE-MASTER
  7752       TO DFHEIV11
  7753*    MOVE '&& L                  %  N#00007054' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 136
* EL6317.cbl
  7754     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7755     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7756     MOVE X'204E233030303037303534' TO DFHEIV0(25:11)
  7757     CALL 'kxdfhei1' USING DFHEIV0,
  7758           WS-ELCERT-FILE-ID,
  7759           CERTIFICATE-MASTER,
  7760           DFHEIV11,
  7761           DFHEIV99
  7762     MOVE EIBRESP  TO WS-RESPONSE
  7763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7764
  7765
  7766     .
  7767 1810-EXIT.
  7768     EXIT.
  7769
  7770 8100-SEND-INITIAL-MAP.
  7771     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7772     MOVE '5'                    TO DC-OPTION-CODE.
  7773     PERFORM 9700-DATE-LINK.
  7774     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7775     MOVE EIBTIME                TO TIME-IN.
  7776     MOVE TIME-OUT               TO TIMEO.
  7777     MOVE -1                     TO SIGREQL.
  7778     IF PI-PROCESSOR-IS-CSR-SUPER
  7779        perform varying s1 from +1 by +1 until
  7780           s1 > +12
  7781           MOVE AL-UANON            TO reacda (s1)
  7782        end-perform
  7783     END-IF
  7784     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  7785     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  7786
  7787* EXEC CICS SEND
  7788*        MAP      (MAP-NAME)
  7789*        MAPSET   (MAPSET-NAME)
  7790*        FROM     (EL631JO)
  7791*        ERASE
  7792*        CURSOR
  7793*    END-EXEC.
  7794     MOVE LENGTH OF
  7795      EL631JO
  7796       TO DFHEIV12
  7797     MOVE -1
  7798       TO DFHEIV11
  7799*    MOVE '8$     CT  E    H L F ,   #00007080' TO DFHEIV0
  7800     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7801     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7802     MOVE X'2020233030303037303830' TO DFHEIV0(25:11)
  7803     CALL 'kxdfhei1' USING DFHEIV0,
  7804           MAP-NAME,
  7805           EL631JO,
  7806           DFHEIV12,
  7807           MAPSET-NAME,
  7808           DFHEIV99,
  7809           DFHEIV99,
  7810           DFHEIV99,
  7811           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 137
* EL6317.cbl
  7812           DFHEIV99,
  7813           DFHEIV99,
  7814           DFHEIV99
  7815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7816
  7817     GO TO 9100-RETURN-TRAN.
  7818 8200-SEND-DATAONLY.
  7819     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7820     MOVE '5'                    TO DC-OPTION-CODE.
  7821     PERFORM 9700-DATE-LINK.
  7822     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7823     MOVE EIBTIME                TO TIME-IN.
  7824     MOVE TIME-OUT               TO TIMEO.
  7825     MOVE -1                     TO PFENTRL
  7826     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  7827     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  7828
  7829* EXEC CICS SEND
  7830*        MAP      (MAP-NAME)
  7831*        MAPSET   (MAPSET-NAME)
  7832*        FROM     (EL631JO)
  7833*        DATAONLY
  7834*        ERASEAUP
  7835*        CURSOR
  7836*    END-EXEC.
  7837     MOVE LENGTH OF
  7838      EL631JO
  7839       TO DFHEIV12
  7840     MOVE -1
  7841       TO DFHEIV11
  7842*    MOVE '8$D    CT  A    H L F ,   #00007098' TO DFHEIV0
  7843     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  7844     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7845     MOVE X'2020233030303037303938' TO DFHEIV0(25:11)
  7846     CALL 'kxdfhei1' USING DFHEIV0,
  7847           MAP-NAME,
  7848           EL631JO,
  7849           DFHEIV12,
  7850           MAPSET-NAME,
  7851           DFHEIV99,
  7852           DFHEIV99,
  7853           DFHEIV99,
  7854           DFHEIV11,
  7855           DFHEIV99,
  7856           DFHEIV99,
  7857           DFHEIV99
  7858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7859
  7860     GO TO 9100-RETURN-TRAN.
  7861 8300-SEND-TEXT.
  7862
  7863* EXEC CICS SEND TEXT
  7864*        FROM     (LOGOFF-TEXT)
  7865*        LENGTH   (LOGOFF-LENGTH)
  7866*        ERASE
  7867*        FREEKB
  7868*    END-EXEC.
  7869*    MOVE '8&      T  E F  H   F -   #00007108' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 138
* EL6317.cbl
  7870     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  7871     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  7872     MOVE X'2020233030303037313038' TO DFHEIV0(25:11)
  7873     CALL 'kxdfhei1' USING DFHEIV0,
  7874           LOGOFF-TEXT,
  7875           LOGOFF-LENGTH,
  7876           DFHEIV99,
  7877           DFHEIV99,
  7878           DFHEIV99,
  7879           DFHEIV99,
  7880           DFHEIV99,
  7881           DFHEIV99,
  7882           DFHEIV99,
  7883           DFHEIV99,
  7884           DFHEIV99,
  7885           DFHEIV99
  7886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7887
  7888
  7889* EXEC CICS RETURN
  7890*    END-EXEC.
  7891*    MOVE '.(                    ''   #00007114' TO DFHEIV0
  7892     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7893     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7894     MOVE X'2020233030303037313134' TO DFHEIV0(25:11)
  7895     CALL 'kxdfhei1' USING DFHEIV0,
  7896           DFHEIV99,
  7897           DFHEIV99,
  7898           DFHEIV99,
  7899           DFHEIV99,
  7900           DFHEIV99,
  7901           DFHEIV99
  7902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7903
  7904 8800-UNAUTHORIZED-ACCESS.
  7905     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  7906     GO TO 8300-SEND-TEXT.
  7907 8810-PF23.
  7908     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  7909     MOVE XCTL-005               TO PGM-NAME.
  7910     GO TO 9300-XCTL.
  7911 9000-RETURN-CICS.
  7912
  7913* EXEC CICS RETURN
  7914*    END-EXEC.
  7915*    MOVE '.(                    ''   #00007124' TO DFHEIV0
  7916     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7917     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7918     MOVE X'2020233030303037313234' TO DFHEIV0(25:11)
  7919     CALL 'kxdfhei1' USING DFHEIV0,
  7920           DFHEIV99,
  7921           DFHEIV99,
  7922           DFHEIV99,
  7923           DFHEIV99,
  7924           DFHEIV99,
  7925           DFHEIV99
  7926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7927
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 139
* EL6317.cbl
  7928 9100-RETURN-TRAN.
  7929     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  7930     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  7931
  7932* EXEC CICS RETURN
  7933*        TRANSID    (TRANS-ID)
  7934*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7935*        LENGTH     (PI-COMM-LENGTH)
  7936*    END-EXEC.
  7937*    MOVE '.(CT                  ''   #00007129' TO DFHEIV0
  7938     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  7939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7940     MOVE X'2020233030303037313239' TO DFHEIV0(25:11)
  7941     CALL 'kxdfhei1' USING DFHEIV0,
  7942           TRANS-ID,
  7943           PROGRAM-INTERFACE-BLOCK,
  7944           PI-COMM-LENGTH,
  7945           DFHEIV99,
  7946           DFHEIV99,
  7947           DFHEIV99
  7948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7949
  7950 9200-RETURN-MAIN-MENU.
  7951     MOVE XCTL-626               TO PGM-NAME.
  7952     GO TO 9300-XCTL.
  7953 9300-XCTL.
  7954
  7955* EXEC CICS XCTL
  7956*        PROGRAM    (PGM-NAME)
  7957*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7958*        LENGTH     (PI-COMM-LENGTH)
  7959*    END-EXEC.
  7960*    MOVE '.$C                   %   #00007138' TO DFHEIV0
  7961     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7962     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7963     MOVE X'2020233030303037313338' TO DFHEIV0(25:11)
  7964     CALL 'kxdfhei1' USING DFHEIV0,
  7965           PGM-NAME,
  7966           PROGRAM-INTERFACE-BLOCK,
  7967           PI-COMM-LENGTH,
  7968           DFHEIV99
  7969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7970
  7971 9400-CLEAR.
  7972     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  7973
  7974* EXEC CICS XCTL
  7975*        PROGRAM    (PGM-NAME)
  7976*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7977*        LENGTH     (PI-COMM-LENGTH)
  7978*    END-EXEC.
  7979*    MOVE '.$C                   %   #00007145' TO DFHEIV0
  7980     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7981     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7982     MOVE X'2020233030303037313435' TO DFHEIV0(25:11)
  7983     CALL 'kxdfhei1' USING DFHEIV0,
  7984           PGM-NAME,
  7985           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 140
* EL6317.cbl
  7986           PI-COMM-LENGTH,
  7987           DFHEIV99
  7988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7989
  7990 9500-PF12.
  7991     MOVE XCTL-010               TO PGM-NAME.
  7992     GO TO 9300-XCTL.
  7993 9600-PGMID-ERROR.
  7994
  7995* EXEC CICS HANDLE CONDITION
  7996*        PGMIDERR    (8300-SEND-TEXT)
  7997*    END-EXEC.
  7998*    MOVE '"$L                   ! " #00007154' TO DFHEIV0
  7999     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8001     MOVE X'2220233030303037313534' TO DFHEIV0(25:11)
  8002     CALL 'kxdfhei1' USING DFHEIV0
  8003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8004
  8005     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8006     MOVE ' '                    TO PI-ENTRY-CD-1.
  8007     MOVE XCTL-005               TO PGM-NAME.
  8008     MOVE PGM-NAME               TO LOGOFF-PGM.
  8009     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8010     GO TO 9300-XCTL.
  8011 9700-DATE-LINK.
  8012     MOVE LINK-ELDATCV           TO PGM-NAME.
  8013
  8014* EXEC CICS LINK
  8015*        PROGRAM    (PGM-NAME)
  8016*        COMMAREA   (DATE-CONVERSION-DATA)
  8017*        LENGTH     (DC-COMM-LENGTH)
  8018*    END-EXEC.
  8019*    MOVE '."C                   (   #00007165' TO DFHEIV0
  8020     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8021     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8022     MOVE X'2020233030303037313635' TO DFHEIV0(25:11)
  8023     CALL 'kxdfhei1' USING DFHEIV0,
  8024           PGM-NAME,
  8025           DATE-CONVERSION-DATA,
  8026           DC-COMM-LENGTH,
  8027           DFHEIV99,
  8028           DFHEIV99,
  8029           DFHEIV99,
  8030           DFHEIV99
  8031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8032
  8033 9900-ERROR-FORMAT.
  8034     IF NOT EMI-ERRORS-COMPLETE
  8035        MOVE LINK-001            TO PGM-NAME
  8036
  8037* EXEC CICS LINK
  8038*           PROGRAM    (PGM-NAME)
  8039*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8040*           LENGTH     (EMI-COMM-LENGTH)
  8041*       END-EXEC
  8042*    MOVE '."C                   (   #00007173' TO DFHEIV0
  8043     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 141
* EL6317.cbl
  8044     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8045     MOVE X'2020233030303037313733' TO DFHEIV0(25:11)
  8046     CALL 'kxdfhei1' USING DFHEIV0,
  8047           PGM-NAME,
  8048           ERROR-MESSAGE-INTERFACE-BLOCK,
  8049           EMI-COMM-LENGTH,
  8050           DFHEIV99,
  8051           DFHEIV99,
  8052           DFHEIV99,
  8053           DFHEIV99
  8054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8055     END-IF
  8056     .
  8057 9900-EXIT.
  8058     EXIT.
  8059 9990-ABEND.
  8060     MOVE LINK-004               TO PGM-NAME.
  8061     MOVE DFHEIBLK               TO EMI-LINE1.
  8062
  8063* EXEC CICS LINK
  8064*        PROGRAM   (PGM-NAME)
  8065*        COMMAREA  (EMI-LINE1)
  8066*        LENGTH    (72)
  8067*    END-EXEC.
  8068     MOVE 72
  8069       TO DFHEIV11
  8070*    MOVE '."C                   (   #00007185' TO DFHEIV0
  8071     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8073     MOVE X'2020233030303037313835' TO DFHEIV0(25:11)
  8074     CALL 'kxdfhei1' USING DFHEIV0,
  8075           PGM-NAME,
  8076           EMI-LINE1,
  8077           DFHEIV11,
  8078           DFHEIV99,
  8079           DFHEIV99,
  8080           DFHEIV99,
  8081           DFHEIV99
  8082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8083
  8084     GO TO 8200-SEND-DATAONLY.
  8085
  8086* GOBACK.
  8087     MOVE '9%                    "   ' TO DFHEIV0
  8088     MOVE 'EL6317' TO DFHEIV1
  8089     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8090     GOBACK.
  8091 9995-SECURITY-VIOLATION.
  8092*                            COPY ELCSCTP.
  8093******************************************************************
  8094*                                                                *
  8095*                            ELCSCTP                             *
  8096*                            VMOD=2.001                          *
  8097*                                                                *
  8098*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8099******************************************************************
  8100
  8101
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:19 Page 142
* EL6317.cbl
  8102     MOVE EIBDATE          TO SM-JUL-DATE.
  8103     MOVE EIBTRMID         TO SM-TERMID.
  8104     MOVE THIS-PGM         TO SM-PGM.
  8105     MOVE EIBTIME          TO TIME-IN.
  8106     MOVE TIME-OUT         TO SM-TIME.
  8107     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8108
  8109
  8110* EXEC CICS LINK
  8111*         PROGRAM  ('EL003')
  8112*         COMMAREA (SECURITY-MESSAGE)
  8113*         LENGTH   (80)
  8114*    END-EXEC.
  8115     MOVE 'EL003' TO DFHEIV1
  8116     MOVE 80
  8117       TO DFHEIV11
  8118*    MOVE '."C                   (   #00007210' TO DFHEIV0
  8119     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8121     MOVE X'2020233030303037323130' TO DFHEIV0(25:11)
  8122     CALL 'kxdfhei1' USING DFHEIV0,
  8123           DFHEIV1,
  8124           SECURITY-MESSAGE,
  8125           DFHEIV11,
  8126           DFHEIV99,
  8127           DFHEIV99,
  8128           DFHEIV99,
  8129           DFHEIV99
  8130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8131
  8132
  8133******************************************************************
  8134
  8135 9995-EXIT.
  8136     EXIT.
  8137
  8138 9999-DFHBACK SECTION.
  8139     MOVE '9%                    "   ' TO DFHEIV0
  8140     MOVE 'EL6317' TO DFHEIV1
  8141     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8142     GOBACK.
  8143 9999-DFHEXIT.
  8144     IF DFHEIGDJ EQUAL 0001
  8145         NEXT SENTENCE
  8146     ELSE IF DFHEIGDJ EQUAL 2
  8147         GO TO 8300-SEND-TEXT
  8148         DEPENDING ON DFHEIGDI.
  8149     MOVE '9%                    "   ' TO DFHEIV0
  8150     MOVE 'EL6317' TO DFHEIV1
  8151     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8152     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34484     Code:       18207
