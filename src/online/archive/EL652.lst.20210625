* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   1
* EL652.cbl
* Options: int("EL652.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL652.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL652.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL652.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL652 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 09/14/94 07:57:28.
     7*                            VMOD=2.059
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11*
    12*REMARKS.
    13*        TRANSACTION - EXD4 - COMPENSATION MASTER MAINT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   2
* EL652.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    24* 102202    2002032200002  SMVA  ADD PF8 KEY FOR COMP MSTR NOTES
    25* 111103    2003080800002  PEMA  ADD BANKFEE,CLPST,MAXFEE  & PF10
    26*                                FOR SECURE PAY
    27* 111204    2004110300005  PEMA  SPLIT AGENT COMMISSION CHANGES
    28* 033105    2005031100003  PEMA  ADD VALID TYPE OF 'B' (BANK)
    29* 042005    2005031100004  PEMA  ALLOW UPDATES TO PCONT FOR 'B'
    30* 042005                         AND 'G' RECORD TYPES.
    31* 092205    2005050300006  PEMA  ADD LEASE FEES
    32* 041106    2006022800001  AJRA  INIT CO-FIRST-WRITTEN-DT ON ADD
    33* 060506    2002061100007  PEMA  ADD CODES TO ERCOMP FILE
    34* 072406    2006022400001  PEMA  ADD REFUND ONLY EDIT
    35* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    36* 043007  IR2007042600002  PEMA  TURN OFF YTDCOMM ATTR
    37* 102908  CR2007052100005  PEMA  UNPROT PCONT ATTRB
    38* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    39* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    40* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    41* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    42******************************************************************
    43
    44 ENVIRONMENT DIVISION.
    45 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   3
* EL652.cbl
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*    EL652 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.059 *********'.
    52 77  WS-TOT-FEES                 PIC S9(3)V99 COMP-3 VALUE +0.
    53 77  S1                          PIC S999 VALUE +0 COMP-3.
    54
    55 01  WS-DATE-AREA.
    56     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    57     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    58
    59 01  STANDARD-AREAS.
    60     12  WS-RESPONSE             PIC S9(8)   COMP.
    61         88  RESP-NORMAL                  VALUE +00.
    62         88  RESP-NOTFND                  VALUE +13.
    63         88  RESP-NOTOPEN                 VALUE +19.
    64         88  RESP-ENDFILE                 VALUE +20.
    65     12  RETURNED-FROM       PIC X(8)        VALUE SPACES.
    66     12  QID-PI.
    67         16  QID-TERM        PIC X(4).
    68         16  FILLER          PIC X(4)        VALUE '652A'.
    69     12  QID-ITEM            PIC S9(4) COMP  VALUE +0001.
    70     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
    71     12  MAP-NAME            PIC  X(8)       VALUE 'EL652A'.
    72     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL652S'.
    73     12  TRANS-ID            PIC  X(4)       VALUE 'EXD4'.
    74     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
    75     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
    76     12  EL633-TRANS-ID      PIC  X(4)       VALUE 'EXB7'.
    77     12  EL633DMD-TRANS-ID   PIC  X(4)       VALUE 'EX1F'.
    78     12  EL635-TRANS-ID      PIC  X(4)       VALUE 'EXJ4'.
    79     12  EL6501-TRANS-ID     PIC  X(4)       VALUE 'EXC5'.
    80     12  EL6592-TRANS-ID     PIC  X(4)       VALUE 'EX66'.
    81     12  EL856-TRANS-ID      PIC  X(4)       VALUE 'EXJ8'.
    82     12  EM6508-TRANS-ID     PIC  X(4)       VALUE 'MXG8'.
    83     12  THIS-PGM            PIC  X(8)       VALUE 'EL652'.
    84     12  PGM-NAME            PIC  X(8).
    85     12  WS-COMP-CD-R.
    86         16  FILLER          PIC  X.
    87         16  WS-COMP-CD-X    PIC  X.
    88     12  WS-COMP-CD  REDEFINES
    89         WS-COMP-CD-R        PIC S9(4)                  COMP.
    90     12  TIME-IN             PIC S9(7).
    91     12  TIME-OUT-R  REDEFINES  TIME-IN.
    92         16  FILLER          PIC  X.
    93         16  TIME-OUT        PIC  99V99.
    94         16  FILLER          PIC  XX.
    95     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
    96     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
    97     12  XCTL-126            PIC  X(8)       VALUE 'EL126'.
    98     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
    99     12  XCTL-633            PIC  X(8)       VALUE 'EL633'.
   100     12  XCTL-633DMD         PIC  X(8)       VALUE 'EL633DMD'.
   101     12  XCTL-635            PIC  X(8)       VALUE 'EL635'.
   102     12  XCTL-650            PIC  X(8)       VALUE 'EL650'.
   103     12  XCTL-6521           PIC  X(8)       VALUE 'EL6521'.
   104     12  XCTL-6522           PIC  X(8)       VALUE 'EL6522'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   4
* EL652.cbl
   105     12  XCTL-6523           PIC  X(8)       VALUE 'EL6523'.
   106     12  XCTL-6524           PIC  X(8)       VALUE 'EL6524'.
   107     12  XCTL-689            PIC  X(8)       VALUE 'EL689'.
   108     12  XCTL-690            PIC  X(8)       VALUE 'EL690'.
   109     12  XCTL-856            PIC  X(8)       VALUE 'EL856'.
   110     12  XCTL-EM626          PIC  X(8)       VALUE 'EM626'.
   111     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   112     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   113     12  LINK-ELDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   114     12  FILE-ID             PIC  X(8)       VALUE SPACES.
   115     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   116     12  NAME-FILE-ID        PIC  X(8)       VALUE 'ERNAME'.
   117     12  CNTL-FILE-ID        PIC  X(8)       VALUE 'ELCNTL'.
   118     12  SUMM-FILE-ID        PIC  X(8)       VALUE 'ERSUMM'.
   119     12  RQST-FILE-ID        PIC  X(8)       VALUE 'ERRQST'.
   120     12  RQST-FILE-ID-3      PIC  X(8)       VALUE 'ERRQST3'.
   121
   122 01  MISC-WORK-AREAS.
   123     12  WS-SRCH-STATE       PIC X(30)  VALUE SPACES.
   124     12  STNDX               PIC S999   COMP-3 VALUE +0.
   125     12  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +35.
   126     12  WS-PHONE-IN         PIC  9(10).
   127     12  WS-PHONE-IN-R  REDEFINES  WS-PHONE-IN.
   128         16  WSPI-AREA       PIC  X(3).
   129         16  WSPI-PFX        PIC  X(3).
   130         16  WSPI-SFX        PIC  X(4).
   131     12  WS-PHONE-OUT.
   132         16  WSPO-AREA       PIC  X(3).
   133         16  FILLER          PIC  X            VALUE '-'.
   134         16  WSPO-PFX        PIC  X(3).
   135         16  FILLER          PIC  X            VALUE '-'.
   136         16  WSPO-SFX        PIC  X(4).
   137     12  DEEDIT-FIELD        PIC  X(15).
   138     12  DEEDIT-FIELD-V0  REDEFINES
   139         DEEDIT-FIELD        PIC S9(15).
   140     12  DEEDIT-FIELD-V1  REDEFINES
   141         DEEDIT-FIELD        PIC S9(13)V99.
   142     12  SUB1                PIC S9(4)         VALUE +0   COMP.
   143     12  SUB2                PIC S9(4)         VALUE +0   COMP.
   144     12  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   145     12  ERCOMP-LENGTH       PIC S9(4)         VALUE +700 COMP.
   146     12  ERSUMM-LENGTH       PIC S9(4)         VALUE +150 COMP.
   147     12  ERNAME-LENGTH       PIC S9(4)         VALUE +160 COMP.
   148     12  SV-CLMTOL           PIC  9(3)V99      VALUE ZEROS.
   149     12  WK-DATE.
   150         16  WK-MO           PIC  99.
   151         16  WK-DA           PIC  99.
   152         16  WK-YR           PIC  99.
   153     12  DATE-TEST-AREA      PIC  9(6).
   154     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   155         16  DATE-TEST-MM    PIC  99.
   156         16  DATE-TEST-DD    PIC  99.
   157         16  DATE-TEST-YY    PIC  99.
   158     12  DIVIDE-RESULT       PIC  99.
   159     12  DIVIDE-REMAINDER    PIC  9.
   160     12  WS-ZERO             PIC  X            VALUE '0'.
   161     12  WS-ONE              PIC  X            VALUE '1'.
   162     12  WS-TWO              PIC  X            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   5
* EL652.cbl
   163     12  WS-ACCESS.
   164         16  FILLER          PIC  X(3)         VALUE SPACES.
   165         16  WS-CARRIER      PIC  X.
   166     12  BIN-CURRENT-SAVE    PIC  XX.
   167     12  WS-BROWSE-SW        PIC  X.
   168         88  BROWSE-STARTED                    VALUE 'Y'.
   169     12  WS-SAVE-KEY         PIC  X(29)        VALUE SPACES.
   170     12  WS-SAVE-SUMM        PIC  X(6)         VALUE SPACES.
   171     12  WS-SUMM-FOR-RQST    PIC  X(6)         VALUE SPACES.
   172     12  WS-SAVE-RQST        PIC X(46)         VALUE SPACES.
   173     12  WS-SHOW-SAVE-TOTALS PIC  X            VALUE SPACE.
   174         88  SHOW-SAVE-TOTALS                  VALUE 'Y'.
   175     12  ELCNTL-KEY.
   176         16  CNTL-COMP-ID    PIC  X(3)         VALUE SPACES.
   177         16  CNTL-REC-TYPE   PIC  X            VALUE SPACES.
   178         16  CNTL-ACCESS     PIC  X(4)         VALUE SPACES.
   179         16  CNTL-SEQ-NO     PIC S9(4)         VALUE +0   COMP.
   180     12  ELCNTL-KEY2.
   181         16  CNTL-COMP-ID-2  PIC  X(3)         VALUE SPACES.
   182         16  CNTL-REC-TYPE-2 PIC  X            VALUE SPACES.
   183         16  CNTL-STATE-2    PIC  X(2)         VALUE SPACES.
   184         16  FILLER          PIC  X(2)         VALUE SPACES.
   185         16  CNTL-SEQ-NO-2   PIC S9(4)         VALUE +0   COMP.
   186     12  ERSUMM-KEY.
   187         16  SUMM-COMP-ID    PIC  X            VALUE SPACES.
   188         16  SUMM-SUMMARY    PIC  X(6)         VALUE SPACES.
   189         16  SUMM-CARRIER    PIC  X            VALUE SPACES.
   190         16  SUMM-GROUP      PIC  X(6)         VALUE SPACES.
   191         16  SUMM-FIN-RESP   PIC  X(10)        VALUE SPACES.
   192         16  SUMM-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   193     12  ERRQST-KEY.
   194         16  RQST-COMP-ID-PC PIC  X            VALUE SPACES.
   195         16  RQST-BATCH-PC   PIC  X(6)         VALUE SPACES.
   196     12  ERRQST-KEY-3.
   197         16  RQST-COMP-ID    PIC  X            VALUE SPACES.
   198         16  RQST-CARRIER    PIC  X            VALUE SPACES.
   199         16  RQST-GROUP      PIC  X(6)         VALUE SPACES.
   200         16  RQST-FIN-RESP   PIC  X(10)        VALUE SPACES.
   201         16  RQST-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   202         16  RQST-REFERENCE  PIC  X(12)        VALUE SPACES.
   203         16  RQST-BATCH      PIC  X(06)        VALUE SPACES.
   204     12  WS-DATE-MDY-8.
   205         16  WS-DMDY8-MM     PIC  XX.
   206         16  WS-DMDY8-SL1    PIC  X.
   207         16  WS-DMDY8-DD     PIC  XX.
   208         16  WS-DMDY8-SL2    PIC  X.
   209         16  WS-DMDY8-YY     PIC  XX.
   210     12  WS-DATE-MDY-6  REDEFINES  WS-DATE-MDY-8.
   211         16  WS-DMDY6-MM     PIC  XX.
   212         16  WS-DMDY6-DD     PIC  XX.
   213         16  WS-DMDY6-YY     PIC  XX.
   214         16  WS-DMDY6-BLNK   PIC  XX.
   215     12  WS-YMD-DATE.
   216         16  WS-YMD-YY       PIC  XX.
   217         16  WS-YMD-MM       PIC  XX.
   218         16  WS-YMD-DD       PIC  XX.
   219     12  WS-YMD-DATE-NUM  REDEFINES
   220         WS-YMD-DATE         PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   6
* EL652.cbl
   221     12  WS-SAVE-SUMMARY     PIC X(6)          VALUE SPACES.
   222     12  WS-SAVE-NAME        PIC X(30)         VALUE SPACES.
   223     12  WS-SAVE-BALFWD      PIC S9(7)V99      VALUE +0   COMP-3.
   224     12  WS-SAVE-CURCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   225     12  WS-SAVE-CURCHG      PIC S9(7)V99      VALUE +0   COMP-3.
   226     12  WS-SAVE-CURPMT      PIC S9(7)V99      VALUE +0   COMP-3.
   227     12  WS-SAVE-ENDBAL      PIC S9(7)V99      VALUE +0   COMP-3.
   228     12  WS-SAVE-YTDCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   229     12  WS-SOC-SEC-WORK-FIELD.
   230         16  WS-SS-TYPE          PIC X.
   231         16  WS-SOC-SEC          PIC X(12).
   232
   233     12  WS-ZIP-CODE.
   234         16  WS-ZIP-1            PIC X.
   235             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   236         16  WS-ZIP-2-3          PIC XX.
   237         16  WS-ZIP-4            PIC X.
   238         16  WS-ZIP-5            PIC X.
   239         16  WS-ZIP-6            PIC X.
   240         16  FILLER              PIC X(4).
   241     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   242         16  WS-ZIP-AM-1-CODE    PIC X(5).
   243         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   244         16  FILLER              PIC X.
   245     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   246         16  WS-ZIP-AM-2-CODE    PIC X(5).
   247         16  WS-ZIP-AM-2-DASH    PIC X.
   248         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   249     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   250         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   251         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   252         16  FILLER              PIC X(4).
   253     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   254         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   255         16  FILLER              PIC X.
   256         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   257         16  FILLER              PIC XXX.
   258
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   7
* EL652.cbl
   260 01  ERROR-NUMBERS.
   261     12  ER-0000             PIC  X(4)       VALUE '0000'.
   262     12  ER-0002             PIC  X(4)       VALUE '0002'.
   263     12  ER-0004             PIC  X(4)       VALUE '0004'.
   264     12  ER-0008             PIC  X(4)       VALUE '0008'.
   265     12  ER-0029             PIC  X(4)       VALUE '0029'.
   266     12  ER-0033             PIC  X(4)       VALUE '0033'.
   267     12  ER-0035             PIC  X(4)       VALUE '0035'.
   268     12  ER-0046             PIC  X(4)       VALUE '0046'.
   269     12  ER-0068             PIC  X(4)       VALUE '0068'.
   270     12  ER-0070             PIC  X(4)       VALUE '0070'.
   271     12  ER-0142             PIC  X(4)       VALUE '0142'.
   272     12  ER-0144             PIC  X(4)       VALUE '0144'.
   273     12  ER-0187             PIC  X(4)       VALUE '0187'.
   274     12  ER-0193             PIC  X(4)       VALUE '0193'.
   275     12  ER-0314             PIC  X(4)       VALUE '0314'.
   276     12  ER-0584             PIC  X(4)       VALUE '0584'.
   277     12  ER-0829             PIC  X(4)       VALUE '0829'.
   278     12  ER-1299             PIC  X(4)       VALUE '1299'.
   279     12  ER-1778             PIC  X(4)       VALUE '1778'.
   280     12  ER-1883             PIC  X(4)       VALUE '1883'.
   281     12  ER-2039             PIC  X(4)       VALUE '2039'.
   282     12  ER-2042             PIC  X(4)       VALUE '2042'.
   283     12  ER-2045             PIC  X(4)       VALUE '2045'.
   284     12  ER-2046             PIC  X(4)       VALUE '2046'.
   285     12  ER-2047             PIC  X(4)       VALUE '2047'.
   286     12  ER-2048             PIC  X(4)       VALUE '2048'.
   287     12  ER-2049             PIC  X(4)       VALUE '2049'.
   288     12  ER-2050             PIC  X(4)       VALUE '2050'.
   289     12  ER-2055             PIC  X(4)       VALUE '2055'.
   290     12  ER-2056             PIC  X(4)       VALUE '2056'.
   291     12  ER-2057             PIC  X(4)       VALUE '2057'.
   292     12  ER-2067             PIC  X(4)       VALUE '2067'.
   293     12  ER-2088             PIC  X(4)       VALUE '2088'.
   294     12  ER-2089             PIC  X(4)       VALUE '2089'.
   295     12  ER-2091             PIC  X(4)       VALUE '2091'.
   296     12  ER-2092             PIC  X(4)       VALUE '2092'.
   297     12  ER-2093             PIC  X(4)       VALUE '2093'.
   298     12  ER-2094             PIC  X(4)       VALUE '2094'.
   299     12  ER-2095             PIC  X(4)       VALUE '2095'.
   300     12  ER-2096             PIC  X(4)       VALUE '2096'.
   301     12  ER-2097             PIC  X(4)       VALUE '2097'.
   302     12  ER-2209             PIC  X(4)       VALUE '2209'.
   303     12  ER-2238             PIC  X(4)       VALUE '2238'.
   304     12  ER-2370             PIC  X(4)       VALUE '2370'.
   305     12  ER-2572             PIC  X(4)       VALUE '2572'.
   306     12  ER-2717             PIC  X(4)       VALUE '2717'.
   307     12  ER-2790             PIC  X(4)       VALUE '2790'.
   308     12  ER-2872             PIC  X(4)       VALUE '2872'.
   309     12  ER-3021             PIC  X(4)       VALUE '3021'.
   310     12  ER-3053             PIC  X(4)       VALUE '3053'.
   311     12  ER-3055             PIC  X(4)       VALUE '3055'.
   312     12  ER-3056             PIC  X(4)       VALUE '3056'.
   313     12  ER-3150             PIC  X(4)       VALUE '3150'.
   314     12  ER-3151             PIC  X(4)       VALUE '3151'.
   315     12  ER-3152             PIC  X(4)       VALUE '3152'.
   316     12  ER-3153             PIC  X(4)       VALUE '3153'.
   317     12  ER-3154             PIC  X(4)       VALUE '3154'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   8
* EL652.cbl
   318     12  ER-3168             PIC  X(4)       VALUE '3168'.
   319     12  ER-3170             PIC  X(4)       VALUE '3170'.
   320     12  ER-3174             PIC  X(4)       VALUE '3174'.
   321     12  ER-3261             PIC  X(4)       VALUE '3261'.
   322     12  ER-9096             PIC  X(4)       VALUE '9096'.
   323     12  ER-9097             PIC  X(4)       VALUE '9097'.
   324     12  ER-9999             PIC  X(4)       VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   9
* EL652.cbl
   326*                          COPY ELCSCTM.
   327******************************************************************
   328*                                                                *
   329*                                                                *
   330*                            ELCSCTM                             *
   331*                            VMOD=2.001                          *
   332*                                                                *
   333*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   334*                                                                *
   335******************************************************************
   336 01  SECURITY-MESSAGE.
   337     12  FILLER                          PIC X(30)
   338            VALUE '** LOGIC SECURITY VIOLATION -'.
   339     12  SM-READ                         PIC X(6).
   340     12  FILLER                          PIC X(5)
   341            VALUE ' PGM='.
   342     12  SM-PGM                          PIC X(6).
   343     12  FILLER                          PIC X(5)
   344            VALUE ' OPR='.
   345     12  SM-PROCESSOR-ID                 PIC X(4).
   346     12  FILLER                          PIC X(6)
   347            VALUE ' TERM='.
   348     12  SM-TERMID                       PIC X(4).
   349     12  FILLER                          PIC XX   VALUE SPACE.
   350     12  SM-JUL-DATE                     PIC 9(5).
   351     12  FILLER                          PIC X    VALUE SPACE.
   352     12  SM-TIME                         PIC 99.99.
   353
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  10
* EL652.cbl
   355*                          COPY ELCSCRTY.
   356******************************************************************
   357*                                                                *
   358*                                                                *
   359*                            ELCSCRTY                            *
   360*                            VMOD=2.001                          *
   361*                                                                *
   362*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   363*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   364*        SAVED IN PI-SECURITY-ADDRESS.                           *
   365*                                                                *
   366******************************************************************
   367 01  SECURITY-CONTROL.
   368     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   369     12  FILLER                       PIC XX    VALUE 'SC'.
   370     12  SC-CREDIT-CODES.
   371         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   372             20  SC-CREDIT-DISPLAY    PIC X.
   373             20  SC-CREDIT-UPDATE     PIC X.
   374     12  SC-CLAIMS-CODES.
   375         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   376             20  SC-CLAIMS-DISPLAY    PIC X.
   377             20  SC-CLAIMS-UPDATE     PIC X.
   378*                          COPY MPCSCRT.
   379******************************************************************
   380*                                                                *
   381*                            MPCSCRT                             *
   382*                            VMOD=1.001                          *
   383*                                                                *
   384*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   385*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   386*                                      (MP MORTGAGE PROTECTION)  *
   387*                                                                *
   388******************************************************************
   389*
   390 01  SECURITY-CONTROL-E.
   391     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   392     12  FILLER                       PIC  X(02) VALUE 'SC'.
   393     12  SC-QUID-KEY.
   394         16  SC-QUID-TERMINAL         PIC  X(04).
   395         16  SC-QUID-SYSTEM           PIC  X(04).
   396     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   397     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   398     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   399         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   400         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   401     12  SC-MP-CODES.
   402         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   403             20  SC-MP-DISPLAY        PIC  X(01).
   404             20  SC-MP-UPDATE         PIC  X(01).
   405     12  FILLER                       PIC  X(40).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  11
* EL652.cbl
   407 01  FILLER                  PIC X(16)  VALUE ALL 'A'.
   408*                          COPY ELCDATE.
   409******************************************************************
   410*                                                                *
   411*                                                                *
   412*                            ELCDATE.                            *
   413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   414*                            VMOD=2.003
   415*                                                                *
   416*                                                                *
   417*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   418*                 LENGTH = 200                                   *
   419******************************************************************
   420
   421 01  DATE-CONVERSION-DATA.
   422     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   423     12  DC-OPTION-CODE                PIC X.
   424         88  BIN-TO-GREG                VALUE ' '.
   425         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   426         88  EDIT-GREG-TO-BIN           VALUE '2'.
   427         88  YMD-GREG-TO-BIN            VALUE '3'.
   428         88  MDY-GREG-TO-BIN            VALUE '4'.
   429         88  JULIAN-TO-BIN              VALUE '5'.
   430         88  BIN-PLUS-ELAPSED           VALUE '6'.
   431         88  FIND-CENTURY               VALUE '7'.
   432         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   433         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   434         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   435         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   436         88  JULIAN-TO-BIN-3            VALUE 'C'.
   437         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   438         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   439         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   440         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   441         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   442         88  CHECK-LEAP-YEAR            VALUE 'H'.
   443         88  BIN-3-TO-GREG              VALUE 'I'.
   444         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   445         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   446         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   447         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   448         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   449         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   450         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   451         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   452         88  THREE-CHARACTER-BIN
   453                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   454         88  GREGORIAN-TO-BIN
   455                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   456         88  BIN-TO-GREGORIAN
   457                  VALUES ' ' '1' 'I' '8' 'G'.
   458         88  JULIAN-TO-BINARY
   459                  VALUES '5' 'C' 'E' 'F'.
   460     12  DC-ERROR-CODE                 PIC X.
   461         88  NO-CONVERSION-ERROR        VALUE ' '.
   462         88  DATE-CONVERSION-ERROR
   463                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   464         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  12
* EL652.cbl
   465         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   466         88  DATE-IS-INVALID            VALUE '3'.
   467         88  DATE1-GREATER-DATE2        VALUE '4'.
   468         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   469         88  DATE-INVALID-OPTION        VALUE '9'.
   470         88  INVALID-CENTURY            VALUE 'A'.
   471         88  ONLY-CENTURY               VALUE 'B'.
   472         88  ONLY-LEAP-YEAR             VALUE 'C'.
   473         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   474     12  DC-END-OF-MONTH               PIC X.
   475         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   476     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   477         88  USE-NORMAL-PROCESS         VALUE ' '.
   478         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   479         88  ADJUST-UP-100-YRS          VALUE '2'.
   480     12  FILLER                        PIC X.
   481     12  DC-CONVERSION-DATES.
   482         16  DC-BIN-DATE-1             PIC XX.
   483         16  DC-BIN-DATE-2             PIC XX.
   484         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   485         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   486                       DC-GREG-DATE-1-EDIT.
   487             20  DC-EDIT1-MONTH        PIC 99.
   488             20  SLASH1-1              PIC X.
   489             20  DC-EDIT1-DAY          PIC 99.
   490             20  SLASH1-2              PIC X.
   491             20  DC-EDIT1-YEAR         PIC 99.
   492         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   493         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   494                     DC-GREG-DATE-2-EDIT.
   495             20  DC-EDIT2-MONTH        PIC 99.
   496             20  SLASH2-1              PIC X.
   497             20  DC-EDIT2-DAY          PIC 99.
   498             20  SLASH2-2              PIC X.
   499             20  DC-EDIT2-YEAR         PIC 99.
   500         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   501         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   502                     DC-GREG-DATE-1-YMD.
   503             20  DC-YMD-YEAR           PIC 99.
   504             20  DC-YMD-MONTH          PIC 99.
   505             20  DC-YMD-DAY            PIC 99.
   506         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   507         16  DC-GREG-DATE-1-MDY-R REDEFINES
   508                      DC-GREG-DATE-1-MDY.
   509             20  DC-MDY-MONTH          PIC 99.
   510             20  DC-MDY-DAY            PIC 99.
   511             20  DC-MDY-YEAR           PIC 99.
   512         16  DC-GREG-DATE-1-ALPHA.
   513             20  DC-ALPHA-MONTH        PIC X(10).
   514             20  DC-ALPHA-DAY          PIC 99.
   515             20  FILLER                PIC XX.
   516             20  DC-ALPHA-CENTURY.
   517                 24 DC-ALPHA-CEN-N     PIC 99.
   518             20  DC-ALPHA-YEAR         PIC 99.
   519         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   520         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   521         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   522         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  13
* EL652.cbl
   523         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   524                                       PIC 9(05).
   525         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   526             20  DC-JULIAN-YEAR        PIC 99.
   527             20  DC-JULIAN-DAYS        PIC 999.
   528         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   529         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   530         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   531     12  DATE-CONVERSION-VARIBLES.
   532         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   533         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   534             20  FILLER                PIC 9(3).
   535             20  HOLD-CEN-1-CCYY.
   536                 24  HOLD-CEN-1-CC     PIC 99.
   537                 24  HOLD-CEN-1-YY     PIC 99.
   538             20  HOLD-CEN-1-MO         PIC 99.
   539             20  HOLD-CEN-1-DA         PIC 99.
   540         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   541             20  HOLD-CEN-1-R-MO       PIC 99.
   542             20  HOLD-CEN-1-R-DA       PIC 99.
   543             20  HOLD-CEN-1-R-CCYY.
   544                 24  HOLD-CEN-1-R-CC   PIC 99.
   545                 24  HOLD-CEN-1-R-YY   PIC 99.
   546             20  FILLER                PIC 9(3).
   547         16  HOLD-CENTURY-1-X.
   548             20  FILLER                PIC X(3)  VALUE SPACES.
   549             20  HOLD-CEN-1-X-CCYY.
   550                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   551                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   552             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   553             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   554         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   555             20  HOLD-CEN-1-R-X-MO     PIC XX.
   556             20  HOLD-CEN-1-R-X-DA     PIC XX.
   557             20  HOLD-CEN-1-R-X-CCYY.
   558                 24  HOLD-CEN-1-R-X-CC PIC XX.
   559                 24  HOLD-CEN-1-R-X-YY PIC XX.
   560             20  FILLER                PIC XXX.
   561         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   562         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   563         16  DC-JULIAN-DATE-1          PIC 9(07).
   564         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   565             20  DC-JULIAN-1-CCYY.
   566                 24  DC-JULIAN-1-CC    PIC 99.
   567                 24  DC-JULIAN-1-YR    PIC 99.
   568             20  DC-JULIAN-DA-1        PIC 999.
   569         16  DC-JULIAN-DATE-2          PIC 9(07).
   570         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   571             20  DC-JULIAN-2-CCYY.
   572                 24  DC-JULIAN-2-CC    PIC 99.
   573                 24  DC-JULIAN-2-YR    PIC 99.
   574             20  DC-JULIAN-DA-2        PIC 999.
   575         16  DC-GREG-DATE-A-EDIT.
   576             20  DC-EDITA-MONTH        PIC 99.
   577             20  SLASHA-1              PIC X VALUE '/'.
   578             20  DC-EDITA-DAY          PIC 99.
   579             20  SLASHA-2              PIC X VALUE '/'.
   580             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  14
* EL652.cbl
   581                 24  DC-EDITA-CENT     PIC 99.
   582                 24  DC-EDITA-YEAR     PIC 99.
   583         16  DC-GREG-DATE-B-EDIT.
   584             20  DC-EDITB-MONTH        PIC 99.
   585             20  SLASHB-1              PIC X VALUE '/'.
   586             20  DC-EDITB-DAY          PIC 99.
   587             20  SLASHB-2              PIC X VALUE '/'.
   588             20  DC-EDITB-CCYY.
   589                 24  DC-EDITB-CENT     PIC 99.
   590                 24  DC-EDITB-YEAR     PIC 99.
   591         16  DC-GREG-DATE-CYMD         PIC 9(08).
   592         16  DC-GREG-DATE-CYMD-R REDEFINES
   593                              DC-GREG-DATE-CYMD.
   594             20  DC-CYMD-CEN           PIC 99.
   595             20  DC-CYMD-YEAR          PIC 99.
   596             20  DC-CYMD-MONTH         PIC 99.
   597             20  DC-CYMD-DAY           PIC 99.
   598         16  DC-GREG-DATE-MDCY         PIC 9(08).
   599         16  DC-GREG-DATE-MDCY-R REDEFINES
   600                              DC-GREG-DATE-MDCY.
   601             20  DC-MDCY-MONTH         PIC 99.
   602             20  DC-MDCY-DAY           PIC 99.
   603             20  DC-MDCY-CEN           PIC 99.
   604             20  DC-MDCY-YEAR          PIC 99.
   605    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   606        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   607    12  DC-EL310-DATE                  PIC X(21).
   608    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  15
* EL652.cbl
   610*                          COPY ELCLOGOF.
   611******************************************************************
   612*                                                                *
   613*                                                                *
   614*                            ELCLOGOF.                           *
   615*                            VMOD=2.001                          *
   616*                                                                *
   617*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   618*                                                                *
   619******************************************************************
   620 01  CLASIC-LOGOFF.
   621     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   622     12  LOGOFF-TEXT.
   623         16  FILLER          PIC X(5)    VALUE SPACES.
   624         16  LOGOFF-MSG.
   625             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   626             20  FILLER      PIC X       VALUE SPACES.
   627             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   628         16  FILLER          PIC X(80)
   629           VALUE '* YOU ARE NOW LOGGED OFF'.
   630         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   631         16  FILLER          PIC X       VALUE QUOTE.
   632         16  LOGOFF-SYS-MSG  PIC X(17)
   633           VALUE 'S CLAS-IC SYSTEM '.
   634     12  TEXT-MESSAGES.
   635         16  UNACCESS-MSG    PIC X(29)
   636             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   637         16  PGMIDERR-MSG    PIC X(17)
   638             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  16
* EL652.cbl
   640*                          COPY ELCATTR.
   641******************************************************************
   642*                                                                *
   643*                            ELCATTR.                            *
   644*                            VMOD=2.001                          *
   645*                                                                *
   646*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   647*                                                                *
   648*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   649*                                                                *
   650*                   POS 1   P=PROTECTED                          *
   651*                           U=UNPROTECTED                        *
   652*                           S=ASKIP                              *
   653*                   POS 2   A=ALPHA/NUMERIC                      *
   654*                           N=NUMERIC                            *
   655*                   POS 3   N=NORMAL                             *
   656*                           B=BRIGHT                             *
   657*                           D=DARK                               *
   658*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   659*                           OF=MODIFIED DATA TAG OFF             *
   660*                                                                *
   661*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   662******************************************************************
   663 01  ATTRIBUTE-LIST.
   664     12  AL-PABOF            PIC X       VALUE 'Y'.
   665     12  AL-PABON            PIC X       VALUE 'Z'.
   666     12  AL-PADOF            PIC X       VALUE '%'.
   667     12  AL-PADON            PIC X       VALUE '_'.
   668     12  AL-PANOF            PIC X       VALUE '-'.
   669     12  AL-PANON            PIC X       VALUE '/'.
   670     12  AL-SABOF            PIC X       VALUE '8'.
   671     12  AL-SABON            PIC X       VALUE '9'.
   672     12  AL-SADOF            PIC X       VALUE '@'.
   673     12  AL-SADON            PIC X       VALUE QUOTE.
   674     12  AL-SANOF            PIC X       VALUE '0'.
   675     12  AL-SANON            PIC X       VALUE '1'.
   676     12  AL-UABOF            PIC X       VALUE 'H'.
   677     12  AL-UABON            PIC X       VALUE 'I'.
   678     12  AL-UADOF            PIC X       VALUE '<'.
   679     12  AL-UADON            PIC X       VALUE '('.
   680     12  AL-UANOF            PIC X       VALUE ' '.
   681     12  AL-UANON            PIC X       VALUE 'A'.
   682     12  AL-UNBOF            PIC X       VALUE 'Q'.
   683     12  AL-UNBON            PIC X       VALUE 'R'.
   684     12  AL-UNDOF            PIC X       VALUE '*'.
   685     12  AL-UNDON            PIC X       VALUE ')'.
   686     12  AL-UNNOF            PIC X       VALUE '&'.
   687     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  17
* EL652.cbl
   689*                          COPY ELCEMIB.
   690******************************************************************
   691*                                                                *
   692*                                                                *
   693*                            ELCEMIB.                            *
   694*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   695*                            VMOD=2.005                          *
   696*                                                                *
   697*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   698*                                                                *
   699******************************************************************
   700 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   701     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   702     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   703     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   704     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   705     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   706     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   707     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   708     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   709     12  EMI-SWITCH1             PIC X        VALUE '1'.
   710         88  EMI-NO-ERRORS                    VALUE '1'.
   711         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   712         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   713     12  EMI-SWITCH2             PIC X        VALUE '1'.
   714         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   715     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   716         88  EMI-AREA1-EMPTY                  VALUE '1'.
   717         88  EMI-AREA1-FULL                   VALUE '2'.
   718     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   719         88  EMI-AREA2-EMPTY                  VALUE '1'.
   720         88  EMI-AREA2-FULL                   VALUE '2'.
   721     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   722         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   723         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   724         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   725         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   726         88  EMI-BYPASS-FATALS                VALUE 'X'.
   727     12  EMI-ERROR-LINES.
   728         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   729         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   730         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   731         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   732             20  EMI-ERR-CODES OCCURS 10 TIMES.
   733                 24  EMI-ERR-NUM         PIC X(4).
   734                 24  EMI-FILLER          PIC X.
   735                 24  EMI-SEV             PIC X.
   736                 24  FILLER              PIC X.
   737             20  FILLER                  PIC X(02).
   738     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   739         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   740             20  EMI-ERROR-NUMBER    PIC X(4).
   741             20  EMI-FILL            PIC X.
   742             20  EMI-SEVERITY        PIC X.
   743             20  FILLER              PIC X.
   744             20  EMI-ERROR-TEXT.
   745                 24  EMI-TEXT-VARIABLE   PIC X(10).
   746                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  18
* EL652.cbl
   747     12  EMI-SEVERITY-SAVE           PIC X.
   748         88  EMI-NOTE                    VALUE 'N'.
   749         88  EMI-WARNING                 VALUE 'W'.
   750         88  EMI-FORCABLE                VALUE 'F'.
   751         88  EMI-FATAL                   VALUE 'X'.
   752     12  EMI-MESSAGE-FLAG            PIC X.
   753         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   754         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   755     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   756     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   757         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   758         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   759         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   760     12  emi-claim-no                pic x(7).
   761     12  emi-claim-type              pic x(6).
   762     12  FILLER                      PIC X(124)  VALUE SPACES.
   763     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   764     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   765     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   766     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  19
* EL652.cbl
   768 01  FILLER                  PIC X(16)  VALUE ALL 'B'.
   769*                          COPY ELCINTF.
   770******************************************************************
   771*                                                                *
   772*                                                                *
   773*                            ELCINTF.                            *
   774*                            VMOD=2.017                          *
   775*                                                                *
   776*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   777*                                                                *
   778*       LENGTH = 1024                                            *
   779*                                                                *
   780******************************************************************
   781*                   C H A N G E   L O G
   782*
   783* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   784*-----------------------------------------------------------------
   785*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   786* EFFECTIVE    NUMBER
   787*-----------------------------------------------------------------
   788* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   789******************************************************************
   790 01  PROGRAM-INTERFACE-BLOCK.
   791     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   792     12  PI-CALLING-PROGRAM              PIC X(8).
   793     12  PI-SAVED-PROGRAM-1              PIC X(8).
   794     12  PI-SAVED-PROGRAM-2              PIC X(8).
   795     12  PI-SAVED-PROGRAM-3              PIC X(8).
   796     12  PI-SAVED-PROGRAM-4              PIC X(8).
   797     12  PI-SAVED-PROGRAM-5              PIC X(8).
   798     12  PI-SAVED-PROGRAM-6              PIC X(8).
   799     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   800     12  PI-COMPANY-ID                   PIC XXX.
   801     12  PI-COMPANY-CD                   PIC X.
   802
   803     12  PI-COMPANY-PASSWORD             PIC X(8).
   804
   805     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   806
   807     12  PI-CONTROL-IN-PROGRESS.
   808         16  PI-CARRIER                  PIC X.
   809         16  PI-GROUPING                 PIC X(6).
   810         16  PI-STATE                    PIC XX.
   811         16  PI-ACCOUNT                  PIC X(10).
   812         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   813                                         PIC X(10).
   814         16  PI-CLAIM-CERT-GRP.
   815             20  PI-CLAIM-NO             PIC X(7).
   816             20  PI-CERT-NO.
   817                 25  PI-CERT-PRIME       PIC X(10).
   818                 25  PI-CERT-SFX         PIC X.
   819             20  PI-CERT-EFF-DT          PIC XX.
   820         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   821             20  PI-PLAN-CODE            PIC X(2).
   822             20  PI-REVISION-NUMBER      PIC X(3).
   823             20  PI-PLAN-EFF-DT          PIC X(2).
   824             20  PI-PLAN-EXP-DT          PIC X(2).
   825             20  FILLER                  PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  20
* EL652.cbl
   826         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   827             20  PI-OE-REFERENCE-1.
   828                 25  PI-OE-REF-1-PRIME   PIC X(18).
   829                 25  PI-OE-REF-1-SUFF    PIC XX.
   830
   831     12  PI-SESSION-IN-PROGRESS          PIC X.
   832         88  CLAIM-SESSION                   VALUE '1'.
   833         88  CREDIT-SESSION                  VALUE '2'.
   834         88  WARRANTY-SESSION                VALUE '3'.
   835         88  MORTGAGE-SESSION                VALUE '4'.
   836         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   837
   838
   839*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   840
   841     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   842     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   843
   844     12  PI-CREDIT-USER                  PIC X.
   845         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   846         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   847
   848     12  PI-CLAIM-USER                   PIC X.
   849         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   850         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   851
   852     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   853         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   854         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   855         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   856         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   857         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   858
   859     12  PI-PROCESSOR-ID                 PIC X(4).
   860
   861     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   862
   863     12  PI-MEMBER-CAPTION               PIC X(10).
   864
   865     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   866         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   867
   868     12  PI-LIFE-OVERRIDE-L1             PIC X.
   869     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   870     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   871     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   872
   873     12  PI-AH-OVERRIDE-L1               PIC X.
   874     12  PI-AH-OVERRIDE-L2               PIC XX.
   875     12  PI-AH-OVERRIDE-L6               PIC X(6).
   876     12  PI-AH-OVERRIDE-L12              PIC X(12).
   877
   878     12  PI-NEW-SYSTEM                   PIC X(2).
   879
   880     12  PI-PRIMARY-CERT-NO              PIC X(11).
   881     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   882         88  PI-USES-PAID-TO                 VALUE '1'.
   883     12  PI-CRDTCRD-SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  21
* EL652.cbl
   884         16  PI-CRDTCRD-USER             PIC X.
   885             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   886             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   887         16  PI-CC-MONTH-END-DT          PIC XX.
   888     12  PI-PROCESSOR-PRINTER            PIC X(4).
   889
   890     12  PI-OE-REFERENCE-2.
   891         16  PI-OE-REF-2-PRIME           PIC X(10).
   892         16  PI-OE-REF-2-SUFF            PIC X.
   893
   894     12  PI-REM-TRM-CALC-OPTION          PIC X.
   895
   896     12  PI-LANGUAGE-TYPE                PIC X.
   897             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   898             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   899             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   900
   901     12  PI-POLICY-LINKAGE-IND           PIC X.
   902         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   903         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   904                                                   LOW-VALUES.
   905
   906     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   907     12  PI-CLAIM-PW-SESSION             PIC X(1).
   908         88  PI-CLAIM-CREDIT                 VALUE '1'.
   909         88  PI-CLAIM-CONVEN                 VALUE '2'.
   910
   911     12  PI-PROCESSOR-CSR-IND            PIC X.
   912         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   913         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   914
   915     12  FILLER                          PIC X(3).
   916
   917     12  PI-SYSTEM-LEVEL                 PIC X(145).
   918
   919     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   920         PI-SYSTEM-LEVEL.
   921
   922         16  PI-ENTRY-CODES.
   923             20  PI-ENTRY-CD-1           PIC X.
   924             20  PI-ENTRY-CD-2           PIC X.
   925
   926         16  PI-RETURN-CODES.
   927             20  PI-RETURN-CD-1          PIC X.
   928             20  PI-RETURN-CD-2          PIC X.
   929
   930         16  PI-UPDATE-STATUS-SAVE.
   931             20  PI-UPDATE-BY            PIC X(4).
   932             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   933
   934         16  PI-LOWER-CASE-LETTERS       PIC X.
   935             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   936
   937*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   938*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   939*            88  CARRIER-CLM-CNTL            VALUE '2'.
   940
   941         16  PI-CERT-ACCESS-CONTROL      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  22
* EL652.cbl
   942             88  ST-ACCNT-CNTL               VALUE ' '.
   943             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   944             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   945             88  ACCNT-CNTL                  VALUE '3'.
   946             88  CARR-ACCNT-CNTL             VALUE '4'.
   947
   948         16  PI-PROCESSOR-CAP-LIST.
   949             20  PI-SYSTEM-CONTROLS.
   950                24 PI-SYSTEM-DISPLAY     PIC X.
   951                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   952                24 PI-SYSTEM-MODIFY      PIC X.
   953                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   954             20  FILLER                  PIC XX.
   955             20  PI-DISPLAY-CAP          PIC X.
   956                 88  DISPLAY-CAP             VALUE 'Y'.
   957             20  PI-MODIFY-CAP           PIC X.
   958                 88  MODIFY-CAP              VALUE 'Y'.
   959             20  PI-MSG-AT-LOGON-CAP     PIC X.
   960                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   961             20  PI-FORCE-CAP            PIC X.
   962                 88  FORCE-CAP               VALUE 'Y'.
   963
   964         16  PI-PROGRAM-CONTROLS.
   965             20  PI-PGM-PRINT-OPT        PIC X.
   966             20  PI-PGM-FORMAT-OPT       PIC X.
   967             20  PI-PGM-PROCESS-OPT      PIC X.
   968             20  PI-PGM-TOTALS-OPT       PIC X.
   969
   970         16  PI-HELP-INTERFACE.
   971             20  PI-LAST-ERROR-NO        PIC X(4).
   972             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   973
   974         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   975             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   976
   977         16  PI-CR-CONTROL-IN-PROGRESS.
   978             20  PI-CR-CARRIER           PIC X.
   979             20  PI-CR-GROUPING          PIC X(6).
   980             20  PI-CR-STATE             PIC XX.
   981             20  PI-CR-ACCOUNT           PIC X(10).
   982             20  PI-CR-FIN-RESP          PIC X(10).
   983             20  PI-CR-TYPE              PIC X.
   984
   985         16  PI-CR-BATCH-NUMBER          PIC X(6).
   986
   987         16  PI-CR-MONTH-END-DT          PIC XX.
   988
   989         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   990             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   991             88  PI-ZERO-CARRIER             VALUE '1'.
   992             88  PI-ZERO-GROUPING            VALUE '2'.
   993             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   994
   995         16  PI-CARRIER-SECURITY         PIC X.
   996             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   997
   998         16  PI-ACCOUNT-SECURITY         PIC X(10).
   999             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  23
* EL652.cbl
  1000             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1001
  1002         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1003             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1004                                         INDEXED BY PI-ACCESS-NDX
  1005                                         PIC X.
  1006
  1007         16  PI-GA-BILLING-CONTROL       PIC X.
  1008             88  PI-GA-BILLING               VALUE '1'.
  1009
  1010         16  PI-MAIL-PROCESSING          PIC X.
  1011             88  PI-MAIL-YES                 VALUE 'Y'.
  1012
  1013         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1014
  1015         16  PI-AR-SYSTEM.
  1016             20  PI-AR-PROCESSING-CNTL   PIC X.
  1017                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1018             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1019             20  PI-AR-MONTH-END-DT      PIC XX.
  1020
  1021         16  PI-MP-SYSTEM.
  1022             20  PI-MORTGAGE-USER            PIC X.
  1023                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1024                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1025             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1026                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1027                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1028                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1029                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1030                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1031             20  PI-MP-MONTH-END-DT          PIC XX.
  1032             20  PI-MP-REFERENCE-NO.
  1033                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1034                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1035
  1036         16  PI-LABEL-CONTROL            PIC X(01).
  1037             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1038             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1039
  1040         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1041             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1042
  1043         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1044             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1045             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1046
  1047         16  FILLER                      PIC X(14).
  1048
  1049     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1050******************************************************************
  1051     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
  1052         16  PI-CHECK-MAINT-TYPE     PIC  X.
  1053             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
  1054                                                   'C' 'D'.
  1055             88  ADD-FUNCTION                VALUE 'A'.
  1056             88  SHOW-FUNCTION               VALUE 'S'.
  1057             88  DELETE-FUNCTION             VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  24
* EL652.cbl
  1058             88  CHANGE-FUNCTION             VALUE 'C'.
  1059         16  PI-CHECK-TYPE           PIC  X.
  1060             88  VALID-TYPE                  VALUE 'A' 'B' 'C'
  1061                                                           'G'.
  1062         16  PI-CHECK-CARRY-BAL      PIC  X.
  1063             88  VALID-CARRY-BAL             VALUE 'Y' 'N'.
  1064         16  PI-FIRST-TIME-SW        PIC  X.
  1065             88  FIRST-TIME                  VALUE 'Y'.
  1066         16  PI-ERCOMP-EOF-SW        PIC  X.
  1067             88  ERCOMP-EOF                  VALUE 'Y'.
  1068         16  PI-SAVE-PHONE           PIC  X(10).
  1069         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
  1070         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
  1071         16  PI-ERCOMP-KEY.
  1072             20  PI-ERC-COMPANY-CD   PIC  X.
  1073             20  PI-ERC-CARRIER      PIC  X.
  1074             20  PI-ERC-GROUP        PIC  X(6).
  1075             20  PI-ERC-RESP         PIC  X(10).
  1076             20  PI-ERC-ACCT         PIC  X(10).
  1077             20  PI-ERC-TYPE         PIC  X.
  1078         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
  1079         16  PI-SAVE-FAXNO           PIC  X(10).
  1080         16  PI-SAVE-FAXNO-RED REDEFINES PI-SAVE-FAXNO  PIC 9(10).
  1081         16  PI-SAVE-ADDR2           PIC X(30).
  1082         16  PI-SAVE-CITYST.
  1083             20  PI-SAVE-CITY        PIC X(28).
  1084             20  PI-SAVE-STATE       PIC XX.
  1085         16  PI-SAVE-ACCT-NAME       PIC X(30).
  1086         16  PI-EL652-DEL-SW         PIC X.
  1087         16  PI-UPDATE-SW            PIC X.
  1088         16  FILLER                  PIC  X(457).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  25
* EL652.cbl
  1090*                            COPY ELCJPFX.
  1091******************************************************************
  1092*                                                                *
  1093*                                                                *
  1094*                            ELCJPFX.                            *
  1095*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1096*                            VMOD=2.002                          *
  1097*                                                                *
  1098*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1099*                                                                *
  1100*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1101*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1102*        ELCNTL - CONTROL FILE                                   *
  1103*        ELMSTR - CLAIM MASTERS                                  *
  1104*        ELTRLR - ACTIVITY TRAILERS                              *
  1105*        ELCHKQ - CHECK QUE                                      *
  1106******************************************************************
  1107 01  JOURNAL-RECORD.
  1108     12  jp-date                     pic s9(5) comp-3.
  1109     12  jp-time                     pic s9(7) comp-3.
  1110     12  JP-USER-ID                  PIC X(4).
  1111     12  JP-FILE-ID                  PIC X(8).
  1112     12  JP-PROGRAM-ID               PIC X(8).
  1113     12  JP-RECORD-TYPE              PIC X.
  1114         88 JP-ADD              VALUE 'A'.
  1115         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1116         88 JP-AFTER-CHANGE     VALUE 'C'.
  1117         88 JP-DELETE           VALUE 'D'.
  1118         88 JP-GENERIC-DELETE   VALUE 'G'.
  1119         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1120         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1121     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1122     12  JP-RECORD-AREA
  1123
  1124
  1125                             PIC  X(750).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  26
* EL652.cbl
  1127*                            COPY ELCAID.
  1128******************************************************************
  1129*                                                                *
  1130*                            ELCAID.                             *
  1131*                            VMOD=2.001                          *
  1132*                                                                *
  1133*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1134*                                                                *
  1135*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1136*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1137******************************************************************
  1138
  1139 01  DFHAID.
  1140   02  DFHNULL   PIC  X  VALUE  ' '.
  1141   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1142   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1143   02  DFHPEN    PIC  X  VALUE  '='.
  1144   02  DFHOPID   PIC  X  VALUE  'W'.
  1145   02  DFHPA1    PIC  X  VALUE  '%'.
  1146   02  DFHPA2    PIC  X  VALUE  '>'.
  1147   02  DFHPA3    PIC  X  VALUE  ','.
  1148   02  DFHPF1    PIC  X  VALUE  '1'.
  1149   02  DFHPF2    PIC  X  VALUE  '2'.
  1150   02  DFHPF3    PIC  X  VALUE  '3'.
  1151   02  DFHPF4    PIC  X  VALUE  '4'.
  1152   02  DFHPF5    PIC  X  VALUE  '5'.
  1153   02  DFHPF6    PIC  X  VALUE  '6'.
  1154   02  DFHPF7    PIC  X  VALUE  '7'.
  1155   02  DFHPF8    PIC  X  VALUE  '8'.
  1156   02  DFHPF9    PIC  X  VALUE  '9'.
  1157   02  DFHPF10   PIC  X  VALUE  ':'.
  1158   02  DFHPF11   PIC  X  VALUE  '#'.
  1159   02  DFHPF12   PIC  X  VALUE  '@'.
  1160   02  DFHPF13   PIC  X  VALUE  'A'.
  1161   02  DFHPF14   PIC  X  VALUE  'B'.
  1162   02  DFHPF15   PIC  X  VALUE  'C'.
  1163   02  DFHPF16   PIC  X  VALUE  'D'.
  1164   02  DFHPF17   PIC  X  VALUE  'E'.
  1165   02  DFHPF18   PIC  X  VALUE  'F'.
  1166   02  DFHPF19   PIC  X  VALUE  'G'.
  1167   02  DFHPF20   PIC  X  VALUE  'H'.
  1168   02  DFHPF21   PIC  X  VALUE  'I'.
  1169*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1170   02  DFHPF22   PIC  X  VALUE  '['.
  1171   02  DFHPF23   PIC  X  VALUE  '.'.
  1172   02  DFHPF24   PIC  X  VALUE  '<'.
  1173   02  DFHMSRE   PIC  X  VALUE  'X'.
  1174   02  DFHSTRF   PIC  X  VALUE  'h'.
  1175   02  DFHTRIG   PIC  X  VALUE  '"'.
  1176
  1177 01  FILLER  REDEFINES  DFHAID.
  1178     12  FILLER              PIC  X(8).
  1179     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  27
* EL652.cbl
  1181*                            COPY EL652S.
  1182 01  EL652AI.
  1183     05  FILLER            PIC  X(0012).
  1184*    -------------------------------
  1185     05  RUNDATEL PIC S9(0004) COMP.
  1186     05  RUNDATEF PIC  X(0001).
  1187     05  FILLER REDEFINES RUNDATEF.
  1188         10  RUNDATEA PIC  X(0001).
  1189     05  RUNDATEI PIC  X(0008).
  1190*    -------------------------------
  1191     05  RUNTIMEL PIC S9(0004) COMP.
  1192     05  RUNTIMEF PIC  X(0001).
  1193     05  FILLER REDEFINES RUNTIMEF.
  1194         10  RUNTIMEA PIC  X(0001).
  1195     05  RUNTIMEI PIC  X(0005).
  1196*    -------------------------------
  1197     05  CMPNYIDL PIC S9(0004) COMP.
  1198     05  CMPNYIDF PIC  X(0001).
  1199     05  FILLER REDEFINES CMPNYIDF.
  1200         10  CMPNYIDA PIC  X(0001).
  1201     05  CMPNYIDI PIC  X(0003).
  1202*    -------------------------------
  1203     05  USERIDL PIC S9(0004) COMP.
  1204     05  USERIDF PIC  X(0001).
  1205     05  FILLER REDEFINES USERIDF.
  1206         10  USERIDA PIC  X(0001).
  1207     05  USERIDI PIC  X(0004).
  1208*    -------------------------------
  1209     05  MAINTYPL PIC S9(0004) COMP.
  1210     05  MAINTYPF PIC  X(0001).
  1211     05  FILLER REDEFINES MAINTYPF.
  1212         10  MAINTYPA PIC  X(0001).
  1213     05  MAINTYPI PIC  X(0001).
  1214*    -------------------------------
  1215     05  SCDESCL PIC S9(0004) COMP.
  1216     05  SCDESCF PIC  X(0001).
  1217     05  FILLER REDEFINES SCDESCF.
  1218         10  SCDESCA PIC  X(0001).
  1219     05  SCDESCI PIC  X(0008).
  1220*    -------------------------------
  1221     05  FLITYPEL PIC S9(0004) COMP.
  1222     05  FLITYPEF PIC  X(0001).
  1223     05  FILLER REDEFINES FLITYPEF.
  1224         10  FLITYPEA PIC  X(0001).
  1225     05  FLITYPEI PIC  X(0004).
  1226*    -------------------------------
  1227     05  CARRIERL PIC S9(0004) COMP.
  1228     05  CARRIERF PIC  X(0001).
  1229     05  FILLER REDEFINES CARRIERF.
  1230         10  CARRIERA PIC  X(0001).
  1231     05  CARRIERI PIC  X(0001).
  1232*    -------------------------------
  1233     05  GROUPL PIC S9(0004) COMP.
  1234     05  GROUPF PIC  X(0001).
  1235     05  FILLER REDEFINES GROUPF.
  1236         10  GROUPA PIC  X(0001).
  1237     05  GROUPI PIC  X(0006).
  1238*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  28
* EL652.cbl
  1239     05  TYPEL PIC S9(0004) COMP.
  1240     05  TYPEF PIC  X(0001).
  1241     05  FILLER REDEFINES TYPEF.
  1242         10  TYPEA PIC  X(0001).
  1243     05  TYPEI PIC  X(0001).
  1244*    -------------------------------
  1245     05  FINRESPL PIC S9(0004) COMP.
  1246     05  FINRESPF PIC  X(0001).
  1247     05  FILLER REDEFINES FINRESPF.
  1248         10  FINRESPA PIC  X(0001).
  1249     05  FINRESPI PIC  X(0010).
  1250*    -------------------------------
  1251     05  ACCTNOL PIC S9(0004) COMP.
  1252     05  ACCTNOF PIC  X(0001).
  1253     05  FILLER REDEFINES ACCTNOF.
  1254         10  ACCTNOA PIC  X(0001).
  1255     05  ACCTNOI PIC  X(0010).
  1256*    -------------------------------
  1257     05  SUMMNOL PIC S9(0004) COMP.
  1258     05  SUMMNOF PIC  X(0001).
  1259     05  FILLER REDEFINES SUMMNOF.
  1260         10  SUMMNOA PIC  X(0001).
  1261     05  SUMMNOI PIC  X(0006).
  1262*    -------------------------------
  1263     05  LSTMDTL PIC S9(0004) COMP.
  1264     05  LSTMDTF PIC  X(0001).
  1265     05  FILLER REDEFINES LSTMDTF.
  1266         10  LSTMDTA PIC  X(0001).
  1267     05  LSTMDTI PIC  X(0008).
  1268*    -------------------------------
  1269     05  FLITYPL PIC S9(0004) COMP.
  1270     05  FLITYPF PIC  X(0001).
  1271     05  FILLER REDEFINES FLITYPF.
  1272         10  FLITYPA PIC  X(0001).
  1273     05  FLITYPI PIC  X(0001).
  1274*    -------------------------------
  1275     05  PCONTL PIC S9(0004) COMP.
  1276     05  PCONTF PIC  X(0001).
  1277     05  FILLER REDEFINES PCONTF.
  1278         10  PCONTA PIC  X(0001).
  1279     05  PCONTI PIC  X(0030).
  1280*    -------------------------------
  1281     05  PNT1099L PIC S9(0004) COMP.
  1282     05  PNT1099F PIC  X(0001).
  1283     05  FILLER REDEFINES PNT1099F.
  1284         10  PNT1099A PIC  X(0001).
  1285     05  PNT1099I PIC  X(0001).
  1286*    -------------------------------
  1287     05  MAILNAML PIC S9(0004) COMP.
  1288     05  MAILNAMF PIC  X(0001).
  1289     05  FILLER REDEFINES MAILNAMF.
  1290         10  MAILNAMA PIC  X(0001).
  1291     05  MAILNAMI PIC  X(0030).
  1292*    -------------------------------
  1293     05  SSNL PIC S9(0004) COMP.
  1294     05  SSNF PIC  X(0001).
  1295     05  FILLER REDEFINES SSNF.
  1296         10  SSNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  29
* EL652.cbl
  1297     05  SSNI PIC  X(0013).
  1298*    -------------------------------
  1299     05  ACCTNAML PIC S9(0004) COMP.
  1300     05  ACCTNAMF PIC  X(0001).
  1301     05  FILLER REDEFINES ACCTNAMF.
  1302         10  ACCTNAMA PIC  X(0001).
  1303     05  ACCTNAMI PIC  X(0030).
  1304*    -------------------------------
  1305     05  PHONEL PIC S9(0004) COMP.
  1306     05  PHONEF PIC  X(0001).
  1307     05  FILLER REDEFINES PHONEF.
  1308         10  PHONEA PIC  X(0001).
  1309     05  PHONEI PIC  X(0012).
  1310*    -------------------------------
  1311     05  ADDR1L PIC S9(0004) COMP.
  1312     05  ADDR1F PIC  X(0001).
  1313     05  FILLER REDEFINES ADDR1F.
  1314         10  ADDR1A PIC  X(0001).
  1315     05  ADDR1I PIC  X(0030).
  1316*    -------------------------------
  1317     05  FAXDESCL PIC S9(0004) COMP.
  1318     05  FAXDESCF PIC  X(0001).
  1319     05  FILLER REDEFINES FAXDESCF.
  1320         10  FAXDESCA PIC  X(0001).
  1321     05  FAXDESCI PIC  X(0016).
  1322*    -------------------------------
  1323     05  FAXNOL PIC S9(0004) COMP.
  1324     05  FAXNOF PIC  X(0001).
  1325     05  FILLER REDEFINES FAXNOF.
  1326         10  FAXNOA PIC  X(0001).
  1327     05  FAXNOI PIC  X(0012).
  1328*    -------------------------------
  1329     05  ADDR2L PIC S9(0004) COMP.
  1330     05  ADDR2F PIC  X(0001).
  1331     05  FILLER REDEFINES ADDR2F.
  1332         10  ADDR2A PIC  X(0001).
  1333     05  ADDR2I PIC  X(0030).
  1334*    -------------------------------
  1335     05  CARBALL PIC S9(0004) COMP.
  1336     05  CARBALF PIC  X(0001).
  1337     05  FILLER REDEFINES CARBALF.
  1338         10  CARBALA PIC  X(0001).
  1339     05  CARBALI PIC  X(0001).
  1340*    -------------------------------
  1341     05  CITYL PIC S9(0004) COMP.
  1342     05  CITYF PIC  X(0001).
  1343     05  FILLER REDEFINES CITYF.
  1344         10  CITYA PIC  X(0001).
  1345     05  CITYI PIC  X(0028).
  1346*    -------------------------------
  1347     05  STATEL PIC S9(0004) COMP.
  1348     05  STATEF PIC  X(0001).
  1349     05  FILLER REDEFINES STATEF.
  1350         10  STATEA PIC  X(0001).
  1351     05  STATEI PIC  X(0002).
  1352*    -------------------------------
  1353     05  REFEHL PIC S9(0004) COMP.
  1354     05  REFEHF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  30
* EL652.cbl
  1355     05  FILLER REDEFINES REFEHF.
  1356         10  REFEHA PIC  X(0001).
  1357     05  REFEHI PIC  X(0013).
  1358*    -------------------------------
  1359     05  REFEL PIC S9(0004) COMP.
  1360     05  REFEF PIC  X(0001).
  1361     05  FILLER REDEFINES REFEF.
  1362         10  REFEA PIC  X(0001).
  1363     05  REFEI PIC  X(0001).
  1364*    -------------------------------
  1365     05  ZIPCODEL PIC S9(0004) COMP.
  1366     05  ZIPCODEF PIC  X(0001).
  1367     05  FILLER REDEFINES ZIPCODEF.
  1368         10  ZIPCODEA PIC  X(0001).
  1369     05  ZIPCODEI PIC  X(0010).
  1370*    -------------------------------
  1371     05  NGDESCL PIC S9(0004) COMP.
  1372     05  NGDESCF PIC  X(0001).
  1373     05  FILLER REDEFINES NGDESCF.
  1374         10  NGDESCA PIC  X(0001).
  1375     05  NGDESCI PIC  X(0012).
  1376*    -------------------------------
  1377     05  NETGRSL PIC S9(0004) COMP.
  1378     05  NETGRSF PIC  X(0001).
  1379     05  FILLER REDEFINES NETGRSF.
  1380         10  NETGRSA PIC  X(0001).
  1381     05  NETGRSI PIC  X(0001).
  1382*    -------------------------------
  1383     05  AHL120L PIC S9(0004) COMP.
  1384     05  AHL120F PIC  X(0001).
  1385     05  FILLER REDEFINES AHL120F.
  1386         10  AHL120A PIC  X(0001).
  1387     05  AHL120I PIC  X(0016).
  1388*    -------------------------------
  1389     05  OVER120L PIC S9(0004) COMP.
  1390     05  OVER120F PIC  X(0001).
  1391     05  FILLER REDEFINES OVER120F.
  1392         10  OVER120A PIC  X(0001).
  1393     05  OVER120I PIC  X(0013).
  1394*    -------------------------------
  1395     05  CSRL PIC S9(0004) COMP.
  1396     05  CSRF PIC  X(0001).
  1397     05  FILLER REDEFINES CSRF.
  1398         10  CSRA PIC  X(0001).
  1399     05  CSRI PIC  X(0004).
  1400*    -------------------------------
  1401     05  RPTCDDL PIC S9(0004) COMP.
  1402     05  RPTCDDF PIC  X(0001).
  1403     05  FILLER REDEFINES RPTCDDF.
  1404         10  RPTCDDA PIC  X(0001).
  1405     05  RPTCDDI PIC  X(0010).
  1406*    -------------------------------
  1407     05  RPTCD2L PIC S9(0004) COMP.
  1408     05  RPTCD2F PIC  X(0001).
  1409     05  FILLER REDEFINES RPTCD2F.
  1410         10  RPTCD2A PIC  X(0001).
  1411     05  RPTCD2I PIC  X(0010).
  1412*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  31
* EL652.cbl
  1413     05  CKDESCL PIC S9(0004) COMP.
  1414     05  CKDESCF PIC  X(0001).
  1415     05  FILLER REDEFINES CKDESCF.
  1416         10  CKDESCA PIC  X(0001).
  1417     05  CKDESCI PIC  X(0016).
  1418*    -------------------------------
  1419     05  CKPULLL PIC S9(0004) COMP.
  1420     05  CKPULLF PIC  X(0001).
  1421     05  FILLER REDEFINES CKPULLF.
  1422         10  CKPULLA PIC  X(0001).
  1423     05  CKPULLI PIC  X(0001).
  1424*    -------------------------------
  1425     05  BILLPRTL PIC S9(0004) COMP.
  1426     05  BILLPRTF PIC  X(0001).
  1427     05  FILLER REDEFINES BILLPRTF.
  1428         10  BILLPRTA PIC  X(0001).
  1429     05  BILLPRTI PIC  X(0001).
  1430*    -------------------------------
  1431     05  LETDESCL PIC S9(0004) COMP.
  1432     05  LETDESCF PIC  X(0001).
  1433     05  FILLER REDEFINES LETDESCF.
  1434         10  LETDESCA PIC  X(0001).
  1435     05  LETDESCI PIC  X(0011).
  1436*    -------------------------------
  1437     05  LETRCDL PIC S9(0004) COMP.
  1438     05  LETRCDF PIC  X(0001).
  1439     05  FILLER REDEFINES LETRCDF.
  1440         10  LETRCDA PIC  X(0001).
  1441     05  LETRCDI PIC  X(0001).
  1442*    -------------------------------
  1443     05  BALPRTL PIC S9(0004) COMP.
  1444     05  BALPRTF PIC  X(0001).
  1445     05  FILLER REDEFINES BALPRTF.
  1446         10  BALPRTA PIC  X(0001).
  1447     05  BALPRTI PIC  X(0011).
  1448*    -------------------------------
  1449     05  BALCDL PIC S9(0004) COMP.
  1450     05  BALCDF PIC  X(0001).
  1451     05  FILLER REDEFINES BALCDF.
  1452         10  BALCDA PIC  X(0001).
  1453     05  BALCDI PIC  X(0001).
  1454*    -------------------------------
  1455     05  SPPDDHL PIC S9(0004) COMP.
  1456     05  SPPDDHF PIC  X(0001).
  1457     05  FILLER REDEFINES SPPDDHF.
  1458         10  SPPDDHA PIC  X(0001).
  1459     05  SPPDDHI PIC  X(0012).
  1460*    -------------------------------
  1461     05  SPPDDL PIC S9(0004) COMP.
  1462     05  SPPDDF PIC  X(0001).
  1463     05  FILLER REDEFINES SPPDDF.
  1464         10  SPPDDA PIC  X(0001).
  1465     05  SPPDDI PIC  X(0001).
  1466*    -------------------------------
  1467     05  MFLABLL PIC S9(0004) COMP.
  1468     05  MFLABLF PIC  X(0001).
  1469     05  FILLER REDEFINES MFLABLF.
  1470         10  MFLABLA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  32
* EL652.cbl
  1471     05  MFLABLI PIC  X(0016).
  1472*    -------------------------------
  1473     05  MAXFEEL PIC S9(0004) COMP.
  1474     05  MAXFEEF PIC  X(0001).
  1475     05  FILLER REDEFINES MAXFEEF.
  1476         10  MAXFEEA PIC  X(0001).
  1477     05  MAXFEEI PIC  S9(04)V99.
  1478*    -------------------------------
  1479     05  CSLABLL PIC S9(0004) COMP.
  1480     05  CSLABLF PIC  X(0001).
  1481     05  FILLER REDEFINES CSLABLF.
  1482         10  CSLABLA PIC  X(0001).
  1483     05  CSLABLI PIC  X(0012).
  1484*    -------------------------------
  1485     05  CLPSTL PIC S9(0004) COMP.
  1486     05  CLPSTF PIC  X(0001).
  1487     05  FILLER REDEFINES CLPSTF.
  1488         10  CLPSTA PIC  X(0001).
  1489     05  CLPSTI PIC  X(0002).
  1490*    -------------------------------
  1491     05  LFLABLL PIC S9(0004) COMP.
  1492     05  LFLABLF PIC  X(0001).
  1493     05  FILLER REDEFINES LFLABLF.
  1494         10  LFLABLA PIC  X(0001).
  1495     05  LFLABLI PIC  X(0016).
  1496*    -------------------------------
  1497     05  MAXLFL PIC S9(0004) COMP.
  1498     05  MAXLFF PIC  X(0001).
  1499     05  FILLER REDEFINES MAXLFF.
  1500         10  MAXLFA PIC  X(0001).
  1501     05  MAXLFI PIC  S9(04)V99.
  1502*    -------------------------------
  1503     05  BALFWDL PIC S9(0004) COMP.
  1504     05  BALFWDF PIC  X(0001).
  1505     05  FILLER REDEFINES BALFWDF.
  1506         10  BALFWDA PIC  X(0001).
  1507     05  BALFWDI PIC  S9(11)V99.
  1508*    -------------------------------
  1509     05  CURCOML PIC S9(0004) COMP.
  1510     05  CURCOMF PIC  X(0001).
  1511     05  FILLER REDEFINES CURCOMF.
  1512         10  CURCOMA PIC  X(0001).
  1513     05  CURCOMI PIC  S9(11)V99.
  1514*    -------------------------------
  1515     05  CURCHGL PIC S9(0004) COMP.
  1516     05  CURCHGF PIC  X(0001).
  1517     05  FILLER REDEFINES CURCHGF.
  1518         10  CURCHGA PIC  X(0001).
  1519     05  CURCHGI PIC  S9(11)V99.
  1520*    -------------------------------
  1521     05  CURPMTL PIC S9(0004) COMP.
  1522     05  CURPMTF PIC  X(0001).
  1523     05  FILLER REDEFINES CURPMTF.
  1524         10  CURPMTA PIC  X(0001).
  1525     05  CURPMTI PIC  S9(11)V99.
  1526*    -------------------------------
  1527     05  ENDBALL PIC S9(0004) COMP.
  1528     05  ENDBALF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  33
* EL652.cbl
  1529     05  FILLER REDEFINES ENDBALF.
  1530         10  ENDBALA PIC  X(0001).
  1531     05  ENDBALI PIC  S9(11)V99.
  1532*    -------------------------------
  1533     05  CURRENTL PIC S9(0004) COMP.
  1534     05  CURRENTF PIC  X(0001).
  1535     05  FILLER REDEFINES CURRENTF.
  1536         10  CURRENTA PIC  X(0001).
  1537     05  CURRENTI PIC  X(0013).
  1538*    -------------------------------
  1539     05  OVER30L PIC S9(0004) COMP.
  1540     05  OVER30F PIC  X(0001).
  1541     05  FILLER REDEFINES OVER30F.
  1542         10  OVER30A PIC  X(0001).
  1543     05  OVER30I PIC  X(0013).
  1544*    -------------------------------
  1545     05  OVER60L PIC S9(0004) COMP.
  1546     05  OVER60F PIC  X(0001).
  1547     05  FILLER REDEFINES OVER60F.
  1548         10  OVER60A PIC  X(0001).
  1549     05  OVER60I PIC  X(0013).
  1550*    -------------------------------
  1551     05  OVER90L PIC S9(0004) COMP.
  1552     05  OVER90F PIC  X(0001).
  1553     05  FILLER REDEFINES OVER90F.
  1554         10  OVER90A PIC  X(0001).
  1555     05  OVER90I PIC  X(0013).
  1556*    -------------------------------
  1557     05  YTDCOML PIC S9(0004) COMP.
  1558     05  YTDCOMF PIC  X(0001).
  1559     05  FILLER REDEFINES YTDCOMF.
  1560         10  YTDCOMA PIC  X(0001).
  1561     05  YTDCOMI PIC  S9(11)V99.
  1562*    -------------------------------
  1563     05  LSTDTEL PIC S9(0004) COMP.
  1564     05  LSTDTEF PIC  X(0001).
  1565     05  FILLER REDEFINES LSTDTEF.
  1566         10  LSTDTEA PIC  X(0001).
  1567     05  LSTDTEI PIC  X(0008).
  1568*    -------------------------------
  1569     05  LSTTIMEL PIC S9(0004) COMP.
  1570     05  LSTTIMEF PIC  X(0001).
  1571     05  FILLER REDEFINES LSTTIMEF.
  1572         10  LSTTIMEA PIC  X(0001).
  1573     05  LSTTIMEI PIC  X(0005).
  1574*    -------------------------------
  1575     05  LSTUSRL PIC S9(0004) COMP.
  1576     05  LSTUSRF PIC  X(0001).
  1577     05  FILLER REDEFINES LSTUSRF.
  1578         10  LSTUSRA PIC  X(0001).
  1579     05  LSTUSRI PIC  X(0004).
  1580*    -------------------------------
  1581     05  ERRMSG1L PIC S9(0004) COMP.
  1582     05  ERRMSG1F PIC  X(0001).
  1583     05  FILLER REDEFINES ERRMSG1F.
  1584         10  ERRMSG1A PIC  X(0001).
  1585     05  ERRMSG1I PIC  X(0072).
  1586*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  34
* EL652.cbl
  1587     05  PFKEYL PIC S9(0004) COMP.
  1588     05  PFKEYF PIC  X(0001).
  1589     05  FILLER REDEFINES PFKEYF.
  1590         10  PFKEYA PIC  X(0001).
  1591     05  PFKEYI PIC  99.
  1592*    -------------------------------
  1593     05  PFK5L PIC S9(0004) COMP.
  1594     05  PFK5F PIC  X(0001).
  1595     05  FILLER REDEFINES PFK5F.
  1596         10  PFK5A PIC  X(0001).
  1597     05  PFK5I PIC  X(0011).
  1598*    -------------------------------
  1599     05  PFK7L PIC S9(0004) COMP.
  1600     05  PFK7F PIC  X(0001).
  1601     05  FILLER REDEFINES PFK7F.
  1602         10  PFK7A PIC  X(0001).
  1603     05  PFK7I PIC  X(0012).
  1604*    -------------------------------
  1605     05  PFK9L PIC S9(0004) COMP.
  1606     05  PFK9F PIC  X(0001).
  1607     05  FILLER REDEFINES PFK9F.
  1608         10  PFK9A PIC  X(0001).
  1609     05  PFK9I PIC  X(0012).
  1610*    -------------------------------
  1611     05  PFK13L PIC S9(0004) COMP.
  1612     05  PFK13F PIC  X(0001).
  1613     05  FILLER REDEFINES PFK13F.
  1614         10  PFK13A PIC  X(0001).
  1615     05  PFK13I PIC  X(0011).
  1616*    -------------------------------
  1617     05  PFK4L PIC S9(0004) COMP.
  1618     05  PFK4F PIC  X(0001).
  1619     05  FILLER REDEFINES PFK4F.
  1620         10  PFK4A PIC  X(0001).
  1621     05  PFK4I PIC  X(0012).
  1622*    -------------------------------
  1623     05  PFK6L PIC S9(0004) COMP.
  1624     05  PFK6F PIC  X(0001).
  1625     05  FILLER REDEFINES PFK6F.
  1626         10  PFK6A PIC  X(0001).
  1627     05  PFK6I PIC  X(0011).
  1628*    -------------------------------
  1629     05  PFK10L PIC S9(0004) COMP.
  1630     05  PFK10F PIC  X(0001).
  1631     05  FILLER REDEFINES PFK10F.
  1632         10  PFK10A PIC  X(0001).
  1633     05  PFK10I PIC  X(0014).
  1634 01  EL652AO REDEFINES EL652AI.
  1635     05  FILLER            PIC  X(0012).
  1636*    -------------------------------
  1637     05  FILLER            PIC  X(0003).
  1638     05  RUNDATEO PIC  X(0008).
  1639*    -------------------------------
  1640     05  FILLER            PIC  X(0003).
  1641     05  RUNTIMEO PIC  99.99.
  1642*    -------------------------------
  1643     05  FILLER            PIC  X(0003).
  1644     05  CMPNYIDO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  35
* EL652.cbl
  1645*    -------------------------------
  1646     05  FILLER            PIC  X(0003).
  1647     05  USERIDO PIC  X(0004).
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  MAINTYPO PIC  X(0001).
  1651*    -------------------------------
  1652     05  FILLER            PIC  X(0003).
  1653     05  SCDESCO PIC  X(0008).
  1654*    -------------------------------
  1655     05  FILLER            PIC  X(0003).
  1656     05  FLITYPEO PIC  X(0004).
  1657*    -------------------------------
  1658     05  FILLER            PIC  X(0003).
  1659     05  CARRIERO PIC  X(0001).
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
  1662     05  GROUPO PIC  X(0006).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  TYPEO PIC  X(0001).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  FINRESPO PIC  X(0010).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  ACCTNOO PIC  X(0010).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  SUMMNOO PIC  X(0006).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  LSTMDTO PIC  X(0008).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  FLITYPO PIC  X(0001).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  PCONTO PIC  X(0030).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  PNT1099O PIC  X(0001).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  MAILNAMO PIC  X(0030).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  SSNO PIC  X(0013).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  ACCTNAMO PIC  X(0030).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  PHONEO PIC  X(0012).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  ADDR1O PIC  X(0030).
  1702*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  36
* EL652.cbl
  1703     05  FILLER            PIC  X(0003).
  1704     05  FAXDESCO PIC  X(0016).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  FAXNOO PIC  X(0012).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  ADDR2O PIC  X(0030).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  CARBALO PIC  X(0001).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  CITYO PIC  X(0028).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  STATEO PIC  X(0002).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  REFEHO PIC  X(0013).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  REFEO PIC  X(0001).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  ZIPCODEO PIC  X(0010).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  NGDESCO PIC  X(0012).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  NETGRSO PIC  X(0001).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  AHL120O PIC  X(0016).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  OVER120O PIC  Z,ZZZ,ZZZ.99-.
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  CSRO PIC  X(0004).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  RPTCDDO PIC  X(0010).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  RPTCD2O PIC  X(0010).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  CKDESCO PIC  X(0016).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  CKPULLO PIC  X(0001).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  BILLPRTO PIC  X(0001).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  37
* EL652.cbl
  1761     05  LETDESCO PIC  X(0011).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  LETRCDO PIC  X(0001).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  BALPRTO PIC  X(0011).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  BALCDO PIC  X(0001).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  SPPDDHO PIC  X(0012).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  SPPDDO PIC  X(0001).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  MFLABLO PIC  X(0016).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  MAXFEEO PIC  Z99.99.
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  CSLABLO PIC  X(0012).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  CLPSTO PIC  X(0002).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  LFLABLO PIC  X(0016).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  MAXLFO PIC  Z99.99.
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  BALFWDO PIC  Z,ZZZ,ZZZ.99-.
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  CURCOMO PIC  Z,ZZZ,ZZZ.99-.
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  CURCHGO PIC  Z,ZZZ,ZZZ.99-.
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  CURPMTO PIC  Z,ZZZ,ZZZ.99-.
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  ENDBALO PIC  Z,ZZZ,ZZZ.99-.
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  CURRENTO PIC  Z,ZZZ,ZZZ.99-.
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  OVER30O PIC  Z,ZZZ,ZZZ.99-.
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  OVER60O PIC  Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  38
* EL652.cbl
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  OVER90O PIC  Z,ZZZ,ZZZ.99-.
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  YTDCOMO PIC  Z,ZZZ,ZZZ.99-.
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  LSTDTEO PIC  X(0008).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  LSTTIMEO PIC  99.99.
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  LSTUSRO PIC  X(0004).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  ERRMSG1O PIC  X(0072).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  PFKEYO PIC  X(0002).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  PFK5O PIC  X(0011).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  PFK7O PIC  X(0012).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  PFK9O PIC  X(0012).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  PFK13O PIC  X(0011).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  PFK4O PIC  X(0012).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  PFK6O PIC  X(0011).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  PFK10O PIC  X(0014).
  1861*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  39
* EL652.cbl
  1863****************************************************************
  1864*
  1865* Copyright (c) 2007 by Clerity Solutions, Inc.
  1866* All rights reserved.
  1867*
  1868****************************************************************
  1869 01  DFHEIV.
  1870   02  DFHEIV0               PIC X(35).
  1871   02  DFHEIV1               PIC X(08).
  1872   02  DFHEIV2               PIC X(08).
  1873   02  DFHEIV3               PIC X(08).
  1874   02  DFHEIV4               PIC X(06).
  1875   02  DFHEIV5               PIC X(04).
  1876   02  DFHEIV6               PIC X(04).
  1877   02  DFHEIV7               PIC X(02).
  1878   02  DFHEIV8               PIC X(02).
  1879   02  DFHEIV9               PIC X(01).
  1880   02  DFHEIV10              PIC S9(7) COMP-3.
  1881   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1882   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1883   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1884   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1885   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1886   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1887   02  DFHEIV17              PIC X(04).
  1888   02  DFHEIV18              PIC X(04).
  1889   02  DFHEIV19              PIC X(04).
  1890   02  DFHEIV20              USAGE IS POINTER.
  1891   02  DFHEIV21              USAGE IS POINTER.
  1892   02  DFHEIV22              USAGE IS POINTER.
  1893   02  DFHEIV23              USAGE IS POINTER.
  1894   02  DFHEIV24              USAGE IS POINTER.
  1895   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1896   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1897   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1898   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1899   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1900   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1901   02  FILLER                PIC X(02).
  1902   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1903   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1904   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1905   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1906   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1907 LINKAGE  SECTION.
  1908*****************************************************************
  1909*                                                               *
  1910* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1911* All rights reserved.                                          *
  1912*                                                               *
  1913*****************************************************************
  1914 01  dfheiblk.
  1915     02  eibtime          pic s9(7) comp-3.
  1916     02  eibdate          pic s9(7) comp-3.
  1917     02  eibtrnid         pic x(4).
  1918     02  eibtaskn         pic s9(7) comp-3.
  1919     02  eibtrmid         pic x(4).
  1920     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  40
* EL652.cbl
  1921     02  eibcposn         pic s9(4) comp.
  1922     02  eibcalen         pic s9(4) comp.
  1923     02  eibaid           pic x(1).
  1924     02  eibfiller1       pic x(1).
  1925     02  eibfn            pic x(2).
  1926     02  eibfiller2       pic x(2).
  1927     02  eibrcode         pic x(6).
  1928     02  eibfiller3       pic x(2).
  1929     02  eibds            pic x(8).
  1930     02  eibreqid         pic x(8).
  1931     02  eibrsrce         pic x(8).
  1932     02  eibsync          pic x(1).
  1933     02  eibfree          pic x(1).
  1934     02  eibrecv          pic x(1).
  1935     02  eibsend          pic x(1).
  1936     02  eibatt           pic x(1).
  1937     02  eibeoc           pic x(1).
  1938     02  eibfmh           pic x(1).
  1939     02  eibcompl         pic x(1).
  1940     02  eibsig           pic x(1).
  1941     02  eibconf          pic x(1).
  1942     02  eiberr           pic x(1).
  1943     02  eibrldbk         pic x(1).
  1944     02  eiberrcd         pic x(4).
  1945     02  eibsynrb         pic x(1).
  1946     02  eibnodat         pic x(1).
  1947     02  eibfiller5       pic x(2).
  1948     02  eibresp          pic 9(09) comp.
  1949     02  eibresp2         pic 9(09) comp.
  1950     02  dfheigdj         pic s9(4) comp.
  1951     02  dfheigdk         pic s9(4) comp.
  1952
  1953 01  DFHCOMMAREA             PIC  X(1024).
  1954
  1955*01 PARMLIST .
  1956*    12  FILLER              PIC S9(8)                  COMP.
  1957*    12  ERCOMP-POINTER      PIC S9(8)                  COMP.
  1958*    12  ERNAME-POINTER      PIC S9(8)                  COMP.
  1959*    12  ELCNTL-POINTER      PIC S9(8)                  COMP.
  1960*    12  ERSUMM-POINTER      PIC S9(8)                  COMP.
  1961*    12  ERRQST-POINTER      PIC S9(8)                  COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  41
* EL652.cbl
  1963*                            COPY ERCCOMP.
  1964******************************************************************
  1965*                                                                *
  1966*                                                                *
  1967*                            ERCCOMP                             *
  1968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1969*                            VMOD=2.019                          *
  1970*                                                                *
  1971*   ONLINE CREDIT SYSTEM                                         *
  1972*                                                                *
  1973*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1974*                                                                *
  1975*   FILE TYPE = VSAM,KSDS                                        *
  1976*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1977*                                                                *
  1978*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1979*       ALTERNATE PATH = NONE                                    *
  1980*                                                                *
  1981*   LOG = NO                                                     *
  1982*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1983*                                                                *
  1984******************************************************************
  1985*                   C H A N G E   L O G
  1986*
  1987* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1988*-----------------------------------------------------------------
  1989*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1990* EFFECTIVE    NUMBER
  1991*-----------------------------------------------------------------
  1992* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1993* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1994* 092205    2005050300006  PEMA  ADD LEASE FEE
  1995* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1996* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1997* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1998* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1999* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2000* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2001******************************************************************
  2002
  2003 01  COMPENSATION-MASTER.
  2004     12  CO-RECORD-ID                          PIC XX.
  2005         88  VALID-CO-ID                          VALUE 'CO'.
  2006
  2007     12  CO-CONTROL-PRIMARY.
  2008         16  CO-COMPANY-CD                     PIC X.
  2009         16  CO-CONTROL.
  2010             20  CO-CTL-1.
  2011                 24  CO-CARR-GROUP.
  2012                     28  CO-CARRIER            PIC X.
  2013                     28  CO-GROUPING.
  2014                         32  CO-GROUP-PREFIX   PIC XXX.
  2015                         32  CO-GROUP-PRIME    PIC XXX.
  2016                 24  CO-RESP-NO.
  2017                     28  CO-RESP-PREFIX        PIC X(4).
  2018                     28  CO-RESP-PRIME         PIC X(6).
  2019             20  CO-CTL-2.
  2020                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  42
* EL652.cbl
  2021                     28  CO-ACCT-PREFIX        PIC X(4).
  2022                     28  CO-ACCT-PRIME         PIC X(6).
  2023         16  CO-TYPE                           PIC X.
  2024             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2025             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2026             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2027
  2028     12  CO-MAINT-INFORMATION.
  2029         16  CO-LAST-MAINT-DT                  PIC XX.
  2030         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2031         16  CO-LAST-MAINT-USER                PIC X(4).
  2032     12  FILLER                                PIC XX.
  2033     12  CO-STMT-TYPE                          PIC XXX.
  2034     12  CO-COMP-TYPE                          PIC X.
  2035         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2036     12  CO-STMT-OWNER                         PIC X(4).
  2037     12  CO-BALANCE-CONTROL                    PIC X.
  2038         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2039         88  CO-NO-BALANCE                        VALUE 'N'.
  2040
  2041     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2042         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2043         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2044         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2045
  2046     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2047         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2048         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2049
  2050     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2051     12  CO-GA-DIRECT-DEP                      PIC X.
  2052     12  CO-FUTURE-SPACE                       PIC X.
  2053         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2054
  2055     12  CO-ACCT-NAME                          PIC X(30).
  2056     12  CO-MAIL-NAME                          PIC X(30).
  2057     12  CO-ADDR-1                             PIC X(30).
  2058     12  CO-ADDR-2                             PIC X(30).
  2059     12  CO-ADDR-3.
  2060         16  CO-ADDR-CITY                      PIC X(27).
  2061         16  CO-ADDR-STATE                     PIC XX.
  2062     12  CO-CSO-1099                           PIC X.
  2063     12  CO-ZIP.
  2064         16  CO-ZIP-PRIME.
  2065             20  CO-ZIP-PRI-1ST                PIC X.
  2066                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2067             20  FILLER                        PIC X(4).
  2068         16  CO-ZIP-PLUS4                      PIC X(4).
  2069     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2070         16  CO-CAN-POSTAL-1                   PIC XXX.
  2071         16  CO-CAN-POSTAL-2                   PIC XXX.
  2072         16  FILLER                            PIC XXX.
  2073     12  CO-SOC-SEC                            PIC X(13).
  2074     12  CO-TELEPHONE.
  2075         16  CO-AREA-CODE                      PIC XXX.
  2076         16  CO-PREFIX                         PIC XXX.
  2077         16  CO-PHONE                          PIC X(4).
  2078
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  43
* EL652.cbl
  2079     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2080
  2081     12  CO-AR-BAL-LEVEL                       PIC X.
  2082         88  CO-AR-REF-LVL                        VALUE '1'.
  2083         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2084         88  CO-AR-BILL-LVL                       VALUE '2'.
  2085         88  CO-AR-AGT-LVL                        VALUE '3'.
  2086         88  CO-AR-FR-LVL                         VALUE '4'.
  2087
  2088     12  CO-AR-NORMAL-PRINT                    PIC X.
  2089         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2090         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2091
  2092     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2093
  2094     12  CO-AR-REPORTING                       PIC X.
  2095         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2096         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2097
  2098     12  CO-AR-PULL-CHECK                      PIC X.
  2099         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2100         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2101
  2102     12  CO-AR-BALANCE-PRINT                   PIC X.
  2103         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2104
  2105     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2106         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2107         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2108         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2109
  2110     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2111
  2112     12  CO-USER-CODE                          PIC X.
  2113     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2114
  2115******************************************************************
  2116*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2117*    THE LAST MONTH END RUN.
  2118******************************************************************
  2119
  2120     12  CO-LAST-ACTIVITY-DATE.
  2121         16  CO-ACT-YEAR                       PIC 99.
  2122         16  CO-ACT-MONTH                      PIC 99.
  2123         16  CO-ACT-DAY                        PIC 99.
  2124
  2125     12  CO-LAST-STMT-DT.
  2126         16  CO-LAST-STMT-YEAR                 PIC 99.
  2127         16  CO-LAST-STMT-MONTH                PIC 99.
  2128         16  CO-LAST-STMT-DAY                  PIC 99.
  2129
  2130     12  CO-MO-END-TOTALS.
  2131         16  CO-MONTHLY-TOTALS.
  2132             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2133             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2134             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2135             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2136             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  44
* EL652.cbl
  2137
  2138         16  CO-AGING-TOTALS.
  2139             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2140             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2141             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2142             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2143
  2144         16  CO-YTD-TOTALS.
  2145             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2146             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2147
  2148         16  CO-OVER-UNDER-TOTALS.
  2149             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2150             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2151
  2152     12  CO-MISCELLANEOUS-TOTALS.
  2153         16  CO-FICA-TOTALS.
  2154             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2155             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2156
  2157         16  CO-CLAIM-TOTALS.
  2158             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2159             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2160
  2161******************************************************************
  2162*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2163*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2164******************************************************************
  2165
  2166     12  CO-CURRENT-TOTALS.
  2167         16  CO-CURRENT-LAST-STMT-DT.
  2168             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2169             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2170             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2171
  2172         16  CO-CURRENT-MONTHLY-TOTALS.
  2173             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2174             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2175             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2176             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2177             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2178
  2179         16  CO-CURRENT-AGING-TOTALS.
  2180             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2181             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2182             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2183             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2184
  2185         16  CO-CURRENT-YTD-TOTALS.
  2186             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2187             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2188
  2189     12  CO-PAID-COMM-TOTALS.
  2190         16  CO-YTD-PAID-COMMS.
  2191             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2192             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2193
  2194     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  45
* EL652.cbl
  2195         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2196         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2197
  2198     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2199         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2200         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2201         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2202         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2203         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2204         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2205         88  CO-FINAL-LETTER                  VALUE 'F'.
  2206         88  CO-RECONCILING                   VALUE 'R'.
  2207         88  CO-PHONE-CALL                    VALUE 'P'.
  2208         88  CO-LEGAL                         VALUE 'L'.
  2209         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2210         88  CO-WRITE-OFF                     VALUE 'W'.
  2211         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2212
  2213     12  CO-CSR-CODE                       PIC X(4).
  2214
  2215     12  CO-GA-STATUS-INFO.
  2216         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2217         16  CO-GA-TERMINATION-DT          PIC XX.
  2218         16  CO-GA-STATUS-CODE             PIC X.
  2219             88  CO-GA-ACTIVE                 VALUE 'A'.
  2220             88  CO-GA-INACTIVE               VALUE 'I'.
  2221             88  CO-GA-PENDING                VALUE 'P'.
  2222         16  CO-GA-COMMENTS.
  2223             20  CO-GA-COMMENT-1           PIC X(40).
  2224             20  CO-GA-COMMENT-2           PIC X(40).
  2225             20  CO-GA-COMMENT-3           PIC X(40).
  2226             20  CO-GA-COMMENT-4           PIC X(40).
  2227
  2228     12  CO-RPTCD2                         PIC X(10).
  2229     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2230         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2231         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2232
  2233     12  CO-TYPE-AGENT                     PIC X(01).
  2234         88  CO-CORPORATION                   VALUE 'C'.
  2235         88  CO-PARTNERSHIP                   VALUE 'P'.
  2236         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2237         88  CO-TRUST                         VALUE 'T'.
  2238         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2239
  2240     12  CO-FAXNO.
  2241         16  CO-FAX-AREA-CODE                  PIC XXX.
  2242         16  CO-FAX-PREFIX                     PIC XXX.
  2243         16  CO-FAX-PHONE                      PIC X(4).
  2244
  2245     12  CO-BANK-INFORMATION.
  2246         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2247         16  CO-BANK-TRANSIT-NON REDEFINES
  2248             CO-BANK-TRANSIT-NO                PIC 9(8).
  2249
  2250         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2251     12  CO-MISC-DEDUCT-INFO REDEFINES
  2252                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  46
* EL652.cbl
  2253         16  CO-MD-GL-ACCT                     PIC X(10).
  2254         16  CO-MD-DIV                         PIC XX.
  2255         16  CO-MD-CENTER                      PIC X(4).
  2256         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2257         16  CO-CREATE-AP-CHECK                PIC X.
  2258         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2259         16  FILLER                            PIC XXX.
  2260     12  CO-ACH-STATUS                         PIC X.
  2261         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2262         88  CO-ACH-PENDING                        VALUE 'P'.
  2263
  2264     12  CO-BILL-SW                            PIC X.
  2265     12  CO-CONTROL-NAME                       PIC X(30).
  2266     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2267     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2268     12  CO-CLP-STATE                          PIC XX.
  2269     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2270     12  CO-SPP-REFUND-EDIT                    PIC X.
  2271
  2272******************************************************************
  2273*                            COPY ERCAGTC.
  2274******************************************************************
  2275*                                                                *
  2276*                                                                *
  2277*                            ERCAGTC                             *
  2278*                            VMOD=2.001                          *
  2279*                                                                *
  2280*   ONLINE CREDIT SYSTEM                                         *
  2281*                                                                *
  2282*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2283*                                                                *
  2284*   FILE TYPE = VSAM,KSDS                                        *
  2285*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2286*                                                                *
  2287*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2288*       ALTERNATE PATH = NONE                                    *
  2289*                                                                *
  2290*   LOG = NO                                                     *
  2291*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2292*                                                                *
  2293******************************************************************
  2294*                   C H A N G E   L O G
  2295*
  2296* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2297*-----------------------------------------------------------------
  2298*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2299* EFFECTIVE    NUMBER
  2300*-----------------------------------------------------------------
  2301* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2302* 111004                         NEW FILE AND COPYBOOK
  2303* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2304******************************************************************
  2305 01  AGENT-COMMISSIONS.
  2306     12  AG-RECORD-ID                          PIC XX.
  2307         88  VALID-CO-ID                          VALUE 'AG'.
  2308     12  AG-CONTROL-PRIMARY.
  2309         16  AG-COMPANY-CD                     PIC X.
  2310         16  AG-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  47
* EL652.cbl
  2311             20  AG-CTL-1.
  2312                 24  AG-CARR-GROUP.
  2313                     28  AG-CARRIER            PIC X.
  2314                     28  AG-GROUPING           PIC X(6).
  2315                 24  AG-BANK                   PIC X(10).
  2316             20  AG-CTL-2.
  2317                 24  AG-EXP-DT                 PIC XX.
  2318         16  AG-TYPE                           PIC X.
  2319             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2320             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2321     12  AG-MAINT-INFORMATION.
  2322         16  AG-LAST-MAINT-DT                  PIC XX.
  2323         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2324         16  AG-LAST-MAINT-USER                PIC X(4).
  2325         16  FILLER                            PIC X(10).
  2326     12  AG-EFF-DT                             PIC XX.
  2327     12  AG-COMM-STRUCTURE.
  2328         16  AG-AGT-COMMS OCCURS 10.
  2329             20  AG-AGT                PIC X(10).
  2330             20  AG-COM-TYP            PIC X.
  2331             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2332             20  AG-RECALC-LV-INDIC    PIC X.
  2333             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2334             20  AG-LRCALC-LV-INDIC    PIC X.
  2335             20  FILLER                PIC X(05).
  2336     12  FILLER                  PIC X(145).
  2337******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  48
* EL652.cbl
  2339*                            COPY ERCNAME.
  2340******************************************************************
  2341*                                                                *
  2342*                                                                *
  2343*                            ERCNAME                             *
  2344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2345*                            VMOD=2.003                          *
  2346*                                                                *
  2347*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2348*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2349*                                                                *
  2350*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2351*                                                                *
  2352*   FILE TYPE = VSAM,KSDS                                        *
  2353*   RECORD SIZE = 160   RECFORM = FIX                            *
  2354*                                                                *
  2355*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2356*                                                                *
  2357*   LOG = NO                                                     *
  2358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2359*                                                                *
  2360*                                                                *
  2361******************************************************************
  2362
  2363 01  NAME-LOOKUP-MASTER.
  2364     12  NL-RECORD-ID                PIC  X(02).
  2365         88  VALID-NL-ID                         VALUE 'NL'.
  2366
  2367     12  NL-RECORD-KEY.
  2368         16  NL-CONTROL-PRIMARY.
  2369             20  NL-COMPANY-CD       PIC  X(01).
  2370             20  NL-NAME             PIC  X(30).
  2371             20  NL-RECORD-TYPE      PIC  X(01).
  2372                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2373                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2374                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2375
  2376         16  NL-ACCOUNT-MASTER.
  2377             20  NL-AM-COMPANY-CD    PIC  X(01).
  2378             20  NL-AM-CARRIER       PIC  X(01).
  2379             20  NL-AM-GROUPING      PIC  X(06).
  2380             20  NL-AM-STATE         PIC  X(02).
  2381             20  NL-AM-ACCOUNT       PIC  X(10).
  2382             20  FILLER              PIC  X(09).
  2383
  2384         16  NL-COMPENSATION-MASTER
  2385                                 REDEFINES  NL-ACCOUNT-MASTER.
  2386             20  NL-CO-COMPANY-CD    PIC  X(01).
  2387             20  NL-CO-CARRIER       PIC  X(01).
  2388             20  NL-CO-GROUPING      PIC  X(06).
  2389             20  NL-CO-RESP-NO       PIC  X(10).
  2390             20  NL-CO-ACCOUNT       PIC  X(10).
  2391             20  NL-CO-TYPE          PIC  X(01).
  2392
  2393         16  NL-REINSURANCE-RECORD
  2394                                 REDEFINES  NL-ACCOUNT-MASTER.
  2395             20  NL-RE-COMPANY-CD    PIC  X(01).
  2396             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  49
* EL652.cbl
  2397             20  NL-RE-COMPANY.
  2398                 24  NL-RE-COMP      PIC  X(03).
  2399                 24  NL-RE-CO-SUB    PIC  X(03).
  2400             20  NL-RE-TABLE         PIC  X(03).
  2401             20  FILLER              PIC  X(18).
  2402
  2403     12  NL-MAINT-INFORMATION.
  2404         16  NL-LAST-MAINT-DT        PIC  X(02).
  2405         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2406         16  NL-LAST-MAINT-USER      PIC  X(04).
  2407         16  FILLER                  PIC  X(10).
  2408
  2409     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2410         16  NL-RE-LEVEL             PIC  9(02).
  2411
  2412     12  NL-CITY                     PIC  X(15).
  2413     12  NL-ST                       PIC  XX.
  2414
  2415******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  50
* EL652.cbl
  2417*                            COPY ELCCNTL.
  2418******************************************************************
  2419*                                                                *
  2420*                                                                *
  2421*                            ELCCNTL.                            *
  2422*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2423*                            VMOD=2.059                          *
  2424*                                                                *
  2425*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2426*                                                                *
  2427*   FILE TYPE = VSAM,KSDS                                        *
  2428*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2429*                                                                *
  2430*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2431*       ALTERNATE INDEX = NONE                                   *
  2432*                                                                *
  2433*   LOG = YES                                                    *
  2434*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2435******************************************************************
  2436*                   C H A N G E   L O G
  2437*
  2438* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2439*-----------------------------------------------------------------
  2440*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2441* EFFECTIVE    NUMBER
  2442*-----------------------------------------------------------------
  2443* 082503                   PEMA  ADD BENEFIT GROUP
  2444* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2445* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2446* 092705    2005050300006  PEMA  ADD SPP LEASES
  2447* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2448* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2449* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2450* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2451* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2452* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2453* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2454* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2455* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2456* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2457******************************************************************
  2458*
  2459 01  CONTROL-FILE.
  2460     12  CF-RECORD-ID                       PIC XX.
  2461         88  VALID-CF-ID                        VALUE 'CF'.
  2462
  2463     12  CF-CONTROL-PRIMARY.
  2464         16  CF-COMPANY-ID                  PIC XXX.
  2465         16  CF-RECORD-TYPE                 PIC X.
  2466             88  CF-COMPANY-MASTER              VALUE '1'.
  2467             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2468             88  CF-STATE-MASTER                VALUE '3'.
  2469             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2470             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2471             88  CF-CARRIER-MASTER              VALUE '6'.
  2472             88  CF-MORTALITY-MASTER            VALUE '7'.
  2473             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2474             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  51
* EL652.cbl
  2475             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2476             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2477             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2478             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2479             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2480             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2481             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2482             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2483             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2484         16  CF-ACCESS-CD-GENL              PIC X(4).
  2485         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2486             20  CF-PROCESSOR               PIC X(4).
  2487         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2488             20  CF-STATE-CODE              PIC XX.
  2489             20  FILLER                     PIC XX.
  2490         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2491             20  FILLER                     PIC XX.
  2492             20  CF-HI-BEN-IN-REC           PIC XX.
  2493         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2494             20  FILLER                     PIC XXX.
  2495             20  CF-CARRIER-CNTL            PIC X.
  2496         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2497             20  FILLER                     PIC XX.
  2498             20  CF-HI-TYPE-IN-REC          PIC 99.
  2499         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2500             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2501                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2502             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2503             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2504         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2505             20  FILLER                     PIC X.
  2506             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2507         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2508             20  FILLER                     PIC XX.
  2509             20  CF-MORTGAGE-PLAN           PIC XX.
  2510         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2511
  2512     12  CF-LAST-MAINT-DT                   PIC XX.
  2513     12  CF-LAST-MAINT-BY                   PIC X(4).
  2514     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2515
  2516     12  CF-RECORD-BODY                     PIC X(728).
  2517
  2518
  2519****************************************************************
  2520*             COMPANY MASTER RECORD                            *
  2521****************************************************************
  2522
  2523     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2524         16  CF-COMPANY-ADDRESS.
  2525             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2526             20  CF-CL-IN-CARE-OF           PIC X(30).
  2527             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2528             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2529             20  CF-CL-CITY-STATE           PIC X(30).
  2530             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2531             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2532         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  52
* EL652.cbl
  2533         16  CF-COMPANY-PASSWORD            PIC X(8).
  2534         16  CF-SECURITY-OPTION             PIC X.
  2535             88  ALL-SECURITY                   VALUE '1'.
  2536             88  COMPANY-VERIFY                 VALUE '2'.
  2537             88  PROCESSOR-VERIFY               VALUE '3'.
  2538             88  NO-SECURITY                    VALUE '4'.
  2539             88  ALL-BUT-TERM                   VALUE '5'.
  2540         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2541             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2542         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2543             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2544         16  CF-INFORCE-LOCATION            PIC X.
  2545             88  CERTS-ARE-ONLINE               VALUE '1'.
  2546             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2547             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2548         16  CF-LOWER-CASE-LETTERS          PIC X.
  2549         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2550             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2551             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2552             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2553             88  CF-ACCNT-CNTL                  VALUE '3'.
  2554             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2555
  2556         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2557         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2558
  2559         16  CF-LGX-CREDIT-USER             PIC X.
  2560             88  CO-IS-NOT-USER                 VALUE 'N'.
  2561             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2562
  2563         16 CF-CREDIT-CALC-CODES.
  2564             20  CF-CR-REM-TERM-CALC PIC X.
  2565               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2566               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2567               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2568               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2569               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2570               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2571               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2572             20  CF-CR-R78-METHOD           PIC X.
  2573               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2574               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2575
  2576         16  CF-CLAIM-CONTROL-COUNTS.
  2577             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2578                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2579
  2580             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2581                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2582
  2583             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2584                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2585
  2586             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2587                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2588
  2589         16  CF-CURRENT-MONTH-END           PIC XX.
  2590
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  53
* EL652.cbl
  2591         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2592             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2593             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2594             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2595             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2596                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2597                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2598             20  CF-CO-PREM-REJECT-SW       PIC X.
  2599                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2600                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2601             20  CF-CO-REF-REJECT-SW        PIC X.
  2602                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2603                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2604
  2605         16  CF-CO-REPORTING-DT             PIC XX.
  2606         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2607         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2608           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2609           88  CF-CO-MONTH-END                  VALUE '1'.
  2610
  2611         16  CF-LGX-CLAIM-USER              PIC X.
  2612             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2613             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2614
  2615         16  CF-CREDIT-EDIT-CONTROLS.
  2616             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2617             20  CF-MIN-AGE                 PIC 99.
  2618             20  CF-DEFAULT-AGE             PIC 99.
  2619             20  CF-MIN-TERM                PIC S999      COMP-3.
  2620             20  CF-MAX-TERM                PIC S999      COMP-3.
  2621             20  CF-DEFAULT-SEX             PIC X.
  2622             20  CF-JOINT-AGE-INPUT         PIC X.
  2623                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2624             20  CF-BIRTH-DATE-INPUT        PIC X.
  2625                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2626             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2627                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2628                 88  CF-ZERO-CARRIER            VALUE '1'.
  2629                 88  CF-ZERO-GROUPING           VALUE '2'.
  2630                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2631             20  CF-EDIT-SW                 PIC X.
  2632                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2633             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2634             20  CF-CR-PR-METHOD            PIC X.
  2635               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2636               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2637             20  FILLER                     PIC X.
  2638
  2639         16  CF-CREDIT-MISC-CONTROLS.
  2640             20  CF-REIN-TABLE-SW           PIC X.
  2641                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2642             20  CF-COMP-TABLE-SW           PIC X.
  2643                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2644             20  CF-EXPERIENCE-RETENTION-AGE
  2645                                            PIC S9        COMP-3.
  2646             20  CF-CONVERSION-DT           PIC XX.
  2647             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2648             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  54
* EL652.cbl
  2649                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2650                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2651
  2652             20  CF-CR-CHECK-NO-CONTROL.
  2653                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2654                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2655                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2656                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2657                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2658                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2659
  2660                 24  CF-CR-CHECK-COUNT       REDEFINES
  2661                     CF-CR-CHECK-COUNTER      PIC X(4).
  2662
  2663                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2664                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2665
  2666                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2667                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2668                 24  CF-MAIL-PROCESSING       PIC X.
  2669                     88  MAIL-PROCESSING          VALUE 'Y'.
  2670
  2671         16  CF-MISC-SYSTEM-CONTROL.
  2672             20  CF-SYSTEM-C                 PIC X.
  2673                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2674             20  CF-SYSTEM-D                 PIC X.
  2675                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2676             20  CF-SOC-SEC-NO-SW            PIC X.
  2677                 88  SOC-SEC-NO-USED             VALUE '1'.
  2678             20  CF-MEMBER-NO-SW             PIC X.
  2679                 88  MEMBER-NO-USED              VALUE '1'.
  2680             20  CF-TAX-ID-NUMBER            PIC X(11).
  2681             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2682             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2683                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2684                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2685                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2686                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2687             20  CF-SYSTEM-E                 PIC X.
  2688                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2689
  2690         16  CF-LGX-LIFE-USER               PIC X.
  2691             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2692             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2693
  2694         16  CF-CR-MONTH-END-DT             PIC XX.
  2695
  2696         16  CF-FILE-MAINT-DATES.
  2697             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2698                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2699             20  CF-LAST-BATCH       REDEFINES
  2700                 CF-LAST-BATCH-NO               PIC X(4).
  2701             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2702             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2703             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2704             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2705             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2706             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  55
* EL652.cbl
  2707             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2708             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2709             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2710             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2711
  2712         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2713         16  FILLER                         PIC X.
  2714
  2715         16  CF-ALT-MORT-CODE               PIC X(4).
  2716         16  CF-MEMBER-CAPTION              PIC X(10).
  2717
  2718         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2719             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2720             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2721             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2722             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2723             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2724
  2725         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2726
  2727         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2728         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2729         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2730         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2731
  2732         16  CF-AH-OVERRIDE-L1              PIC X.
  2733         16  CF-AH-OVERRIDE-L2              PIC XX.
  2734         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2735         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2736
  2737         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2738         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2739
  2740         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2741         16  CF-AR-LAST-EL860-DT            PIC XX.
  2742         16  CF-MP-MONTH-END-DT             PIC XX.
  2743
  2744         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2745         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2746             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2747
  2748         16  CF-AR-MONTH-END-DT             PIC XX.
  2749
  2750         16  CF-CRDTCRD-USER                PIC X.
  2751             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2752             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2753
  2754         16  CF-CC-MONTH-END-DT             PIC XX.
  2755
  2756         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2757
  2758         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2759             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2760             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2761             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2762         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2763         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2764         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  56
* EL652.cbl
  2765         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2766             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2767             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2768         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2769         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2770         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2771             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2772         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2773
  2774         16  CF-CL-ZIP-CODE.
  2775             20  CF-CL-ZIP-PRIME.
  2776                 24  CF-CL-ZIP-1ST          PIC X.
  2777                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2778                 24  FILLER                 PIC X(4).
  2779             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2780         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2781             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2782             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2783             20  FILLER                     PIC XXX.
  2784
  2785         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2786         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2787         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2788         16  CF-CO-OPTION-START-DATE        PIC XX.
  2789         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2790           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2791                                                      '3' '4'.
  2792           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2793           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2794           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2795           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2796           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2797           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2798
  2799         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2800
  2801         16  CF-PAYMENT-APPROVAL-LEVELS.
  2802             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2803             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2804             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2805             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2806             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2807             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2808
  2809         16  CF-END-USER-REPORTING-USER     PIC X.
  2810             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2811             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2812
  2813         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2814             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2815             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2816
  2817         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2818
  2819         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2820         16  FILLER                         PIC X.
  2821
  2822         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  57
* EL652.cbl
  2823             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2824             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2825             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2826
  2827         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2828
  2829         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2830             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2831             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2832
  2833         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2834             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2835             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2836
  2837         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2838
  2839         16  CF-CO-ACH-ID-CODE              PIC  X.
  2840             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2841             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2842             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2843         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2844         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2845         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2846         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2847         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2848         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2849         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2850         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2851         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2852                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2853         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2854                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2855
  2856         16  CF-CO-OVER-SHORT.
  2857             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2858             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2859
  2860*         16  FILLER                         PIC X(102).
  2861         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2862             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2863             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2864
  2865         16  CF-AH-APPROVAL-DAYS.
  2866             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2867             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2868             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2869             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2870
  2871         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2872
  2873         16  CF-APPROV-LEV-5.
  2874             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2875             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2876             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2877
  2878         16  FILLER                         PIC X(68).
  2879****************************************************************
  2880*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  58
* EL652.cbl
  2881****************************************************************
  2882
  2883     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2884         16  CF-PROCESSOR-NAME              PIC X(30).
  2885         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2886         16  CF-PROCESSOR-TITLE             PIC X(26).
  2887         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2888                 88  MESSAGE-YES                VALUE 'Y'.
  2889                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2890
  2891*****************************************************
  2892****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2893****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2894****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2895****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2896*****************************************************
  2897
  2898         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2899             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2900             20  CF-APPLICATION-FORCE       PIC X.
  2901             20  CF-INDIVIDUAL-APP.
  2902                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2903                     28  CF-BROWSE-APP      PIC X.
  2904                     28  CF-UPDATE-APP      PIC X.
  2905
  2906         16  CF-CURRENT-TERM-ON             PIC X(4).
  2907         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2908             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2909             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2910             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2911             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2912             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2913             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2914             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2915         16  CF-PROCESSOR-CARRIER           PIC X.
  2916             88  NO-CARRIER-SECURITY            VALUE ' '.
  2917         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2918             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2919         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2920             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2921         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2922             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2923
  2924         16  CF-PROC-SYS-ACCESS-SW.
  2925             20  CF-PROC-CREDIT-CLAIMS-SW.
  2926                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2927                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2928                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2929                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2930             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2931                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2932                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2933             20  CF-PROC-LIFE-GNRLDGR-SW.
  2934                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2935                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2936                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2937                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2938             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  59
* EL652.cbl
  2939                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2940                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2941         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2942             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2943             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2944         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2945
  2946         16  CF-APPROVAL-LEVEL                  PIC X.
  2947             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2948             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2949             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2950             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2951             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2952
  2953         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2954
  2955         16  CF-LANGUAGE-TYPE                   PIC X.
  2956             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2957             88  CF-LANG-IS-FR                      VALUE 'F'.
  2958
  2959         16  CF-CSR-IND                         PIC X.
  2960         16  FILLER                             PIC X(239).
  2961
  2962****************************************************************
  2963*             PROCESSOR/REMINDERS RECORD                       *
  2964****************************************************************
  2965
  2966     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2967         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2968             20  CF-START-REMIND-DT         PIC XX.
  2969             20  CF-END-REMIND-DT           PIC XX.
  2970             20  CF-REMINDER-TEXT           PIC X(50).
  2971         16  FILLER                         PIC X(296).
  2972
  2973
  2974****************************************************************
  2975*             STATE MASTER RECORD                              *
  2976****************************************************************
  2977
  2978     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2979         16  CF-STATE-ABBREVIATION          PIC XX.
  2980         16  CF-STATE-NAME                  PIC X(25).
  2981         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2982         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2983             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2984             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2985             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2986             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2987                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2988                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2989             20  CF-ST-PREM-REJECT-SW       PIC X.
  2990                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2991                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2992             20  CF-ST-REF-REJECT-SW        PIC X.
  2993                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2994                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2995         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2996         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  60
* EL652.cbl
  2997         16  CF-ST-REFUND-RULES.
  2998             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2999             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3000             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3001         16  CF-ST-FST-PMT-EXTENSION.
  3002             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3003             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3004                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3005                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3006                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3007                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3008         16  CF-ST-STATE-CALL.
  3009             20  CF-ST-CALL-UNEARNED        PIC X.
  3010             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3011             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3012         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3013             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3014             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3015         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3016         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3017         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3018         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3019         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3020         16  FILLER                         PIC X.
  3021         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3022             20  CF-ST-BENEFIT-CD           PIC XX.
  3023             20  CF-ST-BENEFIT-KIND         PIC X.
  3024                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3025                 88  CF-ST-AH-KIND              VALUE 'A'.
  3026             20  CF-ST-REM-TERM-CALC        PIC X.
  3027                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3028                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3029                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3030                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3031                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3032                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3033                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3034                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3035
  3036             20  CF-ST-REFUND-CALC          PIC X.
  3037                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3038                 88  ST-REFD-BY-R78             VALUE '1'.
  3039                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3040                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3041                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3042                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3043                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3044                 88  ST-REFD-UTAH               VALUE '7'.
  3045                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3046                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3047                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3048
  3049             20  CF-ST-EARNING-CALC         PIC X.
  3050                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3051                 88  ST-EARN-BY-R78             VALUE '1'.
  3052                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3053                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3054                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  61
* EL652.cbl
  3055                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3056                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3057                 88  ST-EARN-MEAN               VALUE '8'.
  3058                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3059
  3060             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3061                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3062                 88  ST-OVRD-BY-R78             VALUE '1'.
  3063                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3064                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3065                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3066                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3067                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3068                 88  ST-OVRD-MEAN               VALUE '8'.
  3069                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3070             20  cf-st-extra-periods        pic 9.
  3071*            20  FILLER                     PIC X.
  3072
  3073         16  CF-ST-COMMISSION-CAPS.
  3074             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3075             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3076             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3077             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3078         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3079                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3080
  3081         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3082
  3083         16  CF-ST-STATUTORY-INTEREST.
  3084             20  CF-ST-STAT-DATE-FROM       PIC X.
  3085                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3086                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3087             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3088             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3089             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3090             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3091             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3092
  3093         16  CF-ST-OVER-SHORT.
  3094             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3095             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3096
  3097         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3098
  3099         16  CF-ST-RT-CALC                  PIC X.
  3100
  3101         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3102         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3103         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3104         16  CF-ST-RF-LR-CALC               PIC X.
  3105         16  CF-ST-RF-LL-CALC               PIC X.
  3106         16  CF-ST-RF-LN-CALC               PIC X.
  3107         16  CF-ST-RF-AH-CALC               PIC X.
  3108         16  CF-ST-RF-CP-CALC               PIC X.
  3109*        16  FILLER                         PIC X(206).
  3110*CIDMOD         16  FILLER                         PIC X(192).
  3111         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3112             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  62
* EL652.cbl
  3113         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3114         16  CF-ST-VFY-2ND-BENE             PIC X.
  3115         16  CF-ST-CAUSAL-STATE             PIC X.
  3116         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3117         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3118         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3119             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3120         16  CF-ST-NET-ONLY-STATE           PIC X.
  3121             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3122         16  FILLER                         PIC X(181).
  3123
  3124****************************************************************
  3125*             BENEFIT MASTER RECORD                            *
  3126****************************************************************
  3127
  3128     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3129         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3130             20  CF-BENEFIT-CODE            PIC XX.
  3131             20  CF-BENEFIT-NUMERIC  REDEFINES
  3132                 CF-BENEFIT-CODE            PIC XX.
  3133             20  CF-BENEFIT-ALPHA           PIC XXX.
  3134             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3135             20  CF-BENEFIT-COMMENT         PIC X(10).
  3136
  3137             20  CF-LF-COVERAGE-TYPE        PIC X.
  3138                 88  CF-REDUCING                VALUE 'R'.
  3139                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3140
  3141             20  CF-SPECIAL-CALC-CD         PIC X.
  3142                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3143                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3144                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3145                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3146                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3147                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3148                 88  CF-FARM-PLAN               VALUE 'F'.
  3149                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3150                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3151                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3152                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3153                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3154                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3155                 88  CF-PRUDENTIAL              VALUE 'P'.
  3156                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3157                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3158                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3159                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3160                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3161                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3162
  3163             20  CF-JOINT-INDICATOR         PIC X.
  3164                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3165
  3166*            20  FILLER                     PIC X(12).
  3167             20  cf-maximum-benefits        pic s999 comp-3.
  3168             20  FILLER                     PIC X(09).
  3169             20  CF-BENEFIT-CATEGORY        PIC X.
  3170             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  63
* EL652.cbl
  3171
  3172             20  CF-CO-REM-TERM-CALC        PIC X.
  3173                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3174                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3175                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3176                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3177                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3178
  3179             20  CF-CO-EARNINGS-CALC        PIC X.
  3180                 88  CO-EARN-BY-R78             VALUE '1'.
  3181                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3182                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3183                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3184                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3185                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3186                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3187                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3188
  3189             20  CF-CO-REFUND-CALC          PIC X.
  3190                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3191                 88  CO-REFD-BY-R78             VALUE '1'.
  3192                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3193                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3194                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3195                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3196                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3197                 88  CO-REFD-MEAN               VALUE '8'.
  3198                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3199                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3200                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3201
  3202             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3203                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3204                 88  CO-OVRD-BY-R78             VALUE '1'.
  3205                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3206                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3207                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3208                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3209                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3210                 88  CO-OVRD-MEAN               VALUE '8'.
  3211                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3212
  3213             20  CF-CO-BEN-I-G-CD           PIC X.
  3214                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3215                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3216                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3217
  3218         16  FILLER                         PIC X(304).
  3219
  3220
  3221****************************************************************
  3222*             CARRIER MASTER RECORD                            *
  3223****************************************************************
  3224
  3225     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3226         16  CF-ADDRESS-DATA.
  3227             20  CF-MAIL-TO-NAME            PIC X(30).
  3228             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  64
* EL652.cbl
  3229             20  CF-ADDRESS-LINE-1          PIC X(30).
  3230             20  CF-ADDRESS-LINE-2          PIC X(30).
  3231             20  CF-CITY-STATE              PIC X(30).
  3232             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3233             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3234
  3235         16  CF-CLAIM-NO-CONTROL.
  3236             20  CF-CLAIM-NO-METHOD         PIC X.
  3237                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3238                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3239                 88  CLAIM-NO-SEQ               VALUE '3'.
  3240                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3241             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3242                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3243                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3244                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3245
  3246         16  CF-CHECK-NO-CONTROL.
  3247             20  CF-CHECK-NO-METHOD         PIC X.
  3248                 88  CHECK-NO-MANUAL            VALUE '1'.
  3249                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3250                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3251                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3252             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3253                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3254
  3255         16  CF-DOMICILE-STATE              PIC XX.
  3256
  3257         16  CF-EXPENSE-CONTROLS.
  3258             20  CF-EXPENSE-METHOD          PIC X.
  3259                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3260                 88  DOLLARS-PER-PMT            VALUE '2'.
  3261                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3262                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3263             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3264             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3265
  3266         16  CF-CORRESPONDENCE-CONTROL.
  3267             20  CF-LETTER-RESEND-OPT       PIC X.
  3268                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3269                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3270             20  FILLER                     PIC X(4).
  3271
  3272         16  CF-RESERVE-CONTROLS.
  3273             20  CF-MANUAL-SW               PIC X.
  3274                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3275             20  CF-FUTURE-SW               PIC X.
  3276                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3277             20  CF-PTC-SW                  PIC X.
  3278                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3279             20  CF-IBNR-SW                 PIC X.
  3280                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3281             20  CF-PTC-LF-SW               PIC X.
  3282                 88  CF-LF-PTC-USED             VALUE '1'.
  3283             20  CF-CDT-ACCESS-METHOD       PIC X.
  3284                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3285                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3286                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  65
* EL652.cbl
  3287             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3288
  3289         16  CF-CLAIM-CALC-METHOD           PIC X.
  3290             88  360-PLUS-MONTHS                VALUE '1'.
  3291             88  365-PLUS-MONTHS                VALUE '2'.
  3292             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3293             88  360-DAILY                      VALUE '4'.
  3294             88  365-DAILY                      VALUE '5'.
  3295
  3296         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3297         16  FILLER                         PIC X(11).
  3298
  3299         16  CF-LIMIT-AMOUNTS.
  3300             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3301             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3302             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3303             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3304             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3305             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3306             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3307             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3308             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3309             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3310
  3311         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3312         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3313         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3314
  3315         16  CF-ZIP-CODE.
  3316             20  CF-ZIP-PRIME.
  3317                 24  CF-ZIP-1ST             PIC X.
  3318                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3319                 24  FILLER                 PIC X(4).
  3320             20  CF-ZIP-PLUS4               PIC X(4).
  3321         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3322             20  CF-CAN-POSTAL-1            PIC XXX.
  3323             20  CF-CAN-POSTAL-2            PIC XXX.
  3324             20  FILLER                     PIC XXX.
  3325
  3326         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3327         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3328         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3329
  3330         16  CF-RATING-SWITCH               PIC X.
  3331             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3332             88  CF-NO-RATING                   VALUE 'N'.
  3333
  3334         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3335
  3336         16  CF-CARRIER-OVER-SHORT.
  3337             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3338             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3339
  3340         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3341         16  CF-SECPAY-SWITCH               PIC X.
  3342             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3343             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3344         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  66
* EL652.cbl
  3345         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3346         16  FILLER                         PIC X(444).
  3347*        16  FILLER                         PIC X(452).
  3348
  3349
  3350****************************************************************
  3351*             MORTALITY MASTER RECORD                          *
  3352****************************************************************
  3353
  3354     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3355         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3356                                INDEXED BY CF-MORT-NDX.
  3357             20  CF-MORT-TABLE              PIC X(5).
  3358             20  CF-MORT-TABLE-TYPE         PIC X.
  3359                 88  CF-MORT-JOINT              VALUE 'J'.
  3360                 88  CF-MORT-SINGLE             VALUE 'S'.
  3361                 88  CF-MORT-COMBINED           VALUE 'C'.
  3362                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3363                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3364             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3365             20  CF-MORT-AGE-METHOD         PIC XX.
  3366                 88  CF-AGE-LAST                VALUE 'AL'.
  3367                 88  CF-AGE-NEAR                VALUE 'AN'.
  3368             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3369             20  CF-MORT-ADJUSTMENT-DIRECTION
  3370                                            PIC X.
  3371                 88  CF-MINUS                   VALUE '-'.
  3372                 88  CF-PLUS                    VALUE '+'.
  3373             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3374             20  CF-MORT-JOINT-CODE         PIC X.
  3375                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3376             20  CF-MORT-PC-Q               PIC X.
  3377                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3378             20  CF-MORT-TABLE-CODE         PIC X(4).
  3379             20  CF-MORT-COMMENTS           PIC X(15).
  3380             20  FILLER                     PIC X(14).
  3381
  3382         16  FILLER                         PIC X(251).
  3383
  3384
  3385****************************************************************
  3386*             BUSSINESS TYPE MASTER RECORD                     *
  3387****************************************************************
  3388
  3389     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3390* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3391* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3392* AND RECORD 05 IS TYPES 81-99
  3393         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3394             20  CF-BUSINESS-TITLE          PIC  X(19).
  3395             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3396                                            PIC S9V9(4) COMP-3.
  3397             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3398             20  FILLER                     PIC  X.
  3399         16  FILLER                         PIC  X(248).
  3400
  3401
  3402****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  67
* EL652.cbl
  3403*             TERMINAL MASTER RECORD                           *
  3404****************************************************************
  3405
  3406     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3407
  3408         16  CF-COMPANY-TERMINALS.
  3409             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3410                                  PIC X(4).
  3411         16  FILLER               PIC X(248).
  3412
  3413
  3414****************************************************************
  3415*             LIFE EDIT MASTER RECORD                          *
  3416****************************************************************
  3417
  3418     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3419         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3420             20  CF-LIFE-CODE-IN            PIC XX.
  3421             20  CF-LIFE-CODE-OUT           PIC XX.
  3422         16  FILLER                         PIC X(248).
  3423
  3424
  3425****************************************************************
  3426*             AH EDIT MASTER RECORD                            *
  3427****************************************************************
  3428
  3429     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3430         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3431             20  CF-AH-CODE-IN              PIC XXX.
  3432             20  CF-AH-CODE-OUT             PIC XX.
  3433         16  FILLER                         PIC X(248).
  3434
  3435
  3436****************************************************************
  3437*             CREDIBILITY TABLES                               *
  3438****************************************************************
  3439
  3440     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3441         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3442                             INDEXED BY CF-CRDB-NDX.
  3443             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3444             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3445             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3446         16  FILLER                         PIC  X(332).
  3447
  3448
  3449****************************************************************
  3450*             REPORT CUSTOMIZATION RECORD                      *
  3451****************************************************************
  3452
  3453     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3454         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3455             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3456             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3457             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3458**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3459****       A T-TRANSFER.                                   ****
  3460             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  68
* EL652.cbl
  3461
  3462         16  FILLER                         PIC XX.
  3463
  3464         16  CF-CARRIER-CNTL-OPT.
  3465             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3466                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3467                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3468             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3469                                            PIC X.
  3470         16  CF-GROUP-CNTL-OPT.
  3471             20  CF-GROUP-OPT-SEQ           PIC 9.
  3472                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3473                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3474             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3475                                            PIC X(6).
  3476         16  CF-STATE-CNTL-OPT.
  3477             20  CF-STATE-OPT-SEQ           PIC 9.
  3478                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3479                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3480             20  CF-STATE-SELECT OCCURS 3 TIMES
  3481                                            PIC XX.
  3482         16  CF-ACCOUNT-CNTL-OPT.
  3483             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3484                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3485                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3486             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3487                                            PIC X(10).
  3488         16  CF-BUS-TYP-CNTL-OPT.
  3489             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3490                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3491                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3492             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3493                                            PIC XX.
  3494         16  CF-LF-TYP-CNTL-OPT.
  3495             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3496                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3497                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3498             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3499                                            PIC XX.
  3500         16  CF-AH-TYP-CNTL-OPT.
  3501             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3502                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3503                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3504             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3505                                            PIC XX.
  3506         16  CF-REPTCD1-CNTL-OPT.
  3507             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3508                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3509                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3510             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3511                                            PIC X(10).
  3512         16  CF-REPTCD2-CNTL-OPT.
  3513             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3514                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3515                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3516             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3517                                            PIC X(10).
  3518         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  69
* EL652.cbl
  3519             20  CF-USER1-OPT-SEQ           PIC 9.
  3520                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3521                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3522             20  CF-USER1-SELECT OCCURS 3 TIMES
  3523                                            PIC X(10).
  3524         16  CF-USER2-CNTL-OPT.
  3525             20  CF-USER2-OPT-SEQ           PIC 9.
  3526                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3527                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3528             20  CF-USER2-SELECT OCCURS 3 TIMES
  3529                                            PIC X(10).
  3530         16  CF-USER3-CNTL-OPT.
  3531             20  CF-USER3-OPT-SEQ           PIC 9.
  3532                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3533                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3534             20  CF-USER3-SELECT OCCURS 3 TIMES
  3535                                            PIC X(10).
  3536         16  CF-USER4-CNTL-OPT.
  3537             20  CF-USER4-OPT-SEQ           PIC 9.
  3538                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3539                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3540             20  CF-USER4-SELECT OCCURS 3 TIMES
  3541                                            PIC X(10).
  3542         16  CF-USER5-CNTL-OPT.
  3543             20  CF-USER5-OPT-SEQ           PIC 9.
  3544                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3545                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3546             20  CF-USER5-SELECT OCCURS 3 TIMES
  3547                                            PIC X(10).
  3548         16  CF-REINS-CNTL-OPT.
  3549             20  CF-REINS-OPT-SEQ           PIC 9.
  3550                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3551                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3552             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3553                 24  CF-REINS-PRIME         PIC XXX.
  3554                 24  CF-REINS-SUB           PIC XXX.
  3555
  3556         16  CF-AGENT-CNTL-OPT.
  3557             20  CF-AGENT-OPT-SEQ           PIC 9.
  3558                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3559                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3560             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3561                                            PIC X(10).
  3562
  3563         16  FILLER                         PIC X(43).
  3564
  3565         16  CF-LOSS-RATIO-SELECT.
  3566             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3567             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3568         16  CF-ENTRY-DATE-SELECT.
  3569             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3570             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3571         16  CF-EFFECTIVE-DATE-SELECT.
  3572             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3573             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3574
  3575         16  CF-EXCEPTION-LIST-IND          PIC X.
  3576             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  70
* EL652.cbl
  3577
  3578         16  FILLER                         PIC X(318).
  3579
  3580****************************************************************
  3581*                  EXCEPTION REPORTING RECORD                  *
  3582****************************************************************
  3583
  3584     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3585         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3586             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3587
  3588         16  CF-COMBINED-LIFE-AH-OPT.
  3589             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3590             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3591             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3592             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3593
  3594         16  CF-LIFE-OPT.
  3595             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3596             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3597             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3598             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3599             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3600             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3601             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3602             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3603             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3604             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3605
  3606         16  CF-AH-OPT.
  3607             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3608             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3609             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3610             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3611             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3612             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3613             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3614             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3615             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3616             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3617
  3618         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3619             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3620             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3621             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3622
  3623         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3624
  3625         16  FILLER                         PIC X(673).
  3626
  3627
  3628****************************************************************
  3629*             MORTGAGE SYSTEM PLAN RECORD                      *
  3630****************************************************************
  3631
  3632     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3633         16  CF-PLAN-TYPE                   PIC X.
  3634             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  71
* EL652.cbl
  3635             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3636             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3637         16  CF-PLAN-ABBREV                 PIC XXX.
  3638         16  CF-PLAN-DESCRIPT               PIC X(10).
  3639         16  CF-PLAN-NOTES                  PIC X(20).
  3640         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3641         16  CF-PLAN-UNDERWRITING.
  3642             20  CF-PLAN-TERM-DATA.
  3643                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3644                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3645             20  CF-PLAN-AGE-DATA.
  3646                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3647                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3648                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3649             20  CF-PLAN-BENEFIT-DATA.
  3650                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3651                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3652                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3653                                            PIC S9(7)V99  COMP-3.
  3654         16  CF-PLAN-POLICY-FORMS.
  3655             20  CF-POLICY-FORM             PIC X(12).
  3656             20  CF-MASTER-APPLICATION      PIC X(12).
  3657             20  CF-MASTER-POLICY           PIC X(12).
  3658         16  CF-PLAN-RATING.
  3659             20  CF-RATE-CODE               PIC X(5).
  3660             20  CF-SEX-RATING              PIC X.
  3661                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3662                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3663             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3664             20  CF-SUB-STD-TYPE            PIC X.
  3665                 88  CF-PCT-OF-PREM            VALUE '1'.
  3666                 88  CF-PCT-OF-BENE            VALUE '2'.
  3667         16  CF-PLAN-PREM-TOLERANCES.
  3668             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3669             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3670         16  CF-PLAN-PYMT-TOLERANCES.
  3671             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3672             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3673         16  CF-PLAN-MISC-DATA.
  3674             20  FILLER                     PIC X.
  3675             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3676             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3677         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3678         16  CF-PLAN-IND-GRP                PIC X.
  3679             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3680                                                     '1'.
  3681             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3682                                                     '2'.
  3683         16  CF-MIB-SEARCH-SW               PIC X.
  3684             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3685             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3686             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3687             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3688         16  CF-ALPHA-SEARCH-SW             PIC X.
  3689             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3690             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3691             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3692             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  72
* EL652.cbl
  3693             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3694             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3695             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3696             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3697             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3698             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3699                                                     'A' 'B' 'C'
  3700                                                     'X' 'Y' 'Z'.
  3701         16  CF-EFF-DT-RULE-SW              PIC X.
  3702             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3703             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3704             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3705             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3706             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3707         16  FILLER                         PIC X(4).
  3708         16  CF-HEALTH-QUESTIONS            PIC X.
  3709             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3710         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3711         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3712         16  CF-PLAN-SNGL-JNT               PIC X.
  3713             88  CF-COMBINED-PLAN              VALUE 'C'.
  3714             88  CF-JNT-PLAN                   VALUE 'J'.
  3715             88  CF-SNGL-PLAN                  VALUE 'S'.
  3716         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3717         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3718         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3719         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3720         16  CF-RERATE-CNTL                 PIC  X.
  3721             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3722             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3723             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3724             88  CF-AUTO-RECALC                 VALUE '4'.
  3725         16  CF-BENEFIT-TYPE                PIC  X.
  3726             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3727             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3728         16  CF-POLICY-FEE                  PIC S999V99
  3729                                                    COMP-3.
  3730         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3731         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3732         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3733         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3734         16  FILLER                         PIC  X(32).
  3735         16  CF-TERMINATION-FORM            PIC  X(04).
  3736         16  FILLER                         PIC  X(08).
  3737         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3738                                                       COMP-3.
  3739         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3740         16  CF-ISSUE-LETTER                PIC  X(4).
  3741         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3742         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3743             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3744             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3745         16  CF-MP-REFUND-CALC              PIC X.
  3746             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3747             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3748             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3749             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3750             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  73
* EL652.cbl
  3751             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3752             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3753             88  CF-MP-REFD-MEAN                VALUE '8'.
  3754         16  CF-ALT-RATE-CODE               PIC  X(5).
  3755
  3756
  3757         16  FILLER                         PIC X(498).
  3758****************************************************************
  3759*             MORTGAGE COMPANY MASTER RECORD                   *
  3760****************************************************************
  3761
  3762     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3763         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3764         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3765             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3766             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3767             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3768             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3769             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3770
  3771         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3772         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3773         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3774         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3775         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3776
  3777         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3778             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3779         16  CF-MP-RECON-USE-IND            PIC X(1).
  3780             88  CF-MP-USE-RECON             VALUE 'Y'.
  3781         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3782             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3783         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3784             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3785             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3786         16  FILLER                         PIC X(1).
  3787         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3788             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3789         16  CF-MORTG-MIB-VERSION           PIC X.
  3790             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3791             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3792             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3793         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3794             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3795                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3796             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3797                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3798             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3799                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3800             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3801                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3802             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3803                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3804             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3805                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3806         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3807         16  FILLER                         PIC X(7).
  3808         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  74
* EL652.cbl
  3809             20  CF-MORTG-MIB-COMM          PIC X(5).
  3810             20  CF-MORTG-MIB-TERM          PIC X(5).
  3811         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3812             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3813         16  FILLER                         PIC X(03).
  3814         16  CF-MP-CHECK-NO-CONTROL.
  3815             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3816                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3817                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3818                                                ' ' LOW-VALUES.
  3819                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3820                                               VALUE '3'.
  3821         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3822         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3823         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3824             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3825                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3826             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3827                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3828             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3829                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3830             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3831                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3832             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3833                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3834             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3835                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3836         16  CF-MORTG-BILLING-AREA.
  3837             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3838                                            PIC X.
  3839         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3840         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3841         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3842         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3843             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3844             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3845         16  FILLER                         PIC X.
  3846         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3847             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3848             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3849         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3850         16  FILLER                         PIC X(8).
  3851         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3852         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3853         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3854         16  CF-ACH-COMPANY-ID.
  3855             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3856                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3857                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3858                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3859             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3860         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3861             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3862         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3863             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3864             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3865         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3866         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  75
* EL652.cbl
  3867         16  FILLER                         PIC X(536).
  3868
  3869****************************************************************
  3870*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3871****************************************************************
  3872
  3873     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3874         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3875             20  CF-FEMALE-HEIGHT.
  3876                 24  CF-FEMALE-FT           PIC 99.
  3877                 24  CF-FEMALE-IN           PIC 99.
  3878             20  CF-FEMALE-MIN-WT           PIC 999.
  3879             20  CF-FEMALE-MAX-WT           PIC 999.
  3880         16  FILLER                         PIC X(428).
  3881
  3882     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3883         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3884             20  CF-MALE-HEIGHT.
  3885                 24  CF-MALE-FT             PIC 99.
  3886                 24  CF-MALE-IN             PIC 99.
  3887             20  CF-MALE-MIN-WT             PIC 999.
  3888             20  CF-MALE-MAX-WT             PIC 999.
  3889         16  FILLER                         PIC X(428).
  3890******************************************************************
  3891*             AUTOMATIC ACTIVITY RECORD                          *
  3892******************************************************************
  3893     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3894         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3895             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3896             20  CF-SYS-LETTER-ID           PIC X(04).
  3897             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3898             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3899             20  CF-SYS-RESET-SW            PIC X(01).
  3900             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3901             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3902
  3903         16  FILLER                         PIC X(50).
  3904
  3905         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3906             20  CF-USER-ACTIVE-SW          PIC X(01).
  3907             20  CF-USER-LETTER-ID          PIC X(04).
  3908             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3909             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3910             20  CF-USER-RESET-SW           PIC X(01).
  3911             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3912             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3913             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3914
  3915         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  76
* EL652.cbl
  3917*                            COPY ERCSUMM.
  3918******************************************************************
  3919*                                                                *
  3920*                                                                *
  3921*                            ERCSUMM                             *
  3922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3923*                            VMOD=2.002                          *
  3924*                                                                *
  3925*   ONLINE CREDIT SYSTEM                                         *
  3926*                                                                *
  3927*   FILE DESCRIPTION = AR SUMMARY CROSS REFERENCE                *
  3928*                                                                *
  3929*   FILE TYPE = VSAM,KSDS                                        *
  3930*   RECORD SIZE = 150           RECFORM = FIXED                  *
  3931*                                                                *
  3932*   BASE CLUSTER NAME = ERSUMM                   RKP=2,LEN=34    *
  3933*                                                                *
  3934*       ALTERNATE PATH1 = ERSUMM2  (BY CO SUMMARY CARR           *
  3935*                                      GROUP F.R. AGENT)         *
  3936*                                                 RKP=36 ,LEN=34 *
  3937*                                                                *
  3938*   LOG = NO                                                     *
  3939*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3940*                                                                *
  3941******************************************************************
  3942
  3943 01  SUMM-CROSS-REFERENCE.
  3944     12  SX-RECORD-ID                PIC XX.
  3945         88  VALID-SX-ID             VALUE 'SX'.
  3946
  3947     12  SX-CONTROL-PRIMARY.
  3948         16  SX-COMPANY-CD           PIC X.
  3949         16  SX-SUMMARY              PIC X(6).
  3950         16  SX-CARRIER              PIC X.
  3951         16  SX-GROUP                PIC X(6).
  3952         16  SX-FIN-RESP             PIC X(10).
  3953         16  SX-ACCT-AGENT           PIC X(10).
  3954
  3955     12  SX-CONTROL-A1.
  3956         16  SX-COMPANY-A1           PIC X.
  3957         16  SX-ACCT-AGENT-A1        PIC X(10).
  3958         16  SX-SUMMARY-A1           PIC X(6).
  3959         16  SX-CARR-A1              PIC X.
  3960         16  SX-GROUP-A1             PIC X(6).
  3961         16  SX-FIN-RESP-A1          PIC X(10).
  3962
  3963     12  SX-MAINT-INFORMATION.
  3964         16  SX-LAST-MAINT-DT        PIC XX.
  3965         16  SX-LAST-MAINT-BY        PIC X(4).
  3966         16  SX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  3967
  3968     12  SX-SUMM-OR-AGT-NAME         PIC X(30).
  3969
  3970     12  FILLER                      PIC X(40).
  3971
  3972******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  77
* EL652.cbl
  3974*                            COPY ERCRQST.
  3975******************************************************************
  3976*                                                                *
  3977*                                                                *
  3978*                            ERCRQST.                            *
  3979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3980*                            VMOD=2.002                          *
  3981*                                                                *
  3982*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  3983*                                                                *
  3984*   FILE TYPE = VSAM,KSDS                                        *
  3985*   RECORD SIZE = 200  RECFORM = FIXED                           *
  3986*                                                                *
  3987*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  3988*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  3989*                                   ACCOUNT, REF, BATCH)         *
  3990*                                                RKP=9, LEN=38   *
  3991*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  3992*                                   ACCOUNT, REF, BATCH)         *
  3993*                                                RKP=47, LEN=46  *
  3994*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  3995*                                   BATCH)                       *
  3996*                                                RKP=93, LEN=24  *
  3997*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  3998*                                   REF, BATCH)                  *
  3999*                                                RKP=117, LEN=35 *
  4000*   LOG = NO                                                     *
  4001*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4002******************************************************************
  4003
  4004 01  AR-REQUEST-RECORD.
  4005     12  RQ-RECORD-ID                     PIC XX.
  4006         88  VALID-RQ-ID                        VALUE 'RQ'.
  4007
  4008     12  RQ-CONTROL-PRIMARY.
  4009         16  RQ-COMPANY-CD                PIC X.
  4010         16  RQ-ENTRY-BATCH               PIC X(6).
  4011
  4012     12  RQ-CONTROL-BY-ACCT-REF.
  4013         16  RQ-COMPANY-CD-A1             PIC X.
  4014         16  RQ-CARRIER-A1                PIC X.
  4015         16  RQ-GROUPING-A1               PIC X(6).
  4016         16  RQ-STATE-A1                  PIC XX.
  4017         16  RQ-ACCOUNT-A1                PIC X(10).
  4018         16  RQ-REFERENCE-A1              PIC X(12).
  4019         16  RQ-BATCH-A1                  PIC X(6).
  4020
  4021     12  RQ-CONTROL-BY-FIN-RESP.
  4022         16  RQ-COMPANY-CD-A2             PIC X.
  4023         16  RQ-CARRIER-A2                PIC X.
  4024         16  RQ-GROUPING-A2               PIC X(6).
  4025         16  RQ-FIN-RESP-A2               PIC X(10).
  4026         16  RQ-ACCT-AGENT-A2             PIC X(10).
  4027         16  RQ-REFERENCE-A2              PIC X(12).
  4028         16  RQ-BATCH-A2                  PIC X(6).
  4029
  4030     12  RQ-CONTROL-BY-ACCT-AGENT.
  4031         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  78
* EL652.cbl
  4032         16  RQ-CARRIER-A3                PIC X.
  4033         16  RQ-GROUPING-A3               PIC X(6).
  4034         16  RQ-ACCT-AGENT-A3             PIC X(10).
  4035         16  RQ-BATCH-A3                  PIC X(6).
  4036
  4037     12  RQ-CONTROL-BY-SUMMARY.
  4038         16  RQ-COMPANY-CD-A4             PIC X.
  4039         16  RQ-SUMMARY-CODE              PIC X(6).
  4040         16  RQ-ACCOUNT-A4                PIC X(10).
  4041         16  RQ-REFERENCE-A4              PIC X(12).
  4042         16  RQ-BATCH-A4                  PIC X(6).
  4043
  4044     12  RQ-REQUEST-METHOD                PIC X.
  4045         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  4046         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  4047         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  4048         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  4049     12  FILLER                           PIC X.
  4050     12  RQ-STATUS                        PIC X.
  4051         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  4052         88  RQ-RESUBMIT                      VALUE 'R'.
  4053     12  RQ-PROCESSOR-ID                  PIC X(4).
  4054     12  RQ-ENTRY-DT                      PIC XX.
  4055     12  RQ-MO-END-DT                     PIC XX.
  4056     12  RQ-REQUEST-DT                    PIC XX.
  4057     12  RQ-STMT-DT                       PIC XX.
  4058     12  RQ-REVERSAL-DT                   PIC XX.
  4059     12  RQ-CREDIT-SELECT-DT              PIC XX.
  4060     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  4061
  4062     12  FILLER                           PIC X(27).
  4063
  4064******************************************************************
  4065
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  79
* EL652.cbl
  4067 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  4068                          COMPENSATION-MASTER AGENT-COMMISSIONS
  4069                          NAME-LOOKUP-MASTER CONTROL-FILE
  4070                          SUMM-CROSS-REFERENCE
  4071                          AR-REQUEST-RECORD.
  4072 0000-DFHEXIT SECTION.
  4073     MOVE '9#                    $   ' TO DFHEIV0.
  4074     MOVE 'EL652' TO DFHEIV1.
  4075     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4076
  4077     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4078     MOVE '5'                    TO  DC-OPTION-CODE.
  4079     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4080     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4081     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4082
  4083     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4084     MOVE EIBTRMID               TO  QID-TERM.
  4085
  4086 1000-START.
  4087     IF EIBCALEN = ZERO
  4088         GO TO 8800-UNAUTHORIZED-ACCESS.
  4089
  4090     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4091         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4092
  4093     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  4094         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  4095             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4096             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4097             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4098             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4099             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4100             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4101             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4102             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4103             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  4104         ELSE
  4105             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4106             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4107             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4108             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4109             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4110             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4111             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4112             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4113
  4114     IF  RETURNED-FROM = XCTL-633
  4115             OR
  4116         RETURNED-FROM = XCTL-633DMD
  4117             OR
  4118         RETURNED-FROM = XCTL-635
  4119             OR
  4120         RETURNED-FROM = XCTL-6521
  4121             OR
  4122         RETURNED-FROM = XCTL-6522
  4123             OR
  4124         RETURNED-FROM = XCTL-6523
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  80
* EL652.cbl
  4125             OR
  4126         RETURNED-FROM = XCTL-6524
  4127             OR
  4128         RETURNED-FROM = XCTL-689
  4129             OR
  4130         RETURNED-FROM = XCTL-690
  4131             OR
  4132         RETURNED-FROM = XCTL-650
  4133         GO TO 3475-RECOVER-TEMP-STOR-PI.
  4134
  4135
  4136* EXEC CICS HANDLE CONDITION
  4137*        NOTOPEN   (9990-ABEND)
  4138*        NOTFND    (8880-NOT-FOUND)
  4139*        PGMIDERR  (9600-PGMID-ERROR)
  4140*        ERROR     (9990-ABEND)
  4141*    END-EXEC.
  4142*    MOVE '"$JIL.                ! " #00004131' TO DFHEIV0
  4143     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4145     MOVE X'2220233030303034313331' TO DFHEIV0(25:11)
  4146     CALL 'kxdfhei1' USING DFHEIV0
  4147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4148
  4149
  4150     IF  EIBTRNID NOT = TRANS-ID
  4151         MOVE LOW-VALUES         TO  EL652AI
  4152         IF  EIBTRNID = EM6508-TRANS-ID
  4153             MOVE DFHENTER       TO  EIBAID
  4154             MOVE 'S'            TO  MAINTYPI
  4155             MOVE PI-CARRIER     TO  CARRIERI
  4156             MOVE PI-GROUPING    TO  GROUPI
  4157             MOVE 'A'            TO  TYPEI
  4158             MOVE PI-CR-FIN-RESP TO  FINRESPI
  4159             MOVE PI-CR-ACCOUNT  TO  ACCTNOI
  4160             MOVE 1              TO  CARRIERL TYPEL MAINTYPL
  4161             MOVE 6              TO  GROUPL
  4162             MOVE 10             TO  FINRESPL  ACCTNOL
  4163             GO TO 4000-EDIT-MAINT
  4164         ELSE
  4165             IF  (EIBTRNID NOT = EL640-TRANS-ID AND
  4166                                 EL633-TRANS-ID AND
  4167                                 EL633DMD-TRANS-ID AND
  4168                                 EL635-TRANS-ID AND
  4169                                 EL642-TRANS-ID AND
  4170                                 EL6501-TRANS-ID AND
  4171                                 EL6592-TRANS-ID AND
  4172                                 EL856-TRANS-ID)
  4173                 OR PI-CR-FIN-RESP = SPACES
  4174                 GO TO 8100-SEND-INITIAL-MAP
  4175             ELSE
  4176                 MOVE DFHENTER   TO  EIBAID
  4177                 MOVE 'S'        TO  MAINTYPI
  4178                 MOVE PI-CR-CARRIER  TO  CARRIERI
  4179                 MOVE PI-CR-GROUPING TO  GROUPI
  4180                 MOVE PI-CR-TYPE     TO  TYPEI
  4181                 MOVE PI-CR-FIN-RESP TO  FINRESPI
  4182                 MOVE PI-CR-ACCOUNT  TO  ACCTNOI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  81
* EL652.cbl
  4183                 MOVE 1              TO  CARRIERL
  4184                                         TYPEL
  4185                                         MAINTYPL
  4186                 MOVE 6              TO  GROUPL
  4187                 MOVE 10             TO  FINRESPL
  4188                                         ACCTNOL
  4189                 GO TO 4000-EDIT-MAINT.
  4190
  4191     IF  EIBAID = DFHCLEAR
  4192             OR
  4193         NOT DISPLAY-CAP
  4194         GO TO 9400-CLEAR.
  4195
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  82
* EL652.cbl
  4197 2000-RECEIVE.
  4198     MOVE LOW-VALUES             TO  EL652AI.
  4199
  4200     IF EIBAID = DFHPA1 OR  DFHPA2  OR  DFHPA3
  4201         MOVE ER-0008            TO  EMI-ERROR
  4202         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4203         MOVE -1                 TO  MAINTYPL
  4204         GO TO 8200-SEND-DATAONLY.
  4205
  4206
  4207* EXEC CICS RECEIVE
  4208*        MAP     (MAP-NAME)
  4209*        MAPSET  (MAPSET-NAME)
  4210*        INTO    (EL652AI)
  4211*    END-EXEC.
  4212     MOVE LENGTH OF
  4213      EL652AI
  4214       TO DFHEIV11
  4215*    MOVE '8"T I  L              ''   #00004194' TO DFHEIV0
  4216     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4217     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4218     MOVE X'2020233030303034313934' TO DFHEIV0(25:11)
  4219     CALL 'kxdfhei1' USING DFHEIV0,
  4220           MAP-NAME,
  4221           EL652AI,
  4222           DFHEIV11,
  4223           MAPSET-NAME,
  4224           DFHEIV99,
  4225           DFHEIV99
  4226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4227
  4228
  4229     IF PFKEYL = ZERO
  4230         GO TO 3000-CHECK-PFKEYS.
  4231
  4232     IF EIBAID NOT = DFHENTER
  4233         MOVE ER-0004            TO EMI-ERROR
  4234         GO TO 3100-INPUT-ERROR.
  4235
  4236     IF (PFKEYI NUMERIC) AND (PFKEYI > 0 AND < 25)
  4237         MOVE PF-VALUES (PFKEYI)  TO  EIBAID
  4238     ELSE
  4239         MOVE ER-0029             TO  EMI-ERROR
  4240         GO TO 3100-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  83
* EL652.cbl
  4242 3000-CHECK-PFKEYS.
  4243     IF EIBAID = DFHPF23
  4244         GO TO 8810-PF23.
  4245
  4246     IF EIBAID = DFHPF24
  4247         GO TO 9200-RETURN-MAIN-MENU.
  4248
  4249     IF EIBAID = DFHPF12
  4250         GO TO 9500-PF12.
  4251
  4252     if (maintypl not = zeros)
  4253        and (maintypi not = 'D')
  4254        move spaces              to pi-el652-del-sw
  4255     end-if
  4256     IF EIBAID = DFHPF1
  4257         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4258             MOVE 'S'            TO  MAINTYPO
  4259             MOVE AL-UANON       TO  MAINTYPA
  4260             MOVE 1              TO  MAINTYPL
  4261             GO TO 7250-PAGE-FORWARD
  4262         ELSE
  4263             GO TO 7250-PAGE-FORWARD.
  4264
  4265     IF EIBAID = DFHPF2
  4266         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4267             MOVE 'S'            TO  MAINTYPO
  4268             MOVE AL-UANON       TO  MAINTYPA
  4269             MOVE 1              TO  MAINTYPL
  4270             GO TO 7300-PAGE-BACKWARD
  4271         ELSE
  4272             GO TO 7300-PAGE-BACKWARD.
  4273
  4274     IF EIBAID = DFHPF3
  4275        IF PI-AR-PROCESSING
  4276            IF PI-ERCOMP-KEY  NOT =       SPACES
  4277                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4278                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4279                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4280                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4281                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4282                IF PI-CR-ACCOUNT =  LOW-VALUES
  4283                   MOVE 'G'         TO  PI-CR-TYPE
  4284                                        PI-ERC-TYPE
  4285                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4286                   MOVE XCTL-635    TO PGM-NAME
  4287                   GO TO 9300-XCTL
  4288                ELSE
  4289                   MOVE 'A'         TO  PI-CR-TYPE
  4290                                        PI-ERC-TYPE
  4291                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4292                   MOVE XCTL-635    TO PGM-NAME
  4293                   GO TO 9300-XCTL
  4294            ELSE
  4295                MOVE ER-3021        TO  EMI-ERROR
  4296                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4297                GO TO 8100-SEND-INITIAL-MAP
  4298        ELSE
  4299            IF PI-ERCOMP-KEY NOT = SPACES AND LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  84
* EL652.cbl
  4300                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4301                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4302                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4303                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4304                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4305                IF PI-CR-ACCOUNT =  LOW-VALUES
  4306*                  MOVE 'G'         TO  PI-CR-TYPE
  4307*                                       PI-ERC-TYPE
  4308                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4309                   IF PI-COMPANY-ID = 'DMD'
  4310                      MOVE XCTL-633DMD TO PGM-NAME
  4311                      GO TO 9300-XCTL
  4312                   ELSE
  4313                      MOVE XCTL-633    TO PGM-NAME
  4314                      GO TO 9300-XCTL
  4315                ELSE
  4316                   MOVE 'A'         TO  PI-CR-TYPE
  4317                                        PI-ERC-TYPE
  4318                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4319                   IF PI-COMPANY-ID = 'DMD'
  4320                      MOVE XCTL-633DMD TO PGM-NAME
  4321                      GO TO 9300-XCTL
  4322                   ELSE
  4323                      MOVE XCTL-633    TO PGM-NAME
  4324                      GO TO 9300-XCTL
  4325            ELSE
  4326                MOVE ER-3021        TO  EMI-ERROR
  4327                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4328                GO TO 8100-SEND-INITIAL-MAP.
  4329
  4330     IF EIBAID = DFHPF4
  4331         IF PI-ERC-TYPE = 'G' OR 'A' OR 'B'
  4332             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4333             MOVE XCTL-6521      TO PGM-NAME
  4334             GO TO 9300-XCTL
  4335         ELSE
  4336             MOVE ER-2872        TO  EMI-ERROR
  4337             GO TO 3100-INPUT-ERROR.
  4338
  4339     IF  EIBAID = DFHPF5
  4340         MOVE XCTL-689           TO PGM-NAME
  4341         IF  PI-ERCOMP-KEY NOT = SPACES
  4342             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4343             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4344             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4345             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4346             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4347
  4348             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4349*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4350                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4351                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4352                 GO TO 9300-XCTL
  4353
  4354             ELSE
  4355                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4356                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4357                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  85
* EL652.cbl
  4358                 GO TO 9300-XCTL
  4359
  4360         ELSE
  4361             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4362             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4363             GO TO 9300-XCTL.
  4364
  4365     IF  EIBAID = DFHPF6
  4366
  4367         MOVE XCTL-690           TO PGM-NAME
  4368
  4369         IF  PI-ERCOMP-KEY NOT = SPACES
  4370             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4371             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4372             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4373             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4374             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4375
  4376             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4377*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4378                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4379                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4380                 GO TO 9300-XCTL
  4381
  4382             ELSE
  4383                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4384                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4385                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4386                 GO TO 9300-XCTL
  4387
  4388         ELSE
  4389             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4390             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4391             GO TO 9300-XCTL.
  4392
  4393     IF EIBAID = DFHPF7
  4394         IF PI-ERC-TYPE = 'A'
  4395            MOVE PI-ERC-CARRIER  TO PI-CR-CARRIER
  4396            MOVE PI-ERC-GROUP    TO PI-CR-GROUPING
  4397            MOVE PI-ERC-ACCT     TO PI-CR-ACCOUNT
  4398*           PERFORM 3200-FIND-STATE
  4399*                                THRU 3200-EXIT
  4400            MOVE PI-SAVE-STATE   TO PI-CR-STATE
  4401            PERFORM 3400-CREATE-TS-PI
  4402                                 THRU 3400-EXIT
  4403            MOVE XCTL-650        TO PGM-NAME
  4404            GO TO 9300-XCTL
  4405         ELSE
  4406            MOVE ER-0035         TO EMI-ERROR
  4407            GO TO 3100-INPUT-ERROR
  4408         END-IF
  4409     END-IF.
  4410
  4411     IF EIBAID = DFHPF8
  4412         IF PI-ERCOMP-KEY NOT = SPACES
  4413             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4414             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4415             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  86
* EL652.cbl
  4416             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4417             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4418             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4419             MOVE XCTL-6522             TO PGM-NAME
  4420             GO TO 9300-XCTL
  4421         ELSE
  4422            MOVE ER-0187                TO EMI-ERROR
  4423            GO TO 3100-INPUT-ERROR
  4424         END-IF
  4425     END-IF.
  4426
  4427*****************************************************************
  4428*  SPECIAL CODE - ENABLES DISPLAY OF PRIOR MONTH-END TOTALS*
  4429*  PF9 AVAILABLE TO A/R USERS                                   *
  4430*****************************************************************
  4431
  4432     IF PI-AR-PROCESSING OR PI-PROCESSOR-ID = 'LGXX'
  4433         IF EIBAID = DFHPF9
  4434             MOVE 'Y'            TO  WS-SHOW-SAVE-TOTALS
  4435             GO TO 4000-EDIT-MAINT.
  4436
  4437     IF EIBAID = DFHPF10
  4438        IF PI-ERC-TYPE = 'B'
  4439         IF PI-ERCOMP-KEY NOT = SPACES
  4440             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4441             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4442             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4443             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4444             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4445             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4446             MOVE XCTL-6523             TO PGM-NAME
  4447             GO TO 9300-XCTL
  4448         ELSE
  4449            MOVE ER-0187                TO EMI-ERROR
  4450            GO TO 3100-INPUT-ERROR
  4451         END-IF
  4452        ELSE
  4453           MOVE ER-0035          TO EMI-ERROR
  4454           GO TO 3100-INPUT-ERROR
  4455        END-IF
  4456     END-IF
  4457     IF EIBAID = DFHPF13
  4458        IF PI-ERC-TYPE = 'B'
  4459           IF PI-ERCOMP-KEY NOT = SPACES
  4460              MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4461              MOVE PI-ERC-GROUP  TO PI-CR-GROUPING
  4462              MOVE PI-ERC-RESP   TO PI-CR-FIN-RESP
  4463              MOVE PI-ERC-ACCT   TO PI-CR-ACCOUNT
  4464              MOVE PI-ERC-TYPE   TO PI-CR-TYPE
  4465              PERFORM 3400-CREATE-TS-PI
  4466                                 THRU 3400-EXIT
  4467              MOVE XCTL-6524     TO PGM-NAME
  4468              GO TO 9300-XCTL
  4469           ELSE
  4470              MOVE ER-0187       TO EMI-ERROR
  4471              GO TO 3100-INPUT-ERROR
  4472           END-IF
  4473        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  87
* EL652.cbl
  4474           MOVE ER-0035          TO EMI-ERROR
  4475           GO TO 3100-INPUT-ERROR
  4476        END-IF
  4477     END-IF
  4478     IF EIBAID = DFHENTER
  4479         GO TO 4000-EDIT-MAINT.
  4480
  4481     MOVE ER-0029                TO  EMI-ERROR.
  4482
  4483 3100-INPUT-ERROR.
  4484     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4485
  4486     MOVE AL-UNBON               TO  PFKEYA.
  4487     MOVE -1                     TO  PFKEYL.
  4488
  4489     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  88
* EL652.cbl
  4491 3200-FIND-STATE.
  4492
  4493     IF PI-SAVE-CITYST NOT = SPACES
  4494        MOVE PI-SAVE-CITYST       TO WS-SRCH-STATE
  4495     ELSE
  4496        IF PI-SAVE-ADDR2 NOT = SPACES
  4497           MOVE PI-SAVE-ADDR2     TO WS-SRCH-STATE
  4498        END-IF
  4499     END-IF
  4500
  4501     PERFORM VARYING STNDX FROM +29 BY -1 UNTIL
  4502          (STNDX < +1) OR
  4503          ((WS-SRCH-STATE (STNDX:2) ALPHABETIC) AND
  4504          (WS-SRCH-STATE (STNDX:2) NOT = SPACES AND LOW-VALUES)
  4505          AND
  4506          (WS-SRCH-STATE (STNDX + 1:1) NOT = ' ' AND ',' AND
  4507                   '.' AND LOW-VALUES) AND
  4508          (WS-SRCH-STATE (STNDX:1) NOT = ' ' AND ',' AND
  4509                   '.' AND LOW-VALUES))
  4510     END-PERFORM
  4511
  4512     IF STNDX NOT < +1
  4513        MOVE WS-SRCH-STATE (STNDX:2)
  4514                                 TO PI-SAVE-STATE
  4515     ELSE
  4516        MOVE SPACES              TO PI-SAVE-STATE
  4517     END-IF
  4518
  4519     .
  4520 3200-EXIT.
  4521     EXIT.
  4522 3400-CREATE-TS-PI.
  4523
  4524     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4525
  4526
  4527* EXEC CICS HANDLE CONDITION
  4528*        QIDERR  (3400-EXIT)
  4529*    END-EXEC.
  4530*    MOVE '"$N                   ! # #00004497' TO DFHEIV0
  4531     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4532     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4533     MOVE X'2320233030303034343937' TO DFHEIV0(25:11)
  4534     CALL 'kxdfhei1' USING DFHEIV0
  4535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4536
  4537
  4538
  4539* EXEC CICS WRITEQ TS
  4540*        QUEUE   (QID-PI)
  4541*        FROM    (PROGRAM-INTERFACE-BLOCK)
  4542*        LENGTH  (PI-COMM-LENGTH)
  4543*        ITEM    (QID-ITEM)
  4544*    END-EXEC.
  4545*    MOVE '*" I                  ''   #00004501' TO DFHEIV0
  4546     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  4547     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4548     MOVE X'2020233030303034353031' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  89
* EL652.cbl
  4549     CALL 'kxdfhei1' USING DFHEIV0,
  4550           QID-PI,
  4551           PROGRAM-INTERFACE-BLOCK,
  4552           PI-COMM-LENGTH,
  4553           QID-ITEM,
  4554           DFHEIV99,
  4555           DFHEIV99
  4556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4557
  4558
  4559 3400-EXIT.
  4560      EXIT.
  4561
  4562 3450-DELETE-TEMP-STOR-PI.
  4563
  4564
  4565* EXEC CICS HANDLE CONDITION
  4566*        QIDERR  (3450-EXIT)
  4567*    END-EXEC.
  4568*    MOVE '"$N                   ! $ #00004513' TO DFHEIV0
  4569     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4571     MOVE X'2420233030303034353133' TO DFHEIV0(25:11)
  4572     CALL 'kxdfhei1' USING DFHEIV0
  4573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4574
  4575
  4576
  4577* EXEC CICS DELETEQ TS
  4578*        QUEUE  (QID-PI)
  4579*    END-EXEC.
  4580*    MOVE '*&                    #   #00004517' TO DFHEIV0
  4581     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4582     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4583     MOVE X'2020233030303034353137' TO DFHEIV0(25:11)
  4584     CALL 'kxdfhei1' USING DFHEIV0,
  4585           QID-PI,
  4586           DFHEIV99
  4587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4588
  4589
  4590
  4591* EXEC CICS SYNCPOINT
  4592*    END-EXEC.
  4593*    MOVE '6"                    !   #00004521' TO DFHEIV0
  4594     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  4595     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4596     MOVE X'2020233030303034353231' TO DFHEIV0(25:11)
  4597     CALL 'kxdfhei1' USING DFHEIV0
  4598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4599
  4600
  4601 3450-EXIT.
  4602      EXIT.
  4603
  4604 3475-RECOVER-TEMP-STOR-PI.
  4605
  4606     MOVE LOW-VALUES            TO  EL652AI.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  90
* EL652.cbl
  4607
  4608
  4609* EXEC CICS HANDLE CONDITION
  4610*        NOTOPEN   (9990-ABEND)
  4611*        NOTFND    (8880-NOT-FOUND)
  4612*        PGMIDERR  (9600-PGMID-ERROR)
  4613*        ERROR     (9990-ABEND)
  4614*    END-EXEC.
  4615*    MOVE '"$JIL.                ! % #00004531' TO DFHEIV0
  4616     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4618     MOVE X'2520233030303034353331' TO DFHEIV0(25:11)
  4619     CALL 'kxdfhei1' USING DFHEIV0
  4620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4621
  4622
  4623
  4624* EXEC CICS HANDLE CONDITION
  4625*        QIDERR  (3475-EXIT)
  4626*    END-EXEC.
  4627*    MOVE '"$N                   ! & #00004538' TO DFHEIV0
  4628     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4629     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4630     MOVE X'2620233030303034353338' TO DFHEIV0(25:11)
  4631     CALL 'kxdfhei1' USING DFHEIV0
  4632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4633
  4634
  4635
  4636* EXEC CICS READQ TS
  4637*        QUEUE   (QID-PI)
  4638*        ITEM    (1)
  4639*        INTO    (PROGRAM-INTERFACE-BLOCK)
  4640*        LENGTH  (PI-COMM-LENGTH)
  4641*    END-EXEC.
  4642     MOVE 1
  4643       TO DFHEIV11
  4644*    MOVE '*$II   L              ''   #00004542' TO DFHEIV0
  4645     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4646     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4647     MOVE X'2020233030303034353432' TO DFHEIV0(25:11)
  4648     CALL 'kxdfhei1' USING DFHEIV0,
  4649           QID-PI,
  4650           PROGRAM-INTERFACE-BLOCK,
  4651           PI-COMM-LENGTH,
  4652           DFHEIV11,
  4653           DFHEIV99,
  4654           DFHEIV99
  4655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4656
  4657
  4658     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4659
  4660     IF  PI-ERCOMP-KEY = SPACES OR LOW-VALUES
  4661         GO TO 8100-SEND-INITIAL-MAP.
  4662
  4663     IF  PI-ERC-CARRIER > LOW-VALUES
  4664         MOVE +1                 TO CARRIERL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  91
* EL652.cbl
  4665         MOVE PI-ERC-CARRIER     TO CARRIERI.
  4666
  4667     IF  PI-ERC-GROUP > LOW-VALUES
  4668         MOVE +6                 TO GROUPL
  4669         MOVE PI-ERC-GROUP       TO GROUPI.
  4670
  4671     IF  PI-ERC-RESP > LOW-VALUES
  4672         MOVE +10                TO FINRESPL
  4673         MOVE PI-ERC-RESP        TO FINRESPI.
  4674
  4675     IF  PI-ERC-ACCT > LOW-VALUES
  4676         MOVE +1                 TO ACCTNOL
  4677         MOVE PI-ERC-ACCT        TO ACCTNOI.
  4678
  4679     IF  PI-ERC-TYPE > LOW-VALUES
  4680         MOVE +1                 TO TYPEL
  4681         MOVE PI-ERC-TYPE        TO TYPEI.
  4682
  4683     MOVE 'S'                    TO MAINTYPI.
  4684     MOVE 1                      TO MAINTYPL.
  4685     GO TO 4000-EDIT-MAINT.
  4686
  4687 3475-EXIT.
  4688      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  92
* EL652.cbl
  4690 4000-EDIT-MAINT.
  4691     IF MAINTYPL > ZERO
  4692         MOVE MAINTYPI           TO  PI-CHECK-MAINT-TYPE
  4693         IF VALID-MAINT-TYPE
  4694             MOVE AL-UANON       TO  MAINTYPA
  4695             IF MAINTYPI NOT = 'S'
  4696                 MOVE SPACES     TO  WS-ACCESS
  4697                 MOVE '1'        TO  CNTL-REC-TYPE
  4698                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
  4699             ELSE
  4700                 NEXT SENTENCE
  4701         ELSE
  4702             MOVE -1             TO  MAINTYPL
  4703             MOVE AL-UABON       TO  MAINTYPA
  4704             MOVE ER-2039        TO  EMI-ERROR
  4705             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4706     ELSE
  4707         MOVE -1                 TO  MAINTYPL
  4708         MOVE AL-UABON           TO  MAINTYPA
  4709         MOVE ER-2039            TO  EMI-ERROR
  4710         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4711
  4712     IF  NOT MODIFY-CAP
  4713             AND
  4714         NOT SHOW-FUNCTION
  4715         MOVE 'UPDATE'           TO SM-READ
  4716         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4717         IF  MORTGAGE-SESSION
  4718             MOVE ER-9096        TO  EMI-ERROR
  4719             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4720             GO TO 8100-SEND-INITIAL-MAP
  4721         ELSE
  4722             MOVE ER-0070        TO  EMI-ERROR
  4723             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4724             GO TO 8100-SEND-INITIAL-MAP.
  4725
  4726     IF CARRIERL > ZERO
  4727         IF PI-CARRIER-SECURITY > SPACES
  4728             IF CARRIERI = PI-CARRIER-SECURITY
  4729                 NEXT SENTENCE
  4730             ELSE
  4731                 MOVE -1            TO  CARRIERL
  4732                 MOVE ER-2370       TO  EMI-ERROR
  4733                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4734                 MOVE AL-UABON      TO  CARRIERA
  4735                 GO TO 8200-SEND-DATAONLY.
  4736
  4737     IF CARRIERL > ZERO
  4738         IF ADD-FUNCTION
  4739             IF PI-ZERO-CARRIER
  4740               OR PI-ZERO-CAR-GROUP
  4741                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4742                                     CARRIERI
  4743                 MOVE AL-UANON   TO  CARRIERA
  4744             ELSE
  4745                 MOVE CARRIERI   TO  WS-CARRIER
  4746                 MOVE '6'        TO  CNTL-REC-TYPE
  4747                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  93
* EL652.cbl
  4748         ELSE
  4749             IF PI-ZERO-CARRIER
  4750               OR PI-ZERO-CAR-GROUP
  4751                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4752                                     CARRIERI
  4753                 MOVE AL-UANON   TO  CARRIERA
  4754             ELSE
  4755                 MOVE AL-UANON   TO  CARRIERA
  4756                 MOVE CARRIERI   TO  PI-ERC-CARRIER
  4757     ELSE
  4758         IF ADD-FUNCTION
  4759             IF PI-ZERO-CARRIER
  4760               OR PI-ZERO-CAR-GROUP
  4761                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4762                                     CARRIERI
  4763                 MOVE AL-UANON   TO  CARRIERA
  4764             ELSE
  4765                 MOVE -1         TO  CARRIERL
  4766                 MOVE AL-UABON   TO  CARRIERA
  4767                 MOVE ER-0193    TO  EMI-ERROR
  4768                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4769         ELSE
  4770             MOVE -1             TO  CARRIERL
  4771             MOVE AL-UABON       TO  CARRIERA
  4772             MOVE ER-0193        TO  EMI-ERROR
  4773             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4774
  4775     IF GROUPL > ZERO
  4776         IF PI-ZERO-GROUPING
  4777           OR PI-ZERO-CAR-GROUP
  4778             MOVE ZEROS          TO  PI-ERC-GROUP
  4779                                     GROUPI
  4780             MOVE AL-UANON       TO  GROUPA
  4781         ELSE
  4782             MOVE AL-UANON       TO  GROUPA
  4783             MOVE GROUPI         TO  PI-ERC-GROUP
  4784     ELSE
  4785         IF ADD-FUNCTION
  4786             IF PI-ZERO-GROUPING
  4787               OR PI-ZERO-CAR-GROUP
  4788                 MOVE ZEROS      TO  PI-ERC-GROUP
  4789                                     GROUPI
  4790                 MOVE AL-UANON   TO  GROUPA
  4791             ELSE
  4792                 MOVE LOW-VALUES  TO  PI-ERC-GROUP
  4793         ELSE
  4794             MOVE LOW-VALUES     TO  PI-ERC-GROUP.
  4795
  4796     IF TYPEL > ZERO
  4797         MOVE TYPEI              TO  PI-CHECK-TYPE
  4798         IF VALID-TYPE
  4799             MOVE AL-UANON       TO  TYPEA
  4800             MOVE TYPEI          TO  PI-ERC-TYPE
  4801         ELSE
  4802             MOVE -1             TO  TYPEL
  4803             MOVE AL-UABON       TO  TYPEA
  4804             MOVE ER-2042        TO  EMI-ERROR
  4805             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  94
* EL652.cbl
  4806     ELSE
  4807         MOVE -1                 TO  TYPEL
  4808         MOVE AL-UABON           TO  TYPEA
  4809         MOVE ER-2042            TO  EMI-ERROR
  4810         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4811
  4812     IF FINRESPL >        ZERO
  4813         MOVE AL-UANON           TO  FINRESPA
  4814         IF FINRESPI = SPACES
  4815             MOVE LOW-VALUES     TO  PI-ERC-RESP
  4816         ELSE
  4817             MOVE FINRESPI       TO  PI-ERC-RESP
  4818     ELSE
  4819         MOVE LOW-VALUES         TO  PI-ERC-RESP.
  4820
  4821     IF ACCTNOL > ZERO
  4822         MOVE AL-UANON           TO  ACCTNOA
  4823         IF ACCTNOI = SPACES
  4824             MOVE LOW-VALUES     TO  PI-ERC-ACCT
  4825         ELSE
  4826             MOVE ACCTNOI        TO  PI-ERC-ACCT
  4827     ELSE
  4828         MOVE LOW-VALUES         TO  PI-ERC-ACCT.
  4829
  4830     IF ADDR2L > ZERO
  4831        MOVE AL-UANON            TO ADDR2A
  4832        IF ADDR2I = SPACES
  4833           MOVE LOW-VALUES       TO PI-SAVE-ADDR2
  4834        ELSE
  4835           MOVE ADDR2I           TO PI-SAVE-ADDR2
  4836        END-IF
  4837     ELSE
  4838        MOVE LOW-VALUES          TO PI-SAVE-ADDR2
  4839     END-IF
  4840
  4841     IF CITYL > ZERO
  4842        MOVE AL-UANON            TO CITYA
  4843        IF CITYI = SPACES
  4844           MOVE LOW-VALUES       TO PI-SAVE-CITY
  4845        ELSE
  4846           MOVE CITYI            TO PI-SAVE-CITY
  4847        END-IF
  4848     ELSE
  4849        MOVE LOW-VALUES          TO PI-SAVE-CITY
  4850     END-IF
  4851
  4852     IF STATEL > ZERO
  4853        MOVE AL-UANON            TO STATEA
  4854        IF STATEI = SPACES
  4855           MOVE LOW-VALUES       TO PI-SAVE-STATE
  4856        ELSE
  4857           MOVE STATEI           TO PI-SAVE-STATE
  4858        END-IF
  4859     ELSE
  4860        MOVE LOW-VALUES          TO PI-SAVE-STATE
  4861     END-IF
  4862
  4863     IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  95
* EL652.cbl
  4864         IF SHOW-FUNCTION
  4865             GO TO 5000-BUILD-INITIAL-SCREEN
  4866         ELSE
  4867             MOVE 'UPDATE'       TO SM-READ
  4868             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4869             MOVE ER-0070        TO  EMI-ERROR
  4870             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4871             GO TO 8100-SEND-INITIAL-MAP.
  4872
  4873     IF EMI-NO-ERRORS
  4874         NEXT SENTENCE
  4875     ELSE
  4876        IF EIBTRNID NOT = TRANS-ID
  4877            GO TO 8100-SEND-INITIAL-MAP
  4878         ELSE
  4879            GO TO 8200-SEND-DATAONLY.
  4880
  4881     IF CHANGE-FUNCTION
  4882         GO TO 4400-CHANGE.
  4883
  4884     IF DELETE-FUNCTION
  4885         GO TO 4600-DELETE.
  4886
  4887     IF SHOW-FUNCTION
  4888         GO TO 5000-BUILD-INITIAL-SCREEN.
  4889
  4890     IF TYPEI = 'C'
  4891         IF FINRESPI NOT = LOW-VALUES OR
  4892            ACCTNOI  NOT = LOW-VALUES
  4893               MOVE -1           TO  FINRESPL
  4894               MOVE AL-UABON     TO  FINRESPA
  4895                                     ACCTNOA
  4896               MOVE ER-2088      TO  EMI-ERROR
  4897               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4898
  4899     IF TYPEI = 'A'
  4900         IF FINRESPI = LOW-VALUES OR
  4901             ACCTNOI = LOW-VALUES
  4902               MOVE -1           TO  FINRESPL
  4903               MOVE AL-UABON     TO  FINRESPA
  4904                                     ACCTNOA
  4905               MOVE ER-2089      TO  EMI-ERROR
  4906               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4907
  4908     IF TYPEI = 'G' OR 'B'
  4909         IF ACCTNOI NOT = LOW-VALUES
  4910             MOVE -1             TO  ACCTNOL
  4911             MOVE AL-UABON       TO  ACCTNOA
  4912             MOVE ER-2091        TO  EMI-ERROR
  4913             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4914         ELSE
  4915             IF FINRESPI = LOW-VALUES
  4916                 MOVE -1         TO  FINRESPL
  4917                 MOVE AL-UABON   TO  FINRESPA
  4918                 MOVE ER-2097    TO  EMI-ERROR
  4919                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4920
  4921     IF TYPEI = 'G' OR 'B'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  96
* EL652.cbl
  4922         IF SUMMNOI NOT = LOW-VALUES
  4923             MOVE -1             TO  SUMMNOL
  4924             MOVE AL-UABON       TO  SUMMNOA
  4925             MOVE ER-3153        TO  EMI-ERROR
  4926             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4927
  4928     IF TYPEI = 'G' OR 'B'
  4929         IF NETGRSI NOT = LOW-VALUES
  4930             MOVE -1             TO  NETGRSL
  4931             MOVE AL-UABON       TO  NETGRSA
  4932             MOVE ER-3154        TO  EMI-ERROR
  4933             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4934
  4935     IF EMI-NO-ERRORS
  4936         NEXT SENTENCE
  4937     ELSE
  4938         GO TO 8200-SEND-DATAONLY.
  4939
  4940     IF ADD-FUNCTION
  4941         GO TO 4200-ADD.
  4942
  4943     MOVE -1                     TO  MAINTYPL.
  4944     MOVE ER-2056                TO  EMI-ERROR.
  4945     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4946
  4947     GO TO 8200-SEND-DATAONLY.
  4948
  4949 4000-EXIT.
  4950     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  97
* EL652.cbl
  4952 4200-ADD.
  4953     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  4954         MOVE ER-2057            TO  EMI-ERROR
  4955         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4956         MOVE -1                 TO  MAINTYPL
  4957         GO TO 8200-SEND-DATAONLY.
  4958
  4959     PERFORM 7000-EDIT  THRU  7000-EXIT.
  4960
  4961     IF EMI-NO-ERRORS
  4962         NEXT SENTENCE
  4963     ELSE
  4964         GO TO 8200-SEND-DATAONLY.
  4965
  4966
  4967* EXEC CICS HANDLE CONDITION
  4968*        NOTOPEN  (9990-ABEND)
  4969*        NOTFND   (4250-CONT)
  4970*    END-EXEC.
  4971*    MOVE '"$JI                  ! '' #00004857' TO DFHEIV0
  4972     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4974     MOVE X'2720233030303034383537' TO DFHEIV0(25:11)
  4975     CALL 'kxdfhei1' USING DFHEIV0
  4976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4977
  4978
  4979     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  4980
  4981     MOVE ER-2057                TO  EMI-ERROR.
  4982     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4983
  4984     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY.
  4985
  4986     MOVE -1                     TO  MAINTYPL.
  4987
  4988     GO TO 8200-SEND-DATAONLY.
  4989
  4990 4250-CONT.
  4991     PERFORM 7150-ERCOMP-GETMAIN  THRU  7150-EXIT.
  4992
  4993     MOVE SPACES                 TO  COMPENSATION-MASTER.
  4994     MOVE ZEROS                  TO  CO-LF-CLM-AMT
  4995                                     CO-AH-CLM-AMT
  4996                                     CO-CUR-FICA
  4997                                     CO-YTD-FICA
  4998                                     CO-CUR-OVR-UNDR
  4999                                     CO-YTD-OVR-UNDR
  5000                                     CO-MAX-BANK-FEE-LEASE
  5001                                     CO-MAX-BANK-FEE
  5002                                     CO-BAL-FWD
  5003                                     CO-CUR-COM
  5004                                     CO-CUR-CHG
  5005                                     CO-CUR-PMT
  5006                                     CO-END-BAL
  5007                                     CO-CUR
  5008                                     CO-OV30
  5009                                     CO-OV60
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  98
* EL652.cbl
  5010                                     CO-OV90
  5011                                     co-ov120
  5012                                     CO-YTD-COM
  5013                                     CO-YTD-OV
  5014                                     CO-YTD-PAID-COM
  5015                                     CO-YTD-PAID-OV
  5016                                     CO-CURRENT-BAL-FWD
  5017                                     CO-CURRENT-CUR-COM
  5018                                     CO-CURRENT-CUR-CHG
  5019                                     CO-CURRENT-CUR-PMT
  5020                                     CO-CURRENT-END-BAL
  5021                                     CO-CURRENT-CUR
  5022                                     CO-CURRENT-OV30
  5023                                     CO-CURRENT-OV60
  5024                                     CO-CURRENT-OV90
  5025                                     co-current-ov120
  5026                                     CO-CURRENT-YTD-COM
  5027                                     CO-CURRENT-YTD-OV
  5028                                     CO-ACT-YEAR
  5029                                     CO-ACT-MONTH
  5030                                     CO-ACT-DAY.
  5031     MOVE LOW-VALUES             TO  CO-LAST-ACTIVITY-DATE
  5032                                     CO-LAST-STMT-DT
  5033                                     CO-CURRENT-LAST-STMT-DT
  5034                                     CO-GA-EFFECTIVE-DT
  5035                                     CO-GA-TERMINATION-DT.
  5036     MOVE LOW-VALUES             TO  CO-FIRST-WRITTEN-DT.
  5037
  5038     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1
  5039                                     CO-INTERNAL-CONTROL-2.
  5040     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  5041
  5042     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  5043     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  5044     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5045     MOVE '5'                    TO  DC-OPTION-CODE.
  5046     MOVE LINK-ELDATCV           TO  PGM-NAME.
  5047
  5048
  5049* EXEC CICS LINK
  5050*        PROGRAM   (PGM-NAME)
  5051*        COMMAREA  (DATE-CONVERSION-DATA)
  5052*        LENGTH    (DC-COMM-LENGTH)
  5053*    END-EXEC.
  5054*    MOVE '."C                   (   #00004931' TO DFHEIV0
  5055     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5056     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5057     MOVE X'2020233030303034393331' TO DFHEIV0(25:11)
  5058     CALL 'kxdfhei1' USING DFHEIV0,
  5059           PGM-NAME,
  5060           DATE-CONVERSION-DATA,
  5061           DC-COMM-LENGTH,
  5062           DFHEIV99,
  5063           DFHEIV99,
  5064           DFHEIV99,
  5065           DFHEIV99
  5066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5067
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  99
* EL652.cbl
  5068
  5069     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
  5070                                     BIN-CURRENT-SAVE.
  5071     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5072     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5073     MOVE SPACE                  TO  DC-OPTION-CODE.
  5074
  5075
  5076* EXEC CICS LINK
  5077*        PROGRAM   (PGM-NAME)
  5078*        COMMAREA  (DATE-CONVERSION-DATA)
  5079*        LENGTH    (DC-COMM-LENGTH)
  5080*    END-EXEC.
  5081*    MOVE '."C                   (   #00004943' TO DFHEIV0
  5082     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5084     MOVE X'2020233030303034393433' TO DFHEIV0(25:11)
  5085     CALL 'kxdfhei1' USING DFHEIV0,
  5086           PGM-NAME,
  5087           DATE-CONVERSION-DATA,
  5088           DC-COMM-LENGTH,
  5089           DFHEIV99,
  5090           DFHEIV99,
  5091           DFHEIV99,
  5092           DFHEIV99
  5093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5094
  5095
  5096     MOVE PI-COMPANY-CD          TO  CO-COMPANY-CD.
  5097     MOVE 'CO'                   TO  CO-RECORD-ID.
  5098     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5099     MOVE COMP-FILE-ID           TO  FILE-ID.
  5100     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5101
  5102     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5103
  5104
  5105* EXEC CICS WRITE
  5106*        DATASET  (COMP-FILE-ID)
  5107*        FROM     (COMPENSATION-MASTER)
  5108*        RIDFLD   (CO-CONTROL-PRIMARY)
  5109*    END-EXEC.
  5110     MOVE LENGTH OF
  5111      COMPENSATION-MASTER
  5112       TO DFHEIV11
  5113*    MOVE '&$ L                  ''   #00004957' TO DFHEIV0
  5114     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5115     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5116     MOVE X'2020233030303034393537' TO DFHEIV0(25:11)
  5117     CALL 'kxdfhei1' USING DFHEIV0,
  5118           COMP-FILE-ID,
  5119           COMPENSATION-MASTER,
  5120           DFHEIV11,
  5121           CO-CONTROL-PRIMARY,
  5122           DFHEIV99,
  5123           DFHEIV99
  5124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5125
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 100
* EL652.cbl
  5126
  5127     PERFORM 8400-LOG-JOURNAL-RECORD.
  5128
  5129     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5130
  5131     IF PI-AR-PROCESSING
  5132         IF SUMMNOL > ZERO
  5133             MOVE SUMMNOI        TO PI-AR-SUMMARY-CODE
  5134             PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT
  5135             MOVE PI-AR-SUMMARY-CODE
  5136                                 TO  WS-SUMM-FOR-RQST
  5137             PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5138
  5139     MOVE ER-0000                TO  EMI-ERROR.
  5140     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5141
  5142     MOVE LOW-VALUES             TO  EL652AO.
  5143     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5144     MOVE PI-ERC-TYPE            TO  TYPEO.
  5145     MOVE AL-UANON               TO  CARRIERA
  5146                                     TYPEA.
  5147
  5148     IF PI-ERC-GROUP NOT = SPACES
  5149         MOVE PI-ERC-GROUP       TO  GROUPO
  5150         MOVE AL-UANON           TO  GROUPA.
  5151
  5152     IF PI-ERC-RESP NOT = SPACES
  5153         MOVE PI-ERC-RESP        TO  FINRESPO
  5154         MOVE AL-UANON           TO  FINRESPA.
  5155
  5156     IF PI-ERC-ACCT NOT = SPACES
  5157         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5158         MOVE AL-UANON           TO  ACCTNOA.
  5159
  5160     GO TO 5000-BUILD-INITIAL-SCREEN.
  5161
  5162 4200-EXIT.
  5163     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 101
* EL652.cbl
  5165 4300-ADD-COMPENSATION-NAME.
  5166
  5167* EXEC CICS HANDLE CONDITION
  5168*         DUPREC   (4300-EXIT)
  5169*    END-EXEC.
  5170*    MOVE '"$%                   ! ( #00005002' TO DFHEIV0
  5171     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5173     MOVE X'2820233030303035303032' TO DFHEIV0(25:11)
  5174     CALL 'kxdfhei1' USING DFHEIV0
  5175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5176
  5177
  5178
  5179* EXEC CICS GETMAIN
  5180*         LENGTH   (ERNAME-LENGTH)
  5181*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  5182*         INITIMG  (GETMAIN-SPACE)
  5183*    END-EXEC.
  5184*    MOVE ',"IL                  $   #00005006' TO DFHEIV0
  5185     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5186     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5187     MOVE X'2020233030303035303036' TO DFHEIV0(25:11)
  5188     CALL 'kxdfhei1' USING DFHEIV0,
  5189           DFHEIV20,
  5190           ERNAME-LENGTH,
  5191           GETMAIN-SPACE
  5192     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  5193         DFHEIV20
  5194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5195
  5196
  5197     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  5198     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  5199     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  5200     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  5201     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  5202     MOVE CO-ACCT-NAME           TO  NL-NAME.
  5203     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  5204        MOVE NL-NAME (5:26)      TO NL-NAME
  5205     END-IF
  5206     MOVE CO-ADDR-CITY           TO  NL-CITY.
  5207     MOVE CO-ADDR-STATE          TO  NL-ST
  5208     MOVE 'C'                    TO  NL-RECORD-TYPE.
  5209     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  5210     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  5211     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  5212     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  5213     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  5214     MOVE CO-TYPE                TO  NL-CO-TYPE.
  5215
  5216
  5217* EXEC CICS WRITE
  5218*        FROM      (NAME-LOOKUP-MASTER)
  5219*        RIDFLD    (NL-CONTROL-PRIMARY)
  5220*        DATASET   (NAME-FILE-ID)
  5221*    END-EXEC.
  5222     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 102
* EL652.cbl
  5223      NAME-LOOKUP-MASTER
  5224       TO DFHEIV11
  5225*    MOVE '&$ L                  ''   #00005031' TO DFHEIV0
  5226     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5227     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5228     MOVE X'2020233030303035303331' TO DFHEIV0(25:11)
  5229     CALL 'kxdfhei1' USING DFHEIV0,
  5230           NAME-FILE-ID,
  5231           NAME-LOOKUP-MASTER,
  5232           DFHEIV11,
  5233           NL-CONTROL-PRIMARY,
  5234           DFHEIV99,
  5235           DFHEIV99
  5236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5237
  5238
  5239 4300-EXIT.
  5240     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 103
* EL652.cbl
  5242 4400-CHANGE.
  5243     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5244         NEXT SENTENCE
  5245     ELSE
  5246**** MUST SHOW RECORD FIRST
  5247         MOVE ER-2056            TO  EMI-ERROR
  5248         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5249         MOVE -1                 TO  MAINTYPL
  5250         GO TO 8200-SEND-DATAONLY.
  5251
  5252     PERFORM 7000-EDIT  THRU  7000-EXIT.
  5253
  5254     IF EMI-NO-ERRORS
  5255         NEXT SENTENCE
  5256     ELSE
  5257         GO TO 8200-SEND-DATAONLY.
  5258
  5259     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5260
  5261     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5262     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5263
  5264     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  5265
  5266     IF (CO-LAST-MAINT-USER   = PI-UPDATE-BY)
  5267        OR (CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  5268        CONTINUE
  5269     ELSE
  5270
  5271* EXEC CICS UNLOCK
  5272*            DATASET  (COMP-FILE-ID)
  5273*       END-EXEC
  5274*    MOVE '&*                    #   #00005068' TO DFHEIV0
  5275     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5276     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5277     MOVE X'2020233030303035303638' TO DFHEIV0(25:11)
  5278     CALL 'kxdfhei1' USING DFHEIV0,
  5279           COMP-FILE-ID,
  5280           DFHEIV99
  5281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5282        MOVE ER-0068             TO EMI-ERROR
  5283        PERFORM 9900-ERROR-FORMAT
  5284                                 THRU 9900-EXIT
  5285        GO TO 8200-SEND-DATAONLY
  5286     END-IF
  5287
  5288     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  5289     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  5290     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5291     MOVE '5'                    TO  DC-OPTION-CODE.
  5292     MOVE LINK-ELDATCV           TO  PGM-NAME.
  5293
  5294
  5295* EXEC CICS LINK
  5296*        PROGRAM   (PGM-NAME)
  5297*        COMMAREA  (DATE-CONVERSION-DATA)
  5298*        LENGTH    (DC-COMM-LENGTH)
  5299*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 104
* EL652.cbl
  5300*    MOVE '."C                   (   #00005083' TO DFHEIV0
  5301     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5303     MOVE X'2020233030303035303833' TO DFHEIV0(25:11)
  5304     CALL 'kxdfhei1' USING DFHEIV0,
  5305           PGM-NAME,
  5306           DATE-CONVERSION-DATA,
  5307           DC-COMM-LENGTH,
  5308           DFHEIV99,
  5309           DFHEIV99,
  5310           DFHEIV99,
  5311           DFHEIV99
  5312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5313
  5314
  5315     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
  5316                                     BIN-CURRENT-SAVE.
  5317     MOVE SPACE                  TO  DC-OPTION-CODE.
  5318     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5319     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5320
  5321
  5322* EXEC CICS LINK
  5323*        PROGRAM   (PGM-NAME)
  5324*        COMMAREA  (DATE-CONVERSION-DATA)
  5325*        LENGTH    (DC-COMM-LENGTH)
  5326*    END-EXEC.
  5327*    MOVE '."C                   (   #00005095' TO DFHEIV0
  5328     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5329     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5330     MOVE X'2020233030303035303935' TO DFHEIV0(25:11)
  5331     CALL 'kxdfhei1' USING DFHEIV0,
  5332           PGM-NAME,
  5333           DATE-CONVERSION-DATA,
  5334           DC-COMM-LENGTH,
  5335           DFHEIV99,
  5336           DFHEIV99,
  5337           DFHEIV99,
  5338           DFHEIV99
  5339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5340
  5341
  5342     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1.
  5343     MOVE 'B'                    TO  JP-RECORD-TYPE.
  5344     MOVE COMP-FILE-ID           TO  FILE-ID.
  5345
  5346     PERFORM 8400-LOG-JOURNAL-RECORD.
  5347
  5348     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5349
  5350     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5351
  5352
  5353* EXEC CICS REWRITE
  5354*        DATASET  (COMP-FILE-ID)
  5355*        FROM     (COMPENSATION-MASTER)
  5356*    END-EXEC.
  5357     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 105
* EL652.cbl
  5358      COMPENSATION-MASTER
  5359       TO DFHEIV11
  5360*    MOVE '&& L                  %   #00005111' TO DFHEIV0
  5361     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5363     MOVE X'2020233030303035313131' TO DFHEIV0(25:11)
  5364     CALL 'kxdfhei1' USING DFHEIV0,
  5365           COMP-FILE-ID,
  5366           COMPENSATION-MASTER,
  5367           DFHEIV11,
  5368           DFHEIV99
  5369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5370
  5371
  5372     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5373
  5374     PERFORM 8400-LOG-JOURNAL-RECORD.
  5375
  5376     IF NOT PI-AR-PROCESSING
  5377         GO TO 4400-CONT.
  5378
  5379     IF SUMMNOL NOT > ZERO
  5380         GO TO 4400-CONT.
  5381
  5382     IF SUMMNOI  = WS-SAVE-SUMM
  5383         GO TO 4400-CONT
  5384     ELSE
  5385         PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT.
  5386
  5387     MOVE SUMMNOI                 TO WS-SUMM-FOR-RQST.
  5388     PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5389
  5390     IF SUMMNOI = SPACES
  5391         GO TO 4400-CONT.
  5392
  5393     MOVE SUMMNOI                 TO PI-AR-SUMMARY-CODE.
  5394     PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT.
  5395
  5396 4400-CONT.
  5397     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5398
  5399     MOVE ER-0000                TO  EMI-ERROR.
  5400     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5401
  5402     MOVE LOW-VALUES             TO  EL652AO.
  5403     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5404     MOVE PI-ERC-TYPE            TO  TYPEO.
  5405     MOVE AL-UANON               TO  CARRIERA
  5406                                     TYPEA.
  5407
  5408     IF PI-ERC-GROUP NOT = SPACES
  5409         MOVE PI-ERC-GROUP       TO  GROUPO
  5410         MOVE AL-UANON           TO  GROUPA.
  5411
  5412     IF PI-ERC-RESP NOT = SPACES
  5413         MOVE PI-ERC-RESP        TO  FINRESPO
  5414         MOVE AL-UANON           TO  FINRESPA.
  5415
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 106
* EL652.cbl
  5416     IF PI-ERC-ACCT NOT = SPACES
  5417         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5418         MOVE AL-UANON           TO  ACCTNOA.
  5419
  5420     GO TO 5000-BUILD-INITIAL-SCREEN.
  5421
  5422 4400-EXIT.
  5423     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 107
* EL652.cbl
  5425 4600-DELETE.
  5426     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5427         NEXT SENTENCE
  5428     ELSE
  5429         MOVE ER-2056            TO  EMI-ERROR
  5430         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5431         MOVE -1                 TO  MAINTYPL
  5432         GO TO 8200-SEND-DATAONLY.
  5433
  5434     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5435
  5436     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5437
  5438     IF (CO-YTD-COM NOT = ZERO) OR
  5439        (CO-END-BAL NOT = ZERO)
  5440
  5441* EXEC CICS UNLOCK
  5442*            DATASET  (COMP-FILE-ID)
  5443*        END-EXEC
  5444*    MOVE '&*                    #   #00005184' TO DFHEIV0
  5445     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5446     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5447     MOVE X'2020233030303035313834' TO DFHEIV0(25:11)
  5448     CALL 'kxdfhei1' USING DFHEIV0,
  5449           COMP-FILE-ID,
  5450           DFHEIV99
  5451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5452         MOVE ER-2092            TO  EMI-ERROR
  5453         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5454         MOVE -1                 TO  MAINTYPL
  5455         GO TO 8200-SEND-DATAONLY.
  5456
  5457     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5458     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5459     MOVE COMP-FILE-ID           TO  FILE-ID.
  5460
  5461     IF CO-LAST-MAINT-USER   = PI-UPDATE-BY OR
  5462        CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  5463         continue
  5464     ELSE
  5465
  5466* EXEC CICS UNLOCK
  5467*            DATASET  (COMP-FILE-ID)
  5468*        END-EXEC
  5469*    MOVE '&*                    #   #00005200' TO DFHEIV0
  5470     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5471     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5472     MOVE X'2020233030303035323030' TO DFHEIV0(25:11)
  5473     CALL 'kxdfhei1' USING DFHEIV0,
  5474           COMP-FILE-ID,
  5475           DFHEIV99
  5476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5477         MOVE ER-0068            TO  EMI-ERROR
  5478         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5479         GO TO 8200-SEND-DATAONLY
  5480     end-if
  5481     if pi-el652-del-sw = 'Y'
  5482        continue
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 108
* EL652.cbl
  5483     else
  5484        move 'Y'                 to pi-el652-del-sw
  5485        move er-1299             to emi-error
  5486        perform 9900-error-format thru 9900-exit
  5487        move spaces              to maintypo
  5488        MOVE -1                  TO MAINTypL
  5489        GO TO 8200-send-dataonly
  5490     end-if
  5491
  5492* EXEC CICS DELETE
  5493*        DATASET  (COMP-FILE-ID)
  5494*    END-EXEC
  5495*    MOVE '&(                    &   #00005217' TO DFHEIV0
  5496     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5497     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5498     MOVE X'2020233030303035323137' TO DFHEIV0(25:11)
  5499     CALL 'kxdfhei1' USING DFHEIV0,
  5500           COMP-FILE-ID,
  5501           DFHEIV99,
  5502           DFHEIV99,
  5503           DFHEIV99,
  5504           DFHEIV99
  5505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5506
  5507     PERFORM 8400-LOG-JOURNAL-RECORD
  5508     MOVE EIBDATE                TO  DC-JULIAN-YYDDD
  5509     MOVE '5'                    TO  DC-OPTION-CODE
  5510     MOVE LINK-ELDATCV           TO  PGM-NAME
  5511
  5512
  5513* EXEC CICS LINK
  5514*        PROGRAM   (PGM-NAME)
  5515*        COMMAREA  (DATE-CONVERSION-DATA)
  5516*        LENGTH    (DC-COMM-LENGTH)
  5517*    END-EXEC
  5518*    MOVE '."C                   (   #00005226' TO DFHEIV0
  5519     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5520     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5521     MOVE X'2020233030303035323236' TO DFHEIV0(25:11)
  5522     CALL 'kxdfhei1' USING DFHEIV0,
  5523           PGM-NAME,
  5524           DATE-CONVERSION-DATA,
  5525           DC-COMM-LENGTH,
  5526           DFHEIV99,
  5527           DFHEIV99,
  5528           DFHEIV99,
  5529           DFHEIV99
  5530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5531
  5532     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE
  5533
  5534     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT
  5535
  5536     MOVE ER-0000                TO  EMI-ERROR
  5537     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5538
  5539     IF PI-AR-PROCESSING
  5540         IF WS-SAVE-SUMM NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 109
* EL652.cbl
  5541             PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT
  5542             MOVE SPACES         TO  WS-SUMM-FOR-RQST
  5543             PERFORM  6500-UPDATE-RQST  THRU  6599-EXIT
  5544         end-if
  5545     end-if
  5546
  5547     MOVE LOW-VALUES             TO  EL652AO
  5548     MOVE PI-ERC-CARRIER         TO  CARRIERO
  5549     MOVE PI-ERC-TYPE            TO  TYPEO
  5550     MOVE AL-UANON               TO  CARRIERA
  5551                                     TYPEA
  5552
  5553     IF PI-ERC-GROUP NOT = SPACES
  5554         MOVE PI-ERC-GROUP       TO  GROUPO
  5555         MOVE AL-UANON           TO  GROUPA
  5556     end-if
  5557
  5558     IF PI-ERC-RESP NOT = SPACES
  5559         MOVE PI-ERC-RESP        TO  FINRESPO
  5560         MOVE AL-UANON           TO  FINRESPA
  5561     end-if
  5562
  5563     IF PI-ERC-ACCT NOT = SPACES
  5564         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5565         MOVE AL-UANON           TO  ACCTNOA
  5566     end-if
  5567
  5568     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY
  5569
  5570     GO TO 8100-SEND-INITIAL-MAP
  5571     .
  5572 4600-EXIT.
  5573     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 110
* EL652.cbl
  5575
  5576 4700-CHECK-STATE.
  5577     IF CLPSTI =  SPACES
  5578         GO TO 4799-EXIT
  5579     END-IF.
  5580
  5581     MOVE SPACES                 TO  ELCNTL-KEY2.
  5582     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID-2.
  5583     MOVE '3'                    TO  CNTL-REC-TYPE-2.
  5584     MOVE CLPSTI                 TO  CNTL-STATE-2.
  5585     MOVE +0                     TO  CNTL-SEQ-NO-2.
  5586
  5587
  5588* EXEC CICS  HANDLE CONDITION
  5589*        NOTFND  (4750-NO-STATE)
  5590*    END-EXEC.
  5591*    MOVE '"$I                   ! ) #00005287' TO DFHEIV0
  5592     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5593     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5594     MOVE X'2920233030303035323837' TO DFHEIV0(25:11)
  5595     CALL 'kxdfhei1' USING DFHEIV0
  5596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5597
  5598
  5599
  5600* EXEC CICS  READ
  5601*        DATASET  (CNTL-FILE-ID)
  5602*        SET      (ADDRESS OF CONTROL-FILE)
  5603*        RIDFLD   (ELCNTL-KEY2)
  5604*    END-EXEC.
  5605*    MOVE '&"S        E          (   #00005291' TO DFHEIV0
  5606     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5607     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5608     MOVE X'2020233030303035323931' TO DFHEIV0(25:11)
  5609     CALL 'kxdfhei1' USING DFHEIV0,
  5610           CNTL-FILE-ID,
  5611           DFHEIV20,
  5612           DFHEIV99,
  5613           ELCNTL-KEY2,
  5614           DFHEIV99,
  5615           DFHEIV99,
  5616           DFHEIV99
  5617     SET ADDRESS OF CONTROL-FILE TO
  5618         DFHEIV20
  5619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5620
  5621
  5622     GO TO 4799-EXIT.
  5623
  5624 4750-NO-STATE.
  5625     MOVE ER-0144                TO  EMI-ERROR.
  5626     MOVE -1                     TO  CLPSTL.
  5627     MOVE AL-UABON               TO  CLPSTA.
  5628
  5629     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5630
  5631 4799-EXIT.
  5632     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 111
* EL652.cbl
  5633
  5634 5000-BUILD-INITIAL-SCREEN.
  5635     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  5636
  5637     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  5638
  5639     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  5640     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  5641
  5642     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5643        MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS
  5644        ELSE
  5645        MOVE ZEROS                  TO  PI-UPDATE-HHMMSS.
  5646
  5647 5050-SET-UP-SCREEN.
  5648     MOVE CO-CONTROL-NAME        TO  PCONTO.
  5649     MOVE CO-MAIL-NAME           TO  MAILNAMO.
  5650     MOVE CO-ACCT-NAME           TO  ACCTNAMO.
  5651     MOVE CO-ACCT-NAME           TO  PI-SAVE-ACCT-NAME.
  5652     MOVE CO-ADDR-1              TO  ADDR1O.
  5653     MOVE CO-ADDR-2              TO  ADDR2O
  5654                                     PI-SAVE-ADDR2
  5655     MOVE CO-ADDR-CITY           TO  CITYO
  5656                                     PI-SAVE-CITY
  5657     MOVE CO-ADDR-STATE          TO  STATEO
  5658                                     PI-SAVE-STATE
  5659     MOVE SPACES                 TO  WS-ZIP-CODE.
  5660
  5661     IF CO-CANADIAN-POST-CODE
  5662         MOVE CO-CAN-POSTAL-1    TO  WS-ZIP-CAN-2-POST1
  5663         MOVE CO-CAN-POSTAL-2    TO  WS-ZIP-CAN-2-POST2
  5664     ELSE
  5665         MOVE CO-ZIP-PRIME       TO  WS-ZIP-AM-2-CODE
  5666         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  5667             MOVE '-'            TO  WS-ZIP-AM-2-DASH
  5668             MOVE CO-ZIP-PLUS4   TO  WS-ZIP-AM-2-PLUS4.
  5669
  5670     MOVE WS-ZIP-CODE            TO  ZIPCODEO.
  5671
  5672     IF CO-BILL-SW = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  5673        OR 'O' OR 'E' OR 'C'
  5674         MOVE AL-UANON           TO  BILLPRTA
  5675         MOVE CO-BILL-SW         TO  BILLPRTO
  5676     END-IF.
  5677
  5678     MOVE CO-CSO-1099            TO  PNT1099O.
  5679
  5680     MOVE CO-CSR-CODE            TO  CSRO.
  5681
  5682     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
  5683        AND (CO-TYPE = 'A')
  5684        IF CO-COMP-TYPE = '1'
  5685           MOVE 'Y'              TO SPPDDO
  5686        ELSE
  5687           MOVE 'N'              TO SPPDDO
  5688        END-IF
  5689     END-IF
  5690     MOVE CO-SOC-SEC             TO  SSNO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 112
* EL652.cbl
  5691
  5692     MOVE CO-BALANCE-CONTROL     TO  CARBALO.
  5693
  5694     IF PI-AR-PROCESSING
  5695         IF CO-AR-SUMMARY-CODE > SPACES
  5696             MOVE AL-UANON       TO  SUMMNOA
  5697             MOVE CO-AR-SUMMARY-CODE
  5698                                 TO  SUMMNOO
  5699         ELSE
  5700             MOVE LOW-VALUES     TO  SUMMNOO.
  5701
  5702     IF PI-AR-PROCESSING
  5703        IF NOT CO-ACCOUNT-TYPE
  5704           MOVE AL-SADOF         TO SCDESCA
  5705           MOVE AL-SANOF         TO SUMMNOA
  5706        ELSE
  5707           MOVE AL-UANOF         TO SUMMNOA.
  5708
  5709     IF PI-AR-PROCESSING
  5710*        MOVE CO-AR-BAL-LEVEL    TO  ARBALO
  5711         MOVE CO-AR-PULL-CHECK   TO  CKPULLO.
  5712
  5713     IF PI-AR-PROCESSING
  5714         IF CO-ACCOUNT-TYPE
  5715             MOVE CO-AR-REPORTING
  5716                                 TO  NETGRSO
  5717         ELSE
  5718             MOVE SPACES         TO  NETGRSO.
  5719
  5720     MOVE SPACES                 TO  FLITYPO.
  5721
  5722     IF CO-COMPANY-TYPE
  5723         MOVE SPACES             TO  RPTCD2O
  5724         MOVE AL-SADOF           TO  RPTCDDA.
  5725
  5726     MOVE SPACES                 TO  LETRCDO.
  5727     MOVE AL-SADOF               TO  LETDESCA.
  5728     MOVE SPACES                 TO  BALCDO.
  5729     MOVE AL-SADOF               TO  BALPRTA.
  5730     MOVE CO-CLP-STATE           TO  CLPSTO.
  5731     MOVE CO-MAX-BANK-FEE        TO  MAXFEEO
  5732     MOVE CO-SPP-REFUND-EDIT     TO  REFEO
  5733     IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  5734        MOVE +0                  TO CO-MAX-BANK-FEE-LEASE
  5735     END-IF
  5736     MOVE CO-MAX-BANK-FEE-LEASE  TO  MAXLFO
  5737     .
  5738 5060-BUILD-TOTALS.
  5739     IF SHOW-SAVE-TOTALS
  5740         NEXT SENTENCE
  5741     ELSE
  5742         GO TO 5070-BUILD-CURRENT-TOTALS.
  5743
  5744     IF CO-LAST-STMT-DT = SPACES
  5745         MOVE SPACES             TO  LSTMDTO
  5746         GO TO 5060-LST-STMT-OK.
  5747
  5748     MOVE CO-LAST-STMT-MONTH     TO  WS-YMD-MM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 113
* EL652.cbl
  5749     MOVE CO-LAST-STMT-DAY       TO  WS-YMD-DD.
  5750     MOVE CO-LAST-STMT-YEAR      TO  WS-YMD-YY.
  5751
  5752     IF WS-YMD-DATE-NUM NUMERIC
  5753         NEXT SENTENCE
  5754     ELSE
  5755         MOVE SPACES             TO  LSTMDTO
  5756         GO TO 5060-LST-STMT-OK.
  5757
  5758     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5759     MOVE '3'                    TO  DC-OPTION-CODE.
  5760
  5761     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5762
  5763     IF NO-CONVERSION-ERROR
  5764         NEXT SENTENCE
  5765     ELSE
  5766         MOVE SPACES             TO  LSTMDTO
  5767         GO TO 5060-LST-STMT-OK.
  5768
  5769     MOVE CO-LAST-STMT-MONTH     TO  WS-DMDY8-MM.
  5770     MOVE CO-LAST-STMT-DAY       TO  WS-DMDY8-DD.
  5771     MOVE CO-LAST-STMT-YEAR      TO  WS-DMDY8-YY.
  5772     MOVE '/'                    TO  WS-DMDY8-SL1
  5773                                     WS-DMDY8-SL2.
  5774     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5775
  5776 5060-LST-STMT-OK.
  5777     MOVE CO-BAL-FWD             TO  BALFWDO.
  5778     MOVE CO-CUR-COM             TO  CURCOMO.
  5779     MOVE CO-CUR-PMT             TO  CURPMTO.
  5780     MOVE CO-CUR-CHG             TO  CURCHGO.
  5781     MOVE CO-END-BAL             TO  ENDBALO.
  5782     MOVE CO-CUR                 TO  CURRENTO.
  5783     MOVE CO-OV30                TO  OVER30O.
  5784     MOVE CO-OV60                TO  OVER60O.
  5785     MOVE CO-OV90                TO  OVER90O.
  5786     if pi-company-id = 'AHL'
  5787        if co-ov120 not numeric
  5788           move zeros            to co-ov120
  5789        end-if
  5790        move co-ov120            to over120o
  5791     end-if
  5792     IF CO-ACCOUNT-TYPE
  5793        MOVE CO-YTD-COM          TO YTDCOMO
  5794     ELSE
  5795        MOVE CO-YTD-OV           TO YTDCOMO
  5796     END-IF
  5797
  5798     MOVE AL-SADOF               TO  PFK9A.
  5799     MOVE 'PREV. END-OF-MONTH TOTALS DISPLAYED'
  5800                                 TO  EMI-MESSAGE-AREA (1).
  5801
  5802     GO TO 5090-CONTD.
  5803
  5804 5070-BUILD-CURRENT-TOTALS.
  5805     IF CO-CURRENT-LAST-STMT-DT = SPACES
  5806         MOVE SPACES             TO  LSTMDTO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 114
* EL652.cbl
  5807         GO TO 5070-LST-STMT-OK.
  5808
  5809     MOVE CO-CURRENT-LAST-STMT-MONTH
  5810                                 TO WS-YMD-MM.
  5811     MOVE CO-CURRENT-LAST-STMT-DAY
  5812                                 TO  WS-YMD-DD.
  5813     MOVE CO-CURRENT-LAST-STMT-YEAR
  5814                                 TO  WS-YMD-YY.
  5815
  5816     IF WS-YMD-DATE-NUM NUMERIC
  5817         NEXT SENTENCE
  5818     ELSE
  5819         MOVE SPACES             TO  LSTMDTO
  5820         GO TO 5070-LST-STMT-OK.
  5821
  5822     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5823     MOVE '3'                    TO  DC-OPTION-CODE.
  5824
  5825     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5826
  5827     IF NO-CONVERSION-ERROR
  5828         NEXT SENTENCE
  5829     ELSE
  5830         MOVE SPACES             TO  LSTMDTO
  5831         GO TO 5070-LST-STMT-OK.
  5832
  5833     MOVE CO-CURRENT-LAST-STMT-MONTH
  5834                                 TO  WS-DMDY8-MM.
  5835     MOVE CO-CURRENT-LAST-STMT-DAY
  5836                                 TO  WS-DMDY8-DD.
  5837     MOVE CO-CURRENT-LAST-STMT-YEAR
  5838                                 TO  WS-DMDY8-YY.
  5839     MOVE '/'                    TO  WS-DMDY8-SL1
  5840                                     WS-DMDY8-SL2.
  5841     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5842
  5843 5070-LST-STMT-OK.
  5844     MOVE CO-CURRENT-BAL-FWD     TO  BALFWDO.
  5845     MOVE CO-CURRENT-CUR-COM     TO  CURCOMO.
  5846     MOVE CO-CURRENT-CUR-PMT     TO  CURPMTO.
  5847     MOVE CO-CURRENT-CUR-CHG     TO  CURCHGO.
  5848     MOVE CO-CURRENT-END-BAL     TO  ENDBALO
  5849                                     PI-ERC-END-BAL.
  5850     MOVE CO-CURRENT-CUR         TO  CURRENTO.
  5851     MOVE CO-CURRENT-OV30        TO  OVER30O.
  5852     MOVE CO-CURRENT-OV60        TO  OVER60O.
  5853     MOVE CO-CURRENT-OV90        TO  OVER90O.
  5854     if pi-company-id = 'AHL'
  5855        if co-current-ov120 not numeric
  5856           move zeros            to co-current-ov120
  5857        end-if
  5858        move co-current-ov120    to over120o
  5859     end-if
  5860     IF CO-ACCOUNT-TYPE
  5861        MOVE CO-CURRENT-YTD-COM  TO YTDCOMO
  5862     ELSE
  5863        MOVE CO-CURRENT-YTD-OV   TO YTDCOMO
  5864     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 115
* EL652.cbl
  5865     .
  5866 5090-CONTD.
  5867
  5868     MOVE CO-LAST-MAINT-USER     TO LSTUSRO.
  5869
  5870     MOVE ' '              TO DC-OPTION-CODE.
  5871     MOVE CO-LAST-MAINT-DT TO DC-BIN-DATE-1.
  5872
  5873     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5874
  5875     MOVE DC-GREG-DATE-1-EDIT    TO LSTDTEO.
  5876
  5877     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5878         MOVE CO-LAST-MAINT-HHMMSS
  5879                                 TO TIME-IN
  5880         MOVE TIME-OUT           TO LSTTIMEO
  5881     ELSE
  5882         MOVE ZEROS              TO TIME-IN
  5883         MOVE TIME-OUT           TO LSTTIMEO.
  5884
  5885     IF PI-COMPANY-ID =  'FLI'  OR  'FLU'  OR  'UCL'
  5886         MOVE AL-SANOF           TO  FLITYPEA
  5887         MOVE AL-UANON           TO  FLITYPA
  5888     ELSE
  5889         MOVE AL-SANON           TO  FLITYPA.
  5890
  5891     IF PI-COMPANY-ID = 'NCL'
  5892         IF CO-ACCOUNT-TYPE
  5893             MOVE AL-SANOF       TO  RPTCD2A
  5894         ELSE
  5895             IF CO-COMPANY-TYPE
  5896                MOVE AL-SANOF    TO  RPTCD2A
  5897                MOVE AL-SADOF    TO  RPTCDDA.
  5898
  5899     IF PI-COMPANY-ID = 'NCL'
  5900         IF CO-GEN-AGENT-TYPE
  5901            MOVE AL-UANON       TO  RPTCD2A.
  5902
  5903     IF PI-COMPANY-ID = 'NCL'
  5904         MOVE AL-UANON           TO  LETRCDA
  5905     ELSE
  5906         MOVE AL-SANOF           TO  LETRCDA
  5907         MOVE AL-SADOF           TO  LETDESCA.
  5908
  5909     IF PI-COMPANY-ID  NOT =  'DDB' AND 'ANT' AND 'ASL' AND
  5910                              'AN1' AND 'TFS'
  5911         MOVE AL-SANOF           TO  BALCDA
  5912         MOVE AL-SADOF           TO  BALPRTA.
  5913
  5914     IF PI-AR-PROCESSING
  5915         IF CO-ACCOUNT-TYPE
  5916             MOVE AL-SANOF       TO  SCDESCA
  5917             MOVE AL-SANOF       TO  NGDESCA
  5918             MOVE AL-UANON       TO  NETGRSA
  5919             IF PI-COMPANY-ID  =  'DDB' OR 'ANT' OR 'ASL' OR
  5920                                  'AN1' OR 'TFS'
  5921                 MOVE AL-SANOF   TO  BALPRTA
  5922                 MOVE AL-UANON   TO  BALCDA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 116
* EL652.cbl
  5923
  5924     IF PI-AR-PROCESSING
  5925*            MOVE AL-SANOF       TO  BALDESCA
  5926             move al-sanof       to  CKDESCA
  5927*            MOVE AL-UANON       TO  ARBALA
  5928             move al-uanon       to  CKPULLA.
  5929
  5930
  5931     MOVE AL-UANON               TO  MAILNAMA
  5932                                     ACCTNAMA
  5933                                     ADDR1A
  5934                                     ADDR2A
  5935                                     CITYA
  5936                                     STATEA
  5937                                     SSNA
  5938                                     ZIPCODEA
  5939                                     BILLPRTA
  5940                                     PNT1099A
  5941                                     CARBALA.
  5942
  5943     IF NOT SHOW-SAVE-TOTALS
  5944         IF PI-PROCESSOR-ID = 'LGXX'
  5945             GO TO 5100-CONTD.
  5946
  5947     MOVE AL-SANOF               TO  BALFWDA
  5948                                     CURCOMA
  5949                                     CURPMTA
  5950                                     CURCHGA
  5951                                     ENDBALA.
  5952
  5953 5100-CONTD.
  5954     IF CO-TELEPHONE NUMERIC
  5955         MOVE CO-TELEPHONE       TO  WS-PHONE-IN
  5956                                     PI-SAVE-PHONE
  5957         MOVE WSPI-AREA          TO  WSPO-AREA
  5958         MOVE WSPI-PFX           TO  WSPO-PFX
  5959         MOVE WSPI-SFX           TO  WSPO-SFX
  5960         MOVE WS-PHONE-OUT       TO  PHONEO
  5961         MOVE AL-UNNON           TO  PHONEA
  5962     ELSE
  5963         MOVE SPACES             TO  PHONEO.
  5964
  5965     IF CO-FAXNO NUMERIC
  5966         MOVE CO-FAXNO           TO  WS-PHONE-IN
  5967                                     PI-SAVE-FAXNO
  5968         MOVE WSPI-AREA          TO  WSPO-AREA
  5969         MOVE WSPI-PFX           TO  WSPO-PFX
  5970         MOVE WSPI-SFX           TO  WSPO-SFX
  5971         MOVE WS-PHONE-OUT       TO  FAXNOO
  5972         MOVE AL-UNNON           TO  FAXNOA
  5973     ELSE
  5974         MOVE SPACES             TO  FAXNOO.
  5975
  5976     MOVE 'S'                    TO  MAINTYPO
  5977                                     PI-CHECK-MAINT-TYPE.
  5978     MOVE AL-UANON               TO  MAINTYPA.
  5979     MOVE -1                     TO  MAINTYPL.
  5980
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 117
* EL652.cbl
  5981     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 118
* EL652.cbl
  5983 6000-CHECK-FOR-UPDATE.
  5984     IF CHANGE-FUNCTION
  5985         GO TO 6010-CONT.
  5986
  5987     IF CARRIERL > ZERO
  5988         MOVE CARRIERI           TO  CO-CARRIER.
  5989
  5990     IF GROUPL > ZERO
  5991         MOVE GROUPI             TO  CO-GROUPING
  5992     ELSE
  5993         MOVE LOW-VALUES         TO  CO-GROUPING.
  5994
  5995     IF FINRESPL > ZERO
  5996         MOVE FINRESPI           TO  CO-RESP-NO
  5997     ELSE
  5998         MOVE LOW-VALUES         TO  CO-RESP-NO.
  5999
  6000     IF ACCTNOL > ZERO
  6001         MOVE ACCTNOI            TO  CO-ACCOUNT
  6002     ELSE
  6003         MOVE LOW-VALUES         TO  CO-ACCOUNT.
  6004
  6005     IF TYPEL > ZERO
  6006         MOVE TYPEI              TO  CO-TYPE.
  6007
  6008 6010-CONT.
  6009     IF PI-PROCESSOR-ID = 'LGXX'
  6010         IF LSTMDTL > ZERO
  6011             MOVE WS-YMD-YY      TO  CO-CURRENT-LAST-STMT-YEAR
  6012                                     WS-DMDY8-YY
  6013             MOVE WS-YMD-MM      TO  CO-CURRENT-LAST-STMT-MONTH
  6014                                     WS-DMDY8-MM
  6015             MOVE WS-YMD-DD      TO  CO-CURRENT-LAST-STMT-DAY
  6016                                     WS-DMDY8-DD
  6017             MOVE '/'            TO  WS-DMDY8-SL1  WS-DMDY8-SL2
  6018             MOVE WS-DATE-MDY-8  TO  LSTMDTO.
  6019
  6020     IF PI-AR-PROCESSING
  6021         IF TYPEI = 'A'
  6022             IF SUMMNOL > ZERO
  6023                 MOVE SUMMNOI   TO  CO-AR-SUMMARY-CODE
  6024                                    WS-SAVE-SUMMARY.
  6025
  6026     IF PI-AR-PROCESSING
  6027         IF TYPEI = 'A'
  6028             IF NETGRSL > ZERO
  6029                 MOVE NETGRSI   TO  CO-AR-REPORTING
  6030             ELSE
  6031                 IF ADD-FUNCTION
  6032                     MOVE 'G'   TO  CO-AR-REPORTING.
  6033
  6034     IF PI-AR-PROCESSING
  6035*        IF ARBALL > ZERO
  6036*            MOVE ARBALI        TO  CO-AR-BAL-LEVEL
  6037*        ELSE
  6038             IF ADD-FUNCTION
  6039                 MOVE '1'       TO  CO-AR-BAL-LEVEL.
  6040
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 119
* EL652.cbl
  6041     IF PI-AR-PROCESSING
  6042         IF CKPULLL > ZERO
  6043             MOVE CKPULLI       TO  CO-AR-PULL-CHECK
  6044         ELSE
  6045             IF ADD-FUNCTION
  6046                 MOVE 'Y'       TO  CO-AR-PULL-CHECK.
  6047
  6048     IF MAILNAML > ZERO
  6049         MOVE MAILNAMI           TO  CO-MAIL-NAME
  6050                                     WS-SAVE-NAME.
  6051
  6052     IF ACCTNAML > ZERO
  6053         MOVE ACCTNAMI           TO  CO-ACCT-NAME.
  6054
  6055     IF ADDR1L > ZERO
  6056         MOVE ADDR1I             TO  CO-ADDR-1.
  6057
  6058     IF ADDR2L > ZERO
  6059         MOVE ADDR2I             TO  CO-ADDR-2.
  6060
  6061     IF CITYL > ZERO
  6062         MOVE CITYI              TO  CO-ADDR-CITY.
  6063     IF STATEL > ZERO
  6064         MOVE STATEI             TO  CO-ADDR-STATE.
  6065
  6066     IF ZIPCODEL NOT > ZERO
  6067         GO TO 6015-CONT.
  6068
  6069     MOVE ZIPCODEI               TO  WS-ZIP-CODE.
  6070
  6071     IF WS-CANADIAN-ZIP
  6072         IF WS-ZIP-4 = SPACE  OR  '-'
  6073             MOVE WS-ZIP-CAN-2-POST1     TO  CO-CAN-POSTAL-1
  6074             MOVE WS-ZIP-CAN-2-POST2     TO  CO-CAN-POSTAL-2
  6075         ELSE
  6076             MOVE WS-ZIP-CAN-1-POST1     TO  CO-CAN-POSTAL-1
  6077             MOVE WS-ZIP-CAN-1-POST2     TO  CO-CAN-POSTAL-2
  6078     ELSE
  6079         IF WS-ZIP-6 = SPACE  OR  '-'
  6080             MOVE WS-ZIP-AM-2-CODE       TO  CO-ZIP-PRIME
  6081             MOVE WS-ZIP-AM-2-PLUS4      TO  CO-ZIP-PLUS4
  6082         ELSE
  6083             MOVE WS-ZIP-AM-1-CODE       TO  CO-ZIP-PRIME
  6084             MOVE WS-ZIP-AM-1-PLUS4      TO  CO-ZIP-PLUS4.
  6085
  6086 6015-CONT.
  6087     IF BILLPRTL > ZERO
  6088         IF BILLPRTI = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  6089            OR 'O' OR 'E' OR 'C'
  6090             MOVE  BILLPRTI          TO  CO-BILL-SW
  6091         ELSE
  6092             MOVE SPACES         TO  CO-BILL-SW
  6093                                     BILLPRTO
  6094         END-IF
  6095     END-IF.
  6096     IF SPPDDL > ZERO
  6097        IF SPPDDI = 'Y'
  6098           MOVE '1'              TO CO-COMP-TYPE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 120
* EL652.cbl
  6099        ELSE
  6100           MOVE ' '              TO CO-COMP-TYPE
  6101        END-IF
  6102     END-IF
  6103     IF PNT1099L > ZERO
  6104         IF PNT1099I = 'N' OR 'Y'
  6105             MOVE  PNT1099I      TO  CO-CSO-1099
  6106         ELSE
  6107             MOVE 'N'            TO  CO-CSO-1099
  6108                                     PNT1099O
  6109         END-IF
  6110     END-IF.
  6111
  6112     IF CSRL > ZERO
  6113         MOVE CSRI               TO  CO-CSR-CODE.
  6114
  6115     IF SSNL > ZERO
  6116         MOVE SSNI               TO  CO-SOC-SEC.
  6117
  6118     IF PHONEL > ZERO
  6119         MOVE PI-SAVE-PHONE      TO  CO-TELEPHONE
  6120         MOVE ZEROS              TO  PI-SAVE-PHONE.
  6121
  6122     IF FAXNOL > ZERO
  6123         MOVE PI-SAVE-FAXNO      TO  CO-FAXNO
  6124         MOVE ZEROS              TO  PI-SAVE-FAXNO.
  6125
  6126     IF PCONTL > ZEROS
  6127        MOVE PCONTI              TO CO-CONTROL-NAME
  6128     END-IF
  6129     IF CLPSTL > ZERO
  6130         MOVE CLPSTI             TO  CO-CLP-STATE
  6131     END-IF
  6132     IF REFEL > ZERO
  6133        MOVE REFEI               TO CO-SPP-REFUND-EDIT
  6134     END-IF
  6135     IF MAXFEEL > ZERO
  6136         MOVE MAXFEEI            TO  CO-MAX-BANK-FEE
  6137*        IF ADD-FUNCTION
  6138*           MOVE CO-MAX-BANK-FEE TO  CO-BANK-FEE
  6139*        ELSE
  6140*           IF CHANGE-FUNCTION
  6141*              PERFORM 6100-EDIT-ERAGTC
  6142*                                THRU 6100-EXIT
  6143*              IF WS-TOT-FEES > CO-MAX-BANK-FEE
  6144*                 MOVE ER-2717   TO EMI-ERROR
  6145*                 MOVE -1        TO MAXFEEL
  6146*                 MOVE AL-UABON  TO MAXFEEA
  6147*                 PERFORM 9900-ERROR-FORMAT
  6148*                                THRU 9900-EXIT
  6149*              ELSE
  6150*                 COMPUTE CO-BANK-FEE = CO-MAX-BANK-FEE
  6151*                    - WS-TOT-FEES
  6152*              END-IF
  6153*           END-IF
  6154*        END-IF
  6155     END-IF
  6156
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 121
* EL652.cbl
  6157     IF MAXLFL > ZERO
  6158         MOVE MAXLFI             TO CO-MAX-BANK-FEE-LEASE
  6159     END-IF
  6160     IF CARBALL > ZERO
  6161         MOVE CARBALI            TO  CO-BALANCE-CONTROL
  6162         GO TO 6020-CONT.
  6163
  6164     IF NOT PI-AR-PROCESSING
  6165         GO TO 6020-CONT.
  6166
  6167     IF ADD-FUNCTION
  6168        AND (TYPEI = 'G' OR 'B')
  6169         MOVE 'Y'                TO  CO-BALANCE-CONTROL
  6170         GO TO 6020-CONT.
  6171
  6172     IF ADD-FUNCTION
  6173         IF TYPEI = 'A'
  6174             IF FINRESPI = ACCTNOI
  6175                 MOVE 'Y'        TO  CO-BALANCE-CONTROL
  6176             ELSE
  6177                 MOVE 'N'        TO  CO-BALANCE-CONTROL.
  6178
  6179     IF ADD-FUNCTION AND TYPEI = 'C'
  6180         MOVE 'N'                TO  CO-BALANCE-CONTROL.
  6181
  6182 6020-CONT.
  6183     IF BALFWDL > ZERO
  6184         MOVE WS-SAVE-BALFWD     TO  CO-CURRENT-BAL-FWD.
  6185
  6186     IF CURCOML > ZERO
  6187         MOVE WS-SAVE-CURCOM     TO  CO-CURRENT-CUR-COM.
  6188
  6189     IF CURCHGL > ZERO
  6190         MOVE WS-SAVE-CURCHG     TO  CO-CURRENT-CUR-CHG.
  6191
  6192     IF CURPMTL > ZERO
  6193         MOVE WS-SAVE-CURPMT     TO  CO-CURRENT-CUR-PMT.
  6194
  6195     IF ENDBALL > ZERO
  6196         MOVE WS-SAVE-ENDBAL     TO  CO-CURRENT-END-BAL.
  6197
  6198*    IF YTDCOML > ZERO
  6199*       IF CO-ACCOUNT-TYPE
  6200*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-COM
  6201*       ELSE
  6202*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-OV
  6203*       END-IF
  6204*    END-IF
  6205     .
  6206 6099-EXIT.
  6207     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 122
* EL652.cbl
  6209 6100-EDIT-ERAGTC.
  6210
  6211* EXEC CICS READ
  6212*         SET     (ADDRESS OF AGENT-COMMISSIONS)
  6213*         DATASET ('ERAGTC')
  6214*         RIDFLD  (PI-ERCOMP-KEY)
  6215*         RESP    (WS-RESPONSE)
  6216*    END-EXEC
  6217     MOVE 'ERAGTC' TO DFHEIV1
  6218*    MOVE '&"S        E          (  N#00005885' TO DFHEIV0
  6219     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6220     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6221     MOVE X'204E233030303035383835' TO DFHEIV0(25:11)
  6222     CALL 'kxdfhei1' USING DFHEIV0,
  6223           DFHEIV1,
  6224           DFHEIV20,
  6225           DFHEIV99,
  6226           PI-ERCOMP-KEY,
  6227           DFHEIV99,
  6228           DFHEIV99,
  6229           DFHEIV99
  6230     SET ADDRESS OF AGENT-COMMISSIONS TO
  6231         DFHEIV20
  6232     MOVE EIBRESP  TO WS-RESPONSE
  6233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6234     MOVE +0                     TO WS-TOT-FEES
  6235     IF RESP-NORMAL
  6236        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6237           (S1 > +10)
  6238           COMPUTE WS-TOT-FEES = WS-TOT-FEES
  6239              + AG-SPP-FEES (S1)
  6240        END-PERFORM
  6241     END-IF
  6242     .
  6243 6100-EXIT.
  6244     EXIT.
  6245 6500-UPDATE-RQST.
  6246
  6247     MOVE LOW-VALUES             TO  ERRQST-KEY-3.
  6248     MOVE PI-ERC-COMPANY-CD      TO  RQST-COMP-ID.
  6249     MOVE PI-ERC-CARRIER         TO  RQST-CARRIER.
  6250     MOVE PI-ERC-GROUP           TO  RQST-GROUP.
  6251     MOVE PI-ERC-RESP            TO  RQST-FIN-RESP.
  6252     MOVE PI-ERC-ACCT            TO  RQST-ACCT-AGENT.
  6253
  6254
  6255* EXEC CICS HANDLE CONDITION
  6256*        ENDFILE  (6550-END-BROWSE)
  6257*        NOTFND   (6550-END-BROWSE)
  6258*    END-EXEC.
  6259*    MOVE '"$''I                  ! * #00005911' TO DFHEIV0
  6260     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6262     MOVE X'2A20233030303035393131' TO DFHEIV0(25:11)
  6263     CALL 'kxdfhei1' USING DFHEIV0
  6264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6265
  6266
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 123
* EL652.cbl
  6267
  6268* EXEC CICS STARTBR
  6269*        DATASET  (RQST-FILE-ID-3)
  6270*        RIDFLD   (ERRQST-KEY-3)
  6271*    END-EXEC.
  6272     MOVE 0
  6273       TO DFHEIV11
  6274*    MOVE '&,         G          &   #00005916' TO DFHEIV0
  6275     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6276     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6277     MOVE X'2020233030303035393136' TO DFHEIV0(25:11)
  6278     CALL 'kxdfhei1' USING DFHEIV0,
  6279           RQST-FILE-ID-3,
  6280           ERRQST-KEY-3,
  6281           DFHEIV99,
  6282           DFHEIV11,
  6283           DFHEIV99
  6284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6285
  6286
  6287 6525-READ-LOOP.
  6288
  6289* EXEC CICS HANDLE CONDITION
  6290*        ENDFILE  (6550-END-BROWSE)
  6291*        NOTFND   (6550-END-BROWSE)
  6292*    END-EXEC.
  6293*    MOVE '"$''I                  ! + #00005922' TO DFHEIV0
  6294     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6296     MOVE X'2B20233030303035393232' TO DFHEIV0(25:11)
  6297     CALL 'kxdfhei1' USING DFHEIV0
  6298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6299
  6300
  6301
  6302* EXEC CICS READNEXT
  6303*        DATASET  (RQST-FILE-ID-3)
  6304*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6305*        RIDFLD   (ERRQST-KEY-3)
  6306*    END-EXEC.
  6307     MOVE 0
  6308       TO DFHEIV11
  6309*    MOVE '&.S                   )   #00005927' TO DFHEIV0
  6310     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6311     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6312     MOVE X'2020233030303035393237' TO DFHEIV0(25:11)
  6313     CALL 'kxdfhei1' USING DFHEIV0,
  6314           RQST-FILE-ID-3,
  6315           DFHEIV20,
  6316           DFHEIV99,
  6317           ERRQST-KEY-3,
  6318           DFHEIV99,
  6319           DFHEIV11,
  6320           DFHEIV99,
  6321           DFHEIV99
  6322     SET ADDRESS OF AR-REQUEST-RECORD TO
  6323         DFHEIV20
  6324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 124
* EL652.cbl
  6325
  6326
  6327     IF RQ-CONTROL-BY-FIN-RESP = WS-SAVE-RQST
  6328         GO TO 6525-READ-LOOP.
  6329
  6330     IF RQ-COMPANY-CD-A2 =  PI-ERC-COMPANY-CD AND
  6331        RQ-CARRIER-A2    =  PI-ERC-CARRIER    AND
  6332        RQ-GROUPING-A2   =  PI-ERC-GROUP      AND
  6333        RQ-FIN-RESP-A2   =  PI-ERC-RESP       AND
  6334        RQ-ACCT-AGENT-A2 =  PI-ERC-ACCT
  6335         NEXT SENTENCE
  6336     ELSE
  6337         GO TO 6550-END-BROWSE.
  6338
  6339     IF WS-SUMM-FOR-RQST = RQ-SUMMARY-CODE
  6340         GO TO 6525-READ-LOOP.
  6341
  6342     MOVE RQ-CONTROL-BY-FIN-RESP TO  WS-SAVE-RQST.
  6343     MOVE RQ-CONTROL-PRIMARY     TO  ERRQST-KEY.
  6344
  6345
  6346* EXEC CICS ENDBR
  6347*        DATASET  (RQST-FILE-ID-3)
  6348*    END-EXEC.
  6349     MOVE 0
  6350       TO DFHEIV11
  6351*    MOVE '&2                    $   #00005951' TO DFHEIV0
  6352     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6353     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6354     MOVE X'2020233030303035393531' TO DFHEIV0(25:11)
  6355     CALL 'kxdfhei1' USING DFHEIV0,
  6356           RQST-FILE-ID-3,
  6357           DFHEIV11,
  6358           DFHEIV99
  6359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6360
  6361
  6362
  6363* EXEC CICS HANDLE CONDITION
  6364*        ENDFILE  (6599-EXIT)
  6365*        NOTFND   (6599-EXIT)
  6366*    END-EXEC.
  6367*    MOVE '"$''I                  ! , #00005955' TO DFHEIV0
  6368     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6370     MOVE X'2C20233030303035393535' TO DFHEIV0(25:11)
  6371     CALL 'kxdfhei1' USING DFHEIV0
  6372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6373
  6374
  6375
  6376* EXEC CICS READ
  6377*        DATASET  (RQST-FILE-ID)
  6378*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6379*        RIDFLD   (ERRQST-KEY)
  6380*        UPDATE
  6381*    END-EXEC.
  6382*    MOVE '&"S        EU         (   #00005960' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 125
* EL652.cbl
  6383     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6384     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6385     MOVE X'2020233030303035393630' TO DFHEIV0(25:11)
  6386     CALL 'kxdfhei1' USING DFHEIV0,
  6387           RQST-FILE-ID,
  6388           DFHEIV20,
  6389           DFHEIV99,
  6390           ERRQST-KEY,
  6391           DFHEIV99,
  6392           DFHEIV99,
  6393           DFHEIV99
  6394     SET ADDRESS OF AR-REQUEST-RECORD TO
  6395         DFHEIV20
  6396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6397
  6398
  6399     MOVE WS-SUMM-FOR-RQST       TO  RQ-SUMMARY-CODE.
  6400
  6401
  6402* EXEC CICS REWRITE
  6403*        DATASET  (RQST-FILE-ID)
  6404*        FROM     (AR-REQUEST-RECORD)
  6405*    END-EXEC.
  6406     MOVE LENGTH OF
  6407      AR-REQUEST-RECORD
  6408       TO DFHEIV11
  6409*    MOVE '&& L                  %   #00005969' TO DFHEIV0
  6410     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6411     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6412     MOVE X'2020233030303035393639' TO DFHEIV0(25:11)
  6413     CALL 'kxdfhei1' USING DFHEIV0,
  6414           RQST-FILE-ID,
  6415           AR-REQUEST-RECORD,
  6416           DFHEIV11,
  6417           DFHEIV99
  6418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6419
  6420
  6421     GO TO 6500-UPDATE-RQST.
  6422
  6423 6550-END-BROWSE.
  6424
  6425
  6426* EXEC CICS ENDBR
  6427*        DATASET  (RQST-FILE-ID-3)
  6428*    END-EXEC.
  6429     MOVE 0
  6430       TO DFHEIV11
  6431*    MOVE '&2                    $   #00005978' TO DFHEIV0
  6432     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6433     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6434     MOVE X'2020233030303035393738' TO DFHEIV0(25:11)
  6435     CALL 'kxdfhei1' USING DFHEIV0,
  6436           RQST-FILE-ID-3,
  6437           DFHEIV11,
  6438           DFHEIV99
  6439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6440
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 126
* EL652.cbl
  6441
  6442 6599-EXIT.
  6443     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 127
* EL652.cbl
  6445
  6446 7000-EDIT.
  6447     MOVE LSTMDTI                TO  WS-DATE-MDY-8.
  6448
  6449     IF LSTMDTL > ZERO
  6450         NEXT SENTENCE
  6451     ELSE
  6452         GO TO 7100-EDIT-CONTD.
  6453
  6454     IF LSTMDTI = SPACES
  6455         GO TO 7100-EDIT-CONTD.
  6456
  6457     IF WS-DMDY8-SL1 = '/'  AND
  6458        WS-DMDY8-SL2 = '/'
  6459         MOVE WS-DMDY8-MM        TO  WS-YMD-MM
  6460         MOVE WS-DMDY8-DD        TO  WS-YMD-DD
  6461         MOVE WS-DMDY8-YY        TO  WS-YMD-YY
  6462     ELSE
  6463         MOVE WS-DMDY6-MM        TO  WS-YMD-MM
  6464         MOVE WS-DMDY6-DD        TO  WS-YMD-DD
  6465         MOVE WS-DMDY6-YY        TO  WS-YMD-YY.
  6466
  6467     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  6468     MOVE '3'                    TO  DC-OPTION-CODE.
  6469
  6470     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  6471
  6472     IF NO-CONVERSION-ERROR
  6473         NEXT SENTENCE
  6474     ELSE
  6475         GO TO 7090-DATE-ERROR.
  6476
  6477     IF DC-BIN-DATE-1 > PI-CR-MONTH-END-DT
  6478         NEXT SENTENCE
  6479     ELSE
  6480         GO TO 7100-EDIT-CONTD.
  6481
  6482 7090-DATE-ERROR.
  6483     MOVE -1                     TO  LSTMDTL.
  6484     MOVE AL-UABON               TO  LSTMDTA.
  6485     MOVE ER-0314                TO  EMI-ERROR.
  6486
  6487     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6488
  6489 7100-EDIT-CONTD.
  6490
  6491     IF CSRL > ZEROS
  6492         MOVE AL-UANON           TO  CSRA
  6493     END-IF
  6494
  6495     IF MAILNAML > ZERO
  6496         MOVE AL-UANON           TO  MAILNAMA.
  6497
  6498     IF SSNL > ZERO
  6499         MOVE AL-UANON           TO  SSNA.
  6500
  6501     IF ACCTNAML > ZERO
  6502         MOVE AL-UANON           TO  ACCTNAMA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 128
* EL652.cbl
  6503     ELSE
  6504         IF ADD-FUNCTION
  6505             MOVE -1             TO  ACCTNAML
  6506             MOVE AL-UABON       TO  ACCTNAMA
  6507             MOVE ER-2045        TO  EMI-ERROR
  6508             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6509
  6510     IF PHONEL > ZERO
  6511         MOVE PHONEI               TO  DEEDIT-FIELD
  6512         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6513         IF DEEDIT-FIELD-V0 = ZEROS
  6514             MOVE SPACES               TO  PHONEO
  6515                                           PI-SAVE-PHONE
  6516         ELSE
  6517             IF (DEEDIT-FIELD-V0 > 9999999999
  6518               OR < 2000000000)
  6519                 MOVE -1               TO  PHONEL
  6520                 MOVE AL-UNBON         TO  PHONEA
  6521                 MOVE ER-2046          TO  EMI-ERROR
  6522                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6523             ELSE
  6524                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6525                                           PI-SAVE-PHONE-RED
  6526                 MOVE WSPI-AREA        TO  WSPO-AREA
  6527                 MOVE WSPI-PFX         TO  WSPO-PFX
  6528                 MOVE WSPI-SFX         TO  WSPO-SFX
  6529                 MOVE WS-PHONE-OUT     TO  PHONEO
  6530                 MOVE AL-UNNON         TO  PHONEA.
  6531
  6532     IF FAXNOL > ZERO
  6533         MOVE FAXNOI               TO  DEEDIT-FIELD
  6534         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6535         IF DEEDIT-FIELD-V0 = ZEROS
  6536             MOVE SPACES               TO  FAXNOO
  6537                                           PI-SAVE-FAXNO
  6538         ELSE
  6539             IF (DEEDIT-FIELD-V0 > 9999999999
  6540               OR < 2000000000)
  6541                 MOVE -1               TO  FAXNOL
  6542                 MOVE AL-UNBON         TO  FAXNOA
  6543                 MOVE ER-3055          TO  EMI-ERROR
  6544                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6545             ELSE
  6546                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6547                                           PI-SAVE-FAXNO-RED
  6548                 MOVE WSPI-AREA        TO  WSPO-AREA
  6549                 MOVE WSPI-PFX         TO  WSPO-PFX
  6550                 MOVE WSPI-SFX         TO  WSPO-SFX
  6551                 MOVE WS-PHONE-OUT     TO  FAXNOO
  6552                 MOVE AL-UNNON         TO  FAXNOA.
  6553
  6554     IF ADDR1L > ZERO
  6555         MOVE AL-UANON           TO  ADDR1A
  6556     ELSE
  6557         IF ADD-FUNCTION
  6558             MOVE -1             TO  ADDR1L
  6559             MOVE AL-UABON       TO  ADDR1A
  6560             MOVE ER-2047        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 129
* EL652.cbl
  6561             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6562
  6563     IF ADDR2L > ZERO
  6564         MOVE AL-UANON           TO  ADDR2A.
  6565
  6566     IF CARBALL > ZERO OR CHANGE-FUNCTION
  6567         MOVE CARBALI            TO  PI-CHECK-CARRY-BAL
  6568         IF VALID-CARRY-BAL
  6569             PERFORM 7010-EDIT-CARBAL  THRU  7010-EXIT
  6570         ELSE
  6571             MOVE -1             TO  CARBALL
  6572             MOVE AL-UABON       TO  CARBALA
  6573             MOVE ER-2048        TO  EMI-ERROR
  6574             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6575     ELSE
  6576         IF ADD-FUNCTION AND NOT PI-AR-PROCESSING
  6577             MOVE -1             TO  CARBALL
  6578             MOVE AL-UABON       TO  CARBALA
  6579             MOVE ER-2048        TO  EMI-ERROR
  6580             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6581
  6582     IF PI-AR-PROCESSING
  6583         IF TYPEI = 'A'
  6584            IF NETGRSL > ZERO OR CHANGE-FUNCTION
  6585                 IF NETGRSI = 'N' OR 'G'
  6586                    MOVE AL-UANON    TO  NETGRSA
  6587                 ELSE
  6588                     MOVE -1         TO  NETGRSL
  6589                     MOVE AL-UABON   TO  NETGRSA
  6590                     MOVE ER-3151    TO  EMI-ERROR
  6591                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6592
  6593     IF CITYL > ZERO
  6594         MOVE AL-UANON           TO  CITYA
  6595     ELSE
  6596         IF ADD-FUNCTION
  6597             MOVE -1             TO  CITYL
  6598             MOVE AL-UABON       TO  CITYA
  6599             MOVE ER-2049        TO  EMI-ERROR
  6600             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6601
  6602     IF STATEL   > ZERO
  6603        MOVE AL-UANON            TO STATEA
  6604        MOVE SPACES              TO ELCNTL-KEY
  6605        MOVE PI-COMPANY-ID       TO CNTL-COMP-ID
  6606        MOVE '3'                 TO CNTL-REC-TYPE
  6607        MOVE STATEI              TO CNTL-ACCESS
  6608        MOVE +0                  TO CNTL-SEQ-NO
  6609
  6610* EXEC CICS READ
  6611*          DATASET   (CNTL-FILE-ID)
  6612*          SET       (ADDRESS OF CONTROL-FILE)
  6613*          RIDFLD    (ELCNTL-KEY)
  6614*          RESP      (WS-RESPONSE)
  6615*       END-EXEC
  6616*    MOVE '&"S        E          (  N#00006149' TO DFHEIV0
  6617     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6618     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 130
* EL652.cbl
  6619     MOVE X'204E233030303036313439' TO DFHEIV0(25:11)
  6620     CALL 'kxdfhei1' USING DFHEIV0,
  6621           CNTL-FILE-ID,
  6622           DFHEIV20,
  6623           DFHEIV99,
  6624           ELCNTL-KEY,
  6625           DFHEIV99,
  6626           DFHEIV99,
  6627           DFHEIV99
  6628     SET ADDRESS OF CONTROL-FILE TO
  6629         DFHEIV20
  6630     MOVE EIBRESP  TO WS-RESPONSE
  6631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6632        IF RESP-NORMAL
  6633           CONTINUE
  6634        ELSE
  6635           MOVE ER-2209          TO EMI-ERROR
  6636           MOVE -1               TO STATEL
  6637           MOVE AL-UABON         TO STATEA
  6638           PERFORM 9900-ERROR-FORMAT
  6639                                 THRU 9900-EXIT
  6640        END-IF
  6641     ELSE
  6642         IF ADD-FUNCTION
  6643             MOVE -1             TO  STATEL
  6644             MOVE AL-UABON       TO  STATEA
  6645             MOVE ER-2049        TO  EMI-ERROR
  6646             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6647
  6648*     IF PI-AR-PROCESSING
  6649*         IF ARBALL > ZERO OR CHANGE-FUNCTION
  6650*             IF ARBALI = '1' OR '2' OR '3' OR '4'
  6651*                 MOVE AL-UANON   TO  ARBALA
  6652*             ELSE
  6653*                 MOVE -1         TO  ARBALL
  6654*                 MOVE AL-UABON   TO  ARBALA
  6655*                 MOVE ER-3150    TO  EMI-ERROR
  6656*                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6657
  6658     IF PI-AR-PROCESSING
  6659         IF CKPULLL > ZERO OR CHANGE-FUNCTION
  6660             IF CKPULLI = 'Y' OR 'N'
  6661                 MOVE AL-UANON   TO  CKPULLA
  6662             ELSE
  6663                 MOVE -1         TO  CKPULLL
  6664                 MOVE AL-UABON   TO  CKPULLA
  6665                 MOVE ER-3170    TO  EMI-ERROR
  6666                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6667
  6668     IF ZIPCODEL > ZERO
  6669         MOVE AL-UANON           TO  ZIPCODEA.
  6670
  6671     IF PI-COMPANY-ID = 'CID' OR 'AHL'
  6672        CONTINUE
  6673     ELSE
  6674        IF PI-ERC-TYPE = 'B'
  6675           IF CLPSTL > ZERO
  6676              PERFORM 4700-CHECK-STATE       THRU 4799-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 131
* EL652.cbl
  6677              IF CLPSTI = SPACES
  6678                 MOVE -1         TO  CLPSTL
  6679                 MOVE AL-UABON   TO  CLPSTA
  6680                 MOVE ER-0144    TO  EMI-ERROR
  6681                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6682              ELSE
  6683                 MOVE AL-UANON   TO  CLPSTA
  6684              END-IF
  6685           ELSE
  6686              IF ADD-FUNCTION
  6687                 MOVE -1         TO  CLPSTL
  6688                 MOVE AL-UABON   TO  CLPSTA
  6689                 MOVE ER-0144    TO  EMI-ERROR
  6690                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6691              END-IF
  6692           END-IF
  6693
  6694           IF MAXFEEL  > ZERO
  6695
  6696* EXEC CICS BIF
  6697*                  DEEDIT
  6698*                  FIELD   (MAXFEEI)
  6699*                  LENGTH  (6)
  6700*             END-EXEC
  6701     MOVE 6
  6702       TO DFHEIV11
  6703*    MOVE '@"L                   #   #00006218' TO DFHEIV0
  6704     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6705     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6706     MOVE X'2020233030303036323138' TO DFHEIV0(25:11)
  6707     CALL 'kxdfhei1' USING DFHEIV0,
  6708           MAXFEEI,
  6709           DFHEIV11
  6710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6711              IF MAXFEEI NUMERIC
  6712                 MOVE AL-UNNON   TO  MAXFEEA
  6713              ELSE
  6714                 MOVE -1         TO  MAXFEEL
  6715                 MOVE AL-UABON   TO  MAXFEEA
  6716                 MOVE ER-3261    TO  EMI-ERROR
  6717                 PERFORM 9900-ERROR-FORMAT
  6718                                 THRU  9900-EXIT
  6719              END-IF
  6720           ELSE
  6721              IF ADD-FUNCTION
  6722                 MOVE -1         TO  MAXFEEL
  6723                 MOVE AL-UABON   TO  MAXFEEA
  6724                 MOVE ER-3261    TO  EMI-ERROR
  6725                 PERFORM 9900-ERROR-FORMAT
  6726                                 THRU  9900-EXIT
  6727              END-IF
  6728           END-IF
  6729           IF MAXLFL  > ZERO
  6730
  6731* EXEC CICS BIF
  6732*                  DEEDIT
  6733*                  FIELD   (MAXLFI)
  6734*                  LENGTH  (6)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 132
* EL652.cbl
  6735*             END-EXEC
  6736     MOVE 6
  6737       TO DFHEIV11
  6738*    MOVE '@"L                   #   #00006242' TO DFHEIV0
  6739     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6740     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6741     MOVE X'2020233030303036323432' TO DFHEIV0(25:11)
  6742     CALL 'kxdfhei1' USING DFHEIV0,
  6743           MAXLFI,
  6744           DFHEIV11
  6745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6746              IF MAXLFI NUMERIC
  6747                 MOVE AL-UNNON   TO  MAXLFA
  6748              ELSE
  6749                 MOVE -1         TO  MAXLFL
  6750                 MOVE AL-UABON   TO  MAXLFA
  6751                 MOVE ER-3261    TO  EMI-ERROR
  6752                 PERFORM 9900-ERROR-FORMAT
  6753                                 THRU  9900-EXIT
  6754              END-IF
  6755           ELSE
  6756              IF ADD-FUNCTION
  6757                 MOVE -1         TO  MAXLFL
  6758                 MOVE AL-UABON   TO  MAXLFA
  6759                 MOVE ER-3261    TO  EMI-ERROR
  6760                 PERFORM 9900-ERROR-FORMAT
  6761                                 THRU  9900-EXIT
  6762              END-IF
  6763           END-IF
  6764           IF REFEL > ZERO
  6765              IF REFEI = ' ' OR 'R' OR 'N' OR 'B'
  6766                 MOVE AL-UANON   TO REFEA
  6767              ELSE
  6768                 MOVE -1         TO REFEL
  6769                 MOVE AL-UABON   TO REFEA
  6770                 MOVE ER-2790    TO EMI-ERROR
  6771                 PERFORM 9900-ERROR-FORMAT
  6772                                 THRU  9900-EXIT
  6773              END-IF
  6774           END-IF
  6775        END-IF
  6776     END-IF
  6777
  6778     IF BALFWDL > ZERO
  6779
  6780* EXEC CICS BIF
  6781*            DEEDIT
  6782*            FIELD   (BALFWDI)
  6783*            LENGTH  (13)
  6784*        END-EXEC
  6785     MOVE 13
  6786       TO DFHEIV11
  6787*    MOVE '@"L                   #   #00006280' TO DFHEIV0
  6788     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6789     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6790     MOVE X'2020233030303036323830' TO DFHEIV0(25:11)
  6791     CALL 'kxdfhei1' USING DFHEIV0,
  6792           BALFWDI,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 133
* EL652.cbl
  6793           DFHEIV11
  6794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6795         MOVE AL-UNNON           TO  BALFWDA
  6796         MOVE BALFWDI            TO  WS-SAVE-BALFWD.
  6797
  6798     IF CURCOML >        ZERO
  6799
  6800* EXEC CICS BIF
  6801*            DEEDIT
  6802*            FIELD   (CURCOMI)
  6803*            LENGTH  (13)
  6804*        END-EXEC
  6805     MOVE 13
  6806       TO DFHEIV11
  6807*    MOVE '@"L                   #   #00006289' TO DFHEIV0
  6808     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6809     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6810     MOVE X'2020233030303036323839' TO DFHEIV0(25:11)
  6811     CALL 'kxdfhei1' USING DFHEIV0,
  6812           CURCOMI,
  6813           DFHEIV11
  6814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6815         MOVE AL-UNNON           TO  CURCOMA
  6816         MOVE CURCOMI            TO  WS-SAVE-CURCOM.
  6817
  6818     IF CURCHGL > ZERO
  6819
  6820* EXEC CICS BIF
  6821*            DEEDIT
  6822*            FIELD   (CURCHGI)
  6823*            LENGTH  (13)
  6824*        END-EXEC
  6825     MOVE 13
  6826       TO DFHEIV11
  6827*    MOVE '@"L                   #   #00006298' TO DFHEIV0
  6828     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6829     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6830     MOVE X'2020233030303036323938' TO DFHEIV0(25:11)
  6831     CALL 'kxdfhei1' USING DFHEIV0,
  6832           CURCHGI,
  6833           DFHEIV11
  6834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6835         MOVE AL-UNNON           TO  CURCHGA
  6836         MOVE CURCHGI            TO  WS-SAVE-CURCHG.
  6837
  6838     IF CURPMTL > ZERO
  6839
  6840* EXEC CICS BIF
  6841*            DEEDIT
  6842*            FIELD   (CURPMTI)
  6843*            LENGTH  (13)
  6844*        END-EXEC
  6845     MOVE 13
  6846       TO DFHEIV11
  6847*    MOVE '@"L                   #   #00006307' TO DFHEIV0
  6848     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6849     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6850     MOVE X'2020233030303036333037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 134
* EL652.cbl
  6851     CALL 'kxdfhei1' USING DFHEIV0,
  6852           CURPMTI,
  6853           DFHEIV11
  6854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6855         MOVE AL-UNNON           TO  CURPMTA
  6856         MOVE CURPMTI            TO  WS-SAVE-CURPMT.
  6857
  6858     IF ENDBALL > ZERO
  6859
  6860* EXEC CICS BIF
  6861*            DEEDIT
  6862*            FIELD   (ENDBALI)
  6863*            LENGTH  (13)
  6864*        END-EXEC
  6865     MOVE 13
  6866       TO DFHEIV11
  6867*    MOVE '@"L                   #   #00006316' TO DFHEIV0
  6868     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6869     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6870     MOVE X'2020233030303036333136' TO DFHEIV0(25:11)
  6871     CALL 'kxdfhei1' USING DFHEIV0,
  6872           ENDBALI,
  6873           DFHEIV11
  6874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6875         MOVE AL-UNNON           TO  ENDBALA
  6876         MOVE ENDBALI            TO  WS-SAVE-ENDBAL.
  6877
  6878*    IF YTDCOML > ZERO
  6879*       EXEC CICS BIF
  6880*            DEEDIT
  6881*            FIELD   (YTDCOMI)
  6882*            LENGTH  (13)
  6883*       END-EXEC
  6884*       MOVE AL-UNNON            TO YTDCOMA
  6885*       MOVE YTDCOMI             TO WS-SAVE-YTDCOM
  6886*    END-IF
  6887     .
  6888 7000-EXIT.
  6889     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 135
* EL652.cbl
  6891 7010-EDIT-CARBAL.
  6892     IF TYPEI = 'G' OR 'B'
  6893         IF CARBALI NOT = 'Y'
  6894             MOVE -1             TO  CARBALL
  6895             MOVE AL-UABON       TO  CARBALA
  6896             MOVE ER-2093        TO  EMI-ERROR
  6897             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6898             GO TO 7010-EXIT.
  6899
  6900     IF TYPEI = 'A'
  6901         IF FINRESPI = ACCTNOI
  6902             IF CARBALI NOT = 'Y'
  6903                 MOVE -1         TO  CARBALL
  6904                 MOVE AL-UABON   TO  CARBALA
  6905                 MOVE ER-2094    TO  EMI-ERROR
  6906                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6907                 GO TO 7010-EXIT.
  6908
  6909     IF PI-PROCESSOR-ID = 'E864'
  6910         NEXT SENTENCE
  6911     ELSE
  6912        IF TYPEI = 'A'
  6913           IF PI-AR-PROCESSING
  6914               IF FINRESPI NOT = ACCTNOI
  6915                    IF CARBALI = 'Y'
  6916                       MOVE -1             TO  CARBALL
  6917                       MOVE AL-UABON       TO  CARBALA
  6918                       MOVE ER-3174        TO  EMI-ERROR
  6919                       PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6920
  6921     IF TYPEI = 'C'
  6922         IF CARBALI NOT = 'N'
  6923             MOVE -1             TO  CARBALL
  6924             MOVE AL-UABON       TO  CARBALA
  6925             MOVE ER-2096        TO  EMI-ERROR
  6926             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6927             GO TO 7010-EXIT.
  6928
  6929     IF PI-PROCESSOR-ID = 'E864'
  6930         NEXT SENTENCE
  6931     ELSE
  6932        IF CHANGE-FUNCTION
  6933            IF PI-ERC-END-BAL NOT = ZERO
  6934                IF CARBALI = 'N'
  6935                    MOVE -1         TO  CARBALL
  6936                    MOVE AL-UABON   TO  CARBALA
  6937                    MOVE ER-2095    TO  EMI-ERROR
  6938                    PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6939                    GO TO 7010-EXIT.
  6940
  6941     MOVE AL-UANON               TO  CARBALA.
  6942
  6943 7010-EXIT.
  6944     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 136
* EL652.cbl
  6946 7050-READ-ERCOMP.
  6947     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  6948
  6949
  6950* EXEC CICS READ
  6951*        DATASET  (COMP-FILE-ID)
  6952*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6953*        RIDFLD   (PI-ERCOMP-KEY)
  6954*    END-EXEC.
  6955*    MOVE '&"S        E          (   #00006395' TO DFHEIV0
  6956     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6958     MOVE X'2020233030303036333935' TO DFHEIV0(25:11)
  6959     CALL 'kxdfhei1' USING DFHEIV0,
  6960           COMP-FILE-ID,
  6961           DFHEIV20,
  6962           DFHEIV99,
  6963           PI-ERCOMP-KEY,
  6964           DFHEIV99,
  6965           DFHEIV99,
  6966           DFHEIV99
  6967     SET ADDRESS OF COMPENSATION-MASTER TO
  6968         DFHEIV20
  6969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6970
  6971
  6972     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  6973
  6974 7050-EXIT.
  6975     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 137
* EL652.cbl
  6977 7100-DEEDIT.
  6978
  6979* EXEC CICS BIF
  6980*        DEEDIT
  6981*        FIELD   (DEEDIT-FIELD)
  6982*        LENGTH  (15)
  6983*    END-EXEC.
  6984     MOVE 15
  6985       TO DFHEIV11
  6986*    MOVE '@"L                   #   #00006407' TO DFHEIV0
  6987     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6988     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6989     MOVE X'2020233030303036343037' TO DFHEIV0(25:11)
  6990     CALL 'kxdfhei1' USING DFHEIV0,
  6991           DEEDIT-FIELD,
  6992           DFHEIV11
  6993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6994
  6995
  6996 7100-EXIT.
  6997     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 138
* EL652.cbl
  6999 7150-ERCOMP-GETMAIN.
  7000
  7001* EXEC CICS GETMAIN
  7002*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7003*        LENGTH   (ERCOMP-LENGTH)
  7004*        INITIMG  (GETMAIN-SPACE)
  7005*    END-EXEC.
  7006*    MOVE ',"IL                  $   #00006417' TO DFHEIV0
  7007     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7008     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7009     MOVE X'2020233030303036343137' TO DFHEIV0(25:11)
  7010     CALL 'kxdfhei1' USING DFHEIV0,
  7011           DFHEIV20,
  7012           ERCOMP-LENGTH,
  7013           GETMAIN-SPACE
  7014     SET ADDRESS OF COMPENSATION-MASTER TO
  7015         DFHEIV20
  7016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7017
  7018
  7019 7150-EXIT.
  7020     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 139
* EL652.cbl
  7022 7200-READ-ERCOMP-UPDATE.
  7023     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7024
  7025
  7026* EXEC CICS READ
  7027*        DATASET  (COMP-FILE-ID)
  7028*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7029*        RIDFLD   (PI-ERCOMP-KEY)
  7030*        UPDATE
  7031*    END-EXEC.
  7032*    MOVE '&"S        EU         (   #00006429' TO DFHEIV0
  7033     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7034     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7035     MOVE X'2020233030303036343239' TO DFHEIV0(25:11)
  7036     CALL 'kxdfhei1' USING DFHEIV0,
  7037           COMP-FILE-ID,
  7038           DFHEIV20,
  7039           DFHEIV99,
  7040           PI-ERCOMP-KEY,
  7041           DFHEIV99,
  7042           DFHEIV99,
  7043           DFHEIV99
  7044     SET ADDRESS OF COMPENSATION-MASTER TO
  7045         DFHEIV20
  7046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7047
  7048
  7049 7200-EXIT.
  7050     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 140
* EL652.cbl
  7052 7250-PAGE-FORWARD.
  7053     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  7054
  7055     IF MAINTYPL > ZERO
  7056         MOVE GROUPI             TO  PI-ERC-GROUP
  7057         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7058         MOVE FINRESPI           TO  PI-ERC-RESP
  7059         MOVE ACCTNOI            TO  PI-ERC-ACCT
  7060         MOVE TYPEI              TO  PI-ERC-TYPE
  7061     ELSE
  7062         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY
  7063         MOVE 'Y'                TO  PI-FIRST-TIME-SW.
  7064
  7065     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7066     MOVE PI-ERCOMP-KEY          TO  WS-SAVE-KEY.
  7067
  7068
  7069* EXEC CICS HANDLE CONDITION
  7070*        ENDFILE  (7250-ENDFILE)
  7071*        NOTFND   (7250-ENDFILE)
  7072*        ERROR    (9990-ABEND)
  7073*    END-EXEC.
  7074*    MOVE '"$''I.                 ! - #00006455' TO DFHEIV0
  7075     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7076     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7077     MOVE X'2D20233030303036343535' TO DFHEIV0(25:11)
  7078     CALL 'kxdfhei1' USING DFHEIV0
  7079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7080
  7081
  7082     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7083
  7084 7250-READ-NEXT.
  7085
  7086* EXEC CICS HANDLE CONDITION
  7087*        ENDFILE  (7250-ENDFILE)
  7088*        NOTFND   (7275-NOTFOUND)
  7089*    END-EXEC.
  7090*    MOVE '"$''I                  ! . #00006464' TO DFHEIV0
  7091     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7093     MOVE X'2E20233030303036343634' TO DFHEIV0(25:11)
  7094     CALL 'kxdfhei1' USING DFHEIV0
  7095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7096
  7097
  7098     PERFORM 7900-READNEXT  THRU  7900-EXIT.
  7099
  7100     IF PI-CARRIER-SECURITY > SPACES
  7101         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7102             NEXT SENTENCE
  7103         ELSE
  7104             GO TO 7250-READ-NEXT.
  7105
  7106     IF ERCOMP-EOF
  7107         IF FIRST-TIME
  7108             MOVE LOW-VALUES     TO  EL652AO
  7109             MOVE ER-0584        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 141
* EL652.cbl
  7110             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7111             GO TO 8100-SEND-INITIAL-MAP
  7112         ELSE
  7113             MOVE LOW-VALUES     TO  EL652AO
  7114             MOVE ER-2067        TO  EMI-ERROR
  7115             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7116             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  7117             GO TO 7250-PAGE-FORWARD.
  7118
  7119     IF PI-ERCOMP-KEY = WS-SAVE-KEY
  7120         GO TO 7250-READ-NEXT.
  7121
  7122     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  7123     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7124     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7125     MOVE LOW-VALUES             TO  EL652AO.
  7126     MOVE CO-CARRIER             TO  CARRIERO.
  7127     MOVE CO-GROUPING            TO  GROUPO.
  7128     MOVE CO-RESP-NO             TO  FINRESPO.
  7129     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7130     MOVE CO-TYPE                TO  TYPEO.
  7131     MOVE AL-UANON               TO  CARRIERA
  7132                                     GROUPA
  7133                                     TYPEA
  7134                                     FINRESPA
  7135                                     ACCTNOA
  7136                                     MAINTYPA.
  7137     MOVE 'S'                    TO  MAINTYPO
  7138                                     PI-CHECK-MAINT-TYPE.
  7139
  7140     GO TO 5050-SET-UP-SCREEN.
  7141
  7142 7250-ENDFILE.
  7143     IF FIRST-TIME
  7144         MOVE LOW-VALUES         TO  EL652AO
  7145         MOVE ER-0584            TO  EMI-ERROR
  7146         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7147         GO TO 8100-SEND-INITIAL-MAP.
  7148
  7149     IF BROWSE-STARTED
  7150         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7151
  7152     MOVE ER-2067                TO  EMI-ERROR.
  7153     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7154
  7155     MOVE LOW-VALUES             TO  EL652AO.
  7156
  7157     GO TO 7250-PAGE-FORWARD.
  7158
  7159 7275-NOTFOUND.
  7160     IF BROWSE-STARTED
  7161         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7162
  7163     GO TO 8880-NOT-FOUND.
  7164
  7165 7299-EXIT.
  7166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 142
* EL652.cbl
  7168 7300-PAGE-BACKWARD.
  7169     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  7170
  7171     IF MAINTYPL > ZERO
  7172         MOVE GROUPI             TO  PI-ERC-GROUP
  7173         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7174         MOVE FINRESPI           TO  PI-ERC-RESP
  7175         MOVE ACCTNOI            TO  PI-ERC-ACCT
  7176         MOVE TYPEI              TO  PI-ERC-TYPE
  7177     ELSE
  7178         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY.
  7179
  7180     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7181
  7182
  7183* EXEC CICS HANDLE CONDITION
  7184*        ENDFILE  (7375-ENDFILE)
  7185*        NOTFND   (7375-ENDFILE)
  7186*        ERROR    (9990-ABEND)
  7187*    END-EXEC.
  7188*    MOVE '"$''I.                 ! / #00006553' TO DFHEIV0
  7189     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7191     MOVE X'2F20233030303036353533' TO DFHEIV0(25:11)
  7192     CALL 'kxdfhei1' USING DFHEIV0
  7193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7194
  7195
  7196     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7197
  7198     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7199
  7200 7350-READ-PREV.
  7201
  7202* EXEC CICS HANDLE CONDITION
  7203*        ENDFILE  (7375-ENDFILE)
  7204*        NOTFND   (7275-NOTFOUND)
  7205*    END-EXEC.
  7206*    MOVE '"$''I                  ! 0 #00006564' TO DFHEIV0
  7207     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7209     MOVE X'3020233030303036353634' TO DFHEIV0(25:11)
  7210     CALL 'kxdfhei1' USING DFHEIV0
  7211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7212
  7213
  7214     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7215
  7216     IF PI-CARRIER-SECURITY > SPACES
  7217         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7218             NEXT SENTENCE
  7219         ELSE
  7220             GO TO 7350-READ-PREV.
  7221
  7222     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7223         GO TO 7375-ENDFILE.
  7224
  7225     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 143
* EL652.cbl
  7226     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7227     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7228     MOVE LOW-VALUES             TO  EL652AO.
  7229     MOVE CO-CARRIER             TO  CARRIERO.
  7230     MOVE CO-GROUPING            TO  GROUPO.
  7231     MOVE CO-RESP-NO             TO  FINRESPO.
  7232     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7233     MOVE CO-TYPE                TO  TYPEO.
  7234     MOVE AL-UANON               TO  CARRIERA
  7235                                     GROUPA
  7236                                     TYPEA
  7237                                     FINRESPA
  7238                                     ACCTNOA
  7239                                     MAINTYPA.
  7240     MOVE 'S'                    TO  MAINTYPO
  7241                                     PI-CHECK-MAINT-TYPE.
  7242
  7243     GO TO 5050-SET-UP-SCREEN.
  7244
  7245 7375-ENDFILE.
  7246     IF BROWSE-STARTED
  7247         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7248
  7249     MOVE ER-2238                TO  EMI-ERROR.
  7250     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7251
  7252     MOVE -1                     TO  MAINTYPL.
  7253
  7254     GO TO 8200-SEND-DATAONLY.
  7255
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 144
* EL652.cbl
  7257 7400-READ-CONTROL-FILE.
  7258     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7259     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  7260
  7261
  7262* EXEC CICS HANDLE CONDITION
  7263*        NOTFND  (7490-NOT-FOUND)
  7264*        ERROR   (9990-ABEND)
  7265*    END-EXEC.
  7266*    MOVE '"$I.                  ! 1 #00006616' TO DFHEIV0
  7267     MOVE X'2224492E2020202020202020' TO DFHEIV0(1:12)
  7268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7269     MOVE X'3120233030303036363136' TO DFHEIV0(25:11)
  7270     CALL 'kxdfhei1' USING DFHEIV0
  7271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7272
  7273
  7274
  7275* EXEC CICS READ
  7276*        DATASET  (CNTL-FILE-ID)
  7277*        SET      (ADDRESS OF CONTROL-FILE)
  7278*        RIDFLD   (ELCNTL-KEY)
  7279*    END-EXEC.
  7280*    MOVE '&"S        E          (   #00006621' TO DFHEIV0
  7281     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7283     MOVE X'2020233030303036363231' TO DFHEIV0(25:11)
  7284     CALL 'kxdfhei1' USING DFHEIV0,
  7285           CNTL-FILE-ID,
  7286           DFHEIV20,
  7287           DFHEIV99,
  7288           ELCNTL-KEY,
  7289           DFHEIV99,
  7290           DFHEIV99,
  7291           DFHEIV99
  7292     SET ADDRESS OF CONTROL-FILE TO
  7293         DFHEIV20
  7294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7295
  7296
  7297     IF CNTL-REC-TYPE = '6'
  7298         MOVE AL-UANON           TO  CARRIERA
  7299         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7300         GO TO 7499-EXIT.
  7301
  7302     IF CF-COMPENSATION-MSTR-MAINT-DT NOT = LOW-VALUES
  7303         GO TO 7499-EXIT
  7304     ELSE
  7305         MOVE -1                 TO  MAINTYPL
  7306         MOVE ER-2572            TO  EMI-ERROR
  7307         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7308         GO TO 7499-EXIT.
  7309
  7310 7490-NOT-FOUND.
  7311     IF CNTL-REC-TYPE = '6'
  7312         MOVE -1                 TO  CARRIERL
  7313         MOVE AL-UABON           TO  CARRIERA
  7314         MOVE ER-0193            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 145
* EL652.cbl
  7315     ELSE
  7316         IF CNTL-REC-TYPE = '2'
  7317             MOVE -1                TO  CSRL
  7318             MOVE AL-UABON          TO  CSRA
  7319             MOVE ER-1883           TO  EMI-ERROR
  7320         ELSE
  7321            MOVE ER-0002            TO  EMI-ERROR
  7322            MOVE -1                 TO  PFKEYL.
  7323
  7324     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7325
  7326 7499-EXIT.
  7327     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 146
* EL652.cbl
  7329
  7330 7500-UPDATE-SUMM.
  7331
  7332     PERFORM 7700-ERSUMM-GETMAIN  THRU  7700-EXIT.
  7333
  7334     MOVE 'SX'                   TO SX-RECORD-ID.
  7335     MOVE PI-COMPANY-CD          TO SX-COMPANY-CD.
  7336     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY.
  7337     MOVE PI-ERC-CARRIER         TO SX-CARRIER.
  7338     MOVE PI-ERC-GROUP           TO SX-GROUP.
  7339     MOVE PI-ERC-RESP            TO SX-FIN-RESP.
  7340     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT.
  7341     MOVE WS-SAVE-NAME           TO SX-SUMM-OR-AGT-NAME.
  7342     MOVE PI-PROCESSOR-ID        TO SX-LAST-MAINT-BY.
  7343     MOVE EIBTIME                TO SX-LAST-MAINT-HHMMSS.
  7344     MOVE BIN-CURRENT-SAVE       TO SX-LAST-MAINT-DT.
  7345     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7346     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT-A1.
  7347     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7348     MOVE PI-ERC-CARRIER         TO SX-CARR-A1.
  7349     MOVE PI-ERC-GROUP           TO SX-GROUP-A1.
  7350     MOVE PI-ERC-RESP            TO SX-FIN-RESP-A1.
  7351
  7352
  7353* EXEC CICS HANDLE CONDITION
  7354*        DUPREC  (7550-DUP)
  7355*    END-EXEC.
  7356*    MOVE '"$%                   ! 2 #00006682' TO DFHEIV0
  7357     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7359     MOVE X'3220233030303036363832' TO DFHEIV0(25:11)
  7360     CALL 'kxdfhei1' USING DFHEIV0
  7361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7362
  7363
  7364
  7365* EXEC CICS WRITE
  7366*        DATASET  (SUMM-FILE-ID)
  7367*        FROM     (SUMM-CROSS-REFERENCE)
  7368*        RIDFLD   (SX-CONTROL-PRIMARY)
  7369*    END-EXEC.
  7370     MOVE LENGTH OF
  7371      SUMM-CROSS-REFERENCE
  7372       TO DFHEIV11
  7373*    MOVE '&$ L                  ''   #00006686' TO DFHEIV0
  7374     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7375     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7376     MOVE X'2020233030303036363836' TO DFHEIV0(25:11)
  7377     CALL 'kxdfhei1' USING DFHEIV0,
  7378           SUMM-FILE-ID,
  7379           SUMM-CROSS-REFERENCE,
  7380           DFHEIV11,
  7381           SX-CONTROL-PRIMARY,
  7382           DFHEIV99,
  7383           DFHEIV99
  7384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7385
  7386
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 147
* EL652.cbl
  7387     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7388     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7389     MOVE PI-AR-SUMMARY-CODE     TO SUMM-SUMMARY.
  7390
  7391
  7392* EXEC CICS HANDLE CONDITION
  7393*        NOTFND  (7540-WRITE)
  7394*    END-EXEC.
  7395*    MOVE '"$I                   ! 3 #00006696' TO DFHEIV0
  7396     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7398     MOVE X'3320233030303036363936' TO DFHEIV0(25:11)
  7399     CALL 'kxdfhei1' USING DFHEIV0
  7400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7401
  7402
  7403
  7404* EXEC CICS READ
  7405*        DATASET  (SUMM-FILE-ID)
  7406*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7407*        RIDFLD   (ERSUMM-KEY)
  7408*    END-EXEC.
  7409*    MOVE '&"S        E          (   #00006700' TO DFHEIV0
  7410     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7412     MOVE X'2020233030303036373030' TO DFHEIV0(25:11)
  7413     CALL 'kxdfhei1' USING DFHEIV0,
  7414           SUMM-FILE-ID,
  7415           DFHEIV20,
  7416           DFHEIV99,
  7417           ERSUMM-KEY,
  7418           DFHEIV99,
  7419           DFHEIV99,
  7420           DFHEIV99
  7421     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7422         DFHEIV20
  7423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7424
  7425     GO TO 7599-EXIT.
  7426
  7427 7540-WRITE.
  7428
  7429     MOVE ERSUMM-KEY             TO SX-CONTROL-PRIMARY.
  7430     MOVE LOW-VALUES             TO SX-CONTROL-A1.
  7431     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7432     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7433     MOVE SPACES                 TO SX-SUMM-OR-AGT-NAME.
  7434     MOVE 'LGXX'                 TO SX-LAST-MAINT-BY.
  7435
  7436
  7437* EXEC CICS WRITE
  7438*        DATASET  (SUMM-FILE-ID)
  7439*        FROM     (SUMM-CROSS-REFERENCE)
  7440*        RIDFLD   (SX-CONTROL-PRIMARY)
  7441*    END-EXEC.
  7442     MOVE LENGTH OF
  7443      SUMM-CROSS-REFERENCE
  7444       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 148
* EL652.cbl
  7445*    MOVE '&$ L                  ''   #00006716' TO DFHEIV0
  7446     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7447     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7448     MOVE X'2020233030303036373136' TO DFHEIV0(25:11)
  7449     CALL 'kxdfhei1' USING DFHEIV0,
  7450           SUMM-FILE-ID,
  7451           SUMM-CROSS-REFERENCE,
  7452           DFHEIV11,
  7453           SX-CONTROL-PRIMARY,
  7454           DFHEIV99,
  7455           DFHEIV99
  7456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7457
  7458
  7459     MOVE PI-ERC-CARRIER         TO PI-CR-CARRIER.
  7460     MOVE PI-ERC-GROUP           TO PI-CR-GROUPING.
  7461     MOVE PI-ERC-TYPE            TO PI-CR-TYPE.
  7462     MOVE PI-ERC-RESP            TO PI-CR-FIN-RESP.
  7463     MOVE PI-ERC-ACCT            TO PI-CR-ACCOUNT.
  7464
  7465     MOVE XCTL-856               TO PGM-NAME.
  7466     GO TO 9300-XCTL.
  7467
  7468 7550-DUP.
  7469
  7470     MOVE ER-3152                TO EMI-ERROR.
  7471     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7472
  7473     MOVE -1                     TO MAINTYPL.
  7474
  7475     GO TO 8200-SEND-DATAONLY.
  7476
  7477 7599-EXIT.
  7478     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 149
* EL652.cbl
  7480
  7481 7600-DELETE-SUMM.
  7482
  7483     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7484     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7485     MOVE PI-ERC-CARRIER         TO SUMM-CARRIER.
  7486     MOVE PI-ERC-GROUP           TO SUMM-GROUP.
  7487     MOVE PI-ERC-RESP            TO SUMM-FIN-RESP.
  7488     MOVE PI-ERC-ACCT            TO SUMM-ACCT-AGENT.
  7489
  7490 7620-READ-ERSUMM.
  7491
  7492* EXEC CICS HANDLE CONDITION
  7493*        NOTFND  (7699-EXIT)
  7494*    END-EXEC.
  7495*    MOVE '"$I                   ! 4 #00006754' TO DFHEIV0
  7496     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7498     MOVE X'3420233030303036373534' TO DFHEIV0(25:11)
  7499     CALL 'kxdfhei1' USING DFHEIV0
  7500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7501
  7502
  7503
  7504* EXEC CICS READ
  7505*        DATASET  (SUMM-FILE-ID)
  7506*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7507*        RIDFLD   (ERSUMM-KEY)
  7508*        UPDATE
  7509*    END-EXEC.
  7510*    MOVE '&"S        EU         (   #00006758' TO DFHEIV0
  7511     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7512     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7513     MOVE X'2020233030303036373538' TO DFHEIV0(25:11)
  7514     CALL 'kxdfhei1' USING DFHEIV0,
  7515           SUMM-FILE-ID,
  7516           DFHEIV20,
  7517           DFHEIV99,
  7518           ERSUMM-KEY,
  7519           DFHEIV99,
  7520           DFHEIV99,
  7521           DFHEIV99
  7522     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7523         DFHEIV20
  7524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7525
  7526
  7527
  7528* EXEC CICS DELETE
  7529*        DATASET  (SUMM-FILE-ID)
  7530*    END-EXEC.
  7531*    MOVE '&(                    &   #00006765' TO DFHEIV0
  7532     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7533     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7534     MOVE X'2020233030303036373635' TO DFHEIV0(25:11)
  7535     CALL 'kxdfhei1' USING DFHEIV0,
  7536           SUMM-FILE-ID,
  7537           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 150
* EL652.cbl
  7538           DFHEIV99,
  7539           DFHEIV99,
  7540           DFHEIV99
  7541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7542
  7543
  7544     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7545     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7546     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7547
  7548
  7549* EXEC CICS STARTBR
  7550*        DATASET  (SUMM-FILE-ID)
  7551*        RIDFLD   (ERSUMM-KEY)
  7552*    END-EXEC.
  7553     MOVE 0
  7554       TO DFHEIV11
  7555*    MOVE '&,         G          &   #00006773' TO DFHEIV0
  7556     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7557     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7558     MOVE X'2020233030303036373733' TO DFHEIV0(25:11)
  7559     CALL 'kxdfhei1' USING DFHEIV0,
  7560           SUMM-FILE-ID,
  7561           ERSUMM-KEY,
  7562           DFHEIV99,
  7563           DFHEIV11,
  7564           DFHEIV99
  7565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7566
  7567
  7568
  7569* EXEC CICS READNEXT
  7570*        DATASET  (SUMM-FILE-ID)
  7571*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7572*        RIDFLD   (ERSUMM-KEY)
  7573*    END-EXEC.
  7574     MOVE 0
  7575       TO DFHEIV11
  7576*    MOVE '&.S                   )   #00006778' TO DFHEIV0
  7577     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7578     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7579     MOVE X'2020233030303036373738' TO DFHEIV0(25:11)
  7580     CALL 'kxdfhei1' USING DFHEIV0,
  7581           SUMM-FILE-ID,
  7582           DFHEIV20,
  7583           DFHEIV99,
  7584           ERSUMM-KEY,
  7585           DFHEIV99,
  7586           DFHEIV11,
  7587           DFHEIV99,
  7588           DFHEIV99
  7589     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7590         DFHEIV20
  7591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7592
  7593
  7594     IF SX-CARRIER = LOW-VALUES
  7595         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 151
* EL652.cbl
  7596     ELSE
  7597         GO TO 7640-END-BROWSE.
  7598
  7599
  7600* EXEC CICS HANDLE CONDITION
  7601*        ENDFILE  (7630-DELETE)
  7602*    END-EXEC.
  7603*    MOVE '"$''                   ! 5 #00006789' TO DFHEIV0
  7604     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7606     MOVE X'3520233030303036373839' TO DFHEIV0(25:11)
  7607     CALL 'kxdfhei1' USING DFHEIV0
  7608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7609
  7610
  7611
  7612* EXEC CICS READNEXT
  7613*        DATASET  (SUMM-FILE-ID)
  7614*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7615*        RIDFLD   (ERSUMM-KEY)
  7616*    END-EXEC.
  7617     MOVE 0
  7618       TO DFHEIV11
  7619*    MOVE '&.S                   )   #00006793' TO DFHEIV0
  7620     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7621     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7622     MOVE X'2020233030303036373933' TO DFHEIV0(25:11)
  7623     CALL 'kxdfhei1' USING DFHEIV0,
  7624           SUMM-FILE-ID,
  7625           DFHEIV20,
  7626           DFHEIV99,
  7627           ERSUMM-KEY,
  7628           DFHEIV99,
  7629           DFHEIV11,
  7630           DFHEIV99,
  7631           DFHEIV99
  7632     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7633         DFHEIV20
  7634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7635
  7636
  7637     IF SX-SUMMARY = WS-SAVE-SUMM
  7638         GO TO 7640-END-BROWSE.
  7639
  7640 7630-DELETE.
  7641
  7642* EXEC CICS ENDBR
  7643*        DATASET  (SUMM-FILE-ID)
  7644*    END-EXEC.
  7645     MOVE 0
  7646       TO DFHEIV11
  7647*    MOVE '&2                    $   #00006803' TO DFHEIV0
  7648     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7649     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7650     MOVE X'2020233030303036383033' TO DFHEIV0(25:11)
  7651     CALL 'kxdfhei1' USING DFHEIV0,
  7652           SUMM-FILE-ID,
  7653           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 152
* EL652.cbl
  7654           DFHEIV99
  7655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7656
  7657
  7658     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7659     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7660     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7661
  7662
  7663* EXEC CICS READ
  7664*        DATASET  (SUMM-FILE-ID)
  7665*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7666*        RIDFLD   (ERSUMM-KEY)
  7667*        UPDATE
  7668*    END-EXEC.
  7669*    MOVE '&"S        EU         (   #00006811' TO DFHEIV0
  7670     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7671     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7672     MOVE X'2020233030303036383131' TO DFHEIV0(25:11)
  7673     CALL 'kxdfhei1' USING DFHEIV0,
  7674           SUMM-FILE-ID,
  7675           DFHEIV20,
  7676           DFHEIV99,
  7677           ERSUMM-KEY,
  7678           DFHEIV99,
  7679           DFHEIV99,
  7680           DFHEIV99
  7681     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7682         DFHEIV20
  7683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7684
  7685
  7686
  7687* EXEC CICS DELETE
  7688*        DATASET  (SUMM-FILE-ID)
  7689*    END-EXEC.
  7690*    MOVE '&(                    &   #00006818' TO DFHEIV0
  7691     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7692     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7693     MOVE X'2020233030303036383138' TO DFHEIV0(25:11)
  7694     CALL 'kxdfhei1' USING DFHEIV0,
  7695           SUMM-FILE-ID,
  7696           DFHEIV99,
  7697           DFHEIV99,
  7698           DFHEIV99,
  7699           DFHEIV99
  7700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7701
  7702
  7703     GO TO 7699-EXIT.
  7704
  7705 7640-END-BROWSE.
  7706
  7707* EXEC CICS ENDBR
  7708*        DATASET  (SUMM-FILE-ID)
  7709*    END-EXEC.
  7710     MOVE 0
  7711       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 153
* EL652.cbl
  7712*    MOVE '&2                    $   #00006825' TO DFHEIV0
  7713     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7714     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7715     MOVE X'2020233030303036383235' TO DFHEIV0(25:11)
  7716     CALL 'kxdfhei1' USING DFHEIV0,
  7717           SUMM-FILE-ID,
  7718           DFHEIV11,
  7719           DFHEIV99
  7720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7721
  7722
  7723 7699-EXIT.
  7724     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 154
* EL652.cbl
  7726
  7727 7700-ERSUMM-GETMAIN.
  7728
  7729* EXEC CICS GETMAIN
  7730*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7731*        LENGTH   (ERSUMM-LENGTH)
  7732*        INITIMG  (GETMAIN-SPACE)
  7733*    END-EXEC.
  7734*    MOVE ',"IL                  $   #00006834' TO DFHEIV0
  7735     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7736     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7737     MOVE X'2020233030303036383334' TO DFHEIV0(25:11)
  7738     CALL 'kxdfhei1' USING DFHEIV0,
  7739           DFHEIV20,
  7740           ERSUMM-LENGTH,
  7741           GETMAIN-SPACE
  7742     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7743         DFHEIV20
  7744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7745
  7746
  7747 7700-EXIT.
  7748     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 155
* EL652.cbl
  7750
  7751 7850-START-BROWSE.
  7752
  7753* EXEC CICS STARTBR
  7754*        DATASET  (COMP-FILE-ID)
  7755*        RIDFLD   (PI-ERCOMP-KEY)
  7756*    END-EXEC.
  7757     MOVE 0
  7758       TO DFHEIV11
  7759*    MOVE '&,         G          &   #00006845' TO DFHEIV0
  7760     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7761     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7762     MOVE X'2020233030303036383435' TO DFHEIV0(25:11)
  7763     CALL 'kxdfhei1' USING DFHEIV0,
  7764           COMP-FILE-ID,
  7765           PI-ERCOMP-KEY,
  7766           DFHEIV99,
  7767           DFHEIV11,
  7768           DFHEIV99
  7769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7770
  7771
  7772     MOVE 'Y'                    TO  WS-BROWSE-SW.
  7773
  7774 7850-EXIT.
  7775     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 156
* EL652.cbl
  7777 7900-READNEXT.
  7778
  7779* EXEC CICS READNEXT
  7780*        DATASET  (COMP-FILE-ID)
  7781*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7782*        RIDFLD   (PI-ERCOMP-KEY)
  7783*    END-EXEC.
  7784     MOVE 0
  7785       TO DFHEIV11
  7786*    MOVE '&.S                   )   #00006856' TO DFHEIV0
  7787     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7788     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7789     MOVE X'2020233030303036383536' TO DFHEIV0(25:11)
  7790     CALL 'kxdfhei1' USING DFHEIV0,
  7791           COMP-FILE-ID,
  7792           DFHEIV20,
  7793           DFHEIV99,
  7794           PI-ERCOMP-KEY,
  7795           DFHEIV99,
  7796           DFHEIV11,
  7797           DFHEIV99,
  7798           DFHEIV99
  7799     SET ADDRESS OF COMPENSATION-MASTER TO
  7800         DFHEIV20
  7801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7802
  7803
  7804     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7805         MOVE 'Y'                TO  PI-ERCOMP-EOF-SW
  7806     ELSE
  7807         MOVE SPACE              TO  PI-FIRST-TIME-SW.
  7808
  7809 7900-EXIT.
  7810     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 157
* EL652.cbl
  7812 7950-END-BROWSE.
  7813
  7814* EXEC CICS ENDBR
  7815*        DATASET  (COMP-FILE-ID)
  7816*    END-EXEC.
  7817     MOVE 0
  7818       TO DFHEIV11
  7819*    MOVE '&2                    $   #00006871' TO DFHEIV0
  7820     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7821     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7822     MOVE X'2020233030303036383731' TO DFHEIV0(25:11)
  7823     CALL 'kxdfhei1' USING DFHEIV0,
  7824           COMP-FILE-ID,
  7825           DFHEIV11,
  7826           DFHEIV99
  7827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7828
  7829
  7830     MOVE 'N'                    TO  WS-BROWSE-SW.
  7831
  7832 7950-EXIT.
  7833     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 158
* EL652.cbl
  7835 8000-UPDATE-MAINT-DATE.
  7836     MOVE SPACES                 TO  ELCNTL-KEY.
  7837     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7838     MOVE '1'                    TO  CNTL-REC-TYPE.
  7839     MOVE +0                     TO  CNTL-SEQ-NO.
  7840
  7841
  7842* EXEC CICS HANDLE CONDITION
  7843*        NOTFND  (8000-EXIT)
  7844*    END-EXEC.
  7845*    MOVE '"$I                   ! 6 #00006886' TO DFHEIV0
  7846     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7848     MOVE X'3620233030303036383836' TO DFHEIV0(25:11)
  7849     CALL 'kxdfhei1' USING DFHEIV0
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7851
  7852
  7853
  7854* EXEC CICS READ
  7855*        UPDATE
  7856*        DATASET  (CNTL-FILE-ID)
  7857*        SET      (ADDRESS OF CONTROL-FILE)
  7858*        RIDFLD   (ELCNTL-KEY)
  7859*    END-EXEC.
  7860*    MOVE '&"S        EU         (   #00006890' TO DFHEIV0
  7861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7862     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7863     MOVE X'2020233030303036383930' TO DFHEIV0(25:11)
  7864     CALL 'kxdfhei1' USING DFHEIV0,
  7865           CNTL-FILE-ID,
  7866           DFHEIV20,
  7867           DFHEIV99,
  7868           ELCNTL-KEY,
  7869           DFHEIV99,
  7870           DFHEIV99,
  7871           DFHEIV99
  7872     SET ADDRESS OF CONTROL-FILE TO
  7873         DFHEIV20
  7874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7875
  7876
  7877     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  7878     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7879     MOVE CNTL-FILE-ID           TO  FILE-ID.
  7880
  7881     PERFORM 8400-LOG-JOURNAL-RECORD.
  7882
  7883     MOVE BIN-CURRENT-SAVE  TO  CF-COMPENSATION-MSTR-MAINT-DT.
  7884     MOVE CONTROL-FILE      TO  JP-RECORD-AREA.
  7885     MOVE 'C'               TO  JP-RECORD-TYPE.
  7886     MOVE CNTL-FILE-ID      TO  FILE-ID.
  7887
  7888
  7889* EXEC CICS REWRITE
  7890*        DATASET  (CNTL-FILE-ID)
  7891*        FROM     (CONTROL-FILE)
  7892*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 159
* EL652.cbl
  7893     MOVE LENGTH OF
  7894      CONTROL-FILE
  7895       TO DFHEIV11
  7896*    MOVE '&& L                  %   #00006908' TO DFHEIV0
  7897     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7898     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7899     MOVE X'2020233030303036393038' TO DFHEIV0(25:11)
  7900     CALL 'kxdfhei1' USING DFHEIV0,
  7901           CNTL-FILE-ID,
  7902           CONTROL-FILE,
  7903           DFHEIV11,
  7904           DFHEIV99
  7905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7906
  7907
  7908     PERFORM 8400-LOG-JOURNAL-RECORD.
  7909
  7910 8000-EXIT.
  7911      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 160
* EL652.cbl
  7913 8050-READPREV.
  7914
  7915* EXEC CICS READPREV
  7916*        DATASET  (COMP-FILE-ID)
  7917*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7918*        RIDFLD   (PI-ERCOMP-KEY)
  7919*    END-EXEC.
  7920     MOVE 0
  7921       TO DFHEIV11
  7922*    MOVE '&0S                   )   #00006919' TO DFHEIV0
  7923     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7924     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7925     MOVE X'2020233030303036393139' TO DFHEIV0(25:11)
  7926     CALL 'kxdfhei1' USING DFHEIV0,
  7927           COMP-FILE-ID,
  7928           DFHEIV20,
  7929           DFHEIV99,
  7930           PI-ERCOMP-KEY,
  7931           DFHEIV99,
  7932           DFHEIV11,
  7933           DFHEIV99,
  7934           DFHEIV99
  7935     SET ADDRESS OF COMPENSATION-MASTER TO
  7936         DFHEIV20
  7937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7938
  7939
  7940 8050-EXIT.
  7941     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 161
* EL652.cbl
  7943 8100-SEND-INITIAL-MAP.
  7944
  7945     IF  NOT CREDIT-SESSION
  7946         MOVE AL-SADOF           TO PFK5A
  7947                                    PFK6A.
  7948
  7949     IF PI-COMPANY-ID NOT = 'NCL'
  7950         MOVE AL-SANOF           TO  LETRCDA
  7951         MOVE AL-SADOF           TO  LETDESCA.
  7952
  7953     IF PI-COMPANY-ID  NOT = 'DDB' AND 'ANT' AND 'ASL' AND
  7954                             'AN1' AND 'TFS'
  7955         MOVE AL-SANOF           TO  BALCDA
  7956         MOVE AL-SADOF           TO  BALPRTA.
  7957
  7958     IF PI-COMPANY-ID   = 'NCL'
  7959        IF TYPEI =  'G' OR 'B'
  7960           MOVE AL-UNNOF         TO  RPTCD2A
  7961           MOVE AL-SANOF         TO  RPTCDDA.
  7962
  7963     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  7964        IF TYPEI = 'A'
  7965           MOVE AL-SANOF         TO SPPDDHA
  7966           MOVE AL-UANON         TO SPPDDA
  7967        END-IF
  7968     END-IF
  7969     MOVE AL-SANON               TO  FLITYPA.
  7970
  7971     IF EIBTRNID NOT = TRANS-ID
  7972        IF PI-AR-PROCESSING
  7973             MOVE AL-SANOF       TO  SCDESCA
  7974                                     NGDESCA
  7975*                                    BALDESCA
  7976                                     CKDESCA
  7977             MOVE AL-UANON       TO  SUMMNOA
  7978                                     NETGRSA
  7979*                                    ARBALA
  7980                                     CKPULLA.
  7981
  7982     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  7983         MOVE AL-UANOF           TO  LSTMDTA
  7984         MOVE AL-SANOF           TO  PFK9A
  7985     ELSE
  7986         IF PI-AR-PROCESSING
  7987             MOVE AL-SANOF       TO  PFK9A
  7988         ELSE
  7989             MOVE AL-SANOF       TO  LSTMDTA
  7990             MOVE AL-SADOF       TO  PFK9A.
  7991
  7992*    IF (PI-ERC-TYPE NOT = 'G' AND SPACE)
  7993*       OR (PI-COMPANY-ID NOT = 'DCC')
  7994     IF PI-ERC-TYPE = 'A'
  7995        MOVE AL-SANOF            TO PCONTA
  7996     END-IF
  7997     IF PI-ERC-TYPE NOT = 'B' AND SPACE
  7998         MOVE AL-SADOF           TO  PFK10A
  7999                                     PFK13A
  8000         MOVE AL-SADOF           TO  CSLABLA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 162
* EL652.cbl
  8001         MOVE AL-SADOF           TO  CLPSTA
  8002         MOVE AL-SADOF           TO  MFLABLA
  8003         MOVE AL-SADOF           TO  MAXFEEA
  8004         MOVE AL-SADOF           TO  LFLABLA
  8005         MOVE AL-SADOF           TO  MAXLFA
  8006         MOVE AL-SADOF           TO  REFEHA
  8007                                     REFEA
  8008     END-IF
  8009     if pi-company-id = 'AHL'
  8010        move al-sanof            to ahl120a
  8011                                    over120a
  8012     end-if
  8013     MOVE SAVE-DATE              TO  RUNDATEO.
  8014     MOVE EIBTIME                TO  TIME-IN.
  8015     MOVE TIME-OUT               TO  RUNTIMEO.
  8016     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  8017     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  8018     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  8019     MOVE -1                     TO  MAINTYPL.
  8020
  8021
  8022* EXEC CICS SEND
  8023*        MAP     (MAP-NAME)
  8024*        MAPSET  (MAPSET-NAME)
  8025*        FROM    (EL652AO)
  8026*        ERASE
  8027*        CURSOR
  8028*    END-EXEC.
  8029     MOVE LENGTH OF
  8030      EL652AO
  8031       TO DFHEIV12
  8032     MOVE -1
  8033       TO DFHEIV11
  8034*    MOVE '8$     CT  E    H L F ,   #00007006' TO DFHEIV0
  8035     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8036     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8037     MOVE X'2020233030303037303036' TO DFHEIV0(25:11)
  8038     CALL 'kxdfhei1' USING DFHEIV0,
  8039           MAP-NAME,
  8040           EL652AO,
  8041           DFHEIV12,
  8042           MAPSET-NAME,
  8043           DFHEIV99,
  8044           DFHEIV99,
  8045           DFHEIV99,
  8046           DFHEIV11,
  8047           DFHEIV99,
  8048           DFHEIV99,
  8049           DFHEIV99
  8050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8051
  8052
  8053     GO TO 9100-RETURN-TRAN.
  8054
  8055 8200-SEND-DATAONLY.
  8056
  8057     IF  NOT CREDIT-SESSION
  8058         MOVE AL-SADOF           TO PFK5A
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 163
* EL652.cbl
  8059                                    PFK6A.
  8060
  8061     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  8062         MOVE AL-UANOF           TO  LSTMDTA
  8063         MOVE AL-SANOF           TO  PFK9A
  8064     ELSE
  8065         IF PI-AR-PROCESSING
  8066             MOVE AL-SANOF       TO  PFK9A
  8067         ELSE
  8068             MOVE AL-SANOF       TO  LSTMDTA
  8069             MOVE AL-SADOF       TO  PFK9A.
  8070     IF PI-ERC-TYPE = 'A'
  8071        MOVE AL-SANOF            TO PCONTA
  8072     END-IF
  8073
  8074     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  8075        IF TYPEI = 'A'
  8076           MOVE AL-SANOF         TO SPPDDHA
  8077           MOVE AL-UANON         TO SPPDDA
  8078        END-IF
  8079     END-IF
  8080*    IF (PI-ERC-TYPE NOT = 'G')
  8081*       OR (PI-COMPANY-ID NOT = 'DCC')
  8082     IF PI-ERC-TYPE NOT = 'B'
  8083         MOVE AL-SADOF           TO  PFK10A
  8084                                     PFK13A
  8085         MOVE AL-SADOF           TO  CSLABLA
  8086         MOVE AL-SADOF           TO  CLPSTA
  8087         MOVE AL-SADOF           TO  MFLABLA
  8088         MOVE AL-SADOF           TO  MAXFEEA
  8089         MOVE AL-SADOF           TO  LFLABLA
  8090         MOVE AL-SADOF           TO  MAXLFA
  8091     END-IF.
  8092
  8093     MOVE SAVE-DATE              TO  RUNDATEO.
  8094     MOVE EIBTIME                TO  TIME-IN.
  8095     MOVE TIME-OUT               TO  RUNTIMEO.
  8096     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  8097     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  8098     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  8099
  8100
  8101* EXEC CICS SEND
  8102*        MAP     (MAP-NAME)
  8103*        MAPSET  (MAPSET-NAME)
  8104*        FROM    (EL652AO)
  8105*        DATAONLY
  8106*        CURSOR
  8107*    END-EXEC.
  8108     MOVE LENGTH OF
  8109      EL652AO
  8110       TO DFHEIV12
  8111     MOVE -1
  8112       TO DFHEIV11
  8113*    MOVE '8$D    CT       H L F ,   #00007061' TO DFHEIV0
  8114     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8115     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8116     MOVE X'2020233030303037303631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 164
* EL652.cbl
  8117     CALL 'kxdfhei1' USING DFHEIV0,
  8118           MAP-NAME,
  8119           EL652AO,
  8120           DFHEIV12,
  8121           MAPSET-NAME,
  8122           DFHEIV99,
  8123           DFHEIV99,
  8124           DFHEIV99,
  8125           DFHEIV11,
  8126           DFHEIV99,
  8127           DFHEIV99,
  8128           DFHEIV99
  8129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8130
  8131
  8132     GO TO 9100-RETURN-TRAN.
  8133
  8134 8300-SEND-TEXT.
  8135
  8136* EXEC CICS SEND TEXT
  8137*        FROM    (LOGOFF-TEXT)
  8138*        LENGTH  (LOGOFF-LENGTH)
  8139*        ERASE
  8140*        FREEKB
  8141*    END-EXEC.
  8142*    MOVE '8&      T  E F  H   F -   #00007072' TO DFHEIV0
  8143     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8144     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8145     MOVE X'2020233030303037303732' TO DFHEIV0(25:11)
  8146     CALL 'kxdfhei1' USING DFHEIV0,
  8147           LOGOFF-TEXT,
  8148           LOGOFF-LENGTH,
  8149           DFHEIV99,
  8150           DFHEIV99,
  8151           DFHEIV99,
  8152           DFHEIV99,
  8153           DFHEIV99,
  8154           DFHEIV99,
  8155           DFHEIV99,
  8156           DFHEIV99,
  8157           DFHEIV99,
  8158           DFHEIV99
  8159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8160
  8161
  8162
  8163* EXEC CICS RETURN
  8164*    END-EXEC.
  8165*    MOVE '.(                    ''   #00007079' TO DFHEIV0
  8166     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8167     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8168     MOVE X'2020233030303037303739' TO DFHEIV0(25:11)
  8169     CALL 'kxdfhei1' USING DFHEIV0,
  8170           DFHEIV99,
  8171           DFHEIV99,
  8172           DFHEIV99,
  8173           DFHEIV99,
  8174           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 165
* EL652.cbl
  8175           DFHEIV99
  8176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8177
  8178
  8179 8400-LOG-JOURNAL-RECORD.
  8180     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  8181     MOVE FILE-ID                TO  JP-FILE-ID.
  8182     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  8183
  8184*    EXEC CICS JOURNAL
  8185*        JFILEID  (PI-JOURNAL-FILE-ID)
  8186*        JTYPEID  ('EL')
  8187*        FROM     (JOURNAL-RECORD)
  8188*        LENGTH   (473)
  8189*    END-EXEC.
  8190
  8191 8800-UNAUTHORIZED-ACCESS.
  8192     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  8193
  8194     GO TO 8300-SEND-TEXT.
  8195
  8196 8810-PF23.
  8197     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  8198     MOVE XCTL-005               TO  PGM-NAME.
  8199
  8200     GO TO 9300-XCTL.
  8201
  8202 8880-NOT-FOUND.
  8203     MOVE ER-0142                TO  EMI-ERROR.
  8204     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8205
  8206     MOVE SPACE                  TO  PI-ERC-TYPE.
  8207     MOVE -1                     TO  MAINTYPL.
  8208
  8209     IF EIBTRNID NOT = TRANS-ID
  8210         GO TO 8100-SEND-INITIAL-MAP.
  8211
  8212     GO TO 8200-SEND-DATAONLY.
  8213
  8214 9100-RETURN-TRAN.
  8215     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  8216     MOVE '652A'                 TO  PI-CURRENT-SCREEN-NO.
  8217
  8218
  8219* EXEC CICS RETURN
  8220*        TRANSID   (TRANS-ID)
  8221*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8222*        LENGTH    (PI-COMM-LENGTH)
  8223*    END-EXEC.
  8224*    MOVE '.(CT                  ''   #00007121' TO DFHEIV0
  8225     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8226     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8227     MOVE X'2020233030303037313231' TO DFHEIV0(25:11)
  8228     CALL 'kxdfhei1' USING DFHEIV0,
  8229           TRANS-ID,
  8230           PROGRAM-INTERFACE-BLOCK,
  8231           PI-COMM-LENGTH,
  8232           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 166
* EL652.cbl
  8233           DFHEIV99,
  8234           DFHEIV99
  8235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8236
  8237
  8238 9200-RETURN-MAIN-MENU.
  8239
  8240     IF  MORTGAGE-SESSION
  8241         MOVE XCTL-EM626         TO PGM-NAME
  8242     ELSE
  8243         IF  CREDIT-SESSION
  8244             MOVE XCTL-626       TO PGM-NAME
  8245         ELSE
  8246             MOVE XCTL-126       TO PGM-NAME.
  8247
  8248     GO TO 9300-XCTL.
  8249
  8250 9300-XCTL.
  8251
  8252* EXEC CICS XCTL
  8253*        PROGRAM   (PGM-NAME)
  8254*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8255*        LENGTH    (PI-COMM-LENGTH)
  8256*    END-EXEC.
  8257*    MOVE '.$C                   %   #00007140' TO DFHEIV0
  8258     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8259     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8260     MOVE X'2020233030303037313430' TO DFHEIV0(25:11)
  8261     CALL 'kxdfhei1' USING DFHEIV0,
  8262           PGM-NAME,
  8263           PROGRAM-INTERFACE-BLOCK,
  8264           PI-COMM-LENGTH,
  8265           DFHEIV99
  8266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8267
  8268
  8269 9400-CLEAR.
  8270     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  8271
  8272     GO TO 9300-XCTL.
  8273
  8274 9500-PF12.
  8275     MOVE XCTL-010               TO  PGM-NAME.
  8276
  8277     GO TO 9300-XCTL.
  8278
  8279 9600-PGMID-ERROR.
  8280
  8281* EXEC CICS HANDLE CONDITION
  8282*        PGMIDERR  (8300-SEND-TEXT)
  8283*    END-EXEC.
  8284*    MOVE '"$L                   ! 7 #00007157' TO DFHEIV0
  8285     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8287     MOVE X'3720233030303037313537' TO DFHEIV0(25:11)
  8288     CALL 'kxdfhei1' USING DFHEIV0
  8289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8290
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 167
* EL652.cbl
  8291
  8292     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  8293     MOVE ' '                    TO  PI-ENTRY-CD-1.
  8294     MOVE XCTL-005               TO  PGM-NAME.
  8295     MOVE PGM-NAME               TO  LOGOFF-PGM.
  8296     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  8297
  8298     GO TO 9300-XCTL.
  8299
  8300 9700-LINK-DATE-CONVERT.
  8301
  8302* EXEC CICS LINK
  8303*        PROGRAM   ('ELDATCV')
  8304*        COMMAREA  (DATE-CONVERSION-DATA)
  8305*        LENGTH    (DC-COMM-LENGTH)
  8306*    END-EXEC.
  8307     MOVE 'ELDATCV' TO DFHEIV1
  8308*    MOVE '."C                   (   #00007170' TO DFHEIV0
  8309     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8310     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8311     MOVE X'2020233030303037313730' TO DFHEIV0(25:11)
  8312     CALL 'kxdfhei1' USING DFHEIV0,
  8313           DFHEIV1,
  8314           DATE-CONVERSION-DATA,
  8315           DC-COMM-LENGTH,
  8316           DFHEIV99,
  8317           DFHEIV99,
  8318           DFHEIV99,
  8319           DFHEIV99
  8320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8321
  8322
  8323 9700-EXIT.
  8324     EXIT.
  8325
  8326 9900-ERROR-FORMAT.
  8327     IF NOT EMI-ERRORS-COMPLETE
  8328         MOVE LINK-001           TO  PGM-NAME
  8329
  8330* EXEC CICS LINK
  8331*            PROGRAM   (PGM-NAME)
  8332*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  8333*            LENGTH    (EMI-COMM-LENGTH)
  8334*        END-EXEC.
  8335*    MOVE '."C                   (   #00007182' TO DFHEIV0
  8336     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8338     MOVE X'2020233030303037313832' TO DFHEIV0(25:11)
  8339     CALL 'kxdfhei1' USING DFHEIV0,
  8340           PGM-NAME,
  8341           ERROR-MESSAGE-INTERFACE-BLOCK,
  8342           EMI-COMM-LENGTH,
  8343           DFHEIV99,
  8344           DFHEIV99,
  8345           DFHEIV99,
  8346           DFHEIV99
  8347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8348
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 168
* EL652.cbl
  8349
  8350 9900-EXIT.
  8351     EXIT.
  8352
  8353 9910-INITIALIZE-SECURITY.
  8354******************************************************************
  8355*                                                                *
  8356*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  8357*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  8358*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  8359*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  8360*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  8361*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  8362*                                                                *
  8363******************************************************************
  8364
  8365     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  8366
  8367         IF  MORTGAGE-SESSION
  8368             MOVE '125E'             TO SC-QUID-SYSTEM
  8369             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  8370
  8371
  8372* EXEC CICS READQ TS
  8373*                QUEUE  (SC-QUID-KEY)
  8374*                INTO   (SECURITY-CONTROL-E)
  8375*                LENGTH (SC-COMM-LENGTH-E)
  8376*                ITEM   (SC-ITEM)
  8377*            END-EXEC
  8378*    MOVE '*$II   L              ''   #00007209' TO DFHEIV0
  8379     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8380     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8381     MOVE X'2020233030303037323039' TO DFHEIV0(25:11)
  8382     CALL 'kxdfhei1' USING DFHEIV0,
  8383           SC-QUID-KEY,
  8384           SECURITY-CONTROL-E,
  8385           SC-COMM-LENGTH-E,
  8386           SC-ITEM,
  8387           DFHEIV99,
  8388           DFHEIV99
  8389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8390
  8391             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  8392                                     TO PI-DISPLAY-CAP
  8393             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  8394                                     TO PI-MODIFY-CAP
  8395
  8396             IF  NOT DISPLAY-CAP
  8397                 MOVE 'READ'         TO SM-READ
  8398                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8399                 MOVE ER-9097        TO EMI-ERROR
  8400                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8401                 GO TO 8100-SEND-INITIAL-MAP
  8402             ELSE
  8403                 GO TO 9910-EXIT
  8404         ELSE
  8405
  8406* EXEC CICS  READQ TS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 169
* EL652.cbl
  8407*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8408*                INTO    (SECURITY-CONTROL)
  8409*                LENGTH  (SC-COMM-LENGTH)
  8410*                ITEM    (SC-ITEM-CL-CR)
  8411*                END-EXEC
  8412*    MOVE '*$II   L              ''   #00007230' TO DFHEIV0
  8413     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8414     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8415     MOVE X'2020233030303037323330' TO DFHEIV0(25:11)
  8416     CALL 'kxdfhei1' USING DFHEIV0,
  8417           PI-SECURITY-TEMP-STORE-ID,
  8418           SECURITY-CONTROL,
  8419           SC-COMM-LENGTH,
  8420           SC-ITEM-CL-CR,
  8421           DFHEIV99,
  8422           DFHEIV99
  8423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8424
  8425             MOVE SC-CREDIT-DISPLAY (05)
  8426                                 TO PI-DISPLAY-CAP
  8427             MOVE SC-CREDIT-UPDATE  (05)
  8428                                 TO PI-MODIFY-CAP
  8429
  8430             IF  NOT DISPLAY-CAP
  8431                 MOVE 'READ'     TO SM-READ
  8432                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8433                 MOVE ER-0070    TO  EMI-ERROR
  8434                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8435                 GO TO 8100-SEND-INITIAL-MAP.
  8436
  8437 9910-EXIT.
  8438     EXIT.
  8439
  8440 9990-ABEND.
  8441     MOVE LINK-004               TO  PGM-NAME.
  8442     MOVE DFHEIBLK               TO  EMI-LINE1.
  8443
  8444
  8445* EXEC CICS LINK
  8446*        PROGRAM   (PGM-NAME)
  8447*        COMMAREA  (EMI-LINE1)
  8448*        LENGTH    (72)
  8449*    END-EXEC.
  8450     MOVE 72
  8451       TO DFHEIV11
  8452*    MOVE '."C                   (   #00007256' TO DFHEIV0
  8453     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8455     MOVE X'2020233030303037323536' TO DFHEIV0(25:11)
  8456     CALL 'kxdfhei1' USING DFHEIV0,
  8457           PGM-NAME,
  8458           EMI-LINE1,
  8459           DFHEIV11,
  8460           DFHEIV99,
  8461           DFHEIV99,
  8462           DFHEIV99,
  8463           DFHEIV99
  8464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 170
* EL652.cbl
  8465
  8466
  8467     GO TO 8200-SEND-DATAONLY.
  8468
  8469 9995-SECURITY-VIOLATION.
  8470*           COPY ELCSCTP.
  8471******************************************************************
  8472*                                                                *
  8473*                            ELCSCTP                             *
  8474*                            VMOD=2.001                          *
  8475*                                                                *
  8476*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8477******************************************************************
  8478
  8479
  8480     MOVE EIBDATE          TO SM-JUL-DATE.
  8481     MOVE EIBTRMID         TO SM-TERMID.
  8482     MOVE THIS-PGM         TO SM-PGM.
  8483     MOVE EIBTIME          TO TIME-IN.
  8484     MOVE TIME-OUT         TO SM-TIME.
  8485     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8486
  8487
  8488* EXEC CICS LINK
  8489*         PROGRAM  ('EL003')
  8490*         COMMAREA (SECURITY-MESSAGE)
  8491*         LENGTH   (80)
  8492*    END-EXEC.
  8493     MOVE 'EL003' TO DFHEIV1
  8494     MOVE 80
  8495       TO DFHEIV11
  8496*    MOVE '."C                   (   #00007282' TO DFHEIV0
  8497     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8498     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8499     MOVE X'2020233030303037323832' TO DFHEIV0(25:11)
  8500     CALL 'kxdfhei1' USING DFHEIV0,
  8501           DFHEIV1,
  8502           SECURITY-MESSAGE,
  8503           DFHEIV11,
  8504           DFHEIV99,
  8505           DFHEIV99,
  8506           DFHEIV99,
  8507           DFHEIV99
  8508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8509
  8510
  8511******************************************************************
  8512
  8513 9995-EXIT.
  8514      EXIT.
  8515
  8516 9999-DFHBACK SECTION.
  8517     MOVE '9%                    "   ' TO DFHEIV0
  8518     MOVE 'EL652' TO DFHEIV1
  8519     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8520     GOBACK.
  8521 9999-DFHEXIT.
  8522     IF DFHEIGDJ EQUAL 0001
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 171
* EL652.cbl
  8523         NEXT SENTENCE
  8524     ELSE IF DFHEIGDJ EQUAL 2
  8525         GO TO 9990-ABEND,
  8526               8880-NOT-FOUND,
  8527               9600-PGMID-ERROR,
  8528               9990-ABEND
  8529         DEPENDING ON DFHEIGDI
  8530     ELSE IF DFHEIGDJ EQUAL 3
  8531         GO TO 3400-EXIT
  8532         DEPENDING ON DFHEIGDI
  8533     ELSE IF DFHEIGDJ EQUAL 4
  8534         GO TO 3450-EXIT
  8535         DEPENDING ON DFHEIGDI
  8536     ELSE IF DFHEIGDJ EQUAL 5
  8537         GO TO 9990-ABEND,
  8538               8880-NOT-FOUND,
  8539               9600-PGMID-ERROR,
  8540               9990-ABEND
  8541         DEPENDING ON DFHEIGDI
  8542     ELSE IF DFHEIGDJ EQUAL 6
  8543         GO TO 3475-EXIT
  8544         DEPENDING ON DFHEIGDI
  8545     ELSE IF DFHEIGDJ EQUAL 7
  8546         GO TO 9990-ABEND,
  8547               4250-CONT
  8548         DEPENDING ON DFHEIGDI
  8549     ELSE IF DFHEIGDJ EQUAL 8
  8550         GO TO 4300-EXIT
  8551         DEPENDING ON DFHEIGDI
  8552     ELSE IF DFHEIGDJ EQUAL 9
  8553         GO TO 4750-NO-STATE
  8554         DEPENDING ON DFHEIGDI
  8555     ELSE IF DFHEIGDJ EQUAL 10
  8556         GO TO 6550-END-BROWSE,
  8557               6550-END-BROWSE
  8558         DEPENDING ON DFHEIGDI
  8559     ELSE IF DFHEIGDJ EQUAL 11
  8560         GO TO 6550-END-BROWSE,
  8561               6550-END-BROWSE
  8562         DEPENDING ON DFHEIGDI
  8563     ELSE IF DFHEIGDJ EQUAL 12
  8564         GO TO 6599-EXIT,
  8565               6599-EXIT
  8566         DEPENDING ON DFHEIGDI
  8567     ELSE IF DFHEIGDJ EQUAL 13
  8568         GO TO 7250-ENDFILE,
  8569               7250-ENDFILE,
  8570               9990-ABEND
  8571         DEPENDING ON DFHEIGDI
  8572     ELSE IF DFHEIGDJ EQUAL 14
  8573         GO TO 7250-ENDFILE,
  8574               7275-NOTFOUND
  8575         DEPENDING ON DFHEIGDI
  8576     ELSE IF DFHEIGDJ EQUAL 15
  8577         GO TO 7375-ENDFILE,
  8578               7375-ENDFILE,
  8579               9990-ABEND
  8580         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 172
* EL652.cbl
  8581     ELSE IF DFHEIGDJ EQUAL 16
  8582         GO TO 7375-ENDFILE,
  8583               7275-NOTFOUND
  8584         DEPENDING ON DFHEIGDI
  8585     ELSE IF DFHEIGDJ EQUAL 17
  8586         GO TO 7490-NOT-FOUND,
  8587               9990-ABEND
  8588         DEPENDING ON DFHEIGDI
  8589     ELSE IF DFHEIGDJ EQUAL 18
  8590         GO TO 7550-DUP
  8591         DEPENDING ON DFHEIGDI
  8592     ELSE IF DFHEIGDJ EQUAL 19
  8593         GO TO 7540-WRITE
  8594         DEPENDING ON DFHEIGDI
  8595     ELSE IF DFHEIGDJ EQUAL 20
  8596         GO TO 7699-EXIT
  8597         DEPENDING ON DFHEIGDI
  8598     ELSE IF DFHEIGDJ EQUAL 21
  8599         GO TO 7630-DELETE
  8600         DEPENDING ON DFHEIGDI
  8601     ELSE IF DFHEIGDJ EQUAL 22
  8602         GO TO 8000-EXIT
  8603         DEPENDING ON DFHEIGDI
  8604     ELSE IF DFHEIGDJ EQUAL 23
  8605         GO TO 8300-SEND-TEXT
  8606         DEPENDING ON DFHEIGDI.
  8607     MOVE '9%                    "   ' TO DFHEIV0
  8608     MOVE 'EL652' TO DFHEIV1
  8609     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8610     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6276     Code:       25552
