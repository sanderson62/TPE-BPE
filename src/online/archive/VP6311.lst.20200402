* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   1
* VP6311.cbl
* Options: int("VP6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("VP6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"VP6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"VP6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 VP6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   2
* VP6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - VPB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   3
* VP6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    79* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    80******************************************************************
    81
    82 ENVIRONMENT DIVISION.
    83
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   4
* VP6311.cbl
    85 DATA DIVISION.
    86 WORKING-STORAGE SECTION.
    87 01  DFH-START PIC X(04).
    88 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    89 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    90 77  FILLER  PIC X(32)  VALUE '********************************'.
    91 77  FILLER  PIC X(32)  VALUE '*    VP6311 WORKING STORAGE    *'.
    92 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    93 77  A1                          PIC S999 COMP-3 VALUE +0.
    94 77  N1                          PIC S999 COMP-3 VALUE +0.
    95 77  N2                          PIC S999 COMP-3 VALUE +0.
    96 77  N3                          PIC S999 COMP-3 VALUE +0.
    97 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    98 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    99 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   100     88  REVERSAL                    VALUE 'Y'.
   101 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   102 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   103 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   104 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   105 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   106     88  ERMAIL-FOUND                 VALUE 'Y'.
   107 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   108 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   109 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   110 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   111     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   112 77  ws-stop-sw                  pic x value ' '.
   113     88  i-say-stop                 value 'Y'.
   114 77  ws-check-sw                 pic x value ' '.
   115     88  i-have-checks              value 'Y'.
   116 77  ws-proc-check-sw            pic x value ' '.
   117     88  i-have-processed-checks    value 'Y'.
   118 77  ws-chek-browse-sw           pic x value ' '.
   119 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   120 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   121 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   122 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   123 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   124 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   125 01  P pointer.
   126 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   127 01  var-ptr pointer.
   128 01  env-var-len                 pic 9(4)  binary.
   129 01  rc                          pic 9(9)  binary.
   130 01  WS-KIXSYS.
   131     05  WS-KIX-FIL1             PIC X(10).
   132     05  WS-KIX-APPS             PIC X(10).
   133     05  WS-KIX-ENV              PIC X(10).
   134     05  WS-KIX-MYENV            PIC X(10).
   135     05  WS-KIX-SYS              PIC X(10).
   136*    COPY ELCSCTM.
   137******************************************************************
   138*                                                                *
   139*                                                                *
   140*                            ELCSCTM                             *
   141*                            VMOD=2.001                          *
   142*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   5
* VP6311.cbl
   143*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   144*                                                                *
   145******************************************************************
   146 01  SECURITY-MESSAGE.
   147     12  FILLER                          PIC X(30)
   148            VALUE '** LOGIC SECURITY VIOLATION -'.
   149     12  SM-READ                         PIC X(6).
   150     12  FILLER                          PIC X(5)
   151            VALUE ' PGM='.
   152     12  SM-PGM                          PIC X(6).
   153     12  FILLER                          PIC X(5)
   154            VALUE ' OPR='.
   155     12  SM-PROCESSOR-ID                 PIC X(4).
   156     12  FILLER                          PIC X(6)
   157            VALUE ' TERM='.
   158     12  SM-TERMID                       PIC X(4).
   159     12  FILLER                          PIC XX   VALUE SPACE.
   160     12  SM-JUL-DATE                     PIC 9(5).
   161     12  FILLER                          PIC X    VALUE SPACE.
   162     12  SM-TIME                         PIC 99.99.
   163
   164
   165*    COPY ELCSCRTY.
   166******************************************************************
   167*                                                                *
   168*                                                                *
   169*                            ELCSCRTY                            *
   170*                            VMOD=2.001                          *
   171*                                                                *
   172*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   173*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   174*        SAVED IN PI-SECURITY-ADDRESS.                           *
   175*                                                                *
   176******************************************************************
   177 01  SECURITY-CONTROL.
   178     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   179     12  FILLER                       PIC XX    VALUE 'SC'.
   180     12  SC-CREDIT-CODES.
   181         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   182             20  SC-CREDIT-DISPLAY    PIC X.
   183             20  SC-CREDIT-UPDATE     PIC X.
   184     12  SC-CLAIMS-CODES.
   185         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   186             20  SC-CLAIMS-DISPLAY    PIC X.
   187             20  SC-CLAIMS-UPDATE     PIC X.
   188
   189 01  WS-VA-NO-COMM-MESS.
   190     12  FILLER                  PIC X(41) VALUE
   191        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   192 01  WS-OC-MESSAGE.
   193     12  FILLER                  PIC X(43) VALUE
   194        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   195     12  WS-OC-DIS-AMT           PIC -----9.99.
   196     12  FILLER                  PIC X(4) VALUE ' ON '.
   197     12  WS-OC-DATE              PIC X(10).
   198 01  WS-DATE-AREA.
   199     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   200     12  WS-CURRENT-DT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   6
* VP6311.cbl
   201         16  FILLER              PIC X(6)    VALUE SPACES.
   202         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   203     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   204     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   205     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   206
   207 01  STANDARD-AREAS.
   208     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   209     12  VP631B                  PIC X(8)    VALUE 'VP631B'.
   210     12  VP631C                  PIC X(8)    VALUE 'VP631C'.
   211     12  VP631D                  PIC X(8)    VALUE 'VP631D'.
   212     12  MAPSET-VP6311S          PIC X(8)    VALUE 'VP6311S'.
   213     12  SCREEN-NUMBER           PIC X(6)    VALUE 'VP631B'.
   214     12  TRANS-EXB1              PIC X(4)    VALUE 'VPB1'.
   215     12  THIS-PGM                PIC X(8)    VALUE 'VP6311'.
   216     12  PGM-NAME                PIC X(8).
   217     12  TIME-IN                 PIC S9(7).
   218     12  TIME-OUT-R  REDEFINES TIME-IN.
   219         16  FILLER              PIC X.
   220         16  TIME-OUT            PIC 99V99.
   221         16  FILLER              PIC XX.
   222     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   223     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   224     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   225     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   226     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   227     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   228     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   229     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   230     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   231     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   232     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   233     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   234     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   235     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   236     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   237     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   238     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   239     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   240     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   241     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   242     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   243     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   244     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   245     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   246     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   247     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   248     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   249     12  FILE-ID                 PIC X(8).
   250     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   251     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   252     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   253     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   254     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   255     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   256     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   257     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   258     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   7
* VP6311.cbl
   259     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   260     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   261     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   262     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   263     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   264     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   265
   266 01  WS-PASS-AREA.
   267     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   268     05  WS-PASS-VADS-REC    PIC X(350).
   269*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   270*                                COPY ELCZREC.
   271******************************************************************
   272*                                                                *
   273*                                                                *
   274*                            ELCZREC.                            *
   275*                                                                *
   276*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   277*                                                                *
   278******************************************************************
   279*-----------------------------------------------------------------
   280*                   C H A N G E   L O G
   281*
   282* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   283*-----------------------------------------------------------------
   284*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   285* EFFECTIVE    NUMBER
   286*-----------------------------------------------------------------
   287* 122011    2011022800001  AJRA  NEW FILE
   288* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   289* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   290* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   291* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   292*-----------------------------------------------------------------
   293 01  W-Z-CONTROL-DATA.
   294     05  W-NUMBER-OF-COPIES      PIC  9.
   295     05  FILLER                  PIC  X.
   296     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   297     05  FILLER                  PIC  X.
   298     05  W-DAYS-TO-RESEND        PIC  999.
   299     05  FILLER                  PIC  X.
   300     05  W-FORM-TO-RESEND        PIC  X(4).
   301     05  W-ADD-BAR-CODE          PIC  X.
   302     05  W-PROMPT-LETTER         PIC  X.
   303     05  W-HAS-RETURN-ENV        PIC  X.
   304     05  W-ENCLOSURE-CD          PIC  XXX.
   305     05  W-SIG-FLAG-DEFAULT      PIC  X.
   306     05  W-AUTO-CLOSE-IND        PIC  X.
   307     05  FILLER                  PIC  X.
   308     05  W-LETTER-TO-BENE        PIC  X.
   309     05  FILLER                  PIC  X.
   310     05  W-LETTER-TO-ACCT        PIC  X.
   311     05  FILLER                  PIC  X.
   312     05  W-LETTER-TYPE           PIC  X.
   313     05  FILLER                  PIC  X.
   314     05  W-PRINT-CERTIFICATE     PIC  X.
   315     05  FILLER                  PIC  X.
   316     05  W-REFUND-REQUIRED       PIC  X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   8
* VP6311.cbl
   317     05  FILLER                  PIC  X.
   318     05  W-ONBASE-CODE           PIC  XX.
   319     05  FILLER                  PIC  X.
   320     05  W-ACCT-SUMM             PIC  X.
   321     05  FILLER                  PIC  X.
   322     05  W-CSO-SUMM              PIC  X.
   323     05  FILLER                  PIC  X.
   324     05  W-REASONS-REQUIRED      PIC  X.
   325     05  FILLER                  PIC  X(29).
   326******************************************************************
   327*                                                                *
   328*              A C C E S S   K E Y S                             *
   329*                                                                *
   330******************************************************************
   331
   332 01  ACCESS-KEYS.
   333     12  ERPYAJ-KEY.
   334         16  ERPYAJ-COMPANY-CD       PIC X.
   335         16  ERPYAJ-CARRIER          PIC X.
   336         16  ERPYAJ-GROUPING         PIC X(6).
   337         16  ERPYAJ-FIN-RESP         PIC X(10).
   338         16  ERPYAJ-ACCOUNT          PIC X(10).
   339         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   340         16  ERPYAJ-TYPE             PIC X.
   341     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   342     12  ELCERT-KEY.
   343         16  ELCERT-COMPANY-CD       PIC X.
   344         16  ELCERT-CARRIER          PIC X.
   345         16  ELCERT-GROUPING         PIC X(6).
   346         16  ELCERT-STATE            PIC XX.
   347         16  ELCERT-ACCOUNT          PIC X(10).
   348         16  ELCERT-CERT-EFF-DT      PIC XX.
   349         16  ELCERT-CERT-NO.
   350             20  ELCERT-CERT-PRIME   PIC X(10).
   351             20  ELCERT-CERT-SFX     PIC X.
   352
   353     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   354     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   355     12  ELCRTO-KEY.
   356         16  ELCRTO-COMPANY-CD       PIC X.
   357         16  ELCRTO-CARRIER          PIC X.
   358         16  ELCRTO-GROUPING         PIC X(6).
   359         16  ELCRTO-STATE            PIC XX.
   360         16  ELCRTO-ACCOUNT          PIC X(10).
   361         16  ELCRTO-CERT-EFF-DT      PIC XX.
   362         16  ELCRTO-CERT-NO.
   363             20  ELCRTO-CERT-PRIME   PIC X(10).
   364             20  ELCRTO-CERT-SFX     PIC X.
   365         16  ELCRTO-RECORD-TYPE      PIC X.
   366         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   367
   368     12  ELCRTT-KEY.
   369         16  ELCRTT-PRIMARY          PIC X(33).
   370         16  ELCRTT-REC-TYPE         PIC X(1).
   371     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   372     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   373
   374     12  ERPNDB-KEY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page   9
* VP6311.cbl
   375         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   376         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   377         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   378         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   379             ERPNDB-BATCH-SEQ-NO     PIC XX.
   380         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   381
   382     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   383     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   384     12  ERCHEK-KEY.
   385         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   386         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   387         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   388         16  CHEK-STATE              PIC XX      VALUE SPACES.
   389         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   390         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   391         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   392         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   393         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   394     12  ELLETR-KEY.
   395         16  LETR-COMPANY-CD     PIC X.
   396         16  LETR-LETTER-ID      PIC X(4).
   397         16  LETR-FILLER         PIC X(8).
   398         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   399     12  ERPNDM-KEY.
   400         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   401         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   402         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   403         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   404
   405*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   406     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   407*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   408     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   409
   410     12  ERPNDB-ALT-KEY.
   411         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   412         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   413         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   414         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   415         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   416         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   417         16  ERPNDB-CERT-NO.
   418             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   419             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   420         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   421         16  ERPNDB-RECORD-TYPE      PIC X.
   422
   423      12  ERPNDB-CSR-KEY.
   424          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   425          20  ERPNDB-CSR-ID                PIC X(4).
   426          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   427          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   428          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   429
   430     12  ERNOTE-KEY.
   431         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   432         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  10
* VP6311.cbl
   433         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   434         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   435         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   436         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   437         16  ERNOTE-CERT-NO.
   438             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   439             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   440
   441     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   442     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   443
   444     12  ERCNOT-KEY.
   445         16  ERCNOT-PART-KEY.
   446             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   447             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   448             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   449             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   450             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   451             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   452             20  ERCNOT-CERT-NO.
   453                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   454                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   455         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   456         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   457
   458     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   459     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   460
   461     12  ERMAIL-KEY.
   462         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   463         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   464         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   465         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   466         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   467         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   468         16  ERMAIL-CERT-NO.
   469             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   470             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   471
   472     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   473     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   474
   475     12  ERRQST-KEY.
   476         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   477         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   478
   479     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   480     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   481
   482     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   483
   484     12  ERLOFC-KEY.
   485         16  ERLOFC-COMPANY-CD          PIC  X.
   486         16  ERLOFC-CARRIER             PIC  X.
   487         16  ERLOFC-GROUPING            PIC  X(6).
   488         16  ERLOFC-STATE               PIC  XX.
   489         16  ERLOFC-ACCOUNT             PIC  X(10).
   490         16  ERLOFC-OFFICER-CODE        PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  11
* VP6311.cbl
   491*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   492
   493     12  ERACCT-KEY.
   494         16  ERACCT-COMPANY-CD          PIC  X.
   495         16  ERACCT-CARRIER             PIC  X.
   496         16  ERACCT-GROUPING            PIC  X(6).
   497         16  ERACCT-STATE               PIC  XX.
   498         16  ERACCT-ACCOUNT             PIC  X(10).
   499         16  ERACCT-EXP-DT.
   500             20  ERACCT-DT              PIC  XX.
   501             20  ERACCT-FILL            PIC  X(4).
   502
   503     12  ERENDT-KEY.
   504         16  ENDT-COMPANY-CD       PIC X.
   505         16  ENDT-CARRIER          PIC X.
   506         16  ENDT-GROUPING         PIC X(6).
   507         16  ENDT-STATE            PIC XX.
   508         16  ENDT-ACCOUNT          PIC X(10).
   509         16  ENDT-CERT-EFF-DT      PIC XX.
   510         16  ENDT-CERT-PRIME       PIC X(10).
   511         16  ENDT-CERT-SFX         PIC X.
   512         16  ENDT-RECORD-TYPE      PIC X.
   513         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   514
   515 01  WS-ELMSTR-WORK.
   516     12  ELMSTR-KEY.
   517         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   518         16  MSTR-CERT-NO.
   519             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   520             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   521     12  W-CLAIM-KEY.
   522         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   523         16  W-CL-CERT-NO.
   524             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   525             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   526      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   527 01  CANCEL-GEN-PASS-AREA.
   528     05  CG-OPTION-CODE          PIC X.
   529         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   530         88  CG-FLAT-CANCEL        VALUE '1'.
   531         88  CG-CANCEL             VALUE '2'.
   532         88  CG-CANCEL-REISSUE     VALUE '3'.
   533     05  CG-ERROR-CODE           PIC 99.
   534         88  CG-SUCCESS            VALUE 00.
   535         88  CG-DATE-ERROR         VALUE 01.
   536         88  CG-CERT-NOT-FOUND     VALUE 02.
   537         88  CG-AMOUNT-ERROR       VALUE 04.
   538         88  CG-OPTION-ERROR       VALUE 05.
   539         88  CG-PREV-CAN           VALUE 06.
   540         88  CG-INVALID-DATA       VALUE 07.
   541         88  CG-NO-ACCT-MSTR       VALUE 08.
   542         88  CG-SFX-A-EXIST        VALUE 09.
   543         88  CG-MISC-ERROR         VALUE 99.
   544     05  CG-COMPANY-ID           PIC XXX.
   545     05  CG-PROC-ID              PIC XXXX.
   546     05  CG-CURRENT-DT           PIC XX.
   547     05  CG-MONTH-END-DT         PIC XX.
   548     05  CG-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  12
* VP6311.cbl
   549         10  CG-CERT-COMPANY-CD  PIC X.
   550         10  CG-CERT-CARRIER     PIC X.
   551         10  CG-CERT-GROUP       PIC X(6).
   552         10  CG-CERT-STATE       PIC XX.
   553         10  CG-CERT-ACCOUNT     PIC X(10).
   554         10  CG-CERT-EFF-DT      PIC XX.
   555         10  CG-CERT-CERT-NO     PIC X(11).
   556     05  CG-LF-CAN-DATA.
   557         10  CG-LF-CAN-DT        PIC XX.
   558         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   559     05  CG-AH-CAN-DATA.
   560         10  CG-AH-CAN-DT        PIC XX.
   561         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   562     05  CG-CERT-PROFILE-DATA.
   563         10  CG-INS-LNAME        PIC X(15).
   564         10  CG-INS-FNAME        PIC X(10).
   565         10  CG-INS-MID-INIT     PIC X.
   566         10  CG-INS-AGE          PIC 99.
   567         10  CG-JNT-LNAME        PIC X(15).
   568         10  CG-JNT-FNAME        PIC X(10).
   569         10  CG-JNT-MID-INIT     PIC X.
   570         10  CG-JNT-AGE          PIC 99.
   571     05  CG-LF-ISS-DATA.
   572         10  CG-LF-BENCD         PIC XX.
   573         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   574         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   575     05  CG-AH-ISS-DATA.
   576         10  CG-AH-BENCD         PIC XX.
   577         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   578     05  CG-BATCH-NO             PIC X(6).
   579     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   580     05  FILLER                  PIC X(306).
   581******************************************************************
   582*                                                                *
   583*            G E N E R A L   W O R K   A R E A                   *
   584*                                                                *
   585******************************************************************
   586
   587 01  WORK-AREA.
   588     12  WS-RESPONSE             PIC S9(8)   COMP.
   589         88  RESP-NORMAL           VALUE +0.
   590         88  resp-file-notfnd      value +12.
   591         88  RESP-NOTFND           VALUE +13.
   592         88  resp-duprec           value +14.
   593         88  resp-dupkey           value +15.
   594         88  resp-invreq           value +16.
   595         88  RESP-NOTOPEN          VALUE +19.
   596         88  RESP-ENDFILE          VALUE +20.
   597         88  resp-lengtherr        value +22.
   598     12  DEEDIT-FIELD            PIC X(15).
   599     12  FILLER          REDEFINES DEEDIT-FIELD.
   600         16  FILLER              PIC X(4).
   601         16  DEEDIT-FIELD-X11    PIC X(11).
   602     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   603                                 PIC S9(15).
   604     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   605                                 PIC S9(13)V99.
   606     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  13
* VP6311.cbl
   607                                 PIC S9(11)V9999.
   608     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   609     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   610     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   611         16  WS-CALC-TERM-WHOLE  PIC S999.
   612         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   613
   614     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   615     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   616         16  WS-HR-MINS          PIC 99V99.
   617         16  FILLER              PIC XX.
   618
   619     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   620     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   621
   622     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   623     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   624
   625     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   626     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   627     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   628     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   629     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   630     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   631     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   632
   633     12  QID.
   634         16  QID-TERM            PIC X(4).
   635         16  FILLER              PIC X(4)    VALUE '607B'.
   636
   637     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   638         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   639
   640     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   641         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   642
   643     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   644         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   645                                         'A'.
   646
   647     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   648
   649     12  WS-NUMERIC-SW           PIC X.
   650        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   651
   652     12  WS-EDIT-CSO-FIELD.
   653         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   654                                 PIC X.
   655
   656     12  WS-SAVE-INPUT-FIELDS.
   657         16  WS-BAGE             PIC 99       VALUE ZERO.
   658*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   659         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   660         16  FILLER REDEFINES WS-BAPR.
   661             20  WS-APR-WHOLE-NUM    PIC 99.
   662             20  WS-APR-DEC          PIC 9999.
   663         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   664         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  14
* VP6311.cbl
   665
   666         16  WS-B-COVERAGE OCCURS 2 TIMES.
   667             20  WS-TERM-IN-DAYS-SW  PIC X.
   668                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   669             20  WS-BTERM        PIC 999       COMP-3.
   670             20  WS-BALT-TERM    PIC 999       COMP-3.
   671             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   672             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   673             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   674             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   675             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   676             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   677
   678         16  WS-C-FIELDS COMP-3.
   679             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   680             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   681             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   682
   683         16  WS-D-FIELDS COMP-3.
   684             20  WS-DRISS        PIC S9(5)    VALUE +0.
   685             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   686             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   687             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   688             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   689             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   690
   691     12  WS-SAVE-BIRTH-DATE.
   692         16  FILLER              PIC X(4)   VALUE SPACES.
   693         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   694
   695     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   696     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   697     12  FILLER REDEFINES WS-WORK-BIN-RED.
   698         16  FILLER              PIC X(02).
   699         16  WS-WORK-BIN-DT      PIC X(02).
   700     12  WS-SW-1                 PIC X     VALUE SPACE.
   701     12  WS-SW-2                 PIC X     VALUE SPACE.
   702     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   703         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   704     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   705         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   706
   707     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   708     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   709     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   710     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   711     12  WS-CONVERTED-CANCEL-DATES.
   712         16  WS-CONVERTED-CANDT1                  PIC XX.
   713         16  WS-CONVERTED-CANDT2                  PIC XX.
   714
   715     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   716
   717     12  WS-REC-FOUND-SW         PIC X.
   718         88  RECORD-NOT-FOUND    VALUE 'N'.
   719
   720     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   721         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   722         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  15
* VP6311.cbl
   723
   724     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   725         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   726         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   727
   728     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   729         88  BROWSE-STARTED      VALUE 'Y'.
   730
   731     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   732         88  FIRST-TIME          VALUE 'Y'.
   733
   734     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   735         88  FIRST-ENTRY         VALUE 'Y'.
   736
   737     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   738         88  REC-BILLED          VALUE 'Y'.
   739
   740     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   741         88  NO-CURSOR-SET       VALUE +0.
   742         88  CURSOR-SET          VALUE +1.
   743
   744     12  WS-ERR-SW               PIC X.
   745         88  STD-ERRORS          VALUE 'S'.
   746         88  TRN-ERRORS          VALUE 'T'.
   747
   748     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   749         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   750
   751     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   752         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   753
   754     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   755         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   756
   757     12  WS-ERR-CODE.
   758         16  FILLER              PIC 99.
   759         16  WS-ERROR-SUB        PIC 99.
   760
   761     12  WS-DATE-WORK.
   762         16  WS-WORK-MM          PIC XX.
   763         16  WS-WORK-DD          PIC XX.
   764         16  WS-WORK-YY          PIC XX.
   765
   766     12  WS-MM-YY.
   767         16  WS-MM               PIC XX.
   768         16  FILLER              PIC X     VALUE '/'.
   769         16  WS-YY               PIC XX.
   770
   771     12  WS-CERT-EFF-DT          PIC XX.
   772
   773     12  WS-MEMBER-NO            PIC X(12).
   774     12  FILLER  REDEFINES  WS-MEMBER-NO.
   775         16  WS-MEMBER-NO-1-8    PIC 9(8).
   776         16  FILLER              PIC X(4).
   777
   778     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   779
   780     12  WS-ERPNDB-ALT-KEY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  16
* VP6311.cbl
   781         16  WS-PB-COMPANY-CD-A1         PIC X.
   782         16  WS-PB-CARRIER               PIC X.
   783         16  WS-PB-GROUPING              PIC X(6).
   784         16  WS-PB-STATE                 PIC XX.
   785         16  WS-PB-ACCOUNT               PIC X(10).
   786         16  WS-PB-CERT-EFF-DT           PIC XX.
   787         16  WS-PB-CERT-NO.
   788             20  WS-PB-CERT-PRIME        PIC X(10).
   789             20  WS-PB-CERT-SFX          PIC X.
   790         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   791         16  WS-PB-RECORD-TYPE           PIC X.
   792
   793     12  WS-SHOW-SAVE-AREAS.
   794         16  WS-NEW-CERT-NO.
   795             20  WS-NEW-PRIME    PIC X(10).
   796             20  WS-NEW-SUFFIX   PIC X.
   797         16  WS-NEW-CERT-EFF-DT  PIC XX.
   798         16  WS-NEW-RECORD-TYPE  PIC X.
   799         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   800             88   SHOW-RECORD            VALUE 'Y'.
   801
   802     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   803
   804     12  WS-BATCH-NO.
   805         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   806         16  FILLER              PIC X(5) VALUE SPACES.
   807
   808     12  WS-FIRST-NAME.
   809         16  WS-1ST-INIT         PIC X.
   810         16  FILLER              PIC X(9).
   811
   812     12  WS-INITIALS.
   813         16  WS-INITIAL-1        PIC X.
   814         16  WS-INITIAL-2        PIC X.
   815
   816     12  WS-C-HDG.
   817         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   818         16  FILLER              PIC X(4) VALUE '-REF'.
   819
   820     12  WS-D-PREM-HDG.
   821         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   822         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   823
   824     12  WS-D-REFUND-HDG.
   825         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   826         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   827
   828     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   829
   830     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   831     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   832     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   833     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   834     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   835     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   836     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   837
   838     12  WS-01-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  17
* VP6311.cbl
   839         VALUE 'CANCEL DATE ERROR'.
   840     12  WS-02-CANCEL-ERR        PIC X(25)
   841         VALUE 'CERT NOT FOUND'.
   842     12  WS-04-CANCEL-ERR        PIC X(25)
   843         VALUE 'CANCEL AMOUNT ERROR'.
   844     12  WS-05-CANCEL-ERR        PIC X(25)
   845         VALUE 'CANCEL OPTION ERROR'.
   846     12  WS-06-CANCEL-ERR        PIC X(25)
   847         VALUE 'PREVIOUSLY CANCELLED'.
   848     12  WS-07-CANCEL-ERR        PIC X(25)
   849         VALUE 'INVALID DATA'.
   850     12  WS-08-CANCEL-ERR        PIC X(25)
   851         VALUE 'NO ACCOUNT MASTER'.
   852     12  WS-09-CANCEL-ERR        PIC X(25)
   853         VALUE 'SUFFIX ALREADY EXISTS'.
   854     12  WS-99-CANCEL-ERR        PIC X(25)
   855         VALUE 'MISC CANCEL ERROR'.
   856
   857     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   858     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   859
   860     12  WS-AGE-FIELDS.
   861         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   862         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   863         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   864         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   865
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  18
* VP6311.cbl
   867
   868******************************************************************
   869*                                                                *
   870*                 B A T C H   T O T A L S                        *
   871*                                                                *
   872******************************************************************
   873
   874     12  WS-BATCH-RECORD.
   875         16  FILLER                       PIC X(10).
   876         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   877         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   878         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   879         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   880         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   881         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   882         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   883         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   884         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   885         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   886         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   887         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   888         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   889         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   890         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   891         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   892         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   893         16  WS-ACCOUNT-NAME              PIC X(30).
   894         16  FILLER                       PIC X.
   895         16  WS-REFERENCE                 PIC X(12).
   896         16  FILLER                       PIC X(197).
   897
   898     12  WS-BATCH-TOTALS.
   899         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   900         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   901         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   902         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   903         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   904         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   905         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   906         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   908         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   909         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   910         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   911         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   912         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   913         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   914         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   915         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   916         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   917         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   918
   919     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   920
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  19
* VP6311.cbl
   922
   923******************************************************************
   924*                                                                *
   925*                E R R O R   M E S S A G E S                     *
   926*                                                                *
   927******************************************************************
   928
   929 01  ERROR-MESSAGES.
   930     12  ER-0004                 PIC  9(4) VALUE 0004.
   931     12  ER-0008                 PIC  9(4) VALUE 0008.
   932     12  ER-0023                 PIC  9(4) VALUE 0023.
   933     12  ER-0029                 PIC  9(4) VALUE 0029.
   934     12  ER-0033                 PIC  9(4) VALUE 0033.
   935     12  ER-0070                 PIC  9(4) VALUE 0070.
   936     12  ER-0220                 PIC  9(4) VALUE 0220.
   937     12  ER-0248                 PIC  9(4) VALUE 0248.
   938     12  ER-0280                 PIC  9(4) VALUE 0280.
   939     12  ER-0348                 PIC  9(4) VALUE 0348.
   940     12  ER-0582                 PIC  9(4) VALUE 0582.
   941     12  ER-0877                 PIC  9(4) VALUE 0877.
   942     12  ER-1236                 PIC  9(4) VALUE 1236.
   943     12  ER-1570                 PIC  9(4) VALUE 1570.
   944     12  ER-1575                 PIC  9(4) VALUE 1575.
   945     12  ER-1609                 PIC  9(4) VALUE 1609.
   946     12  ER-1819                 PIC  9(4) VALUE 1819.
   947     12  ER-2077                 PIC  9(4) VALUE 2077.
   948     12  ER-2129                 PIC  9(4) VALUE 2129.
   949     12  ER-2188                 PIC  9(4) VALUE 2188.
   950     12  ER-2192                 PIC  9(4) VALUE 2192.
   951     12  ER-2196                 PIC  9(4) VALUE 2196.
   952     12  ER-2197                 PIC  9(4) VALUE 2197.
   953     12  ER-2198                 PIC  9(4) VALUE 2198.
   954     12  ER-2200                 PIC  9(4) VALUE 2200.
   955     12  ER-2212                 PIC  9(4) VALUE 2212.
   956     12  ER-2218                 PIC  9(4) VALUE 2218.
   957     12  ER-2220                 PIC  9(4) VALUE 2220.
   958     12  ER-2222                 PIC  9(4) VALUE 2222.
   959     12  ER-2223                 PIC  9(4) VALUE 2223.
   960     12  ER-2224                 PIC  9(4) VALUE 2224.
   961     12  ER-2225                 PIC  9(4) VALUE 2225.
   962     12  ER-2226                 PIC  9(4) VALUE 2226.
   963     12  ER-2227                 PIC  9(4) VALUE 2227.
   964     12  ER-2228                 PIC  9(4) VALUE 2228.
   965     12  ER-2240                 PIC  9(4) VALUE 2240.
   966     12  ER-2241                 PIC  9(4) VALUE 2241.
   967     12  ER-2242                 PIC  9(4) VALUE 2242.
   968     12  ER-2243                 PIC  9(4) VALUE 2243.
   969     12  ER-2244                 PIC  9(4) VALUE 2244.
   970     12  ER-2245                 PIC  9(4) VALUE 2245.
   971     12  ER-2246                 PIC  9(4) VALUE 2246.
   972     12  ER-2247                 PIC  9(4) VALUE 2247.
   973     12  ER-2251                 PIC  9(4) VALUE 2251.
   974     12  ER-2252                 PIC  9(4) VALUE 2252.
   975     12  ER-2253                 PIC  9(4) VALUE 2253.
   976     12  ER-2254                 PIC  9(4) VALUE 2254.
   977     12  ER-2255                 PIC  9(4) VALUE 2255.
   978     12  ER-2256                 PIC  9(4) VALUE 2256.
   979     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  20
* VP6311.cbl
   980     12  ER-2258                 PIC  9(4) VALUE 2258.
   981     12  ER-2259                 PIC  9(4) VALUE 2259.
   982     12  ER-2260                 PIC  9(4) VALUE 2260.
   983     12  ER-2261                 PIC  9(4) VALUE 2261.
   984     12  ER-2287                 PIC  9(4) VALUE 2287.
   985     12  ER-2336                 PIC  9(4) VALUE 2336.
   986     12  ER-2337                 PIC  9(4) VALUE 2337.
   987     12  ER-2437                 PIC  9(4) VALUE 2437.
   988     12  ER-2471                 PIC  9(4) VALUE 2471.
   989     12  ER-2530                 PIC  9(4) VALUE 2530.
   990     12  ER-2531                 PIC  9(4) VALUE 2531.
   991     12  ER-2532                 PIC  9(4) VALUE 2532.
   992     12  ER-2533                 PIC  9(4) VALUE 2533.
   993     12  ER-2547                 PIC  9(4) VALUE 2547.
   994     12  ER-2591                 PIC  9(4) VALUE 2591.
   995     12  ER-2592                 PIC  9(4) VALUE 2592.
   996     12  ER-2593                 PIC  9(4) VALUE 2593.
   997     12  ER-2600                 PIC  9(4) VALUE 2600.
   998     12  ER-2601                 PIC  9(4) VALUE 2601.
   999     12  ER-2604                 PIC  9(4) VALUE 2604.
  1000     12  ER-2605                 PIC  9(4) VALUE 2605.
  1001     12  ER-2606                 PIC  9(4) VALUE 2606.
  1002     12  ER-2607                 PIC  9(4) VALUE 2607.
  1003     12  ER-2622                 PIC  9(4) VALUE 2622.
  1004     12  ER-2625                 PIC  9(4) VALUE 2625.
  1005     12  ER-2626                 PIC  9(4) VALUE 2626.
  1006     12  ER-2627                 PIC  9(4) VALUE 2627.
  1007     12  ER-2628                 PIC  9(4) VALUE 2628.
  1008     12  ER-2629                 PIC  9(4) VALUE 2629.
  1009     12  ER-2630                 PIC  9(4) VALUE 2630.
  1010     12  ER-2631                 PIC  9(4) VALUE 2631.
  1011     12  ER-2632                 PIC  9(4) VALUE 2632.
  1012     12  ER-2633                 PIC  9(4) VALUE 2633.
  1013     12  ER-2634                 PIC  9(4) VALUE 2634.
  1014     12  ER-2635                 PIC  9(4) VALUE 2635.
  1015     12  ER-2636                 PIC  9(4) VALUE 2636.
  1016     12  ER-2639                 PIC  9(4) VALUE 2639.
  1017     12  ER-2640                 PIC  9(4) VALUE 2640.
  1018     12  ER-2647                 PIC  9(4) VALUE 2647.
  1019     12  ER-2648                 PIC  9(4) VALUE 2648.
  1020     12  ER-2649                 PIC  9(4) VALUE 2649.
  1021     12  ER-2650                 PIC  9(4) VALUE 2650.
  1022     12  ER-2653                 PIC  9(4) VALUE 2653.
  1023     12  ER-2654                 PIC  9(4) VALUE 2654.
  1024     12  ER-2655                 PIC  9(4) VALUE 2655.
  1025     12  ER-2656                 PIC  9(4) VALUE 2656.
  1026     12  ER-2657                 PIC  9(4) VALUE 2657.
  1027     12  ER-2660                 PIC  9(4) VALUE 2660.
  1028     12  ER-2661                 PIC  9(4) VALUE 2661.
  1029     12  ER-2662                 PIC  9(4) VALUE 2662.
  1030     12  ER-2663                 PIC  9(4) VALUE 2663.
  1031     12  ER-2664                 PIC  9(4) VALUE 2664.
  1032     12  ER-2667                 PIC  9(4) VALUE 2667.
  1033     12  ER-2668                 PIC  9(4) VALUE 2668.
  1034     12  ER-2669                 PIC  9(4) VALUE 2669.
  1035     12  ER-2670                 PIC  9(4) VALUE 2670.
  1036     12  ER-2671                 PIC  9(4) VALUE 2671.
  1037     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  21
* VP6311.cbl
  1038     12  ER-2673                 PIC  9(4) VALUE 2673.
  1039     12  ER-2677                 PIC  9(4) VALUE 2677.
  1040     12  ER-2678                 PIC  9(4) VALUE 2678.
  1041     12  ER-2679                 PIC  9(4) VALUE 2679.
  1042     12  ER-2680                 PIC  9(4) VALUE 2680.
  1043     12  ER-2681                 PIC  9(4) VALUE 2681.
  1044     12  ER-2682                 PIC  9(4) VALUE 2682.
  1045     12  ER-2683                 PIC  9(4) VALUE 2683.
  1046     12  ER-2684                 PIC  9(4) VALUE 2684.
  1047     12  ER-2686                 PIC  9(4) VALUE 2686.
  1048     12  ER-2689                 PIC  9(4) VALUE 2689.
  1049     12  ER-2690                 PIC  9(4) VALUE 2690.
  1050     12  ER-2693                 PIC  9(4) VALUE 2693.
  1051     12  ER-2695                 PIC  9(4) VALUE 2695.
  1052     12  ER-2701                 PIC  9(4) VALUE 2701.
  1053     12  ER-2720                 PIC  9(4) VALUE 2720.
  1054     12  ER-2709                 PIC  9(4) VALUE 2709.
  1055     12  ER-2704                 PIC  9(4) VALUE 2704.
  1056     12  ER-2725                 PIC  9(4) VALUE 2725.
  1057     12  ER-2726                 PIC  9(4) VALUE 2726.
  1058     12  ER-2728                 PIC  9(4) VALUE 2728.
  1059     12  ER-2729                 PIC  9(4) VALUE 2729.
  1060     12  ER-2731                 PIC  9(4) VALUE 2731.
  1061     12  ER-2732                 PIC  9(4) VALUE 2732.
  1062     12  ER-2733                 PIC  9(4) VALUE 2733.
  1063     12  ER-2735                 PIC  9(4) VALUE 2735.
  1064     12  ER-2738                 PIC  9(4) VALUE 2738.
  1065     12  ER-2742                 PIC  9(4) VALUE 2742.
  1066     12  ER-2743                 PIC  9(4) VALUE 2743.
  1067     12  ER-2744                 PIC  9(4) VALUE 2744.
  1068     12  ER-2747                 PIC  9(4) VALUE 2747.
  1069     12  ER-2749                 PIC  9(4) VALUE 2749.
  1070     12  ER-2753                 PIC  9(4) VALUE 2753.
  1071     12  ER-2755                 PIC  9(4) VALUE 2755.
  1072     12  ER-2757                 PIC  9(4) VALUE 2757.
  1073     12  ER-2771                 PIC  9(4) VALUE 2771.
  1074     12  ER-2774                 PIC  9(4) VALUE 2774.
  1075     12  ER-2775                 PIC  9(4) VALUE 2775.
  1076     12  ER-2776                 PIC  9(4) VALUE 2776.
  1077     12  ER-2777                 PIC  9(4) VALUE 2777.
  1078     12  ER-2794                 PIC  9(4) VALUE 2794.
  1079     12  ER-2799                 PIC  9(4) VALUE 2799.
  1080     12  ER-2900                 PIC  9(4) VALUE 2900.
  1081     12  ER-2902                 PIC  9(4) VALUE 2902.
  1082     12  ER-2945                 PIC  9(4) VALUE 2945.
  1083     12  ER-3000                 PIC  9(4) VALUE 3000.
  1084     12  ER-3006                 PIC  9(4) VALUE 3006.
  1085     12  ER-3054                 PIC  9(4) VALUE 3054.
  1086     12  ER-3224                 PIC  9(4) VALUE 3224.
  1087     12  ER-3269                 PIC  9(4) VALUE 3269.
  1088     12  er-3444                 pic  9(4) value 3444.
  1089     12  er-3446                 pic  9(4) value 3446.
  1090     12  er-3447                 pic  9(4) value 3447.
  1091     12  er-3448                 pic  9(4) value 3448.
  1092     12  er-3449                 pic  9(4) value 3449.
  1093     12  ER-3456                 PIC  9(4) VALUE 3456.
  1094     12  ER-3457                 PIC  9(4) VALUE 3457.
  1095     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  22
* VP6311.cbl
  1096     12  ER-3504                 PIC  9(4) VALUE 3504.
  1097     12  ER-3513                 PIC  9(4) VALUE 3513.
  1098     12  ER-3831                 PIC  9(4) VALUE 3831.
  1099     12  ER-3834                 PIC  9(4) VALUE 3834.
  1100     12  ER-3835                 PIC  9(4) VALUE 3835.
  1101     12  ER-4005                 PIC  9(4) VALUE 4005.
  1102     12  ER-7144                 PIC  9(4) VALUE 7144.
  1103     12  ER-7401                 PIC  9(4) VALUE 7401.
  1104     12  ER-7402                 PIC  9(4) VALUE 7402.
  1105     12  ER-7403                 PIC  9(4) VALUE 7403.
  1106     12  ER-7404                 PIC  9(4) VALUE 7404.
  1107     12  ER-7423                 PIC  9(4) VALUE 7423.
  1108     12  ER-7424                 PIC  9(4) VALUE 7424.
  1109     12  ER-7433                 PIC  9(4) VALUE 7433.
  1110     12  ER-7450                 PIC  9(4) VALUE 7450.
  1111     12  ER-7451                 PIC  9(4) VALUE 7451.
  1112     12  ER-7530                 PIC  9(4) VALUE 7530.
  1113     12  ER-7573                 PIC  9(4) VALUE 7573.
  1114     12  ER-7631                 PIC  9(4) VALUE 7631.
  1115     12  ER-7632                 PIC  9(4) VALUE 7632.
  1116     12  ER-7633                 PIC  9(4) VALUE 7633.
  1117     12  ER-7537                 PIC  9(4) VALUE 7537.
  1118     12  ER-7538                 PIC  9(4) VALUE 7538.
  1119     12  ER-7574                 PIC  9(4) VALUE 7574.
  1120     12  ER-7997                 PIC  9(4) VALUE 7997.
  1121     12  ER-7998                 PIC  9(4) VALUE 7998.
  1122     12  ER-8148                 PIC  9(4) VALUE 8148.
  1123     12  ER-9063                 PIC  9(4) VALUE 9063.
  1124     12  ER-9076                 PIC  9(4) VALUE 9076.
  1125     12  ER-9618                 PIC  9(4) VALUE 9618.
  1126     12  ER-9841                 PIC  9(4) VALUE 9841.
  1127
  1128*                                COPY ELCTEXT.
  1129******************************************************************
  1130*                                                                *
  1131*                                                                *
  1132*                            ELCTEXT.                            *
  1133*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1134*                            VMOD=2.008                          *
  1135*                                                                *
  1136*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1137*                                     FORM LETTERS,              *
  1138*                                     CERT FORM DISPLAY.
  1139*                                                                *
  1140*   FILE TYPE = VSAM,KSDS                                        *
  1141*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1142*                                                                *
  1143*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1144*       ALTERNATE INDEX = NONE                                   *
  1145*                                                                *
  1146*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1147*       ALTERNATE INDEX = NONE                                   *
  1148*                                                                *
  1149*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1150*       ALTERNATE INDEX = NONE                                   *
  1151*                                                                *
  1152*   LOG = NO                                                     *
  1153*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  23
* VP6311.cbl
  1154******************************************************************
  1155 01  TEXT-FILES.
  1156     12  TEXT-FILE-ID                PIC XX.
  1157         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1158         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1159         88  HELP-FILE-TEXT             VALUE 'TH'.
  1160
  1161     12  TX-CONTROL-PRIMARY.
  1162         16  TX-COMPANY-CD           PIC X.
  1163             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1164         16  TX-ACCESS-CD-GENL       PIC X(12).
  1165
  1166         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1167             20  TX-LETTER-NO        PIC X(4).
  1168             20  FILLER              PIC X(8).
  1169
  1170         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1171             20  TX-FORM-NO          PIC X(12).
  1172
  1173         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1174             20  TX-HELP-TYPE        PIC X.
  1175                 88  HELP-FOR-GENERAL   VALUE ' '.
  1176                 88  HELP-BY-SCREEN     VALUE 'S'.
  1177                 88  HELP-BY-ERROR      VALUE 'E'.
  1178             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1179                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1180             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1181                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1182             20  FILLER              PIC X(4).
  1183
  1184         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1185
  1186     12  TX-PROCESS-CONTROL          PIC XX.
  1187         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1188
  1189     12  TX-TEXT-LINE                PIC X(70).
  1190
  1191     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1192         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1193         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1194         88  TX-VALID-FORM-SQUEEZE-VALUE
  1195                                        VALUE 'Y' ' '.
  1196
  1197     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1198         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1199         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1200         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1201         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1202         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1203         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1204         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1205                                              'K' 'N' ' '
  1206                                              'Z'.
  1207
  1208     12  TX-ARCHIVE-SW               PIC X.
  1209         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1210         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1211         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  24
* VP6311.cbl
  1212
  1213     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1214     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1215
  1216     12  TX-BSR-CODE                 PIC X.
  1217         88  TX-BSR-LETTER              VALUE 'B'.
  1218         88  TX-NON-BSR-LETTER          VALUE ' '.
  1219
  1220     12  FILLER                      PIC X.
  1221*****************************************************************
  1222*                                COPY ELCCRTO.
  1223******************************************************************
  1224*                                                                *
  1225*                            ELCCRTO.                            *
  1226*                                                                *
  1227*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1228*                                                                *
  1229*   FILE TYPE = VSAM,KSDS                                        *
  1230*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1231*                                                                *
  1232*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1233*                                                                *
  1234*   LOG = YES                                                    *
  1235*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1236******************************************************************
  1237*                   C H A N G E   L O G
  1238*
  1239* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1240*-----------------------------------------------------------------
  1241*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1242* EFFECTIVE    NUMBER
  1243*-----------------------------------------------------------------
  1244* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1245* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1246* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1247* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1248* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1249******************************************************************
  1250 01  ORIGINAL-CERTIFICATE.
  1251     12  OC-RECORD-ID                      PIC XX.
  1252         88  VALID-OC-ID                      VALUE 'OC'.
  1253     12  OC-CONTROL-PRIMARY.
  1254         16  OC-COMPANY-CD                 PIC X.
  1255         16  OC-CARRIER                    PIC X.
  1256         16  OC-GROUPING                   PIC X(6).
  1257         16  OC-STATE                      PIC XX.
  1258         16  OC-ACCOUNT                    PIC X(10).
  1259         16  OC-CERT-EFF-DT                PIC XX.
  1260         16  OC-CERT-NO.
  1261             20  OC-CERT-PRIME             PIC X(10).
  1262             20  OC-CERT-SFX               PIC X.
  1263         16  OC-RECORD-TYPE                PIC X.
  1264         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1265     12  OC-LAST-MAINT-DT                  PIC XX.
  1266     12  OC-LAST-MAINT-BY                  PIC X(4).
  1267     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1268     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1269     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  25
* VP6311.cbl
  1270     12  OC-ORIG-REC.
  1271         16  OC-INS-LAST-NAME              PIC X(15).
  1272         16  OC-INS-FIRST-NAME             PIC X(10).
  1273         16  OC-INS-MIDDLE-INIT            PIC X.
  1274         16  OC-INS-AGE                    PIC S999     COMP-3.
  1275         16  OC-JNT-LAST-NAME              PIC X(15).
  1276         16  OC-JNT-FIRST-NAME             PIC X(10).
  1277         16  OC-JNT-MIDDLE-INIT            PIC X.
  1278         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1279         16  OC-LF-BENCD                   PIC XX.
  1280         16  OC-LF-TERM                    PIC S999      COMP-3.
  1281         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1282         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1283         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1284         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1285         16  OC-LF-EXP-DT                  PIC XX.
  1286         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1287         16  OC-LF-CANCEL-DT               PIC XX.
  1288         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1289         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1290         16  OC-AH-BENCD                   PIC XX.
  1291         16  OC-AH-TERM                    PIC S999      COMP-3.
  1292         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1293         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1294         16  OC-AH-EXP-DT                  PIC XX.
  1295         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1296         16  OC-AH-CP                      PIC 99.
  1297         16  OC-AH-CANCEL-DT               PIC XX.
  1298         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1299         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1300         16  OC-CRED-BENE-NAME             PIC X(25).
  1301         16  OC-1ST-PMT-DT                 PIC XX.
  1302         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1303         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1304         16  OC-ISSUE-TRAN-IND             PIC X.
  1305         16  OC-CANCEL-TRAN-IND            PIC X.
  1306         16  FILLER                        PIC X(211).
  1307
  1308     12  FILLER                            PIC X(50).
  1309******************************************************************
  1310*                                COPY ERCACCT.
  1311******************************************************************
  1312*                                                                *
  1313*                                                                *
  1314*                            ERCACCT                             *
  1315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1316*                            VMOD=2.031                          *
  1317*                                                                *
  1318*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1319*                                                                *
  1320*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1321*   VSAM ACCOUNT MASTER FILES.                                   *
  1322*                                                                *
  1323*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1324*                                                                *
  1325*   FILE TYPE = VSAM,KSDS                                        *
  1326*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1327*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  26
* VP6311.cbl
  1328*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1329*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1330*                                                                *
  1331*   LOG = NO                                                     *
  1332*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1333*                                                                *
  1334*                                                                *
  1335******************************************************************
  1336*                   C H A N G E   L O G
  1337*
  1338* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1339*-----------------------------------------------------------------
  1340*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1341* EFFECTIVE    NUMBER
  1342*-----------------------------------------------------------------
  1343* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1344* 092705    2005050300006  PEMA  ADD SPP LEASES
  1345* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1346* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1347* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1348* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1349* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1350* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1351******************************************************************
  1352
  1353 01  ACCOUNT-MASTER.
  1354     12  AM-RECORD-ID                      PIC XX.
  1355         88  VALID-AM-ID                      VALUE 'AM'.
  1356
  1357     12  AM-CONTROL-PRIMARY.
  1358         16  AM-COMPANY-CD                 PIC X.
  1359         16  AM-MSTR-CNTRL.
  1360             20  AM-CONTROL-A.
  1361                 24  AM-CARRIER            PIC X.
  1362                 24  AM-GROUPING.
  1363                     28 AM-GROUPING-PREFIX PIC XXX.
  1364                     28 AM-GROUPING-PRIME  PIC XXX.
  1365                 24  AM-STATE              PIC XX.
  1366                 24  AM-ACCOUNT.
  1367                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1368                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1369             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1370                                           PIC X(19).
  1371             20  AM-CNTRL-B.
  1372                 24  AM-EXPIRATION-DT      PIC XX.
  1373                 24  FILLER                PIC X(4).
  1374             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1375                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1376
  1377     12  AM-CONTROL-BY-VAR-GRP.
  1378         16  AM-COMPANY-CD-A1              PIC X.
  1379         16  AM-VG-CARRIER                 PIC X.
  1380         16  AM-VG-GROUPING                PIC X(6).
  1381         16  AM-VG-STATE                   PIC XX.
  1382         16  AM-VG-ACCOUNT                 PIC X(10).
  1383         16  AM-VG-DATE.
  1384             20  AM-VG-EXPIRATION-DT       PIC XX.
  1385             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  27
* VP6311.cbl
  1386         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1387                                           PIC 9(11)      COMP-3.
  1388     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1389         16  FILLER                        PIC X(10).
  1390         16  AM-VG-KEY3.
  1391             20  AM-VG3-ACCOUNT            PIC X(10).
  1392             20  AM-VG3-EXP-DT             PIC XX.
  1393         16  FILLER                        PIC X(4).
  1394     12  AM-MAINT-INFORMATION.
  1395         16  AM-LAST-MAINT-DT              PIC XX.
  1396         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1397         16  AM-LAST-MAINT-USER            PIC X(4).
  1398         16  FILLER                        PIC XX.
  1399
  1400     12  AM-EFFECTIVE-DT                   PIC XX.
  1401     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1402
  1403     12  AM-PREV-DATES  COMP-3.
  1404         16  AM-PREV-EXP-DT                PIC 9(11).
  1405         16  AM-PREV-EFF-DT                PIC 9(11).
  1406
  1407     12  AM-REPORT-CODE-1                  PIC X(10).
  1408     12  AM-REPORT-CODE-2                  PIC X(10).
  1409
  1410     12  AM-CITY-CODE                      PIC X(4).
  1411     12  AM-COUNTY-PARISH                  PIC X(6).
  1412
  1413     12  AM-NAME                           PIC X(30).
  1414     12  AM-PERSON                         PIC X(30).
  1415     12  AM-ADDRS                          PIC X(30).
  1416     12  AM-CITY.
  1417         16  AM-ADDR-CITY                  PIC X(28).
  1418         16  AM-ADDR-STATE                 PIC XX.
  1419     12  AM-ZIP.
  1420         16  AM-ZIP-PRIME.
  1421             20  AM-ZIP-PRI-1ST            PIC X.
  1422                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1423             20  FILLER                    PIC X(4).
  1424         16  AM-ZIP-PLUS4                  PIC X(4).
  1425     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1426         16  AM-CAN-POSTAL-1               PIC XXX.
  1427         16  AM-CAN-POSTAL-2               PIC XXX.
  1428         16  FILLER                        PIC XXX.
  1429     12  AM-TEL-NO.
  1430         16  AM-AREA-CODE                  PIC 999.
  1431         16  AM-TEL-PRE                    PIC 999.
  1432         16  AM-TEL-NBR                    PIC 9(4).
  1433     12  AM-TEL-LOC                        PIC X.
  1434         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1435         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1436
  1437     12  AM-COMM-STRUCTURE.
  1438         16  AM-DEFN-1.
  1439             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1440                 24  AM-AGT.
  1441                     28  AM-AGT-PREFIX     PIC X(4).
  1442                     28  AM-AGT-PRIME      PIC X(6).
  1443                 24  AM-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  28
* VP6311.cbl
  1444                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1445                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1446                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1447                 24  AM-RECALC-LV-INDIC    PIC X.
  1448                 24  AM-RETRO-LV-INDIC     PIC X.
  1449                 24  AM-GL-CODES           PIC X.
  1450                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1451                 24  FILLER                PIC X(01).
  1452         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1453             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1454                 24  FILLER                PIC X(11).
  1455                 24  AM-L-COMA             PIC XXX.
  1456                 24  AM-J-COMA             PIC XXX.
  1457                 24  AM-A-COMA             PIC XXX.
  1458                 24  FILLER                PIC X(6).
  1459
  1460     12  AM-COMM-CHANGE-STATUS             PIC X.
  1461         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1462
  1463     12  AM-CSR-CODE                       PIC X(4).
  1464
  1465     12  AM-BILLING-STATUS                 PIC X.
  1466         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1467         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1468     12  AM-AUTO-REFUND-SW                 PIC X.
  1469         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1470         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1471     12  AM-GPCD                           PIC 99.
  1472     12  AM-IG                             PIC X.
  1473         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1474         88  AM-HAS-GROUP                     VALUE '2'.
  1475     12  AM-STATUS                         PIC X.
  1476         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1477         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1478         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1479         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1480         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1481         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1482         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1483         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1484         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1485         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1486     12  AM-REMIT-TO                       PIC 99.
  1487     12  AM-ID-NO                          PIC X(11).
  1488
  1489     12  AM-CAL-TABLE                      PIC XX.
  1490     12  AM-LF-DEVIATION                   PIC XXX.
  1491     12  AM-AH-DEVIATION                   PIC XXX.
  1492     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1493     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1494     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1495     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1496     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1497     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1498
  1499     12  AM-USER-FIELDS.
  1500         16  AM-FLD-1                      PIC XX.
  1501         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  29
* VP6311.cbl
  1502         16  AM-FLD-3                      PIC XX.
  1503         16  AM-FLD-4                      PIC XX.
  1504         16  AM-FLD-5                      PIC XX.
  1505
  1506     12  AM-1ST-PROD-DATE.
  1507         16  AM-1ST-PROD-YR                PIC XX.
  1508         16  AM-1ST-PROD-MO                PIC XX.
  1509         16  AM-1ST-PROD-DA                PIC XX.
  1510     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1511     12  AM-CERTS-PURGED-DATE.
  1512         16  AM-PUR-YR                     PIC XX.
  1513         16  AM-PUR-MO                     PIC XX.
  1514         16  AM-PUR-DA                     PIC XX.
  1515     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1516     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1517     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1518     12  AM-INACTIVE-DATE.
  1519         16  AM-INA-MO                     PIC 99.
  1520         16  AM-INA-DA                     PIC 99.
  1521         16  AM-INA-YR                     PIC 99.
  1522     12  AM-AR-HI-CERT-DATE                PIC XX.
  1523
  1524     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1525     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1526
  1527     12  AM-OB-PAYMENT-MODE                PIC X.
  1528         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1529         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1530         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1531         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1532
  1533     12  AM-AH-ONLY-INDICATOR              PIC X.
  1534         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1535         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1536
  1537     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1538
  1539     12  AM-OVER-SHORT.
  1540         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1541         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1542
  1543     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1544     12  AM-DCC-CLP-STATE                  PIC XX.
  1545
  1546     12  AM-RECALC-COMM                    PIC X.
  1547     12  AM-RECALC-REIN                    PIC X.
  1548
  1549     12  AM-REI-TABLE                      PIC XXX.
  1550     12  AM-REI-ET-LF                      PIC X.
  1551     12  AM-REI-ET-AH                      PIC X.
  1552     12  AM-REI-PE-LF                      PIC X.
  1553     12  AM-REI-PE-AH                      PIC X.
  1554     12  AM-REI-PRT-ST                     PIC X.
  1555     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1556     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1557     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1558     12  AM-REI-GROUP-A                    PIC X(6).
  1559     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  30
* VP6311.cbl
  1560     12  AM-REI-PRT-OW                     PIC X.
  1561     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1562     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1563     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1564     12  AM-REI-GROUP-B                    PIC X(6).
  1565
  1566     12  AM-TRUST-TYPE                     PIC X(2).
  1567
  1568     12  AM-EMPLOYER-STMT-USED             PIC X.
  1569     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1570
  1571     12  AM-STD-AH-TYPE                    PIC XX.
  1572     12  AM-EARN-METHODS.
  1573         16  AM-EARN-METHOD-R              PIC X.
  1574             88 AM-REF-RL-R78                 VALUE 'R'.
  1575             88 AM-REF-RL-PR                  VALUE 'P'.
  1576             88 AM-REF-RL-MEAN                VALUE 'M'.
  1577             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1578         16  AM-EARN-METHOD-L              PIC X.
  1579             88 AM-REF-LL-R78                 VALUE 'R'.
  1580             88 AM-REF-LL-PR                  VALUE 'P'.
  1581             88 AM-REF-LL-MEAN                VALUE 'M'.
  1582             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1583         16  AM-EARN-METHOD-A              PIC X.
  1584             88 AM-REF-AH-R78                 VALUE 'R'.
  1585             88 AM-REF-AH-PR                  VALUE 'P'.
  1586             88 AM-REF-AH-MEAN                VALUE 'M'.
  1587             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1588             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1589             88 AM-REF-AH-NET                 VALUE 'N'.
  1590
  1591     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1592     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1593     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1594
  1595     12  AM-RET-Y-N                        PIC X.
  1596     12  AM-RET-P-E                        PIC X.
  1597     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1598     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1599     12  AM-RET-GRP                        PIC X(6).
  1600     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1601         16  AM-POOL-PRIME                 PIC XXX.
  1602         16  AM-POOL-SUB                   PIC XXX.
  1603     12  AM-RETRO-EARNINGS.
  1604         16  AM-RET-EARN-R                 PIC X.
  1605         16  AM-RET-EARN-L                 PIC X.
  1606         16  AM-RET-EARN-A                 PIC X.
  1607     12  AM-RET-ST-TAX-USE                 PIC X.
  1608         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1609         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1610     12  AM-RETRO-BEG-EARNINGS.
  1611         16  AM-RET-BEG-EARN-R             PIC X.
  1612         16  AM-RET-BEG-EARN-L             PIC X.
  1613         16  AM-RET-BEG-EARN-A             PIC X.
  1614     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1615     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1616
  1617     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  31
* VP6311.cbl
  1618         16  AM-USER-SELECT-1              PIC X(10).
  1619         16  AM-USER-SELECT-2              PIC X(10).
  1620         16  AM-USER-SELECT-3              PIC X(10).
  1621         16  AM-USER-SELECT-4              PIC X(10).
  1622         16  AM-USER-SELECT-5              PIC X(10).
  1623
  1624     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1625
  1626     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1627
  1628     12  AM-RPT045A-SWITCH                 PIC X.
  1629         88  RPT045A-OFF                   VALUE 'N'.
  1630
  1631     12  AM-INSURANCE-LIMITS.
  1632         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1633         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1634
  1635     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1636         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1637
  1638     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1639         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1640         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1641
  1642     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1643
  1644     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1645     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1646     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1647     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1648     12  AM-DCC-UEF-STATE                  PIC XX.
  1649     12  FILLER                            PIC XXX.
  1650     12  AM-REPORT-CODE-3                  PIC X(10).
  1651*    12  FILLER                            PIC X(22).
  1652
  1653     12  AM-RESERVE-DATE.
  1654         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1655         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1656         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1657
  1658     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1659     12  AM-NOTIFICATION-TYPES.
  1660         16  AM-NOTIF-OF-LETTERS           PIC X.
  1661         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1662         16  AM-NOTIF-OF-REPORTS           PIC X.
  1663         16  AM-NOTIF-OF-STATUS            PIC X.
  1664
  1665     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1666         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1667         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1668         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1669         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1670
  1671     12  AM-BENEFIT-CONTROLS.
  1672         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1673             20  AM-BENEFIT-CODE           PIC XX.
  1674             20  AM-BENEFIT-TYPE           PIC X.
  1675             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  32
* VP6311.cbl
  1676             20  AM-BENEFIT-REM-TERM       PIC X.
  1677             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1678             20  FILLER                    PIC XX.
  1679         16  FILLER                        PIC X(80).
  1680
  1681     12  AM-TRANSFER-DATA.
  1682         16  AM-TRANSFERRED-FROM.
  1683             20  AM-TRNFROM-CARRIER        PIC X.
  1684             20  AM-TRNFROM-GROUPING.
  1685                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1686                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1687             20  AM-TRNFROM-STATE          PIC XX.
  1688             20  AM-TRNFROM-ACCOUNT.
  1689                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1690                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1691             20  AM-TRNFROM-DTE            PIC XX.
  1692         16  AM-TRANSFERRED-TO.
  1693             20  AM-TRNTO-CARRIER          PIC X.
  1694             20  AM-TRNTO-GROUPING.
  1695                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1696                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1697             20  AM-TRNTO-STATE            PIC XX.
  1698             20  AM-TRNTO-ACCOUNT.
  1699                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1700                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1701             20  AM-TRNTO-DTE              PIC XX.
  1702         16  FILLER                        PIC X(10).
  1703
  1704     12  AM-SAVED-REMIT-TO                 PIC 99.
  1705
  1706     12  AM-COMM-STRUCTURE-SAVED.
  1707         16  AM-DEFN-1-SAVED.
  1708             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1709                 24  AM-AGT-SV             PIC X(10).
  1710                 24  AM-COM-TYP-SV         PIC X.
  1711                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1712                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1713                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1714                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1715                 24  FILLER                PIC X.
  1716                 24  AM-GL-CODES-SV        PIC X.
  1717                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1718                 24  FILLER                PIC X.
  1719         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1720             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1721                 24  FILLER                PIC X(11).
  1722                 24  AM-L-COMA-SV          PIC XXX.
  1723                 24  AM-J-COMA-SV          PIC XXX.
  1724                 24  AM-A-COMA-SV          PIC XXX.
  1725                 24  FILLER                PIC X(6).
  1726
  1727     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1728         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1729            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1730            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1731            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1732
  1733     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  33
* VP6311.cbl
  1734     12  FILLER                            PIC X(120).
  1735
  1736     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1737         16  AM-CONTROL-NAME               PIC X(30).
  1738         16  AM-EXECUTIVE-ONE.
  1739             20  AM-EXEC1-NAME             PIC X(15).
  1740             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1741                                                          COMP-3.
  1742             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1743                                                          COMP-3.
  1744         16  AM-EXECUTIVE-TWO.
  1745             20  AM-EXEC2-NAME             PIC X(15).
  1746             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1747                                                          COMP-3.
  1748             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1749                                                          COMP-3.
  1750
  1751     12  AM-RETRO-ADDITIONAL-DATA.
  1752         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1753         16  AM-RETRO-PREM-P-E             PIC X.
  1754         16  AM-RETRO-CLMS-P-I             PIC X.
  1755         16  AM-RETRO-RET-BRACKET-LF.
  1756             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1757                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1758                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1759             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1760                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1761                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1762             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1763                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1764                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1765         16  AM-RETRO-RET-BRACKET-AH.
  1766             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1767                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1768                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1769                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1770             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1771                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1772                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1773             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1774                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1775                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1776
  1777     12  AM-COMMENTS.
  1778         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1779
  1780     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1781         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1782         16  AM-FLI-BILLING-CODE           PIC X.
  1783         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1784         16  AM-FLI-UNITED-IDENT           PIC X.
  1785         16  AM-FLI-INTEREST-LOST-DATA.
  1786             20  AM-FLI-BANK-NO            PIC X(5).
  1787             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1788             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1789             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1790         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1791             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  34
* VP6311.cbl
  1792             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1793             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1794         16  FILLER                        PIC X(102).
  1795
  1796     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1797         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1798             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1799             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1800             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1801             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1802             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1803         16  FILLER                          PIC X(10).
  1804******************************************************************
  1805*                                COPY ELCVADS.
  1806******************************************************************
  1807*                                                                *
  1808*                                                                *
  1809*                            ELCVADS.                            *
  1810*                                                                *
  1811*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1812*   ELVADS                  LENGTH = 350                         *
  1813******************************************************************
  1814******************************************************************
  1815*                   C H A N G E   L O G
  1816*
  1817* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1818*-----------------------------------------------------------------
  1819*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1820* EFFECTIVE    NUMBER
  1821*-----------------------------------------------------------------
  1822* 100111    2011022800001  AJRA  NAPERSOFT
  1823******************************************************************
  1824
  1825 01  VIRGINIA-DISCLOSURE.
  1826     12  VD-COMPANY-CD              PIC X.
  1827     12  VD-CARRIER                 PIC X.
  1828     12  VD-GROUPING.
  1829         20  VD-GROUPING-PREFIX     PIC XXX.
  1830         20  VD-GROUPING-PRIME      PIC XXX.
  1831     12  VD-STATE                   PIC XX.
  1832     12  VD-ACCOUNT.
  1833         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1834         20  VD-ACCOUNT-PRIME       PIC X(6).
  1835     12  VD-CERT-EFF-DT             PIC XX.
  1836     12  VD-CERT-NO.
  1837         20  VD-CERT-PRIME          PIC X(10).
  1838         20  VD-CERT-SFX            PIC X.
  1839     12  VD-ENTRY-BATCH             PIC X(6).
  1840     12  VD-CSR-ID                  PIC X(4).
  1841     12  VD-NAME.
  1842         20  VD-INSURED-LAST-NAME   PIC X(15).
  1843         20  VD-INSURED-FIRST-NAME.
  1844             24  VD-INSURED-1ST-INIT PIC X.
  1845             24  FILLER             PIC X(9).
  1846         20  VD-INSURED-MIDDLE-INIT PIC X.
  1847     12  VD-JOINT-INSURED.
  1848         20 VD-JOINT-LAST-NAME      PIC X(15).
  1849         20 VD-JOINT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  35
* VP6311.cbl
  1850            24  VD-JOINT-FIRST-INIT PIC X.
  1851            24  FILLER              PIC X(9).
  1852         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1853     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1854     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1855     12  VD-INSURED-CITY-STATE.
  1856         20  VD-INSURED-CITY        PIC X(28).
  1857         20  VD-INSURED-STATE       PIC XX.
  1858     12  VD-INSURED-ZIP-CODE.
  1859         20  VD-INSURED-ZIP-PRIME.
  1860             24  VD-INSURED-ZIP-1   PIC X.
  1861                 88  VD-CANADIAN-POST-CODE
  1862                                       VALUE 'A' THRU 'Z'.
  1863             24  FILLER             PIC X(4).
  1864         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1865     12  VD-BENEFICIARY-NAME        PIC X(30).
  1866     12  VD-ACCOUNT-NAME            PIC X(30).
  1867     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1868     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1869     12  VD-1ST-PMT-DT              PIC XX.
  1870     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1871         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1872         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1873                                             '90' THRU '99'.
  1874     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1875                                    PIC XX.
  1876     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1877     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1878     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1879     12  VD-LF-TERM                 PIC S999   COMP-3.
  1880     12  VD-AH-BENEFIT-CD           PIC XX.
  1881         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1882         88  VD-INVALID-AH             VALUE '  ' '00'
  1883                                             '90' THRU '99'.
  1884     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1885     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1886     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1887     12  VD-AH-TERM                 PIC S999   COMP-3.
  1888     12  VD-LETTER-ID               PIC X(4).
  1889     12  VD-PROC-ID                 PIC X(4).
  1890     12  VD-COMP-ID                 PIC X(3).
  1891     12  VD-CURRENT-DATE            PIC XX.
  1892     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1893     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1894     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  36
* VP6311.cbl
  1896*    COPY ELCDATE.
  1897******************************************************************
  1898*                                                                *
  1899*                                                                *
  1900*                            ELCDATE.                            *
  1901*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1902*                            VMOD=2.003
  1903*                                                                *
  1904*                                                                *
  1905*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1906*                 LENGTH = 200                                   *
  1907******************************************************************
  1908
  1909 01  DATE-CONVERSION-DATA.
  1910     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1911     12  DC-OPTION-CODE                PIC X.
  1912         88  BIN-TO-GREG                VALUE ' '.
  1913         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1914         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1915         88  YMD-GREG-TO-BIN            VALUE '3'.
  1916         88  MDY-GREG-TO-BIN            VALUE '4'.
  1917         88  JULIAN-TO-BIN              VALUE '5'.
  1918         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1919         88  FIND-CENTURY               VALUE '7'.
  1920         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1921         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1922         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1923         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1924         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1925         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1926         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1927         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1928         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1929         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1930         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1931         88  BIN-3-TO-GREG              VALUE 'I'.
  1932         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1933         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1934         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1935         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1936         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1937         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1938         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1939         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1940         88  THREE-CHARACTER-BIN
  1941                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1942         88  GREGORIAN-TO-BIN
  1943                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1944         88  BIN-TO-GREGORIAN
  1945                  VALUES ' ' '1' 'I' '8' 'G'.
  1946         88  JULIAN-TO-BINARY
  1947                  VALUES '5' 'C' 'E' 'F'.
  1948     12  DC-ERROR-CODE                 PIC X.
  1949         88  NO-CONVERSION-ERROR        VALUE ' '.
  1950         88  DATE-CONVERSION-ERROR
  1951                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1952         88  DATE-IS-ZERO               VALUE '1'.
  1953         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  37
* VP6311.cbl
  1954         88  DATE-IS-INVALID            VALUE '3'.
  1955         88  DATE1-GREATER-DATE2        VALUE '4'.
  1956         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1957         88  DATE-INVALID-OPTION        VALUE '9'.
  1958         88  INVALID-CENTURY            VALUE 'A'.
  1959         88  ONLY-CENTURY               VALUE 'B'.
  1960         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1961         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1962     12  DC-END-OF-MONTH               PIC X.
  1963         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1964     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1965         88  USE-NORMAL-PROCESS         VALUE ' '.
  1966         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1967         88  ADJUST-UP-100-YRS          VALUE '2'.
  1968     12  FILLER                        PIC X.
  1969     12  DC-CONVERSION-DATES.
  1970         16  DC-BIN-DATE-1             PIC XX.
  1971         16  DC-BIN-DATE-2             PIC XX.
  1972         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1973         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1974                       DC-GREG-DATE-1-EDIT.
  1975             20  DC-EDIT1-MONTH        PIC 99.
  1976             20  SLASH1-1              PIC X.
  1977             20  DC-EDIT1-DAY          PIC 99.
  1978             20  SLASH1-2              PIC X.
  1979             20  DC-EDIT1-YEAR         PIC 99.
  1980         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1981         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1982                     DC-GREG-DATE-2-EDIT.
  1983             20  DC-EDIT2-MONTH        PIC 99.
  1984             20  SLASH2-1              PIC X.
  1985             20  DC-EDIT2-DAY          PIC 99.
  1986             20  SLASH2-2              PIC X.
  1987             20  DC-EDIT2-YEAR         PIC 99.
  1988         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1989         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1990                     DC-GREG-DATE-1-YMD.
  1991             20  DC-YMD-YEAR           PIC 99.
  1992             20  DC-YMD-MONTH          PIC 99.
  1993             20  DC-YMD-DAY            PIC 99.
  1994         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1995         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1996                      DC-GREG-DATE-1-MDY.
  1997             20  DC-MDY-MONTH          PIC 99.
  1998             20  DC-MDY-DAY            PIC 99.
  1999             20  DC-MDY-YEAR           PIC 99.
  2000         16  DC-GREG-DATE-1-ALPHA.
  2001             20  DC-ALPHA-MONTH        PIC X(10).
  2002             20  DC-ALPHA-DAY          PIC 99.
  2003             20  FILLER                PIC XX.
  2004             20  DC-ALPHA-CENTURY.
  2005                 24 DC-ALPHA-CEN-N     PIC 99.
  2006             20  DC-ALPHA-YEAR         PIC 99.
  2007         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2008         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2009         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2010         16  DC-JULIAN-DATE            PIC 9(05).
  2011         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  38
* VP6311.cbl
  2012                                       PIC 9(05).
  2013         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2014             20  DC-JULIAN-YEAR        PIC 99.
  2015             20  DC-JULIAN-DAYS        PIC 999.
  2016         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2017         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2018         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2019     12  DATE-CONVERSION-VARIBLES.
  2020         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2021         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2022             20  FILLER                PIC 9(3).
  2023             20  HOLD-CEN-1-CCYY.
  2024                 24  HOLD-CEN-1-CC     PIC 99.
  2025                 24  HOLD-CEN-1-YY     PIC 99.
  2026             20  HOLD-CEN-1-MO         PIC 99.
  2027             20  HOLD-CEN-1-DA         PIC 99.
  2028         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2029             20  HOLD-CEN-1-R-MO       PIC 99.
  2030             20  HOLD-CEN-1-R-DA       PIC 99.
  2031             20  HOLD-CEN-1-R-CCYY.
  2032                 24  HOLD-CEN-1-R-CC   PIC 99.
  2033                 24  HOLD-CEN-1-R-YY   PIC 99.
  2034             20  FILLER                PIC 9(3).
  2035         16  HOLD-CENTURY-1-X.
  2036             20  FILLER                PIC X(3)  VALUE SPACES.
  2037             20  HOLD-CEN-1-X-CCYY.
  2038                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2039                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2040             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2041             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2042         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2043             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2044             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2045             20  HOLD-CEN-1-R-X-CCYY.
  2046                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2047                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2048             20  FILLER                PIC XXX.
  2049         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2050         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2051         16  DC-JULIAN-DATE-1          PIC 9(07).
  2052         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2053             20  DC-JULIAN-1-CCYY.
  2054                 24  DC-JULIAN-1-CC    PIC 99.
  2055                 24  DC-JULIAN-1-YR    PIC 99.
  2056             20  DC-JULIAN-DA-1        PIC 999.
  2057         16  DC-JULIAN-DATE-2          PIC 9(07).
  2058         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2059             20  DC-JULIAN-2-CCYY.
  2060                 24  DC-JULIAN-2-CC    PIC 99.
  2061                 24  DC-JULIAN-2-YR    PIC 99.
  2062             20  DC-JULIAN-DA-2        PIC 999.
  2063         16  DC-GREG-DATE-A-EDIT.
  2064             20  DC-EDITA-MONTH        PIC 99.
  2065             20  SLASHA-1              PIC X VALUE '/'.
  2066             20  DC-EDITA-DAY          PIC 99.
  2067             20  SLASHA-2              PIC X VALUE '/'.
  2068             20  DC-EDITA-CCYY.
  2069                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  39
* VP6311.cbl
  2070                 24  DC-EDITA-YEAR     PIC 99.
  2071         16  DC-GREG-DATE-B-EDIT.
  2072             20  DC-EDITB-MONTH        PIC 99.
  2073             20  SLASHB-1              PIC X VALUE '/'.
  2074             20  DC-EDITB-DAY          PIC 99.
  2075             20  SLASHB-2              PIC X VALUE '/'.
  2076             20  DC-EDITB-CCYY.
  2077                 24  DC-EDITB-CENT     PIC 99.
  2078                 24  DC-EDITB-YEAR     PIC 99.
  2079         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2080         16  DC-GREG-DATE-CYMD-R REDEFINES
  2081                              DC-GREG-DATE-CYMD.
  2082             20  DC-CYMD-CEN           PIC 99.
  2083             20  DC-CYMD-YEAR          PIC 99.
  2084             20  DC-CYMD-MONTH         PIC 99.
  2085             20  DC-CYMD-DAY           PIC 99.
  2086         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2087         16  DC-GREG-DATE-MDCY-R REDEFINES
  2088                              DC-GREG-DATE-MDCY.
  2089             20  DC-MDCY-MONTH         PIC 99.
  2090             20  DC-MDCY-DAY           PIC 99.
  2091             20  DC-MDCY-CEN           PIC 99.
  2092             20  DC-MDCY-YEAR          PIC 99.
  2093    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2094        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2095    12  DC-EL310-DATE                  PIC X(21).
  2096    12  FILLER                         PIC X(28).
  2097
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  40
* VP6311.cbl
  2099*    COPY ELCLOGOF.
  2100******************************************************************
  2101*                                                                *
  2102*                                                                *
  2103*                            ELCLOGOF.                           *
  2104*                            VMOD=2.001                          *
  2105*                                                                *
  2106*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2107*                                                                *
  2108******************************************************************
  2109 01  CLASIC-LOGOFF.
  2110     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2111     12  LOGOFF-TEXT.
  2112         16  FILLER          PIC X(5)    VALUE SPACES.
  2113         16  LOGOFF-MSG.
  2114             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2115             20  FILLER      PIC X       VALUE SPACES.
  2116             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2117         16  FILLER          PIC X(80)
  2118           VALUE '* YOU ARE NOW LOGGED OFF'.
  2119         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2120         16  FILLER          PIC X       VALUE QUOTE.
  2121         16  LOGOFF-SYS-MSG  PIC X(17)
  2122           VALUE 'S CLAS-IC SYSTEM '.
  2123     12  TEXT-MESSAGES.
  2124         16  UNACCESS-MSG    PIC X(29)
  2125             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2126         16  PGMIDERR-MSG    PIC X(17)
  2127             VALUE 'PROGRAM NOT FOUND'.
  2128
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  41
* VP6311.cbl
  2130*    COPY ELCATTR.
  2131******************************************************************
  2132*                                                                *
  2133*                            ELCATTR.                            *
  2134*                            VMOD=2.001                          *
  2135*                                                                *
  2136*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2137*                                                                *
  2138*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2139*                                                                *
  2140*                   POS 1   P=PROTECTED                          *
  2141*                           U=UNPROTECTED                        *
  2142*                           S=ASKIP                              *
  2143*                   POS 2   A=ALPHA/NUMERIC                      *
  2144*                           N=NUMERIC                            *
  2145*                   POS 3   N=NORMAL                             *
  2146*                           B=BRIGHT                             *
  2147*                           D=DARK                               *
  2148*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2149*                           OF=MODIFIED DATA TAG OFF             *
  2150*                                                                *
  2151*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2152******************************************************************
  2153 01  ATTRIBUTE-LIST.
  2154     12  AL-PABOF            PIC X       VALUE 'Y'.
  2155     12  AL-PABON            PIC X       VALUE 'Z'.
  2156     12  AL-PADOF            PIC X       VALUE '%'.
  2157     12  AL-PADON            PIC X       VALUE '_'.
  2158     12  AL-PANOF            PIC X       VALUE '-'.
  2159     12  AL-PANON            PIC X       VALUE '/'.
  2160     12  AL-SABOF            PIC X       VALUE '8'.
  2161     12  AL-SABON            PIC X       VALUE '9'.
  2162     12  AL-SADOF            PIC X       VALUE '@'.
  2163     12  AL-SADON            PIC X       VALUE QUOTE.
  2164     12  AL-SANOF            PIC X       VALUE '0'.
  2165     12  AL-SANON            PIC X       VALUE '1'.
  2166     12  AL-UABOF            PIC X       VALUE 'H'.
  2167     12  AL-UABON            PIC X       VALUE 'I'.
  2168     12  AL-UADOF            PIC X       VALUE '<'.
  2169     12  AL-UADON            PIC X       VALUE '('.
  2170     12  AL-UANOF            PIC X       VALUE ' '.
  2171     12  AL-UANON            PIC X       VALUE 'A'.
  2172     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2173     12  AL-UNBON            PIC X       VALUE 'R'.
  2174     12  AL-UNDOF            PIC X       VALUE '*'.
  2175     12  AL-UNDON            PIC X       VALUE ')'.
  2176     12  AL-UNNOF            PIC X       VALUE '&'.
  2177     12  AL-UNNON            PIC X       VALUE 'J'.
  2178
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  42
* VP6311.cbl
  2180*    COPY ELCEMIB.
  2181******************************************************************
  2182*                                                                *
  2183*                                                                *
  2184*                            ELCEMIB.                            *
  2185*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2186*                            VMOD=2.005                          *
  2187*                                                                *
  2188*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2189*                                                                *
  2190******************************************************************
  2191 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2192     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2193     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2194     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2195     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2196     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2197     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2198     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2199     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2200     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2201         88  EMI-NO-ERRORS                    VALUE '1'.
  2202         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2203         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2204     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2205         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2206     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2207         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2208         88  EMI-AREA1-FULL                   VALUE '2'.
  2209     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2210         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2211         88  EMI-AREA2-FULL                   VALUE '2'.
  2212     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2213         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2214         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2215         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2216         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2217         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2218     12  EMI-ERROR-LINES.
  2219         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2220         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2221         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2222         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2223             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2224                 24  EMI-ERR-NUM         PIC X(4).
  2225                 24  EMI-FILLER          PIC X.
  2226                 24  EMI-SEV             PIC X.
  2227                 24  FILLER              PIC X.
  2228             20  FILLER                  PIC X(02).
  2229     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2230         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2231             20  EMI-ERROR-NUMBER    PIC X(4).
  2232             20  EMI-FILL            PIC X.
  2233             20  EMI-SEVERITY        PIC X.
  2234             20  FILLER              PIC X.
  2235             20  EMI-ERROR-TEXT.
  2236                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2237                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  43
* VP6311.cbl
  2238     12  EMI-SEVERITY-SAVE           PIC X.
  2239         88  EMI-NOTE                    VALUE 'N'.
  2240         88  EMI-WARNING                 VALUE 'W'.
  2241         88  EMI-FORCABLE                VALUE 'F'.
  2242         88  EMI-FATAL                   VALUE 'X'.
  2243     12  EMI-MESSAGE-FLAG            PIC X.
  2244         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2245         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2246     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2247     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2248         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2249         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2250         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2251     12  emi-claim-no                pic x(7).
  2252     12  emi-claim-type              pic x(6).
  2253     12  FILLER                      PIC X(124)  VALUE SPACES.
  2254     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2255     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2256     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2257     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2258
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  44
* VP6311.cbl
  2260*    COPY ELCINTF.
  2261******************************************************************
  2262*                                                                *
  2263*                                                                *
  2264*                            ELCINTF.                            *
  2265*                            VMOD=2.017                          *
  2266*                                                                *
  2267*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2268*                                                                *
  2269*       LENGTH = 1024                                            *
  2270*                                                                *
  2271******************************************************************
  2272*                   C H A N G E   L O G
  2273*
  2274* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2275*-----------------------------------------------------------------
  2276*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2277* EFFECTIVE    NUMBER
  2278*-----------------------------------------------------------------
  2279* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2280******************************************************************
  2281 01  PROGRAM-INTERFACE-BLOCK.
  2282     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2283     12  PI-CALLING-PROGRAM              PIC X(8).
  2284     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2285     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2286     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2287     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2288     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2289     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2290     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2291     12  PI-COMPANY-ID                   PIC XXX.
  2292     12  PI-COMPANY-CD                   PIC X.
  2293
  2294     12  PI-COMPANY-PASSWORD             PIC X(8).
  2295
  2296     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2297
  2298     12  PI-CONTROL-IN-PROGRESS.
  2299         16  PI-CARRIER                  PIC X.
  2300         16  PI-GROUPING                 PIC X(6).
  2301         16  PI-STATE                    PIC XX.
  2302         16  PI-ACCOUNT                  PIC X(10).
  2303         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2304                                         PIC X(10).
  2305         16  PI-CLAIM-CERT-GRP.
  2306             20  PI-CLAIM-NO             PIC X(7).
  2307             20  PI-CERT-NO.
  2308                 25  PI-CERT-PRIME       PIC X(10).
  2309                 25  PI-CERT-SFX         PIC X.
  2310             20  PI-CERT-EFF-DT          PIC XX.
  2311         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2312             20  PI-PLAN-CODE            PIC X(2).
  2313             20  PI-REVISION-NUMBER      PIC X(3).
  2314             20  PI-PLAN-EFF-DT          PIC X(2).
  2315             20  PI-PLAN-EXP-DT          PIC X(2).
  2316             20  FILLER                  PIC X(11).
  2317         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  45
* VP6311.cbl
  2318             20  PI-OE-REFERENCE-1.
  2319                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2320                 25  PI-OE-REF-1-SUFF    PIC XX.
  2321
  2322     12  PI-SESSION-IN-PROGRESS          PIC X.
  2323         88  CLAIM-SESSION                   VALUE '1'.
  2324         88  CREDIT-SESSION                  VALUE '2'.
  2325         88  WARRANTY-SESSION                VALUE '3'.
  2326         88  MORTGAGE-SESSION                VALUE '4'.
  2327         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2328
  2329
  2330*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2331
  2332     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2333     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2334
  2335     12  PI-CREDIT-USER                  PIC X.
  2336         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2337         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2338
  2339     12  PI-CLAIM-USER                   PIC X.
  2340         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2341         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2342
  2343     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2344         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2345         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2346         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2347         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2348         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2349
  2350     12  PI-PROCESSOR-ID                 PIC X(4).
  2351
  2352     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2353
  2354     12  PI-MEMBER-CAPTION               PIC X(10).
  2355
  2356     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2357         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2358
  2359     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2360     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2361     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2362     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2363
  2364     12  PI-AH-OVERRIDE-L1               PIC X.
  2365     12  PI-AH-OVERRIDE-L2               PIC XX.
  2366     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2367     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2368
  2369     12  PI-NEW-SYSTEM                   PIC X(2).
  2370
  2371     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2372     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2373         88  PI-USES-PAID-TO                 VALUE '1'.
  2374     12  PI-CRDTCRD-SYSTEM.
  2375         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  46
* VP6311.cbl
  2376             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2377             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2378         16  PI-CC-MONTH-END-DT          PIC XX.
  2379     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2380
  2381     12  PI-OE-REFERENCE-2.
  2382         16  PI-OE-REF-2-PRIME           PIC X(10).
  2383         16  PI-OE-REF-2-SUFF            PIC X.
  2384
  2385     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2386
  2387     12  PI-LANGUAGE-TYPE                PIC X.
  2388             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2389             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2390             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2391
  2392     12  PI-POLICY-LINKAGE-IND           PIC X.
  2393         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2394         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2395                                                   LOW-VALUES.
  2396
  2397     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2398     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2399         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2400         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2401
  2402     12  PI-PROCESSOR-CSR-IND            PIC X.
  2403         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2404         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2405
  2406     12  FILLER                          PIC X(3).
  2407
  2408     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2409
  2410     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2411         PI-SYSTEM-LEVEL.
  2412
  2413         16  PI-ENTRY-CODES.
  2414             20  PI-ENTRY-CD-1           PIC X.
  2415             20  PI-ENTRY-CD-2           PIC X.
  2416
  2417         16  PI-RETURN-CODES.
  2418             20  PI-RETURN-CD-1          PIC X.
  2419             20  PI-RETURN-CD-2          PIC X.
  2420
  2421         16  PI-UPDATE-STATUS-SAVE.
  2422             20  PI-UPDATE-BY            PIC X(4).
  2423             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2424
  2425         16  PI-LOWER-CASE-LETTERS       PIC X.
  2426             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2427
  2428*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2429*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2430*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2431
  2432         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2433             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  47
* VP6311.cbl
  2434             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2435             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2436             88  ACCNT-CNTL                  VALUE '3'.
  2437             88  CARR-ACCNT-CNTL             VALUE '4'.
  2438
  2439         16  PI-PROCESSOR-CAP-LIST.
  2440             20  PI-SYSTEM-CONTROLS.
  2441                24 PI-SYSTEM-DISPLAY     PIC X.
  2442                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2443                24 PI-SYSTEM-MODIFY      PIC X.
  2444                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2445             20  FILLER                  PIC XX.
  2446             20  PI-DISPLAY-CAP          PIC X.
  2447                 88  DISPLAY-CAP             VALUE 'Y'.
  2448             20  PI-MODIFY-CAP           PIC X.
  2449                 88  MODIFY-CAP              VALUE 'Y'.
  2450             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2451                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2452             20  PI-FORCE-CAP            PIC X.
  2453                 88  FORCE-CAP               VALUE 'Y'.
  2454
  2455         16  PI-PROGRAM-CONTROLS.
  2456             20  PI-PGM-PRINT-OPT        PIC X.
  2457             20  PI-PGM-FORMAT-OPT       PIC X.
  2458             20  PI-PGM-PROCESS-OPT      PIC X.
  2459             20  PI-PGM-TOTALS-OPT       PIC X.
  2460
  2461         16  PI-HELP-INTERFACE.
  2462             20  PI-LAST-ERROR-NO        PIC X(4).
  2463             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2464
  2465         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2466             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2467
  2468         16  PI-CR-CONTROL-IN-PROGRESS.
  2469             20  PI-CR-CARRIER           PIC X.
  2470             20  PI-CR-GROUPING          PIC X(6).
  2471             20  PI-CR-STATE             PIC XX.
  2472             20  PI-CR-ACCOUNT           PIC X(10).
  2473             20  PI-CR-FIN-RESP          PIC X(10).
  2474             20  PI-CR-TYPE              PIC X.
  2475
  2476         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2477
  2478         16  PI-CR-MONTH-END-DT          PIC XX.
  2479
  2480         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2481             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2482             88  PI-ZERO-CARRIER             VALUE '1'.
  2483             88  PI-ZERO-GROUPING            VALUE '2'.
  2484             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2485
  2486         16  PI-CARRIER-SECURITY         PIC X.
  2487             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2488
  2489         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2490             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2491             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  48
* VP6311.cbl
  2492
  2493         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2494             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2495                                         INDEXED BY PI-ACCESS-NDX
  2496                                         PIC X.
  2497
  2498         16  PI-GA-BILLING-CONTROL       PIC X.
  2499             88  PI-GA-BILLING               VALUE '1'.
  2500
  2501         16  PI-MAIL-PROCESSING          PIC X.
  2502             88  PI-MAIL-YES                 VALUE 'Y'.
  2503
  2504         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2505
  2506         16  PI-AR-SYSTEM.
  2507             20  PI-AR-PROCESSING-CNTL   PIC X.
  2508                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2509             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2510             20  PI-AR-MONTH-END-DT      PIC XX.
  2511
  2512         16  PI-MP-SYSTEM.
  2513             20  PI-MORTGAGE-USER            PIC X.
  2514                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2515                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2516             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2517                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2518                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2519                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2520                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2521                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2522             20  PI-MP-MONTH-END-DT          PIC XX.
  2523             20  PI-MP-REFERENCE-NO.
  2524                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2525                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2526
  2527         16  PI-LABEL-CONTROL            PIC X(01).
  2528             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2529             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2530
  2531         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2532             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2533
  2534         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2535             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2536             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2537
  2538         16  FILLER                      PIC X(14).
  2539
  2540     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2541******************************************************************
  2542
  2543     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2544*    COPY ELC631PI.
  2545******************************************************************
  2546*                                                                *
  2547*                                                                *
  2548*                            ELC631PI                            *
  2549*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  49
* VP6311.cbl
  2550*                                                                *
  2551*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2552*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2553*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2554*                                                                *
  2555*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2556*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2557*    BETWEEN PROGRAMS.                                           *
  2558*                                                                *
  2559*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2560*                                                                *
  2561*               EL631 - EL6311 - EL6312 - EL6313                 *
  2562*                                                                *
  2563******************************************************************
  2564*                   C H A N G E   L O G
  2565*
  2566* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2567*-----------------------------------------------------------------
  2568*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2569* EFFECTIVE    NUMBER
  2570*-----------------------------------------------------------------
  2571* 021414    2003053000001  PEMA  changes for auto chk request
  2572******************************************************************
  2573
  2574         16  PI-631-DATA.
  2575             20  PI-ERPNDB-KEY.
  2576                 24  PI-PB-COMPANY-CD     PIC X.
  2577                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2578                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2579                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2580
  2581             20  PI-ERPNDB-ALT-KEY.
  2582                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2583                 24  PI-PB-CARRIER        PIC X.
  2584                 24  PI-PB-GROUPING       PIC X(6).
  2585                 24  PI-PB-STATE          PIC XX.
  2586                 24  PI-PB-ACCOUNT        PIC X(10).
  2587                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2588                 24  PI-PB-CERT-NO.
  2589                     28  PI-PB-CERT-PRIME PIC X(10).
  2590                     28  PI-PB-CERT-SFX   PIC X.
  2591                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2592                 24  PI-PB-RECORD-TYPE    PIC X.
  2593
  2594             20  PI-ERPNDB-CSR-KEY.
  2595                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2596                 24  PI-PB-CSR-ID             PIC X(4).
  2597                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2598                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2599                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2600
  2601             20  PI-BROWSE-TYPE               PIC X.
  2602                 88  PI-FILE-BROWSE             VALUE ' '.
  2603                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2604                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2605                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2606                 88  PI-CSR-BROWSE              VALUE '4'.
  2607
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  50
* VP6311.cbl
  2608             20  PI-MAINT-FUNCTION            PIC X.
  2609                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2610                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2611                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2612                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2613                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2614                 88  PI-PF5-FUNCTION            VALUE '5'.
  2615                 88  PI-PF6-FUNCTION            VALUE '6'.
  2616
  2617             20  PI-FILE-SWITCHES.
  2618                 24  PI-ALL-ISSUES-SW         PIC X.
  2619                     88  ALL-ISSUES             VALUE 'Y'.
  2620                 24  PI-ALL-CANCELS-SW        PIC X.
  2621                     88  ALL-CANCELS            VALUE 'Y'.
  2622                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2623                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2624                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2625                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2626                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2627                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2628                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2629                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2630                 24  PI-HOLD-REC-SW           PIC X.
  2631                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2632                 24  PI-CHANGE-REC-SW         PIC X.
  2633                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2634                 24  PI-CHK-REQ-REC-SW        PIC X.
  2635                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2636                 24  PI-ISSUE-WARNING-SW      PIC X.
  2637                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2638                 24  PI-CANCEL-WARNING-SW     PIC X.
  2639                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2640             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2641                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2642             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2643                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2644
  2645             20  PI-MAP-NAME                  PIC X(8).
  2646
  2647             20  PI-CURSOR                    PIC S9(4) COMP.
  2648
  2649             20  PI-PREV-ALT-KEY              PIC X(36).
  2650             20  PI-PREV-CSR-KEY              PIC X(15).
  2651             20  PI-PREV-KEY.
  2652                 24  PI-PREV-COMPANY-CD       PIC X.
  2653                 24  PI-PREV-BATCH            PIC X(6).
  2654                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2655                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2656             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2657             20  PI-BROWSE-SW                 PIC X.
  2658                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2659                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2660             20  PI-SV-CARRIER                PIC X.
  2661             20  PI-SV-GROUPING               PIC X(6).
  2662             20  PI-SV-STATE                  PIC XX.
  2663             20  PI-EDIT-SW                   PIC X.
  2664             20  PI-DISPLAY-SW                PIC XX.
  2665                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  51
* VP6311.cbl
  2666                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2667             20  PI-CRITERIA-DATA             PIC X(350).
  2668             20  PI-BMODE                     PIC X.
  2669             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2670             20  PI-BPMTS                     PIC S999     COMP-3.
  2671             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2672             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2673             20  PI-CSR-SESSION-SW            PIC X.
  2674                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2675             20  PI-ERRORS-SW                 PIC X.
  2676                 88  FATAL-ERRORS               VALUE 'X'.
  2677*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2678             20  pi-unforced-sw               pic x.
  2679                 88  unforced-errors            value 'X'.
  2680             20  FILLER                       PIC X(4).
  2681
  2682        16  FILLER             PIC X(94).
  2683
  2684 01  W-LETTER-COMMUNICATION-AREAS.
  2685*    COPY ELC1042.
  2686******************************************************************
  2687*                                                                *
  2688*                                                                *
  2689*                           ELC1042                              *
  2690*                            VMOD=2.002                          *
  2691*                                                                *
  2692*    NOTE                                                        *
  2693*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2694*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2695*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2696*        TO THESE PROGRAMS.                                      *
  2697*                                                                *
  2698*    NOTE                                                        *
  2699*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2700*        USE ONLY!                                               *
  2701*                                                                *
  2702******************************************************************
  2703
  2704         16  PI-1042-WA.
  2705             20  PI-ACTION       PIC  X(01).
  2706                 88 PI-SHOW-MODE           VALUE '1'.
  2707                 88 PI-CLEAR-MODE          VALUE '2'.
  2708                 88 PI-CREATE-MODE         VALUE '3'.
  2709             20  PI-COMM-CONTROL PIC  X(12).
  2710             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2711             20  PI-EOF-SW       PIC  X(01).
  2712                 88  PI-FILE-EOF           VALUE 'Y'.
  2713             20  PI-FILETYP      PIC  X(01).
  2714             20  PI-FORM-SQUEEZE-CONTROL
  2715                                 PIC  X(01).
  2716                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2717                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2718             20  PI-LAST-CONTROL PIC  X(12).
  2719             20  PI-TEMP-STOR-ITEMS
  2720                                 PIC S9(04) COMP.
  2721             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2722             20  PI-UPDATE-SW    PIC  9(01).
  2723                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  52
* VP6311.cbl
  2724             20  PI-104-SCREEN-SENT-IND
  2725                                 PIC  X(01).
  2726                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2727                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2728             20  PI-1042-SCREEN-SENT-IND
  2729                                 PIC  X(01).
  2730                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2731                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2732             20  PI-1042-ARCHIVE-IND
  2733                                 PIC  X(01).
  2734                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2735             20  FILLER          PIC  X(29).
  2736*    COPY ELC689PI.
  2737******************************************************************
  2738*                                                                *
  2739*                            ELC689PI                            *
  2740*                            VMOD=2.003                          *
  2741*                                                                *
  2742*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2743*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2744*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2745*                                                                *
  2746*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2747*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2748*    BETWEEN PROGRAMS.                                           *
  2749*                                                                *
  2750*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2751*                                                                *
  2752*               EL631 - EL689  - EL6891 - EL6892                 *
  2753*                                                                *
  2754******************************************************************
  2755*                   C H A N G E   L O G
  2756*
  2757* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2758*-----------------------------------------------------------------
  2759*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2760* EFFECTIVE    NUMBER
  2761*-----------------------------------------------------------------
  2762* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2763* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2764* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2765******************************************************************
  2766
  2767
  2768         16  PI-689-WORK-AREA.
  2769             20  PI-689-ALT-PRINTER-ID
  2770                                 PIC  X(04).
  2771             20  PI-689-ARCHIVE-NUMBER
  2772                                 PIC  9(08).
  2773             20  PI-689-ARCHIVE-SW
  2774                                 PIC  X(01).
  2775                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2776             20  PI-689-DATA-SOURCE
  2777                                 PIC  X(01).
  2778                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2779                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2780                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2781                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  53
* VP6311.cbl
  2782                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2783             20  PI-689-ERROR-IND
  2784                                 PIC  X(01).
  2785                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2786             20  PI-689-ERROR    PIC  9(04).
  2787                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2788                 88  PI-689-FATAL-ERROR
  2789                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2790                            0042 0047 0051 0066 0067 0070
  2791                            0168 0169 0174 0175 0176 0177 0179
  2792                            0180 0181 0182 0184 0185 0189 0190
  2793                            0191
  2794                            0215 0279 0280
  2795                            0412 0413 0454
  2796                            0533 0537
  2797                            2055 2114 2208 2209 2216 2232 2369
  2798                            2398 2433 2908 2999
  2799                            3000 3770 3771 3775
  2800                            7250 7365 7367 7368 7369 7370 7371
  2801                            7272 7373 7374 7376 7377 7378 7379
  2802                            7381 7388 7390 7393 7395 7396 7398
  2803                            9095 9096 9281 9298 9299 9320 9327
  2804                            9426 9427.
  2805                 88  PI-689-STOP-ERROR
  2806                     VALUES 0004 0008 0013 0023 0029 0033
  2807                            0042 0047 0066 0067 0070
  2808                            0168 0169 0174 0175 0176 0177
  2809                            0181 0182 0184 0185 0189 0190
  2810                            0279 0280
  2811                            0412 0413 0454
  2812                            2055 2208 2209 2216 2232
  2813                            2398 2999
  2814                            3000 3770 3771 3775
  2815                            7250 7365 7369 7370 7371
  2816                            7272 7373 7374 7376 7377 7378 7379
  2817                            7381 7388 7390 7393 7396 7398
  2818                            9095 9096 9299 9320 9426.
  2819             20  PI-689-FOLLOW-UP-DATE
  2820                                 PIC  X(02).
  2821             20  PI-689-FORM-NUMBER
  2822                                 PIC  X(04).
  2823             20  PI-689-LABEL-SOURCE
  2824                                 PIC X(01).
  2825                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2826                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2827                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2828                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2829                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2830                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2831                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2832             20  PI-689-NUMBER-COPIES
  2833                                 PIC  9(01).
  2834             20  PI-689-NUMBER-LABEL-LINES
  2835                                 PIC  9(01).
  2836             20  PI-689-NUMBER-TEXT-RECORDS
  2837                                 PIC  9(03).
  2838             20  PI-689-PRINT-ORDER-SW
  2839                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  54
* VP6311.cbl
  2840                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2841                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2842                 88  PI-689-PRINT-LATER     VALUE '3'.
  2843                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2844             20  PI-689-PRINT-RESTRICTION
  2845                                 PIC  X(01).
  2846                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2847                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2848                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2849             20  PI-689-PRINT-SW PIC  X(01).
  2850                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2851             20  PI-689-RESEND-DATE-1
  2852                                 PIC  X(02).
  2853             20  PI-689-RESEND-LETR-1
  2854                                 PIC X(4).
  2855             20  PI-689-TEMP-STOR-ID
  2856                                 PIC  X(08).
  2857             20  PI-689-USE-SCREEN-IND
  2858                                 PIC  X(01).
  2859                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2860             20  PI-689-ARCH-POINTER
  2861                                 PIC S9(08) COMP.
  2862                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2863             20  PI-689-ARCT-POINTER
  2864                                 PIC S9(08) COMP.
  2865                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2866             20  PI-689-VARIABLE-DATA-GRP.
  2867                 24  PI-689-VARIABLE-DATA-1
  2868                                 PIC  X(30).
  2869                 24  PI-689-VARIABLE-DATA-2
  2870                                 PIC  X(30).
  2871                 24  PI-689-VARIABLE-DATA-3
  2872                                 PIC  X(30).
  2873                 24  PI-689-VARIABLE-DATA-4
  2874                                 PIC  X(30).
  2875
  2876         16  PI-689-KEY-DATA-FIELDS.
  2877             20  PI-689-ACCOUNT  PIC  X(10).
  2878             20  PI-689-CARRIER  PIC  X(01).
  2879             20  PI-689-CERT-NO.
  2880                 24  PI-689-CERT-PRIME
  2881                                 PIC  X(10).
  2882                 24  PI-689-CERT-SFX
  2883                                 PIC  X(01).
  2884             20  PI-689-CHG-SEQ-NO
  2885                                 PIC S9(04)    COMP.
  2886             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2887                                 PIC  X(02).
  2888             20  PI-689-ENTRY-BATCH
  2889                                 PIC  X(06).
  2890             20  PI-689-EFF-DATE PIC  X(02).
  2891             20  PI-689-EXP-DATE PIC  X(02).
  2892             20  PI-689-GROUPING PIC  X(06).
  2893             20  PI-689-RESP-PERSON
  2894                                 PIC  X(10).
  2895             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2896             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2897                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  55
* VP6311.cbl
  2898             20  PI-689-STATE    PIC  X(02).
  2899             20  PI-689-TYPE     PIC  X(01).
  2900             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2901             20  PI-689-ALT-SEQ-NO
  2902                                 PIC S9(04)    COMP.
  2903         16  PI-689-DATE-EDIT    PIC  X(08).
  2904         16  PI-689-FOLLOW-UP-EDIT
  2905                                 PIC  X(08).
  2906         16  PI-689-RESEND1-EDIT PIC  X(08).
  2907         16  PI-689-SEQ-EDIT     PIC  X(08).
  2908         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2909         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2910             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2911         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2912         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  56
* VP6311.cbl
  2914
  2915 01  WS-EL6315-PASS-AREA.
  2916        16  PI-6315-ISS-CAN-SW      PIC X.
  2917        16  FILLER                  PIC X(120).
  2918        16  PI-RES-REF-CLM-TYPE     PIC X.
  2919        16  FILLER                  PIC X.
  2920        16  PI-6315-PASS-AREA.
  2921            20 FILLER               PIC X(236).
  2922            20 PI-6315-FINALIZED    PIC X.
  2923            20 FILLER               PIC X(280).
  2924
  2925 01  WS-EL6316-PASS-AREA.
  2926        16  PI-ISS-CAN-SW           PIC X.
  2927        16  FILLER                  PIC X(121).
  2928        16  PI-CLM-RESC-IND         PIC X.
  2929        16  PI-6316-PASS-AREA.
  2930            20 FILLER               PIC X(236).
  2931            20 PI-6316-FINALIZED    PIC X.
  2932            20 FILLER               PIC X(280).
  2933
  2934******************************************************************
  2935*                                                                *
  2936*         P A S S   A R E A   F O R   E D I T                    *
  2937*                                                                *
  2938******************************************************************
  2939
  2940 01  PASSED-RECORD.
  2941     12  RECORD-SAVE                  PIC X(585).
  2942* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2943*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2944*                    BY  WK-CURRENT-DATE.
  2945******************************************************************
  2946*                                                                *
  2947*                                                                *
  2948*                             ELC50W1                            *
  2949*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2950*                            VMOD=2.004                          *
  2951*                                                                *
  2952*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2953*                                                                *
  2954*                                                                *
  2955******************************************************************
  2956
  2957     12  WK-WORK-AREA.
  2958         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2959         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2960         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2961         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2962         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2963         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2964         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2965         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2966         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2967         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2968         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2969         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2970         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2971         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  57
* VP6311.cbl
  2972         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2973         16  WK-CREDIT-EDIT-CONTROLS.
  2974             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2975             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2976             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2977             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2978             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2979             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2980         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2981         16  WK-SAVE-REIN-DATA.
  2982             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2983             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2984             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2985         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2986             88  ENTRY-FROM-EL6311       VALUE '6'.
  2987         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2988         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2989     12  WK-RECORD-ADDRESSES.
  2990         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2991         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2992         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2993         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2994         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2995         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2996         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2997         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2998     12  WK-OVER-SHORT-AREA.
  2999         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3000         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3001         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3002             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3003         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  58
* VP6311.cbl
  3005
  3006*    COPY ELCEDITC.
  3007******************************************************************
  3008*                                                                *
  3009*                                                                *
  3010*                            ELCEDITC                            *
  3011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3012*                            VMOD=2.012                          *
  3013*                                                                *
  3014*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3015*                     EL6313, EL050 AND EL517.                   *
  3016*                                                                *
  3017******************************************************************
  3018******************************************************************
  3019*                   C H A N G E   L O G
  3020*
  3021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3022*-----------------------------------------------------------------
  3023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3024* EFFECTIVE    NUMBER
  3025*-----------------------------------------------------------------
  3026* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3027******************************************************************
  3028
  3029     12  EDIT-CRITERIA-DATA.
  3030         16  EC-CO-MONTH-END-DT       PIC XX.
  3031         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3032         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3033         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3034         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3035         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3036         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3037         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3038         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3039         16  EC-CO-REM-TERM-CALC      PIC X.
  3040               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3041               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3042               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3043               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3044
  3045         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3046               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3047               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3048               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3049               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3050               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3051               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3052               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3053               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3054               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3055               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3056
  3057         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3058               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3059               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3060               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3061               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3062               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  59
* VP6311.cbl
  3063               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3064               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3065               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3066
  3067         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3068                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3069                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3070
  3071         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3072                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3073                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3074                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3075                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3076                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3077                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3078                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3079                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3080
  3081         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3082               88  EC-BR-REDUCING                   VALUE 'R'.
  3083               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3084
  3085         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3086         16  EC-BR-LF-DESC             PIC X(10).
  3087         16  EC-BR-AH-DESC             PIC X(10).
  3088         16  EC-BR-LF-COMMENT          PIC X(10).
  3089         16  EC-BR-AH-COMMENT          PIC X(10).
  3090
  3091         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3092               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3093               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3094               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3095               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3096
  3097         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3098               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3099               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3100               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3101               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3102
  3103         16  EC-BR-LF-REFUND-CALC      PIC X.
  3104                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3105                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3106                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3107                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3108                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3109                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3110                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3111
  3112         16  EC-BR-AH-REFUND-CALC      PIC X.
  3113                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3114                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3115                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3116                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3117                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3118                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3119                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3120                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  60
* VP6311.cbl
  3121
  3122         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3123                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3124                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3125                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3126
  3127         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3128                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3129                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3130                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3131
  3132         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3133         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3134         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3135         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3136
  3137         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3138         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3139                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3140                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3141                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3142                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3143
  3144         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3145               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3146               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3147               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3148               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3149               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3150
  3151         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3152               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3153               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3154               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3155               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3156               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3157
  3158         16  EC-ST-LF-REFUND-CALC      PIC X.
  3159                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3160                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3161                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3162                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3163                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3164                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3165                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3166                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3167
  3168         16  EC-ST-AH-REFUND-CALC      PIC X.
  3169                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3170                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3171                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3172                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3173                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3174                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3175                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3176                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3177
  3178         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  61
* VP6311.cbl
  3179         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3180         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3181         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3182         16  EC-AM-EXPIRATION-DT       PIC XX.
  3183         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3184         16  EC-AM-CLASS-CD            PIC XX.
  3185         16  EC-AM-LF-DEVIATION        PIC XXX.
  3186         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3187         16  EC-AM-AH-DEVIATION        PIC XXX.
  3188         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3189         16  EC-AM-PHONE-NO            PIC X(10).
  3190
  3191         16  EC-AM-LF-REFUND-CALC      PIC X.
  3192                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3193                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3194                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3195                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3196                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3197                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3198                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3199
  3200         16  EC-AM-AH-REFUND-CALC      PIC X.
  3201                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3202                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3203                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3204                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3205                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3206                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3207                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3208
  3209         16  EC-AM-BEN-I-G-CD          PIC X.
  3210                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3211                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3212                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3213
  3214         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3215         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3216         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3217         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3218         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3219         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3220         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3221         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3222         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3223
  3224         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3225         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3226         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3227         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3228         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3229         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3230         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3231         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3232         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3233         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3234         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3235         16  EC-RT-LF-NSP-ST           PIC XX.
  3236         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  62
* VP6311.cbl
  3237         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3238         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3239
  3240         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3241             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3242                                             'M' '5' '9' '2'.
  3243             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3244             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3245             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3246             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3247             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3248             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3249             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3250             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3251             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3252             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3253
  3254         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3255             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3256                                             'M' '5' '9' '2'.
  3257             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3258             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3259             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3260             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3261             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3262             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3263             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3264             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3265             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3266             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3267
  3268         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3269         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3270         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3271         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3272         16  EC-CM-DEATH-DT            PIC XX.
  3273
  3274*DMD CUSTOM CODING FIELDS BELOW
  3275*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3276         16  EC-BR-DMD-RATING-SW       PIC X.
  3277                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3278                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3279                 88  NO-DMD-RATING               VALUE 'N'.
  3280
  3281         16  EC-NEW-CERT               PIC X(11).
  3282         16  EC-NEW-STATE              PIC XX.
  3283         16  FILLER                    PIC X.
  3284*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3285         16  OVER-SHORT-EDIT-FIELDS.
  3286             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3287             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3288             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3289             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3290             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3291             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3292             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3293             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3294             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  63
* VP6311.cbl
  3295         16  FILLER                    PIC X(71).
  3296
  3297******************************************************************
  3298
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  64
* VP6311.cbl
  3300
  3301*    COPY ELCJPFX.
  3302******************************************************************
  3303*                                                                *
  3304*                                                                *
  3305*                            ELCJPFX.                            *
  3306*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3307*                            VMOD=2.002                          *
  3308*                                                                *
  3309*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3310*                                                                *
  3311*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3312*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3313*        ELCNTL - CONTROL FILE                                   *
  3314*        ELMSTR - CLAIM MASTERS                                  *
  3315*        ELTRLR - ACTIVITY TRAILERS                              *
  3316*        ELCHKQ - CHECK QUE                                      *
  3317******************************************************************
  3318 01  JOURNAL-RECORD.
  3319     12  jp-date                     pic s9(5) comp-3.
  3320     12  jp-time                     pic s9(7) comp-3.
  3321     12  JP-USER-ID                  PIC X(4).
  3322     12  JP-FILE-ID                  PIC X(8).
  3323     12  JP-PROGRAM-ID               PIC X(8).
  3324     12  JP-RECORD-TYPE              PIC X.
  3325         88 JP-ADD              VALUE 'A'.
  3326         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3327         88 JP-AFTER-CHANGE     VALUE 'C'.
  3328         88 JP-DELETE           VALUE 'D'.
  3329         88 JP-GENERIC-DELETE   VALUE 'G'.
  3330         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3331         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3332     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3333     12  JP-RECORD-AREA
  3334
  3335
  3336                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  65
* VP6311.cbl
  3338*    COPY ELCAID.
  3339******************************************************************
  3340*                                                                *
  3341*                            ELCAID.                             *
  3342*                            VMOD=2.001                          *
  3343*                                                                *
  3344*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3345*                                                                *
  3346*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3347*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3348******************************************************************
  3349
  3350 01  DFHAID.
  3351   02  DFHNULL   PIC  X  VALUE  ' '.
  3352   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3353   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3354   02  DFHPEN    PIC  X  VALUE  '='.
  3355   02  DFHOPID   PIC  X  VALUE  'W'.
  3356   02  DFHPA1    PIC  X  VALUE  '%'.
  3357   02  DFHPA2    PIC  X  VALUE  '>'.
  3358   02  DFHPA3    PIC  X  VALUE  ','.
  3359   02  DFHPF1    PIC  X  VALUE  '1'.
  3360   02  DFHPF2    PIC  X  VALUE  '2'.
  3361   02  DFHPF3    PIC  X  VALUE  '3'.
  3362   02  DFHPF4    PIC  X  VALUE  '4'.
  3363   02  DFHPF5    PIC  X  VALUE  '5'.
  3364   02  DFHPF6    PIC  X  VALUE  '6'.
  3365   02  DFHPF7    PIC  X  VALUE  '7'.
  3366   02  DFHPF8    PIC  X  VALUE  '8'.
  3367   02  DFHPF9    PIC  X  VALUE  '9'.
  3368   02  DFHPF10   PIC  X  VALUE  ':'.
  3369   02  DFHPF11   PIC  X  VALUE  '#'.
  3370   02  DFHPF12   PIC  X  VALUE  '@'.
  3371   02  DFHPF13   PIC  X  VALUE  'A'.
  3372   02  DFHPF14   PIC  X  VALUE  'B'.
  3373   02  DFHPF15   PIC  X  VALUE  'C'.
  3374   02  DFHPF16   PIC  X  VALUE  'D'.
  3375   02  DFHPF17   PIC  X  VALUE  'E'.
  3376   02  DFHPF18   PIC  X  VALUE  'F'.
  3377   02  DFHPF19   PIC  X  VALUE  'G'.
  3378   02  DFHPF20   PIC  X  VALUE  'H'.
  3379   02  DFHPF21   PIC  X  VALUE  'I'.
  3380*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3381   02  DFHPF22   PIC  X  VALUE  '['.
  3382   02  DFHPF23   PIC  X  VALUE  '.'.
  3383   02  DFHPF24   PIC  X  VALUE  '<'.
  3384   02  DFHMSRE   PIC  X  VALUE  'X'.
  3385   02  DFHSTRF   PIC  X  VALUE  'h'.
  3386   02  DFHTRIG   PIC  X  VALUE  '"'.
  3387
  3388 01  FILLER    REDEFINES DFHAID.
  3389     12  FILLER              PIC X(8).
  3390     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3391
  3392*                                COPY VP6311S.
  3393 01  VP631BI.
  3394     05  FILLER            PIC  X(0012).
  3395*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  66
* VP6311.cbl
  3396     05  BDATEL PIC S9(0004) COMP.
  3397     05  BDATEF PIC  X(0001).
  3398     05  FILLER REDEFINES BDATEF.
  3399         10  BDATEA PIC  X(0001).
  3400     05  BDATEI PIC  X(0008).
  3401*    -------------------------------
  3402     05  BTIMEL PIC S9(0004) COMP.
  3403     05  BTIMEF PIC  X(0001).
  3404     05  FILLER REDEFINES BTIMEF.
  3405         10  BTIMEA PIC  X(0001).
  3406     05  BTIMEI PIC  X(0005).
  3407*    -------------------------------
  3408     05  BHEADL PIC S9(0004) COMP.
  3409     05  BHEADF PIC  X(0001).
  3410     05  FILLER REDEFINES BHEADF.
  3411         10  BHEADA PIC  X(0001).
  3412     05  BHEADI PIC  X(0038).
  3413*    -------------------------------
  3414     05  BNCERTLL PIC S9(0004) COMP.
  3415     05  BNCERTLF PIC  X(0001).
  3416     05  FILLER REDEFINES BNCERTLF.
  3417         10  BNCERTLA PIC  X(0001).
  3418     05  BNCERTLI PIC  X(0008).
  3419*    -------------------------------
  3420     05  BNCERTL PIC S9(0004) COMP.
  3421     05  BNCERTF PIC  X(0001).
  3422     05  FILLER REDEFINES BNCERTF.
  3423         10  BNCERTA PIC  X(0001).
  3424     05  BNCERTI PIC  X(0011).
  3425*    -------------------------------
  3426     05  BNSTATLL PIC S9(0004) COMP.
  3427     05  BNSTATLF PIC  X(0001).
  3428     05  FILLER REDEFINES BNSTATLF.
  3429         10  BNSTATLA PIC  X(0001).
  3430     05  BNSTATLI PIC  X(0009).
  3431*    -------------------------------
  3432     05  BNSTATL PIC S9(0004) COMP.
  3433     05  BNSTATF PIC  X(0001).
  3434     05  FILLER REDEFINES BNSTATF.
  3435         10  BNSTATA PIC  X(0001).
  3436     05  BNSTATI PIC  X(0002).
  3437*    -------------------------------
  3438     05  BCHGTL PIC S9(0004) COMP.
  3439     05  BCHGTF PIC  X(0001).
  3440     05  FILLER REDEFINES BCHGTF.
  3441         10  BCHGTA PIC  X(0001).
  3442     05  BCHGTI PIC  X(0004).
  3443*    -------------------------------
  3444     05  BCHGL PIC S9(0004) COMP.
  3445     05  BCHGF PIC  X(0001).
  3446     05  FILLER REDEFINES BCHGF.
  3447         10  BCHGA PIC  X(0001).
  3448     05  BCHGI PIC  X(0004).
  3449*    -------------------------------
  3450     05  BCOMPIDL PIC S9(0004) COMP.
  3451     05  BCOMPIDF PIC  X(0001).
  3452     05  FILLER REDEFINES BCOMPIDF.
  3453         10  BCOMPIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  67
* VP6311.cbl
  3454     05  BCOMPIDI PIC  X(0003).
  3455*    -------------------------------
  3456     05  BREGIONL PIC S9(0004) COMP.
  3457     05  BREGIONF PIC  X(0001).
  3458     05  FILLER REDEFINES BREGIONF.
  3459         10  BREGIONA PIC  X(0001).
  3460     05  BREGIONI PIC  X(0006).
  3461*    -------------------------------
  3462     05  BUSERL PIC S9(0004) COMP.
  3463     05  BUSERF PIC  X(0001).
  3464     05  FILLER REDEFINES BUSERF.
  3465         10  BUSERA PIC  X(0001).
  3466     05  BUSERI PIC  X(0004).
  3467*    -------------------------------
  3468     05  BMAINTL PIC S9(0004) COMP.
  3469     05  BMAINTF PIC  X(0001).
  3470     05  FILLER REDEFINES BMAINTF.
  3471         10  BMAINTA PIC  X(0001).
  3472     05  BMAINTI PIC  X(0001).
  3473*    -------------------------------
  3474     05  BMANTBYL PIC S9(0004) COMP.
  3475     05  BMANTBYF PIC  X(0001).
  3476     05  FILLER REDEFINES BMANTBYF.
  3477         10  BMANTBYA PIC  X(0001).
  3478     05  BMANTBYI PIC  X(0004).
  3479*    -------------------------------
  3480     05  BCHGHDGL PIC S9(0004) COMP.
  3481     05  BCHGHDGF PIC  X(0001).
  3482     05  FILLER REDEFINES BCHGHDGF.
  3483         10  BCHGHDGA PIC  X(0001).
  3484     05  BCHGHDGI PIC  X(0003).
  3485*    -------------------------------
  3486     05  BMANTDTL PIC S9(0004) COMP.
  3487     05  BMANTDTF PIC  X(0001).
  3488     05  FILLER REDEFINES BMANTDTF.
  3489         10  BMANTDTA PIC  X(0001).
  3490     05  BMANTDTI PIC  X(0008).
  3491*    -------------------------------
  3492     05  BMANTATL PIC S9(0004) COMP.
  3493     05  BMANTATF PIC  X(0001).
  3494     05  FILLER REDEFINES BMANTATF.
  3495         10  BMANTATA PIC  X(0001).
  3496     05  BMANTATI PIC  X(0005).
  3497*    -------------------------------
  3498     05  BCSRL PIC S9(0004) COMP.
  3499     05  BCSRF PIC  X(0001).
  3500     05  FILLER REDEFINES BCSRF.
  3501         10  BCSRA PIC  X(0001).
  3502     05  BCSRI PIC  X(0004).
  3503*    -------------------------------
  3504     05  BBATCHL PIC S9(0004) COMP.
  3505     05  BBATCHF PIC  X(0001).
  3506     05  FILLER REDEFINES BBATCHF.
  3507         10  BBATCHA PIC  X(0001).
  3508     05  BBATCHI PIC  X(0006).
  3509*    -------------------------------
  3510     05  BSEQL PIC S9(0004) COMP.
  3511     05  BSEQF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  68
* VP6311.cbl
  3512     05  FILLER REDEFINES BSEQF.
  3513         10  BSEQA PIC  X(0001).
  3514     05  BSEQI PIC  X(0004).
  3515*    -------------------------------
  3516     05  BMOENDTL PIC S9(0004) COMP.
  3517     05  BMOENDTF PIC  X(0001).
  3518     05  FILLER REDEFINES BMOENDTF.
  3519         10  BMOENDTA PIC  X(0001).
  3520     05  BMOENDTI PIC  X(0008).
  3521*    -------------------------------
  3522     05  BCARRL PIC S9(0004) COMP.
  3523     05  BCARRF PIC  X(0001).
  3524     05  FILLER REDEFINES BCARRF.
  3525         10  BCARRA PIC  X(0001).
  3526     05  BCARRI PIC  X(0001).
  3527*    -------------------------------
  3528     05  BGROUPL PIC S9(0004) COMP.
  3529     05  BGROUPF PIC  X(0001).
  3530     05  FILLER REDEFINES BGROUPF.
  3531         10  BGROUPA PIC  X(0001).
  3532     05  BGROUPI PIC  X(0006).
  3533*    -------------------------------
  3534     05  BSTATEL PIC S9(0004) COMP.
  3535     05  BSTATEF PIC  X(0001).
  3536     05  FILLER REDEFINES BSTATEF.
  3537         10  BSTATEA PIC  X(0001).
  3538     05  BSTATEI PIC  X(0002).
  3539*    -------------------------------
  3540     05  BACCTL PIC S9(0004) COMP.
  3541     05  BACCTF PIC  X(0001).
  3542     05  FILLER REDEFINES BACCTF.
  3543         10  BACCTA PIC  X(0001).
  3544     05  BACCTI PIC  X(0010).
  3545*    -------------------------------
  3546     05  BVINHL PIC S9(0004) COMP.
  3547     05  BVINHF PIC  X(0001).
  3548     05  FILLER REDEFINES BVINHF.
  3549         10  BVINHA PIC  X(0001).
  3550     05  BVINHI PIC  X(0004).
  3551*    -------------------------------
  3552     05  BVINL PIC S9(0004) COMP.
  3553     05  BVINF PIC  X(0001).
  3554     05  FILLER REDEFINES BVINF.
  3555         10  BVINA PIC  X(0001).
  3556     05  BVINI PIC  X(0017).
  3557*    -------------------------------
  3558     05  BREFHDGL PIC S9(0004) COMP.
  3559     05  BREFHDGF PIC  X(0001).
  3560     05  FILLER REDEFINES BREFHDGF.
  3561         10  BREFHDGA PIC  X(0001).
  3562     05  BREFHDGI PIC  X(0004).
  3563*    -------------------------------
  3564     05  BREFL PIC S9(0004) COMP.
  3565     05  BREFF PIC  X(0001).
  3566     05  FILLER REDEFINES BREFF.
  3567         10  BREFA PIC  X(0001).
  3568     05  BREFI PIC  X(0012).
  3569*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  69
* VP6311.cbl
  3570     05  BAGEDEFL PIC S9(0004) COMP.
  3571     05  BAGEDEFF PIC  X(0001).
  3572     05  FILLER REDEFINES BAGEDEFF.
  3573         10  BAGEDEFA PIC  X(0001).
  3574     05  BAGEDEFI PIC  X(0004).
  3575*    -------------------------------
  3576     05  BCERTNOL PIC S9(0004) COMP.
  3577     05  BCERTNOF PIC  X(0001).
  3578     05  FILLER REDEFINES BCERTNOF.
  3579         10  BCERTNOA PIC  X(0001).
  3580     05  BCERTNOI PIC  X(0010).
  3581*    -------------------------------
  3582     05  BSUFIXL PIC S9(0004) COMP.
  3583     05  BSUFIXF PIC  X(0001).
  3584     05  FILLER REDEFINES BSUFIXF.
  3585         10  BSUFIXA PIC  X(0001).
  3586     05  BSUFIXI PIC  X(0001).
  3587*    -------------------------------
  3588     05  BEFFDTL PIC S9(0004) COMP.
  3589     05  BEFFDTF PIC  X(0001).
  3590     05  FILLER REDEFINES BEFFDTF.
  3591         10  BEFFDTA PIC  X(0001).
  3592     05  BEFFDTI PIC  X(0008).
  3593*    -------------------------------
  3594     05  BLSTNML PIC S9(0004) COMP.
  3595     05  BLSTNMF PIC  X(0001).
  3596     05  FILLER REDEFINES BLSTNMF.
  3597         10  BLSTNMA PIC  X(0001).
  3598     05  BLSTNMI PIC  X(0015).
  3599*    -------------------------------
  3600     05  B1STNML PIC S9(0004) COMP.
  3601     05  B1STNMF PIC  X(0001).
  3602     05  FILLER REDEFINES B1STNMF.
  3603         10  B1STNMA PIC  X(0001).
  3604     05  B1STNMI PIC  X(0010).
  3605*    -------------------------------
  3606     05  BINITL PIC S9(0004) COMP.
  3607     05  BINITF PIC  X(0001).
  3608     05  FILLER REDEFINES BINITF.
  3609         10  BINITA PIC  X(0001).
  3610     05  BINITI PIC  X(0001).
  3611*    -------------------------------
  3612     05  BSEXL PIC S9(0004) COMP.
  3613     05  BSEXF PIC  X(0001).
  3614     05  FILLER REDEFINES BSEXF.
  3615         10  BSEXA PIC  X(0001).
  3616     05  BSEXI PIC  X(0001).
  3617*    -------------------------------
  3618     05  BAGEL PIC S9(0004) COMP.
  3619     05  BAGEF PIC  X(0001).
  3620     05  FILLER REDEFINES BAGEF.
  3621         10  BAGEA PIC  X(0001).
  3622     05  BAGEI PIC  X(0002).
  3623*    -------------------------------
  3624     05  BBIRTHL PIC S9(0004) COMP.
  3625     05  BBIRTHF PIC  X(0001).
  3626     05  FILLER REDEFINES BBIRTHF.
  3627         10  BBIRTHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  70
* VP6311.cbl
  3628     05  BBIRTHI PIC  X(0008).
  3629*    -------------------------------
  3630     05  BYEARL PIC S9(0004) COMP.
  3631     05  BYEARF PIC  X(0001).
  3632     05  FILLER REDEFINES BYEARF.
  3633         10  BYEARA PIC  X(0001).
  3634     05  BYEARI PIC  X(0004).
  3635*    -------------------------------
  3636     05  BMAKEL PIC S9(0004) COMP.
  3637     05  BMAKEF PIC  X(0001).
  3638     05  FILLER REDEFINES BMAKEF.
  3639         10  BMAKEA PIC  X(0001).
  3640     05  BMAKEI PIC  X(0020).
  3641*    -------------------------------
  3642     05  BMODELL PIC S9(0004) COMP.
  3643     05  BMODELF PIC  X(0001).
  3644     05  FILLER REDEFINES BMODELF.
  3645         10  BMODELA PIC  X(0001).
  3646     05  BMODELI PIC  X(0020).
  3647*    -------------------------------
  3648     05  BFUTUREL PIC S9(0004) COMP.
  3649     05  BFUTUREF PIC  X(0001).
  3650     05  FILLER REDEFINES BFUTUREF.
  3651         10  BFUTUREA PIC  X(0001).
  3652     05  BFUTUREI PIC  X(0020).
  3653*    -------------------------------
  3654     05  BOMETERL PIC S9(0004) COMP.
  3655     05  BOMETERF PIC  X(0001).
  3656     05  FILLER REDEFINES BOMETERF.
  3657         10  BOMETERA PIC  X(0001).
  3658     05  BOMETERI PIC  X(0007).
  3659*    -------------------------------
  3660     05  BMEMCAPL PIC S9(0004) COMP.
  3661     05  BMEMCAPF PIC  X(0001).
  3662     05  FILLER REDEFINES BMEMCAPF.
  3663         10  BMEMCAPA PIC  X(0001).
  3664     05  BMEMCAPI PIC  X(0011).
  3665*    -------------------------------
  3666     05  BORIGHDL PIC S9(0004) COMP.
  3667     05  BORIGHDF PIC  X(0001).
  3668     05  FILLER REDEFINES BORIGHDF.
  3669         10  BORIGHDA PIC  X(0001).
  3670     05  BORIGHDI PIC  X(0010).
  3671*    -------------------------------
  3672     05  BFORCEL PIC S9(0004) COMP.
  3673     05  BFORCEF PIC  X(0001).
  3674     05  FILLER REDEFINES BFORCEF.
  3675         10  BFORCEA PIC  X(0001).
  3676     05  BFORCEI PIC  X(0001).
  3677*    -------------------------------
  3678     05  BENTRYL PIC S9(0004) COMP.
  3679     05  BENTRYF PIC  X(0001).
  3680     05  FILLER REDEFINES BENTRYF.
  3681         10  BENTRYA PIC  X(0001).
  3682     05  BENTRYI PIC  X(0001).
  3683*    -------------------------------
  3684     05  BREINL PIC S9(0004) COMP.
  3685     05  BREINF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  71
* VP6311.cbl
  3686     05  FILLER REDEFINES BREINF.
  3687         10  BREINA PIC  X(0001).
  3688     05  BREINI PIC  X(0001).
  3689*    -------------------------------
  3690     05  BBILCDL PIC S9(0004) COMP.
  3691     05  BBILCDF PIC  X(0001).
  3692     05  FILLER REDEFINES BBILCDF.
  3693         10  BBILCDA PIC  X(0001).
  3694     05  BBILCDI PIC  X(0001).
  3695*    -------------------------------
  3696     05  BUNWRITL PIC S9(0004) COMP.
  3697     05  BUNWRITF PIC  X(0001).
  3698     05  FILLER REDEFINES BUNWRITF.
  3699         10  BUNWRITA PIC  X(0001).
  3700     05  BUNWRITI PIC  X(0001).
  3701*    -------------------------------
  3702     05  BSKPCDL PIC S9(0004) COMP.
  3703     05  BSKPCDF PIC  X(0001).
  3704     05  FILLER REDEFINES BSKPCDF.
  3705         10  BSKPCDA PIC  X(0001).
  3706     05  BSKPCDI PIC  X(0001).
  3707*    -------------------------------
  3708     05  BINDGRPL PIC S9(0004) COMP.
  3709     05  BINDGRPF PIC  X(0001).
  3710     05  FILLER REDEFINES BINDGRPF.
  3711         10  BINDGRPA PIC  X(0001).
  3712     05  BINDGRPI PIC  X(0001).
  3713*    -------------------------------
  3714     05  BSIGL PIC S9(0004) COMP.
  3715     05  BSIGF PIC  X(0001).
  3716     05  FILLER REDEFINES BSIGF.
  3717         10  BSIGA PIC  X(0001).
  3718     05  BSIGI PIC  X(0001).
  3719*    -------------------------------
  3720     05  BRTCLSL PIC S9(0004) COMP.
  3721     05  BRTCLSF PIC  X(0001).
  3722     05  FILLER REDEFINES BRTCLSF.
  3723         10  BRTCLSA PIC  X(0001).
  3724     05  BRTCLSI PIC  X(0002).
  3725*    -------------------------------
  3726     05  BCHGCNTL PIC S9(0004) COMP.
  3727     05  BCHGCNTF PIC  X(0001).
  3728     05  FILLER REDEFINES BCHGCNTF.
  3729         10  BCHGCNTA PIC  X(0001).
  3730     05  BCHGCNTI PIC  X(0003).
  3731*    -------------------------------
  3732     05  BMEMBERL PIC S9(0004) COMP.
  3733     05  BMEMBERF PIC  X(0001).
  3734     05  FILLER REDEFINES BMEMBERF.
  3735         10  BMEMBERA PIC  X(0001).
  3736     05  BMEMBERI PIC  X(0012).
  3737*    -------------------------------
  3738     05  BLNOFCRL PIC S9(0004) COMP.
  3739     05  BLNOFCRF PIC  X(0001).
  3740     05  FILLER REDEFINES BLNOFCRF.
  3741         10  BLNOFCRA PIC  X(0001).
  3742     05  BLNOFCRI PIC  X(0005).
  3743*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  72
* VP6311.cbl
  3744     05  BKIND1L PIC S9(0004) COMP.
  3745     05  BKIND1F PIC  X(0001).
  3746     05  FILLER REDEFINES BKIND1F.
  3747         10  BKIND1A PIC  X(0001).
  3748     05  BKIND1I PIC  X(0002).
  3749*    -------------------------------
  3750     05  BTYPE1L PIC S9(0004) COMP.
  3751     05  BTYPE1F PIC  X(0001).
  3752     05  FILLER REDEFINES BTYPE1F.
  3753         10  BTYPE1A PIC  X(0001).
  3754     05  BTYPE1I PIC  X(0003).
  3755*    -------------------------------
  3756     05  BTERM1L PIC S9(0004) COMP.
  3757     05  BTERM1F PIC  X(0001).
  3758     05  FILLER REDEFINES BTERM1F.
  3759         10  BTERM1A PIC  X(0001).
  3760     05  BTERM1I PIC  X(0003).
  3761*    -------------------------------
  3762     05  BBEN1L PIC S9(0004) COMP.
  3763     05  BBEN1F PIC  X(0001).
  3764     05  FILLER REDEFINES BBEN1F.
  3765         10  BBEN1A PIC  X(0001).
  3766     05  BBEN1I PIC  X(0012).
  3767*    -------------------------------
  3768     05  BPREM1L PIC S9(0004) COMP.
  3769     05  BPREM1F PIC  X(0001).
  3770     05  FILLER REDEFINES BPREM1F.
  3771         10  BPREM1A PIC  X(0001).
  3772     05  BPREM1I PIC  X(0011).
  3773*    -------------------------------
  3774     05  BEXPIR1L PIC S9(0004) COMP.
  3775     05  BEXPIR1F PIC  X(0001).
  3776     05  FILLER REDEFINES BEXPIR1F.
  3777         10  BEXPIR1A PIC  X(0001).
  3778     05  BEXPIR1I PIC  X(0008).
  3779*    -------------------------------
  3780     05  BCP1L PIC S9(0004) COMP.
  3781     05  BCP1F PIC  X(0001).
  3782     05  FILLER REDEFINES BCP1F.
  3783         10  BCP1A PIC  X(0001).
  3784     05  BCP1I PIC  X(0002).
  3785*    -------------------------------
  3786     05  BALTBN1L PIC S9(0004) COMP.
  3787     05  BALTBN1F PIC  X(0001).
  3788     05  FILLER REDEFINES BALTBN1F.
  3789         10  BALTBN1A PIC  X(0001).
  3790     05  BALTBN1I PIC  X(0012).
  3791*    -------------------------------
  3792     05  BALTPR1L PIC S9(0004) COMP.
  3793     05  BALTPR1F PIC  X(0001).
  3794     05  FILLER REDEFINES BALTPR1F.
  3795         10  BALTPR1A PIC  X(0001).
  3796     05  BALTPR1I PIC  X(0011).
  3797*    -------------------------------
  3798     05  BBNCD1L PIC S9(0004) COMP.
  3799     05  BBNCD1F PIC  X(0001).
  3800     05  FILLER REDEFINES BBNCD1F.
  3801         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  73
* VP6311.cbl
  3802     05  BBNCD1I PIC  X(0003).
  3803*    -------------------------------
  3804     05  BCPRM1L PIC S9(0004) COMP.
  3805     05  BCPRM1F PIC  X(0001).
  3806     05  FILLER REDEFINES BCPRM1F.
  3807         10  BCPRM1A PIC  X(0001).
  3808     05  BCPRM1I PIC  X(0011).
  3809*    -------------------------------
  3810     05  BCAPRM1L PIC S9(0004) COMP.
  3811     05  BCAPRM1F PIC  X(0001).
  3812     05  FILLER REDEFINES BCAPRM1F.
  3813         10  BCAPRM1A PIC  X(0001).
  3814     05  BCAPRM1I PIC  X(0011).
  3815*    -------------------------------
  3816     05  BENABR1L PIC S9(0004) COMP.
  3817     05  BENABR1F PIC  X(0001).
  3818     05  FILLER REDEFINES BENABR1F.
  3819         10  BENABR1A PIC  X(0001).
  3820     05  BENABR1I PIC  X(0005).
  3821*    -------------------------------
  3822     05  BDIFF1L PIC S9(0004) COMP.
  3823     05  BDIFF1F PIC  X(0001).
  3824     05  FILLER REDEFINES BDIFF1F.
  3825         10  BDIFF1A PIC  X(0001).
  3826     05  BDIFF1I PIC  X(0011).
  3827*    -------------------------------
  3828     05  BBILIT1L PIC S9(0004) COMP.
  3829     05  BBILIT1F PIC  X(0001).
  3830     05  FILLER REDEFINES BBILIT1F.
  3831         10  BBILIT1A PIC  X(0001).
  3832     05  BBILIT1I PIC  X(0008).
  3833*    -------------------------------
  3834     05  BADIFF1L PIC S9(0004) COMP.
  3835     05  BADIFF1F PIC  X(0001).
  3836     05  FILLER REDEFINES BADIFF1F.
  3837         10  BADIFF1A PIC  X(0001).
  3838     05  BADIFF1I PIC  X(0011).
  3839*    -------------------------------
  3840     05  BKIND2L PIC S9(0004) COMP.
  3841     05  BKIND2F PIC  X(0001).
  3842     05  FILLER REDEFINES BKIND2F.
  3843         10  BKIND2A PIC  X(0001).
  3844     05  BKIND2I PIC  X(0002).
  3845*    -------------------------------
  3846     05  BTYPE2L PIC S9(0004) COMP.
  3847     05  BTYPE2F PIC  X(0001).
  3848     05  FILLER REDEFINES BTYPE2F.
  3849         10  BTYPE2A PIC  X(0001).
  3850     05  BTYPE2I PIC  X(0003).
  3851*    -------------------------------
  3852     05  BTERM2L PIC S9(0004) COMP.
  3853     05  BTERM2F PIC  X(0001).
  3854     05  FILLER REDEFINES BTERM2F.
  3855         10  BTERM2A PIC  X(0001).
  3856     05  BTERM2I PIC  X(0003).
  3857*    -------------------------------
  3858     05  BBEN2L PIC S9(0004) COMP.
  3859     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  74
* VP6311.cbl
  3860     05  FILLER REDEFINES BBEN2F.
  3861         10  BBEN2A PIC  X(0001).
  3862     05  BBEN2I PIC  X(0012).
  3863*    -------------------------------
  3864     05  BPREM2L PIC S9(0004) COMP.
  3865     05  BPREM2F PIC  X(0001).
  3866     05  FILLER REDEFINES BPREM2F.
  3867         10  BPREM2A PIC  X(0001).
  3868     05  BPREM2I PIC  X(0011).
  3869*    -------------------------------
  3870     05  BEXPIR2L PIC S9(0004) COMP.
  3871     05  BEXPIR2F PIC  X(0001).
  3872     05  FILLER REDEFINES BEXPIR2F.
  3873         10  BEXPIR2A PIC  X(0001).
  3874     05  BEXPIR2I PIC  X(0008).
  3875*    -------------------------------
  3876     05  BCP2L PIC S9(0004) COMP.
  3877     05  BCP2F PIC  X(0001).
  3878     05  FILLER REDEFINES BCP2F.
  3879         10  BCP2A PIC  X(0001).
  3880     05  BCP2I PIC  X(0002).
  3881*    -------------------------------
  3882     05  BALTBN2L PIC S9(0004) COMP.
  3883     05  BALTBN2F PIC  X(0001).
  3884     05  FILLER REDEFINES BALTBN2F.
  3885         10  BALTBN2A PIC  X(0001).
  3886     05  BALTBN2I PIC  X(0012).
  3887*    -------------------------------
  3888     05  BALTPR2L PIC S9(0004) COMP.
  3889     05  BALTPR2F PIC  X(0001).
  3890     05  FILLER REDEFINES BALTPR2F.
  3891         10  BALTPR2A PIC  X(0001).
  3892     05  BALTPR2I PIC  X(0011).
  3893*    -------------------------------
  3894     05  BBNCD2L PIC S9(0004) COMP.
  3895     05  BBNCD2F PIC  X(0001).
  3896     05  FILLER REDEFINES BBNCD2F.
  3897         10  BBNCD2A PIC  X(0001).
  3898     05  BBNCD2I PIC  X(0003).
  3899*    -------------------------------
  3900     05  BCPRM2L PIC S9(0004) COMP.
  3901     05  BCPRM2F PIC  X(0001).
  3902     05  FILLER REDEFINES BCPRM2F.
  3903         10  BCPRM2A PIC  X(0001).
  3904     05  BCPRM2I PIC  X(0011).
  3905*    -------------------------------
  3906     05  BCAPRM2L PIC S9(0004) COMP.
  3907     05  BCAPRM2F PIC  X(0001).
  3908     05  FILLER REDEFINES BCAPRM2F.
  3909         10  BCAPRM2A PIC  X(0001).
  3910     05  BCAPRM2I PIC  X(0011).
  3911*    -------------------------------
  3912     05  BENABR2L PIC S9(0004) COMP.
  3913     05  BENABR2F PIC  X(0001).
  3914     05  FILLER REDEFINES BENABR2F.
  3915         10  BENABR2A PIC  X(0001).
  3916     05  BENABR2I PIC  X(0005).
  3917*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  75
* VP6311.cbl
  3918     05  BDIFF2L PIC S9(0004) COMP.
  3919     05  BDIFF2F PIC  X(0001).
  3920     05  FILLER REDEFINES BDIFF2F.
  3921         10  BDIFF2A PIC  X(0001).
  3922     05  BDIFF2I PIC  X(0011).
  3923*    -------------------------------
  3924     05  BBILIT2L PIC S9(0004) COMP.
  3925     05  BBILIT2F PIC  X(0001).
  3926     05  FILLER REDEFINES BBILIT2F.
  3927         10  BBILIT2A PIC  X(0001).
  3928     05  BBILIT2I PIC  X(0008).
  3929*    -------------------------------
  3930     05  BADIFF2L PIC S9(0004) COMP.
  3931     05  BADIFF2F PIC  X(0001).
  3932     05  FILLER REDEFINES BADIFF2F.
  3933         10  BADIFF2A PIC  X(0001).
  3934     05  BADIFF2I PIC  X(0011).
  3935*    -------------------------------
  3936     05  BERMSG1L PIC S9(0004) COMP.
  3937     05  BERMSG1F PIC  X(0001).
  3938     05  FILLER REDEFINES BERMSG1F.
  3939         10  BERMSG1A PIC  X(0001).
  3940     05  BERMSG1I PIC  X(0078).
  3941*    -------------------------------
  3942     05  BERMSG2L PIC S9(0004) COMP.
  3943     05  BERMSG2F PIC  X(0001).
  3944     05  FILLER REDEFINES BERMSG2F.
  3945         10  BERMSG2A PIC  X(0001).
  3946     05  BERMSG2I PIC  X(0078).
  3947*    -------------------------------
  3948     05  BERMSG3L PIC S9(0004) COMP.
  3949     05  BERMSG3F PIC  X(0001).
  3950     05  FILLER REDEFINES BERMSG3F.
  3951         10  BERMSG3A PIC  X(0001).
  3952     05  BERMSG3I PIC  X(0078).
  3953*    -------------------------------
  3954     05  BPFENTRL PIC S9(0004) COMP.
  3955     05  BPFENTRF PIC  X(0001).
  3956     05  FILLER REDEFINES BPFENTRF.
  3957         10  BPFENTRA PIC  X(0001).
  3958     05  BPFENTRI PIC  9(2).
  3959*    -------------------------------
  3960     05  BPF5HDRL PIC S9(0004) COMP.
  3961     05  BPF5HDRF PIC  X(0001).
  3962     05  FILLER REDEFINES BPF5HDRF.
  3963         10  BPF5HDRA PIC  X(0001).
  3964     05  BPF5HDRI PIC  X(0005).
  3965*    -------------------------------
  3966     05  BPF4HDRL PIC S9(0004) COMP.
  3967     05  BPF4HDRF PIC  X(0001).
  3968     05  FILLER REDEFINES BPF4HDRF.
  3969         10  BPF4HDRA PIC  X(0001).
  3970     05  BPF4HDRI PIC  X(0013).
  3971*    -------------------------------
  3972     05  BF15HDRL PIC S9(0004) COMP.
  3973     05  BF15HDRF PIC  X(0001).
  3974     05  FILLER REDEFINES BF15HDRF.
  3975         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  76
* VP6311.cbl
  3976     05  BF15HDRI PIC  X(0010).
  3977 01  VP631BO REDEFINES VP631BI.
  3978     05  FILLER            PIC  X(0012).
  3979*    -------------------------------
  3980     05  FILLER            PIC  X(0003).
  3981     05  BDATEO PIC  X(0008).
  3982*    -------------------------------
  3983     05  FILLER            PIC  X(0003).
  3984     05  BTIMEO PIC  99.99.
  3985*    -------------------------------
  3986     05  FILLER            PIC  X(0003).
  3987     05  BHEADO PIC  X(0038).
  3988*    -------------------------------
  3989     05  FILLER            PIC  X(0003).
  3990     05  BNCERTLO PIC  X(0008).
  3991*    -------------------------------
  3992     05  FILLER            PIC  X(0003).
  3993     05  BNCERTO PIC  X(0011).
  3994*    -------------------------------
  3995     05  FILLER            PIC  X(0003).
  3996     05  BNSTATLO PIC  X(0009).
  3997*    -------------------------------
  3998     05  FILLER            PIC  X(0003).
  3999     05  BNSTATO PIC  X(0002).
  4000*    -------------------------------
  4001     05  FILLER            PIC  X(0003).
  4002     05  BCHGTO PIC  X(0004).
  4003*    -------------------------------
  4004     05  FILLER            PIC  X(0003).
  4005     05  BCHGO PIC  ZZZ9.
  4006*    -------------------------------
  4007     05  FILLER            PIC  X(0003).
  4008     05  BCOMPIDO PIC  X(0003).
  4009*    -------------------------------
  4010     05  FILLER            PIC  X(0003).
  4011     05  BREGIONO PIC  X(0006).
  4012*    -------------------------------
  4013     05  FILLER            PIC  X(0003).
  4014     05  BUSERO PIC  X(0004).
  4015*    -------------------------------
  4016     05  FILLER            PIC  X(0003).
  4017     05  BMAINTO PIC  X(0001).
  4018*    -------------------------------
  4019     05  FILLER            PIC  X(0003).
  4020     05  BMANTBYO PIC  X(0004).
  4021*    -------------------------------
  4022     05  FILLER            PIC  X(0003).
  4023     05  BCHGHDGO PIC  X(0003).
  4024*    -------------------------------
  4025     05  FILLER            PIC  X(0003).
  4026     05  BMANTDTO PIC  X(0008).
  4027*    -------------------------------
  4028     05  FILLER            PIC  X(0003).
  4029     05  BMANTATO PIC  99.99.
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BCSRO PIC  X(0004).
  4033*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  77
* VP6311.cbl
  4034     05  FILLER            PIC  X(0003).
  4035     05  BBATCHO PIC  X(0006).
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BSEQO PIC  X(0004).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BMOENDTO PIC  X(0008).
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BCARRO PIC  X(0001).
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BGROUPO PIC  X(0006).
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
  4050     05  BSTATEO PIC  X(0002).
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BACCTO PIC  X(0010).
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BVINHO PIC  X(0004).
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  BVINO PIC  X(0017).
  4060*    -------------------------------
  4061     05  FILLER            PIC  X(0003).
  4062     05  BREFHDGO PIC  X(0004).
  4063*    -------------------------------
  4064     05  FILLER            PIC  X(0003).
  4065     05  BREFO PIC  X(0012).
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BAGEDEFO PIC  X(0004).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BCERTNOO PIC  X(0010).
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BSUFIXO PIC  X(0001).
  4075*    -------------------------------
  4076     05  FILLER            PIC  X(0003).
  4077     05  BEFFDTO PIC  X(0008).
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  BLSTNMO PIC  X(0015).
  4081*    -------------------------------
  4082     05  FILLER            PIC  X(0003).
  4083     05  B1STNMO PIC  X(0010).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
  4086     05  BINITO PIC  X(0001).
  4087*    -------------------------------
  4088     05  FILLER            PIC  X(0003).
  4089     05  BSEXO PIC  X(0001).
  4090*    -------------------------------
  4091     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  78
* VP6311.cbl
  4092     05  BAGEO PIC  X(0002).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  BBIRTHO PIC  X(0008).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BYEARO PIC  X(0004).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BMAKEO PIC  X(0020).
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BMODELO PIC  X(0020).
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BFUTUREO PIC  X(0020).
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BOMETERO PIC  ZZZ,Z99.
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BMEMCAPO PIC  X(0011).
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BORIGHDO PIC  X(0010).
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
  4119     05  BFORCEO PIC  X(0001).
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
  4122     05  BENTRYO PIC  X(0001).
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  BREINO PIC  X(0001).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  BBILCDO PIC  X(0001).
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  BUNWRITO PIC  X(0001).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  BSKPCDO PIC  X(0001).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BINDGRPO PIC  X(0001).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BSIGO PIC  X(0001).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BRTCLSO PIC  X(0002).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BCHGCNTO PIC  X(0003).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BMEMBERO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  79
* VP6311.cbl
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BLNOFCRO PIC  X(0005).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BKIND1O PIC  X(0002).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BTYPE1O PIC  X(0003).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BTERM1O PIC  X(0003).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BBEN1O PIC  X(0012).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BPREM1O PIC  X(0011).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BEXPIR1O PIC  X(0008).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BCP1O PIC  X(0002).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BALTBN1O PIC  X(0012).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BALTPR1O PIC  X(0011).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BBNCD1O PIC  X(0003).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BCPRM1O PIC  X(0011).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BCAPRM1O PIC  X(0011).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BENABR1O PIC  X(0005).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BDIFF1O PIC  X(0011).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BBILIT1O PIC  X(0008).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BADIFF1O PIC  X(0011).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BKIND2O PIC  X(0002).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BTYPE2O PIC  X(0003).
  4207*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  80
* VP6311.cbl
  4208     05  FILLER            PIC  X(0003).
  4209     05  BTERM2O PIC  X(0003).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BBEN2O PIC  X(0012).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BPREM2O PIC  X(0011).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BEXPIR2O PIC  X(0008).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BCP2O PIC  X(0002).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BALTBN2O PIC  X(0012).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BALTPR2O PIC  X(0011).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BBNCD2O PIC  X(0003).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BCPRM2O PIC  X(0011).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BCAPRM2O PIC  X(0011).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BENABR2O PIC  X(0005).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BDIFF2O PIC  X(0011).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BBILIT2O PIC  X(0008).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BADIFF2O PIC  X(0011).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BERMSG1O PIC  X(0078).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BERMSG2O PIC  X(0078).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BERMSG3O PIC  X(0078).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BPFENTRO PIC  X(0002).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BPF5HDRO PIC  X(0005).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  81
* VP6311.cbl
  4266     05  BPF4HDRO PIC  X(0013).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BF15HDRO PIC  X(0010).
  4270*    -------------------------------
  4271 01  VP631CI REDEFINES VP631BI.
  4272     05  FILLER            PIC  X(0012).
  4273*    -------------------------------
  4274     05  CDATEL PIC S9(0004) COMP.
  4275     05  CDATEF PIC  X(0001).
  4276     05  FILLER REDEFINES CDATEF.
  4277         10  CDATEA PIC  X(0001).
  4278     05  CDATEI PIC  X(0008).
  4279*    -------------------------------
  4280     05  CTIMEL PIC S9(0004) COMP.
  4281     05  CTIMEF PIC  X(0001).
  4282     05  FILLER REDEFINES CTIMEF.
  4283         10  CTIMEA PIC  X(0001).
  4284     05  CTIMEI PIC  X(0005).
  4285*    -------------------------------
  4286     05  CHEADL PIC S9(0004) COMP.
  4287     05  CHEADF PIC  X(0001).
  4288     05  FILLER REDEFINES CHEADF.
  4289         10  CHEADA PIC  X(0001).
  4290     05  CHEADI PIC  X(0038).
  4291*    -------------------------------
  4292     05  CCHGTL PIC S9(0004) COMP.
  4293     05  CCHGTF PIC  X(0001).
  4294     05  FILLER REDEFINES CCHGTF.
  4295         10  CCHGTA PIC  X(0001).
  4296     05  CCHGTI PIC  X(0004).
  4297*    -------------------------------
  4298     05  CCHGL PIC S9(0004) COMP.
  4299     05  CCHGF PIC  X(0001).
  4300     05  FILLER REDEFINES CCHGF.
  4301         10  CCHGA PIC  X(0001).
  4302     05  CCHGI PIC  X(0004).
  4303*    -------------------------------
  4304     05  CMAINTL PIC S9(0004) COMP.
  4305     05  CMAINTF PIC  X(0001).
  4306     05  FILLER REDEFINES CMAINTF.
  4307         10  CMAINTA PIC  X(0001).
  4308     05  CMAINTI PIC  X(0001).
  4309*    -------------------------------
  4310     05  CMANTBYL PIC S9(0004) COMP.
  4311     05  CMANTBYF PIC  X(0001).
  4312     05  FILLER REDEFINES CMANTBYF.
  4313         10  CMANTBYA PIC  X(0001).
  4314     05  CMANTBYI PIC  X(0004).
  4315*    -------------------------------
  4316     05  CCHGHDGL PIC S9(0004) COMP.
  4317     05  CCHGHDGF PIC  X(0001).
  4318     05  FILLER REDEFINES CCHGHDGF.
  4319         10  CCHGHDGA PIC  X(0001).
  4320     05  CCHGHDGI PIC  X(0003).
  4321*    -------------------------------
  4322     05  CMANTDTL PIC S9(0004) COMP.
  4323     05  CMANTDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  82
* VP6311.cbl
  4324     05  FILLER REDEFINES CMANTDTF.
  4325         10  CMANTDTA PIC  X(0001).
  4326     05  CMANTDTI PIC  X(0008).
  4327*    -------------------------------
  4328     05  CMANTATL PIC S9(0004) COMP.
  4329     05  CMANTATF PIC  X(0001).
  4330     05  FILLER REDEFINES CMANTATF.
  4331         10  CMANTATA PIC  X(0001).
  4332     05  CMANTATI PIC  X(0005).
  4333*    -------------------------------
  4334     05  CCSRL PIC S9(0004) COMP.
  4335     05  CCSRF PIC  X(0001).
  4336     05  FILLER REDEFINES CCSRF.
  4337         10  CCSRA PIC  X(0001).
  4338     05  CCSRI PIC  X(0004).
  4339*    -------------------------------
  4340     05  CBATCHL PIC S9(0004) COMP.
  4341     05  CBATCHF PIC  X(0001).
  4342     05  FILLER REDEFINES CBATCHF.
  4343         10  CBATCHA PIC  X(0001).
  4344     05  CBATCHI PIC  X(0006).
  4345*    -------------------------------
  4346     05  CSEQL PIC S9(0004) COMP.
  4347     05  CSEQF PIC  X(0001).
  4348     05  FILLER REDEFINES CSEQF.
  4349         10  CSEQA PIC  X(0001).
  4350     05  CSEQI PIC  X(0004).
  4351*    -------------------------------
  4352     05  CMOENDTL PIC S9(0004) COMP.
  4353     05  CMOENDTF PIC  X(0001).
  4354     05  FILLER REDEFINES CMOENDTF.
  4355         10  CMOENDTA PIC  X(0001).
  4356     05  CMOENDTI PIC  X(0008).
  4357*    -------------------------------
  4358     05  CCARRL PIC S9(0004) COMP.
  4359     05  CCARRF PIC  X(0001).
  4360     05  FILLER REDEFINES CCARRF.
  4361         10  CCARRA PIC  X(0001).
  4362     05  CCARRI PIC  X(0001).
  4363*    -------------------------------
  4364     05  CGROUPL PIC S9(0004) COMP.
  4365     05  CGROUPF PIC  X(0001).
  4366     05  FILLER REDEFINES CGROUPF.
  4367         10  CGROUPA PIC  X(0001).
  4368     05  CGROUPI PIC  X(0006).
  4369*    -------------------------------
  4370     05  CSTATEL PIC S9(0004) COMP.
  4371     05  CSTATEF PIC  X(0001).
  4372     05  FILLER REDEFINES CSTATEF.
  4373         10  CSTATEA PIC  X(0001).
  4374     05  CSTATEI PIC  X(0002).
  4375*    -------------------------------
  4376     05  CACCTL PIC S9(0004) COMP.
  4377     05  CACCTF PIC  X(0001).
  4378     05  FILLER REDEFINES CACCTF.
  4379         10  CACCTA PIC  X(0001).
  4380     05  CACCTI PIC  X(0010).
  4381*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  83
* VP6311.cbl
  4382     05  CORIGHDL PIC S9(0004) COMP.
  4383     05  CORIGHDF PIC  X(0001).
  4384     05  FILLER REDEFINES CORIGHDF.
  4385         10  CORIGHDA PIC  X(0001).
  4386     05  CORIGHDI PIC  X(0011).
  4387*    -------------------------------
  4388     05  CORGNOL PIC S9(0004) COMP.
  4389     05  CORGNOF PIC  X(0001).
  4390     05  FILLER REDEFINES CORGNOF.
  4391         10  CORGNOA PIC  X(0001).
  4392     05  CORGNOI PIC  X(0006).
  4393*    -------------------------------
  4394     05  CORGSEQL PIC S9(0004) COMP.
  4395     05  CORGSEQF PIC  X(0001).
  4396     05  FILLER REDEFINES CORGSEQF.
  4397         10  CORGSEQA PIC  X(0001).
  4398     05  CORGSEQI PIC  X(0004).
  4399*    -------------------------------
  4400     05  CREFHDGL PIC S9(0004) COMP.
  4401     05  CREFHDGF PIC  X(0001).
  4402     05  FILLER REDEFINES CREFHDGF.
  4403         10  CREFHDGA PIC  X(0001).
  4404     05  CREFHDGI PIC  X(0010).
  4405*    -------------------------------
  4406     05  CREFL PIC S9(0004) COMP.
  4407     05  CREFF PIC  X(0001).
  4408     05  FILLER REDEFINES CREFF.
  4409         10  CREFA PIC  X(0001).
  4410     05  CREFI PIC  X(0012).
  4411*    -------------------------------
  4412     05  CNHINTL PIC S9(0004) COMP.
  4413     05  CNHINTF PIC  X(0001).
  4414     05  FILLER REDEFINES CNHINTF.
  4415         10  CNHINTA PIC  X(0001).
  4416     05  CNHINTI PIC  9(7)V99.
  4417*    -------------------------------
  4418     05  CCERTNOL PIC S9(0004) COMP.
  4419     05  CCERTNOF PIC  X(0001).
  4420     05  FILLER REDEFINES CCERTNOF.
  4421         10  CCERTNOA PIC  X(0001).
  4422     05  CCERTNOI PIC  X(0010).
  4423*    -------------------------------
  4424     05  CSUFIXL PIC S9(0004) COMP.
  4425     05  CSUFIXF PIC  X(0001).
  4426     05  FILLER REDEFINES CSUFIXF.
  4427         10  CSUFIXA PIC  X(0001).
  4428     05  CSUFIXI PIC  X(0001).
  4429*    -------------------------------
  4430     05  CEFFDTL PIC S9(0004) COMP.
  4431     05  CEFFDTF PIC  X(0001).
  4432     05  FILLER REDEFINES CEFFDTF.
  4433         10  CEFFDTA PIC  X(0001).
  4434     05  CEFFDTI PIC  X(0008).
  4435*    -------------------------------
  4436     05  CLSTNML PIC S9(0004) COMP.
  4437     05  CLSTNMF PIC  X(0001).
  4438     05  FILLER REDEFINES CLSTNMF.
  4439         10  CLSTNMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  84
* VP6311.cbl
  4440     05  CLSTNMI PIC  X(0015).
  4441*    -------------------------------
  4442     05  CPCYNL PIC S9(0004) COMP.
  4443     05  CPCYNF PIC  X(0001).
  4444     05  FILLER REDEFINES CPCYNF.
  4445         10  CPCYNA PIC  X(0001).
  4446     05  CPCYNI PIC  X(0001).
  4447*    -------------------------------
  4448     05  CINAMEL PIC S9(0004) COMP.
  4449     05  CINAMEF PIC  X(0001).
  4450     05  FILLER REDEFINES CINAMEF.
  4451         10  CINAMEA PIC  X(0001).
  4452     05  CINAMEI PIC  X(0015).
  4453*    -------------------------------
  4454     05  CINITSL PIC S9(0004) COMP.
  4455     05  CINITSF PIC  X(0001).
  4456     05  FILLER REDEFINES CINITSF.
  4457         10  CINITSA PIC  X(0001).
  4458     05  CINITSI PIC  X(0010).
  4459*    -------------------------------
  4460     05  CCANREAL PIC S9(0004) COMP.
  4461     05  CCANREAF PIC  X(0001).
  4462     05  FILLER REDEFINES CCANREAF.
  4463         10  CCANREAA PIC  X(0001).
  4464     05  CCANREAI PIC  X(0001).
  4465*    -------------------------------
  4466     05  CKIND1L PIC S9(0004) COMP.
  4467     05  CKIND1F PIC  X(0001).
  4468     05  FILLER REDEFINES CKIND1F.
  4469         10  CKIND1A PIC  X(0001).
  4470     05  CKIND1I PIC  X(0002).
  4471*    -------------------------------
  4472     05  CCANDT1L PIC S9(0004) COMP.
  4473     05  CCANDT1F PIC  X(0001).
  4474     05  FILLER REDEFINES CCANDT1F.
  4475         10  CCANDT1A PIC  X(0001).
  4476     05  CCANDT1I PIC  X(0008).
  4477*    -------------------------------
  4478     05  CREFND1L PIC S9(0004) COMP.
  4479     05  CREFND1F PIC  X(0001).
  4480     05  FILLER REDEFINES CREFND1F.
  4481         10  CREFND1A PIC  X(0001).
  4482     05  CREFND1I PIC  S9(9)V99.
  4483*    -------------------------------
  4484     05  CMTHD1L PIC S9(0004) COMP.
  4485     05  CMTHD1F PIC  X(0001).
  4486     05  FILLER REDEFINES CMTHD1F.
  4487         10  CMTHD1A PIC  X(0001).
  4488     05  CMTHD1I PIC  X(0001).
  4489*    -------------------------------
  4490     05  CKIND2L PIC S9(0004) COMP.
  4491     05  CKIND2F PIC  X(0001).
  4492     05  FILLER REDEFINES CKIND2F.
  4493         10  CKIND2A PIC  X(0001).
  4494     05  CKIND2I PIC  X(0002).
  4495*    -------------------------------
  4496     05  CCANDT2L PIC S9(0004) COMP.
  4497     05  CCANDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  85
* VP6311.cbl
  4498     05  FILLER REDEFINES CCANDT2F.
  4499         10  CCANDT2A PIC  X(0001).
  4500     05  CCANDT2I PIC  X(0008).
  4501*    -------------------------------
  4502     05  CREFND2L PIC S9(0004) COMP.
  4503     05  CREFND2F PIC  X(0001).
  4504     05  FILLER REDEFINES CREFND2F.
  4505         10  CREFND2A PIC  X(0001).
  4506     05  CREFND2I PIC  S9(9)V99.
  4507*    -------------------------------
  4508     05  CMTHD2L PIC S9(0004) COMP.
  4509     05  CMTHD2F PIC  X(0001).
  4510     05  FILLER REDEFINES CMTHD2F.
  4511         10  CMTHD2A PIC  X(0001).
  4512     05  CMTHD2I PIC  X(0001).
  4513*    -------------------------------
  4514     05  CLIVESL PIC S9(0004) COMP.
  4515     05  CLIVESF PIC  X(0001).
  4516     05  FILLER REDEFINES CLIVESF.
  4517         10  CLIVESA PIC  X(0001).
  4518     05  CLIVESI PIC  X(0003).
  4519*    -------------------------------
  4520     05  CFORCEL PIC S9(0004) COMP.
  4521     05  CFORCEF PIC  X(0001).
  4522     05  FILLER REDEFINES CFORCEF.
  4523         10  CFORCEA PIC  X(0001).
  4524     05  CFORCEI PIC  X(0001).
  4525*    -------------------------------
  4526     05  CBILCDL PIC S9(0004) COMP.
  4527     05  CBILCDF PIC  X(0001).
  4528     05  FILLER REDEFINES CBILCDF.
  4529         10  CBILCDA PIC  X(0001).
  4530     05  CBILCDI PIC  X(0001).
  4531*    -------------------------------
  4532     05  CCRFND1L PIC S9(0004) COMP.
  4533     05  CCRFND1F PIC  X(0001).
  4534     05  FILLER REDEFINES CCRFND1F.
  4535         10  CCRFND1A PIC  X(0001).
  4536     05  CCRFND1I PIC  X(0011).
  4537*    -------------------------------
  4538     05  CCRFND2L PIC S9(0004) COMP.
  4539     05  CCRFND2F PIC  X(0001).
  4540     05  FILLER REDEFINES CCRFND2F.
  4541         10  CCRFND2A PIC  X(0001).
  4542     05  CCRFND2I PIC  X(0011).
  4543*    -------------------------------
  4544     05  CBILIT1L PIC S9(0004) COMP.
  4545     05  CBILIT1F PIC  X(0001).
  4546     05  FILLER REDEFINES CBILIT1F.
  4547         10  CBILIT1A PIC  X(0001).
  4548     05  CBILIT1I PIC  X(0008).
  4549*    -------------------------------
  4550     05  CDRFND1L PIC S9(0004) COMP.
  4551     05  CDRFND1F PIC  X(0001).
  4552     05  FILLER REDEFINES CDRFND1F.
  4553         10  CDRFND1A PIC  X(0001).
  4554     05  CDRFND1I PIC  X(0011).
  4555*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  86
* VP6311.cbl
  4556     05  CBILIT2L PIC S9(0004) COMP.
  4557     05  CBILIT2F PIC  X(0001).
  4558     05  FILLER REDEFINES CBILIT2F.
  4559         10  CBILIT2A PIC  X(0001).
  4560     05  CBILIT2I PIC  X(0008).
  4561*    -------------------------------
  4562     05  CDRFND2L PIC S9(0004) COMP.
  4563     05  CDRFND2F PIC  X(0001).
  4564     05  FILLER REDEFINES CDRFND2F.
  4565         10  CDRFND2A PIC  X(0001).
  4566     05  CDRFND2I PIC  X(0011).
  4567*    -------------------------------
  4568     05  CCANTXTL PIC S9(0004) COMP.
  4569     05  CCANTXTF PIC  X(0001).
  4570     05  FILLER REDEFINES CCANTXTF.
  4571         10  CCANTXTA PIC  X(0001).
  4572     05  CCANTXTI PIC  X(0005).
  4573*    -------------------------------
  4574     05  CCANFEEL PIC S9(0004) COMP.
  4575     05  CCANFEEF PIC  X(0001).
  4576     05  FILLER REDEFINES CCANFEEF.
  4577         10  CCANFEEA PIC  X(0001).
  4578     05  CCANFEEI PIC  X(0002).
  4579*    -------------------------------
  4580     05  CTERM1L PIC S9(0004) COMP.
  4581     05  CTERM1F PIC  X(0001).
  4582     05  FILLER REDEFINES CTERM1F.
  4583         10  CTERM1A PIC  X(0001).
  4584     05  CTERM1I PIC  X(0003).
  4585*    -------------------------------
  4586     05  CRTERM1L PIC S9(0004) COMP.
  4587     05  CRTERM1F PIC  X(0001).
  4588     05  FILLER REDEFINES CRTERM1F.
  4589         10  CRTERM1A PIC  X(0001).
  4590     05  CRTERM1I PIC  X(0003).
  4591*    -------------------------------
  4592     05  CPREM1L PIC S9(0004) COMP.
  4593     05  CPREM1F PIC  X(0001).
  4594     05  FILLER REDEFINES CPREM1F.
  4595         10  CPREM1A PIC  X(0001).
  4596     05  CPREM1I PIC  X(0011).
  4597*    -------------------------------
  4598     05  CTERM2L PIC S9(0004) COMP.
  4599     05  CTERM2F PIC  X(0001).
  4600     05  FILLER REDEFINES CTERM2F.
  4601         10  CTERM2A PIC  X(0001).
  4602     05  CTERM2I PIC  X(0003).
  4603*    -------------------------------
  4604     05  CRTERM2L PIC S9(0004) COMP.
  4605     05  CRTERM2F PIC  X(0001).
  4606     05  FILLER REDEFINES CRTERM2F.
  4607         10  CRTERM2A PIC  X(0001).
  4608     05  CRTERM2I PIC  X(0003).
  4609*    -------------------------------
  4610     05  CPREM2L PIC S9(0004) COMP.
  4611     05  CPREM2F PIC  X(0001).
  4612     05  FILLER REDEFINES CPREM2F.
  4613         10  CPREM2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  87
* VP6311.cbl
  4614     05  CPREM2I PIC  X(0011).
  4615*    -------------------------------
  4616     05  CENTRDTL PIC S9(0004) COMP.
  4617     05  CENTRDTF PIC  X(0001).
  4618     05  FILLER REDEFINES CENTRDTF.
  4619         10  CENTRDTA PIC  X(0001).
  4620     05  CENTRDTI PIC  X(0008).
  4621*    -------------------------------
  4622     05  CPAYEEL PIC S9(0004) COMP.
  4623     05  CPAYEEF PIC  X(0001).
  4624     05  FILLER REDEFINES CPAYEEF.
  4625         10  CPAYEEA PIC  X(0001).
  4626     05  CPAYEEI PIC  X(0006).
  4627*    -------------------------------
  4628     05  CRFNDSWL PIC S9(0004) COMP.
  4629     05  CRFNDSWF PIC  X(0001).
  4630     05  FILLER REDEFINES CRFNDSWF.
  4631         10  CRFNDSWA PIC  X(0001).
  4632     05  CRFNDSWI PIC  X(0003).
  4633*    -------------------------------
  4634     05  CLFHDGL PIC S9(0004) COMP.
  4635     05  CLFHDGF PIC  X(0001).
  4636     05  FILLER REDEFINES CLFHDGF.
  4637         10  CLFHDGA PIC  X(0001).
  4638     05  CLFHDGI PIC  X(0006).
  4639*    -------------------------------
  4640     05  CAHHDGL PIC S9(0004) COMP.
  4641     05  CAHHDGF PIC  X(0001).
  4642     05  FILLER REDEFINES CAHHDGF.
  4643         10  CAHHDGA PIC  X(0001).
  4644     05  CAHHDGI PIC  X(0006).
  4645*    -------------------------------
  4646     05  CENTDTL PIC S9(0004) COMP.
  4647     05  CENTDTF PIC  X(0001).
  4648     05  FILLER REDEFINES CENTDTF.
  4649         10  CENTDTA PIC  X(0001).
  4650     05  CENTDTI PIC  X(0008).
  4651*    -------------------------------
  4652     05  CENTBYL PIC S9(0004) COMP.
  4653     05  CENTBYF PIC  X(0001).
  4654     05  FILLER REDEFINES CENTBYF.
  4655         10  CENTBYA PIC  X(0001).
  4656     05  CENTBYI PIC  X(0004).
  4657*    -------------------------------
  4658     05  CCHGCNTL PIC S9(0004) COMP.
  4659     05  CCHGCNTF PIC  X(0001).
  4660     05  FILLER REDEFINES CCHGCNTF.
  4661         10  CCHGCNTA PIC  X(0001).
  4662     05  CCHGCNTI PIC  X(0003).
  4663*    -------------------------------
  4664     05  CLFREFNL PIC S9(0004) COMP.
  4665     05  CLFREFNF PIC  X(0001).
  4666     05  FILLER REDEFINES CLFREFNF.
  4667         10  CLFREFNA PIC  X(0001).
  4668     05  CLFREFNI PIC  X(0006).
  4669*    -------------------------------
  4670     05  CAHREFNL PIC S9(0004) COMP.
  4671     05  CAHREFNF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  88
* VP6311.cbl
  4672     05  FILLER REDEFINES CAHREFNF.
  4673         10  CAHREFNA PIC  X(0001).
  4674     05  CAHREFNI PIC  X(0006).
  4675*    -------------------------------
  4676     05  CREINCDL PIC S9(0004) COMP.
  4677     05  CREINCDF PIC  X(0001).
  4678     05  FILLER REDEFINES CREINCDF.
  4679         10  CREINCDA PIC  X(0001).
  4680     05  CREINCDI PIC  X(0003).
  4681*    -------------------------------
  4682     05  CAEFFDTL PIC S9(0004) COMP.
  4683     05  CAEFFDTF PIC  X(0001).
  4684     05  FILLER REDEFINES CAEFFDTF.
  4685         10  CAEFFDTA PIC  X(0001).
  4686     05  CAEFFDTI PIC  X(0008).
  4687*    -------------------------------
  4688     05  CAEXPDTL PIC S9(0004) COMP.
  4689     05  CAEXPDTF PIC  X(0001).
  4690     05  FILLER REDEFINES CAEXPDTF.
  4691         10  CAEXPDTA PIC  X(0001).
  4692     05  CAEXPDTI PIC  X(0008).
  4693*    -------------------------------
  4694     05  COMMLFL PIC S9(0004) COMP.
  4695     05  COMMLFF PIC  X(0001).
  4696     05  FILLER REDEFINES COMMLFF.
  4697         10  COMMLFA PIC  X(0001).
  4698     05  COMMLFI PIC  X(0006).
  4699*    -------------------------------
  4700     05  COMMAHL PIC S9(0004) COMP.
  4701     05  COMMAHF PIC  X(0001).
  4702     05  FILLER REDEFINES COMMAHF.
  4703         10  COMMAHA PIC  X(0001).
  4704     05  COMMAHI PIC  X(0006).
  4705*    -------------------------------
  4706     05  CERMSG1L PIC S9(0004) COMP.
  4707     05  CERMSG1F PIC  X(0001).
  4708     05  FILLER REDEFINES CERMSG1F.
  4709         10  CERMSG1A PIC  X(0001).
  4710     05  CERMSG1I PIC  X(0078).
  4711*    -------------------------------
  4712     05  CERMSG2L PIC S9(0004) COMP.
  4713     05  CERMSG2F PIC  X(0001).
  4714     05  FILLER REDEFINES CERMSG2F.
  4715         10  CERMSG2A PIC  X(0001).
  4716     05  CERMSG2I PIC  X(0078).
  4717*    -------------------------------
  4718     05  CERMSG3L PIC S9(0004) COMP.
  4719     05  CERMSG3F PIC  X(0001).
  4720     05  FILLER REDEFINES CERMSG3F.
  4721         10  CERMSG3A PIC  X(0001).
  4722     05  CERMSG3I PIC  X(0078).
  4723*    -------------------------------
  4724     05  CPFENTRL PIC S9(0004) COMP.
  4725     05  CPFENTRF PIC  X(0001).
  4726     05  FILLER REDEFINES CPFENTRF.
  4727         10  CPFENTRA PIC  X(0001).
  4728     05  CPFENTRI PIC  9(2).
  4729*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  89
* VP6311.cbl
  4730     05  CPF5HDRL PIC S9(0004) COMP.
  4731     05  CPF5HDRF PIC  X(0001).
  4732     05  FILLER REDEFINES CPF5HDRF.
  4733         10  CPF5HDRA PIC  X(0001).
  4734     05  CPF5HDRI PIC  X(0005).
  4735*    -------------------------------
  4736     05  CPF4HDRL PIC S9(0004) COMP.
  4737     05  CPF4HDRF PIC  X(0001).
  4738     05  FILLER REDEFINES CPF4HDRF.
  4739         10  CPF4HDRA PIC  X(0001).
  4740     05  CPF4HDRI PIC  X(0013).
  4741*    -------------------------------
  4742     05  CF15HDRL PIC S9(0004) COMP.
  4743     05  CF15HDRF PIC  X(0001).
  4744     05  FILLER REDEFINES CF15HDRF.
  4745         10  CF15HDRA PIC  X(0001).
  4746     05  CF15HDRI PIC  X(0022).
  4747 01  VP631CO REDEFINES VP631BI.
  4748     05  FILLER            PIC  X(0012).
  4749*    -------------------------------
  4750     05  FILLER            PIC  X(0003).
  4751     05  CDATEO PIC  X(0008).
  4752*    -------------------------------
  4753     05  FILLER            PIC  X(0003).
  4754     05  CTIMEO PIC  99.99.
  4755*    -------------------------------
  4756     05  FILLER            PIC  X(0003).
  4757     05  CHEADO PIC  X(0038).
  4758*    -------------------------------
  4759     05  FILLER            PIC  X(0003).
  4760     05  CCHGTO PIC  X(0004).
  4761*    -------------------------------
  4762     05  FILLER            PIC  X(0003).
  4763     05  CCHGO PIC  ZZZ9.
  4764*    -------------------------------
  4765     05  FILLER            PIC  X(0003).
  4766     05  CMAINTO PIC  X(0001).
  4767*    -------------------------------
  4768     05  FILLER            PIC  X(0003).
  4769     05  CMANTBYO PIC  X(0004).
  4770*    -------------------------------
  4771     05  FILLER            PIC  X(0003).
  4772     05  CCHGHDGO PIC  X(0003).
  4773*    -------------------------------
  4774     05  FILLER            PIC  X(0003).
  4775     05  CMANTDTO PIC  X(0008).
  4776*    -------------------------------
  4777     05  FILLER            PIC  X(0003).
  4778     05  CMANTATO PIC  99.99.
  4779*    -------------------------------
  4780     05  FILLER            PIC  X(0003).
  4781     05  CCSRO PIC  X(0004).
  4782*    -------------------------------
  4783     05  FILLER            PIC  X(0003).
  4784     05  CBATCHO PIC  X(0006).
  4785*    -------------------------------
  4786     05  FILLER            PIC  X(0003).
  4787     05  CSEQO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  90
* VP6311.cbl
  4788*    -------------------------------
  4789     05  FILLER            PIC  X(0003).
  4790     05  CMOENDTO PIC  X(0008).
  4791*    -------------------------------
  4792     05  FILLER            PIC  X(0003).
  4793     05  CCARRO PIC  X(0001).
  4794*    -------------------------------
  4795     05  FILLER            PIC  X(0003).
  4796     05  CGROUPO PIC  X(0006).
  4797*    -------------------------------
  4798     05  FILLER            PIC  X(0003).
  4799     05  CSTATEO PIC  X(0002).
  4800*    -------------------------------
  4801     05  FILLER            PIC  X(0003).
  4802     05  CACCTO PIC  X(0010).
  4803*    -------------------------------
  4804     05  FILLER            PIC  X(0003).
  4805     05  CORIGHDO PIC  X(0011).
  4806*    -------------------------------
  4807     05  FILLER            PIC  X(0003).
  4808     05  CORGNOO PIC  X(0006).
  4809*    -------------------------------
  4810     05  FILLER            PIC  X(0003).
  4811     05  CORGSEQO PIC  X(0004).
  4812*    -------------------------------
  4813     05  FILLER            PIC  X(0003).
  4814     05  CREFHDGO PIC  X(0010).
  4815*    -------------------------------
  4816     05  FILLER            PIC  X(0003).
  4817     05  CREFO PIC  X(0012).
  4818*    -------------------------------
  4819     05  FILLER            PIC  X(0003).
  4820     05  CNHINTO PIC  999999.99.
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  CCERTNOO PIC  X(0010).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CSUFIXO PIC  X(0001).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CEFFDTO PIC  X(0008).
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  CLSTNMO PIC  X(0015).
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CPCYNO PIC  X(0001).
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CINAMEO PIC  X(0015).
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  CINITSO PIC  X(0010).
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CCANREAO PIC  X(0001).
  4845*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  91
* VP6311.cbl
  4846     05  FILLER            PIC  X(0003).
  4847     05  CKIND1O PIC  X(0002).
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CCANDT1O PIC  X(0008).
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CREFND1O PIC  Z(7).99-.
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CMTHD1O PIC  X(0001).
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CKIND2O PIC  X(0002).
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  CCANDT2O PIC  X(0008).
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CREFND2O PIC  Z(7).99-.
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CMTHD2O PIC  X(0001).
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CLIVESO PIC  X(0003).
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  CFORCEO PIC  X(0001).
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  CBILCDO PIC  X(0001).
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CCRFND1O PIC  Z(7).99-.
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CCRFND2O PIC  Z(7).99-.
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CBILIT1O PIC  X(0008).
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
  4889     05  CDRFND1O PIC  Z(7).99-.
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CBILIT2O PIC  X(0008).
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  CDRFND2O PIC  Z(7).99-.
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  CCANTXTO PIC  X(0005).
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  CCANFEEO PIC  Z9.
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  92
* VP6311.cbl
  4904     05  CTERM1O PIC  ZZ9.
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CRTERM1O PIC  ZZ9.
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  CPREM1O PIC  ZZZZZZ9.99-.
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  CTERM2O PIC  ZZ9.
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CRTERM2O PIC  ZZ9.
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CPREM2O PIC  ZZZZZZ9.99-.
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CENTRDTO PIC  X(0008).
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CPAYEEO PIC  X(0006).
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CRFNDSWO PIC  X(0003).
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  CLFHDGO PIC  X(0006).
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CAHHDGO PIC  X(0006).
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  CENTDTO PIC  X(0008).
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  CENTBYO PIC  X(0004).
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CCHGCNTO PIC  X(0003).
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  CLFREFNO PIC  X(0006).
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CAHREFNO PIC  X(0006).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CREINCDO PIC  X(0003).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CAEFFDTO PIC  X(0008).
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CAEXPDTO PIC  X(0008).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  COMMLFO PIC  .99999.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  93
* VP6311.cbl
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  COMMAHO PIC  .99999.
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CERMSG1O PIC  X(0078).
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CERMSG2O PIC  X(0078).
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CERMSG3O PIC  X(0078).
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CPFENTRO PIC  X(0002).
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CPF5HDRO PIC  X(0005).
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CPF4HDRO PIC  X(0013).
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CF15HDRO PIC  X(0022).
  4986*    -------------------------------
  4987 01  VP631DI REDEFINES VP631BI.
  4988     05  FILLER            PIC  X(0012).
  4989*    -------------------------------
  4990     05  DDATEL PIC S9(0004) COMP.
  4991     05  DDATEF PIC  X(0001).
  4992     05  FILLER REDEFINES DDATEF.
  4993         10  DDATEA PIC  X(0001).
  4994     05  DDATEI PIC  X(0008).
  4995*    -------------------------------
  4996     05  DTIMEL PIC S9(0004) COMP.
  4997     05  DTIMEF PIC  X(0001).
  4998     05  FILLER REDEFINES DTIMEF.
  4999         10  DTIMEA PIC  X(0001).
  5000     05  DTIMEI PIC  X(0005).
  5001*    -------------------------------
  5002     05  DHEADL PIC S9(0004) COMP.
  5003     05  DHEADF PIC  X(0001).
  5004     05  FILLER REDEFINES DHEADF.
  5005         10  DHEADA PIC  X(0001).
  5006     05  DHEADI PIC  X(0038).
  5007*    -------------------------------
  5008     05  DLDATEL PIC S9(0004) COMP.
  5009     05  DLDATEF PIC  X(0001).
  5010     05  FILLER REDEFINES DLDATEF.
  5011         10  DLDATEA PIC  X(0001).
  5012     05  DLDATEI PIC  X(0010).
  5013*    -------------------------------
  5014     05  DBATCHL PIC S9(0004) COMP.
  5015     05  DBATCHF PIC  X(0001).
  5016     05  FILLER REDEFINES DBATCHF.
  5017         10  DBATCHA PIC  X(0001).
  5018     05  DBATCHI PIC  X(0011).
  5019*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  94
* VP6311.cbl
  5020     05  DACCTNML PIC S9(0004) COMP.
  5021     05  DACCTNMF PIC  X(0001).
  5022     05  FILLER REDEFINES DACCTNMF.
  5023         10  DACCTNMA PIC  X(0001).
  5024     05  DACCTNMI PIC  X(0030).
  5025*    -------------------------------
  5026     05  DPROCDTL PIC S9(0004) COMP.
  5027     05  DPROCDTF PIC  X(0001).
  5028     05  FILLER REDEFINES DPROCDTF.
  5029         10  DPROCDTA PIC  X(0001).
  5030     05  DPROCDTI PIC  X(0008).
  5031*    -------------------------------
  5032     05  DINPUTL PIC S9(0004) COMP.
  5033     05  DINPUTF PIC  X(0001).
  5034     05  FILLER REDEFINES DINPUTF.
  5035         10  DINPUTA PIC  X(0001).
  5036     05  DINPUTI PIC  X(0008).
  5037*    -------------------------------
  5038     05  DMAINDTL PIC S9(0004) COMP.
  5039     05  DMAINDTF PIC  X(0001).
  5040     05  FILLER REDEFINES DMAINDTF.
  5041         10  DMAINDTA PIC  X(0001).
  5042     05  DMAINDTI PIC  X(0008).
  5043*    -------------------------------
  5044     05  DCARRL PIC S9(0004) COMP.
  5045     05  DCARRF PIC  X(0001).
  5046     05  FILLER REDEFINES DCARRF.
  5047         10  DCARRA PIC  X(0001).
  5048     05  DCARRI PIC  X(0001).
  5049*    -------------------------------
  5050     05  DGROUPL PIC S9(0004) COMP.
  5051     05  DGROUPF PIC  X(0001).
  5052     05  FILLER REDEFINES DGROUPF.
  5053         10  DGROUPA PIC  X(0001).
  5054     05  DGROUPI PIC  X(0006).
  5055*    -------------------------------
  5056     05  DSTATEL PIC S9(0004) COMP.
  5057     05  DSTATEF PIC  X(0001).
  5058     05  FILLER REDEFINES DSTATEF.
  5059         10  DSTATEA PIC  X(0001).
  5060     05  DSTATEI PIC  X(0002).
  5061*    -------------------------------
  5062     05  DACCTL PIC S9(0004) COMP.
  5063     05  DACCTF PIC  X(0001).
  5064     05  FILLER REDEFINES DACCTF.
  5065         10  DACCTA PIC  X(0001).
  5066     05  DACCTI PIC  X(0010).
  5067*    -------------------------------
  5068     05  DRECVDTL PIC S9(0004) COMP.
  5069     05  DRECVDTF PIC  X(0001).
  5070     05  FILLER REDEFINES DRECVDTF.
  5071         10  DRECVDTA PIC  X(0001).
  5072     05  DRECVDTI PIC  X(0008).
  5073*    -------------------------------
  5074     05  DCSRL PIC S9(0004) COMP.
  5075     05  DCSRF PIC  X(0001).
  5076     05  FILLER REDEFINES DCSRF.
  5077         10  DCSRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  95
* VP6311.cbl
  5078     05  DCSRI PIC  X(0004).
  5079*    -------------------------------
  5080     05  DREFHDGL PIC S9(0004) COMP.
  5081     05  DREFHDGF PIC  X(0001).
  5082     05  FILLER REDEFINES DREFHDGF.
  5083         10  DREFHDGA PIC  X(0001).
  5084     05  DREFHDGI PIC  X(0010).
  5085*    -------------------------------
  5086     05  DREFL PIC S9(0004) COMP.
  5087     05  DREFF PIC  X(0001).
  5088     05  FILLER REDEFINES DREFF.
  5089         10  DREFA PIC  X(0001).
  5090     05  DREFI PIC  X(0012).
  5091*    -------------------------------
  5092     05  DLFPHDGL PIC S9(0004) COMP.
  5093     05  DLFPHDGF PIC  X(0001).
  5094     05  FILLER REDEFINES DLFPHDGF.
  5095         10  DLFPHDGA PIC  X(0001).
  5096     05  DLFPHDGI PIC  X(0010).
  5097*    -------------------------------
  5098     05  DAHPHDGL PIC S9(0004) COMP.
  5099     05  DAHPHDGF PIC  X(0001).
  5100     05  FILLER REDEFINES DAHPHDGF.
  5101         10  DAHPHDGA PIC  X(0001).
  5102     05  DAHPHDGI PIC  X(0010).
  5103*    -------------------------------
  5104     05  DLFRHDGL PIC S9(0004) COMP.
  5105     05  DLFRHDGF PIC  X(0001).
  5106     05  FILLER REDEFINES DLFRHDGF.
  5107         10  DLFRHDGA PIC  X(0001).
  5108     05  DLFRHDGI PIC  X(0009).
  5109*    -------------------------------
  5110     05  DAHRHDGL PIC S9(0004) COMP.
  5111     05  DAHRHDGF PIC  X(0001).
  5112     05  FILLER REDEFINES DAHRHDGF.
  5113         10  DAHRHDGA PIC  X(0001).
  5114     05  DAHRHDGI PIC  X(0009).
  5115*    -------------------------------
  5116     05  DRISSL PIC S9(0004) COMP.
  5117     05  DRISSF PIC  X(0001).
  5118     05  FILLER REDEFINES DRISSF.
  5119         10  DRISSA PIC  X(0001).
  5120     05  DRISSI PIC  X(0005).
  5121*    -------------------------------
  5122     05  DRLFPRML PIC S9(0004) COMP.
  5123     05  DRLFPRMF PIC  X(0001).
  5124     05  FILLER REDEFINES DRLFPRMF.
  5125         10  DRLFPRMA PIC  X(0001).
  5126     05  DRLFPRMI PIC  S9(9)V99.
  5127*    -------------------------------
  5128     05  DRAHPRML PIC S9(0004) COMP.
  5129     05  DRAHPRMF PIC  X(0001).
  5130     05  FILLER REDEFINES DRAHPRMF.
  5131         10  DRAHPRMA PIC  X(0001).
  5132     05  DRAHPRMI PIC  S9(9)V99.
  5133*    -------------------------------
  5134     05  DRCANCL PIC S9(0004) COMP.
  5135     05  DRCANCF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  96
* VP6311.cbl
  5136     05  FILLER REDEFINES DRCANCF.
  5137         10  DRCANCA PIC  X(0001).
  5138     05  DRCANCI PIC  X(0005).
  5139*    -------------------------------
  5140     05  DRLFRFDL PIC S9(0004) COMP.
  5141     05  DRLFRFDF PIC  X(0001).
  5142     05  FILLER REDEFINES DRLFRFDF.
  5143         10  DRLFRFDA PIC  X(0001).
  5144     05  DRLFRFDI PIC  S9(9)V99.
  5145*    -------------------------------
  5146     05  DRAHRFDL PIC S9(0004) COMP.
  5147     05  DRAHRFDF PIC  X(0001).
  5148     05  FILLER REDEFINES DRAHRFDF.
  5149         10  DRAHRFDA PIC  X(0001).
  5150     05  DRAHRFDI PIC  S9(9)V99.
  5151*    -------------------------------
  5152     05  DEISSL PIC S9(0004) COMP.
  5153     05  DEISSF PIC  X(0001).
  5154     05  FILLER REDEFINES DEISSF.
  5155         10  DEISSA PIC  X(0001).
  5156     05  DEISSI PIC  X(0005).
  5157*    -------------------------------
  5158     05  DELFPRML PIC S9(0004) COMP.
  5159     05  DELFPRMF PIC  X(0001).
  5160     05  FILLER REDEFINES DELFPRMF.
  5161         10  DELFPRMA PIC  X(0001).
  5162     05  DELFPRMI PIC  X(0011).
  5163*    -------------------------------
  5164     05  DEAHPRML PIC S9(0004) COMP.
  5165     05  DEAHPRMF PIC  X(0001).
  5166     05  FILLER REDEFINES DEAHPRMF.
  5167         10  DEAHPRMA PIC  X(0001).
  5168     05  DEAHPRMI PIC  X(0011).
  5169*    -------------------------------
  5170     05  DECANCL PIC S9(0004) COMP.
  5171     05  DECANCF PIC  X(0001).
  5172     05  FILLER REDEFINES DECANCF.
  5173         10  DECANCA PIC  X(0001).
  5174     05  DECANCI PIC  X(0005).
  5175*    -------------------------------
  5176     05  DELFRFDL PIC S9(0004) COMP.
  5177     05  DELFRFDF PIC  X(0001).
  5178     05  FILLER REDEFINES DELFRFDF.
  5179         10  DELFRFDA PIC  X(0001).
  5180     05  DELFRFDI PIC  X(0011).
  5181*    -------------------------------
  5182     05  DEAHRFDL PIC S9(0004) COMP.
  5183     05  DEAHRFDF PIC  X(0001).
  5184     05  FILLER REDEFINES DEAHRFDF.
  5185         10  DEAHRFDA PIC  X(0001).
  5186     05  DEAHRFDI PIC  X(0011).
  5187*    -------------------------------
  5188     05  DCISSL PIC S9(0004) COMP.
  5189     05  DCISSF PIC  X(0001).
  5190     05  FILLER REDEFINES DCISSF.
  5191         10  DCISSA PIC  X(0001).
  5192     05  DCISSI PIC  X(0005).
  5193*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  97
* VP6311.cbl
  5194     05  DCLFPRML PIC S9(0004) COMP.
  5195     05  DCLFPRMF PIC  X(0001).
  5196     05  FILLER REDEFINES DCLFPRMF.
  5197         10  DCLFPRMA PIC  X(0001).
  5198     05  DCLFPRMI PIC  X(0011).
  5199*    -------------------------------
  5200     05  DCAHPRML PIC S9(0004) COMP.
  5201     05  DCAHPRMF PIC  X(0001).
  5202     05  FILLER REDEFINES DCAHPRMF.
  5203         10  DCAHPRMA PIC  X(0001).
  5204     05  DCAHPRMI PIC  X(0011).
  5205*    -------------------------------
  5206     05  DCCANCL PIC S9(0004) COMP.
  5207     05  DCCANCF PIC  X(0001).
  5208     05  FILLER REDEFINES DCCANCF.
  5209         10  DCCANCA PIC  X(0001).
  5210     05  DCCANCI PIC  X(0005).
  5211*    -------------------------------
  5212     05  DCLFRFDL PIC S9(0004) COMP.
  5213     05  DCLFRFDF PIC  X(0001).
  5214     05  FILLER REDEFINES DCLFRFDF.
  5215         10  DCLFRFDA PIC  X(0001).
  5216     05  DCLFRFDI PIC  X(0011).
  5217*    -------------------------------
  5218     05  DCAHRFDL PIC S9(0004) COMP.
  5219     05  DCAHRFDF PIC  X(0001).
  5220     05  FILLER REDEFINES DCAHRFDF.
  5221         10  DCAHRFDA PIC  X(0001).
  5222     05  DCAHRFDI PIC  X(0011).
  5223*    -------------------------------
  5224     05  DOISSL PIC S9(0004) COMP.
  5225     05  DOISSF PIC  X(0001).
  5226     05  FILLER REDEFINES DOISSF.
  5227         10  DOISSA PIC  X(0001).
  5228     05  DOISSI PIC  X(0005).
  5229*    -------------------------------
  5230     05  DOLFPRML PIC S9(0004) COMP.
  5231     05  DOLFPRMF PIC  X(0001).
  5232     05  FILLER REDEFINES DOLFPRMF.
  5233         10  DOLFPRMA PIC  X(0001).
  5234     05  DOLFPRMI PIC  X(0011).
  5235*    -------------------------------
  5236     05  DOAHPRML PIC S9(0004) COMP.
  5237     05  DOAHPRMF PIC  X(0001).
  5238     05  FILLER REDEFINES DOAHPRMF.
  5239         10  DOAHPRMA PIC  X(0001).
  5240     05  DOAHPRMI PIC  X(0011).
  5241*    -------------------------------
  5242     05  DOCANCL PIC S9(0004) COMP.
  5243     05  DOCANCF PIC  X(0001).
  5244     05  FILLER REDEFINES DOCANCF.
  5245         10  DOCANCA PIC  X(0001).
  5246     05  DOCANCI PIC  X(0005).
  5247*    -------------------------------
  5248     05  DOLFRFDL PIC S9(0004) COMP.
  5249     05  DOLFRFDF PIC  X(0001).
  5250     05  FILLER REDEFINES DOLFRFDF.
  5251         10  DOLFRFDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  98
* VP6311.cbl
  5252     05  DOLFRFDI PIC  X(0011).
  5253*    -------------------------------
  5254     05  DOAHRFDL PIC S9(0004) COMP.
  5255     05  DOAHRFDF PIC  X(0001).
  5256     05  FILLER REDEFINES DOAHRFDF.
  5257         10  DOAHRFDA PIC  X(0001).
  5258     05  DOAHRFDI PIC  X(0011).
  5259*    -------------------------------
  5260     05  DITOTALL PIC S9(0004) COMP.
  5261     05  DITOTALF PIC  X(0001).
  5262     05  FILLER REDEFINES DITOTALF.
  5263         10  DITOTALA PIC  X(0001).
  5264     05  DITOTALI PIC  X(0005).
  5265*    -------------------------------
  5266     05  DIFATALL PIC S9(0004) COMP.
  5267     05  DIFATALF PIC  X(0001).
  5268     05  FILLER REDEFINES DIFATALF.
  5269         10  DIFATALA PIC  X(0001).
  5270     05  DIFATALI PIC  X(0005).
  5271*    -------------------------------
  5272     05  DIFORCEL PIC S9(0004) COMP.
  5273     05  DIFORCEF PIC  X(0001).
  5274     05  FILLER REDEFINES DIFORCEF.
  5275         10  DIFORCEA PIC  X(0001).
  5276     05  DIFORCEI PIC  X(0005).
  5277*    -------------------------------
  5278     05  DIHOLDL PIC S9(0004) COMP.
  5279     05  DIHOLDF PIC  X(0001).
  5280     05  FILLER REDEFINES DIHOLDF.
  5281         10  DIHOLDA PIC  X(0001).
  5282     05  DIHOLDI PIC  X(0005).
  5283*    -------------------------------
  5284     05  DIAVAILL PIC S9(0004) COMP.
  5285     05  DIAVAILF PIC  X(0001).
  5286     05  FILLER REDEFINES DIAVAILF.
  5287         10  DIAVAILA PIC  X(0001).
  5288     05  DIAVAILI PIC  X(0005).
  5289*    -------------------------------
  5290     05  DIGPREML PIC S9(0004) COMP.
  5291     05  DIGPREMF PIC  X(0001).
  5292     05  FILLER REDEFINES DIGPREMF.
  5293         10  DIGPREMA PIC  X(0001).
  5294     05  DIGPREMI PIC  X(0011).
  5295*    -------------------------------
  5296     05  DIBPREML PIC S9(0004) COMP.
  5297     05  DIBPREMF PIC  X(0001).
  5298     05  FILLER REDEFINES DIBPREMF.
  5299         10  DIBPREMA PIC  X(0001).
  5300     05  DIBPREMI PIC  X(0011).
  5301*    -------------------------------
  5302     05  DCTOTALL PIC S9(0004) COMP.
  5303     05  DCTOTALF PIC  X(0001).
  5304     05  FILLER REDEFINES DCTOTALF.
  5305         10  DCTOTALA PIC  X(0001).
  5306     05  DCTOTALI PIC  X(0005).
  5307*    -------------------------------
  5308     05  DCFATALL PIC S9(0004) COMP.
  5309     05  DCFATALF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page  99
* VP6311.cbl
  5310     05  FILLER REDEFINES DCFATALF.
  5311         10  DCFATALA PIC  X(0001).
  5312     05  DCFATALI PIC  X(0005).
  5313*    -------------------------------
  5314     05  DCFORCEL PIC S9(0004) COMP.
  5315     05  DCFORCEF PIC  X(0001).
  5316     05  FILLER REDEFINES DCFORCEF.
  5317         10  DCFORCEA PIC  X(0001).
  5318     05  DCFORCEI PIC  X(0005).
  5319*    -------------------------------
  5320     05  DCHOLDL PIC S9(0004) COMP.
  5321     05  DCHOLDF PIC  X(0001).
  5322     05  FILLER REDEFINES DCHOLDF.
  5323         10  DCHOLDA PIC  X(0001).
  5324     05  DCHOLDI PIC  X(0005).
  5325*    -------------------------------
  5326     05  DCAVAILL PIC S9(0004) COMP.
  5327     05  DCAVAILF PIC  X(0001).
  5328     05  FILLER REDEFINES DCAVAILF.
  5329         10  DCAVAILA PIC  X(0001).
  5330     05  DCAVAILI PIC  X(0005).
  5331*    -------------------------------
  5332     05  DCGPREML PIC S9(0004) COMP.
  5333     05  DCGPREMF PIC  X(0001).
  5334     05  FILLER REDEFINES DCGPREMF.
  5335         10  DCGPREMA PIC  X(0001).
  5336     05  DCGPREMI PIC  X(0011).
  5337*    -------------------------------
  5338     05  DCBPREML PIC S9(0004) COMP.
  5339     05  DCBPREMF PIC  X(0001).
  5340     05  FILLER REDEFINES DCBPREMF.
  5341         10  DCBPREMA PIC  X(0001).
  5342     05  DCBPREMI PIC  X(0011).
  5343*    -------------------------------
  5344     05  DNTOTALL PIC S9(0004) COMP.
  5345     05  DNTOTALF PIC  X(0001).
  5346     05  FILLER REDEFINES DNTOTALF.
  5347         10  DNTOTALA PIC  X(0001).
  5348     05  DNTOTALI PIC  X(0005).
  5349*    -------------------------------
  5350     05  DNFATALL PIC S9(0004) COMP.
  5351     05  DNFATALF PIC  X(0001).
  5352     05  FILLER REDEFINES DNFATALF.
  5353         10  DNFATALA PIC  X(0001).
  5354     05  DNFATALI PIC  X(0005).
  5355*    -------------------------------
  5356     05  DNFORCEL PIC S9(0004) COMP.
  5357     05  DNFORCEF PIC  X(0001).
  5358     05  FILLER REDEFINES DNFORCEF.
  5359         10  DNFORCEA PIC  X(0001).
  5360     05  DNFORCEI PIC  X(0005).
  5361*    -------------------------------
  5362     05  DNHOLDL PIC S9(0004) COMP.
  5363     05  DNHOLDF PIC  X(0001).
  5364     05  FILLER REDEFINES DNHOLDF.
  5365         10  DNHOLDA PIC  X(0001).
  5366     05  DNHOLDI PIC  X(0005).
  5367*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 100
* VP6311.cbl
  5368     05  DNAVAILL PIC S9(0004) COMP.
  5369     05  DNAVAILF PIC  X(0001).
  5370     05  FILLER REDEFINES DNAVAILF.
  5371         10  DNAVAILA PIC  X(0001).
  5372     05  DNAVAILI PIC  X(0005).
  5373*    -------------------------------
  5374     05  DNGPREML PIC S9(0004) COMP.
  5375     05  DNGPREMF PIC  X(0001).
  5376     05  FILLER REDEFINES DNGPREMF.
  5377         10  DNGPREMA PIC  X(0001).
  5378     05  DNGPREMI PIC  X(0011).
  5379*    -------------------------------
  5380     05  DNBPREML PIC S9(0004) COMP.
  5381     05  DNBPREMF PIC  X(0001).
  5382     05  FILLER REDEFINES DNBPREMF.
  5383         10  DNBPREMA PIC  X(0001).
  5384     05  DNBPREMI PIC  X(0011).
  5385*    -------------------------------
  5386     05  DERMSGL PIC S9(0004) COMP.
  5387     05  DERMSGF PIC  X(0001).
  5388     05  FILLER REDEFINES DERMSGF.
  5389         10  DERMSGA PIC  X(0001).
  5390     05  DERMSGI PIC  X(0075).
  5391*    -------------------------------
  5392     05  DPFENTRL PIC S9(0004) COMP.
  5393     05  DPFENTRF PIC  X(0001).
  5394     05  FILLER REDEFINES DPFENTRF.
  5395         10  DPFENTRA PIC  X(0001).
  5396     05  DPFENTRI PIC  9(2).
  5397 01  VP631DO REDEFINES VP631BI.
  5398     05  FILLER            PIC  X(0012).
  5399*    -------------------------------
  5400     05  FILLER            PIC  X(0003).
  5401     05  DDATEO PIC  X(0008).
  5402*    -------------------------------
  5403     05  FILLER            PIC  X(0003).
  5404     05  DTIMEO PIC  99.99.
  5405*    -------------------------------
  5406     05  FILLER            PIC  X(0003).
  5407     05  DHEADO PIC  X(0038).
  5408*    -------------------------------
  5409     05  FILLER            PIC  X(0003).
  5410     05  DLDATEO PIC  X(0010).
  5411*    -------------------------------
  5412     05  FILLER            PIC  X(0003).
  5413     05  DBATCHO PIC  X(0011).
  5414*    -------------------------------
  5415     05  FILLER            PIC  X(0003).
  5416     05  DACCTNMO PIC  X(0030).
  5417*    -------------------------------
  5418     05  FILLER            PIC  X(0003).
  5419     05  DPROCDTO PIC  X(0008).
  5420*    -------------------------------
  5421     05  FILLER            PIC  X(0003).
  5422     05  DINPUTO PIC  X(0008).
  5423*    -------------------------------
  5424     05  FILLER            PIC  X(0003).
  5425     05  DMAINDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 101
* VP6311.cbl
  5426*    -------------------------------
  5427     05  FILLER            PIC  X(0003).
  5428     05  DCARRO PIC  X(0001).
  5429*    -------------------------------
  5430     05  FILLER            PIC  X(0003).
  5431     05  DGROUPO PIC  X(0006).
  5432*    -------------------------------
  5433     05  FILLER            PIC  X(0003).
  5434     05  DSTATEO PIC  X(0002).
  5435*    -------------------------------
  5436     05  FILLER            PIC  X(0003).
  5437     05  DACCTO PIC  X(0010).
  5438*    -------------------------------
  5439     05  FILLER            PIC  X(0003).
  5440     05  DRECVDTO PIC  X(0008).
  5441*    -------------------------------
  5442     05  FILLER            PIC  X(0003).
  5443     05  DCSRO PIC  X(0004).
  5444*    -------------------------------
  5445     05  FILLER            PIC  X(0003).
  5446     05  DREFHDGO PIC  X(0010).
  5447*    -------------------------------
  5448     05  FILLER            PIC  X(0003).
  5449     05  DREFO PIC  X(0012).
  5450*    -------------------------------
  5451     05  FILLER            PIC  X(0003).
  5452     05  DLFPHDGO PIC  X(0010).
  5453*    -------------------------------
  5454     05  FILLER            PIC  X(0003).
  5455     05  DAHPHDGO PIC  X(0010).
  5456*    -------------------------------
  5457     05  FILLER            PIC  X(0003).
  5458     05  DLFRHDGO PIC  X(0009).
  5459*    -------------------------------
  5460     05  FILLER            PIC  X(0003).
  5461     05  DAHRHDGO PIC  X(0009).
  5462*    -------------------------------
  5463     05  FILLER            PIC  X(0003).
  5464     05  DRISSO PIC  ZZ99-.
  5465*    -------------------------------
  5466     05  FILLER            PIC  X(0003).
  5467     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5468*    -------------------------------
  5469     05  FILLER            PIC  X(0003).
  5470     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5471*    -------------------------------
  5472     05  FILLER            PIC  X(0003).
  5473     05  DRCANCO PIC  ZZ99-.
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5477*    -------------------------------
  5478     05  FILLER            PIC  X(0003).
  5479     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DEISSO PIC  ZZ99-.
  5483*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 102
* VP6311.cbl
  5484     05  FILLER            PIC  X(0003).
  5485     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DECANCO PIC  ZZ99-.
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
  5500     05  DCISSO PIC  ZZ99-.
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DCCANCO PIC  ZZ99-.
  5510*    -------------------------------
  5511     05  FILLER            PIC  X(0003).
  5512     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5513*    -------------------------------
  5514     05  FILLER            PIC  X(0003).
  5515     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DOISSO PIC  ZZ99-.
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5525*    -------------------------------
  5526     05  FILLER            PIC  X(0003).
  5527     05  DOCANCO PIC  ZZ99-.
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5531*    -------------------------------
  5532     05  FILLER            PIC  X(0003).
  5533     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
  5536     05  DITOTALO PIC  ZZZ99.
  5537*    -------------------------------
  5538     05  FILLER            PIC  X(0003).
  5539     05  DIFATALO PIC  ZZZ99.
  5540*    -------------------------------
  5541     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 103
* VP6311.cbl
  5542     05  DIFORCEO PIC  ZZZ99.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DIHOLDO PIC  ZZZ99.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DIAVAILO PIC  ZZZ99.
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5552*    -------------------------------
  5553     05  FILLER            PIC  X(0003).
  5554     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5555*    -------------------------------
  5556     05  FILLER            PIC  X(0003).
  5557     05  DCTOTALO PIC  ZZZ99.
  5558*    -------------------------------
  5559     05  FILLER            PIC  X(0003).
  5560     05  DCFATALO PIC  ZZZ99.
  5561*    -------------------------------
  5562     05  FILLER            PIC  X(0003).
  5563     05  DCFORCEO PIC  ZZZ99.
  5564*    -------------------------------
  5565     05  FILLER            PIC  X(0003).
  5566     05  DCHOLDO PIC  ZZZ99.
  5567*    -------------------------------
  5568     05  FILLER            PIC  X(0003).
  5569     05  DCAVAILO PIC  ZZZ99.
  5570*    -------------------------------
  5571     05  FILLER            PIC  X(0003).
  5572     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5573*    -------------------------------
  5574     05  FILLER            PIC  X(0003).
  5575     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5576*    -------------------------------
  5577     05  FILLER            PIC  X(0003).
  5578     05  DNTOTALO PIC  ---99.
  5579*    -------------------------------
  5580     05  FILLER            PIC  X(0003).
  5581     05  DNFATALO PIC  ---99.
  5582*    -------------------------------
  5583     05  FILLER            PIC  X(0003).
  5584     05  DNFORCEO PIC  ---99.
  5585*    -------------------------------
  5586     05  FILLER            PIC  X(0003).
  5587     05  DNHOLDO PIC  ---99.
  5588*    -------------------------------
  5589     05  FILLER            PIC  X(0003).
  5590     05  DNAVAILO PIC  ---99.
  5591*    -------------------------------
  5592     05  FILLER            PIC  X(0003).
  5593     05  DNGPREMO PIC  -------9.99.
  5594*    -------------------------------
  5595     05  FILLER            PIC  X(0003).
  5596     05  DNBPREMO PIC  -------9.99.
  5597*    -------------------------------
  5598     05  FILLER            PIC  X(0003).
  5599     05  DERMSGO PIC  X(0075).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 104
* VP6311.cbl
  5600*    -------------------------------
  5601     05  FILLER            PIC  X(0003).
  5602     05  DPFENTRO PIC  X(0002).
  5603*    -------------------------------
  5604 01  MAP-B REDEFINES VP631BI.
  5605     12  FILLER                  PIC X(569).
  5606*    12  FILLER                  PIC X(512).
  5607*    12  FILLER                  PIC X(510).
  5608     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5609         16  BKIND-LEN               PIC S9(4)  COMP.
  5610         16  BKIND-ATTRB             PIC X.
  5611         16  BKIND                   PIC XX.
  5612         16  BTYPE-LEN               PIC S9(4)  COMP.
  5613         16  BTYPE-ATTRB             PIC X.
  5614         16  BTYPE                   PIC X(3).
  5615         16  BTERM-LEN               PIC S9(4)  COMP.
  5616         16  BTERM-ATTRB             PIC X.
  5617         16  BTERMI                  PIC 999.
  5618         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5619         16  BBEN-LEN                PIC S9(4)  COMP.
  5620         16  BBEN-ATTRB              PIC X.
  5621         16  BBENI                   PIC 9(10)V99.
  5622*        16  BBENI                   PIC 9(12).
  5623         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5624         16  BPREM-LEN               PIC S9(4)  COMP.
  5625         16  BPREM-ATTRB             PIC X.
  5626         16  BPREMI                  PIC S9(9)V99.
  5627*        16  BPREMI                  PIC 9(11).
  5628         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5629         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5630         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5631         16  BEXPIRE-ATTRB           PIC X.
  5632         16  BEXPIRE                 PIC X(8).
  5633         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5634         16  BCRIT-PERD-ATTRB        PIC X.
  5635         16  BCRIT-PERDI             PIC 99.
  5636         16  BCRIT-PERDO REDEFINES
  5637                         BCRIT-PERDI PIC ZZ.
  5638         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5639         16  BALT-BEN-ATTRB          PIC X.
  5640         16  BALT-BENI               PIC 9(10)V99.
  5641*        16  BALT-BENI               PIC 9(12).
  5642         16  BALT-BENO REDEFINES
  5643                           BALT-BENI PIC Z(9).ZZ.
  5644         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5645         16  BALT-PREM-ATTRB         PIC X.
  5646         16  BALT-PREMI              PIC 9(9)V99.
  5647*        16  BALT-PREMI              PIC 9(11).
  5648         16  BALT-PREMO REDEFINES
  5649                          BALT-PREMI PIC Z(7).ZZ-.
  5650         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5651         16  BBEN-CD-ATTRB           PIC X.
  5652         16  BBEN-CD                 PIC XXX.
  5653         16  BCPREM-LEN              PIC S9(4)  COMP.
  5654         16  BCPREM-ATTRB            PIC X.
  5655         16  BCPREMI                 PIC S9(9)V99.
  5656*        16  BCPREMI                 PIC X(11).
  5657         16  BCPREMO REDEFINES BCPREMI
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 105
* VP6311.cbl
  5658                                     PIC Z(7).99-.
  5659         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5660         16  BCALT-PREM-ATTRB        PIC X.
  5661         16  BCALT-PREM              PIC Z(7).99-.
  5662         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5663         16  BBEN-ABBR-ATTRB         PIC X.
  5664         16  BBEN-ABBR               PIC X(5).
  5665         16  BDIFF-LEN               PIC S9(4)  COMP.
  5666         16  BDIFF-ATTRB             PIC X.
  5667         16  BDIFFO                  PIC Z(7).99-.
  5668         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5669         16  BBILL-LIT-ATTRB         PIC X.
  5670         16  BBILL-LIT               PIC X(8).
  5671         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5672         16  BDALT-PREM-ATTRB        PIC X.
  5673         16  BDALT-PREM              PIC Z(7).99-.
  5674
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 106
* VP6311.cbl
  5676
  5677****************************************************************
  5678*
  5679* Copyright (c) 2007-2013 Dell Inc.
  5680* All rights reserved.
  5681*
  5682****************************************************************
  5683 01  DFHEIV.
  5684   02  DFHEIV0               PIC X(35).
  5685   02  DFHEIV1               PIC X(08).
  5686   02  DFHEIV2               PIC X(08).
  5687   02  DFHEIV3               PIC X(08).
  5688   02  DFHEIV4               PIC X(06).
  5689   02  DFHEIV5               PIC X(04).
  5690   02  DFHEIV6               PIC X(04).
  5691   02  DFHEIV7               PIC X(02).
  5692   02  DFHEIV8               PIC X(02).
  5693   02  DFHEIV9               PIC X(01).
  5694   02  DFHEIV10              PIC S9(7) COMP-3.
  5695   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5696   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5697   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5698   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5699   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5700   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5701   02  DFHEIV17              PIC X(04).
  5702   02  DFHEIV18              PIC X(04).
  5703   02  DFHEIV19              PIC X(04).
  5704   02  DFHEIV20              USAGE IS POINTER.
  5705   02  DFHEIV21              USAGE IS POINTER.
  5706   02  DFHEIV22              USAGE IS POINTER.
  5707   02  DFHEIV23              USAGE IS POINTER.
  5708   02  DFHEIV24              USAGE IS POINTER.
  5709   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5710   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5711   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5712   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5713   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5714   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5715   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5716   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5717   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5718   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5719   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5720   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5721   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5722   02  FILLER                PIC X(02).
  5723   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5724   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5725   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5726   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5727   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5728   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5729   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5730 LINKAGE  SECTION.
  5731*****************************************************************
  5732*                                                               *
  5733* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 107
* VP6311.cbl
  5734* All rights reserved.                                          *
  5735*                                                               *
  5736*****************************************************************
  5737 01  dfheiblk.
  5738     02  eibtime          pic s9(7) comp-3.
  5739     02  eibdate          pic s9(7) comp-3.
  5740     02  eibtrnid         pic x(4).
  5741     02  eibtaskn         pic s9(7) comp-3.
  5742     02  eibtrmid         pic x(4).
  5743     02  dfheigdi         pic s9(4) comp.
  5744     02  eibcposn         pic s9(4) comp.
  5745     02  eibcalen         pic s9(4) comp.
  5746     02  eibaid           pic x(1).
  5747     02  eibfiller1       pic x(1).
  5748     02  eibfn            pic x(2).
  5749     02  eibfiller2       pic x(2).
  5750     02  eibrcode         pic x(6).
  5751     02  eibfiller3       pic x(2).
  5752     02  eibds            pic x(8).
  5753     02  eibreqid         pic x(8).
  5754     02  eibrsrce         pic x(8).
  5755     02  eibsync          pic x(1).
  5756     02  eibfree          pic x(1).
  5757     02  eibrecv          pic x(1).
  5758     02  eibsend          pic x(1).
  5759     02  eibatt           pic x(1).
  5760     02  eibeoc           pic x(1).
  5761     02  eibfmh           pic x(1).
  5762     02  eibcompl         pic x(1).
  5763     02  eibsig           pic x(1).
  5764     02  eibconf          pic x(1).
  5765     02  eiberr           pic x(1).
  5766     02  eibrldbk         pic x(1).
  5767     02  eiberrcd         pic x(4).
  5768     02  eibsynrb         pic x(1).
  5769     02  eibnodat         pic x(1).
  5770     02  eibfiller5       pic x(2).
  5771     02  eibresp          pic s9(8) comp.
  5772     02  eibresp2         pic s9(8) comp.
  5773     02  dfheigdj         pic s9(4) comp.
  5774     02  dfheigdk         pic s9(4) comp.
  5775 01  DFHCOMMAREA                 PIC X(1300).
  5776*                                COPY ERCPNDB.
  5777******************************************************************
  5778*                                                                *
  5779*                                                                *
  5780*                            ERCPNDB.                            *
  5781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5782*                            VMOD=2.025                          *
  5783*                                                                *
  5784*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5785*                                                                *
  5786******************************************************************
  5787*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5788*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5789******************************************************************
  5790*                                                                *
  5791*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 108
* VP6311.cbl
  5792*   FILE TYPE = VSAM,KSDS                                        *
  5793*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5794*                                                                *
  5795*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5796*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5797*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5798*                                                 RKP=13,LEN=36  *
  5799*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5800*                                      AND CHG-SEQ.)             *
  5801*                                                RKP=49,LEN=11   *
  5802*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5803*                                      AND CHG-SEQ.)             *
  5804*                                                RKP=60,LEN=15   *
  5805*                                                                *
  5806*   LOG = NO                                                     *
  5807*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5808******************************************************************
  5809******************************************************************
  5810*                   C H A N G E   L O G
  5811*
  5812* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5813*-----------------------------------------------------------------
  5814*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5815* EFFECTIVE    NUMBER
  5816*-----------------------------------------------------------------
  5817* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5818* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5819* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5820* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5821* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5822* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5823* 032306                   PEMA  ADD BOW LOAN NUMBER
  5824* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5825* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5826* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5827* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5828* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5829* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5830* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5831* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5832* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5833* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5834* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  5835* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5836******************************************************************
  5837
  5838 01  PENDING-BUSINESS.
  5839     12  PB-RECORD-ID                     PIC XX.
  5840         88  VALID-PB-ID                        VALUE 'PB'.
  5841
  5842     12  PB-CONTROL-PRIMARY.
  5843         16  PB-COMPANY-CD                PIC X.
  5844         16  PB-ENTRY-BATCH               PIC X(6).
  5845         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5846         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5847
  5848     12  PB-CONTROL-BY-ACCOUNT.
  5849         16  PB-COMPANY-CD-A1             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 109
* VP6311.cbl
  5850         16  PB-CARRIER                   PIC X.
  5851         16  PB-GROUPING.
  5852             20  PB-GROUPING-PREFIX       PIC XXX.
  5853             20  PB-GROUPING-PRIME        PIC XXX.
  5854         16  PB-STATE                     PIC XX.
  5855         16  PB-ACCOUNT.
  5856             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5857             20  PB-ACCOUNT-PRIME         PIC X(6).
  5858         16  PB-CERT-EFF-DT               PIC XX.
  5859         16  PB-CERT-NO.
  5860             20  PB-CERT-PRIME            PIC X(10).
  5861             20  PB-CERT-SFX              PIC X.
  5862         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5863
  5864         16  PB-RECORD-TYPE               PIC X.
  5865             88  PB-MAILING-DATA                VALUE '0'.
  5866             88  PB-ISSUE                       VALUE '1'.
  5867             88  PB-CANCELLATION                VALUE '2'.
  5868             88  PB-BATCH-TRAILER               VALUE '9'.
  5869
  5870     12  PB-CONTROL-BY-ORIG-BATCH.
  5871         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5872         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5873         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5874         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5875
  5876     12  PB-CONTROL-BY-CSR.
  5877         16  PB-CSR-COMPANY-CD            PIC X.
  5878         16  PB-CSR-ID                    PIC X(4).
  5879         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5880         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5881         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5882******************************************************************
  5883*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5884******************************************************************
  5885
  5886     12  PB-LAST-MAINT-DT                 PIC XX.
  5887     12  PB-LAST-MAINT-BY                 PIC X(4).
  5888     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5889
  5890     12  PB-RECORD-BODY                   PIC X(375).
  5891
  5892     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5893         16  PB-CERT-ORIGIN               PIC X.
  5894             88  CLASIC-CREATED-CERT         VALUE '1'.
  5895         16  PB-I-NAME.
  5896             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5897             20  PB-I-INSURED-FIRST-NAME.
  5898                 24  PB-I-INSURED-1ST-INIT PIC X.
  5899                 24  FILLER                PIC X(9).
  5900             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5901         16  PB-I-AGE                     PIC S99   COMP-3.
  5902         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5903         16  PB-I-BIRTHDAY                PIC XX.
  5904         16  PB-I-INSURED-SEX             PIC X.
  5905             88  PB-SEX-MALE     VALUE 'M'.
  5906             88  PB-SEX-FEMALE   VALUE 'F'.
  5907
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 110
* VP6311.cbl
  5908         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5909         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5910         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5911         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5912         16  PB-I-SKIP-CODE               PIC X.
  5913             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5914             88  PB-SKIP-JULY              VALUE '1'.
  5915             88  PB-SKIP-AUGUST            VALUE '2'.
  5916             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5917             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5918             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5919             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5920             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5921             88  PB-SKIP-JUNE              VALUE '8'.
  5922             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5923             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5924             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5925         16  PB-I-TERM-TYPE               PIC X.
  5926             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5927             88  PB-PAID-WEEKLY            VALUE 'W'.
  5928             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5929             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5930             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5931         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5932         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5933         16  PB-I-DATA-ENTRY-SW           PIC X.
  5934             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5935             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5936             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5937             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5938         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5939         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5940*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5941         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5942         16  FILLER                       PIC X.
  5943
  5944         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5945             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5946             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5947                                                   '90' THRU '99'.
  5948         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5949                                          PIC XX.
  5950         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5951         16  PB-I-AMOUNT-FINANCED REDEFINES
  5952                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5953         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5954         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5955                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5956         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5957         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5958         16  PB-I-CLP-AMOUNT REDEFINES
  5959                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5960         16  PB-I-LF-CALC-FLAG            PIC X.
  5961             88 PB-COMP-LF-PREM               VALUE '?'.
  5962         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5963         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5964         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5965         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 111
* VP6311.cbl
  5966         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5967         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5968         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5969         16  PB-I-LF-ABBR                 PIC XXX.
  5970         16  PB-I-LF-INPUT-CD             PIC XX.
  5971
  5972         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5973             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5974             88  PB-INVALID-AH               VALUE '  ' '00'
  5975                                                   '90' THRU '99'.
  5976         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5977         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5978         16  PB-I-AH-CALC-FLAG            PIC X.
  5979             88 PB-COMP-AH-PREM                  VALUE '?'.
  5980         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5981         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5982         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  5983         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5984         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5985         16  PB-I-AH-ABBR                 PIC XXX.
  5986         16  PB-I-AH-INPUT-CD             PIC XXX.
  5987
  5988         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5989         16  PB-I-REIN-TABLE              PIC XXX.
  5990         16  PB-I-BUSINESS-TYPE           PIC 99.
  5991         16  PB-I-INDV-GRP-CD             PIC X.
  5992         16  PB-I-MORT-CODE.
  5993             20  PB-I-TABLE               PIC X.
  5994             20  PB-I-INTEREST            PIC XX.
  5995             20  PB-I-MORT-TYP            PIC X.
  5996         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5997         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5998         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5999         16  PB-I-INDV-GRP-OVRD           PIC X.
  6000         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6001         16  PB-I-SIG-SW                  PIC X.
  6002             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6003         16  PB-I-RATE-CLASS              PIC XX.
  6004         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6005         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6006         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6007         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6008         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6009         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6010         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6011         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6012         16  PB-I-OB-FLAG                 PIC X.
  6013             88  PB-I-OB                      VALUE 'B'.
  6014             88  PB-I-SUMMARY                 VALUE 'Z'.
  6015         16  PB-I-ENTRY-STATUS            PIC X.
  6016             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6017                                              'M' '5' '9' '2'.
  6018             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6019             88  PB-I-POLICY-PENDING          VALUE '2'.
  6020             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6021             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6022             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6023             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 112
* VP6311.cbl
  6024             88  PB-I-REIN-ONLY               VALUE '9'.
  6025             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6026             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6027             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6028             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6029         16  PB-I-INT-CODE                PIC X.
  6030             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6031             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6032         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6033         16  PB-I-SOC-SEC-NO              PIC X(11).
  6034         16  PB-I-MEMBER-NO               PIC X(12).
  6035         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6036*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6037         16  PB-I-OLD-LOF                 PIC XXX.
  6038         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6039         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6040         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6041         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6042         16  PB-I-LIFE-INDICATOR          PIC X.
  6043             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6044         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6045         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6046                                          PIC S9(5)V99    COMP-3.
  6047         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6048             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6049             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6050         16  PB-I-1ST-PMT-DT              PIC XX.
  6051         16  PB-I-JOINT-INSURED.
  6052             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6053             20 PB-I-JOINT-FIRST-NAME.
  6054                24  PB-I-JOINT-FIRST-INIT PIC X.
  6055                24  FILLER                PIC X(9).
  6056             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6057*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6058         16  PB-I-BENEFICIARY-NAME.
  6059             20  PB-I-BANK-NUMBER         PIC X(10).
  6060             20  FILLER                   PIC X(15).
  6061         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6062         16  PB-I-REFERENCE               PIC X(12).
  6063         16  FILLER REDEFINES PB-I-REFERENCE.
  6064             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6065             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6066             20  PB-I-CLP-STATE           PIC XX.
  6067         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6068             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6069             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6070             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6071         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6072         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6073         16  PB-I-RESIDENT-STATE          PIC XX.
  6074         16  PB-I-RATE-CODE               PIC X(4).
  6075         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6076         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6077         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6078         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6079         16  PB-I-BANK-NOCHRGB            PIC 99.
  6080         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6081         16  PB-I-JOINT-BIRTHDAY          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 113
* VP6311.cbl
  6082
  6083     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6084         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6085             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6086         16  PB-C-CANCEL-ORIGIN           PIC X.
  6087             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6088         16  PB-C-LF-CANCEL-DT            PIC XX.
  6089         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6090         16  PB-C-LF-CALC-REQ             PIC X.
  6091             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6092         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6093         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6094         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6095             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6096         16  PB-C-AH-CANCEL-DT            PIC XX.
  6097         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6098         16  PB-C-AH-CALC-REQ             PIC X.
  6099             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6100         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6101         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6102         16  PB-C-LAST-NAME               PIC X(15).
  6103         16  PB-C-REFUND-SW               PIC X.
  6104             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6105             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6106         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6107         16  PB-C-PAYEE-CODE              PIC X(6).
  6108         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6109         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6110         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6111         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6112         16  PB-C-REFERENCE               PIC X(12).
  6113         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6114         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6115         16  PB-C-POST-CARD-IND           PIC X.
  6116         16  PB-C-CANCEL-REASON           PIC X.
  6117         16  PB-C-REF-INTERFACE-SW        PIC X.
  6118         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6119         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6120         16  FILLER                       PIC X(01).
  6121*        16  FILLER                       PIC X(18).
  6122         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6123*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6124         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6125         16  PB-CANCELED-CERT-DATA.
  6126             20  PB-CI-INSURED-NAME.
  6127                 24  PB-CI-LAST-NAME      PIC X(15).
  6128                 24  PB-CI-INITIALS       PIC XX.
  6129             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6130             20  PB-CI-INSURED-SEX        PIC X.
  6131             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6132             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6133             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6134             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6135             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6136             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6137             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6138             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6139             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 114
* VP6311.cbl
  6140             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6141             20  PB-CI-RATE-CLASS         PIC XX.
  6142             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6143             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6144             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6145             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6146             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6147             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6148             20  PB-CI-LF-ABBR            PIC X(3).
  6149             20  PB-CI-AH-ABBR            PIC X(3).
  6150             20  PB-CI-OB-FLAG            PIC X.
  6151                 88  PB-CI-OB                VALUE 'B'.
  6152             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6153                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6154                                           'M' '4' '5' '9' '2'.
  6155                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6156                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6157                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6158                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6159                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6160                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6161                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6162                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6163                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6164                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6165                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6166                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6167                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6168             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6169                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6170                                           'M' '4' '5' '9' '2'.
  6171                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6172                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6173                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6174                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6175                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6176                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6177                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6178                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6179                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6180                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6181                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6182                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6183                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6184             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6185             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6186             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6187             20  PB-CI-MEMBER-NO          PIC X(12).
  6188             20  PB-CI-INT-CODE           PIC X.
  6189                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6190                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6191             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6192             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6193             20  PB-CI-COMP-EXCP-SW       PIC X.
  6194                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6195                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6196             20  PB-CI-ENTRY-STATUS       PIC X.
  6197             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 115
* VP6311.cbl
  6198             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6199             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6200             20  PB-CI-DEATH-DT           PIC XX.
  6201             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6202             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6203             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6204             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6205             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6206             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6207             20  PB-CI-ENTRY-DT              PIC XX.
  6208             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6209             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6210             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6211             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6212             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6213             20  PB-CI-OLD-LOF               PIC XXX.
  6214*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6215             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6216             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6217             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6218             20  PB-CI-INDV-GRP-CD           PIC X.
  6219             20  PB-CI-BENEFICIARY-NAME.
  6220                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6221                 24  FILLER                  PIC X(15).
  6222             20  PB-CI-NOTE-SW               PIC X.
  6223             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6224             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6225             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6226             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6227             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6228             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6229             20  PB-CI-FIRST-NAME            PIC X(10).
  6230             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6231
  6232         16  FILLER                       PIC X(13).
  6233*032306  16  FILLER                       PIC X(27).
  6234*        16  FILLER                       PIC X(46).
  6235
  6236     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6237         16  FILLER                       PIC X(10).
  6238         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6239         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6240         16  PB-M-INSURED-MID-INIT        PIC X.
  6241         16  PB-M-INSURED-AGE             PIC 99.
  6242         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6243         16  PB-M-INSURED-SEX             PIC X.
  6244         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6245         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6246         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6247         16  PB-M-INSURED-CITY-STATE.
  6248             20  PB-M-INSURED-CITY        PIC X(28).
  6249             20  PB-M-INSURED-STATE       PIC XX.
  6250         16  PB-M-INSURED-ZIP-CODE.
  6251             20  PB-M-INSURED-ZIP-PRIME.
  6252                 24  PB-M-INSURED-ZIP-1   PIC X.
  6253                     88  PB-M-CANADIAN-POST-CODE
  6254                                             VALUE 'A' THRU 'Z'.
  6255                 24  FILLER               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 116
* VP6311.cbl
  6256             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6257         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6258                                        PB-M-INSURED-ZIP-CODE.
  6259             20  PM-M-INS-CAN-POST1       PIC XXX.
  6260             20  PM-M-INS-CAN-POST2       PIC XXX.
  6261             20  FILLER                   PIC XXX.
  6262         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6263         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6264         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6265         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6266         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6267         16  PB-M-CRED-BENE-CITYST.
  6268             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6269             20  PB-M-CRED-BENE-STATE     PIC XX.
  6270         16  FILLER                       PIC X(92).
  6271
  6272     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6273         16  FILLER                       PIC X(10).
  6274         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6275         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6276         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6277         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6278         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6279         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6280         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6281         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6282         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6283         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6284         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6285         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6286         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6287         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6288         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6289         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6290         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6291         16  PB-ACCOUNT-NAME              PIC X(30).
  6292         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6293         16  PB-REFERENCE                 PIC X(12).
  6294         16  PB-B-RECEIVED-DT             PIC XX.
  6295         16  FILLER                       PIC X(234).
  6296
  6297     12  PB-RECORD-STATUS.
  6298         16  PB-CREDIT-SELECT-DT          PIC XX.
  6299         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6300         16  PB-BILLED-DT                 PIC XX.
  6301         16  PB-BILLING-STATUS            PIC X.
  6302             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6303             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6304             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6305         16  PB-RECORD-BILL               PIC X.
  6306             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6307             88  PB-RECORD-RETURNED           VALUE 'R'.
  6308             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6309             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6310             88  PB-OVERRIDE-AH               VALUE 'A'.
  6311             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6312         16  PB-BATCH-ENTRY               PIC X.
  6313             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 117
* VP6311.cbl
  6314             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6315             88  PB-REISSUED-CERT             VALUE 'E'.
  6316             88  PB-CASH-CERT                 VALUE 'C'.
  6317             88  PB-MONTHLY-CERT              VALUE 'M'.
  6318             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6319             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6320             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6321         16  PB-FORCE-CODE                PIC X.
  6322             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6323             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6324             88  PB-CANCEL-FORCE              VALUE '8'.
  6325             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6326             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6327             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6328             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6329             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6330             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6331             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6332             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6333         16  PB-FATAL-FLAG                PIC X.
  6334             88  PB-FATAL-ERRORS              VALUE 'X'.
  6335         16  PB-FORCE-ER-CD               PIC X.
  6336             88  PB-FORCE-ERRORS              VALUE 'F'.
  6337             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6338         16  PB-WARN-ER-CD                PIC X.
  6339             88  PB-WARNING-ERRORS            VALUE 'W'.
  6340         16  FILLER                       PIC X.
  6341         16  PB-OUT-BAL-CD                PIC X.
  6342             88  PB-OUT-OF-BAL                VALUE 'O'.
  6343         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6344         16  PB-AH-OVERRIDE-L1            PIC X.
  6345         16  PB-INPUT-DT                  PIC XX.
  6346         16  PB-INPUT-BY                  PIC X(4).
  6347         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6348         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6349         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6350         16  PB-LF-EARNING-METHOD         PIC X.
  6351         16  PB-AH-EARNING-METHOD         PIC X.
  6352         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6353         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6354         16  PB-REIN-CD                   PIC XXX.
  6355         16  PB-LF-REFUND-TYPE            PIC X.
  6356         16  PB-AH-REFUND-TYPE            PIC X.
  6357         16  PB-ACCT-EFF-DT               PIC XX.
  6358         16  PB-ACCT-EXP-DT               PIC XX.
  6359         16  PB-COMPANY-ID                PIC X(3).
  6360         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6361         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6362         16  PB-SV-CARRIER                PIC X.
  6363         16  PB-SV-GROUPING               PIC X(6).
  6364         16  PB-SV-STATE                  PIC XX.
  6365         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6366         16  PB-GA-BILLING-INFO.
  6367             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6368                                          PIC XX.
  6369         16  PB-SV-REMIT-TO  REDEFINES
  6370             PB-GA-BILLING-INFO           PIC X(10).
  6371         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 118
* VP6311.cbl
  6372         16  PB-I-LOAN-OFFICER            PIC X(5).
  6373         16  PB-I-VIN                     PIC X(17).
  6374
  6375         16  FILLER                       PIC X(04).
  6376         16  IMNET-BYPASS-SW              PIC X.
  6377
  6378******************************************************************
  6379*                COMMON EDIT ERRORS                              *
  6380******************************************************************
  6381
  6382     12  PB-COMMON-ERRORS.
  6383         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6384                                           PIC S9(4)     COMP.
  6385
  6386******************************************************************
  6387*                                COPY ELCCERT.
  6388******************************************************************
  6389*                                                                *
  6390*                            ELCCERT.                            *
  6391*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6392*                            VMOD=2.013                          *
  6393*                                                                *
  6394*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6395*                                                                *
  6396*   FILE TYPE = VSAM,KSDS                                        *
  6397*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6398*                                                                *
  6399*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6400*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6401*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6402*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6403*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6404*                                                                *
  6405*   LOG = YES                                                    *
  6406*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6407******************************************************************
  6408*                   C H A N G E   L O G
  6409*
  6410* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6411*-----------------------------------------------------------------
  6412*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6413* EFFECTIVE    NUMBER
  6414*-----------------------------------------------------------------
  6415* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6416* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6417* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6418* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6419* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6420* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6421* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6422* 032612  CR2011110200001  PEMA  AHL CHANGES
  6423* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6424* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6425* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6426******************************************************************
  6427
  6428 01  CERTIFICATE-MASTER.
  6429     12  CM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 119
* VP6311.cbl
  6430         88  VALID-CM-ID                      VALUE 'CM'.
  6431
  6432     12  CM-CONTROL-PRIMARY.
  6433         16  CM-COMPANY-CD                 PIC X.
  6434         16  CM-CARRIER                    PIC X.
  6435         16  CM-GROUPING.
  6436             20  CM-GROUPING-PREFIX        PIC X(3).
  6437             20  CM-GROUPING-PRIME         PIC X(3).
  6438         16  CM-STATE                      PIC XX.
  6439         16  CM-ACCOUNT.
  6440             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6441             20  CM-ACCOUNT-PRIME          PIC X(6).
  6442         16  CM-CERT-EFF-DT                PIC XX.
  6443         16  CM-CERT-NO.
  6444             20  CM-CERT-PRIME             PIC X(10).
  6445             20  CM-CERT-SFX               PIC X.
  6446
  6447     12  CM-CONTROL-BY-NAME.
  6448         16  CM-COMPANY-CD-A1              PIC X.
  6449         16  CM-INSURED-LAST-NAME          PIC X(15).
  6450         16  CM-INSURED-INITIALS.
  6451             20  CM-INSURED-INITIAL1       PIC X.
  6452             20  CM-INSURED-INITIAL2       PIC X.
  6453
  6454     12  CM-CONTROL-BY-SSN.
  6455         16  CM-COMPANY-CD-A2              PIC X.
  6456         16  CM-SOC-SEC-NO.
  6457             20  CM-SSN-STATE              PIC XX.
  6458             20  CM-SSN-ACCOUNT            PIC X(6).
  6459             20  CM-SSN-LN3.
  6460                 25  CM-INSURED-INITIALS-A2.
  6461                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6462                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6463                 25 CM-PART-LAST-NAME-A2         PIC X.
  6464
  6465     12  CM-CONTROL-BY-CERT-NO.
  6466         16  CM-COMPANY-CD-A4              PIC X.
  6467         16  CM-CERT-NO-A4                 PIC X(11).
  6468
  6469     12  CM-CONTROL-BY-MEMB.
  6470         16  CM-COMPANY-CD-A5              PIC X.
  6471         16  CM-MEMBER-NO.
  6472             20  CM-MEMB-STATE             PIC XX.
  6473             20  CM-MEMB-ACCOUNT           PIC X(6).
  6474             20  CM-MEMB-LN4.
  6475                 25  CM-INSURED-INITIALS-A5.
  6476                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6477                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6478                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6479
  6480     12  CM-INSURED-PROFILE-DATA.
  6481         16  CM-INSURED-FIRST-NAME.
  6482             20  CM-INSURED-1ST-INIT       PIC X.
  6483             20  FILLER                    PIC X(9).
  6484         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6485         16  CM-INSURED-SEX                PIC X.
  6486             88  CM-SEX-MALE                  VALUE 'M'.
  6487             88  CM-SEX-FEMAL                 VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 120
* VP6311.cbl
  6488         16  CM-INSURED-JOINT-AGE          PIC 99.
  6489         16  CM-JOINT-INSURED-NAME.
  6490             20  CM-JT-LAST-NAME           PIC X(15).
  6491             20  CM-JT-FIRST-NAME.
  6492                 24  CM-JT-1ST-INIT        PIC X.
  6493                 24  FILLER                PIC X(9).
  6494             20  CM-JT-INITIAL             PIC X.
  6495
  6496     12  CM-LIFE-DATA.
  6497         16  CM-LF-BENEFIT-CD              PIC XX.
  6498         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6499         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6500         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6501         16  CM-LF-DEV-CODE                PIC XXX.
  6502         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6503         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6504         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6505         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6506         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6507         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6508         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6509         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6510         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6511         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6512         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6513         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6514         16  cm-temp-epiq                  pic xx.
  6515             88  EPIQ-CLASS                  value 'EQ'.
  6516*        16  FILLER                        PIC XX.
  6517
  6518     12  CM-AH-DATA.
  6519         16  CM-AH-BENEFIT-CD              PIC XX.
  6520         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6521         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6522         16  CM-AH-DEV-CODE                PIC XXX.
  6523         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6524         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6525         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6526         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6527         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6528         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6529         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6530         16  CM-AH-PAID-THRU-DT            PIC XX.
  6531             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6532         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6533         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6534         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6535         16  FILLER                        PIC X.
  6536
  6537     12  CM-LOAN-INFORMATION.
  6538         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6539         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6540                                           PIC S9(5)V99  COMP-3.
  6541         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6542         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6543         16  CM-PAY-FREQUENCY              PIC S99.
  6544         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6545         16  CM-RATE-CLASS                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 121
* VP6311.cbl
  6546         16  CM-BENEFICIARY                PIC X(25).
  6547         16  CM-POLICY-FORM-NO             PIC X(12).
  6548         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6549         16  CM-LAST-ADD-ON-DT             PIC XX.
  6550         16  CM-DEDUCTIBLE-AMOUNTS.
  6551             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6552             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6553         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6554             20  CM-RESIDENT-STATE         PIC XX.
  6555             20  CM-RATE-CODE              PIC X(4).
  6556             20  FILLER                    PIC XX.
  6557         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6558             20  CM-LOAN-OFFICER           PIC X(5).
  6559             20  FILLER                    PIC XXX.
  6560         16  CM-CSR-CODE                   PIC XXX.
  6561         16  CM-UNDERWRITING-CODE          PIC X.
  6562             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6563         16  CM-POST-CARD-IND              PIC X.
  6564         16  CM-REF-INTERFACE-SW           PIC X.
  6565         16  CM-PREMIUM-TYPE               PIC X.
  6566             88  CM-SING-PRM                  VALUE '1'.
  6567             88  CM-O-B-COVERAGE              VALUE '2'.
  6568             88  CM-OPEN-END                  VALUE '3'.
  6569         16  CM-IND-GRP-TYPE               PIC X.
  6570             88  CM-INDIVIDUAL                VALUE 'I'.
  6571             88  CM-GROUP                     VALUE 'G'.
  6572         16  CM-SKIP-CODE                  PIC X.
  6573             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6574             88  SKIP-JULY                    VALUE '1'.
  6575             88  SKIP-AUGUST                  VALUE '2'.
  6576             88  SKIP-SEPTEMBER               VALUE '3'.
  6577             88  SKIP-JULY-AUG                VALUE '4'.
  6578             88  SKIP-AUG-SEPT                VALUE '5'.
  6579             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6580             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6581             88  SKIP-JUNE                    VALUE '8'.
  6582             88  SKIP-JUNE-JULY               VALUE '9'.
  6583             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6584             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6585         16  CM-PAYMENT-MODE               PIC X.
  6586             88  PAY-MONTHLY                  VALUE SPACE.
  6587             88  PAY-WEEKLY                   VALUE '1'.
  6588             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6589             88  PAY-BI-WEEKLY                VALUE '3'.
  6590             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6591         16  CM-LOAN-NUMBER                PIC X(8).
  6592         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6593         16  CM-OLD-LOF                    PIC XXX.
  6594*        16  CM-LOAN-OFFICER               PIC XXX.
  6595         16  CM-REIN-TABLE                 PIC XXX.
  6596         16  CM-SPECIAL-REIN-CODE          PIC X.
  6597         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6598         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6599         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6600
  6601     12  CM-STATUS-DATA.
  6602         16  CM-ENTRY-STATUS               PIC X.
  6603         16  CM-ENTRY-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 122
* VP6311.cbl
  6604
  6605         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6606         16  CM-LF-CANCEL-DT               PIC XX.
  6607         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6608
  6609         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6610         16  CM-LF-DEATH-DT                PIC XX.
  6611         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6612
  6613         16  CM-LF-CURRENT-STATUS          PIC X.
  6614             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6615                                                'M' '4' '5' '9'.
  6616             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6617             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6618             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6619             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6620             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6621             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6622             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6623             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6624             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6625             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6626             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6627             88  CM-LF-DECLINED               VALUE 'D'.
  6628             88  CM-LF-VOIDED                 VALUE 'V'.
  6629
  6630         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6631         16  CM-AH-CANCEL-DT               PIC XX.
  6632         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6633
  6634         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6635         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6636         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6637
  6638         16  CM-AH-CURRENT-STATUS          PIC X.
  6639             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6640                                                'M' '4' '5' '9'.
  6641             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6642             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6643             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6644             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6645             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6646             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6647             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6648             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6649             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6650             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6651             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6652             88  CM-AH-DECLINED               VALUE 'D'.
  6653             88  CM-AH-VOIDED                 VALUE 'V'.
  6654
  6655         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6656             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6657             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6658             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6659         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6660
  6661         16  CM-ENTRY-BATCH                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 123
* VP6311.cbl
  6662         16  CM-LF-EXIT-BATCH              PIC X(6).
  6663         16  CM-AH-EXIT-BATCH              PIC X(6).
  6664         16  CM-LAST-MONTH-END             PIC XX.
  6665
  6666     12  CM-NOTE-SW                        PIC X.
  6667         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6668         88  CERT-NOTES-PRESENT               VALUE '1'.
  6669         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6670         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6671         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6672         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6673         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6674         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6675     12  CM-COMP-EXCP-SW                   PIC X.
  6676         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6677         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6678     12  CM-INSURED-ADDRESS-SW             PIC X.
  6679         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6680         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6681
  6682*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6683     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6684     12  FILLER                            PIC X.
  6685
  6686*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6687     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6688     12  FILLER                            PIC X.
  6689*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6690     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6691
  6692     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6693         88  CERT-ADDED-BATCH                 VALUE ' '.
  6694         88  CERT-ADDED-ONLINE                VALUE '1'.
  6695         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6696         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6697         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6698     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6699         88  CERT-AS-LOADED                   VALUE ' '.
  6700         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6701         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6702         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6703         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6704         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6705         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6706         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6707
  6708     12  CM-ACCOUNT-COMM-PCTS.
  6709         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6710         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6711
  6712     12  CM-USER-FIELD                     PIC X.
  6713     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6714     12  CM-CLP-STATE                      PIC XX.
  6715     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6716     12  CM-USER-RESERVED                  PIC XXX.
  6717     12  FILLER REDEFINES CM-USER-RESERVED.
  6718         16  CM-AH-CLASS-CD                PIC XX.
  6719         16  F                             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 124
* VP6311.cbl
  6720******************************************************************
  6721*                                COPY ERCNOTE.
  6722******************************************************************
  6723*                                                                *
  6724*                                                                *
  6725*                            ERCNOTE                             *
  6726*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6727*                            VMOD=2.003                          *
  6728*                                                                *
  6729*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6730*                                                                *
  6731*        FILE TYPE= VSAM,KSDS                                    *
  6732*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6733*                                                                *
  6734*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6735*                                                                *
  6736*        LOG = YES                                               *
  6737*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6738*                                                                *
  6739******************************************************************
  6740*                   C H A N G E   L O G
  6741*
  6742* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6743*-----------------------------------------------------------------
  6744*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6745* EFFECTIVE    NUMBER
  6746*-----------------------------------------------------------------
  6747* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6748*                                FILE WILL CONTAIN BILLING NOTES O
  6749******************************************************************
  6750
  6751 01  CERTIFICATE-NOTE.
  6752     12  CN-RECORD-ID                PIC  XX.
  6753         88  VALID-CN-ID                  VALUE 'CN'.
  6754
  6755     12  CN-CONTROL-PRIMARY.
  6756         16  CN-COMPANY-CD           PIC X.
  6757         16  CN-CARRIER              PIC X.
  6758         16  CN-GROUPING.
  6759             20 CN-GROUPING-PREFIX   PIC XXX.
  6760             20 CN-GROUPING-PRIME    PIC XXX.
  6761         16  CN-STATE                PIC XX.
  6762         16  CN-ACCOUNT.
  6763             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6764             20 CN-ACCOUNT-PRIME     PIC X(6).
  6765         16  CN-CERT-EFF-DT          PIC XX.
  6766         16  CN-CERT-NO.
  6767             20  CN-CERT-PRIME       PIC X(10).
  6768             20  CN-CERT-SFX         PIC X.
  6769
  6770     12  CN-BILLING-START-LINE-NO    PIC 99.
  6771     12  CN-BILLING-END-LINE-NO      PIC 99.
  6772
  6773     12  CN-LINES.
  6774         16  CN-LINE OCCURS 10       PIC X(77).
  6775
  6776     12  CN-LAST-MAINT-DT            PIC XX.
  6777     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 125
* VP6311.cbl
  6778     12  CN-LAST-MAINT-USER          PIC X(4).
  6779     12  FILLER                      PIC X(6).
  6780******************************************************************
  6781*                                COPY ERCPNDM.
  6782******************************************************************
  6783*                                                                *
  6784*                                                                *
  6785*                            ERCPNDM                             *
  6786*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6787*                            VMOD=2.003                          *
  6788*                                                                *
  6789*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6790*                                                                *
  6791*   FILE TYPE = VSAM,KSDS                                        *
  6792*   RECORD SIZE = 374   RECFORM = FIX                            *
  6793*                                                                *
  6794*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6795*   ALTERNATE PATH    = NOT USED                                 *
  6796*                                                                *
  6797*   LOG = YES                                                    *
  6798*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6799******************************************************************
  6800*                   C H A N G E   L O G
  6801*
  6802* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6803*-----------------------------------------------------------------
  6804*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6805* EFFECTIVE    NUMBER
  6806*-----------------------------------------------------------------
  6807* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6808* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6809* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6810* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  6811******************************************************************
  6812
  6813 01  PENDING-MAILING-DATA.
  6814     12  PM-RECORD-ID                      PIC XX.
  6815         88  VALID-MA-ID                       VALUE 'PM'.
  6816
  6817     12  PM-CONTROL-PRIMARY.
  6818         16  PM-COMPANY-CD                 PIC X.
  6819         16  PM-ENTRY-BATCH                PIC X(6).
  6820         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6821         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6822
  6823     12  FILLER                            PIC X(14).
  6824
  6825     12  PM-ACCESS-CONTROL.
  6826         16  PM-SOURCE-SYSTEM              PIC XX.
  6827             88  PM-FROM-CREDIT                VALUE 'CR'.
  6828             88  PM-FROM-VSI                   VALUE 'VS'.
  6829             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6830             88  PM-FROM-OTHER                 VALUE 'OT'.
  6831         16  PM-RECORD-ADD-DT              PIC XX.
  6832         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6833         16  PM-LAST-MAINT-DT              PIC XX.
  6834         16  PM-LAST-MAINT-BY              PIC XXXX.
  6835         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 126
* VP6311.cbl
  6836
  6837     12  PM-PROFILE-INFO.
  6838         16  PM-QUALIFY-CODE-1             PIC XX.
  6839         16  PM-QUALIFY-CODE-2             PIC XX.
  6840         16  PM-QUALIFY-CODE-3             PIC XX.
  6841         16  PM-QUALIFY-CODE-4             PIC XX.
  6842         16  PM-QUALIFY-CODE-5             PIC XX.
  6843
  6844         16  PM-INSURED-LAST-NAME          PIC X(15).
  6845         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6846         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6847         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6848         16  PM-INSURED-BIRTH-DT           PIC XX.
  6849         16  PM-INSURED-SEX                PIC X.
  6850             88  PM-SEX-MALE                   VALUE 'M'.
  6851             88  PM-SEX-FEMALE                 VALUE 'F'.
  6852         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6853
  6854         16  PM-ADDRESS-CORRECTED          PIC X.
  6855         16  PM-JOINT-BIRTH-DT             PIC XX.
  6856*        16  FILLER                        PIC X(12).
  6857
  6858         16  PM-ADDRESS-LINE-1             PIC X(30).
  6859         16  PM-ADDRESS-LINE-2             PIC X(30).
  6860         16  PM-CITY-STATE.
  6861             20  PM-CITY                   PIC X(28).
  6862             20  PM-STATE                  PIC XX.
  6863         16  PM-ZIP.
  6864             20  PM-ZIP-CODE.
  6865                 24  PM-ZIP-1              PIC X.
  6866                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6867                 24  FILLER                PIC X(4).
  6868             20  PM-ZIP-PLUS4              PIC X(4).
  6869         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6870             20  PM-CAN-POST1              PIC XXX.
  6871             20  PM-CAN-POST2              PIC XXX.
  6872             20  FILLER                    PIC XXX.
  6873
  6874         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6875         16  pm-city-st-zip-verified       pic x.
  6876         16  FILLER                        PIC XX.
  6877
  6878     12  PM-CRED-BENE-INFO.
  6879         16  PM-CRED-BENE-NAME             PIC X(25).
  6880         16  PM-CRED-BENE-ADDR             PIC X(30).
  6881         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6882         16  PM-CRED-BENE-CTYST.
  6883             20  PM-CRED-BENE-CITY         PIC X(28).
  6884             20  PM-CRED-BENE-STATE        PIC XX.
  6885         16  PM-CRED-BENE-ZIP.
  6886             20  PM-CB-ZIP-CODE.
  6887                 24  PM-CB-ZIP-1           PIC X.
  6888                     88  PM-CB-CANADIAN-POST-CODE
  6889                                  VALUE 'A' THRU 'Z'.
  6890                 24  FILLER                PIC X(4).
  6891             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6892         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6893             20  PM-CB-CAN-POST1           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 127
* VP6311.cbl
  6894             20  PM-CB-CAN-POST2           PIC XXX.
  6895             20  FILLER                    PIC XXX.
  6896     12  PM-POST-CARD-MAIL-DATA.
  6897         16  PM-MAIL-DATA OCCURS 7.
  6898             20  PM-MAIL-TYPE              PIC X.
  6899                 88  PM-12MO-MAILING           VALUE '1'.
  6900                 88  PM-EXP-MAILING            VALUE '2'.
  6901             20  PM-MAIL-STATUS            PIC X.
  6902                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6903                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6904                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6905             20  PM-MAIL-DATE              PIC XX.
  6906     12  FILLER                            PIC XX.
  6907     12  FILLER                            PIC X(12).
  6908*    12  FILLER                            PIC X(30).
  6909
  6910******************************************************************
  6911*                                COPY ERCMAIL.
  6912******************************************************************
  6913*                                                                *
  6914*                                                                *
  6915*                            ERCMAIL                             *
  6916*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6917*                            VMOD=2.003                          *
  6918*                                                                *
  6919*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6920*                                                                *
  6921*   FILE TYPE = VSAM,KSDS                                        *
  6922*   RECORD SIZE = 374   RECFORM = FIX                            *
  6923*                                                                *
  6924*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6925*   ALTERNATE PATH    = NOT USED                                 *
  6926*                                                                *
  6927*   LOG = YES                                                    *
  6928*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6929******************************************************************
  6930*                   C H A N G E   L O G
  6931*
  6932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6933*-----------------------------------------------------------------
  6934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6935* EFFECTIVE    NUMBER
  6936*-----------------------------------------------------------------
  6937* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6938* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6939* 111108                   PEMA  ADD CRED BENE ADDR2
  6940******************************************************************
  6941
  6942 01  MAILING-DATA.
  6943     12  MA-RECORD-ID                      PIC XX.
  6944         88  VALID-MA-ID                       VALUE 'MA'.
  6945
  6946     12  MA-CONTROL-PRIMARY.
  6947         16  MA-COMPANY-CD                 PIC X.
  6948         16  MA-CARRIER                    PIC X.
  6949         16  MA-GROUPING.
  6950             20  MA-GROUPING-PREFIX        PIC XXX.
  6951             20  MA-GROUPING-PRIME         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 128
* VP6311.cbl
  6952         16  MA-STATE                      PIC XX.
  6953         16  MA-ACCOUNT.
  6954             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6955             20  MA-ACCOUNT-PRIME          PIC X(6).
  6956         16  MA-CERT-EFF-DT                PIC XX.
  6957         16  MA-CERT-NO.
  6958             20  MA-CERT-PRIME             PIC X(10).
  6959             20  MA-CERT-SFX               PIC X.
  6960
  6961     12  FILLER                            PIC XX.
  6962
  6963     12  MA-ACCESS-CONTROL.
  6964         16  MA-SOURCE-SYSTEM              PIC XX.
  6965             88  MA-FROM-CREDIT                VALUE 'CR'.
  6966             88  MA-FROM-VSI                   VALUE 'VS'.
  6967             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6968             88  MA-FROM-OTHER                 VALUE 'OT'.
  6969         16  MA-RECORD-ADD-DT              PIC XX.
  6970         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6971         16  MA-LAST-MAINT-DT              PIC XX.
  6972         16  MA-LAST-MAINT-BY              PIC XXXX.
  6973         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6974
  6975     12  MA-PROFILE-INFO.
  6976         16  MA-QUALIFY-CODE-1             PIC XX.
  6977         16  MA-QUALIFY-CODE-2             PIC XX.
  6978         16  MA-QUALIFY-CODE-3             PIC XX.
  6979         16  MA-QUALIFY-CODE-4             PIC XX.
  6980         16  MA-QUALIFY-CODE-5             PIC XX.
  6981
  6982         16  MA-INSURED-LAST-NAME          PIC X(15).
  6983         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6984         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6985         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6986         16  MA-INSURED-BIRTH-DT           PIC XX.
  6987         16  MA-INSURED-SEX                PIC X.
  6988             88  MA-SEX-MALE                   VALUE 'M'.
  6989             88  MA-SEX-FEMALE                 VALUE 'F'.
  6990         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6991
  6992         16  MA-ADDRESS-CORRECTED          PIC X.
  6993         16  MA-JOINT-BIRTH-DT             PIC XX.
  6994*        16  FILLER                        PIC X(12).
  6995
  6996         16  MA-ADDRESS-LINE-1             PIC X(30).
  6997         16  MA-ADDRESS-LINE-2             PIC X(30).
  6998         16  MA-CITY-STATE.
  6999             20  MA-CITY                   PIC X(28).
  7000             20  MA-ADDR-STATE             PIC XX.
  7001         16  MA-ZIP.
  7002             20  MA-ZIP-CODE.
  7003                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7004                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7005                 24  FILLER                PIC X(4).
  7006             20  MA-ZIP-PLUS4              PIC X(4).
  7007         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7008             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7009             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 129
* VP6311.cbl
  7010             20  FILLER                    PIC X(3).
  7011
  7012         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7013
  7014         16  FILLER                        PIC XXX.
  7015*        16  FILLER                        PIC X(10).
  7016
  7017     12  MA-CRED-BENE-INFO.
  7018         16  MA-CRED-BENE-NAME                 PIC X(25).
  7019         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7020         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7021         16  MA-CRED-BENE-CTYST.
  7022             20  MA-CRED-BENE-CITY             PIC X(28).
  7023             20  MA-CRED-BENE-STATE            PIC XX.
  7024         16  MA-CRED-BENE-ZIP.
  7025             20  MA-CB-ZIP-CODE.
  7026                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7027                     88  MA-CB-CANADIAN-POST-CODE
  7028                                           VALUE 'A' THRU 'Z'.
  7029                 24  FILLER                    PIC X(4).
  7030             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7031         16  MA-CB-CANADIAN-POSTAL-CODE
  7032                            REDEFINES MA-CRED-BENE-ZIP.
  7033             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7034             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7035             20  FILLER                        PIC X(3).
  7036     12  MA-POST-CARD-MAIL-DATA.
  7037         16  MA-MAIL-DATA OCCURS 7.
  7038             20  MA-MAIL-TYPE              PIC X.
  7039                 88  MA-12MO-MAILING           VALUE '1'.
  7040                 88  MA-EXP-MAILING            VALUE '2'.
  7041             20  MA-MAIL-STATUS            PIC X.
  7042                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7043                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7044                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7045             20  MA-MAIL-DATE              PIC XX.
  7046     12  FILLER                            PIC XX.
  7047     12  FILLER                            PIC XX.
  7048*    12  FILLER                            PIC X(30).
  7049******************************************************************
  7050*                                COPY ERCRQST.
  7051******************************************************************
  7052*                                                                *
  7053*                                                                *
  7054*                            ERCRQST.                            *
  7055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7056*                            VMOD=2.002                          *
  7057*                                                                *
  7058*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7059*                                                                *
  7060*   FILE TYPE = VSAM,KSDS                                        *
  7061*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7062*                                                                *
  7063*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7064*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7065*                                   ACCOUNT, REF, BATCH)         *
  7066*                                                RKP=9, LEN=38   *
  7067*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 130
* VP6311.cbl
  7068*                                   ACCOUNT, REF, BATCH)         *
  7069*                                                RKP=47, LEN=46  *
  7070*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7071*                                   BATCH)                       *
  7072*                                                RKP=93, LEN=24  *
  7073*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7074*                                   REF, BATCH)                  *
  7075*                                                RKP=117, LEN=35 *
  7076*   LOG = NO                                                     *
  7077*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7078******************************************************************
  7079
  7080 01  AR-REQUEST-RECORD.
  7081     12  RQ-RECORD-ID                     PIC XX.
  7082         88  VALID-RQ-ID                        VALUE 'RQ'.
  7083
  7084     12  RQ-CONTROL-PRIMARY.
  7085         16  RQ-COMPANY-CD                PIC X.
  7086         16  RQ-ENTRY-BATCH               PIC X(6).
  7087
  7088     12  RQ-CONTROL-BY-ACCT-REF.
  7089         16  RQ-COMPANY-CD-A1             PIC X.
  7090         16  RQ-CARRIER-A1                PIC X.
  7091         16  RQ-GROUPING-A1               PIC X(6).
  7092         16  RQ-STATE-A1                  PIC XX.
  7093         16  RQ-ACCOUNT-A1                PIC X(10).
  7094         16  RQ-REFERENCE-A1              PIC X(12).
  7095         16  RQ-BATCH-A1                  PIC X(6).
  7096
  7097     12  RQ-CONTROL-BY-FIN-RESP.
  7098         16  RQ-COMPANY-CD-A2             PIC X.
  7099         16  RQ-CARRIER-A2                PIC X.
  7100         16  RQ-GROUPING-A2               PIC X(6).
  7101         16  RQ-FIN-RESP-A2               PIC X(10).
  7102         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7103         16  RQ-REFERENCE-A2              PIC X(12).
  7104         16  RQ-BATCH-A2                  PIC X(6).
  7105
  7106     12  RQ-CONTROL-BY-ACCT-AGENT.
  7107         16  RQ-COMPANY-CD-A3             PIC X.
  7108         16  RQ-CARRIER-A3                PIC X.
  7109         16  RQ-GROUPING-A3               PIC X(6).
  7110         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7111         16  RQ-BATCH-A3                  PIC X(6).
  7112
  7113     12  RQ-CONTROL-BY-SUMMARY.
  7114         16  RQ-COMPANY-CD-A4             PIC X.
  7115         16  RQ-SUMMARY-CODE              PIC X(6).
  7116         16  RQ-ACCOUNT-A4                PIC X(10).
  7117         16  RQ-REFERENCE-A4              PIC X(12).
  7118         16  RQ-BATCH-A4                  PIC X(6).
  7119
  7120     12  RQ-REQUEST-METHOD                PIC X.
  7121         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7122         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7123         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7124         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7125     12  FILLER                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 131
* VP6311.cbl
  7126     12  RQ-STATUS                        PIC X.
  7127         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7128         88  RQ-RESUBMIT                      VALUE 'R'.
  7129     12  RQ-PROCESSOR-ID                  PIC X(4).
  7130     12  RQ-ENTRY-DT                      PIC XX.
  7131     12  RQ-MO-END-DT                     PIC XX.
  7132     12  RQ-REQUEST-DT                    PIC XX.
  7133     12  RQ-STMT-DT                       PIC XX.
  7134     12  RQ-REVERSAL-DT                   PIC XX.
  7135     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7136     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7137
  7138     12  FILLER                           PIC X(27).
  7139
  7140******************************************************************
  7141
  7142*                                COPY ERCLOFC.
  7143******************************************************************
  7144*                                                                *
  7145*                                                                *
  7146*                            ERCLOFC                             *
  7147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7148*                            VMOD=2.003                          *
  7149*                                                                *
  7150*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7151*                                                                *
  7152*   FILE TYPE = VSAM,KSDS                                        *
  7153*   RECORD SIZE = 670   RECFORM = FIX                            *
  7154*                                                                *
  7155*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7156*                                                                *
  7157*   LOG = YES                                                    *
  7158*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7159*                                                                *
  7160******************************************************************
  7161
  7162 01  LOAN-OFFICER-MASTER.
  7163     12  LO-RECORD-ID                PIC XX.
  7164         88  VALID-LO-ID                VALUE 'LO'.
  7165
  7166     12  LO-CONTROL-PRIMARY.
  7167         16  LO-COMPANY-CD           PIC X.
  7168         16  LO-CARRIER              PIC X.
  7169         16  LO-GROUPING.
  7170             20  LO-GROUPING-PREFIX  PIC XXX.
  7171             20  LO-GROUPING-PRIME   PIC XXX.
  7172         16  LO-STATE                PIC XX.
  7173         16  LO-ACCOUNT.
  7174             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7175             20  LO-ACCOUNT-PRIME    PIC X(6).
  7176         16  LO-OFFICER-CODE         PIC X(5).
  7177
  7178     12  LO-OFFICER-NAME             PIC X(30).
  7179
  7180     12  LO-LAST-MAINT-DT            PIC XX.
  7181     12  LO-LAST-USER                PIC X(4).
  7182     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7183
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 132
* VP6311.cbl
  7184     12  LO-COMP-CONTROL             PIC X.
  7185             88  LO-SHOW-COMP           VALUE 'Y'.
  7186             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7187     12  LO-DETAIL-CONTROL           PIC X.
  7188             88  LO-PRINT-DETAIL        VALUE 'D'.
  7189             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7190
  7191     12  LO-SV-CARRIER               PIC X.
  7192     12  LO-SV-GROUPING              PIC X(6).
  7193     12  LO-SV-STATE                 PIC XX.
  7194
  7195     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7196     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7197
  7198     12  LO-OFFICER-INFO.
  7199         16  FILLER OCCURS 12 TIMES.
  7200             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7201             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7202             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7203             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7204             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7205             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7206             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7207             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7208     12  FILLER                      PIC X(198).
  7209******************************************************************
  7210*                                COPY ERCPYAJ.
  7211******************************************************************
  7212*                                                                *
  7213*                            ERCPYAJ                             *
  7214*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7215*                            VMOD=2.015                          *
  7216*                                                                *
  7217*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7218*                                                                *
  7219*                                                                *
  7220*   FILE TYPE = VSAM,KSDS                                        *
  7221*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7222*                                                                *
  7223*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7224*       ALTERNATE PATHS = NONE                                   *
  7225*                                                                *
  7226*   LOG = YES                                                    *
  7227*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7228******************************************************************
  7229******************************************************************
  7230*                   C H A N G E   L O G
  7231*
  7232* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7233*-----------------------------------------------------------------
  7234*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7235* EFFECTIVE    NUMBER
  7236*-----------------------------------------------------------------
  7237* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7238* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7239******************************************************************
  7240
  7241 01  PENDING-PAY-ADJ.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 133
* VP6311.cbl
  7242     12  PY-RECORD-ID                     PIC XX.
  7243         88  VALID-PY-ID                        VALUE 'PY'.
  7244
  7245     12  PY-CONTROL-PRIMARY.
  7246         16  PY-COMPANY-CD                PIC X.
  7247         16  PY-CARRIER                   PIC X.
  7248         16  PY-GROUPING                  PIC X(6).
  7249         16  PY-FIN-RESP                  PIC X(10).
  7250         16  PY-ACCOUNT                   PIC X(10).
  7251         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7252                                          PIC X(10).
  7253         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7254         16  PY-RECORD-TYPE               PIC X.
  7255             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7256             88  PY-DEPOSIT                   VALUE 'D'.
  7257             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7258             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7259             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7260             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7261             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7262             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7263             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7264             88  PY-FICA-ENTRY                VALUE 'F'.
  7265             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7266             88  PY-POLICY-FEE                VALUE 'W'.
  7267             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7268
  7269     12  PY-PYMT-TYPE                     PIC X.
  7270             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7271             88  PY-REINS-PYMT                VALUE 'R'.
  7272             88  PY-EXP-PYMT                  VALUE 'E'.
  7273
  7274     12  PY-BIL-INV                       PIC X(6).
  7275     12  PY-REF-NO                        PIC X(12).
  7276
  7277     12  PY-LAST-MAINT-DT                 PIC XX.
  7278     12  PY-LAST-MAINT-BY                 PIC X(4).
  7279     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7280
  7281     12  PY-PYADJ-RECORD.
  7282         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7283         16  PY-ENTRY-COMMENT             PIC X(30).
  7284         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7285             20  PY-GL-ACCOUNT            PIC X(10).
  7286             20  PY-GL-STATE              PIC X(02).
  7287             20  PY-GL-CANC-SW            PIC X(01).
  7288                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7289                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7290             20  PY-GL-COMMENT            PIC X(10).
  7291             20  FILLER      REDEFINES PY-GL-COMMENT.
  7292                 24  PY-GL-CHECK-NO       PIC 9(06).
  7293                 24  FILLER               PIC X(04).
  7294             20  FILLER                   PIC X(07).
  7295         16  PY-SAVE-ACCOUNT              PIC X(10).
  7296         16  PY-SAVE-TYPE                 PIC X(01).
  7297
  7298         16  PY-LETTERS.
  7299             20  PY-LETTER OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 134
* VP6311.cbl
  7300                           INDEXED BY PY-LET-NDX
  7301                                          PIC X(04).
  7302
  7303         16  PY-ERCOMP-TYPE               PIC X.
  7304             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7305             88  PY-GA-TYPE                   VALUE 'G'.
  7306             88  PY-BANK-TYPE                 VALUE 'B'.
  7307         16  FILLER                       PIC X(05).
  7308
  7309     12  PY-RECORD-STATUS.
  7310         16  PY-CREDIT-SELECT-DT          PIC XX.
  7311         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7312         16  PY-BILLED-DATE               PIC XX.
  7313         16  PY-REPORTED-DT               PIC XX.
  7314         16  PY-PMT-APPLIED               PIC X.
  7315             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7316             88  PY-GA-PMT                    VALUE 'G'.
  7317             88  PY-OVWRITE-PMT               VALUE 'O'.
  7318             88  PY-NON-AR-PMT                VALUE 'N'.
  7319         16  FILLER                       PIC X(5).
  7320         16  PY-INPUT-DT                  PIC XX.
  7321         16  PY-CHECK-NUMBER              PIC X(6).
  7322         16  PY-VOID-SW                   PIC X.
  7323             88  PY-CHECK-VOIDED              VALUE 'V'.
  7324         16  PY-CHECK-ORIGIN-SW           PIC X.
  7325             88  PY-BILLING-CHECK             VALUE 'B'.
  7326             88  PY-REFUND-CHECK              VALUE 'R'.
  7327             88  PY-GA-CHECK                  VALUE 'G'.
  7328             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7329             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7330         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7331         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7332         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7333         16  PY-BILL-FLAG                 PIC X.
  7334             88  PY-BILLED                    VALUE 'B'.
  7335         16  PY-AR-FLAG                   PIC X.
  7336             88  PY-AR-CYCLE                  VALUE 'C'.
  7337             88  PY-AR-MONTH-END              VALUE 'M'.
  7338         16  PY-AR-DATE                   PIC XX.
  7339
  7340     12  PY-GL-CODES.
  7341         16  PY-GL-DB                     PIC X(14).
  7342         16  PY-GL-CR                     PIC X(14).
  7343         16  PY-GL-FLAG                   PIC X.
  7344         16  PY-GL-DATE                   PIC XX.
  7345
  7346     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7347     12  FILLER                           PIC X(3).
  7348******************************************************************
  7349*                                COPY ERCCNOT.
  7350******************************************************************
  7351*                                                                *
  7352*                            ERCCNOT                             *
  7353*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7354*                            VMOD=2.003                          *
  7355*                                                                *
  7356*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7357*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 135
* VP6311.cbl
  7358*        FILE TYPE= VSAM,KSDS                                    *
  7359*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7360*                                                                *
  7361*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7362*                                                                *
  7363*        LOG = YES                                               *
  7364*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7365*                                                                *
  7366******************************************************************
  7367*                   C H A N G E   L O G
  7368*
  7369* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7370*-----------------------------------------------------------------
  7371*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7372* EFFECTIVE    NUMBER
  7373*-----------------------------------------------------------------
  7374* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7375******************************************************************
  7376
  7377 01  CERT-NOTE-FILE.
  7378     12  CZ-RECORD-ID                PIC  XX.
  7379         88  VALID-CZ-ID                  VALUE 'CZ'.
  7380
  7381     12  CZ-CONTROL-PRIMARY.
  7382         16  CZ-COMPANY-CD           PIC X.
  7383         16  CZ-CARRIER              PIC X.
  7384         16  CZ-GROUPING.
  7385             20 CZ-GROUPING-PREFIX   PIC XXX.
  7386             20 CZ-GROUPING-PRIME    PIC XXX.
  7387         16  CZ-STATE                PIC XX.
  7388         16  CZ-ACCOUNT.
  7389             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7390             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7391         16  CZ-CERT-EFF-DT          PIC XX.
  7392         16  CZ-CERT-NO.
  7393             20  CZ-CERT-PRIME       PIC X(10).
  7394             20  CZ-CERT-SFX         PIC X.
  7395         16  CZ-RECORD-TYPE          PIC X.
  7396             88  CERT-NOTE           VALUE '1'.
  7397             88  CLAIM-CERT-NOTE     VALUE '2'.
  7398         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7399
  7400     12  CZ-LAST-MAINT-DT            PIC XX.
  7401     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7402     12  CZ-LAST-MAINT-USER          PIC X(4).
  7403
  7404     12  CZ-NOTE-INFORMATION.
  7405         16  CZ-NOTE                 PIC X(63).
  7406         16  FILLER                  PIC X(39).
  7407******************************************************************
  7408*                                COPY ELCMSTR.
  7409******************************************************************
  7410*                                                                *
  7411*                            ELCMSTR.                            *
  7412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7413*                            VMOD=2.012                          *
  7414*                                                                *
  7415*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 136
* VP6311.cbl
  7416*                                                                *
  7417*   FILE TYPE = VSAM,KSDS                                        *
  7418*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7419*                                                                *
  7420*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7421*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7422*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7423*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7424*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7425*                                                 RKP=75,LEN=21  *
  7426*                                                                *
  7427*   **** NOTE ****                                               *
  7428*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7429*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7430*                                                                *
  7431*   LOG = YES                                                    *
  7432*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7433******************************************************************
  7434*                   C H A N G E   L O G
  7435*
  7436* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7437*-----------------------------------------------------------------
  7438*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7439* EFFECTIVE    NUMBER
  7440*-----------------------------------------------------------------
  7441* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7442* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7443* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7444* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7445* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7446* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7447******************************************************************
  7448 01  CLAIM-MASTER.
  7449     12  CL-RECORD-ID                PIC XX.
  7450         88  VALID-CL-ID         VALUE 'CL'.
  7451
  7452     12  CL-CONTROL-PRIMARY.
  7453         16  CL-COMPANY-CD           PIC X.
  7454         16  CL-CARRIER              PIC X.
  7455         16  CL-CLAIM-NO             PIC X(7).
  7456         16  CL-CERT-NO.
  7457             20  CL-CERT-PRIME       PIC X(10).
  7458             20  CL-CERT-SFX         PIC X.
  7459
  7460     12  CL-CONTROL-BY-NAME.
  7461         16  CL-COMPANY-CD-A1        PIC X.
  7462         16  CL-INSURED-LAST-NAME    PIC X(15).
  7463         16  CL-INSURED-NAME.
  7464             20  CL-INSURED-1ST-NAME PIC X(12).
  7465             20  CL-INSURED-MID-INIT PIC X.
  7466
  7467     12  CL-CONTROL-BY-SSN.
  7468         16  CL-COMPANY-CD-A2        PIC X.
  7469         16  CL-SOC-SEC-NO.
  7470             20  CL-SSN-STATE        PIC XX.
  7471             20  CL-SSN-ACCOUNT      PIC X(6).
  7472             20  CL-SSN-LN3          PIC X(3).
  7473
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 137
* VP6311.cbl
  7474     12  CL-CONTROL-BY-CERT-NO.
  7475         16  CL-COMPANY-CD-A4        PIC X.
  7476         16  CL-CERT-NO-A4.
  7477             20  CL-CERT-A4-PRIME    PIC X(10).
  7478             20  CL-CERT-A4-SFX      PIC X.
  7479
  7480     12  CL-CONTROL-BY-CCN.
  7481         16  CL-COMPANY-CD-A5        PIC X.
  7482         16  CL-CCN-A5.
  7483             20  CL-CCN.
  7484                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7485                 24  CL-CCN-PRIME-A5 PIC X(12).
  7486             20  CL-CCN-FILLER-A5    PIC X(4).
  7487
  7488     12  CL-INSURED-PROFILE-DATA.
  7489         16  CL-INSURED-BIRTH-DT     PIC XX.
  7490         16  CL-INSURED-SEX-CD       PIC X.
  7491             88  INSURED-IS-MALE        VALUE 'M'.
  7492             88  INSURED-IS-FEMALE      VALUE 'F'.
  7493             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7494         16  CL-INSURED-OCC-CD       PIC X(6).
  7495         16  FILLER                  PIC X(5).
  7496
  7497     12  CL-PROCESSING-INFO.
  7498         16  CL-PROCESSOR-ID         PIC X(4).
  7499         16  CL-CLAIM-STATUS         PIC X.
  7500             88  CLAIM-IS-OPEN          VALUE 'O'.
  7501             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7502         16  CL-CLAIM-TYPE           PIC X.
  7503*            88  AH-CLAIM               VALUE 'A'.
  7504*            88  LIFE-CLAIM             VALUE 'L'.
  7505*            88  PROPERTY-CLAIM         VALUE 'P'.
  7506*            88  IUI-CLAIM              VALUE 'I'.
  7507*            88  GAP-CLAIM              VALUE 'G'.
  7508*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7509         16  CL-CLAIM-PREM-TYPE      PIC X.
  7510             88  SINGLE-PREMIUM         VALUE '1'.
  7511             88  O-B-COVERAGE           VALUE '2'.
  7512             88  OPEN-END-COVERAGE      VALUE '3'.
  7513         16  CL-INCURRED-DT          PIC XX.
  7514         16  CL-REPORTED-DT          PIC XX.
  7515         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7516         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7517         16  CL-LAST-PMT-DT          PIC XX.
  7518         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7519         16  CL-PAID-THRU-DT         PIC XX.
  7520         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7521         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7522         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7523         16  CL-PMT-CALC-METHOD      PIC X.
  7524             88  CL-360-DAY-YR          VALUE '1'.
  7525             88  CL-365-DAY-YR          VALUE '2'.
  7526             88  CL-FULL-MONTHS         VALUE '3'.
  7527         16  CL-CAUSE-CD             PIC X(6).
  7528
  7529         16  CL-PRIME-CERT-NO.
  7530             20  CL-PRIME-CERT-PRIME PIC X(10).
  7531             20  CL-PRIME-CERT-SFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 138
* VP6311.cbl
  7532
  7533         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7534             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7535             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7536
  7537         16  CL-MICROFILM-NO         PIC X(10).
  7538         16  FILLER REDEFINES CL-MICROFILM-NO.
  7539             20  CL-BENEFIT-PERIOD   PIC 99.
  7540             20  FILLER              PIC X(8).
  7541         16  CL-PROG-FORM-TYPE       PIC X.
  7542         16  CL-LAST-ADD-ON-DT       PIC XX.
  7543
  7544         16  CL-LAST-REOPEN-DT       PIC XX.
  7545         16  CL-LAST-CLOSE-DT        PIC XX.
  7546         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7547             88  FINAL-PAID             VALUE '1'.
  7548             88  CLAIM-DENIED           VALUE '2'.
  7549             88  AUTO-CLOSE             VALUE '3'.
  7550             88  MANUAL-CLOSE           VALUE '4'.
  7551             88  BENEFITS-CHANGED       VALUE 'C'.
  7552             88  SETUP-ERRORS           VALUE 'E'.
  7553         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7554         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7555         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7556             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7557         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7558         16  FILLER                  PIC X.
  7559
  7560     12  CL-CERTIFICATE-DATA.
  7561         16  CL-CERT-ORIGIN          PIC X.
  7562             88  CERT-WAS-ONLINE        VALUE '1'.
  7563             88  CERT-WAS-CREATED       VALUE '2'.
  7564             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7565         16  CL-CERT-KEY-DATA.
  7566             20  CL-CERT-CARRIER     PIC X.
  7567             20  CL-CERT-GROUPING    PIC X(6).
  7568             20  CL-CERT-STATE       PIC XX.
  7569             20  CL-CERT-ACCOUNT.
  7570                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7571                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7572             20  CL-CERT-EFF-DT      PIC XX.
  7573
  7574     12  CL-STATUS-CONTROLS.
  7575         16  CL-PRIORITY-CD          PIC X.
  7576             88  CONFIDENTIAL-DATA      VALUE '8'.
  7577             88  HIGHEST-PRIORITY       VALUE '9'.
  7578         16  CL-SUPV-ATTN-CD         PIC X.
  7579             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7580             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7581         16  CL-PURGED-DT            PIC XX.
  7582         16  CL-RESTORED-DT          PIC XX.
  7583         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7584         16  CL-NEXT-RESEND-DT       PIC XX.
  7585         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7586         16  CL-CRITICAL-PERIOD      PIC 99.
  7587*        16  FILLER                  PIC XX.
  7588         16  CL-LAST-MAINT-DT        PIC XX.
  7589         16  CL-LAST-MAINT-USER      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 139
* VP6311.cbl
  7590         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7591         16  CL-LAST-MAINT-TYPE      PIC X.
  7592             88  CLAIM-SET-UP           VALUE ' '.
  7593             88  PAYMENT-MADE           VALUE '1'.
  7594             88  LETTER-SENT            VALUE '2'.
  7595             88  MASTER-WAS-ALTERED     VALUE '3'.
  7596             88  MASTER-WAS-RESTORED    VALUE '4'.
  7597             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7598             88  FILE-CONVERTED         VALUE '6'.
  7599             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7600             88  ERROR-CORRECTION       VALUE 'E'.
  7601         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7602         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7603         16  CL-BENEFICIARY          PIC X(10).
  7604         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7605         16  CL-DENIAL-TYPE          PIC X.
  7606             88  CL-TYPE-DENIAL          VALUE '1'.
  7607             88  CL-TYPE-RESCISSION      VALUE '2'.
  7608             88  CL-TYPE-REFORMATION     VALUE '3'.
  7609             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7610             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7611         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7612         16  filler                  pic x(3).
  7613*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7614*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7615*        16  CL-RTW-DT               PIC XX.
  7616
  7617     12  CL-TRAILER-CONTROLS.
  7618         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7619             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7620             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7621             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7622         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7623         16  FILLER                  PIC XX.
  7624         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7625         16  CL-ADDRESS-TRAILER-CNT.
  7626             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7627                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7628             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7629                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7630             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7631                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7632             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7633                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7634             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7635                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7636             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7637                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7638             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7639                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7640
  7641     12  CL-CV-REFERENCE-NO.
  7642         16  CL-CV-REFNO-PRIME       PIC X(18).
  7643         16  CL-CV-REFNO-SFX         PIC XX.
  7644
  7645     12  CL-FILE-LOCATION            PIC X(4).
  7646
  7647     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 140
* VP6311.cbl
  7648         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7649             88  NO-FATAL-ERRORS        VALUE ZERO.
  7650         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7651             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7652
  7653     12  CL-PRODUCT-CD               PIC X.
  7654
  7655     12  CL-CURRENT-KEY-DATA.
  7656         16  CL-CURRENT-CARRIER      PIC X.
  7657         16  CL-CURRENT-GROUPING     PIC X(6).
  7658         16  CL-CURRENT-STATE        PIC XX.
  7659         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7660
  7661     12  CL-ASSOCIATES               PIC X.
  7662         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7663         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7664         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7665         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7666
  7667     12  CL-ACTIVITY-CODE            PIC 99.
  7668     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7669     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7670
  7671     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7672     12  CL-LAG-REPORT-CODE          PIC 9.
  7673     12  CL-LOAN-TYPE                PIC XX.
  7674     12  CL-LEGAL-STATE              PIC XX.
  7675
  7676     12  CL-YESNOSW                  PIC X.
  7677     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7678         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7679         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7680         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7681     12  cl-insured-type             pic x.
  7682         88  cl-claim-on-primary         value 'P'.
  7683         88  cl-claim-on-co-borrower     value 'C'.
  7684     12  cl-benefit-expiration-dt    PIC XX.
  7685*                                COPY ERCENDT.
  7686******************************************************************
  7687*                                                                *
  7688*                                                                *
  7689*                            ERCENDT.                            *
  7690*                            VMOD=2.001                          *
  7691*                                                                *
  7692*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7693*                                                                *
  7694*   FILE TYPE = VSAM,KSDS                                        *
  7695*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7696*                                                                *
  7697*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7698*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7699*                                                                *
  7700*   LOG = NO                                                     *
  7701*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7702******************************************************************
  7703*-----------------------------------------------------------------
  7704*                   C H A N G E   L O G
  7705*
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 141
* VP6311.cbl
  7706* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7707*-----------------------------------------------------------------
  7708*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7709* EFFECTIVE    NUMBER
  7710*-----------------------------------------------------------------
  7711* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7712*                                WITH OPEN CLAIMS
  7713* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7714* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7715* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7716* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7717*-----------------------------------------------------------------
  7718 01  ENDORSEMENT-RECORD.
  7719     12  EN-RECORD-ID                PIC XX.
  7720         88  VALID-EN-ID                VALUE 'EN'.
  7721     12  EN-CONTROL-PRIMARY.
  7722         16  EN-COMPANY-CD           PIC X.
  7723         16  EN-CARRIER              PIC X.
  7724         16  EN-GROUPING             PIC X(6).
  7725         16  EN-STATE                PIC XX.
  7726         16  EN-ACCOUNT              PIC X(10).
  7727         16  EN-CERT-EFF-DT          PIC XX.
  7728         16  EN-CERT-NO.
  7729             20  EN-CERT-PRIME       PIC X(10).
  7730             20  EN-CERT-SFX         PIC X.
  7731         16  EN-REC-TYPE             PIC X.
  7732             88  EN-ISSUE               VALUE 'I'.
  7733             88  EN-CANCELLATION        VALUE 'C'.
  7734         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7735     12  EN-CONTROL-BY-ARCH-NO.
  7736         16  EN-COMPANY-CD-A1              PIC X.
  7737         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7738     12  EN-LAST-MAINT-DT            PIC XX.
  7739     12  EN-LAST-MAINT-BY            PIC X(4).
  7740     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7741     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7742     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7743         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7744         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7745         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7746         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7747         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7748         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7749         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7750         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7751         16  EN-LF-ORIG-BENCD        PIC XX.
  7752         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7753         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7754         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7755         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7756         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7757         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7758*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7759         16  EN-ORIG-CRED-BENE       PIC X(25).
  7760         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7761         16  FILLER                  PIC X.
  7762         16  EN-AH-ORIG-BENCD        PIC XX.
  7763         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 142
* VP6311.cbl
  7764         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7765         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7766         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7767*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7768*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7769         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7770         16  F                       PIC X(09).
  7771         16  EN-AH-ORIG-CP           PIC 99.
  7772         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7773         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7774         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7775         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7776         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7777         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7778         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7779         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7780         16  EN-LF-NEW-BENCD         PIC XX.
  7781         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7782         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7783         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7784         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7785         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7786         16  EN-LF-NEW-EXP-DT        PIC XX.
  7787         16  EN-NEW-CRED-BENE        PIC X(25).
  7788         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7789         16  FILLER                  PIC X.
  7790         16  EN-AH-NEW-BENCD         PIC XX.
  7791         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7792         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7793         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7794         16  EN-AH-NEW-EXP-DT        PIC XX.
  7795*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7796*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7797*        16  F                       PIC X(12).
  7798         16  EN-AH-NEW-CP            PIC 99.
  7799         16  EN-SIG-SW               PIC X.
  7800         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7801         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7802         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7803         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7804         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7805         16  FILLER                  PIC X(33).
  7806     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7807         16  EN-LF-ORIG-REF-DT       PIC XX.
  7808         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7809         16  EN-AH-ORIG-REF-DT       PIC XX.
  7810         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7811         16  EN-LF-NEW-REF-DT        PIC XX.
  7812         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7813         16  EN-AH-NEW-REF-DT        PIC XX.
  7814         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7815         16  EN-FLAG-CERT            PIC X.
  7816         16  EN-INS-LAST-NAME        PIC X(15).
  7817         16  EN-INS-FIRST-NAME       PIC X(10).
  7818         16  EN-INS-MIDDLE-INIT      PIC X.
  7819         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7820         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7821         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 143
* VP6311.cbl
  7822         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7823         16  FILLER                  PIC X(262).
  7824     12  EN-MONEY-SW             PIC X.
  7825     12  EN-HEALTH-APP           PIC X.
  7826     12  EN-VOUCHER-SW           PIC X.
  7827     12  EN-PAYEE                PIC X(14).
  7828     12  EN-INPUT-DT             PIC XX.
  7829     12  EN-PROCESS-DT           PIC XX.
  7830     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7831     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7832     12  EN-REASON-CODES.
  7833         16  F OCCURS 12.
  7834             20  EN-REASON-CODE  PIC X(4).
  7835     12  EN-TEMPLATE-USED        PIC X(8).
  7836     12  EN-DOCU-TYPE            PIC X.
  7837         88  EN-VERI-DOCU          VALUE 'V'.
  7838         88  EN-GCE-DOCU           VALUE 'G'.
  7839         88  EN-CANC-DOCU          VALUE 'C'.
  7840     12  EN-COMMENTS1            PIC X(13).
  7841     12  EN-COMMENTS2            PIC X(70).
  7842     12  EN-COMM-CHGBK           PIC X.
  7843         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7844         88  EN-CHG-ACCT           VALUE 'Y'.
  7845     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7846     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7847     12  EN-BATCH-NUMBER         PIC X(6).
  7848     12  EN-ACCT-SUMM            PIC X.
  7849     12  EN-CSO-SUMM             PIC X.
  7850     12  en-check-type           pic x.
  7851     12  FILLER                  PIC X(12).
  7852******************************************************************
  7853*                                COPY ELCCRTT.
  7854******************************************************************
  7855*                                                                *
  7856*                            ELCCRTT.                            *
  7857*                                                                *
  7858*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7859*                                                                *
  7860*   FILE TYPE = VSAM,KSDS                                        *
  7861*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7862*                                                                *
  7863*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7864*                                                                *
  7865*   LOG = YES                                                    *
  7866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7867******************************************************************
  7868*                   C H A N G E   L O G
  7869*
  7870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7871*-----------------------------------------------------------------
  7872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7873* EFFECTIVE    NUMBER
  7874*-----------------------------------------------------------------
  7875* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7876* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7877* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7878* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7879* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 144
* VP6311.cbl
  7880* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7881* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7882* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7883* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7884******************************************************************
  7885
  7886 01  CERTIFICATE-TRAILERS.
  7887     12  CS-RECORD-ID                      PIC XX.
  7888         88  VALID-CS-ID                      VALUE 'CS'.
  7889
  7890     12  CS-CONTROL-PRIMARY.
  7891         16  CS-COMPANY-CD                 PIC X.
  7892         16  CS-CARRIER                    PIC X.
  7893         16  CS-GROUPING                   PIC X(6).
  7894         16  CS-STATE                      PIC XX.
  7895         16  CS-ACCOUNT                    PIC X(10).
  7896         16  CS-CERT-EFF-DT                PIC XX.
  7897         16  CS-CERT-NO.
  7898             20  CS-CERT-PRIME             PIC X(10).
  7899             20  CS-CERT-SFX               PIC X.
  7900         16  CS-TRAILER-TYPE               PIC X.
  7901             88  COMM-TRLR           VALUE 'A'.
  7902             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7903             88  CERT-DATA-TRLR      VALUE 'C'.
  7904
  7905     12  CS-DATA-AREA                      PIC X(516).
  7906
  7907     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7908         16  CS-BANK-COMMISSION-AREA.
  7909             20  CS-BANK-COMMS       OCCURS 10.
  7910                 24  CS-AGT                PIC X(10).
  7911                 24  CS-COM-TYP            PIC X.
  7912                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7913                 24  CS-RECALC-LV-INDIC    PIC X.
  7914                 24  FILLER                PIC X(10).
  7915         16  FILLER                        PIC X(256).
  7916
  7917     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7918****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7919         16  CS-MB-CLAIM-DATA OCCURS 24.
  7920             20  CS-CLAIM-NO               PIC X(7).
  7921             20  CS-CLAIM-TYPE             PIC X.
  7922                 88  CS-AH-CLM               VALUE 'A'.
  7923                 88  CS-IU-CLM               VALUE 'I'.
  7924                 88  CS-GP-CLM               VALUE 'G'.
  7925                 88  CS-LF-CLM               VALUE 'L'.
  7926                 88  CS-PR-CLM               VALUE 'P'.
  7927                 88  CS-FL-CLM               VALUE 'F'.
  7928             20  CS-INSURED-TYPE           PIC X.
  7929                 88  CS-PRIM-INSURED          VALUE 'P'.
  7930                 88  CS-CO-BORROWER           VALUE 'C'.
  7931             20  CS-BENEFIT-PERIOD         PIC 99.
  7932             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7933             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7934             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7935         16  FILLER                        PIC X(12).
  7936     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7937         16  CS-VIN-NUMBER                 PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 145
* VP6311.cbl
  7938         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7939         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7940         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7941         16  cs-agent-name.
  7942             20  cs-agent-fname            pic x(20).
  7943             20  cs-agent-mi               pic x.
  7944             20  cs-agent-lname            pic x(25).
  7945         16  cs-license-no                 pic x(15).
  7946         16  cs-npn-number                 pic x(10).
  7947         16  cs-agent-edit-status          pic x.
  7948             88  cs-ae-refer-to-manager      value 'M'.
  7949             88  cs-ae-cover-sheet           value 'C'.
  7950             88  cs-ae-sig-form              value 'S'.
  7951             88  cs-ae-verified              value 'V'.
  7952             88  cs-unidentified-signature   value 'U'.
  7953             88  cs-cert-returned            value 'R'.
  7954             88  cs-accept-no-commission     value 'N'.
  7955         16  cs-year                       pic 9999.
  7956         16  cs-make                       pic x(20).
  7957         16  cs-model                      pic x(20).
  7958         16  cs-future                     pic x(20).
  7959         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7960         16  FILLER                        PIC X(356). *> was 420
  7961*        16  FILLER                        PIC X(496).
  7962*                                COPY ERCCHEK.
  7963******************************************************************
  7964*                                                                *
  7965*                                                                *
  7966*                            ERCCHEK                             *
  7967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7968*                            VMOD=2.008                          *
  7969*                                                                *
  7970*   FILE DESCRIPTION = CHECK RECORDS                             *
  7971*                                                                *
  7972*   FILE TYPE = VSAM,KSDS                                        *
  7973*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7974*                                                                *
  7975*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7976*       ALTERNATE INDEX = NONE                                   *
  7977*                                                                *
  7978*   LOG = YES                                                    *
  7979*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7980******************************************************************
  7981*                   C H A N G E   L O G
  7982*
  7983* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7984*-----------------------------------------------------------------
  7985*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7986* EFFECTIVE    NUMBER
  7987*-----------------------------------------------------------------
  7988* 021414    2003053000001  PEMA  changes for auto chk request
  7989******************************************************************
  7990 01  CHECK-RECORDS.
  7991     12  CH-RECORD-ID                      PIC XX.
  7992         88  VALID-CH-ID                      VALUE 'CH'.
  7993
  7994     12  CH-CONTROL-PRIMARY.
  7995         16  CH-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 146
* VP6311.cbl
  7996         16  CH-CARRIER                    PIC X.
  7997         16  CH-GROUPING                   PIC X(6).
  7998         16  CH-STATE                      PIC XX.
  7999         16  CH-ACCOUNT                    PIC X(10).
  8000         16  CH-CERT-EFF-DT                PIC XX.
  8001         16  CH-CERT-NO.
  8002             20  CH-CERT-PRIME             PIC X(10).
  8003             20  CH-CERT-SFX               PIC X.
  8004         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8005
  8006     12  CH-RECORDED-DT                    PIC XX.
  8007     12  CH-RECORDED-BY                    PIC X(4).
  8008     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8009
  8010     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8011     12  CH-CHECK-NO                       PIC X(7).
  8012     12  CH-REASON-FOR-CHECK               PIC X(25).
  8013     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8014     12  FILLER                            PIC X.
  8015
  8016     12  CH-PAYEE-INFO.
  8017         16  CH-PAYEE-NAME-1               PIC X(30).
  8018         16  CH-PAYEE-NAME-2               PIC X(30).
  8019         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8020         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8021         16  CH-PAYEE-CITY-ST.
  8022             20  CH-PAYEE-CITY             PIC X(28).
  8023             20  CH-PAYEE-STATE            PIC XX.
  8024         16  CH-PAYEE-ZIP-CODE.
  8025             20  CH-PAYEE-ZIP.
  8026                 24  CH-ZIP-PRI-1ST        PIC X.
  8027                     88  CH-CANADIAN-POST-CODE
  8028                                           VALUES 'A' THRU 'Z'.
  8029                 24  FILLER                PIC X(4).
  8030             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8031         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8032             20  CH-CAN-POSTAL-1           PIC XXX.
  8033             20  CH-CAN-POSTAL-2           PIC XXX.
  8034             20  FILLER                    PIC XXX.
  8035
  8036     12  CH-CHECK-STUB-TEXT.
  8037         16  CH-STUB-LINE-1                PIC X(30).
  8038         16  CH-TEXT-LINE-1                PIC X(50).
  8039         16  CH-TEXT-LINE-2                PIC X(50).
  8040         16  CH-TEXT-LINE-3                PIC X(40).
  8041     12  CH-RETURN-TO                      PIC X(30).
  8042
  8043     12  CH-COMPENSATION-CONTROL.
  8044         16  CH-COMP-CARRIER               PIC X.
  8045         16  CH-COMP-GROUPING              PIC X(6).
  8046         16  CH-COMP-FIN-RESP              PIC X(10).
  8047         16  CH-COMP-ACCOUNT               PIC X(10).
  8048
  8049     12  CH-CREDIT-SELECT-DT               PIC XX.
  8050     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8051     12  CH-PAYEE-CODE                     PIC X(6).
  8052
  8053     12  CH-VOID-DATA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 147
* VP6311.cbl
  8054         20  CH-VOID-DT                    PIC XX.
  8055         20  CH-VOID-BY                    PIC X(4).
  8056         20  CH-VOID-REASON                PIC X(25).
  8057
  8058     12  CH-APPROVAL-DATA.
  8059         20  CH-APPROVAL-DT                PIC XX.
  8060         20  CH-APPROVAL-STATUS            PIC X.
  8061             88  CH-IN-LIMBO                  VALUE ' '.
  8062             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8063             88  CH-APPROVED                  VALUE 'A'.
  8064             88  CH-DENIED                    VALUE 'D'.
  8065         20  CH-APPROVED-BY                PIC XXXX.
  8066     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8067             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8068     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8069
  8070     12  ch-released-dt                    pic xx.
  8071     12  ch-check-cashed-dt                pic xx.
  8072     12  FILLER                            PIC X.
  8073*    12  CH-CHECK-REFERENCE                PIC X(12).
  8074     12  CH-CHECK-ORIGIN-SW                PIC X.
  8075             88  CH-REFUND-CHECK              VALUE 'R'.
  8076             88  CH-MAINT-CHECK               VALUE 'M'.
  8077
  8078     12  CH-CANC-DT                        PIC XX.
  8079     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8080     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8081
  8082     12  CH-INSURED-NAME                   PIC X(28).
  8083
  8084     12  ch-released-by                    pic x(4).
  8085     12  ch-csr                            pic x(4).
  8086     12  ch-deduct-commission              pic x.
  8087         88  ch-deduct-comm                  value 'Y'.
  8088         88  ch-do-not-deduct-comm           value 'N'.
  8089
  8090     12  FILLER                            PIC X(11).
  8091*    12  CH-LETTER-TABLE.
  8092*        16  CH-LETTERS OCCURS 3 TIMES
  8093*                       INDEXED BY CH-LT-NDX
  8094*                                          PIC X(04).
  8095
  8096     12  FILLER                            PIC X(07).
  8097
  8098 01  var                         pic x(30).
  8099 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8100                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8101                          PENDING-MAILING-DATA MAILING-DATA
  8102                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8103                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8104                          CLAIM-MASTER ENDORSEMENT-RECORD
  8105                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8106                          VAR.
  8107 0000-DFHEXIT SECTION.
  8108     MOVE '9#                    $   ' TO DFHEIV0.
  8109     MOVE 'VP6311' TO DFHEIV1.
  8110     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8111
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 148
* VP6311.cbl
  8112     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8113     MOVE EIBTRMID               TO QID-TERM.
  8114     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8115     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8116     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8117     MOVE 2                      TO EMI-SWITCH2.
  8118
  8119     move spaces to ws-kix-myenv
  8120     set P to address of KIXSYS
  8121     CALL "getenv" using by value P returning var-ptr
  8122     if var-ptr = null then
  8123        display ' kixsys not set '
  8124     else
  8125        set address of var to var-ptr
  8126        move 0 to env-var-len
  8127        inspect var tallying env-var-len
  8128          for characters before X'00'
  8129        unstring var (1:env-var-len) delimited by '/'
  8130           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8131              WS-KIX-SYS
  8132        end-unstring
  8133     end-if
  8134     perform varying a1 from +1 by +1 until a1 > +10
  8135        if ws-kix-myenv (a1:1) = low-values or high-values
  8136           display ' found low or hi val '
  8137           move spaces to ws-kix-myenv (a1:1)
  8138        end-if
  8139     end-perform
  8140*    display ' env *' ws-kix-myenv '*'
  8141     IF EIBCALEN = 0
  8142         GO TO 8800-UNAUTHORIZED-ACCESS.
  8143
  8144     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8145     MOVE '5'                   TO DC-OPTION-CODE.
  8146     PERFORM 9700-DATE-LINK.
  8147     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8148     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8149
  8150     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8151     MOVE SPACE                  TO DC-OPTION-CODE.
  8152     PERFORM 9700-DATE-LINK.
  8153     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8154     MOVE LOW-VALUES             TO VP631BI.
  8155
  8156
  8157* EXEC CICS HANDLE CONDITION
  8158*        PGMIDERR  (9600-PGMID-ERROR)
  8159*        ERROR     (9990-ABEND)
  8160*        INVREQ    (9990-ABEND)
  8161*        QIDERR    (0010-MAIN-LOGIC)
  8162*    END-EXEC.
  8163*    MOVE '"$L.8N                ! " #00008152' TO DFHEIV0
  8164     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8166     MOVE X'2220233030303038313532' TO DFHEIV0(25:11)
  8167     CALL 'kxdfhei1' USING DFHEIV0
  8168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8169
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 149
* VP6311.cbl
  8170
  8171     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8172         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8173             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8174             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8175             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8176             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8177             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8178             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8179             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8180             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8181
  8182             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8183                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8184
  8185             ELSE
  8186                 NEXT SENTENCE
  8187
  8188         ELSE
  8189             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8190             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8191             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8192             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8193             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8194             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8195             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8196             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8197             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8198             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8199             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8200             GO TO 3900-RE-DISPLAY-RECORD
  8201     ELSE
  8202         GO TO 0020-MAIN-LOGIC.
  8203
  8204 0010-MAIN-LOGIC.
  8205     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8206                                    WS-FIRST-ENTRY-SW.
  8207
  8208     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8209
  8210     MOVE LOW-VALUES             TO EC-NEW-CERT
  8211                                    EC-NEW-STATE.
  8212
  8213     IF PI-DISPLAY-ORIGINAL-BATCH
  8214         NEXT SENTENCE
  8215     ELSE
  8216         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8217             GO TO 5000-BROWSE-BATCH-HEADERS.
  8218
  8219     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8220         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8221
  8222     IF PI-CSR-BROWSE
  8223        GO TO 4200-BROWSE-CSR-FORWARD.
  8224
  8225     IF PI-FILE-BROWSE
  8226         GO TO 4300-BROWSE-FILE-FORWARD.
  8227
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 150
* VP6311.cbl
  8228     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8229
  8230 0020-MAIN-LOGIC.
  8231     IF EIBAID = DFHCLEAR
  8232         GO TO 9400-CLEAR.
  8233
  8234     MOVE LOW-VALUES             TO EC-NEW-CERT
  8235                                    EC-NEW-STATE.
  8236
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 151
* VP6311.cbl
  8238
  8239******************************************************************
  8240*                                                                *
  8241*              R E C E I V E   M A P                             *
  8242*                                                                *
  8243******************************************************************
  8244
  8245 0200-RECEIVE.
  8246     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8247         MOVE ER-0008            TO EMI-ERROR
  8248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8249         IF PI-MAP-NAME = VP631B
  8250             MOVE -1                 TO BMAINTL
  8251             GO TO 8200-SEND-DATAONLY
  8252         ELSE
  8253             IF PI-MAP-NAME = VP631C
  8254                 MOVE -1                 TO CMAINTL
  8255                 GO TO 8200-SEND-DATAONLY
  8256             ELSE
  8257                 IF PI-MAP-NAME = VP631D
  8258                     MOVE -1                 TO DPFENTRL
  8259                     GO TO 8200-SEND-DATAONLY.
  8260
  8261
  8262* EXEC CICS RECEIVE
  8263*        MAP      (PI-MAP-NAME)
  8264*        MAPSET   (MAPSET-VP6311S)
  8265*        INTO     (VP631BI)
  8266*    END-EXEC.
  8267     MOVE LENGTH OF
  8268      VP631BI
  8269       TO DFHEIV11
  8270*    MOVE '8"T I  L              ''   #00008249' TO DFHEIV0
  8271     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8272     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8273     MOVE X'2020233030303038323439' TO DFHEIV0(25:11)
  8274     CALL 'kxdfhei1' USING DFHEIV0,
  8275           PI-MAP-NAME,
  8276           VP631BI,
  8277           DFHEIV11,
  8278           MAPSET-VP6311S,
  8279           DFHEIV99,
  8280           DFHEIV99
  8281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8282
  8283
  8284******************************************************************
  8285*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8286******************************************************************
  8287
  8288     IF BTYPE-LEN (1) EQUAL +3
  8289        IF BTYPE (1) EQUAL ALL ' '
  8290            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8291
  8292     IF BTYPE-LEN (2) EQUAL +3
  8293        IF BTYPE (2) EQUAL ALL ' '
  8294            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8295
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 152
* VP6311.cbl
  8296     INSPECT VP631BI CONVERTING '_' TO ' '.
  8297
  8298     IF PI-MAP-NAME = VP631B
  8299         IF BPFENTRL GREATER THAN ZEROS
  8300             IF EIBAID NOT = DFHENTER
  8301                 MOVE ER-0004       TO EMI-ERROR
  8302                 MOVE -1            TO BPFENTRL
  8303                 MOVE AL-UNBOF      TO BPFENTRA
  8304                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8305                 GO TO 8200-SEND-DATAONLY
  8306             ELSE
  8307                 IF BPFENTRI NUMERIC AND
  8308                   (BPFENTRI GREATER 0 AND LESS 25)
  8309                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8310                 ELSE
  8311                     MOVE ER-0029  TO EMI-ERROR
  8312                     MOVE AL-UNBON TO BPFENTRA
  8313                     MOVE -1       TO BPFENTRL
  8314                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8315                     GO TO 8200-SEND-DATAONLY
  8316         ELSE
  8317             NEXT SENTENCE
  8318     ELSE
  8319         IF PI-MAP-NAME = VP631C
  8320            IF CPFENTRL GREATER THAN ZEROS
  8321                IF EIBAID NOT = DFHENTER
  8322                 MOVE ER-0004         TO EMI-ERROR
  8323                 MOVE -1              TO CPFENTRL
  8324                 MOVE AL-UNBOF        TO CPFENTRA
  8325                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8326                 GO TO 8200-SEND-DATAONLY
  8327             ELSE
  8328                 IF CPFENTRI NUMERIC AND
  8329                   (CPFENTRI GREATER 0 AND LESS 25)
  8330                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8331                 ELSE
  8332                     MOVE ER-0029      TO EMI-ERROR
  8333                     MOVE AL-UNBON     TO CPFENTRA
  8334                     MOVE -1           TO CPFENTRL
  8335                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8336                     GO TO 8200-SEND-DATAONLY
  8337         ELSE
  8338             NEXT SENTENCE
  8339     ELSE
  8340     IF PI-MAP-NAME = VP631D
  8341         IF DPFENTRL GREATER THAN ZEROS
  8342             IF EIBAID NOT = DFHENTER
  8343                 MOVE ER-0004         TO EMI-ERROR
  8344                 MOVE -1              TO DPFENTRL
  8345                 MOVE AL-UNBOF        TO DPFENTRA
  8346                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8347                 GO TO 8200-SEND-DATAONLY
  8348             ELSE
  8349                 IF DPFENTRI NUMERIC AND
  8350                   (DPFENTRI GREATER 0 AND LESS 25)
  8351                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8352                 ELSE
  8353                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 153
* VP6311.cbl
  8354                     MOVE AL-UNBON     TO DPFENTRA
  8355                     MOVE -1           TO DPFENTRL
  8356                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8357                     GO TO 8200-SEND-DATAONLY.
  8358
  8359     IF EIBAID = DFHPF23
  8360         GO TO 8810-PF23.
  8361
  8362     IF EIBAID = DFHPF24
  8363         GO TO 9200-RETURN-MAIN-MENU.
  8364
  8365     IF EIBAID = DFHPF12
  8366         GO TO 9500-PF12.
  8367
  8368     IF PI-MAP-NAME = VP631B
  8369        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8370
  8371     IF PI-MAP-NAME = VP631C
  8372        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8373
  8374     IF PI-MAP-NAME = VP631D
  8375        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8376
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 154
* VP6311.cbl
  8378
  8379******************************************************************
  8380*                                                                *
  8381*      ISSUE SCREEN PF KEY CHECKING                              *
  8382*                                                                *
  8383******************************************************************
  8384
  8385******************************************************************
  8386*                                                                *
  8387*      PF KEY FUNCTIONS:                                         *
  8388*                                                                *
  8389*      PF1  = BROWSE FORWARD                                     *
  8390*      PF2  = BROWSE BACKWARD                                    *
  8391*      PF3  = CERTIFICATE LOOKUP                                 *
  8392*      PF4  = DISPLAY BATCH HEADER                               *
  8393*      PF5  = ADD ISSUE  SCREEN                                  *
  8394*      PF6  = ADD CANCEL SCREEN                                  *
  8395*      PF7  = CERTIFICATE DISPLAY                                *
  8396*      PF8  = CERTIFICATE NOTES                                  *
  8397*      PF9  = EDIT CONTROL                                       *
  8398*      PF10 = DISPLAY LETTER SCREEN                              *
  8399*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8400*      PF12 = HELP SCREEN                                        *
  8401*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8402*      PF14 = ACCOUNT MASTER                                     *
  8403*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8404*      PF16 = DISPLAY LETTER REVIEW                              *
  8405*                                                                *
  8406******************************************************************
  8407
  8408 0300-CHECK-ISSUE-PF-KEYS.
  8409     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8410        MOVE ER-2337            TO EMI-ERROR
  8411        MOVE -1                  TO BMAINTL
  8412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8413        GO TO 8200-SEND-DATAONLY.
  8414
  8415     IF EIBAID = DFHPF1
  8416        MOVE '0'                TO PI-EDIT-SW
  8417        IF PI-PRIMARY-BROWSE
  8418           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8419        ELSE
  8420           IF PI-PRIMARY-WITH-SELECT
  8421              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8422           ELSE
  8423              IF PI-FILE-BROWSE
  8424                 GO TO 4300-BROWSE-FILE-FORWARD
  8425              ELSE
  8426                 IF PI-CSR-BROWSE
  8427                    GO TO 4200-BROWSE-CSR-FORWARD
  8428                 ELSE
  8429                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8430
  8431     IF EIBAID = DFHPF2
  8432        MOVE '0'                TO PI-EDIT-SW
  8433        IF PI-PRIMARY-BROWSE
  8434           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8435        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 155
* VP6311.cbl
  8436           IF PI-PRIMARY-WITH-SELECT
  8437              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8438           ELSE
  8439              IF PI-FILE-BROWSE
  8440                 GO TO 4800-BROWSE-FILE-BACKWARD
  8441              ELSE
  8442                 IF PI-CSR-BROWSE
  8443                    GO TO 4900-BROWSE-CSR-BACKWARD
  8444                 ELSE
  8445                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8446
  8447     IF EIBAID = DFHPF3
  8448        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8449        MOVE XCTL-EL127         TO PGM-NAME
  8450        GO TO 9300-XCTL.
  8451
  8452     IF (EIBAID = DFHPF15 OR DFHPF6)
  8453        AND (CSR-EDIT-SESSION)
  8454*       AND (FATAL-OR-UNFORCED)
  8455        AND (FATAL-ERRORS)
  8456        MOVE ER-1819             TO EMI-ERROR
  8457        MOVE -1                  TO BMAINTL
  8458        MOVE AL-UANON            TO BMAINTA
  8459        PERFORM 9900-ERROR-FORMAT
  8460                                 THRU 9900-EXIT
  8461        GO TO 8200-SEND-DATAONLY
  8462     END-IF
  8463     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8464      OR (EIBAID = DFHPF10)
  8465        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8466        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8467        IF (RESP-NORMAL)
  8468           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8469              AM-CONTROL-PRIMARY (1:20))
  8470            IF AM-NAME NOT GREATER THAN SPACES OR
  8471               AM-ADDRS NOT GREATER THAN SPACES  OR
  8472               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8473               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8474               AM-ZIP NOT GREATER THAN SPACES
  8475               MOVE ER-3834             TO EMI-ERROR
  8476               MOVE -1                  TO BMAINTL
  8477               MOVE AL-UANON            TO BMAINTA
  8478               PERFORM 9900-ERROR-FORMAT
  8479                                 THRU 9900-EXIT
  8480               GO TO 8200-SEND-DATAONLY
  8481            END-IF
  8482        ELSE
  8483           MOVE ER-1609             TO EMI-ERROR
  8484           MOVE -1                  TO BMAINTL
  8485           MOVE AL-UANON            TO BMAINTA
  8486           PERFORM 9900-ERROR-FORMAT
  8487                                THRU 9900-EXIT
  8488           GO TO 8200-SEND-DATAONLY
  8489        END-IF
  8490
  8491        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8492        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8493        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 156
* VP6311.cbl
  8494            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8495               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8496               MA-CITY NOT GREATER THAN SPACES OR
  8497               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8498               MA-ZIP-CODE NOT GREATER THAN SPACES
  8499               MOVE ER-3835             TO EMI-ERROR
  8500               MOVE -1                  TO BMAINTL
  8501               MOVE AL-UANON            TO BMAINTA
  8502               PERFORM 9900-ERROR-FORMAT
  8503                                 THRU 9900-EXIT
  8504               GO TO 8200-SEND-DATAONLY
  8505            END-IF
  8506        ELSE
  8507           MOVE ER-3000             TO EMI-ERROR
  8508           MOVE -1                  TO BMAINTL
  8509           MOVE AL-UANON            TO BMAINTA
  8510           PERFORM 9900-ERROR-FORMAT
  8511                                THRU 9900-EXIT
  8512           GO TO 8200-SEND-DATAONLY
  8513        END-IF
  8514
  8515     END-IF
  8516     IF (EIBAID = DFHPF15)
  8517        AND (CSR-EDIT-SESSION)
  8518        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8519        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8520        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8521        MOVE PI-SV-STATE         TO PI-STATE
  8522        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8523        MOVE BCERTNOI            TO PI-CERT-PRIME
  8524        MOVE BSUFIXI             TO PI-CERT-SFX
  8525        MOVE BEFFDTI             TO DEEDIT-FIELD
  8526        PERFORM 8600-DEEDIT
  8527        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8528        MOVE '4'                 TO DC-OPTION-CODE
  8529        PERFORM 9700-DATE-LINK
  8530        IF DATE-CONVERSION-ERROR
  8531           MOVE ER-0348          TO EMI-ERROR
  8532           MOVE -1               TO BEFFDTL
  8533           MOVE AL-UABON         TO BEFFDTA
  8534           PERFORM 9900-ERROR-FORMAT
  8535                                 THRU 9900-EXIT
  8536           GO TO 8200-SEND-DATAONLY
  8537        ELSE
  8538           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8539           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8540           MOVE XCTL-EL6315      TO PGM-NAME
  8541           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8542           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8543           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8544           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8545           GO TO 9300-XCTL
  8546        END-IF
  8547     END-IF
  8548
  8549     IF EIBAID = DFHPF4
  8550        MOVE '0'                TO PI-EDIT-SW
  8551        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 157
* VP6311.cbl
  8552           NEXT SENTENCE
  8553        ELSE
  8554           GO TO 7200-DISPLAY-BATCHES.
  8555
  8556     IF EIBAID = DFHPF5
  8557        MOVE ER-0029                TO EMI-ERROR
  8558        MOVE -1                     TO BPFENTRL
  8559        MOVE AL-UNBON               TO BPFENTRA
  8560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8561        GO TO 8200-SEND-DATAONLY.
  8562*        MOVE '0'                TO PI-EDIT-SW
  8563*        IF PI-DISPLAY-ORIGINAL-BATCH
  8564*           NEXT SENTENCE
  8565*        ELSE
  8566*           MOVE VP631B              TO PI-MAP-NAME
  8567*           MOVE LOW-VALUES          TO VP631BI
  8568*           MOVE 'A'                 TO BMAINTO
  8569*           MOVE AL-UANON            TO BMAINTA
  8570*           MOVE -1                  TO BMAINTL
  8571*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8572*           GO TO 8100-SEND-INITIAL-MAP.
  8573
  8574     IF EIBAID = DFHPF6
  8575        IF NOT CSR-EDIT-SESSION
  8576           MOVE ER-0029                TO EMI-ERROR
  8577           MOVE -1                     TO BPFENTRL
  8578           MOVE AL-UNBON               TO BPFENTRA
  8579           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8580           GO TO 8200-SEND-DATAONLY
  8581*           MOVE '0'              TO PI-EDIT-SW
  8582*           IF PI-DISPLAY-ORIGINAL-BATCH
  8583*              NEXT SENTENCE
  8584*           ELSE
  8585*              MOVE VP631C        TO PI-MAP-NAME
  8586*              MOVE LOW-VALUES    TO VP631CI
  8587*              MOVE 'A'           TO CMAINTO
  8588*              MOVE AL-UANON      TO CMAINTA
  8589*              MOVE -1            TO CMAINTL
  8590*              MOVE '6'           TO PI-MAINT-FUNCTION
  8591*              GO TO 8100-SEND-INITIAL-MAP
  8592*           END-IF
  8593        ELSE
  8594           PERFORM 5100-PROCESS-POL-RESC
  8595                                 THRU 5100-EXIT
  8596           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8597           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8598                                    PI-PREV-SEQ-NO
  8599           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8600*                                    WS-CANCEL-LETTER-SW
  8601                                    PI-ALL-ISSUES-SW
  8602                                    PI-ALL-CANCELS-SW
  8603           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8604        END-IF
  8605     END-IF
  8606     IF EIBAID = DFHPF7
  8607        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8608        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8609        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 158
* VP6311.cbl
  8610        MOVE PI-SV-STATE            TO PI-STATE
  8611        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8612        MOVE BCERTNOI               TO PI-CERT-PRIME
  8613        MOVE BSUFIXI                TO PI-CERT-SFX
  8614        MOVE BEFFDTI                TO DEEDIT-FIELD
  8615        PERFORM 8600-DEEDIT
  8616        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8617        MOVE '4'                    TO DC-OPTION-CODE
  8618        PERFORM 9700-DATE-LINK
  8619        IF DATE-CONVERSION-ERROR
  8620           MOVE ER-0348            TO EMI-ERROR
  8621           MOVE -1                  TO BEFFDTL
  8622           MOVE AL-UABON            TO BEFFDTA
  8623           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8624           GO TO 8200-SEND-DATAONLY
  8625        ELSE
  8626           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8627           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8628           MOVE XCTL-EL1273        TO PGM-NAME
  8629           GO TO 9300-XCTL.
  8630
  8631     IF EIBAID = DFHPF8
  8632        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8633        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8634        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8635        MOVE PI-SV-STATE            TO PI-STATE
  8636        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8637        MOVE BCERTNOI               TO PI-CERT-PRIME
  8638        MOVE BSUFIXI                TO PI-CERT-SFX
  8639        MOVE BEFFDTI                TO DEEDIT-FIELD
  8640        PERFORM 8600-DEEDIT
  8641        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8642        MOVE '4'                    TO DC-OPTION-CODE
  8643        PERFORM 9700-DATE-LINK
  8644        IF DATE-CONVERSION-ERROR
  8645           MOVE ER-0348            TO EMI-ERROR
  8646           MOVE -1                  TO BEFFDTL
  8647           MOVE AL-UABON            TO BEFFDTA
  8648           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8649           GO TO 8200-SEND-DATAONLY
  8650        ELSE
  8651           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8652           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8653           IF PI-COMPANY-ID = 'DMD'
  8654               MOVE XCTL-EL401DMD      TO PGM-NAME
  8655             ELSE
  8656               MOVE XCTL-EL1279        TO PGM-NAME
  8657           END-IF
  8658           GO TO 9300-XCTL.
  8659
  8660     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8661        MOVE XCTL-EL6312         TO PGM-NAME
  8662
  8663* EXEC CICS XCTL
  8664*           PROGRAM   (PGM-NAME)
  8665*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8666*           LENGTH    (WS-COMM-LENGTH)
  8667*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 159
* VP6311.cbl
  8668*    MOVE '.$C                   %   #00008633' TO DFHEIV0
  8669     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8670     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8671     MOVE X'2020233030303038363333' TO DFHEIV0(25:11)
  8672     CALL 'kxdfhei1' USING DFHEIV0,
  8673           PGM-NAME,
  8674           PROGRAM-INTERFACE-BLOCK,
  8675           WS-COMM-LENGTH,
  8676           DFHEIV99
  8677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8678     ELSE
  8679        MOVE '0'                 TO  PI-EDIT-SW.
  8680
  8681     IF  EIBAID = DFHPF10
  8682         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8683         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8684         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8685                                    PI-1042-WA
  8686         MOVE 4                  TO PI-689-DATA-SOURCE
  8687         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8688         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8689         MOVE PI-SV-STATE        TO PI-689-STATE
  8690         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8691         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8692         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8693         MOVE PI-PB-ALT-CHG-SEQ-NO
  8694                                 TO PI-689-ALT-SEQ-NO
  8695         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8696         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8697         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8698         MOVE +0                 TO PI-689-CONTROL
  8699         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8700                                    PI-689-EXP-DATE
  8701                                    PI-689-RESP-PERSON
  8702                                    PI-689-TYPE
  8703                                    PI-689-FOLLOW-UP-EDIT
  8704                                    PI-689-RESEND1-EDIT
  8705                                    PI-689-SEQ-EDIT
  8706                                    PI-689-BCSEQ-EDIT
  8707                                    PI-689-LBL-OVERRIDE
  8708         MOVE W-LETTER-COMMUNICATION-AREAS
  8709                                 TO PI-PROGRAM-WORK-AREA
  8710         MOVE XCTL-EL689         TO PGM-NAME
  8711         GO TO 9300-XCTL.
  8712
  8713     IF  EIBAID = DFHPF16
  8714         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8715         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8716         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8717                                    PI-1042-WA
  8718         MOVE 4                  TO PI-689-DATA-SOURCE
  8719         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8720         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8721         MOVE PI-SV-STATE        TO PI-689-STATE
  8722         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8723         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8724         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8725         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 160
* VP6311.cbl
  8726                                 TO PI-689-ALT-SEQ-NO
  8727         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8728         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8729         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8730         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8731         MOVE W-LETTER-COMMUNICATION-AREAS
  8732                                 TO PI-PROGRAM-WORK-AREA
  8733         MOVE XCTL-EL690         TO PGM-NAME
  8734         GO TO 9300-XCTL.
  8735
  8736     IF EIBAID = DFHPF13
  8737         MOVE XCTL-EL6313        TO PGM-NAME
  8738         GO TO 9300-XCTL.
  8739
  8740     IF EIBAID = DFHPF17
  8741        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8742        IF (PB-I-LOAN-APR numeric)
  8743           and (pb-i-loan-apr < 99.9999)
  8744           AND (PB-I-BENEFICIARY-NAME NOT
  8745              = SPACES AND LOW-VALUES)
  8746
  8747           MOVE LINK-ELVADS          TO PGM-NAME
  8748
  8749* EXEC CICS LINK
  8750*              PROGRAM    (PGM-NAME)
  8751*              COMMAREA   (WS-PASS-AREA)
  8752*              LENGTH     (WS-PASS-AREA-LENGTH)
  8753*          END-EXEC
  8754*    MOVE '."C                   (   #00008708' TO DFHEIV0
  8755     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8756     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8757     MOVE X'2020233030303038373038' TO DFHEIV0(25:11)
  8758     CALL 'kxdfhei1' USING DFHEIV0,
  8759           PGM-NAME,
  8760           WS-PASS-AREA,
  8761           WS-PASS-AREA-LENGTH,
  8762           DFHEIV99,
  8763           DFHEIV99,
  8764           DFHEIV99,
  8765           DFHEIV99
  8766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8767
  8768           MOVE 0000             TO EMI-ERROR
  8769           MOVE -1               TO BMAINTL
  8770           PERFORM 9900-ERROR-FORMAT
  8771                                 THRU 9900-EXIT
  8772           GO TO 8200-SEND-DATAONLY
  8773        ELSE
  8774           MOVE ER-0877            TO EMI-ERROR
  8775           MOVE -1                  TO BEFFDTL
  8776           MOVE AL-UABON            TO BEFFDTA
  8777           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8778           GO TO 8200-SEND-DATAONLY
  8779        END-IF
  8780     END-IF
  8781     IF EIBAID = DFHPF14
  8782        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8783        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 161
* VP6311.cbl
  8784        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8785        MOVE PI-SV-STATE            TO PI-CR-STATE
  8786        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8787        MOVE SPACE                  TO PI-EDIT-SW
  8788        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8789        MOVE XCTL-EL650             TO PGM-NAME
  8790        GO TO 9300-XCTL.
  8791
  8792     IF EIBAID = DFHPF15
  8793        IF PI-COMPANY-ID  =  'HER'
  8794            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8795            MOVE XCTL-EL680         TO PGM-NAME
  8796            GO TO 9300-XCTL.
  8797
  8798     IF EIBAID = DFHENTER OR DFHPF11
  8799        GO TO 1000-ISSUE-MAINLINE.
  8800
  8801     MOVE ER-0029                TO EMI-ERROR
  8802     MOVE -1                     TO BPFENTRL
  8803     MOVE AL-UNBON               TO BPFENTRA
  8804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8805     GO TO 8200-SEND-DATAONLY.
  8806
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 162
* VP6311.cbl
  8808
  8809******************************************************************
  8810*                                                                *
  8811*      CANCEL SCREEN PF KEY CHECKING                             *
  8812*                                                                *
  8813******************************************************************
  8814
  8815******************************************************************
  8816*                                                                *
  8817*      PF KEY FUNCTIONS:                                         *
  8818*                                                                *
  8819*      PF1  = BROWSE FORWARD                                     *
  8820*      PF2  = BROWSE BACKWARD                                    *
  8821*      PF3  = CERTIFICATE LOOKUP                                 *
  8822*      PF4  = DISPLAY BATCH HEADER                               *
  8823*      PF5  = ADD ISSUE SCREEN                                   *
  8824*      PF6  = ADD CANCEL SCREEN                                  *
  8825*      PF7  = CERTIFICATE DISPLAY                                *
  8826*      PF8  = CERTIFICATE NOTES                                  *
  8827*      PF9  = EDIT CONTROL                                       *
  8828*      PF10 = DISPLAY LETTER SCREEN                              *
  8829*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8830*      PF12 = DISPLAY HELP SCREEN                                *
  8831*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8832*      PF14 = ACCOUNT MASTER                                     *
  8833*      PF16 = LETTER REVIEW                                      *
  8834*                                                                *
  8835******************************************************************
  8836
  8837 0400-CHECK-CANCEL-PF-KEYS.
  8838     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8839        MOVE ER-2337             TO EMI-ERROR
  8840        MOVE -1                  TO CMAINTL
  8841        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8842        GO TO 8200-SEND-DATAONLY.
  8843
  8844     IF EIBAID = DFHPF1
  8845        MOVE '0'                TO PI-EDIT-SW
  8846        IF PI-PRIMARY-BROWSE
  8847           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8848        ELSE
  8849           IF PI-PRIMARY-WITH-SELECT
  8850              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8851           ELSE
  8852              IF PI-FILE-BROWSE
  8853                 GO TO 4300-BROWSE-FILE-FORWARD
  8854              ELSE
  8855                 IF PI-CSR-BROWSE
  8856                    GO TO 4200-BROWSE-CSR-FORWARD
  8857                 ELSE
  8858                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8859
  8860     IF EIBAID = DFHPF2
  8861        MOVE '0'                TO PI-EDIT-SW
  8862        IF PI-PRIMARY-BROWSE
  8863           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8864        ELSE
  8865           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 163
* VP6311.cbl
  8866              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8867           ELSE
  8868              IF PI-FILE-BROWSE
  8869                 GO TO 4800-BROWSE-FILE-BACKWARD
  8870              ELSE
  8871                 IF PI-CSR-BROWSE
  8872                    GO TO 4900-BROWSE-CSR-BACKWARD
  8873                 ELSE
  8874                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8875
  8876     IF EIBAID = DFHPF3
  8877        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8878        MOVE XCTL-EL127         TO PGM-NAME
  8879        GO TO 9300-XCTL.
  8880
  8881     IF (EIBAID = DFHPF15 OR DFHPF17)
  8882        AND (CSR-EDIT-SESSION)
  8883*       AND (FATAL-OR-UNFORCED)
  8884        AND (FATAL-ERRORS)
  8885        MOVE ER-1819             TO EMI-ERROR
  8886        MOVE -1                  TO CMAINTL
  8887        MOVE AL-UANON            TO CMAINTA
  8888        PERFORM 9900-ERROR-FORMAT
  8889                                 THRU 9900-EXIT
  8890        GO TO 8200-SEND-DATAONLY
  8891     END-IF
  8892     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8893       AND (CSR-EDIT-SESSION)
  8894        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8895        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8896        IF (RESP-NORMAL)
  8897           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8898              AM-CONTROL-PRIMARY (1:20))
  8899            IF AM-NAME NOT GREATER THAN SPACES OR
  8900               AM-ADDRS NOT GREATER THAN SPACES  OR
  8901               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8902               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8903               AM-ZIP NOT GREATER THAN SPACES
  8904               MOVE ER-3834             TO EMI-ERROR
  8905               MOVE -1                  TO BMAINTL
  8906               MOVE AL-UANON            TO BMAINTA
  8907               PERFORM 9900-ERROR-FORMAT
  8908                                 THRU 9900-EXIT
  8909               GO TO 8200-SEND-DATAONLY
  8910            END-IF
  8911        ELSE
  8912           MOVE ER-1609             TO EMI-ERROR
  8913           MOVE -1                  TO BMAINTL
  8914           MOVE AL-UANON            TO BMAINTA
  8915           PERFORM 9900-ERROR-FORMAT
  8916                                THRU 9900-EXIT
  8917           GO TO 8200-SEND-DATAONLY
  8918        END-IF
  8919
  8920        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8921        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8922        IF (ERMAIL-FOUND)
  8923            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 164
* VP6311.cbl
  8924               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8925               MA-CITY NOT GREATER THAN SPACES OR
  8926               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8927               MA-ZIP-CODE NOT GREATER THAN SPACES
  8928               MOVE ER-3835             TO EMI-ERROR
  8929               MOVE -1                  TO BMAINTL
  8930               MOVE AL-UANON            TO BMAINTA
  8931               PERFORM 9900-ERROR-FORMAT
  8932                                 THRU 9900-EXIT
  8933               GO TO 8200-SEND-DATAONLY
  8934            END-IF
  8935        ELSE
  8936           MOVE ER-3000             TO EMI-ERROR
  8937           MOVE -1                  TO BMAINTL
  8938           MOVE AL-UANON            TO BMAINTA
  8939           PERFORM 9900-ERROR-FORMAT
  8940                                THRU 9900-EXIT
  8941           GO TO 8200-SEND-DATAONLY
  8942        END-IF
  8943
  8944     END-IF
  8945     IF (EIBAID = DFHPF15 OR DFHPF17)
  8946        AND (CSR-EDIT-SESSION)
  8947        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8948        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8949        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8950        MOVE PI-SV-STATE         TO PI-STATE
  8951        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8952        MOVE CCERTNOI            TO PI-CERT-PRIME
  8953        MOVE CSUFIXI             TO PI-CERT-SFX
  8954        MOVE CEFFDTI             TO DEEDIT-FIELD
  8955        PERFORM 8600-DEEDIT
  8956        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8957        MOVE '4'                 TO DC-OPTION-CODE
  8958        PERFORM 9700-DATE-LINK
  8959        IF DATE-CONVERSION-ERROR
  8960           MOVE ER-0348          TO EMI-ERROR
  8961           MOVE -1               TO CEFFDTL
  8962           MOVE AL-UABON         TO CEFFDTA
  8963           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8964           GO TO 8200-SEND-DATAONLY
  8965        ELSE
  8966           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8967           PERFORM 6000-CREATE-TEMP-STORAGE
  8968                                 THRU 6000-EXIT
  8969           IF EIBAID = DFHPF17
  8970               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8971                                  THRU 6400-EXIT
  8972               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8973                                 '2' AND '3' AND '4'
  8974                  MOVE ER-3831     TO  EMI-ERROR
  8975                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8976                  GO TO 8200-SEND-DATAONLY
  8977               END-IF
  8978               MOVE 'Y'          TO PI-CLM-RESC-IND
  8979           ELSE
  8980               MOVE 'N'          TO PI-CLM-RESC-IND
  8981           END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 165
* VP6311.cbl
  8982           MOVE XCTL-EL6316      TO PGM-NAME
  8983           MOVE '2'              TO PI-ISS-CAN-SW
  8984           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8985           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8986           GO TO 9300-XCTL
  8987        END-IF
  8988     END-IF
  8989
  8990     IF EIBAID = DFHPF4
  8991        MOVE '0'                TO PI-EDIT-SW
  8992        IF PI-DISPLAY-ORIGINAL-BATCH
  8993           NEXT SENTENCE
  8994        ELSE
  8995           GO TO 7200-DISPLAY-BATCHES.
  8996
  8997     IF EIBAID = DFHPF5
  8998        MOVE ER-0029                TO EMI-ERROR
  8999        MOVE -1                     TO BPFENTRL
  9000        MOVE AL-UNBON               TO BPFENTRA
  9001        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9002        GO TO 8200-SEND-DATAONLY.
  9003*        MOVE '0'                TO PI-EDIT-SW
  9004*        IF PI-DISPLAY-ORIGINAL-BATCH
  9005*           NEXT SENTENCE
  9006*        ELSE
  9007*           MOVE VP631B              TO PI-MAP-NAME
  9008*           MOVE LOW-VALUES          TO VP631BI
  9009*           MOVE 'A'                 TO BMAINTO
  9010*           MOVE AL-UANON            TO BMAINTA
  9011*           MOVE -1                  TO BMAINTL
  9012*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9013*           GO TO 8100-SEND-INITIAL-MAP.
  9014
  9015     IF EIBAID = DFHPF6
  9016        MOVE ER-0029                TO EMI-ERROR
  9017        MOVE -1                     TO BPFENTRL
  9018        MOVE AL-UNBON               TO BPFENTRA
  9019        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9020        GO TO 8200-SEND-DATAONLY.
  9021*        MOVE '0'                TO PI-EDIT-SW
  9022*        IF PI-DISPLAY-ORIGINAL-BATCH
  9023*           NEXT SENTENCE
  9024*        ELSE
  9025*           MOVE VP631C              TO PI-MAP-NAME
  9026*           MOVE LOW-VALUES          TO VP631CI
  9027*           MOVE 'A'                 TO CMAINTO
  9028*           MOVE AL-UANON            TO CMAINTA
  9029*           MOVE -1                  TO CMAINTL
  9030*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9031*           GO TO 8100-SEND-INITIAL-MAP.
  9032
  9033     IF EIBAID = DFHPF7
  9034        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9035        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9036        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9037        MOVE PI-SV-STATE            TO PI-STATE
  9038        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9039        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 166
* VP6311.cbl
  9040        MOVE CSUFIXI                TO PI-CERT-SFX
  9041        MOVE CEFFDTI                TO DEEDIT-FIELD
  9042        PERFORM 8600-DEEDIT
  9043        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9044        MOVE '4'                    TO DC-OPTION-CODE
  9045        PERFORM 9700-DATE-LINK
  9046        IF DATE-CONVERSION-ERROR
  9047           MOVE ER-0348            TO EMI-ERROR
  9048           MOVE -1                  TO BEFFDTL
  9049           MOVE AL-UABON            TO BEFFDTA
  9050           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9051           GO TO 8200-SEND-DATAONLY
  9052        ELSE
  9053           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9054           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9055           MOVE XCTL-EL1273        TO PGM-NAME
  9056           GO TO 9300-XCTL.
  9057
  9058     IF EIBAID = DFHPF8
  9059        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9060        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9061        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9062        MOVE PI-SV-STATE            TO PI-STATE
  9063        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9064        MOVE CCERTNOI               TO PI-CERT-PRIME
  9065        MOVE CSUFIXI                TO PI-CERT-SFX
  9066        MOVE CEFFDTI                TO DEEDIT-FIELD
  9067        PERFORM 8600-DEEDIT
  9068        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9069        MOVE '4'                    TO DC-OPTION-CODE
  9070        PERFORM 9700-DATE-LINK
  9071        IF DATE-CONVERSION-ERROR
  9072           MOVE ER-0348             TO EMI-ERROR
  9073           MOVE -1                  TO BEFFDTL
  9074           MOVE AL-UABON            TO BEFFDTA
  9075           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9076           GO TO 8200-SEND-DATAONLY
  9077        ELSE
  9078           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9079           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9080           IF PI-COMPANY-ID = 'DMD'
  9081               MOVE XCTL-EL401DMD      TO PGM-NAME
  9082             ELSE
  9083               MOVE XCTL-EL1279        TO PGM-NAME
  9084           END-IF
  9085           GO TO 9300-XCTL.
  9086
  9087     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9088        MOVE XCTL-EL6312     TO PGM-NAME
  9089
  9090* EXEC CICS XCTL
  9091*           PROGRAM  (PGM-NAME)
  9092*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9093*           LENGTH   (WS-COMM-LENGTH)
  9094*       END-EXEC
  9095*    MOVE '.$C                   %   #00009035' TO DFHEIV0
  9096     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9097     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 167
* VP6311.cbl
  9098     MOVE X'2020233030303039303335' TO DFHEIV0(25:11)
  9099     CALL 'kxdfhei1' USING DFHEIV0,
  9100           PGM-NAME,
  9101           PROGRAM-INTERFACE-BLOCK,
  9102           WS-COMM-LENGTH,
  9103           DFHEIV99
  9104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9105     ELSE
  9106        MOVE '0'                 TO  PI-EDIT-SW.
  9107
  9108     IF EIBAID = DFHPF10
  9109         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9110         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9111         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9112         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9113                                    PI-1042-WA
  9114         MOVE 4                  TO PI-689-DATA-SOURCE
  9115         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9116         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9117         MOVE PI-SV-STATE        TO PI-689-STATE
  9118         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9119         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9120         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9121         MOVE PI-PB-ALT-CHG-SEQ-NO
  9122                                 TO PI-689-ALT-SEQ-NO
  9123         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9124         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9125         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9126         MOVE +0                 TO PI-689-CONTROL
  9127         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9128                                    PI-689-EXP-DATE
  9129                                    PI-689-RESP-PERSON
  9130                                    PI-689-TYPE
  9131                                    PI-689-FOLLOW-UP-EDIT
  9132                                    PI-689-RESEND1-EDIT
  9133                                    PI-689-SEQ-EDIT
  9134                                    PI-689-BCSEQ-EDIT
  9135                                    PI-689-LBL-OVERRIDE
  9136         MOVE W-LETTER-COMMUNICATION-AREAS
  9137                                 TO PI-PROGRAM-WORK-AREA
  9138         MOVE XCTL-EL689         TO PGM-NAME
  9139         GO TO 9300-XCTL.
  9140
  9141     IF  EIBAID = DFHPF16
  9142         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9143         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9144         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9145                                    PI-1042-WA
  9146         MOVE 4                  TO PI-689-DATA-SOURCE
  9147         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9148         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9149         MOVE PI-SV-STATE        TO PI-689-STATE
  9150         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9151         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9152         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9153         MOVE PI-PB-ALT-CHG-SEQ-NO
  9154                                 TO PI-689-ALT-SEQ-NO
  9155         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 168
* VP6311.cbl
  9156         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9157         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9158         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9159         MOVE W-LETTER-COMMUNICATION-AREAS
  9160                                 TO PI-PROGRAM-WORK-AREA
  9161         MOVE XCTL-EL690         TO PGM-NAME
  9162         GO TO 9300-XCTL.
  9163     IF (EIBAID = DFHPF13)
  9164        if (not fatal-errors)
  9165           and (not unforced-errors)
  9166           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9167           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9168           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9169           MOVE PI-SV-STATE      TO PI-STATE
  9170           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9171           MOVE CCERTNOI         TO PI-CERT-PRIME
  9172           MOVE CSUFIXI          TO PI-CERT-SFX
  9173           MOVE CEFFDTI          TO DEEDIT-FIELD
  9174           PERFORM 8600-DEEDIT
  9175           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9176           MOVE '4'              TO DC-OPTION-CODE
  9177           PERFORM 9700-DATE-LINK
  9178           IF DATE-CONVERSION-ERROR
  9179              MOVE ER-0348       TO EMI-ERROR
  9180              MOVE -1            TO CEFFDTL
  9181              MOVE AL-UABON      TO CEFFDTA
  9182              PERFORM 9900-ERROR-FORMAT
  9183                                 THRU 9900-EXIT
  9184              GO TO 8200-SEND-DATAONLY
  9185           ELSE
  9186              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9187              MOVE AL-UANON      TO CEFFDTA
  9188              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9189              PERFORM 6000-CREATE-TEMP-STORAGE
  9190                                 THRU 6000-EXIT
  9191              MOVE XCTL-EL677    TO PGM-NAME
  9192              GO TO 9300-XCTL
  9193           end-if
  9194        else
  9195           MOVE ER-3444          TO EMI-ERROR
  9196           MOVE -1               TO CPFENTRL
  9197           MOVE AL-UNBON         TO CPFENTRA
  9198           PERFORM 9900-ERROR-FORMAT
  9199                                 THRU 9900-EXIT
  9200           GO TO 8200-SEND-DATAONLY
  9201        end-if
  9202     end-if
  9203
  9204     IF EIBAID = DFHPF14
  9205        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9206        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9207        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9208        MOVE PI-SV-STATE            TO PI-CR-STATE
  9209        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9210        MOVE SPACE                  TO PI-EDIT-SW
  9211        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9212        MOVE XCTL-EL650             TO PGM-NAME
  9213        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 169
* VP6311.cbl
  9214
  9215     IF EIBAID = DFHENTER OR DFHPF11
  9216        GO TO 2000-CANCEL-MAINLINE.
  9217
  9218     MOVE ER-0029                TO EMI-ERROR.
  9219     MOVE -1                     TO CPFENTRL.
  9220     MOVE AL-UNBON               TO CPFENTRA.
  9221     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9222     GO TO 8200-SEND-DATAONLY.
  9223
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 170
* VP6311.cbl
  9225
  9226******************************************************************
  9227*                                                                *
  9228*      BATCH SCREEN PF KEY CHECKING                              *
  9229*                                                                *
  9230******************************************************************
  9231
  9232******************************************************************
  9233*                                                                *
  9234*      PF KEY FUNCTIONS:                                         *
  9235*                                                                *
  9236*      PF1 = BROWSE FORWARD                                      *
  9237*      PF2 = BROWSE BACKWARD                                     *
  9238*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9239*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9240*                                                                *
  9241*                                                                *
  9242******************************************************************
  9243
  9244 0500-CHECK-BATCH-PF-KEYS.
  9245     IF EIBAID = DFHPF1
  9246        MOVE '0'                TO PI-EDIT-SW
  9247        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9248           GO TO 5000-BROWSE-BATCH-HEADERS
  9249        ELSE
  9250           IF PI-GOOD-BROWSE
  9251              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9252                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9253              ELSE
  9254                 IF PI-FILE-BROWSE
  9255                    GO TO 4300-BROWSE-FILE-FORWARD
  9256                 ELSE
  9257                    IF PI-CSR-BROWSE
  9258                       GO TO 4200-BROWSE-CSR-FORWARD
  9259                    ELSE
  9260                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9261           ELSE
  9262              GO TO 0800-BROWSE-ERROR.
  9263
  9264     IF EIBAID = DFHPF2
  9265        MOVE '0'                TO PI-EDIT-SW
  9266        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9267           GO TO 5500-BROWSE-BATCH-BACKWARD
  9268        ELSE
  9269           IF PI-GOOD-BROWSE
  9270              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9271                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9272              ELSE
  9273                 IF PI-FILE-BROWSE
  9274                    GO TO 4800-BROWSE-FILE-BACKWARD
  9275                 ELSE
  9276                    IF PI-CSR-BROWSE
  9277                       GO TO 4900-BROWSE-CSR-BACKWARD
  9278                    ELSE
  9279                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9280           ELSE
  9281              GO TO 0800-BROWSE-ERROR.
  9282
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 171
* VP6311.cbl
  9283     IF EIBAID = DFHPF3
  9284        GO TO 3000-BATCH-MAINLINE.
  9285
  9286     IF  EIBAID = DFHPF4
  9287        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9288        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9289        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9290        MOVE PI-SV-STATE            TO PI-CR-STATE
  9291        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9292                                       PI-CR-FIN-RESP
  9293        MOVE 'A'                    TO PI-CR-TYPE
  9294        MOVE SPACE                  TO PI-EDIT-SW
  9295        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9296        MOVE XCTL-EL640             TO PGM-NAME
  9297        GO TO 9300-XCTL.
  9298
  9299     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9300       AND
  9301        (EIBAID = DFHENTER)
  9302           GO TO 3500-EDIT-BATCH-DATA.
  9303
  9304     IF EIBAID = DFHENTER
  9305        GO TO 3500-EDIT-BATCH-DATA.
  9306
  9307     MOVE ER-0029             TO EMI-ERROR.
  9308     MOVE -1                  TO DPFENTRL.
  9309     MOVE AL-UNBON            TO DPFENTRA.
  9310     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9311     GO TO 8200-SEND-DATAONLY.
  9312
  9313 0800-BROWSE-ERROR.
  9314     MOVE ER-2258                TO EMI-ERROR.
  9315     MOVE -1                     TO DPFENTRL.
  9316     MOVE AL-UNBON               TO DPFENTRA.
  9317     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9318     GO TO 8200-SEND-DATAONLY.
  9319
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 172
* VP6311.cbl
  9321
  9322******************************************************************
  9323*                                                                *
  9324*                I S S U E   M A I N L I N E                     *
  9325*                                                                *
  9326******************************************************************
  9327
  9328 1000-ISSUE-MAINLINE.
  9329     IF PI-DISPLAY-ORIGINAL-BATCH
  9330        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9331           MOVE ER-0023             TO EMI-ERROR
  9332           MOVE -1                  TO BMAINTL
  9333           MOVE AL-UABON            TO BMAINTA
  9334           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9335           GO TO 8200-SEND-DATAONLY
  9336        ELSE
  9337           NEXT SENTENCE
  9338     ELSE
  9339        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9340           MOVE ER-0023             TO EMI-ERROR
  9341           MOVE -1                  TO BMAINTL
  9342           MOVE AL-UABON            TO BMAINTA
  9343           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9344           GO TO 8200-SEND-DATAONLY.
  9345
  9346     IF BMAINTI = 'S'
  9347        GO TO 1100-SHOW-REQUEST.
  9348
  9349     IF NOT MODIFY-CAP
  9350         MOVE 'UPDATE'       TO SM-READ
  9351         PERFORM 9995-SECURITY-VIOLATION
  9352         MOVE ER-0070        TO EMI-ERROR
  9353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9354         GO TO 8100-SEND-INITIAL-MAP.
  9355
  9356     IF BMAINTL GREATER THAN ZEROS
  9357        IF PI-PF5-FUNCTION
  9358           IF BMAINTI NOT = 'A'
  9359              MOVE AL-UABON  TO BMAINTA
  9360              MOVE -1        TO BMAINTL
  9361              MOVE ER-2260   TO EMI-ERROR
  9362              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9363              GO TO 8200-SEND-DATAONLY.
  9364
  9365     IF BCERTNOL = ZEROS
  9366       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9367         NEXT SENTENCE
  9368     ELSE
  9369         IF BCERTNOL NOT = ZEROS
  9370             MOVE AL-UANON       TO BCERTNOA
  9371         ELSE
  9372             MOVE -1             TO BCERTNOL
  9373             MOVE  1             TO SET-CURSOR-SW
  9374             MOVE ER-2218        TO EMI-ERROR
  9375             MOVE AL-UABON       TO BCERTNOA
  9376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9377
  9378     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 173
* VP6311.cbl
  9379         MOVE AL-UANON       TO BSUFIXA
  9380     ELSE
  9381         MOVE AL-SANOF       TO BSUFIXA.
  9382
  9383     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9384        NEXT SENTENCE
  9385     ELSE
  9386        IF BEFFDTL NOT = ZEROS
  9387           MOVE AL-UNNON             TO BEFFDTA
  9388           MOVE BEFFDTI              TO DEEDIT-FIELD
  9389           PERFORM 8600-DEEDIT
  9390           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9391           MOVE 4                    TO DC-OPTION-CODE
  9392           PERFORM 9700-DATE-LINK
  9393           IF NO-CONVERSION-ERROR
  9394              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9395              ELSE
  9396              MOVE -1                TO BEFFDTL
  9397              MOVE  1                TO SET-CURSOR-SW
  9398              MOVE ER-2226           TO EMI-ERROR
  9399              MOVE AL-UNBON          TO BEFFDTA
  9400              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9401           ELSE
  9402              MOVE -1                TO BEFFDTL
  9403              MOVE  1                TO SET-CURSOR-SW
  9404              MOVE ER-2220           TO EMI-ERROR
  9405              MOVE AL-UNBON          TO BEFFDTA
  9406              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9407
  9408     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9409
  9410     IF BCERTNOL NOT = ZEROS
  9411        MOVE BCERTNOI                TO WS-NEW-PRIME
  9412     ELSE
  9413        MOVE SPACES                  TO WS-NEW-PRIME.
  9414
  9415     IF BSUFIXL NOT = ZEROS
  9416        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9417     ELSE
  9418        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9419
  9420     IF BEFFDTL NOT = ZEROS
  9421        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9422     ELSE
  9423        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9424
  9425     IF BMAINTI = 'A' OR 'K' OR 'S'
  9426        NEXT SENTENCE
  9427     ELSE
  9428        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9429        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9430           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9431           WS-PB-RECORD-TYPE NOT = '1'
  9432           IF BMAINTI = 'C'
  9433               MOVE ER-2287          TO EMI-ERROR
  9434               MOVE -1               TO BCERTNOL
  9435               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9436               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 174
* VP6311.cbl
  9437               GO TO 8200-SEND-DATAONLY
  9438             ELSE
  9439               MOVE ER-2260          TO EMI-ERROR
  9440               MOVE -1               TO BCERTNOL
  9441               MOVE AL-UABON         TO BCERTNOA
  9442               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9443               GO TO 8200-SEND-DATAONLY.
  9444
  9445     IF BMAINTI = 'D'
  9446         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9447
  9448*    IF BMICRNOL  NOT =  ZEROS
  9449*        IF BMICRNOI  NUMERIC
  9450*            MOVE AL-UNNON       TO  BMICRNOA
  9451*        ELSE
  9452*            MOVE -1             TO  BMICRNOL
  9453*            MOVE 1              TO  SET-CURSOR-SW
  9454*            MOVE AL-UNBON       TO  BMICRNOA
  9455*            MOVE ER-2701        TO  EMI-ERROR
  9456*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9457     IF BVINL NOT = ZEROS
  9458        MOVE AL-UANON            TO BVINA
  9459     END-IF
  9460     IF B1STNML NOT = ZEROS
  9461         MOVE AL-UANON                TO B1STNMA.
  9462
  9463     IF BINITL  NOT = ZEROS
  9464        MOVE AL-UANON                TO BINITA.
  9465
  9466     IF BSEXL NOT = ZEROS
  9467        IF BSEXI = 'M' OR 'F'
  9468           MOVE AL-UANON             TO BSEXA
  9469        ELSE
  9470           MOVE -1               TO BSEXL
  9471           MOVE ER-2629          TO EMI-ERROR
  9472           MOVE AL-UABON         TO BSEXA
  9473           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9474
  9475     IF BAGEL NOT = ZEROS
  9476         IF BAGEI NUMERIC
  9477             MOVE BAGEI              TO WS-BAGE
  9478             MOVE AL-UNNON           TO BAGEA
  9479         ELSE
  9480             MOVE -1                 TO BAGEL
  9481             MOVE  1                 TO SET-CURSOR-SW
  9482             MOVE ER-2223            TO EMI-ERROR
  9483             MOVE AL-UNBON           TO BAGEA
  9484             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9485
  9486     IF BLSTNML NOT = ZERO  OR
  9487        B1STNML NOT = ZERO  OR
  9488        BINITL NOT = ZERO
  9489         IF BAGEL = ZEROS
  9490             MOVE -1                 TO BAGEL
  9491             MOVE  1                 TO SET-CURSOR-SW
  9492             MOVE ER-3269            TO EMI-ERROR
  9493             MOVE AL-UNBON           TO BAGEA
  9494             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 175
* VP6311.cbl
  9495         END-IF
  9496     END-IF.
  9497
  9498     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9499
  9500     IF (BBIRTHL GREATER THAN +0) AND
  9501        (BBIRTHI NOT EQUAL SPACES)
  9502        NEXT SENTENCE
  9503     ELSE
  9504        GO TO 1010-CHECK-AGE.
  9505
  9506     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9507     PERFORM 8600-DEEDIT.
  9508     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9509     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9510     MOVE AL-UNNON               TO BBIRTHA.
  9511     MOVE '4'                    TO DC-OPTION-CODE.
  9512     PERFORM 9700-DATE-LINK.
  9513     IF DATE-CONVERSION-ERROR
  9514        MOVE -1                  TO BBIRTHL
  9515        MOVE  1                  TO SET-CURSOR-SW
  9516        MOVE ER-2228             TO EMI-ERROR
  9517        MOVE AL-UNBON            TO BBIRTHA
  9518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9519        GO TO 1010-CHECK-AGE.
  9520
  9521     IF (NO-CONVERSION-ERROR) AND
  9522        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9523        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9524        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9525        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9526                                    WS-CONVERTED-BIRTH
  9527        MOVE AL-UANON            TO BBIRTHA
  9528     ELSE
  9529        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9530        MOVE AL-UANON            TO BBIRTHA.
  9531
  9532 1010-CHECK-AGE.
  9533
  9534*    IF BAGEL = ZERO
  9535*       IF BBIRTHL GREATER THAN ZERO
  9536*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9537
  9538
  9539
  9540
  9541**   IF PI-COMPANY-ID = 'DMD'
  9542     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9543        NEXT SENTENCE
  9544     ELSE
  9545         IF BLNOFCRL NOT = ZEROS
  9546            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9547            IF LOAN-OFFICER-FOUND
  9548                MOVE AL-UANON        TO BLNOFCRA
  9549             ELSE
  9550                 MOVE SPACE          TO WS-LOAN-OFFICER
  9551                 MOVE -1             TO BLNOFCRL
  9552                 MOVE  1             TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 176
* VP6311.cbl
  9553                 MOVE ER-3006        TO EMI-ERROR
  9554                 MOVE AL-UNBON       TO BLNOFCRA
  9555                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9556
  9557 1010-EDIT-CONT.
  9558
  9559     IF BFORCEL  NOT = ZEROS
  9560         IF FORCE-CAP
  9561            MOVE AL-UANON            TO BFORCEA
  9562         ELSE
  9563            MOVE ER-2945             TO EMI-ERROR
  9564            MOVE AL-UABON            TO BFORCEA
  9565            MOVE -1                  TO BFORCEL
  9566            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9567
  9568     IF BENTRYL NOT = ZEROS
  9569        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9570                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9571           MOVE ER-2224              TO EMI-ERROR
  9572           MOVE AL-UABON             TO BENTRYA
  9573           MOVE -1                   TO BENTRYL
  9574           MOVE  1                   TO SET-CURSOR-SW
  9575           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9576        ELSE
  9577           MOVE AL-UANON             TO BENTRYA.
  9578
  9579     IF BUNWRITL NOT = ZEROS
  9580        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9581           MOVE ER-7574              TO EMI-ERROR
  9582           MOVE AL-UABON             TO BUNWRITA
  9583           MOVE -1                   TO BUNWRITL
  9584           MOVE  1                   TO SET-CURSOR-SW
  9585           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9586        ELSE
  9587           MOVE AL-UANON             TO BUNWRITA.
  9588
  9589     IF BREINL  NOT = ZEROS
  9590         MOVE AL-UANON               TO BREINA.
  9591
  9592     IF BBILCDL NOT = ZEROS
  9593        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9594                             AND 'A' AND 'B' AND 'E'
  9595           MOVE ER-2225              TO EMI-ERROR
  9596           MOVE AL-UABON             TO BBILCDA
  9597           MOVE -1                   TO BBILCDL
  9598           MOVE  1                   TO SET-CURSOR-SW
  9599           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9600        ELSE
  9601           MOVE AL-UANON             TO BBILCDA.
  9602
  9603     IF BSKPCDL NOT = ZEROS
  9604         MOVE AL-UANON               TO BSKPCDA.
  9605
  9606     IF BINDGRPL NOT = ZEROS
  9607         MOVE AL-UANON               TO BINDGRPA.
  9608
  9609     IF BSIGL   NOT = ZEROS
  9610         MOVE AL-UANON               TO BSIGA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 177
* VP6311.cbl
  9611
  9612     IF BRTCLSL NOT = ZEROS
  9613         MOVE AL-UANON               TO BRTCLSA.
  9614
  9615     IF BMEMBERL NOT = ZEROS
  9616         MOVE AL-UANON               TO BMEMBERA.
  9617
  9618     MOVE +0                         TO WS-SUB1.
  9619
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 178
* VP6311.cbl
  9621
  9622******************************************************************
  9623*                                                                *
  9624*           E D I T   I S S U E   C O V E R A G E S              *
  9625*                                                                *
  9626******************************************************************
  9627
  9628 1020-EDIT-COVERAGES.
  9629     ADD +1                      TO WS-SUB1.
  9630
  9631     IF WS-SUB1 GREATER +2
  9632        GO TO 1025-EDIT-CONTINUE
  9633     END-IF
  9634
  9635
  9636     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9637        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9638        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9639        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9640        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9641        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9642        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9643        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9644        NEXT SENTENCE
  9645         ELSE
  9646            GO TO 1020-EDIT-COVERAGES.
  9647
  9648 1021-CONT-EDIT.
  9649
  9650     IF BMAINTI = 'A'
  9651        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9652           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9653        ELSE
  9654           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9655           MOVE ER-7404          TO EMI-ERROR
  9656           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9657           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9658     ELSE
  9659        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9660           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9661
  9662     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9663        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9664        PERFORM 8600-DEEDIT
  9665        IF DEEDIT-FIELD-V0 NUMERIC
  9666           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9667        ELSE
  9668           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9669
  9670
  9671     IF BMAINTI = ('C' OR 'K')
  9672        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9673           NEXT SENTENCE
  9674        ELSE
  9675           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9676           PERFORM 8600-DEEDIT
  9677           IF DEEDIT-FIELD-V0 NUMERIC
  9678              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 179
* VP6311.cbl
  9679              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9680                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9681              ELSE
  9682                    MOVE ER-2241      TO EMI-ERROR
  9683                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9684                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9685                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9686           ELSE
  9687              MOVE ER-2223          TO EMI-ERROR
  9688              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9689              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9690              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9691     ELSE
  9692        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9693            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9694            PERFORM 8600-DEEDIT
  9695            IF DEEDIT-FIELD-V0      NUMERIC
  9696               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9697                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9698                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9699               ELSE
  9700                  MOVE ER-2241         TO EMI-ERROR
  9701                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9702                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9703                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9704            ELSE
  9705              MOVE ER-2223             TO EMI-ERROR
  9706              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9707              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9708              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9709        ELSE
  9710            MOVE ER-2240               TO EMI-ERROR
  9711            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9712            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9713
  9714     IF BBEN-LEN (WS-SUB1) = ZEROS
  9715        AND BMAINTI = ('C' OR 'K')
  9716           NEXT SENTENCE
  9717     ELSE
  9718        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9719           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9720
  9721* EXEC CICS BIF DEEDIT
  9722*              FIELD  (BBENI (WS-SUB1))
  9723*              LENGTH (12)
  9724*          END-EXEC
  9725     MOVE 12
  9726       TO DFHEIV11
  9727*    MOVE '@"L                   #   #00009655' TO DFHEIV0
  9728     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9729     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9730     MOVE X'2020233030303039363535' TO DFHEIV0(25:11)
  9731     CALL 'kxdfhei1' USING DFHEIV0,
  9732           BBENI(WS-SUB1),
  9733           DFHEIV11
  9734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9735           IF BBENI (WS-SUB1)  NUMERIC
  9736              IF BBENI (WS-SUB1) GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 180
* VP6311.cbl
  9737                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9738*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9739*          PERFORM 8600-DEEDIT
  9740*          IF DEEDIT-FIELD-V2  NUMERIC
  9741*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9742*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9743              ELSE
  9744                 MOVE ER-7632    TO EMI-ERROR
  9745                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9746                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9747                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9748           ELSE
  9749              MOVE ER-2223         TO EMI-ERROR
  9750              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9751              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9752              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9753        ELSE
  9754           MOVE ER-7632    TO EMI-ERROR
  9755           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9756           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9757           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9758
  9759     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9760        AND (BMAINTI = ('C' OR 'K'))
  9761        CONTINUE
  9762     ELSE
  9763        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9764           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9765           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9766              FOR ALL '.'
  9767           IF WS-TALLY > 1
  9768              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9769                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9770              END-PERFORM
  9771              IF A1 < 9
  9772                 ADD 3 TO A1
  9773                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9774              END-IF
  9775           ELSE
  9776              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9777                (A1 > 11)
  9778                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9779                  LOW-VALUES OR SPACES)
  9780              END-PERFORM
  9781              IF A1 > 1 AND < 12
  9782                 MOVE SPACES
  9783                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9784              END-IF
  9785           END-IF
  9786
  9787* EXEC CICS BIF DEEDIT
  9788*              FIELD  (BPREMI (WS-SUB1))
  9789*              LENGTH (11)
  9790*          END-EXEC
  9791     MOVE 11
  9792       TO DFHEIV11
  9793*    MOVE '@"L                   #   #00009710' TO DFHEIV0
  9794     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 181
* VP6311.cbl
  9795     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9796     MOVE X'2020233030303039373130' TO DFHEIV0(25:11)
  9797     CALL 'kxdfhei1' USING DFHEIV0,
  9798           BPREMI(WS-SUB1),
  9799           DFHEIV11
  9800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9801           IF BPREMI (WS-SUB1) NUMERIC
  9802              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9803                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9804*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9805*          PERFORM 8600-DEEDIT
  9806*          IF DEEDIT-FIELD-V2  NUMERIC
  9807*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9808*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9809              ELSE
  9810                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9811                    MOVE ER-7633    TO EMI-ERROR
  9812                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9813                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9814                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9815                 END-IF
  9816              END-IF
  9817           ELSE
  9818              MOVE ER-2223         TO EMI-ERROR
  9819              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9820              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9821              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9822           END-IF
  9823        ELSE
  9824           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9825              MOVE ER-7633         TO EMI-ERROR
  9826              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9827              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9828              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9829           END-IF
  9830        END-IF
  9831     END-IF
  9832
  9833     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9834        NEXT SENTENCE
  9835     ELSE
  9836        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9837
  9838* EXEC CICS BIF DEEDIT
  9839*           FIELD  (BCPREMI (WS-SUB1))
  9840*           LENGTH (11)
  9841*       END-EXEC
  9842     MOVE 11
  9843       TO DFHEIV11
  9844*    MOVE '@"L                   #   #00009750' TO DFHEIV0
  9845     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9846     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9847     MOVE X'2020233030303039373530' TO DFHEIV0(25:11)
  9848     CALL 'kxdfhei1' USING DFHEIV0,
  9849           BCPREMI(WS-SUB1),
  9850           DFHEIV11
  9851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9852        IF BCPREMI (WS-SUB1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 182
* VP6311.cbl
  9853           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9854*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9855*       PERFORM 8600-DEEDIT
  9856*       IF DEEDIT-FIELD-V2  NUMERIC
  9857*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9858        ELSE
  9859           MOVE ER-2223         TO EMI-ERROR
  9860           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9861           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9862           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9863
  9864     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9865        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9866        PERFORM 8600-DEEDIT
  9867        IF DEEDIT-FIELD-V0 NUMERIC
  9868           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9869           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9870         ELSE
  9871           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9872           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9873           MOVE ER-2223              TO EMI-ERROR
  9874           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9875
  9876     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9877        IF BEXPIRE   (WS-SUB1) = SPACES
  9878           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9879        ELSE
  9880           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9881           PERFORM 8600-DEEDIT
  9882           IF DEEDIT-FIELD-V0        NUMERIC
  9883              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9884              MOVE 4                TO DC-OPTION-CODE
  9885              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9886              PERFORM 9700-DATE-LINK
  9887              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9888                                                        (WS-SUB1)
  9889              IF NO-CONVERSION-ERROR
  9890                 NEXT SENTENCE
  9891              ELSE
  9892                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9893                 MOVE ER-2531    TO EMI-ERROR
  9894                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9895                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9896           ELSE
  9897             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9898             MOVE ER-2532        TO EMI-ERROR
  9899             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9900             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9901
  9902     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9903        NEXT SENTENCE
  9904     ELSE
  9905
  9906* EXEC CICS BIF DEEDIT
  9907*           FIELD  (BALT-BENI (WS-SUB1))
  9908*           LENGTH (12)
  9909*       END-EXEC
  9910     MOVE 12
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 183
* VP6311.cbl
  9911       TO DFHEIV11
  9912*    MOVE '@"L                   #   #00009807' TO DFHEIV0
  9913     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9914     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9915     MOVE X'2020233030303039383037' TO DFHEIV0(25:11)
  9916     CALL 'kxdfhei1' USING DFHEIV0,
  9917           BALT-BENI(WS-SUB1),
  9918           DFHEIV11
  9919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9920        IF BALT-BENI (WS-SUB1) NUMERIC
  9921           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9922*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9923*       PERFORM 8600-DEEDIT
  9924*       IF DEEDIT-FIELD-V0 NUMERIC
  9925*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9926        ELSE
  9927           MOVE ER-2223         TO EMI-ERROR
  9928           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9929           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9930           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9931
  9932     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9933        NEXT SENTENCE
  9934     ELSE
  9935
  9936* EXEC CICS BIF DEEDIT
  9937*           FIELD  (BALT-PREMI (WS-SUB1))
  9938*           LENGTH (11)
  9939*       END-EXEC
  9940     MOVE 11
  9941       TO DFHEIV11
  9942*    MOVE '@"L                   #   #00009826' TO DFHEIV0
  9943     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9944     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9945     MOVE X'2020233030303039383236' TO DFHEIV0(25:11)
  9946     CALL 'kxdfhei1' USING DFHEIV0,
  9947           BALT-PREMI(WS-SUB1),
  9948           DFHEIV11
  9949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9950        IF BALT-PREMI (WS-SUB1) NUMERIC
  9951           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9952*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9953*       PERFORM 8600-DEEDIT
  9954*       IF DEEDIT-FIELD-V0 NUMERIC
  9955*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9956        ELSE
  9957           MOVE ER-2223         TO EMI-ERROR
  9958           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9959           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9960           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9961
  9962      GO TO 1020-EDIT-COVERAGES.
  9963     .
  9964 1025-edit-continue.
  9965     IF PI-COMPANY-ID  =  'DMD'
  9966        MOVE LOW-VALUES             TO BNCERTI
  9967                                       BNSTATI.
  9968
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 184
* VP6311.cbl
  9969     IF EMI-ERROR = ZEROS
  9970         NEXT SENTENCE
  9971     ELSE
  9972         GO TO 8200-SEND-DATAONLY.
  9973
  9974     IF BMAINTI = 'A'
  9975         GO TO 1200-ADD-ISSUE-ROUTINE.
  9976
  9977     IF BMAINTI = 'C'
  9978         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9979
  9980     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9981
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 185
* VP6311.cbl
  9983
  9984 1030-EDIT-FOR-NUMERICS.
  9985     IF WS-CSO-SUB EQUAL 10
  9986        GO TO 1030-EDIT-EXIT.
  9987
  9988     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9989        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9990        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9991           ADD +1               TO WS-CSO-SUB
  9992           GO TO 1030-EDIT-FOR-NUMERICS.
  9993
  9994     MOVE 'N'                   TO WS-NUMERIC-SW.
  9995
  9996 1030-EDIT-EXIT.
  9997******************************************************************
  9998*                                                                *
  9999*                 C A L C U L A T E   A G E                      *
 10000*                                                                *
 10001******************************************************************
 10002
 10003
 10004 1095-CALC-AGE.
 10005
 10006     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10007     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10008     MOVE 1                  TO DC-OPTION-CODE.
 10009     PERFORM 9700-DATE-LINK
 10010     IF NO-CONVERSION-ERROR
 10011         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10012         MOVE WS-BAGE            TO BAGEI
 10013         MOVE +2                 TO BAGEL
 10014         MOVE AL-UNNON TO BAGEA.
 10015
 10016 1099-EXIT.
 10017     EXIT.
 10018
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 186
* VP6311.cbl
 10020
 10021******************************************************************
 10022*                                                                *
 10023*                   S H O W   I S S U E                          *
 10024*                                                                *
 10025******************************************************************
 10026
 10027 1100-SHOW-REQUEST.
 10028     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10029
 10030     IF BCERTNOL = ZEROS AND
 10031        BEFFDTL  = ZEROS
 10032        MOVE -1                  TO BMAINTL
 10033        GO TO 8200-SEND-DATAONLY.
 10034
 10035     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10036
 10037     IF BSUFIXL NOT = ZEROS
 10038        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10039     ELSE
 10040        MOVE SPACE               TO WS-NEW-SUFFIX.
 10041
 10042     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10043     PERFORM 8600-DEEDIT.
 10044     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10045     MOVE '4'                    TO DC-OPTION-CODE.
 10046     PERFORM 9700-DATE-LINK.
 10047     IF DATE-CONVERSION-ERROR
 10048        MOVE ER-0348             TO EMI-ERROR
 10049        MOVE -1                  TO BEFFDTL
 10050        MOVE AL-UABON            TO BEFFDTA
 10051        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10052        GO TO 8200-SEND-DATAONLY
 10053     ELSE
 10054        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10055        MOVE AL-UANON            TO BEFFDTA
 10056        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10057
 10058     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10059
 10060     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10061        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10062          MOVE 'Y'                    TO WS-SHOW-SW
 10063          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10064             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10065           ELSE
 10066             IF PI-FILE-BROWSE
 10067                GO TO 4300-BROWSE-FILE-FORWARD
 10068              ELSE
 10069                IF PI-CSR-BROWSE
 10070                   GO TO 4200-BROWSE-CSR-FORWARD
 10071                ELSE
 10072                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10073        ELSE
 10074           GO TO 3900-RE-DISPLAY-RECORD.
 10075
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 187
* VP6311.cbl
 10077
 10078******************************************************************
 10079*                                                                *
 10080*            A D D   I S S U E   R O U T I N E                   *
 10081*                                                                *
 10082******************************************************************
 10083
 10084***************************************************************
 10085*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10086*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10087*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10088*     4. LINK TO THE EDIT ROUTINE.                            *
 10089*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10090*     6. WRITE THE NEW ISSUE RECORD.                          *
 10091*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10092*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10093*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10094*        ELSE                                                 *
 10095*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10096***************************************************************
 10097
 10098 1200-ADD-ISSUE-ROUTINE.
 10099     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10100
 10101
 10102* EXEC CICS GETMAIN
 10103*        SET     (ADDRESS OF PENDING-BUSINESS)
 10104*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10105*    END-EXEC.
 10106*    MOVE '," L                  $   #00009981' TO DFHEIV0
 10107     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10108     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10109     MOVE X'2020233030303039393831' TO DFHEIV0(25:11)
 10110     CALL 'kxdfhei1' USING DFHEIV0,
 10111           DFHEIV20,
 10112           ERPNDB-RECORD-LENGTH,
 10113           DFHEIV99
 10114     SET ADDRESS OF PENDING-BUSINESS TO
 10115         DFHEIV20
 10116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10117
 10118
 10119
 10120* EXEC CICS HANDLE CONDITION
 10121*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10122*    END-EXEC.
 10123*    MOVE '"$I                   ! # #00009986' TO DFHEIV0
 10124     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10126     MOVE X'2320233030303039393836' TO DFHEIV0(25:11)
 10127     CALL 'kxdfhei1' USING DFHEIV0
 10128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10129
 10130
 10131     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10132     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10133     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10134
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 188
* VP6311.cbl
 10135
 10136* EXEC CICS READ
 10137*        INTO    (PENDING-BUSINESS)
 10138*        DATASET (FILE-ID-ERPNDB)
 10139*        RIDFLD  (ERPNDB-KEY)
 10140*    END-EXEC.
 10141     MOVE LENGTH OF
 10142      PENDING-BUSINESS
 10143       TO DFHEIV11
 10144*    MOVE '&"IL       E          (   #00009994' TO DFHEIV0
 10145     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10147     MOVE X'2020233030303039393934' TO DFHEIV0(25:11)
 10148     CALL 'kxdfhei1' USING DFHEIV0,
 10149           FILE-ID-ERPNDB,
 10150           PENDING-BUSINESS,
 10151           DFHEIV11,
 10152           ERPNDB-KEY,
 10153           DFHEIV99,
 10154           DFHEIV99,
 10155           DFHEIV99
 10156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10157
 10158
 10159     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10160
 10161     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10162     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10163     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10164     MOVE SPACES                 TO PENDING-BUSINESS.
 10165     MOVE 'PB'                   TO PB-RECORD-ID.
 10166     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10167     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10168     MOVE SPACES                 TO PB-CERT-SFX.
 10169     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10170     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10171                                    PB-ALT-CHG-SEQ-NO.
 10172
 10173     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10174     MOVE '1'                    TO PB-RECORD-TYPE.
 10175
 10176     IF BSUFIXL NOT = ZEROS
 10177        MOVE BSUFIXI             TO PB-CERT-SFX.
 10178
 10179     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10180
 10181     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10182     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10183
 10184     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10185                                    PB-I-LF-PREM-CALC
 10186                                    PB-I-LF-ALT-PREM-CALC
 10187                                    PB-I-LF-RATE
 10188                                    PB-I-LF-ALT-RATE
 10189                                    PB-I-LF-REI-RATE
 10190                                    PB-I-LF-ALT-REI-RATE
 10191                                    PB-I-RATE-DEV-PCT-LF
 10192                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 189
* VP6311.cbl
 10193                                    PB-I-AH-RATE
 10194                                    PB-I-AH-REI-RATE
 10195                                    PB-I-AH-RATE-TRM
 10196                                    PB-I-RATE-DEV-PCT-AH
 10197                                    PB-I-BUSINESS-TYPE
 10198                                    PB-I-LIFE-COMMISSION
 10199                                    PB-I-JOINT-COMMISSION
 10200                                    PB-I-JOINT-AGE
 10201                                    PB-I-AH-COMMISSION
 10202                                    PB-I-CURR-SEQ
 10203                                    PB-CHG-COUNT
 10204                                    PB-LF-BILLED-AMTS
 10205                                    PB-AH-BILLED-AMTS
 10206                                    PB-CALC-TOLERANCE
 10207                                    PB-I-EXTENTION-DAYS
 10208*                                   PB-I-MICROFILM-NO
 10209                                    PB-I-TERM-IN-DAYS.
 10210
 10211     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10212                                    PB-I-LF-EXPIRE-DT
 10213                                    PB-I-AH-EXPIRE-DT
 10214                                    PB-BILLED-DT
 10215                                    PB-ACCT-EFF-DT
 10216                                    PB-ACCT-EXP-DT
 10217                                    PB-I-1ST-PMT-DT.
 10218
 10219     MOVE 'X'                    TO PB-FATAL-FLAG.
 10220
 10221     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10222
 10223     IF BLSTNML GREATER THAN ZEROS
 10224         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10225
 10226*    IF BMICRNOL  GREATER  ZEROS
 10227*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10228*    ELSE
 10229*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10230     IF BVINL > ZEROS
 10231        MOVE BVINI               TO PB-I-VIN
 10232     END-IF
 10233     IF B1STNML GREATER THAN ZEROS
 10234         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10235
 10236     IF BINITL  GREATER THAN ZEROS
 10237         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10238
 10239     IF BBIRTHL GREATER THAN ZERO
 10240         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10241     ELSE
 10242         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10243
 10244
 10245     IF BAGEL    GREATER THAN ZEROS
 10246         MOVE BAGEI              TO PB-I-AGE
 10247        ELSE
 10248         MOVE ZEROS              TO PB-I-AGE.
 10249
 10250     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 190
* VP6311.cbl
 10251         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10252
 10253     IF BTERM-LEN (1) GREATER THAN ZEROS
 10254        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10255     ELSE
 10256        MOVE ZEROS               TO PB-I-LF-TERM.
 10257
 10258     IF BTERM-LEN (2) GREATER THAN ZEROS
 10259        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10260     ELSE
 10261        MOVE ZEROS               TO PB-I-AH-TERM.
 10262
 10263
 10264
 10265     IF BSKPCDL       GREATER THAN ZEROS
 10266         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10267
 10268
 10269         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10270                                    PI-BPMTS.
 10271
 10272         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10273
 10274     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10275        IF BTYPE  (1)   NOT = ZEROS
 10276           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10277                                    PI-BTYPE (1)
 10278           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10279           MOVE SPACES           TO PB-I-LF-ABBR
 10280        ELSE
 10281           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10282                                    PB-I-LF-ABBR
 10283           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10284     ELSE
 10285        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10286                                    PB-I-LF-ABBR
 10287        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10288
 10289     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10290         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10291     ELSE
 10292         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10293
 10294     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10295         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10296     ELSE
 10297         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10298
 10299     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10300         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10301            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10302            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10303         ELSE
 10304            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10305*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10306*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10307         END-IF
 10308     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 191
* VP6311.cbl
 10309         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10310
 10311     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10312         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10313
 10314     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10315         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10316         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10317     ELSE
 10318         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10319
 10320     IF  BALT-PREM-LEN     (2) > ZEROS
 10321         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10322     ELSE
 10323         MOVE ZEROS            TO PB-I-TOT-FEES.
 10324
 10325     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10326        IF BTYPE      (2)   NOT = ZEROS
 10327           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10328                                  PI-BTYPE (2)
 10329           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10330           MOVE SPACES         TO PB-I-AH-ABBR
 10331        ELSE
 10332           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10333                                  PB-I-AH-ABBR
 10334           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10335     ELSE
 10336        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10337                                  PB-I-AH-ABBR
 10338        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10339
 10340     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10341         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10342     ELSE
 10343         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10344
 10345     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10346         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10347            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10348            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10349         ELSE
 10350            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10351*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10352*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10353         END-IF
 10354     ELSE
 10355         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10356
 10357     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10358         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10359
 10360     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10361        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10362     ELSE
 10363        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10364
 10365     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10366        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 192
* VP6311.cbl
 10367     ELSE
 10368        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10369
 10370     IF BINDGRPL  GREATER THAN ZEROS
 10371         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10372
 10373     IF BRTCLSL   GREATER THAN ZEROS
 10374         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10375
 10376     IF BSIGL     GREATER THAN ZEROS
 10377         MOVE BSIGI              TO PB-I-SIG-SW.
 10378     IF BMEMBERL  GREATER THAN ZEROS
 10379         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10380
 10381     IF BLNOFCRL  GREATER THAN ZEROS
 10382         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10383
 10384     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10385        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10386     ELSE
 10387        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10388
 10389     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10390        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10391     ELSE
 10392        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10393
 10394
 10395     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10396        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10397           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10398
 10399     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10400        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10401           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10402
 10403
 10404     IF PB-EXT-DAYS-PROCESSING
 10405        IF PB-I-EXTENTION-DAYS = ZEROS
 10406           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10407
 10408     IF PB-EXPIRE-DT-PROCESSING
 10409        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10410           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10411             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10412
 10413     IF PB-1ST-PMT-DT-PROCESSING
 10414        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10415           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10416
 10417     IF BREINL GREATER THAN ZEROS
 10418        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10419
 10420     IF BENTRYL NOT = ZEROS
 10421        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10422        IF PI-COMPANY-ID = 'CID'
 10423           AND (PB-BATCH-ENTRY = 'P')
 10424           AND (PB-STATE = 'VA')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 193
* VP6311.cbl
 10425           PERFORM 1500-UPDATE-ERNOTE
 10426                                 THRU 1500-EXIT
 10427        END-IF
 10428     END-IF
 10429     IF BUNWRITL NOT = ZEROS
 10430        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10431
 10432     IF BFORCEL NOT = ZEROS
 10433        MOVE BFORCEI             TO PB-FORCE-CODE.
 10434
 10435     IF BBILCDL NOT = ZEROS
 10436        MOVE BBILCDI             TO PB-RECORD-BILL.
 10437
 10438
 10439
 10440 1260-WRITE-PB-RECORD.
 10441     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10442                                    PB-INPUT-BY.
 10443     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10444     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10445                                    PB-INPUT-DT.
 10446
 10447     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10448     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10449                                    PB-CONTROL-BY-ORIG-BATCH.
 10450
 10451
 10452     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10453     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10454     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10455     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10456     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10457
 10458     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10459
 10460     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10461
 10462     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10463     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10464     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10465
 10466     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10467     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10468
 10469 1275-WRITE-PENDING-BUSINESS.
 10470     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10471     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10472     MOVE 'A'                    TO JP-RECORD-TYPE.
 10473     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10474
 10475
 10476* EXEC CICS HANDLE CONDITION
 10477*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10478*    END-EXEC.
 10479*    MOVE '"$%                   ! $ #00010316' TO DFHEIV0
 10480     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10482     MOVE X'2420233030303130333136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 194
* VP6311.cbl
 10483     CALL 'kxdfhei1' USING DFHEIV0
 10484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10485
 10486
 10487
 10488* EXEC CICS WRITE
 10489*        DATASET (FILE-ID-ERPNDB)
 10490*        FROM    (PENDING-BUSINESS)
 10491*        RIDFLD  (PB-CONTROL-PRIMARY)
 10492*    END-EXEC.
 10493     MOVE LENGTH OF
 10494      PENDING-BUSINESS
 10495       TO DFHEIV11
 10496*    MOVE '&$ L                  ''   #00010320' TO DFHEIV0
 10497     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10498     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10499     MOVE X'2020233030303130333230' TO DFHEIV0(25:11)
 10500     CALL 'kxdfhei1' USING DFHEIV0,
 10501           FILE-ID-ERPNDB,
 10502           PENDING-BUSINESS,
 10503           DFHEIV11,
 10504           PB-CONTROL-PRIMARY,
 10505           DFHEIV99,
 10506           DFHEIV99
 10507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10508
 10509
 10510     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10511
 10512     PERFORM 8400-LOG-JOURNAL-RECORD.
 10513
 10514******************************************************************
 10515*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10516******************************************************************
 10517     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10518     MOVE ' '                    TO WS-ERMAIL-SW
 10519
 10520* EXEC CICS READ
 10521*       DATASET   (FILE-ID-ERMAIL)
 10522*       SET       (ADDRESS OF MAILING-DATA)
 10523*       RIDFLD    (ERMAIL-KEY)
 10524*       RESP      (WS-RESPONSE)
 10525*    END-EXEC
 10526*    MOVE '&"S        E          (  N#00010336' TO DFHEIV0
 10527     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10529     MOVE X'204E233030303130333336' TO DFHEIV0(25:11)
 10530     CALL 'kxdfhei1' USING DFHEIV0,
 10531           FILE-ID-ERMAIL,
 10532           DFHEIV20,
 10533           DFHEIV99,
 10534           ERMAIL-KEY,
 10535           DFHEIV99,
 10536           DFHEIV99,
 10537           DFHEIV99
 10538     SET ADDRESS OF MAILING-DATA TO
 10539         DFHEIV20
 10540     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 195
* VP6311.cbl
 10541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10542     IF RESP-NORMAL
 10543        SET ERMAIL-FOUND TO TRUE
 10544     END-IF
 10545
 10546     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10547     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10548     MOVE 'OC'                   TO OC-RECORD-ID
 10549     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10550                                 TO OC-CONTROL-PRIMARY (1:33)
 10551     MOVE 'I'                    TO OC-RECORD-TYPE
 10552     MOVE +4096                  TO OC-KEY-SEQ-NO
 10553     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10554     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10555     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10556     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10557     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10558     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10559     MOVE PB-I-AGE               TO OC-INS-AGE
 10560     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10561     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10562     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10563     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10564     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10565     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10566     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10567     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10568     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10569     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10570     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10571     IF PB-I-JOINT-COMMISSION > +0
 10572         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10573     ELSE
 10574         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10575     END-IF
 10576     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10577     MOVE +0                     TO OC-LF-CANCEL-AMT
 10578                                    OC-LF-ITD-CANCEL-AMT
 10579     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10580     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10581     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10582     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10583     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10584     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10585     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10586     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10587     MOVE +0                     TO OC-AH-CANCEL-AMT
 10588                                    OC-AH-ITD-CANCEL-AMT
 10589     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10590     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10591     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10592     IF ERMAIL-FOUND
 10593        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10594     END-IF
 10595     IF NOT CERT-TRL-REC-NOT-FOUND
 10596        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10597                           OC-INS-AGE-DEFAULT-FLAG
 10598        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 196
* VP6311.cbl
 10599                           OC-JNT-AGE-DEFAULT-FLAG
 10600     END-IF
 10601     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10602     .
 10603 1275-WRITE-ELCRTO.
 10604
 10605* EXEC CICS WRITE
 10606*       DATASET   ('ELCRTO')
 10607*       FROM      (ORIGINAL-CERTIFICATE)
 10608*       RIDFLD    (OC-CONTROL-PRIMARY)
 10609*       RESP      (WS-RESPONSE)
 10610*    END-EXEC
 10611     MOVE LENGTH OF
 10612      ORIGINAL-CERTIFICATE
 10613       TO DFHEIV11
 10614     MOVE 'ELCRTO' TO DFHEIV1
 10615*    MOVE '&$ L                  ''  N#00010404' TO DFHEIV0
 10616     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10617     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10618     MOVE X'204E233030303130343034' TO DFHEIV0(25:11)
 10619     CALL 'kxdfhei1' USING DFHEIV0,
 10620           DFHEIV1,
 10621           ORIGINAL-CERTIFICATE,
 10622           DFHEIV11,
 10623           OC-CONTROL-PRIMARY,
 10624           DFHEIV99,
 10625           DFHEIV99
 10626     MOVE EIBRESP  TO WS-RESPONSE
 10627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10628*    display ' just wrote 1275 ' ws-response
 10629     IF RESP-DUPKEY
 10630        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10631        GO TO 1275-WRITE-ELCRTO
 10632     ELSE
 10633        IF NOT RESP-NORMAL
 10634           MOVE -1               TO BMAINTL
 10635           MOVE ER-7450          TO EMI-ERROR
 10636           PERFORM 9900-ERROR-FORMAT
 10637                                 THRU 9900-EXIT
 10638           GO TO 8200-SEND-DATAONLY
 10639        END-IF
 10640     END-IF
 10641******************************************************************
 10642*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10643******************************************************************
 10644
 10645
 10646* EXEC CICS READ
 10647*        INTO    (PENDING-BUSINESS)
 10648*        DATASET (FILE-ID-ERPNDB)
 10649*        RIDFLD  (ERPNDB-KEY)
 10650*        UPDATE
 10651*    END-EXEC.
 10652     MOVE LENGTH OF
 10653      PENDING-BUSINESS
 10654       TO DFHEIV11
 10655*    MOVE '&"IL       EU         (   #00010427' TO DFHEIV0
 10656     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 197
* VP6311.cbl
 10657     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10658     MOVE X'2020233030303130343237' TO DFHEIV0(25:11)
 10659     CALL 'kxdfhei1' USING DFHEIV0,
 10660           FILE-ID-ERPNDB,
 10661           PENDING-BUSINESS,
 10662           DFHEIV11,
 10663           ERPNDB-KEY,
 10664           DFHEIV99,
 10665           DFHEIV99,
 10666           DFHEIV99
 10667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10668
 10669
 10670     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10671     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10672     MOVE 'B'                    TO JP-RECORD-TYPE.
 10673     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10674
 10675     PERFORM 8400-LOG-JOURNAL-RECORD.
 10676
 10677     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10678
 10679
 10680* EXEC CICS REWRITE
 10681*        DATASET (FILE-ID-ERPNDB)
 10682*        FROM    (PENDING-BUSINESS)
 10683*    END-EXEC.
 10684     MOVE LENGTH OF
 10685      PENDING-BUSINESS
 10686       TO DFHEIV11
 10687*    MOVE '&& L                  %   #00010443' TO DFHEIV0
 10688     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10689     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10690     MOVE X'2020233030303130343433' TO DFHEIV0(25:11)
 10691     CALL 'kxdfhei1' USING DFHEIV0,
 10692           FILE-ID-ERPNDB,
 10693           PENDING-BUSINESS,
 10694           DFHEIV11,
 10695           DFHEIV99
 10696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10697
 10698
 10699     MOVE 'C'                    TO JP-RECORD-TYPE.
 10700     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10701
 10702     PERFORM 8400-LOG-JOURNAL-RECORD.
 10703
 10704     IF WS-ERRORS-PRESENT
 10705         GO TO 3900-RE-DISPLAY-RECORD.
 10706
 10707     MOVE ZEROS                  TO EMI-ERROR.
 10708     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10709     MOVE LOW-VALUES             TO VP631BI.
 10710     MOVE  -1                    TO BMAINTL.
 10711     GO TO 8100-SEND-INITIAL-MAP.
 10712
 10713 1280-BATCH-HDR-NOT-FOUND.
 10714     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 198
* VP6311.cbl
 10715     MOVE ER-7450                TO EMI-ERROR.
 10716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10717     GO TO 8200-SEND-DATAONLY.
 10718
 10719 1290-DUPLICATE-ALT-INDEX.
 10720
 10721******************************************************************
 10722*                                                                *
 10723*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10724*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10725*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10726*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10727*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10728*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10729*                                                                *
 10730******************************************************************
 10731
 10732     IF LCP-ONCTR-01 =  0
 10733         ADD 1 TO LCP-ONCTR-01
 10734        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10735
 10736     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10737
 10738     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10739         NEXT SENTENCE
 10740     ELSE
 10741         ADD +1 TO PB-BATCH-SEQ-NO
 10742                   PB-CSR-BATCH-SEQ-NO
 10743         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10744         GO TO 1275-WRITE-PENDING-BUSINESS.
 10745
 10746     MOVE -1                     TO BCERTNOL.
 10747     MOVE AL-UABON               TO BCERTNOA.
 10748     MOVE AL-UNBON               TO BEFFDTA.
 10749
 10750     MOVE 1                      TO EMI-SUB
 10751                                    EMI-SWITCH1
 10752                                    EMI-SWITCH-AREA-1
 10753                                    EMI-SWITCH-AREA-2.
 10754
 10755     MOVE SPACES                 TO EMI-ERROR-LINES.
 10756
 10757
 10758* EXEC CICS SYNCPOINT ROLLBACK
 10759*    END-EXEC.
 10760*    MOVE '6"R                   !   #00010506' TO DFHEIV0
 10761     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10763     MOVE X'2020233030303130353036' TO DFHEIV0(25:11)
 10764     CALL 'kxdfhei1' USING DFHEIV0
 10765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10766
 10767
 10768     MOVE ER-2247                TO EMI-ERROR.
 10769     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10770     GO TO 8200-SEND-DATAONLY.
 10771
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 199
* VP6311.cbl
 10773
 10774
 10775 1295-READ-CERT-TRAILER.
 10776
 10777
 10778* EXEC CICS GETMAIN
 10779*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10780*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10781*        INITIMG (GETMAIN-SPACE)
 10782*    END-EXEC
 10783*    MOVE ',"IL                  $   #00010518' TO DFHEIV0
 10784     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10785     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10786     MOVE X'2020233030303130353138' TO DFHEIV0(25:11)
 10787     CALL 'kxdfhei1' USING DFHEIV0,
 10788           DFHEIV20,
 10789           ELCRTT-RECORD-LENGTH,
 10790           GETMAIN-SPACE
 10791     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10792         DFHEIV20
 10793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10794
 10795     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10796     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10797     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10798
 10799
 10800* EXEC CICS HANDLE CONDITION
 10801*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10802*    END-EXEC.
 10803*    MOVE '"$I                   ! % #00010528' TO DFHEIV0
 10804     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10805     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10806     MOVE X'2520233030303130353238' TO DFHEIV0(25:11)
 10807     CALL 'kxdfhei1' USING DFHEIV0
 10808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10809
 10810
 10811
 10812* EXEC CICS READ
 10813*        DATASET  (CRTT-ID)
 10814*        RIDFLD   (ELCRTT-KEY)
 10815*        INTO     (CERTIFICATE-TRAILERS)
 10816*    END-EXEC.
 10817     MOVE LENGTH OF
 10818      CERTIFICATE-TRAILERS
 10819       TO DFHEIV11
 10820*    MOVE '&"IL       E          (   #00010532' TO DFHEIV0
 10821     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10823     MOVE X'2020233030303130353332' TO DFHEIV0(25:11)
 10824     CALL 'kxdfhei1' USING DFHEIV0,
 10825           CRTT-ID,
 10826           CERTIFICATE-TRAILERS,
 10827           DFHEIV11,
 10828           ELCRTT-KEY,
 10829           DFHEIV99,
 10830           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 200
* VP6311.cbl
 10831           DFHEIV99
 10832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10833
 10834
 10835     GO TO 1295-EXIT.
 10836
 10837 1295-CERT-TRL-REC-NOTFND.
 10838     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10839
 10840 1295-EXIT.
 10841     EXIT.
 10842
 10843******************************************************************
 10844*                                                                *
 10845*          C H A N G E   I S S U E   R O U T I N E               *
 10846*                                                                *
 10847******************************************************************
 10848
 10849***************************************************************
 10850*                                                             *
 10851*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10852*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10853*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10854*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10855*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10856*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10857*     5. LINK TO THE EDIT ROUTINE.                            *
 10858*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10859*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10860*              THE EDIT ROUTINE.                              *
 10861*     7. REWRITE THE NEW ISSUE                                *
 10862*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10863*                                                             *
 10864***************************************************************
 10865
 10866 1300-CHANGE-ISSUE-ROUTINE.
 10867     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10868
 10869     IF BCHGL NOT = ZEROS
 10870        MOVE ER-2196             TO EMI-ERROR
 10871        MOVE AL-UABON            TO BMAINTA
 10872        MOVE -1                  TO BMAINTL
 10873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10874        GO TO 8200-SEND-DATAONLY.
 10875
 10876     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10877
 10878     IF BSUFIXL NOT = ZEROS
 10879        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10880     ELSE
 10881        MOVE SPACE               TO WS-NEW-SUFFIX.
 10882
 10883     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10884     PERFORM 8600-DEEDIT.
 10885     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10886     MOVE '4'                    TO DC-OPTION-CODE.
 10887     PERFORM 9700-DATE-LINK.
 10888     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 201
* VP6311.cbl
 10889        MOVE ER-0348             TO EMI-ERROR
 10890        MOVE -1                  TO BEFFDTL
 10891        MOVE AL-UABON            TO BEFFDTA
 10892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10893        GO TO 8200-SEND-DATAONLY
 10894     ELSE
 10895        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10896        MOVE AL-UANON            TO BEFFDTA
 10897        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10898
 10899 1325-PROCESS-ISSUE-CHANGES.
 10900
 10901* EXEC CICS HANDLE CONDITION
 10902*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10903*    END-EXEC.
 10904*    MOVE '"$I                   ! & #00010603' TO DFHEIV0
 10905     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10906     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10907     MOVE X'2620233030303130363033' TO DFHEIV0(25:11)
 10908     CALL 'kxdfhei1' USING DFHEIV0
 10909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10910
 10911
 10912     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10913     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10914     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10915
 10916
 10917* EXEC CICS GETMAIN
 10918*        SET      (ADDRESS OF PENDING-BUSINESS)
 10919*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10920*        INITIMG  (GETMAIN-SPACE)
 10921*     END-EXEC.
 10922*    MOVE ',"IL                  $   #00010611' TO DFHEIV0
 10923     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10924     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10925     MOVE X'2020233030303130363131' TO DFHEIV0(25:11)
 10926     CALL 'kxdfhei1' USING DFHEIV0,
 10927           DFHEIV20,
 10928           ERPNDB-RECORD-LENGTH,
 10929           GETMAIN-SPACE
 10930     SET ADDRESS OF PENDING-BUSINESS TO
 10931         DFHEIV20
 10932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10933
 10934
 10935
 10936* EXEC CICS READ
 10937*        INTO    (PENDING-BUSINESS)
 10938*        DATASET (FILE-ID-ERPNDB)
 10939*        RIDFLD  (ERPNDB-KEY)
 10940*    END-EXEC.
 10941     MOVE LENGTH OF
 10942      PENDING-BUSINESS
 10943       TO DFHEIV11
 10944*    MOVE '&"IL       E          (   #00010617' TO DFHEIV0
 10945     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 202
* VP6311.cbl
 10947     MOVE X'2020233030303130363137' TO DFHEIV0(25:11)
 10948     CALL 'kxdfhei1' USING DFHEIV0,
 10949           FILE-ID-ERPNDB,
 10950           PENDING-BUSINESS,
 10951           DFHEIV11,
 10952           ERPNDB-KEY,
 10953           DFHEIV99,
 10954           DFHEIV99,
 10955           DFHEIV99
 10956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10957
 10958
 10959     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10960
 10961
 10962* EXEC CICS HANDLE CONDITION
 10963*         NOTFND     (1385-REC-NOT-FOUND)
 10964*    END-EXEC.
 10965*    MOVE '"$I                   ! '' #00010625' TO DFHEIV0
 10966     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10968     MOVE X'2720233030303130363235' TO DFHEIV0(25:11)
 10969     CALL 'kxdfhei1' USING DFHEIV0
 10970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10971
 10972
 10973**********************************************************
 10974*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10975*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10976**********************************************************
 10977
 10978
 10979* EXEC CICS READ
 10980*        DATASET (FILE-ID-ERPNDB)
 10981*        INTO    (PENDING-BUSINESS)
 10982*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10983*    END-EXEC.
 10984     MOVE LENGTH OF
 10985      PENDING-BUSINESS
 10986       TO DFHEIV11
 10987*    MOVE '&"IL       E          (   #00010634' TO DFHEIV0
 10988     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10990     MOVE X'2020233030303130363334' TO DFHEIV0(25:11)
 10991     CALL 'kxdfhei1' USING DFHEIV0,
 10992           FILE-ID-ERPNDB,
 10993           PENDING-BUSINESS,
 10994           DFHEIV11,
 10995           PI-PREV-CONTROL-PRIMARY,
 10996           DFHEIV99,
 10997           DFHEIV99,
 10998           DFHEIV99
 10999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11000
 11001
 11002********** DO NOT ALLOW CHANGES IF THRU A/R
 11003     IF BMAINTI = 'C'
 11004         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 203
* VP6311.cbl
 11005             MOVE ER-4005          TO EMI-ERROR
 11006             MOVE -1               TO BMAINTL
 11007             MOVE AL-UABON         TO BMAINTA
 11008             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11009             GO TO 8200-SEND-DATAONLY.
 11010**********
 11011
 11012     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11013        MOVE -1                 TO BMAINTL
 11014        MOVE ER-2197            TO EMI-ERROR
 11015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11016        GO TO 8200-SEND-DATAONLY.
 11017
 11018     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11019        MOVE ER-2196             TO EMI-ERROR
 11020        MOVE AL-UABON            TO BMAINTA
 11021        MOVE -1                  TO BMAINTL
 11022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11023        GO TO 8200-SEND-DATAONLY.
 11024
 11025     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11026
 11027     IF PB-BILLED-DT = LOW-VALUES AND
 11028        PB-CHG-COUNT = ZEROS
 11029        NEXT SENTENCE
 11030     ELSE
 11031        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11032            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11033           OR
 11034           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11035            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11036           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11037     move zeros                  to ws-check-amts
 11038     move ' '                    to ws-stop-sw
 11039                                    ws-check-sw
 11040                                    ws-proc-check-sw
 11041                                    ws-chek-browse-sw
 11042
 11043     perform 2500-browse-checks  thru 2500-exit
 11044
 11045     if i-have-processed-checks
 11046        or i-have-checks
 11047        continue
 11048     else
 11049        go to 1330-continue
 11050     end-if
 11051
 11052     compute ws-tot-orig-prem =
 11053        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11054        pb-i-lf-alt-premium-amt
 11055
 11056     if bprem1l <> zeros
 11057        MOVE AL-UNNON            TO bprem1a
 11058        move ws-bprem (1)        to ws-new-iss-total
 11059     else
 11060        move pb-i-lf-premium-amt to ws-new-iss-total
 11061     end-if
 11062     display ' new iss totala ' ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 204
* VP6311.cbl
 11063
 11064     if baltpr1l <> zeros
 11065        MOVE AL-UNNON            TO baltpr1a
 11066        compute ws-new-iss-total =
 11067           ws-new-iss-total + ws-balt-prem(1)
 11068     else
 11069        compute ws-new-iss-total =
 11070           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11071     end-if
 11072
 11073     if bprem2l <> zeros
 11074        MOVE AL-UNNON            TO bprem2a
 11075        compute ws-new-iss-total = ws-new-iss-total +
 11076           ws-bprem (2)
 11077     else
 11078        compute ws-new-iss-total = ws-new-iss-total +
 11079           pb-i-ah-premium-amt
 11080     end-if
 11081
 11082     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11083        if ((bprem1l <> zeros)
 11084           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11085                      or
 11086           ((bprem2l <> zeros)
 11087           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11088           move er-3456          to emi-error
 11089           perform 9900-error-format
 11090                                 thru 9900-exit
 11091           go to 1330-continue
 11092        end-if
 11093     end-if
 11094
 11095     if ws-new-iss-total > ws-tot-orig-prem
 11096        move er-3458             to emi-error
 11097        perform 9900-error-format thru 9900-exit
 11098        move al-uabon            to bmainta
 11099        move -1                  to bmaintl
 11100        go to 8200-send-dataonly
 11101     end-if
 11102
 11103     if ws-new-iss-total < ws-tot-orig-prem
 11104        move er-3457             to emi-error
 11105        move al-uabon            to bprem1a
 11106                                    bprem2a
 11107        move +0 to bprem1l bprem2l
 11108        perform 9900-error-format thru 9900-exit
 11109        move -1                  to bmaintl
 11110        go to 1330-continue
 11111     end-if
 11112
 11113     .
 11114 1330-continue.
 11115
 11116
 11117* EXEC CICS READ
 11118*        DATASET (FILE-ID-ERPNDB)
 11119*        INTO    (PENDING-BUSINESS)
 11120*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 205
* VP6311.cbl
 11121*        UPDATE
 11122*    END-EXEC.
 11123     MOVE LENGTH OF
 11124      PENDING-BUSINESS
 11125       TO DFHEIV11
 11126*    MOVE '&"IL       EU         (   #00010754' TO DFHEIV0
 11127     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11128     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11129     MOVE X'2020233030303130373534' TO DFHEIV0(25:11)
 11130     CALL 'kxdfhei1' USING DFHEIV0,
 11131           FILE-ID-ERPNDB,
 11132           PENDING-BUSINESS,
 11133           DFHEIV11,
 11134           PI-PREV-CONTROL-PRIMARY,
 11135           DFHEIV99,
 11136           DFHEIV99,
 11137           DFHEIV99
 11138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11139
 11140
 11141     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11142     MOVE 'B'                    TO JP-RECORD-TYPE
 11143     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11144     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11145
 11146     PERFORM 8400-LOG-JOURNAL-RECORD.
 11147
 11148     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11149        PB-CHG-COUNT NOT = ZEROS
 11150        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11151            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11152           OR
 11153           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11154            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11155            MOVE LOW-VALUES             TO PB-BILLED-DT
 11156            ADD +1                      TO PB-CHG-COUNT.
 11157
 11158     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11159     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11160     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11161     MOVE '5'                    TO DC-OPTION-CODE.
 11162     PERFORM 9700-DATE-LINK
 11163     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11164
 11165*    IF BMICRNOL  GREATER  ZEROS
 11166*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11167
 11168     IF BVINL > ZEROS
 11169        MOVE BVINI               TO PB-I-VIN
 11170     END-IF
 11171     IF (BFORCEL NOT = ZEROS)
 11172        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11173        AND (BFORCEI = ' ')
 11174        AND (PB-FORCE-CODE = 'O')
 11175        COMPUTE PB-I-AH-PREMIUM-AMT =
 11176           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11177        PERFORM 1800-REMOVE-CERT-NOTES
 11178                                 THRU 1800-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 206
* VP6311.cbl
 11179        PERFORM 1900-DELETE-ERPYAJ
 11180                                 THRU 1900-EXIT
 11181        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11182     END-IF
 11183     IF (BFORCEL NOT = ZEROS)
 11184        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11185        AND (BFORCEI = 'O')
 11186        AND (PB-FORCE-CODE NOT = 'O')
 11187        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11188           PB-I-AH-PREM-CALC
 11189        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11190        MOVE SPACE               TO DC-OPTION-CODE
 11191        PERFORM 9700-DATE-LINK
 11192        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11193        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11194        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11195        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11196        PERFORM 1500-UPDATE-ERNOTE
 11197                                 THRU 1500-EXIT
 11198        PERFORM 1600-UPDATE-ERPYAJ
 11199                                 THRU 1600-EXIT
 11200     END-IF
 11201     IF BLSTNML  GREATER THAN ZEROS
 11202         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11203
 11204     IF B1STNML  GREATER THAN ZEROS
 11205         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11206
 11207     IF BINITL   GREATER THAN ZEROS
 11208         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11209
 11210     IF BBIRTHL  GREATER THAN ZERO
 11211         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11212
 11213
 11214     IF BAGEL    GREATER THAN ZEROS
 11215         MOVE BAGEI              TO PB-I-AGE.
 11216
 11217     MOVE 'N'                    TO WS-INS-AGE-SET
 11218                                    WS-JNT-AGE-SET.
 11219     IF BAGEL    GREATER THAN ZEROS
 11220        MOVE 'Y'                TO WS-INS-AGE-SET
 11221        IF BAGEI = ZERO AND
 11222             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11223           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11224           MOVE 'AGE*'          TO BAGEDEFO
 11225        ELSE
 11226           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11227           MOVE 'AGE '          TO BAGEDEFO
 11228        END-IF
 11229        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11230     END-IF.
 11231     if (byearl      <> zeros)
 11232        or (bmakel   <> zeros)
 11233        or (bmodell  <> zeros)
 11234        or (bometerl <> zeros)
 11235        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11236                                 TO ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 207
* VP6311.cbl
 11237        MOVE 'C'                 TO ELCRTT-REC-TYPE
 11238        perform 1390-read-elcrtt-update
 11239                                 thru 1390-exit
 11240        if resp-normal
 11241           perform 1391-rewrite-elcrtt
 11242                                 thru 1391-exit
 11243        else
 11244           if resp-notfnd
 11245              perform 1392-write-elcrtt
 11246                                 thru 1392-exit
 11247           end-if
 11248        end-if
 11249     end-if
 11250     IF BSEXL    GREATER THAN ZEROS
 11251         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11252
 11253     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11254        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11255
 11256     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11257        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11258
 11259
 11260
 11261     IF BSKPCDL  GREATER THAN ZEROS
 11262         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11263
 11264
 11265
 11266
 11267     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11268         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11269
 11270     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11271         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11272
 11273     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11274
 11275     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11276         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11277            SUBTRACT PB-I-LF-PREMIUM-AMT
 11278                     FROM WS-B-LF-ISS-PRM-ENTERED
 11279            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11280            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11281            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11282         ELSE
 11283            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11284*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11285*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11286         END-IF
 11287     END-IF.
 11288
 11289     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11290            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11291                     FROM WS-B-LF-ISS-PRM-ENTERED
 11292         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11293         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11294
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 208
* VP6311.cbl
 11295     IF  BALT-PREM-LEN     (2)  > ZEROS
 11296         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11297
 11298     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11299         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11300
 11301     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11302         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11303            SUBTRACT PB-I-AH-PREMIUM-AMT
 11304                     FROM WS-B-AH-ISS-PRM-ENTERED
 11305            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11306            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11307            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11308         ELSE
 11309            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11310*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11311*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11312         END-IF
 11313     END-IF
 11314
 11315     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11316        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11317
 11318     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11319        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11320
 11321     IF BINDGRPL            GREATER THAN ZEROS
 11322         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11323
 11324     IF BRTCLSL             GREATER THAN ZEROS
 11325         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11326
 11327     IF BSIGL               GREATER THAN ZEROS
 11328         MOVE BSIGI              TO PB-I-SIG-SW.
 11329
 11330
 11331     IF BMEMBERL            GREATER THAN ZEROS
 11332         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11333
 11334     IF BLNOFCRL            GREATER THAN ZEROS
 11335         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11336
 11337     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11338        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11339
 11340     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11341        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11342
 11343
 11344     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11345        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11346           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11347
 11348     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11349        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11350           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11351
 11352
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 209
* VP6311.cbl
 11353     IF PB-EXT-DAYS-PROCESSING
 11354        IF PB-I-EXTENTION-DAYS = ZEROS
 11355           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11356
 11357     IF PB-EXPIRE-DT-PROCESSING
 11358        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11359           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11360             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11361
 11362     IF PB-1ST-PMT-DT-PROCESSING
 11363        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11364           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11365
 11366     IF BREINL GREATER THAN ZEROS
 11367        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11368
 11369     IF BFORCEL NOT = ZEROS
 11370        MOVE BFORCEI             TO PB-FORCE-CODE.
 11371     IF (BENTRYL NOT = ZEROS)
 11372        AND (PB-COMPANY-ID = 'CID')
 11373        AND (PB-STATE = 'VA')
 11374        AND (BENTRYI NOT = 'P')
 11375        AND (PB-BATCH-ENTRY = 'P')
 11376        PERFORM 1800-REMOVE-CERT-NOTES
 11377                                 THRU 1800-EXIT
 11378     END-IF
 11379     IF BENTRYL NOT = ZEROS
 11380        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11381        IF PI-COMPANY-ID = 'CID'
 11382           AND (PB-BATCH-ENTRY = 'P')
 11383           AND (PB-STATE = 'VA')
 11384           PERFORM 1500-UPDATE-ERNOTE
 11385                                 THRU 1500-EXIT
 11386        END-IF
 11387     END-IF
 11388
 11389     IF BUNWRITL NOT = ZEROS
 11390        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11391
 11392     IF BBILCDL NOT = ZEROS
 11393        MOVE BBILCDI             TO PB-RECORD-BILL.
 11394
 11395
 11396
 11397
 11398
 11399*****************************************************************
 11400*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11401*****************************************************************
 11402
 11403     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11404        IF BTYPE  (1)   = ZEROS OR SPACES
 11405           IF REMOVE-LF-COVERAGE
 11406               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11407                                        PI-BTYPE (1)
 11408               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11409                                        WS-B-LF-ISS-PRM-ENTERED
 11410               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 210
* VP6311.cbl
 11411                                        WS-B-LF-ISS-PRM-ENTERED
 11412               SUBTRACT PB-I-LF-PREM-CALC FROM
 11413                                        WS-B-LF-ISS-PRM-COMPUTED
 11414               MOVE ZEROS            TO PB-I-LF-TERM
 11415                                        PB-I-LF-BENEFIT-AMT
 11416                                        PB-I-LF-PREMIUM-AMT
 11417                                        PB-I-LF-BENEFIT-CD
 11418                                        PB-I-LF-PREM-CALC
 11419                                        PB-I-LF-CRIT-PER
 11420                                        PB-I-LF-ALT-BENEFIT-AMT
 11421                                        PB-I-LF-ALT-PREMIUM-AMT
 11422               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11423           ELSE
 11424               NEXT SENTENCE
 11425        ELSE
 11426           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11427                                    PI-BTYPE (1).
 11428     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11429        IF BTYPE  (2)   = ZEROS OR SPACES
 11430           IF  REMOVE-AH-COVERAGE
 11431               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11432                                        PI-BTYPE (2)
 11433               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11434                                        WS-B-AH-ISS-PRM-ENTERED
 11435               SUBTRACT PB-I-AH-PREM-CALC FROM
 11436                                        WS-B-AH-ISS-PRM-COMPUTED
 11437               MOVE ZEROS            TO PB-I-AH-TERM
 11438                                        PB-I-AH-BENEFIT-AMT
 11439                                        PB-I-AH-PREMIUM-AMT
 11440                                        PB-I-AH-BENEFIT-CD
 11441                                        PB-I-AH-PREM-CALC
 11442                                        PB-I-AH-CRIT-PER
 11443               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11444           ELSE
 11445               NEXT SENTENCE
 11446        ELSE
 11447           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11448                                    PI-BTYPE (2).
 11449 1360-REWRITE-PB-RECORD.
 11450     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11451
 11452     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11453     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11454
 11455     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11456
 11457     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11458     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11459
 11460     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11461         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11462
 11463     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11464         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11465
 11466     PERFORM 1398-UPDATE-ERPNDM THRU 1398-EXIT.
 11467
 11468     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 211
* VP6311.cbl
 11469
 11470     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11471
 11472     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11473     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11474     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11475
 11476     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11477     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11478
 11479 1375-REWRITE-PB-RECORD.
 11480     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11481     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11482     MOVE 'C'                    TO JP-RECORD-TYPE.
 11483     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11484
 11485
 11486* EXEC CICS REWRITE
 11487*        DATASET (FILE-ID-ERPNDB)
 11488*        FROM    (PENDING-BUSINESS)
 11489*    END-EXEC.
 11490     MOVE LENGTH OF
 11491      PENDING-BUSINESS
 11492       TO DFHEIV11
 11493*    MOVE '&& L                  %   #00011105' TO DFHEIV0
 11494     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11495     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11496     MOVE X'2020233030303131313035' TO DFHEIV0(25:11)
 11497     CALL 'kxdfhei1' USING DFHEIV0,
 11498           FILE-ID-ERPNDB,
 11499           PENDING-BUSINESS,
 11500           DFHEIV11,
 11501           DFHEIV99
 11502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11503
 11504
 11505     PERFORM 8400-LOG-JOURNAL-RECORD.
 11506******************************************************************
 11507*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11508******************************************************************
 11509     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11510     MOVE ' '                    TO WS-ERMAIL-SW
 11511
 11512* EXEC CICS READ
 11513*       DATASET   (FILE-ID-ERMAIL)
 11514*       SET       (ADDRESS OF MAILING-DATA)
 11515*       RIDFLD    (ERMAIL-KEY)
 11516*       RESP      (WS-RESPONSE)
 11517*    END-EXEC
 11518*    MOVE '&"S        E          (  N#00011116' TO DFHEIV0
 11519     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11520     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11521     MOVE X'204E233030303131313136' TO DFHEIV0(25:11)
 11522     CALL 'kxdfhei1' USING DFHEIV0,
 11523           FILE-ID-ERMAIL,
 11524           DFHEIV20,
 11525           DFHEIV99,
 11526           ERMAIL-KEY,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 212
* VP6311.cbl
 11527           DFHEIV99,
 11528           DFHEIV99,
 11529           DFHEIV99
 11530     SET ADDRESS OF MAILING-DATA TO
 11531         DFHEIV20
 11532     MOVE EIBRESP  TO WS-RESPONSE
 11533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11534     IF RESP-NORMAL
 11535        SET ERMAIL-FOUND TO TRUE
 11536     END-IF
 11537
 11538     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11539     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11540                                 TO ELCRTO-KEY
 11541     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11542     MOVE +0                     TO ELCRTO-SEQ-NO
 11543
 11544* EXEC CICS READ
 11545*       DATASET   ('ELCRTO')
 11546*       INTO      (ORIGINAL-CERTIFICATE)
 11547*       RIDFLD    (ELCRTO-KEY)
 11548*       GTEQ
 11549*       RESP      (WS-RESPONSE)
 11550*    END-EXEC
 11551     MOVE LENGTH OF
 11552      ORIGINAL-CERTIFICATE
 11553       TO DFHEIV11
 11554     MOVE 'ELCRTO' TO DFHEIV1
 11555*    MOVE '&"IL       G          (  N#00011131' TO DFHEIV0
 11556     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11557     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11558     MOVE X'204E233030303131313331' TO DFHEIV0(25:11)
 11559     CALL 'kxdfhei1' USING DFHEIV0,
 11560           DFHEIV1,
 11561           ORIGINAL-CERTIFICATE,
 11562           DFHEIV11,
 11563           ELCRTO-KEY,
 11564           DFHEIV99,
 11565           DFHEIV99,
 11566           DFHEIV99
 11567     MOVE EIBRESP  TO WS-RESPONSE
 11568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11569*    display ' just read gteq ' ws-response
 11570     IF RESP-NORMAL
 11571        AND (OC-CONTROL-PRIMARY (1:33) =
 11572                 PB-CONTROL-BY-ACCOUNT (1:33))
 11573        AND (OC-RECORD-TYPE = 'I')
 11574        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11575           display ' csr edit session ' PI-CSR-SESSION-SW
 11576           IF NOT CSR-EDIT-SESSION
 11577
 11578* EXEC CICS READ
 11579*                DATASET   ('ELCRTO')
 11580*                INTO      (ORIGINAL-CERTIFICATE)
 11581*                RIDFLD    (OC-CONTROL-PRIMARY)
 11582*                UPDATE
 11583*                RESP      (WS-RESPONSE)
 11584*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 213
* VP6311.cbl
 11585     MOVE LENGTH OF
 11586      ORIGINAL-CERTIFICATE
 11587       TO DFHEIV11
 11588     MOVE 'ELCRTO' TO DFHEIV1
 11589*    MOVE '&"IL       EU         (  N#00011148' TO DFHEIV0
 11590     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11591     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11592     MOVE X'204E233030303131313438' TO DFHEIV0(25:11)
 11593     CALL 'kxdfhei1' USING DFHEIV0,
 11594           DFHEIV1,
 11595           ORIGINAL-CERTIFICATE,
 11596           DFHEIV11,
 11597           OC-CONTROL-PRIMARY,
 11598           DFHEIV99,
 11599           DFHEIV99,
 11600           DFHEIV99
 11601     MOVE EIBRESP  TO WS-RESPONSE
 11602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11603              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11604              IF RESP-NORMAL
 11605                 display ' good read upd '
 11606                 MOVE PB-I-INSURED-LAST-NAME TO
 11607                         OC-INS-LAST-NAME
 11608                 MOVE PB-I-INSURED-FIRST-NAME TO
 11609                         OC-INS-FIRST-NAME
 11610                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11611                         OC-INS-MIDDLE-INIT
 11612                 MOVE PB-I-AGE         TO OC-INS-AGE
 11613                 MOVE PB-I-JOINT-LAST-NAME   TO
 11614                         OC-JNT-LAST-NAME
 11615                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11616                         OC-JNT-FIRST-NAME
 11617                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11618                         OC-JNT-MIDDLE-INIT
 11619                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11620                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11621                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11622                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11623                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11624                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11625                         OC-LF-ALT-BEN-AMT
 11626                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11627                         OC-LF-ALT-PRM-AMT
 11628                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11629                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11630                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11631                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11632                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11633                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11634                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11635                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11636                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11637                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11638                 IF OC-CANCEL-TRAN-IND = 'N'
 11639                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11640                    MOVE +0            TO OC-LF-CANCEL-AMT
 11641                                          OC-LF-ITD-CANCEL-AMT
 11642                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 214
* VP6311.cbl
 11643                    MOVE +0            TO OC-AH-CANCEL-AMT
 11644                                          OC-AH-ITD-CANCEL-AMT
 11645                 END-IF
 11646                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11647                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11648                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11649                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11650                 IF ERMAIL-FOUND
 11651                    MOVE MA-CRED-BENE-NAME
 11652                                 TO OC-CRED-BENE-NAME
 11653                 END-IF
 11654                 IF NOT CERT-TRL-REC-NOT-FOUND
 11655                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11656                           OC-INS-AGE-DEFAULT-FLAG
 11657                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11658                           OC-JNT-AGE-DEFAULT-FLAG
 11659                 END-IF
 11660
 11661* EXEC CICS REWRITE
 11662*                   DATASET   ('ELCRTO')
 11663*                   FROM      (ORIGINAL-CERTIFICATE)
 11664*                   RESP      (WS-RESPONSE)
 11665*                END-EXEC
 11666     MOVE LENGTH OF
 11667      ORIGINAL-CERTIFICATE
 11668       TO DFHEIV11
 11669     MOVE 'ELCRTO' TO DFHEIV1
 11670*    MOVE '&& L                  %  N#00011212' TO DFHEIV0
 11671     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11672     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11673     MOVE X'204E233030303131323132' TO DFHEIV0(25:11)
 11674     CALL 'kxdfhei1' USING DFHEIV0,
 11675           DFHEIV1,
 11676           ORIGINAL-CERTIFICATE,
 11677           DFHEIV11,
 11678           DFHEIV99
 11679     MOVE EIBRESP  TO WS-RESPONSE
 11680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11681                 display ' just rewrote ' ws-response
 11682              END-IF
 11683           END-IF
 11684        ELSE
 11685           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11686           MOVE 'OC'             TO OC-RECORD-ID
 11687           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11688           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11689           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11690           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11691           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11692           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11693           MOVE PB-I-AGE         TO OC-INS-AGE
 11694           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11695           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11696           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11697           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11698           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11699           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11700           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 215
* VP6311.cbl
 11701           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11702           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11703           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11704           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11705           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11706           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11707           MOVE +0               TO OC-LF-CANCEL-AMT
 11708                                    OC-LF-ITD-CANCEL-AMT
 11709           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11710           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11711           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11712           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11713           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11714           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11715           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11716           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11717           MOVE +0               TO OC-AH-CANCEL-AMT
 11718                                    OC-AH-ITD-CANCEL-AMT
 11719           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11720           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11721           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11722           IF ERMAIL-FOUND
 11723              MOVE MA-CRED-BENE-NAME
 11724                                 TO OC-CRED-BENE-NAME
 11725           END-IF
 11726           IF NOT CERT-TRL-REC-NOT-FOUND
 11727              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11728                           OC-INS-AGE-DEFAULT-FLAG
 11729              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11730                           OC-JNT-AGE-DEFAULT-FLAG
 11731           END-IF
 11732           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11733
 11734* EXEC CICS WRITE
 11735*             DATASET   ('ELCRTO')
 11736*             FROM      (ORIGINAL-CERTIFICATE)
 11737*             RIDFLD    (OC-CONTROL-PRIMARY)
 11738*             RESP      (WS-RESPONSE)
 11739*          END-EXEC
 11740     MOVE LENGTH OF
 11741      ORIGINAL-CERTIFICATE
 11742       TO DFHEIV11
 11743     MOVE 'ELCRTO' TO DFHEIV1
 11744*    MOVE '&$ L                  ''  N#00011269' TO DFHEIV0
 11745     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11746     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11747     MOVE X'204E233030303131323639' TO DFHEIV0(25:11)
 11748     CALL 'kxdfhei1' USING DFHEIV0,
 11749           DFHEIV1,
 11750           ORIGINAL-CERTIFICATE,
 11751           DFHEIV11,
 11752           OC-CONTROL-PRIMARY,
 11753           DFHEIV99,
 11754           DFHEIV99
 11755     MOVE EIBRESP  TO WS-RESPONSE
 11756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11757        END-IF
 11758     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 216
* VP6311.cbl
 11759        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11760        MOVE 'OC'                TO OC-RECORD-ID
 11761        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11762                                 TO OC-CONTROL-PRIMARY (1:33)
 11763        MOVE 'I'                 TO OC-RECORD-TYPE
 11764        MOVE +4096               TO OC-KEY-SEQ-NO
 11765        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11766        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11767        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11768        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11769        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11770        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11771        MOVE PB-I-AGE            TO OC-INS-AGE
 11772        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11773        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11774        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11775        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11776        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11777        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11778        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11779        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11780        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11781        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11782        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11783        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11784        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11785        MOVE +0                  TO OC-LF-CANCEL-AMT
 11786                                    OC-LF-ITD-CANCEL-AMT
 11787        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11788        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11789        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11790        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11791        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11792        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11793        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11794        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11795        MOVE +0                  TO OC-AH-CANCEL-AMT
 11796                                    OC-AH-ITD-CANCEL-AMT
 11797        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11798        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11799        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11800        IF ERMAIL-FOUND
 11801           MOVE MA-CRED-BENE-NAME
 11802                                 TO OC-CRED-BENE-NAME
 11803        END-IF
 11804        IF NOT CERT-TRL-REC-NOT-FOUND
 11805           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11806                           OC-INS-AGE-DEFAULT-FLAG
 11807           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11808                           OC-JNT-AGE-DEFAULT-FLAG
 11809        END-IF
 11810        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11811
 11812* EXEC CICS WRITE
 11813*          DATASET   ('ELCRTO')
 11814*          FROM      (ORIGINAL-CERTIFICATE)
 11815*          RIDFLD    (OC-CONTROL-PRIMARY)
 11816*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 217
* VP6311.cbl
 11817*       END-EXEC
 11818     MOVE LENGTH OF
 11819      ORIGINAL-CERTIFICATE
 11820       TO DFHEIV11
 11821     MOVE 'ELCRTO' TO DFHEIV1
 11822*    MOVE '&$ L                  ''  N#00011329' TO DFHEIV0
 11823     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11824     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11825     MOVE X'204E233030303131333239' TO DFHEIV0(25:11)
 11826     CALL 'kxdfhei1' USING DFHEIV0,
 11827           DFHEIV1,
 11828           ORIGINAL-CERTIFICATE,
 11829           DFHEIV11,
 11830           OC-CONTROL-PRIMARY,
 11831           DFHEIV99,
 11832           DFHEIV99
 11833     MOVE EIBRESP  TO WS-RESPONSE
 11834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11835     END-IF
 11836******************************************************************
 11837*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11838******************************************************************
 11839
 11840     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11841     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11842
 11843
 11844* EXEC CICS READ
 11845*        INTO    (PENDING-BUSINESS)
 11846*        DATASET (FILE-ID-ERPNDB)
 11847*        RIDFLD  (ERPNDB-KEY)
 11848*        UPDATE
 11849*    END-EXEC.
 11850     MOVE LENGTH OF
 11851      PENDING-BUSINESS
 11852       TO DFHEIV11
 11853*    MOVE '&"IL       EU         (   #00011343' TO DFHEIV0
 11854     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11855     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11856     MOVE X'2020233030303131333433' TO DFHEIV0(25:11)
 11857     CALL 'kxdfhei1' USING DFHEIV0,
 11858           FILE-ID-ERPNDB,
 11859           PENDING-BUSINESS,
 11860           DFHEIV11,
 11861           ERPNDB-KEY,
 11862           DFHEIV99,
 11863           DFHEIV99,
 11864           DFHEIV99
 11865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11866
 11867
 11868     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11869     MOVE 'B'                    TO JP-RECORD-TYPE.
 11870     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11871
 11872     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11873
 11874     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 218
* VP6311.cbl
 11875
 11876     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11877
 11878     MOVE 'C'                    TO JP-RECORD-TYPE.
 11879     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11880
 11881
 11882* EXEC CICS REWRITE
 11883*        DATASET    (FILE-ID-ERPNDB)
 11884*        FROM       (PENDING-BUSINESS)
 11885*    END-EXEC.
 11886     MOVE LENGTH OF
 11887      PENDING-BUSINESS
 11888       TO DFHEIV11
 11889*    MOVE '&& L                  %   #00011363' TO DFHEIV0
 11890     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11891     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11892     MOVE X'2020233030303131333633' TO DFHEIV0(25:11)
 11893     CALL 'kxdfhei1' USING DFHEIV0,
 11894           FILE-ID-ERPNDB,
 11895           PENDING-BUSINESS,
 11896           DFHEIV11,
 11897           DFHEIV99
 11898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11899
 11900
 11901     PERFORM 8400-LOG-JOURNAL-RECORD.
 11902
 11903     IF WS-ERRORS-PRESENT
 11904        GO TO 3900-RE-DISPLAY-RECORD.
 11905
 11906     MOVE ZEROS                  TO EMI-ERROR.
 11907     MOVE -1                     TO BMAINTL.
 11908     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11909     GO TO 3900-RE-DISPLAY-RECORD.
 11910
 11911 1380-BATCH-HDR-NOT-FOUND.
 11912     MOVE -1                     TO BMAINTL.
 11913     MOVE ER-7450                TO EMI-ERROR.
 11914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11915     GO TO 8200-SEND-DATAONLY.
 11916
 11917 1385-REC-NOT-FOUND.
 11918     MOVE -1                     TO BMAINTL.
 11919     MOVE ER-7451                TO EMI-ERROR.
 11920     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11921     GO TO 8200-SEND-DATAONLY.
 11922
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 219
* VP6311.cbl
 11924
 11925
 11926 1386-UPDATE-AGE-FLAGS.
 11927
 11928
 11929* EXEC CICS GETMAIN
 11930*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11931*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11932*        INITIMG (GETMAIN-SPACE)
 11933*    END-EXEC
 11934*    MOVE ',"IL                  $   #00011395' TO DFHEIV0
 11935     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11936     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11937     MOVE X'2020233030303131333935' TO DFHEIV0(25:11)
 11938     CALL 'kxdfhei1' USING DFHEIV0,
 11939           DFHEIV20,
 11940           ELCRTT-RECORD-LENGTH,
 11941           GETMAIN-SPACE
 11942     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11943         DFHEIV20
 11944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11945
 11946
 11947* EXEC CICS HANDLE CONDITION
 11948*        NOTFND   (1386-NOTFND)
 11949*    END-EXEC.
 11950*    MOVE '"$I                   ! ( #00011401' TO DFHEIV0
 11951     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11953     MOVE X'2820233030303131343031' TO DFHEIV0(25:11)
 11954     CALL 'kxdfhei1' USING DFHEIV0
 11955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11956
 11957
 11958     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11959     MOVE 'C'                TO ELCRTT-REC-TYPE
 11960
 11961
 11962* EXEC CICS READ
 11963*        UPDATE
 11964*        DATASET  (CRTT-ID)
 11965*        RIDFLD   (ELCRTT-KEY)
 11966*        INTO     (CERTIFICATE-TRAILERS)
 11967*    END-EXEC.
 11968     MOVE LENGTH OF
 11969      CERTIFICATE-TRAILERS
 11970       TO DFHEIV11
 11971*    MOVE '&"IL       EU         (   #00011408' TO DFHEIV0
 11972     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11973     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11974     MOVE X'2020233030303131343038' TO DFHEIV0(25:11)
 11975     CALL 'kxdfhei1' USING DFHEIV0,
 11976           CRTT-ID,
 11977           CERTIFICATE-TRAILERS,
 11978           DFHEIV11,
 11979           ELCRTT-KEY,
 11980           DFHEIV99,
 11981           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 220
* VP6311.cbl
 11982           DFHEIV99
 11983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11984
 11985
 11986     IF WS-INS-AGE-SET = 'Y'
 11987        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11988     END-IF
 11989     IF WS-JNT-AGE-SET = 'Y'
 11990        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11991     END-IF
 11992
 11993
 11994* EXEC CICS REWRITE
 11995*       DATASET  (CRTT-ID)
 11996*       FROM     (CERTIFICATE-TRAILERS)
 11997*    END-EXEC.
 11998     MOVE LENGTH OF
 11999      CERTIFICATE-TRAILERS
 12000       TO DFHEIV11
 12001*    MOVE '&& L                  %   #00011422' TO DFHEIV0
 12002     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12003     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12004     MOVE X'2020233030303131343232' TO DFHEIV0(25:11)
 12005     CALL 'kxdfhei1' USING DFHEIV0,
 12006           CRTT-ID,
 12007           CERTIFICATE-TRAILERS,
 12008           DFHEIV11,
 12009           DFHEIV99
 12010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12011
 12012
 12013     GO TO 1386-EXIT.
 12014
 12015 1386-NOTFND.
 12016
 12017     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12018     MOVE 'CS'         TO CS-RECORD-ID.
 12019     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12020     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12021     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12022     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12023     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12024
 12025* EXEC CICS WRITE
 12026*       DATASET  (CRTT-ID)
 12027*       RIDFLD   (ELCRTT-KEY)
 12028*       FROM     (CERTIFICATE-TRAILERS)
 12029*    END-EXEC.
 12030     MOVE LENGTH OF
 12031      CERTIFICATE-TRAILERS
 12032       TO DFHEIV11
 12033*    MOVE '&$ L                  ''   #00011438' TO DFHEIV0
 12034     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12035     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12036     MOVE X'2020233030303131343338' TO DFHEIV0(25:11)
 12037     CALL 'kxdfhei1' USING DFHEIV0,
 12038           CRTT-ID,
 12039           CERTIFICATE-TRAILERS,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 221
* VP6311.cbl
 12040           DFHEIV11,
 12041           ELCRTT-KEY,
 12042           DFHEIV99,
 12043           DFHEIV99
 12044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12045
 12046
 12047 1386-EXIT.
 12048     EXIT.
 12049 1390-read-elcrtt-update.
 12050
 12051* EXEC CICS GETMAIN
 12052*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12053*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12054*        INITIMG (GETMAIN-SPACE)
 12055*    END-EXEC
 12056*    MOVE ',"IL                  $   #00011447' TO DFHEIV0
 12057     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12058     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12059     MOVE X'2020233030303131343437' TO DFHEIV0(25:11)
 12060     CALL 'kxdfhei1' USING DFHEIV0,
 12061           DFHEIV20,
 12062           ELCRTT-RECORD-LENGTH,
 12063           GETMAIN-SPACE
 12064     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12065         DFHEIV20
 12066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12067
 12068* EXEC CICS READ
 12069*        UPDATE
 12070*        DATASET  (CRTT-ID)
 12071*        RIDFLD   (ELCRTT-KEY)
 12072*        INTO     (CERTIFICATE-TRAILERS)
 12073*        resp     (ws-response)
 12074*    END-EXEC
 12075     MOVE LENGTH OF
 12076      CERTIFICATE-TRAILERS
 12077       TO DFHEIV11
 12078*    MOVE '&"IL       EU         (  N#00011452' TO DFHEIV0
 12079     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12080     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12081     MOVE X'204E233030303131343532' TO DFHEIV0(25:11)
 12082     CALL 'kxdfhei1' USING DFHEIV0,
 12083           CRTT-ID,
 12084           CERTIFICATE-TRAILERS,
 12085           DFHEIV11,
 12086           ELCRTT-KEY,
 12087           DFHEIV99,
 12088           DFHEIV99,
 12089           DFHEIV99
 12090     MOVE EIBRESP  TO ws-response
 12091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12092     .
 12093 1390-exit.
 12094     exit.
 12095 1391-rewrite-elcrtt.
 12096     perform 1393-update-elcrtt  thru 1393-exit
 12097
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 222
* VP6311.cbl
 12098* EXEC CICS REWRITE
 12099*       DATASET  (CRTT-ID)
 12100*       FROM     (CERTIFICATE-TRAILERS)
 12101*       resp     (ws-response)
 12102*    END-EXEC
 12103     MOVE LENGTH OF
 12104      CERTIFICATE-TRAILERS
 12105       TO DFHEIV11
 12106*    MOVE '&& L                  %  N#00011464' TO DFHEIV0
 12107     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12108     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12109     MOVE X'204E233030303131343634' TO DFHEIV0(25:11)
 12110     CALL 'kxdfhei1' USING DFHEIV0,
 12111           CRTT-ID,
 12112           CERTIFICATE-TRAILERS,
 12113           DFHEIV11,
 12114           DFHEIV99
 12115     MOVE EIBRESP  TO ws-response
 12116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12117     .
 12118 1391-exit.
 12119     exit.
 12120 1392-write-elcrtt.
 12121     move 'CS'                   to certificate-trailers
 12122     move elcrtt-key             to cs-control-primary
 12123     move 'C'                    to cs-trailer-type
 12124     perform 1393-update-elcrtt  thru 1393-exit
 12125
 12126* EXEC CICS WRITE
 12127*       DATASET  (CRTT-ID)
 12128*       ridfld   (elcrtt-key)
 12129*       FROM     (CERTIFICATE-TRAILERS)
 12130*       resp     (ws-response)
 12131*    END-EXEC
 12132     MOVE LENGTH OF
 12133      CERTIFICATE-TRAILERS
 12134       TO DFHEIV11
 12135*    MOVE '&$ L                  ''  N#00011477' TO DFHEIV0
 12136     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12137     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12138     MOVE X'204E233030303131343737' TO DFHEIV0(25:11)
 12139     CALL 'kxdfhei1' USING DFHEIV0,
 12140           CRTT-ID,
 12141           CERTIFICATE-TRAILERS,
 12142           DFHEIV11,
 12143           elcrtt-key,
 12144           DFHEIV99,
 12145           DFHEIV99
 12146     MOVE EIBRESP  TO ws-response
 12147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12148     .
 12149 1392-exit.
 12150     exit.
 12151 1393-update-elcrtt.
 12152     if byearl <> zeros
 12153        move byeari              to cs-year
 12154     end-if
 12155     if bmakel <> zeros
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 223
* VP6311.cbl
 12156        move bmakei              to cs-make
 12157     end-if
 12158     if bmodell <> zeros
 12159        move bmodeli             to cs-model
 12160     end-if
 12161     if bometerl <> zeros
 12162        MOVE Bometeri            TO DEEDIT-FIELD
 12163        PERFORM 8600-DEEDIT
 12164        IF DEEDIT-FIELD-V0 NUMERIC
 12165           MOVE DEEDIT-FIELD-V0  TO cs-vehicle-odometer
 12166        end-if
 12167     end-if
 12168     .
 12169 1393-exit.
 12170     exit.
 12171 1398-UPDATE-ERPNDM.
 12172
 12173
 12174* EXEC CICS HANDLE CONDITION
 12175*        NOTFND (1398-EXIT)
 12176*    END-EXEC.
 12177*    MOVE '"$I                   ! ) #00011508' TO DFHEIV0
 12178     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12180     MOVE X'2920233030303131353038' TO DFHEIV0(25:11)
 12181     CALL 'kxdfhei1' USING DFHEIV0
 12182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12183
 12184
 12185     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12186
 12187
 12188* EXEC CICS READ
 12189*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12190*        DATASET (FILE-ID-ERPNDM)
 12191*        RIDFLD  (ERPNDM-KEY)
 12192*        UPDATE
 12193*    END-EXEC.
 12194*    MOVE '&"S        EU         (   #00011514' TO DFHEIV0
 12195     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12196     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12197     MOVE X'2020233030303131353134' TO DFHEIV0(25:11)
 12198     CALL 'kxdfhei1' USING DFHEIV0,
 12199           FILE-ID-ERPNDM,
 12200           DFHEIV20,
 12201           DFHEIV99,
 12202           ERPNDM-KEY,
 12203           DFHEIV99,
 12204           DFHEIV99,
 12205           DFHEIV99
 12206     SET ADDRESS OF PENDING-MAILING-DATA TO
 12207         DFHEIV20
 12208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12209
 12210
 12211     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12212     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12213     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 224
* VP6311.cbl
 12214
 12215     IF BLSTNML GREATER THAN ZEROS
 12216         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12217
 12218     IF B1STNML GREATER  THAN ZEROS
 12219         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
 12220
 12221     IF BINITL GREATER THAN ZEROS
 12222         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12223
 12224     IF BAGEL GREATER THAN ZEROS
 12225         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12226
 12227     IF BBIRTHL GREATER THAN ZEROS
 12228         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12229
 12230     IF BSEXL GREATER THAN ZEROS
 12231         MOVE  BSEXI             TO PM-INSURED-SEX.
 12232
 12233
 12234* EXEC CICS REWRITE
 12235*        DATASET (FILE-ID-ERPNDM)
 12236*        FROM    (PENDING-MAILING-DATA)
 12237*    END-EXEC.
 12238     MOVE LENGTH OF
 12239      PENDING-MAILING-DATA
 12240       TO DFHEIV11
 12241*    MOVE '&& L                  %   #00011543' TO DFHEIV0
 12242     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12243     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12244     MOVE X'2020233030303131353433' TO DFHEIV0(25:11)
 12245     CALL 'kxdfhei1' USING DFHEIV0,
 12246           FILE-ID-ERPNDM,
 12247           PENDING-MAILING-DATA,
 12248           DFHEIV11,
 12249           DFHEIV99
 12250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12251
 12252
 12253 1398-EXIT.
 12254     EXIT.
 12255
 12256******************************************************************
 12257*                                                                *
 12258*          D E L E T E   I S S U E   R O U T I N E               *
 12259*                                                                *
 12260******************************************************************
 12261
 12262 1400-DELETE-ISSUE-ROUTINE.
 12263     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12264
 12265     IF BCHGL NOT = ZEROS
 12266        MOVE ER-2196             TO EMI-ERROR
 12267        MOVE AL-UABON            TO BMAINTA
 12268        MOVE -1                  TO BMAINTL
 12269        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12270        GO TO 8200-SEND-DATAONLY.
 12271
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 225
* VP6311.cbl
 12272
 12273* EXEC CICS HANDLE CONDITION
 12274*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12275*    END-EXEC.
 12276*    MOVE '"$I                   ! * #00011567' TO DFHEIV0
 12277     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12279     MOVE X'2A20233030303131353637' TO DFHEIV0(25:11)
 12280     CALL 'kxdfhei1' USING DFHEIV0
 12281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12282
 12283
 12284     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12285     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12286     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12287
 12288
 12289* EXEC CICS READ
 12290*        SET     (ADDRESS OF PENDING-BUSINESS)
 12291*        DATASET (FILE-ID-ERPNDB)
 12292*        RIDFLD  (ERPNDB-KEY)
 12293*    END-EXEC.
 12294*    MOVE '&"S        E          (   #00011575' TO DFHEIV0
 12295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12297     MOVE X'2020233030303131353735' TO DFHEIV0(25:11)
 12298     CALL 'kxdfhei1' USING DFHEIV0,
 12299           FILE-ID-ERPNDB,
 12300           DFHEIV20,
 12301           DFHEIV99,
 12302           ERPNDB-KEY,
 12303           DFHEIV99,
 12304           DFHEIV99,
 12305           DFHEIV99
 12306     SET ADDRESS OF PENDING-BUSINESS TO
 12307         DFHEIV20
 12308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12309
 12310
 12311     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12312
 12313     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12314
 12315     IF BSUFIXL NOT = ZEROS
 12316        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12317     ELSE
 12318        MOVE SPACE               TO WS-NEW-SUFFIX.
 12319
 12320     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12321     PERFORM 8600-DEEDIT.
 12322     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12323     MOVE '4'                    TO DC-OPTION-CODE.
 12324     PERFORM 9700-DATE-LINK.
 12325     IF DATE-CONVERSION-ERROR
 12326        MOVE ER-0348             TO EMI-ERROR
 12327        MOVE -1                  TO BEFFDTL
 12328        MOVE AL-UABON            TO BEFFDTA
 12329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 226
* VP6311.cbl
 12330        GO TO 8200-SEND-DATAONLY
 12331     ELSE
 12332        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12333        MOVE AL-UANON            TO BEFFDTA
 12334        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12335
 12336
 12337* EXEC CICS HANDLE CONDITION
 12338*         NOTFND    (1490-RECORD-NOT-FOUND)
 12339*    END-EXEC.
 12340*    MOVE '"$I                   ! + #00011606' TO DFHEIV0
 12341     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12343     MOVE X'2B20233030303131363036' TO DFHEIV0(25:11)
 12344     CALL 'kxdfhei1' USING DFHEIV0
 12345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12346
 12347
 12348
 12349* EXEC CICS READ
 12350*        SET     (ADDRESS OF PENDING-BUSINESS)
 12351*        DATASET (FILE-ID-ERPNDB)
 12352*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12353*        UPDATE
 12354*    END-EXEC.
 12355*    MOVE '&"S        EU         (   #00011610' TO DFHEIV0
 12356     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12357     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12358     MOVE X'2020233030303131363130' TO DFHEIV0(25:11)
 12359     CALL 'kxdfhei1' USING DFHEIV0,
 12360           FILE-ID-ERPNDB,
 12361           DFHEIV20,
 12362           DFHEIV99,
 12363           PI-PREV-CONTROL-PRIMARY,
 12364           DFHEIV99,
 12365           DFHEIV99,
 12366           DFHEIV99
 12367     SET ADDRESS OF PENDING-BUSINESS TO
 12368         DFHEIV20
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12370
 12371
 12372     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12373        MOVE -1                 TO BMAINTL
 12374        MOVE ER-2197            TO EMI-ERROR
 12375        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12376        GO TO 8200-SEND-DATAONLY.
 12377
 12378     IF PB-BILLED-DT NOT = LOW-VALUES
 12379        MOVE -1                 TO BMAINTL
 12380        MOVE ER-2129            TO EMI-ERROR
 12381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12382        GO TO 8200-SEND-DATAONLY.
 12383
 12384     IF PB-CHG-COUNT NOT = ZEROS
 12385        MOVE ER-2336            TO EMI-ERROR
 12386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12387        MOVE AL-UABON            TO BMAINTA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 227
* VP6311.cbl
 12388        MOVE -1                  TO BMAINTL
 12389        GO TO 8200-SEND-DATAONLY.
 12390
 12391     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12392        PB-CHG-COUNT NOT = ZEROS
 12393        MOVE ER-2196             TO EMI-ERROR
 12394        MOVE AL-UABON            TO BMAINTA
 12395        MOVE -1                  TO BMAINTL
 12396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12397        GO TO 8200-SEND-DATAONLY.
 12398******************************************************************
 12399*                                                                *
 12400*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12401*                                                                *
 12402******************************************************************
 12403     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12404     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12405     MOVE +0                     TO ELCRTO-SEQ-NO
 12406
 12407* EXEC CICS READ
 12408*       DATASET   ('ELCRTO')
 12409*       INTO      (ORIGINAL-CERTIFICATE)
 12410*       RIDFLD    (ELCRTO-KEY)
 12411*       GTEQ
 12412*       RESP      (WS-RESPONSE)
 12413*    END-EXEC
 12414     MOVE LENGTH OF
 12415      ORIGINAL-CERTIFICATE
 12416       TO DFHEIV11
 12417     MOVE 'ELCRTO' TO DFHEIV1
 12418*    MOVE '&"IL       G          (  N#00011651' TO DFHEIV0
 12419     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12421     MOVE X'204E233030303131363531' TO DFHEIV0(25:11)
 12422     CALL 'kxdfhei1' USING DFHEIV0,
 12423           DFHEIV1,
 12424           ORIGINAL-CERTIFICATE,
 12425           DFHEIV11,
 12426           ELCRTO-KEY,
 12427           DFHEIV99,
 12428           DFHEIV99,
 12429           DFHEIV99
 12430     MOVE EIBRESP  TO WS-RESPONSE
 12431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12432     IF RESP-NORMAL
 12433        AND (OC-CONTROL-PRIMARY (1:33) =
 12434                 PB-CONTROL-BY-ACCOUNT (1:33))
 12435        AND (OC-RECORD-TYPE = 'I')
 12436
 12437* EXEC CICS READ
 12438*          DATASET   ('ELCRTO')
 12439*          INTO      (ORIGINAL-CERTIFICATE)
 12440*          RIDFLD    (ELCRTO-KEY)
 12441*          UPDATE
 12442*          RESP      (WS-RESPONSE)
 12443*       END-EXEC
 12444     MOVE LENGTH OF
 12445      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 228
* VP6311.cbl
 12446       TO DFHEIV11
 12447     MOVE 'ELCRTO' TO DFHEIV1
 12448*    MOVE '&"IL       EU         (  N#00011662' TO DFHEIV0
 12449     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12450     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12451     MOVE X'204E233030303131363632' TO DFHEIV0(25:11)
 12452     CALL 'kxdfhei1' USING DFHEIV0,
 12453           DFHEIV1,
 12454           ORIGINAL-CERTIFICATE,
 12455           DFHEIV11,
 12456           ELCRTO-KEY,
 12457           DFHEIV99,
 12458           DFHEIV99,
 12459           DFHEIV99
 12460     MOVE EIBRESP  TO WS-RESPONSE
 12461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12462        IF RESP-NORMAL
 12463
 12464* EXEC CICS DELETE
 12465*             DATASET   ('ELCRTO')
 12466*          END-EXEC
 12467     MOVE 'ELCRTO' TO DFHEIV1
 12468*    MOVE '&(                    &   #00011670' TO DFHEIV0
 12469     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12470     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12471     MOVE X'2020233030303131363730' TO DFHEIV0(25:11)
 12472     CALL 'kxdfhei1' USING DFHEIV0,
 12473           DFHEIV1,
 12474           DFHEIV99,
 12475           DFHEIV99,
 12476           DFHEIV99,
 12477           DFHEIV99
 12478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12479        END-IF
 12480     END-IF
 12481******************************************************************
 12482*                                                                *
 12483*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12484*                                                                *
 12485******************************************************************
 12486
 12487* EXEC CICS HANDLE CONDITION
 12488*        NOTFND    (1405-DELETE-CERTIFICATE)
 12489*    END-EXEC.
 12490*    MOVE '"$I                   ! , #00011680' TO DFHEIV0
 12491     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12492     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12493     MOVE X'2C20233030303131363830' TO DFHEIV0(25:11)
 12494     CALL 'kxdfhei1' USING DFHEIV0
 12495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12496
 12497
 12498
 12499* EXEC CICS READ
 12500*        EQUAL
 12501*        DATASET   (FILE-ID-ERPNDM)
 12502*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12503*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 229
* VP6311.cbl
 12504*        UPDATE
 12505*    END-EXEC.
 12506*    MOVE '&"S        EU         (   #00011684' TO DFHEIV0
 12507     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12508     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12509     MOVE X'2020233030303131363834' TO DFHEIV0(25:11)
 12510     CALL 'kxdfhei1' USING DFHEIV0,
 12511           FILE-ID-ERPNDM,
 12512           DFHEIV20,
 12513           DFHEIV99,
 12514           PI-PREV-CONTROL-PRIMARY,
 12515           DFHEIV99,
 12516           DFHEIV99,
 12517           DFHEIV99
 12518     SET ADDRESS OF PENDING-MAILING-DATA TO
 12519         DFHEIV20
 12520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12521
 12522
 12523     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12524     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12525     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12526
 12527     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12528
 12529
 12530* EXEC CICS DELETE
 12531*        DATASET   (FILE-ID-ERPNDM)
 12532*    END-EXEC.
 12533*    MOVE '&(                    &   #00011698' TO DFHEIV0
 12534     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12535     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12536     MOVE X'2020233030303131363938' TO DFHEIV0(25:11)
 12537     CALL 'kxdfhei1' USING DFHEIV0,
 12538           FILE-ID-ERPNDM,
 12539           DFHEIV99,
 12540           DFHEIV99,
 12541           DFHEIV99,
 12542           DFHEIV99
 12543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12544
 12545
 12546******************************************************************
 12547*                PROCESS   CERTIFICATE                           *
 12548******************************************************************
 12549
 12550 1405-DELETE-CERTIFICATE.
 12551
 12552* EXEC CICS HANDLE CONDITION
 12553*         NOTFND  (1420-CONTINUE-DELETE)
 12554*    END-EXEC.
 12555*    MOVE '"$I                   ! - #00011707' TO DFHEIV0
 12556     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12558     MOVE X'2D20233030303131373037' TO DFHEIV0(25:11)
 12559     CALL 'kxdfhei1' USING DFHEIV0
 12560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12561
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 230
* VP6311.cbl
 12562
 12563     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12564     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12565     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12566     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12567
 12568
 12569* EXEC CICS READ
 12570*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12571*        DATASET (FILE-ID-ELCERT)
 12572*        RIDFLD  (ELCERT-KEY)
 12573*        UPDATE
 12574*    END-EXEC.
 12575*    MOVE '&"S        EU         (   #00011716' TO DFHEIV0
 12576     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12577     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12578     MOVE X'2020233030303131373136' TO DFHEIV0(25:11)
 12579     CALL 'kxdfhei1' USING DFHEIV0,
 12580           FILE-ID-ELCERT,
 12581           DFHEIV20,
 12582           DFHEIV99,
 12583           ELCERT-KEY,
 12584           DFHEIV99,
 12585           DFHEIV99,
 12586           DFHEIV99
 12587     SET ADDRESS OF CERTIFICATE-MASTER TO
 12588         DFHEIV20
 12589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12590
 12591
 12592     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12593
 12594     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12595     MOVE 'B'                    TO JP-RECORD-TYPE
 12596     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12597
 12598     PERFORM 8400-LOG-JOURNAL-RECORD.
 12599
 12600     IF CERT-NOTES-ARE-NOT-PRESENT
 12601        MOVE ' '                 TO WS-CERT-NOTE-SW
 12602     ELSE
 12603        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12604
 12605     IF INSURED-ADDR-PRESENT
 12606        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12607
 12608******************************************************************
 12609******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12610******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12611******************************************************************
 12612******************************************************************
 12613
 12614     IF CERT-ADDED-BATCH AND
 12615        (NOT NO-CLAIM-ATTACHED
 12616         OR
 12617         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12618        GO TO 1410-REWRITE-CERT.
 12619
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 231
* VP6311.cbl
 12620******************************************************************
 12621******************************************************************
 12622
 12623     IF CERT-ADDED-BATCH  AND
 12624        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12625        GO TO 1410-REWRITE-CERT.
 12626
 12627     IF NO-CLAIM-ATTACHED
 12628        NEXT SENTENCE
 12629     ELSE
 12630        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12631        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12632        GO TO 1410-REWRITE-CERT.
 12633
 12634     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12635     MOVE 'D'                      TO JP-RECORD-TYPE.
 12636     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12637
 12638
 12639* EXEC CICS DELETE
 12640*         DATASET    (FILE-ID-ELCERT)
 12641*    END-EXEC.
 12642*    MOVE '&(                    &   #00011769' TO DFHEIV0
 12643     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12645     MOVE X'2020233030303131373639' TO DFHEIV0(25:11)
 12646     CALL 'kxdfhei1' USING DFHEIV0,
 12647           FILE-ID-ELCERT,
 12648           DFHEIV99,
 12649           DFHEIV99,
 12650           DFHEIV99,
 12651           DFHEIV99
 12652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12653
 12654
 12655     PERFORM 8400-LOG-JOURNAL-RECORD.
 12656
 12657******************************************************************
 12658*                                                                *
 12659*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12660*                                                                *
 12661******************************************************************
 12662
 12663     IF  CERT-NOTES-ARE-PRESENT
 12664         NEXT SENTENCE
 12665     ELSE
 12666         GO TO 1407-DELETE-MAILING.
 12667
 12668
 12669* EXEC CICS HANDLE CONDITION
 12670*         NOTFND  (1406-DELETE-ERNOTE)
 12671*    END-EXEC.
 12672*    MOVE '"$I                   ! . #00011786' TO DFHEIV0
 12673     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12674     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12675     MOVE X'2E20233030303131373836' TO DFHEIV0(25:11)
 12676     CALL 'kxdfhei1' USING DFHEIV0
 12677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 232
* VP6311.cbl
 12678
 12679
 12680     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12681     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12682     MOVE 0                     TO ERCNOT-SEQUENCE.
 12683
 12684 1406-DELETE-ERCNOT-LOOP.
 12685
 12686
 12687* EXEC CICS READ
 12688*        GTEQ
 12689*        DATASET   (FILE-ID-ERCNOT)
 12690*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12691*        RIDFLD    (ERCNOT-KEY)
 12692*    END-EXEC.
 12693*    MOVE '&"S        G          (   #00011796' TO DFHEIV0
 12694     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12695     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12696     MOVE X'2020233030303131373936' TO DFHEIV0(25:11)
 12697     CALL 'kxdfhei1' USING DFHEIV0,
 12698           FILE-ID-ERCNOT,
 12699           DFHEIV20,
 12700           DFHEIV99,
 12701           ERCNOT-KEY,
 12702           DFHEIV99,
 12703           DFHEIV99,
 12704           DFHEIV99
 12705     SET ADDRESS OF CERT-NOTE-FILE TO
 12706         DFHEIV20
 12707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12708
 12709
 12710     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12711     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12712         GO TO 1406-DELETE-ERNOTE
 12713     END-IF.
 12714
 12715     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12716     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12717     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12718
 12719     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12720
 12721
 12722* EXEC CICS DELETE
 12723*        DATASET   (FILE-ID-ERCNOT)
 12724*        RIDFLD    (ERCNOT-KEY)
 12725*        END-EXEC.
 12726*    MOVE '&(  R                 &   #00011814' TO DFHEIV0
 12727     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12728     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12729     MOVE X'2020233030303131383134' TO DFHEIV0(25:11)
 12730     CALL 'kxdfhei1' USING DFHEIV0,
 12731           FILE-ID-ERCNOT,
 12732           ERCNOT-KEY,
 12733           DFHEIV99,
 12734           DFHEIV99,
 12735           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 233
* VP6311.cbl
 12736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12737
 12738
 12739     PERFORM 8400-LOG-JOURNAL-RECORD.
 12740
 12741     GO TO 1406-DELETE-ERCNOT-LOOP.
 12742
 12743 1406-DELETE-ERNOTE.
 12744
 12745
 12746* EXEC CICS HANDLE CONDITION
 12747*         NOTFND  (1407-DELETE-MAILING)
 12748*    END-EXEC.
 12749*    MOVE '"$I                   ! / #00011825' TO DFHEIV0
 12750     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12752     MOVE X'2F20233030303131383235' TO DFHEIV0(25:11)
 12753     CALL 'kxdfhei1' USING DFHEIV0
 12754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12755
 12756
 12757
 12758* EXEC CICS READ
 12759*        EQUAL
 12760*        DATASET   (FILE-ID-ERNOTE)
 12761*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12762*        RIDFLD    (ELCERT-KEY)
 12763*        UPDATE
 12764*    END-EXEC.
 12765*    MOVE '&"S        EU         (   #00011829' TO DFHEIV0
 12766     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12767     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12768     MOVE X'2020233030303131383239' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0,
 12770           FILE-ID-ERNOTE,
 12771           DFHEIV20,
 12772           DFHEIV99,
 12773           ELCERT-KEY,
 12774           DFHEIV99,
 12775           DFHEIV99,
 12776           DFHEIV99
 12777     SET ADDRESS OF CERTIFICATE-NOTE TO
 12778         DFHEIV20
 12779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12780
 12781
 12782     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12783     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12784     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12785
 12786     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12787
 12788
 12789* EXEC CICS DELETE
 12790*        DATASET   (FILE-ID-ERNOTE)
 12791*        END-EXEC.
 12792*    MOVE '&(                    &   #00011843' TO DFHEIV0
 12793     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 234
* VP6311.cbl
 12794     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12795     MOVE X'2020233030303131383433' TO DFHEIV0(25:11)
 12796     CALL 'kxdfhei1' USING DFHEIV0,
 12797           FILE-ID-ERNOTE,
 12798           DFHEIV99,
 12799           DFHEIV99,
 12800           DFHEIV99,
 12801           DFHEIV99
 12802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12803
 12804
 12805     PERFORM 8400-LOG-JOURNAL-RECORD.
 12806
 12807******************************************************************
 12808*                                                                *
 12809*                DELETE MAILING ADDRESS RECORDS                  *
 12810*                                                                *
 12811******************************************************************
 12812
 12813 1407-DELETE-MAILING.
 12814     IF CERT-ADDRESS-PRESENT
 12815        NEXT SENTENCE
 12816     ELSE
 12817        GO TO 1420-CONTINUE-DELETE.
 12818
 12819
 12820* EXEC CICS HANDLE CONDITION
 12821*         NOTFND  (1420-CONTINUE-DELETE)
 12822*    END-EXEC.
 12823*    MOVE '"$I                   ! 0 #00011861' TO DFHEIV0
 12824     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12826     MOVE X'3020233030303131383631' TO DFHEIV0(25:11)
 12827     CALL 'kxdfhei1' USING DFHEIV0
 12828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12829
 12830
 12831
 12832* EXEC CICS READ
 12833*        EQUAL
 12834*        DATASET   (FILE-ID-ERMAIL)
 12835*        SET       (ADDRESS OF MAILING-DATA)
 12836*        RIDFLD    (ELCERT-KEY)
 12837*        UPDATE
 12838*    END-EXEC.
 12839*    MOVE '&"S        EU         (   #00011865' TO DFHEIV0
 12840     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12841     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12842     MOVE X'2020233030303131383635' TO DFHEIV0(25:11)
 12843     CALL 'kxdfhei1' USING DFHEIV0,
 12844           FILE-ID-ERMAIL,
 12845           DFHEIV20,
 12846           DFHEIV99,
 12847           ELCERT-KEY,
 12848           DFHEIV99,
 12849           DFHEIV99,
 12850           DFHEIV99
 12851     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 235
* VP6311.cbl
 12852         DFHEIV20
 12853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12854
 12855
 12856     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12857     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12858     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12859
 12860     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12861
 12862
 12863* EXEC CICS DELETE
 12864*        DATASET   (FILE-ID-ERMAIL)
 12865*    END-EXEC.
 12866*    MOVE '&(                    &   #00011879' TO DFHEIV0
 12867     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12869     MOVE X'2020233030303131383739' TO DFHEIV0(25:11)
 12870     CALL 'kxdfhei1' USING DFHEIV0,
 12871           FILE-ID-ERMAIL,
 12872           DFHEIV99,
 12873           DFHEIV99,
 12874           DFHEIV99,
 12875           DFHEIV99
 12876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12877
 12878
 12879     GO TO 1420-CONTINUE-DELETE.
 12880
 12881 1410-REWRITE-CERT.
 12882     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12883     MOVE 'C'                      TO JP-RECORD-TYPE.
 12884     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12885     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12886
 12887
 12888* EXEC CICS REWRITE
 12889*         DATASET    (FILE-ID-ELCERT)
 12890*         FROM       (CERTIFICATE-MASTER)
 12891*         END-EXEC.
 12892     MOVE LENGTH OF
 12893      CERTIFICATE-MASTER
 12894       TO DFHEIV11
 12895*    MOVE '&& L                  %   #00011891' TO DFHEIV0
 12896     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12897     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12898     MOVE X'2020233030303131383931' TO DFHEIV0(25:11)
 12899     CALL 'kxdfhei1' USING DFHEIV0,
 12900           FILE-ID-ELCERT,
 12901           CERTIFICATE-MASTER,
 12902           DFHEIV11,
 12903           DFHEIV99
 12904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12905
 12906
 12907     PERFORM 8400-LOG-JOURNAL-RECORD.
 12908
 12909 1420-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 236
* VP6311.cbl
 12910     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12911     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12912
 12913     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12914     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12915
 12916     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12917
 12918 1450-DELETE-PB-RECORD.
 12919     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12920     MOVE 'D'                      TO JP-RECORD-TYPE
 12921     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12922
 12923
 12924* EXEC CICS DELETE
 12925*        DATASET    (FILE-ID-ERPNDB)
 12926*    END-EXEC.
 12927*    MOVE '&(                    &   #00011912' TO DFHEIV0
 12928     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12929     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12930     MOVE X'2020233030303131393132' TO DFHEIV0(25:11)
 12931     CALL 'kxdfhei1' USING DFHEIV0,
 12932           FILE-ID-ERPNDB,
 12933           DFHEIV99,
 12934           DFHEIV99,
 12935           DFHEIV99,
 12936           DFHEIV99
 12937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12938
 12939
 12940     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12941
 12942     PERFORM 8400-LOG-JOURNAL-RECORD.
 12943
 12944     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12945     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12946     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12947
 12948
 12949* EXEC CICS HANDLE CONDITION
 12950*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12951*    END-EXEC.
 12952*    MOVE '"$I                   ! 1 #00011924' TO DFHEIV0
 12953     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12954     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12955     MOVE X'3120233030303131393234' TO DFHEIV0(25:11)
 12956     CALL 'kxdfhei1' USING DFHEIV0
 12957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12958
 12959
 12960
 12961* EXEC CICS READ
 12962*        SET     (ADDRESS OF PENDING-BUSINESS)
 12963*        DATASET (FILE-ID-ERPNDB)
 12964*        RIDFLD  (ERPNDB-KEY)
 12965*        UPDATE
 12966*    END-EXEC.
 12967*    MOVE '&"S        EU         (   #00011928' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 237
* VP6311.cbl
 12968     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12969     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12970     MOVE X'2020233030303131393238' TO DFHEIV0(25:11)
 12971     CALL 'kxdfhei1' USING DFHEIV0,
 12972           FILE-ID-ERPNDB,
 12973           DFHEIV20,
 12974           DFHEIV99,
 12975           ERPNDB-KEY,
 12976           DFHEIV99,
 12977           DFHEIV99,
 12978           DFHEIV99
 12979     SET ADDRESS OF PENDING-BUSINESS TO
 12980         DFHEIV20
 12981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12982
 12983
 12984     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12985
 12986     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12987
 12988     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12989        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12990        MOVE 'D'                   TO JP-RECORD-TYPE
 12991        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12992
 12993* EXEC CICS DELETE
 12994*            DATASET    (FILE-ID-ERPNDB)
 12995*       END-EXEC
 12996*    MOVE '&(                    &   #00011943' TO DFHEIV0
 12997     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12998     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12999     MOVE X'2020233030303131393433' TO DFHEIV0(25:11)
 13000     CALL 'kxdfhei1' USING DFHEIV0,
 13001           FILE-ID-ERPNDB,
 13002           DFHEIV99,
 13003           DFHEIV99,
 13004           DFHEIV99,
 13005           DFHEIV99
 13006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13007        PERFORM 8400-LOG-JOURNAL-RECORD
 13008     ELSE
 13009        MOVE 'B'                 TO JP-RECORD-TYPE
 13010        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13011        PERFORM 8400-LOG-JOURNAL-RECORD
 13012        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13013        MOVE 'C'                 TO JP-RECORD-TYPE
 13014        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13015
 13016* EXEC CICS REWRITE
 13017*            DATASET    (FILE-ID-ERPNDB)
 13018*            FROM       (PENDING-BUSINESS)
 13019*       END-EXEC
 13020     MOVE LENGTH OF
 13021      PENDING-BUSINESS
 13022       TO DFHEIV11
 13023*    MOVE '&& L                  %   #00011954' TO DFHEIV0
 13024     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13025     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 238
* VP6311.cbl
 13026     MOVE X'2020233030303131393534' TO DFHEIV0(25:11)
 13027     CALL 'kxdfhei1' USING DFHEIV0,
 13028           FILE-ID-ERPNDB,
 13029           PENDING-BUSINESS,
 13030           DFHEIV11,
 13031           DFHEIV99
 13032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13033        PERFORM 8400-LOG-JOURNAL-RECORD.
 13034
 13035******************************************************************
 13036*                                                                *
 13037*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13038*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13039*                                                                *
 13040******************************************************************
 13041
 13042     IF NOT PI-AR-PROCESSING
 13043        GO TO 1475-DELETE-FINISHED.
 13044
 13045     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13046        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13047        NEXT SENTENCE
 13048     ELSE
 13049        GO TO 1475-DELETE-FINISHED.
 13050
 13051
 13052* EXEC CICS HANDLE CONDITION
 13053*         NOTFND    (1475-DELETE-FINISHED)
 13054*         END-EXEC.
 13055*    MOVE '"$I                   ! 2 #00011976' TO DFHEIV0
 13056     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13058     MOVE X'3220233030303131393736' TO DFHEIV0(25:11)
 13059     CALL 'kxdfhei1' USING DFHEIV0
 13060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13061
 13062
 13063     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13064     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13065
 13066
 13067* EXEC CICS READ
 13068*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13069*        DATASET (FILE-ID-ERRQST)
 13070*        RIDFLD  (ERRQST-KEY)
 13071*        UPDATE
 13072*    END-EXEC.
 13073*    MOVE '&"S        EU         (   #00011983' TO DFHEIV0
 13074     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13075     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13076     MOVE X'2020233030303131393833' TO DFHEIV0(25:11)
 13077     CALL 'kxdfhei1' USING DFHEIV0,
 13078           FILE-ID-ERRQST,
 13079           DFHEIV20,
 13080           DFHEIV99,
 13081           ERRQST-KEY,
 13082           DFHEIV99,
 13083           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 239
* VP6311.cbl
 13084           DFHEIV99
 13085     SET ADDRESS OF AR-REQUEST-RECORD TO
 13086         DFHEIV20
 13087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13088
 13089
 13090     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13091
 13092     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13093
 13094     MOVE 'D'                      TO JP-RECORD-TYPE.
 13095     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13096
 13097
 13098* EXEC CICS DELETE
 13099*         DATASET    (FILE-ID-ERRQST)
 13100*    END-EXEC.
 13101*    MOVE '&(                    &   #00011997' TO DFHEIV0
 13102     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13103     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13104     MOVE X'2020233030303131393937' TO DFHEIV0(25:11)
 13105     CALL 'kxdfhei1' USING DFHEIV0,
 13106           FILE-ID-ERRQST,
 13107           DFHEIV99,
 13108           DFHEIV99,
 13109           DFHEIV99,
 13110           DFHEIV99
 13111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13112
 13113
 13114     PERFORM 8400-LOG-JOURNAL-RECORD.
 13115
 13116 1475-DELETE-FINISHED.
 13117     MOVE ZEROS                  TO EMI-ERROR.
 13118     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13119     MOVE LOW-VALUES             TO VP631BI.
 13120     MOVE -1                     TO BMAINTL.
 13121     GO TO 8100-SEND-INITIAL-MAP.
 13122
 13123 1480-BATCH-HDR-NOT-FOUND.
 13124     MOVE -1                     TO BMAINTL.
 13125     MOVE ER-7450                TO EMI-ERROR.
 13126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13127     GO TO 8200-SEND-DATAONLY.
 13128
 13129 1490-RECORD-NOT-FOUND.
 13130     MOVE -1                     TO BMAINTL.
 13131     MOVE ER-7451                TO EMI-ERROR.
 13132     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13133     GO TO 8200-SEND-DATAONLY.
 13134
 13135******************************************************************
 13136*            O V E R   C H A R G E   P R O C E S S I N G         *
 13137******************************************************************
 13138 1500-UPDATE-ERNOTE.
 13139     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13140     MOVE 'A'                    TO WS-NOTE-SW
 13141     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 240
* VP6311.cbl
 13142     .
 13143 1500-EXIT.
 13144     EXIT.
 13145 1510-ADD-ERNOTE-REC.
 13146
 13147* EXEC CICS GETMAIN
 13148*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13149*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13150*        INITIMG (GETMAIN-SPACE)
 13151*    END-EXEC
 13152*    MOVE ',"IL                  $   #00012033' TO DFHEIV0
 13153     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13154     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13155     MOVE X'2020233030303132303333' TO DFHEIV0(25:11)
 13156     CALL 'kxdfhei1' USING DFHEIV0,
 13157           DFHEIV20,
 13158           ERNOTE-RECORD-LENGTH,
 13159           GETMAIN-SPACE
 13160     SET ADDRESS OF CERTIFICATE-NOTE TO
 13161         DFHEIV20
 13162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13163     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13164                                 TO ERNOTE-KEY
 13165
 13166* EXEC CICS READ
 13167*       DATASET    (FILE-ID-ERNOTE)
 13168*       RIDFLD     (ERNOTE-KEY)
 13169*       INTO       (CERTIFICATE-NOTE)
 13170*       RESP       (WS-RESPONSE)
 13171*       UPDATE
 13172*    END-EXEC
 13173     MOVE LENGTH OF
 13174      CERTIFICATE-NOTE
 13175       TO DFHEIV11
 13176*    MOVE '&"IL       EU         (  N#00012040' TO DFHEIV0
 13177     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13178     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13179     MOVE X'204E233030303132303430' TO DFHEIV0(25:11)
 13180     CALL 'kxdfhei1' USING DFHEIV0,
 13181           FILE-ID-ERNOTE,
 13182           CERTIFICATE-NOTE,
 13183           DFHEIV11,
 13184           ERNOTE-KEY,
 13185           DFHEIV99,
 13186           DFHEIV99,
 13187           DFHEIV99
 13188     MOVE EIBRESP  TO WS-RESPONSE
 13189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13190     IF RESP-NORMAL
 13191        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13192           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13193        END-IF
 13194        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13195           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13196        END-IF
 13197        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13198           (N1 > +10)
 13199           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 241
* VP6311.cbl
 13200           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13201        END-PERFORM
 13202        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13203          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13204
 13205* EXEC CICS UNLOCK
 13206*            DATASET    (FILE-ID-ERNOTE)
 13207*          END-EXEC
 13208*    MOVE '&*                    #   #00012061' TO DFHEIV0
 13209     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13210     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13211     MOVE X'2020233030303132303631' TO DFHEIV0(25:11)
 13212     CALL 'kxdfhei1' USING DFHEIV0,
 13213           FILE-ID-ERNOTE,
 13214           DFHEIV99
 13215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13216        ELSE
 13217          PERFORM VARYING N1 FROM +1 BY +1
 13218           UNTIL (N1 > +10)
 13219           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13220          END-PERFORM
 13221          IF (N1 < +11)
 13222            IF N1 >= CN-BILLING-START-LINE-NO AND
 13223              N1 <= CN-BILLING-END-LINE-NO
 13224              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13225                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13226              ELSE
 13227                 MOVE WS-VA-NO-COMM-MESS
 13228                                    TO CN-LINE (N1)
 13229              END-IF
 13230            ELSE
 13231              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13232               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13233                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13234                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13235                ELSE
 13236                  MOVE WS-VA-NO-COMM-MESS
 13237                                    TO CN-LINE (N1)
 13238                END-IF
 13239                MOVE N1             TO CN-BILLING-END-LINE-NO
 13240              ELSE
 13241                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13242                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13243                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13244                  ELSE
 13245                     MOVE WS-VA-NO-COMM-MESS
 13246                                    TO CN-LINE (N1)
 13247                  END-IF
 13248                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13249                                      CN-BILLING-START-LINE-NO
 13250                ELSE
 13251                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13252                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13253                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13254                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13255                     ELSE
 13256                       MOVE WS-VA-NO-COMM-MESS
 13257                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 242
* VP6311.cbl
 13258                     END-IF
 13259                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13260                  ELSE
 13261                     PERFORM 1700-SQUEEZE-IT-IN
 13262                                 THRU 1700-EXIT
 13263                  END-IF
 13264                END-IF
 13265              END-IF
 13266            END-IF
 13267            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13268            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13269            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13270
 13271* EXEC CICS REWRITE
 13272*              DATASET    (FILE-ID-ERNOTE)
 13273*              FROM       (CERTIFICATE-NOTE)
 13274*              RESP       (WS-RESPONSE)
 13275*           END-EXEC
 13276     MOVE LENGTH OF
 13277      CERTIFICATE-NOTE
 13278       TO DFHEIV11
 13279*    MOVE '&& L                  %  N#00012118' TO DFHEIV0
 13280     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13281     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13282     MOVE X'204E233030303132313138' TO DFHEIV0(25:11)
 13283     CALL 'kxdfhei1' USING DFHEIV0,
 13284           FILE-ID-ERNOTE,
 13285           CERTIFICATE-NOTE,
 13286           DFHEIV11,
 13287           DFHEIV99
 13288     MOVE EIBRESP  TO WS-RESPONSE
 13289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13290          END-IF
 13291        END-IF
 13292     ELSE
 13293        MOVE SPACES              TO CERTIFICATE-NOTE
 13294        MOVE 'CN'                TO CN-RECORD-ID
 13295        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13296                                 TO CN-CONTROL-PRIMARY
 13297                                    ERNOTE-KEY
 13298        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13299                                    CN-BILLING-END-LINE-NO
 13300        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13301           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13302        ELSE
 13303           MOVE WS-VA-NO-COMM-MESS
 13304                                 TO CN-LINE (1)
 13305        END-IF
 13306        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13307        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13308        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13309
 13310* EXEC CICS WRITE
 13311*          DATASET    (FILE-ID-ERNOTE)
 13312*          FROM       (CERTIFICATE-NOTE)
 13313*          RIDFLD     (ERNOTE-KEY)
 13314*          RESP       (WS-RESPONSE)
 13315*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 243
* VP6311.cbl
 13316     MOVE LENGTH OF
 13317      CERTIFICATE-NOTE
 13318       TO DFHEIV11
 13319*    MOVE '&$ L                  ''  N#00012142' TO DFHEIV0
 13320     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13321     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13322     MOVE X'204E233030303132313432' TO DFHEIV0(25:11)
 13323     CALL 'kxdfhei1' USING DFHEIV0,
 13324           FILE-ID-ERNOTE,
 13325           CERTIFICATE-NOTE,
 13326           DFHEIV11,
 13327           ERNOTE-KEY,
 13328           DFHEIV99,
 13329           DFHEIV99
 13330     MOVE EIBRESP  TO WS-RESPONSE
 13331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13332     END-IF
 13333     .
 13334 1510-EXIT.
 13335     EXIT.
 13336 1520-UPDATE-ELCERT.
 13337     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13338                                 TO ELCERT-KEY
 13339
 13340* EXEC CICS READ
 13341*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13342*        DATASET (FILE-ID-ELCERT)
 13343*        RIDFLD  (ELCERT-KEY)
 13344*        UPDATE
 13345*        RESP    (WS-RESPONSE)
 13346*    END-EXEC
 13347*    MOVE '&"S        EU         (  N#00012155' TO DFHEIV0
 13348     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13349     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13350     MOVE X'204E233030303132313535' TO DFHEIV0(25:11)
 13351     CALL 'kxdfhei1' USING DFHEIV0,
 13352           FILE-ID-ELCERT,
 13353           DFHEIV20,
 13354           DFHEIV99,
 13355           ELCERT-KEY,
 13356           DFHEIV99,
 13357           DFHEIV99,
 13358           DFHEIV99
 13359     SET ADDRESS OF CERTIFICATE-MASTER TO
 13360         DFHEIV20
 13361     MOVE EIBRESP  TO WS-RESPONSE
 13362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13363     IF RESP-NORMAL
 13364        IF WS-NOTE-SW = 'A'
 13365           IF CM-NOTE-SW = ' '
 13366              MOVE '2'             TO CM-NOTE-SW
 13367           ELSE
 13368             IF CM-NOTE-SW = '1'
 13369                MOVE '3'           TO CM-NOTE-SW
 13370             ELSE
 13371               IF CM-NOTE-SW = '4'
 13372                  MOVE '6'         TO CM-NOTE-SW
 13373               ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 244
* VP6311.cbl
 13374                 IF CM-NOTE-SW = '5'
 13375                    MOVE '7'       TO CM-NOTE-SW
 13376                 END-IF
 13377               END-IF
 13378             END-IF
 13379           END-IF
 13380        ELSE
 13381           IF CM-NOTE-SW = '2'
 13382              MOVE ' '             TO CM-NOTE-SW
 13383           ELSE
 13384             IF CM-NOTE-SW = '3'
 13385                MOVE '1'           TO CM-NOTE-SW
 13386             ELSE
 13387               IF CM-NOTE-SW = '6'
 13388                  MOVE '4'         TO CM-NOTE-SW
 13389               ELSE
 13390                 IF CM-NOTE-SW = '7'
 13391                    MOVE '5'       TO CM-NOTE-SW
 13392                 END-IF
 13393               END-IF
 13394             END-IF
 13395           END-IF
 13396        END-IF
 13397
 13398* EXEC CICS REWRITE
 13399*          DATASET    (FILE-ID-ELCERT)
 13400*          FROM       (CERTIFICATE-MASTER)
 13401*          RESP       (WS-RESPONSE)
 13402*       END-EXEC
 13403     MOVE LENGTH OF
 13404      CERTIFICATE-MASTER
 13405       TO DFHEIV11
 13406*    MOVE '&& L                  %  N#00012196' TO DFHEIV0
 13407     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13408     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13409     MOVE X'204E233030303132313936' TO DFHEIV0(25:11)
 13410     CALL 'kxdfhei1' USING DFHEIV0,
 13411           FILE-ID-ELCERT,
 13412           CERTIFICATE-MASTER,
 13413           DFHEIV11,
 13414           DFHEIV99
 13415     MOVE EIBRESP  TO WS-RESPONSE
 13416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13417        IF RESP-NORMAL
 13418           CONTINUE
 13419        ELSE
 13420           MOVE WS-RESPONSE TO EMI-ERROR
 13421           PERFORM 9900-ERROR-FORMAT
 13422                                 THRU 9900-EXIT
 13423           GO TO 8200-SEND-DATAONLY
 13424        END-IF
 13425     ELSE
 13426        MOVE -1                  TO BMAINTL
 13427        MOVE 0249                TO EMI-ERROR
 13428        PERFORM 9900-ERROR-FORMAT
 13429                                 THRU 9900-EXIT
 13430        GO TO 8200-SEND-DATAONLY
 13431     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 245
* VP6311.cbl
 13432     .
 13433 1520-EXIT.
 13434     EXIT.
 13435 1600-UPDATE-ERPYAJ.
 13436     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13437                                 THRU 1610-EXIT
 13438     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13439                                 THRU 1620-EXIT
 13440     .
 13441 1600-EXIT.
 13442     EXIT.
 13443 1610-ADD-ERPYAJ-BANK-REC.
 13444
 13445* EXEC CICS GETMAIN
 13446*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13447*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13448*        INITIMG (GETMAIN-SPACE)
 13449*    END-EXEC
 13450*    MOVE ',"IL                  $   #00012228' TO DFHEIV0
 13451     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13452     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13453     MOVE X'2020233030303132323238' TO DFHEIV0(25:11)
 13454     CALL 'kxdfhei1' USING DFHEIV0,
 13455           DFHEIV20,
 13456           ERPYAJ-RECORD-LENGTH,
 13457           GETMAIN-SPACE
 13458     SET ADDRESS OF PENDING-PAY-ADJ TO
 13459         DFHEIV20
 13460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13461     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13462     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13463     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13464     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13465     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13466     MOVE +10                    TO ERPYAJ-SEQ-NO
 13467     MOVE 'R'                    TO ERPYAJ-TYPE
 13468     IF REVERSAL
 13469        MOVE 'C'                 TO ERPYAJ-TYPE
 13470     END-IF
 13471     MOVE SPACES                 TO PENDING-PAY-ADJ
 13472     MOVE 'PY'                   TO PY-RECORD-ID
 13473     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13474     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13475     IF REVERSAL
 13476        MOVE PB-I-DCC-OVER-CHG-AMT
 13477                                 TO PY-ENTRY-AMT
 13478     END-IF
 13479     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13480                                    PY-INPUT-DT
 13481*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13482*                                   PY-INPUT-DT
 13483     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13484     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13485     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13486     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13487     IF PB-CARRIER = '2'
 13488        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13489     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 246
* VP6311.cbl
 13490        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13491     END-IF
 13492     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13493                                    PY-BILLED-DATE
 13494                                    PY-AR-DATE
 13495                                    PY-REPORTED-DT
 13496                                    PY-CHECK-WRITTEN-DT
 13497     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13498                                    PY-CHECK-QUE-SEQUENCE
 13499     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13500     PERFORM WITH TEST AFTER
 13501        UNTIL (NOT RESP-DUPKEY)
 13502           AND (NOT RESP-DUPREC)
 13503
 13504* EXEC CICS WRITE
 13505*          DATASET    (FILE-ID-ERPYAJ)
 13506*          FROM       (PENDING-PAY-ADJ)
 13507*          RIDFLD     (ERPYAJ-KEY)
 13508*          RESP       (WS-RESPONSE)
 13509*       END-EXEC
 13510     MOVE LENGTH OF
 13511      PENDING-PAY-ADJ
 13512       TO DFHEIV11
 13513*    MOVE '&$ L                  ''  N#00012275' TO DFHEIV0
 13514     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13515     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13516     MOVE X'204E233030303132323735' TO DFHEIV0(25:11)
 13517     CALL 'kxdfhei1' USING DFHEIV0,
 13518           FILE-ID-ERPYAJ,
 13519           PENDING-PAY-ADJ,
 13520           DFHEIV11,
 13521           ERPYAJ-KEY,
 13522           DFHEIV99,
 13523           DFHEIV99
 13524     MOVE EIBRESP  TO WS-RESPONSE
 13525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13526        IF RESP-DUPKEY OR RESP-DUPREC
 13527           ADD +1                TO ERPYAJ-SEQ-NO
 13528           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13529        END-IF
 13530     END-PERFORM
 13531     .
 13532 1610-EXIT.
 13533     EXIT.
 13534 1620-ADD-ERPYAJ-DLR-REC.
 13535     MOVE 'C'                    TO ERPYAJ-TYPE
 13536     IF REVERSAL
 13537        MOVE 'R'                 TO ERPYAJ-TYPE
 13538     END-IF
 13539     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13540                                    ERPYAJ-ACCOUNT
 13541     ADD +1                      TO ERPYAJ-SEQ-NO
 13542     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13543     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13544     IF PB-CARRIER = '2'
 13545        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13546     ELSE
 13547        MOVE '2725040130'        TO PY-GL-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 247
* VP6311.cbl
 13548     END-IF
 13549     PERFORM WITH TEST AFTER
 13550        UNTIL (NOT RESP-DUPKEY)
 13551           AND (NOT RESP-DUPREC)
 13552
 13553* EXEC CICS WRITE
 13554*          DATASET    (FILE-ID-ERPYAJ)
 13555*          FROM       (PENDING-PAY-ADJ)
 13556*          RIDFLD     (ERPYAJ-KEY)
 13557*          RESP       (WS-RESPONSE)
 13558*       END-EXEC
 13559     MOVE LENGTH OF
 13560      PENDING-PAY-ADJ
 13561       TO DFHEIV11
 13562*    MOVE '&$ L                  ''  N#00012307' TO DFHEIV0
 13563     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13565     MOVE X'204E233030303132333037' TO DFHEIV0(25:11)
 13566     CALL 'kxdfhei1' USING DFHEIV0,
 13567           FILE-ID-ERPYAJ,
 13568           PENDING-PAY-ADJ,
 13569           DFHEIV11,
 13570           ERPYAJ-KEY,
 13571           DFHEIV99,
 13572           DFHEIV99
 13573     MOVE EIBRESP  TO WS-RESPONSE
 13574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13575        IF RESP-DUPKEY OR RESP-DUPREC
 13576           ADD +1                TO ERPYAJ-SEQ-NO
 13577           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13578        END-IF
 13579     END-PERFORM
 13580     .
 13581 1620-EXIT.
 13582     EXIT.
 13583 1700-SQUEEZE-IT-IN.
 13584     IF (N1 > CN-BILLING-END-LINE-NO)
 13585        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13586           N1 = +1
 13587           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13588           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13589              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13590                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13591              ELSE
 13592                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13593              END-IF
 13594              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13595              MOVE +2 TO N1
 13596           END-IF
 13597        END-PERFORM
 13598     ELSE
 13599        IF (N1 < CN-BILLING-START-LINE-NO)
 13600           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13601              N1 = +10
 13602              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13603              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13604                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13605                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 248
* VP6311.cbl
 13606                 ELSE
 13607                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13608                 END-IF
 13609                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13610                 MOVE +9 TO N1
 13611              END-IF
 13612           END-PERFORM
 13613        END-IF
 13614     END-IF
 13615     .
 13616 1700-EXIT.
 13617     EXIT.
 13618 1800-REMOVE-CERT-NOTES.
 13619     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13620                                 TO ERNOTE-KEY
 13621
 13622* EXEC CICS READ
 13623*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13624*       DATASET    (FILE-ID-ERNOTE)
 13625*       RIDFLD     (ERNOTE-KEY)
 13626*       RESP       (WS-RESPONSE)
 13627*       UPDATE
 13628*    END-EXEC
 13629*    MOVE '&"S        EU         (  N#00012359' TO DFHEIV0
 13630     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13631     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13632     MOVE X'204E233030303132333539' TO DFHEIV0(25:11)
 13633     CALL 'kxdfhei1' USING DFHEIV0,
 13634           FILE-ID-ERNOTE,
 13635           DFHEIV20,
 13636           DFHEIV99,
 13637           ERNOTE-KEY,
 13638           DFHEIV99,
 13639           DFHEIV99,
 13640           DFHEIV99
 13641     SET ADDRESS OF CERTIFICATE-NOTE TO
 13642         DFHEIV20
 13643     MOVE EIBRESP  TO WS-RESPONSE
 13644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13645     IF RESP-NORMAL
 13646        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13647           (N1 > +10)
 13648           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13649           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13650        END-PERFORM
 13651        IF N1 < +11
 13652           MOVE SPACES              TO CN-LINE (N1)
 13653           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13654              N1 <= CN-BILLING-END-LINE-NO
 13655              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13656              IF CN-BILLING-END-LINE-NO <
 13657                               CN-BILLING-START-LINE-NO
 13658                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13659                                     CN-BILLING-START-LINE-NO
 13660              END-IF
 13661              PERFORM 1820-SQUEEZE-ERNOTE
 13662                                  THRU 1820-EXIT
 13663           END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 249
* VP6311.cbl
 13664           IF CN-LINES = SPACES
 13665
 13666* EXEC CICS DELETE
 13667*                DATASET    (FILE-ID-ERNOTE)
 13668*                RESP       (WS-RESPONSE)
 13669*             END-EXEC
 13670*    MOVE '&(                    &  N#00012386' TO DFHEIV0
 13671     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13672     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13673     MOVE X'204E233030303132333836' TO DFHEIV0(25:11)
 13674     CALL 'kxdfhei1' USING DFHEIV0,
 13675           FILE-ID-ERNOTE,
 13676           DFHEIV99,
 13677           DFHEIV99,
 13678           DFHEIV99,
 13679           DFHEIV99
 13680     MOVE EIBRESP  TO WS-RESPONSE
 13681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13682              IF RESP-NORMAL
 13683                 MOVE 'D'        TO WS-NOTE-SW
 13684                 PERFORM 1520-UPDATE-ELCERT
 13685                                 THRU 1520-EXIT
 13686              END-IF
 13687           ELSE
 13688
 13689* EXEC CICS REWRITE
 13690*                DATASET    (FILE-ID-ERNOTE)
 13691*                FROM       (CERTIFICATE-NOTE)
 13692*                RESP       (WS-RESPONSE)
 13693*             END-EXEC
 13694     MOVE LENGTH OF
 13695      CERTIFICATE-NOTE
 13696       TO DFHEIV11
 13697*    MOVE '&& L                  %  N#00012396' TO DFHEIV0
 13698     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13699     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13700     MOVE X'204E233030303132333936' TO DFHEIV0(25:11)
 13701     CALL 'kxdfhei1' USING DFHEIV0,
 13702           FILE-ID-ERNOTE,
 13703           CERTIFICATE-NOTE,
 13704           DFHEIV11,
 13705           DFHEIV99
 13706     MOVE EIBRESP  TO WS-RESPONSE
 13707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13708           END-IF
 13709        END-IF
 13710     END-IF
 13711     .
 13712 1800-EXIT.
 13713     EXIT.
 13714 1820-SQUEEZE-ERNOTE.
 13715     MOVE CN-BILLING-START-LINE-NO TO N2
 13716     IF N2 = 0
 13717         MOVE +1                 TO N2
 13718     END-IF
 13719     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13720        (N1 > +9)
 13721        IF CN-LINE (N1) = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 250
* VP6311.cbl
 13722           MOVE CN-LINE (N1 + +1)
 13723                                 TO CN-LINE (N1)
 13724           MOVE SPACES           TO CN-LINE (N1 + +1)
 13725        END-IF
 13726     END-PERFORM
 13727     .
 13728 1820-EXIT.
 13729     EXIT.
 13730 1900-DELETE-ERPYAJ.
 13731     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13732     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13733     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13734     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13735     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13736     MOVE +10                    TO ERPYAJ-SEQ-NO
 13737     MOVE 'R'                    TO ERPYAJ-TYPE
 13738     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13739
 13740* EXEC CICS STARTBR
 13741*       DATASET    (FILE-ID-ERPYAJ)
 13742*       RIDFLD     (ERPYAJ-KEY)
 13743*       RESP       (WS-RESPONSE)
 13744*    END-EXEC
 13745     MOVE 0
 13746       TO DFHEIV11
 13747*    MOVE '&,         G          &  N#00012432' TO DFHEIV0
 13748     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13749     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13750     MOVE X'204E233030303132343332' TO DFHEIV0(25:11)
 13751     CALL 'kxdfhei1' USING DFHEIV0,
 13752           FILE-ID-ERPYAJ,
 13753           ERPYAJ-KEY,
 13754           DFHEIV99,
 13755           DFHEIV11,
 13756           DFHEIV99
 13757     MOVE EIBRESP  TO WS-RESPONSE
 13758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13759     IF RESP-NORMAL
 13760        CONTINUE
 13761     ELSE
 13762        GO TO 1900-GET-DEALER
 13763     END-IF
 13764     .
 13765 1900-READNEXT-ERPYAJ-B.
 13766*  GET THE BANK ERPYAJ RECORD
 13767
 13768* EXEC CICS READNEXT
 13769*       DATASET    (FILE-ID-ERPYAJ)
 13770*       RIDFLD     (ERPYAJ-KEY)
 13771*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13772*       RESP       (WS-RESPONSE)
 13773*    END-EXEC
 13774     MOVE 0
 13775       TO DFHEIV11
 13776*    MOVE '&.S                   )  N#00012445' TO DFHEIV0
 13777     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13778     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13779     MOVE X'204E233030303132343435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 251
* VP6311.cbl
 13780     CALL 'kxdfhei1' USING DFHEIV0,
 13781           FILE-ID-ERPYAJ,
 13782           DFHEIV20,
 13783           DFHEIV99,
 13784           ERPYAJ-KEY,
 13785           DFHEIV99,
 13786           DFHEIV11,
 13787           DFHEIV99,
 13788           DFHEIV99
 13789     SET ADDRESS OF PENDING-PAY-ADJ TO
 13790         DFHEIV20
 13791     MOVE EIBRESP  TO WS-RESPONSE
 13792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13793     IF RESP-NORMAL
 13794        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13795           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13796              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13797                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13798
 13799* EXEC CICS READ
 13800*                   DATASET    (FILE-ID-ERPYAJ)
 13801*                   RIDFLD     (ERPYAJ-KEY)
 13802*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13803*                   RESP       (WS-RESPONSE)
 13804*                   UPDATE
 13805*                END-EXEC
 13806*    MOVE '&"S        EU         (  N#00012456' TO DFHEIV0
 13807     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13808     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13809     MOVE X'204E233030303132343536' TO DFHEIV0(25:11)
 13810     CALL 'kxdfhei1' USING DFHEIV0,
 13811           FILE-ID-ERPYAJ,
 13812           DFHEIV20,
 13813           DFHEIV99,
 13814           ERPYAJ-KEY,
 13815           DFHEIV99,
 13816           DFHEIV99,
 13817           DFHEIV99
 13818     SET ADDRESS OF PENDING-PAY-ADJ TO
 13819         DFHEIV20
 13820     MOVE EIBRESP  TO WS-RESPONSE
 13821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13822                 IF RESP-NORMAL
 13823
 13824* EXEC CICS DELETE
 13825*                      DATASET   (FILE-ID-ERPYAJ)
 13826*                      RESP      (WS-RESPONSE)
 13827*                   END-EXEC
 13828*    MOVE '&(                    &  N#00012464' TO DFHEIV0
 13829     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13830     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13831     MOVE X'204E233030303132343634' TO DFHEIV0(25:11)
 13832     CALL 'kxdfhei1' USING DFHEIV0,
 13833           FILE-ID-ERPYAJ,
 13834           DFHEIV99,
 13835           DFHEIV99,
 13836           DFHEIV99,
 13837           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 252
* VP6311.cbl
 13838     MOVE EIBRESP  TO WS-RESPONSE
 13839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13840                 END-IF
 13841              ELSE
 13842                 SET REVERSAL    TO TRUE
 13843                 PERFORM 1600-UPDATE-ERPYAJ
 13844                                 THRU 1600-EXIT
 13845                 GO TO 1900-EXIT
 13846              END-IF
 13847           ELSE
 13848              GO TO 1900-READNEXT-ERPYAJ-B
 13849           END-IF
 13850        END-IF
 13851
 13852* EXEC CICS ENDBR
 13853*          DATASET   (FILE-ID-ERPYAJ)
 13854*       END-EXEC
 13855     MOVE 0
 13856       TO DFHEIV11
 13857*    MOVE '&2                    $   #00012479' TO DFHEIV0
 13858     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13859     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13860     MOVE X'2020233030303132343739' TO DFHEIV0(25:11)
 13861     CALL 'kxdfhei1' USING DFHEIV0,
 13862           FILE-ID-ERPYAJ,
 13863           DFHEIV11,
 13864           DFHEIV99
 13865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13866     END-IF
 13867     .
 13868 1900-GET-DEALER.
 13869     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13870     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13871     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13872     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13873     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13874     MOVE +10                    TO ERPYAJ-SEQ-NO
 13875     MOVE 'C'                    TO ERPYAJ-TYPE
 13876     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13877
 13878* EXEC CICS STARTBR
 13879*       DATASET    (FILE-ID-ERPYAJ)
 13880*       RIDFLD     (ERPYAJ-KEY)
 13881*       RESP       (WS-RESPONSE)
 13882*    END-EXEC
 13883     MOVE 0
 13884       TO DFHEIV11
 13885*    MOVE '&,         G          &  N#00012493' TO DFHEIV0
 13886     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13887     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13888     MOVE X'204E233030303132343933' TO DFHEIV0(25:11)
 13889     CALL 'kxdfhei1' USING DFHEIV0,
 13890           FILE-ID-ERPYAJ,
 13891           ERPYAJ-KEY,
 13892           DFHEIV99,
 13893           DFHEIV11,
 13894           DFHEIV99
 13895     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 253
* VP6311.cbl
 13896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13897     IF RESP-NORMAL
 13898        CONTINUE
 13899     ELSE
 13900        GO TO 1900-EXIT
 13901     END-IF
 13902     .
 13903 1900-READNEXT-ERPYAJ-D.
 13904*  GET THE DEALER ERPYAJ RECORD
 13905
 13906* EXEC CICS READNEXT
 13907*       DATASET    (FILE-ID-ERPYAJ)
 13908*       RIDFLD     (ERPYAJ-KEY)
 13909*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13910*       RESP       (WS-RESPONSE)
 13911*    END-EXEC
 13912     MOVE 0
 13913       TO DFHEIV11
 13914*    MOVE '&.S                   )  N#00012506' TO DFHEIV0
 13915     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13916     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13917     MOVE X'204E233030303132353036' TO DFHEIV0(25:11)
 13918     CALL 'kxdfhei1' USING DFHEIV0,
 13919           FILE-ID-ERPYAJ,
 13920           DFHEIV20,
 13921           DFHEIV99,
 13922           ERPYAJ-KEY,
 13923           DFHEIV99,
 13924           DFHEIV11,
 13925           DFHEIV99,
 13926           DFHEIV99
 13927     SET ADDRESS OF PENDING-PAY-ADJ TO
 13928         DFHEIV20
 13929     MOVE EIBRESP  TO WS-RESPONSE
 13930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13931     IF RESP-NORMAL
 13932        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13933           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13934              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13935                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13936
 13937* EXEC CICS READ
 13938*                   DATASET    (FILE-ID-ERPYAJ)
 13939*                   RIDFLD     (ERPYAJ-KEY)
 13940*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13941*                   RESP       (WS-RESPONSE)
 13942*                   UPDATE
 13943*                END-EXEC
 13944*    MOVE '&"S        EU         (  N#00012517' TO DFHEIV0
 13945     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13946     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13947     MOVE X'204E233030303132353137' TO DFHEIV0(25:11)
 13948     CALL 'kxdfhei1' USING DFHEIV0,
 13949           FILE-ID-ERPYAJ,
 13950           DFHEIV20,
 13951           DFHEIV99,
 13952           ERPYAJ-KEY,
 13953           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 254
* VP6311.cbl
 13954           DFHEIV99,
 13955           DFHEIV99
 13956     SET ADDRESS OF PENDING-PAY-ADJ TO
 13957         DFHEIV20
 13958     MOVE EIBRESP  TO WS-RESPONSE
 13959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13960                 IF RESP-NORMAL
 13961
 13962* EXEC CICS DELETE
 13963*                      DATASET   (FILE-ID-ERPYAJ)
 13964*                      RESP      (WS-RESPONSE)
 13965*                   END-EXEC
 13966*    MOVE '&(                    &  N#00012525' TO DFHEIV0
 13967     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13968     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13969     MOVE X'204E233030303132353235' TO DFHEIV0(25:11)
 13970     CALL 'kxdfhei1' USING DFHEIV0,
 13971           FILE-ID-ERPYAJ,
 13972           DFHEIV99,
 13973           DFHEIV99,
 13974           DFHEIV99,
 13975           DFHEIV99
 13976     MOVE EIBRESP  TO WS-RESPONSE
 13977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13978                 END-IF
 13979              ELSE
 13980                 SET REVERSAL    TO TRUE
 13981              END-IF
 13982           ELSE
 13983              GO TO 1900-READNEXT-ERPYAJ-D
 13984           END-IF
 13985        END-IF
 13986
 13987* EXEC CICS ENDBR
 13988*          DATASET   (FILE-ID-ERPYAJ)
 13989*       END-EXEC
 13990     MOVE 0
 13991       TO DFHEIV11
 13992*    MOVE '&2                    $   #00012537' TO DFHEIV0
 13993     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13994     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13995     MOVE X'2020233030303132353337' TO DFHEIV0(25:11)
 13996     CALL 'kxdfhei1' USING DFHEIV0,
 13997           FILE-ID-ERPYAJ,
 13998           DFHEIV11,
 13999           DFHEIV99
 14000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14001     END-IF
 14002     .
 14003 1900-EXIT.
 14004     EXIT.
 14005******************************************************************
 14006*            C A N C E L   M A I N L I N E                       *
 14007******************************************************************
 14008
 14009 2000-CANCEL-MAINLINE.
 14010     IF PI-DISPLAY-ORIGINAL-BATCH
 14011        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 255
* VP6311.cbl
 14012           MOVE ER-0023             TO EMI-ERROR
 14013           MOVE -1                  TO CMAINTL
 14014           MOVE AL-UABON            TO CMAINTA
 14015           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14016           GO TO 8200-SEND-DATAONLY
 14017        ELSE
 14018           NEXT SENTENCE
 14019     ELSE
 14020        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14021           MOVE ER-0023             TO EMI-ERROR
 14022           MOVE -1                  TO CMAINTL
 14023           MOVE AL-UABON            TO CMAINTA
 14024           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14025           GO TO 8200-SEND-DATAONLY.
 14026
 14027     IF CMAINTI = 'S'
 14028        GO TO 2100-SHOW-REQUEST.
 14029
 14030     IF NOT MODIFY-CAP
 14031         MOVE 'UPDATE'       TO SM-READ
 14032         PERFORM 9995-SECURITY-VIOLATION
 14033         MOVE ER-0070        TO EMI-ERROR
 14034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14035         GO TO 8100-SEND-INITIAL-MAP.
 14036
 14037     IF CMAINTL GREATER THAN ZEROS
 14038        IF PI-PF6-FUNCTION
 14039           IF CMAINTI NOT = 'A'
 14040              MOVE AL-UABON  TO CMAINTA
 14041              MOVE -1        TO CMAINTL
 14042              MOVE ER-2260   TO EMI-ERROR
 14043              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14044              GO TO 8200-SEND-DATAONLY.
 14045
 14046     IF CCERTNOL = ZEROS
 14047       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14048         NEXT SENTENCE
 14049     ELSE
 14050         IF CCERTNOL NOT = ZEROS
 14051             MOVE AL-UANON       TO CCERTNOA
 14052         ELSE
 14053             MOVE -1             TO CCERTNOL
 14054             MOVE  1             TO SET-CURSOR-SW
 14055             MOVE ER-2218       TO EMI-ERROR
 14056             MOVE AL-UABON       TO CCERTNOA
 14057             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14058
 14059     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14060        NEXT SENTENCE
 14061     ELSE
 14062        IF CEFFDTL NOT = ZEROS
 14063           MOVE AL-UNNON         TO CEFFDTA
 14064           MOVE CEFFDTI TO DEEDIT-FIELD
 14065           PERFORM 8600-DEEDIT
 14066           MOVE 4                TO DC-OPTION-CODE
 14067           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14068           PERFORM 9700-DATE-LINK
 14069           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 256
* VP6311.cbl
 14070              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14071              ELSE
 14072              MOVE -1            TO CEFFDTL
 14073              MOVE  1            TO SET-CURSOR-SW
 14074              MOVE ER-2226      TO EMI-ERROR
 14075              MOVE AL-UNBON      TO CEFFDTA
 14076              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14077          ELSE
 14078          MOVE -1                 TO CEFFDTL
 14079          MOVE  1                 TO SET-CURSOR-SW
 14080          MOVE ER-2220            TO EMI-ERROR
 14081          MOVE AL-UNBON           TO CEFFDTA
 14082          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14083
 14084     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14085
 14086     IF CCERTNOL NOT = ZEROS
 14087        MOVE CCERTNOI                TO WS-NEW-PRIME
 14088     ELSE
 14089        MOVE SPACES                  TO WS-NEW-PRIME.
 14090
 14091     IF CSUFIXL NOT = ZEROS
 14092        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14093     ELSE
 14094        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14095
 14096     IF CEFFDTL NOT = ZEROS
 14097        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14098     ELSE
 14099        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14100
 14101     IF CMAINTI = 'A' OR 'K' OR 'S'
 14102        NEXT SENTENCE
 14103     ELSE
 14104        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14105        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14106           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14107           WS-PB-RECORD-TYPE NOT = '2'
 14108           IF CMAINTI = 'C'
 14109              MOVE ER-2287          TO EMI-ERROR
 14110              MOVE -1               TO CCERTNOL
 14111              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14112              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14113              GO TO 8200-SEND-DATAONLY
 14114             ELSE
 14115              MOVE ER-2260          TO EMI-ERROR
 14116              MOVE -1               TO CCERTNOL
 14117              MOVE AL-UABON         TO CCERTNOA
 14118              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14119              GO TO 8200-SEND-DATAONLY.
 14120
 14121     IF CMAINTI = 'D'
 14122        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14123
 14124     IF CLSTNML GREATER THAN ZEROS
 14125         MOVE AL-UANON           TO CLSTNMA.
 14126
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 257
* VP6311.cbl
 14128
 14129******************************************************************
 14130*                                                                *
 14131*           E D I T   C A N C E L   C O V E R A G E S            *
 14132*                                                                *
 14133******************************************************************
 14134
 14135 2015-EDIT-COVERAGES.
 14136     IF CCANDT1L      GREATER THAN ZEROS OR
 14137        CREFND1L      GREATER THAN ZEROS OR
 14138        CCANDT2L      GREATER THAN ZEROS OR
 14139        CREFND2L      GREATER THAN ZEROS OR
 14140        CMTHD1L       GREATER THAN ZEROS OR
 14141        CMTHD2L       GREATER THAN ZEROS OR
 14142        CLIVESL       GREATER THAN ZEROS OR
 14143        CPAYEEL       GREATER THAN ZEROS OR
 14144        CFORCEL       GREATER THAN ZEROS OR
 14145        CBILCDL       GREATER THAN ZEROS OR
 14146        CCANREAL      GREATER THAN ZEROS
 14147            NEXT SENTENCE
 14148         ELSE
 14149            GO TO 2030-EDIT-COMPLETE.
 14150
 14151     IF CCANDT1L = ZEROS
 14152        AND (CMAINTI = 'C' OR 'K')
 14153        NEXT SENTENCE
 14154     ELSE
 14155        IF CCANDT1L      GREATER THAN ZEROS
 14156            MOVE AL-UNNON            TO CCANDT1A
 14157            IF CCANDT1I = SPACES
 14158               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14159            ELSE
 14160               MOVE CCANDT1I            TO DEEDIT-FIELD
 14161               PERFORM 8600-DEEDIT
 14162               IF DEEDIT-FIELD-V0   NUMERIC
 14163                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14164                  MOVE 4                TO DC-OPTION-CODE
 14165                  PERFORM 9700-DATE-LINK
 14166                  IF NO-CONVERSION-ERROR
 14167                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14168                  ELSE
 14169                      MOVE -1        TO CCANDT1L
 14170                      MOVE ER-2227   TO EMI-ERROR
 14171                      MOVE AL-UNBON  TO CCANDT1A
 14172                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14173               ELSE
 14174                  MOVE -1         TO CCANDT1L
 14175                  MOVE ER-2223    TO EMI-ERROR
 14176                  MOVE AL-UNBON   TO CCANDT1A
 14177                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14178        ELSE
 14179            IF CREFND1L GREATER THAN ZEROS
 14180               MOVE -1             TO CCANDT1L
 14181               MOVE ER-2222        TO EMI-ERROR
 14182               MOVE AL-UNBOF       TO CCANDT1A
 14183               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14184
 14185     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 258
* VP6311.cbl
 14186        AND (CMAINTI = 'C' OR 'K')
 14187         NEXT SENTENCE
 14188     ELSE
 14189         IF CREFND1L NOT = ZEROS
 14190            MOVE AL-UNNON        TO CREFND1A
 14191
 14192* EXEC CICS BIF DEEDIT
 14193*               FIELD  (CREFND1I)
 14194*               LENGTH (11)
 14195*           END-EXEC
 14196     MOVE 11
 14197       TO DFHEIV11
 14198*    MOVE '@"L                   #   #00012730' TO DFHEIV0
 14199     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14200     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14201     MOVE X'2020233030303132373330' TO DFHEIV0(25:11)
 14202     CALL 'kxdfhei1' USING DFHEIV0,
 14203           CREFND1I,
 14204           DFHEIV11
 14205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14206            MOVE CREFND1I        TO WS-CREFND1
 14207*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14208*           PERFORM 8600-DEEDIT
 14209*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14210            IF WS-CREFND1  = ZEROS
 14211               AND CMAINTI = 'A'
 14212             MOVE ER-2437        TO EMI-ERROR
 14213             MOVE -1             TO CREFND1L
 14214             MOVE AL-UNBON       TO CREFND1A
 14215             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14216
 14217     IF CCANREAL > +0
 14218        MOVE AL-UANON            TO CCANREAA
 14219        IF CCANREAI = 'R' OR ' '
 14220           CONTINUE
 14221        ELSE
 14222           MOVE ER-9841        TO EMI-ERROR
 14223           MOVE -1             TO CCANREAL
 14224           MOVE AL-UABON       TO CCANREAA
 14225           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14226        END-IF
 14227     END-IF
 14228     IF CMTHD1L EQUAL +0
 14229        NEXT SENTENCE
 14230     ELSE
 14231        IF CMTHD1L NOT = +0
 14232           MOVE AL-UNNON        TO CMTHD1A
 14233           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14234                         OR '5' OR '6' OR '8' OR '9'
 14235                         OR 'R' OR ' '
 14236              NEXT SENTENCE
 14237           ELSE
 14238              MOVE ER-0582        TO EMI-ERROR
 14239              MOVE -1             TO CMTHD1L
 14240              MOVE AL-UNBON       TO CMTHD1A
 14241              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14242
 14243     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 259
* VP6311.cbl
 14244        AND (CMAINTI = 'C' OR 'K')
 14245         NEXT SENTENCE
 14246     ELSE
 14247         IF CCANDT2L  GREATER THAN ZEROS
 14248             MOVE AL-UNNON       TO CCANDT2A
 14249             IF CCANDT2I = SPACES
 14250                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14251             ELSE
 14252                MOVE CCANDT2I       TO DEEDIT-FIELD
 14253                PERFORM 8600-DEEDIT
 14254                IF DEEDIT-FIELD-V0   NUMERIC
 14255                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14256                   MOVE 4                TO DC-OPTION-CODE
 14257                   PERFORM 9700-DATE-LINK
 14258                   IF NO-CONVERSION-ERROR
 14259                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14260                   ELSE
 14261                      MOVE -1       TO CCANDT2L
 14262                      MOVE ER-2227  TO EMI-ERROR
 14263                      MOVE AL-UNBON TO CCANDT2A
 14264                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14265                ELSE
 14266                   MOVE -1         TO CCANDT2L
 14267                   MOVE ER-2223    TO EMI-ERROR
 14268                   MOVE AL-UNBON   TO CCANDT2A
 14269                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14270         ELSE
 14271            IF CREFND2L GREATER THAN ZEROS
 14272               MOVE -1             TO CCANDT2L
 14273               MOVE ER-2222        TO EMI-ERROR
 14274               MOVE AL-UNBOF       TO CCANDT2A
 14275               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14276
 14277     IF CREFND2L = ZEROS
 14278        AND (CMAINTI = 'C' OR 'K')
 14279         NEXT SENTENCE
 14280     ELSE
 14281         IF CREFND2L NOT = ZEROS
 14282            MOVE AL-UNNON        TO CREFND2A
 14283
 14284* EXEC CICS BIF DEEDIT
 14285*               FIELD  (CREFND2I)
 14286*               LENGTH (11)
 14287*           END-EXEC
 14288     MOVE 11
 14289       TO DFHEIV11
 14290*    MOVE '@"L                   #   #00012811' TO DFHEIV0
 14291     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14292     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14293     MOVE X'2020233030303132383131' TO DFHEIV0(25:11)
 14294     CALL 'kxdfhei1' USING DFHEIV0,
 14295           CREFND2I,
 14296           DFHEIV11
 14297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14298            MOVE CREFND2I        TO WS-CREFND2
 14299*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14300*           PERFORM 8600-DEEDIT
 14301*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 260
* VP6311.cbl
 14302            IF WS-CREFND2  = ZEROS
 14303               AND CMAINTI = 'A'
 14304             MOVE ER-2437        TO EMI-ERROR
 14305             MOVE -1             TO CREFND2L
 14306             MOVE AL-UNBON       TO CREFND2A
 14307             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14308
 14309     IF CMTHD2L EQUAL +0
 14310        NEXT SENTENCE
 14311     ELSE
 14312        IF CMTHD2L NOT = +0
 14313           MOVE AL-UNNON        TO CMTHD2A
 14314           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14315                         OR '5' OR '6' OR '8' OR '9'
 14316                         OR ' ' OR 'R'
 14317              NEXT SENTENCE
 14318           ELSE
 14319              MOVE ER-0582        TO EMI-ERROR
 14320              MOVE -1             TO CMTHD2L
 14321              MOVE AL-UNBON       TO CMTHD2A
 14322              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14323
 14324     IF CLIVESL GREATER THAN ZEROS
 14325         MOVE CLIVESI            TO DEEDIT-FIELD
 14326         PERFORM 8600-DEEDIT
 14327         IF DEEDIT-FIELD-V0 NUMERIC
 14328             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14329             MOVE AL-UNNON       TO CLIVESA
 14330         ELSE
 14331             MOVE -1             TO CLIVESL
 14332             MOVE AL-UNBON       TO CLIVESA
 14333             MOVE ER-2223        TO EMI-ERROR
 14334             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14335
 14336     IF CFORCEL  NOT = ZEROS
 14337         IF FORCE-CAP
 14338            MOVE AL-UANON            TO CFORCEA
 14339         ELSE
 14340            MOVE ER-2945             TO EMI-ERROR
 14341            MOVE AL-UABON            TO CFORCEA
 14342            MOVE -1                  TO CFORCEL
 14343            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14344
 14345     IF CPAYEEL GREATER THAN ZEROS
 14346        MOVE AL-UANON            TO CPAYEEA.
 14347
 14348     IF CBILCDL NOT = ZEROS
 14349        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14350                             AND 'A' AND 'B' AND 'E'
 14351           MOVE ER-2225              TO EMI-ERROR
 14352           MOVE AL-UABON             TO CBILCDA
 14353           MOVE -1                   TO CBILCDL
 14354           MOVE  1                   TO SET-CURSOR-SW
 14355           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14356        ELSE
 14357           MOVE AL-UANON             TO CBILCDA.
 14358
 14359 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 261
* VP6311.cbl
 14360     IF EMI-ERROR = ZEROS
 14361         NEXT SENTENCE
 14362     ELSE
 14363         GO TO 8200-SEND-DATAONLY.
 14364
 14365     IF CMAINTI = 'A'
 14366        GO TO 2200-ADD-CANCEL-ROUTINE.
 14367
 14368     IF CMAINTI = 'C'
 14369        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14370
 14371     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14372
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 262
* VP6311.cbl
 14374
 14375******************************************************************
 14376*                                                                *
 14377*                   S H O W   C A N C E L                        *
 14378*                                                                *
 14379******************************************************************
 14380
 14381 2100-SHOW-REQUEST.
 14382     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14383
 14384     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14385        MOVE -1                  TO CMAINTL
 14386        GO TO 8200-SEND-DATAONLY.
 14387
 14388     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14389
 14390     IF CSUFIXL NOT = ZEROS
 14391        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14392       ELSE
 14393        MOVE SPACE            TO WS-NEW-SUFFIX.
 14394
 14395     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14396     PERFORM 8600-DEEDIT.
 14397     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14398     MOVE '4'                    TO DC-OPTION-CODE.
 14399     PERFORM 9700-DATE-LINK.
 14400     IF DATE-CONVERSION-ERROR
 14401        MOVE ER-0348             TO EMI-ERROR
 14402        MOVE -1                  TO CEFFDTL
 14403        MOVE AL-UABON            TO CEFFDTA
 14404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14405        GO TO 8200-SEND-DATAONLY
 14406     ELSE
 14407        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14408        MOVE AL-UANON            TO CEFFDTA
 14409        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14410
 14411     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14412
 14413     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14414        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14415        MOVE 'Y'                    TO WS-SHOW-SW
 14416        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14417           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14418        ELSE
 14419           IF PI-FILE-BROWSE
 14420              GO TO 4300-BROWSE-FILE-FORWARD
 14421           ELSE
 14422              IF PI-CSR-BROWSE
 14423                 GO TO 4200-BROWSE-CSR-FORWARD
 14424              ELSE
 14425                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14426     ELSE
 14427        GO TO 3900-RE-DISPLAY-RECORD.
 14428
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 263
* VP6311.cbl
 14430
 14431
 14432******************************************************************
 14433*                                                                *
 14434*            A D D   C A N C E L   R O U T I N E                 *
 14435*                                                                *
 14436******************************************************************
 14437
 14438 2200-ADD-CANCEL-ROUTINE.
 14439     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14440
 14441
 14442* EXEC CICS GETMAIN
 14443*        SET     (ADDRESS OF PENDING-BUSINESS)
 14444*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14445*    END-EXEC.
 14446*    MOVE '," L                  $   #00012958' TO DFHEIV0
 14447     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14448     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14449     MOVE X'2020233030303132393538' TO DFHEIV0(25:11)
 14450     CALL 'kxdfhei1' USING DFHEIV0,
 14451           DFHEIV20,
 14452           ERPNDB-RECORD-LENGTH,
 14453           DFHEIV99
 14454     SET ADDRESS OF PENDING-BUSINESS TO
 14455         DFHEIV20
 14456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14457
 14458
 14459
 14460* EXEC CICS HANDLE CONDITION
 14461*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14462*    END-EXEC.
 14463*    MOVE '"$I                   ! 3 #00012963' TO DFHEIV0
 14464     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14466     MOVE X'3320233030303132393633' TO DFHEIV0(25:11)
 14467     CALL 'kxdfhei1' USING DFHEIV0
 14468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14469
 14470
 14471     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14472     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14473     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14474
 14475
 14476* EXEC CICS READ
 14477*        INTO    (PENDING-BUSINESS)
 14478*        DATASET (FILE-ID-ERPNDB)
 14479*        RIDFLD  (ERPNDB-KEY)
 14480*    END-EXEC.
 14481     MOVE LENGTH OF
 14482      PENDING-BUSINESS
 14483       TO DFHEIV11
 14484*    MOVE '&"IL       E          (   #00012971' TO DFHEIV0
 14485     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14487     MOVE X'2020233030303132393731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 264
* VP6311.cbl
 14488     CALL 'kxdfhei1' USING DFHEIV0,
 14489           FILE-ID-ERPNDB,
 14490           PENDING-BUSINESS,
 14491           DFHEIV11,
 14492           ERPNDB-KEY,
 14493           DFHEIV99,
 14494           DFHEIV99,
 14495           DFHEIV99
 14496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14497
 14498
 14499     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14500
 14501     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14502     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14503     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14504     MOVE SPACES                 TO PENDING-BUSINESS.
 14505     MOVE 'PB'                   TO PB-RECORD-ID.
 14506     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14507     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14508     MOVE SPACES                 TO PB-CERT-SFX.
 14509     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14510     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14511                                    PB-ALT-CHG-SEQ-NO.
 14512
 14513     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14514     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14515     MOVE '2'                    TO PB-RECORD-TYPE.
 14516
 14517     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14518     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14519
 14520
 14521     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14522                                    PB-ALT-CHG-SEQ-NO
 14523                                    PB-C-LF-REF-CALC
 14524                                    PB-C-AH-REF-CALC
 14525                                    PB-C-LF-RFND-CLP
 14526                                    PB-C-AH-RFND-CLP
 14527                                    PB-CI-INSURED-AGE
 14528                                    PB-CI-LF-TERM
 14529                                    PB-CI-AH-TERM
 14530                                    PB-CI-LF-BENEFIT-CD
 14531                                    PB-CI-LF-BENEFIT-AMT
 14532                                    PB-CI-LF-ALT-BENEFIT-AMT
 14533                                    PB-CI-LF-PREMIUM-AMT
 14534                                    PB-CI-LF-ALT-PREMIUM-AMT
 14535                                    PB-CI-AH-BENEFIT-CD
 14536                                    PB-CI-AH-BENEFIT-AMT
 14537                                    PB-CI-AH-PREMIUM-AMT
 14538                                    PB-CI-PAY-FREQUENCY
 14539                                    PB-CI-LOAN-APR
 14540                                    PB-CI-LOAN-TERM
 14541                                    PB-CI-LIFE-COMMISSION
 14542                                    PB-CI-AH-COMMISSION
 14543                                    PB-CI-CURR-SEQ
 14544                                    PB-CI-AH-CANCEL-AMT
 14545                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 265
* VP6311.cbl
 14546                                    PB-CI-RATE-DEV-PCT-LF
 14547                                    PB-CI-RATE-DEV-PCT-AH
 14548                                    PB-CI-EXTENTION-DAYS
 14549                                    PB-CI-TERM-IN-DAYS
 14550                                    PB-CI-LIVES
 14551                                    PB-CI-LF-CRIT-PER
 14552                                    PB-CI-AH-CRIT-PER
 14553                                    PB-C-LF-REM-TERM
 14554                                    PB-C-AH-REM-TERM
 14555                                    PB-CHG-COUNT
 14556                                    PB-LF-BILLED-AMTS
 14557                                    PB-AH-BILLED-AMTS
 14558                                    PB-C-INT-ON-REFS
 14559*                                   PB-C-MICROFILM-NO
 14560                                    PB-CALC-TOLERANCE.
 14561
 14562     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14563                                    PB-CI-AH-SETTLEMENT-DT
 14564                                    PB-CI-DEATH-DT
 14565                                    PB-CI-LF-PRIOR-CANCEL-DT
 14566                                    PB-CI-AH-PRIOR-CANCEL-DT
 14567                                    PB-CI-ENTRY-DT
 14568                                    PB-CI-LF-EXPIRE-DT
 14569                                    PB-CI-AH-EXPIRE-DT
 14570                                    PB-CI-LOAN-1ST-PMT-DT
 14571                                    PB-C-LF-CANCEL-DT
 14572                                    PB-C-AH-CANCEL-DT
 14573                                    PB-CREDIT-ACCEPT-DT
 14574                                    PB-BILLED-DT
 14575                                    PB-ACCT-EFF-DT
 14576                                    PB-ACCT-EXP-DT.
 14577
 14578     MOVE 'X'                    TO PB-FATAL-FLAG.
 14579
 14580     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14581
 14582     IF CSUFIXL     GREATER THAN ZEROS
 14583        MOVE CSUFIXI             TO PB-CERT-SFX.
 14584
 14585*    IF CMICRNOL  GREATER  ZEROS
 14586*        IF CMICRNOI  NUMERIC
 14587*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14588*            MOVE AL-UNNON       TO  CMICRNOA
 14589*        ELSE
 14590*            MOVE -1             TO  CMICRNOL
 14591*            MOVE AL-UNBON       TO  CMICRNOA
 14592*            MOVE ER-2701        TO  EMI-ERROR
 14593*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14594
 14595     IF CLSTNML     GREATER THAN ZEROS
 14596        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14597
 14598     IF CCANREAL > ZEROS
 14599        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14600     END-IF
 14601     IF CPCYNL > ZEROS
 14602        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14603     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 266
* VP6311.cbl
 14604     IF CCANDT1L    GREATER THAN ZEROS
 14605        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14606
 14607     IF CCANDT2L    GREATER THAN ZEROS
 14608        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14609
 14610     IF CMTHD1L    GREATER THAN +0
 14611        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14612
 14613     IF CMTHD2L    GREATER THAN +0
 14614        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14615
 14616     IF CREFND1L    GREATER THAN ZEROS
 14617        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14618        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14619     ELSE
 14620        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14621
 14622     IF CREFND2L    GREATER THAN ZEROS
 14623        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14624        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14625     ELSE
 14626        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14627
 14628     IF CLIVESL     GREATER THAN ZEROS
 14629        MOVE WS-CLIVES           TO PB-C-LIVES
 14630     ELSE
 14631        MOVE ZEROS               TO PB-C-LIVES.
 14632
 14633     IF CPAYEEL     GREATER THAN ZEROS
 14634        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14635
 14636     IF CFORCEL     GREATER THAN ZEROS
 14637        MOVE CFORCEI             TO PB-FORCE-CODE.
 14638
 14639     IF CBILCDL     GREATER THAN ZEROS
 14640        MOVE CBILCDI             TO PB-RECORD-BILL.
 14641
 14642*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14643
 14644 2260-WRITE-PB-RECORD.
 14645     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14646                                    PB-INPUT-BY.
 14647     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14648     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14649                                    PB-INPUT-DT.
 14650
 14651     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14652     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14653                                    PB-CONTROL-BY-ORIG-BATCH.
 14654
 14655     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14656     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14657     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14658     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14659     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14660
 14661     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 267
* VP6311.cbl
 14662
 14663     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14664
 14665     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14666     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14667     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14668
 14669     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14670     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14671
 14672 2275-WRITE-PENDING-BUSINESS.
 14673     MOVE 'A'                    TO JP-RECORD-TYPE.
 14674     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14675     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14676     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14677
 14678
 14679* EXEC CICS HANDLE CONDITION
 14680*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14681*    END-EXEC.
 14682*    MOVE '"$%                   ! 4 #00013156' TO DFHEIV0
 14683     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14685     MOVE X'3420233030303133313536' TO DFHEIV0(25:11)
 14686     CALL 'kxdfhei1' USING DFHEIV0
 14687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14688
 14689
 14690
 14691* EXEC CICS WRITE
 14692*        DATASET (FILE-ID-ERPNDB)
 14693*        FROM    (PENDING-BUSINESS)
 14694*        RIDFLD  (PB-CONTROL-PRIMARY)
 14695*    END-EXEC.
 14696     MOVE LENGTH OF
 14697      PENDING-BUSINESS
 14698       TO DFHEIV11
 14699*    MOVE '&$ L                  ''   #00013160' TO DFHEIV0
 14700     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14701     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14702     MOVE X'2020233030303133313630' TO DFHEIV0(25:11)
 14703     CALL 'kxdfhei1' USING DFHEIV0,
 14704           FILE-ID-ERPNDB,
 14705           PENDING-BUSINESS,
 14706           DFHEIV11,
 14707           PB-CONTROL-PRIMARY,
 14708           DFHEIV99,
 14709           DFHEIV99
 14710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14711
 14712
 14713     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14714
 14715     PERFORM 8400-LOG-JOURNAL-RECORD.
 14716
 14717******************************************************************
 14718*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14719******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 268
* VP6311.cbl
 14720
 14721     display ' made it to add orig CANCEL cert '
 14722     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14723     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14724     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14725     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14726
 14727
 14728* EXEC CICS READ
 14729*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14730*        DATASET (FILE-ID-ELCERT)
 14731*        RIDFLD  (ELCERT-KEY)
 14732*        RESP    (WS-RESPONSE)
 14733*    END-EXEC.
 14734*    MOVE '&"S        E          (  N#00013180' TO DFHEIV0
 14735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14737     MOVE X'204E233030303133313830' TO DFHEIV0(25:11)
 14738     CALL 'kxdfhei1' USING DFHEIV0,
 14739           FILE-ID-ELCERT,
 14740           DFHEIV20,
 14741           DFHEIV99,
 14742           ELCERT-KEY,
 14743           DFHEIV99,
 14744           DFHEIV99,
 14745           DFHEIV99
 14746     SET ADDRESS OF CERTIFICATE-MASTER TO
 14747         DFHEIV20
 14748     MOVE EIBRESP  TO WS-RESPONSE
 14749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14750
 14751
 14752     IF NOT RESP-NORMAL
 14753        GO TO 2276-BYPASS-CRTO
 14754     END-IF
 14755
 14756     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14757     MOVE ' '                    TO WS-ERMAIL-SW
 14758
 14759
 14760* EXEC CICS READ
 14761*       DATASET   (FILE-ID-ERMAIL)
 14762*       SET       (ADDRESS OF MAILING-DATA)
 14763*       RIDFLD    (ERMAIL-KEY)
 14764*       RESP      (WS-RESPONSE)
 14765*    END-EXEC
 14766*    MOVE '&"S        E          (  N#00013194' TO DFHEIV0
 14767     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14769     MOVE X'204E233030303133313934' TO DFHEIV0(25:11)
 14770     CALL 'kxdfhei1' USING DFHEIV0,
 14771           FILE-ID-ERMAIL,
 14772           DFHEIV20,
 14773           DFHEIV99,
 14774           ERMAIL-KEY,
 14775           DFHEIV99,
 14776           DFHEIV99,
 14777           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 269
* VP6311.cbl
 14778     SET ADDRESS OF MAILING-DATA TO
 14779         DFHEIV20
 14780     MOVE EIBRESP  TO WS-RESPONSE
 14781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14782
 14783     IF RESP-NORMAL
 14784        SET ERMAIL-FOUND TO TRUE
 14785     END-IF
 14786
 14787     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14788
 14789     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14790     MOVE 'OC'                   TO OC-RECORD-ID
 14791     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14792                                 TO OC-CONTROL-PRIMARY (1:33)
 14793     MOVE 'I'                    TO OC-RECORD-TYPE
 14794     MOVE +4096                  TO OC-KEY-SEQ-NO
 14795     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14796     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14797     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14798
 14799     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14800     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14801     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14802     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14803     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14804     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14805     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14806     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14807     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14808     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14809     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14810     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14811     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14812     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14813     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14814     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14815     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14816     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14817     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14818     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14819     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14820     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14821     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14822     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14823     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14824     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14825     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14826     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14827     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14828     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14829     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14830     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14831
 14832     IF ERMAIL-FOUND
 14833        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14834     END-IF
 14835     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 270
* VP6311.cbl
 14836        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14837                           OC-INS-AGE-DEFAULT-FLAG
 14838        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14839                           OC-JNT-AGE-DEFAULT-FLAG
 14840     END-IF
 14841     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14842     .
 14843 2275-WRITE-ELCRTO.
 14844
 14845
 14846* EXEC CICS WRITE
 14847*       DATASET   ('ELCRTO')
 14848*       FROM      (ORIGINAL-CERTIFICATE)
 14849*       RIDFLD    (OC-CONTROL-PRIMARY)
 14850*       RESP      (WS-RESPONSE)
 14851*    END-EXEC
 14852     MOVE LENGTH OF
 14853      ORIGINAL-CERTIFICATE
 14854       TO DFHEIV11
 14855     MOVE 'ELCRTO' TO DFHEIV1
 14856*    MOVE '&$ L                  ''  N#00013263' TO DFHEIV0
 14857     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14858     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14859     MOVE X'204E233030303133323633' TO DFHEIV0(25:11)
 14860     CALL 'kxdfhei1' USING DFHEIV0,
 14861           DFHEIV1,
 14862           ORIGINAL-CERTIFICATE,
 14863           DFHEIV11,
 14864           OC-CONTROL-PRIMARY,
 14865           DFHEIV99,
 14866           DFHEIV99
 14867     MOVE EIBRESP  TO WS-RESPONSE
 14868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14869
 14870     display ' just wrote 2275 ' ws-response
 14871     IF RESP-DUPKEY
 14872        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14873        GO TO 2275-WRITE-ELCRTO
 14874     ELSE
 14875        IF NOT RESP-NORMAL
 14876           MOVE -1               TO BMAINTL
 14877           MOVE ER-7450          TO EMI-ERROR
 14878           PERFORM 9900-ERROR-FORMAT
 14879                                 THRU 9900-EXIT
 14880           GO TO 8200-SEND-DATAONLY
 14881        END-IF
 14882     END-IF.
 14883
 14884 2276-BYPASS-CRTO.
 14885******************************************************************
 14886*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14887******************************************************************
 14888
 14889
 14890* EXEC CICS READ
 14891*        INTO    (PENDING-BUSINESS)
 14892*        DATASET (FILE-ID-ERPNDB)
 14893*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 271
* VP6311.cbl
 14894*        UPDATE
 14895*    END-EXEC.
 14896     MOVE LENGTH OF
 14897      PENDING-BUSINESS
 14898       TO DFHEIV11
 14899*    MOVE '&"IL       EU         (   #00013289' TO DFHEIV0
 14900     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14901     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14902     MOVE X'2020233030303133323839' TO DFHEIV0(25:11)
 14903     CALL 'kxdfhei1' USING DFHEIV0,
 14904           FILE-ID-ERPNDB,
 14905           PENDING-BUSINESS,
 14906           DFHEIV11,
 14907           ERPNDB-KEY,
 14908           DFHEIV99,
 14909           DFHEIV99,
 14910           DFHEIV99
 14911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14912
 14913
 14914     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14915     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14916     MOVE 'B'                    TO JP-RECORD-TYPE.
 14917     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14918
 14919     PERFORM 8400-LOG-JOURNAL-RECORD.
 14920
 14921     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14922
 14923
 14924* EXEC CICS REWRITE
 14925*        DATASET (FILE-ID-ERPNDB)
 14926*        FROM    (PENDING-BUSINESS)
 14927*    END-EXEC.
 14928     MOVE LENGTH OF
 14929      PENDING-BUSINESS
 14930       TO DFHEIV11
 14931*    MOVE '&& L                  %   #00013305' TO DFHEIV0
 14932     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14933     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14934     MOVE X'2020233030303133333035' TO DFHEIV0(25:11)
 14935     CALL 'kxdfhei1' USING DFHEIV0,
 14936           FILE-ID-ERPNDB,
 14937           PENDING-BUSINESS,
 14938           DFHEIV11,
 14939           DFHEIV99
 14940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14941
 14942
 14943     MOVE 'C'                    TO JP-RECORD-TYPE.
 14944     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14945
 14946     PERFORM 8400-LOG-JOURNAL-RECORD.
 14947
 14948     IF WS-ERRORS-PRESENT
 14949        GO TO 3900-RE-DISPLAY-RECORD.
 14950
 14951     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 272
* VP6311.cbl
 14952     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14953     MOVE LOW-VALUES             TO VP631CI.
 14954     MOVE  -1                    TO CMAINTL.
 14955     GO TO 8100-SEND-INITIAL-MAP.
 14956
 14957 2280-BATCH-HDR-NOT-FOUND.
 14958     MOVE -1                     TO BMAINTL.
 14959     MOVE ER-7450                TO EMI-ERROR.
 14960     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14961     GO TO 8200-SEND-DATAONLY.
 14962
 14963 2290-DUPLICATE-ALT-INDEX.
 14964
 14965******************************************************************
 14966*                                                                *
 14967*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14968*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14969*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14970*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14971*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14972*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14973*                                                                *
 14974******************************************************************
 14975
 14976     IF LCP-ONCTR-02 =  0
 14977         ADD 1 TO LCP-ONCTR-02
 14978        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14979
 14980     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14981
 14982     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14983         NEXT SENTENCE
 14984     ELSE
 14985         ADD +1 TO PB-BATCH-SEQ-NO
 14986                   PB-CSR-BATCH-SEQ-NO
 14987         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14988         GO TO 2275-WRITE-PENDING-BUSINESS.
 14989
 14990     MOVE -1                     TO CCERTNOL.
 14991     MOVE AL-UABON               TO CCERTNOA.
 14992     MOVE AL-UNBON               TO CEFFDTA.
 14993
 14994     MOVE 1                      TO EMI-SUB
 14995                                    EMI-SWITCH1
 14996                                    EMI-SWITCH-AREA-1
 14997                                    EMI-SWITCH-AREA-2.
 14998
 14999     MOVE SPACES                 TO EMI-ERROR-LINES.
 15000
 15001
 15002* EXEC CICS SYNCPOINT ROLLBACK
 15003*    END-EXEC.
 15004*    MOVE '6"R                   !   #00013368' TO DFHEIV0
 15005     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15007     MOVE X'2020233030303133333638' TO DFHEIV0(25:11)
 15008     CALL 'kxdfhei1' USING DFHEIV0
 15009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 273
* VP6311.cbl
 15010
 15011
 15012     MOVE ER-2247                TO EMI-ERROR.
 15013     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15014     GO TO 8200-SEND-DATAONLY.
 15015
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 274
* VP6311.cbl
 15017
 15018******************************************************************
 15019*                                                                *
 15020*          C H A N G E   C A N C E L   R O U T I N E             *
 15021*                                                                *
 15022******************************************************************
 15023
 15024***************************************************************
 15025*                                                             *
 15026*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15027*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15028*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15029*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15030*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15031*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15032*     5. LINK TO THE EDIT ROUTINE.                            *
 15033*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15034*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15035*              THE EDIT ROUTINE.                              *
 15036*     7. REWRITE THE NEW ISSUE                                *
 15037*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15038*                                                             *
 15039***************************************************************
 15040 2300-CHANGE-CANCEL-ROUTINE.
 15041     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15042
 15043     IF CCHGL NOT = ZEROS
 15044        MOVE ER-2196             TO EMI-ERROR
 15045        MOVE AL-UABON            TO CMAINTA
 15046        MOVE -1                  TO CMAINTL
 15047        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15048        GO TO 8200-SEND-DATAONLY.
 15049
 15050     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15051
 15052     IF CSUFIXL NOT = ZEROS
 15053        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15054     ELSE
 15055        MOVE SPACE               TO WS-NEW-SUFFIX.
 15056
 15057     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15058     PERFORM 8600-DEEDIT.
 15059     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15060     MOVE '4'                    TO DC-OPTION-CODE.
 15061
 15062     PERFORM 9700-DATE-LINK.
 15063
 15064     IF DATE-CONVERSION-ERROR
 15065        MOVE ER-0348             TO EMI-ERROR
 15066        MOVE -1                  TO CEFFDTL
 15067        MOVE AL-UABON            TO CEFFDTA
 15068        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15069        GO TO 8200-SEND-DATAONLY
 15070     ELSE
 15071        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15072        MOVE AL-UANON            TO CEFFDTA
 15073        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15074
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 275
* VP6311.cbl
 15075 2325-PROCESS-CANCEL-CHANGES.
 15076
 15077* EXEC CICS HANDLE CONDITION
 15078*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15079*    END-EXEC.
 15080*    MOVE '"$I                   ! 5 #00013435' TO DFHEIV0
 15081     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15083     MOVE X'3520233030303133343335' TO DFHEIV0(25:11)
 15084     CALL 'kxdfhei1' USING DFHEIV0
 15085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15086
 15087
 15088     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15089     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15090     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15091
 15092
 15093* EXEC CICS GETMAIN
 15094*        SET      (ADDRESS OF PENDING-BUSINESS)
 15095*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15096*        INITIMG  (GETMAIN-SPACE)
 15097*     END-EXEC.
 15098*    MOVE ',"IL                  $   #00013443' TO DFHEIV0
 15099     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15100     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15101     MOVE X'2020233030303133343433' TO DFHEIV0(25:11)
 15102     CALL 'kxdfhei1' USING DFHEIV0,
 15103           DFHEIV20,
 15104           ERPNDB-RECORD-LENGTH,
 15105           GETMAIN-SPACE
 15106     SET ADDRESS OF PENDING-BUSINESS TO
 15107         DFHEIV20
 15108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15109
 15110
 15111
 15112* EXEC CICS READ
 15113*        INTO    (PENDING-BUSINESS)
 15114*        DATASET (FILE-ID-ERPNDB)
 15115*        RIDFLD  (ERPNDB-KEY)
 15116*    END-EXEC.
 15117     MOVE LENGTH OF
 15118      PENDING-BUSINESS
 15119       TO DFHEIV11
 15120*    MOVE '&"IL       E          (   #00013449' TO DFHEIV0
 15121     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15123     MOVE X'2020233030303133343439' TO DFHEIV0(25:11)
 15124     CALL 'kxdfhei1' USING DFHEIV0,
 15125           FILE-ID-ERPNDB,
 15126           PENDING-BUSINESS,
 15127           DFHEIV11,
 15128           ERPNDB-KEY,
 15129           DFHEIV99,
 15130           DFHEIV99,
 15131           DFHEIV99
 15132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 276
* VP6311.cbl
 15133
 15134
 15135     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15136
 15137
 15138* EXEC CICS HANDLE CONDITION
 15139*         NOTFND     (2385-REC-NOT-FOUND)
 15140*    END-EXEC.
 15141*    MOVE '"$I                   ! 6 #00013457' TO DFHEIV0
 15142     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15144     MOVE X'3620233030303133343537' TO DFHEIV0(25:11)
 15145     CALL 'kxdfhei1' USING DFHEIV0
 15146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15147
 15148
 15149**********************************************************
 15150*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15151*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15152**********************************************************
 15153
 15154
 15155* EXEC CICS READ
 15156*        DATASET (FILE-ID-ERPNDB)
 15157*        INTO    (PENDING-BUSINESS)
 15158*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15159*    END-EXEC.
 15160     MOVE LENGTH OF
 15161      PENDING-BUSINESS
 15162       TO DFHEIV11
 15163*    MOVE '&"IL       E          (   #00013466' TO DFHEIV0
 15164     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15165     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15166     MOVE X'2020233030303133343636' TO DFHEIV0(25:11)
 15167     CALL 'kxdfhei1' USING DFHEIV0,
 15168           FILE-ID-ERPNDB,
 15169           PENDING-BUSINESS,
 15170           DFHEIV11,
 15171           PI-PREV-CONTROL-PRIMARY,
 15172           DFHEIV99,
 15173           DFHEIV99,
 15174           DFHEIV99
 15175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15176
 15177
 15178********** DO NOT ALLOW CHANGES IF THRU A/R
 15179     IF BMAINTI = 'C'
 15180         IF PB-EL860-INTERNAL-PROCESS
 15181             MOVE ER-4005          TO EMI-ERROR
 15182             MOVE -1               TO BMAINTL
 15183             MOVE AL-UABON         TO BMAINTA
 15184             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15185             GO TO 8200-SEND-DATAONLY.
 15186**********
 15187
 15188     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15189        MOVE -1                 TO CMAINTL
 15190        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 277
* VP6311.cbl
 15191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15192        GO TO 8200-SEND-DATAONLY.
 15193
 15194     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15195        MOVE ER-2196             TO EMI-ERROR
 15196        MOVE AL-UABON            TO CMAINTA
 15197        MOVE -1                  TO CMAINTL
 15198        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15199        GO TO 8200-SEND-DATAONLY.
 15200     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15201
 15202     IF PB-BILLED-DT = LOW-VALUES AND
 15203        PB-CHG-COUNT = ZEROS
 15204        NEXT SENTENCE
 15205     ELSE
 15206        IF (CREFND1L GREATER THAN ZEROS AND
 15207            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15208           OR
 15209           (CREFND2L GREATER THAN ZEROS AND
 15210            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15211           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15212     if ((crefnd1l <> zeros)
 15213        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15214                      or
 15215        ((crefnd2l <> zeros)
 15216        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15217        continue
 15218     else
 15219        go to 2330-continue-change
 15220     end-if
 15221
 15222     move zeros                  to ws-check-amts
 15223     move ' '                    to ws-stop-sw
 15224                                    ws-check-sw
 15225                                    ws-proc-check-sw
 15226                                    ws-chek-browse-sw
 15227
 15228     perform 2500-browse-checks  thru 2500-exit
 15229
 15230     if i-have-processed-checks
 15231        or i-have-checks
 15232        continue
 15233     else
 15234        go to 2330-continue-change
 15235     end-if
 15236
 15237     if crefnd1l <> zeros
 15238        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15239        move ws-crefnd1 to ws-new-ref-total
 15240     else
 15241        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15242     end-if
 15243     if crefnd2l <> zeros
 15244        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15245        compute ws-new-ref-total = ws-new-ref-total +
 15246           ws-crefnd2
 15247     else
 15248        compute ws-new-ref-total = ws-new-ref-total +
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 278
* VP6311.cbl
 15249           pb-c-ah-cancel-amt
 15250     end-if
 15251
 15252     if zeros = (ws-lf-diff + ws-ah-diff)
 15253        move er-3449             to emi-error
 15254        perform 9900-error-format thru 9900-exit
 15255        go to 2330-continue-change
 15256     end-if
 15257
 15258     if (ws-new-ref-total < ws-check-amts)
 15259        and (pb-c-refund-sw = 'Y')
 15260        move er-3447             to emi-error
 15261        perform 9900-error-format thru 9900-exit
 15262        move al-uabon            to cmainta
 15263        move -1                  to cmaintl
 15264        go to 8200-send-dataonly
 15265     end-if
 15266
 15267     if (ws-new-ref-total > ws-check-amts)
 15268        and (ws-check-amts not = zeros)
 15269        move er-3448             to emi-error
 15270        move al-uabon            to crefnd1a
 15271                                    crefnd2a
 15272        perform 9900-error-format thru 9900-exit
 15273     end-if
 15274
 15275*     if (ws-lf-diff + ws-ah-diff) < zeros
 15276*        move er-3447             to emi-error
 15277*        perform 9900-error-format thru 9900-exit
 15278*        move al-uabon            to cmainta
 15279*        move -1                  to cmaintl
 15280*        go to 8200-send-dataonly
 15281*     end-if
 15282     .
 15283 2330-continue-change.
 15284
 15285
 15286* EXEC CICS READ
 15287*        DATASET (FILE-ID-ERPNDB)
 15288*        INTO    (PENDING-BUSINESS)
 15289*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15290*        UPDATE
 15291*    END-EXEC.
 15292     MOVE LENGTH OF
 15293      PENDING-BUSINESS
 15294       TO DFHEIV11
 15295*    MOVE '&"IL       EU         (   #00013579' TO DFHEIV0
 15296     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15297     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15298     MOVE X'2020233030303133353739' TO DFHEIV0(25:11)
 15299     CALL 'kxdfhei1' USING DFHEIV0,
 15300           FILE-ID-ERPNDB,
 15301           PENDING-BUSINESS,
 15302           DFHEIV11,
 15303           PI-PREV-CONTROL-PRIMARY,
 15304           DFHEIV99,
 15305           DFHEIV99,
 15306           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 279
* VP6311.cbl
 15307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15308
 15309
 15310     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15311     MOVE 'B'                    TO JP-RECORD-TYPE
 15312     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15313     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15314
 15315     PERFORM 8400-LOG-JOURNAL-RECORD.
 15316
 15317     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15318          PB-CHG-COUNT NOT = ZEROS
 15319        IF (CREFND1L GREATER THAN ZEROS AND
 15320            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15321           OR
 15322           (CREFND2L GREATER THAN ZEROS AND
 15323            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15324            ADD +1                      TO PB-CHG-COUNT
 15325            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15326
 15327*    IF CMICRNOL  GREATER  ZEROS
 15328*        IF CMICRNOI  NUMERIC
 15329*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15330*            MOVE AL-UNNON       TO  CMICRNOA
 15331*        ELSE
 15332*            MOVE -1             TO  CMICRNOL
 15333*            MOVE AL-UNBON       TO  CMICRNOA
 15334*            MOVE ER-2701        TO  EMI-ERROR
 15335*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15336
 15337     IF CSUFIXL GREATER THAN ZEROS
 15338        MOVE CSUFIXI             TO PB-CERT-SFX.
 15339
 15340     IF CLSTNML GREATER THAN ZEROS
 15341         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15342
 15343     IF CCANREAL > ZEROS
 15344        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15345     END-IF
 15346     IF CPCYNL > ZEROS
 15347        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15348     END-IF
 15349     IF CCANDT1L    GREATER THAN ZEROS
 15350        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15351
 15352     IF CCANDT2L    GREATER THAN ZEROS
 15353        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15354
 15355     IF CMTHD1L    GREATER THAN +0
 15356        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15357
 15358     IF CMTHD2L    GREATER THAN +0
 15359        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15360
 15361     IF CREFND1L    GREATER THAN ZEROS
 15362        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15363        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15364        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 280
* VP6311.cbl
 15365        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15366
 15367     IF CREFND2L    GREATER THAN ZEROS
 15368        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15369        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15370        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15371        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15372
 15373     IF CLIVESL     GREATER THAN ZEROS
 15374        MOVE WS-CLIVES           TO PB-C-LIVES.
 15375
 15376     IF CPAYEEL     GREATER THAN ZEROS
 15377        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15378
 15379     IF CFORCEL     GREATER THAN ZEROS
 15380        MOVE CFORCEI             TO PB-FORCE-CODE.
 15381
 15382     IF CBILCDL     GREATER THAN ZEROS
 15383        MOVE CBILCDI             TO PB-RECORD-BILL.
 15384
 15385 2360-REWRITE-PB-RECORD.
 15386     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15387     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15388     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15389     MOVE 'C'                    TO JP-RECORD-TYPE.
 15390     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15391     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15392     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15393
 15394     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15395
 15396     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15397     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15398
 15399     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15400
 15401     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15402
 15403     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15404     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15405     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15406
 15407     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15408     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15409
 15410 2375-REWRITE-PENDING-BUSINESS.
 15411     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15412     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15413     MOVE 'C'                    TO JP-RECORD-TYPE.
 15414     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15415
 15416
 15417* EXEC CICS REWRITE
 15418*        DATASET (FILE-ID-ERPNDB)
 15419*        FROM    (PENDING-BUSINESS)
 15420*    END-EXEC.
 15421     MOVE LENGTH OF
 15422      PENDING-BUSINESS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 281
* VP6311.cbl
 15423       TO DFHEIV11
 15424*    MOVE '&& L                  %   #00013692' TO DFHEIV0
 15425     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15426     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15427     MOVE X'2020233030303133363932' TO DFHEIV0(25:11)
 15428     CALL 'kxdfhei1' USING DFHEIV0,
 15429           FILE-ID-ERPNDB,
 15430           PENDING-BUSINESS,
 15431           DFHEIV11,
 15432           DFHEIV99
 15433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15434
 15435
 15436     PERFORM 8400-LOG-JOURNAL-RECORD.
 15437
 15438******************************************************************
 15439*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15440******************************************************************
 15441
 15442     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15443     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15444     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15445     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15446
 15447
 15448* EXEC CICS READ
 15449*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15450*        DATASET (FILE-ID-ELCERT)
 15451*        RIDFLD  (ELCERT-KEY)
 15452*        RESP    (WS-RESPONSE)
 15453*    END-EXEC.
 15454*    MOVE '&"S        E          (  N#00013708' TO DFHEIV0
 15455     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15457     MOVE X'204E233030303133373038' TO DFHEIV0(25:11)
 15458     CALL 'kxdfhei1' USING DFHEIV0,
 15459           FILE-ID-ELCERT,
 15460           DFHEIV20,
 15461           DFHEIV99,
 15462           ELCERT-KEY,
 15463           DFHEIV99,
 15464           DFHEIV99,
 15465           DFHEIV99
 15466     SET ADDRESS OF CERTIFICATE-MASTER TO
 15467         DFHEIV20
 15468     MOVE EIBRESP  TO WS-RESPONSE
 15469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15470
 15471
 15472     IF NOT RESP-NORMAL
 15473        GO TO 2376-BYPASS-CRTO
 15474     END-IF
 15475
 15476
 15477     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15478     MOVE ' '                    TO WS-ERMAIL-SW
 15479
 15480
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 282
* VP6311.cbl
 15481* EXEC CICS READ
 15482*       DATASET   (FILE-ID-ERMAIL)
 15483*       SET       (ADDRESS OF MAILING-DATA)
 15484*       RIDFLD    (ERMAIL-KEY)
 15485*       RESP      (WS-RESPONSE)
 15486*    END-EXEC
 15487*    MOVE '&"S        E          (  N#00013723' TO DFHEIV0
 15488     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15490     MOVE X'204E233030303133373233' TO DFHEIV0(25:11)
 15491     CALL 'kxdfhei1' USING DFHEIV0,
 15492           FILE-ID-ERMAIL,
 15493           DFHEIV20,
 15494           DFHEIV99,
 15495           ERMAIL-KEY,
 15496           DFHEIV99,
 15497           DFHEIV99,
 15498           DFHEIV99
 15499     SET ADDRESS OF MAILING-DATA TO
 15500         DFHEIV20
 15501     MOVE EIBRESP  TO WS-RESPONSE
 15502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15503
 15504     IF RESP-NORMAL
 15505        SET ERMAIL-FOUND TO TRUE
 15506     END-IF
 15507
 15508     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15509
 15510     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15511                                 TO ELCRTO-KEY
 15512     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15513     MOVE +0                     TO ELCRTO-SEQ-NO
 15514
 15515
 15516* EXEC CICS READ
 15517*       DATASET   ('ELCRTO')
 15518*       INTO      (ORIGINAL-CERTIFICATE)
 15519*       RIDFLD    (ELCRTO-KEY)
 15520*       GTEQ
 15521*       RESP      (WS-RESPONSE)
 15522*    END-EXEC
 15523     MOVE LENGTH OF
 15524      ORIGINAL-CERTIFICATE
 15525       TO DFHEIV11
 15526     MOVE 'ELCRTO' TO DFHEIV1
 15527*    MOVE '&"IL       G          (  N#00013741' TO DFHEIV0
 15528     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15530     MOVE X'204E233030303133373431' TO DFHEIV0(25:11)
 15531     CALL 'kxdfhei1' USING DFHEIV0,
 15532           DFHEIV1,
 15533           ORIGINAL-CERTIFICATE,
 15534           DFHEIV11,
 15535           ELCRTO-KEY,
 15536           DFHEIV99,
 15537           DFHEIV99,
 15538           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 283
* VP6311.cbl
 15539     MOVE EIBRESP  TO WS-RESPONSE
 15540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15541
 15542     IF RESP-NORMAL
 15543        AND (OC-CONTROL-PRIMARY (1:33) =
 15544                 PB-CONTROL-BY-ACCOUNT (1:33))
 15545        AND (OC-RECORD-TYPE = 'I')
 15546        display ' resp norm, key =, type i '
 15547        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15548           display ' end proc blank '
 15549           display ' csr edit session ' PI-CSR-SESSION-SW
 15550           IF NOT CSR-EDIT-SESSION
 15551
 15552* EXEC CICS READ
 15553*                DATASET   ('ELCRTO')
 15554*                INTO      (ORIGINAL-CERTIFICATE)
 15555*                RIDFLD    (OC-CONTROL-PRIMARY)
 15556*                UPDATE
 15557*                RESP      (WS-RESPONSE)
 15558*             END-EXEC
 15559     MOVE LENGTH OF
 15560      ORIGINAL-CERTIFICATE
 15561       TO DFHEIV11
 15562     MOVE 'ELCRTO' TO DFHEIV1
 15563*    MOVE '&"IL       EU         (  N#00013758' TO DFHEIV0
 15564     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15565     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15566     MOVE X'204E233030303133373538' TO DFHEIV0(25:11)
 15567     CALL 'kxdfhei1' USING DFHEIV0,
 15568           DFHEIV1,
 15569           ORIGINAL-CERTIFICATE,
 15570           DFHEIV11,
 15571           OC-CONTROL-PRIMARY,
 15572           DFHEIV99,
 15573           DFHEIV99,
 15574           DFHEIV99
 15575     MOVE EIBRESP  TO WS-RESPONSE
 15576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15577              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15578              IF RESP-NORMAL
 15579                 display ' good read upd '
 15580                 IF OC-ISSUE-TRAN-IND = 'N'
 15581                    MOVE CM-INSURED-LAST-NAME   TO
 15582                         OC-INS-LAST-NAME
 15583                    MOVE CM-INSURED-FIRST-NAME  TO
 15584                         OC-INS-FIRST-NAME
 15585                    MOVE CM-INSURED-INITIAL2    TO
 15586                         OC-INS-MIDDLE-INIT
 15587                    MOVE CM-INSURED-ISSUE-AGE   TO
 15588                         OC-INS-AGE
 15589                    MOVE CM-JT-LAST-NAME        TO
 15590                         OC-JNT-LAST-NAME
 15591                    MOVE CM-JT-FIRST-NAME       TO
 15592                         OC-JNT-FIRST-NAME
 15593                    MOVE CM-JT-INITIAL          TO
 15594                         OC-JNT-MIDDLE-INIT
 15595                    MOVE CM-INSURED-JOINT-AGE   TO
 15596                         OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 284
* VP6311.cbl
 15597                    MOVE CM-LF-BENEFIT-CD       TO
 15598                         OC-LF-BENCD
 15599                    MOVE CM-LF-ORIG-TERM        TO
 15600                         OC-LF-TERM
 15601                    MOVE CM-LF-BENEFIT-AMT      TO
 15602                         OC-LF-BEN-AMT
 15603                    MOVE CM-LF-PREMIUM-AMT      TO
 15604                         OC-LF-PRM-AMT
 15605                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15606                         OC-LF-ALT-BEN-AMT
 15607                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15608                         OC-LF-ALT-PRM-AMT
 15609                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15610                         OC-LF-EXP-DT
 15611                    MOVE CM-LIFE-COMM-PCT       TO
 15612                         OC-LF-COMM-PCT
 15613                    MOVE CM-AH-BENEFIT-CD       TO
 15614                         OC-AH-BENCD
 15615                    MOVE CM-AH-ORIG-TERM        TO
 15616                         OC-AH-TERM
 15617                    MOVE CM-AH-BENEFIT-AMT      TO
 15618                         OC-AH-BEN-AMT
 15619                    MOVE CM-AH-PREMIUM-AMT      TO
 15620                         OC-AH-PRM-AMT
 15621                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15622                         OC-AH-EXP-DT
 15623                    MOVE CM-AH-COMM-PCT         TO
 15624                         OC-AH-COMM-PCT
 15625                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15626                         OC-AH-CP
 15627                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15628                         OC-1ST-PMT-DT
 15629                 END-IF
 15630                 MOVE PB-C-LF-CANCEL-DT      TO
 15631                         OC-LF-CANCEL-DT
 15632                 MOVE PB-C-LF-CANCEL-AMT     TO
 15633                         OC-LF-CANCEL-AMT
 15634                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15635                         OC-LF-ITD-CANCEL-AMT
 15636                 MOVE PB-C-AH-CANCEL-DT      TO
 15637                         OC-AH-CANCEL-DT
 15638                 MOVE PB-C-AH-CANCEL-AMT     TO
 15639                         OC-AH-CANCEL-AMT
 15640                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15641                         OC-AH-ITD-CANCEL-AMT
 15642                 MOVE 'Y'                    TO
 15643                         OC-CANCEL-TRAN-IND
 15644                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15645                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15646                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15647                 IF ERMAIL-FOUND
 15648                    MOVE MA-CRED-BENE-NAME
 15649                                 TO OC-CRED-BENE-NAME
 15650                 END-IF
 15651                 IF NOT CERT-TRL-REC-NOT-FOUND
 15652                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15653                           OC-INS-AGE-DEFAULT-FLAG
 15654                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 285
* VP6311.cbl
 15655                           OC-JNT-AGE-DEFAULT-FLAG
 15656                 END-IF
 15657
 15658* EXEC CICS REWRITE
 15659*                   DATASET   ('ELCRTO')
 15660*                   FROM      (ORIGINAL-CERTIFICATE)
 15661*                   RESP      (WS-RESPONSE)
 15662*                END-EXEC
 15663     MOVE LENGTH OF
 15664      ORIGINAL-CERTIFICATE
 15665       TO DFHEIV11
 15666     MOVE 'ELCRTO' TO DFHEIV1
 15667*    MOVE '&& L                  %  N#00013845' TO DFHEIV0
 15668     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15669     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15670     MOVE X'204E233030303133383435' TO DFHEIV0(25:11)
 15671     CALL 'kxdfhei1' USING DFHEIV0,
 15672           DFHEIV1,
 15673           ORIGINAL-CERTIFICATE,
 15674           DFHEIV11,
 15675           DFHEIV99
 15676     MOVE EIBRESP  TO WS-RESPONSE
 15677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15678                 display ' just rewrote ' ws-response
 15679              END-IF
 15680           END-IF
 15681        ELSE
 15682           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15683           MOVE 'OC'             TO OC-RECORD-ID
 15684           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15685           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15686           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15687           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15688           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15689           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15690           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15691           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15692           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15693           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15694           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15695           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15696           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15697           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15698           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15699           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15700           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15701           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15702           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15703           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15704           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15705           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15706           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15707           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15708           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15709           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15710           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15711           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15712           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 286
* VP6311.cbl
 15713           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15714           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15715           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15716           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15717           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15718           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15719           IF ERMAIL-FOUND
 15720              MOVE MA-CRED-BENE-NAME
 15721                                 TO OC-CRED-BENE-NAME
 15722           END-IF
 15723           IF NOT CERT-TRL-REC-NOT-FOUND
 15724              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15725                           OC-INS-AGE-DEFAULT-FLAG
 15726              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15727                           OC-JNT-AGE-DEFAULT-FLAG
 15728           END-IF
 15729           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15730
 15731* EXEC CICS WRITE
 15732*             DATASET   ('ELCRTO')
 15733*             FROM      (ORIGINAL-CERTIFICATE)
 15734*             RIDFLD    (OC-CONTROL-PRIMARY)
 15735*             RESP      (WS-RESPONSE)
 15736*          END-EXEC
 15737     MOVE LENGTH OF
 15738      ORIGINAL-CERTIFICATE
 15739       TO DFHEIV11
 15740     MOVE 'ELCRTO' TO DFHEIV1
 15741*    MOVE '&$ L                  ''  N#00013902' TO DFHEIV0
 15742     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15743     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15744     MOVE X'204E233030303133393032' TO DFHEIV0(25:11)
 15745     CALL 'kxdfhei1' USING DFHEIV0,
 15746           DFHEIV1,
 15747           ORIGINAL-CERTIFICATE,
 15748           DFHEIV11,
 15749           OC-CONTROL-PRIMARY,
 15750           DFHEIV99,
 15751           DFHEIV99
 15752     MOVE EIBRESP  TO WS-RESPONSE
 15753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15754        END-IF
 15755     ELSE
 15756        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15757        MOVE 'OC'                TO OC-RECORD-ID
 15758        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15759                                 TO OC-CONTROL-PRIMARY (1:33)
 15760        MOVE 'I'                 TO OC-RECORD-TYPE
 15761        MOVE +4096               TO OC-KEY-SEQ-NO
 15762        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15763        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15764        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15765        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15766        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15767        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15768        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15769        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15770        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 287
* VP6311.cbl
 15771        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15772        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15773        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15774        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15775        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15776        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15777        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15778        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15779        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15780        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15781        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15782        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15783        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15784        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15785        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15786        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15787        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15788        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15789        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15790        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15791        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15792        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15793        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15794        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15795        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15796        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15797        IF ERMAIL-FOUND
 15798           MOVE MA-CRED-BENE-NAME
 15799                                 TO OC-CRED-BENE-NAME
 15800        END-IF
 15801        IF NOT CERT-TRL-REC-NOT-FOUND
 15802           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15803                           OC-INS-AGE-DEFAULT-FLAG
 15804           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15805                           OC-JNT-AGE-DEFAULT-FLAG
 15806        END-IF
 15807        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15808
 15809
 15810* EXEC CICS WRITE
 15811*          DATASET   ('ELCRTO')
 15812*          FROM      (ORIGINAL-CERTIFICATE)
 15813*          RIDFLD    (OC-CONTROL-PRIMARY)
 15814*          RESP      (WS-RESPONSE)
 15815*       END-EXEC
 15816     MOVE LENGTH OF
 15817      ORIGINAL-CERTIFICATE
 15818       TO DFHEIV11
 15819     MOVE 'ELCRTO' TO DFHEIV1
 15820*    MOVE '&$ L                  ''  N#00013963' TO DFHEIV0
 15821     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15822     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15823     MOVE X'204E233030303133393633' TO DFHEIV0(25:11)
 15824     CALL 'kxdfhei1' USING DFHEIV0,
 15825           DFHEIV1,
 15826           ORIGINAL-CERTIFICATE,
 15827           DFHEIV11,
 15828           OC-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 288
* VP6311.cbl
 15829           DFHEIV99,
 15830           DFHEIV99
 15831     MOVE EIBRESP  TO WS-RESPONSE
 15832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15833     END-IF.
 15834
 15835 2376-BYPASS-CRTO.
 15836******************************************************************
 15837*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15838******************************************************************
 15839
 15840
 15841* EXEC CICS HANDLE CONDITION
 15842*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15843*    END-EXEC.
 15844*    MOVE '"$I                   ! 7 #00013976' TO DFHEIV0
 15845     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15847     MOVE X'3720233030303133393736' TO DFHEIV0(25:11)
 15848     CALL 'kxdfhei1' USING DFHEIV0
 15849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15850
 15851
 15852
 15853* EXEC CICS READ
 15854*        INTO    (PENDING-BUSINESS)
 15855*        DATASET (FILE-ID-ERPNDB)
 15856*        RIDFLD  (ERPNDB-KEY)
 15857*        UPDATE
 15858*    END-EXEC.
 15859     MOVE LENGTH OF
 15860      PENDING-BUSINESS
 15861       TO DFHEIV11
 15862*    MOVE '&"IL       EU         (   #00013980' TO DFHEIV0
 15863     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15864     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15865     MOVE X'2020233030303133393830' TO DFHEIV0(25:11)
 15866     CALL 'kxdfhei1' USING DFHEIV0,
 15867           FILE-ID-ERPNDB,
 15868           PENDING-BUSINESS,
 15869           DFHEIV11,
 15870           ERPNDB-KEY,
 15871           DFHEIV99,
 15872           DFHEIV99,
 15873           DFHEIV99
 15874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15875
 15876
 15877     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15878     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15879     MOVE 'B'                    TO JP-RECORD-TYPE.
 15880     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15881
 15882     PERFORM 8400-LOG-JOURNAL-RECORD.
 15883
 15884     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15885
 15886
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 289
* VP6311.cbl
 15887* EXEC CICS REWRITE
 15888*        DATASET (FILE-ID-ERPNDB)
 15889*        FROM    (PENDING-BUSINESS)
 15890*    END-EXEC.
 15891     MOVE LENGTH OF
 15892      PENDING-BUSINESS
 15893       TO DFHEIV11
 15894*    MOVE '&& L                  %   #00013996' TO DFHEIV0
 15895     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15896     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15897     MOVE X'2020233030303133393936' TO DFHEIV0(25:11)
 15898     CALL 'kxdfhei1' USING DFHEIV0,
 15899           FILE-ID-ERPNDB,
 15900           PENDING-BUSINESS,
 15901           DFHEIV11,
 15902           DFHEIV99
 15903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15904
 15905
 15906     MOVE 'C'                    TO JP-RECORD-TYPE.
 15907     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15908
 15909     PERFORM 8400-LOG-JOURNAL-RECORD.
 15910
 15911     IF WS-ERRORS-PRESENT
 15912         GO TO 3900-RE-DISPLAY-RECORD.
 15913
 15914     MOVE ZEROS                  TO EMI-ERROR
 15915     MOVE -1                     TO CMAINTL
 15916     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15917     GO TO 3900-RE-DISPLAY-RECORD.
 15918
 15919 2380-BATCH-HDR-NOT-FOUND.
 15920     MOVE -1                     TO BMAINTL.
 15921     MOVE ER-7450                TO EMI-ERROR.
 15922     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15923     GO TO 8200-SEND-DATAONLY.
 15924
 15925 2385-REC-NOT-FOUND.
 15926     MOVE -1                     TO BMAINTL.
 15927     MOVE ER-7451                TO EMI-ERROR.
 15928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15929     GO TO 8200-SEND-DATAONLY.
 15930
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 290
* VP6311.cbl
 15932
 15933******************************************************************
 15934*                                                                *
 15935*          D E L E T E   C A N C E L   R O U T I N E             *
 15936*                                                                *
 15937******************************************************************
 15938
 15939 2400-DELETE-CANCEL-ROUTINE.
 15940     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15941
 15942     IF CCHGL NOT = ZEROS
 15943        MOVE ER-2196             TO EMI-ERROR
 15944        MOVE AL-UABON            TO CMAINTA
 15945        MOVE -1                  TO CMAINTL
 15946        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15947        GO TO 8200-SEND-DATAONLY.
 15948
 15949
 15950* EXEC CICS HANDLE CONDITION
 15951*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15952*    END-EXEC.
 15953*    MOVE '"$I                   ! 8 #00014044' TO DFHEIV0
 15954     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15956     MOVE X'3820233030303134303434' TO DFHEIV0(25:11)
 15957     CALL 'kxdfhei1' USING DFHEIV0
 15958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15959
 15960
 15961     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15962     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15963     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15964
 15965
 15966* EXEC CICS READ
 15967*        SET     (ADDRESS OF PENDING-BUSINESS)
 15968*        DATASET (FILE-ID-ERPNDB)
 15969*        RIDFLD  (ERPNDB-KEY)
 15970*    END-EXEC.
 15971*    MOVE '&"S        E          (   #00014052' TO DFHEIV0
 15972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15974     MOVE X'2020233030303134303532' TO DFHEIV0(25:11)
 15975     CALL 'kxdfhei1' USING DFHEIV0,
 15976           FILE-ID-ERPNDB,
 15977           DFHEIV20,
 15978           DFHEIV99,
 15979           ERPNDB-KEY,
 15980           DFHEIV99,
 15981           DFHEIV99,
 15982           DFHEIV99
 15983     SET ADDRESS OF PENDING-BUSINESS TO
 15984         DFHEIV20
 15985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15986
 15987
 15988     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15989
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 291
* VP6311.cbl
 15990     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15991
 15992     IF CSUFIXL NOT = ZEROS
 15993        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15994     ELSE
 15995        MOVE SPACE               TO WS-NEW-SUFFIX.
 15996
 15997     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15998
 15999     PERFORM 8600-DEEDIT.
 16000     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16001     MOVE '4'                    TO DC-OPTION-CODE.
 16002     PERFORM 9700-DATE-LINK.
 16003
 16004     IF DATE-CONVERSION-ERROR
 16005        MOVE ER-0348             TO EMI-ERROR
 16006        MOVE -1                  TO CEFFDTL
 16007        MOVE AL-UABON            TO CEFFDTA
 16008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16009        GO TO 8200-SEND-DATAONLY
 16010     ELSE
 16011        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16012        MOVE AL-UANON            TO CEFFDTA
 16013        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16014
 16015
 16016* EXEC CICS HANDLE CONDITION
 16017*         NOTFND    (2490-RECORD-NOT-FOUND)
 16018*    END-EXEC.
 16019*    MOVE '"$I                   ! 9 #00014085' TO DFHEIV0
 16020     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16021     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16022     MOVE X'3920233030303134303835' TO DFHEIV0(25:11)
 16023     CALL 'kxdfhei1' USING DFHEIV0
 16024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16025
 16026
 16027
 16028* EXEC CICS READ
 16029*        SET     (ADDRESS OF PENDING-BUSINESS)
 16030*        DATASET (FILE-ID-ERPNDB)
 16031*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16032*        UPDATE
 16033*    END-EXEC.
 16034*    MOVE '&"S        EU         (   #00014089' TO DFHEIV0
 16035     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16036     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16037     MOVE X'2020233030303134303839' TO DFHEIV0(25:11)
 16038     CALL 'kxdfhei1' USING DFHEIV0,
 16039           FILE-ID-ERPNDB,
 16040           DFHEIV20,
 16041           DFHEIV99,
 16042           PI-PREV-CONTROL-PRIMARY,
 16043           DFHEIV99,
 16044           DFHEIV99,
 16045           DFHEIV99
 16046     SET ADDRESS OF PENDING-BUSINESS TO
 16047         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 292
* VP6311.cbl
 16048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16049
 16050
 16051     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16052        MOVE -1                 TO CMAINTL
 16053        MOVE ER-2197            TO EMI-ERROR
 16054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16055        GO TO 8200-SEND-DATAONLY.
 16056
 16057     IF PB-BILLED-DT NOT = LOW-VALUES
 16058        MOVE -1                 TO CMAINTL
 16059        MOVE ER-2129            TO EMI-ERROR
 16060        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16061        GO TO 8200-SEND-DATAONLY.
 16062
 16063     IF PB-CHG-COUNT NOT = ZEROS
 16064        MOVE ER-2336            TO EMI-ERROR
 16065        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16066        MOVE AL-UABON            TO CMAINTA
 16067        MOVE -1                  TO CMAINTL
 16068        GO TO 8200-SEND-DATAONLY.
 16069
 16070     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16071        PB-CHG-COUNT NOT = ZEROS
 16072        MOVE ER-2196             TO EMI-ERROR
 16073        MOVE AL-UABON            TO CMAINTA
 16074        MOVE -1                  TO CMAINTL
 16075        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16076        GO TO 8200-SEND-DATAONLY.
 16077
 16078     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16079        MOVE ER-2900 TO EMI-ERROR
 16080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16081        MOVE AL-UABON         TO CMAINTA
 16082        MOVE -1               TO CMAINTL
 16083        GO TO 8200-SEND-DATAONLY.
 16084     move ' '                    to ws-stop-sw
 16085                                    ws-check-sw
 16086                                    ws-proc-check-sw
 16087                                    ws-chek-browse-sw
 16088
 16089     perform 2500-browse-checks  thru 2500-exit
 16090     if (i-have-processed-checks)
 16091        and (pb-c-refund-sw = 'Y')
 16092        move er-3446             to emi-error
 16093        perform 9900-error-format thru 9900-exit
 16094        move al-uabon            to cmainta
 16095        move -1                  to cmaintl
 16096        go to 8200-send-dataonly
 16097     end-if
 16098
 16099* EXEC CICS HANDLE CONDITION
 16100*         NOTFND  (2475-CONTINUE-DELETE)
 16101*    END-EXEC
 16102*    MOVE '"$I                   ! : #00014143' TO DFHEIV0
 16103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16105     MOVE X'3A20233030303134313433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 293
* VP6311.cbl
 16106     CALL 'kxdfhei1' USING DFHEIV0
 16107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16108
 16109     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16110     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16111     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16112     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16113
 16114
 16115* EXEC CICS READ
 16116*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16117*        DATASET (FILE-ID-ELCERT)
 16118*        RIDFLD  (ELCERT-KEY)
 16119*        UPDATE
 16120*    END-EXEC.
 16121*    MOVE '&"S        EU         (   #00014152' TO DFHEIV0
 16122     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16123     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16124     MOVE X'2020233030303134313532' TO DFHEIV0(25:11)
 16125     CALL 'kxdfhei1' USING DFHEIV0,
 16126           FILE-ID-ELCERT,
 16127           DFHEIV20,
 16128           DFHEIV99,
 16129           ELCERT-KEY,
 16130           DFHEIV99,
 16131           DFHEIV99,
 16132           DFHEIV99
 16133     SET ADDRESS OF CERTIFICATE-MASTER TO
 16134         DFHEIV20
 16135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16136
 16137
 16138     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16139
 16140     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16141     MOVE 'B'                    TO JP-RECORD-TYPE.
 16142     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16143     PERFORM 8400-LOG-JOURNAL-RECORD.
 16144
 16145     IF PB-CI-LIVES NOT NUMERIC
 16146         MOVE ZERO                    TO PB-CI-LIVES.
 16147
 16148     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16149        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16150           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16151           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16152           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16153                                            CM-LF-CANCEL-DT
 16154           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16155        ELSE
 16156           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16157           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16158           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16159           MOVE PB-CI-LIVES              TO CM-LIVES.
 16160
 16161     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16162        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16163           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 294
* VP6311.cbl
 16164               MOVE CM-LF-STATUS-AT-CANCEL
 16165                                        TO CM-LF-CURRENT-STATUS
 16166               MOVE SPACE
 16167                                        TO CM-LF-STATUS-AT-CANCEL
 16168           ELSE
 16169               MOVE PB-CI-LF-POLICY-STATUS
 16170                                        TO CM-LF-CURRENT-STATUS
 16171        ELSE
 16172           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16173
 16174
 16175     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16176        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16177           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16178           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16179           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16180                                            CM-AH-CANCEL-DT
 16181           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16182        ELSE
 16183           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16184           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16185           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16186           MOVE PB-CI-LIVES              TO CM-LIVES.
 16187
 16188     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16189        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16190           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16191               MOVE CM-AH-STATUS-AT-CANCEL
 16192                                        TO CM-AH-CURRENT-STATUS
 16193               MOVE SPACE
 16194                                        TO CM-AH-STATUS-AT-CANCEL
 16195           ELSE
 16196               MOVE PB-CI-AH-POLICY-STATUS
 16197                                        TO CM-AH-CURRENT-STATUS
 16198        ELSE
 16199           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16200
 16201 2450-REWRITE-CERT.
 16202     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16203     MOVE 'C'                      TO JP-RECORD-TYPE.
 16204     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16205
 16206
 16207* EXEC CICS REWRITE
 16208*        DATASET  (FILE-ID-ELCERT)
 16209*        FROM     (CERTIFICATE-MASTER)
 16210*    END-EXEC.
 16211     MOVE LENGTH OF
 16212      CERTIFICATE-MASTER
 16213       TO DFHEIV11
 16214*    MOVE '&& L                  %   #00014227' TO DFHEIV0
 16215     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16216     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16217     MOVE X'2020233030303134323237' TO DFHEIV0(25:11)
 16218     CALL 'kxdfhei1' USING DFHEIV0,
 16219           FILE-ID-ELCERT,
 16220           CERTIFICATE-MASTER,
 16221           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 295
* VP6311.cbl
 16222           DFHEIV99
 16223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16224
 16225
 16226     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16227
 16228     PERFORM 8400-LOG-JOURNAL-RECORD.
 16229
 16230     move ' '                    to ws-stop-sw
 16231                                    ws-proc-check-sw
 16232                                    ws-chek-browse-sw
 16233
 16234     if i-have-checks
 16235        perform until i-say-stop
 16236           perform 2510-startbr-erchek
 16237                                 thru 2510-exit
 16238           if resp-normal
 16239              perform 2520-readnext-erchek
 16240                                 thru 2520-exit
 16241           end-if
 16242           if (not resp-normal)
 16243              or (pb-control-by-account (1:33) not =
 16244                 ch-control-primary (1:33))
 16245                 set i-say-stop to true
 16246           else
 16247              perform 2530-readupd-erchek
 16248                                 thru 2530-exit
 16249              if resp-normal
 16250                 perform 2540-delete-erchek
 16251                                 thru 2540-exit
 16252              end-if
 16253              if ws-chek-browse-sw = 'Y'
 16254                 perform 2525-endbr-erchek
 16255                                 thru 2525-exit
 16256                 move ' '        to ws-chek-browse-sw
 16257              end-if
 16258           end-if
 16259        end-perform
 16260     end-if
 16261
 16262     if ws-chek-browse-sw = 'Y'
 16263        perform 2525-endbr-erchek thru 2525-exit
 16264     end-if
 16265     .
 16266 2475-CONTINUE-DELETE.
 16267     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16268     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16269
 16270     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16271     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16272
 16273     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16274
 16275     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16276     MOVE 'D'                    TO JP-RECORD-TYPE
 16277     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16278
 16279
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 296
* VP6311.cbl
 16280* EXEC CICS DELETE
 16281*        DATASET    (FILE-ID-ERPNDB)
 16282*    END-EXEC.
 16283*    MOVE '&(                    &   #00014285' TO DFHEIV0
 16284     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16285     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16286     MOVE X'2020233030303134323835' TO DFHEIV0(25:11)
 16287     CALL 'kxdfhei1' USING DFHEIV0,
 16288           FILE-ID-ERPNDB,
 16289           DFHEIV99,
 16290           DFHEIV99,
 16291           DFHEIV99,
 16292           DFHEIV99
 16293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16294
 16295
 16296     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16297
 16298     PERFORM 8400-LOG-JOURNAL-RECORD.
 16299
 16300     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16301     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16302
 16303
 16304* EXEC CICS HANDLE CONDITION
 16305*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16306*    END-EXEC.
 16307*    MOVE '"$I                   ! ; #00014296' TO DFHEIV0
 16308     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16310     MOVE X'3B20233030303134323936' TO DFHEIV0(25:11)
 16311     CALL 'kxdfhei1' USING DFHEIV0
 16312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16313
 16314
 16315
 16316* EXEC CICS READ
 16317*        SET     (ADDRESS OF PENDING-BUSINESS)
 16318*        DATASET (FILE-ID-ERPNDB)
 16319*        RIDFLD  (ERPNDB-KEY)
 16320*        UPDATE
 16321*    END-EXEC.
 16322*    MOVE '&"S        EU         (   #00014300' TO DFHEIV0
 16323     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16324     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16325     MOVE X'2020233030303134333030' TO DFHEIV0(25:11)
 16326     CALL 'kxdfhei1' USING DFHEIV0,
 16327           FILE-ID-ERPNDB,
 16328           DFHEIV20,
 16329           DFHEIV99,
 16330           ERPNDB-KEY,
 16331           DFHEIV99,
 16332           DFHEIV99,
 16333           DFHEIV99
 16334     SET ADDRESS OF PENDING-BUSINESS TO
 16335         DFHEIV20
 16336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16337
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 297
* VP6311.cbl
 16338
 16339     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16340     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16341
 16342     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16343        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16344        MOVE 'D'                 TO JP-RECORD-TYPE
 16345        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16346
 16347* EXEC CICS DELETE
 16348*            DATASET    (FILE-ID-ERPNDB)
 16349*       END-EXEC
 16350*    MOVE '&(                    &   #00014314' TO DFHEIV0
 16351     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16352     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16353     MOVE X'2020233030303134333134' TO DFHEIV0(25:11)
 16354     CALL 'kxdfhei1' USING DFHEIV0,
 16355           FILE-ID-ERPNDB,
 16356           DFHEIV99,
 16357           DFHEIV99,
 16358           DFHEIV99,
 16359           DFHEIV99
 16360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16361        PERFORM 8400-LOG-JOURNAL-RECORD
 16362     ELSE
 16363        MOVE 'B'                 TO JP-RECORD-TYPE
 16364        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16365        PERFORM 8400-LOG-JOURNAL-RECORD
 16366        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16367        MOVE 'C'                 TO JP-RECORD-TYPE
 16368        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16369
 16370* EXEC CICS REWRITE
 16371*            DATASET    (FILE-ID-ERPNDB)
 16372*            FROM       (PENDING-BUSINESS)
 16373*       END-EXEC
 16374     MOVE LENGTH OF
 16375      PENDING-BUSINESS
 16376       TO DFHEIV11
 16377*    MOVE '&& L                  %   #00014325' TO DFHEIV0
 16378     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16379     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16380     MOVE X'2020233030303134333235' TO DFHEIV0(25:11)
 16381     CALL 'kxdfhei1' USING DFHEIV0,
 16382           FILE-ID-ERPNDB,
 16383           PENDING-BUSINESS,
 16384           DFHEIV11,
 16385           DFHEIV99
 16386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16387        PERFORM 8400-LOG-JOURNAL-RECORD.
 16388
 16389******************************************************************
 16390*                                                                *
 16391*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16392*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16393*                                                                *
 16394******************************************************************
 16395
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 298
* VP6311.cbl
 16396     IF NOT PI-AR-PROCESSING
 16397        GO TO 2480-DELETE-FINISHED.
 16398
 16399     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16400        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16401        NEXT SENTENCE
 16402     ELSE
 16403        GO TO 2480-DELETE-FINISHED.
 16404
 16405
 16406* EXEC CICS HANDLE CONDITION
 16407*         NOTFND    (2480-DELETE-FINISHED)
 16408*    END-EXEC.
 16409*    MOVE '"$I                   ! < #00014347' TO DFHEIV0
 16410     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16412     MOVE X'3C20233030303134333437' TO DFHEIV0(25:11)
 16413     CALL 'kxdfhei1' USING DFHEIV0
 16414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16415
 16416
 16417     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16418     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16419
 16420
 16421* EXEC CICS READ
 16422*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16423*        DATASET (FILE-ID-ERRQST)
 16424*        RIDFLD  (ERRQST-KEY)
 16425*        UPDATE
 16426*    END-EXEC.
 16427*    MOVE '&"S        EU         (   #00014354' TO DFHEIV0
 16428     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16429     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16430     MOVE X'2020233030303134333534' TO DFHEIV0(25:11)
 16431     CALL 'kxdfhei1' USING DFHEIV0,
 16432           FILE-ID-ERRQST,
 16433           DFHEIV20,
 16434           DFHEIV99,
 16435           ERRQST-KEY,
 16436           DFHEIV99,
 16437           DFHEIV99,
 16438           DFHEIV99
 16439     SET ADDRESS OF AR-REQUEST-RECORD TO
 16440         DFHEIV20
 16441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16442
 16443
 16444     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16445
 16446     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16447
 16448     MOVE 'D'                      TO JP-RECORD-TYPE.
 16449     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16450
 16451
 16452* EXEC CICS DELETE
 16453*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 299
* VP6311.cbl
 16454*    END-EXEC.
 16455*    MOVE '&(                    &   #00014368' TO DFHEIV0
 16456     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16457     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16458     MOVE X'2020233030303134333638' TO DFHEIV0(25:11)
 16459     CALL 'kxdfhei1' USING DFHEIV0,
 16460           FILE-ID-ERRQST,
 16461           DFHEIV99,
 16462           DFHEIV99,
 16463           DFHEIV99,
 16464           DFHEIV99
 16465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16466
 16467
 16468     PERFORM 8400-LOG-JOURNAL-RECORD.
 16469
 16470 2480-DELETE-FINISHED.
 16471     MOVE ZEROS                  TO EMI-ERROR.
 16472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16473     MOVE LOW-VALUES             TO VP631CI.
 16474     MOVE -1                     TO CMAINTL.
 16475     GO TO 8100-SEND-INITIAL-MAP.
 16476
 16477 2485-BATCH-HDR-NOT-FOUND.
 16478     MOVE -1                     TO CMAINTL
 16479     MOVE AL-UABON               TO CMAINTA.
 16480     MOVE ER-7450                TO EMI-ERROR.
 16481     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16482     GO TO 8200-SEND-DATAONLY.
 16483
 16484 2490-RECORD-NOT-FOUND.
 16485     MOVE -1                     TO CMAINTL
 16486     MOVE AL-UABON               TO CMAINTA.
 16487     MOVE ER-7451                TO EMI-ERROR.
 16488     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16489     GO TO 8200-SEND-DATAONLY.
 16490***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16491***                                                            ***
 16492***     2500  B R O W S E   C H E C K S                        ***
 16493***  We perform this routine from 2 different places.          ***
 16494***  1. If the user changes the refund amount on a cancel, we  ***
 16495***    want to.........                                        ***
 16496***    a. determine if prior checks have been processed        ***
 16497***    b. If the amt is larger, display message instructing    ***
 16498***     them to create another check to make up the difference.***
 16499***    c. If the amt is less, do not allow the change and      ***
 16500***     display a FATAL error suggesting they deal with check  ***
 16501***     records befor continuing.                              ***
 16502***  2. If the user wants to delete a cancel record we......   ***
 16503***    a. browse through all the checks and if there is a      ***
 16504***     processed check, send FATAL message.                   ***
 16505***    b. If there is a non-released check, then delete that   ***
 16506***     check after you delete the pending cancel record.      ***
 16507***                                                            ***
 16508***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16509
 16510 2500-browse-checks.
 16511
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 300
* VP6311.cbl
 16512     perform 2510-startbr-erchek thru 2510-exit
 16513
 16514     if not resp-normal
 16515        go to 2500-exit
 16516     end-if
 16517
 16518     perform until i-say-stop
 16519        perform 2520-readnext-erchek
 16520                                 thru 2520-exit
 16521        if (not resp-normal)
 16522           or (pb-control-by-account (1:33) not =
 16523              ch-control-primary (1:33))
 16524              set i-say-stop to true
 16525        else
 16526           if (ch-approval-status) = ' '
 16527              and (ch-void-dt = low-values)
 16528              and (ch-released-dt = low-values)
 16529              set i-have-checks to true
 16530           else
 16531              if ch-void-dt = low-values
 16532                 set i-have-processed-checks to true
 16533              end-if
 16534           end-if
 16535           if (ch-credit-accept-dt = low-values)
 16536              and (ch-void-dt = low-values)
 16537              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16538              if (ch-check-origin-sw not = 'R')
 16539                 and (pb-record-type = '2')
 16540                 continue
 16541              else
 16542                 compute ws-check-amts =
 16543                    ws-check-amts + ch-amount-paid
 16544              end-if
 16545           end-if
 16546        end-if
 16547     end-perform
 16548
 16549     if ws-chek-browse-sw = 'Y'
 16550        perform 2525-endbr-erchek thru 2525-exit
 16551     end-if
 16552
 16553    .
 16554 2500-exit.
 16555     exit.
 16556
 16557 2510-startbr-erchek.
 16558
 16559     move pb-control-by-account  to erchek-key
 16560     move +0                     to chek-record-seq
 16561
 16562
 16563* exec cics startbr
 16564*       dataset   ('ERCHEK')
 16565*       ridfld    (erchek-key)
 16566*       gteq
 16567*       resp      (ws-response)
 16568*    end-exec
 16569     MOVE 'ERCHEK' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 301
* VP6311.cbl
 16570     MOVE 0
 16571       TO DFHEIV11
 16572*    MOVE '&,         G          &  N#00014466' TO DFHEIV0
 16573     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16574     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16575     MOVE X'204E233030303134343636' TO DFHEIV0(25:11)
 16576     CALL 'kxdfhei1' USING DFHEIV0,
 16577           DFHEIV1,
 16578           erchek-key,
 16579           DFHEIV99,
 16580           DFHEIV11,
 16581           DFHEIV99
 16582     MOVE EIBRESP  TO ws-response
 16583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16584
 16585     IF RESP-NORMAL
 16586        move 'Y'                 to ws-chek-browse-sw
 16587     end-if
 16588
 16589     .
 16590 2510-exit.
 16591     exit.
 16592
 16593 2520-readnext-erchek.
 16594
 16595
 16596* EXEC CICS READNEXT
 16597*       SET     (ADDRESS OF CHECK-RECORDS)
 16598*       DATASET ('ERCHEK')
 16599*       RIDFLD  (ERCHEK-KEY)
 16600*       RESP    (WS-RESPONSE)
 16601*    END-EXEC
 16602     MOVE 'ERCHEK' TO DFHEIV1
 16603     MOVE 0
 16604       TO DFHEIV11
 16605*    MOVE '&.S                   )  N#00014483' TO DFHEIV0
 16606     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16607     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16608     MOVE X'204E233030303134343833' TO DFHEIV0(25:11)
 16609     CALL 'kxdfhei1' USING DFHEIV0,
 16610           DFHEIV1,
 16611           DFHEIV20,
 16612           DFHEIV99,
 16613           ERCHEK-KEY,
 16614           DFHEIV99,
 16615           DFHEIV11,
 16616           DFHEIV99,
 16617           DFHEIV99
 16618     SET ADDRESS OF CHECK-RECORDS TO
 16619         DFHEIV20
 16620     MOVE EIBRESP  TO WS-RESPONSE
 16621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16622
 16623     .
 16624 2520-exit.
 16625     exit.
 16626
 16627 2525-endbr-erchek.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 302
* VP6311.cbl
 16628
 16629
 16630* exec cics endbr
 16631*       dataset  ('ERCHEK')
 16632*    end-exec
 16633     MOVE 'ERCHEK' TO DFHEIV1
 16634     MOVE 0
 16635       TO DFHEIV11
 16636*    MOVE '&2                    $   #00014496' TO DFHEIV0
 16637     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16638     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16639     MOVE X'2020233030303134343936' TO DFHEIV0(25:11)
 16640     CALL 'kxdfhei1' USING DFHEIV0,
 16641           DFHEIV1,
 16642           DFHEIV11,
 16643           DFHEIV99
 16644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16645
 16646     .
 16647 2525-exit.
 16648     exit.
 16649
 16650 2530-readupd-erchek.
 16651
 16652
 16653* EXEC CICS READ
 16654*       UPDATE
 16655*       SET     (ADDRESS OF CHECK-RECORDS)
 16656*       DATASET ('ERCHEK')
 16657*       RIDFLD  (ERCHEK-KEY)
 16658*       RESP    (WS-RESPONSE)
 16659*    END-EXEC
 16660     MOVE 'ERCHEK' TO DFHEIV1
 16661*    MOVE '&"S        EU         (  N#00014506' TO DFHEIV0
 16662     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16663     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16664     MOVE X'204E233030303134353036' TO DFHEIV0(25:11)
 16665     CALL 'kxdfhei1' USING DFHEIV0,
 16666           DFHEIV1,
 16667           DFHEIV20,
 16668           DFHEIV99,
 16669           ERCHEK-KEY,
 16670           DFHEIV99,
 16671           DFHEIV99,
 16672           DFHEIV99
 16673     SET ADDRESS OF CHECK-RECORDS TO
 16674         DFHEIV20
 16675     MOVE EIBRESP  TO WS-RESPONSE
 16676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16677
 16678     .
 16679 2530-exit.
 16680     exit.
 16681
 16682 2540-delete-erchek.
 16683
 16684
 16685* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 303
* VP6311.cbl
 16686*       DATASET ('ERCHEK')
 16687*       RESP    (WS-RESPONSE)
 16688*    END-EXEC
 16689     MOVE 'ERCHEK' TO DFHEIV1
 16690*    MOVE '&(                    &  N#00014520' TO DFHEIV0
 16691     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16692     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16693     MOVE X'204E233030303134353230' TO DFHEIV0(25:11)
 16694     CALL 'kxdfhei1' USING DFHEIV0,
 16695           DFHEIV1,
 16696           DFHEIV99,
 16697           DFHEIV99,
 16698           DFHEIV99,
 16699           DFHEIV99
 16700     MOVE EIBRESP  TO WS-RESPONSE
 16701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16702
 16703     .
 16704 2540-exit.
 16705     exit.
 16706***************************************************************
 16707*                                                             *
 16708*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16709*                                                             *
 16710***************************************************************
 16711
 16712***************************************************************
 16713*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16714*     AN ALREADY BILLED RECORD.                               *
 16715***************************************************************
 16716
 16717 2700-BUILD-CORRECTION-RECORD.
 16718     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16719     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16720     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16721     MOVE '5'                    TO DC-OPTION-CODE.
 16722     PERFORM 9700-DATE-LINK.
 16723     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16724
 16725     IF PB-CHG-COUNT = ZEROS
 16726        MOVE +1                  TO WS-SEQ-SAVE
 16727     ELSE
 16728        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16729
 16730     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16731     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16732
 16733     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16734
 16735     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16736     MOVE 'A'                    TO JP-RECORD-TYPE.
 16737     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16738
 16739
 16740* EXEC CICS WRITE
 16741*        DATASET    (FILE-ID-ERPNDB)
 16742*        FROM       (PENDING-BUSINESS)
 16743*        RIDFLD     (PB-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 304
* VP6311.cbl
 16744*    END-EXEC.
 16745     MOVE LENGTH OF
 16746      PENDING-BUSINESS
 16747       TO DFHEIV11
 16748*    MOVE '&$ L                  ''   #00014561' TO DFHEIV0
 16749     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16750     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16751     MOVE X'2020233030303134353631' TO DFHEIV0(25:11)
 16752     CALL 'kxdfhei1' USING DFHEIV0,
 16753           FILE-ID-ERPNDB,
 16754           PENDING-BUSINESS,
 16755           DFHEIV11,
 16756           PB-CONTROL-PRIMARY,
 16757           DFHEIV99,
 16758           DFHEIV99
 16759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16760
 16761
 16762     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16763
 16764     PERFORM 8400-LOG-JOURNAL-RECORD.
 16765
 16766 2799-EXIT.
 16767      EXIT.
 16768
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 305
* VP6311.cbl
 16770
 16771******************************************************************
 16772*                                                                *
 16773*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16774*                                                                *
 16775******************************************************************
 16776
 16777 2800-REWRITE-ISSUE-CERT-KEY.
 16778     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16779
 16780     IF  BCERTNOL GREATER THAN ZEROS
 16781         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16782
 16783     IF  BSUFIXL  GREATER THAN ZEROS
 16784         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16785
 16786     IF  BEFFDTL  GREATER THAN ZEROS
 16787         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16788
 16789 2810-READ-BY-ACCOUNT.
 16790
 16791* EXEC CICS HANDLE CONDITION
 16792*         NOTFND    (2820-PROCESS-REWRITE)
 16793*    END-EXEC.
 16794*    MOVE '"$I                   ! = #00014595' TO DFHEIV0
 16795     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16796     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16797     MOVE X'3D20233030303134353935' TO DFHEIV0(25:11)
 16798     CALL 'kxdfhei1' USING DFHEIV0
 16799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16800
 16801
 16802***  read pndb using new key
 16803
 16804* EXEC CICS READ
 16805*        SET     (ADDRESS OF PENDING-BUSINESS)
 16806*        DATASET (FILE-ID-ERPNDB2)
 16807*        RIDFLD  (ERPNDB-ALT-KEY)
 16808*    END-EXEC.
 16809*    MOVE '&"S        E          (   #00014600' TO DFHEIV0
 16810     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16811     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16812     MOVE X'2020233030303134363030' TO DFHEIV0(25:11)
 16813     CALL 'kxdfhei1' USING DFHEIV0,
 16814           FILE-ID-ERPNDB2,
 16815           DFHEIV20,
 16816           DFHEIV99,
 16817           ERPNDB-ALT-KEY,
 16818           DFHEIV99,
 16819           DFHEIV99,
 16820           DFHEIV99
 16821     SET ADDRESS OF PENDING-BUSINESS TO
 16822         DFHEIV20
 16823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16824
 16825
 16826     GO TO 2890-DUPLICATE-RECORD.
 16827
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 306
* VP6311.cbl
 16828  2820-PROCESS-REWRITE.
 16829
 16830* EXEC CICS HANDLE CONDITION
 16831*         NOTFND    (2885-RECORD-MISSING)
 16832*    END-EXEC.
 16833*    MOVE '"$I                   ! > #00014609' TO DFHEIV0
 16834     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16836     MOVE X'3E20233030303134363039' TO DFHEIV0(25:11)
 16837     CALL 'kxdfhei1' USING DFHEIV0
 16838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16839
 16840
 16841     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16842
 16843***  read pndb using original key
 16844
 16845* EXEC CICS READ
 16846*        SET     (ADDRESS OF PENDING-BUSINESS)
 16847*        DATASET (FILE-ID-ERPNDB)
 16848*        RIDFLD  (ERPNDB-KEY)
 16849*        UPDATE
 16850*    END-EXEC.
 16851*    MOVE '&"S        EU         (   #00014616' TO DFHEIV0
 16852     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16853     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16854     MOVE X'2020233030303134363136' TO DFHEIV0(25:11)
 16855     CALL 'kxdfhei1' USING DFHEIV0,
 16856           FILE-ID-ERPNDB,
 16857           DFHEIV20,
 16858           DFHEIV99,
 16859           ERPNDB-KEY,
 16860           DFHEIV99,
 16861           DFHEIV99,
 16862           DFHEIV99
 16863     SET ADDRESS OF PENDING-BUSINESS TO
 16864         DFHEIV20
 16865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16866
 16867
 16868     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16869     MOVE 'D'                    TO JP-RECORD-TYPE.
 16870     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16871     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16872
 16873     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16874
 16875     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16876     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16877     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16878
 16879***  delete pndb using original key
 16880
 16881* EXEC CICS DELETE
 16882*        DATASET    (FILE-ID-ERPNDB)
 16883*    END-EXEC.
 16884*    MOVE '&(                    &   #00014635' TO DFHEIV0
 16885     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 307
* VP6311.cbl
 16886     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16887     MOVE X'2020233030303134363335' TO DFHEIV0(25:11)
 16888     CALL 'kxdfhei1' USING DFHEIV0,
 16889           FILE-ID-ERPNDB,
 16890           DFHEIV99,
 16891           DFHEIV99,
 16892           DFHEIV99,
 16893           DFHEIV99
 16894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16895
 16896
 16897     PERFORM 8400-LOG-JOURNAL-RECORD.
 16898
 16899
 16900* EXEC CICS GETMAIN
 16901*        SET      (ADDRESS OF PENDING-BUSINESS)
 16902*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16903*        INITIMG  (GETMAIN-SPACE)
 16904*    END-EXEC.
 16905*    MOVE ',"IL                  $   #00014641' TO DFHEIV0
 16906     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16907     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16908     MOVE X'2020233030303134363431' TO DFHEIV0(25:11)
 16909     CALL 'kxdfhei1' USING DFHEIV0,
 16910           DFHEIV20,
 16911           ERPNDB-RECORD-LENGTH,
 16912           GETMAIN-SPACE
 16913     SET ADDRESS OF PENDING-BUSINESS TO
 16914         DFHEIV20
 16915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16916
 16917
 16918***  pending-business now has original record
 16919     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16920
 16921
 16922* EXEC CICS HANDLE CONDITION
 16923*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16924*    END-EXEC.
 16925*    MOVE '"$I                   ! ? #00014650' TO DFHEIV0
 16926     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16928     MOVE X'3F20233030303134363530' TO DFHEIV0(25:11)
 16929     CALL 'kxdfhei1' USING DFHEIV0
 16930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16931
 16932
 16933***  read elcert using original key
 16934
 16935* EXEC CICS READ
 16936*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16937*        DATASET (FILE-ID-ELCERT)
 16938*        RIDFLD  (ELCERT-KEY)
 16939*        UPDATE
 16940*    END-EXEC.
 16941*    MOVE '&"S        EU         (   #00014655' TO DFHEIV0
 16942     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16943     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 308
* VP6311.cbl
 16944     MOVE X'2020233030303134363535' TO DFHEIV0(25:11)
 16945     CALL 'kxdfhei1' USING DFHEIV0,
 16946           FILE-ID-ELCERT,
 16947           DFHEIV20,
 16948           DFHEIV99,
 16949           ELCERT-KEY,
 16950           DFHEIV99,
 16951           DFHEIV99,
 16952           DFHEIV99
 16953     SET ADDRESS OF CERTIFICATE-MASTER TO
 16954         DFHEIV20
 16955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16956
 16957
 16958     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16959     MOVE 'B'                    TO JP-RECORD-TYPE
 16960     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16961     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16962
 16963     IF INSURED-ADDR-PRESENT
 16964        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16965
 16966     IF CERT-NOTES-ARE-NOT-PRESENT
 16967        MOVE SPACE               TO WS-CERT-NOTE-SW
 16968     ELSE
 16969        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16970
 16971     IF CERT-ADDED-BATCH      OR
 16972        CERT-AND-CLAIM-ONLINE OR
 16973        CERT-WAS-CREATED-FOR-CLAIM
 16974        NEXT SENTENCE
 16975     ELSE
 16976        GO TO 2825-DELETE-CERTIFICATE.
 16977
 16978     PERFORM 8400-LOG-JOURNAL-RECORD.
 16979
 16980*********************************************************
 16981** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16982     IF CERT-ADDED-BATCH
 16983         GO TO 2822-REWRITE-ELCERT.
 16984*********************************************************
 16985
 16986     IF NO-CLAIM-ATTACHED
 16987        NEXT SENTENCE
 16988     ELSE
 16989        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16990        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16991
 16992 2822-REWRITE-ELCERT.
 16993     MOVE 'C'                    TO JP-RECORD-TYPE
 16994     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16995
 16996     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16997
 16998
 16999* EXEC CICS REWRITE
 17000*         DATASET    (FILE-ID-ELCERT)
 17001*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 309
* VP6311.cbl
 17002*    END-EXEC.
 17003     MOVE LENGTH OF
 17004      CERTIFICATE-MASTER
 17005       TO DFHEIV11
 17006*    MOVE '&& L                  %   #00014702' TO DFHEIV0
 17007     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17008     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17009     MOVE X'2020233030303134373032' TO DFHEIV0(25:11)
 17010     CALL 'kxdfhei1' USING DFHEIV0,
 17011           FILE-ID-ELCERT,
 17012           CERTIFICATE-MASTER,
 17013           DFHEIV11,
 17014           DFHEIV99
 17015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17016
 17017
 17018     PERFORM 8400-LOG-JOURNAL-RECORD.
 17019
 17020     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17021
 17022 2825-DELETE-CERTIFICATE.
 17023     MOVE 'D'                      TO JP-RECORD-TYPE.
 17024     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17025
 17026     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17027
 17028
 17029* EXEC CICS DELETE
 17030*         DATASET    (FILE-ID-ELCERT)
 17031*    END-EXEC.
 17032*    MOVE '&(                    &   #00014717' TO DFHEIV0
 17033     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17034     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17035     MOVE X'2020233030303134373137' TO DFHEIV0(25:11)
 17036     CALL 'kxdfhei1' USING DFHEIV0,
 17037           FILE-ID-ELCERT,
 17038           DFHEIV99,
 17039           DFHEIV99,
 17040           DFHEIV99,
 17041           DFHEIV99
 17042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17043
 17044
 17045     PERFORM 8400-LOG-JOURNAL-RECORD.
 17046
 17047******************************************************************
 17048*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17049******************************************************************
 17050
 17051     IF CERT-NOTES-ARE-PRESENT
 17052        NEXT SENTENCE
 17053     ELSE
 17054        GO TO 2827-DELETE-MAILING.
 17055
 17056
 17057* EXEC CICS HANDLE CONDITION
 17058*         NOTFND  (2827-DELETE-MAILING)
 17059*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 310
* VP6311.cbl
 17060*    MOVE '"$I                   ! @ #00014732' TO DFHEIV0
 17061     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17063     MOVE X'4020233030303134373332' TO DFHEIV0(25:11)
 17064     CALL 'kxdfhei1' USING DFHEIV0
 17065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17066
 17067
 17068
 17069* EXEC CICS READ
 17070*        EQUAL
 17071*        DATASET   (FILE-ID-ERNOTE)
 17072*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17073*        RIDFLD    (ELCERT-KEY)
 17074*        UPDATE
 17075*    END-EXEC.
 17076*    MOVE '&"S        EU         (   #00014736' TO DFHEIV0
 17077     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17078     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17079     MOVE X'2020233030303134373336' TO DFHEIV0(25:11)
 17080     CALL 'kxdfhei1' USING DFHEIV0,
 17081           FILE-ID-ERNOTE,
 17082           DFHEIV20,
 17083           DFHEIV99,
 17084           ELCERT-KEY,
 17085           DFHEIV99,
 17086           DFHEIV99,
 17087           DFHEIV99
 17088     SET ADDRESS OF CERTIFICATE-NOTE TO
 17089         DFHEIV20
 17090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17091
 17092
 17093     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17094     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17095     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17096
 17097     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17098
 17099
 17100* EXEC CICS DELETE
 17101*        DATASET   (FILE-ID-ERNOTE)
 17102*    END-EXEC.
 17103*    MOVE '&(                    &   #00014750' TO DFHEIV0
 17104     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17105     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17106     MOVE X'2020233030303134373530' TO DFHEIV0(25:11)
 17107     CALL 'kxdfhei1' USING DFHEIV0,
 17108           FILE-ID-ERNOTE,
 17109           DFHEIV99,
 17110           DFHEIV99,
 17111           DFHEIV99,
 17112           DFHEIV99
 17113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17114
 17115
 17116     PERFORM 8400-LOG-JOURNAL-RECORD.
 17117
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 311
* VP6311.cbl
 17118******************************************************************
 17119*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17120******************************************************************
 17121
 17122 2827-DELETE-MAILING.
 17123     IF CERT-ADDRESS-PRESENT
 17124        NEXT SENTENCE
 17125     ELSE
 17126        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17127
 17128
 17129* EXEC CICS HANDLE CONDITION
 17130*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17131*    END-EXEC.
 17132*    MOVE '"$I                   ! A #00014766' TO DFHEIV0
 17133     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17135     MOVE X'4120233030303134373636' TO DFHEIV0(25:11)
 17136     CALL 'kxdfhei1' USING DFHEIV0
 17137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17138
 17139
 17140     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17141
 17142
 17143* EXEC CICS READ
 17144*        EQUAL
 17145*        DATASET   (FILE-ID-ERMAIL)
 17146*        SET       (ADDRESS OF MAILING-DATA)
 17147*        RIDFLD    (ERMAIL-KEY)
 17148*        UPDATE
 17149*    END-EXEC.
 17150*    MOVE '&"S        EU         (   #00014772' TO DFHEIV0
 17151     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17152     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17153     MOVE X'2020233030303134373732' TO DFHEIV0(25:11)
 17154     CALL 'kxdfhei1' USING DFHEIV0,
 17155           FILE-ID-ERMAIL,
 17156           DFHEIV20,
 17157           DFHEIV99,
 17158           ERMAIL-KEY,
 17159           DFHEIV99,
 17160           DFHEIV99,
 17161           DFHEIV99
 17162     SET ADDRESS OF MAILING-DATA TO
 17163         DFHEIV20
 17164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17165
 17166
 17167     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17168     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17169     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17170
 17171     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17172
 17173
 17174* EXEC CICS DELETE
 17175*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 312
* VP6311.cbl
 17176*    END-EXEC.
 17177*    MOVE '&(                    &   #00014786' TO DFHEIV0
 17178     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17179     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17180     MOVE X'2020233030303134373836' TO DFHEIV0(25:11)
 17181     CALL 'kxdfhei1' USING DFHEIV0,
 17182           FILE-ID-ERMAIL,
 17183           DFHEIV99,
 17184           DFHEIV99,
 17185           DFHEIV99,
 17186           DFHEIV99
 17187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17188
 17189
 17190     PERFORM 8400-LOG-JOURNAL-RECORD.
 17191
 17192 2830-BUILD-NEW-ISSUE-RECORD.
 17193     MOVE SPACES                 TO ELCERT-KEY.
 17194
 17195     IF  BCERTNOL GREATER THAN ZEROS
 17196         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17197
 17198     IF  BSUFIXL  GREATER THAN ZEROS
 17199         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17200
 17201     IF BEFFDTL GREATER THAN ZEROS
 17202        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17203
 17204 2870-WRITE-PENDING-BUSINESS.
 17205     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17206     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17207     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17208     MOVE '5'                    TO DC-OPTION-CODE.
 17209     PERFORM 9700-DATE-LINK.
 17210     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17211
 17212     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17213
 17214     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17215     MOVE 'A'                    TO JP-RECORD-TYPE.
 17216     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17217
 17218
 17219* EXEC CICS WRITE
 17220*        DATASET  (FILE-ID-ERPNDB)
 17221*        FROM     (PENDING-BUSINESS)
 17222*        RIDFLD   (PB-CONTROL-PRIMARY)
 17223*    END-EXEC.
 17224     MOVE LENGTH OF
 17225      PENDING-BUSINESS
 17226       TO DFHEIV11
 17227*    MOVE '&$ L                  ''   #00014818' TO DFHEIV0
 17228     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17229     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17230     MOVE X'2020233030303134383138' TO DFHEIV0(25:11)
 17231     CALL 'kxdfhei1' USING DFHEIV0,
 17232           FILE-ID-ERPNDB,
 17233           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 313
* VP6311.cbl
 17234           DFHEIV11,
 17235           PB-CONTROL-PRIMARY,
 17236           DFHEIV99,
 17237           DFHEIV99
 17238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17239
 17240
 17241     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17242
 17243     PERFORM 8400-LOG-JOURNAL-RECORD.
 17244
 17245     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17246
 17247 2885-RECORD-MISSING.
 17248     MOVE -1                     TO BMAINTL
 17249     MOVE AL-UABON               TO BMAINTA
 17250     MOVE ER-2902                TO EMI-ERROR.
 17251     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17252     GO TO 8200-SEND-DATAONLY.
 17253
 17254 2890-DUPLICATE-RECORD.
 17255     MOVE -1                     TO BMAINTL.
 17256     MOVE AL-UABON               TO BCERTNOA.
 17257     MOVE AL-UNBON               TO BEFFDTA.
 17258     MOVE SPACE                  TO BMAINTI.
 17259
 17260     MOVE 1                      TO EMI-SUB
 17261                                    EMI-SWITCH1
 17262                                    EMI-SWITCH-AREA-1
 17263                                    EMI-SWITCH-AREA-2.
 17264
 17265     MOVE SPACES                 TO EMI-ERROR-LINES.
 17266
 17267
 17268* EXEC CICS SYNCPOINT ROLLBACK
 17269*    END-EXEC.
 17270*    MOVE '6"R                   !   #00014850' TO DFHEIV0
 17271     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17272     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17273     MOVE X'2020233030303134383530' TO DFHEIV0(25:11)
 17274     CALL 'kxdfhei1' USING DFHEIV0
 17275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17276
 17277
 17278     MOVE ER-2247                TO EMI-ERROR.
 17279     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17280     GO TO 8200-SEND-DATAONLY.
 17281
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 314
* VP6311.cbl
 17283
 17284******************************************************************
 17285*                                                                *
 17286*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17287*                                                                *
 17288******************************************************************
 17289
 17290 2900-REWRITE-CAN-CERT-KEY.
 17291     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17292
 17293     IF  CCERTNOL GREATER THAN ZEROS
 17294         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17295
 17296     IF  CSUFIXL  GREATER THAN ZEROS
 17297         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17298
 17299     IF  CEFFDTL  GREATER THAN ZEROS
 17300         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17301
 17302 2910-READ-BY-ACCOUNT.
 17303
 17304* EXEC CICS HANDLE CONDITION
 17305*         NOTFND    (2920-PROCESS-REWRITE)
 17306*    END-EXEC.
 17307*    MOVE '"$I                   ! B #00014878' TO DFHEIV0
 17308     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17310     MOVE X'4220233030303134383738' TO DFHEIV0(25:11)
 17311     CALL 'kxdfhei1' USING DFHEIV0
 17312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17313
 17314
 17315
 17316* EXEC CICS READ
 17317*        SET     (ADDRESS OF PENDING-BUSINESS)
 17318*        DATASET (FILE-ID-ERPNDB2)
 17319*        RIDFLD  (ERPNDB-ALT-KEY)
 17320*    END-EXEC.
 17321*    MOVE '&"S        E          (   #00014882' TO DFHEIV0
 17322     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17323     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17324     MOVE X'2020233030303134383832' TO DFHEIV0(25:11)
 17325     CALL 'kxdfhei1' USING DFHEIV0,
 17326           FILE-ID-ERPNDB2,
 17327           DFHEIV20,
 17328           DFHEIV99,
 17329           ERPNDB-ALT-KEY,
 17330           DFHEIV99,
 17331           DFHEIV99,
 17332           DFHEIV99
 17333     SET ADDRESS OF PENDING-BUSINESS TO
 17334         DFHEIV20
 17335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17336
 17337
 17338     GO TO 2990-DUPLICATE-RECORD.
 17339
 17340  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 315
* VP6311.cbl
 17341
 17342* EXEC CICS HANDLE CONDITION
 17343*         NOTFND    (2985-RECORD-MISSING)
 17344*    END-EXEC.
 17345*    MOVE '"$I                   ! C #00014891' TO DFHEIV0
 17346     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17348     MOVE X'4320233030303134383931' TO DFHEIV0(25:11)
 17349     CALL 'kxdfhei1' USING DFHEIV0
 17350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17351
 17352
 17353     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17354
 17355
 17356* EXEC CICS READ
 17357*        SET     (ADDRESS OF PENDING-BUSINESS)
 17358*        DATASET (FILE-ID-ERPNDB)
 17359*        RIDFLD  (ERPNDB-KEY)
 17360*        UPDATE
 17361*    END-EXEC.
 17362*    MOVE '&"S        EU         (   #00014897' TO DFHEIV0
 17363     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17364     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17365     MOVE X'2020233030303134383937' TO DFHEIV0(25:11)
 17366     CALL 'kxdfhei1' USING DFHEIV0,
 17367           FILE-ID-ERPNDB,
 17368           DFHEIV20,
 17369           DFHEIV99,
 17370           ERPNDB-KEY,
 17371           DFHEIV99,
 17372           DFHEIV99,
 17373           DFHEIV99
 17374     SET ADDRESS OF PENDING-BUSINESS TO
 17375         DFHEIV20
 17376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17377
 17378
 17379     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17380     MOVE 'D'                    TO JP-RECORD-TYPE.
 17381     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17382     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17383
 17384     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17385
 17386     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17387     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17388     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17389
 17390
 17391* EXEC CICS DELETE
 17392*        DATASET    (FILE-ID-ERPNDB)
 17393*    END-EXEC.
 17394*    MOVE '&(                    &   #00014915' TO DFHEIV0
 17395     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17396     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17397     MOVE X'2020233030303134393135' TO DFHEIV0(25:11)
 17398     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 316
* VP6311.cbl
 17399           FILE-ID-ERPNDB,
 17400           DFHEIV99,
 17401           DFHEIV99,
 17402           DFHEIV99,
 17403           DFHEIV99
 17404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17405
 17406
 17407     PERFORM 8400-LOG-JOURNAL-RECORD.
 17408
 17409
 17410* EXEC CICS GETMAIN
 17411*        SET      (ADDRESS OF PENDING-BUSINESS)
 17412*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17413*        INITIMG  (GETMAIN-SPACE)
 17414*    END-EXEC.
 17415*    MOVE ',"IL                  $   #00014921' TO DFHEIV0
 17416     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17417     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17418     MOVE X'2020233030303134393231' TO DFHEIV0(25:11)
 17419     CALL 'kxdfhei1' USING DFHEIV0,
 17420           DFHEIV20,
 17421           ERPNDB-RECORD-LENGTH,
 17422           GETMAIN-SPACE
 17423     SET ADDRESS OF PENDING-BUSINESS TO
 17424         DFHEIV20
 17425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17426
 17427
 17428     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17429
 17430 2950-PROCESS-CANCELS.
 17431
 17432
 17433* EXEC CICS HANDLE CONDITION
 17434*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17435*    END-EXEC.
 17436*    MOVE '"$I                   ! D #00014931' TO DFHEIV0
 17437     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17439     MOVE X'4420233030303134393331' TO DFHEIV0(25:11)
 17440     CALL 'kxdfhei1' USING DFHEIV0
 17441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17442
 17443
 17444
 17445* EXEC CICS READ
 17446*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17447*        DATASET (FILE-ID-ELCERT)
 17448*        RIDFLD  (ELCERT-KEY)
 17449*        UPDATE
 17450*    END-EXEC.
 17451*    MOVE '&"S        EU         (   #00014935' TO DFHEIV0
 17452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17453     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17454     MOVE X'2020233030303134393335' TO DFHEIV0(25:11)
 17455     CALL 'kxdfhei1' USING DFHEIV0,
 17456           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 317
* VP6311.cbl
 17457           DFHEIV20,
 17458           DFHEIV99,
 17459           ELCERT-KEY,
 17460           DFHEIV99,
 17461           DFHEIV99,
 17462           DFHEIV99
 17463     SET ADDRESS OF CERTIFICATE-MASTER TO
 17464         DFHEIV20
 17465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17466
 17467
 17468     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17469
 17470     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17471     MOVE 'B'                      TO JP-RECORD-TYPE.
 17472     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17473     PERFORM 8400-LOG-JOURNAL-RECORD.
 17474
 17475     IF PB-CI-LIVES NOT NUMERIC
 17476         MOVE ZERO                    TO PB-CI-LIVES.
 17477
 17478     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17479        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17480        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17481        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17482                                         CM-LF-CANCEL-DT
 17483     ELSE
 17484        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17485        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17486        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17487        MOVE PB-CI-LIVES              TO CM-LIVES.
 17488
 17489     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17490        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17491            MOVE CM-LF-STATUS-AT-CANCEL
 17492                                     TO CM-LF-CURRENT-STATUS
 17493            MOVE SPACE
 17494                                     TO CM-LF-STATUS-AT-CANCEL
 17495        ELSE
 17496            MOVE PB-CI-LF-POLICY-STATUS
 17497                                     TO CM-LF-CURRENT-STATUS
 17498     ELSE
 17499        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17500
 17501     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17502        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17503        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17504        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17505                                         CM-AH-CANCEL-DT
 17506     ELSE
 17507        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17508        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17509        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17510        MOVE PB-CI-LIVES              TO CM-LIVES.
 17511
 17512     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17513        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17514            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 318
* VP6311.cbl
 17515                                     TO CM-AH-CURRENT-STATUS
 17516            MOVE SPACE
 17517                                     TO CM-AH-STATUS-AT-CANCEL
 17518        ELSE
 17519            MOVE PB-CI-AH-POLICY-STATUS
 17520                                     TO CM-AH-CURRENT-STATUS
 17521     ELSE
 17522        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17523
 17524 2975-REWRITE-CERT.
 17525     MOVE 'C'                      TO JP-RECORD-TYPE.
 17526     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17527
 17528
 17529* EXEC CICS REWRITE
 17530*        DATASET    (FILE-ID-ELCERT)
 17531*        FROM       (CERTIFICATE-MASTER)
 17532*    END-EXEC.
 17533     MOVE LENGTH OF
 17534      CERTIFICATE-MASTER
 17535       TO DFHEIV11
 17536*    MOVE '&& L                  %   #00015002' TO DFHEIV0
 17537     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17538     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17539     MOVE X'2020233030303135303032' TO DFHEIV0(25:11)
 17540     CALL 'kxdfhei1' USING DFHEIV0,
 17541           FILE-ID-ELCERT,
 17542           CERTIFICATE-MASTER,
 17543           DFHEIV11,
 17544           DFHEIV99
 17545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17546
 17547
 17548     PERFORM 8400-LOG-JOURNAL-RECORD.
 17549
 17550 2960-BUILD-NEW-CANCEL-RECORD.
 17551     IF  CCERTNOL GREATER THAN ZEROS
 17552         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17553
 17554     IF  CSUFIXL  GREATER THAN ZEROS
 17555         MOVE CSUFIXI             TO PB-CERT-SFX.
 17556
 17557     IF  CEFFDTL  GREATER  THAN ZEROS
 17558         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17559
 17560 2970-WRITE-PENDING-BUSINESS.
 17561     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17562     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17563     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17564     MOVE '5'                    TO DC-OPTION-CODE.
 17565     PERFORM 9700-DATE-LINK.
 17566     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17567
 17568     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17569
 17570     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17571                                    PB-CI-INSURED-SEX
 17572                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 319
* VP6311.cbl
 17573                                    PB-CI-AH-BENEFIT-CD
 17574                                    PB-CI-RATE-CLASS
 17575                                    PB-CI-RATE-DEV-LF
 17576                                    PB-CI-RATE-DEV-AH
 17577                                    PB-CI-LF-ABBR
 17578                                    PB-CI-AH-ABBR
 17579                                    PB-CI-OB-FLAG
 17580                                    PB-CI-LF-POLICY-STATUS
 17581                                    PB-CI-AH-POLICY-STATUS
 17582                                    PB-CI-INDV-GRP-CD
 17583                                    PB-CI-BENEFICIARY-NAME
 17584                                    PB-CI-NOTE-SW
 17585                                    PB-CI-SOC-SEC-NO
 17586                                    PB-CI-MEMBER-NO
 17587                                    PB-CI-INT-CODE
 17588                                    PB-CI-COMP-EXCP-SW
 17589                                    PB-CI-ENTRY-STATUS
 17590                                    PB-CI-CREDIT-INTERFACE-SW-1
 17591                                    PB-CI-CREDIT-INTERFACE-SW-2
 17592                                    PB-CI-ENTRY-BATCH.
 17593
 17594     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17595                                    PB-CI-AH-SETTLEMENT-DT
 17596                                    PB-CI-DEATH-DT
 17597                                    PB-CI-LF-PRIOR-CANCEL-DT
 17598                                    PB-CI-AH-PRIOR-CANCEL-DT
 17599                                    PB-CI-LOAN-1ST-PMT-DT
 17600                                    PB-CI-ENTRY-DT
 17601                                    PB-CI-LF-EXPIRE-DT
 17602                                    PB-CI-AH-EXPIRE-DT.
 17603
 17604     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17605                                    PB-CI-LF-TERM
 17606                                    PB-CI-LF-BENEFIT-AMT
 17607                                    PB-CI-LF-ALT-BENEFIT-AMT
 17608                                    PB-CI-LF-PREMIUM-AMT
 17609                                    PB-CI-LF-ALT-PREMIUM-AMT
 17610                                    PB-CI-AH-TERM
 17611                                    PB-CI-AH-BENEFIT-AMT
 17612                                    PB-CI-AH-PREMIUM-AMT
 17613                                    PB-CI-RATE-DEV-PCT-LF
 17614                                    PB-CI-RATE-DEV-PCT-AH
 17615                                    PB-CI-LIFE-COMMISSION
 17616                                    PB-CI-AH-COMMISSION
 17617                                    PB-CI-PAY-FREQUENCY
 17618                                    PB-CI-LOAN-APR
 17619                                    PB-CI-LOAN-TERM
 17620                                    PB-CI-CURR-SEQ
 17621                                    PB-CI-AH-CANCEL-AMT
 17622                                    PB-CI-LF-CANCEL-AMT
 17623                                    PB-CI-EXTENTION-DAYS
 17624                                    PB-CI-TERM-IN-DAYS
 17625                                    PB-CI-LOAN-OFFICER
 17626                                    PB-CI-LIVES
 17627                                    PB-CI-LF-CRIT-PER
 17628                                    PB-CI-AH-CRIT-PER
 17629                                    PB-C-LF-REM-TERM
 17630                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 320
* VP6311.cbl
 17631
 17632     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17633     MOVE 'A'                    TO JP-RECORD-TYPE.
 17634     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17635
 17636
 17637* EXEC CICS HANDLE CONDITION
 17638*        DUPREC   (2990-DUPLICATE-RECORD)
 17639*    END-EXEC.
 17640*    MOVE '"$%                   ! E #00015095' TO DFHEIV0
 17641     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17643     MOVE X'4520233030303135303935' TO DFHEIV0(25:11)
 17644     CALL 'kxdfhei1' USING DFHEIV0
 17645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17646
 17647
 17648
 17649* EXEC CICS WRITE
 17650*        DATASET  (FILE-ID-ERPNDB)
 17651*        FROM     (PENDING-BUSINESS)
 17652*        RIDFLD   (PB-CONTROL-PRIMARY)
 17653*    END-EXEC.
 17654     MOVE LENGTH OF
 17655      PENDING-BUSINESS
 17656       TO DFHEIV11
 17657*    MOVE '&$ L                  ''   #00015099' TO DFHEIV0
 17658     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17659     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17660     MOVE X'2020233030303135303939' TO DFHEIV0(25:11)
 17661     CALL 'kxdfhei1' USING DFHEIV0,
 17662           FILE-ID-ERPNDB,
 17663           PENDING-BUSINESS,
 17664           DFHEIV11,
 17665           PB-CONTROL-PRIMARY,
 17666           DFHEIV99,
 17667           DFHEIV99
 17668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17669
 17670
 17671     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17672
 17673     PERFORM 8400-LOG-JOURNAL-RECORD.
 17674
 17675     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17676
 17677 2985-RECORD-MISSING.
 17678     MOVE -1                     TO CMAINTL
 17679     MOVE AL-UABON               TO CMAINTA.
 17680
 17681     MOVE ER-2902                TO EMI-ERROR.
 17682     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17683     GO TO 8200-SEND-DATAONLY.
 17684
 17685 2990-DUPLICATE-RECORD.
 17686     MOVE SPACE                  TO CMAINTI.
 17687     MOVE -1                     TO CMAINTL.
 17688     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 321
* VP6311.cbl
 17689     MOVE AL-UNBON               TO CEFFDTA.
 17690
 17691     MOVE 1                      TO EMI-SUB
 17692                                    EMI-SWITCH1
 17693                                    EMI-SWITCH-AREA-1
 17694                                    EMI-SWITCH-AREA-2.
 17695     MOVE SPACES                 TO EMI-ERROR-LINES.
 17696
 17697
 17698* EXEC CICS SYNCPOINT ROLLBACK
 17699*    END-EXEC.
 17700*    MOVE '6"R                   !   #00015131' TO DFHEIV0
 17701     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17703     MOVE X'2020233030303135313331' TO DFHEIV0(25:11)
 17704     CALL 'kxdfhei1' USING DFHEIV0
 17705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17706
 17707
 17708     MOVE ER-2247                TO EMI-ERROR.
 17709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17710     GO TO 8200-SEND-DATAONLY.
 17711
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 322
* VP6311.cbl
 17713
 17714***************************************************************
 17715*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17716*     PREMIUM FOR A SINGLE BATCH.                             *
 17717*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17718***************************************************************
 17719
 17720 3000-BATCH-MAINLINE.
 17721     IF PI-PREV-KEY NOT = SPACES
 17722         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17723     ELSE
 17724         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17725
 17726     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17727
 17728 3010-READNEXT.
 17729
 17730* EXEC CICS READ
 17731*         DATASET    (FILE-ID-ERPNDB)
 17732*         SET        (ADDRESS OF PENDING-BUSINESS)
 17733*         RIDFLD     (ERPNDB-KEY)
 17734*         GTEQ
 17735*    END-EXEC.
 17736*    MOVE '&"S        G          (   #00015155' TO DFHEIV0
 17737     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17738     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17739     MOVE X'2020233030303135313535' TO DFHEIV0(25:11)
 17740     CALL 'kxdfhei1' USING DFHEIV0,
 17741           FILE-ID-ERPNDB,
 17742           DFHEIV20,
 17743           DFHEIV99,
 17744           ERPNDB-KEY,
 17745           DFHEIV99,
 17746           DFHEIV99,
 17747           DFHEIV99
 17748     SET ADDRESS OF PENDING-BUSINESS TO
 17749         DFHEIV20
 17750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17751
 17752
 17753     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17754        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17755          GO TO 3030-END-BATCH.
 17756
 17757     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17758
 17759     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17760        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17761          GO TO 3020-BUMP-SEQ.
 17762
 17763     IF PB-ISSUE
 17764        ADD +1                   TO WS-ISS-TOTAL-CNT
 17765        IF PB-FATAL-ERRORS
 17766           ADD +1                      TO WS-ISS-FATAL-CNT
 17767           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17768           GO TO 3020-BUMP-SEQ
 17769        ELSE
 17770           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 323
* VP6311.cbl
 17771              ADD +1                      TO WS-ISS-FORCE-CNT
 17772              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17773              GO TO 3020-BUMP-SEQ
 17774           ELSE
 17775              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17776                 ADD +1                      TO WS-ISS-HOLD-CNT
 17777                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17778                 GO TO 3020-BUMP-SEQ
 17779              ELSE
 17780                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17781                     THRU  3299-EXIT
 17782                 GO TO 3020-BUMP-SEQ.
 17783
 17784     IF PB-CANCELLATION
 17785        ADD +1                   TO WS-CAN-TOTAL-CNT
 17786        IF PB-FATAL-ERRORS
 17787           ADD +1                 TO WS-CAN-FATAL-CNT
 17788           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17789           GO TO 3020-BUMP-SEQ
 17790        ELSE
 17791           IF PB-UNFORCED-ERRORS
 17792              ADD +1                 TO WS-CAN-FORCE-CNT
 17793              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17794              GO TO 3020-BUMP-SEQ
 17795           ELSE
 17796              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17797                 ADD +1                 TO WS-CAN-HOLD-CNT
 17798                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17799                 GO TO 3020-BUMP-SEQ
 17800              ELSE
 17801                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17802                     THRU  3499-EXIT
 17803                 GO TO 3020-BUMP-SEQ.
 17804
 17805     IF PB-BATCH-TRAILER
 17806         GO TO 3030-END-BATCH.
 17807
 17808 3020-BUMP-SEQ.
 17809     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17810     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17811     GO TO 3010-READNEXT.
 17812
 17813 3030-END-BATCH.
 17814     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17815     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17816     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17817     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17818
 17819     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17820                                          - WS-ISS-FORCE-CNT
 17821                                          - WS-ISS-HOLD-CNT).
 17822
 17823     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17824     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17825
 17826     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17827     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17828     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 324
* VP6311.cbl
 17829     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17830     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17831                                          - WS-CAN-FORCE-CNT
 17832                                          - WS-CAN-HOLD-CNT).
 17833     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17834     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17835
 17836     COMPUTE WS-NET-TOTAL-CNT
 17837         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17838     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17839     COMPUTE WS-NET-FATAL-CNT
 17840         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17841     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17842     COMPUTE WS-NET-FORCE-CNT
 17843         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17844     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17845     COMPUTE WS-NET-HOLD-CNT
 17846         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17847     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17848
 17849     COMPUTE WS-NET-AVAIL-CNT
 17850          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17851                              - WS-ISS-FORCE-CNT
 17852                              - WS-ISS-HOLD-CNT)
 17853          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17854                              - WS-CAN-FORCE-CNT
 17855                              - WS-CAN-HOLD-CNT).
 17856     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17857
 17858     COMPUTE WS-NET-GOOD-PREM
 17859         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17860     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17861     COMPUTE WS-NET-BAD-PREM
 17862         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17863     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17864
 17865     MOVE 0000                   TO EMI-ERROR.
 17866     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17867     MOVE -1                     TO DPFENTRL.
 17868     GO TO 8200-SEND-DATAONLY.
 17869
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 325
* VP6311.cbl
 17871
 17872******************************************************************
 17873*                                                                *
 17874*           A D D    B A D   I S S U E   P R E M I U M           *
 17875*                                                                *
 17876******************************************************************
 17877
 17878 3100-ADD-BAD-ISSUE-PREM.
 17879     IF PB-OVERRIDE-LIFE
 17880       OR PB-OVERRIDE-BOTH
 17881           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17882           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17883       ELSE
 17884           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17885           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17886
 17887     IF PB-OVERRIDE-AH
 17888       OR PB-OVERRIDE-BOTH
 17889           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17890       ELSE
 17891           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17892
 17893 3199-EXIT.
 17894     EXIT.
 17895
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 326
* VP6311.cbl
 17897
 17898******************************************************************
 17899*                                                                *
 17900*       A D D   G O O D   I S S U E   P R E M I U M              *
 17901*                                                                *
 17902******************************************************************
 17903
 17904 3200-ADD-GOOD-ISSUE-PREM.
 17905     IF PB-OVERRIDE-LIFE
 17906       OR PB-OVERRIDE-BOTH
 17907           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17908           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17909       ELSE
 17910           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17911           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17912
 17913     IF PB-OVERRIDE-AH
 17914       OR PB-OVERRIDE-BOTH
 17915           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17916       ELSE
 17917           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17918
 17919 3299-EXIT.
 17920     EXIT.
 17921
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 327
* VP6311.cbl
 17923
 17924
 17925******************************************************************
 17926*                                                                *
 17927*        A D D   B A D   C A N C E L   P R E M I U M             *
 17928*                                                                *
 17929******************************************************************
 17930
 17931 3300-ADD-BAD-CANCEL-PREM.
 17932     IF PB-OVERRIDE-LIFE
 17933       OR PB-OVERRIDE-BOTH
 17934           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17935       ELSE
 17936           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17937
 17938     IF PB-OVERRIDE-AH
 17939       OR PB-OVERRIDE-BOTH
 17940           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17941       ELSE
 17942           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17943
 17944 3399-EXIT.
 17945     EXIT.
 17946
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 328
* VP6311.cbl
 17948
 17949******************************************************************
 17950*                                                                *
 17951*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17952*                                                                *
 17953******************************************************************
 17954
 17955 3400-ADD-GOOD-CANCEL-PREM.
 17956     IF PB-OVERRIDE-LIFE
 17957       OR PB-OVERRIDE-BOTH
 17958           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17959       ELSE
 17960           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17961
 17962     IF PB-OVERRIDE-AH
 17963       OR PB-OVERRIDE-BOTH
 17964           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17965       ELSE
 17966           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17967
 17968 3499-EXIT.
 17969     EXIT.
 17970
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 329
* VP6311.cbl
 17972
 17973******************************************************************
 17974*                                                                *
 17975*           E D I T   B A T C H   D A T A                        *
 17976*                                                                *
 17977******************************************************************
 17978
 17979 3500-EDIT-BATCH-DATA.
 17980     IF PI-PREV-KEY NOT = SPACES
 17981        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17982     ELSE
 17983        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17984
 17985     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17986     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17987
 17988
 17989* EXEC CICS HANDLE CONDITION
 17990*         NOTFND      (3590-NOT-FOUND)
 17991*    END-EXEC.
 17992*    MOVE '"$I                   ! F #00015397' TO DFHEIV0
 17993     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17995     MOVE X'4620233030303135333937' TO DFHEIV0(25:11)
 17996     CALL 'kxdfhei1' USING DFHEIV0
 17997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17998
 17999
 18000     IF DRISSL   GREATER THAN ZEROS OR
 18001        DRISSL   GREATER THAN ZEROS OR
 18002        DRLFPRML GREATER THAN ZEROS OR
 18003        DRAHPRML GREATER THAN ZEROS OR
 18004        DRCANCL  GREATER THAN ZEROS OR
 18005        DRLFRFDL GREATER THAN ZEROS OR
 18006        DRAHRFDL GREATER THAN ZEROS
 18007              NEXT SENTENCE
 18008          ELSE
 18009              MOVE ER-3224    TO EMI-ERROR
 18010              MOVE -1         TO DPFENTRL
 18011              MOVE AL-UNBON   TO DPFENTRA
 18012              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18013              GO TO 8200-SEND-DATAONLY.
 18014
 18015     IF NOT MODIFY-CAP
 18016         MOVE 'UPDATE'       TO SM-READ
 18017         PERFORM 9995-SECURITY-VIOLATION
 18018         MOVE ER-0070        TO EMI-ERROR
 18019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18020         GO TO 8100-SEND-INITIAL-MAP.
 18021
 18022        IF DRISSL GREATER THAN ZEROS
 18023           MOVE AL-UNNON         TO DRISSA
 18024           MOVE DRISSI           TO DEEDIT-FIELD
 18025           PERFORM 8600-DEEDIT
 18026           IF DEEDIT-FIELD-V0  NUMERIC
 18027              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18028           ELSE
 18029              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 330
* VP6311.cbl
 18030              MOVE -1         TO DRISSL
 18031              MOVE AL-UNBON   TO DRISSA
 18032              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18033
 18034        IF DRLFPRML GREATER THAN ZEROS
 18035           MOVE AL-UNNON         TO DRLFPRMA
 18036
 18037* EXEC CICS BIF DEEDIT
 18038*              FIELD  (DRLFPRMI)
 18039*              LENGTH (11)
 18040*          END-EXEC
 18041     MOVE 11
 18042       TO DFHEIV11
 18043*    MOVE '@"L                   #   #00015437' TO DFHEIV0
 18044     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18045     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18046     MOVE X'2020233030303135343337' TO DFHEIV0(25:11)
 18047     CALL 'kxdfhei1' USING DFHEIV0,
 18048           DRLFPRMI,
 18049           DFHEIV11
 18050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18051           IF DRLFPRMI NUMERIC
 18052              MOVE DRLFPRMI   TO WS-DRLFPRM
 18053*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18054*          PERFORM 8600-DEEDIT
 18055*          IF DEEDIT-FIELD-V2  NUMERIC
 18056*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18057           ELSE
 18058              MOVE ER-2223    TO EMI-ERROR
 18059              MOVE -1         TO DRLFPRML
 18060              MOVE AL-UNBON   TO DRLFPRMA
 18061              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18062
 18063        IF DRAHPRML GREATER THAN ZEROS
 18064           MOVE AL-UNNON         TO DRAHPRMA
 18065
 18066* EXEC CICS BIF DEEDIT
 18067*              FIELD  (DRAHPRMI)
 18068*              LENGTH (11)
 18069*          END-EXEC
 18070     MOVE 11
 18071       TO DFHEIV11
 18072*    MOVE '@"L                   #   #00015455' TO DFHEIV0
 18073     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18074     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18075     MOVE X'2020233030303135343535' TO DFHEIV0(25:11)
 18076     CALL 'kxdfhei1' USING DFHEIV0,
 18077           DRAHPRMI,
 18078           DFHEIV11
 18079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18080           IF DRAHPRMI NUMERIC
 18081              MOVE DRAHPRMI   TO WS-DRAHPRM
 18082*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18083*          PERFORM 8600-DEEDIT
 18084*          IF DEEDIT-FIELD-V2  NUMERIC
 18085*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18086           ELSE
 18087              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 331
* VP6311.cbl
 18088              MOVE -1         TO DRAHPRML
 18089              MOVE AL-UNBON   TO DRAHPRMA
 18090              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18091
 18092        IF DRCANCL GREATER THAN ZEROS
 18093           MOVE AL-UNNON         TO DRCANCA
 18094           MOVE DRCANCI          TO DEEDIT-FIELD
 18095           PERFORM 8600-DEEDIT
 18096           IF DEEDIT-FIELD-V0  NUMERIC
 18097              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18098           ELSE
 18099              MOVE ER-2223    TO EMI-ERROR
 18100              MOVE -1         TO DRCANCL
 18101              MOVE AL-UNBON   TO DRCANCL
 18102              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18103
 18104        IF DRLFRFDL GREATER THAN ZEROS
 18105           MOVE AL-UNNON         TO DRLFRFDA
 18106
 18107* EXEC CICS BIF DEEDIT
 18108*              FIELD  (DRLFRFDI)
 18109*              LENGTH (11)
 18110*          END-EXEC
 18111     MOVE 11
 18112       TO DFHEIV11
 18113*    MOVE '@"L                   #   #00015485' TO DFHEIV0
 18114     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18115     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18116     MOVE X'2020233030303135343835' TO DFHEIV0(25:11)
 18117     CALL 'kxdfhei1' USING DFHEIV0,
 18118           DRLFRFDI,
 18119           DFHEIV11
 18120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18121           IF DRLFRFDI NUMERIC
 18122              MOVE DRLFRFDI   TO WS-DRLFRFD
 18123*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18124*          PERFORM 8600-DEEDIT
 18125*          IF DEEDIT-FIELD-V2  NUMERIC
 18126*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18127           ELSE
 18128              MOVE ER-2223    TO EMI-ERROR
 18129              MOVE -1         TO DRLFRFDL
 18130              MOVE AL-UNBON   TO DRLFRFDA
 18131              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18132
 18133        IF DRAHRFDL GREATER THAN ZEROS
 18134           MOVE AL-UNNON         TO DRAHRFDA
 18135
 18136* EXEC CICS BIF DEEDIT
 18137*              FIELD  (DRAHRFDI)
 18138*              LENGTH (11)
 18139*          END-EXEC
 18140     MOVE 11
 18141       TO DFHEIV11
 18142*    MOVE '@"L                   #   #00015503' TO DFHEIV0
 18143     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18144     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18145     MOVE X'2020233030303135353033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 332
* VP6311.cbl
 18146     CALL 'kxdfhei1' USING DFHEIV0,
 18147           DRAHRFDI,
 18148           DFHEIV11
 18149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18150           IF DRAHRFDI NUMERIC
 18151              MOVE DRAHRFDI   TO WS-DRAHRFD
 18152*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18153*          PERFORM 8600-DEEDIT
 18154*          IF DEEDIT-FIELD-V2  NUMERIC
 18155*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18156           ELSE
 18157              MOVE ER-2223    TO EMI-ERROR
 18158              MOVE -1         TO DRAHRFDL
 18159              MOVE AL-UNBON   TO DRAHRFDA
 18160              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18161
 18162     IF EMI-ERROR = ZEROS
 18163        GO 3600-UPDATE-BATCH-HEADER.
 18164
 18165     GO TO 8200-SEND-DATAONLY.
 18166
 18167 3590-NOT-FOUND.
 18168     MOVE ER-2192                TO EMI-ERROR.
 18169     MOVE -1                     TO DPFENTRL.
 18170     MOVE AL-UNBON               TO DPFENTRA.
 18171     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18172     GO TO 8200-SEND-DATAONLY.
 18173
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 333
* VP6311.cbl
 18175
 18176******************************************************************
 18177*                                                                *
 18178*           U P D A T E   B A T C H   H E A D E R                *
 18179*                                                                *
 18180******************************************************************
 18181
 18182 3600-UPDATE-BATCH-HEADER.
 18183
 18184* EXEC CICS HANDLE CONDITION
 18185*         NOTFND      (3690-NOT-FOUND)
 18186*    END-EXEC.
 18187*    MOVE '"$I                   ! G #00015540' TO DFHEIV0
 18188     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18190     MOVE X'4720233030303135353430' TO DFHEIV0(25:11)
 18191     CALL 'kxdfhei1' USING DFHEIV0
 18192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18193
 18194
 18195
 18196* EXEC CICS READ
 18197*        DATASET (FILE-ID-ERPNDB)
 18198*        RIDFLD  (ERPNDB-KEY)
 18199*        SET     (ADDRESS OF PENDING-BUSINESS)
 18200*        UPDATE
 18201*    END-EXEC.
 18202*    MOVE '&"S        EU         (   #00015544' TO DFHEIV0
 18203     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18204     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18205     MOVE X'2020233030303135353434' TO DFHEIV0(25:11)
 18206     CALL 'kxdfhei1' USING DFHEIV0,
 18207           FILE-ID-ERPNDB,
 18208           DFHEIV20,
 18209           DFHEIV99,
 18210           ERPNDB-KEY,
 18211           DFHEIV99,
 18212           DFHEIV99,
 18213           DFHEIV99
 18214     SET ADDRESS OF PENDING-BUSINESS TO
 18215         DFHEIV20
 18216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18217
 18218
 18219     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18220     MOVE 'B'                    TO JP-RECORD-TYPE.
 18221     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18222
 18223     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18224
 18225     PERFORM 8400-LOG-JOURNAL-RECORD.
 18226
 18227     IF DRISSL GREATER THAN ZEROS
 18228        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18229
 18230     IF DRCANCL GREATER THAN ZEROS
 18231        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18232
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 334
* VP6311.cbl
 18233
 18234     IF DRLFPRML GREATER THAN ZEROS
 18235        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18236
 18237     IF DRAHPRML GREATER THAN ZEROS
 18238        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18239
 18240     IF DRLFRFDL GREATER THAN ZEROS
 18241        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18242
 18243     IF DRAHRFDL GREATER THAN ZEROS
 18244        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18245
 18246 3670-REWRITE-BATCH-HEADER.
 18247     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18248        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18249        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18250        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18251        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18252        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18253        MOVE SPACE               TO PB-OUT-BAL-CD
 18254     ELSE
 18255        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18256
 18257     MOVE 'C'                    TO JP-RECORD-TYPE.
 18258     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18259
 18260
 18261* EXEC CICS REWRITE
 18262*         DATASET      (FILE-ID-ERPNDB)
 18263*         FROM         (PENDING-BUSINESS)
 18264*    END-EXEC.
 18265     MOVE LENGTH OF
 18266      PENDING-BUSINESS
 18267       TO DFHEIV11
 18268*    MOVE '&& L                  %   #00015592' TO DFHEIV0
 18269     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18270     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18271     MOVE X'2020233030303135353932' TO DFHEIV0(25:11)
 18272     CALL 'kxdfhei1' USING DFHEIV0,
 18273           FILE-ID-ERPNDB,
 18274           PENDING-BUSINESS,
 18275           DFHEIV11,
 18276           DFHEIV99
 18277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18278
 18279
 18280     PERFORM 8400-LOG-JOURNAL-RECORD.
 18281
 18282     GO TO 7200-DISPLAY-BATCHES.
 18283
 18284 3690-NOT-FOUND.
 18285     MOVE ER-2192                TO EMI-ERROR.
 18286     MOVE -1                     TO DPFENTRL.
 18287     MOVE AL-UNBON               TO DPFENTRA.
 18288     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18289     GO TO 8200-SEND-DATAONLY.
 18290
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 335
* VP6311.cbl
 18292
 18293******************************************************************
 18294*                                                                *
 18295*           R E - D I S P L A Y   R E C O R D                    *
 18296*                                                                *
 18297******************************************************************
 18298
 18299 3900-RE-DISPLAY-RECORD.
 18300
 18301* EXEC CICS HANDLE CONDITION
 18302*         NOTFND   (3990-NOT-FOUND)
 18303*    END-EXEC.
 18304*    MOVE '"$I                   ! H #00015617' TO DFHEIV0
 18305     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18307     MOVE X'4820233030303135363137' TO DFHEIV0(25:11)
 18308     CALL 'kxdfhei1' USING DFHEIV0
 18309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18310
 18311
 18312     IF PI-DISPLAY-ORIGINAL-BATCH
 18313         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18314     ELSE
 18315         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18316
 18317
 18318* EXEC CICS READ
 18319*         DATASET   (FILE-ID)
 18320*         RIDFLD    (PI-PREV-KEY)
 18321*         SET       (ADDRESS OF PENDING-BUSINESS)
 18322*    END-EXEC.
 18323*    MOVE '&"S        E          (   #00015626' TO DFHEIV0
 18324     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18326     MOVE X'2020233030303135363236' TO DFHEIV0(25:11)
 18327     CALL 'kxdfhei1' USING DFHEIV0,
 18328           FILE-ID,
 18329           DFHEIV20,
 18330           DFHEIV99,
 18331           PI-PREV-KEY,
 18332           DFHEIV99,
 18333           DFHEIV99,
 18334           DFHEIV99
 18335     SET ADDRESS OF PENDING-BUSINESS TO
 18336         DFHEIV20
 18337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18338
 18339
 18340     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18341
 18342     IF PB-ISSUE
 18343         GO TO 7000-DISPLAY-ISSUES.
 18344
 18345     IF PB-CANCELLATION
 18346         GO TO 7100-DISPLAY-CANCELS.
 18347
 18348     IF PB-BATCH-TRAILER
 18349         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 336
* VP6311.cbl
 18350
 18351 3990-NOT-FOUND.
 18352     MOVE LOW-VALUES             TO VP631BI.
 18353
 18354     IF PI-MAP-NAME = VP631B
 18355         MOVE -1                  TO BMAINTL
 18356     ELSE
 18357         MOVE -1                  TO CMAINTL.
 18358
 18359     GO TO 8100-SEND-INITIAL-MAP.
 18360
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 337
* VP6311.cbl
 18362
 18363***************************************************************
 18364*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18365*                                                             *
 18366*      1. START BROWSE WITH                                   *
 18367*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18368*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18369*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18370*                                                             *
 18371*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18372*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18373*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18374*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18375*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18376*               AND IS IT TO BE DISPLAYED.                    *
 18377*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18378*               DISPLAYED.                                    *
 18379*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18380*               DISPLAYED.                                    *
 18381*                                                             *
 18382*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18383*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18384***************************************************************
 18385
 18386 4000-BROWSE-DETAIL-FORWARD.
 18387     IF FIRST-TIME
 18388        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18389     ELSE
 18390        IF SHOW-RECORD
 18391           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18392           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18393           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18394           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18395           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18396        ELSE
 18397           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18398
 18399
 18400* EXEC CICS HANDLE CONDITION
 18401*         NOTFND   (4050-END-RECORDS)
 18402*         ENDFILE  (4050-END-RECORDS)
 18403*    END-EXEC.
 18404*    MOVE '"$I''                  ! I #00015691' TO DFHEIV0
 18405     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18407     MOVE X'4920233030303135363931' TO DFHEIV0(25:11)
 18408     CALL 'kxdfhei1' USING DFHEIV0
 18409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18410
 18411
 18412
 18413* EXEC CICS STARTBR
 18414*         DATASET   (FILE-ID-ERPNDB2)
 18415*         RIDFLD    (ERPNDB-ALT-KEY)
 18416*    END-EXEC.
 18417     MOVE 0
 18418       TO DFHEIV11
 18419*    MOVE '&,         G          &   #00015696' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 338
* VP6311.cbl
 18420     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18422     MOVE X'2020233030303135363936' TO DFHEIV0(25:11)
 18423     CALL 'kxdfhei1' USING DFHEIV0,
 18424           FILE-ID-ERPNDB2,
 18425           ERPNDB-ALT-KEY,
 18426           DFHEIV99,
 18427           DFHEIV11,
 18428           DFHEIV99
 18429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18430
 18431
 18432     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18433
 18434     IF FIRST-TIME OR SHOW-RECORD
 18435        MOVE SPACE               TO WS-FIRST-TIME-SW
 18436        GO TO 4005-READ-NEXT-RECORD.
 18437
 18438
 18439* EXEC CICS READNEXT
 18440*         DATASET    (FILE-ID-ERPNDB2)
 18441*         SET        (ADDRESS OF PENDING-BUSINESS)
 18442*         RIDFLD     (ERPNDB-ALT-KEY)
 18443*    END-EXEC.
 18444     MOVE 0
 18445       TO DFHEIV11
 18446*    MOVE '&.S                   )   #00015707' TO DFHEIV0
 18447     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18448     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18449     MOVE X'2020233030303135373037' TO DFHEIV0(25:11)
 18450     CALL 'kxdfhei1' USING DFHEIV0,
 18451           FILE-ID-ERPNDB2,
 18452           DFHEIV20,
 18453           DFHEIV99,
 18454           ERPNDB-ALT-KEY,
 18455           DFHEIV99,
 18456           DFHEIV11,
 18457           DFHEIV99,
 18458           DFHEIV99
 18459     SET ADDRESS OF PENDING-BUSINESS TO
 18460         DFHEIV20
 18461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18462
 18463
 18464 4005-READ-NEXT-RECORD.
 18465
 18466* EXEC CICS READNEXT
 18467*         DATASET    (FILE-ID-ERPNDB2)
 18468*         SET        (ADDRESS OF PENDING-BUSINESS)
 18469*         RIDFLD     (ERPNDB-ALT-KEY)
 18470*    END-EXEC.
 18471     MOVE 0
 18472       TO DFHEIV11
 18473*    MOVE '&.S                   )   #00015714' TO DFHEIV0
 18474     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18475     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18476     MOVE X'2020233030303135373134' TO DFHEIV0(25:11)
 18477     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 339
* VP6311.cbl
 18478           FILE-ID-ERPNDB2,
 18479           DFHEIV20,
 18480           DFHEIV99,
 18481           ERPNDB-ALT-KEY,
 18482           DFHEIV99,
 18483           DFHEIV11,
 18484           DFHEIV99,
 18485           DFHEIV99
 18486     SET ADDRESS OF PENDING-BUSINESS TO
 18487         DFHEIV20
 18488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18489
 18490
 18491     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18492
 18493     IF WS-BATCH-PREFIX = '#CL'
 18494        GO TO 4005-READ-NEXT-RECORD.
 18495
 18496     IF SHOW-RECORD
 18497        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18498           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18499           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18500           PB-STATE         NOT = PI-PB-STATE          OR
 18501           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18502           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18503           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18504           GO TO 4050-END-RECORDS
 18505        ELSE
 18506           GO TO 4010-CHECK-REC-TYPE.
 18507
 18508     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18509        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18510        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18511        PB-STATE            NOT = PI-PB-STATE          OR
 18512        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18513        GO TO 4050-END-RECORDS.
 18514
 18515     IF PB-BATCH-TRAILER
 18516        GO TO 4005-READ-NEXT-RECORD.
 18517
 18518     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18519        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18520           GO TO 4005-READ-NEXT-RECORD
 18521        ELSE
 18522           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18523              GO TO 4010-CHECK-REC-TYPE
 18524           ELSE
 18525              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18526                 GO TO 4010-CHECK-REC-TYPE
 18527              ELSE
 18528                 GO TO 4005-READ-NEXT-RECORD.
 18529
 18530     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18531        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18532           GO TO 4005-READ-NEXT-RECORD.
 18533
 18534 4010-CHECK-REC-TYPE.
 18535     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 340
* VP6311.cbl
 18536         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18537             NEXT SENTENCE
 18538         ELSE
 18539             GO TO 4005-READ-NEXT-RECORD.
 18540
 18541     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18542         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18543             NEXT SENTENCE
 18544        ELSE
 18545             GO TO 4005-READ-NEXT-RECORD.
 18546
 18547     IF NOT DISPLAY-CHANGE-RECORDS AND
 18548            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18549        GO TO 4005-READ-NEXT-RECORD.
 18550
 18551     IF DISPLAY-HOLD-RECORDS AND
 18552        NOT PB-RECORD-ON-HOLD
 18553          GO TO 4005-READ-NEXT-RECORD.
 18554
 18555     IF PB-ISSUE
 18556        IF DISPLAY-CHK-REQ-RECORDS
 18557            GO TO 4005-READ-NEXT-RECORD.
 18558
 18559     IF PB-ISSUE
 18560        IF ISSUE-WITH-WARNING
 18561           IF PB-WARNING-ERRORS
 18562              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18563                  GO TO 4005-READ-NEXT-RECORD
 18564              ELSE
 18565                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18566                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18567                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18568                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18569                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18570                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18571                 GO TO 7000-DISPLAY-ISSUES
 18572           ELSE
 18573              GO TO 4005-READ-NEXT-RECORD.
 18574
 18575     IF PB-ISSUE
 18576        IF (ISSUES-IN-ERROR AND
 18577            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18578            ALL-ISSUES
 18579            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18580            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18581            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18582            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18583            MOVE PB-SV-STATE            TO PI-SV-STATE
 18584            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18585            GO TO 7000-DISPLAY-ISSUES
 18586        ELSE
 18587            GO TO 4005-READ-NEXT-RECORD.
 18588
 18589     IF PB-CANCELLATION
 18590        IF DISPLAY-CHK-REQ-RECORDS
 18591           IF PB-C-REFUND-REQUESTED
 18592              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18593              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 341
* VP6311.cbl
 18594              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18595              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18596              MOVE PB-SV-STATE            TO PI-SV-STATE
 18597              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18598              GO TO 7100-DISPLAY-CANCELS
 18599           ELSE
 18600               GO TO 4005-READ-NEXT-RECORD.
 18601
 18602     IF PB-CANCELLATION
 18603        IF CANCEL-WITH-WARNING
 18604           IF PB-WARNING-ERRORS
 18605              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18606                  GO TO 4005-READ-NEXT-RECORD
 18607              ELSE
 18608                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18609                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18610                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18611                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18612                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18613                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18614                 GO TO 7100-DISPLAY-CANCELS
 18615           ELSE
 18616              GO TO 4005-READ-NEXT-RECORD.
 18617
 18618     IF PB-CANCELLATION
 18619        IF (CANCEL-IN-ERROR  AND
 18620            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18621            ALL-CANCELS
 18622            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18623            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18624            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18625            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18626            MOVE PB-SV-STATE            TO PI-SV-STATE
 18627            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18628            GO TO 7100-DISPLAY-CANCELS.
 18629
 18630     GO TO 4005-READ-NEXT-RECORD.
 18631
 18632 4050-END-RECORDS.
 18633******************************************************************
 18634*                                                                *
 18635*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18636*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING
 18637*         PROGRAM.                                               *
 18638*                                                                *
 18639******************************************************************
 18640
 18641     IF BROWSE-STARTED
 18642        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18643
 18644* EXEC CICS ENDBR
 18645*            DATASET  (FILE-ID-ERPNDB2)
 18646*       END-EXEC.
 18647     MOVE 0
 18648       TO DFHEIV11
 18649*    MOVE '&2                    $   #00015872' TO DFHEIV0
 18650     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18651     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 342
* VP6311.cbl
 18652     MOVE X'2020233030303135383732' TO DFHEIV0(25:11)
 18653     CALL 'kxdfhei1' USING DFHEIV0,
 18654           FILE-ID-ERPNDB2,
 18655           DFHEIV11,
 18656           DFHEIV99
 18657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18658
 18659
 18660     IF  EIBTRNID NOT = TRANS-EXB1
 18661         IF PENDING-BUS-RECS-FOUND
 18662             NEXT SENTENCE
 18663           ELSE
 18664             MOVE '9'            TO PI-BROWSE-SW
 18665             GO TO 9400-CLEAR.
 18666
 18667     IF SHOW-RECORD
 18668        MOVE ER-2253            TO EMI-ERROR
 18669       ELSE
 18670        MOVE ER-2254            TO EMI-ERROR.
 18671
 18672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18673
 18674     IF PI-MAP-NAME = SPACES
 18675        MOVE -1                  TO DPFENTRL
 18676        MOVE VP631D               TO PI-MAP-NAME
 18677        GO TO 8100-SEND-INITIAL-MAP.
 18678
 18679     IF PI-MAP-NAME = VP631B
 18680        MOVE -1                  TO BMAINTL
 18681     ELSE
 18682        IF PI-MAP-NAME = VP631C
 18683           MOVE -1               TO CMAINTL
 18684        ELSE
 18685           MOVE -1               TO DPFENTRL.
 18686
 18687     GO TO 8200-SEND-DATAONLY.
 18688
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 343
* VP6311.cbl
 18690
 18691***************************************************************
 18692*                                                             *
 18693*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18694*                                                             *
 18695*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18696*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18697*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18698*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18699*                                                             *
 18700*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18701*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18702*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18703*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18704*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18705*                AND IS IT TO BE DISPLAYED.                   *
 18706*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18707*                DISPLAYED.                                   *
 18708*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18709*                DISPLAYED.                                   *
 18710*                                                             *
 18711*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18712*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18713*                                                             *
 18714*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18715*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18716*                THEY ARE NOT TO BE DISPLAYED.                *
 18717*                                                             *
 18718***************************************************************
 18719
 18720 4100-BROWSE-PRIMARY-FORWARD.
 18721     IF FIRST-TIME  OR SHOW-RECORD
 18722        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18723        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18724        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18725     ELSE
 18726        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18727        IF ERPNDB-BATCH-SEQ-NO = +9999
 18728           GO TO 4150-END-BATCH
 18729        ELSE
 18730           IF DISPLAY-CHANGE-RECORDS
 18731              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18732           ELSE
 18733              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18734              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18735
 18736     IF FIRST-TIME
 18737         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18738            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18739              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18740
 18741
 18742* EXEC CICS HANDLE CONDITION
 18743*         ENDFILE  (4150-END-BATCH)
 18744*    END-EXEC.
 18745*    MOVE '"$''                   ! J #00015957' TO DFHEIV0
 18746     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 344
* VP6311.cbl
 18748     MOVE X'4A20233030303135393537' TO DFHEIV0(25:11)
 18749     CALL 'kxdfhei1' USING DFHEIV0
 18750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18751
 18752
 18753 4105-READ-NEXT.
 18754
 18755* EXEC CICS HANDLE CONDITION
 18756*         NOTFND    (4150-END-BATCH)
 18757*    END-EXEC.
 18758*    MOVE '"$I                   ! K #00015962' TO DFHEIV0
 18759     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18760     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18761     MOVE X'4B20233030303135393632' TO DFHEIV0(25:11)
 18762     CALL 'kxdfhei1' USING DFHEIV0
 18763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18764
 18765
 18766     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18767
 18768     IF PI-DISPLAY-ORIGINAL-BATCH
 18769        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18770     ELSE
 18771        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18772
 18773
 18774* EXEC CICS READ
 18775*         DATASET   (FILE-ID)
 18776*         SET       (ADDRESS OF PENDING-BUSINESS)
 18777*         RIDFLD    (ERPNDB-KEY)
 18778*         GTEQ
 18779*    END-EXEC.
 18780*    MOVE '&"S        G          (   #00015973' TO DFHEIV0
 18781     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18783     MOVE X'2020233030303135393733' TO DFHEIV0(25:11)
 18784     CALL 'kxdfhei1' USING DFHEIV0,
 18785           FILE-ID,
 18786           DFHEIV20,
 18787           DFHEIV99,
 18788           ERPNDB-KEY,
 18789           DFHEIV99,
 18790           DFHEIV99,
 18791           DFHEIV99
 18792     SET ADDRESS OF PENDING-BUSINESS TO
 18793         DFHEIV20
 18794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18795
 18796
 18797     IF PI-DISPLAY-ORIGINAL-BATCH
 18798        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18799           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18800           GO TO 4150-END-BATCH
 18801        ELSE
 18802           IF PB-BATCH-TRAILER
 18803              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18804              GO TO 4105-READ-NEXT
 18805           ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 345
* VP6311.cbl
 18806              NEXT SENTENCE
 18807     ELSE
 18808        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18809           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18810           GO TO 4150-END-BATCH.
 18811
 18812     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18813
 18814     IF WS-BATCH-PREFIX = '#CL'
 18815         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18816         GO TO 4105-READ-NEXT.
 18817
 18818     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18819     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18820     MOVE PB-STATE               TO PI-PB-STATE.
 18821     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18822
 18823     IF PB-BATCH-TRAILER
 18824        IF SHOW-RECORD
 18825           GO TO 4150-END-BATCH
 18826        ELSE
 18827           MOVE ER-2251         TO EMI-ERROR
 18828           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18829           MOVE 1               TO PI-BROWSE-TYPE
 18830           GO TO 7200-DISPLAY-BATCHES.
 18831
 18832     IF SHOW-RECORD
 18833           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18834              GO TO 4110-BUMP-SEQ
 18835           ELSE
 18836              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18837                 GO TO 4110-BUMP-SEQ
 18838              ELSE
 18839                 GO TO 4107-CHECK-REC-TYPE.
 18840
 18841     IF NOT  PI-PRIMARY-WITH-SELECT
 18842        GO TO 4107-CHECK-REC-TYPE.
 18843
 18844     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18845        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18846           GO TO 4110-BUMP-SEQ
 18847        ELSE
 18848           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18849              GO TO 4107-CHECK-REC-TYPE
 18850           ELSE
 18851              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18852                 GO TO 4107-CHECK-REC-TYPE
 18853              ELSE
 18854                 GO TO 4110-BUMP-SEQ.
 18855
 18856     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18857        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18858           GO TO 4110-BUMP-SEQ.
 18859
 18860 4107-CHECK-REC-TYPE.
 18861     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18862         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18863             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 346
* VP6311.cbl
 18864           ELSE
 18865             GO TO 4110-BUMP-SEQ.
 18866
 18867     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18868         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18869             NEXT SENTENCE
 18870           ELSE
 18871             GO TO 4110-BUMP-SEQ.
 18872
 18873     IF NOT DISPLAY-CHANGE-RECORDS AND
 18874        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18875           GO TO 4110-BUMP-SEQ.
 18876
 18877     IF DISPLAY-HOLD-RECORDS AND
 18878        NOT PB-RECORD-ON-HOLD
 18879          GO TO 4110-BUMP-SEQ.
 18880
 18881     IF PB-ISSUE
 18882        IF DISPLAY-CHK-REQ-RECORDS
 18883            GO TO 4110-BUMP-SEQ.
 18884
 18885     IF PB-ISSUE
 18886        IF ISSUE-WITH-WARNING
 18887           IF PB-WARNING-ERRORS
 18888              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18889                  GO TO 4110-BUMP-SEQ
 18890              ELSE
 18891                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18892                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18893                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18894                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18895                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18896                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18897                 GO TO 7000-DISPLAY-ISSUES
 18898        ELSE
 18899            GO TO 4110-BUMP-SEQ.
 18900
 18901     IF PB-ISSUE
 18902        IF (ISSUES-IN-ERROR AND
 18903            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18904            ALL-ISSUES
 18905            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18906            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18907            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18908            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18909            MOVE PB-SV-STATE            TO PI-SV-STATE
 18910            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18911            GO TO 7000-DISPLAY-ISSUES
 18912        ELSE
 18913            GO TO 4110-BUMP-SEQ.
 18914
 18915     IF PB-CANCELLATION
 18916        IF DISPLAY-CHK-REQ-RECORDS
 18917           IF PB-C-REFUND-REQUESTED
 18918              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18919              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18920              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18921              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 347
* VP6311.cbl
 18922              MOVE PB-SV-STATE            TO PI-SV-STATE
 18923              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18924              GO TO 7100-DISPLAY-CANCELS
 18925           ELSE
 18926              GO TO 4110-BUMP-SEQ.
 18927
 18928     IF PB-CANCELLATION
 18929        IF CANCEL-WITH-WARNING
 18930           IF PB-WARNING-ERRORS
 18931              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18932                  GO TO 4110-BUMP-SEQ
 18933              ELSE
 18934                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18935                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18936                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18937                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18938                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18939                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18940                 GO TO 7100-DISPLAY-CANCELS
 18941           ELSE
 18942              GO TO 4110-BUMP-SEQ.
 18943
 18944     IF PB-CANCELLATION
 18945        IF (CANCEL-IN-ERROR  AND
 18946            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18947            ALL-CANCELS
 18948            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18949            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18950            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18951            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18952            MOVE PB-SV-STATE            TO PI-SV-STATE
 18953            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18954            GO TO 7100-DISPLAY-CANCELS.
 18955
 18956 4110-BUMP-SEQ.
 18957     IF NOT DISPLAY-CHANGE-RECORDS
 18958        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18959        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18960     ELSE
 18961        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18962           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18963           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18964        ELSE
 18965           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18966           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18967
 18968     GO TO 4105-READ-NEXT.
 18969
 18970 4150-END-BATCH.
 18971******************************************************************
 18972*                                                                *
 18973*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18974*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING     *
 18975*         PROGRAM.                                               *
 18976*                                                                *
 18977******************************************************************
 18978
 18979     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 348
* VP6311.cbl
 18980         IF PENDING-BUS-RECS-FOUND
 18981             NEXT SENTENCE
 18982           ELSE
 18983             MOVE '9'            TO PI-BROWSE-SW
 18984             GO TO 9400-CLEAR.
 18985
 18986     IF SHOW-RECORD
 18987        MOVE ER-2253             TO EMI-ERROR
 18988     ELSE
 18989        MOVE ER-2251             TO EMI-ERROR.
 18990
 18991     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18992
 18993     IF PI-MAP-NAME = SPACES
 18994        MOVE -1                  TO BMAINTL
 18995        MOVE VP631B              TO PI-MAP-NAME
 18996        GO TO 8100-SEND-INITIAL-MAP.
 18997
 18998     IF PI-MAP-NAME = VP631B
 18999        MOVE -1                  TO BMAINTL
 19000     ELSE
 19001        IF PI-MAP-NAME = VP631C
 19002           MOVE -1               TO CMAINTL
 19003        ELSE
 19004           MOVE -1               TO DPFENTRL.
 19005
 19006     GO TO 8200-SEND-DATAONLY.
 19007
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 349
* VP6311.cbl
 19009
 19010***************************************************************
 19011*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19012*                                                             *
 19013*      1. START BROWSE WITH                                   *
 19014*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19015*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19016*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19017*                                                             *
 19018*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19019*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19020*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19021*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19022*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19023*               AND IS IT TO BE DISPLAYED.                    *
 19024*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19025*               DISPLAYED.                                    *
 19026*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19027*               DISPLAYED.                                    *
 19028*                                                             *
 19029*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19030*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19031***************************************************************
 19032
 19033 4200-BROWSE-CSR-FORWARD.
 19034
 19035     IF FIRST-TIME
 19036        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19037     ELSE
 19038        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19039
 19040
 19041* EXEC CICS HANDLE CONDITION
 19042*         NOTFND   (4250-END-RECORDS)
 19043*         ENDFILE  (4250-END-RECORDS)
 19044*    END-EXEC.
 19045*    MOVE '"$I''                  ! L #00016223' TO DFHEIV0
 19046     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19048     MOVE X'4C20233030303136323233' TO DFHEIV0(25:11)
 19049     CALL 'kxdfhei1' USING DFHEIV0
 19050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19051
 19052
 19053
 19054* EXEC CICS STARTBR
 19055*         DATASET   (FILE-ID-ERPNDB4)
 19056*         RIDFLD    (ERPNDB-CSR-KEY)
 19057*    END-EXEC.
 19058     MOVE 0
 19059       TO DFHEIV11
 19060*    MOVE '&,         G          &   #00016228' TO DFHEIV0
 19061     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19062     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19063     MOVE X'2020233030303136323238' TO DFHEIV0(25:11)
 19064     CALL 'kxdfhei1' USING DFHEIV0,
 19065           FILE-ID-ERPNDB4,
 19066           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 350
* VP6311.cbl
 19067           DFHEIV99,
 19068           DFHEIV11,
 19069           DFHEIV99
 19070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19071
 19072
 19073     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19074
 19075     IF FIRST-TIME
 19076        MOVE SPACE               TO WS-FIRST-TIME-SW
 19077        GO TO 4205-READ-NEXT-RECORD.
 19078
 19079
 19080* EXEC CICS READNEXT
 19081*         DATASET    (FILE-ID-ERPNDB4)
 19082*         SET        (ADDRESS OF PENDING-BUSINESS)
 19083*         RIDFLD     (ERPNDB-CSR-KEY)
 19084*    END-EXEC.
 19085     MOVE 0
 19086       TO DFHEIV11
 19087*    MOVE '&.S                   )   #00016239' TO DFHEIV0
 19088     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19089     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19090     MOVE X'2020233030303136323339' TO DFHEIV0(25:11)
 19091     CALL 'kxdfhei1' USING DFHEIV0,
 19092           FILE-ID-ERPNDB4,
 19093           DFHEIV20,
 19094           DFHEIV99,
 19095           ERPNDB-CSR-KEY,
 19096           DFHEIV99,
 19097           DFHEIV11,
 19098           DFHEIV99,
 19099           DFHEIV99
 19100     SET ADDRESS OF PENDING-BUSINESS TO
 19101         DFHEIV20
 19102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19103
 19104
 19105 4205-READ-NEXT-RECORD.
 19106
 19107
 19108* EXEC CICS READNEXT
 19109*         DATASET    (FILE-ID-ERPNDB4)
 19110*         SET        (ADDRESS OF PENDING-BUSINESS)
 19111*         RIDFLD     (ERPNDB-CSR-KEY)
 19112*    END-EXEC.
 19113     MOVE 0
 19114       TO DFHEIV11
 19115*    MOVE '&.S                   )   #00016247' TO DFHEIV0
 19116     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19117     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19118     MOVE X'2020233030303136323437' TO DFHEIV0(25:11)
 19119     CALL 'kxdfhei1' USING DFHEIV0,
 19120           FILE-ID-ERPNDB4,
 19121           DFHEIV20,
 19122           DFHEIV99,
 19123           ERPNDB-CSR-KEY,
 19124           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 351
* VP6311.cbl
 19125           DFHEIV11,
 19126           DFHEIV99,
 19127           DFHEIV99
 19128     SET ADDRESS OF PENDING-BUSINESS TO
 19129         DFHEIV20
 19130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19131
 19132
 19133     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19134
 19135     IF WS-BATCH-PREFIX = '#CL'
 19136        GO TO 4205-READ-NEXT-RECORD.
 19137
 19138     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19139        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19140        GO TO 4250-END-RECORDS.
 19141
 19142     IF PB-BATCH-TRAILER
 19143        GO TO 4205-READ-NEXT-RECORD.
 19144
 19145     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19146        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19147           GO TO 4205-READ-NEXT-RECORD
 19148        ELSE
 19149           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19150              GO TO 4210-CHECK-REC-TYPE
 19151           ELSE
 19152              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19153                 GO TO 4210-CHECK-REC-TYPE
 19154              ELSE
 19155                 GO TO 4205-READ-NEXT-RECORD.
 19156
 19157     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19158        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19159           GO TO 4205-READ-NEXT-RECORD.
 19160
 19161 4210-CHECK-REC-TYPE.
 19162     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19163         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19164             NEXT SENTENCE
 19165         ELSE
 19166             GO TO 4205-READ-NEXT-RECORD.
 19167
 19168     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19169         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19170             NEXT SENTENCE
 19171        ELSE
 19172             GO TO 4205-READ-NEXT-RECORD.
 19173
 19174     IF NOT DISPLAY-CHANGE-RECORDS AND
 19175            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19176        GO TO 4205-READ-NEXT-RECORD.
 19177
 19178     IF DISPLAY-HOLD-RECORDS AND
 19179        NOT PB-RECORD-ON-HOLD
 19180          GO TO 4205-READ-NEXT-RECORD.
 19181
 19182     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 352
* VP6311.cbl
 19183        IF DISPLAY-CHK-REQ-RECORDS
 19184            GO TO 4205-READ-NEXT-RECORD.
 19185
 19186     IF PB-ISSUE
 19187        IF ISSUE-WITH-WARNING
 19188           IF PB-WARNING-ERRORS
 19189              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19190                  GO TO 4205-READ-NEXT-RECORD
 19191              ELSE
 19192                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19193                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19194                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19195                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19196                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19197                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19198                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19199                 GO TO 7000-DISPLAY-ISSUES
 19200           ELSE
 19201              GO TO 4205-READ-NEXT-RECORD.
 19202
 19203     IF PB-ISSUE
 19204        IF (ISSUES-IN-ERROR AND
 19205            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19206            ALL-ISSUES
 19207            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19208            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19209            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19210            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19211            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19212            MOVE PB-SV-STATE            TO PI-SV-STATE
 19213            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19214            GO TO 7000-DISPLAY-ISSUES
 19215        ELSE
 19216            GO TO 4205-READ-NEXT-RECORD.
 19217
 19218     IF PB-CANCELLATION
 19219        IF DISPLAY-CHK-REQ-RECORDS
 19220           IF PB-C-REFUND-REQUESTED
 19221              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19222              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19223              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19224              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19225              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19226              MOVE PB-SV-STATE            TO PI-SV-STATE
 19227              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19228              GO TO 7100-DISPLAY-CANCELS
 19229           ELSE
 19230               GO TO 4205-READ-NEXT-RECORD.
 19231
 19232     IF PB-CANCELLATION
 19233        IF CANCEL-WITH-WARNING
 19234           IF PB-WARNING-ERRORS
 19235              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19236                  GO TO 4205-READ-NEXT-RECORD
 19237              ELSE
 19238                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19239                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19240                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 353
* VP6311.cbl
 19241                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19242                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19243                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19244                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19245                 GO TO 7100-DISPLAY-CANCELS
 19246           ELSE
 19247              GO TO 4205-READ-NEXT-RECORD.
 19248
 19249     IF PB-CANCELLATION
 19250        IF (CANCEL-IN-ERROR  AND
 19251            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19252            ALL-CANCELS
 19253            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19254            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19255            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19256            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19257            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19258            MOVE PB-SV-STATE            TO PI-SV-STATE
 19259            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19260            GO TO 7100-DISPLAY-CANCELS.
 19261
 19262     GO TO 4205-READ-NEXT-RECORD.
 19263
 19264 4250-END-RECORDS.
 19265******************************************************************
 19266*                                                                *
 19267*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19268*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING
 19269*         PROGRAM.                                               *
 19270*                                                                *
 19271******************************************************************
 19272
 19273     IF BROWSE-STARTED
 19274        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19275
 19276* EXEC CICS ENDBR
 19277*            DATASET  (FILE-ID-ERPNDB4)
 19278*       END-EXEC.
 19279     MOVE 0
 19280       TO DFHEIV11
 19281*    MOVE '&2                    $   #00016395' TO DFHEIV0
 19282     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19283     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19284     MOVE X'2020233030303136333935' TO DFHEIV0(25:11)
 19285     CALL 'kxdfhei1' USING DFHEIV0,
 19286           FILE-ID-ERPNDB4,
 19287           DFHEIV11,
 19288           DFHEIV99
 19289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19290
 19291
 19292     IF  EIBTRNID NOT = TRANS-EXB1
 19293         IF PENDING-BUS-RECS-FOUND
 19294             NEXT SENTENCE
 19295           ELSE
 19296             MOVE '9'            TO PI-BROWSE-SW
 19297             GO TO 9400-CLEAR.
 19298
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 354
* VP6311.cbl
 19299     IF SHOW-RECORD
 19300        MOVE ER-2253            TO EMI-ERROR
 19301       ELSE
 19302        MOVE ER-2254            TO EMI-ERROR.
 19303
 19304     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19305
 19306     IF PI-MAP-NAME = SPACES
 19307        MOVE -1                  TO DPFENTRL
 19308        MOVE VP631D               TO PI-MAP-NAME
 19309        GO TO 8100-SEND-INITIAL-MAP.
 19310
 19311     IF PI-MAP-NAME = VP631B
 19312        MOVE -1                  TO BMAINTL
 19313     ELSE
 19314        IF PI-MAP-NAME = VP631C
 19315           MOVE -1               TO CMAINTL
 19316        ELSE
 19317           MOVE -1               TO DPFENTRL.
 19318
 19319     GO TO 8200-SEND-DATAONLY.
 19320
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 355
* VP6311.cbl
 19322
 19323***************************************************************
 19324*                                                             *
 19325*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19326*                                                             *
 19327*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19328*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19329*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19330*                                                             *
 19331*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19332*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19333*          A. IS IT WITHIN THE SAME COMPANY                   *
 19334*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19335*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19336*                AND IS IT TO BE DISPLAYED.                   *
 19337*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19338*                DISPLAYED.                                   *
 19339*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19340*                DISPLAYED.                                   *
 19341*                                                             *
 19342*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19343*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19344*                                                             *
 19345*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19346*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19347*                THEY ARE NOT TO BE DISPLAYED.                *
 19348*                                                             *
 19349***************************************************************
 19350
 19351 4300-BROWSE-FILE-FORWARD.
 19352     IF FIRST-TIME OR SHOW-RECORD
 19353        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19354        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19355        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19356     ELSE
 19357        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19358        IF ERPNDB-BATCH-SEQ-NO = +9999
 19359           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19360        ELSE
 19361           IF DISPLAY-CHANGE-RECORDS
 19362              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19363           ELSE
 19364              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19365              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19366
 19367
 19368* EXEC CICS HANDLE CONDITION
 19369*         ENDFILE  (4350-END-BATCH)
 19370*         NOTFND   (4350-END-BATCH)
 19371*    END-EXEC.
 19372*    MOVE '"$''I                  ! M #00016474' TO DFHEIV0
 19373     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19375     MOVE X'4D20233030303136343734' TO DFHEIV0(25:11)
 19376     CALL 'kxdfhei1' USING DFHEIV0
 19377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19378
 19379
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 356
* VP6311.cbl
 19380 4305-READ-NEXT.
 19381     IF PI-DISPLAY-ORIGINAL-BATCH
 19382        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19383     ELSE
 19384        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19385
 19386
 19387* EXEC CICS READ
 19388*         DATASET   (FILE-ID)
 19389*         SET       (ADDRESS OF PENDING-BUSINESS)
 19390*         RIDFLD    (ERPNDB-KEY)
 19391*         GTEQ
 19392*    END-EXEC.
 19393*    MOVE '&"S        G          (   #00016485' TO DFHEIV0
 19394     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19396     MOVE X'2020233030303136343835' TO DFHEIV0(25:11)
 19397     CALL 'kxdfhei1' USING DFHEIV0,
 19398           FILE-ID,
 19399           DFHEIV20,
 19400           DFHEIV99,
 19401           ERPNDB-KEY,
 19402           DFHEIV99,
 19403           DFHEIV99,
 19404           DFHEIV99
 19405     SET ADDRESS OF PENDING-BUSINESS TO
 19406         DFHEIV20
 19407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19408
 19409
 19410     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19411        GO TO 4350-END-BATCH.
 19412
 19413     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19414                                    WS-BATCH-NO.
 19415
 19416     IF  WS-BATCH-PREFIX = '#CL'
 19417         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19418         GO TO 4305-READ-NEXT.
 19419
 19420     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19421     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19422     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19423     MOVE PB-STATE               TO PI-PB-STATE.
 19424     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19425
 19426     IF PB-BATCH-TRAILER
 19427        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19428        GO TO 4305-READ-NEXT.
 19429
 19430     IF SHOW-RECORD
 19431           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19432              GO TO 4310-BUMP-SEQ
 19433           ELSE
 19434              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19435                 GO TO 4310-BUMP-SEQ
 19436              ELSE
 19437                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 357
* VP6311.cbl
 19438
 19439     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19440        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19441           GO TO 4310-BUMP-SEQ
 19442        ELSE
 19443           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19444              GO TO 4307-CHECK-REC-TYPE
 19445           ELSE
 19446              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19447                 GO TO 4307-CHECK-REC-TYPE
 19448              ELSE
 19449                 GO TO 4310-BUMP-SEQ.
 19450
 19451     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19452        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19453           GO TO 4310-BUMP-SEQ.
 19454
 19455 4307-CHECK-REC-TYPE.
 19456     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19457         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19458             NEXT SENTENCE
 19459         ELSE
 19460             GO TO 4310-BUMP-SEQ.
 19461
 19462     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19463         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19464             NEXT SENTENCE
 19465        ELSE
 19466             GO TO 4310-BUMP-SEQ.
 19467
 19468     IF NOT DISPLAY-CHANGE-RECORDS AND
 19469            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19470        GO TO 4310-BUMP-SEQ.
 19471
 19472     IF DISPLAY-HOLD-RECORDS AND
 19473        NOT PB-RECORD-ON-HOLD
 19474          GO TO 4310-BUMP-SEQ.
 19475
 19476     IF PB-ISSUE
 19477        IF DISPLAY-CHK-REQ-RECORDS
 19478           GO TO 4310-BUMP-SEQ.
 19479
 19480     IF PB-ISSUE
 19481        IF ISSUE-WITH-WARNING
 19482           IF PB-WARNING-ERRORS
 19483              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19484                  GO TO 4310-BUMP-SEQ
 19485              ELSE
 19486                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19487                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19488                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19489                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19490                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19491                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19492                 GO TO 7000-DISPLAY-ISSUES
 19493           ELSE
 19494              GO TO 4310-BUMP-SEQ.
 19495
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 358
* VP6311.cbl
 19496     IF PB-ISSUE
 19497        IF (ISSUES-IN-ERROR AND
 19498            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19499            ALL-ISSUES
 19500            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19501            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19502            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19503            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19504            MOVE PB-SV-STATE            TO PI-SV-STATE
 19505            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19506            GO TO 7000-DISPLAY-ISSUES
 19507        ELSE
 19508            GO TO 4310-BUMP-SEQ.
 19509
 19510     IF PB-CANCELLATION
 19511        IF DISPLAY-CHK-REQ-RECORDS
 19512           IF PB-C-REFUND-REQUESTED
 19513              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19514              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19515              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19516              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19517              MOVE PB-SV-STATE            TO PI-SV-STATE
 19518              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19519              GO TO 7100-DISPLAY-CANCELS
 19520           ELSE
 19521              GO TO 4310-BUMP-SEQ.
 19522
 19523     IF PB-CANCELLATION
 19524        IF CANCEL-WITH-WARNING
 19525           IF PB-WARNING-ERRORS
 19526              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19527                  GO TO 4310-BUMP-SEQ
 19528              ELSE
 19529                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19530                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19531                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19532                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19533                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19534                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19535                 GO TO 7100-DISPLAY-CANCELS
 19536           ELSE
 19537              GO TO 4310-BUMP-SEQ.
 19538
 19539     IF PB-CANCELLATION
 19540        IF (CANCEL-IN-ERROR  AND
 19541            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19542            ALL-CANCELS
 19543            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19544            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19545            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19546            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19547            MOVE PB-SV-STATE            TO PI-SV-STATE
 19548            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19549            GO TO 7100-DISPLAY-CANCELS.
 19550
 19551 4310-BUMP-SEQ.
 19552     IF NOT DISPLAY-CHANGE-RECORDS
 19553        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 359
* VP6311.cbl
 19554        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19555     ELSE
 19556        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19557           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19558           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19559        ELSE
 19560           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19561           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19562
 19563     GO TO 4305-READ-NEXT.
 19564
 19565 4350-END-BATCH.
 19566
 19567******************************************************************
 19568*                                                                *
 19569*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19570*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING    *
 19571*         PROGRAM.                                               *
 19572*                                                                *
 19573******************************************************************
 19574
 19575     IF  EIBTRNID NOT = TRANS-EXB1
 19576         IF PENDING-BUS-RECS-FOUND
 19577             NEXT SENTENCE
 19578           ELSE
 19579             MOVE '9'            TO PI-BROWSE-SW
 19580             GO TO 9400-CLEAR.
 19581
 19582     IF SHOW-RECORD
 19583        MOVE ER-2253            TO EMI-ERROR
 19584     ELSE
 19585        MOVE ER-2251            TO EMI-ERROR.
 19586
 19587     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19588
 19589     IF PI-MAP-NAME = SPACES
 19590        MOVE -1                  TO BMAINTL
 19591        MOVE VP631B               TO PI-MAP-NAME
 19592        GO TO 8100-SEND-INITIAL-MAP.
 19593
 19594     IF PI-MAP-NAME = VP631B
 19595        MOVE -1                  TO BMAINTL
 19596     ELSE
 19597        IF PI-MAP-NAME = VP631C
 19598           MOVE -1               TO CMAINTL
 19599        ELSE
 19600           MOVE -1               TO DPFENTRL.
 19601
 19602     GO TO 8200-SEND-DATAONLY.
 19603
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 360
* VP6311.cbl
 19605
 19606******************************************************************
 19607*                                                                *
 19608*        B R O W S E   D E T A I L   B A C K W A R D             *
 19609*                                                                *
 19610******************************************************************
 19611
 19612 4500-BROWSE-DETAIL-BACKWARD.
 19613
 19614     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19615
 19616
 19617* EXEC CICS HANDLE CONDITION
 19618*         NOTFND   (4570-NOT-FOUND)
 19619*         ENDFILE  (4550-END-RECORDS)
 19620*    END-EXEC
 19621*    MOVE '"$I''                  ! N #00016698' TO DFHEIV0
 19622     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19624     MOVE X'4E20233030303136363938' TO DFHEIV0(25:11)
 19625     CALL 'kxdfhei1' USING DFHEIV0
 19626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19627
 19628
 19629* EXEC CICS STARTBR
 19630*         DATASET   (FILE-ID-ERPNDB2)
 19631*         RIDFLD    (ERPNDB-ALT-KEY)
 19632*    END-EXEC.
 19633     MOVE 0
 19634       TO DFHEIV11
 19635*    MOVE '&,         G          &   #00016703' TO DFHEIV0
 19636     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19637     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19638     MOVE X'2020233030303136373033' TO DFHEIV0(25:11)
 19639     CALL 'kxdfhei1' USING DFHEIV0,
 19640           FILE-ID-ERPNDB2,
 19641           ERPNDB-ALT-KEY,
 19642           DFHEIV99,
 19643           DFHEIV11,
 19644           DFHEIV99
 19645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19646
 19647
 19648     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19649                                    WS-FIRST-TIME-SW.
 19650
 19651 4505-READ-PREV-RECORD.
 19652
 19653* EXEC CICS READPREV
 19654*         DATASET    (FILE-ID-ERPNDB2)
 19655*         SET        (ADDRESS OF PENDING-BUSINESS)
 19656*         RIDFLD     (ERPNDB-ALT-KEY)
 19657*    END-EXEC.
 19658     MOVE 0
 19659       TO DFHEIV11
 19660*    MOVE '&0S                   )   #00016712' TO DFHEIV0
 19661     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 361
* VP6311.cbl
 19663     MOVE X'2020233030303136373132' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           FILE-ID-ERPNDB2,
 19666           DFHEIV20,
 19667           DFHEIV99,
 19668           ERPNDB-ALT-KEY,
 19669           DFHEIV99,
 19670           DFHEIV11,
 19671           DFHEIV99,
 19672           DFHEIV99
 19673     SET ADDRESS OF PENDING-BUSINESS TO
 19674         DFHEIV20
 19675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19676
 19677
 19678     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19679
 19680     IF WS-BATCH-PREFIX = '#CL'
 19681         GO TO 4505-READ-PREV-RECORD.
 19682
 19683     IF FIRST-TIME
 19684         MOVE SPACE               TO WS-FIRST-TIME-SW
 19685         GO TO 4505-READ-PREV-RECORD.
 19686
 19687     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19688        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19689        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19690        PB-STATE         NOT = PI-PB-STATE    OR
 19691        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19692          GO TO 4550-END-RECORDS.
 19693
 19694
 19695     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19696
 19697     IF PB-BATCH-TRAILER
 19698        GO TO 4505-READ-PREV-RECORD.
 19699
 19700     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19701
 19702     IF  WS-BATCH-PREFIX = '#CL'
 19703         GO TO 4505-READ-PREV-RECORD.
 19704
 19705     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19706        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19707           GO TO 4505-READ-PREV-RECORD
 19708        ELSE
 19709           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19710              GO TO 4510-CHECK-REC-TYPE
 19711           ELSE
 19712              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19713                 GO TO 4510-CHECK-REC-TYPE
 19714              ELSE
 19715                 GO TO 4505-READ-PREV-RECORD.
 19716
 19717     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19718        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19719           GO TO 4505-READ-PREV-RECORD.
 19720
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 362
* VP6311.cbl
 19721 4510-CHECK-REC-TYPE.
 19722     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19723         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19724             NEXT SENTENCE
 19725         ELSE
 19726             GO TO 4505-READ-PREV-RECORD.
 19727
 19728     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19729         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19730             NEXT SENTENCE
 19731        ELSE
 19732             GO TO 4505-READ-PREV-RECORD.
 19733
 19734     IF NOT DISPLAY-CHANGE-RECORDS AND
 19735            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19736        GO TO 4505-READ-PREV-RECORD.
 19737
 19738     IF DISPLAY-HOLD-RECORDS AND
 19739        NOT PB-RECORD-ON-HOLD
 19740          GO TO 4505-READ-PREV-RECORD.
 19741
 19742     IF PB-ISSUE
 19743        IF DISPLAY-CHK-REQ-RECORDS
 19744           GO TO 4505-READ-PREV-RECORD.
 19745
 19746     IF PB-ISSUE
 19747        IF ISSUE-WITH-WARNING
 19748           IF PB-WARNING-ERRORS
 19749              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19750                  GO TO 4505-READ-PREV-RECORD
 19751              ELSE
 19752                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19753                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19754                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19755                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19756                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19757                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19758                 GO TO 7000-DISPLAY-ISSUES
 19759           ELSE
 19760              GO TO 4505-READ-PREV-RECORD.
 19761
 19762     IF PB-ISSUE
 19763        IF (ISSUES-IN-ERROR AND
 19764            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19765            ALL-ISSUES
 19766            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19767            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19768            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19769            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19770            MOVE PB-SV-STATE            TO PI-SV-STATE
 19771            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19772            GO TO 7000-DISPLAY-ISSUES
 19773        ELSE
 19774            GO TO 4505-READ-PREV-RECORD.
 19775
 19776     IF PB-CANCELLATION
 19777        IF DISPLAY-CHK-REQ-RECORDS
 19778           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 363
* VP6311.cbl
 19779              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19780              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19781              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19782              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19783              MOVE PB-SV-STATE            TO PI-SV-STATE
 19784              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19785              GO TO 7100-DISPLAY-CANCELS
 19786           ELSE
 19787              GO TO 4505-READ-PREV-RECORD.
 19788
 19789     IF PB-CANCELLATION
 19790        IF CANCEL-WITH-WARNING
 19791           IF PB-WARNING-ERRORS
 19792              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19793                  GO TO 4505-READ-PREV-RECORD
 19794              ELSE
 19795                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19796                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19797                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19798                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19799                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19800                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19801                 GO TO 7100-DISPLAY-CANCELS
 19802           ELSE
 19803              GO TO 4505-READ-PREV-RECORD.
 19804
 19805     IF PB-CANCELLATION
 19806        IF (CANCEL-IN-ERROR  AND
 19807            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19808            ALL-CANCELS
 19809            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19810            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19811            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19812            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19813            MOVE PB-SV-STATE            TO PI-SV-STATE
 19814            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19815            GO TO 7100-DISPLAY-CANCELS.
 19816
 19817     GO TO 4505-READ-PREV-RECORD.
 19818
 19819 4550-END-RECORDS.
 19820     IF PI-MAP-NAME = VP631B
 19821        MOVE -1                  TO BMAINTL
 19822     ELSE
 19823        IF PI-MAP-NAME = VP631C
 19824           MOVE -1               TO CMAINTL
 19825        ELSE
 19826           MOVE -1               TO DPFENTRL.
 19827
 19828     MOVE ER-2255               TO EMI-ERROR.
 19829     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19830     GO TO 8200-SEND-DATAONLY.
 19831
 19832 4570-NOT-FOUND.
 19833
 19834******************************************************************
 19835*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19836******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 364
* VP6311.cbl
 19837
 19838
 19839* EXEC CICS RESETBR
 19840*         DATASET    (FILE-ID-ERPNDB2)
 19841*         RIDFLD     (ERPNDB-ALT-KEY)
 19842*    END-EXEC.
 19843     MOVE 0
 19844       TO DFHEIV11
 19845*    MOVE '&4         G          &   #00016878' TO DFHEIV0
 19846     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19847     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19848     MOVE X'2020233030303136383738' TO DFHEIV0(25:11)
 19849     CALL 'kxdfhei1' USING DFHEIV0,
 19850           FILE-ID-ERPNDB2,
 19851           ERPNDB-ALT-KEY,
 19852           DFHEIV99,
 19853           DFHEIV11,
 19854           DFHEIV99
 19855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19856
 19857
 19858
 19859* EXEC CICS READNEXT
 19860*         DATASET    (FILE-ID-ERPNDB2)
 19861*         SET        (ADDRESS OF PENDING-BUSINESS)
 19862*         RIDFLD     (ERPNDB-ALT-KEY)
 19863*    END-EXEC.
 19864     MOVE 0
 19865       TO DFHEIV11
 19866*    MOVE '&.S                   )   #00016883' TO DFHEIV0
 19867     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19868     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19869     MOVE X'2020233030303136383833' TO DFHEIV0(25:11)
 19870     CALL 'kxdfhei1' USING DFHEIV0,
 19871           FILE-ID-ERPNDB2,
 19872           DFHEIV20,
 19873           DFHEIV99,
 19874           ERPNDB-ALT-KEY,
 19875           DFHEIV99,
 19876           DFHEIV11,
 19877           DFHEIV99,
 19878           DFHEIV99
 19879     SET ADDRESS OF PENDING-BUSINESS TO
 19880         DFHEIV20
 19881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19882
 19883
 19884
 19885* EXEC CICS READPREV
 19886*         DATASET    (FILE-ID-ERPNDB2)
 19887*         SET        (ADDRESS OF PENDING-BUSINESS)
 19888*         RIDFLD     (ERPNDB-ALT-KEY)
 19889*    END-EXEC.
 19890     MOVE 0
 19891       TO DFHEIV11
 19892*    MOVE '&0S                   )   #00016889' TO DFHEIV0
 19893     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19894     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 365
* VP6311.cbl
 19895     MOVE X'2020233030303136383839' TO DFHEIV0(25:11)
 19896     CALL 'kxdfhei1' USING DFHEIV0,
 19897           FILE-ID-ERPNDB2,
 19898           DFHEIV20,
 19899           DFHEIV99,
 19900           ERPNDB-ALT-KEY,
 19901           DFHEIV99,
 19902           DFHEIV11,
 19903           DFHEIV99,
 19904           DFHEIV99
 19905     SET ADDRESS OF PENDING-BUSINESS TO
 19906         DFHEIV20
 19907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19908
 19909
 19910 4580-READ-PREV-RECORD.
 19911
 19912* EXEC CICS READPREV
 19913*         DATASET    (FILE-ID-ERPNDB2)
 19914*         SET        (ADDRESS OF PENDING-BUSINESS)
 19915*         RIDFLD     (ERPNDB-ALT-KEY)
 19916*    END-EXEC.
 19917     MOVE 0
 19918       TO DFHEIV11
 19919*    MOVE '&0S                   )   #00016896' TO DFHEIV0
 19920     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19921     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19922     MOVE X'2020233030303136383936' TO DFHEIV0(25:11)
 19923     CALL 'kxdfhei1' USING DFHEIV0,
 19924           FILE-ID-ERPNDB2,
 19925           DFHEIV20,
 19926           DFHEIV99,
 19927           ERPNDB-ALT-KEY,
 19928           DFHEIV99,
 19929           DFHEIV11,
 19930           DFHEIV99,
 19931           DFHEIV99
 19932     SET ADDRESS OF PENDING-BUSINESS TO
 19933         DFHEIV20
 19934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19935
 19936
 19937     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19938
 19939     IF WS-BATCH-PREFIX = '#CL'
 19940        GO TO 4580-READ-PREV-RECORD.
 19941
 19942     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19943     GO TO 4505-READ-PREV-RECORD.
 19944
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 366
* VP6311.cbl
 19946
 19947******************************************************************
 19948*                                                                *
 19949*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19950*                                                                *
 19951******************************************************************
 19952
 19953 4600-BROWSE-PRIMARY-BACKWARD.
 19954        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19955
 19956     IF ERPNDB-BATCH-SEQ-NO = +9999
 19957        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19958
 19959        IF ERPNDB-BATCH-SEQ-NO = +0000
 19960           GO TO 4650-END-BATCH
 19961        ELSE
 19962           IF PI-MAP-NAME NOT = VP631D
 19963              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19964                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19965              ELSE
 19966                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19967                 IF DISPLAY-CHANGE-RECORDS
 19968                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19969                 ELSE
 19970                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19971
 19972
 19973* EXEC CICS HANDLE CONDITION
 19974*         NOTFND    (4680-NOT-FOUND)
 19975*         ENDFILE   (4680-NOT-FOUND)
 19976*    END-EXEC.
 19977*    MOVE '"$I''                  ! O #00016937' TO DFHEIV0
 19978     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19979     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19980     MOVE X'4F20233030303136393337' TO DFHEIV0(25:11)
 19981     CALL 'kxdfhei1' USING DFHEIV0
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19983
 19984
 19985 4605-READ-NEXT.
 19986     IF ERPNDB-BATCH-SEQ-NO = +0000
 19987        GO TO 4650-END-BATCH.
 19988
 19989     IF PI-DISPLAY-ORIGINAL-BATCH
 19990        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19991     ELSE
 19992        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19993
 19994
 19995* EXEC CICS READ
 19996*         DATASET   (FILE-ID)
 19997*         SET       (ADDRESS OF PENDING-BUSINESS)
 19998*         RIDFLD    (ERPNDB-KEY)
 19999*    END-EXEC.
 20000*    MOVE '&"S        E          (   #00016951' TO DFHEIV0
 20001     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20003     MOVE X'2020233030303136393531' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 367
* VP6311.cbl
 20004     CALL 'kxdfhei1' USING DFHEIV0,
 20005           FILE-ID,
 20006           DFHEIV20,
 20007           DFHEIV99,
 20008           ERPNDB-KEY,
 20009           DFHEIV99,
 20010           DFHEIV99,
 20011           DFHEIV99
 20012     SET ADDRESS OF PENDING-BUSINESS TO
 20013         DFHEIV20
 20014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20015
 20016
 20017     IF NOT  PI-PRIMARY-WITH-SELECT
 20018        GO TO 4607-CHECK-REC-TYPE.
 20019
 20020     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20021
 20022     IF  WS-BATCH-PREFIX = '#CL'
 20023         GO TO 4610-BUMP-SEQ.
 20024
 20025     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20026        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20027           GO TO 4610-BUMP-SEQ
 20028        ELSE
 20029           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20030              GO TO 4607-CHECK-REC-TYPE
 20031           ELSE
 20032              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20033                 GO TO 4607-CHECK-REC-TYPE
 20034              ELSE
 20035                 GO TO 4610-BUMP-SEQ.
 20036
 20037     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20038        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20039           GO TO 4610-BUMP-SEQ.
 20040
 20041 4607-CHECK-REC-TYPE.
 20042     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20043         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20044             NEXT SENTENCE
 20045         ELSE
 20046             GO TO 4610-BUMP-SEQ.
 20047
 20048     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20049         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20050             NEXT SENTENCE
 20051        ELSE
 20052             GO TO 4610-BUMP-SEQ.
 20053
 20054     IF NOT DISPLAY-CHANGE-RECORDS AND
 20055            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20056        GO TO 4610-BUMP-SEQ.
 20057
 20058     IF DISPLAY-HOLD-RECORDS AND
 20059        NOT PB-RECORD-ON-HOLD
 20060          GO TO 4610-BUMP-SEQ.
 20061
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 368
* VP6311.cbl
 20062     IF PB-ISSUE
 20063        IF DISPLAY-CHK-REQ-RECORDS
 20064           GO TO 4610-BUMP-SEQ.
 20065
 20066     IF PB-ISSUE
 20067        IF ISSUE-WITH-WARNING
 20068           IF PB-WARNING-ERRORS
 20069              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20070                  GO TO 4610-BUMP-SEQ
 20071              ELSE
 20072                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20073                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20074                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20075                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20076                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20077                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20078                 GO TO 7000-DISPLAY-ISSUES
 20079           ELSE
 20080              GO TO 4610-BUMP-SEQ.
 20081
 20082     IF PB-ISSUE
 20083        IF (ISSUES-IN-ERROR AND
 20084            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20085            ALL-ISSUES
 20086            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20087            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20088            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20089            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20090            MOVE PB-SV-STATE            TO PI-SV-STATE
 20091            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20092            GO TO 7000-DISPLAY-ISSUES
 20093        ELSE
 20094            GO TO 4610-BUMP-SEQ.
 20095
 20096     IF PB-CANCELLATION
 20097        IF DISPLAY-CHK-REQ-RECORDS
 20098           IF PB-C-REFUND-REQUESTED
 20099              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20100              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20101              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20102              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20103              MOVE PB-SV-STATE            TO PI-SV-STATE
 20104              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20105              GO TO 7100-DISPLAY-CANCELS
 20106           ELSE
 20107              GO TO 4610-BUMP-SEQ.
 20108
 20109     IF PB-CANCELLATION
 20110        IF CANCEL-WITH-WARNING
 20111           IF PB-WARNING-ERRORS
 20112              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20113                  GO TO 4610-BUMP-SEQ
 20114              ELSE
 20115                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20116                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20117                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20118                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20119                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 369
* VP6311.cbl
 20120                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20121                 GO TO 7100-DISPLAY-CANCELS
 20122           ELSE
 20123              GO TO 4610-BUMP-SEQ.
 20124
 20125     IF PB-CANCELLATION
 20126        IF (CANCEL-IN-ERROR  AND
 20127            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20128            ALL-CANCELS
 20129            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20130            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20131            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20132            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20133            MOVE PB-SV-STATE            TO PI-SV-STATE
 20134            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20135            GO TO 7100-DISPLAY-CANCELS.
 20136
 20137 4610-BUMP-SEQ.
 20138     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20139        GO TO 4650-END-BATCH.
 20140
 20141     IF DISPLAY-CHANGE-RECORDS
 20142        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20143           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20144        ELSE
 20145           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20146           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20147        ELSE
 20148           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20149           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20150
 20151        GO TO 4605-READ-NEXT.
 20152
 20153 4650-END-BATCH.
 20154     IF PI-MAP-NAME = VP631B
 20155        MOVE -1                  TO BMAINTL
 20156     ELSE
 20157        IF PI-MAP-NAME = VP631C
 20158           MOVE -1               TO CMAINTL
 20159        ELSE
 20160           MOVE -1               TO DPFENTRL.
 20161
 20162     MOVE ER-2252               TO EMI-ERROR.
 20163     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20164     GO TO 8200-SEND-DATAONLY.
 20165
 20166 4680-NOT-FOUND.
 20167     IF DISPLAY-CHANGE-RECORDS
 20168        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20169           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20170        ELSE
 20171           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20172           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20173     ELSE
 20174        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20175
 20176     GO TO 4605-READ-NEXT.
 20177
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 370
* VP6311.cbl
 20179
 20180******************************************************************
 20181*                                                                *
 20182*        B R O W S E   F I L E   B A C K W A R D S               *
 20183*                                                                *
 20184******************************************************************
 20185
 20186 4800-BROWSE-FILE-BACKWARD.
 20187
 20188* EXEC CICS HANDLE CONDITION
 20189*         NOTFND   (4860-NOT-FOUND)
 20190*         ENDFILE  (4850-END-RECORDS)
 20191*    END-EXEC.
 20192*    MOVE '"$I''                  ! P #00017127' TO DFHEIV0
 20193     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20195     MOVE X'5020233030303137313237' TO DFHEIV0(25:11)
 20196     CALL 'kxdfhei1' USING DFHEIV0
 20197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20198
 20199
 20200     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20201
 20202     IF PI-DISPLAY-ORIGINAL-BATCH
 20203        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20204     ELSE
 20205        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20206
 20207
 20208* EXEC CICS STARTBR
 20209*         DATASET   (FILE-ID)
 20210*         RIDFLD    (ERPNDB-KEY)
 20211*    END-EXEC.
 20212     MOVE 0
 20213       TO DFHEIV11
 20214*    MOVE '&,         G          &   #00017139' TO DFHEIV0
 20215     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20216     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20217     MOVE X'2020233030303137313339' TO DFHEIV0(25:11)
 20218     CALL 'kxdfhei1' USING DFHEIV0,
 20219           FILE-ID,
 20220           ERPNDB-KEY,
 20221           DFHEIV99,
 20222           DFHEIV11,
 20223           DFHEIV99
 20224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20225
 20226
 20227     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20228
 20229
 20230* EXEC CICS READPREV
 20231*         DATASET    (FILE-ID-ERPNDB)
 20232*         SET        (ADDRESS OF PENDING-BUSINESS)
 20233*         RIDFLD     (ERPNDB-KEY)
 20234*    END-EXEC.
 20235     MOVE 0
 20236       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 371
* VP6311.cbl
 20237*    MOVE '&0S                   )   #00017146' TO DFHEIV0
 20238     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20239     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20240     MOVE X'2020233030303137313436' TO DFHEIV0(25:11)
 20241     CALL 'kxdfhei1' USING DFHEIV0,
 20242           FILE-ID-ERPNDB,
 20243           DFHEIV20,
 20244           DFHEIV99,
 20245           ERPNDB-KEY,
 20246           DFHEIV99,
 20247           DFHEIV11,
 20248           DFHEIV99,
 20249           DFHEIV99
 20250     SET ADDRESS OF PENDING-BUSINESS TO
 20251         DFHEIV20
 20252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20253
 20254
 20255 4810-READ-PREV-RECORD.
 20256
 20257* EXEC CICS READPREV
 20258*         DATASET    (FILE-ID-ERPNDB)
 20259*         SET        (ADDRESS OF PENDING-BUSINESS)
 20260*         RIDFLD     (ERPNDB-KEY)
 20261*    END-EXEC.
 20262     MOVE 0
 20263       TO DFHEIV11
 20264*    MOVE '&0S                   )   #00017153' TO DFHEIV0
 20265     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20266     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20267     MOVE X'2020233030303137313533' TO DFHEIV0(25:11)
 20268     CALL 'kxdfhei1' USING DFHEIV0,
 20269           FILE-ID-ERPNDB,
 20270           DFHEIV20,
 20271           DFHEIV99,
 20272           ERPNDB-KEY,
 20273           DFHEIV99,
 20274           DFHEIV11,
 20275           DFHEIV99,
 20276           DFHEIV99
 20277     SET ADDRESS OF PENDING-BUSINESS TO
 20278         DFHEIV20
 20279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20280
 20281
 20282     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20283        GO TO 4850-END-RECORDS.
 20284
 20285     IF PB-BATCH-TRAILER
 20286        GO TO 4810-READ-PREV-RECORD.
 20287
 20288     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20289
 20290     IF  WS-BATCH-PREFIX = '#CL'
 20291         GO TO 4810-READ-PREV-RECORD.
 20292
 20293     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20294        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 372
* VP6311.cbl
 20295           GO TO 4810-READ-PREV-RECORD
 20296        ELSE
 20297           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20298              GO TO 4820-CHECK-REC-TYPE
 20299           ELSE
 20300              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20301                 GO TO 4820-CHECK-REC-TYPE
 20302              ELSE
 20303                 GO TO 4810-READ-PREV-RECORD.
 20304
 20305     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20306        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20307           GO TO 4810-READ-PREV-RECORD.
 20308
 20309 4820-CHECK-REC-TYPE.
 20310     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20311         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20312             NEXT SENTENCE
 20313         ELSE
 20314             GO TO 4810-READ-PREV-RECORD.
 20315
 20316     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20317         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20318             NEXT SENTENCE
 20319        ELSE
 20320             GO TO 4810-READ-PREV-RECORD.
 20321
 20322     IF NOT DISPLAY-CHANGE-RECORDS AND
 20323            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20324        GO TO 4810-READ-PREV-RECORD.
 20325
 20326     IF DISPLAY-HOLD-RECORDS AND
 20327        NOT PB-RECORD-ON-HOLD
 20328          GO TO 4810-READ-PREV-RECORD.
 20329
 20330     IF PB-ISSUE
 20331        IF DISPLAY-CHK-REQ-RECORDS
 20332           GO TO 4810-READ-PREV-RECORD.
 20333
 20334     IF PB-ISSUE
 20335        IF ISSUE-WITH-WARNING
 20336           IF PB-WARNING-ERRORS
 20337              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20338                  GO TO 4810-READ-PREV-RECORD
 20339              ELSE
 20340                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20341                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20342                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20343                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20344                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20345                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20346                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20347                 GO TO 7000-DISPLAY-ISSUES
 20348           ELSE
 20349              GO TO 4810-READ-PREV-RECORD.
 20350
 20351     IF PB-ISSUE
 20352        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 373
* VP6311.cbl
 20353            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20354            ALL-ISSUES
 20355            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20356            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20357            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20358            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20359            MOVE PB-SV-STATE            TO PI-SV-STATE
 20360            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20361            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20362            GO TO 7000-DISPLAY-ISSUES
 20363        ELSE
 20364            GO TO 4810-READ-PREV-RECORD.
 20365
 20366     IF PB-CANCELLATION
 20367        IF DISPLAY-CHK-REQ-RECORDS
 20368           IF PB-C-REFUND-REQUESTED
 20369              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20370              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20371              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20372              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20373              MOVE PB-SV-STATE            TO PI-SV-STATE
 20374              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20375              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20376              GO TO 7100-DISPLAY-CANCELS
 20377           ELSE
 20378              GO TO 4810-READ-PREV-RECORD.
 20379
 20380     IF PB-CANCELLATION
 20381        IF CANCEL-WITH-WARNING
 20382           IF PB-WARNING-ERRORS
 20383              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20384                  GO TO 4810-READ-PREV-RECORD
 20385              ELSE
 20386                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20387                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20388                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20389                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20390                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20391                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20392                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20393                 GO TO 7100-DISPLAY-CANCELS
 20394           ELSE
 20395              GO TO 4810-READ-PREV-RECORD.
 20396
 20397     IF PB-CANCELLATION
 20398        IF (CANCEL-IN-ERROR  AND
 20399            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20400            ALL-CANCELS
 20401            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20402            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20403            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20404            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20405            MOVE PB-SV-STATE            TO PI-SV-STATE
 20406            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20407            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20408            GO TO 7100-DISPLAY-CANCELS.
 20409
 20410     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 374
* VP6311.cbl
 20411
 20412 4850-END-RECORDS.
 20413     MOVE ER-2252                TO EMI-ERROR.
 20414     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20415
 20416     IF PI-MAP-NAME = VP631B
 20417        MOVE -1                  TO BPFENTRL
 20418     ELSE
 20419        MOVE -1                  TO CPFENTRL.
 20420
 20421     GO TO 8200-SEND-DATAONLY.
 20422
 20423 4860-NOT-FOUND.
 20424
 20425******************************************************************
 20426*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20427******************************************************************
 20428
 20429
 20430* EXEC CICS RESETBR
 20431*         DATASET    (FILE-ID-ERPNDB)
 20432*         RIDFLD     (ERPNDB-KEY)
 20433*     END-EXEC.
 20434     MOVE 0
 20435       TO DFHEIV11
 20436*    MOVE '&4         G          &   #00017306' TO DFHEIV0
 20437     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20438     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20439     MOVE X'2020233030303137333036' TO DFHEIV0(25:11)
 20440     CALL 'kxdfhei1' USING DFHEIV0,
 20441           FILE-ID-ERPNDB,
 20442           ERPNDB-KEY,
 20443           DFHEIV99,
 20444           DFHEIV11,
 20445           DFHEIV99
 20446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20447
 20448
 20449
 20450* EXEC CICS READNEXT
 20451*         DATASET    (FILE-ID-ERPNDB)
 20452*         SET        (ADDRESS OF PENDING-BUSINESS)
 20453*         RIDFLD     (ERPNDB-KEY)
 20454*    END-EXEC.
 20455     MOVE 0
 20456       TO DFHEIV11
 20457*    MOVE '&.S                   )   #00017311' TO DFHEIV0
 20458     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20459     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20460     MOVE X'2020233030303137333131' TO DFHEIV0(25:11)
 20461     CALL 'kxdfhei1' USING DFHEIV0,
 20462           FILE-ID-ERPNDB,
 20463           DFHEIV20,
 20464           DFHEIV99,
 20465           ERPNDB-KEY,
 20466           DFHEIV99,
 20467           DFHEIV11,
 20468           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 375
* VP6311.cbl
 20469           DFHEIV99
 20470     SET ADDRESS OF PENDING-BUSINESS TO
 20471         DFHEIV20
 20472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20473
 20474
 20475
 20476* EXEC CICS READPREV
 20477*         DATASET    (FILE-ID-ERPNDB)
 20478*         SET        (ADDRESS OF PENDING-BUSINESS)
 20479*         RIDFLD     (ERPNDB-KEY)
 20480*    END-EXEC.
 20481     MOVE 0
 20482       TO DFHEIV11
 20483*    MOVE '&0S                   )   #00017317' TO DFHEIV0
 20484     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20485     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20486     MOVE X'2020233030303137333137' TO DFHEIV0(25:11)
 20487     CALL 'kxdfhei1' USING DFHEIV0,
 20488           FILE-ID-ERPNDB,
 20489           DFHEIV20,
 20490           DFHEIV99,
 20491           ERPNDB-KEY,
 20492           DFHEIV99,
 20493           DFHEIV11,
 20494           DFHEIV99,
 20495           DFHEIV99
 20496     SET ADDRESS OF PENDING-BUSINESS TO
 20497         DFHEIV20
 20498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20499
 20500
 20501     GO TO 4810-READ-PREV-RECORD.
 20502
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 376
* VP6311.cbl
 20504
 20505******************************************************************
 20506*                                                                *
 20507*           B R O W S E   C S R   B A C K W A R D                *
 20508*                                                                *
 20509******************************************************************
 20510
 20511 4900-BROWSE-CSR-BACKWARD.
 20512
 20513     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20514
 20515
 20516* EXEC CICS HANDLE CONDITION
 20517*         NOTFND   (4970-NOT-FOUND)
 20518*         ENDFILE  (4950-END-RECORDS)
 20519*    END-EXEC
 20520*    MOVE '"$I''                  ! Q #00017337' TO DFHEIV0
 20521     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20523     MOVE X'5120233030303137333337' TO DFHEIV0(25:11)
 20524     CALL 'kxdfhei1' USING DFHEIV0
 20525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20526
 20527
 20528* EXEC CICS STARTBR
 20529*         DATASET   (FILE-ID-ERPNDB4)
 20530*         RIDFLD    (ERPNDB-CSR-KEY)
 20531*    END-EXEC.
 20532     MOVE 0
 20533       TO DFHEIV11
 20534*    MOVE '&,         G          &   #00017342' TO DFHEIV0
 20535     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20536     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20537     MOVE X'2020233030303137333432' TO DFHEIV0(25:11)
 20538     CALL 'kxdfhei1' USING DFHEIV0,
 20539           FILE-ID-ERPNDB4,
 20540           ERPNDB-CSR-KEY,
 20541           DFHEIV99,
 20542           DFHEIV11,
 20543           DFHEIV99
 20544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20545
 20546
 20547     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20548                                    WS-FIRST-TIME-SW.
 20549
 20550 4905-READ-PREV-RECORD.
 20551
 20552* EXEC CICS READPREV
 20553*         DATASET    (FILE-ID-ERPNDB4)
 20554*         SET        (ADDRESS OF PENDING-BUSINESS)
 20555*         RIDFLD     (ERPNDB-CSR-KEY)
 20556*    END-EXEC.
 20557     MOVE 0
 20558       TO DFHEIV11
 20559*    MOVE '&0S                   )   #00017351' TO DFHEIV0
 20560     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20561     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 377
* VP6311.cbl
 20562     MOVE X'2020233030303137333531' TO DFHEIV0(25:11)
 20563     CALL 'kxdfhei1' USING DFHEIV0,
 20564           FILE-ID-ERPNDB4,
 20565           DFHEIV20,
 20566           DFHEIV99,
 20567           ERPNDB-CSR-KEY,
 20568           DFHEIV99,
 20569           DFHEIV11,
 20570           DFHEIV99,
 20571           DFHEIV99
 20572     SET ADDRESS OF PENDING-BUSINESS TO
 20573         DFHEIV20
 20574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20575
 20576
 20577     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20578
 20579     IF WS-BATCH-PREFIX = '#CL'
 20580         GO TO 4905-READ-PREV-RECORD.
 20581
 20582     IF FIRST-TIME
 20583         MOVE SPACE               TO WS-FIRST-TIME-SW
 20584         GO TO 4905-READ-PREV-RECORD.
 20585
 20586     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20587        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20588        GO TO 4950-END-RECORDS.
 20589
 20590     IF PB-BATCH-TRAILER
 20591        GO TO 4905-READ-PREV-RECORD.
 20592
 20593     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20594
 20595     IF  WS-BATCH-PREFIX = '#CL'
 20596         GO TO 4905-READ-PREV-RECORD.
 20597
 20598     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20599        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20600           GO TO 4905-READ-PREV-RECORD
 20601        ELSE
 20602           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20603              GO TO 4910-CHECK-REC-TYPE
 20604           ELSE
 20605              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20606                 GO TO 4910-CHECK-REC-TYPE
 20607              ELSE
 20608                 GO TO 4905-READ-PREV-RECORD.
 20609
 20610     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20611        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20612           GO TO 4905-READ-PREV-RECORD.
 20613
 20614 4910-CHECK-REC-TYPE.
 20615     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20616         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20617             NEXT SENTENCE
 20618         ELSE
 20619             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 378
* VP6311.cbl
 20620
 20621     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20622         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20623             NEXT SENTENCE
 20624        ELSE
 20625             GO TO 4905-READ-PREV-RECORD.
 20626
 20627     IF NOT DISPLAY-CHANGE-RECORDS AND
 20628            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20629        GO TO 4905-READ-PREV-RECORD.
 20630
 20631     IF DISPLAY-HOLD-RECORDS AND
 20632        NOT PB-RECORD-ON-HOLD
 20633          GO TO 4905-READ-PREV-RECORD.
 20634
 20635     IF PB-ISSUE
 20636        IF DISPLAY-CHK-REQ-RECORDS
 20637           GO TO 4905-READ-PREV-RECORD.
 20638
 20639     IF PB-ISSUE
 20640        IF ISSUE-WITH-WARNING
 20641           IF PB-WARNING-ERRORS
 20642              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20643                  GO TO 4505-READ-PREV-RECORD
 20644              ELSE
 20645                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20646                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20647                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20648                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20649                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20650                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20651                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20652                 GO TO 7000-DISPLAY-ISSUES
 20653           ELSE
 20654              GO TO 4905-READ-PREV-RECORD.
 20655
 20656     IF PB-ISSUE
 20657        IF (ISSUES-IN-ERROR AND
 20658            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20659            ALL-ISSUES
 20660            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20661            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20662            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20663            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20664            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20665            MOVE PB-SV-STATE            TO PI-SV-STATE
 20666            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20667            GO TO 7000-DISPLAY-ISSUES
 20668        ELSE
 20669            GO TO 4905-READ-PREV-RECORD.
 20670
 20671     IF PB-CANCELLATION
 20672        IF DISPLAY-CHK-REQ-RECORDS
 20673           IF PB-C-REFUND-REQUESTED
 20674              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20675              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20676              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20677              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 379
* VP6311.cbl
 20678              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20679              MOVE PB-SV-STATE            TO PI-SV-STATE
 20680              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20681              GO TO 7100-DISPLAY-CANCELS
 20682           ELSE
 20683              GO TO 4905-READ-PREV-RECORD.
 20684
 20685     IF PB-CANCELLATION
 20686        IF CANCEL-WITH-WARNING
 20687           IF PB-WARNING-ERRORS
 20688              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20689                  GO TO 4505-READ-PREV-RECORD
 20690              ELSE
 20691                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20692                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20693                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20694                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20695                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20696                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20697                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20698                 GO TO 7100-DISPLAY-CANCELS
 20699           ELSE
 20700              GO TO 4905-READ-PREV-RECORD.
 20701
 20702     IF PB-CANCELLATION
 20703        IF (CANCEL-IN-ERROR  AND
 20704            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20705            ALL-CANCELS
 20706            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20707            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20708            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20709            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20710            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20711            MOVE PB-SV-STATE            TO PI-SV-STATE
 20712            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20713            GO TO 7100-DISPLAY-CANCELS.
 20714
 20715     GO TO 4905-READ-PREV-RECORD.
 20716
 20717 4950-END-RECORDS.
 20718     IF PI-MAP-NAME = VP631B
 20719        MOVE -1                  TO BMAINTL
 20720     ELSE
 20721        IF PI-MAP-NAME = VP631C
 20722           MOVE -1               TO CMAINTL
 20723        ELSE
 20724           MOVE -1               TO DPFENTRL.
 20725
 20726     MOVE ER-2255               TO EMI-ERROR.
 20727     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20728     GO TO 8200-SEND-DATAONLY.
 20729
 20730 4970-NOT-FOUND.
 20731
 20732******************************************************************
 20733*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20734******************************************************************
 20735
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 380
* VP6311.cbl
 20736
 20737* EXEC CICS RESETBR
 20738*         DATASET    (FILE-ID-ERPNDB4)
 20739*         RIDFLD     (ERPNDB-CSR-KEY)
 20740*    END-EXEC.
 20741     MOVE 0
 20742       TO DFHEIV11
 20743*    MOVE '&4         G          &   #00017516' TO DFHEIV0
 20744     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20745     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20746     MOVE X'2020233030303137353136' TO DFHEIV0(25:11)
 20747     CALL 'kxdfhei1' USING DFHEIV0,
 20748           FILE-ID-ERPNDB4,
 20749           ERPNDB-CSR-KEY,
 20750           DFHEIV99,
 20751           DFHEIV11,
 20752           DFHEIV99
 20753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20754
 20755
 20756
 20757* EXEC CICS READNEXT
 20758*         DATASET    (FILE-ID-ERPNDB4)
 20759*         SET        (ADDRESS OF PENDING-BUSINESS)
 20760*         RIDFLD     (ERPNDB-CSR-KEY)
 20761*    END-EXEC.
 20762     MOVE 0
 20763       TO DFHEIV11
 20764*    MOVE '&.S                   )   #00017521' TO DFHEIV0
 20765     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20766     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20767     MOVE X'2020233030303137353231' TO DFHEIV0(25:11)
 20768     CALL 'kxdfhei1' USING DFHEIV0,
 20769           FILE-ID-ERPNDB4,
 20770           DFHEIV20,
 20771           DFHEIV99,
 20772           ERPNDB-CSR-KEY,
 20773           DFHEIV99,
 20774           DFHEIV11,
 20775           DFHEIV99,
 20776           DFHEIV99
 20777     SET ADDRESS OF PENDING-BUSINESS TO
 20778         DFHEIV20
 20779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20780
 20781
 20782
 20783* EXEC CICS READPREV
 20784*         DATASET    (FILE-ID-ERPNDB4)
 20785*         SET        (ADDRESS OF PENDING-BUSINESS)
 20786*         RIDFLD     (ERPNDB-CSR-KEY)
 20787*    END-EXEC.
 20788     MOVE 0
 20789       TO DFHEIV11
 20790*    MOVE '&0S                   )   #00017527' TO DFHEIV0
 20791     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20792     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20793     MOVE X'2020233030303137353237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 381
* VP6311.cbl
 20794     CALL 'kxdfhei1' USING DFHEIV0,
 20795           FILE-ID-ERPNDB4,
 20796           DFHEIV20,
 20797           DFHEIV99,
 20798           ERPNDB-CSR-KEY,
 20799           DFHEIV99,
 20800           DFHEIV11,
 20801           DFHEIV99,
 20802           DFHEIV99
 20803     SET ADDRESS OF PENDING-BUSINESS TO
 20804         DFHEIV20
 20805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20806
 20807
 20808 4980-READ-PREV-RECORD.
 20809
 20810* EXEC CICS READPREV
 20811*         DATASET    (FILE-ID-ERPNDB4)
 20812*         SET        (ADDRESS OF PENDING-BUSINESS)
 20813*         RIDFLD     (ERPNDB-CSR-KEY)
 20814*    END-EXEC.
 20815     MOVE 0
 20816       TO DFHEIV11
 20817*    MOVE '&0S                   )   #00017534' TO DFHEIV0
 20818     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20819     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20820     MOVE X'2020233030303137353334' TO DFHEIV0(25:11)
 20821     CALL 'kxdfhei1' USING DFHEIV0,
 20822           FILE-ID-ERPNDB4,
 20823           DFHEIV20,
 20824           DFHEIV99,
 20825           ERPNDB-CSR-KEY,
 20826           DFHEIV99,
 20827           DFHEIV11,
 20828           DFHEIV99,
 20829           DFHEIV99
 20830     SET ADDRESS OF PENDING-BUSINESS TO
 20831         DFHEIV20
 20832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20833
 20834
 20835     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20836
 20837     IF WS-BATCH-PREFIX = '#CL'
 20838        GO TO 4980-READ-PREV-RECORD.
 20839
 20840     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20841     GO TO 4905-READ-PREV-RECORD.
 20842
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 382
* VP6311.cbl
 20844
 20845
 20846******************************************************************
 20847*                                                                *
 20848*        B R O W S E   B A T C H   H E A D E R S                 *
 20849*                                                                *
 20850******************************************************************
 20851
 20852 5000-BROWSE-BATCH-HEADERS.
 20853
 20854     IF EIBTRNID NOT = TRANS-EXB1
 20855        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20856        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20857        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20858        GO TO 5010-READ-NEXT-RECORD.
 20859
 20860     IF EIBAID = DFHPF4
 20861        MOVE '0'                TO PI-EDIT-SW
 20862        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20863        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20864        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20865        GO TO 5010-READ-NEXT-RECORD.
 20866
 20867     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20868     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20869     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20870
 20871
 20872* EXEC CICS HANDLE CONDITION
 20873*         ENDFILE  (5050-NOT-FOUND)
 20874*    END-EXEC.
 20875*    MOVE '"$''                   ! R #00017576' TO DFHEIV0
 20876     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20878     MOVE X'5220233030303137353736' TO DFHEIV0(25:11)
 20879     CALL 'kxdfhei1' USING DFHEIV0
 20880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20881
 20882
 20883 5010-READ-NEXT-RECORD.
 20884
 20885* EXEC CICS HANDLE CONDITION
 20886*         NOTFND    (5050-NOT-FOUND)
 20887*    END-EXEC.
 20888*    MOVE '"$I                   ! S #00017581' TO DFHEIV0
 20889     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20891     MOVE X'5320233030303137353831' TO DFHEIV0(25:11)
 20892     CALL 'kxdfhei1' USING DFHEIV0
 20893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20894
 20895
 20896
 20897* EXEC CICS READ
 20898*         DATASET   (FILE-ID-ERPNDB)
 20899*         SET       (ADDRESS OF PENDING-BUSINESS)
 20900*         RIDFLD    (ERPNDB-KEY)
 20901*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 383
* VP6311.cbl
 20902*    END-EXEC.
 20903*    MOVE '&"S        G          (   #00017585' TO DFHEIV0
 20904     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20906     MOVE X'2020233030303137353835' TO DFHEIV0(25:11)
 20907     CALL 'kxdfhei1' USING DFHEIV0,
 20908           FILE-ID-ERPNDB,
 20909           DFHEIV20,
 20910           DFHEIV99,
 20911           ERPNDB-KEY,
 20912           DFHEIV99,
 20913           DFHEIV99,
 20914           DFHEIV99
 20915     SET ADDRESS OF PENDING-BUSINESS TO
 20916         DFHEIV20
 20917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20918
 20919
 20920     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20921         GO TO 5050-NOT-FOUND.
 20922
 20923     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20924
 20925     IF WS-BATCH-PREFIX = '#CL'
 20926         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20927         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20928         GO TO 5010-READ-NEXT-RECORD.
 20929
 20930     IF NOT PB-BATCH-TRAILER
 20931         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20932         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20933         GO TO 5010-READ-NEXT-RECORD.
 20934
 20935     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20936         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20937             NEXT SENTENCE
 20938         ELSE
 20939             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20940             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20941             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20942             GO TO 5010-READ-NEXT-RECORD.
 20943
 20944     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20945         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20946             NEXT SENTENCE
 20947        ELSE
 20948             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20949             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20950             GO TO 5010-READ-NEXT-RECORD.
 20951
 20952     IF EIBAID = DFHPF4
 20953        MOVE '0'                TO PI-EDIT-SW
 20954        GO TO 7200-DISPLAY-BATCHES.
 20955
 20956     IF PI-CSR-BROWSE
 20957        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20958           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20959           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 384
* VP6311.cbl
 20960           GO TO 5010-READ-NEXT-RECORD.
 20961
 20962     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20963       IF PI-PB-CARRIER    = SPACES AND
 20964          PI-PB-GROUPING   = SPACES AND
 20965          PI-PB-STATE      = SPACES AND
 20966          PI-PB-ACCOUNT    = SPACES
 20967            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20968            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20969            GO TO 7200-DISPLAY-BATCHES
 20970         ELSE
 20971           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20972              PI-PB-GROUPING   = PB-GROUPING AND
 20973              PI-PB-STATE      = PB-STATE    AND
 20974              PI-PB-ACCOUNT    = PB-ACCOUNT
 20975              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20976              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20977              GO TO 7200-DISPLAY-BATCHES.
 20978
 20979     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20980     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20981
 20982
 20983* EXEC CICS HANDLE CONDITION
 20984*         NOTFND    (5050-NOT-FOUND)
 20985*    END-EXEC.
 20986*    MOVE '"$I                   ! T #00017654' TO DFHEIV0
 20987     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20989     MOVE X'5420233030303137363534' TO DFHEIV0(25:11)
 20990     CALL 'kxdfhei1' USING DFHEIV0
 20991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20992
 20993
 20994
 20995* EXEC CICS READ
 20996*         DATASET   (FILE-ID-ERPNDB)
 20997*         SET       (ADDRESS OF PENDING-BUSINESS)
 20998*         RIDFLD    (ERPNDB-KEY)
 20999*         GTEQ
 21000*    END-EXEC.
 21001*    MOVE '&"S        G          (   #00017658' TO DFHEIV0
 21002     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21004     MOVE X'2020233030303137363538' TO DFHEIV0(25:11)
 21005     CALL 'kxdfhei1' USING DFHEIV0,
 21006           FILE-ID-ERPNDB,
 21007           DFHEIV20,
 21008           DFHEIV99,
 21009           ERPNDB-KEY,
 21010           DFHEIV99,
 21011           DFHEIV99,
 21012           DFHEIV99
 21013     SET ADDRESS OF PENDING-BUSINESS TO
 21014         DFHEIV20
 21015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21016
 21017
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 385
* VP6311.cbl
 21018     GO TO 5010-READ-NEXT-RECORD.
 21019
 21020 5050-NOT-FOUND.
 21021
 21022******************************************************************
 21023*                                                                *
 21024*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21025*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING     *
 21026*         PROGRAM.                                               *
 21027*                                                                *
 21028******************************************************************
 21029
 21030     IF EIBTRNID NOT = TRANS-EXB1
 21031        IF PENDING-BUS-RECS-FOUND
 21032            NEXT SENTENCE
 21033          ELSE
 21034            MOVE '9'            TO PI-BROWSE-SW
 21035            GO TO 9400-CLEAR.
 21036
 21037     MOVE ER-2256                TO EMI-ERROR.
 21038     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21039
 21040     IF PI-MAP-NAME = SPACES
 21041        MOVE VP631D              TO PI-MAP-NAME
 21042        MOVE -1                  TO DPFENTRL
 21043        GO TO 8100-SEND-INITIAL-MAP.
 21044
 21045     IF PI-MAP-NAME = VP631B
 21046        MOVE -1                  TO BMAINTL
 21047     ELSE
 21048        IF PI-MAP-NAME = VP631C
 21049           MOVE -1               TO CMAINTL
 21050        ELSE
 21051           MOVE -1               TO DPFENTRL
 21052           GO TO 8200-SEND-DATAONLY.
 21053
 21054     GO TO 8100-SEND-INITIAL-MAP.
 21055
 21056     .
 21057 5100-PROCESS-POL-RESC.
 21058     MOVE ZEROS                  TO CG-LF-BENCD
 21059                                    CG-AH-BENCD
 21060                                    CG-LF-CAN-AMT
 21061                                    CG-AH-CAN-AMT
 21062     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21063                                    CG-AH-CAN-DT
 21064     MOVE SPACES                 TO CG-BATCH-NO
 21065     MOVE '4'                    TO CG-OPTION-CODE
 21066     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21067     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21068     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21069     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21070     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21071     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21072     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21073     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21074     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21075     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 386
* VP6311.cbl
 21076     MOVE PI-PREV-ALT-KEY (1:33)
 21077                                 TO CG-CERT-KEY
 21078     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21079     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21080                                    CG-AH-CAN-AMT
 21081     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21082                                    CG-AH-CAN-DT
 21083     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21084     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21085      display 'about to cancel ' cg-cert-key
 21086
 21087* EXEC CICS LINK
 21088*        PROGRAM  ('ELCANC')
 21089*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21090*    END-EXEC
 21091     MOVE LENGTH OF
 21092      CANCEL-GEN-PASS-AREA
 21093       TO DFHEIV11
 21094     MOVE 'ELCANC' TO DFHEIV1
 21095*    MOVE '."C                   (   #00017733' TO DFHEIV0
 21096     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21098     MOVE X'2020233030303137373333' TO DFHEIV0(25:11)
 21099     CALL 'kxdfhei1' USING DFHEIV0,
 21100           DFHEIV1,
 21101           CANCEL-GEN-PASS-AREA,
 21102           DFHEIV11,
 21103           DFHEIV99,
 21104           DFHEIV99,
 21105           DFHEIV99,
 21106           DFHEIV99
 21107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21108     IF CG-SUCCESS
 21109        CONTINUE
 21110     ELSE
 21111        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21112        MOVE '3'                 TO EMI-SWITCH1
 21113        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21114        EVALUATE TRUE
 21115           WHEN CG-DATE-ERROR
 21116             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21117           WHEN CG-CERT-NOT-FOUND
 21118             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21119           WHEN CG-AMOUNT-ERROR
 21120             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21121           WHEN CG-OPTION-ERROR
 21122             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21123           WHEN CG-PREV-CAN
 21124             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21125           WHEN CG-INVALID-DATA
 21126             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21127           WHEN CG-NO-ACCT-MSTR
 21128             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21129           WHEN CG-SFX-A-EXIST
 21130             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21131           WHEN CG-MISC-ERROR
 21132             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21133           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 387
* VP6311.cbl
 21134             MOVE ' ERROR - ELCANC - RETURN '
 21135                                 TO EMI-ERROR-TEXT (1) (12:25)
 21136        END-EVALUATE
 21137        GO TO 8200-SEND-DATAONLY
 21138     END-IF
 21139     .
 21140 5100-EXIT.
 21141     EXIT.
 21142
 21143******************************************************************
 21144*                                                                *
 21145*        B R O W S E   B A T C H   B A C K W A R D S             *
 21146*                                                                *
 21147******************************************************************
 21148
 21149 5500-BROWSE-BATCH-BACKWARD.
 21150
 21151* EXEC CICS HANDLE CONDITION
 21152*         NOTFND   (5550-END-RECORDS)
 21153*         ENDFILE  (5550-END-RECORDS)
 21154*    END-EXEC.
 21155*    MOVE '"$I''                  ! U #00017779' TO DFHEIV0
 21156     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21158     MOVE X'5520233030303137373739' TO DFHEIV0(25:11)
 21159     CALL 'kxdfhei1' USING DFHEIV0
 21160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21161
 21162
 21163 5505-START-BROWSE.
 21164     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21165     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21166     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21167
 21168
 21169* EXEC CICS STARTBR
 21170*         DATASET   (FILE-ID-ERPNDB)
 21171*         RIDFLD    (ERPNDB-ALT-KEY)
 21172*    END-EXEC.
 21173     MOVE 0
 21174       TO DFHEIV11
 21175*    MOVE '&,         G          &   #00017789' TO DFHEIV0
 21176     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21177     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21178     MOVE X'2020233030303137373839' TO DFHEIV0(25:11)
 21179     CALL 'kxdfhei1' USING DFHEIV0,
 21180           FILE-ID-ERPNDB,
 21181           ERPNDB-ALT-KEY,
 21182           DFHEIV99,
 21183           DFHEIV11,
 21184           DFHEIV99
 21185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21186
 21187
 21188     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21189
 21190
 21191* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 388
* VP6311.cbl
 21192*         DATASET    (FILE-ID-ERPNDB)
 21193*         SET        (ADDRESS OF PENDING-BUSINESS)
 21194*         RIDFLD     (ERPNDB-KEY)
 21195*    END-EXEC.
 21196     MOVE 0
 21197       TO DFHEIV11
 21198*    MOVE '&.S                   )   #00017796' TO DFHEIV0
 21199     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21200     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21201     MOVE X'2020233030303137373936' TO DFHEIV0(25:11)
 21202     CALL 'kxdfhei1' USING DFHEIV0,
 21203           FILE-ID-ERPNDB,
 21204           DFHEIV20,
 21205           DFHEIV99,
 21206           ERPNDB-KEY,
 21207           DFHEIV99,
 21208           DFHEIV11,
 21209           DFHEIV99,
 21210           DFHEIV99
 21211     SET ADDRESS OF PENDING-BUSINESS TO
 21212         DFHEIV20
 21213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21214
 21215
 21216
 21217* EXEC CICS READPREV
 21218*         DATASET    (FILE-ID-ERPNDB)
 21219*         SET        (ADDRESS OF PENDING-BUSINESS)
 21220*         RIDFLD     (ERPNDB-KEY)
 21221*    END-EXEC.
 21222     MOVE 0
 21223       TO DFHEIV11
 21224*    MOVE '&0S                   )   #00017802' TO DFHEIV0
 21225     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21226     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21227     MOVE X'2020233030303137383032' TO DFHEIV0(25:11)
 21228     CALL 'kxdfhei1' USING DFHEIV0,
 21229           FILE-ID-ERPNDB,
 21230           DFHEIV20,
 21231           DFHEIV99,
 21232           ERPNDB-KEY,
 21233           DFHEIV99,
 21234           DFHEIV11,
 21235           DFHEIV99,
 21236           DFHEIV99
 21237     SET ADDRESS OF PENDING-BUSINESS TO
 21238         DFHEIV20
 21239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21240
 21241
 21242
 21243* EXEC CICS READPREV
 21244*         DATASET    (FILE-ID-ERPNDB)
 21245*         SET        (ADDRESS OF PENDING-BUSINESS)
 21246*         RIDFLD     (ERPNDB-KEY)
 21247*    END-EXEC.
 21248     MOVE 0
 21249       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 389
* VP6311.cbl
 21250*    MOVE '&0S                   )   #00017808' TO DFHEIV0
 21251     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21252     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21253     MOVE X'2020233030303137383038' TO DFHEIV0(25:11)
 21254     CALL 'kxdfhei1' USING DFHEIV0,
 21255           FILE-ID-ERPNDB,
 21256           DFHEIV20,
 21257           DFHEIV99,
 21258           ERPNDB-KEY,
 21259           DFHEIV99,
 21260           DFHEIV11,
 21261           DFHEIV99,
 21262           DFHEIV99
 21263     SET ADDRESS OF PENDING-BUSINESS TO
 21264         DFHEIV20
 21265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21266
 21267
 21268     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21269        GO TO 5550-END-RECORDS.
 21270
 21271     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21272
 21273     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21274
 21275     IF  WS-BATCH-PREFIX = '#CL'
 21276             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21277
 21278* EXEC CICS ENDBR
 21279*                 DATASET  (FILE-ID-ERPNDB)
 21280*            END-EXEC
 21281     MOVE 0
 21282       TO DFHEIV11
 21283*    MOVE '&2                    $   #00017823' TO DFHEIV0
 21284     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21285     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21286     MOVE X'2020233030303137383233' TO DFHEIV0(25:11)
 21287     CALL 'kxdfhei1' USING DFHEIV0,
 21288           FILE-ID-ERPNDB,
 21289           DFHEIV11,
 21290           DFHEIV99
 21291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21292         GO TO 5505-START-BROWSE.
 21293
 21294     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21295         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21296             NEXT SENTENCE
 21297         ELSE
 21298             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21299
 21300* EXEC CICS ENDBR
 21301*                 DATASET  (FILE-ID-ERPNDB)
 21302*            END-EXEC
 21303     MOVE 0
 21304       TO DFHEIV11
 21305*    MOVE '&2                    $   #00017833' TO DFHEIV0
 21306     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21307     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 390
* VP6311.cbl
 21308     MOVE X'2020233030303137383333' TO DFHEIV0(25:11)
 21309     CALL 'kxdfhei1' USING DFHEIV0,
 21310           FILE-ID-ERPNDB,
 21311           DFHEIV11,
 21312           DFHEIV99
 21313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21314             GO TO 5505-START-BROWSE.
 21315
 21316
 21317     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21318         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21319             NEXT SENTENCE
 21320        ELSE
 21321             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21322
 21323* EXEC CICS ENDBR
 21324*                 DATASET  (FILE-ID-ERPNDB)
 21325*            END-EXEC
 21326     MOVE 0
 21327       TO DFHEIV11
 21328*    MOVE '&2                    $   #00017844' TO DFHEIV0
 21329     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21330     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21331     MOVE X'2020233030303137383434' TO DFHEIV0(25:11)
 21332     CALL 'kxdfhei1' USING DFHEIV0,
 21333           FILE-ID-ERPNDB,
 21334           DFHEIV11,
 21335           DFHEIV99
 21336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21337             GO TO 5505-START-BROWSE.
 21338
 21339     IF NOT PB-BATCH-TRAILER
 21340        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21341
 21342* EXEC CICS ENDBR
 21343*            DATASET  (FILE-ID-ERPNDB)
 21344*       END-EXEC
 21345     MOVE 0
 21346       TO DFHEIV11
 21347*    MOVE '&2                    $   #00017851' TO DFHEIV0
 21348     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21350     MOVE X'2020233030303137383531' TO DFHEIV0(25:11)
 21351     CALL 'kxdfhei1' USING DFHEIV0,
 21352           FILE-ID-ERPNDB,
 21353           DFHEIV11,
 21354           DFHEIV99
 21355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21356        GO TO 5505-START-BROWSE.
 21357
 21358     IF PI-CSR-BROWSE
 21359        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21360           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21361
 21362* EXEC CICS ENDBR
 21363*               DATASET  (FILE-ID-ERPNDB)
 21364*          END-EXEC
 21365     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 391
* VP6311.cbl
 21366       TO DFHEIV11
 21367*    MOVE '&2                    $   #00017859' TO DFHEIV0
 21368     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21369     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21370     MOVE X'2020233030303137383539' TO DFHEIV0(25:11)
 21371     CALL 'kxdfhei1' USING DFHEIV0,
 21372           FILE-ID-ERPNDB,
 21373           DFHEIV11,
 21374           DFHEIV99
 21375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21376           GO TO 5505-START-BROWSE.
 21377
 21378     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21379        IF PI-PB-CARRIER    = SPACES AND
 21380           PI-PB-GROUPING   = SPACES AND
 21381           PI-PB-STATE      = SPACES AND
 21382           PI-PB-ACCOUNT    = SPACES
 21383             GO TO 7200-DISPLAY-BATCHES
 21384          ELSE
 21385            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21386               PI-PB-GROUPING   = PB-GROUPING AND
 21387               PI-PB-STATE      = PB-STATE    AND
 21388               PI-PB-ACCOUNT    = PB-ACCOUNT
 21389                 GO TO 7200-DISPLAY-BATCHES.
 21390
 21391     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21392
 21393
 21394* EXEC CICS ENDBR
 21395*         DATASET  (FILE-ID-ERPNDB)
 21396*    END-EXEC.
 21397     MOVE 0
 21398       TO DFHEIV11
 21399*    MOVE '&2                    $   #00017879' TO DFHEIV0
 21400     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21401     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21402     MOVE X'2020233030303137383739' TO DFHEIV0(25:11)
 21403     CALL 'kxdfhei1' USING DFHEIV0,
 21404           FILE-ID-ERPNDB,
 21405           DFHEIV11,
 21406           DFHEIV99
 21407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21408
 21409
 21410     GO TO 5505-START-BROWSE.
 21411
 21412 5550-END-RECORDS.
 21413     MOVE ER-2257                TO EMI-ERROR.
 21414     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21415     MOVE -1                     TO DPFENTRL.
 21416
 21417     GO TO 8200-SEND-DATAONLY.
 21418
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 392
* VP6311.cbl
 21420
 21421******************************************************************
 21422*                                                                *
 21423*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21424*                                                                *
 21425******************************************************************
 21426
 21427 6000-CREATE-TEMP-STORAGE.
 21428
 21429
 21430* EXEC CICS HANDLE CONDITION
 21431*        QIDERR  (6050-QID-ERROR)
 21432*    END-EXEC.
 21433*    MOVE '"$N                   ! V #00017902' TO DFHEIV0
 21434     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21436     MOVE X'5620233030303137393032' TO DFHEIV0(25:11)
 21437     CALL 'kxdfhei1' USING DFHEIV0
 21438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21439
 21440
 21441
 21442* EXEC CICS WRITEQ TS
 21443*        QUEUE    (QID)
 21444*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21445*        LENGTH   (WS-COMM-LENGTH)
 21446*        ITEM     (W-ONE)
 21447*    END-EXEC.
 21448*    MOVE '*" I   L              ''   #00017906' TO DFHEIV0
 21449     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21450     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21451     MOVE X'2020233030303137393036' TO DFHEIV0(25:11)
 21452     CALL 'kxdfhei1' USING DFHEIV0,
 21453           QID,
 21454           PROGRAM-INTERFACE-BLOCK,
 21455           WS-COMM-LENGTH,
 21456           W-ONE,
 21457           DFHEIV99,
 21458           DFHEIV99
 21459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21460
 21461
 21462 6000-EXIT.
 21463      EXIT.
 21464
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 393
* VP6311.cbl
 21466
 21467******************************************************************
 21468*                                                                *
 21469*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21470*                                                                *
 21471******************************************************************
 21472
 21473 6050-RECOVER-TEMP-STORAGE.
 21474     IF PGM-NAME = XCTL-EL6312
 21475        GO TO 6050-EXIT.
 21476
 21477     IF PGM-NAME = XCTL-EL6313
 21478        GO TO 6050-EXIT.
 21479
 21480     IF PGM-NAME = XCTL-EL6315
 21481         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21482     END-IF
 21483
 21484     IF PGM-NAME = XCTL-EL6316
 21485         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21486     END-IF
 21487
 21488
 21489* EXEC CICS HANDLE CONDITION
 21490*        QIDERR  (6050-QID-ERROR)
 21491*    END-EXEC.
 21492*    MOVE '"$N                   ! W #00017939' TO DFHEIV0
 21493     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21495     MOVE X'5720233030303137393339' TO DFHEIV0(25:11)
 21496     CALL 'kxdfhei1' USING DFHEIV0
 21497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21498
 21499
 21500
 21501* EXEC CICS READQ TS
 21502*         QUEUE   (QID)
 21503*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21504*         LENGTH  (WS-COMM-LENGTH)
 21505*         ITEM    (W-ONE)
 21506*     END-EXEC.
 21507*    MOVE '*$II   L              ''   #00017943' TO DFHEIV0
 21508     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21509     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21510     MOVE X'2020233030303137393433' TO DFHEIV0(25:11)
 21511     CALL 'kxdfhei1' USING DFHEIV0,
 21512           QID,
 21513           PROGRAM-INTERFACE-BLOCK,
 21514           WS-COMM-LENGTH,
 21515           W-ONE,
 21516           DFHEIV99,
 21517           DFHEIV99
 21518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21519
 21520
 21521 6050-DELETE-TEMP-STORAGE.
 21522
 21523
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 394
* VP6311.cbl
 21524* EXEC CICS DELETEQ TS
 21525*        QUEUE   (QID)
 21526*    END-EXEC.
 21527*    MOVE '*&                    #   #00017952' TO DFHEIV0
 21528     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21529     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21530     MOVE X'2020233030303137393532' TO DFHEIV0(25:11)
 21531     CALL 'kxdfhei1' USING DFHEIV0,
 21532           QID,
 21533           DFHEIV99
 21534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21535
 21536
 21537     GO TO 6050-EXIT.
 21538
 21539 6050-QID-ERROR.
 21540     MOVE ER-0033                TO EMI-ERROR
 21541     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21542
 21543 6050-EXIT.
 21544      EXIT.
 21545
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 395
* VP6311.cbl
 21547
 21548******************************************************************
 21549*                                                                *
 21550*            T E R M   C O N V E R S I O N                       *
 21551*                                                                *
 21552******************************************************************
 21553
 21554 6100-TERM-CONVERSION.
 21555
 21556     IF PI-BPMTS = ZERO
 21557         GO TO 6199-EXIT.
 21558
 21559
 21560 6105-ROUND-TERM.
 21561
 21562     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21563         ADD +1                  TO WS-CALC-TERM-WHOLE
 21564         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21565
 21566     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21567         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21568
 21569     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21570         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21571                                      WS-BTERM    (WS-SUB1)
 21572         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21573
 21574
 21575 6124-CHECK-BENEFIT.
 21576
 21577     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21578        GO TO 6126-COMPUTE-BENEFIT.
 21579
 21580     GO TO 6199-EXIT.
 21581
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 396
* VP6311.cbl
 21583******************************************************************
 21584**         COMPUTE TERM AND BENEFIT
 21585******************************************************************
 21586 6125-COMPUTE-TERM-BENEFIT.
 21587
 21588     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21589        PI-BPMTAMT = ZERO
 21590         GO TO 6199-EXIT.
 21591
 21592     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21593                                     WS-BTERM  (WS-SUB1).
 21594     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21595
 21596 6126-COMPUTE-BENEFIT.
 21597
 21598
 21599     IF WS-SUB1 = +1
 21600        COMPUTE WS-BBEN (WS-SUB1) =
 21601                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21602
 21603     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21604     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21605     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21606
 21607 6199-EXIT.
 21608     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 397
* VP6311.cbl
 21610
 21611******************************************************************
 21612*                                                                *
 21613*             D I S P L A Y   I S S U E S                        *
 21614*                                                                *
 21615******************************************************************
 21616
 21617 6200-CREATE-VADS.
 21618     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21619     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21620     MOVE SPACES                 TO WS-PASS-VADS-REC
 21621
 21622* EXEC CICS GETMAIN
 21623*       SET      (ADDRESS OF PENDING-BUSINESS)
 21624*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21625*       INITIMG  (GETMAIN-SPACE)
 21626*       RESP     (WS-RESPONSE)
 21627*    END-EXEC
 21628*    MOVE ',"IL                  $  N#00018040' TO DFHEIV0
 21629     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21630     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21631     MOVE X'204E233030303138303430' TO DFHEIV0(25:11)
 21632     CALL 'kxdfhei1' USING DFHEIV0,
 21633           DFHEIV20,
 21634           ERPNDB-RECORD-LENGTH,
 21635           GETMAIN-SPACE
 21636     SET ADDRESS OF PENDING-BUSINESS TO
 21637         DFHEIV20
 21638     MOVE EIBRESP  TO WS-RESPONSE
 21639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21640
 21641* EXEC CICS READ
 21642*       INTO    (PENDING-BUSINESS)
 21643*       DATASET (FILE-ID-ERPNDB)
 21644*       RIDFLD  (ERPNDB-KEY)
 21645*       RESP    (WS-RESPONSE)
 21646*    END-EXEC
 21647     MOVE LENGTH OF
 21648      PENDING-BUSINESS
 21649       TO DFHEIV11
 21650*    MOVE '&"IL       E          (  N#00018046' TO DFHEIV0
 21651     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21653     MOVE X'204E233030303138303436' TO DFHEIV0(25:11)
 21654     CALL 'kxdfhei1' USING DFHEIV0,
 21655           FILE-ID-ERPNDB,
 21656           PENDING-BUSINESS,
 21657           DFHEIV11,
 21658           ERPNDB-KEY,
 21659           DFHEIV99,
 21660           DFHEIV99,
 21661           DFHEIV99
 21662     MOVE EIBRESP  TO WS-RESPONSE
 21663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21664     IF RESP-NORMAL
 21665        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21666        IF (RESP-NORMAL)
 21667           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 398
* VP6311.cbl
 21668              AM-CONTROL-PRIMARY (1:20))
 21669           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21670        ELSE
 21671           MOVE 'ACCOUNT NOT FOUND'
 21672                                 TO VD-ACCOUNT-NAME
 21673        END-IF
 21674        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21675                                    TO M1
 21676        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21677        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21678           (A2 > M1)
 21679           OR (WS-WORK-FIELD (A2:1) = '*')
 21680           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21681           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21682        END-PERFORM
 21683        IF A2 > M1
 21684           CONTINUE
 21685        ELSE
 21686           MOVE WS-WORK-FIELD (1:A2 - 1)
 21687                                    TO VD-ACCOUNT-NAME
 21688        END-IF
 21689        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21690        MOVE PB-CARRIER          TO VD-CARRIER
 21691        MOVE PB-GROUPING         TO VD-GROUPING
 21692        MOVE PB-STATE            TO VD-STATE
 21693        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21694        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21695        MOVE PB-CERT-NO          TO VD-CERT-NO
 21696        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21697        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21698        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21699        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21700        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21701        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21702        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21703        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21704        MOVE PB-CSR-ID           TO VD-CSR-ID
 21705        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21706        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21707        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21708        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21709        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21710        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21711        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21712        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21713        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21714        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21715        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21716        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21717        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21718     END-IF
 21719     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21720
 21721
 21722* EXEC CICS GETMAIN
 21723*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21724*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21725*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 399
* VP6311.cbl
 21726*       RESP     (WS-RESPONSE)
 21727*    END-EXEC
 21728*    MOVE ',"IL                  $  N#00018109' TO DFHEIV0
 21729     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21730     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21731     MOVE X'204E233030303138313039' TO DFHEIV0(25:11)
 21732     CALL 'kxdfhei1' USING DFHEIV0,
 21733           DFHEIV20,
 21734           ERPNDM-RECORD-LENGTH,
 21735           GETMAIN-SPACE
 21736     SET ADDRESS OF PENDING-MAILING-DATA TO
 21737         DFHEIV20
 21738     MOVE EIBRESP  TO WS-RESPONSE
 21739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21740
 21741
 21742* EXEC CICS READ
 21743*       INTO    (PENDING-MAILING-DATA)
 21744*       DATASET (FILE-ID-ERPNDM)
 21745*       RIDFLD  (ERPNDM-KEY)
 21746*       RESP    (WS-RESPONSE)
 21747*    END-EXEC
 21748     MOVE LENGTH OF
 21749      PENDING-MAILING-DATA
 21750       TO DFHEIV11
 21751*    MOVE '&"IL       E          (  N#00018116' TO DFHEIV0
 21752     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21754     MOVE X'204E233030303138313136' TO DFHEIV0(25:11)
 21755     CALL 'kxdfhei1' USING DFHEIV0,
 21756           FILE-ID-ERPNDM,
 21757           PENDING-MAILING-DATA,
 21758           DFHEIV11,
 21759           ERPNDM-KEY,
 21760           DFHEIV99,
 21761           DFHEIV99,
 21762           DFHEIV99
 21763     MOVE EIBRESP  TO WS-RESPONSE
 21764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21765
 21766     IF RESP-NORMAL
 21767        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21768        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21769        MOVE PM-CITY              TO VD-INSURED-CITY
 21770        MOVE PM-STATE             TO VD-INSURED-STATE
 21771        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21772     END-IF
 21773
 21774     MOVE 'VAC1'                  TO VD-LETTER-ID
 21775     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21776     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21777     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21778     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21779     MOVE +0                      TO VD-ARCHIVE-NO
 21780     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21781     .
 21782 6200-EXIT.
 21783     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 400
* VP6311.cbl
 21784 6210-READ-ERACCT.
 21785     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21786     MOVE LOW-VALUES             TO ERACCT-FILL
 21787
 21788* EXEC CICS READ
 21789*         DATASET   ('ERACCT')
 21790*         INTO      (ACCOUNT-MASTER)
 21791*         RIDFLD    (ERACCT-KEY)
 21792*         GTEQ
 21793*         RESP      (WS-RESPONSE)
 21794*    END-EXEC
 21795     MOVE LENGTH OF
 21796      ACCOUNT-MASTER
 21797       TO DFHEIV11
 21798     MOVE 'ERACCT' TO DFHEIV1
 21799*    MOVE '&"IL       G          (  N#00018144' TO DFHEIV0
 21800     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21802     MOVE X'204E233030303138313434' TO DFHEIV0(25:11)
 21803     CALL 'kxdfhei1' USING DFHEIV0,
 21804           DFHEIV1,
 21805           ACCOUNT-MASTER,
 21806           DFHEIV11,
 21807           ERACCT-KEY,
 21808           DFHEIV99,
 21809           DFHEIV99,
 21810           DFHEIV99
 21811     MOVE EIBRESP  TO WS-RESPONSE
 21812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21813     .
 21814 6210-EXIT.
 21815     EXIT.
 21816
 21817 6220-READ-ERMAIL.
 21818
 21819     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21820     MOVE ' '                    TO WS-ERMAIL-SW
 21821
 21822
 21823* EXEC CICS READ
 21824*       DATASET   (FILE-ID-ERMAIL)
 21825*       SET       (ADDRESS OF MAILING-DATA)
 21826*       RIDFLD    (ERMAIL-KEY)
 21827*       RESP      (WS-RESPONSE)
 21828*    END-EXEC
 21829*    MOVE '&"S        E          (  N#00018160' TO DFHEIV0
 21830     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21831     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21832     MOVE X'204E233030303138313630' TO DFHEIV0(25:11)
 21833     CALL 'kxdfhei1' USING DFHEIV0,
 21834           FILE-ID-ERMAIL,
 21835           DFHEIV20,
 21836           DFHEIV99,
 21837           ERMAIL-KEY,
 21838           DFHEIV99,
 21839           DFHEIV99,
 21840           DFHEIV99
 21841     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 401
* VP6311.cbl
 21842         DFHEIV20
 21843     MOVE EIBRESP  TO WS-RESPONSE
 21844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21845
 21846     IF RESP-NORMAL
 21847        SET ERMAIL-FOUND TO TRUE
 21848     END-IF
 21849     .
 21850 6220-EXIT.
 21851     EXIT.
 21852
 21853 6400-CHECK-FOR-RES-REF-CLAIM.
 21854     display 'made it to 6400- for ' pi-cert-no
 21855     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21856
 21857     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21858                                    W-CL-COMP-CD.
 21859     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21860                                    W-CL-CERT-NO.
 21861     MOVE SPACES                 TO MSTR-CERT-SFX.
 21862
 21863
 21864* EXEC CICS HANDLE CONDITION
 21865*        NOTFND  (6400-CONTINUE)
 21866*        ENDFILE (6400-CONTINUE)
 21867*    END-EXEC.
 21868*    MOVE '"$I''                  ! X #00018184' TO DFHEIV0
 21869     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21871     MOVE X'5820233030303138313834' TO DFHEIV0(25:11)
 21872     CALL 'kxdfhei1' USING DFHEIV0
 21873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21874
 21875
 21876
 21877* EXEC CICS IGNORE CONDITION
 21878*        DUPKEY
 21879*    END-EXEC.
 21880*    MOVE '"*$                   !   #00018189' TO DFHEIV0
 21881     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21883     MOVE X'2020233030303138313839' TO DFHEIV0(25:11)
 21884     CALL 'kxdfhei1' USING DFHEIV0
 21885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21886
 21887
 21888
 21889* EXEC CICS STARTBR
 21890*        DATASET   (CLMS-ID)
 21891*        RIDFLD    (ELMSTR-KEY)
 21892*        GENERIC   EQUAL
 21893*        KEYLENGTH (ELMSTR-LENGTH)
 21894*    END-EXEC.
 21895     MOVE 0
 21896       TO DFHEIV11
 21897*    MOVE '&,   KG    E          &   #00018193' TO DFHEIV0
 21898     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21899     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 402
* VP6311.cbl
 21900     MOVE X'2020233030303138313933' TO DFHEIV0(25:11)
 21901     CALL 'kxdfhei1' USING DFHEIV0,
 21902           CLMS-ID,
 21903           ELMSTR-KEY,
 21904           ELMSTR-LENGTH,
 21905           DFHEIV11,
 21906           DFHEIV99
 21907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21908
 21909
 21910     display 'browse started'
 21911     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21912
 21913 6400-NEXT-CLAIM.
 21914
 21915
 21916* EXEC CICS READNEXT
 21917*        DATASET   (CLMS-ID)
 21918*        RIDFLD    (ELMSTR-KEY)
 21919*        SET       (ADDRESS OF CLAIM-MASTER)
 21920*    END-EXEC.
 21921     MOVE 0
 21922       TO DFHEIV11
 21923*    MOVE '&.S                   )   #00018205' TO DFHEIV0
 21924     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21925     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21926     MOVE X'2020233030303138323035' TO DFHEIV0(25:11)
 21927     CALL 'kxdfhei1' USING DFHEIV0,
 21928           CLMS-ID,
 21929           DFHEIV20,
 21930           DFHEIV99,
 21931           ELMSTR-KEY,
 21932           DFHEIV99,
 21933           DFHEIV11,
 21934           DFHEIV99,
 21935           DFHEIV99
 21936     SET ADDRESS OF CLAIM-MASTER TO
 21937         DFHEIV20
 21938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21939
 21940
 21941     display 'read claim for ' mstr-cert-no
 21942     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21943        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21944         GO TO 6400-CONTINUE
 21945     END-IF.
 21946
 21947     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21948        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21949        PI-STATE       NOT = CL-CERT-STATE     OR
 21950        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21951        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21952         GO TO 6400-NEXT-CLAIM
 21953     END-IF.
 21954
 21955     display 'found claim ' cl-claim-no
 21956        ' with denial type ' cl-denial-type
 21957     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 403
* VP6311.cbl
 21958         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21959         GO TO 6400-CONTINUE
 21960     END-IF.
 21961
 21962     GO TO 6400-NEXT-CLAIM.
 21963
 21964 6400-CONTINUE.
 21965
 21966     IF WS-BROWSE-STARTED-SW = 'Y'
 21967
 21968* EXEC CICS ENDBR
 21969*            DATASET   (CLMS-ID)
 21970*        END-EXEC
 21971     MOVE 0
 21972       TO DFHEIV11
 21973*    MOVE '&2                    $   #00018237' TO DFHEIV0
 21974     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21975     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21976     MOVE X'2020233030303138323337' TO DFHEIV0(25:11)
 21977     CALL 'kxdfhei1' USING DFHEIV0,
 21978           CLMS-ID,
 21979           DFHEIV11,
 21980           DFHEIV99
 21981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21982         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21983     END-IF.
 21984
 21985 6400-EXIT.
 21986     EXIT.
 21987
 21988 7000-DISPLAY-ISSUES.
 21989
 21990     IF PI-DISPLAY-ORIGINAL-BATCH
 21991        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21992        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21993     ELSE
 21994        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21995
 21996     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21997
 21998     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21999     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22000
 22001     MOVE LOW-VALUES                 TO VP631BI.
 22002     MOVE ZEROS                      TO PI-BPMTAMT
 22003                                        PI-BPMTS.
 22004     MOVE SPACE                      TO PI-BMODE
 22005                                        PI-BTYPE (1)
 22006                                        PI-BTYPE (2).
 22007     MOVE VP631B                     TO PI-MAP-NAME.
 22008     MOVE 'Y'                        TO PI-BROWSE-SW.
 22009     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22010                                        PI-HIGH-SEQ-NO.
 22011
 22012     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22013        MOVE AL-SABOF                TO BCHGTA
 22014        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22015        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 404
* VP6311.cbl
 22016     ELSE
 22017        MOVE AL-SADOF                TO BCHGTA
 22018                                        BCHGA
 22019        MOVE PB-CHG-COUNT            TO BCHGO.
 22020
 22021     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22022     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22023     MOVE WS-HR-MINS                 TO BMANTATO.
 22024
 22025     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22026        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22027        MOVE SPACE                   TO DC-OPTION-CODE
 22028        PERFORM 9700-DATE-LINK
 22029        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22030        MOVE 'INACTIVE'              TO BMOENDTO
 22031     ELSE
 22032        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22033        MOVE SPACE                   TO DC-OPTION-CODE
 22034        PERFORM 9700-DATE-LINK
 22035        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22036        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22037        MOVE SPACE                   TO DC-OPTION-CODE
 22038        PERFORM 9700-DATE-LINK
 22039        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22040
 22041*    MOVE PB-I-REFERENCE             TO BREFO.
 22042
 22043*    IF PI-COMPANY-ID EQUAL 'HER'
 22044*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22045*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22046*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22047*                MOVE WS-MEMBER-NO-1-8
 22048*                                TO  BMICRNOO.
 22049
 22050*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22051*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22052*            MOVE PB-I-MICROFILM-NO
 22053*                                TO  BMICRNOO.
 22054     IF PB-I-VIN NOT = SPACES
 22055        MOVE PB-I-VIN            TO BVINO
 22056     END-IF
 22057
 22058     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22059     MOVE PB-CERT-SFX                TO BSUFIXO.
 22060     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22061     MOVE SPACE                      TO DC-OPTION-CODE.
 22062     PERFORM 9700-DATE-LINK.
 22063     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22064
 22065     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22066     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22067     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22068     MOVE PB-I-INSURED-SEX           TO BSEXO
 22069
 22070     IF PB-I-AGE NOT = ZEROS
 22071         MOVE PB-I-AGE               TO BAGEO.
 22072
 22073     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 405
* VP6311.cbl
 22074                                 TO ELCERT-KEY
 22075     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22076     IF NOT CERT-TRL-REC-NOT-FOUND
 22077         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22078             MOVE 'AGE*'             TO BAGEDEFO
 22079         ELSE
 22080             MOVE 'AGE '             TO BAGEDEFO
 22081         END-IF
 22082         if cs-year numeric
 22083            move cs-year         to byearo
 22084         end-if
 22085         move cs-make            to bmakeo
 22086         move cs-model           to bmodelo
 22087         move cs-future          to bfutureo
 22088         if cs-vehicle-odometer numeric
 22089            move cs-vehicle-odometer
 22090                                 to bometero
 22091         end-if
 22092     ELSE
 22093         MOVE 'AGE '             TO BAGEDEFO
 22094     END-IF
 22095
 22096     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22097         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22098         MOVE SPACE                  TO DC-OPTION-CODE
 22099         PERFORM 9700-DATE-LINK
 22100         IF NO-CONVERSION-ERROR
 22101            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22102
 22103
 22104
 22105
 22106     MOVE PB-FORCE-CODE              TO BFORCEO.
 22107
 22108
 22109
 22110
 22111     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22112     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22113     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22114     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22115     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22116     MOVE PB-I-SIG-SW                TO BSIGO.
 22117     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22118     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22119     MOVE PB-RECORD-BILL             TO BBILCDO.
 22120     MOVE PB-FORCE-CODE              TO BFORCEO.
 22121
 22122
 22123
 22124     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22125
 22126
 22127     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22128        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22129
 22130
 22131     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 406
* VP6311.cbl
 22132
 22133     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22134        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22135
 22136     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22137        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22138                                        PI-BTYPE (1).
 22139
 22140     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22141        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22142
 22143     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22144        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22145
 22146     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22147        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22148
 22149     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22150        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22151
 22152     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22153        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22154
 22155     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22156         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22157         MOVE SPACE                  TO DC-OPTION-CODE
 22158         PERFORM 9700-DATE-LINK
 22159         IF NO-CONVERSION-ERROR
 22160            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22161
 22162     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22163        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22164        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22165        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22166        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22167                 GIVING BDIFFO (1)
 22168     ELSE
 22169        MOVE SPACES                  TO BBEN-CD     (1)
 22170                                        BBEN-ABBR   (1).
 22171
 22172     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22173        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22174        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22175                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22176
 22177     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22178       IF PB-RECORD-ON-HOLD
 22179          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22180
 22181     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22182       IF PB-RECORD-RETURNED
 22183          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22184
 22185     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22186        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22187             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22188
 22189     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 407
* VP6311.cbl
 22190
 22191     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22192        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22193
 22194     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22195        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22196                                        PI-BTYPE (2).
 22197
 22198     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22199        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22200
 22201     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22202        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22203
 22204     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22205        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22206
 22207     IF PB-I-TOT-FEES NOT NUMERIC
 22208        MOVE ZEROS               TO PB-I-TOT-FEES
 22209     END-IF
 22210     IF PB-I-TOT-FEES > ZEROS
 22211        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22212
 22213     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22214         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22215         MOVE SPACE                  TO DC-OPTION-CODE
 22216         PERFORM 9700-DATE-LINK
 22217         IF NO-CONVERSION-ERROR
 22218            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22219
 22220     IF PB-I-TOT-FEES > ZEROS
 22221        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22222        SUBTRACT PB-I-TOT-FEES FROM
 22223                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22224
 22225     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22226        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22227        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22228        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22229        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22230                 GIVING BDIFFO (2)
 22231     ELSE
 22232        MOVE SPACES                  TO BBEN-CD     (2)
 22233                                        BBEN-ABBR   (2).
 22234
 22235     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22236       IF PB-RECORD-ON-HOLD
 22237          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22238
 22239     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22240       IF PB-RECORD-RETURNED
 22241          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22242
 22243     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22244        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22245             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22246
 22247     MOVE PB-CSR-ID                  TO BCSRO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 408
* VP6311.cbl
 22248
 22249     IF PI-COMPANY-ID  =  'DMD'
 22250        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22251            NEXT SENTENCE
 22252        ELSE
 22253            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22254               MOVE 'NEW CERT'       TO BNCERTLI
 22255               MOVE EC-NEW-CERT      TO BNCERTO.
 22256
 22257     IF PI-COMPANY-ID  =  'DMD'
 22258        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22259            NEXT SENTENCE
 22260        ELSE
 22261           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22262               MOVE 'NEW STATE'      TO BNSTATLI
 22263               MOVE EC-NEW-STATE     TO BNSTATO.
 22264
 22265 7000-CONTINUE.
 22266     MOVE 'C'                        TO BMAINTI.
 22267     MOVE AL-UANON                   TO BMAINTA.
 22268
 22269     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22270        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22271
 22272     IF PI-6315-FINALIZED = 'Y'   AND
 22273        PB-UNFORCED-ERRORS
 22274          MOVE -1                TO BFORCEL
 22275          MOVE  1                TO SET-CURSOR-SW
 22276     END-IF
 22277
 22278     IF NO-CURSOR-SET
 22279        MOVE -1                      TO BMAINTL.
 22280
 22281     GO TO 8100-SEND-INITIAL-MAP.
 22282
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 409
* VP6311.cbl
 22284
 22285******************************************************************
 22286*                                                                *
 22287*             D I S P L A Y   C A N C E L S                      *
 22288*                                                                *
 22289******************************************************************
 22290
 22291 7100-DISPLAY-CANCELS.
 22292     IF PI-DISPLAY-ORIGINAL-BATCH
 22293        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22294        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22295     ELSE
 22296        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22297
 22298     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22299
 22300     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22301     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22302
 22303     MOVE LOW-VALUES                 TO VP631CI.
 22304     MOVE VP631C                     TO PI-MAP-NAME.
 22305     MOVE 'Y'                        TO PI-BROWSE-SW.
 22306     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22307                                        PI-HIGH-SEQ-NO.
 22308
 22309     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22310        MOVE AL-SABOF                TO CCHGTA
 22311        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22312        MOVE AL-SANON                TO CCHGA
 22313      ELSE
 22314        MOVE AL-SADOF                TO CCHGTA
 22315                                        CCHGA
 22316        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22317
 22318*    MOVE PB-C-REFERENCE             TO CREFO.
 22319
 22320*    IF PB-C-MICROFILM-NO IS NUMERIC
 22321*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22322*          MOVE PB-C-MICROFILM-NO
 22323*                                TO CMICRNOO
 22324*          MOVE AL-UNNON         TO CMICRNOA
 22325*       END-IF
 22326*    END-IF
 22327     IF PB-C-INT-ON-REFS NUMERIC
 22328        IF PB-C-INT-ON-REFS NOT = ZEROS
 22329           MOVE PB-C-INT-ON-REFS
 22330                                 TO CNHINTO
 22331           MOVE AL-SANOF         TO CNHINTA
 22332        END-IF
 22333     END-IF
 22334     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22335     MOVE PB-CERT-SFX                TO CSUFIXO.
 22336     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22337     MOVE SPACE                      TO DC-OPTION-CODE.
 22338     PERFORM 9700-DATE-LINK.
 22339     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22340
 22341     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 410
* VP6311.cbl
 22342        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22343        MOVE SPACE                   TO DC-OPTION-CODE
 22344        PERFORM 9700-DATE-LINK
 22345        IF NO-CONVERSION-ERROR
 22346           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22347
 22348     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22349        NEXT SENTENCE
 22350     ELSE
 22351        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22352
 22353     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22354        NEXT SENTENCE
 22355     ELSE
 22356        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22357
 22358     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22359        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22360        MOVE SPACE                   TO DC-OPTION-CODE
 22361        PERFORM 9700-DATE-LINK
 22362        IF NO-CONVERSION-ERROR
 22363           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22364
 22365     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22366         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22367
 22368     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22369         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22370
 22371     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22372        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22373        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22374                 GIVING CDRFND1O.
 22375
 22376     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22377        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22378        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22379                 GIVING CDRFND2O.
 22380
 22381     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22382       IF PB-RECORD-ON-HOLD
 22383          MOVE 'ON HOLD'             TO CBILIT1O.
 22384
 22385     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22386       IF PB-RECORD-RETURNED
 22387          MOVE 'RETURNED'            TO CBILIT1O.
 22388
 22389     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22390        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22391             MOVE 'OVERRIDE'         TO CBILIT1O.
 22392
 22393     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22394       IF PB-RECORD-ON-HOLD
 22395          MOVE 'ON HOLD'             TO CBILIT2O.
 22396
 22397     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22398       IF PB-RECORD-RETURNED
 22399          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 411
* VP6311.cbl
 22400
 22401     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22402        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22403             MOVE 'OVERRIDE'         TO CBILIT2O.
 22404
 22405     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22406     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22407     IF PB-C-POST-CARD-IND = 'Y'
 22408        MOVE 'Y'                     TO CPCYNO
 22409     ELSE
 22410        MOVE 'N'                     TO CPCYNO
 22411     END-IF
 22412     MOVE PB-FORCE-CODE              TO CFORCEO.
 22413     MOVE PB-RECORD-BILL             TO CBILCDO.
 22414     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22415     MOVE SPACES                     TO CINITSO.
 22416     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22417         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22418     ELSE
 22419         MOVE PB-CI-INITIALS         TO CINITSO
 22420     END-IF.
 22421
 22422     IF PB-CI-CANCEL-FEE NUMERIC
 22423        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22424        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22425     ELSE
 22426        MOVE ZEROES                  TO W-CANCEL-FEE.
 22427
 22428     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22429
 22430     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22431        ADD PB-CI-LF-PREMIUM-AMT
 22432             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22433
 22434     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22435        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22436
 22437     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22438     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22439     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22440     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22441
 22442     IF PB-C-LIVES NUMERIC
 22443        MOVE PB-C-LIVES              TO CLIVESO.
 22444
 22445     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22446        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22447
 22448     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22449        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22450        MOVE SPACE                   TO DC-OPTION-CODE
 22451        PERFORM 9700-DATE-LINK
 22452        IF NO-CONVERSION-ERROR
 22453           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22454
 22455     IF  PB-C-REFUND-CREATED
 22456         MOVE 'YES'                  TO CRFNDSWO
 22457     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 412
* VP6311.cbl
 22458         IF PB-C-REFUND-REQUESTED
 22459            MOVE 'REQ'               TO CRFNDSWO
 22460         ELSE
 22461            MOVE 'NO'                TO CRFNDSWO.
 22462
 22463     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22464     MOVE SPACE                      TO DC-OPTION-CODE.
 22465     PERFORM 9700-DATE-LINK.
 22466     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22467     MOVE PB-INPUT-BY                TO CENTBYO.
 22468
 22469     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22470        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22471        MOVE SPACE                   TO DC-OPTION-CODE
 22472        PERFORM 9700-DATE-LINK
 22473        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22474        MOVE 'INACTIVE'              TO CMOENDTO
 22475     ELSE
 22476        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22477        MOVE SPACE                   TO DC-OPTION-CODE
 22478        PERFORM 9700-DATE-LINK
 22479        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22480        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22481        MOVE SPACE                   TO DC-OPTION-CODE
 22482        PERFORM 9700-DATE-LINK
 22483        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22484
 22485     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22486
 22487     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22488     MOVE WS-HR-MINS                 TO CMANTATO.
 22489
 22490     EVALUATE PB-LF-REFUND-TYPE
 22491        WHEN '1'
 22492           MOVE 'RULE78'            TO CLFREFNO
 22493        WHEN '2'
 22494           MOVE 'PRORAT'            TO CLFREFNO
 22495        WHEN '3'
 22496           MOVE 'CALIF'             TO CLFREFNO
 22497        WHEN '4'
 22498           MOVE 'IRREG'             TO CLFREFNO
 22499        WHEN '5'
 22500           MOVE 'NETPAY'            TO CLFREFNO
 22501        WHEN '6'
 22502           MOVE 'ATCP'              TO CLFREFNO
 22503        WHEN '7'
 22504           MOVE 'UTAH'              TO CLFREFNO
 22505        WHEN '8'
 22506           MOVE 'MEAN'              TO CLFREFNO
 22507        WHEN '9'
 22508           MOVE 'SUM '              TO CLFREFNO
 22509        WHEN 'B'
 22510           MOVE 'BALN'              TO CLFREFNO
 22511     END-EVALUATE.
 22512
 22513     EVALUATE TRUE
 22514        WHEN PB-AH-REFUND-TYPE =  '1'
 22515           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 413
* VP6311.cbl
 22516        WHEN PB-AH-REFUND-TYPE =  '2'
 22517           MOVE 'PRORAT'            TO CAHREFNO
 22518        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22519           MOVE 'CALIF'             TO CAHREFNO
 22520        WHEN PB-AH-REFUND-TYPE =  '4'
 22521           MOVE 'IRREG'             TO CAHREFNO
 22522        WHEN PB-AH-REFUND-TYPE =  '5'
 22523           MOVE 'NETPAY'            TO CAHREFNO
 22524        WHEN PB-AH-REFUND-TYPE =  '6'
 22525           MOVE 'ATCP'              TO CAHREFNO
 22526        WHEN PB-AH-REFUND-TYPE =  '7'
 22527           MOVE 'UTAH'              TO CAHREFNO
 22528        WHEN PB-AH-REFUND-TYPE =  '8'
 22529           MOVE 'MEAN'              TO CAHREFNO
 22530        WHEN PB-AH-REFUND-TYPE =  '9'
 22531           MOVE 'SUM '              TO CAHREFNO
 22532        WHEN PB-AH-REFUND-TYPE =  'B'
 22533           MOVE 'BALN'              TO CAHREFNO
 22534     END-EVALUATE.
 22535
 22536     MOVE PB-REIN-CD                 TO CREINCDO.
 22537
 22538     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22539        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22540        MOVE SPACE                   TO DC-OPTION-CODE
 22541        PERFORM 9700-DATE-LINK
 22542        IF NO-CONVERSION-ERROR
 22543           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22544
 22545     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22546        MOVE 999999                  TO WS-EXP-DT-EDIT
 22547        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22548        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22549     ELSE
 22550        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22551           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22552           MOVE SPACE                   TO DC-OPTION-CODE
 22553           PERFORM 9700-DATE-LINK
 22554           IF NO-CONVERSION-ERROR
 22555              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22556
 22557     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22558        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22559           MOVE AL-SANOF                TO CORIGHDA
 22560           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22561           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22562
 22563     MOVE PB-CSR-ID              TO CCSRO.
 22564
 22565     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22566     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22567
 22568     MOVE 'C'                    TO CMAINTI.
 22569     MOVE AL-UANON               TO CMAINTA.
 22570
 22571     IF PI-6316-FINALIZED = 'Y'  AND
 22572        PB-UNFORCED-ERRORS
 22573          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 414
* VP6311.cbl
 22574          MOVE  1                TO SET-CURSOR-SW
 22575     END-IF
 22576
 22577     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22578        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22579
 22580     IF NO-CURSOR-SET
 22581        MOVE -1                  TO CMAINTL.
 22582
 22583     GO TO 8100-SEND-INITIAL-MAP.
 22584
 22585
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 415
* VP6311.cbl
 22587***************************************************************
 22588*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22589*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22590***************************************************************
 22591
 22592 7200-DISPLAY-BATCHES.
 22593     MOVE VP631D                 TO PI-MAP-NAME.
 22594     MOVE LOW-VALUES             TO VP631DI.
 22595
 22596     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22597
 22598
 22599* EXEC CICS HANDLE CONDITION
 22600*         NOTFND   (3690-NOT-FOUND)
 22601*    END-EXEC.
 22602*    MOVE '"$I                   ! Y #00018856' TO DFHEIV0
 22603     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22605     MOVE X'5920233030303138383536' TO DFHEIV0(25:11)
 22606     CALL 'kxdfhei1' USING DFHEIV0
 22607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22608
 22609
 22610     IF PI-DISPLAY-SCREEN
 22611        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22612     ELSE
 22613        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22614
 22615     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22616     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22617
 22618
 22619* EXEC CICS READ
 22620*         DATASET   (FILE-ID-ERPNDB)
 22621*         RIDFLD    (ERPNDB-KEY)
 22622*         SET       (ADDRESS OF PENDING-BUSINESS)
 22623*    END-EXEC.
 22624*    MOVE '&"S        E          (   #00018868' TO DFHEIV0
 22625     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22627     MOVE X'2020233030303138383638' TO DFHEIV0(25:11)
 22628     CALL 'kxdfhei1' USING DFHEIV0,
 22629           FILE-ID-ERPNDB,
 22630           DFHEIV20,
 22631           DFHEIV99,
 22632           ERPNDB-KEY,
 22633           DFHEIV99,
 22634           DFHEIV99,
 22635           DFHEIV99
 22636     SET ADDRESS OF PENDING-BUSINESS TO
 22637         DFHEIV20
 22638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22639
 22640
 22641     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22642     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22643     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22644     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 416
* VP6311.cbl
 22645     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22646
 22647     MOVE VP631D                 TO PI-MAP-NAME.
 22648     MOVE LOW-VALUES             TO VP631DI.
 22649     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22650
 22651*    IF PI-AR-PROCESSING
 22652*       MOVE PB-REFERENCE        TO DREFO.
 22653
 22654     MOVE PB-CSR-ID              TO DCSRO.
 22655
 22656     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22657        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22658        MOVE SPACE               TO DC-OPTION-CODE
 22659        PERFORM 9700-DATE-LINK
 22660        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22661        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22662        MOVE 'INACTIVE'          TO DLDATEO
 22663     ELSE
 22664        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22665        MOVE SPACE               TO DC-OPTION-CODE
 22666        PERFORM 9700-DATE-LINK
 22667        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22668
 22669     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22670     MOVE SPACE                  TO DC-OPTION-CODE.
 22671     PERFORM 9700-DATE-LINK.
 22672     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22673
 22674     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22675        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22676     ELSE
 22677        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22678        MOVE SPACE               TO DC-OPTION-CODE
 22679        PERFORM 9700-DATE-LINK
 22680        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22681
 22682     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22683     MOVE SPACE                  TO DC-OPTION-CODE.
 22684     PERFORM 9700-DATE-LINK.
 22685     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22686
 22687     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22688     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22689
 22690     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22691        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22692                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22693
 22694     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22695     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22696     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22697
 22698     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22699        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22700                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22701
 22702     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 417
* VP6311.cbl
 22703     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22704     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22705
 22706     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22707        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22708                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22709
 22710     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22711     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22712
 22713     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22714        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22715                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22716
 22717     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22718     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22719     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22720
 22721     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22722        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22723                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22724
 22725     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22726     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22727     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22728
 22729     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22730        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22731                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22732
 22733     MOVE -1                     TO DPFENTRL.
 22734     GO TO 8100-SEND-INITIAL-MAP.
 22735
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 418
* VP6311.cbl
 22737
 22738***************************************************************
 22739*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22740*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22741*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22742*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22743*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22744*     ARE THEN SET ACCORDINGLY.                               *
 22745*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22746*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22747*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22748***************************************************************
 22749
 22750******************************************************************
 22751*                                                                *
 22752*            E R R O R   A N A L Y S I S                         *
 22753*                                                                *
 22754******************************************************************
 22755
 22756******************************************************************
 22757*                                                                *
 22758*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22759*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22760*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22761*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22762*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22763*                                                                *
 22764*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22765*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22766*                                                                *
 22767******************************************************************
 22768
 22769 7300-FORMAT-ERRORS.
 22770     MOVE ' '                    TO PI-ERRORS-SW
 22771     IF PB-COMMON-ERRORS = LOW-VALUES
 22772        IF PB-FATAL-ERRORS
 22773           MOVE ER-2695          TO EMI-ERROR
 22774           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22775           GO TO 7399-EXIT.
 22776
 22777     MOVE +0                     TO WS-SUB4.
 22778
 22779 7310-ERROR-LOOP.
 22780
 22781     ADD +1                      TO WS-SUB4.
 22782
 22783     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22784        GO TO 7350-SET-ERROR-FLAGS.
 22785
 22786     IF PI-COMPANY-ID = 'UCL'
 22787         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22788             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22789             MOVE ' '                   TO DC-OPTION-CODE
 22790             PERFORM 9700-DATE-LINK
 22791             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22792
 22793     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 419
* VP6311.cbl
 22795     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22796
 22797     GO TO 7310-ERROR-LOOP.
 22798
 22799
 22800 7350-SET-ERROR-FLAGS.
 22801
 22802     IF EMI-FATAL-CTR NOT = ZEROS
 22803        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22804        MOVE 'X'                 TO PB-FATAL-FLAG
 22805                                    PI-ERRORS-SW
 22806        GO TO 7355-SET-ERROR-FLAGS.
 22807
 22808     move ' ' to pi-unforced-sw
 22809     IF EMI-FORCABLE-CTR NOT = ZEROS
 22810        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22811        IF PB-ISSUE
 22812           IF PB-ISSUE-FORCE
 22813              MOVE 'F'           TO PB-FORCE-ER-CD
 22814              MOVE ER-2600       TO EMI-ERROR
 22815              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22816             ELSE
 22817              MOVE 'X'           TO PB-FORCE-ER-CD
 22818*                                   PI-ERRORS-SW
 22819          ELSE
 22820           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22821              MOVE 'F'           TO PB-FORCE-ER-CD
 22822                                    pi-unforced-sw
 22823              MOVE ER-2600       TO EMI-ERROR
 22824              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22825             ELSE
 22826              MOVE 'X'           TO PB-FORCE-ER-CD
 22827                                    pi-unforced-sw.
 22828*                                   PI-ERRORS-SW.
 22829
 22830     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22831     IF PB-ISSUE
 22832         MOVE 'I'                TO ENDT-RECORD-TYPE
 22833     ELSE
 22834         MOVE 'C'                TO ENDT-RECORD-TYPE
 22835     END-IF
 22836     MOVE +0                     TO ENDT-SEQ-NO
 22837
 22838
 22839* EXEC CICS READ
 22840*        DATASET   (FILE-ID-ERENDT)
 22841*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22842*        RIDFLD    (ERENDT-KEY)
 22843*        RESP      (WS-RESPONSE)
 22844*        GTEQ
 22845*    END-EXEC
 22846*    MOVE '&"S        G          (  N#00019071' TO DFHEIV0
 22847     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22848     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22849     MOVE X'204E233030303139303731' TO DFHEIV0(25:11)
 22850     CALL 'kxdfhei1' USING DFHEIV0,
 22851           FILE-ID-ERENDT,
 22852           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 420
* VP6311.cbl
 22853           DFHEIV99,
 22854           ERENDT-KEY,
 22855           DFHEIV99,
 22856           DFHEIV99,
 22857           DFHEIV99
 22858     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22859         DFHEIV20
 22860     MOVE EIBRESP  TO WS-RESPONSE
 22861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22862
 22863     IF RESP-NORMAL
 22864        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22865        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22866            MOVE ER-0280          TO EMI-ERROR
 22867            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22868            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22869            EVALUATE TRUE
 22870              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22871                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22872              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22873                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22874              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22875                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22876            END-EVALUATE
 22877        END-IF
 22878     END-IF
 22879
 22880
 22881
 22882     IF FIRST-ENTRY OR
 22883        EIBAID = DFHPF1 OR DFHPF2
 22884        MOVE '0'                TO PI-EDIT-SW
 22885        GO TO 7399-EXIT.
 22886
 22887 7355-SET-ERROR-FLAGS.
 22888
 22889     IF EMI-WARNING-CTR NOT = ZEROS
 22890        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22891        MOVE 'W'                 TO PB-WARN-ER-CD.
 22892
 22893     IF PB-UNFORCED-ERRORS OR
 22894        PB-FATAL-ERRORS    OR
 22895        PB-RECORD-ON-HOLD  OR
 22896        PB-RECORD-RETURNED OR
 22897        PB-CANCELLATION
 22898          NEXT SENTENCE
 22899        ELSE
 22900          GO TO 7399-EXIT.
 22901
 22902
 22903* EXEC CICS  HANDLE CONDITION
 22904*           NOTFND   (7399-EXIT)
 22905*    END-EXEC.
 22906*    MOVE '"$I                   ! Z #00019118' TO DFHEIV0
 22907     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22909     MOVE X'5A20233030303139313138' TO DFHEIV0(25:11)
 22910     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 421
* VP6311.cbl
 22911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22912
 22913
 22914     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22915     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22916     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22917     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22918
 22919
 22920* EXEC CICS READ
 22921*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22922*        DATASET (FILE-ID-ELCERT)
 22923*        RIDFLD  (ELCERT-KEY)
 22924*        UPDATE
 22925*    END-EXEC.
 22926*    MOVE '&"S        EU         (   #00019127' TO DFHEIV0
 22927     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22928     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22929     MOVE X'2020233030303139313237' TO DFHEIV0(25:11)
 22930     CALL 'kxdfhei1' USING DFHEIV0,
 22931           FILE-ID-ELCERT,
 22932           DFHEIV20,
 22933           DFHEIV99,
 22934           ELCERT-KEY,
 22935           DFHEIV99,
 22936           DFHEIV99,
 22937           DFHEIV99
 22938     SET ADDRESS OF CERTIFICATE-MASTER TO
 22939         DFHEIV20
 22940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22941
 22942
 22943
 22944     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22945     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22946
 22947     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22948        GO TO 7360-REWRITE-CERT-MASTER.
 22949
 22950     IF PB-ISSUE
 22951        IF PB-RECORD-RETURNED
 22952            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22953            GO TO 7360-REWRITE-CERT-MASTER
 22954        ELSE
 22955            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22956            GO TO 7360-REWRITE-CERT-MASTER.
 22957
 22958     IF PB-RECORD-RETURNED
 22959         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22960         GO TO 7360-REWRITE-CERT-MASTER.
 22961
 22962     IF (PB-C-LF-CANCEL-VOIDED)
 22963        or (pb-c-ah-cancel-voided)
 22964        IF (PB-UNFORCED-ERRORS OR
 22965            PB-FATAL-ERRORS    OR
 22966            PB-RECORD-ON-HOLD)
 22967            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22968            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 422
* VP6311.cbl
 22969        ELSE
 22970            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22971            GO TO 7360-REWRITE-CERT-MASTER.
 22972
 22973     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22974                            OR PB-RECORD-ON-HOLD)
 22975        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22976     ELSE
 22977        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22978
 22979 7360-REWRITE-CERT-MASTER.
 22980
 22981     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22982        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22983
 22984* EXEC CICS UNLOCK
 22985*            DATASET    (FILE-ID-ELCERT)
 22986*       END-EXEC
 22987*    MOVE '&*                    #   #00019174' TO DFHEIV0
 22988     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22989     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22990     MOVE X'2020233030303139313734' TO DFHEIV0(25:11)
 22991     CALL 'kxdfhei1' USING DFHEIV0,
 22992           FILE-ID-ELCERT,
 22993           DFHEIV99
 22994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22995        GO TO 7399-EXIT.
 22996
 22997
 22998* EXEC CICS REWRITE
 22999*         DATASET    (FILE-ID-ELCERT)
 23000*         FROM       (CERTIFICATE-MASTER)
 23001*    END-EXEC.
 23002     MOVE LENGTH OF
 23003      CERTIFICATE-MASTER
 23004       TO DFHEIV11
 23005*    MOVE '&& L                  %   #00019179' TO DFHEIV0
 23006     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23007     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23008     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 23009     CALL 'kxdfhei1' USING DFHEIV0,
 23010           FILE-ID-ELCERT,
 23011           CERTIFICATE-MASTER,
 23012           DFHEIV11,
 23013           DFHEIV99
 23014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23015
 23016
 23017 7399-EXIT.
 23018      EXIT.
 23019
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 423
* VP6311.cbl
 23021
 23022*************************************************************
 23023*                                                           *
 23024*              S E T   A T T R I B U T E S                  *
 23025*                                                           *
 23026*************************************************************
 23027
 23028 7400-SET-ATTRIBUTES.
 23029
 23030     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23031        GO TO 7499-EXIT.
 23032
 23033**2601**
 23034
 23035     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23036        IF PB-ISSUE
 23037           MOVE AL-UABON         TO BEFFDTA
 23038           GO TO 7499-EXIT
 23039         ELSE
 23040           MOVE AL-UABON         TO CEFFDTA
 23041           GO TO 7499-EXIT.
 23042
 23043**2604**
 23044
 23045     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23046        IF PB-ISSUE
 23047           MOVE AL-UABON         TO BTYPE1A
 23048           MOVE -1               TO BTYPE1L
 23049           MOVE  1               TO SET-CURSOR-SW
 23050           GO TO 7499-EXIT.
 23051
 23052**2605**
 23053
 23054     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23055        IF PB-ISSUE
 23056           MOVE AL-UABON         TO BTYPE2A
 23057           MOVE -1               TO BTYPE2L
 23058           MOVE  1               TO SET-CURSOR-SW
 23059           GO TO 7499-EXIT.
 23060
 23061**2606**
 23062
 23063     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23064        IF PB-ISSUE
 23065           MOVE AL-UABON         TO BSIGA
 23066           MOVE -1               TO BSIGL
 23067           MOVE  1               TO SET-CURSOR-SW
 23068           GO TO 7499-EXIT.
 23069
 23070**2607**
 23071
 23072     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23073        IF PB-ISSUE
 23074           MOVE AL-UABON         TO BSIGA
 23075           MOVE -1               TO BSIGL
 23076           MOVE  1               TO SET-CURSOR-SW
 23077           GO TO 7499-EXIT.
 23078
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 424
* VP6311.cbl
 23079**2615**
 23080
 23081     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23082        IF PB-ISSUE
 23083           MOVE AL-UABOF         TO BREINA
 23084           MOVE -1               TO BREINL
 23085           GO TO 7499-EXIT.
 23086
 23087**2622**
 23088
 23089     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23090        IF PB-ISSUE
 23091           MOVE AL-UABON         TO BEFFDTA
 23092           GO TO 7499-EXIT
 23093        ELSE
 23094           MOVE AL-UABON         TO CEFFDTA
 23095           GO TO 7499-EXIT.
 23096
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 425
* VP6311.cbl
 23098
 23099*************************************************************
 23100*                                                           *
 23101*              I S S U E   E R R O R S                      *
 23102*                                                           *
 23103*************************************************************
 23104
 23105 7420-ISSUE-ERRORS.
 23106
 23107**2626**
 23108
 23109     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23110        MOVE AL-UABON            TO BCERTNOA
 23111        GO TO 7499-EXIT.
 23112
 23113**2627**
 23114
 23115     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23116        MOVE AL-UNBON            TO BAGEA
 23117        MOVE -1                  TO BAGEL
 23118        MOVE  1                  TO SET-CURSOR-SW
 23119        GO TO 7499-EXIT.
 23120
 23121**2628**
 23122
 23123     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23124        MOVE AL-UNBON            TO BAGEA
 23125        MOVE -1                  TO BAGEL
 23126        MOVE  1                  TO SET-CURSOR-SW
 23127        GO TO 7499-EXIT.
 23128
 23129**2629**
 23130
 23131     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23132        MOVE AL-UABON            TO BSEXA
 23133        MOVE -1                  TO BSEXL
 23134        MOVE  1                  TO SET-CURSOR-SW
 23135        GO TO 7499-EXIT.
 23136
 23137**2630**
 23138
 23139     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23140        MOVE -1                  TO BTYPE1L
 23141        MOVE  1                  TO SET-CURSOR-SW
 23142        GO TO 7499-EXIT.
 23143
 23144**2631**
 23145
 23146     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23147        MOVE -1                  TO BTYPE1L
 23148        MOVE  1                  TO SET-CURSOR-SW
 23149        GO TO 7499-EXIT.
 23150
 23151**2632**
 23152
 23153     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23154        MOVE AL-UNBON            TO BBEN1A
 23155        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 426
* VP6311.cbl
 23156        MOVE  1                  TO SET-CURSOR-SW
 23157        GO TO 7499-EXIT.
 23158
 23159**2633**
 23160
 23161     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23162        MOVE AL-UNBON            TO BPREM1A
 23163        MOVE -1                  TO BPREM1L
 23164        MOVE  1                  TO SET-CURSOR-SW
 23165        GO TO 7499-EXIT.
 23166
 23167**2634**
 23168
 23169     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23170        MOVE -1                  TO BTYPE2L
 23171        MOVE  1                  TO SET-CURSOR-SW
 23172        GO TO 7499-EXIT.
 23173
 23174**2635**
 23175
 23176     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23177        MOVE AL-UNBON            TO BBEN2A
 23178        MOVE -1                  TO BBEN2L
 23179        MOVE  1                  TO SET-CURSOR-SW
 23180        GO TO 7499-EXIT.
 23181
 23182**2636**
 23183
 23184     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23185        MOVE AL-UNBON            TO BPREM2A
 23186        MOVE -1                  TO BPREM2L
 23187        MOVE  1                  TO SET-CURSOR-SW
 23188        GO TO 7499-EXIT.
 23189
 23190**2639**
 23191
 23192     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23193        MOVE AL-UNBON            TO BBEN1A
 23194        MOVE -1                  TO BBEN1L
 23195        MOVE  1                  TO SET-CURSOR-SW
 23196        GO TO 7499-EXIT.
 23197
 23198**2640**
 23199
 23200     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23201        MOVE AL-UNBON            TO BBEN2A
 23202        MOVE -1                  TO BBEN2L
 23203        MOVE  1                  TO SET-CURSOR-SW
 23204        GO TO 7499-EXIT.
 23205
 23206**2647**
 23207
 23208     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23209        MOVE AL-UNBON            TO BTERM1A
 23210        MOVE -1                  TO BTERM1L
 23211        MOVE  1                  TO SET-CURSOR-SW
 23212        GO TO 7499-EXIT.
 23213
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 427
* VP6311.cbl
 23214
 23215**2649**
 23216
 23217     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23218        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23219            MOVE AL-UNBON            TO BPREM1A
 23220            MOVE -1                  TO BPREM1L
 23221            MOVE  1                  TO SET-CURSOR-SW
 23222            GO TO 7499-EXIT
 23223     ELSE
 23224        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23225           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23226            MOVE AL-UNBON            TO BPREM2A
 23227            MOVE -1                  TO BPREM2L
 23228            MOVE  1                  TO SET-CURSOR-SW
 23229            GO TO 7499-EXIT.
 23230
 23231**2650**
 23232
 23233     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23234        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23235            MOVE AL-UNBON        TO BPREM1A
 23236            MOVE -1              TO BPREM1L
 23237            MOVE  1              TO SET-CURSOR-SW
 23238            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23239                MOVE AL-UNBON        TO BPREM2A
 23240                MOVE -1              TO BPREM2L
 23241                MOVE  1              TO SET-CURSOR-SW
 23242                GO TO 7499-EXIT
 23243            ELSE
 23244                GO TO 7499-EXIT
 23245        ELSE
 23246            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23247                MOVE AL-UNBON        TO BPREM2A
 23248                MOVE -1              TO BPREM2L
 23249                MOVE  1              TO SET-CURSOR-SW
 23250                GO TO 7499-EXIT
 23251            ELSE
 23252                GO TO 7499-EXIT.
 23253
 23254**2651**
 23255
 23256     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23257        MOVE AL-UABON            TO BSIGA
 23258        MOVE -1                  TO BSIGL
 23259        MOVE  1                  TO SET-CURSOR-SW
 23260        GO TO 7499-EXIT.
 23261
 23262
 23263
 23264
 23265**2658**
 23266
 23267     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23268        MOVE AL-UNBON            TO BTERM2A
 23269        MOVE -1                  TO BTERM2L
 23270        MOVE  1                  TO SET-CURSOR-SW
 23271        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 428
* VP6311.cbl
 23272
 23273**2660**
 23274
 23275     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23276        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23277        MOVE -1                  TO BLSTNML
 23278        MOVE  1                  TO SET-CURSOR-SW
 23279        GO TO 7499-EXIT.
 23280
 23281
 23282**2662**
 23283
 23284     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23285        MOVE AL-UNBON            TO BAGEA
 23286        MOVE -1                  TO BAGEL
 23287        MOVE  1                  TO SET-CURSOR-SW
 23288        GO TO 7499-EXIT.
 23289
 23290**2663**
 23291
 23292     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23293        MOVE AL-UNBON            TO BAGEA
 23294        MOVE -1                  TO BAGEL
 23295        MOVE  1                  TO SET-CURSOR-SW
 23296        GO TO 7499-EXIT.
 23297
 23298**2664**
 23299
 23300     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23301        MOVE AL-UABON            TO BREINA
 23302        MOVE -1                  TO BREINL
 23303        MOVE  1                  TO SET-CURSOR-SW
 23304        GO TO 7499-EXIT.
 23305
 23306**2667**
 23307
 23308     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23309        MOVE AL-UNBON            TO BBEN2A
 23310        MOVE -1                  TO BBEN2L
 23311        MOVE  1                  TO SET-CURSOR-SW
 23312        GO TO 7499-EXIT.
 23313
 23314**2668**
 23315
 23316     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23317        MOVE AL-UABON            TO BEFFDTA
 23318        GO TO 7499-EXIT.
 23319
 23320**2669**
 23321
 23322     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23323       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23324       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23325        MOVE AL-UNBON            TO BAGEA
 23326        MOVE -1                  TO BAGEL
 23327        MOVE  1                  TO SET-CURSOR-SW
 23328        GO TO 7499-EXIT.
 23329
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 429
* VP6311.cbl
 23330**2670**
 23331
 23332     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23333        MOVE AL-UABON            TO BFORCEA
 23334        MOVE -1                  TO BFORCEL
 23335        MOVE  1                  TO SET-CURSOR-SW
 23336        GO TO 7499-EXIT.
 23337
 23338**2671**
 23339
 23340     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23341        MOVE AL-UABON            TO BEFFDTA
 23342        GO TO 7499-EXIT.
 23343
 23344**2672**
 23345
 23346     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23347        MOVE AL-UABON            TO BEFFDTA
 23348        GO TO 7499-EXIT.
 23349
 23350**2673**
 23351
 23352     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23353        MOVE AL-UABON            TO BEFFDTA
 23354        GO TO 7499-EXIT.
 23355
 23356**2674**
 23357
 23358     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23359        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23360        MOVE -1                  TO BTYPE1L
 23361        MOVE  1                  TO SET-CURSOR-SW
 23362        GO TO 7499-EXIT.
 23363
 23364**2677**
 23365
 23366     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23367        MOVE AL-UNBON            TO BTERM1A
 23368        MOVE -1                  TO BTERM1L
 23369        MOVE  1                  TO SET-CURSOR-SW
 23370        GO TO 7499-EXIT.
 23371
 23372**2678**
 23373
 23374     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23375        MOVE AL-UNBON            TO BTERM2A
 23376        MOVE -1                  TO BTERM2L
 23377        MOVE  1                  TO SET-CURSOR-SW
 23378        GO TO 7499-EXIT.
 23379
 23380**2679**
 23381
 23382     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23383        MOVE AL-UABON            TO BTYPE1A
 23384        MOVE -1                  TO BTYPE1L
 23385        MOVE  1                  TO SET-CURSOR-SW
 23386        GO TO 7499-EXIT.
 23387
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 430
* VP6311.cbl
 23388
 23389
 23390**2682**
 23391
 23392     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23393        MOVE AL-UABON            TO BTERM1A
 23394        MOVE -1                  TO BTERM1L
 23395        MOVE  1                  TO SET-CURSOR-SW
 23396        GO TO 7499-EXIT.
 23397
 23398**2683**
 23399
 23400     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23401        MOVE AL-UABON            TO BSKPCDA
 23402        MOVE -1                  TO BSKPCDL
 23403        MOVE  1                  TO SET-CURSOR-SW
 23404        GO TO 7499-EXIT.
 23405
 23406**2684**
 23407
 23408     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23409        MOVE AL-UABON            TO BTYPE2A
 23410        MOVE -1                  TO BTYPE2L
 23411        MOVE  1                  TO SET-CURSOR-SW
 23412        GO TO 7499-EXIT.
 23413
 23414**2686**
 23415
 23416     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23417        MOVE AL-UABON            TO BTYPE2A
 23418        MOVE -1                  TO BTYPE2L
 23419        MOVE  1                  TO SET-CURSOR-SW
 23420        GO TO 7499-EXIT.
 23421
 23422**2689**
 23423
 23424     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23425        MOVE AL-UABON            TO BSIGA
 23426        MOVE -1                  TO BSIGL
 23427        MOVE  1                  TO SET-CURSOR-SW
 23428        GO TO 7499-EXIT.
 23429
 23430**2690**
 23431
 23432     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23433        MOVE AL-UABOF            TO BLNOFCRA
 23434        MOVE -1                  TO BLNOFCRL
 23435        MOVE  1                  TO SET-CURSOR-SW
 23436        GO TO 7499-EXIT.
 23437
 23438**2693**
 23439
 23440     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23441        MOVE AL-UABOF            TO BLNOFCRA
 23442        MOVE AL-UNBON            TO BBEN1A
 23443        MOVE -1                  TO BBEN1L
 23444        MOVE  1                  TO SET-CURSOR-SW
 23445        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 431
* VP6311.cbl
 23446
 23447**2720**
 23448
 23449     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23450        MOVE AL-UNBON            TO BBEN1A
 23451        MOVE -1                  TO BBEN1L
 23452        MOVE  1                  TO SET-CURSOR-SW
 23453        GO TO 7499-EXIT.
 23454
 23455**2709**
 23456
 23457*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23458*       MOVE AL-UNBON            TO BBEN1A
 23459*       MOVE -1                  TO BBEN1L
 23460*       MOVE  1                  TO SET-CURSOR-SW
 23461*       GO TO 7499-EXIT.
 23462
 23463*************************************************************
 23464*                                                           *
 23465*            C A N C E L   E R R O R S                      *
 23466*                                                           *
 23467*************************************************************
 23468
 23469**2726**
 23470
 23471     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23472        MOVE AL-UABON            TO CCERTNOA
 23473        GO TO 7499-EXIT.
 23474
 23475**2728**
 23476
 23477     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23478        MOVE AL-UABON            TO CCERTNOA
 23479        GO TO 7499-EXIT.
 23480
 23481**2729**
 23482
 23483     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23484        MOVE AL-UABON            TO CCERTNOA
 23485        GO TO 7499-EXIT.
 23486
 23487**2730**
 23488
 23489     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23490        MOVE AL-UABON            TO CCERTNOA
 23491        GO TO 7499-EXIT.
 23492
 23493**2731**
 23494
 23495     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23496        MOVE AL-UABON            TO CCANDT1A
 23497        MOVE -1                  TO CCANDT1L
 23498        MOVE  1                  TO SET-CURSOR-SW
 23499        GO TO 7499-EXIT.
 23500
 23501**2732**
 23502
 23503     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 432
* VP6311.cbl
 23504        MOVE AL-UABON            TO CCANDT1A
 23505        MOVE -1                  TO CCANDT1L
 23506        MOVE  1                  TO SET-CURSOR-SW
 23507        GO TO 7499-EXIT.
 23508
 23509**2733**
 23510
 23511     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23512        MOVE AL-UABON            TO CCANDT1A
 23513        MOVE -1                  TO CCANDT1L
 23514        MOVE  1                  TO SET-CURSOR-SW
 23515        GO TO 7499-EXIT.
 23516
 23517**2734**
 23518
 23519     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23520        MOVE AL-UNBON            TO CREFND1A
 23521        MOVE -1                  TO CREFND1L
 23522        MOVE  1                  TO SET-CURSOR-SW
 23523        GO TO 7499-EXIT.
 23524
 23525**2735**
 23526
 23527     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23528        MOVE AL-UABON            TO CCANDT2A
 23529        MOVE -1                  TO CCANDT2L
 23530        MOVE  1                  TO SET-CURSOR-SW
 23531        GO TO 7499-EXIT.
 23532
 23533**2736**
 23534
 23535     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23536        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23537            MOVE AL-UNBON        TO CREFND1A
 23538            MOVE -1              TO CREFND1L
 23539            MOVE  1              TO SET-CURSOR-SW
 23540            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23541                MOVE AL-UNBON        TO CREFND2A
 23542                MOVE -1              TO CREFND2L
 23543                MOVE  1              TO SET-CURSOR-SW
 23544                GO TO 7499-EXIT
 23545            ELSE
 23546                GO TO 7499-EXIT
 23547        ELSE
 23548            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23549                MOVE AL-UNBON        TO CREFND2A
 23550                MOVE -1              TO CREFND2L
 23551                MOVE  1              TO SET-CURSOR-SW
 23552                GO TO 7499-EXIT
 23553            ELSE
 23554                GO TO 7499-EXIT.
 23555
 23556**2738**
 23557
 23558     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23559        MOVE -1                  TO CREFND2L
 23560        MOVE  1                  TO SET-CURSOR-SW
 23561        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 433
* VP6311.cbl
 23562
 23563**2739**
 23564
 23565     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23566        MOVE -1                  TO CREFND1L
 23567        MOVE  1                  TO SET-CURSOR-SW
 23568        GO TO 7499-EXIT.
 23569
 23570**2741**
 23571
 23572     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23573        MOVE -1                  TO CREFND1L
 23574        MOVE  1                  TO SET-CURSOR-SW
 23575        GO TO 7499-EXIT.
 23576
 23577**2743**
 23578
 23579     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23580        MOVE AL-UNBON            TO CCANDT1A
 23581        MOVE -1                  TO CCANDT1L
 23582        MOVE  1                  TO SET-CURSOR-SW
 23583        GO TO 7499-EXIT.
 23584
 23585**2744**
 23586
 23587     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23588        MOVE AL-UNBON            TO CCANDT2A
 23589        MOVE -1                  TO CCANDT2L
 23590        MOVE  1                  TO SET-CURSOR-SW
 23591        GO TO 7499-EXIT.
 23592
 23593**2747**
 23594
 23595     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23596        MOVE AL-UABON            TO CLSTNMA
 23597        MOVE -1                  TO CLSTNML
 23598        MOVE  1                  TO SET-CURSOR-SW
 23599        GO TO 7499-EXIT.
 23600
 23601**2749**
 23602
 23603     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23604        MOVE AL-UABON            TO CFORCEA
 23605        MOVE -1                  TO CFORCEL
 23606        MOVE  1                  TO SET-CURSOR-SW
 23607        GO TO 7499-EXIT.
 23608
 23609**2753**
 23610
 23611     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23612        MOVE AL-UNBON            TO CCANDT1A
 23613        MOVE -1                  TO CCANDT1L
 23614        MOVE  1                  TO SET-CURSOR-SW
 23615        GO TO 7499-EXIT.
 23616
 23617**2755**
 23618
 23619     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 434
* VP6311.cbl
 23620        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23621            MOVE AL-UNBON        TO CREFND1A
 23622            MOVE -1              TO CREFND1L
 23623            MOVE  1              TO SET-CURSOR-SW
 23624            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23625                MOVE AL-UNBON        TO CREFND2A
 23626                MOVE -1              TO CREFND2L
 23627                MOVE  1              TO SET-CURSOR-SW
 23628                GO TO 7499-EXIT
 23629            ELSE
 23630                GO TO 7499-EXIT
 23631        ELSE
 23632            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23633                MOVE AL-UNBON        TO CREFND2A
 23634                MOVE -1              TO CREFND2L
 23635                MOVE  1              TO SET-CURSOR-SW
 23636            ELSE
 23637                GO TO 7499-EXIT.
 23638
 23639**2757**
 23640
 23641     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23642        MOVE AL-UNBON            TO CLIVESA
 23643        MOVE -1                  TO CLIVESL
 23644        MOVE  1                  TO SET-CURSOR-SW
 23645        GO TO 7499-EXIT.
 23646
 23647**2771**
 23648
 23649     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23650        MOVE AL-UABON            TO CCANDT2A
 23651        MOVE -1                  TO CCANDT2L
 23652        MOVE  1                  TO SET-CURSOR-SW
 23653        GO TO 7499-EXIT.
 23654
 23655**2774**
 23656
 23657     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23658        MOVE AL-UABON            TO CCANDT1A
 23659        MOVE -1                  TO CCANDT1L
 23660        MOVE  1                  TO SET-CURSOR-SW
 23661        GO TO 7499-EXIT.
 23662
 23663**2775**
 23664
 23665     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23666        MOVE AL-UABON            TO CCANDT2A
 23667        MOVE -1                  TO CCANDT2L
 23668        MOVE  1                  TO SET-CURSOR-SW
 23669        GO TO 7499-EXIT.
 23670
 23671**2776**
 23672
 23673     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23674        MOVE AL-UABON            TO CCANDT1A
 23675        MOVE -1                  TO CCANDT1L
 23676        MOVE  1                  TO SET-CURSOR-SW
 23677        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 435
* VP6311.cbl
 23678
 23679
 23680**2777**
 23681
 23682     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23683        MOVE AL-UABON            TO CCANDT2A
 23684        MOVE -1                  TO CCANDT2L
 23685        MOVE  1                  TO SET-CURSOR-SW
 23686        GO TO 7499-EXIT.
 23687
 23688**2794**
 23689
 23690     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23691        MOVE AL-UABON            TO CFORCEA
 23692        MOVE -1                  TO CFORCEL
 23693        MOVE  1                  TO SET-CURSOR-SW
 23694        GO TO 7499-EXIT.
 23695
 23696**2799**
 23697
 23698     IF PI-COMPANY-ID = 'UCL'
 23699         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23700             MOVE AL-UNBON            TO BEFFDTA
 23701             MOVE -1                  TO BEFFDTL
 23702             MOVE  1                  TO SET-CURSOR-SW
 23703             GO TO 7499-EXIT.
 23704
 23705 7499-EXIT.
 23706      EXIT.
 23707
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 436
* VP6311.cbl
 23709
 23710 7500-READ-ERLOFC.
 23711     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23712                                     ERLOFC-KEY.
 23713
 23714     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23715
 23716     IF ST-ACCNT-CNTL
 23717         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23718
 23719     IF CARR-GROUP-ST-ACCNT-CNTL
 23720         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23721         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23722         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23723
 23724     IF CARR-ST-ACCNT-CNTL
 23725         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23726         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23727
 23728     IF CARR-ACCNT-CNTL
 23729         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23730
 23731     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23732
 23733     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23734
 23735
 23736* EXEC CICS HANDLE CONDITION
 23737*        NOTFND   (7550-OFFICER-NOTFND)
 23738*    END-EXEC.
 23739*    MOVE '"$I                   ! [ #00019902' TO DFHEIV0
 23740     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23742     MOVE X'5B20233030303139393032' TO DFHEIV0(25:11)
 23743     CALL 'kxdfhei1' USING DFHEIV0
 23744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23745
 23746
 23747
 23748* EXEC CICS READ
 23749*        DATASET   (FILE-ID-ERLOFC)
 23750*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23751*        RIDFLD    (ERLOFC-KEY)
 23752*        EQUAL
 23753*    END-EXEC.
 23754*    MOVE '&"S        E          (   #00019906' TO DFHEIV0
 23755     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23756     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23757     MOVE X'2020233030303139393036' TO DFHEIV0(25:11)
 23758     CALL 'kxdfhei1' USING DFHEIV0,
 23759           FILE-ID-ERLOFC,
 23760           DFHEIV20,
 23761           DFHEIV99,
 23762           ERLOFC-KEY,
 23763           DFHEIV99,
 23764           DFHEIV99,
 23765           DFHEIV99
 23766     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 437
* VP6311.cbl
 23767         DFHEIV20
 23768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23769
 23770
 23771     GO TO 7599-EXIT.
 23772
 23773 7550-OFFICER-NOTFND.
 23774     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23775
 23776 7599-EXIT.
 23777      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 438
* VP6311.cbl
 23779******************************************************************
 23780*                                                                *
 23781*            S  E N D    I N I T I A L   M A P                   *
 23782*                                                                *
 23783******************************************************************
 23784
 23785 8100-SEND-INITIAL-MAP.
 23786     MOVE EIBTIME                TO TIME-IN.
 23787
 23788     IF EIBAID = DFHPF11
 23789        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23791
 23792
 23793     IF PI-COMPANY-ID = CLIENT-GIC
 23794        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23795                                       BCPREM-ATTRB (2).
 23796
 23797     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23798                         CLIENT-PEM OR
 23799                         CLIENT-CSO)
 23800        AND PI-DISPLAY-ORIGINAL-BATCH
 23801          IF PI-MAP-NAME = VP631B
 23802             MOVE AL-SADOF               TO BPF5HDRA
 23803                                            BPF4HDRA
 23804          ELSE
 23805             IF PI-MAP-NAME = VP631C
 23806                MOVE AL-SADOF            TO CPF5HDRA
 23807                                            CPF4HDRA.
 23808
 23809     IF PI-MAP-NAME = VP631B
 23810        MOVE AL-SADOF               TO BPF5HDRA
 23811     ELSE
 23812        MOVE AL-SADOF               TO CPF5HDRA
 23813     END-IF
 23814
 23815
 23816     IF PI-PROCESSOR-ID = 'LGXX'
 23817        IF PI-MAP-NAME = VP631B
 23818           MOVE AL-SABOF                    TO BREFHDGA
 23819           MOVE AL-SANOF                    TO BREFA
 23820        ELSE
 23821           IF PI-MAP-NAME = VP631C
 23822              MOVE AL-SABOF                 TO CREFHDGA
 23823              MOVE AL-SANOF                 TO CREFA.
 23824
 23825     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 23826        continue
 23827     ELSE
 23828        IF PI-MAP-NAME = VP631C
 23829           MOVE AL-SADOF         TO CCANTXTA
 23830                                    CCANFEEA
 23831        end-if
 23832     end-if
 23833     IF PI-MAP-NAME = VP631D
 23834        IF PI-AR-PROCESSING
 23835           MOVE AL-SANOF            TO DREFHDGA
 23836        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 439
* VP6311.cbl
 23837           MOVE AL-SADOF            TO DREFHDGA.
 23838
 23839     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 23840        AND (PI-MAP-NAME = VP631B)
 23841        MOVE AL-SADOF            TO BVINHA
 23842                                    BVINA
 23843     END-IF
 23844     IF PI-MAP-NAME = VP631B
 23845        MOVE PI-COMPANY-ID          TO BCOMPIDO
 23846        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 23847                                 TO BREGIONO
 23848        MOVE PI-PROCESSOR-ID     TO BUSERO
 23849        IF CSR-EDIT-SESSION
 23850           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23851                                 TO BHEADO
 23852           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23853        ELSE
 23854           MOVE AL-SADOF         TO BF15HDRA
 23855           MOVE '4=B-HDR      '  TO BPF4HDRO
 23856        END-IF
 23857        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23858        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23859        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23860        MOVE WS-CURRENT-DT          TO BDATEO
 23861        MOVE TIME-OUT               TO BTIMEO
 23862        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23863        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23864        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23865        IF   WS-DISPLAY-SCREEN
 23866             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23867             MOVE PB-SV-CARRIER     TO BCARRO
 23868             MOVE PB-SV-GROUPING    TO BGROUPO
 23869             MOVE PB-SV-STATE       TO BSTATEO
 23870             MOVE PB-ACCOUNT        TO BACCTO
 23871        ELSE
 23872             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23873     ELSE
 23874        IF PI-MAP-NAME = VP631C
 23875           MOVE '4=B-HDR      '     TO CPF4HDRO
 23876           IF CSR-EDIT-SESSION
 23877              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23878                                 TO CHEADO
 23879           ELSE
 23880              MOVE AL-SADOF      TO CF15HDRA
 23881           END-IF
 23882           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23883           MOVE WS-CURRENT-DT          TO CDATEO
 23884           MOVE TIME-OUT               TO CTIMEO
 23885           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23886           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23887           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23888           MOVE WS-C-HDG               TO CLFHDGO
 23889           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23890           MOVE WS-C-HDG               TO CAHHDGO
 23891           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23892           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23893           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23894           IF   WS-DISPLAY-SCREEN
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 440
* VP6311.cbl
 23895                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23896                MOVE PB-SV-CARRIER     TO CCARRO
 23897                MOVE PB-SV-GROUPING    TO CGROUPO
 23898                MOVE PB-SV-STATE       TO CSTATEO
 23899                MOVE PB-ACCOUNT        TO CACCTO
 23900           ELSE
 23901                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23902        ELSE
 23903           MOVE WS-CURRENT-DT          TO DDATEO
 23904           MOVE TIME-OUT               TO DTIMEO
 23905           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23906                                          WS-REFUND-HDG-OVERRIDE
 23907           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23908           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23909           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23910                                          WS-REFUND-HDG-OVERRIDE
 23911           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23912           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23913           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23914           IF CSR-EDIT-SESSION
 23915              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23916                                 TO DHEADO
 23917           END-IF
 23918           IF  WS-DISPLAY-SCREEN
 23919               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23920               MOVE PB-CARRIER         TO DCARRO
 23921               MOVE PB-GROUPING        TO DGROUPO
 23922               MOVE PB-STATE           TO DSTATEO
 23923               MOVE PB-ACCOUNT         TO DACCTO
 23924               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23925           ELSE
 23926               MOVE VP631D             TO PI-MAP-NAME
 23927               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23928               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23929
 23930     MOVE SPACE                        TO WS-DISPLAY-SW.
 23931
 23932
 23933* EXEC CICS SEND
 23934*        MAP      (PI-MAP-NAME)
 23935*        MAPSET   (MAPSET-VP6311S)
 23936*        FROM     (VP631BI)
 23937*        ERASE
 23938*        CURSOR
 23939*    END-EXEC.
 23940     MOVE LENGTH OF
 23941      VP631BI
 23942       TO DFHEIV12
 23943     MOVE -1
 23944       TO DFHEIV11
 23945*    MOVE '8$     CT  E    H L F ,   #00020074' TO DFHEIV0
 23946     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23947     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23948     MOVE X'2020233030303230303734' TO DFHEIV0(25:11)
 23949     CALL 'kxdfhei1' USING DFHEIV0,
 23950           PI-MAP-NAME,
 23951           VP631BI,
 23952           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 441
* VP6311.cbl
 23953           MAPSET-VP6311S,
 23954           DFHEIV99,
 23955           DFHEIV99,
 23956           DFHEIV99,
 23957           DFHEIV11,
 23958           DFHEIV99,
 23959           DFHEIV99,
 23960           DFHEIV99
 23961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23962
 23963
 23964     GO TO 9100-RETURN-TRAN.
 23965
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 442
* VP6311.cbl
 23967
 23968******************************************************************
 23969*                                                                *
 23970*              S E N D    D A T A O N L Y                        *
 23971*                                                                *
 23972******************************************************************
 23973
 23974 8200-SEND-DATAONLY.
 23975     MOVE EIBTIME                TO TIME-IN.
 23976
 23977     IF PI-COMPANY-ID = CLIENT-GIC
 23978        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23979                                       BCPREM-ATTRB (2).
 23980
 23981     IF PI-MAP-NAME = VP631B
 23982        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23983        MOVE WS-CURRENT-DT          TO BDATEO
 23984        MOVE TIME-OUT               TO BTIMEO
 23985        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23986        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23987        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23988        MOVE SPACES                 TO BPFENTRO
 23989        MOVE AL-UANOF               TO BPFENTRA
 23990
 23991     ELSE
 23992        IF PI-MAP-NAME = VP631C
 23993           MOVE WS-CURRENT-DT          TO CDATEO
 23994           MOVE TIME-OUT               TO CTIMEO
 23995           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23996           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23997           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23998           MOVE SPACES                 TO CPFENTRO
 23999           MOVE AL-UANOF               TO CPFENTRA
 24000        ELSE
 24001           MOVE WS-CURRENT-DT          TO DDATEO
 24002           MOVE TIME-OUT               TO DTIMEO
 24003           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24004
 24005
 24006* EXEC CICS SEND
 24007*        MAP      (PI-MAP-NAME)
 24008*        MAPSET   (MAPSET-VP6311S)
 24009*        FROM     (VP631BI)
 24010*        DATAONLY
 24011*        CURSOR
 24012*    END-EXEC.
 24013     MOVE LENGTH OF
 24014      VP631BI
 24015       TO DFHEIV12
 24016     MOVE -1
 24017       TO DFHEIV11
 24018*    MOVE '8$D    CT       H L F ,   #00020123' TO DFHEIV0
 24019     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24020     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24021     MOVE X'2020233030303230313233' TO DFHEIV0(25:11)
 24022     CALL 'kxdfhei1' USING DFHEIV0,
 24023           PI-MAP-NAME,
 24024           VP631BI,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 443
* VP6311.cbl
 24025           DFHEIV12,
 24026           MAPSET-VP6311S,
 24027           DFHEIV99,
 24028           DFHEIV99,
 24029           DFHEIV99,
 24030           DFHEIV11,
 24031           DFHEIV99,
 24032           DFHEIV99,
 24033           DFHEIV99
 24034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24035
 24036
 24037     GO TO 9100-RETURN-TRAN.
 24038
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 444
* VP6311.cbl
 24040
 24041******************************************************************
 24042*                                                                *
 24043*           U T I L I T Y   R O U T I N E S                      *
 24044*                                                                *
 24045******************************************************************
 24046
 24047 8300-SEND-TEXT.
 24048
 24049* EXEC CICS SEND TEXT
 24050*        FROM     (LOGOFF-TEXT)
 24051*        LENGTH   (LOGOFF-LENGTH)
 24052*        ERASE
 24053*        FREEKB
 24054*    END-EXEC.
 24055*    MOVE '8&      T  E F  H   F -   #00020142' TO DFHEIV0
 24056     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24057     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24058     MOVE X'2020233030303230313432' TO DFHEIV0(25:11)
 24059     CALL 'kxdfhei1' USING DFHEIV0,
 24060           LOGOFF-TEXT,
 24061           LOGOFF-LENGTH,
 24062           DFHEIV99,
 24063           DFHEIV99,
 24064           DFHEIV99,
 24065           DFHEIV99,
 24066           DFHEIV99,
 24067           DFHEIV99,
 24068           DFHEIV99,
 24069           DFHEIV99,
 24070           DFHEIV99,
 24071           DFHEIV99
 24072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24073
 24074
 24075
 24076* EXEC CICS RETURN
 24077*    END-EXEC.
 24078*    MOVE '.(                    ''   #00020149' TO DFHEIV0
 24079     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24080     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24081     MOVE X'2020233030303230313439' TO DFHEIV0(25:11)
 24082     CALL 'kxdfhei1' USING DFHEIV0,
 24083           DFHEIV99,
 24084           DFHEIV99,
 24085           DFHEIV99,
 24086           DFHEIV99,
 24087           DFHEIV99,
 24088           DFHEIV99
 24089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24090
 24091
 24092 8400-LOG-JOURNAL-RECORD.
 24093     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24094     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24095
 24096*    EXEC CICS JOURNAL
 24097*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 445
* VP6311.cbl
 24098*        JTYPEID     ('EL')
 24099*        FROM        (JOURNAL-RECORD)
 24100*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24101*    END-EXEC.
 24102
 24103 8600-DEEDIT.
 24104
 24105* EXEC CICS BIF DEEDIT
 24106*         FIELD   (DEEDIT-FIELD)
 24107*         LENGTH  (15)
 24108*    END-EXEC.
 24109     MOVE 15
 24110       TO DFHEIV11
 24111*    MOVE '@"L                   #   #00020164' TO DFHEIV0
 24112     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24113     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24114     MOVE X'2020233030303230313634' TO DFHEIV0(25:11)
 24115     CALL 'kxdfhei1' USING DFHEIV0,
 24116           DEEDIT-FIELD,
 24117           DFHEIV11
 24118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24119
 24120
 24121 8800-UNAUTHORIZED-ACCESS.
 24122     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24123     GO TO 8300-SEND-TEXT.
 24124
 24125 8810-PF23.
 24126     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24127     MOVE XCTL-EL005             TO PGM-NAME.
 24128     GO TO 9300-XCTL.
 24129
 24130 9100-RETURN-TRAN.
 24131     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24132
 24133     IF  PI-MAP-NAME =  VP631B
 24134         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24135
 24136     IF  PI-MAP-NAME =  VP631C
 24137         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24138
 24139     IF  PI-MAP-NAME =  VP631D
 24140         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24141
 24142
 24143* EXEC CICS RETURN
 24144*        TRANSID    (TRANS-EXB1)
 24145*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24146*        LENGTH     (1300)
 24147*    END-EXEC.
 24148     MOVE 1300
 24149       TO DFHEIV11
 24150*    MOVE '.(CT                  ''   #00020190' TO DFHEIV0
 24151     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24152     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24153     MOVE X'2020233030303230313930' TO DFHEIV0(25:11)
 24154     CALL 'kxdfhei1' USING DFHEIV0,
 24155           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 446
* VP6311.cbl
 24156           PROGRAM-INTERFACE-BLOCK,
 24157           DFHEIV11,
 24158           DFHEIV99,
 24159           DFHEIV99,
 24160           DFHEIV99
 24161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24162
 24163
 24164 9200-RETURN-MAIN-MENU.
 24165     MOVE XCTL-EL626             TO PGM-NAME.
 24166     GO TO 9300-XCTL.
 24167
 24168 9300-XCTL.
 24169
 24170* EXEC CICS XCTL
 24171*        PROGRAM    (PGM-NAME)
 24172*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24173*        LENGTH     (PI-COMM-LENGTH)
 24174*    END-EXEC.
 24175*    MOVE '.$C                   %   #00020201' TO DFHEIV0
 24176     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24177     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24178     MOVE X'2020233030303230323031' TO DFHEIV0(25:11)
 24179     CALL 'kxdfhei1' USING DFHEIV0,
 24180           PGM-NAME,
 24181           PROGRAM-INTERFACE-BLOCK,
 24182           PI-COMM-LENGTH,
 24183           DFHEIV99
 24184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24185
 24186
 24187 9400-CLEAR.
 24188     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24189     GO TO 9300-XCTL.
 24190
 24191 9500-PF12.
 24192     MOVE XCTL-EL010             TO PGM-NAME.
 24193     GO TO 9300-XCTL.
 24194
 24195 9600-PGMID-ERROR.
 24196
 24197* EXEC CICS HANDLE CONDITION
 24198*        PGMIDERR    (8300-SEND-TEXT)
 24199*    END-EXEC.
 24200*    MOVE '"$L                   ! \ #00020216' TO DFHEIV0
 24201     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24203     MOVE X'5C20233030303230323136' TO DFHEIV0(25:11)
 24204     CALL 'kxdfhei1' USING DFHEIV0
 24205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24206
 24207
 24208     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24209     MOVE ' '                    TO PI-ENTRY-CD-1.
 24210     MOVE XCTL-EL005             TO PGM-NAME.
 24211     MOVE PGM-NAME               TO LOGOFF-PGM.
 24212     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24213     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 447
* VP6311.cbl
 24214
 24215 9700-DATE-LINK.
 24216     MOVE LINK-ELDATCV           TO PGM-NAME.
 24217
 24218* EXEC CICS LINK
 24219*        PROGRAM    (PGM-NAME)
 24220*        COMMAREA   (DATE-CONVERSION-DATA)
 24221*        LENGTH     (DC-COMM-LENGTH)
 24222*    END-EXEC.
 24223*    MOVE '."C                   (   #00020229' TO DFHEIV0
 24224     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24225     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24226     MOVE X'2020233030303230323239' TO DFHEIV0(25:11)
 24227     CALL 'kxdfhei1' USING DFHEIV0,
 24228           PGM-NAME,
 24229           DATE-CONVERSION-DATA,
 24230           DC-COMM-LENGTH,
 24231           DFHEIV99,
 24232           DFHEIV99,
 24233           DFHEIV99,
 24234           DFHEIV99
 24235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24236
 24237
 24238 9800-LINK-PENDING-EDIT.
 24239     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24240     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24241
 24242     MOVE LINK-EL050             TO PGM-NAME
 24243     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24244     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24245                                    WK-CO-TOL-CLAIM
 24246                                    WK-CO-TOL-PREM
 24247                                    WK-CO-TOL-REFUND
 24248                                    WK-CO-TOL-PREM-PCT
 24249                                    WK-CO-TOL-REFUND-PCT
 24250                                    WK-REFUND-OVS-AMT
 24251                                    WK-REFUND-OVS-PCT
 24252                                    WK-ACCT-ADDR
 24253                                    WK-LIFE-EDIT-ADDR
 24254                                    WK-AH-EDIT-ADDR
 24255                                    WK-LIFE-BEN-ADDR
 24256                                    WK-AH-BEN-ADDR
 24257                                    WK-STATE-ADDR
 24258                                    WK-PLAN-ADDR
 24259                                    WK-FORM-ADDR
 24260     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24261
 24262     MOVE '6'                    TO WK-ENTRY-SW.
 24263
 24264     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24265
 24266     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24267                                    EC-AM-EXPIRATION-DT
 24268                                    EC-AM-EFFECTIVE-DT
 24269                                    EC-CM-LF-CANCEL-DT
 24270                                    EC-CM-AH-CANCEL-DT
 24271                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 448
* VP6311.cbl
 24272
 24273     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24274                                    EC-CO-TOL-REFUND
 24275                                    EC-CO-MIN-AGE
 24276                                    EC-CO-MIN-PREMIUM
 24277                                    EC-CO-MIN-TERM
 24278                                    EC-CO-MAX-TERM
 24279                                    EC-ST-TOL-PREM
 24280                                    EC-ST-TOL-REFUND
 24281                                    EC-AM-LF-TOL-PREM
 24282                                    EC-AM-AH-TOL-PREM
 24283                                    EC-AM-LF-MAX-ATT-AGE
 24284                                    EC-AM-LF-MAX-AGE
 24285                                    EC-AM-LF-MAX-TERM
 24286                                    EC-AM-LF-MAX-TOT-BEN
 24287                                    EC-AM-AH-MAX-ATT-AGE
 24288                                    EC-AM-AH-MAX-AGE
 24289                                    EC-AM-AH-MAX-TERM
 24290                                    EC-AM-AH-MAX-TOT-BEN
 24291                                    EC-AM-AH-MAX-MON-BEN
 24292                                    EC-RT-LF-MAX-ATT-AGE
 24293                                    EC-RT-LF-MAX-AGE
 24294                                    EC-RT-LF-MAX-TERM
 24295                                    EC-RT-LF-MAX-TOT-BEN
 24296                                    EC-RT-AH-MAX-ATT-AGE
 24297                                    EC-RT-AH-MAX-AGE
 24298                                    EC-RT-AH-MAX-TERM
 24299                                    EC-RT-AH-MAX-TOT-BEN
 24300                                    EC-RT-AH-MAX-MON-BEN
 24301                                    EC-RT-AH-RATE
 24302                                    EC-RT-LF-RATE
 24303                                    EC-RT-LF-NSP-RATE
 24304                                    EC-RT-AH-NSP-RATE
 24305                                    EC-CM-LF-PRIOR-REFUND
 24306                                    EC-CM-AH-PRIOR-REFUND.
 24307
 24308     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24309                                    EC-ST-TOL-PREM-PCT
 24310                                    EC-AM-LF-TOL-REFUND
 24311                                    EC-AM-LF-DEV-PERCENT
 24312                                    EC-CO-TOL-REFUND-PCT
 24313                                    EC-ST-TOL-REFUND-PCT
 24314                                    EC-AM-AH-TOL-REFUND
 24315                                    EC-AM-AH-DEV-PERCENT.
 24316
 24317
 24318* EXEC CICS LINK
 24319*         PROGRAM   (PGM-NAME)
 24320*         COMMAREA  (PASSED-RECORD)
 24321*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24322*    END-EXEC.
 24323*    MOVE '."C                   (   #00020314' TO DFHEIV0
 24324     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24326     MOVE X'2020233030303230333134' TO DFHEIV0(25:11)
 24327     CALL 'kxdfhei1' USING DFHEIV0,
 24328           PGM-NAME,
 24329           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 449
* VP6311.cbl
 24330           WS-EDIT-PASS-LENGTH,
 24331           DFHEIV99,
 24332           DFHEIV99,
 24333           DFHEIV99,
 24334           DFHEIV99
 24335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24336
 24337
 24338     MOVE '1'                    TO PI-EDIT-SW.
 24339     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24340
 24341     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24342
 24343     IF PI-COMPANY-ID = 'UCL'
 24344         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24345
 24346     IF VALID-PB-ID
 24347        GO TO 9800-EXIT.
 24348
 24349     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24350
 24351     IF PI-MAP-NAME = VP631B
 24352        MOVE -1                  TO BMAINTL
 24353       ELSE
 24354        MOVE -1                  TO CMAINTL.
 24355
 24356     GO TO 8200-SEND-DATAONLY.
 24357
 24358 9800-EXIT.
 24359      EXIT.
 24360
 24361 9900-ERROR-FORMAT.
 24362
 24363     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24364
 24365     IF NOT EMI-ERRORS-COMPLETE
 24366         MOVE LINK-EL001         TO PGM-NAME
 24367
 24368* EXEC CICS LINK
 24369*            PROGRAM    (PGM-NAME)
 24370*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24371*            LENGTH     (EMI-COMM-LENGTH)
 24372*        END-EXEC.
 24373*    MOVE '."C                   (   #00020349' TO DFHEIV0
 24374     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24376     MOVE X'2020233030303230333439' TO DFHEIV0(25:11)
 24377     CALL 'kxdfhei1' USING DFHEIV0,
 24378           PGM-NAME,
 24379           ERROR-MESSAGE-INTERFACE-BLOCK,
 24380           EMI-COMM-LENGTH,
 24381           DFHEIV99,
 24382           DFHEIV99,
 24383           DFHEIV99,
 24384           DFHEIV99
 24385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24386
 24387
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 450
* VP6311.cbl
 24388 9900-EXIT.
 24389     EXIT.
 24390
 24391 9990-ABEND.
 24392     MOVE LINK-EL004             TO PGM-NAME.
 24393     MOVE DFHEIBLK               TO EMI-LINE1.
 24394
 24395* EXEC CICS LINK
 24396*        PROGRAM   (PGM-NAME)
 24397*        COMMAREA  (EMI-LINE1)
 24398*        LENGTH    (72)
 24399*    END-EXEC.
 24400     MOVE 72
 24401       TO DFHEIV11
 24402*    MOVE '."C                   (   #00020361' TO DFHEIV0
 24403     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24405     MOVE X'2020233030303230333631' TO DFHEIV0(25:11)
 24406     CALL 'kxdfhei1' USING DFHEIV0,
 24407           PGM-NAME,
 24408           EMI-LINE1,
 24409           DFHEIV11,
 24410           DFHEIV99,
 24411           DFHEIV99,
 24412           DFHEIV99,
 24413           DFHEIV99
 24414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24415
 24416
 24417     IF PI-MAP-NAME = VP631B
 24418        MOVE -1                  TO BMAINTL
 24419       ELSE
 24420        MOVE -1                  TO CMAINTL.
 24421
 24422     IF EIBTRNID NOT = TRANS-EXB1
 24423        GO TO 8100-SEND-INITIAL-MAP
 24424       ELSE
 24425        GO TO 8200-SEND-DATAONLY.
 24426
 24427 9995-SECURITY-VIOLATION.
 24428*                            COPY ELCSCTP.
 24429******************************************************************
 24430*                                                                *
 24431*                            ELCSCTP                             *
 24432*                            VMOD=2.001                          *
 24433*                                                                *
 24434*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24435******************************************************************
 24436
 24437
 24438     MOVE EIBDATE          TO SM-JUL-DATE.
 24439     MOVE EIBTRMID         TO SM-TERMID.
 24440     MOVE THIS-PGM         TO SM-PGM.
 24441     MOVE EIBTIME          TO TIME-IN.
 24442     MOVE TIME-OUT         TO SM-TIME.
 24443     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24444
 24445
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 451
* VP6311.cbl
 24446* EXEC CICS LINK
 24447*         PROGRAM  ('EL003')
 24448*         COMMAREA (SECURITY-MESSAGE)
 24449*         LENGTH   (80)
 24450*    END-EXEC.
 24451     MOVE 'EL003' TO DFHEIV1
 24452     MOVE 80
 24453       TO DFHEIV11
 24454*    MOVE '."C                   (   #00020395' TO DFHEIV0
 24455     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24457     MOVE X'2020233030303230333935' TO DFHEIV0(25:11)
 24458     CALL 'kxdfhei1' USING DFHEIV0,
 24459           DFHEIV1,
 24460           SECURITY-MESSAGE,
 24461           DFHEIV11,
 24462           DFHEIV99,
 24463           DFHEIV99,
 24464           DFHEIV99,
 24465           DFHEIV99
 24466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24467
 24468
 24469******************************************************************
 24470
 24471
 24472 9999-DFHBACK SECTION.
 24473     MOVE '9%                    "   ' TO DFHEIV0
 24474     MOVE 'VP6311' TO DFHEIV1
 24475     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24476     GOBACK.
 24477 9999-DFHEXIT.
 24478     IF DFHEIGDJ EQUAL 0001
 24479         NEXT SENTENCE
 24480     ELSE IF DFHEIGDJ EQUAL 2
 24481         GO TO 9600-PGMID-ERROR,
 24482               9990-ABEND,
 24483               9990-ABEND,
 24484               0010-MAIN-LOGIC
 24485         DEPENDING ON DFHEIGDI
 24486     ELSE IF DFHEIGDJ EQUAL 3
 24487         GO TO 1280-BATCH-HDR-NOT-FOUND
 24488         DEPENDING ON DFHEIGDI
 24489     ELSE IF DFHEIGDJ EQUAL 4
 24490         GO TO 1290-DUPLICATE-ALT-INDEX
 24491         DEPENDING ON DFHEIGDI
 24492     ELSE IF DFHEIGDJ EQUAL 5
 24493         GO TO 1295-CERT-TRL-REC-NOTFND
 24494         DEPENDING ON DFHEIGDI
 24495     ELSE IF DFHEIGDJ EQUAL 6
 24496         GO TO 1380-BATCH-HDR-NOT-FOUND
 24497         DEPENDING ON DFHEIGDI
 24498     ELSE IF DFHEIGDJ EQUAL 7
 24499         GO TO 1385-REC-NOT-FOUND
 24500         DEPENDING ON DFHEIGDI
 24501     ELSE IF DFHEIGDJ EQUAL 8
 24502         GO TO 1386-NOTFND
 24503         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 452
* VP6311.cbl
 24504     ELSE IF DFHEIGDJ EQUAL 9
 24505         GO TO 1398-EXIT
 24506         DEPENDING ON DFHEIGDI
 24507     ELSE IF DFHEIGDJ EQUAL 10
 24508         GO TO 1480-BATCH-HDR-NOT-FOUND
 24509         DEPENDING ON DFHEIGDI
 24510     ELSE IF DFHEIGDJ EQUAL 11
 24511         GO TO 1490-RECORD-NOT-FOUND
 24512         DEPENDING ON DFHEIGDI
 24513     ELSE IF DFHEIGDJ EQUAL 12
 24514         GO TO 1405-DELETE-CERTIFICATE
 24515         DEPENDING ON DFHEIGDI
 24516     ELSE IF DFHEIGDJ EQUAL 13
 24517         GO TO 1420-CONTINUE-DELETE
 24518         DEPENDING ON DFHEIGDI
 24519     ELSE IF DFHEIGDJ EQUAL 14
 24520         GO TO 1406-DELETE-ERNOTE
 24521         DEPENDING ON DFHEIGDI
 24522     ELSE IF DFHEIGDJ EQUAL 15
 24523         GO TO 1407-DELETE-MAILING
 24524         DEPENDING ON DFHEIGDI
 24525     ELSE IF DFHEIGDJ EQUAL 16
 24526         GO TO 1420-CONTINUE-DELETE
 24527         DEPENDING ON DFHEIGDI
 24528     ELSE IF DFHEIGDJ EQUAL 17
 24529         GO TO 1480-BATCH-HDR-NOT-FOUND
 24530         DEPENDING ON DFHEIGDI
 24531     ELSE IF DFHEIGDJ EQUAL 18
 24532         GO TO 1475-DELETE-FINISHED
 24533         DEPENDING ON DFHEIGDI
 24534     ELSE IF DFHEIGDJ EQUAL 19
 24535         GO TO 2280-BATCH-HDR-NOT-FOUND
 24536         DEPENDING ON DFHEIGDI
 24537     ELSE IF DFHEIGDJ EQUAL 20
 24538         GO TO 2290-DUPLICATE-ALT-INDEX
 24539         DEPENDING ON DFHEIGDI
 24540     ELSE IF DFHEIGDJ EQUAL 21
 24541         GO TO 2380-BATCH-HDR-NOT-FOUND
 24542         DEPENDING ON DFHEIGDI
 24543     ELSE IF DFHEIGDJ EQUAL 22
 24544         GO TO 2385-REC-NOT-FOUND
 24545         DEPENDING ON DFHEIGDI
 24546     ELSE IF DFHEIGDJ EQUAL 23
 24547         GO TO 2380-BATCH-HDR-NOT-FOUND
 24548         DEPENDING ON DFHEIGDI
 24549     ELSE IF DFHEIGDJ EQUAL 24
 24550         GO TO 2485-BATCH-HDR-NOT-FOUND
 24551         DEPENDING ON DFHEIGDI
 24552     ELSE IF DFHEIGDJ EQUAL 25
 24553         GO TO 2490-RECORD-NOT-FOUND
 24554         DEPENDING ON DFHEIGDI
 24555     ELSE IF DFHEIGDJ EQUAL 26
 24556         GO TO 2475-CONTINUE-DELETE
 24557         DEPENDING ON DFHEIGDI
 24558     ELSE IF DFHEIGDJ EQUAL 27
 24559         GO TO 2485-BATCH-HDR-NOT-FOUND
 24560         DEPENDING ON DFHEIGDI
 24561     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 453
* VP6311.cbl
 24562         GO TO 2480-DELETE-FINISHED
 24563         DEPENDING ON DFHEIGDI
 24564     ELSE IF DFHEIGDJ EQUAL 29
 24565         GO TO 2820-PROCESS-REWRITE
 24566         DEPENDING ON DFHEIGDI
 24567     ELSE IF DFHEIGDJ EQUAL 30
 24568         GO TO 2885-RECORD-MISSING
 24569         DEPENDING ON DFHEIGDI
 24570     ELSE IF DFHEIGDJ EQUAL 31
 24571         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24572         DEPENDING ON DFHEIGDI
 24573     ELSE IF DFHEIGDJ EQUAL 32
 24574         GO TO 2827-DELETE-MAILING
 24575         DEPENDING ON DFHEIGDI
 24576     ELSE IF DFHEIGDJ EQUAL 33
 24577         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24578         DEPENDING ON DFHEIGDI
 24579     ELSE IF DFHEIGDJ EQUAL 34
 24580         GO TO 2920-PROCESS-REWRITE
 24581         DEPENDING ON DFHEIGDI
 24582     ELSE IF DFHEIGDJ EQUAL 35
 24583         GO TO 2985-RECORD-MISSING
 24584         DEPENDING ON DFHEIGDI
 24585     ELSE IF DFHEIGDJ EQUAL 36
 24586         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24587         DEPENDING ON DFHEIGDI
 24588     ELSE IF DFHEIGDJ EQUAL 37
 24589         GO TO 2990-DUPLICATE-RECORD
 24590         DEPENDING ON DFHEIGDI
 24591     ELSE IF DFHEIGDJ EQUAL 38
 24592         GO TO 3590-NOT-FOUND
 24593         DEPENDING ON DFHEIGDI
 24594     ELSE IF DFHEIGDJ EQUAL 39
 24595         GO TO 3690-NOT-FOUND
 24596         DEPENDING ON DFHEIGDI
 24597     ELSE IF DFHEIGDJ EQUAL 40
 24598         GO TO 3990-NOT-FOUND
 24599         DEPENDING ON DFHEIGDI
 24600     ELSE IF DFHEIGDJ EQUAL 41
 24601         GO TO 4050-END-RECORDS,
 24602               4050-END-RECORDS
 24603         DEPENDING ON DFHEIGDI
 24604     ELSE IF DFHEIGDJ EQUAL 42
 24605         GO TO 4150-END-BATCH
 24606         DEPENDING ON DFHEIGDI
 24607     ELSE IF DFHEIGDJ EQUAL 43
 24608         GO TO 4150-END-BATCH
 24609         DEPENDING ON DFHEIGDI
 24610     ELSE IF DFHEIGDJ EQUAL 44
 24611         GO TO 4250-END-RECORDS,
 24612               4250-END-RECORDS
 24613         DEPENDING ON DFHEIGDI
 24614     ELSE IF DFHEIGDJ EQUAL 45
 24615         GO TO 4350-END-BATCH,
 24616               4350-END-BATCH
 24617         DEPENDING ON DFHEIGDI
 24618     ELSE IF DFHEIGDJ EQUAL 46
 24619         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:36 Page 454
* VP6311.cbl
 24620               4550-END-RECORDS
 24621         DEPENDING ON DFHEIGDI
 24622     ELSE IF DFHEIGDJ EQUAL 47
 24623         GO TO 4680-NOT-FOUND,
 24624               4680-NOT-FOUND
 24625         DEPENDING ON DFHEIGDI
 24626     ELSE IF DFHEIGDJ EQUAL 48
 24627         GO TO 4860-NOT-FOUND,
 24628               4850-END-RECORDS
 24629         DEPENDING ON DFHEIGDI
 24630     ELSE IF DFHEIGDJ EQUAL 49
 24631         GO TO 4970-NOT-FOUND,
 24632               4950-END-RECORDS
 24633         DEPENDING ON DFHEIGDI
 24634     ELSE IF DFHEIGDJ EQUAL 50
 24635         GO TO 5050-NOT-FOUND
 24636         DEPENDING ON DFHEIGDI
 24637     ELSE IF DFHEIGDJ EQUAL 51
 24638         GO TO 5050-NOT-FOUND
 24639         DEPENDING ON DFHEIGDI
 24640     ELSE IF DFHEIGDJ EQUAL 52
 24641         GO TO 5050-NOT-FOUND
 24642         DEPENDING ON DFHEIGDI
 24643     ELSE IF DFHEIGDJ EQUAL 53
 24644         GO TO 5550-END-RECORDS,
 24645               5550-END-RECORDS
 24646         DEPENDING ON DFHEIGDI
 24647     ELSE IF DFHEIGDJ EQUAL 54
 24648         GO TO 6050-QID-ERROR
 24649         DEPENDING ON DFHEIGDI
 24650     ELSE IF DFHEIGDJ EQUAL 55
 24651         GO TO 6050-QID-ERROR
 24652         DEPENDING ON DFHEIGDI
 24653     ELSE IF DFHEIGDJ EQUAL 56
 24654         GO TO 6400-CONTINUE,
 24655               6400-CONTINUE
 24656         DEPENDING ON DFHEIGDI
 24657     ELSE IF DFHEIGDJ EQUAL 57
 24658         GO TO 3690-NOT-FOUND
 24659         DEPENDING ON DFHEIGDI
 24660     ELSE IF DFHEIGDJ EQUAL 58
 24661         GO TO 7399-EXIT
 24662         DEPENDING ON DFHEIGDI
 24663     ELSE IF DFHEIGDJ EQUAL 59
 24664         GO TO 7550-OFFICER-NOTFND
 24665         DEPENDING ON DFHEIGDI
 24666     ELSE IF DFHEIGDJ EQUAL 60
 24667         GO TO 8300-SEND-TEXT
 24668         DEPENDING ON DFHEIGDI.
 24669     MOVE '9%                    "   ' TO DFHEIV0
 24670     MOVE 'VP6311' TO DFHEIV1
 24671     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24672     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15788     Code:       96410
