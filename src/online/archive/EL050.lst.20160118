* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54******************************************************************
    55 ENVIRONMENT DIVISION.
    56
    57 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page   3
* EL050.cbl
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    65
    66 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    67 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    68                                   USAGE POINTER.
    69 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    72                                   USAGE IS POINTER.
    73 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    78                                   USAGE IS POINTER.
    79
    80 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    82                                   USAGE IS POINTER.
    83
    84*    COPY ELC50WS.
    85*****************************************************************
    86*                                                               *
    87*                            ELC50WS.                           *
    88*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    89*                            VMOD=2.061.                        *
    90*                                                               *
    91*   THIS IS THE WORKING STORAGE FOR EL050                       *
    92*                                   EL517                       *
    93*****************************************************************
    94******************************************************************
    95*                   C H A N G E   L O G
    96*
    97* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    98*-----------------------------------------------------------------
    99*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   100* EFFECTIVE    NUMBER
   101*-----------------------------------------------------------------
   102* 123102                   PEMA  ADD DCC PROCESSING
   103* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   104* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   105* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   106* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   107* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   108* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   109* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   110* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   111* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   112* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   113* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   114* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   115* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   116* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page   4
* EL050.cbl
   117* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   118* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   119* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   120* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   121* 030309  CR2009021700001  PEMA  ADD ER-2883
   122* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   123* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   124* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   125* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   126* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   127* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   128* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   129* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   130* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   132* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   133* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   134* 061412  CR2011022800001  AJRA  NAPERSOFT
   135* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   136* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   137* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   138* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   139* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   140* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   141* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   142* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   143* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   144* 091114  IR2014091000001  TANA  ADD ERROR 2898
   145* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   146*-----------------------------------------------------------------
   147
   148 01  WORK-AREAS.
   149
   150*****************************************************************
   151*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   152*****************************************************************
   153
   154     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   155     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   156     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   157     12  WS-NAME-EDIT-WORK-AREA.
   158         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   159         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   160             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   161         16  WS-WORK-NAME.
   162             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   163             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   164             20  FILLER           PIC X(10)     VALUE SPACES.
   165         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   166             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   167
   168*****************************************************************
   169*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   170*****************************************************************
   171
   172     12  WS-ERRESC-KEY.
   173         16 WS-ERRESC-SEARCH-KEY.
   174             20  WS-ERRESC-COMPANY-CD PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page   5
* EL050.cbl
   175             20  WS-ERRESC-CARRIER    PIC  X.
   176             20  WS-ERRESC-GROUP      PIC X(6).
   177             20  WS-ERRESC-STATE      PIC XX.
   178             20  WS-ERRESC-ACCOUNT    PIC X(10).
   179         16 WS-ERRESC-RESIDUAL-KEY.
   180             20  WS-ERRESC-AGENT      PIC X(10).
   181             20  WS-ERRESC-RES-STATE  PIC XX.
   182             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   183*                                          YYYYMMDD
   184     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   185     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   186
   187*RESIDENT STATE TAX MASTER(ERRESS)
   188*
   189     12  WS-ERRESS-KEY.
   190         16  WS-ERRESS-COMPANY-CD      PIC  X.
   191         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   192         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   193         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   194*                                          YYYYMMDD
   195
   196     12  WS-CONTRACT-DATE              PIC 9(8).
   197*                                          YYYYMMDD
   198     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   199     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   200         16 WS-YEAR-YY                 PIC   9999.
   201         16 FILLER                     PIC 9(4).
   202*                                          YYYYMMDD
   203     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   204     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   205     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   206     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   207
   208     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   209         88  DPRB-1ST-TIME                      VALUE ' '.
   210
   211*****************************************************************
   212*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   213*****************************************************************
   214
   215     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   216     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   217     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   219     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   220     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   221     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   222     12  ws-st-agent-sig-edit    pic x          value spaces.
   223     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   224     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   225     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   226     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   227         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   228         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   229     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   230         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   231         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   232     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page   6
* EL050.cbl
   233
   234     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   235     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   236
   237     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   238     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   251     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   252     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   269     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   273     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   274     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   275     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   276     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   285     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   286     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   287     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   288     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   289     12  WS-2671-SW               PIC X         VALUE SPACE.
   290     12  WS-2672-SW               PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page   7
* EL050.cbl
   291     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   292         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   293     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   294         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   295     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   296
   297     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   298         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   299         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   300         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   301         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   302
   303     12  WS-CREDIT-EDIT-CONTROLS.
   304         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   305         16  WS-MIN-AGE           PIC 99                VALUE  0.
   306         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   307         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   308         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   309         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   310
   311     12  WS-AGE-FIELDS.
   312         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   313         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   314         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   315         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   316
   317     12  WS-SAVE-ALLOWABLE-BENEFIT.
   318         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   319         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   320         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   321         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   322         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   323         16  FILLER                      PIC XX.
   324
   325     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   326     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   327     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   328     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   329     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   330     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   331     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   332     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   333     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   334     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   335
   336     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   337     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   338     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   339     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   340     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   341     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   342     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   343     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   344         88  WS-REDUCING              VALUE 'R'.
   345         88  WS-LEVEL                 VALUE 'L' 'P'.
   346     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   347
   348     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page   8
* EL050.cbl
   349     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   350     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   351     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   352     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   353     12  ws-ah-max-bens           pic 99        value zeros.
   354     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   355     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   356     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   357     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   358
   359     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   360     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   361     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   362     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   363     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   364     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   365     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   366     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   367     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   368     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   369     12  WS-ACCT-SIG-SW.
   370         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   371         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   372     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   373     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   374     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   376     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   377     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   379     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  WS-INITIALS.
   382         16  WS-INIT-1            PIC X         VALUE SPACES.
   383         16  WS-INIT-2            PIC X         VALUE SPACES.
   384
   385     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   386     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   387     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   388     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   389     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   390*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   391     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   397     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   398     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   399     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   400     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   401     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   402     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   403     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   404     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   405     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   406     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page   9
* EL050.cbl
   407     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   413******** FLA
   414     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   416     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   417     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   418     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   419********
   420     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   421     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   422     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   423     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   424     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   425     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   426     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   427     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   428     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   429     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   430
   431     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   432         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   433                                         '0' THRU '9'.
   434
   435     12  NUMBER-OF-MONTHS.
   436         16  SK-MO OCCURS 12 TIMES PIC X.
   437
   438     12  WS-WORK-DATE.
   439         16  WS-YEAR            PIC 99    VALUE 00.
   440         16  WS-MONTH           PIC 99    VALUE 00.
   441         16  WS-DAY             PIC 99    VALUE 00.
   442
   443     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   444     12  WS-WORK-CRIT-DEV       REDEFINES
   445         WS-WORK-LF-CRIT-PER    PIC X(03).
   446
   447     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   448     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   449
   450     12  WS-WORK-DATE-FROM.
   451         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   452         16  FILLER             PIC X  VALUE SPACE.
   453         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   454         16  FILLER             PIC X         VALUE SPACE.
   455         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   456
   457     12  WS-WORK-DATE-THRU.
   458         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   459         16  FILLER             PIC X         VALUE SPACE.
   460         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   461         16  FILLER             PIC X         VALUE SPACE.
   462         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   463
   464     12  WS-LF-INPUT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  10
* EL050.cbl
   465         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   466         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   467
   468     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   469     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   470         16  WS-AH-INPUT-CD-1   PIC X.
   471         16  WS-AH-INPUT-CD-2-3 PIC XX.
   472
   473     12  WS-SWITCHES.
   474         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   475         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   476             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   477         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   478             88  BANK-ACCT-FOUND          VALUE 'Y'.
   479         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   480             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   481         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   482             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   483         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   484             88  COMP-MASTER-FOUND        VALUE 'Y'.
   485         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   486             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   487         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   488             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   489         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   490             88  STAT-MASTER-FOUND        VALUE 'Y'.
   491         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   492             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   493         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   494             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   495         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   496             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   497         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   498             88  FORM-MASTER-FOUND        VALUE 'Y'.
   499         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   500             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   501         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   502             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   503         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   504             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   505         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   506             88  NO-BENEFIT-FOUND         VALUE 'N'.
   507         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   508             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   509         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   510             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   511         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   512             88  AH-BENEFIT-FOUND         VALUE ' '.
   513             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   514         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   515             88  LF-BENEFIT-FOUND         VALUE ' '.
   516             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   517         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   518             88  NO-STATE-RECORD          VALUE '1'.
   519         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   520             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   521         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   522             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  11
* EL050.cbl
   523         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   524             88  CERT-WAS-FOUND           VALUE ' '.
   525             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   526         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   527             88  BROWSE-STARTED           VALUE 'Y'.
   528         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   529             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   530         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   531             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   532         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   533             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   534         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   535             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   536         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   537             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   538         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   539             88  APP-CERT-USED            VALUE 'Y' 'A'.
   540         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   541             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   542             88  FIRST-TIME-THROUGH       VALUE '1'.
   543             88  CTBL-NOT-FOUND           VALUE '2'.
   544
   545         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   546             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   547
   548         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   549             88  DLO-ERROR-FOUND          VALUE 'Y'.
   550
   551********FLA
   552     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   553     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   554********
   555     12  RC-SW-1                  PIC X           VALUE '0'.
   556     12  RC-SW-2                  PIC X           VALUE '0'.
   557     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   558     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   559     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   566     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   567     12  LIT-SPACES               PIC X           VALUE SPACES.
   568     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   569     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   570     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   571     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   572     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   573     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   574     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   575         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   576         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   577     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   578         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   579
   580 01  WS-EXTRA-PERIODS-BY-STATE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  12
* EL050.cbl
   581     12  WS-INT-PERIODS          PIC 9.
   582     12  WS-EXTRA-PMTS           PIC 9.
   583 01  ws-net-only-state           pic x value 'N'.
   584 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   585     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   586     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   587 01  WS-CRI-SSN-WORK-AREA.
   588     05  WS-CRI-SOC-SEC-NO.
   589         10  WS-SS-REPT-CD       PIC X(5).
   590         10  WS-SS-LAST-NAME     PIC X(5).
   591         10  WS-SS-INITIAL       PIC X.
   592
   593     05  WS-CRI-REPORT-CODE.
   594         10  FILLER              PIC X(5).
   595         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   596
   597     05  WS-CRI-LAST-NAME.
   598         10  WS-CRI-NAME-MOVE    PIC X(5).
   599         10  FILLER              PIC X(10).
   600
   601 01  WS-NUM-TABLE                PIC X(26)  VALUE
   602     '12345678012345070923456789'.
   603 01  FILLER REDEFINES WS-NUM-TABLE.
   604     05  WS-NUM OCCURS 26        PIC 9.
   605 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   606 01  V1                          PIC S999 COMP-3.
   607 01  V2                          PIC S999 COMP-3.
   608 01  V3                          PIC S999 COMP-3.
   609 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   610 01  FILLER REDEFINES WS-WORK-VIN.
   611     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   612 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   613 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   614 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   615 01  WS-HEX-WORK.
   616     05  FILLER                  PIC X  VALUE LOW-VALUES.
   617     05  WS-HEX-BYTE             PIC X.
   618 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   619 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   620 01  WS-WORK-HIN-ROW-B.
   621     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   622
   623 01  ws-benefit-cd-chg-sw      pic x value spaces.
   624     88  benefit-code-chg           value 'Y'.
   625 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   626 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   627     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   628 01  WS-ROW-D-TABLE.
   629     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   630
   631 01  WS-HIN-TABLE-B.
   632     05  F                       PIC XX VALUE 'A2'.
   633     05  F                       PIC XX VALUE 'B3'.
   634     05  F                       PIC XX VALUE 'C4'.
   635     05  F                       PIC XX VALUE 'D5'.
   636     05  F                       PIC XX VALUE 'E6'.
   637     05  F                       PIC XX VALUE 'F7'.
   638     05  F                       PIC XX VALUE 'G8'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  13
* EL050.cbl
   639     05  F                       PIC XX VALUE 'H9'.
   640     05  F                       PIC XX VALUE 'I1'.
   641     05  F                       PIC XX VALUE 'J2'.
   642     05  F                       PIC XX VALUE 'K3'.
   643     05  F                       PIC XX VALUE 'L4'.
   644     05  F                       PIC XX VALUE 'M5'.
   645     05  F                       PIC XX VALUE 'N6'.
   646     05  F                       PIC XX VALUE 'O0'.
   647     05  F                       PIC XX VALUE 'P7'.
   648     05  F                       PIC XX VALUE 'Q0'.
   649     05  F                       PIC XX VALUE 'R8'.
   650     05  F                       PIC XX VALUE 'S9'.
   651     05  F                       PIC XX VALUE 'T2'.
   652     05  F                       PIC XX VALUE 'U3'.
   653     05  F                       PIC XX VALUE 'V4'.
   654     05  F                       PIC XX VALUE 'W5'.
   655     05  F                       PIC XX VALUE 'X6'.
   656     05  F                       PIC XX VALUE 'Y7'.
   657     05  F                       PIC XX VALUE 'Z8'.
   658 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   659     05  WS-VAL-IN               PIC X.
   660     05  WS-VAL-OUT              PIC 9.
   661 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   662 01  WS-COMPARE-BINARY-DATES.
   663     05  WS-971231                PIC XX VALUE X'92FF'.
   664     05  WS-931231                PIC XX VALUE X'8CFF'.
   665     05  WS-791231                PIC XX VALUE X'77FF'.
   666     05  WS-771001                PIC XX VALUE X'74A1'.
   667     05  WS-820301                PIC XX VALUE X'7B41'.
   668     05  WS-831031                PIC XX VALUE X'7DBF'.
   669     05  WS-831231                PIC XX VALUE X'7DFF'.
   670     05  WS-810831                PIC XX VALUE X'7A7F'.
   671     05  WS-830901                PIC XX VALUE X'7D81'.
   672
   673 01  FILE-ACCESS-IDS.
   674     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   675     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   676     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   677     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   678     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   679     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   680     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   681     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   682     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   683     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   684     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   685     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   686     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   687     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   688     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   689     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   690     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   691 01  DD-IU-SW                    PIC X   VALUE ' '.
   692     88  DD-IU-PRESENT                 VALUE 'Y'.
   693
   694 01  ACCESS-KEYS.
   695     12  ELMSTR-KEY.
   696         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  14
* EL050.cbl
   697         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   698     12  W-CLAIM-KEY.
   699         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   701
   702     12  ELCNTL-KEY.
   703         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   704         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   705         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   706         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   707
   708     12  ELCERT-KEY.
   709         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   710         16  CERT-CARRIER         PIC X       VALUE SPACE.
   711         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   712         16  CERT-STATE           PIC XX      VALUE SPACES.
   713         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   714         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   715         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   716
   717     12  ELCERT2-KEY.
   718         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   719         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   720
   721     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   722
   723     12  ELCERT-SAVE.
   724         16  FILLER                      PIC XX    VALUE SPACES.
   725
   726         16  WCS-CONTROL-PRIMARY.
   727             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   728             20  WCS-CARRIER             PIC X     VALUE SPACE.
   729             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   730             20  WCS-STATE               PIC XX    VALUE SPACES.
   731             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   732             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   733             20  WCS-CERT-NO.
   734                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   735                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   736
   737         16  CS-CONTROL-BY-NAME.
   738             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   739             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   740             20  CS-INSURED-INITIALS.
   741                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   742                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   743
   744         16  CS-CONTROL-BY-SSN.
   745             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   746             20  CS-SOC-SEC-NO.
   747                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   748                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   749                 24  CS-SSN-LN3.
   750                     28 CS-INSURED-INITIALS-A2   PIC XX
   751                                     VALUE SPACES.
   752                     28 CS-PART-LAST-NAME-A2     PIC X
   753                                     VALUE SPACE.
   754
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  15
* EL050.cbl
   755         16  CS-CONTROL-BY-CERT-NO.
   756             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   757             20  CS-CERT-NO-A4           PIC X(11)
   758                                     VALUE SPACES.
   759
   760         16  CS-CONTROL-BY-MEMB.
   761             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   762             20  CS-MEMBER-NO.
   763                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   764                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   765                 24  CS-MEMB-LN4.
   766                     28 CS-INSURED-INITIALS-A5   PIC XX
   767                                      VALUE SPACES.
   768                     28 CS-PART-LAST-NAME-A5     PIC XX
   769                                      VALUE SPACES.
   770
   771         16  FILLER              PIC X(360) VALUE SPACES.
   772
   773     12  ERACCT-KEY.
   774         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   775         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   776         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   777         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   778         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   779         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   780
   781     12  ERCOMP-KEY.
   782         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   783         16  COMP-CARRIER         PIC X     VALUE SPACES.
   784         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   785         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   786         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   787         16  COMP-TYPE            PIC X     VALUE SPACES.
   788
   789     12  ERLOFC-KEY.
   790         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   791         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   792         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   793         16  LOFC-STATE           PIC XX    VALUE SPACES.
   794         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   795         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   796
   797     12  WS-ELCRTT-KEY.
   798         16  WS-ELCRTT-PRIMARY       PIC X(33).
   799         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   800
   801     12  ERBXRF-KEY.
   802         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   803         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   804         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   805         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   806
   807     12  ERAGTC-KEY.
   808         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   809         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   810         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   811         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   812         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  16
* EL050.cbl
   813         16  AGTC-TYPE            PIC X     VALUE SPACES.
   814
   815     12  ERPLAN-KEY.
   816         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   817         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   818         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   819         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   820         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   821         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   822         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   823         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   824
   825     12  ERFORM-KEY.
   826         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   827         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   828         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   829         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   830
   831     12  ERREIN-KEY.
   832         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   833         16  REIN-TYPE            PIC X     VALUE SPACES.
   834         16  REIN-TABLE-CO.
   835             20  REIN-CODE-1      PIC X     VALUE SPACE.
   836             20  REIN-CODE-2      PIC X     VALUE SPACE.
   837             20  REIN-CODE-3      PIC X     VALUE SPACE.
   838         16  FILLER               PIC X(3)  VALUE SPACES.
   839
   840     12  ERCTBL-KEY.
   841         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   842         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   843         16  CTBL-CNTRL-2.
   844             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   845             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   846
   847     12  ELCRTO-KEY.
   848         16  ELCRTO-COMPANY-CD       PIC X.
   849         16  ELCRTO-CARRIER          PIC X.
   850         16  ELCRTO-GROUPING         PIC X(6).
   851         16  ELCRTO-STATE            PIC XX.
   852         16  ELCRTO-ACCOUNT          PIC X(10).
   853         16  ELCRTO-CERT-EFF-DT      PIC XX.
   854         16  ELCRTO-CERT-NO.
   855             20  ELCRTO-CERT-PRIME   PIC X(10).
   856             20  ELCRTO-CERT-SFX     PIC X.
   857         16  ELCRTO-RECORD-TYPE      PIC X.
   858         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   859
   860
   861     12  WS-ACCESS.
   862         16  FILLER               PIC XX    VALUE SPACES.
   863         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   864
   865     12  WS-CARR-ACCESS.
   866         16  FILLER               PIC X(3)  VALUE SPACES.
   867         16  WS-CARR              PIC X     VALUE SPACE.
   868*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   869*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   870     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  17
* EL050.cbl
   871         88  WS-DMD-LF-RATING   VALUE 'Y'.
   872         88  WS-DMD-AH-RATING   VALUE 'Y'.
   873         88  WS-DMD-NO-RATING   VALUE 'N'.
   874
   875     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   876         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   877                                         'NJ' 'NL'
   878                                         'PJ' 'PL'
   879                                         'SJ' 'SL'.
   880     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   881         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   882                                         'NI' 'NJ' 'NL' 'NU'
   883                                         'PJ' 'PL' 'PI' 'PU'
   884                                         'SI' 'SJ' 'SL' 'SU'
   885                                         'MX' 'MY' 'MZ'.
   886 01  ERPDEF-KEY-SAVE             PIC X(18).
   887 01  ERPDEF-KEY.
   888     12  ERPDEF-COMPANY-CD       PIC X.
   889     12  ERPDEF-STATE            PIC XX.
   890     12  ERPDEF-PROD-CD          PIC XXX.
   891     12  F                       PIC X(7).
   892     12  ERPDEF-BEN-TYPE         PIC X.
   893     12  ERPDEF-BEN-CODE         PIC XX.
   894     12  ERPDEF-EXP-DT           PIC XX.
   895
   896 01  ELSTAT-KEY-SAVE             PIC X(20).
   897 01  ELSTAT-KEY.
   898     12  ELSTAT-COMPANY-ID       PIC XXX.
   899     12  ELSTAT-CARRIER          PIC X.
   900     12  ELSTAT-GROUP            PIC X(6).
   901     12  ELSTAT-STATE            PIC XX.
   902     12  ELSTAT-EXP-DT           PIC 9(8).
   903 01  WS-ERROR-VALUES.
   904     12  ER-1570                     PIC S9(4)   VALUE +1570.
   905     12  ER-1571                     PIC S9(4)   VALUE +1571.
   906     12  er-1572                     pic s9(4)   value +1572.
   907     12  er-1573                     pic s9(4)   value +1573.
   908     12  er-1574                     pic s9(4)   value +1574.
   909     12  ER-1575                     PIC S9(4)   VALUE +1575.
   910     12  er-1576                     pic s9(4)   value +1576.
   911     12  er-1743                     pic s9(4)   value +1743.
   912     12  er-1744                     pic s9(4)   value +1744.
   913     12  er-1745                     pic s9(4)   value +1745.
   914     12  er-1746                     pic s9(4)   value +1746.
   915     12  er-1747                     pic s9(4)   value +1747.
   916     12  er-1748                     pic s9(4)   value +1748.
   917     12  ER-1891                     PIC S9(4)   VALUE +1891.
   918     12  ER-1892                     PIC S9(4)   VALUE +1892.
   919     12  ER-1893                     PIC S9(4)   VALUE +1893.
   920     12  ER-1894                     PIC S9(4)   VALUE +1894.
   921     12  ER-1895                     PIC S9(4)   VALUE +1895.
   922     12  ER-1896                     PIC S9(4)   VALUE +1896.
   923     12  ER-1897                     PIC S9(4)   VALUE +1897.
   924     12  ER-1898                     PIC S9(4)   VALUE +1898.
   925     12  ER-1899                     PIC S9(4)   VALUE +1899.
   926     12  ER-1900                     PIC S9(4)   VALUE +1900.
   927     12  ER-1901                     PIC S9(4)   VALUE +1901.
   928     12  ER-1902                     PIC S9(4)   VALUE +1902.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  18
* EL050.cbl
   929     12  ER-1903                     PIC S9(4)   VALUE +1903.
   930     12  ER-1904                     PIC S9(4)   VALUE +1904.
   931     12  ER-1905                     PIC S9(4)   VALUE +1905.
   932     12  ER-1906                     PIC S9(4)   VALUE +1906.
   933     12  ER-1907                     PIC S9(4)   VALUE +1907.
   934     12  ER-1909                     PIC S9(4)   VALUE +1909.
   935     12  ER-1910                     PIC S9(4)   VALUE +1910.
   936     12  ER-1911                     PIC S9(4)   VALUE +1911.
   937     12  ER-1912                     PIC S9(4)   VALUE +1912.
   938     12  ER-1913                     PIC S9(4)   VALUE +1913.
   939     12  ER-1914                     PIC S9(4)   VALUE +1914.
   940     12  ER-1915                     PIC S9(4)   VALUE +1915.
   941     12  ER-1916                     PIC S9(4)   VALUE +1916.
   942     12  ER-1917                     PIC S9(4)   VALUE +1917.
   943     12  ER-1918                     PIC S9(4)   VALUE +1918.
   944     12  ER-1919                     PIC S9(4)   VALUE +1919.
   945     12  ER-1920                     PIC S9(4)   VALUE +1920.
   946     12  ER-1921                     PIC S9(4)   VALUE +1921.
   947     12  ER-1922                     PIC S9(4)   VALUE +1922.
   948     12  ER-1923                     PIC S9(4)   VALUE +1923.
   949     12  ER-1924                     PIC S9(4)   VALUE +1924.
   950     12  ER-1925                     PIC S9(4)   VALUE +1925.
   951     12  ER-1926                     PIC S9(4)   VALUE +1926.
   952     12  ER-1927                     PIC S9(4)   VALUE +1927.
   953     12  ER-2393                     PIC S9(4)   VALUE +2393.
   954     12  ER-2600                     PIC S9(4)   VALUE +2600.
   955     12  ER-2601                     PIC S9(4)   VALUE +2601.
   956     12  ER-2602                     PIC S9(4)   VALUE +2602.
   957     12  ER-2603                     PIC S9(4)   VALUE +2603.
   958     12  ER-2604                     PIC S9(4)   VALUE +2604.
   959     12  ER-2605                     PIC S9(4)   VALUE +2605.
   960     12  ER-2606                     PIC S9(4)   VALUE +2606.
   961     12  ER-2607                     PIC S9(4)   VALUE +2607.
   962     12  ER-2608                     PIC S9(4)   VALUE +2608.
   963     12  ER-2609                     PIC S9(4)   VALUE +2609.
   964     12  ER-2610                     PIC S9(4)   VALUE +2610.
   965     12  ER-2611                     PIC S9(4)   VALUE +2611.
   966     12  ER-2612                     PIC S9(4)   VALUE +2612.
   967     12  ER-2613                     PIC S9(4)   VALUE +2613.
   968     12  ER-2614                     PIC S9(4)   VALUE +2614.
   969     12  ER-2615                     PIC S9(4)   VALUE +2615.
   970     12  ER-2616                     PIC S9(4)   VALUE +2616.
   971     12  ER-2617                     PIC S9(4)   VALUE +2617.
   972     12  ER-2618                     PIC S9(4)   VALUE +2618.
   973     12  ER-2619                     PIC S9(4)   VALUE +2619.
   974     12  ER-2620                     PIC S9(4)   VALUE +2620.
   975     12  ER-2621                     PIC S9(4)   VALUE +2621.
   976     12  ER-2622                     PIC S9(4)   VALUE +2622.
   977     12  ER-2623                     PIC S9(4)   VALUE +2623.
   978     12  ER-2624                     PIC S9(4)   VALUE +2624.
   979     12  ER-2625                     PIC S9(4)   VALUE +2625.
   980     12  ER-2626                     PIC S9(4)   VALUE +2626.
   981     12  ER-2627                     PIC S9(4)   VALUE +2627.
   982     12  ER-2628                     PIC S9(4)   VALUE +2628.
   983     12  ER-2629                     PIC S9(4)   VALUE +2629.
   984     12  ER-2630                     PIC S9(4)   VALUE +2630.
   985     12  ER-2631                     PIC S9(4)   VALUE +2631.
   986     12  ER-2632                     PIC S9(4)   VALUE +2632.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  19
* EL050.cbl
   987     12  ER-2633                     PIC S9(4)   VALUE +2633.
   988     12  ER-2634                     PIC S9(4)   VALUE +2634.
   989     12  ER-2635                     PIC S9(4)   VALUE +2635.
   990     12  ER-2636                     PIC S9(4)   VALUE +2636.
   991     12  ER-2637                     PIC S9(4)   VALUE +2637.
   992     12  ER-2638                     PIC S9(4)   VALUE +2638.
   993     12  ER-2639                     PIC S9(4)   VALUE +2639.
   994     12  ER-2640                     PIC S9(4)   VALUE +2640.
   995     12  ER-2641                     PIC S9(4)   VALUE +2641.
   996     12  ER-2642                     PIC S9(4)   VALUE +2642.
   997     12  ER-2643                     PIC S9(4)   VALUE +2643.
   998     12  ER-2644                     PIC S9(4)   VALUE +2644.
   999     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1000     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1001     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1002     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1003     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1004     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1005     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1006     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1007     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1008     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1009     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1010     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1011     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1012     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1013     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1014     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1015     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1016     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1017     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1018     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1019     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1020     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1021     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1022     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1023     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1024     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1025     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1026     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1027     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1028     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1029     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1030     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1031     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1032     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1033     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1034     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1035     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1036     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1037     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1038     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1039     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1040     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1041     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1042     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1043     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1044     12  ER-2690                     PIC S9(4)   VALUE +2690.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  20
* EL050.cbl
  1045     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1046     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1047     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1048     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1049     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1050     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1051     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1052     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1053     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1054     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1055     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1056     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1057     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1058     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1059     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1060     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1061     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1062     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1063     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1064     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1065     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1066     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1067     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1068     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1069     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1070     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1071     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1072     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1073     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1074     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1075     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1076     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1077     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1078     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1079     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1080     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1081     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1082     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1083     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1084     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1085     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1086     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1087     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1088     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1089     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1090     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1091     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1092     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1093     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1094     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1095     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1096     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1097     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1098     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1099     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1100     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1101     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1102     12  ER-2758                     PIC S9(4)   VALUE +2758.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  21
* EL050.cbl
  1103     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1104     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1105     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1106     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1107     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1108     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1109     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1110     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1111     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1112     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1113     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1114     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1115     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1116     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1117     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1118     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1119     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1120     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1121     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1122     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1123     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1124     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1125     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1126     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1127     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1128     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1129     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1130     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1131     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1132     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1133     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1134     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1135     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1136     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1137     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1138     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1139     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1140     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1141     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1142     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1143     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1144     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1145     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1146     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1147     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1148     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1149     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1150     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1151     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1152     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1153     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1154     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1155     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1156     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1157     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1158     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1159     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1160     12  ER-3006                     PIC S9(4)   VALUE +3006.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  22
* EL050.cbl
  1161     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1162     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1163     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1164     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1165     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1166     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1167     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1168     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1169     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1170     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1171     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1172     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1173     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1174     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1175     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1176     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1177     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1178     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1179     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1180     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1181     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1182     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1183     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1184     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1185     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1186     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1187     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1188     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1189     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1190     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1191     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1192     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1193     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1194     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1195     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1196     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1197     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1198     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1199     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1200     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1201     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1202     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1203     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1204     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1205     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1206     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1207     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1208     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1209     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1210     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1211     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1212     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1213     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1214     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1215     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1216     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1217     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1218     12  ER-8085                     PIC S9(4)   VALUE +8085.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  23
* EL050.cbl
  1219     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1220     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1221     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1222     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1223     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1224     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1225     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1226     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1227     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1228     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1229     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1230     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1231     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1232     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1233     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1234     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1235     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1236     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1237     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1238     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1239     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1240     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1241     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1242     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1243     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1244     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1245     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1246     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1247     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1248     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1249     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1250     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1251     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1252     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1253     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1254     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1255     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1256     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1257     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1258     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1259     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1260     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1261******************************************************************
  1262***************   END OF ELC50WS     ****************************
  1263******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  24
* EL050.cbl
  1266 01  WORKING-STORAGE-WORK-AREAS.
  1267     12  WS-RESPONSE             PIC S9(8)  COMP.
  1268         88  WS-RESP-NORMAL           VALUE +00.
  1269         88  WS-RESP-ERROR            VALUE +01.
  1270         88  WS-RESP-NOTFND           VALUE +13.
  1271         88  WS-RESP-DUPREC           VALUE +14.
  1272         88  WS-RESP-ENDFILE          VALUE +20.
  1273     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1274     12  WORK-AREAS.
  1275         16  WK-CONV-GREG.
  1276             24  WCG-CENT             PIC XX.
  1277             24  WCG-REST             PIC X(4).
  1278         16  WORK-GREGORIAN-DATE.
  1279             24  WK-GREG-CENT         PIC XX.
  1280             24  WK-GREG-DATE-YYMMDD.
  1281                 28  WK-GREG-YYMM     PIC X(4).
  1282                 28  WK-GREG-DD       PIC XX.
  1283
  1284         16  WORK-SELECT-DATE.
  1285             24  WK-SELECT-CENT            PIC XX.
  1286             24  WK-SELECT-DATE-YYMMDD.
  1287                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1288                 28  FILLER                PIC XX.
  1289
  1290         16  WK-FORM-NO.
  1291             24  WK-FORM-BANK-ID       PIC X(5).
  1292             24  WK-FORM-UNDRWRTR      PIC X(1).
  1293             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1294
  1295         16  WK-MEMBER-NO.
  1296             24  WK-MEMBER-1-6        PIC X(6).
  1297             24  WK-MEMBER-7-12       PIC X(6).
  1298
  1299         16  WK-FULL-CERT-NO.
  1300             24  WK-CERT-POS-1-2      PIC X(2).
  1301             24  WK-CERT-POS-3        PIC X(1).
  1302             24  WK-CERT-POS-4        PIC X(1).
  1303             24  WK-CERT-POS-5-6      PIC X(2).
  1304             24  WK-CERT-POS-7        PIC X(1).
  1305             24  WK-CERT-POS-8-11     PIC X(4).
  1306
  1307         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1308             88  VALID-RATE-CODE        VALUE 'Y'.
  1309             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1310
  1311         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1312         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1313         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1314         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1315         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1316         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1317         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1318         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1319         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1320         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1321
  1322* DLO001
  1323 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  25
* EL050.cbl
  1324     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1325     12  DMPF-RETURN-CODE          PIC XX.
  1326         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1327         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1328         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1329         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1330         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1331         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1332
  1333* DLO002
  1334 01  WS-DLO-INTERNAL-POLICY-FORM.
  1335     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1336     12  DIPF-RETURN-CODE          PIC XX.
  1337         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1338         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1339         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1340         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1341         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1342         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1343
  1344* DLO003
  1345 01  WS-DLO-VALID-BANK-ID.
  1346     12  DVBI-BANK-ID              PIC X(5).
  1347     12  DVBI-BANK-ID-TYPE         PIC X.
  1348         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1349         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1350         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1351         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1352         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1353     12  DVBI-RETURN-CODE          PIC XX.
  1354         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1355         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1356         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1357         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1358         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1359         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1360         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1361         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1362         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1363
  1364* DLO007
  1365 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1366     12  DCUA-RES-STATE            PIC XX.
  1367     12  DCUA-BEN-TYPE             PIC XX.
  1368     12  DCUA-SYS-IDENT            PIC X.
  1369         88  DCUA-CLAIM                        VALUE 'C'.
  1370         88  DCUA-PREMIUM                      VALUE 'P'.
  1371     12  DCUA-COVERAGE-RULE        PIC X.
  1372     12  DCUA-CLIENT-ID            PIC X(10).
  1373     12  DCUA-EFF-DATE             PIC X(8).
  1374     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1375     12  DCUA-RETURN-CODE          PIC XX.
  1376         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1377     12  DCUA-CERT-NUMBER          PIC X(11).
  1378     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1379     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1380
  1381* DLO011
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  26
* EL050.cbl
  1382 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1383     12  DPRB-RATE-CODE            PIC X(4).
  1384     12  DPRB-COVERAGE-CATEG       PIC X.
  1385     12  DPRB-RETURN-CODE          PIC XX.
  1386         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1387         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1388         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1389         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1390         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1391         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1392         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1393         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1394         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1395     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1396     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1397     12  DPRB-BEN-TYPE             PIC XX.
  1398
  1399* DLO017
  1400 01  WS-DLO-VALID-RATE-CODE.
  1401     12  DVRC-RATE-CODE            PIC X(4).
  1402     12  DVRC-RETURN-CODE          PIC XX.
  1403         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1404         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1405         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1406         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1407         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1408         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1409
  1410* DLO019
  1411 01  WS-DLO-ORIG-COV-CAT.
  1412     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1413     12  DOCC-RETURN-CODE          PIC XX.
  1414     12  DOCC-ORIG-COV-CAT         PIC X.
  1415     12  DOCC-UNDERWITER           PIC XX.
  1416     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1417     12  DOCC-FILLER               PIC X(6).
  1418
  1419* DLO021
  1420 01  WS-DLO-VALID-LOAN-OFFICER.
  1421     12  DVLO-LOAN-OFFICER.
  1422         16  DVLO-BILL-TYPE        PIC X.
  1423         16  DVLO-BILL-SOURCE      PIC X.
  1424         16  DVLO-BATCH-TYPE       PIC X.
  1425     12  DVLO-RETURN-CODE          PIC XX.
  1426         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1427         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1428         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1429         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1430         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1431         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1432
  1433* DLO022
  1434 01  WS-DLO-VALID-STATE-CODE.
  1435     12  DVSC-STATE-CODE           PIC XX.
  1436     12  DVSC-RETURN-CODE          PIC XX.
  1437         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1438
  1439* DLO023
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  27
* EL050.cbl
  1440 01  WS-DLO-VALID-CODE-VALUES.
  1441     12  DVCV-SYSTEM-ID            PIC XX.
  1442         88  DVCV-CLAIMS                       VALUE 'CL'.
  1443         88  DVCV-CREDIT                       VALUE 'CR'.
  1444     12  DVCV-RECORD-TYPE          PIC XX.
  1445         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1446         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1447         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1448         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1449         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1450         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1451         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1452         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1453     12  DVCV-RECORD-KEY           PIC X(6).
  1454     12  DVCV-RETURN-CODE          PIC XX.
  1455         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1456         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1457         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1458         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1459         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1460         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1461         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1462     12  DVCV-CODE-DESC            PIC X(60).
  1463     12  DVCV-GEN-DESC-1           PIC X(20).
  1464     12  DVCV-GEN-DESC-2           PIC X(20).
  1465     12  DVCV-GEN-DESC-3           PIC X(20).
  1466
  1467****  this is for aggregate report.
  1468****  Length is erpndb + 100 of passed-key-area
  1469 01  ws-passed-key-length        pic s9(4) comp value +587.
  1470 01  ws-pass-to-pemaggo.
  1471     05  ws-passed-erpndb        pic x(585).
  1472     05  ws-exceed-limit-yn      pic x.
  1473     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  28
* EL050.cbl
  1475*    COPY ERCBXRF.
  1476******************************************************************
  1477*                                                                *
  1478*                                                                *
  1479*                            ERCBXRF                             *
  1480*                                                                *
  1481*   ONLINE CREDIT SYSTEM                                         *
  1482*                                                                *
  1483*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1484*                                                                *
  1485*   FILE TYPE = VSAM,KSDS                                        *
  1486*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1487*                                                                *
  1488*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1489*       ALTERNATE PATH = NONE                                    *
  1490*                                                                *
  1491*   LOG = NO                                                     *
  1492*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1493*                                                                *
  1494******************************************************************
  1495
  1496 01  BANK-CROSS-REFERENCE.
  1497     12  BK-RECORD-ID                PIC XX.
  1498         88  VALID-BK-ID             VALUE 'BK'.
  1499
  1500     12  BK-CONTROL-PRIMARY.
  1501         16  BK-COMPANY-CD           PIC X.
  1502         16  BK-CARRIER              PIC X.
  1503         16  BK-GROUPING             PIC X(6).
  1504         16  BK-BANK-NO              PIC X(10).
  1505
  1506     12  BK-MAINT-INFORMATION.
  1507         16  BK-LAST-MAINT-DT        PIC XX.
  1508         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1509         16  BK-LAST-MAINT-USER      PIC X(4).
  1510         16  FILLER                  PIC X(9).
  1511
  1512     12  FILLER                      PIC X(37).
  1513
  1514     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1515
  1516     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1517                            DEPENDING ON BK-BANK-POINTER-CNT.
  1518         16  BK-AM-ACCOUNT           PIC X(10).
  1519         16  BK-AM-EXP-DT            PIC XX.
  1520         16  BK-AM-EFF-DT            PIC XX.
  1521         16  BK-AM-STATE             PIC XX.
  1522         16  FILLER                  PIC X(20).
  1523
  1524******************************************************************
  1525
  1526*    COPY ERCCOMP.
  1527******************************************************************
  1528*                                                                *
  1529*                                                                *
  1530*                            ERCCOMP                             *
  1531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1532*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  29
* EL050.cbl
  1533*                                                                *
  1534*   ONLINE CREDIT SYSTEM                                         *
  1535*                                                                *
  1536*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1537*                                                                *
  1538*   FILE TYPE = VSAM,KSDS                                        *
  1539*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1540*                                                                *
  1541*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1542*       ALTERNATE PATH = NONE                                    *
  1543*                                                                *
  1544*   LOG = NO                                                     *
  1545*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1546*                                                                *
  1547******************************************************************
  1548*                   C H A N G E   L O G
  1549*
  1550* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1551*-----------------------------------------------------------------
  1552*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1553* EFFECTIVE    NUMBER
  1554*-----------------------------------------------------------------
  1555* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1556* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1557* 092205    2005050300006  PEMA  ADD LEASE FEE
  1558* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1559* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1560* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1561* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1562* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1563* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1564******************************************************************
  1565
  1566 01  COMPENSATION-MASTER.
  1567     12  CO-RECORD-ID                          PIC XX.
  1568         88  VALID-CO-ID                          VALUE 'CO'.
  1569
  1570     12  CO-CONTROL-PRIMARY.
  1571         16  CO-COMPANY-CD                     PIC X.
  1572         16  CO-CONTROL.
  1573             20  CO-CTL-1.
  1574                 24  CO-CARR-GROUP.
  1575                     28  CO-CARRIER            PIC X.
  1576                     28  CO-GROUPING.
  1577                         32  CO-GROUP-PREFIX   PIC XXX.
  1578                         32  CO-GROUP-PRIME    PIC XXX.
  1579                 24  CO-RESP-NO.
  1580                     28  CO-RESP-PREFIX        PIC X(4).
  1581                     28  CO-RESP-PRIME         PIC X(6).
  1582             20  CO-CTL-2.
  1583                 24  CO-ACCOUNT.
  1584                     28  CO-ACCT-PREFIX        PIC X(4).
  1585                     28  CO-ACCT-PRIME         PIC X(6).
  1586         16  CO-TYPE                           PIC X.
  1587             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1588             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1589             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1590
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  30
* EL050.cbl
  1591     12  CO-MAINT-INFORMATION.
  1592         16  CO-LAST-MAINT-DT                  PIC XX.
  1593         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1594         16  CO-LAST-MAINT-USER                PIC X(4).
  1595     12  FILLER                                PIC XX.
  1596     12  CO-STMT-TYPE                          PIC XXX.
  1597     12  CO-COMP-TYPE                          PIC X.
  1598         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1599     12  CO-STMT-OWNER                         PIC X(4).
  1600     12  CO-BALANCE-CONTROL                    PIC X.
  1601         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1602         88  CO-NO-BALANCE                        VALUE 'N'.
  1603
  1604     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1605         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1606         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1607         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1608
  1609     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1610         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1611         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1612
  1613     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1614     12  CO-GA-DIRECT-DEP                      PIC X.
  1615     12  CO-FUTURE-SPACE                       PIC X.
  1616         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1617
  1618     12  CO-ACCT-NAME                          PIC X(30).
  1619     12  CO-MAIL-NAME                          PIC X(30).
  1620     12  CO-ADDR-1                             PIC X(30).
  1621     12  CO-ADDR-2                             PIC X(30).
  1622     12  CO-ADDR-3.
  1623         16  CO-ADDR-CITY                      PIC X(27).
  1624         16  CO-ADDR-STATE                     PIC XX.
  1625     12  CO-CSO-1099                           PIC X.
  1626     12  CO-ZIP.
  1627         16  CO-ZIP-PRIME.
  1628             20  CO-ZIP-PRI-1ST                PIC X.
  1629                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1630             20  FILLER                        PIC X(4).
  1631         16  CO-ZIP-PLUS4                      PIC X(4).
  1632     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1633         16  CO-CAN-POSTAL-1                   PIC XXX.
  1634         16  CO-CAN-POSTAL-2                   PIC XXX.
  1635         16  FILLER                            PIC XXX.
  1636     12  CO-SOC-SEC                            PIC X(13).
  1637     12  CO-TELEPHONE.
  1638         16  CO-AREA-CODE                      PIC XXX.
  1639         16  CO-PREFIX                         PIC XXX.
  1640         16  CO-PHONE                          PIC X(4).
  1641
  1642     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1643
  1644     12  CO-AR-BAL-LEVEL                       PIC X.
  1645         88  CO-AR-REF-LVL                        VALUE '1'.
  1646         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1647         88  CO-AR-BILL-LVL                       VALUE '2'.
  1648         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  31
* EL050.cbl
  1649         88  CO-AR-FR-LVL                         VALUE '4'.
  1650
  1651     12  CO-AR-NORMAL-PRINT                    PIC X.
  1652         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1653         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1654
  1655     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1656
  1657     12  CO-AR-REPORTING                       PIC X.
  1658         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1659         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1660
  1661     12  CO-AR-PULL-CHECK                      PIC X.
  1662         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1663         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1664
  1665     12  CO-AR-BALANCE-PRINT                   PIC X.
  1666         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1667
  1668     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1669         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1670         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1671         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1672
  1673     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1674
  1675     12  CO-USER-CODE                          PIC X.
  1676     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1677
  1678******************************************************************
  1679*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1680*    THE LAST MONTH END RUN.
  1681******************************************************************
  1682
  1683     12  CO-LAST-ACTIVITY-DATE.
  1684         16  CO-ACT-YEAR                       PIC 99.
  1685         16  CO-ACT-MONTH                      PIC 99.
  1686         16  CO-ACT-DAY                        PIC 99.
  1687
  1688     12  CO-LAST-STMT-DT.
  1689         16  CO-LAST-STMT-YEAR                 PIC 99.
  1690         16  CO-LAST-STMT-MONTH                PIC 99.
  1691         16  CO-LAST-STMT-DAY                  PIC 99.
  1692
  1693     12  CO-MO-END-TOTALS.
  1694         16  CO-MONTHLY-TOTALS.
  1695             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1696             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1697             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1698             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1699             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1700
  1701         16  CO-AGING-TOTALS.
  1702             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1703             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1704             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1705             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1706
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  32
* EL050.cbl
  1707         16  CO-YTD-TOTALS.
  1708             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1709             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1710
  1711         16  CO-OVER-UNDER-TOTALS.
  1712             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1713             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1714
  1715     12  CO-MISCELLANEOUS-TOTALS.
  1716         16  CO-FICA-TOTALS.
  1717             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1718             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1719
  1720         16  CO-CLAIM-TOTALS.
  1721             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1722             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1723
  1724******************************************************************
  1725*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1726*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1727******************************************************************
  1728
  1729     12  CO-CURRENT-TOTALS.
  1730         16  CO-CURRENT-LAST-STMT-DT.
  1731             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1732             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1733             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1734
  1735         16  CO-CURRENT-MONTHLY-TOTALS.
  1736             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1737             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1738             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1739             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1740             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1741
  1742         16  CO-CURRENT-AGING-TOTALS.
  1743             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1745             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1746             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1747
  1748         16  CO-CURRENT-YTD-TOTALS.
  1749             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1750             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1751
  1752     12  CO-PAID-COMM-TOTALS.
  1753         16  CO-YTD-PAID-COMMS.
  1754             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1755             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1756
  1757     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1758         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1759         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1760
  1761     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1762         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1763         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1764         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  33
* EL050.cbl
  1765         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1766         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1767         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1768         88  CO-FINAL-LETTER                  VALUE 'F'.
  1769         88  CO-RECONCILING                   VALUE 'R'.
  1770         88  CO-PHONE-CALL                    VALUE 'P'.
  1771         88  CO-LEGAL                         VALUE 'L'.
  1772         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1773         88  CO-WRITE-OFF                     VALUE 'W'.
  1774         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1775
  1776     12  CO-CSR-CODE                       PIC X(4).
  1777
  1778     12  CO-GA-STATUS-INFO.
  1779         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1780         16  CO-GA-TERMINATION-DT          PIC XX.
  1781         16  CO-GA-STATUS-CODE             PIC X.
  1782             88  CO-GA-ACTIVE                 VALUE 'A'.
  1783             88  CO-GA-INACTIVE               VALUE 'I'.
  1784             88  CO-GA-PENDING                VALUE 'P'.
  1785         16  CO-GA-COMMENTS.
  1786             20  CO-GA-COMMENT-1           PIC X(40).
  1787             20  CO-GA-COMMENT-2           PIC X(40).
  1788             20  CO-GA-COMMENT-3           PIC X(40).
  1789             20  CO-GA-COMMENT-4           PIC X(40).
  1790
  1791     12  CO-RPTCD2                         PIC X(10).
  1792     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1793         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1794         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1795
  1796     12  CO-TYPE-AGENT                     PIC X(01).
  1797         88  CO-CORPORATION                   VALUE 'C'.
  1798         88  CO-PARTNERSHIP                   VALUE 'P'.
  1799         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1800         88  CO-TRUST                         VALUE 'T'.
  1801         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1802
  1803     12  CO-FAXNO.
  1804         16  CO-FAX-AREA-CODE                  PIC XXX.
  1805         16  CO-FAX-PREFIX                     PIC XXX.
  1806         16  CO-FAX-PHONE                      PIC X(4).
  1807
  1808     12  CO-BANK-INFORMATION.
  1809         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1810         16  CO-BANK-TRANSIT-NON REDEFINES
  1811             CO-BANK-TRANSIT-NO                PIC 9(8).
  1812
  1813         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1814     12  CO-MISC-DEDUCT-INFO REDEFINES
  1815                  CO-BANK-INFORMATION.
  1816         16  CO-MD-GL-ACCT                     PIC X(10).
  1817         16  CO-MD-DIV                         PIC XX.
  1818         16  CO-MD-CENTER                      PIC X(4).
  1819         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1820         16  CO-CREATE-AP-CHECK                PIC X.
  1821         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1822         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  34
* EL050.cbl
  1823     12  CO-ACH-STATUS                         PIC X.
  1824         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1825         88  CO-ACH-PENDING                        VALUE 'P'.
  1826
  1827     12  CO-BILL-SW                            PIC X.
  1828     12  CO-CONTROL-NAME                       PIC X(30).
  1829     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1830     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1831     12  CO-CLP-STATE                          PIC XX.
  1832     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1833     12  CO-SPP-REFUND-EDIT                    PIC X.
  1834
  1835******************************************************************
  1836
  1837*    COPY ERCAGTC.
  1838******************************************************************
  1839*                                                                *
  1840*                                                                *
  1841*                            ERCAGTC                             *
  1842*                            VMOD=2.001                          *
  1843*                                                                *
  1844*   ONLINE CREDIT SYSTEM                                         *
  1845*                                                                *
  1846*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1847*                                                                *
  1848*   FILE TYPE = VSAM,KSDS                                        *
  1849*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1850*                                                                *
  1851*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1852*       ALTERNATE PATH = NONE                                    *
  1853*                                                                *
  1854*   LOG = NO                                                     *
  1855*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1856*                                                                *
  1857******************************************************************
  1858*                   C H A N G E   L O G
  1859*
  1860* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1861*-----------------------------------------------------------------
  1862*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1863* EFFECTIVE    NUMBER
  1864*-----------------------------------------------------------------
  1865* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1866* 111004                         NEW FILE AND COPYBOOK
  1867* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1868******************************************************************
  1869 01  AGENT-COMMISSIONS.
  1870     12  AG-RECORD-ID                          PIC XX.
  1871         88  VALID-CO-ID                          VALUE 'AG'.
  1872     12  AG-CONTROL-PRIMARY.
  1873         16  AG-COMPANY-CD                     PIC X.
  1874         16  AG-CONTROL.
  1875             20  AG-CTL-1.
  1876                 24  AG-CARR-GROUP.
  1877                     28  AG-CARRIER            PIC X.
  1878                     28  AG-GROUPING           PIC X(6).
  1879                 24  AG-BANK                   PIC X(10).
  1880             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  35
* EL050.cbl
  1881                 24  AG-EXP-DT                 PIC XX.
  1882         16  AG-TYPE                           PIC X.
  1883             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1884             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1885     12  AG-MAINT-INFORMATION.
  1886         16  AG-LAST-MAINT-DT                  PIC XX.
  1887         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1888         16  AG-LAST-MAINT-USER                PIC X(4).
  1889         16  FILLER                            PIC X(10).
  1890     12  AG-EFF-DT                             PIC XX.
  1891     12  AG-COMM-STRUCTURE.
  1892         16  AG-AGT-COMMS OCCURS 10.
  1893             20  AG-AGT                PIC X(10).
  1894             20  AG-COM-TYP            PIC X.
  1895             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1896             20  AG-RECALC-LV-INDIC    PIC X.
  1897             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1898             20  AG-LRCALC-LV-INDIC    PIC X.
  1899             20  FILLER                PIC X(05).
  1900     12  FILLER                  PIC X(145).
  1901******************************************************************
  1902*    COPY ERCRESS.
  1903******************************************************************
  1904*                                                                *
  1905*                            ERCRESS                             *
  1906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1907*                            VMOD=2.002                          *
  1908*                                                                *
  1909*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1910*                                                                *
  1911*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1912*   VSAM RESIDENT STATE TAX MASTER                              *
  1913*                                                                *
  1914*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1915*                                                                *
  1916*   FILE TYPE = VSAM,KSDS                                        *
  1917*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1918*                                                                *
  1919*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1920*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1921*                                                                *
  1922*   LOG = NO                                                     *
  1923*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1924*                                                                *
  1925*                                                                *
  1926******************************************************************
  1927
  1928 01  RESIDENT-STATE-TAX-MASTER.
  1929
  1930     10  ERRESS-PRIMARY-KEY.
  1931         15  RES-COMPANY-CD        PIC X.
  1932         15  RES-RESIDENT-STATE    PIC XX.
  1933         15  RES-COVERAGE-CATEGORY PIC X.
  1934         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1935*                                      YYYYMMDD
  1936*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1937
  1938     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  36
* EL050.cbl
  1939
  1940         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1941         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1942         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1943         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1944
  1945     10 RES-RECALC-SW              PIC   X.
  1946         88 RECALC                VALUE 'Y'.
  1947         88 NO-RECALC             VALUE 'N'.
  1948     10  RES-MAINT-BY              PIC X(4).
  1949     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1950     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1951*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  37
* EL050.cbl
  1953*    COPY ERCRESC.
  1954******************************************************************
  1955*                                                                *
  1956*                            ERCRESC                             *
  1957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1958*                            VMOD=2.003                          *
  1959*                                                                *
  1960*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1961*                                                                *
  1962*   FILE TYPE = VSAM,KSDS                                        *
  1963*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1964*                                                                *
  1965*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1966*       ALTERNATE PATH1 = NONE                                   *
  1967*                                                                *
  1968*   LOG = NO                                                     *
  1969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1970*                                                                *
  1971******************************************************************
  1972
  1973 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1974
  1975     10  ERRESC-RECORD-KEY.
  1976         15  RESC-COMPANY-CD           PIC   X.
  1977         15  RESC-CARRIER              PIC   X.
  1978         15  RESC-GROUP                PIC   X(6).
  1979         15  RESC-STATE                PIC   XX.
  1980         15  RESC-ACCOUNT              PIC   X(10).
  1981         15  RESC-AGENT                PIC   X(10).
  1982         15  RESC-RESIDENT-STATE       PIC   XX.
  1983         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1984*                                           YYYYMMDD
  1985     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1986
  1987     10  RESC-COMM-RECORD-DATA.
  1988         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1989             20 RESC-COVERAGE-CAT      PIC    X.
  1990             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1991             20 RESC-COMMISSION-TAB REDEFINES
  1992                RESC-COMMISSION-PER    PIC  XXX.
  1993
  1994     10  RESC-MAINT-BY                 PIC X(4).
  1995     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1996     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1997*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  38
* EL050.cbl
  1999*    COPY ERCPLAN.
  2000******************************************************************
  2001*                                                                *
  2002*                                                                *
  2003*                            ERCPLAN                             *
  2004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2005*                            VMOD=2.003                          *
  2006*                                                                *
  2007*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2008*                                                                *
  2009*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2010*   PLAN MASTER                                                  *
  2011*                                                                *
  2012*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2013*                                                                *
  2014*   FILE TYPE = VSAM,KSDS                                        *
  2015*   RECORD SIZE = 420   RECFORM = FIX                            *
  2016*                                                                *
  2017*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2018*       ALTERNATE PATH1 = N/A                                    *
  2019*                                                                *
  2020*   LOG = NO                                                     *
  2021*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2022*                                                                *
  2023*                                                                *
  2024******************************************************************
  2025
  2026 01  PLAN-MASTER.
  2027     12  PL-RECORD-ID                      PIC XX.
  2028         88  VALID-PL-ID                      VALUE 'PL'.
  2029
  2030     12  PL-CONTROL-PRIMARY.
  2031         16  PL-COMPANY-CD                 PIC X.
  2032         16  PL-MSTR-CNTRL.
  2033             20  PL-CONTROL-A.
  2034                 24  PL-CARRIER            PIC X.
  2035                 24  PL-GROUPING           PIC X(6).
  2036                 24  PL-STATE              PIC XX.
  2037                 24  PL-ACCOUNT            PIC X(10).
  2038             20  PL-BENEFIT-TYPE           PIC X.
  2039             20  PL-BENEFIT-CODE           PIC XX.
  2040             20  PL-REVISION-NO            PIC X(3).
  2041
  2042     12  PL-CONTROL-BY-VAR-GRP.
  2043         16  PL-COMPANY-CD-A1              PIC X.
  2044         16  PL-VG-CARRIER                 PIC X.
  2045         16  PL-VG-GROUPING                PIC X(6).
  2046         16  PL-VG-STATE                   PIC XX.
  2047         16  PL-VG-ACCOUNT                 PIC X(10).
  2048         16  PL-BENEFIT-TYPE-A1            PIC X.
  2049         16  PL-BENEFIT-CODE-A1            PIC XX.
  2050         16  PL-REVISION-NO-A1             PIC 999.
  2051
  2052     12  PL-MAINT-INFORMATION.
  2053         16  PL-LAST-MAINT-DT              PIC XX.
  2054         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2055         16  PL-LAST-MAINT-USER            PIC X(4).
  2056         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  39
* EL050.cbl
  2057
  2058     12  PL-LIABILITY-LIMITS.
  2059         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2060         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2061             20  PL-LM-AGE                 PIC S99        COMP-3.
  2062             20  PL-LM-DUR                 PIC S999       COMP-3.
  2063             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2064             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2065
  2066     12  FILLER                            PIC X(30).
  2067
  2068     12  PL-GL-ACCOUNT-NOS.
  2069         16  PL-PREMIUM-GL                 PIC X(8).
  2070         16  PL-COMM-GL                    PIC X(8).
  2071         16  PL-CLAIM-GL                   PIC X(8).
  2072     12  FILLER                            PIC X(24).
  2073     12  PL-TOLERANCES.
  2074         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2075         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2076         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2077         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2078         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2079         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2080     12  PL-OVER-SHORT.
  2081         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2082         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2083     12  FILLER                            PIC X(24).
  2084     12  PLAN-MISC.
  2085         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2086         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2087         16  PL-IG                         PIC X.
  2088         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2089         16  PL-POLICY-FORM                PIC X(12).
  2090         16  PL-EDIT-FOR-FORM              PIC X(01).
  2091         16  PL-DEV-CODE                   PIC XXX.
  2092         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2093         16  PL-CALC-METHOD                PIC X.
  2094         16  PL-BENEFIT-GROUP              PIC X(05).
  2095         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2096
  2097         16  FILLER                        PIC X(99).
  2098******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  40
* EL050.cbl
  2100*    COPY ELCCERT.
  2101******************************************************************
  2102*                                                                *
  2103*                            ELCCERT.                            *
  2104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2105*                            VMOD=2.013                          *
  2106*                                                                *
  2107*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2108*                                                                *
  2109*   FILE TYPE = VSAM,KSDS                                        *
  2110*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2111*                                                                *
  2112*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2113*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2114*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2115*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2116*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2117*                                                                *
  2118*   LOG = YES                                                    *
  2119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2120******************************************************************
  2121*                   C H A N G E   L O G
  2122*
  2123* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2124*-----------------------------------------------------------------
  2125*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2126* EFFECTIVE    NUMBER
  2127*-----------------------------------------------------------------
  2128* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2129* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2130* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2131* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2132* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2133* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2134* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2135* 032612  CR2011110200001  PEMA  AHL CHANGES
  2136* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2137******************************************************************
  2138
  2139 01  CERTIFICATE-MASTER.
  2140     12  CM-RECORD-ID                      PIC XX.
  2141         88  VALID-CM-ID                      VALUE 'CM'.
  2142
  2143     12  CM-CONTROL-PRIMARY.
  2144         16  CM-COMPANY-CD                 PIC X.
  2145         16  CM-CARRIER                    PIC X.
  2146         16  CM-GROUPING.
  2147             20  CM-GROUPING-PREFIX        PIC X(3).
  2148             20  CM-GROUPING-PRIME         PIC X(3).
  2149         16  CM-STATE                      PIC XX.
  2150         16  CM-ACCOUNT.
  2151             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2152             20  CM-ACCOUNT-PRIME          PIC X(6).
  2153         16  CM-CERT-EFF-DT                PIC XX.
  2154         16  CM-CERT-NO.
  2155             20  CM-CERT-PRIME             PIC X(10).
  2156             20  CM-CERT-SFX               PIC X.
  2157
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  41
* EL050.cbl
  2158     12  CM-CONTROL-BY-NAME.
  2159         16  CM-COMPANY-CD-A1              PIC X.
  2160         16  CM-INSURED-LAST-NAME          PIC X(15).
  2161         16  CM-INSURED-INITIALS.
  2162             20  CM-INSURED-INITIAL1       PIC X.
  2163             20  CM-INSURED-INITIAL2       PIC X.
  2164
  2165     12  CM-CONTROL-BY-SSN.
  2166         16  CM-COMPANY-CD-A2              PIC X.
  2167         16  CM-SOC-SEC-NO.
  2168             20  CM-SSN-STATE              PIC XX.
  2169             20  CM-SSN-ACCOUNT            PIC X(6).
  2170             20  CM-SSN-LN3.
  2171                 25  CM-INSURED-INITIALS-A2.
  2172                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2173                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2174                 25 CM-PART-LAST-NAME-A2         PIC X.
  2175
  2176     12  CM-CONTROL-BY-CERT-NO.
  2177         16  CM-COMPANY-CD-A4              PIC X.
  2178         16  CM-CERT-NO-A4                 PIC X(11).
  2179
  2180     12  CM-CONTROL-BY-MEMB.
  2181         16  CM-COMPANY-CD-A5              PIC X.
  2182         16  CM-MEMBER-NO.
  2183             20  CM-MEMB-STATE             PIC XX.
  2184             20  CM-MEMB-ACCOUNT           PIC X(6).
  2185             20  CM-MEMB-LN4.
  2186                 25  CM-INSURED-INITIALS-A5.
  2187                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2188                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2189                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2190
  2191     12  CM-INSURED-PROFILE-DATA.
  2192         16  CM-INSURED-FIRST-NAME.
  2193             20  CM-INSURED-1ST-INIT       PIC X.
  2194             20  FILLER                    PIC X(9).
  2195         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2196         16  CM-INSURED-SEX                PIC X.
  2197             88  CM-SEX-MALE                  VALUE 'M'.
  2198             88  CM-SEX-FEMAL                 VALUE 'F'.
  2199         16  CM-INSURED-JOINT-AGE          PIC 99.
  2200         16  CM-JOINT-INSURED-NAME.
  2201             20  CM-JT-LAST-NAME           PIC X(15).
  2202             20  CM-JT-FIRST-NAME.
  2203                 24  CM-JT-1ST-INIT        PIC X.
  2204                 24  FILLER                PIC X(9).
  2205             20  CM-JT-INITIAL             PIC X.
  2206
  2207     12  CM-LIFE-DATA.
  2208         16  CM-LF-BENEFIT-CD              PIC XX.
  2209         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2210         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2211         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2212         16  CM-LF-DEV-CODE                PIC XXX.
  2213         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2214         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2215         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  42
* EL050.cbl
  2216         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2217         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2218         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2219         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2220         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2221         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2222         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2223         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2224         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2225         16  cm-temp-epiq                  pic xx.
  2226             88  EPIQ-CLASS                  value 'EQ'.
  2227*        16  FILLER                        PIC XX.
  2228
  2229     12  CM-AH-DATA.
  2230         16  CM-AH-BENEFIT-CD              PIC XX.
  2231         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2232         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2233         16  CM-AH-DEV-CODE                PIC XXX.
  2234         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2235         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2236         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2237         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2238         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2239         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2240         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2241         16  CM-AH-PAID-THRU-DT            PIC XX.
  2242             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2243         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2244         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2245         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2246         16  FILLER                        PIC X.
  2247
  2248     12  CM-LOAN-INFORMATION.
  2249         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2250         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2251                                           PIC S9(5)V99  COMP-3.
  2252         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2253         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2254         16  CM-PAY-FREQUENCY              PIC S99.
  2255         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2256         16  CM-RATE-CLASS                 PIC XX.
  2257         16  CM-BENEFICIARY                PIC X(25).
  2258         16  CM-POLICY-FORM-NO             PIC X(12).
  2259         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2260         16  CM-LAST-ADD-ON-DT             PIC XX.
  2261         16  CM-DEDUCTIBLE-AMOUNTS.
  2262             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2263             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2264         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2265             20  CM-RESIDENT-STATE         PIC XX.
  2266             20  CM-RATE-CODE              PIC X(4).
  2267             20  FILLER                    PIC XX.
  2268         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2269             20  CM-LOAN-OFFICER           PIC X(5).
  2270             20  FILLER                    PIC XXX.
  2271         16  CM-CSR-CODE                   PIC XXX.
  2272         16  CM-UNDERWRITING-CODE          PIC X.
  2273             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  43
* EL050.cbl
  2274         16  CM-POST-CARD-IND              PIC X.
  2275         16  CM-NH-INTERFACE-SW            PIC X.
  2276         16  CM-PREMIUM-TYPE               PIC X.
  2277             88  CM-SING-PRM                  VALUE '1'.
  2278             88  CM-O-B-COVERAGE              VALUE '2'.
  2279             88  CM-OPEN-END                  VALUE '3'.
  2280         16  CM-IND-GRP-TYPE               PIC X.
  2281             88  CM-INDIVIDUAL                VALUE 'I'.
  2282             88  CM-GROUP                     VALUE 'G'.
  2283         16  CM-SKIP-CODE                  PIC X.
  2284             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2285             88  SKIP-JULY                    VALUE '1'.
  2286             88  SKIP-AUGUST                  VALUE '2'.
  2287             88  SKIP-SEPTEMBER               VALUE '3'.
  2288             88  SKIP-JULY-AUG                VALUE '4'.
  2289             88  SKIP-AUG-SEPT                VALUE '5'.
  2290             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2291             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2292             88  SKIP-JUNE                    VALUE '8'.
  2293             88  SKIP-JUNE-JULY               VALUE '9'.
  2294             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2295             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2296         16  CM-PAYMENT-MODE               PIC X.
  2297             88  PAY-MONTHLY                  VALUE SPACE.
  2298             88  PAY-WEEKLY                   VALUE '1'.
  2299             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2300             88  PAY-BI-WEEKLY                VALUE '3'.
  2301             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2302         16  CM-LOAN-NUMBER                PIC X(8).
  2303         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2304         16  CM-OLD-LOF                    PIC XXX.
  2305*        16  CM-LOAN-OFFICER               PIC XXX.
  2306         16  CM-REIN-TABLE                 PIC XXX.
  2307         16  CM-SPECIAL-REIN-CODE          PIC X.
  2308         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2309         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2310         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2311
  2312     12  CM-STATUS-DATA.
  2313         16  CM-ENTRY-STATUS               PIC X.
  2314         16  CM-ENTRY-DT                   PIC XX.
  2315
  2316         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2317         16  CM-LF-CANCEL-DT               PIC XX.
  2318         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2319
  2320         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2321         16  CM-LF-DEATH-DT                PIC XX.
  2322         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2323
  2324         16  CM-LF-CURRENT-STATUS          PIC X.
  2325             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2326                                                'M' '4' '5' '9'.
  2327             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2328             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2329             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2330             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2331             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  44
* EL050.cbl
  2332             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2333             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2334             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2335             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2336             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2337             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2338             88  CM-LF-DECLINED               VALUE 'D'.
  2339             88  CM-LF-VOIDED                 VALUE 'V'.
  2340
  2341         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2342         16  CM-AH-CANCEL-DT               PIC XX.
  2343         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2344
  2345         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2346         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2347         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2348
  2349         16  CM-AH-CURRENT-STATUS          PIC X.
  2350             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2351                                                'M' '4' '5' '9'.
  2352             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2353             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2354             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2355             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2356             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2357             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2358             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2359             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2360             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2361             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2362             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2363             88  CM-AH-DECLINED               VALUE 'D'.
  2364             88  CM-AH-VOIDED                 VALUE 'V'.
  2365
  2366         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2367             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2368             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2369             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2370         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2371
  2372         16  CM-ENTRY-BATCH                PIC X(6).
  2373         16  CM-LF-EXIT-BATCH              PIC X(6).
  2374         16  CM-AH-EXIT-BATCH              PIC X(6).
  2375         16  CM-LAST-MONTH-END             PIC XX.
  2376
  2377     12  CM-NOTE-SW                        PIC X.
  2378         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2379         88  CERT-NOTES-PRESENT               VALUE '1'.
  2380         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2381         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2382         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2383         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2384         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2385         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2386     12  CM-COMP-EXCP-SW                   PIC X.
  2387         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2388         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2389     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  45
* EL050.cbl
  2390         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2391         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2392
  2393*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2394     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2395     12  FILLER                            PIC X.
  2396
  2397*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2398     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2399     12  FILLER                            PIC X.
  2400*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2401     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2402
  2403     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2404         88  CERT-ADDED-BATCH                 VALUE ' '.
  2405         88  CERT-ADDED-ONLINE                VALUE '1'.
  2406         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2407         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2408         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2409     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2410         88  CERT-AS-LOADED                   VALUE ' '.
  2411         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2412         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2413         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2414         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2415         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2416         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2417         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2418
  2419     12  CM-ACCOUNT-COMM-PCTS.
  2420         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2421         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2422
  2423     12  CM-USER-FIELD                     PIC X.
  2424     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2425     12  CM-CLP-STATE                      PIC XX.
  2426     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2427     12  CM-USER-RESERVED                  PIC XXX.
  2428     12  FILLER REDEFINES CM-USER-RESERVED.
  2429         16  CM-AH-CLASS-CD                PIC XX.
  2430         16  F                             PIC X.
  2431******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  46
* EL050.cbl
  2433*    COPY ERCMAIL.
  2434******************************************************************
  2435*                                                                *
  2436*                                                                *
  2437*                            ERCMAIL                             *
  2438*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2439*                            VMOD=2.003                          *
  2440*                                                                *
  2441*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2442*                                                                *
  2443*   FILE TYPE = VSAM,KSDS                                        *
  2444*   RECORD SIZE = 374   RECFORM = FIX                            *
  2445*                                                                *
  2446*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2447*   ALTERNATE PATH    = NOT USED                                 *
  2448*                                                                *
  2449*   LOG = YES                                                    *
  2450*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2451******************************************************************
  2452*                   C H A N G E   L O G
  2453*
  2454* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2455*-----------------------------------------------------------------
  2456*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2457* EFFECTIVE    NUMBER
  2458*-----------------------------------------------------------------
  2459* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2460* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2461* 111108                   PEMA  ADD CRED BENE ADDR2
  2462******************************************************************
  2463
  2464 01  MAILING-DATA.
  2465     12  MA-RECORD-ID                      PIC XX.
  2466         88  VALID-MA-ID                       VALUE 'MA'.
  2467
  2468     12  MA-CONTROL-PRIMARY.
  2469         16  MA-COMPANY-CD                 PIC X.
  2470         16  MA-CARRIER                    PIC X.
  2471         16  MA-GROUPING.
  2472             20  MA-GROUPING-PREFIX        PIC XXX.
  2473             20  MA-GROUPING-PRIME         PIC XXX.
  2474         16  MA-STATE                      PIC XX.
  2475         16  MA-ACCOUNT.
  2476             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2477             20  MA-ACCOUNT-PRIME          PIC X(6).
  2478         16  MA-CERT-EFF-DT                PIC XX.
  2479         16  MA-CERT-NO.
  2480             20  MA-CERT-PRIME             PIC X(10).
  2481             20  MA-CERT-SFX               PIC X.
  2482
  2483     12  FILLER                            PIC XX.
  2484
  2485     12  MA-ACCESS-CONTROL.
  2486         16  MA-SOURCE-SYSTEM              PIC XX.
  2487             88  MA-FROM-CREDIT                VALUE 'CR'.
  2488             88  MA-FROM-VSI                   VALUE 'VS'.
  2489             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2490             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  47
* EL050.cbl
  2491         16  MA-RECORD-ADD-DT              PIC XX.
  2492         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2493         16  MA-LAST-MAINT-DT              PIC XX.
  2494         16  MA-LAST-MAINT-BY              PIC XXXX.
  2495         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2496
  2497     12  MA-PROFILE-INFO.
  2498         16  MA-QUALIFY-CODE-1             PIC XX.
  2499         16  MA-QUALIFY-CODE-2             PIC XX.
  2500         16  MA-QUALIFY-CODE-3             PIC XX.
  2501         16  MA-QUALIFY-CODE-4             PIC XX.
  2502         16  MA-QUALIFY-CODE-5             PIC XX.
  2503
  2504         16  MA-INSURED-LAST-NAME          PIC X(15).
  2505         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2506         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2507         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2508         16  MA-INSURED-BIRTH-DT           PIC XX.
  2509         16  MA-INSURED-SEX                PIC X.
  2510             88  MA-SEX-MALE                   VALUE 'M'.
  2511             88  MA-SEX-FEMALE                 VALUE 'F'.
  2512         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2513
  2514         16  MA-ADDRESS-CORRECTED          PIC X.
  2515         16  MA-JOINT-BIRTH-DT             PIC XX.
  2516*        16  FILLER                        PIC X(12).
  2517
  2518         16  MA-ADDRESS-LINE-1             PIC X(30).
  2519         16  MA-ADDRESS-LINE-2             PIC X(30).
  2520         16  MA-CITY-STATE.
  2521             20  MA-CITY                   PIC X(28).
  2522             20  MA-ADDR-STATE             PIC XX.
  2523         16  MA-ZIP.
  2524             20  MA-ZIP-CODE.
  2525                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2526                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2527                 24  FILLER                PIC X(4).
  2528             20  MA-ZIP-PLUS4              PIC X(4).
  2529         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2530             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2531             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2532             20  FILLER                    PIC X(3).
  2533
  2534         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2535
  2536         16  FILLER                        PIC XXX.
  2537*        16  FILLER                        PIC X(10).
  2538
  2539     12  MA-CRED-BENE-INFO.
  2540         16  MA-CRED-BENE-NAME                 PIC X(25).
  2541         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2542         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2543         16  MA-CRED-BENE-CTYST.
  2544             20  MA-CRED-BENE-CITY             PIC X(28).
  2545             20  MA-CRED-BENE-STATE            PIC XX.
  2546         16  MA-CRED-BENE-ZIP.
  2547             20  MA-CB-ZIP-CODE.
  2548                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  48
* EL050.cbl
  2549                     88  MA-CB-CANADIAN-POST-CODE
  2550                                           VALUE 'A' THRU 'Z'.
  2551                 24  FILLER                    PIC X(4).
  2552             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2553         16  MA-CB-CANADIAN-POSTAL-CODE
  2554                            REDEFINES MA-CRED-BENE-ZIP.
  2555             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2556             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2557             20  FILLER                        PIC X(3).
  2558     12  MA-POST-CARD-MAIL-DATA.
  2559         16  MA-MAIL-DATA OCCURS 7.
  2560             20  MA-MAIL-TYPE              PIC X.
  2561                 88  MA-12MO-MAILING           VALUE '1'.
  2562                 88  MA-EXP-MAILING            VALUE '2'.
  2563             20  MA-MAIL-STATUS            PIC X.
  2564                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2565                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2566                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2567             20  MA-MAIL-DATE              PIC XX.
  2568     12  FILLER                            PIC XX.
  2569     12  FILLER                            PIC XX.
  2570*    12  FILLER                            PIC X(30).
  2571******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  49
* EL050.cbl
  2573*    COPY ERCPNDM.
  2574******************************************************************
  2575*                                                                *
  2576*                                                                *
  2577*                            ERCPNDM                             *
  2578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2579*                            VMOD=2.003                          *
  2580*                                                                *
  2581*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2582*                                                                *
  2583*   FILE TYPE = VSAM,KSDS                                        *
  2584*   RECORD SIZE = 374   RECFORM = FIX                            *
  2585*                                                                *
  2586*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2587*   ALTERNATE PATH    = NOT USED                                 *
  2588*                                                                *
  2589*   LOG = YES                                                    *
  2590*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2591******************************************************************
  2592*                   C H A N G E   L O G
  2593*
  2594* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2595*-----------------------------------------------------------------
  2596*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2597* EFFECTIVE    NUMBER
  2598*-----------------------------------------------------------------
  2599* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2600* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2601* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2602******************************************************************
  2603
  2604 01  PENDING-MAILING-DATA.
  2605     12  PM-RECORD-ID                      PIC XX.
  2606         88  VALID-MA-ID                       VALUE 'PM'.
  2607
  2608     12  PM-CONTROL-PRIMARY.
  2609         16  PM-COMPANY-CD                 PIC X.
  2610         16  PM-ENTRY-BATCH                PIC X(6).
  2611         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2612         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2613
  2614     12  FILLER                            PIC X(14).
  2615
  2616     12  PM-ACCESS-CONTROL.
  2617         16  PM-SOURCE-SYSTEM              PIC XX.
  2618             88  PM-FROM-CREDIT                VALUE 'CR'.
  2619             88  PM-FROM-VSI                   VALUE 'VS'.
  2620             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2621             88  PM-FROM-OTHER                 VALUE 'OT'.
  2622         16  PM-RECORD-ADD-DT              PIC XX.
  2623         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2624         16  PM-LAST-MAINT-DT              PIC XX.
  2625         16  PM-LAST-MAINT-BY              PIC XXXX.
  2626         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2627
  2628     12  PM-PROFILE-INFO.
  2629         16  PM-QUALIFY-CODE-1             PIC XX.
  2630         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  50
* EL050.cbl
  2631         16  PM-QUALIFY-CODE-3             PIC XX.
  2632         16  PM-QUALIFY-CODE-4             PIC XX.
  2633         16  PM-QUALIFY-CODE-5             PIC XX.
  2634
  2635         16  PM-INSURED-LAST-NAME          PIC X(15).
  2636         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2637         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2638         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2639         16  PM-INSURED-BIRTH-DT           PIC XX.
  2640         16  PM-INSURED-SEX                PIC X.
  2641             88  PM-SEX-MALE                   VALUE 'M'.
  2642             88  PM-SEX-FEMALE                 VALUE 'F'.
  2643         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2644
  2645         16  PM-ADDRESS-CORRECTED          PIC X.
  2646         16  PM-JOINT-BIRTH-DT             PIC XX.
  2647*        16  FILLER                        PIC X(12).
  2648
  2649         16  PM-ADDRESS-LINE-1             PIC X(30).
  2650         16  PM-ADDRESS-LINE-2             PIC X(30).
  2651         16  PM-CITY-STATE.
  2652             20  PM-CITY                   PIC X(28).
  2653             20  PM-STATE                  PIC XX.
  2654         16  PM-ZIP.
  2655             20  PM-ZIP-CODE.
  2656                 24  PM-ZIP-1              PIC X.
  2657                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2658                 24  FILLER                PIC X(4).
  2659             20  PM-ZIP-PLUS4              PIC X(4).
  2660         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2661             20  PM-CAN-POST1              PIC XXX.
  2662             20  PM-CAN-POST2              PIC XXX.
  2663             20  FILLER                    PIC XXX.
  2664
  2665         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2666
  2667         16  FILLER                        PIC X(03).
  2668
  2669     12  PM-CRED-BENE-INFO.
  2670         16  PM-CRED-BENE-NAME             PIC X(25).
  2671         16  PM-CRED-BENE-ADDR             PIC X(30).
  2672         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2673         16  PM-CRED-BENE-CTYST.
  2674             20  PM-CRED-BENE-CITY         PIC X(28).
  2675             20  PM-CRED-BENE-STATE        PIC XX.
  2676         16  PM-CRED-BENE-ZIP.
  2677             20  PM-CB-ZIP-CODE.
  2678                 24  PM-CB-ZIP-1           PIC X.
  2679                     88  PM-CB-CANADIAN-POST-CODE
  2680                                  VALUE 'A' THRU 'Z'.
  2681                 24  FILLER                PIC X(4).
  2682             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2683         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2684             20  PM-CB-CAN-POST1           PIC XXX.
  2685             20  PM-CB-CAN-POST2           PIC XXX.
  2686             20  FILLER                    PIC XXX.
  2687     12  PM-POST-CARD-MAIL-DATA.
  2688         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  51
* EL050.cbl
  2689             20  PM-MAIL-TYPE              PIC X.
  2690                 88  PM-12MO-MAILING           VALUE '1'.
  2691                 88  PM-EXP-MAILING            VALUE '2'.
  2692             20  PM-MAIL-STATUS            PIC X.
  2693                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2694                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2695                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2696             20  PM-MAIL-DATE              PIC XX.
  2697     12  FILLER                            PIC XX.
  2698     12  FILLER                            PIC X(12).
  2699*    12  FILLER                            PIC X(30).
  2700
  2701******************************************************************
  2702*                                COPY ERCLOFC.
  2703******************************************************************
  2704*                                                                *
  2705*                                                                *
  2706*                            ERCLOFC                             *
  2707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2708*                            VMOD=2.003                          *
  2709*                                                                *
  2710*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2711*                                                                *
  2712*   FILE TYPE = VSAM,KSDS                                        *
  2713*   RECORD SIZE = 670   RECFORM = FIX                            *
  2714*                                                                *
  2715*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2716*                                                                *
  2717*   LOG = YES                                                    *
  2718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2719*                                                                *
  2720******************************************************************
  2721
  2722 01  LOAN-OFFICER-MASTER.
  2723     12  LO-RECORD-ID                PIC XX.
  2724         88  VALID-LO-ID                VALUE 'LO'.
  2725
  2726     12  LO-CONTROL-PRIMARY.
  2727         16  LO-COMPANY-CD           PIC X.
  2728         16  LO-CARRIER              PIC X.
  2729         16  LO-GROUPING.
  2730             20  LO-GROUPING-PREFIX  PIC XXX.
  2731             20  LO-GROUPING-PRIME   PIC XXX.
  2732         16  LO-STATE                PIC XX.
  2733         16  LO-ACCOUNT.
  2734             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2735             20  LO-ACCOUNT-PRIME    PIC X(6).
  2736         16  LO-OFFICER-CODE         PIC X(5).
  2737
  2738     12  LO-OFFICER-NAME             PIC X(30).
  2739
  2740     12  LO-LAST-MAINT-DT            PIC XX.
  2741     12  LO-LAST-USER                PIC X(4).
  2742     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2743
  2744     12  LO-COMP-CONTROL             PIC X.
  2745             88  LO-SHOW-COMP           VALUE 'Y'.
  2746             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  52
* EL050.cbl
  2747     12  LO-DETAIL-CONTROL           PIC X.
  2748             88  LO-PRINT-DETAIL        VALUE 'D'.
  2749             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2750
  2751     12  LO-SV-CARRIER               PIC X.
  2752     12  LO-SV-GROUPING              PIC X(6).
  2753     12  LO-SV-STATE                 PIC XX.
  2754
  2755     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2756     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2757
  2758     12  LO-OFFICER-INFO.
  2759         16  FILLER OCCURS 12 TIMES.
  2760             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2761             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2762             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2763             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2764             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2765             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2766             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2767             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2768     12  FILLER                      PIC X(198).
  2769******************************************************************
  2770*                                COPY ERCPDEF.
  2771******************************************************************
  2772*                                                                *
  2773*                                                                *
  2774*                            ERCPDEF.                            *
  2775*                                                                *
  2776*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2777*                                                                *
  2778*    FILE TYPE = VSAM,KSDS                                       *
  2779*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2780*                                                                *
  2781*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2782*                                                                *
  2783*    LOG = YES                                                   *
  2784*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2785******************************************************************
  2786*                   C H A N G E   L O G
  2787*
  2788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2789*-----------------------------------------------------------------
  2790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2791* EFFECTIVE    NUMBER
  2792*-----------------------------------------------------------------
  2793* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2794* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2795* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2796******************************************************************
  2797 01  PRODUCT-MASTER.
  2798    12  PD-RECORD-ID                 PIC X(02).
  2799        88  VALID-PD-ID                  VALUE 'PD'.
  2800    12  PD-CONTROL-PRIMARY.
  2801        16  PD-COMPANY-CD            PIC X.
  2802        16  PD-STATE                 PIC XX.
  2803        16  PD-PRODUCT-CD            PIC XXX.
  2804        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  53
* EL050.cbl
  2805        16  PD-BEN-TYPE              PIC X.
  2806        16  PD-BEN-CODE              PIC XX.
  2807        16  PD-PROD-EXP-DT           PIC XX.
  2808    12  FILLER                       PIC X(50).
  2809    12  PD-PRODUCT-DATA OCCURS 8.
  2810        16  PD-PROD-CODE             PIC X.
  2811            88  PD-PROD-LIFE           VALUE 'L'.
  2812            88  PD-PROD-PROP           VALUE 'P'.
  2813            88  PD-PROD-AH             VALUE 'A'.
  2814            88  PD-PROD-IU             VALUE 'I'.
  2815            88  PD-PROD-GAP            VALUE 'G'.
  2816            88  PD-PROD-FAML           VALUE 'F'.
  2817        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2818        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2819        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2820        16  PD-MAX-TERM              PIC S999        COMP-3.
  2821        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2822        16  FILLER                   PIC X.
  2823        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2824        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2825        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2826        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2827        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2828        16  PD-REC-CRIT-PERIOD       PIC 99.
  2829        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2830            20  PD-RECURRING-YN      PIC X.
  2831            20  FILLER               PIC X.
  2832        16  PD-RTW-MOS               PIC 99.
  2833        16  PD-MAX-EXTENSION         PIC 99.
  2834        16  pd-ben-pct               pic sv999 comp-3.
  2835*       16  FILLER                   PIC XX.
  2836    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2837    12  PD-TERM-LIMITS OCCURS 15.
  2838        16  PD-LOW-TERM              PIC S999        COMP-3.
  2839        16  PD-HI-TERM               PIC S999        COMP-3.
  2840*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2841    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2842        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2843        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2844    12  PD-EARN-FACTORS.
  2845        16  FILLER OCCURS 15.
  2846            20  FILLER OCCURS 15.
  2847                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2848    12  PD-PRODUCT-DESC              PIC X(80).
  2849    12  PD-TRUNCATED                 PIC X.
  2850    12  FILLER                       PIC X(59).
  2851    12  PD-MAINT-INFORMATION.
  2852        16  PD-LAST-MAINT-DT         PIC X(02).
  2853        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2854        16  PD-LAST-MAINT-BY         PIC X(04).
  2855*                                COPY ELCSTATE.
  2856******************************************************************
  2857*                                                                *
  2858*                                                                *
  2859*                            ELCSTATE.                           *
  2860*                                                                *
  2861*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2862*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  54
* EL050.cbl
  2863*   FILE TYPE = VSAM,KSDS                                        *
  2864*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2865*                                                                *
  2866*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2867*       ALTERNATE INDEX = NONE                                   *
  2868*                                                                *
  2869*   LOG = YES                                                    *
  2870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2871******************************************************************
  2872*                   C H A N G E   L O G
  2873*
  2874* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2875*-----------------------------------------------------------------
  2876*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2877* EFFECTIVE    NUMBER
  2878*-----------------------------------------------------------------
  2879* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2880******************************************************************
  2881*
  2882 01  STATE-FILE.
  2883     12  SF-RECORD-ID                       PIC XX.
  2884         88  VALID-CF-ID                        VALUE 'SF'.
  2885     12  SF-CONTROL-PRIMARY.
  2886         16  SF-COMPANY-ID                  PIC XXX.
  2887         16  SF-CARRIER-CODE                PIC X.
  2888         16  SF-GROUPING                    PIC X(6).
  2889         16  SF-STATE-CODE                  PIC XX.
  2890         16  SF-EXPIRE-DATE                 PIC 9(8).
  2891****************************************************************
  2892*             STATE CONTROLS
  2893****************************************************************
  2894     12  SF-LAST-MAINT-DT                   PIC XX.
  2895     12  SF-LAST-MAINT-BY                   PIC X(4).
  2896     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2897     12  SF-STATE-RT-CONTROLS.
  2898         16  SF-ST-RT-CALC                  PIC X.
  2899     12  SF-ST-TAX-CONTROLS.
  2900         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2901         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2902         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2903     12  SF-ST-REFUND-OPTIONS.
  2904         16  SF-ST-RF-LR-CALC               PIC X.
  2905         16  SF-ST-RF-LL-CALC               PIC X.
  2906         16  SF-ST-RF-LN-CALC               PIC X.
  2907         16  SF-ST-RF-AH-CALC               PIC X.
  2908         16  SF-ST-RF-CP-CALC               PIC X.
  2909     12  SF-ST-UNEARN-PREM-OPTIONS.
  2910         16  SF-ST-LUEP-R78                 PIC X.
  2911         16  SF-ST-LUEP-PRO                 PIC X.
  2912         16  SF-ST-LUEP-ST                  PIC X.
  2913         16  SF-ST-LUEP-DOM                 PIC X.
  2914         16  SF-ST-AUEP-R78                 PIC X.
  2915         16  SF-ST-AUEP-PRO                 PIC X.
  2916         16  SF-ST-AUEP-ST                  PIC X.
  2917         16  SF-ST-AUEP-DOM                 PIC X.
  2918         16  SF-ST-CUEP-R78                 PIC X.
  2919         16  SF-ST-CUEP-PRO                 PIC X.
  2920         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  55
* EL050.cbl
  2921         16  SF-ST-CUEP-DOM                 PIC X.
  2922     12  SF-ST-EARN-PREM-OPTIONS.
  2923         16  SF-ST-LEP-R78                  PIC X.
  2924         16  SF-ST-LEP-PRO                  PIC X.
  2925         16  SF-ST-LEP-ST                   PIC X.
  2926         16  SF-ST-LEP-DOM                  PIC X.
  2927         16  SF-ST-AEP-R78                  PIC X.
  2928         16  SF-ST-AEP-PRO                  PIC X.
  2929         16  SF-ST-AEP-ST                   PIC X.
  2930         16  SF-ST-AEP-DOM                  PIC X.
  2931         16  SF-ST-CEP-R78                  PIC X.
  2932         16  SF-ST-CEP-PRO                  PIC X.
  2933         16  SF-ST-CEP-ST                   PIC X.
  2934         16  SF-ST-CEP-DOM                  PIC X.
  2935     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  56
* EL050.cbl
  2937*    COPY ELCCRTT.
  2938******************************************************************
  2939*                                                                *
  2940*                            ELCCRTT.                            *
  2941*                                                                *
  2942*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2943*                                                                *
  2944*   FILE TYPE = VSAM,KSDS                                        *
  2945*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2946*                                                                *
  2947*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2948*                                                                *
  2949*   LOG = YES                                                    *
  2950*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2951******************************************************************
  2952*                   C H A N G E   L O G
  2953*
  2954* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2955*-----------------------------------------------------------------
  2956*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2957* EFFECTIVE    NUMBER
  2958*-----------------------------------------------------------------
  2959* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2960* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2961* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2962* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2963* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2964* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2965* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2966* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2967******************************************************************
  2968
  2969 01  CERTIFICATE-TRAILERS.
  2970     12  CS-RECORD-ID                      PIC XX.
  2971         88  VALID-CS-ID                      VALUE 'CS'.
  2972
  2973     12  CS-CONTROL-PRIMARY.
  2974         16  CS-COMPANY-CD                 PIC X.
  2975         16  CS-CARRIER                    PIC X.
  2976         16  CS-GROUPING                   PIC X(6).
  2977         16  CS-STATE                      PIC XX.
  2978         16  CS-ACCOUNT                    PIC X(10).
  2979         16  CS-CERT-EFF-DT                PIC XX.
  2980         16  CS-CERT-NO.
  2981             20  CS-CERT-PRIME             PIC X(10).
  2982             20  CS-CERT-SFX               PIC X.
  2983         16  CS-TRAILER-TYPE               PIC X.
  2984             88  COMM-TRLR           VALUE 'A'.
  2985             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2986             88  CERT-DATA-TRLR      VALUE 'C'.
  2987
  2988     12  CS-DATA-AREA                      PIC X(516).
  2989
  2990     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2991         16  CS-BANK-COMMISSION-AREA.
  2992             20  CS-BANK-COMMS       OCCURS 10.
  2993                 24  CS-AGT                PIC X(10).
  2994                 24  CS-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  57
* EL050.cbl
  2995                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2996                 24  CS-RECALC-LV-INDIC    PIC X.
  2997                 24  FILLER                PIC X(10).
  2998         16  FILLER                        PIC X(256).
  2999
  3000     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3001****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3002         16  CS-MB-CLAIM-DATA OCCURS 24.
  3003             20  CS-CLAIM-NO               PIC X(7).
  3004             20  CS-CLAIM-TYPE             PIC X.
  3005                 88  CS-AH-CLM               VALUE 'A'.
  3006                 88  CS-IU-CLM               VALUE 'I'.
  3007                 88  CS-GP-CLM               VALUE 'G'.
  3008                 88  CS-LF-CLM               VALUE 'L'.
  3009                 88  CS-PR-CLM               VALUE 'P'.
  3010                 88  CS-FL-CLM               VALUE 'F'.
  3011             20  CS-INSURED-TYPE           PIC X.
  3012                 88  CS-PRIM-INSURED          VALUE 'P'.
  3013                 88  CS-CO-BORROWER           VALUE 'C'.
  3014             20  CS-BENEFIT-PERIOD         PIC 99.
  3015             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3016             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3017             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3018         16  FILLER                        PIC X(12).
  3019     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3020         16  CS-VIN-NUMBER                 PIC X(17).
  3021         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3022         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3023         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3024         16  cs-agent-name.
  3025             20  cs-agent-fname            pic x(20).
  3026             20  cs-agent-mi               pic x.
  3027             20  cs-agent-lname            pic x(25).
  3028         16  cs-license-no                 pic x(15).
  3029         16  cs-npn-number                 pic x(10).
  3030         16  cs-agent-edit-status          pic x.
  3031             88  cs-ae-refer-to-manager      value 'M'.
  3032             88  cs-ae-cover-sheet           value 'C'.
  3033             88  cs-ae-sig-form              value 'S'.
  3034             88  cs-ae-verified              value 'V'.
  3035             88  cs-unidentified-signature   value 'U'.
  3036             88  cs-cert-returned            value 'R'.
  3037             88  cs-accept-no-commission     value 'N'.
  3038         16  FILLER                        PIC X(424).
  3039*        16  FILLER                        PIC X(496).
  3040*    COPY ELCCRTO.
  3041******************************************************************
  3042*                                                                *
  3043*                            ELCCRTO.                            *
  3044*                                                                *
  3045*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3046*                                                                *
  3047*   FILE TYPE = VSAM,KSDS                                        *
  3048*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3049*                                                                *
  3050*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3051*                                                                *
  3052*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  58
* EL050.cbl
  3053*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3054******************************************************************
  3055*                   C H A N G E   L O G
  3056*
  3057* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3058*-----------------------------------------------------------------
  3059*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3060* EFFECTIVE    NUMBER
  3061*-----------------------------------------------------------------
  3062* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3063* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3064* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3065* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3066* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3067******************************************************************
  3068 01  ORIGINAL-CERTIFICATE.
  3069     12  OC-RECORD-ID                      PIC XX.
  3070         88  VALID-OC-ID                      VALUE 'OC'.
  3071     12  OC-CONTROL-PRIMARY.
  3072         16  OC-COMPANY-CD                 PIC X.
  3073         16  OC-CARRIER                    PIC X.
  3074         16  OC-GROUPING                   PIC X(6).
  3075         16  OC-STATE                      PIC XX.
  3076         16  OC-ACCOUNT                    PIC X(10).
  3077         16  OC-CERT-EFF-DT                PIC XX.
  3078         16  OC-CERT-NO.
  3079             20  OC-CERT-PRIME             PIC X(10).
  3080             20  OC-CERT-SFX               PIC X.
  3081         16  OC-RECORD-TYPE                PIC X.
  3082         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3083     12  OC-LAST-MAINT-DT                  PIC XX.
  3084     12  OC-LAST-MAINT-BY                  PIC X(4).
  3085     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3086     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3087     12  FILLER                            PIC X(49).
  3088     12  OC-ORIG-REC.
  3089         16  OC-INS-LAST-NAME              PIC X(15).
  3090         16  OC-INS-FIRST-NAME             PIC X(10).
  3091         16  OC-INS-MIDDLE-INIT            PIC X.
  3092         16  OC-INS-AGE                    PIC S999     COMP-3.
  3093         16  OC-JNT-LAST-NAME              PIC X(15).
  3094         16  OC-JNT-FIRST-NAME             PIC X(10).
  3095         16  OC-JNT-MIDDLE-INIT            PIC X.
  3096         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3097         16  OC-LF-BENCD                   PIC XX.
  3098         16  OC-LF-TERM                    PIC S999      COMP-3.
  3099         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3100         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3101         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3102         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3103         16  OC-LF-EXP-DT                  PIC XX.
  3104         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3105         16  OC-LF-CANCEL-DT               PIC XX.
  3106         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3107         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3108         16  OC-AH-BENCD                   PIC XX.
  3109         16  OC-AH-TERM                    PIC S999      COMP-3.
  3110         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  59
* EL050.cbl
  3111         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3112         16  OC-AH-EXP-DT                  PIC XX.
  3113         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3114         16  OC-AH-CP                      PIC 99.
  3115         16  OC-AH-CANCEL-DT               PIC XX.
  3116         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3117         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3118         16  OC-CRED-BENE-NAME             PIC X(25).
  3119         16  OC-1ST-PMT-DT                 PIC XX.
  3120         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3121         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3122         16  OC-ISSUE-TRAN-IND             PIC X.
  3123         16  OC-CANCEL-TRAN-IND            PIC X.
  3124         16  FILLER                        PIC X(211).
  3125
  3126     12  FILLER                            PIC X(50).
  3127******************************************************************
  3128
  3129*    COPY ELCDATE.
  3130******************************************************************
  3131*                                                                *
  3132*                                                                *
  3133*                            ELCDATE.                            *
  3134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3135*                            VMOD=2.003
  3136*                                                                *
  3137*                                                                *
  3138*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3139*                 LENGTH = 200                                   *
  3140******************************************************************
  3141
  3142 01  DATE-CONVERSION-DATA.
  3143     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3144     12  DC-OPTION-CODE                PIC X.
  3145         88  BIN-TO-GREG                VALUE ' '.
  3146         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3147         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3148         88  YMD-GREG-TO-BIN            VALUE '3'.
  3149         88  MDY-GREG-TO-BIN            VALUE '4'.
  3150         88  JULIAN-TO-BIN              VALUE '5'.
  3151         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3152         88  FIND-CENTURY               VALUE '7'.
  3153         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3154         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3155         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3156         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3157         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3158         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3159         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3160         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3161         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3162         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3163         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3164         88  BIN-3-TO-GREG              VALUE 'I'.
  3165         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3166         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3167         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3168         88  MDCY-GREG-TO-BIN           VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  60
* EL050.cbl
  3169         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3170         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3171         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3172         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3173         88  THREE-CHARACTER-BIN
  3174                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3175         88  GREGORIAN-TO-BIN
  3176                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3177         88  BIN-TO-GREGORIAN
  3178                  VALUES ' ' '1' 'I' '8' 'G'.
  3179         88  JULIAN-TO-BINARY
  3180                  VALUES '5' 'C' 'E' 'F'.
  3181     12  DC-ERROR-CODE                 PIC X.
  3182         88  NO-CONVERSION-ERROR        VALUE ' '.
  3183         88  DATE-CONVERSION-ERROR
  3184                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3185         88  DATE-IS-ZERO               VALUE '1'.
  3186         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3187         88  DATE-IS-INVALID            VALUE '3'.
  3188         88  DATE1-GREATER-DATE2        VALUE '4'.
  3189         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3190         88  DATE-INVALID-OPTION        VALUE '9'.
  3191         88  INVALID-CENTURY            VALUE 'A'.
  3192         88  ONLY-CENTURY               VALUE 'B'.
  3193         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3194         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3195     12  DC-END-OF-MONTH               PIC X.
  3196         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3197     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3198         88  USE-NORMAL-PROCESS         VALUE ' '.
  3199         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3200         88  ADJUST-UP-100-YRS          VALUE '2'.
  3201     12  FILLER                        PIC X.
  3202     12  DC-CONVERSION-DATES.
  3203         16  DC-BIN-DATE-1             PIC XX.
  3204         16  DC-BIN-DATE-2             PIC XX.
  3205         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3206         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3207                       DC-GREG-DATE-1-EDIT.
  3208             20  DC-EDIT1-MONTH        PIC 99.
  3209             20  SLASH1-1              PIC X.
  3210             20  DC-EDIT1-DAY          PIC 99.
  3211             20  SLASH1-2              PIC X.
  3212             20  DC-EDIT1-YEAR         PIC 99.
  3213         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3214         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3215                     DC-GREG-DATE-2-EDIT.
  3216             20  DC-EDIT2-MONTH        PIC 99.
  3217             20  SLASH2-1              PIC X.
  3218             20  DC-EDIT2-DAY          PIC 99.
  3219             20  SLASH2-2              PIC X.
  3220             20  DC-EDIT2-YEAR         PIC 99.
  3221         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3222         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3223                     DC-GREG-DATE-1-YMD.
  3224             20  DC-YMD-YEAR           PIC 99.
  3225             20  DC-YMD-MONTH          PIC 99.
  3226             20  DC-YMD-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  61
* EL050.cbl
  3227         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3228         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3229                      DC-GREG-DATE-1-MDY.
  3230             20  DC-MDY-MONTH          PIC 99.
  3231             20  DC-MDY-DAY            PIC 99.
  3232             20  DC-MDY-YEAR           PIC 99.
  3233         16  DC-GREG-DATE-1-ALPHA.
  3234             20  DC-ALPHA-MONTH        PIC X(10).
  3235             20  DC-ALPHA-DAY          PIC 99.
  3236             20  FILLER                PIC XX.
  3237             20  DC-ALPHA-CENTURY.
  3238                 24 DC-ALPHA-CEN-N     PIC 99.
  3239             20  DC-ALPHA-YEAR         PIC 99.
  3240         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3241         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3242         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3243         16  DC-JULIAN-DATE            PIC 9(05).
  3244         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3245                                       PIC 9(05).
  3246         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3247             20  DC-JULIAN-YEAR        PIC 99.
  3248             20  DC-JULIAN-DAYS        PIC 999.
  3249         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3250         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3251         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3252     12  DATE-CONVERSION-VARIBLES.
  3253         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3254         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3255             20  FILLER                PIC 9(3).
  3256             20  HOLD-CEN-1-CCYY.
  3257                 24  HOLD-CEN-1-CC     PIC 99.
  3258                 24  HOLD-CEN-1-YY     PIC 99.
  3259             20  HOLD-CEN-1-MO         PIC 99.
  3260             20  HOLD-CEN-1-DA         PIC 99.
  3261         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3262             20  HOLD-CEN-1-R-MO       PIC 99.
  3263             20  HOLD-CEN-1-R-DA       PIC 99.
  3264             20  HOLD-CEN-1-R-CCYY.
  3265                 24  HOLD-CEN-1-R-CC   PIC 99.
  3266                 24  HOLD-CEN-1-R-YY   PIC 99.
  3267             20  FILLER                PIC 9(3).
  3268         16  HOLD-CENTURY-1-X.
  3269             20  FILLER                PIC X(3)  VALUE SPACES.
  3270             20  HOLD-CEN-1-X-CCYY.
  3271                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3272                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3273             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3274             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3275         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3276             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3277             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3278             20  HOLD-CEN-1-R-X-CCYY.
  3279                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3280                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3281             20  FILLER                PIC XXX.
  3282         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3283         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3284         16  DC-JULIAN-DATE-1          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  62
* EL050.cbl
  3285         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3286             20  DC-JULIAN-1-CCYY.
  3287                 24  DC-JULIAN-1-CC    PIC 99.
  3288                 24  DC-JULIAN-1-YR    PIC 99.
  3289             20  DC-JULIAN-DA-1        PIC 999.
  3290         16  DC-JULIAN-DATE-2          PIC 9(07).
  3291         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3292             20  DC-JULIAN-2-CCYY.
  3293                 24  DC-JULIAN-2-CC    PIC 99.
  3294                 24  DC-JULIAN-2-YR    PIC 99.
  3295             20  DC-JULIAN-DA-2        PIC 999.
  3296         16  DC-GREG-DATE-A-EDIT.
  3297             20  DC-EDITA-MONTH        PIC 99.
  3298             20  SLASHA-1              PIC X VALUE '/'.
  3299             20  DC-EDITA-DAY          PIC 99.
  3300             20  SLASHA-2              PIC X VALUE '/'.
  3301             20  DC-EDITA-CCYY.
  3302                 24  DC-EDITA-CENT     PIC 99.
  3303                 24  DC-EDITA-YEAR     PIC 99.
  3304         16  DC-GREG-DATE-B-EDIT.
  3305             20  DC-EDITB-MONTH        PIC 99.
  3306             20  SLASHB-1              PIC X VALUE '/'.
  3307             20  DC-EDITB-DAY          PIC 99.
  3308             20  SLASHB-2              PIC X VALUE '/'.
  3309             20  DC-EDITB-CCYY.
  3310                 24  DC-EDITB-CENT     PIC 99.
  3311                 24  DC-EDITB-YEAR     PIC 99.
  3312         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3313         16  DC-GREG-DATE-CYMD-R REDEFINES
  3314                              DC-GREG-DATE-CYMD.
  3315             20  DC-CYMD-CEN           PIC 99.
  3316             20  DC-CYMD-YEAR          PIC 99.
  3317             20  DC-CYMD-MONTH         PIC 99.
  3318             20  DC-CYMD-DAY           PIC 99.
  3319         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3320         16  DC-GREG-DATE-MDCY-R REDEFINES
  3321                              DC-GREG-DATE-MDCY.
  3322             20  DC-MDCY-MONTH         PIC 99.
  3323             20  DC-MDCY-DAY           PIC 99.
  3324             20  DC-MDCY-CEN           PIC 99.
  3325             20  DC-MDCY-YEAR          PIC 99.
  3326    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3327        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3328    12  DC-EL310-DATE                  PIC X(21).
  3329    12  FILLER                         PIC X(28).
  3330
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  63
* EL050.cbl
  3332*    COPY ELCCALC.
  3333******************************************************************
  3334*                                                                *
  3335*                           ELCCALC.                            *
  3336*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3337*                            VMOD=2.025                          *
  3338*                                                                *
  3339*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3340*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3341*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3342*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3343*                                                                *
  3344*  PASSED TO ELRTRM                                              *
  3345*  -----------------                                             *
  3346*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3347*  ORIGINAL TERM                                                 *
  3348*  BEGINNING DATE                                                *
  3349*  ENDING DATE                                                   *
  3350*  COMPANY I.D.                                                  *
  3351*  ACCOUNT MASTER USER FIELD                                     *
  3352*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3353*  FREE LOOK DAYS                                                *
  3354*                                                                *
  3355*  RETURNED FROM ELRTRM                                          *
  3356*  ---------------------                                         *
  3357*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3358*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3359*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3360*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3361*----------------------------------------------------------------*
  3362*  PASSED TO ELRAMT                                              *
  3363*  ----------------                                              *
  3364*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3365*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3366*  ORIGINAL AMOUNT                                               *
  3367*  ALTERNATE BENEFIT (BALLON)                                    *
  3368*  A.P.R. - NET PAY ONLY                                         *
  3369*  METHOD
  3370*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3371*  COMPANY I.D.                                                  *
  3372*  BENEFIT TYPE                                                  *
  3373*                                                                *
  3374*  RETURNED FROM ELRAMT                                          *
  3375*  --------------------                                          *
  3376*  REMAINING AMOUNT 1 - CURRENT                                  *
  3377*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3378*  REMAINING AMOUNT FACTOR
  3379*----------------------------------------------------------------*
  3380*  PASSED TO ELRESV                                              *
  3381*  -----------------                                             *
  3382*  CERTIFICATE EFFECTIVE DATE                                    *
  3383*  VALUATION DATE                                                *
  3384*  PAID THRU DATE                                                *
  3385*  BENEFIT                                                       *
  3386*  INCURRED DATE                                                 *
  3387*  REPORTED DATE                                                 *
  3388*  ISSUE AGE                                                     *
  3389*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  64
* EL050.cbl
  3390*  CDT PERCENT                                                   *
  3391*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3392* *CLAIM TYPE (LIFE, A/H)                                        *
  3393* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3394* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3395*                                                                *
  3396*  RETURNED FROM ELRESV                                          *
  3397*  --------------------                                          *
  3398*  CDT TABLE USED                                                *
  3399*  CDT FACTOR USED                                               *
  3400*  PAY TO CURRENT RESERVE                                        *
  3401*  I.B.N.R. - A/H ONLY                                           *
  3402*  FUTURE (ACCRUED) AH ONLY                                      *
  3403*----------------------------------------------------------------*
  3404*  PASSED TO ELRATE                                              *
  3405*  ----------------                                              *
  3406*  CERT ISSUE DATE                                               *
  3407*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3408*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3409*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3410*  STATE CODE (CLIENT DEFINED)                                   *
  3411*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3412*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3413*  DEVIATION CODE                                                *
  3414*  ISSUE AGE                                                     *
  3415*  ORIGINAL BENEFIT AMOUNT                                       *
  3416*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3417*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3418*  BENEFIT KIND (LIFE OR A/H)                                    *
  3419*  A.P.R.                                                        *
  3420*  METHOD
  3421*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3422*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3423*  COMPANY I.D. (3 CHARACTER)                                    *
  3424*  BENEFIT CODE                                                  *
  3425*  BENEFIT OVERRIDE CODE                                         *
  3426*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3427*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3428*  JOINT INDICATOR (CSL ONLY)                                    *
  3429*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3430*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3431*                                                                *
  3432*  RETURNED FROM ELRATE                                          *
  3433*  --------------------                                          *
  3434*  CALCULATED PREMIUM                                            *
  3435*  PREMIUM RATE                                                  *
  3436*  MORTALITY CODE                                                *
  3437*  MAX ATTAINED AGE                                              *
  3438*  MAX AGE                                                       *
  3439*  MAX TERM                                                      *
  3440*  MAX MONTHLY BENEFIT                                           *
  3441*  MAX TOTAL BENIFIT                                             *
  3442*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3443*----------------------------------------------------------------*
  3444*  PASSED TO ELRFND                                              *
  3445*  ----------------                                              *
  3446*  CERT ISSUE DATE                                               *
  3447*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  65
* EL050.cbl
  3448*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3449*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3450*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3451*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3452*  STATE CODE (CLIENT DEFINED)                                   *
  3453*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3454*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3455*  DEVIATION CODE                                                *
  3456*  ISSUE AGE                                                     *
  3457*  ORIGINAL BENEFIT AMOUNT                                       *
  3458*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3459*  PROCESS TYPE (CANCEL)                                         *
  3460*  BENEFIT KIND (LIFE OR A/H)                                    *
  3461*  A.P.R.                                                        *
  3462*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3463*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3464*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3465*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3466*  COMPANY I.D. (3 CHARACTER)                                    *
  3467*  BENEFIT CODE                                                  *
  3468*  BENEFIT OVERRIDE CODE                                         *
  3469*                                                                *
  3470*  RETURNED FROM ELRFND                                          *
  3471*  --------------------                                          *
  3472*  CALCULATED REFUND                                             *
  3473*----------------------------------------------------------------*
  3474*  PASSED TO ELEARN                                              *
  3475*  ----------------                                              *
  3476*  CERT ISSUE DATE                                               *
  3477*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3478*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3479*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3480*  STATE CODE (CLIENT DEFINED)                                   *
  3481*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3482*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3483*  DEVIATION CODE                                                *
  3484*  ISSUE AGE                                                     *
  3485*  ORIGINAL BENEFIT AMOUNT                                       *
  3486*  BENEFIT KIND (LIFE OR A/H)                                    *
  3487*  A.P.R.                                                        *
  3488*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3489*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3490*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3491*  COMPANY I.D. (3 CHARACTER)                                    *
  3492*  BENEFIT CODE                                                  *
  3493*  BENEFIT OVERRIDE CODE                                         *
  3494*                                                                *
  3495*  RETURNED FROM ELEARN                                          *
  3496*  --------------------                                          *
  3497*  INDICATED  EARNINGS                                           *
  3498*----------------------------------------------------------------*
  3499*                 LENGTH = 450                                   *
  3500*                                                                *
  3501******************************************************************
  3502******************************************************************
  3503*                   C H A N G E   L O G
  3504*
  3505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  66
* EL050.cbl
  3506*-----------------------------------------------------------------
  3507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3508* EFFECTIVE    NUMBER
  3509*-----------------------------------------------------------------
  3510* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3511* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3512* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3513* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3514* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3515* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3516* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3517* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3518* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3519* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3520******************************************************************
  3521
  3522 01  CALCULATION-PASS-AREA.
  3523     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3524                                     COMP.
  3525
  3526     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3527       88  NO-CP-ERROR                             VALUE ZERO.
  3528       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3529                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3530       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3531       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3532       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3533       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3534       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3535       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3536       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3537       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3538       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3539       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3540       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3541       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3542       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3543       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3544       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3545       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3546       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3547
  3548     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3549       88  NO-CP-ERROR-2                           VALUE ZERO.
  3550***********************  INPUT AREAS ****************************
  3551
  3552     12  CP-CALCULATION-AREA.
  3553         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3554         16  CP-CERT-EFF-DT        PIC XX.
  3555         16  CP-VALUATION-DT       PIC XX.
  3556         16  CP-PAID-THRU-DT       PIC XX.
  3557         16  CP-BENEFIT-TYPE       PIC X.
  3558           88  CP-AH                               VALUE 'A' 'D'
  3559                                                   'I' 'U'.
  3560           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3561           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3562         16  CP-INCURRED-DT        PIC XX.
  3563         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  67
* EL050.cbl
  3564         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3565         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3566         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3569                                     COMP-3.
  3570         16  CP-CDT-METHOD         PIC X.
  3571           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3572           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3573           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3574         16  CP-CLAIM-TYPE         PIC X.
  3575           88  CP-AH-CLAIM                         VALUE 'A'.
  3576           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3577         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3578                                     COMP-3.
  3579         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3580                                     COMP-3.
  3581         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3582                                     COMP-3.
  3583         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3586                                     COMP-3.
  3587         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3588                                     COMP-3.
  3589         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-REM-TERM-METHOD    PIC X.
  3592           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3593           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3594           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3595           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3596           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3597           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3598           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3599         16  CP-EARNING-METHOD     PIC X.
  3600           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3601           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3602           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3603           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3604           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3605           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3606           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3607           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3608           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3609           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3610           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3611           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3612           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3613           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3614         16  CP-PROCESS-TYPE       PIC X.
  3615           88  CP-CLAIM                            VALUE '1'.
  3616           88  CP-CANCEL                           VALUE '2'.
  3617           88  CP-ISSUE                            VALUE '3'.
  3618         16  CP-SPECIAL-CALC-CD    PIC X.
  3619           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3620           88  CP-1-MTH-INTEREST               VALUE ' '.
  3621           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  68
* EL050.cbl
  3622           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3623           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3624           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3625           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3626           88  CP-FARM-PLAN                    VALUE 'F'.
  3627           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3628           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3629           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3630           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3631           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3632           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3633           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3634           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3635           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3636           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3637                                                     'W' 'X'.
  3638           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3639           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3640           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3641           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3642           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3643           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3644           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3645           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3646           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3647           88  CP-CSL-METH-1                   VALUE '5'.
  3648           88  CP-CSL-METH-2                   VALUE '6'.
  3649           88  CP-CSL-METH-3                   VALUE '7'.
  3650           88  CP-CSL-METH-4                   VALUE '8'.
  3651
  3652         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3653                                     COMP-3.
  3654         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3655         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3656         16  CP-STATE              PIC XX          VALUE SPACE.
  3657         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3658         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3659           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3660               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3661         16  CP-R78-OPTION         PIC X.
  3662           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3663           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3664
  3665         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3666         16  CP-IBNR-RESERVE-SW    PIC X.
  3667         16  CP-CLAIM-STATUS       PIC X.
  3668         16  CP-RATE-FILE          PIC X.
  3669         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3670                                     COMP-3.
  3671
  3672         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3673         16  CP-AH-OVERRIDE-CODE   PIC X.
  3674
  3675         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3678                                   PIC S9(5)V99 COMP-3.
  3679         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  69
* EL050.cbl
  3680                                     COMP-3.
  3681         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3682                                     COMP-3.
  3683         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3684                                     COMP-3.
  3685         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3686                                  PIC S9(7)V99 COMP-3.
  3687
  3688         16  CP-PAID-FROM-DATE     PIC X(02).
  3689         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3690         16  CP-EXT-DAYS-CALC      PIC X.
  3691           88  CP-EXT-NO-CHG                   VALUE ' '.
  3692           88  CP-EXT-CHG-LF                   VALUE '1'.
  3693           88  CP-EXT-CHG-AH                   VALUE '2'.
  3694           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3695         16  CP-DOMICILE-STATE     PIC XX.
  3696         16  CP-CARRIER            PIC X.
  3697         16  CP-REIN-FLAG          PIC X.
  3698         16  CP-REM-TRM-CALC-OPTION PIC X.
  3699           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3700                      '2' '3' '4' '5'.
  3701           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3702           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3703           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3704           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3705           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3706           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3707           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3708           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3709         16  CP-SIG-SWITCH         PIC X.
  3710         16  CP-RATING-METHOD      PIC X.
  3711           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3712           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3713           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3714           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3715           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3716           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3717           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3718           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3719           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3720         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3721                                     COMP-3.
  3722         16  CP-BEN-CATEGORY       PIC X.
  3723         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3724         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3725                                   PIC S99V9(5) COMP-3.
  3726         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3727         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3728                                   PIC S99V9(5) COMP-3.
  3729         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3730         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3731         16  CP-EXPIRE-DT          PIC XX.
  3732         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3733         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3734         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3735         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3736         16  CP-DDF-SPEC-CALC      PIC X.
  3737             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  70
* EL050.cbl
  3738             88  CP-CALC-CLP              VALUE 'C'.
  3739         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3740         16  CP-CANCEL-REASON      PIC X.
  3741         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3742         16  CP-PMT-MODE           PIC X.
  3743         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3744         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3745         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3746         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3747         16  FILLER                PIC X.
  3748
  3749***************    OUTPUT FROM ELRESV   ************************
  3750
  3751         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3752
  3753         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3754                                     COMP-3.
  3755         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3756                                     COMP-3.
  3757         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3758                                     COMP-3.
  3759         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3760                                     COMP-3.
  3761         16  FILLER                PIC X(09).
  3762***************    OUTPUT FROM ELRTRM   *************************
  3763
  3764         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3765                                     COMP-3.
  3766         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3771                                     COMP-3.
  3772         16  FILLER                PIC X(12).
  3773
  3774***************    OUTPUT FROM ELRAMT   *************************
  3775
  3776         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3779                                     COMP-3.
  3780         16  FILLER                PIC X(12).
  3781
  3782***************    OUTPUT FROM ELRATE   *************************
  3783
  3784         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3785                                     COMP-3.
  3786         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3787                                     COMP-3.
  3788         16  CP-MORTALITY-CODE     PIC X(4).
  3789         16  CP-RATE-EDIT-FLAG     PIC X.
  3790             88  CP-RATES-NEED-APR                  VALUE '1'.
  3791         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3794         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3795         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  71
* EL050.cbl
  3796                                   PIC S9(7)V99 COMP-3.
  3797         16  FILLER                PIC X(07).
  3798
  3799***************    OUTPUT FROM ELRFND   *************************
  3800
  3801         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-REFUND-TYPE-USED   PIC X.
  3804           88  CP-R-AS-R78                         VALUE '1'.
  3805           88  CP-R-AS-PRORATA                     VALUE '2'.
  3806           88  CP-R-AS-CALIF                       VALUE '3'.
  3807           88  CP-R-AS-TEXAS                       VALUE '4'.
  3808           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3809           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3810           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3811           88  CP-R-AS-MEAN                        VALUE '8'.
  3812           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3813           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3814           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3815           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3816           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3817           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3818         16  FILLER                PIC X(12).
  3819
  3820***************    OUTPUT FROM ELEARN   *************************
  3821
  3822         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3833                                     COMP-3.
  3834         16  CP-EARNING-TYPE-USED  PIC X.
  3835           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3836           88  CP-E-AS-R78                         VALUE '1'.
  3837           88  CP-E-AS-PRORATA                     VALUE '2'.
  3838           88  CP-E-AS-TEXAS                       VALUE '4'.
  3839           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3840           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3841           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3842           88  CP-E-AS-MEAN                        VALUE '8'.
  3843           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3844         16  FILLER                PIC X(12).
  3845
  3846***************    OUTPUT FROM ELPMNT   *************************
  3847
  3848         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3849                                     COMP-3.
  3850         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3851                                     COMP-3.
  3852         16  FILLER                PIC X(12).
  3853
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  72
* EL050.cbl
  3854***************   MISC WORK AREAS    *****************************
  3855         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3858                                     COMP-3.
  3859         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3860                                     COMP-3.
  3861         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3862                                     COMP-3.
  3863         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3866                                     COMP-3.
  3867         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3868             88  OPEN-RATE-FILE                   VALUE 'O'.
  3869             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3870             88  IO-ERROR                         VALUE 'E'.
  3871
  3872         16  CP-FIRST-PAY-DATE     PIC XX.
  3873
  3874         16  CP-JOINT-INDICATOR    PIC X.
  3875
  3876         16  CP-RESERVE-REMAINING-TERM
  3877                                   PIC S9(4)V9    VALUE ZERO
  3878                                     COMP-3.
  3879
  3880         16  CP-INSURED-BIRTH-DT   PIC XX.
  3881
  3882         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3883                                     COMP-3.
  3884
  3885         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3886                                     COMP-3.
  3887
  3888         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3889                                     COMP-3.
  3890
  3891         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3892                                     COMP-3.
  3893
  3894         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3895                                     COMP-3.
  3896
  3897         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3898                                     COMP-3.
  3899
  3900         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3901                                     COMP-3.
  3902
  3903         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3904             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3905
  3906         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3907                                     COMP-3.
  3908         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3909                                     COMP-3.
  3910         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3911         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  73
* EL050.cbl
  3912         16  cp-net-only-state     pic x value spaces.
  3913         16  FILLER                PIC X(13).
  3914******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  74
* EL050.cbl
  3916******************************************************************
  3917*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3918*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3919*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3920*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3921*** MODIFICATION.                                              ***
  3922*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3923*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3924******************************************************************
  3925*    COPY ERCPNDB.
  3926******************************************************************
  3927*                                                                *
  3928*                                                                *
  3929*                            ERCPNDB.                            *
  3930*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3931*                            VMOD=2.025                          *
  3932*                                                                *
  3933*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3934*                                                                *
  3935******************************************************************
  3936*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3937*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3938******************************************************************
  3939*                                                                *
  3940*                                                                *
  3941*   FILE TYPE = VSAM,KSDS                                        *
  3942*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3943*                                                                *
  3944*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3945*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3946*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3947*                                                 RKP=13,LEN=36  *
  3948*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3949*                                      AND CHG-SEQ.)             *
  3950*                                                RKP=49,LEN=11   *
  3951*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3952*                                      AND CHG-SEQ.)             *
  3953*                                                RKP=60,LEN=15   *
  3954*                                                                *
  3955*   LOG = NO                                                     *
  3956*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3957******************************************************************
  3958******************************************************************
  3959*                   C H A N G E   L O G
  3960*
  3961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3962*-----------------------------------------------------------------
  3963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3964* EFFECTIVE    NUMBER
  3965*-----------------------------------------------------------------
  3966* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3967* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3968* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3969* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3970* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3971* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3972* 032306                   PEMA  ADD BOW LOAN NUMBER
  3973* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  75
* EL050.cbl
  3974* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3975* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3976* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3977* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3978* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3979* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3980* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3981* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3982******************************************************************
  3983
  3984 01  PENDING-BUSINESS.
  3985     12  PB-RECORD-ID                     PIC XX.
  3986         88  VALID-PB-ID                        VALUE 'PB'.
  3987
  3988     12  PB-CONTROL-PRIMARY.
  3989         16  PB-COMPANY-CD                PIC X.
  3990         16  PB-ENTRY-BATCH               PIC X(6).
  3991         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3992         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3993
  3994     12  PB-CONTROL-BY-ACCOUNT.
  3995         16  PB-COMPANY-CD-A1             PIC X.
  3996         16  PB-CARRIER                   PIC X.
  3997         16  PB-GROUPING.
  3998             20  PB-GROUPING-PREFIX       PIC XXX.
  3999             20  PB-GROUPING-PRIME        PIC XXX.
  4000         16  PB-STATE                     PIC XX.
  4001         16  PB-ACCOUNT.
  4002             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4003             20  PB-ACCOUNT-PRIME         PIC X(6).
  4004         16  PB-CERT-EFF-DT               PIC XX.
  4005         16  PB-CERT-NO.
  4006             20  PB-CERT-PRIME            PIC X(10).
  4007             20  PB-CERT-SFX              PIC X.
  4008         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4009
  4010         16  PB-RECORD-TYPE               PIC X.
  4011             88  PB-MAILING-DATA                VALUE '0'.
  4012             88  PB-ISSUE                       VALUE '1'.
  4013             88  PB-CANCELLATION                VALUE '2'.
  4014             88  PB-BATCH-TRAILER               VALUE '9'.
  4015
  4016     12  PB-CONTROL-BY-ORIG-BATCH.
  4017         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4018         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4019         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4020         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4021
  4022     12  PB-CONTROL-BY-CSR.
  4023         16  PB-CSR-COMPANY-CD            PIC X.
  4024         16  PB-CSR-ID                    PIC X(4).
  4025         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4026         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4027         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4028******************************************************************
  4029*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4030******************************************************************
  4031
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  76
* EL050.cbl
  4032     12  PB-LAST-MAINT-DT                 PIC XX.
  4033     12  PB-LAST-MAINT-BY                 PIC X(4).
  4034     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4035
  4036     12  PB-RECORD-BODY                   PIC X(375).
  4037
  4038     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4039         16  PB-CERT-ORIGIN               PIC X.
  4040             88  CLASIC-CREATED-CERT         VALUE '1'.
  4041         16  PB-I-NAME.
  4042             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4043             20  PB-I-INSURED-FIRST-NAME.
  4044                 24  PB-I-INSURED-1ST-INIT PIC X.
  4045                 24  FILLER                PIC X(9).
  4046             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4047         16  PB-I-AGE                     PIC S99   COMP-3.
  4048         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4049         16  PB-I-BIRTHDAY                PIC XX.
  4050         16  PB-I-INSURED-SEX             PIC X.
  4051             88  PB-SEX-MALE     VALUE 'M'.
  4052             88  PB-SEX-FEMALE   VALUE 'F'.
  4053
  4054         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4055         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4056         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4057         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4058         16  PB-I-SKIP-CODE               PIC X.
  4059             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4060             88  PB-SKIP-JULY              VALUE '1'.
  4061             88  PB-SKIP-AUGUST            VALUE '2'.
  4062             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4063             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4064             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4065             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4066             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4067             88  PB-SKIP-JUNE              VALUE '8'.
  4068             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4069             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4070             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4071         16  PB-I-TERM-TYPE               PIC X.
  4072             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4073             88  PB-PAID-WEEKLY            VALUE 'W'.
  4074             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4075             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4076             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4077         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4078         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4079         16  PB-I-DATA-ENTRY-SW           PIC X.
  4080             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4081             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4082             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4083             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4084         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4085         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4086*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4087         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4088         16  FILLER                       PIC X.
  4089
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  77
* EL050.cbl
  4090         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4091             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4092             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4093                                                   '90' THRU '99'.
  4094         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4095                                          PIC XX.
  4096         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4097         16  PB-I-AMOUNT-FINANCED REDEFINES
  4098                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4099         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4100         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4101                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4102         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4103         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4104         16  PB-I-CLP-AMOUNT REDEFINES
  4105                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4106         16  PB-I-LF-CALC-FLAG            PIC X.
  4107             88 PB-COMP-LF-PREM               VALUE '?'.
  4108         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4109         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4110         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4111         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4112         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4113         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4114         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4115         16  PB-I-LF-ABBR                 PIC XXX.
  4116         16  PB-I-LF-INPUT-CD             PIC XX.
  4117
  4118         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4119             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4120             88  PB-INVALID-AH               VALUE '  ' '00'
  4121                                                   '90' THRU '99'.
  4122         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4123         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4124         16  PB-I-AH-CALC-FLAG            PIC X.
  4125             88 PB-COMP-AH-PREM                  VALUE '?'.
  4126         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4127         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4128         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4129         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4130         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4131         16  PB-I-AH-ABBR                 PIC XXX.
  4132         16  PB-I-AH-INPUT-CD             PIC XXX.
  4133
  4134         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4135         16  PB-I-REIN-TABLE              PIC XXX.
  4136         16  PB-I-BUSINESS-TYPE           PIC 99.
  4137         16  PB-I-INDV-GRP-CD             PIC X.
  4138         16  PB-I-MORT-CODE.
  4139             20  PB-I-TABLE               PIC X.
  4140             20  PB-I-INTEREST            PIC XX.
  4141             20  PB-I-MORT-TYP            PIC X.
  4142         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4143         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4144         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4145         16  PB-I-INDV-GRP-OVRD           PIC X.
  4146         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4147         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  78
* EL050.cbl
  4148             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4149         16  PB-I-RATE-CLASS              PIC XX.
  4150         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4151         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4152         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4153         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4154         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4155         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4156         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4157         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4158         16  PB-I-OB-FLAG                 PIC X.
  4159             88  PB-I-OB                      VALUE 'B'.
  4160             88  PB-I-SUMMARY                 VALUE 'Z'.
  4161         16  PB-I-ENTRY-STATUS            PIC X.
  4162             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4163                                              'M' '5' '9' '2'.
  4164             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4165             88  PB-I-POLICY-PENDING          VALUE '2'.
  4166             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4167             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4168             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4169             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4170             88  PB-I-REIN-ONLY               VALUE '9'.
  4171             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4172             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4173             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4174             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4175         16  PB-I-INT-CODE                PIC X.
  4176             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4177             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4178         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4179         16  PB-I-SOC-SEC-NO              PIC X(11).
  4180         16  PB-I-MEMBER-NO               PIC X(12).
  4181         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4182*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4183         16  PB-I-OLD-LOF                 PIC XXX.
  4184         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4185         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4186         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4187         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4188         16  PB-I-LIFE-INDICATOR          PIC X.
  4189             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4190         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4191         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4192                                          PIC S9(5)V99    COMP-3.
  4193         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4194             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4195             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4196         16  PB-I-1ST-PMT-DT              PIC XX.
  4197         16  PB-I-JOINT-INSURED.
  4198             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4199             20 PB-I-JOINT-FIRST-NAME.
  4200                24  PB-I-JOINT-FIRST-INIT PIC X.
  4201                24  FILLER                PIC X(9).
  4202             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4203*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4204         16  PB-I-BENEFICIARY-NAME.
  4205             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  79
* EL050.cbl
  4206             20  FILLER                   PIC X(15).
  4207         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4208         16  PB-I-REFERENCE               PIC X(12).
  4209         16  FILLER REDEFINES PB-I-REFERENCE.
  4210             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4211             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4212             20  PB-I-CLP-STATE           PIC XX.
  4213         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4214             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4215             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4216             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4217         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4218         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4219         16  PB-I-RESIDENT-STATE          PIC XX.
  4220         16  PB-I-RATE-CODE               PIC X(4).
  4221         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4222         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4223         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4224         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4225         16  PB-I-BANK-NOCHRGB            PIC 99.
  4226         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4227         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4228
  4229     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4230         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4231             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4232         16  PB-C-CANCEL-ORIGIN           PIC X.
  4233             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4234         16  PB-C-LF-CANCEL-DT            PIC XX.
  4235         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4236         16  PB-C-LF-CALC-REQ             PIC X.
  4237             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4238         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4239         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4240         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4241             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4242         16  PB-C-AH-CANCEL-DT            PIC XX.
  4243         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4244         16  PB-C-AH-CALC-REQ             PIC X.
  4245             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4246         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4247         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4248         16  PB-C-LAST-NAME               PIC X(15).
  4249         16  PB-C-REFUND-SW               PIC X.
  4250             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4251             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4252         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4253         16  PB-C-PAYEE-CODE              PIC X(6).
  4254         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4255         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4256         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4257         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4258         16  PB-C-REFERENCE               PIC X(12).
  4259         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4260         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4261         16  PB-C-POST-CARD-IND           PIC X.
  4262         16  PB-C-CANCEL-REASON           PIC X.
  4263         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  80
* EL050.cbl
  4264         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4265         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4266         16  FILLER                       PIC X(01).
  4267*        16  FILLER                       PIC X(18).
  4268         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4269*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4270         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4271         16  PB-CANCELED-CERT-DATA.
  4272             20  PB-CI-INSURED-NAME.
  4273                 24  PB-CI-LAST-NAME      PIC X(15).
  4274                 24  PB-CI-INITIALS       PIC XX.
  4275             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4276             20  PB-CI-INSURED-SEX        PIC X.
  4277             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4278             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4279             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4280             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4281             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4282             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4283             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4284             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4285             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4286             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4287             20  PB-CI-RATE-CLASS         PIC XX.
  4288             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4289             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4290             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4291             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4292             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4293             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4294             20  PB-CI-LF-ABBR            PIC X(3).
  4295             20  PB-CI-AH-ABBR            PIC X(3).
  4296             20  PB-CI-OB-FLAG            PIC X.
  4297                 88  PB-CI-OB                VALUE 'B'.
  4298             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4299                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4300                                           'M' '4' '5' '9' '2'.
  4301                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4302                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4303                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4304                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4305                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4306                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4307                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4308                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4309                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4310                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4311                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4312                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4313                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4314             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4315                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4316                                           'M' '4' '5' '9' '2'.
  4317                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4318                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4319                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4320                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4321                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  81
* EL050.cbl
  4322                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4323                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4324                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4325                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4326                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4327                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4328                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4329                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4330             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4331             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4332             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4333             20  PB-CI-MEMBER-NO          PIC X(12).
  4334             20  PB-CI-INT-CODE           PIC X.
  4335                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4336                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4337             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4338             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4339             20  PB-CI-COMP-EXCP-SW       PIC X.
  4340                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4341                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4342             20  PB-CI-ENTRY-STATUS       PIC X.
  4343             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4344             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4345             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4346             20  PB-CI-DEATH-DT           PIC XX.
  4347             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4348             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4349             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4350             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4351             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4352             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4353             20  PB-CI-ENTRY-DT              PIC XX.
  4354             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4355             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4356             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4357             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4358             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4359             20  PB-CI-OLD-LOF               PIC XXX.
  4360*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4361             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4362             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4363             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4364             20  PB-CI-INDV-GRP-CD           PIC X.
  4365             20  PB-CI-BENEFICIARY-NAME.
  4366                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4367                 24  FILLER                  PIC X(15).
  4368             20  PB-CI-NOTE-SW               PIC X.
  4369             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4370             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4371             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4372             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4373             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4374             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4375             20  PB-CI-FIRST-NAME            PIC X(10).
  4376             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4377
  4378         16  FILLER                       PIC X(13).
  4379*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  82
* EL050.cbl
  4380*        16  FILLER                       PIC X(46).
  4381
  4382     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4383         16  FILLER                       PIC X(10).
  4384         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4385         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4386         16  PB-M-INSURED-MID-INIT        PIC X.
  4387         16  PB-M-INSURED-AGE             PIC 99.
  4388         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4389         16  PB-M-INSURED-SEX             PIC X.
  4390         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4391         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4392         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4393         16  PB-M-INSURED-CITY-STATE.
  4394             20  PB-M-INSURED-CITY        PIC X(28).
  4395             20  PB-M-INSURED-STATE       PIC XX.
  4396         16  PB-M-INSURED-ZIP-CODE.
  4397             20  PB-M-INSURED-ZIP-PRIME.
  4398                 24  PB-M-INSURED-ZIP-1   PIC X.
  4399                     88  PB-M-CANADIAN-POST-CODE
  4400                                             VALUE 'A' THRU 'Z'.
  4401                 24  FILLER               PIC X(4).
  4402             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4403         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4404                                        PB-M-INSURED-ZIP-CODE.
  4405             20  PM-M-INS-CAN-POST1       PIC XXX.
  4406             20  PM-M-INS-CAN-POST2       PIC XXX.
  4407             20  FILLER                   PIC XXX.
  4408         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4409         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4410         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4411         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4412         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4413         16  PB-M-CRED-BENE-CITYST.
  4414             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4415             20  PB-M-CRED-BENE-STATE     PIC XX.
  4416         16  FILLER                       PIC X(92).
  4417
  4418     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4419         16  FILLER                       PIC X(10).
  4420         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4421         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4422         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4423         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4424         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4425         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4426         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4427         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4428         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4429         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4430         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4431         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4432         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4433         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4434         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4435         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4436         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4437         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  83
* EL050.cbl
  4438         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4439         16  PB-REFERENCE                 PIC X(12).
  4440         16  PB-B-RECEIVED-DT             PIC XX.
  4441         16  FILLER                       PIC X(234).
  4442
  4443     12  PB-RECORD-STATUS.
  4444         16  PB-CREDIT-SELECT-DT          PIC XX.
  4445         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4446         16  PB-BILLED-DT                 PIC XX.
  4447         16  PB-BILLING-STATUS            PIC X.
  4448             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4449             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4450             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4451         16  PB-RECORD-BILL               PIC X.
  4452             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4453             88  PB-RECORD-RETURNED           VALUE 'R'.
  4454             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4455             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4456             88  PB-OVERRIDE-AH               VALUE 'A'.
  4457             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4458         16  PB-BATCH-ENTRY               PIC X.
  4459             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4460             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4461             88  PB-REISSUED-CERT             VALUE 'E'.
  4462             88  PB-CASH-CERT                 VALUE 'C'.
  4463             88  PB-MONTHLY-CERT              VALUE 'M'.
  4464             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4465             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4466             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4467         16  PB-FORCE-CODE                PIC X.
  4468             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4469             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4470             88  PB-CANCEL-FORCE              VALUE '8'.
  4471             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4472             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4473             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4474             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4475             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4476             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4477             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4478         16  PB-FATAL-FLAG                PIC X.
  4479             88  PB-FATAL-ERRORS              VALUE 'X'.
  4480         16  PB-FORCE-ER-CD               PIC X.
  4481             88  PB-FORCE-ERRORS              VALUE 'F'.
  4482             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4483         16  PB-WARN-ER-CD                PIC X.
  4484             88  PB-WARNING-ERRORS            VALUE 'W'.
  4485         16  FILLER                       PIC X.
  4486         16  PB-OUT-BAL-CD                PIC X.
  4487             88  PB-OUT-OF-BAL                VALUE 'O'.
  4488         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4489         16  PB-AH-OVERRIDE-L1            PIC X.
  4490         16  PB-INPUT-DT                  PIC XX.
  4491         16  PB-INPUT-BY                  PIC X(4).
  4492         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4493         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4494         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4495         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  84
* EL050.cbl
  4496         16  PB-AH-EARNING-METHOD         PIC X.
  4497         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4498         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4499         16  PB-REIN-CD                   PIC XXX.
  4500         16  PB-LF-REFUND-TYPE            PIC X.
  4501         16  PB-AH-REFUND-TYPE            PIC X.
  4502         16  PB-ACCT-EFF-DT               PIC XX.
  4503         16  PB-ACCT-EXP-DT               PIC XX.
  4504         16  PB-COMPANY-ID                PIC X(3).
  4505         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4506         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4507         16  PB-SV-CARRIER                PIC X.
  4508         16  PB-SV-GROUPING               PIC X(6).
  4509         16  PB-SV-STATE                  PIC XX.
  4510         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4511         16  PB-GA-BILLING-INFO.
  4512             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4513                                          PIC XX.
  4514         16  PB-SV-REMIT-TO  REDEFINES
  4515             PB-GA-BILLING-INFO           PIC X(10).
  4516         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4517         16  PB-I-LOAN-OFFICER            PIC X(5).
  4518         16  PB-I-VIN                     PIC X(17).
  4519
  4520         16  FILLER                       PIC X(04).
  4521         16  IMNET-BYPASS-SW              PIC X.
  4522
  4523******************************************************************
  4524*                COMMON EDIT ERRORS                              *
  4525******************************************************************
  4526
  4527     12  PB-COMMON-ERRORS.
  4528         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4529                                           PIC S9(4)     COMP.
  4530
  4531******************************************************************
  4532
  4533* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4534*    COPY ELC50W1.
  4535******************************************************************
  4536*                                                                *
  4537*                                                                *
  4538*                             ELC50W1                            *
  4539*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4540*                            VMOD=2.004                          *
  4541*                                                                *
  4542*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4543*                                                                *
  4544*                                                                *
  4545******************************************************************
  4546
  4547     12  WK-WORK-AREA.
  4548         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4549         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4550         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4551         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4552         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4553         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  85
* EL050.cbl
  4554         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4555         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4556         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4557         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4558         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4559         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4560         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4561         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4562         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4563         16  WK-CREDIT-EDIT-CONTROLS.
  4564             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4565             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4566             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4567             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4568             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4569             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4570         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4571         16  WK-SAVE-REIN-DATA.
  4572             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4573             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4574             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4575         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4576             88  ENTRY-FROM-EL6311       VALUE '6'.
  4577         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4578         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4579     12  WK-RECORD-ADDRESSES.
  4580         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4581         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4582         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4583         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4584         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4585         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4586         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4587         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4588     12  WK-OVER-SHORT-AREA.
  4589         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4590         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4591         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4592             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4593         16  FILLER                   PIC X(5) VALUE SPACES.
  4594
  4595*    COPY ELCEDITC.
  4596******************************************************************
  4597*                                                                *
  4598*                                                                *
  4599*                            ELCEDITC                            *
  4600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4601*                            VMOD=2.012                          *
  4602*                                                                *
  4603*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4604*                     EL6313, EL050 AND EL517.                   *
  4605*                                                                *
  4606******************************************************************
  4607******************************************************************
  4608*                   C H A N G E   L O G
  4609*
  4610* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4611*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  86
* EL050.cbl
  4612*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4613* EFFECTIVE    NUMBER
  4614*-----------------------------------------------------------------
  4615* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4616******************************************************************
  4617
  4618     12  EDIT-CRITERIA-DATA.
  4619         16  EC-CO-MONTH-END-DT       PIC XX.
  4620         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4621         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4622         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4623         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4624         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4625         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4626         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4627         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4628         16  EC-CO-REM-TERM-CALC      PIC X.
  4629               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4630               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4631               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4632               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4633
  4634         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4635               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4636               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4637               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4638               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4639               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4640               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4641               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4642               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4643               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4644               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4645
  4646         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4647               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4648               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4649               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4650               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4651               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4652               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4653               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4654               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4655
  4656         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4657                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4658                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4659
  4660         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4661                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4662                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4663                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4664                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4665                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4666                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4667                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4668                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4669
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  87
* EL050.cbl
  4670         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4671               88  EC-BR-REDUCING                   VALUE 'R'.
  4672               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4673
  4674         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4675         16  EC-BR-LF-DESC             PIC X(10).
  4676         16  EC-BR-AH-DESC             PIC X(10).
  4677         16  EC-BR-LF-COMMENT          PIC X(10).
  4678         16  EC-BR-AH-COMMENT          PIC X(10).
  4679
  4680         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4681               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4682               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4683               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4684               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4685
  4686         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4687               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4688               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4689               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4690               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4691
  4692         16  EC-BR-LF-REFUND-CALC      PIC X.
  4693                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4694                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4695                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4696                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4697                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4698                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4699                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4700
  4701         16  EC-BR-AH-REFUND-CALC      PIC X.
  4702                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4703                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4704                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4705                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4706                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4707                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4708                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4709                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4710
  4711         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4712                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4713                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4714                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4715
  4716         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4717                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4718                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4719                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4720
  4721         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4722         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4723         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4724         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4725
  4726         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4727         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  88
* EL050.cbl
  4728                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4729                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4730                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4731                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4732
  4733         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4734               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4735               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4736               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4737               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4738               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4739
  4740         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4741               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4742               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4743               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4744               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4745               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4746
  4747         16  EC-ST-LF-REFUND-CALC      PIC X.
  4748                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4749                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4750                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4751                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4752                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4753                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4754                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4755                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4756
  4757         16  EC-ST-AH-REFUND-CALC      PIC X.
  4758                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4759                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4760                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4761                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4762                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4763                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4764                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4765                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4766
  4767         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4768         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4769         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4770         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4771         16  EC-AM-EXPIRATION-DT       PIC XX.
  4772         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4773         16  EC-AM-CLASS-CD            PIC XX.
  4774         16  EC-AM-LF-DEVIATION        PIC XXX.
  4775         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4776         16  EC-AM-AH-DEVIATION        PIC XXX.
  4777         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4778         16  EC-AM-PHONE-NO            PIC X(10).
  4779
  4780         16  EC-AM-LF-REFUND-CALC      PIC X.
  4781                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4782                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4783                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4784                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4785                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  89
* EL050.cbl
  4786                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4787                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4788
  4789         16  EC-AM-AH-REFUND-CALC      PIC X.
  4790                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4791                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4792                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4793                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4794                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4795                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4796                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4797
  4798         16  EC-AM-BEN-I-G-CD          PIC X.
  4799                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4800                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4801                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4802
  4803         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4804         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4805         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4806         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4807         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4808         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4809         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4810         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4811         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4812
  4813         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4814         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4815         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4816         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4817         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4818         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4819         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4820         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4821         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4822         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4823         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4824         16  EC-RT-LF-NSP-ST           PIC XX.
  4825         16  EC-RT-AH-NSP-ST           PIC XX.
  4826         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4827         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4828
  4829         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4830             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4831                                             'M' '5' '9' '2'.
  4832             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4833             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4834             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4835             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4836             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4837             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4838             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4839             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4840             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4841             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4842
  4843         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  90
* EL050.cbl
  4844             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4845                                             'M' '5' '9' '2'.
  4846             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4847             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4848             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4849             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4850             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4851             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4852             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4853             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4854             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4855             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4856
  4857         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4858         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4859         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4860         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4861         16  EC-CM-DEATH-DT            PIC XX.
  4862
  4863*DMD CUSTOM CODING FIELDS BELOW
  4864*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4865         16  EC-BR-DMD-RATING-SW       PIC X.
  4866                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4867                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4868                 88  NO-DMD-RATING               VALUE 'N'.
  4869
  4870         16  EC-NEW-CERT               PIC X(11).
  4871         16  EC-NEW-STATE              PIC XX.
  4872         16  FILLER                    PIC X.
  4873*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4874         16  OVER-SHORT-EDIT-FIELDS.
  4875             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4876             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4877             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4878             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4879             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4880             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4881             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4882             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4883             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4884         16  FILLER                    PIC X(71).
  4885******************************************************************
  4886
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  91
* EL050.cbl
  4888*    COPY ELCDIFRD.
  4889******************************************************************
  4890*                                                                *
  4891*                                                                *
  4892*                            ELCDIFRD.                           *
  4893*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4894*                            VMOD=2.004                          *
  4895*                                                                *
  4896*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4897*                                                                *
  4898******************************************************************
  4899*
  4900  01  WS-DIFFERENCE-CALCULATION.
  4901        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4902        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4903        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4904        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4905        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4906        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4907        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4908        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4909        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4910        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4911        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4912
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  92
* EL050.cbl
  4914****************************************************************
  4915*
  4916* Copyright (c) 2007 by Clerity Solutions, Inc.
  4917* All rights reserved.
  4918*
  4919****************************************************************
  4920 01  DFHEIV.
  4921   02  DFHEIV0               PIC X(35).
  4922   02  DFHEIV1               PIC X(08).
  4923   02  DFHEIV2               PIC X(08).
  4924   02  DFHEIV3               PIC X(08).
  4925   02  DFHEIV4               PIC X(06).
  4926   02  DFHEIV5               PIC X(04).
  4927   02  DFHEIV6               PIC X(04).
  4928   02  DFHEIV7               PIC X(02).
  4929   02  DFHEIV8               PIC X(02).
  4930   02  DFHEIV9               PIC X(01).
  4931   02  DFHEIV10              PIC S9(7) COMP-3.
  4932   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4933   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4934   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4935   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4936   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4937   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4938   02  DFHEIV17              PIC X(04).
  4939   02  DFHEIV18              PIC X(04).
  4940   02  DFHEIV19              PIC X(04).
  4941   02  DFHEIV20              USAGE IS POINTER.
  4942   02  DFHEIV21              USAGE IS POINTER.
  4943   02  DFHEIV22              USAGE IS POINTER.
  4944   02  DFHEIV23              USAGE IS POINTER.
  4945   02  DFHEIV24              USAGE IS POINTER.
  4946   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4947   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4948   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4949   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4950   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4951   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4952   02  FILLER                PIC X(02).
  4953   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4954   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4955   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4956   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4957   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4958 LINKAGE  SECTION.
  4959*****************************************************************
  4960*                                                               *
  4961* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4962* All rights reserved.                                          *
  4963*                                                               *
  4964*****************************************************************
  4965 01  dfheiblk.
  4966     02  eibtime          pic s9(7) comp-3.
  4967     02  eibdate          pic s9(7) comp-3.
  4968     02  eibtrnid         pic x(4).
  4969     02  eibtaskn         pic s9(7) comp-3.
  4970     02  eibtrmid         pic x(4).
  4971     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  93
* EL050.cbl
  4972     02  eibcposn         pic s9(4) comp.
  4973     02  eibcalen         pic s9(4) comp.
  4974     02  eibaid           pic x(1).
  4975     02  eibfiller1       pic x(1).
  4976     02  eibfn            pic x(2).
  4977     02  eibfiller2       pic x(2).
  4978     02  eibrcode         pic x(6).
  4979     02  eibfiller3       pic x(2).
  4980     02  eibds            pic x(8).
  4981     02  eibreqid         pic x(8).
  4982     02  eibrsrce         pic x(8).
  4983     02  eibsync          pic x(1).
  4984     02  eibfree          pic x(1).
  4985     02  eibrecv          pic x(1).
  4986     02  eibsend          pic x(1).
  4987     02  eibatt           pic x(1).
  4988     02  eibeoc           pic x(1).
  4989     02  eibfmh           pic x(1).
  4990     02  eibcompl         pic x(1).
  4991     02  eibsig           pic x(1).
  4992     02  eibconf          pic x(1).
  4993     02  eiberr           pic x(1).
  4994     02  eibrldbk         pic x(1).
  4995     02  eiberrcd         pic x(4).
  4996     02  eibsynrb         pic x(1).
  4997     02  eibnodat         pic x(1).
  4998     02  eibfiller5       pic x(2).
  4999     02  eibresp          pic 9(09) comp.
  5000     02  eibresp2         pic 9(09) comp.
  5001     02  dfheigdj         pic s9(4) comp.
  5002     02  dfheigdk         pic s9(4) comp.
  5003
  5004 01  DFHCOMMAREA                   PIC X(1036).
  5005
  5006*01 PARMLIST .
  5007*    02  FILLER                    PIC S9(8)   COMP.
  5008*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5009*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5010*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5011*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5012*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5013*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5014*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5015
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  94
* EL050.cbl
  5017*    COPY ELCCNTL.
  5018******************************************************************
  5019*                                                                *
  5020*                                                                *
  5021*                            ELCCNTL.                            *
  5022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5023*                            VMOD=2.059                          *
  5024*                                                                *
  5025*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5026*                                                                *
  5027*   FILE TYPE = VSAM,KSDS                                        *
  5028*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5029*                                                                *
  5030*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5031*       ALTERNATE INDEX = NONE                                   *
  5032*                                                                *
  5033*   LOG = YES                                                    *
  5034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5035******************************************************************
  5036*                   C H A N G E   L O G
  5037*
  5038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5039*-----------------------------------------------------------------
  5040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5041* EFFECTIVE    NUMBER
  5042*-----------------------------------------------------------------
  5043* 082503                   PEMA  ADD BENEFIT GROUP
  5044* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5045* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5046* 092705    2005050300006  PEMA  ADD SPP LEASES
  5047* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5048* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5049* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5050* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5051* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5052* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5053* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5054* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5055* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5056* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5057******************************************************************
  5058*
  5059 01  CONTROL-FILE.
  5060     12  CF-RECORD-ID                       PIC XX.
  5061         88  VALID-CF-ID                        VALUE 'CF'.
  5062
  5063     12  CF-CONTROL-PRIMARY.
  5064         16  CF-COMPANY-ID                  PIC XXX.
  5065         16  CF-RECORD-TYPE                 PIC X.
  5066             88  CF-COMPANY-MASTER              VALUE '1'.
  5067             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5068             88  CF-STATE-MASTER                VALUE '3'.
  5069             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5070             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5071             88  CF-CARRIER-MASTER              VALUE '6'.
  5072             88  CF-MORTALITY-MASTER            VALUE '7'.
  5073             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5074             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  95
* EL050.cbl
  5075             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5076             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5077             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5078             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5079             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5080             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5081             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5082             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5083             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5084         16  CF-ACCESS-CD-GENL              PIC X(4).
  5085         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5086             20  CF-PROCESSOR               PIC X(4).
  5087         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5088             20  CF-STATE-CODE              PIC XX.
  5089             20  FILLER                     PIC XX.
  5090         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5091             20  FILLER                     PIC XX.
  5092             20  CF-HI-BEN-IN-REC           PIC XX.
  5093         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5094             20  FILLER                     PIC XXX.
  5095             20  CF-CARRIER-CNTL            PIC X.
  5096         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5097             20  FILLER                     PIC XX.
  5098             20  CF-HI-TYPE-IN-REC          PIC 99.
  5099         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5100             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5101                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5102             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5103             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5104         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5105             20  FILLER                     PIC X.
  5106             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5107         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5108             20  FILLER                     PIC XX.
  5109             20  CF-MORTGAGE-PLAN           PIC XX.
  5110         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5111
  5112     12  CF-LAST-MAINT-DT                   PIC XX.
  5113     12  CF-LAST-MAINT-BY                   PIC X(4).
  5114     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5115
  5116     12  CF-RECORD-BODY                     PIC X(728).
  5117
  5118
  5119****************************************************************
  5120*             COMPANY MASTER RECORD                            *
  5121****************************************************************
  5122
  5123     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5124         16  CF-COMPANY-ADDRESS.
  5125             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5126             20  CF-CL-IN-CARE-OF           PIC X(30).
  5127             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5128             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5129             20  CF-CL-CITY-STATE           PIC X(30).
  5130             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5131             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5132         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  96
* EL050.cbl
  5133         16  CF-COMPANY-PASSWORD            PIC X(8).
  5134         16  CF-SECURITY-OPTION             PIC X.
  5135             88  ALL-SECURITY                   VALUE '1'.
  5136             88  COMPANY-VERIFY                 VALUE '2'.
  5137             88  PROCESSOR-VERIFY               VALUE '3'.
  5138             88  NO-SECURITY                    VALUE '4'.
  5139             88  ALL-BUT-TERM                   VALUE '5'.
  5140         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5141             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5142         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5143             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5144         16  CF-INFORCE-LOCATION            PIC X.
  5145             88  CERTS-ARE-ONLINE               VALUE '1'.
  5146             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5147             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5148         16  CF-LOWER-CASE-LETTERS          PIC X.
  5149         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5150             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5151             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5152             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5153             88  CF-ACCNT-CNTL                  VALUE '3'.
  5154             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5155
  5156         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5157         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5158
  5159         16  CF-LGX-CREDIT-USER             PIC X.
  5160             88  CO-IS-NOT-USER                 VALUE 'N'.
  5161             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5162
  5163         16 CF-CREDIT-CALC-CODES.
  5164             20  CF-CR-REM-TERM-CALC PIC X.
  5165               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5166               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5167               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5168               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5169               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5170               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5171               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5172             20  CF-CR-R78-METHOD           PIC X.
  5173               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5174               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5175
  5176         16  CF-CLAIM-CONTROL-COUNTS.
  5177             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5178                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5179
  5180             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5181                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5182
  5183             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5184                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5185
  5186             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5187                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5188
  5189         16  CF-CURRENT-MONTH-END           PIC XX.
  5190
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  97
* EL050.cbl
  5191         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5192             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5193             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5194             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5195             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5196                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5197                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5198             20  CF-CO-PREM-REJECT-SW       PIC X.
  5199                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5200                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5201             20  CF-CO-REF-REJECT-SW        PIC X.
  5202                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5203                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5204
  5205         16  CF-CO-REPORTING-DT             PIC XX.
  5206         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5207         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5208           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5209           88  CF-CO-MONTH-END                  VALUE '1'.
  5210
  5211         16  CF-LGX-CLAIM-USER              PIC X.
  5212             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5213             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5214
  5215         16  CF-CREDIT-EDIT-CONTROLS.
  5216             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5217             20  CF-MIN-AGE                 PIC 99.
  5218             20  CF-DEFAULT-AGE             PIC 99.
  5219             20  CF-MIN-TERM                PIC S999      COMP-3.
  5220             20  CF-MAX-TERM                PIC S999      COMP-3.
  5221             20  CF-DEFAULT-SEX             PIC X.
  5222             20  CF-JOINT-AGE-INPUT         PIC X.
  5223                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5224             20  CF-BIRTH-DATE-INPUT        PIC X.
  5225                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5226             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5227                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5228                 88  CF-ZERO-CARRIER            VALUE '1'.
  5229                 88  CF-ZERO-GROUPING           VALUE '2'.
  5230                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5231             20  CF-EDIT-SW                 PIC X.
  5232                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5233             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5234             20  CF-CR-PR-METHOD            PIC X.
  5235               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5236               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5237             20  FILLER                     PIC X.
  5238
  5239         16  CF-CREDIT-MISC-CONTROLS.
  5240             20  CF-REIN-TABLE-SW           PIC X.
  5241                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5242             20  CF-COMP-TABLE-SW           PIC X.
  5243                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5244             20  CF-EXPERIENCE-RETENTION-AGE
  5245                                            PIC S9        COMP-3.
  5246             20  CF-CONVERSION-DT           PIC XX.
  5247             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5248             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  98
* EL050.cbl
  5249                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5250                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5251
  5252             20  CF-CR-CHECK-NO-CONTROL.
  5253                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5254                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5255                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5256                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5257                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5258                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5259
  5260                 24  CF-CR-CHECK-COUNT       REDEFINES
  5261                     CF-CR-CHECK-COUNTER      PIC X(4).
  5262
  5263                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5264                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5265
  5266                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5267                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5268                 24  CF-MAIL-PROCESSING       PIC X.
  5269                     88  MAIL-PROCESSING          VALUE 'Y'.
  5270
  5271         16  CF-MISC-SYSTEM-CONTROL.
  5272             20  CF-SYSTEM-C                 PIC X.
  5273                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5274             20  CF-SYSTEM-D                 PIC X.
  5275                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5276             20  CF-SOC-SEC-NO-SW            PIC X.
  5277                 88  SOC-SEC-NO-USED             VALUE '1'.
  5278             20  CF-MEMBER-NO-SW             PIC X.
  5279                 88  MEMBER-NO-USED              VALUE '1'.
  5280             20  CF-TAX-ID-NUMBER            PIC X(11).
  5281             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5282             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5283                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5284                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5285                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5286                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5287             20  CF-SYSTEM-E                 PIC X.
  5288                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5289
  5290         16  CF-LGX-LIFE-USER               PIC X.
  5291             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5292             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5293
  5294         16  CF-CR-MONTH-END-DT             PIC XX.
  5295
  5296         16  CF-FILE-MAINT-DATES.
  5297             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5298                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5299             20  CF-LAST-BATCH       REDEFINES
  5300                 CF-LAST-BATCH-NO               PIC X(4).
  5301             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5302             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5303             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5304             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5305             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5306             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page  99
* EL050.cbl
  5307             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5308             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5309             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5310             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5311
  5312         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5313         16  FILLER                         PIC X.
  5314
  5315         16  CF-ALT-MORT-CODE               PIC X(4).
  5316         16  CF-MEMBER-CAPTION              PIC X(10).
  5317
  5318         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5319             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5320             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5321             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5322             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5323             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5324
  5325         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5326
  5327         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5328         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5329         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5330         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5331
  5332         16  CF-AH-OVERRIDE-L1              PIC X.
  5333         16  CF-AH-OVERRIDE-L2              PIC XX.
  5334         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5335         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5336
  5337         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5338         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5339
  5340         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5341         16  CF-AR-LAST-EL860-DT            PIC XX.
  5342         16  CF-MP-MONTH-END-DT             PIC XX.
  5343
  5344         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5345         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5346             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5347
  5348         16  CF-AR-MONTH-END-DT             PIC XX.
  5349
  5350         16  CF-CRDTCRD-USER                PIC X.
  5351             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5352             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5353
  5354         16  CF-CC-MONTH-END-DT             PIC XX.
  5355
  5356         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5357
  5358         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5359             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5360             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5361             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5362         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5363         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5364         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 100
* EL050.cbl
  5365         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5366             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5367             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5368         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5369         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5370         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5371             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5372         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5373
  5374         16  CF-CL-ZIP-CODE.
  5375             20  CF-CL-ZIP-PRIME.
  5376                 24  CF-CL-ZIP-1ST          PIC X.
  5377                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5378                 24  FILLER                 PIC X(4).
  5379             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5380         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5381             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5382             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5383             20  FILLER                     PIC XXX.
  5384
  5385         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5386         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5387         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5388         16  CF-CO-OPTION-START-DATE        PIC XX.
  5389         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5390           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5391                                                      '3' '4'.
  5392           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5393           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5394           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5395           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5396           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5397           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5398
  5399         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5400
  5401         16  CF-PAYMENT-APPROVAL-LEVELS.
  5402             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5403             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5404             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5405             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5406             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5407             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5408
  5409         16  CF-END-USER-REPORTING-USER     PIC X.
  5410             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5411             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5412
  5413         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5414             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5415             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5416
  5417         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5418
  5419         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5420         16  FILLER                         PIC X.
  5421
  5422         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 101
* EL050.cbl
  5423             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5424             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5425             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5426
  5427         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5428
  5429         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5430             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5431             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5432
  5433         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5434             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5435             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5436
  5437         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5438
  5439         16  CF-CO-ACH-ID-CODE              PIC  X.
  5440             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5441             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5442             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5443         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5444         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5445         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5446         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5447         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5448         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5449         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5450         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5451         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5452                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5453         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5454                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5455
  5456         16  CF-CO-OVER-SHORT.
  5457             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5458             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5459
  5460*         16  FILLER                         PIC X(102).
  5461         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5462             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5463             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5464
  5465         16  CF-AH-APPROVAL-DAYS.
  5466             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5467             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5468             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5469             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5470
  5471         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5472
  5473         16  CF-APPROV-LEV-5.
  5474             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5475             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5476             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5477
  5478         16  FILLER                         PIC X(68).
  5479****************************************************************
  5480*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 102
* EL050.cbl
  5481****************************************************************
  5482
  5483     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5484         16  CF-PROCESSOR-NAME              PIC X(30).
  5485         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5486         16  CF-PROCESSOR-TITLE             PIC X(26).
  5487         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5488                 88  MESSAGE-YES                VALUE 'Y'.
  5489                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5490
  5491*****************************************************
  5492****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5493****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5494****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5495****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5496*****************************************************
  5497
  5498         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5499             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5500             20  CF-APPLICATION-FORCE       PIC X.
  5501             20  CF-INDIVIDUAL-APP.
  5502                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5503                     28  CF-BROWSE-APP      PIC X.
  5504                     28  CF-UPDATE-APP      PIC X.
  5505
  5506         16  CF-CURRENT-TERM-ON             PIC X(4).
  5507         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5508             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5509             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5510             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5511             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5512             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5513             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5514             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5515         16  CF-PROCESSOR-CARRIER           PIC X.
  5516             88  NO-CARRIER-SECURITY            VALUE ' '.
  5517         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5518             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5519         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5520             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5521         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5522             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5523
  5524         16  CF-PROC-SYS-ACCESS-SW.
  5525             20  CF-PROC-CREDIT-CLAIMS-SW.
  5526                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5527                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5528                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5529                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5530             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5531                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5532                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5533             20  CF-PROC-LIFE-GNRLDGR-SW.
  5534                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5535                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5536                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5537                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5538             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 103
* EL050.cbl
  5539                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5540                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5541         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5542             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5543             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5544         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5545
  5546         16  CF-APPROVAL-LEVEL                  PIC X.
  5547             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5548             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5549             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5550             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5551             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5552
  5553         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5554
  5555         16  CF-LANGUAGE-TYPE                   PIC X.
  5556             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5557             88  CF-LANG-IS-FR                      VALUE 'F'.
  5558
  5559         16  CF-CSR-IND                         PIC X.
  5560         16  FILLER                             PIC X(239).
  5561
  5562****************************************************************
  5563*             PROCESSOR/REMINDERS RECORD                       *
  5564****************************************************************
  5565
  5566     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5567         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5568             20  CF-START-REMIND-DT         PIC XX.
  5569             20  CF-END-REMIND-DT           PIC XX.
  5570             20  CF-REMINDER-TEXT           PIC X(50).
  5571         16  FILLER                         PIC X(296).
  5572
  5573
  5574****************************************************************
  5575*             STATE MASTER RECORD                              *
  5576****************************************************************
  5577
  5578     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5579         16  CF-STATE-ABBREVIATION          PIC XX.
  5580         16  CF-STATE-NAME                  PIC X(25).
  5581         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5582         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5583             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5584             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5585             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5586             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5587                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5588                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5589             20  CF-ST-PREM-REJECT-SW       PIC X.
  5590                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5591                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5592             20  CF-ST-REF-REJECT-SW        PIC X.
  5593                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5594                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5595         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5596         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 104
* EL050.cbl
  5597         16  CF-ST-REFUND-RULES.
  5598             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5599             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5600             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5601         16  CF-ST-FST-PMT-EXTENSION.
  5602             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5603             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5604                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5605                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5606                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5607                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5608         16  CF-ST-STATE-CALL.
  5609             20  CF-ST-CALL-UNEARNED        PIC X.
  5610             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5611             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5612         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5613             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5614             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5615         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5616         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5617         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5618         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5619         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5620         16  FILLER                         PIC X.
  5621         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5622             20  CF-ST-BENEFIT-CD           PIC XX.
  5623             20  CF-ST-BENEFIT-KIND         PIC X.
  5624                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5625                 88  CF-ST-AH-KIND              VALUE 'A'.
  5626             20  CF-ST-REM-TERM-CALC        PIC X.
  5627                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5628                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5629                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5630                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5631                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5632                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5633                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5634                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5635
  5636             20  CF-ST-REFUND-CALC          PIC X.
  5637                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5638                 88  ST-REFD-BY-R78             VALUE '1'.
  5639                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5640                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5641                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5642                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5643                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5644                 88  ST-REFD-UTAH               VALUE '7'.
  5645                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5646                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5647                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5648
  5649             20  CF-ST-EARNING-CALC         PIC X.
  5650                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5651                 88  ST-EARN-BY-R78             VALUE '1'.
  5652                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5653                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5654                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 105
* EL050.cbl
  5655                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5656                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5657                 88  ST-EARN-MEAN               VALUE '8'.
  5658                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5659
  5660             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5661                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5662                 88  ST-OVRD-BY-R78             VALUE '1'.
  5663                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5664                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5665                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5666                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5667                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5668                 88  ST-OVRD-MEAN               VALUE '8'.
  5669                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5670             20  cf-st-extra-periods        pic 9.
  5671*            20  FILLER                     PIC X.
  5672
  5673         16  CF-ST-COMMISSION-CAPS.
  5674             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5675             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5676             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5677             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5678         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5679                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5680
  5681         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5682
  5683         16  CF-ST-STATUTORY-INTEREST.
  5684             20  CF-ST-STAT-DATE-FROM       PIC X.
  5685                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5686                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5687             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5688             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5689             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5690             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5691             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5692
  5693         16  CF-ST-OVER-SHORT.
  5694             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5695             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5696
  5697         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5698
  5699         16  CF-ST-RT-CALC                  PIC X.
  5700
  5701         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5702         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5703         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5704         16  CF-ST-RF-LR-CALC               PIC X.
  5705         16  CF-ST-RF-LL-CALC               PIC X.
  5706         16  CF-ST-RF-LN-CALC               PIC X.
  5707         16  CF-ST-RF-AH-CALC               PIC X.
  5708         16  CF-ST-RF-CP-CALC               PIC X.
  5709*        16  FILLER                         PIC X(206).
  5710*CIDMOD         16  FILLER                         PIC X(192).
  5711         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5712             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 106
* EL050.cbl
  5713         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5714         16  CF-ST-VFY-2ND-BENE             PIC X.
  5715         16  CF-ST-CAUSAL-STATE             PIC X.
  5716         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5717         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5718         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5719             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5720         16  CF-ST-NET-ONLY-STATE           PIC X.
  5721             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5722         16  FILLER                         PIC X(181).
  5723
  5724****************************************************************
  5725*             BENEFIT MASTER RECORD                            *
  5726****************************************************************
  5727
  5728     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5729         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5730             20  CF-BENEFIT-CODE            PIC XX.
  5731             20  CF-BENEFIT-NUMERIC  REDEFINES
  5732                 CF-BENEFIT-CODE            PIC XX.
  5733             20  CF-BENEFIT-ALPHA           PIC XXX.
  5734             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5735             20  CF-BENEFIT-COMMENT         PIC X(10).
  5736
  5737             20  CF-LF-COVERAGE-TYPE        PIC X.
  5738                 88  CF-REDUCING                VALUE 'R'.
  5739                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5740
  5741             20  CF-SPECIAL-CALC-CD         PIC X.
  5742                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5743                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5744                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5745                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5746                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5747                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5748                 88  CF-FARM-PLAN               VALUE 'F'.
  5749                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5750                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5751                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5752                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5753                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5754                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5755                 88  CF-PRUDENTIAL              VALUE 'P'.
  5756                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5757                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5758                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5759                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5760                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5761                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5762
  5763             20  CF-JOINT-INDICATOR         PIC X.
  5764                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5765
  5766*            20  FILLER                     PIC X(12).
  5767             20  cf-maximum-benefits        pic s999 comp-3.
  5768             20  FILLER                     PIC X(09).
  5769             20  CF-BENEFIT-CATEGORY        PIC X.
  5770             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 107
* EL050.cbl
  5771
  5772             20  CF-CO-REM-TERM-CALC        PIC X.
  5773                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5774                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5775                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5776                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5777                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5778
  5779             20  CF-CO-EARNINGS-CALC        PIC X.
  5780                 88  CO-EARN-BY-R78             VALUE '1'.
  5781                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5782                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5783                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5784                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5785                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5786                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5787                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5788
  5789             20  CF-CO-REFUND-CALC          PIC X.
  5790                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5791                 88  CO-REFD-BY-R78             VALUE '1'.
  5792                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5793                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5794                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5795                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5796                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5797                 88  CO-REFD-MEAN               VALUE '8'.
  5798                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5799                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5800                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5801
  5802             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5803                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5804                 88  CO-OVRD-BY-R78             VALUE '1'.
  5805                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5806                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5807                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5808                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5809                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5810                 88  CO-OVRD-MEAN               VALUE '8'.
  5811                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5812
  5813             20  CF-CO-BEN-I-G-CD           PIC X.
  5814                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5815                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5816                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5817
  5818         16  FILLER                         PIC X(304).
  5819
  5820
  5821****************************************************************
  5822*             CARRIER MASTER RECORD                            *
  5823****************************************************************
  5824
  5825     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5826         16  CF-ADDRESS-DATA.
  5827             20  CF-MAIL-TO-NAME            PIC X(30).
  5828             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 108
* EL050.cbl
  5829             20  CF-ADDRESS-LINE-1          PIC X(30).
  5830             20  CF-ADDRESS-LINE-2          PIC X(30).
  5831             20  CF-CITY-STATE              PIC X(30).
  5832             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5833             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5834
  5835         16  CF-CLAIM-NO-CONTROL.
  5836             20  CF-CLAIM-NO-METHOD         PIC X.
  5837                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5838                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5839                 88  CLAIM-NO-SEQ               VALUE '3'.
  5840                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5841             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5842                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5843                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5844                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5845
  5846         16  CF-CHECK-NO-CONTROL.
  5847             20  CF-CHECK-NO-METHOD         PIC X.
  5848                 88  CHECK-NO-MANUAL            VALUE '1'.
  5849                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5850                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5851                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5852             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5853                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5854
  5855         16  CF-DOMICILE-STATE              PIC XX.
  5856
  5857         16  CF-EXPENSE-CONTROLS.
  5858             20  CF-EXPENSE-METHOD          PIC X.
  5859                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5860                 88  DOLLARS-PER-PMT            VALUE '2'.
  5861                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5862                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5863             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5864             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5865
  5866         16  CF-CORRESPONDENCE-CONTROL.
  5867             20  CF-LETTER-RESEND-OPT       PIC X.
  5868                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5869                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5870             20  FILLER                     PIC X(4).
  5871
  5872         16  CF-RESERVE-CONTROLS.
  5873             20  CF-MANUAL-SW               PIC X.
  5874                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5875             20  CF-FUTURE-SW               PIC X.
  5876                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5877             20  CF-PTC-SW                  PIC X.
  5878                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5879             20  CF-IBNR-SW                 PIC X.
  5880                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5881             20  CF-PTC-LF-SW               PIC X.
  5882                 88  CF-LF-PTC-USED             VALUE '1'.
  5883             20  CF-CDT-ACCESS-METHOD       PIC X.
  5884                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5885                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5886                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 109
* EL050.cbl
  5887             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5888
  5889         16  CF-CLAIM-CALC-METHOD           PIC X.
  5890             88  360-PLUS-MONTHS                VALUE '1'.
  5891             88  365-PLUS-MONTHS                VALUE '2'.
  5892             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5893             88  360-DAILY                      VALUE '4'.
  5894             88  365-DAILY                      VALUE '5'.
  5895
  5896         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5897         16  FILLER                         PIC X(11).
  5898
  5899         16  CF-LIMIT-AMOUNTS.
  5900             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5901             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5902             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5903             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5904             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5905             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5906             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5907             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5908             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5909             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5910
  5911         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5912         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5913         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5914
  5915         16  CF-ZIP-CODE.
  5916             20  CF-ZIP-PRIME.
  5917                 24  CF-ZIP-1ST             PIC X.
  5918                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5919                 24  FILLER                 PIC X(4).
  5920             20  CF-ZIP-PLUS4               PIC X(4).
  5921         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5922             20  CF-CAN-POSTAL-1            PIC XXX.
  5923             20  CF-CAN-POSTAL-2            PIC XXX.
  5924             20  FILLER                     PIC XXX.
  5925
  5926         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5927         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5928         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5929
  5930         16  CF-RATING-SWITCH               PIC X.
  5931             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5932             88  CF-NO-RATING                   VALUE 'N'.
  5933
  5934         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5935
  5936         16  CF-CARRIER-OVER-SHORT.
  5937             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5938             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5939
  5940         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5941         16  CF-SECPAY-SWITCH               PIC X.
  5942             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5943             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5944         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 110
* EL050.cbl
  5945         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5946         16  FILLER                         PIC X(444).
  5947*        16  FILLER                         PIC X(452).
  5948
  5949
  5950****************************************************************
  5951*             MORTALITY MASTER RECORD                          *
  5952****************************************************************
  5953
  5954     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5955         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5956                                INDEXED BY CF-MORT-NDX.
  5957             20  CF-MORT-TABLE              PIC X(5).
  5958             20  CF-MORT-TABLE-TYPE         PIC X.
  5959                 88  CF-MORT-JOINT              VALUE 'J'.
  5960                 88  CF-MORT-SINGLE             VALUE 'S'.
  5961                 88  CF-MORT-COMBINED           VALUE 'C'.
  5962                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5963                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5964             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5965             20  CF-MORT-AGE-METHOD         PIC XX.
  5966                 88  CF-AGE-LAST                VALUE 'AL'.
  5967                 88  CF-AGE-NEAR                VALUE 'AN'.
  5968             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5969             20  CF-MORT-ADJUSTMENT-DIRECTION
  5970                                            PIC X.
  5971                 88  CF-MINUS                   VALUE '-'.
  5972                 88  CF-PLUS                    VALUE '+'.
  5973             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5974             20  CF-MORT-JOINT-CODE         PIC X.
  5975                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5976             20  CF-MORT-PC-Q               PIC X.
  5977                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5978             20  CF-MORT-TABLE-CODE         PIC X(4).
  5979             20  CF-MORT-COMMENTS           PIC X(15).
  5980             20  FILLER                     PIC X(14).
  5981
  5982         16  FILLER                         PIC X(251).
  5983
  5984
  5985****************************************************************
  5986*             BUSSINESS TYPE MASTER RECORD                     *
  5987****************************************************************
  5988
  5989     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5990* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5991* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5992* AND RECORD 05 IS TYPES 81-99
  5993         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5994             20  CF-BUSINESS-TITLE          PIC  X(19).
  5995             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5996                                            PIC S9V9(4) COMP-3.
  5997             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5998             20  FILLER                     PIC  X.
  5999         16  FILLER                         PIC  X(248).
  6000
  6001
  6002****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 111
* EL050.cbl
  6003*             TERMINAL MASTER RECORD                           *
  6004****************************************************************
  6005
  6006     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6007
  6008         16  CF-COMPANY-TERMINALS.
  6009             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6010                                  PIC X(4).
  6011         16  FILLER               PIC X(248).
  6012
  6013
  6014****************************************************************
  6015*             LIFE EDIT MASTER RECORD                          *
  6016****************************************************************
  6017
  6018     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6019         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6020             20  CF-LIFE-CODE-IN            PIC XX.
  6021             20  CF-LIFE-CODE-OUT           PIC XX.
  6022         16  FILLER                         PIC X(248).
  6023
  6024
  6025****************************************************************
  6026*             AH EDIT MASTER RECORD                            *
  6027****************************************************************
  6028
  6029     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6030         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6031             20  CF-AH-CODE-IN              PIC XXX.
  6032             20  CF-AH-CODE-OUT             PIC XX.
  6033         16  FILLER                         PIC X(248).
  6034
  6035
  6036****************************************************************
  6037*             CREDIBILITY TABLES                               *
  6038****************************************************************
  6039
  6040     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6041         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6042                             INDEXED BY CF-CRDB-NDX.
  6043             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6044             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6045             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6046         16  FILLER                         PIC  X(332).
  6047
  6048
  6049****************************************************************
  6050*             REPORT CUSTOMIZATION RECORD                      *
  6051****************************************************************
  6052
  6053     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6054         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6055             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6056             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6057             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6058**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6059****       A T-TRANSFER.                                   ****
  6060             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 112
* EL050.cbl
  6061
  6062         16  FILLER                         PIC XX.
  6063
  6064         16  CF-CARRIER-CNTL-OPT.
  6065             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6066                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6067                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6068             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6069                                            PIC X.
  6070         16  CF-GROUP-CNTL-OPT.
  6071             20  CF-GROUP-OPT-SEQ           PIC 9.
  6072                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6073                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6074             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6075                                            PIC X(6).
  6076         16  CF-STATE-CNTL-OPT.
  6077             20  CF-STATE-OPT-SEQ           PIC 9.
  6078                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6079                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6080             20  CF-STATE-SELECT OCCURS 3 TIMES
  6081                                            PIC XX.
  6082         16  CF-ACCOUNT-CNTL-OPT.
  6083             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6084                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6085                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6086             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6087                                            PIC X(10).
  6088         16  CF-BUS-TYP-CNTL-OPT.
  6089             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6090                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6091                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6092             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6093                                            PIC XX.
  6094         16  CF-LF-TYP-CNTL-OPT.
  6095             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6096                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6097                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6098             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6099                                            PIC XX.
  6100         16  CF-AH-TYP-CNTL-OPT.
  6101             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6102                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6103                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6104             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6105                                            PIC XX.
  6106         16  CF-REPTCD1-CNTL-OPT.
  6107             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6108                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6109                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6110             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6111                                            PIC X(10).
  6112         16  CF-REPTCD2-CNTL-OPT.
  6113             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6114                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6115                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6116             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6117                                            PIC X(10).
  6118         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 113
* EL050.cbl
  6119             20  CF-USER1-OPT-SEQ           PIC 9.
  6120                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6121                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6122             20  CF-USER1-SELECT OCCURS 3 TIMES
  6123                                            PIC X(10).
  6124         16  CF-USER2-CNTL-OPT.
  6125             20  CF-USER2-OPT-SEQ           PIC 9.
  6126                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6127                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6128             20  CF-USER2-SELECT OCCURS 3 TIMES
  6129                                            PIC X(10).
  6130         16  CF-USER3-CNTL-OPT.
  6131             20  CF-USER3-OPT-SEQ           PIC 9.
  6132                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6133                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6134             20  CF-USER3-SELECT OCCURS 3 TIMES
  6135                                            PIC X(10).
  6136         16  CF-USER4-CNTL-OPT.
  6137             20  CF-USER4-OPT-SEQ           PIC 9.
  6138                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6139                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6140             20  CF-USER4-SELECT OCCURS 3 TIMES
  6141                                            PIC X(10).
  6142         16  CF-USER5-CNTL-OPT.
  6143             20  CF-USER5-OPT-SEQ           PIC 9.
  6144                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6145                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6146             20  CF-USER5-SELECT OCCURS 3 TIMES
  6147                                            PIC X(10).
  6148         16  CF-REINS-CNTL-OPT.
  6149             20  CF-REINS-OPT-SEQ           PIC 9.
  6150                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6151                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6152             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6153                 24  CF-REINS-PRIME         PIC XXX.
  6154                 24  CF-REINS-SUB           PIC XXX.
  6155
  6156         16  CF-AGENT-CNTL-OPT.
  6157             20  CF-AGENT-OPT-SEQ           PIC 9.
  6158                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6159                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6160             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6161                                            PIC X(10).
  6162
  6163         16  FILLER                         PIC X(43).
  6164
  6165         16  CF-LOSS-RATIO-SELECT.
  6166             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6167             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6168         16  CF-ENTRY-DATE-SELECT.
  6169             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6170             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6171         16  CF-EFFECTIVE-DATE-SELECT.
  6172             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6173             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6174
  6175         16  CF-EXCEPTION-LIST-IND          PIC X.
  6176             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 114
* EL050.cbl
  6177
  6178         16  FILLER                         PIC X(318).
  6179
  6180****************************************************************
  6181*                  EXCEPTION REPORTING RECORD                  *
  6182****************************************************************
  6183
  6184     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6185         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6186             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6187
  6188         16  CF-COMBINED-LIFE-AH-OPT.
  6189             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6190             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6191             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6192             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6193
  6194         16  CF-LIFE-OPT.
  6195             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6196             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6197             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6198             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6199             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6200             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6201             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6202             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6203             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6204             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6205
  6206         16  CF-AH-OPT.
  6207             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6208             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6209             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6210             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6211             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6212             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6213             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6214             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6215             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6216             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6217
  6218         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6219             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6220             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6221             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6222
  6223         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6224
  6225         16  FILLER                         PIC X(673).
  6226
  6227
  6228****************************************************************
  6229*             MORTGAGE SYSTEM PLAN RECORD                      *
  6230****************************************************************
  6231
  6232     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6233         16  CF-PLAN-TYPE                   PIC X.
  6234             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 115
* EL050.cbl
  6235             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6236             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6237         16  CF-PLAN-ABBREV                 PIC XXX.
  6238         16  CF-PLAN-DESCRIPT               PIC X(10).
  6239         16  CF-PLAN-NOTES                  PIC X(20).
  6240         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6241         16  CF-PLAN-UNDERWRITING.
  6242             20  CF-PLAN-TERM-DATA.
  6243                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6244                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6245             20  CF-PLAN-AGE-DATA.
  6246                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6247                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6248                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6249             20  CF-PLAN-BENEFIT-DATA.
  6250                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6251                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6252                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6253                                            PIC S9(7)V99  COMP-3.
  6254         16  CF-PLAN-POLICY-FORMS.
  6255             20  CF-POLICY-FORM             PIC X(12).
  6256             20  CF-MASTER-APPLICATION      PIC X(12).
  6257             20  CF-MASTER-POLICY           PIC X(12).
  6258         16  CF-PLAN-RATING.
  6259             20  CF-RATE-CODE               PIC X(5).
  6260             20  CF-SEX-RATING              PIC X.
  6261                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6262                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6263             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6264             20  CF-SUB-STD-TYPE            PIC X.
  6265                 88  CF-PCT-OF-PREM            VALUE '1'.
  6266                 88  CF-PCT-OF-BENE            VALUE '2'.
  6267         16  CF-PLAN-PREM-TOLERANCES.
  6268             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6269             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6270         16  CF-PLAN-PYMT-TOLERANCES.
  6271             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6272             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6273         16  CF-PLAN-MISC-DATA.
  6274             20  FILLER                     PIC X.
  6275             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6276             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6277         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6278         16  CF-PLAN-IND-GRP                PIC X.
  6279             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6280                                                     '1'.
  6281             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6282                                                     '2'.
  6283         16  CF-MIB-SEARCH-SW               PIC X.
  6284             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6285             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6286             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6287             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6288         16  CF-ALPHA-SEARCH-SW             PIC X.
  6289             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6290             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6291             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6292             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 116
* EL050.cbl
  6293             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6294             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6295             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6296             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6297             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6298             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6299                                                     'A' 'B' 'C'
  6300                                                     'X' 'Y' 'Z'.
  6301         16  CF-EFF-DT-RULE-SW              PIC X.
  6302             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6303             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6304             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6305             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6306             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6307         16  FILLER                         PIC X(4).
  6308         16  CF-HEALTH-QUESTIONS            PIC X.
  6309             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6310         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6311         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6312         16  CF-PLAN-SNGL-JNT               PIC X.
  6313             88  CF-COMBINED-PLAN              VALUE 'C'.
  6314             88  CF-JNT-PLAN                   VALUE 'J'.
  6315             88  CF-SNGL-PLAN                  VALUE 'S'.
  6316         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6317         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6318         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6319         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6320         16  CF-RERATE-CNTL                 PIC  X.
  6321             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6322             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6323             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6324             88  CF-AUTO-RECALC                 VALUE '4'.
  6325         16  CF-BENEFIT-TYPE                PIC  X.
  6326             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6327             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6328         16  CF-POLICY-FEE                  PIC S999V99
  6329                                                    COMP-3.
  6330         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6331         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6332         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6333         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6334         16  FILLER                         PIC  X(32).
  6335         16  CF-TERMINATION-FORM            PIC  X(04).
  6336         16  FILLER                         PIC  X(08).
  6337         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6338                                                       COMP-3.
  6339         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6340         16  CF-ISSUE-LETTER                PIC  X(4).
  6341         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6342         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6343             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6344             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6345         16  CF-MP-REFUND-CALC              PIC X.
  6346             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6347             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6348             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6349             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6350             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 117
* EL050.cbl
  6351             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6352             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6353             88  CF-MP-REFD-MEAN                VALUE '8'.
  6354         16  CF-ALT-RATE-CODE               PIC  X(5).
  6355
  6356
  6357         16  FILLER                         PIC X(498).
  6358****************************************************************
  6359*             MORTGAGE COMPANY MASTER RECORD                   *
  6360****************************************************************
  6361
  6362     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6363         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6364         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6365             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6366             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6367             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6368             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6369             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6370
  6371         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6372         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6373         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6374         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6375         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6376
  6377         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6378             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6379         16  CF-MP-RECON-USE-IND            PIC X(1).
  6380             88  CF-MP-USE-RECON             VALUE 'Y'.
  6381         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6382             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6383         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6384             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6385             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6386         16  FILLER                         PIC X(1).
  6387         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6388             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6389         16  CF-MORTG-MIB-VERSION           PIC X.
  6390             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6391             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6392             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6393         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6394             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6395                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6396             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6397                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6398             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6399                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6400             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6401                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6402             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6403                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6404             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6405                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6406         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6407         16  FILLER                         PIC X(7).
  6408         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 118
* EL050.cbl
  6409             20  CF-MORTG-MIB-COMM          PIC X(5).
  6410             20  CF-MORTG-MIB-TERM          PIC X(5).
  6411         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6412             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6413         16  FILLER                         PIC X(03).
  6414         16  CF-MP-CHECK-NO-CONTROL.
  6415             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6416                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6417                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6418                                                ' ' LOW-VALUES.
  6419                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6420                                               VALUE '3'.
  6421         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6422         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6423         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6424             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6425                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6426             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6427                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6428             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6429                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6430             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6431                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6432             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6433                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6434             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6435                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6436         16  CF-MORTG-BILLING-AREA.
  6437             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6438                                            PIC X.
  6439         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6440         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6441         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6442         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6443             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6444             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6445         16  FILLER                         PIC X.
  6446         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6447             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6448             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6449         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6450         16  FILLER                         PIC X(8).
  6451         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6452         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6453         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6454         16  CF-ACH-COMPANY-ID.
  6455             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6456                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6457                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6458                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6459             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6460         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6461             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6462         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6463             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6464             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6465         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6466         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 119
* EL050.cbl
  6467         16  FILLER                         PIC X(536).
  6468
  6469****************************************************************
  6470*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6471****************************************************************
  6472
  6473     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6474         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6475             20  CF-FEMALE-HEIGHT.
  6476                 24  CF-FEMALE-FT           PIC 99.
  6477                 24  CF-FEMALE-IN           PIC 99.
  6478             20  CF-FEMALE-MIN-WT           PIC 999.
  6479             20  CF-FEMALE-MAX-WT           PIC 999.
  6480         16  FILLER                         PIC X(428).
  6481
  6482     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6483         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6484             20  CF-MALE-HEIGHT.
  6485                 24  CF-MALE-FT             PIC 99.
  6486                 24  CF-MALE-IN             PIC 99.
  6487             20  CF-MALE-MIN-WT             PIC 999.
  6488             20  CF-MALE-MAX-WT             PIC 999.
  6489         16  FILLER                         PIC X(428).
  6490******************************************************************
  6491*             AUTOMATIC ACTIVITY RECORD                          *
  6492******************************************************************
  6493     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6494         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6495             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6496             20  CF-SYS-LETTER-ID           PIC X(04).
  6497             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6498             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6499             20  CF-SYS-RESET-SW            PIC X(01).
  6500             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6501             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6502
  6503         16  FILLER                         PIC X(50).
  6504
  6505         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6506             20  CF-USER-ACTIVE-SW          PIC X(01).
  6507             20  CF-USER-LETTER-ID          PIC X(04).
  6508             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6509             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6510             20  CF-USER-RESET-SW           PIC X(01).
  6511             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6512             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6513             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6514
  6515         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 120
* EL050.cbl
  6517*    COPY ERCACCT.
  6518******************************************************************
  6519*                                                                *
  6520*                                                                *
  6521*                            ERCACCT                             *
  6522*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6523*                            VMOD=2.031                          *
  6524*                                                                *
  6525*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6526*                                                                *
  6527*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6528*   VSAM ACCOUNT MASTER FILES.                                   *
  6529*                                                                *
  6530*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6531*                                                                *
  6532*   FILE TYPE = VSAM,KSDS                                        *
  6533*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6534*                                                                *
  6535*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6536*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6537*                                                                *
  6538*   LOG = NO                                                     *
  6539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6540*                                                                *
  6541*                                                                *
  6542******************************************************************
  6543*                   C H A N G E   L O G
  6544*
  6545* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6546*-----------------------------------------------------------------
  6547*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6548* EFFECTIVE    NUMBER
  6549*-----------------------------------------------------------------
  6550* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6551* 092705    2005050300006  PEMA  ADD SPP LEASES
  6552* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6553* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6554* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6555* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6556* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6557******************************************************************
  6558
  6559 01  ACCOUNT-MASTER.
  6560     12  AM-RECORD-ID                      PIC XX.
  6561         88  VALID-AM-ID                      VALUE 'AM'.
  6562
  6563     12  AM-CONTROL-PRIMARY.
  6564         16  AM-COMPANY-CD                 PIC X.
  6565         16  AM-MSTR-CNTRL.
  6566             20  AM-CONTROL-A.
  6567                 24  AM-CARRIER            PIC X.
  6568                 24  AM-GROUPING.
  6569                     28 AM-GROUPING-PREFIX PIC XXX.
  6570                     28 AM-GROUPING-PRIME  PIC XXX.
  6571                 24  AM-STATE              PIC XX.
  6572                 24  AM-ACCOUNT.
  6573                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6574                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 121
* EL050.cbl
  6575             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6576                                           PIC X(19).
  6577             20  AM-CNTRL-B.
  6578                 24  AM-EXPIRATION-DT      PIC XX.
  6579                 24  FILLER                PIC X(4).
  6580             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6581                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6582
  6583     12  AM-CONTROL-BY-VAR-GRP.
  6584         16  AM-COMPANY-CD-A1              PIC X.
  6585         16  AM-VG-CARRIER                 PIC X.
  6586         16  AM-VG-GROUPING                PIC X(6).
  6587         16  AM-VG-STATE                   PIC XX.
  6588         16  AM-VG-ACCOUNT                 PIC X(10).
  6589         16  AM-VG-DATE.
  6590             20  AM-VG-EXPIRATION-DT       PIC XX.
  6591             20  FILLER                    PIC X(4).
  6592         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6593                                           PIC 9(11)      COMP-3.
  6594     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6595         16  FILLER                        PIC X(10).
  6596         16  AM-VG-KEY3.
  6597             20  AM-VG3-ACCOUNT            PIC X(10).
  6598             20  AM-VG3-EXP-DT             PIC XX.
  6599         16  FILLER                        PIC X(4).
  6600     12  AM-MAINT-INFORMATION.
  6601         16  AM-LAST-MAINT-DT              PIC XX.
  6602         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6603         16  AM-LAST-MAINT-USER            PIC X(4).
  6604         16  FILLER                        PIC XX.
  6605
  6606     12  AM-EFFECTIVE-DT                   PIC XX.
  6607     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6608
  6609     12  AM-PREV-DATES  COMP-3.
  6610         16  AM-PREV-EXP-DT                PIC 9(11).
  6611         16  AM-PREV-EFF-DT                PIC 9(11).
  6612
  6613     12  AM-REPORT-CODE-1                  PIC X(10).
  6614     12  AM-REPORT-CODE-2                  PIC X(10).
  6615
  6616     12  AM-CITY-CODE                      PIC X(4).
  6617     12  AM-COUNTY-PARISH                  PIC X(6).
  6618
  6619     12  AM-NAME                           PIC X(30).
  6620     12  AM-PERSON                         PIC X(30).
  6621     12  AM-ADDRS                          PIC X(30).
  6622     12  AM-CITY.
  6623         16  AM-ADDR-CITY                  PIC X(28).
  6624         16  AM-ADDR-STATE                 PIC XX.
  6625     12  AM-ZIP.
  6626         16  AM-ZIP-PRIME.
  6627             20  AM-ZIP-PRI-1ST            PIC X.
  6628                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6629             20  FILLER                    PIC X(4).
  6630         16  AM-ZIP-PLUS4                  PIC X(4).
  6631     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6632         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 122
* EL050.cbl
  6633         16  AM-CAN-POSTAL-2               PIC XXX.
  6634         16  FILLER                        PIC XXX.
  6635     12  AM-TEL-NO.
  6636         16  AM-AREA-CODE                  PIC 999.
  6637         16  AM-TEL-PRE                    PIC 999.
  6638         16  AM-TEL-NBR                    PIC 9(4).
  6639     12  AM-TEL-LOC                        PIC X.
  6640         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6641         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6642
  6643     12  AM-COMM-STRUCTURE.
  6644         16  AM-DEFN-1.
  6645             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6646                 24  AM-AGT.
  6647                     28  AM-AGT-PREFIX     PIC X(4).
  6648                     28  AM-AGT-PRIME      PIC X(6).
  6649                 24  AM-COM-TYP            PIC X.
  6650                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6651                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6652                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6653                 24  AM-RECALC-LV-INDIC    PIC X.
  6654                 24  AM-RETRO-LV-INDIC     PIC X.
  6655                 24  AM-GL-CODES           PIC X.
  6656                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6657                 24  FILLER                PIC X(01).
  6658         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6659             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6660                 24  FILLER                PIC X(11).
  6661                 24  AM-L-COMA             PIC XXX.
  6662                 24  AM-J-COMA             PIC XXX.
  6663                 24  AM-A-COMA             PIC XXX.
  6664                 24  FILLER                PIC X(6).
  6665
  6666     12  AM-COMM-CHANGE-STATUS             PIC X.
  6667         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6668
  6669     12  AM-CSR-CODE                       PIC X(4).
  6670
  6671     12  AM-BILLING-STATUS                 PIC X.
  6672         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6673         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6674     12  AM-AUTO-REFUND-SW                 PIC X.
  6675         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6676         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6677     12  AM-GPCD                           PIC 99.
  6678     12  AM-IG                             PIC X.
  6679         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6680         88  AM-HAS-GROUP                     VALUE '2'.
  6681     12  AM-STATUS                         PIC X.
  6682         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6683         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6684         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6685         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6686         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6687         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6688     12  AM-REMIT-TO                       PIC 99.
  6689     12  AM-ID-NO                          PIC X(11).
  6690
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 123
* EL050.cbl
  6691     12  AM-CAL-TABLE                      PIC XX.
  6692     12  AM-LF-DEVIATION                   PIC XXX.
  6693     12  AM-AH-DEVIATION                   PIC XXX.
  6694     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6695     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6696     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6697     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6698     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6699     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6700
  6701     12  AM-USER-FIELDS.
  6702         16  AM-FLD-1                      PIC XX.
  6703         16  AM-FLD-2                      PIC XX.
  6704         16  AM-FLD-3                      PIC XX.
  6705         16  AM-FLD-4                      PIC XX.
  6706         16  AM-FLD-5                      PIC XX.
  6707
  6708     12  AM-1ST-PROD-DATE.
  6709         16  AM-1ST-PROD-YR                PIC XX.
  6710         16  AM-1ST-PROD-MO                PIC XX.
  6711         16  AM-1ST-PROD-DA                PIC XX.
  6712     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6713     12  AM-CERTS-PURGED-DATE.
  6714         16  AM-PUR-YR                     PIC XX.
  6715         16  AM-PUR-MO                     PIC XX.
  6716         16  AM-PUR-DA                     PIC XX.
  6717     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6718     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6719     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6720     12  AM-INACTIVE-DATE.
  6721         16  AM-INA-MO                     PIC 99.
  6722         16  AM-INA-DA                     PIC 99.
  6723         16  AM-INA-YR                     PIC 99.
  6724     12  AM-AR-HI-CERT-DATE                PIC XX.
  6725
  6726     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6727     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6728
  6729     12  AM-OB-PAYMENT-MODE                PIC X.
  6730         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6731         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6732         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6733         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6734
  6735     12  AM-AH-ONLY-INDICATOR              PIC X.
  6736         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6737         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6738
  6739     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6740
  6741     12  AM-OVER-SHORT.
  6742         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6743         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6744
  6745     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6746     12  AM-DCC-CLP-STATE                  PIC XX.
  6747
  6748     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 124
* EL050.cbl
  6749     12  AM-RECALC-REIN                    PIC X.
  6750
  6751     12  AM-REI-TABLE                      PIC XXX.
  6752     12  AM-REI-ET-LF                      PIC X.
  6753     12  AM-REI-ET-AH                      PIC X.
  6754     12  AM-REI-PE-LF                      PIC X.
  6755     12  AM-REI-PE-AH                      PIC X.
  6756     12  AM-REI-PRT-ST                     PIC X.
  6757     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6758     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6759     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6760     12  AM-REI-GROUP-A                    PIC X(6).
  6761     12  AM-REI-MORT                       PIC X(4).
  6762     12  AM-REI-PRT-OW                     PIC X.
  6763     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6764     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6765     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6766     12  AM-REI-GROUP-B                    PIC X(6).
  6767
  6768     12  AM-TRUST-TYPE                     PIC X(2).
  6769
  6770     12  AM-EMPLOYER-STMT-USED             PIC X.
  6771     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6772
  6773     12  AM-STD-AH-TYPE                    PIC XX.
  6774     12  AM-EARN-METHODS.
  6775         16  AM-EARN-METHOD-R              PIC X.
  6776             88 AM-REF-RL-R78                 VALUE 'R'.
  6777             88 AM-REF-RL-PR                  VALUE 'P'.
  6778             88 AM-REF-RL-MEAN                VALUE 'M'.
  6779             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6780         16  AM-EARN-METHOD-L              PIC X.
  6781             88 AM-REF-LL-R78                 VALUE 'R'.
  6782             88 AM-REF-LL-PR                  VALUE 'P'.
  6783             88 AM-REF-LL-MEAN                VALUE 'M'.
  6784             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6785         16  AM-EARN-METHOD-A              PIC X.
  6786             88 AM-REF-AH-R78                 VALUE 'R'.
  6787             88 AM-REF-AH-PR                  VALUE 'P'.
  6788             88 AM-REF-AH-MEAN                VALUE 'M'.
  6789             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6790             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6791             88 AM-REF-AH-NET                 VALUE 'N'.
  6792
  6793     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6794     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6795     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6796
  6797     12  AM-RET-Y-N                        PIC X.
  6798     12  AM-RET-P-E                        PIC X.
  6799     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6800     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6801     12  AM-RET-GRP                        PIC X(6).
  6802     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6803         16  AM-POOL-PRIME                 PIC XXX.
  6804         16  AM-POOL-SUB                   PIC XXX.
  6805     12  AM-RETRO-EARNINGS.
  6806         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 125
* EL050.cbl
  6807         16  AM-RET-EARN-L                 PIC X.
  6808         16  AM-RET-EARN-A                 PIC X.
  6809     12  AM-RET-ST-TAX-USE                 PIC X.
  6810         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6811         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6812     12  AM-RETRO-BEG-EARNINGS.
  6813         16  AM-RET-BEG-EARN-R             PIC X.
  6814         16  AM-RET-BEG-EARN-L             PIC X.
  6815         16  AM-RET-BEG-EARN-A             PIC X.
  6816     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6817     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6818
  6819     12  AM-USER-SELECT-OPTIONS.
  6820         16  AM-USER-SELECT-1              PIC X(10).
  6821         16  AM-USER-SELECT-2              PIC X(10).
  6822         16  AM-USER-SELECT-3              PIC X(10).
  6823         16  AM-USER-SELECT-4              PIC X(10).
  6824         16  AM-USER-SELECT-5              PIC X(10).
  6825
  6826     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6827
  6828     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6829
  6830     12  AM-RPT045A-SWITCH                 PIC X.
  6831         88  RPT045A-OFF                   VALUE 'N'.
  6832
  6833     12  AM-INSURANCE-LIMITS.
  6834         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6835         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6836
  6837     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6838         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6839
  6840     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6841         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6842         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6843
  6844     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6845
  6846     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6847     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6848     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6849     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6850     12  AM-DCC-UEF-STATE                  PIC XX.
  6851     12  FILLER                            PIC XXX.
  6852     12  AM-REPORT-CODE-3                  PIC X(10).
  6853*    12  FILLER                            PIC X(22).
  6854
  6855     12  AM-RESERVE-DATE.
  6856         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6857         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6858         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6859
  6860     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6861     12  AM-NOTIFICATION-TYPES.
  6862         16  AM-NOTIF-OF-LETTERS           PIC X.
  6863         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6864         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 126
* EL050.cbl
  6865         16  AM-NOTIF-OF-STATUS            PIC X.
  6866
  6867     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6868         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6869         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6870         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6871         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6872
  6873     12  AM-BENEFIT-CONTROLS.
  6874         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6875             20  AM-BENEFIT-CODE           PIC XX.
  6876             20  AM-BENEFIT-TYPE           PIC X.
  6877             20  AM-BENEFIT-REVISION       PIC XXX.
  6878             20  AM-BENEFIT-REM-TERM       PIC X.
  6879             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6880             20  FILLER                    PIC XX.
  6881         16  FILLER                        PIC X(80).
  6882
  6883     12  AM-TRANSFER-DATA.
  6884         16  AM-TRANSFERRED-FROM.
  6885             20  AM-TRNFROM-CARRIER        PIC X.
  6886             20  AM-TRNFROM-GROUPING.
  6887                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6888                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6889             20  AM-TRNFROM-STATE          PIC XX.
  6890             20  AM-TRNFROM-ACCOUNT.
  6891                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6892                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6893             20  AM-TRNFROM-DTE            PIC XX.
  6894         16  AM-TRANSFERRED-TO.
  6895             20  AM-TRNTO-CARRIER          PIC X.
  6896             20  AM-TRNTO-GROUPING.
  6897                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6898                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6899             20  AM-TRNTO-STATE            PIC XX.
  6900             20  AM-TRNTO-ACCOUNT.
  6901                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6902                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6903             20  AM-TRNTO-DTE              PIC XX.
  6904         16  FILLER                        PIC X(10).
  6905
  6906     12  AM-SAVED-REMIT-TO                 PIC 99.
  6907
  6908     12  AM-COMM-STRUCTURE-SAVED.
  6909         16  AM-DEFN-1-SAVED.
  6910             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6911                 24  AM-AGT-SV             PIC X(10).
  6912                 24  AM-COM-TYP-SV         PIC X.
  6913                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6914                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6915                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6916                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6917                 24  FILLER                PIC X.
  6918                 24  AM-GL-CODES-SV        PIC X.
  6919                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6920                 24  FILLER                PIC X.
  6921         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6922             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 127
* EL050.cbl
  6923                 24  FILLER                PIC X(11).
  6924                 24  AM-L-COMA-SV          PIC XXX.
  6925                 24  AM-J-COMA-SV          PIC XXX.
  6926                 24  AM-A-COMA-SV          PIC XXX.
  6927                 24  FILLER                PIC X(6).
  6928
  6929     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6930         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6931            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6932            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6933            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6934
  6935     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6936     12  FILLER                            PIC X(120).
  6937
  6938     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6939         16  AM-CONTROL-NAME               PIC X(30).
  6940         16  AM-EXECUTIVE-ONE.
  6941             20  AM-EXEC1-NAME             PIC X(15).
  6942             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6943                                                          COMP-3.
  6944             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6945                                                          COMP-3.
  6946         16  AM-EXECUTIVE-TWO.
  6947             20  AM-EXEC2-NAME             PIC X(15).
  6948             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6949                                                          COMP-3.
  6950             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6951                                                          COMP-3.
  6952
  6953     12  AM-RETRO-ADDITIONAL-DATA.
  6954         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6955         16  AM-RETRO-PREM-P-E             PIC X.
  6956         16  AM-RETRO-CLMS-P-I             PIC X.
  6957         16  AM-RETRO-RET-BRACKET-LF.
  6958             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6959                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6960                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6961             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6962                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6963                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6964             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6965                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6966                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6967         16  AM-RETRO-RET-BRACKET-AH.
  6968             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6969                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6970                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6971                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6972             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6973                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6974                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6975             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6976                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6977                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6978
  6979     12  AM-COMMENTS.
  6980         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 128
* EL050.cbl
  6981
  6982     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6983         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6984         16  AM-FLI-BILLING-CODE           PIC X.
  6985         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6986         16  AM-FLI-UNITED-IDENT           PIC X.
  6987         16  AM-FLI-INTEREST-LOST-DATA.
  6988             20  AM-FLI-BANK-NO            PIC X(5).
  6989             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6990             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6991             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6992         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6993             20  AM-FLI-AGT                PIC X(9).
  6994             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6995             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6996         16  FILLER                        PIC X(102).
  6997
  6998     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6999         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7000             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7001             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7002             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7003             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7004             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7005         16  FILLER                          PIC X(10).
  7006******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 129
* EL050.cbl
  7008*    COPY ERCREIN.
  7009******************************************************************
  7010*                                                                *
  7011*                            ERCREIN                             *
  7012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7013*                            VMOD=2.010                          *
  7014*                                                                *
  7015*   ONLINE CREDIT SYSTEM                                         *
  7016*                                                                *
  7017*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7018*                                                                *
  7019*   FILE TYPE = VSAM,KSDS                                        *
  7020*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7021*                                                                *
  7022*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7023*       ALTERNATE PATH = NONE                                    *
  7024*                                                                *
  7025*   LOG = NO                                                     *
  7026*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7027*                                                                *
  7028******************************************************************
  7029*                   C H A N G E   L O G
  7030*
  7031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7032*-----------------------------------------------------------------
  7033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7034* EFFECTIVE    NUMBER
  7035*-----------------------------------------------------------------
  7036* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7037* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7038******************************************************************
  7039 01  REINSURANCE-RECORD.
  7040     12  RE-RECORD-ID                      PIC XX.
  7041         88  VALID-RE-ID                      VALUE 'RE'.
  7042
  7043     12  RE-CONTROL-PRIMARY.
  7044         16  RE-COMPANY-CD                 PIC X.
  7045         16  RE-KEY.
  7046             20  RE-CODE                   PIC X.
  7047                 88  RE-TABLE-RECORD          VALUE 'A'.
  7048                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7049             20  RE-TABLE                  PIC XXX.
  7050             20  FILLER                    PIC XXX.
  7051         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7052             20  FILLER                    PIC X.
  7053             20  RE-COMPANY.
  7054                 24  RE-COMP-PRIME         PIC XXX.
  7055                 24  RE-COMP-SUB           PIC XXX.
  7056
  7057     12  RE-MAINT-INFORMATION.
  7058         16  RE-LAST-MAINT-DT              PIC XX.
  7059         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7060         16  RE-LAST-MAINT-USER            PIC X(4).
  7061         16  FILLER                        PIC X(10).
  7062
  7063     12  RE-TABLE-DATA.
  7064         16  RE-100-COMP                   PIC 99.
  7065
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 130
* EL050.cbl
  7066         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7067             20  RE-REI-COMP-NO.
  7068                 24  RE-REI-COMP           PIC XXX.
  7069                 24  RE-REI-COMP-SUB       PIC XXX.
  7070             20  RE-LF-QC                  PIC X.
  7071             20  RE-AH-QC                  PIC X.
  7072             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7073             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7074             20  RE-LFAGE-LO               PIC 99.
  7075             20  RE-LFAGE-HI               PIC 99.
  7076             20  RE-AHAGE-LO               PIC 99.
  7077             20  RE-AHAGE-HI               PIC 99.
  7078             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7079             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7080             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7081             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7082             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7083             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7084             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7085             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7086             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7087             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7088             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7089             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7090             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7091             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7092             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7093             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7094             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7095             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7096             20  RE-LF-BEN-CODE            PIC X.
  7097             20  RE-AH-BEN-CODE            PIC X.
  7098             20  RE-INTERACTIVE            PIC X.
  7099             20  RE-REMAINING              PIC X.
  7100             20  RE-LF-RUNOFF-SW           PIC X.
  7101             20  RE-AH-RUNOFF-SW           PIC X.
  7102             20  FILLER                    PIC X(19).
  7103
  7104         16  RE-COMP-INFO-END              PIC X(6).
  7105         16  RE-NSP-ST-CD-LF               PIC XX.
  7106         16  RE-NSP-ST-CD-AH               PIC XX.
  7107         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7108             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7109
  7110         16  FILLER                        PIC X(27).
  7111
  7112     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7113         16  RE-NAME                       PIC X(30).
  7114         16  RE-LF-PE                      PIC X.
  7115         16  RE-AH-PE                      PIC X.
  7116         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7117         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7118         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7119         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7120         16  RE-PRT-ST                     PIC X.
  7121         16  RE-PRT-OW                     PIC X.
  7122         16  RE-MORT-CODE                  PIC X(4).
  7123         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 131
* EL050.cbl
  7124         16  RE-ZERO-LF-FEE                PIC X.
  7125         16  RE-ZERO-AH-FEE                PIC X.
  7126         16  RE-CEDE-NAME                  PIC X(30).
  7127         16  RE-LF-COMM                    PIC X.
  7128         16  RE-AH-COMM                    PIC X.
  7129         16  RE-LF-TAX                     PIC X.
  7130         16  RE-AH-TAX                     PIC X.
  7131         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7132         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7133         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7134
  7135         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7136             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7137
  7138         16  RE-LF-CEDING-FEE-BRACKETS.
  7139             20  RE-LF-FEE-METHOD          PIC X.
  7140                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7141                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7142                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7143                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7144             20  RE-LF-FEE-BASIS           PIC X.
  7145                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7146                 88  RE-LF-NET-CEDED               VALUE '2'.
  7147                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7148                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7149                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7150                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7151                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7152                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7153             20  FILLER                    PIC XXX.
  7154             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7155                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7156                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7157
  7158         16  RE-AH-CEDING-FEE-BRACKETS.
  7159             20  RE-AH-FEE-METHOD          PIC X.
  7160                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7161                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7162                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7163                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7164             20  RE-AH-FEE-BASIS           PIC X.
  7165                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7166                 88  RE-AH-NET-CEDED               VALUE '2'.
  7167                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7168                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7169                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7170                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7171                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7172                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7173             20  FILLER                    PIC XXX.
  7174             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7175                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7176                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7177
  7178         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7179
  7180         16  RE-OLD-CEDING-STMT            PIC X.
  7181
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 132
* EL050.cbl
  7182         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7183         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7184         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7185         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7186         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7187         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7188         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7189         16  RE-MORT-SW                    PIC X.
  7190         16  RE-CEDING-TYPE-FLAG           PIC X.
  7191             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7192             88  RE-CEDED                          VALUE 'C'.
  7193             88  RE-ASSUMED                        VALUE 'A'.
  7194             88  RE-PHANTOM                        VALUE 'P'.
  7195
  7196         16  RE-CEDING-STMT-OPT-A          PIC X.
  7197             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7198         16  RE-CEDING-STMT-OPT-B          PIC X.
  7199             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7200         16  RE-CEDING-STMT-OPT-C          PIC X.
  7201             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7202         16  RE-CEDING-STMT-OPT-D          PIC X.
  7203             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7204         16  RE-CEDING-STMT-OPT-E          PIC X.
  7205             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7206
  7207         16  RE-PRT-CRSV                   PIC X.
  7208
  7209         16  RE-GL-CENTER                  PIC X(4).
  7210
  7211         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7212
  7213         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7214
  7215         16  RE-EARN-STOP-CODE             PIC X.
  7216             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7217             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7218
  7219         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7220             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7221
  7222         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7223         16  FILLER                        PIC X(2281).
  7224
  7225         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7226
  7227******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 133
* EL050.cbl
  7229*    COPY ERCCTBL.
  7230******************************************************************
  7231*                                                                *
  7232*                                                                *
  7233*                            ERCCTBL                             *
  7234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7235*                            VMOD=2.003
  7236*                                                                *
  7237*   ONLINE CREDIT SYSTEM                                         *
  7238*                                                                *
  7239*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7240*                                                                *
  7241*   FILE TYPE = VSAM,KSDS                                        *
  7242*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7243*                                                                *
  7244*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7245*       ALTERNATE PATH = NONE                                    *
  7246*                                                                *
  7247*   LOG = NO                                                     *
  7248*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7249*                                                                *
  7250*                                                                *
  7251******************************************************************
  7252
  7253 01  COMM-TABLE-RECORD.
  7254     12  CT-RECORD-ID                      PIC XX.
  7255         88  VALID-CT-ID                      VALUE 'CT'.
  7256
  7257     12  CT-CONTROL-PRIMARY.
  7258         16  CT-COMPANY-CD                 PIC X.
  7259         16  CT-TABLE                      PIC XXX.
  7260         16  CT-CNTRL-2.
  7261             20  CT-BEN-TYPE               PIC X.
  7262             20  CT-BEN-CODE               PIC XX.
  7263
  7264     12  CT-MAINT-INFORMATION.
  7265         16  CT-LAST-MAINT-DT              PIC XX.
  7266         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7267         16  CT-LAST-MAINT-USER            PIC X(4).
  7268         16  FILLER                        PIC X(31).
  7269
  7270     12  CT-LIMITS.
  7271         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7272
  7273         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7274
  7275         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7276
  7277     12  CT-RATES.
  7278         16  CT-RTX          OCCURS 27 TIMES.
  7279             20  CT-RT                     PIC SV9(5)     COMP-3.
  7280             20  CT-RT-R   REDEFINES
  7281                 CT-RT                     PIC XXX.
  7282
  7283     12  FILLER                            PIC  X(42).
  7284
  7285******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 134
* EL050.cbl
  7287*    COPY ERCFORM.
  7288******************************************************************
  7289*                                                                *
  7290*                                                                *
  7291*                            ERCFORM.                            *
  7292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7293*                            VMOD=2.003                          *
  7294*                                                                *
  7295*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7296*                                                                *
  7297*    FILE TYPE = VSAM,KSDS                                       *
  7298*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7299*                                                                *
  7300*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7301*                                                                *
  7302*    LOG = YES                                                   *
  7303*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7304******************************************************************
  7305 01  FORM-MASTER.
  7306    12  FO-RECORD-ID                 PIC X(02).
  7307        88  VALID-FO-ID                  VALUE 'FO'.
  7308
  7309    12  FO-CONTROL-PRIMARY.
  7310        16  FO-COMPANY-CD            PIC X(01).
  7311        16  FO-STATE                 PIC X(02).
  7312        16  FO-FORM-ID               PIC X(12).
  7313        16  FO-FORM-EXP-DT           PIC X(02).
  7314
  7315    12  FO-POLICY-FORM-DATA.
  7316        16  FO-IND-GRP-CD            PIC X(01).
  7317        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7318        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7319        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7320        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7321        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7322        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7323        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7324        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7325        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7326        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7327        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7328        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7329        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7330        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7331        16  FO-APP-CERT-USE-CD       PIC X(01).
  7332
  7333    12  FILLER                       PIC X(29).
  7334
  7335    12  FO-FORM-PLAN-TABLE.
  7336        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7337            20  FO-PLAN-TYPE         PIC X(01).
  7338            20  FO-PLAN-ID           PIC X(02).
  7339            20  FO-PLAN-TERM         PIC 9(03).
  7340            20  FO-PLAN-REFUND-METHOD
  7341                                     PIC X.
  7342
  7343    12  FILLER                       PIC X(30).
  7344
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 135
* EL050.cbl
  7345    12  FO-COMMENTS-AREA.
  7346        16  FO-COMMENT-LINE-1        PIC X(78).
  7347
  7348    12  FILLER                       PIC X(20).
  7349
  7350    12  FO-MAINT-INFORMATION.
  7351        16  FO-LAST-MAINT-DT         PIC X(02).
  7352        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7353        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 136
* EL050.cbl
  7355*    COPY ELCMSTR.
  7356******************************************************************
  7357*                                                                *
  7358*                            ELCMSTR.                            *
  7359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7360*                            VMOD=2.012                          *
  7361*                                                                *
  7362*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7363*                                                                *
  7364*   FILE TYPE = VSAM,KSDS                                        *
  7365*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7366*                                                                *
  7367*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7368*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7369*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7370*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7371*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7372*                                                 RKP=75,LEN=21  *
  7373*                                                                *
  7374*   **** NOTE ****                                               *
  7375*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7376*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7377*                                                                *
  7378*   LOG = YES                                                    *
  7379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7380******************************************************************
  7381*                   C H A N G E   L O G
  7382*
  7383* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7384*-----------------------------------------------------------------
  7385*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7386* EFFECTIVE    NUMBER
  7387*-----------------------------------------------------------------
  7388* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7389* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7390* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7391* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7392* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7393******************************************************************
  7394 01  CLAIM-MASTER.
  7395     12  CL-RECORD-ID                PIC XX.
  7396         88  VALID-CL-ID         VALUE 'CL'.
  7397
  7398     12  CL-CONTROL-PRIMARY.
  7399         16  CL-COMPANY-CD           PIC X.
  7400         16  CL-CARRIER              PIC X.
  7401         16  CL-CLAIM-NO             PIC X(7).
  7402         16  CL-CERT-NO.
  7403             20  CL-CERT-PRIME       PIC X(10).
  7404             20  CL-CERT-SFX         PIC X.
  7405
  7406     12  CL-CONTROL-BY-NAME.
  7407         16  CL-COMPANY-CD-A1        PIC X.
  7408         16  CL-INSURED-LAST-NAME    PIC X(15).
  7409         16  CL-INSURED-NAME.
  7410             20  CL-INSURED-1ST-NAME PIC X(12).
  7411             20  CL-INSURED-MID-INIT PIC X.
  7412
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 137
* EL050.cbl
  7413     12  CL-CONTROL-BY-SSN.
  7414         16  CL-COMPANY-CD-A2        PIC X.
  7415         16  CL-SOC-SEC-NO.
  7416             20  CL-SSN-STATE        PIC XX.
  7417             20  CL-SSN-ACCOUNT      PIC X(6).
  7418             20  CL-SSN-LN3          PIC X(3).
  7419
  7420     12  CL-CONTROL-BY-CERT-NO.
  7421         16  CL-COMPANY-CD-A4        PIC X.
  7422         16  CL-CERT-NO-A4.
  7423             20  CL-CERT-A4-PRIME    PIC X(10).
  7424             20  CL-CERT-A4-SFX      PIC X.
  7425
  7426     12  CL-CONTROL-BY-CCN.
  7427         16  CL-COMPANY-CD-A5        PIC X.
  7428         16  CL-CCN-A5.
  7429             20  CL-CCN.
  7430                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7431                 24  CL-CCN-PRIME-A5 PIC X(12).
  7432             20  CL-CCN-FILLER-A5    PIC X(4).
  7433
  7434     12  CL-INSURED-PROFILE-DATA.
  7435         16  CL-INSURED-BIRTH-DT     PIC XX.
  7436         16  CL-INSURED-SEX-CD       PIC X.
  7437             88  INSURED-IS-MALE        VALUE 'M'.
  7438             88  INSURED-IS-FEMALE      VALUE 'F'.
  7439             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7440         16  CL-INSURED-OCC-CD       PIC X(6).
  7441         16  FILLER                  PIC X(5).
  7442
  7443     12  CL-PROCESSING-INFO.
  7444         16  CL-PROCESSOR-ID         PIC X(4).
  7445         16  CL-CLAIM-STATUS         PIC X.
  7446             88  CLAIM-IS-OPEN          VALUE 'O'.
  7447             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7448         16  CL-CLAIM-TYPE           PIC X.
  7449*            88  AH-CLAIM               VALUE 'A'.
  7450*            88  LIFE-CLAIM             VALUE 'L'.
  7451*            88  PROPERTY-CLAIM         VALUE 'P'.
  7452*            88  IUI-CLAIM              VALUE 'I'.
  7453*            88  GAP-CLAIM              VALUE 'G'.
  7454*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7455         16  CL-CLAIM-PREM-TYPE      PIC X.
  7456             88  SINGLE-PREMIUM         VALUE '1'.
  7457             88  O-B-COVERAGE           VALUE '2'.
  7458             88  OPEN-END-COVERAGE      VALUE '3'.
  7459         16  CL-INCURRED-DT          PIC XX.
  7460         16  CL-REPORTED-DT          PIC XX.
  7461         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7462         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7463         16  CL-LAST-PMT-DT          PIC XX.
  7464         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7465         16  CL-PAID-THRU-DT         PIC XX.
  7466         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7467         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7468         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7469         16  CL-PMT-CALC-METHOD      PIC X.
  7470             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 138
* EL050.cbl
  7471             88  CL-365-DAY-YR          VALUE '2'.
  7472             88  CL-FULL-MONTHS         VALUE '3'.
  7473         16  CL-CAUSE-CD             PIC X(6).
  7474
  7475         16  CL-PRIME-CERT-NO.
  7476             20  CL-PRIME-CERT-PRIME PIC X(10).
  7477             20  CL-PRIME-CERT-SFX   PIC X.
  7478
  7479         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7480             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7481             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7482
  7483         16  CL-MICROFILM-NO         PIC X(10).
  7484         16  FILLER REDEFINES CL-MICROFILM-NO.
  7485             20  CL-BENEFIT-PERIOD   PIC 99.
  7486             20  FILLER              PIC X(8).
  7487         16  CL-PROG-FORM-TYPE       PIC X.
  7488         16  CL-LAST-ADD-ON-DT       PIC XX.
  7489
  7490         16  CL-LAST-REOPEN-DT       PIC XX.
  7491         16  CL-LAST-CLOSE-DT        PIC XX.
  7492         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7493             88  FINAL-PAID             VALUE '1'.
  7494             88  CLAIM-DENIED           VALUE '2'.
  7495             88  AUTO-CLOSE             VALUE '3'.
  7496             88  MANUAL-CLOSE           VALUE '4'.
  7497             88  BENEFITS-CHANGED       VALUE 'C'.
  7498             88  SETUP-ERRORS           VALUE 'E'.
  7499         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7500         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7501         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7502             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7503         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7504         16  FILLER                  PIC X.
  7505
  7506     12  CL-CERTIFICATE-DATA.
  7507         16  CL-CERT-ORIGIN          PIC X.
  7508             88  CERT-WAS-ONLINE        VALUE '1'.
  7509             88  CERT-WAS-CREATED       VALUE '2'.
  7510             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7511         16  CL-CERT-KEY-DATA.
  7512             20  CL-CERT-CARRIER     PIC X.
  7513             20  CL-CERT-GROUPING    PIC X(6).
  7514             20  CL-CERT-STATE       PIC XX.
  7515             20  CL-CERT-ACCOUNT.
  7516                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7517                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7518             20  CL-CERT-EFF-DT      PIC XX.
  7519
  7520     12  CL-STATUS-CONTROLS.
  7521         16  CL-PRIORITY-CD          PIC X.
  7522             88  CONFIDENTIAL-DATA      VALUE '8'.
  7523             88  HIGHEST-PRIORITY       VALUE '9'.
  7524         16  CL-SUPV-ATTN-CD         PIC X.
  7525             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7526             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7527         16  CL-PURGED-DT            PIC XX.
  7528         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 139
* EL050.cbl
  7529         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7530         16  CL-NEXT-RESEND-DT       PIC XX.
  7531         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7532         16  CL-CRITICAL-PERIOD      PIC 99.
  7533*        16  FILLER                  PIC XX.
  7534         16  CL-LAST-MAINT-DT        PIC XX.
  7535         16  CL-LAST-MAINT-USER      PIC X(4).
  7536         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7537         16  CL-LAST-MAINT-TYPE      PIC X.
  7538             88  CLAIM-SET-UP           VALUE ' '.
  7539             88  PAYMENT-MADE           VALUE '1'.
  7540             88  LETTER-SENT            VALUE '2'.
  7541             88  MASTER-WAS-ALTERED     VALUE '3'.
  7542             88  MASTER-WAS-RESTORED    VALUE '4'.
  7543             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7544             88  FILE-CONVERTED         VALUE '6'.
  7545             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7546             88  ERROR-CORRECTION       VALUE 'E'.
  7547         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7548         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7549         16  CL-BENEFICIARY          PIC X(10).
  7550         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7551         16  CL-DENIAL-TYPE          PIC X.
  7552             88  CL-TYPE-DENIAL          VALUE '1'.
  7553             88  CL-TYPE-RESCISSION      VALUE '2'.
  7554             88  CL-TYPE-REFORMATION     VALUE '3'.
  7555             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7556             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7557         16  filler                  pic x(5).
  7558*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7559*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7560*        16  CL-RTW-DT               PIC XX.
  7561
  7562     12  CL-TRAILER-CONTROLS.
  7563         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7564             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7565             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7566             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7567         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7568         16  FILLER                  PIC XX.
  7569         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7570         16  CL-ADDRESS-TRAILER-CNT.
  7571             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7572                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7573             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7574                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7575             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7576                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7577             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7578                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7579             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7580                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7581             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7582                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7583             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7584                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7585
  7586     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 140
* EL050.cbl
  7587         16  CL-CV-REFNO-PRIME       PIC X(18).
  7588         16  CL-CV-REFNO-SFX         PIC XX.
  7589
  7590     12  CL-FILE-LOCATION            PIC X(4).
  7591
  7592     12  CL-PROCESS-ERRORS.
  7593         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7594             88  NO-FATAL-ERRORS        VALUE ZERO.
  7595         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7596             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7597
  7598     12  CL-PRODUCT-CD               PIC X.
  7599
  7600     12  CL-CURRENT-KEY-DATA.
  7601         16  CL-CURRENT-CARRIER      PIC X.
  7602         16  CL-CURRENT-GROUPING     PIC X(6).
  7603         16  CL-CURRENT-STATE        PIC XX.
  7604         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7605
  7606     12  CL-ASSOCIATES               PIC X.
  7607         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7608         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7609         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7610         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7611
  7612     12  CL-ACTIVITY-CODE            PIC 99.
  7613     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7614     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7615
  7616     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7617     12  CL-LAG-REPORT-CODE          PIC 9.
  7618     12  CL-LOAN-TYPE                PIC XX.
  7619     12  CL-LEGAL-STATE              PIC XX.
  7620
  7621     12  CL-YESNOSW                  PIC X.
  7622     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7623         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7624         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7625         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7626     12  cl-insured-type             pic x.
  7627         88  cl-claim-on-primary         value 'P'.
  7628         88  cl-claim-on-co-borrower     value 'C'.
  7629     12  cl-benefit-expiration-dt    PIC XX.
  7630
  7631 01  PLAN-RECORDS.
  7632     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7633     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7634
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 141
* EL050.cbl
  7636 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7637                          ACCOUNT-MASTER REINSURANCE-RECORD
  7638                          COMM-TABLE-RECORD FORM-MASTER
  7639                          CLAIM-MASTER PLAN-RECORDS.
  7640 0000-DFHEXIT SECTION.
  7641     MOVE '9#                    $   ' TO DFHEIV0.
  7642     MOVE 'EL050' TO DFHEIV1.
  7643     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7644
  7645     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7646
  7647
  7648* EXEC CICS  HANDLE CONDITION
  7649*           ERROR    (9300-ABEND)
  7650*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7651*    END-EXEC.
  7652*    MOVE '"$.J                  ! " #00007643' TO DFHEIV0
  7653     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7655     MOVE X'2220233030303037363433' TO DFHEIV0(25:11)
  7656     CALL 'kxdfhei1' USING DFHEIV0
  7657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7658
  7659
  7660 0000-COPY-PROCEDURE-DIV.
  7661*                          COPY ELC50PD.
  7662******************************************************************
  7663*                                                                *
  7664*                            ELC50PD                             *
  7665*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7666*                            VMOD=2.188                          *
  7667*                                                                *
  7668******************************************************************
  7669*                   C H A N G E   L O G
  7670*
  7671* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7672*-----------------------------------------------------------------
  7673*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7674* EFFECTIVE    NUMBER
  7675*-----------------------------------------------------------------
  7676* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7677* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7678* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7679*                             2709 AND 2718
  7680* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7681* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7682* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7683* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7684* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7685*                                IS OPEN OR CNC DT < PD THRU
  7686* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7687* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7688* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7689* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7690* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7691* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7692* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7693* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 142
* EL050.cbl
  7694* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7695* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7696* 020906                   PEMA  EXPAND LOAN OFFICER
  7697* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7698* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7699* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7700* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7701* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7702* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7703* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7704* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7705* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7706* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7707* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7708* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7709* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7710* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7711* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7712* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7713* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7714* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7715* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7716* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7717* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7718* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7719* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7720* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7721* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7722*                                UPDATE VIN ON CERT TRAILER
  7723* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7724* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7725* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7726* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7727* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7728* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7729* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7730* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7731* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7732* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7733* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7734* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7735* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7736* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7737* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7738* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7739* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7740* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7741* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7742* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7743* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7744* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7745* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7746* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7747* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7748* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7749* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7750* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7751* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 143
* EL050.cbl
  7752* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7753* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7754* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7755* 032912  CR2011110200001  PEMA  AHL CHANGES
  7756* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7757* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7758* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7759* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7760* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7761* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7762* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7763* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7764* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7765* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7766* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7767* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7768* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7769* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7770* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7771* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7772* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7773* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7774* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7775* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7776* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7777* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7778* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7779* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7780* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7781* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7782* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7783*                                CERT #, ADD 2898 FORCIBLE ERROR
  7784* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7785* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7786* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7787* 121815  CR2015121700006  PEMA  ADD ERROR 3827 (foreign vin)
  7788* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7789******************************************************************
  7790************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7791******************************************************************
  7792
  7793     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7794
  7795     MOVE SPACES                 TO PB-FATAL-FLAG
  7796                                    PB-FORCE-ER-CD
  7797                                    PB-WARN-ER-CD
  7798                                    PB-OUT-BAL-CD.
  7799
  7800     MOVE SPACE                  TO WS-IG-OVRD-AH
  7801                                    WS-IG-OVRD-LF
  7802                                    WS-IG-OVRD-AM
  7803                                    WS-IG-OVRD
  7804                                    WS-IG-OVRD-AH-PL
  7805                                    WS-IG-OVRD-LF-PL
  7806                                    WS-IG-OVRD-AH-BEN
  7807                                    WS-IG-OVRD-LF-BEN.
  7808
  7809******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 144
* EL050.cbl
  7810*************       INITIALIZE COMMON ERRORS       ***************
  7811******************************************************************
  7812
  7813     MOVE +0                     TO PB-NO-OF-ERRORS.
  7814     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7815
  7816******************************************************************
  7817
  7818     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7819     SET JULIAN-TO-BIN           TO TRUE.
  7820*    MOVE 5                      TO DC-OPTION-CODE.
  7821     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7822     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7823
  7824     MOVE ZERO                   TO  SUB4.
  7825
  7826 0040-INITIALIZE-GA-BILL-DT.
  7827
  7828     ADD +1                      TO  SUB4.
  7829
  7830     IF  SUB4 GREATER THAN +5
  7831         GO TO 0050-CHECK-CNTL-FOUND.
  7832
  7833     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7834         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7835
  7836     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7837
  7838 0050-CHECK-CNTL-FOUND.
  7839
  7840     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7841        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7842                                         WS-AH-REM-TERM-CALC
  7843                                         EC-CO-REM-TERM-CALC
  7844        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7845        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7846        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7847                                         WS-TOL-AH-CLAIM
  7848        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7849                                         WS-TOL-AH-PREM
  7850                                         EC-CO-TOL-PREM
  7851        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7852                                         WS-TOL-AH-REFUND
  7853                                         EC-CO-TOL-REFUND
  7854        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7855                                         WS-AH-REFUND-OVS-AMT
  7856                                         EC-CO-OVR-SHT-AMT
  7857        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7858                                         WS-TOL-AH-PREM-PCT
  7859                                         EC-CO-TOL-PREM-PCT
  7860        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7861                                         WS-TOL-AH-REFUND-PCT
  7862                                         EC-CO-TOL-REFUND-PCT
  7863        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7864                                         WS-AH-REFUND-OVS-PCT
  7865                                         EC-CO-OVR-SHT-PCT
  7866        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7867        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 145
* EL050.cbl
  7868        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7869        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7870        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7871        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7872        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7873        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7874        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7875        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7876        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7877        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7878                                         EC-CO-MONTH-END-DT
  7879        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7880          GO TO 0100-READ-ACCT.
  7881
  7882     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7883     MOVE SPACES                 TO CNTL-ACCESS.
  7884     MOVE '1'                    TO CNTL-REC-TYPE.
  7885     MOVE +0                     TO CNTL-SEQ-NO.
  7886
  7887     MOVE '1' TO RC-SW-1.
  7888     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7889     IF NOT CF-COMPANY-MASTER
  7890         MOVE ZEROS             TO WK-CO-TOL-PREM
  7891                                   WK-CO-TOL-CLAIM
  7892                                   WK-CO-TOL-REFUND
  7893                                   WK-REFUND-OVS-AMT
  7894                                   WK-REFUND-OVS-PCT
  7895                                   WK-CO-TOL-PREM-PCT
  7896                                   WK-CO-TOL-REFUND-PCT
  7897                                   WK-DEFAULT-APR
  7898                                   WK-CO-MAX-CAP
  7899        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7900                                   WK-CR-R78-METHOD
  7901                                   WK-CO-REF-REJECT-SW
  7902                                   WK-CO-PREM-REJECT-SW
  7903                                   WK-REM-TRM-CALC-OPTION
  7904                                   WK-BIRTH-DATE-INPUT
  7905                                   WK-JOINT-AGE-INPUT
  7906        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7907        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7908        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7909        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7910          GO TO 0099-COMPANY-NOT-FOUND.
  7911
  7912     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7913        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7914     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7915        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7916     IF CF-CO-TOL-CAP NOT NUMERIC
  7917        MOVE +0                    TO CF-CO-TOL-CAP.
  7918     IF CF-DEFAULT-APR NOT NUMERIC
  7919        MOVE +0                    TO CF-DEFAULT-APR.
  7920
  7921     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7922     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7923     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7924     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7925     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 146
* EL050.cbl
  7926     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7927     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7928     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7929     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7930     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7931     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7932     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7933
  7934     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7935          CF-CO-OVR-SHT-AMT > +0
  7936        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7937
  7938     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7939          CF-CO-OVR-SHT-PCT > +0
  7940        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7941
  7942     IF CF-VALID-REM-TRM-OPTION
  7943         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7944     ELSE
  7945         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7946
  7947     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7948     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7949     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7950     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7951
  7952     GO TO 0050-CHECK-CNTL-FOUND.
  7953
  7954 0099-COMPANY-NOT-FOUND.
  7955
  7956     MOVE ER-2616                TO WS-ERROR.
  7957     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7958
  7959 0100-READ-ACCT.
  7960
  7961     MOVE SPACES                 TO DATE-RANGE-SW.
  7962
  7963     IF WK-ACCT-ADDR = ZEROS
  7964        GO TO 0102-ACCT-GETMAIN.
  7965
  7966     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7967     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7968     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7969
  7970     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7971        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7972        GO TO 0105-READ-ACCT
  7973     END-IF
  7974
  7975     IF PB-CARRIER NOT = SPACES
  7976        IF PB-CARRIER NOT = AM-VG-CARRIER
  7977           GO TO 0105-READ-ACCT.
  7978
  7979     IF PB-STATE NOT = SPACES
  7980        IF PB-STATE NOT = AM-VG-STATE
  7981           GO TO 0105-READ-ACCT.
  7982
  7983     IF PB-GROUPING NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 147
* EL050.cbl
  7984        IF PB-GROUPING NOT = AM-VG-GROUPING
  7985           GO TO 0105-READ-ACCT.
  7986
  7987     MOVE 'X'                 TO DATE-RANGE-SW.
  7988
  7989     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7990        MOVE 'X'                 TO DATE-RANGE-SW
  7991        GO TO 0105-READ-ACCT.
  7992
  7993     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7994        GO TO 0105-READ-ACCT.
  7995
  7996     GO TO 0180-ACCOUNT-FOUND.
  7997
  7998 0102-ACCT-GETMAIN.
  7999     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8000     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8001
  8002 0105-READ-ACCT.
  8003     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8004     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8005     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8006     MOVE PB-STATE               TO ACCT-STATE.
  8007     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8008     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8009
  8010     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8011
  8012     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8013
  8014 0110-FIND-ACCT-TOLERANCES-LOOP.
  8015     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8016
  8017     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8018        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8019        GO TO 0199-ACCT-NOT-FOUND
  8020     END-IF
  8021     IF PB-CARRIER NOT = SPACES
  8022        IF PB-CARRIER NOT = AM-VG-CARRIER
  8023           GO TO 0199-ACCT-NOT-FOUND.
  8024
  8025     IF PB-STATE NOT = SPACES
  8026        IF PB-STATE NOT = AM-VG-STATE
  8027           GO TO 0199-ACCT-NOT-FOUND.
  8028
  8029     IF PB-GROUPING NOT = SPACES
  8030        IF PB-GROUPING NOT = AM-VG-GROUPING
  8031           GO TO 0199-ACCT-NOT-FOUND.
  8032
  8033     MOVE 'X'                    TO DATE-RANGE-SW.
  8034
  8035     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8036        MOVE 'X'                 TO DATE-RANGE-SW
  8037        GO TO 0199-ACCT-NOT-FOUND.
  8038
  8039     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8040        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8041
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 148
* EL050.cbl
  8042 0180-ACCOUNT-FOUND.
  8043     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8044     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8045     MOVE AM-STATE               TO PB-SV-STATE.
  8046     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8047
  8048     IF AM-CANCEL-FEE  NOT NUMERIC
  8049        MOVE ZEROS TO AM-CANCEL-FEE.
  8050
  8051     IF AM-MAX-MON-BEN NOT NUMERIC
  8052        MOVE ZEROS TO AM-MAX-MON-BEN.
  8053
  8054     IF AM-MAX-TOT-BEN NOT NUMERIC
  8055        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8056
  8057     IF AM-CLP-TOL-PCT NOT NUMERIC
  8058        MOVE +0                  TO AM-CLP-TOL-PCT
  8059     END-IF
  8060     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8061        MOVE +0                  TO AM-SPP-LEASE-COMM
  8062     END-IF
  8063     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8064        MOVE ER-2611             TO   WS-ERROR
  8065        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8066
  8067     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8068        MOVE ER-2621             TO   WS-ERROR
  8069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8070
  8071     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8072        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8073        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8074        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8075         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8076
  8077     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8078     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8079     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8080     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8081     IF AM-CLP-TOL-PCT NOT = ZEROS
  8082        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8083     END-IF
  8084     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8085        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8086     END-IF
  8087*    IF PB-COMPANY-ID = 'DCC'
  8088*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8089*                                   WS-ADMIN-FEES
  8090*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8091*          (SUB5 > +10)
  8092*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8093*             AND (AM-A-COM (SUB5) NUMERIC)
  8094*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8095*                + (AM-A-COM (SUB5) * 1000)
  8096*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8097*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8098*                + (AM-A-COM (SUB5) * 1000)
  8099*             END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 149
* EL050.cbl
  8100*             IF AM-COM-TYP (SUB5) = 'N'
  8101*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8102*                + (AM-A-COM (SUB5) * 1000)
  8103*             END-IF
  8104*          END-IF
  8105*       END-PERFORM
  8106*    END-IF
  8107     IF (PB-COMPANY-ID = 'DCC')
  8108        AND (PB-ISSUE)
  8109        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8110                                    ws-cred-union-fees
  8111        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8112           (SUB5 > +10)
  8113           MOVE +0 TO WS-WK-RATE
  8114           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8115                                   'O' OR 'S')
  8116              IF (AM-A-COM (SUB5) NUMERIC)
  8117                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8118                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8119              ELSE
  8120                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8121                 IF PB-ISSUE
  8122                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8123                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8124                 ELSE
  8125                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8126                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8127                 END-IF
  8128                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8129                 MOVE ZEROS             TO WS-SUB1
  8130                                           WS-COMMISSION
  8131                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8132                 MOVE '0530'               TO CTBL-SW
  8133                 MOVE ' '                  TO WS-CTBL-READ-SW
  8134                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8135                 IF FIRST-TIME-THROUGH
  8136                    MOVE 'AA'              TO CTBL-BEN-CODE
  8137                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8138                 END-IF
  8139                 IF CTBL-TABLE-FOUND
  8140                    IF PB-ISSUE
  8141                       COMPUTE WS-COMM-CK-AMT =
  8142                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8143                    ELSE
  8144                       COMPUTE WS-COMM-CK-AMT =
  8145                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8146                    END-IF
  8147                    PERFORM 8800-GET-COMP-RATE
  8148                              THRU 8800-EXIT
  8149                 END-IF
  8150              END-IF
  8151              if am-com-typ (sub5) = 'O' or 'S'
  8152                 compute ws-cred-union-fees rounded =
  8153                    ws-cred-union-fees +
  8154                    (pb-i-ah-premium-amt * ws-wk-rate)
  8155              else
  8156                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8157                + (WS-WK-RATE * 1000)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 150
* EL050.cbl
  8158              end-if
  8159           END-IF
  8160        END-PERFORM
  8161     END-IF
  8162     IF PB-COMPANY-ID EQUAL 'CRI'
  8163         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8164
  8165     IF PB-COMPANY-ID EQUAL 'NCL'
  8166         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8167     END-IF
  8168
  8169     GO TO 0200-READ-CERT.
  8170
  8171 0199-ACCT-NOT-FOUND.
  8172
  8173     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8174
  8175     IF DATE-RANGE-SW NOT = SPACES
  8176        MOVE ER-2601             TO WS-ERROR
  8177        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8178     ELSE
  8179        MOVE ER-2619             TO WS-ERROR
  8180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8181
  8182     GO TO 9990-RETURN.
  8183
  8184 0200-READ-CERT.
  8185
  8186     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8187     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8188     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8189     MOVE PB-SV-STATE            TO CERT-STATE.
  8190     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8191     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8192     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8193
  8194     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8195
  8196     IF CERT-WAS-NOT-FOUND
  8197        GO TO 0299-CERT-NOT-FOUND.
  8198
  8199     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8200        MOVE ER-2759             TO WS-ERROR
  8201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8202        GO TO 0298-UNLOCK-RETURN.
  8203
  8204     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8205         MOVE ER-2758            TO WS-ERROR
  8206         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8207         GO TO 0298-UNLOCK-RETURN.
  8208
  8209     IF PB-ISSUE
  8210        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8211           IF CERT-WAS-CREATED-FOR-CLAIM
  8212              NEXT SENTENCE
  8213            ELSE
  8214              MOVE ER-2626       TO WS-ERROR
  8215              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 151
* EL050.cbl
  8216              GO TO 0298-UNLOCK-RETURN.
  8217
  8218     IF NOT PB-CANCELLATION
  8219        GO TO 0300-CONTINUE-EDIT.
  8220
  8221     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8222     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8223     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8224     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8225     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8226     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8227
  8228     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8229     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8230     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8231     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8232     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8233     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8234     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8235     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8236     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8237
  8238     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8239     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8240     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8241     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8242     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8243     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8244     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8245
  8246     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8247     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8248
  8249     MOVE CM-CREDIT-INTERFACE-SW-1
  8250                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8251     MOVE CM-CREDIT-INTERFACE-SW-2
  8252                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8253
  8254     IF CM-O-B-COVERAGE
  8255         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8256
  8257     IF CM-LIVES NOT NUMERIC
  8258         MOVE ZERO                TO CM-LIVES.
  8259
  8260     IF CM-BILLED NOT NUMERIC
  8261         MOVE ZERO                TO CM-BILLED.
  8262
  8263     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8264         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8265         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8266         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8267         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8268         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8269         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8270         MOVE CM-LIVES             TO PB-CI-LIVES
  8271*The next line causes a problem with my change  I dont think it is
  8272*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8273
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 152
* EL050.cbl
  8274     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8275     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8276     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8277     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8278     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8279     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8280
  8281     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8282     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8283     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8284     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8285
  8286     IF CM-LIFE-COMM-PCT NUMERIC
  8287         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8288     ELSE
  8289         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8290
  8291     IF CM-AH-COMM-PCT NUMERIC
  8292         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8293     ELSE
  8294         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8295
  8296     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8297
  8298     IF CM-LOAN-APR       NOT NUMERIC
  8299           MOVE ZERO               TO CM-LOAN-APR.
  8300
  8301     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8302           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8303
  8304     IF CM-LOAN-TERM      NOT NUMERIC
  8305           MOVE ZERO               TO CM-LOAN-TERM.
  8306
  8307     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8308           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8309
  8310     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8311           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8312
  8313     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8314     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8315     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8316     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8317     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8318     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8319     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8320     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8321     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8322     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8323     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8324     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8325
  8326     IF CM-STATE = CM-SSN-STATE
  8327         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8328
  8329     IF CM-STATE NOT = CM-MEMB-STATE
  8330         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8331
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 153
* EL050.cbl
  8332     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8333
  8334     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8335        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8336        IF CM-ADDL-CLP NOT NUMERIC
  8337           MOVE +0               TO CM-ADDL-CLP
  8338        END-IF
  8339        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8340        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8341           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8342        END-IF
  8343     END-IF
  8344     IF PB-COMPANY-ID = 'DCC'
  8345        MOVE +0                  TO WS-ADMIN-FEES
  8346                                    WS-CSO-ADMIN-FEE
  8347                                    WS-COMM-AND-MFEE
  8348                                    WS-1ST-YR-ALLOW
  8349        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8350           (SUB5 > +10)
  8351           MOVE +0 TO WS-WK-RATE
  8352           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8353              IF (AM-A-COM (SUB5) NUMERIC)
  8354                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8355                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8356              ELSE
  8357                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8358                 IF PB-ISSUE
  8359                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8360                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8361                 ELSE
  8362                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8363                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8364                 END-IF
  8365                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8366                 MOVE ZEROS             TO WS-SUB1
  8367                                           WS-COMMISSION
  8368                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8369                 MOVE '0530'               TO CTBL-SW
  8370                 MOVE ' '                  TO WS-CTBL-READ-SW
  8371                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8372                 IF FIRST-TIME-THROUGH
  8373                    MOVE 'AA'              TO CTBL-BEN-CODE
  8374                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8375                 END-IF
  8376                 IF CTBL-TABLE-FOUND
  8377                    IF PB-ISSUE
  8378                       COMPUTE WS-COMM-CK-AMT =
  8379                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8380                    ELSE
  8381                       COMPUTE WS-COMM-CK-AMT =
  8382                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8383                    END-IF
  8384                    PERFORM 8800-GET-COMP-RATE
  8385                              THRU 8800-EXIT
  8386                 END-IF
  8387              END-IF
  8388              IF AM-COM-TYP (SUB5) = 'I'
  8389                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 154
* EL050.cbl
  8390                   + (WS-WK-RATE * 1000)
  8391              END-IF
  8392              IF AM-COM-TYP (SUB5) = 'N'
  8393                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8394                   + (WS-WK-RATE * 1000)
  8395              END-IF
  8396              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8397                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8398                   + (WS-WK-RATE * 1000)
  8399              END-IF
  8400              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8401                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8402                   + (WS-WK-RATE * 1000)
  8403              END-IF
  8404           END-IF
  8405        END-PERFORM
  8406     END-IF
  8407     GO TO 0300-CONTINUE-EDIT.
  8408
  8409 0298-UNLOCK-RETURN.
  8410      PERFORM 9250-UNLOCK-RETURN
  8411      GO TO 9990-RETURN.
  8412
  8413 0299-CERT-NOT-FOUND.
  8414
  8415     MOVE '1'                     TO CERT-STATUS-SW.
  8416
  8417     IF PB-COMPANY-ID = 'UCL'
  8418         IF WS-ERROR = ER-2799
  8419             GO TO 3000-CONTINUE-EDIT.
  8420
  8421     IF NOT PB-CANCELLATION
  8422         GO TO 0300-CONTINUE-EDIT.
  8423
  8424     MOVE ER-2726                  TO  WS-ERROR.
  8425     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8426     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8427     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8428                                    PB-CI-LF-TERM
  8429                                    PB-C-LF-REM-TERM
  8430                                    PB-CI-AH-TERM
  8431                                    PB-C-AH-REM-TERM
  8432                                    PB-CI-LF-BENEFIT-CD
  8433                                    PB-CI-LF-BENEFIT-AMT
  8434                                    PB-CI-LF-ALT-BENEFIT-AMT
  8435                                    PB-CI-LF-PREMIUM-AMT
  8436                                    PB-CI-LF-ALT-PREMIUM-AMT
  8437                                    PB-CI-AH-BENEFIT-CD
  8438                                    PB-CI-AH-BENEFIT-AMT
  8439                                    PB-CI-AH-PREMIUM-AMT
  8440                                    PB-CI-PAY-FREQUENCY
  8441                                    PB-CI-LOAN-APR
  8442                                    PB-CI-LOAN-TERM
  8443                                    PB-CI-LIFE-COMMISSION
  8444                                    PB-CI-AH-COMMISSION
  8445                                    PB-CI-CURR-SEQ
  8446                                    PB-CI-AH-CANCEL-AMT
  8447                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 155
* EL050.cbl
  8448                                    PB-CI-RATE-DEV-PCT-LF
  8449                                    PB-CI-RATE-DEV-PCT-AH
  8450                                    PB-CI-EXTENTION-DAYS
  8451                                    PB-CI-TERM-IN-DAYS
  8452                                    PB-CI-LIVES
  8453                                    PB-CI-LF-CRIT-PER
  8454                                    PB-CI-AH-CRIT-PER
  8455                                    PB-CI-ADDL-CLP
  8456                                    PB-CI-DDF-IU-RATE-UP.
  8457
  8458     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8459                                    PB-CI-AH-SETTLEMENT-DT
  8460                                    PB-CI-DEATH-DT
  8461                                    PB-CI-LF-PRIOR-CANCEL-DT
  8462                                    PB-CI-AH-PRIOR-CANCEL-DT
  8463                                    PB-CI-ENTRY-DT
  8464                                    PB-CI-LF-EXPIRE-DT
  8465                                    PB-CI-AH-EXPIRE-DT
  8466                                    PB-CI-LOAN-1ST-PMT-DT.
  8467
  8468     IF ACCOUNT-MAST-FOUND
  8469        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8470        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8471
  8472
  8473 0300-CONTINUE-EDIT.
  8474
  8475     IF PB-ISSUE
  8476        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8477            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8478
  8479     IF PB-ISSUE
  8480        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8481            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8482
  8483     IF PB-ISSUE
  8484       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8485          (AM-NO-AH-ONLY)
  8486           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8487               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8488                   MOVE ER-2679 TO WS-ERROR
  8489                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8490
  8491     IF PB-ISSUE
  8492        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8493        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8494        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8495     ELSE
  8496        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8497        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8498        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8499
  8500     MOVE 'N'                    TO PLAN-MASTER-SW
  8501                                    PLAN-MASTER-LIFE-SW
  8502                                    FORM-MASTER-SW
  8503                                    WS-APP-CERT-SW.
  8504
  8505     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 156
* EL050.cbl
  8506                                    WS-PL-TOL-LF-REFUND
  8507                                    WS-PL-REF-OVS-AMT
  8508                                    WS-PL-TOL-LF-PREM-PCT
  8509                                    WS-PL-TOL-LF-REFUND-PCT
  8510                                    WS-PL-REF-OVS-PCT
  8511                                    WS-PL-TOL-LF-CLAIM.
  8512
  8513     IF PB-COMPANY-ID = 'NCL'
  8514       IF PB-ISSUE
  8515         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8516             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8517             IF FORM-MASTER-FOUND
  8518                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8519
  8520     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8521        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8522
  8523********************** MON CODE **********************
  8524     IF PB-COMPANY-ID = 'MON'
  8525     IF PB-ISSUE
  8526     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8527        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8528             PB-I-LOAN-APR = ZERO)
  8529               MOVE 14.0         TO PB-I-LOAN-APR.
  8530******************************************************
  8531
  8532     IF PB-COMPANY-ID = 'NCL'
  8533       IF PB-ISSUE
  8534           IF FORM-MASTER-FOUND
  8535             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8536                AM-DISMBR-COVERAGE
  8537                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8538                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8539                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8540                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8541                                           PB-I-LIFE-BENEFIT-CD.
  8542
  8543     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8544
  8545     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8546         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8547         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8548         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8549         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8550         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8551           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8552             GO TO 0301-LIFE-BENEFIT-SEARCH
  8553         ELSE
  8554             NEXT SENTENCE
  8555     ELSE
  8556         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8557
  8558     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8559     MOVE '4'                    TO CNTL-REC-TYPE.
  8560     MOVE +0                     TO CNTL-SEQ-NO.
  8561     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8562
  8563     MOVE '1' TO RC-SW-2.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 157
* EL050.cbl
  8564     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8565
  8566     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8567        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8568         GO TO 0305-BENEFIT-NOT-FOUND.
  8569
  8570     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8571
  8572 0301-LIFE-BENEFIT-SEARCH.
  8573
  8574     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8575
  8576     IF NO-BENEFIT-FOUND
  8577        GO TO 0305-BENEFIT-NOT-FOUND.
  8578
  8579     IF WS-BEN-CD = '99'
  8580        GO TO 0305-BENEFIT-NOT-FOUND.
  8581
  8582     IF PB-COMPANY-ID = 'NCL'
  8583         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8584             GO TO 0304-LIFE-BENEFIT-FOUND.
  8585
  8586     MOVE +1                     TO SUB5.
  8587     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8588
  8589* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8590* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8591     IF PB-COMPANY-ID = 'DMD'
  8592         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8593
  8594 0302-EDIT-ACCT-LF-BENEFITS.
  8595
  8596     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8597        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8598           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8599                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8600           GO TO 03XX-GET-LIFE-ERPLAN.
  8601
  8602     IF SUB5 LESS THAN +20
  8603        ADD +1                   TO SUB5
  8604        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8605
  8606     MOVE +1                     TO SUB5.
  8607
  8608     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8609        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8610
  8611 0303-EDIT-DMD-EXTRA-BENEFITS.
  8612
  8613     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8614        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8615           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8616                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8617           GO TO 03XX-GET-LIFE-ERPLAN.
  8618
  8619     IF SUB5 LESS THAN +30
  8620        ADD +1                   TO SUB5
  8621        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 158
* EL050.cbl
  8622
  8623     MOVE +1                     TO SUB5.
  8624
  8625 03XX-EDIT-FOR-NINETY-LF.
  8626
  8627***************************************************************
  8628*                                                             *
  8629*    NINETY BENEFIT PLAN TYPES:                               *
  8630*                                                             *
  8631*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8632*      92 = ALL GROUP REDUCING BENEFITS                       *
  8633*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8634*      94 = ALL GROUP LEVEL BENEFITS                          *
  8635*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8636*           BENEFIT CONTROLS.                                 *
  8637*      99 = ALL BENEFITS                                      *
  8638*                                                             *
  8639***************************************************************
  8640
  8641     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8642                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8643
  8644     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8645       AND
  8646        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8647        GO TO 03XX-GET-LIFE-ERPLAN.
  8648
  8649     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8650       AND
  8651        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8652        IF CF-REDUCING (SUB3)
  8653           IF (PB-I-INDV-GRP-OVRD = 'I')
  8654              OR
  8655           ((AM-IG = '1') AND
  8656           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8657              OR
  8658           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8659           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8660           (AM-IG NOT = '2'))
  8661              GO TO 03XX-GET-LIFE-ERPLAN.
  8662
  8663     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8664       AND
  8665        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8666        IF CF-REDUCING (SUB3)
  8667           IF (PB-I-INDV-GRP-OVRD = 'G')
  8668              OR
  8669           ((AM-IG = '2') AND
  8670           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8671              OR
  8672           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8673           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8674           (AM-IG NOT = '1'))
  8675              GO TO 03XX-GET-LIFE-ERPLAN.
  8676
  8677     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8678       AND
  8679        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 159
* EL050.cbl
  8680        IF CF-LEVEL    (SUB3)
  8681           IF (PB-I-INDV-GRP-OVRD = 'I')
  8682              OR
  8683           ((AM-IG = '1') AND
  8684           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8685              OR
  8686           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8687           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8688            (AM-IG NOT = '2'))
  8689              GO TO 03XX-GET-LIFE-ERPLAN.
  8690
  8691     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8692       AND
  8693        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8694        IF CF-LEVEL    (SUB3)
  8695           IF (PB-I-INDV-GRP-OVRD = 'G')
  8696              OR
  8697           ((AM-IG = '2') AND
  8698           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8699              OR
  8700           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8701           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8702           (AM-IG NOT = '1'))
  8703              GO TO 03XX-GET-LIFE-ERPLAN.
  8704
  8705     IF SUB5 LESS THAN +20
  8706        ADD +1                   TO SUB5
  8707        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8708
  8709     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8710
  8711     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8712        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8713
  8714     MOVE +1                     TO SUB5.
  8715
  8716 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8717
  8718     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8719                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8720
  8721     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8722       AND
  8723        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8724        GO TO 03XX-GET-LIFE-ERPLAN.
  8725
  8726     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8727       AND
  8728        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8729        IF CF-REDUCING (SUB3)
  8730           IF (PB-I-INDV-GRP-OVRD = 'I')
  8731              OR
  8732           ((AM-IG = '1') AND
  8733           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8734              OR
  8735           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8736           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8737           (AM-IG NOT = '2'))
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 160
* EL050.cbl
  8738              GO TO 03XX-GET-LIFE-ERPLAN.
  8739
  8740     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8741       AND
  8742        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8743        IF CF-REDUCING (SUB3)
  8744           IF (PB-I-INDV-GRP-OVRD = 'G')
  8745              OR
  8746           ((AM-IG = '2') AND
  8747           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8748              OR
  8749           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8750           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8751           (AM-IG NOT = '1'))
  8752              GO TO 03XX-GET-LIFE-ERPLAN.
  8753
  8754     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8755       AND
  8756        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8757        IF CF-LEVEL    (SUB3)
  8758           IF (PB-I-INDV-GRP-OVRD = 'I')
  8759              OR
  8760           ((AM-IG = '1') AND
  8761           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8762              OR
  8763           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8764           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8765            (AM-IG NOT = '2'))
  8766              GO TO 03XX-GET-LIFE-ERPLAN.
  8767
  8768     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8769       AND
  8770        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8771        IF CF-LEVEL    (SUB3)
  8772           IF (PB-I-INDV-GRP-OVRD = 'G')
  8773              OR
  8774           ((AM-IG = '2') AND
  8775           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8776              OR
  8777           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8778           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8779           (AM-IG NOT = '1'))
  8780              GO TO 03XX-GET-LIFE-ERPLAN.
  8781
  8782     IF SUB5 LESS THAN +30
  8783        ADD +1                   TO SUB5
  8784        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8785
  8786     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8787
  8788 03XX-EDIT-FOR-NINETY-LF-CONT.
  8789
  8790     MOVE +99                    TO SUB5.
  8791
  8792     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8793        IF PB-ISSUE
  8794           MOVE ER-1924          TO  WS-ERROR
  8795           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 161
* EL050.cbl
  8796
  8797     GO TO 0304-LIFE-BENEFIT-FOUND.
  8798
  8799 03XX-GET-LIFE-ERPLAN.
  8800
  8801     IF WK-PLAN-ADDR EQUAL +0
  8802        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8803
  8804     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8805     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8806     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8807     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8808     MOVE 'Y'                    TO PLAN-MASTER-SW
  8809                                    PLAN-MASTER-LIFE-SW.
  8810     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8811
  8812 03XX-ERPLAN-LIFE-GETMAIN.
  8813
  8814     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8815     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8816
  8817 03XX-ERPLAN-LIFE-READ.
  8818
  8819     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8820     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8821     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8822     MOVE PB-SV-STATE            TO PLAN-STATE.
  8823     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8824     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8825     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8826     MOVE WS-SAVE-BENEFIT-REVISION
  8827                                 TO PLAN-REVISION-NO.
  8828
  8829     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8830     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8831
  8832     IF PB-COMPANY-ID = 'NCL'
  8833       IF NOT LF-PLAN-MASTER-FOUND
  8834         IF NOT PB-POLICY-IS-DECLINED  AND
  8835            NOT PB-POLICY-IS-VOIDED
  8836             MOVE  ER-1921         TO  WS-ERROR
  8837             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8838             GO TO 0304-LIFE-BENEFIT-FOUND.
  8839
  8840     IF NOT LF-PLAN-MASTER-FOUND
  8841        GO TO 0304-LIFE-BENEFIT-FOUND.
  8842
  8843 XXXX-CHECK-LF-PLAN-KEY.
  8844
  8845     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8846        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8847        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8848        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8849        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8850        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8851        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8852        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8853        MOVE 'N'                 TO PLAN-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 162
* EL050.cbl
  8854          GO TO 03XX-ERPLAN-LIFE-READ.
  8855
  8856     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8857
  8858     IF  PB-CANCELLATION
  8859         GO TO  0303-LF-ACCT-BEN-FOUND.
  8860
  8861     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8862        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8863           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8864           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8865              MOVE ER-2644             TO WS-ERROR
  8866              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8867           ELSE
  8868              NEXT SENTENCE
  8869        ELSE
  8870           IF PB-COMPANY-ID NOT = 'NCL'
  8871              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8872                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8873
  8874 0303-LF-ACCT-BEN-FOUND.
  8875
  8876     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8877
  8878     IF PL-DEV-CODE NOT = SPACES
  8879        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8880
  8881     IF PL-DEV-PCT NUMERIC AND
  8882        PL-DEV-PCT NOT = ZEROS
  8883        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8884
  8885     IF PL-TOL-PREM-AMT GREATER THAN +0
  8886        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8887
  8888     IF PL-TOL-REF-AMT GREATER THAN +0
  8889        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8890
  8891     IF PL-TOL-PREM-PCT GREATER THAN +0
  8892        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8893
  8894     IF PL-TOL-REF-PCT GREATER THAN +0
  8895        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8896
  8897     IF PL-TOL-CLM-AMT GREATER THAN +0
  8898        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8899
  8900     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8901                          PL-OVER-SHORT-AMT > +0
  8902        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8903
  8904     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8905                          PL-OVER-SHORT-PCT > +0
  8906        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8907
  8908     IF PL-SALES-TAX NUMERIC AND
  8909                          PL-SALES-TAX > +0
  8910         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8911
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 163
* EL050.cbl
  8912     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8913        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8914                                    WS-IG-OVRD-AM.
  8915
  8916 0304-LIFE-BENEFIT-FOUND.
  8917
  8918     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8919
  8920     IF PB-ISSUE
  8921        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8922     ELSE
  8923        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8924
  8925     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8926     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8927     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8928     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8929     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8930                                         WS-LF-REFUND-CALC.
  8931     if (ws-lf-earnings-calc = '5')
  8932        and (pb-i-loan-apr = zeros)
  8933        and (benefit-code-chg)
  8934        move +99.9999 to pb-i-loan-apr
  8935     end-if
  8936
  8937     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8938        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8939
  8940     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8941        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8942     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8943
  8944     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8945     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8946     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8947     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8948     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8949     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8950
  8951     IF PB-COMPANY-ID = 'NCL'  AND
  8952        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8953         NEXT SENTENCE
  8954     ELSE
  8955         IF SUB5 NOT GREATER THAN +20
  8956            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8957               MOVE WS-SAVE-BENEFIT-REM-TERM
  8958                                      TO WS-AM-LF-BENE-REM-TERM
  8959                                         EC-BR-LF-REM-TERM-CALC.
  8960
  8961     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8962     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8963
  8964     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8965
  8966 0305-BENEFIT-NOT-FOUND.
  8967
  8968     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8969     MOVE ER-2604                TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 164
* EL050.cbl
  8970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8971
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 165
* EL050.cbl
  8973
  8974 0310-FIND-AH-BENEFIT-RECORD.
  8975
  8976     MOVE 'N'                    TO PLAN-MASTER-SW
  8977                                    PLAN-MASTER-AH-SW.
  8978
  8979     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8980                                    WS-PL-TOL-AH-REFUND
  8981                                    WS-AH-PL-REF-OVS-AMT
  8982                                    WS-PL-TOL-AH-PREM-PCT
  8983                                    WS-PL-TOL-AH-REFUND-PCT
  8984                                    WS-AH-PL-REF-OVS-PCT
  8985                                    WS-PL-TOL-AH-CLAIM.
  8986     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8987
  8988
  8989     if pb-issue
  8990        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8991           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8992        end-if
  8993        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8994           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8995           GO TO 0399-BENEFIT-NOT-FOUND
  8996        end-if
  8997     end-if
  8998
  8999     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9000        GO TO 0400-FIND-CARRIER.
  9001
  9002     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9003
  9004     IF WK-AH-BEN-ADDR NOT = ZEROS
  9005         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9006         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9007         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9008         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9009           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9010             GO TO 0311-AH-BENEFIT-SEARCH
  9011         ELSE
  9012             NEXT SENTENCE
  9013     ELSE
  9014         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9015
  9016     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9017     MOVE '5'                    TO CNTL-REC-TYPE.
  9018     MOVE +0                     TO CNTL-SEQ-NO.
  9019     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9020
  9021     MOVE '2' TO RC-SW-2.
  9022     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9023
  9024     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9025        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9026          GO TO 0399-BENEFIT-NOT-FOUND.
  9027
  9028     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9029
  9030 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 166
* EL050.cbl
  9031
  9032     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9033
  9034     IF NO-BENEFIT-FOUND
  9035         GO TO 0399-BENEFIT-NOT-FOUND.
  9036
  9037     IF WS-BEN-CD = '99'
  9038        GO TO 0399-BENEFIT-NOT-FOUND.
  9039
  9040     IF PB-COMPANY-ID  =  'NCL'
  9041         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9042             GO TO 0314-A-H-BENEFIT-FOUND.
  9043
  9044     MOVE +1                     TO SUB5.
  9045     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9046
  9047* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9048* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9049     IF PB-COMPANY-ID = 'DMD'
  9050         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9051
  9052 0312-EDIT-ACCT-AH-BENEFITS.
  9053
  9054     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9055        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9056           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9057                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9058           GO TO 03XX-GET-AH-ERPLAN.
  9059
  9060     IF SUB5 LESS THAN +20
  9061        ADD +1                   TO SUB5
  9062        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9063
  9064     MOVE +1                     TO SUB5.
  9065
  9066     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9067        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9068
  9069 0313-EDIT-DMD-EXTRA-BENEFITS.
  9070
  9071     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9072        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9073           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9074                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9075           GO TO 03XX-GET-AH-ERPLAN.
  9076
  9077     IF SUB5 LESS THAN +30
  9078        ADD +1                   TO SUB5
  9079        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9080
  9081     MOVE +1                     TO SUB5.
  9082
  9083 03XX-EDIT-FOR-NINETY-AH.
  9084
  9085***************************************************************
  9086*                                                             *
  9087*    NINETY BENEFIT PLAN TYPES:                               *
  9088*                                                             *
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 167
* EL050.cbl
  9089*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9090*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9091*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9092*           BENEFIT CONTROLS.                                 *
  9093*      99 = ALL BENEFITS.                                     *
  9094*                                                             *
  9095***************************************************************
  9096
  9097     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9098                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9099
  9100     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9101       AND
  9102        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9103        GO TO 03XX-GET-AH-ERPLAN.
  9104
  9105     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9106       AND
  9107        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9108           IF (PB-I-INDV-GRP-OVRD = 'I')
  9109              OR
  9110           ((AM-IG = '1') AND
  9111           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9112              OR
  9113           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9114           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9115           (AM-IG NOT = '2'))
  9116              GO TO 03XX-GET-AH-ERPLAN.
  9117
  9118     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9119       AND
  9120        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9121           IF (PB-I-INDV-GRP-OVRD = 'G')
  9122              OR
  9123           ((AM-IG = '2') AND
  9124           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9125              OR
  9126           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9127           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9128           (AM-IG NOT = '1'))
  9129              GO TO 03XX-GET-AH-ERPLAN.
  9130
  9131     IF SUB5 LESS THAN +20
  9132        ADD +1                   TO SUB5
  9133        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9134
  9135     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9136        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9137
  9138     MOVE +1                    TO SUB5.
  9139
  9140 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9141
  9142     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9143                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9144
  9145     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9146       AND
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 168
* EL050.cbl
  9147        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9148        GO TO 03XX-GET-AH-ERPLAN.
  9149
  9150     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9151       AND
  9152        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9153           IF (PB-I-INDV-GRP-OVRD = 'I')
  9154              OR
  9155           ((AM-IG = '1') AND
  9156           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9157              OR
  9158           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9159           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9160           (AM-IG NOT = '2'))
  9161              GO TO 03XX-GET-AH-ERPLAN.
  9162
  9163     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9164       AND
  9165        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9166           IF (PB-I-INDV-GRP-OVRD = 'G')
  9167              OR
  9168           ((AM-IG = '2') AND
  9169           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9170              OR
  9171           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9172           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9173           (AM-IG NOT = '1'))
  9174              GO TO 03XX-GET-AH-ERPLAN.
  9175
  9176     IF SUB5 LESS THAN +30
  9177        ADD +1                   TO SUB5
  9178        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9179
  9180 03XX-EDIT-FOR-NINETY-AH-CONT.
  9181
  9182     MOVE +99                    TO SUB5.
  9183
  9184     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9185
  9186     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9187        IF PB-ISSUE
  9188           MOVE ER-1925          TO  WS-ERROR
  9189           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9190
  9191     GO TO 0314-A-H-BENEFIT-FOUND.
  9192
  9193 03XX-GET-AH-ERPLAN.
  9194
  9195     IF WK-PLAN-ADDR EQUAL +0
  9196         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9197
  9198     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9199     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9200     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9201     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9202     MOVE 'Y'                    TO PLAN-MASTER-SW
  9203                                    PLAN-MASTER-AH-SW.
  9204*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 169
* EL050.cbl
  9205     GO TO 03XX-ERPLAN-AH-READ.
  9206
  9207 03XX-ERPLAN-AH-GETMAIN.
  9208
  9209     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9210     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9211
  9212 03XX-ERPLAN-AH-READ.
  9213
  9214     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9215     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9216     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9217     MOVE PB-SV-STATE            TO PLAN-STATE.
  9218     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9219     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9220     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9221     MOVE WS-SAVE-BENEFIT-REVISION
  9222                                 TO PLAN-REVISION-NO.
  9223
  9224     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9225     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9226
  9227     IF PB-COMPANY-ID = 'NCL'
  9228       IF NOT AH-PLAN-MASTER-FOUND
  9229         IF NOT PB-POLICY-IS-DECLINED  AND
  9230            NOT PB-POLICY-IS-VOIDED
  9231             MOVE  ER-1922         TO  WS-ERROR
  9232             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9233             GO TO 0314-A-H-BENEFIT-FOUND.
  9234
  9235     IF NOT AH-PLAN-MASTER-FOUND
  9236        GO TO 0314-A-H-BENEFIT-FOUND.
  9237
  9238 XXXX-CHECK-AH-PLAN-KEY.
  9239
  9240     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9241        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9242        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9243        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9244        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9245        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9246        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9247        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9248        MOVE 'N'                 TO PLAN-MASTER-SW
  9249          GO TO 03XX-ERPLAN-AH-READ.
  9250
  9251     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9252
  9253     IF  PB-CANCELLATION
  9254         GO TO  0313-AH-ACCT-BEN-FOUND.
  9255
  9256     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9257       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9258          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9259          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9260             MOVE ER-2644             TO WS-ERROR
  9261             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9262          ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 170
* EL050.cbl
  9263             NEXT SENTENCE
  9264       ELSE
  9265          IF PB-COMPANY-ID NOT = 'NCL'
  9266             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9267                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9268
  9269 0313-AH-ACCT-BEN-FOUND.
  9270
  9271     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9272
  9273     IF PL-DEV-CODE NOT = SPACES
  9274        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9275
  9276     IF PL-DEV-PCT NUMERIC AND
  9277        PL-DEV-PCT NOT = ZEROS
  9278        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9279
  9280     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9281        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9282
  9283     IF PL-TOL-REF-AMT NOT EQUAL +0
  9284        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9285
  9286     IF PL-TOL-PREM-PCT GREATER THAN +0
  9287        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9288
  9289     IF PL-TOL-REF-PCT GREATER THAN +0
  9290        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9291
  9292     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9293        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9294
  9295     IF PL-OVER-SHORT-AMT NUMERIC AND
  9296                          PL-OVER-SHORT-AMT > +0
  9297        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9298
  9299     IF PL-OVER-SHORT-PCT NUMERIC AND
  9300                          PL-OVER-SHORT-PCT > +0
  9301        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9302
  9303     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9304        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9305        IF WS-IG-OVRD-AM EQUAL SPACES
  9306            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9307
  9308 0314-A-H-BENEFIT-FOUND.
  9309
  9310     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9311
  9312     IF PB-ISSUE
  9313        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9314       ELSE
  9315        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9316
  9317     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9318     if cf-maximum-benefits (sub3) numeric
  9319        move cf-maximum-benefits (sub3)
  9320                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 171
* EL050.cbl
  9321     else
  9322        move zeros               to ws-ah-max-bens
  9323     end-if
  9324     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9325     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9326     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9327                                         WS-AH-REFUND-CALC.
  9328
  9329     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9330        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9331
  9332     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9333        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9334     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9335
  9336     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9337     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9338     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9339     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9340     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9341     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9342
  9343     IF PB-COMPANY-ID = 'NCL'  AND
  9344        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9345         NEXT SENTENCE
  9346     ELSE
  9347         IF SUB5 NOT GREATER THAN +20
  9348            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9349                MOVE WS-SAVE-BENEFIT-REM-TERM
  9350                                      TO WS-AM-AH-BENE-REM-TERM
  9351                                         EC-BR-AH-REM-TERM-CALC.
  9352
  9353     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9354     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9355
  9356     GO TO 0400-FIND-CARRIER.
  9357
  9358 0399-BENEFIT-NOT-FOUND.
  9359
  9360     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9361     MOVE ER-2605                TO WS-ERROR.
  9362     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9363
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 172
* EL050.cbl
  9365
  9366 0400-FIND-CARRIER.
  9367
  9368     MOVE PB-SV-CARRIER          TO WS-CARR.
  9369
  9370     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9371     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9372     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9373     MOVE '6'                    TO CNTL-REC-TYPE.
  9374
  9375*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9376     MOVE SPACE                  TO WS-DMD-RATING-SW
  9377                                    EC-BR-DMD-RATING-SW.
  9378
  9379     MOVE '2'                    TO RC-SW-1.
  9380     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9381
  9382     IF NOT CF-CARRIER-MASTER
  9383        GO TO 0400-CARRIER-NOT-FOUND.
  9384
  9385 0400-BUILD-CARR-TOL.
  9386
  9387     IF CF-CR-TOL-PREM NUMERIC AND
  9388        CF-CR-TOL-PREM GREATER THAN +0
  9389        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9390                                    WS-TOL-AH-PREM.
  9391
  9392     IF CF-CR-TOL-REFUND NUMERIC AND
  9393        CF-CR-TOL-REFUND GREATER THAN +0
  9394        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9395                                    WS-TOL-AH-REFUND.
  9396
  9397     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9398        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9399        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9400                                    WS-AH-REFUND-OVS-AMT.
  9401
  9402     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9403        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9404        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9405                                    WS-AH-REFUND-OVS-PCT.
  9406
  9407     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9408        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9409        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9410                                    WS-TOL-AH-PREM-PCT.
  9411
  9412     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9413        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9414        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9415                                     WS-TOL-AH-REFUND-PCT.
  9416
  9417     IF CF-COMPANY-ID EQUAL 'DMD'
  9418         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9419                                    EC-BR-DMD-RATING-SW.
  9420
  9421     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9422     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 173
* EL050.cbl
  9423        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9424     END-IF
  9425     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9426        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9427     END-IF
  9428     IF WS-TOL-CLP-PCT = ZEROS
  9429        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9430     END-IF
  9431
  9432     IF WS-SPP-LEASE-COMM = ZEROS
  9433        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9434     END-IF
  9435     GO TO 0400-FIND-ERPDEF.
  9436
  9437 0400-CARRIER-NOT-FOUND.
  9438
  9439     MOVE ER-2602                TO WS-ERROR.
  9440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9441
  9442 0400-FIND-ERPDEF.
  9443     IF PB-COMPANY-ID = 'DCC'
  9444        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9445        CONTINUE
  9446     ELSE
  9447        GO TO 0400-FIND-ERCOMP
  9448     END-IF
  9449     MOVE ' '                    TO PDEF-MASTER-SW
  9450     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9451     MOVE PB-STATE               TO ERPDEF-STATE
  9452     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9453     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9454     IF PB-ISSUE
  9455        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9456     ELSE
  9457        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9458     END-IF
  9459     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9460     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9461     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9462     IF PDEF-MASTER-FOUND
  9463        MOVE 'N'                 TO PDEF-MASTER-SW
  9464        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9465        IF PDEF-MASTER-FOUND
  9466           IF (ERPDEF-KEY-SAVE (1:16) =
  9467                        PD-CONTROL-PRIMARY (1:16))
  9468              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9469              CONTINUE
  9470           ELSE
  9471              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9472              IF (ERPDEF-KEY-SAVE (1:16) =
  9473                        PD-CONTROL-PRIMARY (1:16))
  9474                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9475                 CONTINUE
  9476              ELSE
  9477                 MOVE 'N'        TO PDEF-MASTER-SW
  9478              END-IF
  9479           END-IF
  9480        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 174
* EL050.cbl
  9481        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9482     END-IF
  9483     IF PDEF-MASTER-FOUND
  9484        IF PD-TRUNCATED = 'Y'
  9485           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9486        END-IF
  9487     END-IF
  9488     .
  9489 0400-FIND-ERCOMP.
  9490     IF PB-COMPANY-ID = 'DCC'
  9491        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9492           (WS-SUB1 > +10)
  9493           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9494                 OR 'A' OR 'N'
  9495              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9496              MOVE PB-CARRIER    TO COMP-CARRIER
  9497              MOVE PB-GROUPING   TO COMP-GROUPING
  9498              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9499              MOVE AM-AGT (WS-SUB1)
  9500                                 TO COMP-FIN-RESP
  9501              MOVE 'G'           TO COMP-TYPE
  9502              PERFORM 8582-READ-COMPENSATION-MASTER
  9503                                 THRU 8582-EXIT
  9504              IF COMP-MASTER-FOUND
  9505                 IF CO-GA-INACTIVE
  9506                    MOVE ER-2763 TO WS-ERROR
  9507                    PERFORM 9900-ERROR-FORMAT
  9508                                 THRU 9900-EXIT
  9509                    MOVE +11     TO WS-SUB1
  9510                 END-IF
  9511                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9512                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9513                    MOVE ER-2788 TO WS-ERROR
  9514                    PERFORM 9900-ERROR-FORMAT
  9515                                 THRU 9900-EXIT
  9516                    MOVE +11     TO WS-SUB1
  9517                 END-IF
  9518              END-IF
  9519           END-IF
  9520        END-PERFORM
  9521     END-IF
  9522     IF PB-COMPANY-ID = 'DCC'
  9523        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9524           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9525                                    WS-CLP-STATE
  9526        ELSE
  9527           MOVE SPACES           TO PB-I-CLP-STATE
  9528                                    WS-CLP-STATE
  9529        END-IF
  9530     END-IF
  9531
  9532     IF (PB-COMPANY-ID = 'DCC')
  9533        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9534        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9535        CONTINUE
  9536     ELSE
  9537        GO TO 0400-FIND-STATE-RECORD
  9538     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 175
* EL050.cbl
  9539     MOVE SPACES                 TO WS-CLP-STATE
  9540     MOVE +0                     TO WS-BANK-FEE
  9541                                    WS-BANK-LFEE
  9542                                    WS-BANK-NOCHRGB
  9543
  9544     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9545     IF (PB-ISSUE)
  9546        AND (PB-I-BANK-NUMBER NOT =
  9547            SPACES AND ZEROS AND LOW-VALUES)
  9548        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9549     ELSE
  9550        IF (PB-CANCELLATION)
  9551           AND (PB-CI-BANK-NUMBER NOT =
  9552                SPACES AND ZEROS AND LOW-VALUES)
  9553           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9554        END-IF
  9555     END-IF
  9556     IF COMP-FIN-RESP NOT = LOW-VALUES
  9557        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9558        MOVE PB-CARRIER          TO COMP-CARRIER
  9559        MOVE PB-GROUPING         TO COMP-GROUPING
  9560        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9561        MOVE 'B'                 TO COMP-TYPE
  9562        PERFORM 8582-READ-COMPENSATION-MASTER
  9563                                 THRU 8582-EXIT
  9564        IF COMP-MASTER-FOUND
  9565           IF CO-MAX-BANK-FEE NOT NUMERIC
  9566              MOVE +0            TO CO-MAX-BANK-FEE
  9567           END-IF
  9568           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9569              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9570           END-IF
  9571           IF CO-GA-INACTIVE
  9572              MOVE ER-2763       TO WS-ERROR
  9573              PERFORM 9900-ERROR-FORMAT
  9574                                 THRU 9900-EXIT
  9575           END-IF
  9576           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9577              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9578              MOVE ER-2788 TO WS-ERROR
  9579              PERFORM 9900-ERROR-FORMAT
  9580                                 THRU 9900-EXIT
  9581              MOVE +11     TO WS-SUB1
  9582           END-IF
  9583           IF WS-AH-BEN-CATEGORY = 'G'
  9584              MOVE CO-MAX-BANK-FEE
  9585                                 TO WS-BANK-FEE
  9586                                    PB-I-BANK-FEE
  9587           ELSE
  9588              MOVE CO-MAX-BANK-FEE-LEASE
  9589                                 TO WS-BANK-LFEE
  9590                                    PB-I-BANK-FEE
  9591           END-IF
  9592           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9593              AND (WS-AH-REFUND-CALC = 'G'))
  9594                        OR
  9595              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9596              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 176
* EL050.cbl
  9597              CONTINUE
  9598           ELSE
  9599              MOVE ER-2789 TO WS-ERROR
  9600              PERFORM 9900-ERROR-FORMAT
  9601                                 THRU 9900-EXIT
  9602           END-IF
  9603           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9604                                    PB-I-CLP-STATE
  9605           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9606           MOVE CO-CARRIER       TO BXRF-CARRIER
  9607           MOVE CO-GROUPING      TO BXRF-GROUPING
  9608           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9609           MOVE BXRF-MAX-REC-LENGTH
  9610                                 TO BXRF-REC-LENGTH
  9611           PERFORM 8584-READ-BANK-CROSS-REF
  9612                                 THRU 8584-EXIT
  9613           IF BXRF-MASTER-FOUND
  9614              MOVE ' '           TO BANK-ACCT-SW
  9615              MOVE BK-BANK-POINTER-CNT
  9616                                 TO BK-BANK-POINTER-CNT
  9617              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9618                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9619                 OR (BANK-ACCT-FOUND)
  9620                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9621                    AND (BK-AM-EXP-DT (WS-SUB1)
  9622                                 > PB-CERT-EFF-DT)
  9623                    AND (BK-AM-EFF-DT (WS-SUB1)
  9624                                 NOT > PB-CERT-EFF-DT)
  9625                    SET BANK-ACCT-FOUND TO TRUE
  9626                 END-IF
  9627              END-PERFORM
  9628              IF NOT BANK-ACCT-FOUND
  9629                 MOVE ZEROS      TO WS-BANK-FEE
  9630                                    WS-BANK-LFEE
  9631                 MOVE ER-2869    TO WS-ERROR
  9632                 PERFORM 9900-ERROR-FORMAT
  9633                                 THRU 9900-EXIT
  9634              ELSE
  9635                 PERFORM 5000-PROCESS-REPS
  9636                                 THRU 5000-EXIT
  9637                 IF AGENT-MASTER-FOUND
  9638                    MOVE +0      TO WS-BANK-FEE
  9639                                    WS-BANK-LFEE
  9640*                   MOVE AG-SPP-FEES (1)
  9641*                                TO PB-I-BANK-FEE
  9642*                                   WS-BANK-FEE
  9643                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9644                       (WS-SUB1 > +10)
  9645                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9646                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9647                       END-IF
  9648                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9649                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9650                       END-IF
  9651                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9652                          AG-SPP-FEES (WS-SUB1)
  9653                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9654                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 177
* EL050.cbl
  9655                    END-PERFORM
  9656                    IF WS-AH-BEN-CATEGORY = 'G'
  9657                       MOVE WS-BANK-FEE
  9658                                 TO PB-I-BANK-FEE
  9659                    ELSE
  9660                       MOVE WS-BANK-LFEE
  9661                                 TO PB-I-BANK-FEE
  9662                    END-IF
  9663                 END-IF
  9664              END-IF
  9665           END-IF
  9666        ELSE
  9667           MOVE ER-2879          TO WS-ERROR
  9668           PERFORM 9900-ERROR-FORMAT
  9669                                 THRU 9900-EXIT
  9670        END-IF
  9671     ELSE
  9672        MOVE ER-2879             TO WS-ERROR
  9673        PERFORM 9900-ERROR-FORMAT
  9674                                 THRU 9900-EXIT
  9675     END-IF
  9676     IF WS-AH-BEN-CATEGORY = 'G'
  9677        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9678        + WS-BANK-FEE
  9679     ELSE
  9680        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9681        + WS-BANK-LFEE
  9682     END-IF
  9683     .
  9684 0400-FIND-STATE-RECORD.
  9685
  9686     IF WK-STATE-ADDR NOT = ZEROS
  9687         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9688         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9689         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9690         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9691         IF PB-SV-STATE = CF-STATE-CODE
  9692             GO TO 0405-CONTINUE-EDIT
  9693         ELSE
  9694             NEXT SENTENCE
  9695     ELSE
  9696         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9697
  9698     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9699     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9700     MOVE '3'                    TO CNTL-REC-TYPE.
  9701     MOVE +0                     TO CNTL-SEQ-NO.
  9702
  9703     MOVE '3'                    TO RC-SW-2.
  9704     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9705
  9706     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9707        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9708        PB-SV-STATE   NOT = CF-STATE-CODE)
  9709        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9710                                    WS-TOL-AH-CLAIM
  9711                                    WS-MINIMUM-REFUND
  9712                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 178
* EL050.cbl
  9713                                    WS-TOL-AH-PREM
  9714                                    WS-TOL-LF-REFUND
  9715                                    WS-TOL-AH-REFUND
  9716                                    EC-ST-TOL-PREM-PCT
  9717                                    WS-TOL-LF-PREM-PCT
  9718                                    WS-TOL-AH-PREM-PCT
  9719                                    EC-ST-TOL-REFUND-PCT
  9720                                    WS-TOL-LF-REFUND-PCT
  9721                                    WS-TOL-AH-REFUND-PCT
  9722                                    EC-ST-TOL-PREM
  9723                                    EC-ST-TOL-REFUND
  9724                                    EC-ST-FST-PMT-DAYS-MAX
  9725                                    WS-FREE-LOOK-PERIOD
  9726                                    WS-ST-LF-PREM-TAX
  9727                                    WS-ST-AH-PREM-TAX-I
  9728                                    WS-ST-AH-PREM-TAX-G
  9729                                    WS-BANK-FEE
  9730                                    WS-BANK-LFEE
  9731                                    WS-TOL-CLP-PCT
  9732                                    WS-SPP-LEASE-COMM
  9733                                    WS-INT-PERIODS
  9734                                    WS-EXTRA-PMTS
  9735        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9736                                    EC-ST-FST-PMT-DAYS-CHG
  9737                                    WS-LF-REM-TERM-CALC
  9738                                    WS-LF-REFUND-CALC
  9739                                    EC-ST-LF-REM-TERM-CALC
  9740                                    EC-ST-LF-REFUND-CALC
  9741                                    WS-AH-REM-TERM-CALC
  9742                                    WS-AH-REFUND-CALC
  9743                                    WS-LF-BEN-CATEGORY
  9744                                    WS-AH-BEN-CATEGORY
  9745                                    WS-CLP-STATE
  9746                                    WS-ST-REFUND-CLAIM-FLAG
  9747                                    WS-ST-CAUSAL-STATE
  9748                                    ws-st-agent-sig-edit
  9749                                    EC-ST-AH-REM-TERM-CALC
  9750                                    EC-ST-AH-REFUND-CALC
  9751          GO TO 0499-STATE-NOT-FOUND.
  9752
  9753     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9754
  9755 0405-CONTINUE-EDIT.
  9756
  9757     if pb-company-id = 'AHL'
  9758        continue
  9759     else
  9760        IF PB-CERT-PRIME NOT NUMERIC
  9761           MOVE ER-2722          TO WS-ERROR
  9762           PERFORM 9900-ERROR-FORMAT
  9763                                 THRU 9900-EXIT
  9764        end-if
  9765     END-IF
  9766*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9767*       MOVE +0                  TO SUB3
  9768*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9769*       IF SUB3 > +0
  9770*          MOVE ER-2722          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 179
* EL050.cbl
  9771*          PERFORM 9900-ERROR-FORMAT
  9772*                                THRU 9900-EXIT
  9773*       END-IF
  9774*    END-IF
  9775*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9776*       IF PB-CERT-PRIME NOT NUMERIC
  9777*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9778*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9779*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9780*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9781*
  9782*          MOVE ER-2722          TO WS-ERROR
  9783*          PERFORM 9900-ERROR-FORMAT
  9784*                                THRU 9900-EXIT
  9785*       END-IF
  9786*    END-IF
  9787
  9788     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9789
  9790     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9791        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9792                                    WS-TOL-AH-CLAIM.
  9793
  9794     IF CF-ST-REFUND-MIN NOT NUMERIC
  9795        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9796
  9797     IF CF-ST-REFUND-MIN NOT = ZEROS
  9798        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9799
  9800     IF CF-ST-TOL-PREM  NOT = ZEROS
  9801        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9802                                    WS-TOL-AH-PREM
  9803        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9804
  9805     IF CF-ST-TOL-REFUND NOT = ZEROS
  9806        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9807                                    WS-TOL-AH-REFUND
  9808        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9809
  9810     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9811        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9812        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9813                                    WS-AH-REFUND-OVS-AMT
  9814                                    EC-ST-OVR-SHT-AMT.
  9815
  9816     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9817        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9818        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9819                                    WS-TOL-LF-PREM-PCT
  9820                                    WS-TOL-AH-PREM-PCT.
  9821
  9822     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9823        CF-ST-TOL-REF-PCT GREATER THAN +0
  9824        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9825                                    WS-TOL-LF-REFUND-PCT
  9826                                    WS-TOL-AH-REFUND-PCT.
  9827
  9828     IF CF-ST-OVR-SHT-PCT NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 180
* EL050.cbl
  9829        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9830        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9831                                    WS-AH-REFUND-OVS-PCT
  9832                                    EC-ST-OVR-SHT-PCT.
  9833
  9834     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9835     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9836
  9837     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9838          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9839
  9840     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9841     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9842     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9843
  9844     IF CF-ST-LF-PREM-TAX NUMERIC
  9845        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9846     END-IF
  9847     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9848        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9849     END-IF
  9850     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9851        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9852     END-IF
  9853
  9854     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9855         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9856     END-IF.
  9857
  9858     IF CF-ST-CAUSAL-STATE > SPACES
  9859         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9860     END-IF.
  9861     if cf-st-extra-interest-periods not numeric
  9862        move zeros               to cf-st-extra-interest-periods
  9863     end-if
  9864     if cf-st-extra-payments not numeric
  9865        move zeros               to cf-st-extra-payments
  9866     end-if
  9867
  9868     move cf-st-extra-interest-periods
  9869                                 to ws-int-periods
  9870     move cf-st-extra-payments   to ws-extra-pmts
  9871     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9872     move cf-st-net-only-state   to ws-net-only-state
  9873     IF WS-LF-BENEFIT-CD = ZEROS
  9874        GO TO 0410-CHECK-AH.
  9875
  9876     IF CF-ST-RT-CALC NOT = SPACES
  9877        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9878                                    EC-ST-LF-REM-TERM-CALC
  9879     END-IF
  9880
  9881     IF WS-LF-COVERAGE-TYPE = 'R'
  9882        IF WS-LF-EARNINGS-CALC = '5'
  9883           IF CF-ST-RF-LN-CALC > '0'
  9884              MOVE CF-ST-RF-LN-CALC
  9885                                 TO WS-LF-REFUND-CALC
  9886                                    EC-ST-LF-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 181
* EL050.cbl
  9887           END-IF
  9888        ELSE
  9889           IF CF-ST-RF-LR-CALC > '0'
  9890              MOVE CF-ST-RF-LR-CALC
  9891                                 TO WS-LF-REFUND-CALC
  9892                                    EC-ST-LF-REFUND-CALC
  9893           END-IF
  9894        END-IF
  9895     ELSE
  9896        IF CF-ST-RF-LL-CALC > '0'
  9897           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9898                                    EC-ST-LF-REFUND-CALC
  9899        END-IF
  9900     END-IF
  9901
  9902     IF CF-ST-RT-CALC NOT = SPACES
  9903        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9904                                    EC-ST-LF-REM-TERM-CALC
  9905     END-IF
  9906
  9907     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9908     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9909
  9910     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9911
  9912     IF NO-BENEFIT-FOUND
  9913        GO TO 0410-CHECK-AH.
  9914
  9915     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9916        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9917                                 TO EC-ST-LF-REM-TERM-CALC
  9918                                    WS-LF-REM-TERM-CALC
  9919     END-IF
  9920
  9921     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9922        MOVE CF-ST-REFUND-CALC (SUB3)
  9923                                 TO WS-LF-REFUND-CALC
  9924                                    EC-ST-LF-REFUND-CALC
  9925     END-IF
  9926*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9927     if cf-st-extra-periods (sub3) not numeric
  9928        move zeros               to cf-st-extra-periods (sub3)
  9929     end-if
  9930     if cf-st-extra-periods (sub3) > zeros
  9931        if ws-lf-ben-category = 'P'
  9932           move cf-st-extra-periods (sub3)
  9933                                 to ws-extra-pmts
  9934        else
  9935           if ws-lf-ben-category = 'I'
  9936              move cf-st-extra-periods (sub3)
  9937                                 to ws-int-periods
  9938           end-if
  9939        end-if
  9940     end-if
  9941     .
  9942 0410-CHECK-AH.
  9943
  9944     IF WS-AH-BENEFIT-CD = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 182
* EL050.cbl
  9945        GO TO 0500-SET-ACCOUNT.
  9946
  9947     IF CF-ST-RT-CALC NOT = SPACES
  9948        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9949                                    EC-ST-AH-REM-TERM-CALC
  9950     END-IF
  9951
  9952     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9953        IF CF-ST-RF-CP-CALC > '0'
  9954           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9955                                    EC-ST-AH-REFUND-CALC
  9956        END-IF
  9957     ELSE
  9958        IF CF-ST-RF-AH-CALC > '0'
  9959           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9960                                    EC-ST-AH-REFUND-CALC
  9961        END-IF
  9962     END-IF
  9963     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9964     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9965
  9966     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9967
  9968     IF NO-BENEFIT-FOUND
  9969        GO TO 0500-SET-ACCOUNT.
  9970
  9971     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9972        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9973                                 TO WS-AH-REM-TERM-CALC
  9974                                    EC-ST-AH-REM-TERM-CALC
  9975     END-IF
  9976
  9977     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9978        MOVE CF-ST-REFUND-CALC (SUB3)
  9979                                 TO WS-AH-REFUND-CALC
  9980                                    EC-ST-AH-REFUND-CALC
  9981     END-IF
  9982
  9983*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9984
  9985     GO TO 0500-SET-ACCOUNT.
  9986
  9987 0499-STATE-NOT-FOUND.
  9988
  9989     MOVE ER-2603                TO WS-ERROR.
  9990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9991
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 183
* EL050.cbl
  9993
  9994 0500-SET-ACCOUNT.
  9995*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9996     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9997        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9998        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9999        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10000        MOVE '3'                 TO CNTL-REC-TYPE
 10001        MOVE +0                  TO CNTL-SEQ-NO
 10002
 10003        MOVE '3'                 TO RC-SW-2
 10004        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10005
 10006        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10007           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10008           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10009           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10010                                    WS-ST-AH-PREM-TAX-I
 10011                                    WS-ST-AH-PREM-TAX-G
 10012        ELSE
 10013           IF CF-ST-LF-PREM-TAX NUMERIC
 10014              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10015           END-IF
 10016           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10017              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10018           END-IF
 10019           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10020              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10021           END-IF
 10022        END-IF
 10023        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10024     END-IF
 10025*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10026*  FOR DCC ONLY
 10027     IF PB-COMPANY-ID = 'DCC'
 10028
 10029     MOVE ' '                    TO STAT-MASTER-SW
 10030     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10031     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10032     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10033     MOVE PB-STATE               TO ELSTAT-STATE
 10034     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10035        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10036     END-IF
 10037
 10038     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10039     SET BIN-TO-GREG             TO TRUE
 10040     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10041     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10042     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10043
 10044     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10045     IF STAT-MASTER-FOUND
 10046        MOVE 'N'                 TO STAT-MASTER-SW
 10047        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10048        IF STAT-MASTER-FOUND
 10049           IF (ELSTAT-KEY-SAVE (1:12) =
 10050                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 184
* EL050.cbl
 10051              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10052                 MOVE 'F'        TO STAT-MASTER-SW
 10053              ELSE
 10054                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10055                 IF (STAT-MASTER-FOUND)
 10056                    AND (ELSTAT-KEY-SAVE (1:12) =
 10057                        SF-CONTROL-PRIMARY (1:12))
 10058                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10059                    MOVE 'F'     TO STAT-MASTER-SW
 10060                 END-IF
 10061              END-IF
 10062           END-IF
 10063        END-IF
 10064     END-IF
 10065
 10066     IF STAT-MASTER-SW = 'F'
 10067        IF SF-ST-LF-PREM-TAX NUMERIC
 10068           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10069        END-IF
 10070        IF SF-ST-AH-PREM-TAX-I NUMERIC
 10071           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10072        END-IF
 10073        IF SF-ST-AH-PREM-TAX-G NUMERIC
 10074           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10075        END-IF
 10076     END-IF
 10077
 10078     END-IF
 10079     IF (PB-COMPANY-ID = 'DCC')
 10080        AND (PB-ISSUE)
 10081        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10082        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10083        AND (AM-GPCD = 06)
 10084        MOVE 'Y'                 TO WS-GOOD-HIN
 10085        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10086           MOVE PB-I-VIN         TO WS-WORK-VIN
 10087           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10088              (V1 > 16)
 10089              IF WS-WORK-VIN (V1:1) NUMERIC
 10090                 MOVE WS-WORK-VIN-N (V1)
 10091                                 TO WS-ROW-B-VAL (V1)
 10092              ELSE
 10093                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10094                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10095                    OR (V2 > 26)
 10096                 END-PERFORM
 10097                 IF V2 < 27
 10098                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10099                 ELSE
 10100                    MOVE 'N'     TO WS-GOOD-HIN
 10101                 END-IF
 10102              END-IF
 10103              COMPUTE WS-ROW-D-VAL (V1) =
 10104                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10105              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10106                 WS-ROW-D-VAL (V1)
 10107           END-PERFORM
 10108           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 185
* EL050.cbl
 10109           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10110             REMAINDER WS-VIN-REMAINDER
 10111           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10112              CONTINUE
 10113           ELSE
 10114              MOVE 'N'           TO WS-GOOD-HIN
 10115           END-IF
 10116        ELSE
 10117           MOVE 'N'              TO WS-GOOD-HIN
 10118        END-IF
 10119        IF WS-GOOD-HIN NOT = 'Y'
 10120           MOVE ER-3826           TO WS-ERROR
 10121           PERFORM 9900-ERROR-FORMAT
 10122                                 THRU 9900-EXIT
 10123        END-IF
 10124     END-IF
 10125     IF (PB-COMPANY-ID = 'DCC')
 10126        AND (PB-ISSUE)
 10127        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10128        AND (AM-GPCD NOT = 06)
 10129        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10130           perform 3400-edit-vin thru 3400-exit
 10131        ELSE
 10132          MOVE ER-3826           TO WS-ERROR
 10133          PERFORM 9900-ERROR-FORMAT
 10134                                 THRU 9900-EXIT
 10135        END-IF
 10136     END-IF
 10137     if (pb-company-id = 'CID')
 10138        and (pb-issue)
 10139        and (pb-i-vin not = spaces and low-values and zeros)
 10140        perform 3400-edit-vin    thru 3400-exit
 10141     end-if
 10142******************************************************************
 10143******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10144******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10145******* METHODS.
 10146******************************************************************
 10147     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10148        IF PB-CANCELLATION
 10149           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10150              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10151                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10152                IF FORM-MASTER-FOUND
 10153                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10154******************************************************************
 10155
 10156     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10157     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10158
 10159     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10160     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10161     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10162     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10163
 10164
 10165     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10166     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 186
* EL050.cbl
 10167     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10168
 10169     IF AM-LF-OB-RATE NOT NUMERIC
 10170         MOVE ZERO               TO AM-LF-OB-RATE.
 10171
 10172     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10173         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10174
 10175     IF AM-AH-OB-RATE NOT NUMERIC
 10176         MOVE ZERO               TO AM-AH-OB-RATE.
 10177
 10178     IF WS-LF-JOINT-INDICATOR = 'J'
 10179         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10180     ELSE
 10181         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10182
 10183     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10184
 10185     IF WS-IG-OVRD-AM  EQUAL SPACE
 10186         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10187
 10188     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10189         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10190                                       WS-IG-OVRD
 10191     ELSE
 10192         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10193             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10194                                       WS-IG-OVRD
 10195         ELSE
 10196             MOVE AM-IG             TO WS-IG-OVRD-AH
 10197                                       WS-IG-OVRD.
 10198
 10199     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10200         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10201                                       WS-IG-OVRD
 10202     ELSE
 10203         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10204             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10205                                       WS-IG-OVRD
 10206         ELSE
 10207             MOVE AM-IG             TO WS-IG-OVRD-LF
 10208                                       WS-IG-OVRD.
 10209
 10210     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10211     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10212     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10213     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10214     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10215
 10216     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10217     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10218     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10219     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10220
 10221     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10222     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10223     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10224     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 187
* EL050.cbl
 10225     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10226     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10227     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10228
 10229     IF WS-ACCT-AH-DEV-PCT > +0
 10230        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10231     ELSE
 10232        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10233
 10234     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10235        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10236     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10237        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10238
 10239        IF AM-EARN-METHOD-L = 'S'
 10240            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10241                                        WS-LF-REFUND-CALC.
 10242
 10243        IF AM-EARN-METHOD-R = 'S'
 10244            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10245                                        WS-LF-REFUND-CALC.
 10246
 10247     IF WS-LF-COVERAGE-TYPE = 'R'
 10248         IF AM-EARN-METHOD-R = 'R'
 10249            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10250                                    WS-LF-REFUND-CALC.
 10251     IF WS-LF-COVERAGE-TYPE = 'R'
 10252         IF AM-EARN-METHOD-R = 'P'
 10253            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10254                                    WS-LF-REFUND-CALC.
 10255     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10256         IF AM-EARN-METHOD-L = 'R'
 10257            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10258                                    WS-LF-REFUND-CALC.
 10259     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10260         IF AM-EARN-METHOD-L = 'P'
 10261            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10262                                    WS-LF-REFUND-CALC.
 10263     IF WS-LF-COVERAGE-TYPE = 'R'
 10264         IF AM-EARN-METHOD-R = 'A'
 10265            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10266                                    WS-LF-REFUND-CALC.
 10267     IF WS-LF-COVERAGE-TYPE = 'R'
 10268         IF AM-EARN-METHOD-R = 'M'
 10269            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10270                                    WS-LF-REFUND-CALC.
 10271     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10272         IF AM-EARN-METHOD-L = 'A'
 10273            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10274                                    WS-LF-REFUND-CALC.
 10275     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10276         IF AM-EARN-METHOD-L = 'M'
 10277            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10278                                    WS-LF-REFUND-CALC.
 10279
 10280     IF AM-EARN-METHOD-A = 'R'
 10281        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10282                                    WS-AH-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 188
* EL050.cbl
 10283     IF AM-EARN-METHOD-A = 'P'
 10284        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10285                                    WS-AH-REFUND-CALC.
 10286     IF AM-EARN-METHOD-A = 'C'
 10287        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10288                                    WS-AH-REFUND-CALC.
 10289     IF AM-EARN-METHOD-A = 'A'
 10290        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10291                                    WS-AH-REFUND-CALC.
 10292     IF AM-EARN-METHOD-A = 'M'
 10293        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10294                                    WS-AH-REFUND-CALC.
 10295     IF AM-EARN-METHOD-A = 'N'
 10296        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10297                                    WS-AH-REFUND-CALC.
 10298     IF AM-EARN-METHOD-A = 'S'
 10299        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10300                                    WS-AH-REFUND-CALC.
 10301
 10302     IF AM-TOL-PREM NOT = ZEROS
 10303        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10304                                    WS-TOL-AH-PREM.
 10305
 10306     IF AM-OVR-SHT-AMT NUMERIC AND
 10307                  AM-OVR-SHT-AMT > 0
 10308        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10309                                    EC-AM-LF-OVR-SHT-AMT
 10310                                    WS-AH-REFUND-OVS-AMT
 10311                                    EC-AM-AH-OVR-SHT-AMT.
 10312
 10313     IF AM-OVR-SHT-PCT NUMERIC AND
 10314                    AM-OVR-SHT-PCT > 0
 10315        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10316                                    EC-AM-LF-OVR-SHT-PCT
 10317                                    WS-AH-REFUND-OVS-PCT
 10318                                    EC-AM-AH-OVR-SHT-PCT.
 10319
 10320     IF AM-TOL-REF-PCT NUMERIC AND
 10321                  AM-TOL-REF-PCT > 0
 10322        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10323                                    WS-TOL-AH-REFUND-PCT.
 10324
 10325     IF AM-TOL-REF  NOT = ZEROS  AND
 10326                  AM-TOL-REF NUMERIC
 10327        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10328                                    EC-AM-LF-TOL-REFUND
 10329                                    WS-TOL-AH-REFUND
 10330                                    EC-AM-AH-TOL-REFUND.
 10331
 10332     IF AM-TOL-CLM  NOT = ZEROS
 10333        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10334                                    WS-TOL-AH-CLAIM.
 10335
 10336     IF AM-CLP-TOL-PCT NOT NUMERIC
 10337        MOVE +0                  TO AM-CLP-TOL-PCT
 10338     END-IF
 10339
 10340     IF AM-SPP-LEASE-COMM NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 189
* EL050.cbl
 10341        MOVE +0                  TO AM-SPP-LEASE-COMM
 10342     END-IF
 10343     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10344        MOVE WS-PL-TOL-LF-PREM-PCT
 10345                                 TO WS-TOL-LF-PREM-PCT.
 10346
 10347     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10348        MOVE WS-PL-TOL-AH-PREM-PCT
 10349                                 TO WS-TOL-AH-PREM-PCT.
 10350
 10351     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10352        MOVE WS-PL-TOL-LF-REFUND-PCT
 10353                                 TO WS-TOL-LF-REFUND-PCT.
 10354
 10355     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10356        MOVE WS-PL-TOL-AH-REFUND-PCT
 10357                                 TO WS-TOL-AH-REFUND-PCT.
 10358
 10359     IF WS-PL-REF-OVS-AMT > +0
 10360        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10361
 10362     IF WS-PL-REF-OVS-PCT > +0
 10363        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10364
 10365     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10366        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10367     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10368        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10369     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10370        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10371     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10372        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10373     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10374        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10375     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10376        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10377
 10378     IF WS-AH-PL-REF-OVS-AMT > +0
 10379        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10380
 10381     IF WS-AH-PL-REF-OVS-PCT > +0
 10382        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10383
 10384     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10385     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10386
 10387     IF PB-CANCELLATION
 10388        GO TO 3000-CONTINUE-EDIT.
 10389
 10390     MOVE +1 TO SUB1.
 10391     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10392     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10393
 10394     IF CF-COMPANY-ID = 'DMD'
 10395       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10396         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10397        ELSE
 10398         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 190
* EL050.cbl
 10399
 10400  0525-FIND-ACCT-COMM.
 10401     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10402        NEXT SENTENCE
 10403      ELSE
 10404         ADD +1 TO SUB1
 10405         IF SUB1 LESS +11
 10406            GO TO 0525-FIND-ACCT-COMM
 10407          ELSE
 10408             GO TO 0560-EDIT-CONTINUE.
 10409
 10410     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10411     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10412                                    PB-I-LIFE-COMMISSION.
 10413***  IF PB-COMPANY-ID = 'CRI'
 10414     IF PB-PREM-ACCTNG-ONLY
 10415         GO TO 0560-EDIT-CONTINUE.
 10416
 10417     MOVE '0530' TO CTBL-SW.
 10418     MOVE ' '    TO WS-CTBL-READ-SW.
 10419
 10420
 10421 0530-GET-AH-COMP.
 10422     IF NO-AH-COVERAGE  OR
 10423        NO-AH-BENEFIT-MATCH
 10424           GO TO 0540-NEXT-READ-STEP.
 10425
 10426     IF AM-A-COM (SUB1) NUMERIC
 10427        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10428         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10429         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10430         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10431         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10432     ELSE
 10433          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10434          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10435          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10436          MOVE ZEROS             TO WS-SUB1
 10437                                    WS-COMMISSION
 10438          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10439          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10440          IF WS-COMMISSION > ZEROS
 10441             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10442             GO TO 0540-NEXT-READ-STEP
 10443          END-IF
 10444          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10445          IF CTBL-TABLE-FOUND
 10446             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10447                                        PB-I-AH-TERM
 10448             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10449             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10450             GO TO 0540-NEXT-READ-STEP
 10451          ELSE
 10452             IF FIRST-TIME-THROUGH
 10453                 GO TO 0530-GET-AH-COMP
 10454             ELSE
 10455                 MOVE ER-2609                TO WS-ERROR
 10456                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 191
* EL050.cbl
 10457
 10458 0540-NEXT-READ-STEP.
 10459     MOVE '0540' TO CTBL-SW.
 10460     MOVE ' '    TO WS-CTBL-READ-SW.
 10461
 10462 0540-GET-LF-COMP.
 10463     IF NO-LIFE-COVERAGE  OR
 10464        NO-LF-BENEFIT-MATCH
 10465           GO TO 0560-EDIT-CONTINUE.
 10466
 10467     IF WS-LF-JOINT-INDICATOR = 'J'
 10468        IF AM-J-COM (SUB1) NUMERIC
 10469           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10470           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10471           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10472           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10473           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10474        ELSE
 10475           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10476           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10477           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10478           MOVE ZEROS                TO WS-SUB1
 10479                                        WS-COMMISSION
 10480           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10481           IF WS-COMMISSION > ZEROS
 10482              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10483              GO TO 0560-EDIT-CONTINUE
 10484           END-IF
 10485           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10486           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10487           IF CTBL-TABLE-FOUND
 10488              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10489              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10490              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10491              GO TO 0560-EDIT-CONTINUE
 10492           ELSE
 10493              IF FIRST-TIME-THROUGH
 10494                  GO TO 0540-GET-LF-COMP
 10495              ELSE
 10496                  MOVE ER-2609                TO WS-ERROR
 10497                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10498                  GO TO 0560-EDIT-CONTINUE.
 10499
 10500     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10501        IF AM-L-COM (SUB1) NUMERIC
 10502           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10503           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10504           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10505           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10506           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10507        ELSE
 10508           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10509           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10510           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10511           MOVE ZEROS                TO WS-SUB1
 10512                                        WS-COMMISSION
 10513           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10514           IF WS-COMMISSION IS GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 192
* EL050.cbl
 10515              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10516              GO TO 0560-EDIT-CONTINUE
 10517           END-IF
 10518           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10519           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10520           IF CTBL-TABLE-FOUND
 10521              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10522              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10523              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10524              GO TO 0560-EDIT-CONTINUE
 10525           ELSE
 10526              IF FIRST-TIME-THROUGH
 10527                  GO TO 0540-GET-LF-COMP
 10528              ELSE
 10529                  MOVE ER-2609                TO WS-ERROR
 10530                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10531
 10532*    GO TO 0560-EDIT-CONTINUE.
 10533
 10534 0560-EDIT-CONTINUE.
 10535     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10536                                    WS-AH-PMF-COMM
 10537*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10538*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10539     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10540        (SUB1 > +10)
 10541        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10542           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10543           MOVE '0530'           TO CTBL-SW
 10544           MOVE ' '              TO WS-CTBL-READ-SW
 10545           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10546           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10547           MOVE '0540'           TO CTBL-SW
 10548           MOVE ' '              TO WS-CTBL-READ-SW
 10549           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10550        END-IF
 10551     END-PERFORM
 10552     GO TO 0564-EDIT-CONTINUE
 10553     .
 10554 0561-CHECK-AH.
 10555     IF (NO-AH-COVERAGE)
 10556        OR (NO-AH-BENEFIT-MATCH)
 10557        CONTINUE
 10558     ELSE
 10559        IF (AM-A-COM (SUB1) NUMERIC)
 10560           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10561           IF (AM-COM-TYP (SUB1) = 'A')
 10562              AND (WS-AH-PMF-COMM = ZEROS)
 10563              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10564           END-IF
 10565           CONTINUE
 10566        ELSE
 10567           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10568           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10569           MOVE PB-AH-OVERRIDE-L1
 10570                                 TO CTBL-BEN-TYPE
 10571           MOVE ZEROS            TO WS-SUB1
 10572                                    WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 193
* EL050.cbl
 10573           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10574           PERFORM 8300-READ-CTBL-TABLE
 10575                                 THRU 8300-EXIT
 10576           IF CTBL-TABLE-FOUND
 10577              IF (AM-COM-TYP (SUB1) = 'A')
 10578                 AND (WS-AH-PMF-COMM = ZEROS)
 10579                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10580                                        PB-I-AH-TERM
 10581                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10582                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10583              END-IF
 10584              CONTINUE
 10585           ELSE
 10586              IF FIRST-TIME-THROUGH
 10587                 GO TO 0561-CHECK-AH
 10588              ELSE
 10589                 MOVE ER-2609    TO WS-ERROR
 10590                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10591              END-IF
 10592           END-IF
 10593        END-IF
 10594     END-IF
 10595     .
 10596 0561-EXIT.
 10597     EXIT.
 10598 0563-CHECK-LF.
 10599     IF (NO-LIFE-COVERAGE)
 10600        OR (NO-LF-BENEFIT-MATCH)
 10601        CONTINUE
 10602     ELSE
 10603        IF WS-LF-JOINT-INDICATOR = 'J'
 10604           IF AM-J-COM (SUB1) NUMERIC
 10605              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10606              IF (AM-COM-TYP (SUB1) = 'A')
 10607                 AND (WS-LF-PMF-COMM = ZEROS)
 10608                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10609              END-IF
 10610              CONTINUE
 10611           ELSE
 10612              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10613              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10614              MOVE PB-LIFE-OVERRIDE-L1
 10615                                 TO CTBL-BEN-TYPE
 10616              MOVE ZEROS         TO WS-SUB1
 10617                                    WS-COMMISSION
 10618              MOVE AM-J-COMA (SUB1)
 10619                                 TO CTBL-TABLE
 10620              PERFORM 8300-READ-CTBL-TABLE
 10621                                 THRU 8300-EXIT
 10622              IF CTBL-TABLE-FOUND
 10623                 IF (AM-COM-TYP (SUB1) = 'A')
 10624                    AND (WS-LF-PMF-COMM = ZEROS)
 10625                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10626                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10627                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10628                 END-IF
 10629                 CONTINUE
 10630              ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 194
* EL050.cbl
 10631                 IF FIRST-TIME-THROUGH
 10632                    GO TO 0563-CHECK-LF
 10633                 ELSE
 10634                    MOVE ER-2609 TO WS-ERROR
 10635                    PERFORM 9900-ERROR-FORMAT
 10636                                 THRU 9900-EXIT
 10637*                   GO TO 0560-EDIT-CONTINUE
 10638                 END-IF
 10639              END-IF
 10640           END-IF
 10641        ELSE
 10642           IF AM-L-COM (SUB1) NUMERIC
 10643              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10644              IF (AM-COM-TYP (SUB1) = 'A')
 10645                 AND (WS-LF-PMF-COMM = ZEROS)
 10646                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10647              END-IF
 10648              CONTINUE
 10649           ELSE
 10650              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10651              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10652              MOVE PB-LIFE-OVERRIDE-L1
 10653                                 TO CTBL-BEN-TYPE
 10654              MOVE ZEROS         TO WS-SUB1
 10655                                    WS-COMMISSION
 10656              MOVE AM-L-COMA (SUB1)
 10657                                 TO CTBL-TABLE
 10658              PERFORM 8300-READ-CTBL-TABLE
 10659                                 THRU 8300-EXIT
 10660              IF CTBL-TABLE-FOUND
 10661                 CONTINUE
 10662              ELSE
 10663                 IF FIRST-TIME-THROUGH
 10664                    GO TO 0563-CHECK-LF
 10665                 ELSE
 10666                    MOVE ER-2609 TO WS-ERROR
 10667                    PERFORM 9900-ERROR-FORMAT
 10668                                 THRU 9900-EXIT
 10669                 END-IF
 10670              END-IF
 10671           END-IF
 10672        END-IF
 10673     END-IF
 10674     .
 10675 0563-EXIT.
 10676     EXIT.
 10677 0564-EDIT-CONTINUE.
 10678
 10679     IF  PB-COMPANY-ID EQUAL 'DMD'
 10680         IF PB-I-NUM-BILLED EQUAL ZEROS
 10681            MOVE ER-8148       TO WS-ERROR
 10682            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10683
 10684*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10685*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10686*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10687*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10688*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 195
* EL050.cbl
 10689*         IF NO-CONVERSION-ERROR
 10690*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10691*         ELSE
 10692*             IF PB-COMPANY-ID EQUAL 'HAN'
 10693*                 MOVE ZEROS     TO PB-I-AGE.
 10694     IF PB-I-BIRTHDAY > LOW-VALUES
 10695        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10696        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10697        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10698        PERFORM 8500-DATE-CONVERT
 10699                                 THRU 8500-EXIT
 10700        IF NO-CONVERSION-ERROR
 10701           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10702           IF PB-I-AGE > ZEROS
 10703              IF WS-WORK-AGE NOT = PB-I-AGE
 10704                 MOVE ER-9501    TO WS-ERROR
 10705                 PERFORM 9900-ERROR-FORMAT
 10706                                 THRU 9900-EXIT
 10707              END-IF
 10708           ELSE
 10709              MOVE WS-WORK-AGE   TO PB-I-AGE
 10710           END-IF
 10711        END-IF
 10712     END-IF
 10713     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10714                                   WS-INS-AGE-SET
 10715     IF PB-I-AGE = ZEROS
 10716        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10717           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10718                                   WS-INS-AGE-SET
 10719           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10720
 10721     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10722                                   WS-AH-EDIT-AGE.
 10723
 10724     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10725        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10726        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10727        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10728        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10729        IF NO-CONVERSION-ERROR
 10730           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10731           IF PB-I-JOINT-AGE > 0
 10732              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10733                 MOVE ER-9503    TO WS-ERROR
 10734                 PERFORM 9900-ERROR-FORMAT
 10735                                 THRU 9900-EXIT
 10736              END-IF
 10737           ELSE
 10738              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10739           END-IF
 10740        ELSE
 10741           MOVE ZEROS            TO PB-I-JOINT-AGE
 10742        END-IF
 10743     END-IF
 10744     IF PB-I-JOINT-AGE NOT NUMERIC
 10745        MOVE ZERO               TO PB-I-JOINT-AGE.
 10746
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 196
* EL050.cbl
 10747     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10748                                   WS-JNT-AGE-SET
 10749     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10750        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10751           (WS-AH-JOINT-INDICATOR = 'J')
 10752           IF PB-I-JOINT-AGE = ZEROS
 10753               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10754                                          WS-JNT-AGE-SET
 10755               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10756           END-IF
 10757        END-IF
 10758     END-IF
 10759
 10760     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10761     IF WS-LF-JOINT-INDICATOR = 'J'
 10762        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10763        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10764            IF  PB-I-JOINT-AGE = ZERO
 10765                MOVE ER-2686       TO WS-ERROR
 10766                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10767            ELSE
 10768                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10769                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10770                    IF PB-COMPANY-ID NOT = 'LBL'
 10771                        MOVE ER-2685    TO WS-ERROR
 10772                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10773
 10774     IF WS-AH-JOINT-INDICATOR = 'J'
 10775        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10776            IF  PB-I-JOINT-AGE = ZERO
 10777                MOVE ER-2686       TO WS-ERROR
 10778                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10779            ELSE
 10780                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10781                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10782                                           WS-EDIT-AGE
 10783                    IF PB-COMPANY-ID NOT = 'LBL'
 10784                        MOVE ER-2685    TO WS-ERROR
 10785                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10786
 10787******************************************************************
 10788*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10789******************************************************************
 10790
 10791     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10792        (WS-AH-SPECIAL-CALC-CD = 'O')
 10793        NEXT SENTENCE
 10794     ELSE
 10795        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10796          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10797           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10798            WS-AH-JOINT-INDICATOR = 'J')  AND
 10799           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10800            MOVE ER-2627             TO WS-ERROR
 10801            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10802
 10803     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10804        (WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 197
* EL050.cbl
 10805         NEXT SENTENCE
 10806     ELSE
 10807         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10808            WS-AH-JOINT-INDICATOR = 'J'
 10809             IF PB-I-JOINT-INSURED = SPACES
 10810                 IF PB-COMPANY-ID NOT = 'JAL'
 10811                     MOVE ER-2696    TO WS-ERROR
 10812                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10813
 10814     IF PB-COMPANY-ID NOT = 'BOA'
 10815        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10816           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10817           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10818               PB-I-JOINT-INSURED NOT = SPACES)
 10819                MOVE ER-2691         TO WS-ERROR
 10820                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10821
 10822     IF PB-COMPANY-ID = 'BOA'
 10823        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10824           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10825            IF PB-I-JOINT-AGE NOT = ZEROS
 10826                MOVE ER-2691         TO WS-ERROR
 10827                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10828
 10829     IF PB-COMPANY-ID = 'CRI'
 10830        IF PB-I-SIG-SW = 'J'
 10831           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10832              WS-AH-JOINT-INDICATOR NOT = 'J'
 10833              MOVE ER-2675       TO WS-ERROR
 10834              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10835
 10836     IF PB-COMPANY-ID = 'CRI'
 10837        IF PB-I-SIG-SW = 'S'
 10838           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10839              WS-AH-JOINT-INDICATOR = 'J'
 10840              MOVE ER-2676       TO WS-ERROR
 10841              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10842
 10843     IF PB-COMPANY-ID = 'CVL'
 10844         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10845            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10846              MOVE ER-2783           TO WS-ERROR
 10847              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10848     IF (WS-LF-JOINT-INDICATOR = 'J')
 10849        AND (WS-AH-JOINT-INDICATOR = 'J')
 10850        AND (PB-I-LF-TERM > 120)
 10851        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10852        MOVE ER-2783             TO WS-ERROR
 10853        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10854     END-IF
 10855     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10856
 10857     IF PB-I-INDV-GRP-OVRD = 'I'
 10858        MOVE ER-2666             TO WS-ERROR
 10859        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10860        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10861
 10862     IF PB-I-INDV-GRP-OVRD = 'G'
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 198
* EL050.cbl
 10863        MOVE ER-2666             TO WS-ERROR
 10864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10865        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10866
 10867     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10868        NEXT SENTENCE
 10869     ELSE
 10870        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10871
 10872     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10873        IF WS-ERROR = ER-2666
 10874           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10875           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10876
 10877     IF PB-COMPANY-ID = 'CID'
 10878        IF PB-STATE = 'UT' OR 'MO'
 10879           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10880                 OR '76' OR '77')
 10881                      OR
 10882               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10883                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10884                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10885                   OR '2K' OR '2L'))
 10886              AND PB-I-INDV-GRP-CD = 'I'
 10887              MOVE ER-2721             TO WS-ERROR
 10888              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10889           END-IF
 10890        END-IF
 10891     END-IF
 10892
 10893     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10894     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10895        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10896     ELSE
 10897        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10898     END-IF
 10899
 10900*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10901*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10902     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10903                                    ACCOUNT-AH-CK-SW.
 10904
 10905     IF PB-REISSUED-CERT       OR
 10906        PB-REIN-ONLY-CERT      OR
 10907        PB-POLICY-IS-DECLINED  OR
 10908        PB-POLICY-IS-VOIDED
 10909*       OR PB-MONTHLY-CERT
 10910         GO TO 3000-CONTINUE-EDIT.
 10911
 10912     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10913        IF WS-EDIT-AGE           > +65
 10914           MOVE ER-2709          TO WS-ERROR
 10915           PERFORM 9900-ERROR-FORMAT
 10916                                 THRU 9900-EXIT
 10917        ELSE
 10918           IF WS-EDIT-AGE        > +55
 10919              MOVE ER-2718       TO WS-ERROR
 10920              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 199
* EL050.cbl
 10921                                 THRU 9900-EXIT
 10922           END-IF
 10923        END-IF
 10924     IF PB-COMPANY-ID = 'DCC'
 10925        IF WS-EDIT-AGE           > +65
 10926           MOVE ER-2709          TO WS-ERROR
 10927           PERFORM 9900-ERROR-FORMAT
 10928                                 THRU 9900-EXIT
 10929        END-IF
 10930     END-IF
 10931     .
 10932
 10933 0565-LIFE-PLAN-LIMIT-EDITS.
 10934
 10935     IF NOT LF-PLAN-MASTER-FOUND
 10936        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10937                                    EC-AM-LF-MAX-TOT-BEN
 10938        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10939
 10940     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10941
 10942     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10943         IF PL-LM-AGE (1) = ZEROS
 10944             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10945
 10946     IF NO-LF-BENEFIT-MATCH          OR
 10947        WS-LF-BENEFIT-CD = ZEROS     OR
 10948        WS-LF-SPECIAL-CALC-CD = 'M'
 10949        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10950
 10951     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10952     MOVE +1                     TO SUB2.
 10953
 10954     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10955        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10956           MOVE +5   TO SUB2
 10957           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10958              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10959              (PL-LM-AGE (SUB2) EQUAL +0)
 10960              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10961              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10962
 10963     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10964
 10965     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10966                               + PB-I-LF-ALT-BENEFIT-AMT.
 10967
 10968 0568-CHECK-LIFE-ATT-AGE.
 10969
 10970     IF PL-ATT-AGE NUMERIC AND
 10971        PL-ATT-AGE > +0
 10972        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10973     END-IF
 10974*    IF PL-ATT-AGE NUMERIC AND
 10975*       PL-ATT-AGE > +0
 10976*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10977*       IF PB-I-BIRTHDAY > LOW-VALUES
 10978*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 200
* EL050.cbl
 10979*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10980*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10981*          SET BIN-PLUS-ELAPSED  TO TRUE
 10982*          PERFORM 8500-DATE-CONVERT
 10983*                                THRU 8500-EXIT
 10984*          IF NO-CONVERSION-ERROR
 10985*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10986*             MOVE ER-2669       TO WS-ERROR
 10987*             PERFORM 9900-ERROR-FORMAT
 10988*                                THRU 9900-EXIT
 10989*          END-IF
 10990*       ELSE
 10991*          IF WS-ATT-AGE >= PL-ATT-AGE
 10992*             MOVE ER-2669       TO WS-ERROR
 10993*             PERFORM 9900-ERROR-FORMAT
 10994*                                THRU 9900-EXIT
 10995*          END-IF
 10996*       END-IF
 10997*    END-IF
 10998     .
 10999 0570-CHECK-LIFE-LIMITS.
 11000
 11001     IF PB-COMPANY-ID EQUAL 'CRI'
 11002        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11003           IF SUB2 GREATER THAN +4
 11004              MOVE ER-2637 TO WS-ERROR
 11005              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11006              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11007
 11008     IF PB-COMPANY-ID  =  'NCL'
 11009        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11010            SUB2 GREATER THAN +8
 11011             MOVE 'U'         TO PB-BATCH-ENTRY
 11012             MOVE ER-2637     TO WS-ERROR
 11013             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11014             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11015
 11016     IF SUB2 > +8
 11017        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11018           AND (PB-I-SIG-SW = 'Y')
 11019           CONTINUE
 11020        ELSE
 11021           MOVE ER-2637          TO WS-ERROR
 11022           PERFORM 9900-ERROR-FORMAT
 11023                                 THRU 9900-EXIT
 11024        END-IF
 11025        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11026     END-IF
 11027     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11028     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11029     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11030
 11031     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11032        ADD +1  TO SUB2
 11033        GO TO 0570-CHECK-LIFE-LIMITS.
 11034
 11035     IF PB-COMPANY-ID = 'NCL'
 11036         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 201
* EL050.cbl
 11037
 11038     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11039        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11040        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11041           AND (PB-I-SIG-SW = 'Y')
 11042           CONTINUE
 11043        ELSE
 11044           MOVE ER-2637          TO WS-ERROR
 11045           PERFORM 9900-ERROR-FORMAT
 11046                                 THRU 9900-EXIT
 11047        END-IF
 11048     END-IF
 11049     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11050
 11051
 11052 0570-CHECK-NCL-LIFE-LIMITS.
 11053
 11054     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11055        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11056         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11057
 11058     IF APP-CERT-USED
 11059         IF SUB2  LESS THAN  +5
 11060             MOVE +5          TO SUB2
 11061             GO TO 0570-CHECK-LIFE-LIMITS.
 11062
 11063     MOVE ER-2637             TO WS-ERROR.
 11064     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11065
 11066     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11067
 11068 0575-CHECK-NCL-SIG-SWITCH.
 11069
 11070     IF NOT APP-CERT-USED
 11071         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11072
 11073     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11074        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11075        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11076        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11077         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11078
 11079     IF SUB2 GREATER THAN +4
 11080         IF PL-LM-AGE (5) = ZEROS  AND
 11081            PL-LM-AGE (6) = ZEROS  AND
 11082            PL-LM-AGE (7) = ZEROS  AND
 11083            PL-LM-AGE (8) = ZEROS
 11084             MOVE  ER-1927        TO WS-ERROR
 11085             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11086             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11087         ELSE
 11088             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11089                 MOVE  ER-1920    TO WS-ERROR
 11090                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11091
 11092     IF PB-I-SIG-SW  = 'Y'
 11093       IF NOT PB-I-POLICY-ACCEPTED  AND
 11094          NOT PB-I-POLICY-DECLINED
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 202
* EL050.cbl
 11095           MOVE 'U'               TO PB-BATCH-ENTRY
 11096           MOVE  ER-1926          TO WS-ERROR
 11097           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11098
 11099
 11100 0580-AH-PLAN-LIMIT-EDITS.
 11101
 11102     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11103        IF PB-I-AH-BENEFIT-AMT > +1250
 11104           MOVE ER-2702          TO WS-ERROR
 11105           PERFORM 9900-ERROR-FORMAT
 11106                                 THRU 9900-EXIT
 11107        END-IF
 11108     END-IF
 11109
 11110     IF (PB-COMPANY-ID = 'DCC')
 11111        AND (PB-MONTHLY-CERT)
 11112        IF PB-I-AH-BENEFIT-AMT > +3000
 11113           MOVE ER-2881          TO WS-ERROR
 11114           PERFORM 9900-ERROR-FORMAT
 11115                                 THRU 9900-EXIT
 11116        END-IF
 11117     END-IF
 11118     IF NOT AH-PLAN-MASTER-FOUND
 11119        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11120        GO TO 3000-CONTINUE-EDIT.
 11121
 11122     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11123
 11124     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11125         IF PL-LM-AGE (1) = ZEROS
 11126             GO TO 3000-CONTINUE-EDIT.
 11127
 11128     IF NO-AH-BENEFIT-MATCH          OR
 11129        WS-AH-BENEFIT-CD = ZEROS     OR
 11130        WS-AH-SPECIAL-CALC-CD = 'M'
 11131        GO TO 3000-CONTINUE-EDIT.
 11132
 11133     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11134     MOVE +1                     TO SUB2.
 11135
 11136     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11137        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11138           MOVE +5 TO SUB2
 11139           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11140              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11141              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11142              (PL-LM-AGE (SUB2) EQUAL +0)
 11143              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11144              GO TO 3000-CONTINUE-EDIT.
 11145
 11146     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11147
 11148 0590-CHECK-AH-ATT-AGE.
 11149
 11150     IF PL-ATT-AGE NUMERIC AND
 11151        PL-ATT-AGE GREATER THAN +0
 11152        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 203
* EL050.cbl
 11153     END-IF
 11154*       IF WS-ATT-AGE >= PL-ATT-AGE
 11155*          MOVE ER-3054          TO WS-ERROR
 11156*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11157     .
 11158 0597-CHECK-AH-LIMITS.
 11159
 11160     IF PB-COMPANY-ID EQUAL 'CRI'
 11161        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11162           IF SUB2 GREATER THAN +4
 11163              MOVE ER-2638       TO WS-ERROR
 11164              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11165              GO TO 3000-CONTINUE-EDIT.
 11166
 11167     IF PB-COMPANY-ID  =  'NCL'
 11168        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11169            SUB2 GREATER THAN +8
 11170             MOVE 'U'            TO PB-BATCH-ENTRY
 11171             MOVE ER-2638        TO WS-ERROR
 11172             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11173             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11174
 11175     IF SUB2 > +8
 11176        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11177           AND (PB-I-SIG-SW = 'Y')
 11178           CONTINUE
 11179        ELSE
 11180           MOVE ER-2638          TO WS-ERROR
 11181           PERFORM 9900-ERROR-FORMAT
 11182                                 THRU 9900-EXIT
 11183        END-IF
 11184        GO TO 3000-CONTINUE-EDIT
 11185     END-IF
 11186
 11187     IF PB-COMPANY-ID = 'CRI'
 11188        IF WS-ERROR = ER-2638
 11189           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11190
 11191     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11192     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11193     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11194     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11195
 11196     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11197        ADD +1                   TO SUB2
 11198        GO TO 0597-CHECK-AH-LIMITS.
 11199
 11200     IF PB-COMPANY-ID = 'NCL'
 11201         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11202
 11203     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11204        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11205        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11206                                 > PL-LM-AMT (SUB2))
 11207        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11208           AND (PB-I-SIG-SW = 'Y')
 11209           CONTINUE
 11210        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 204
* EL050.cbl
 11211           MOVE ER-2638          TO WS-ERROR
 11212           PERFORM 9900-ERROR-FORMAT
 11213                                 THRU 9900-EXIT
 11214        END-IF
 11215     END-IF
 11216
 11217     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11218         IF  WS-ERROR    EQUAL    ER-2638
 11219             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11220                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11221                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11222                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11223                MOVE  ER-1910    TO  WS-ERROR
 11224                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11225
 11226     IF PB-COMPANY-ID = 'CRI'
 11227        IF WS-ERROR = ER-2638
 11228            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11229            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11230            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11231
 11232     GO TO 3000-CONTINUE-EDIT.
 11233
 11234 0597-CHECK-NCL-AH-LIMITS.
 11235
 11236     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11237        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11238        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11239                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11240         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11241
 11242     IF APP-CERT-USED
 11243         IF SUB2  LESS THAN  +5
 11244             MOVE +5             TO SUB2
 11245             GO TO 0597-CHECK-AH-LIMITS.
 11246
 11247     MOVE ER-2638                TO WS-ERROR.
 11248     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11249
 11250     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11251
 11252 0599-CHECK-NCL-SIG-SWITCH.
 11253
 11254     IF NOT APP-CERT-USED
 11255         GO TO 3000-CONTINUE-EDIT.
 11256
 11257     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11258        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11259        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11260        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11261         GO TO 3000-CONTINUE-EDIT.
 11262
 11263     IF SUB2 GREATER THAN +4
 11264         IF PL-LM-AGE (5) = ZEROS  AND
 11265            PL-LM-AGE (6) = ZEROS  AND
 11266            PL-LM-AGE (7) = ZEROS  AND
 11267            PL-LM-AGE (8) = ZEROS
 11268             MOVE  ER-1927        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 205
* EL050.cbl
 11269             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11270             GO TO 3000-CONTINUE-EDIT
 11271         ELSE
 11272             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11273                 MOVE  ER-1920    TO WS-ERROR
 11274                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11275
 11276     IF PB-I-SIG-SW  = 'Y'
 11277       IF NOT PB-I-POLICY-ACCEPTED  AND
 11278          NOT PB-I-POLICY-DECLINED
 11279           MOVE 'U'               TO PB-BATCH-ENTRY
 11280           MOVE  ER-1926          TO WS-ERROR
 11281           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11282
 11283******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 206
* EL050.cbl
 11285
 11286 3000-CONTINUE-EDIT.
 11287
 11288     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11289     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11290     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11291     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11292     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11293
 11294     IF BROWSE-STARTED
 11295        PERFORM 9990-RETURN THRU 9990-EXIT
 11296        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11297
 11298     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11299        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11300        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11301        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11302*       MOVE 1                   TO DC-OPTION-CODE
 11303        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11304        IF DATE-CONVERSION-ERROR
 11305           MOVE ER-2622          TO WS-ERROR
 11306           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11307        ELSE
 11308           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11309              MOVE ER-2623       TO WS-ERROR
 11310              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11311           ELSE
 11312              MOVE ER-2622       TO WS-ERROR
 11313              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11314
 11315     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11316     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11317     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11318*    MOVE 1                      TO DC-OPTION-CODE.
 11319     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11320     IF DATE-CONVERSION-ERROR
 11321        GO TO 3005-EDIT-CONTINUE
 11322     ELSE
 11323        IF DC-ELAPSED-DAYS GREATER +180
 11324           MOVE ER-2613          TO WS-ERROR
 11325           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11326        ELSE
 11327           IF DC-ELAPSED-DAYS GREATER +90
 11328              MOVE ER-2612       TO WS-ERROR
 11329              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11330           ELSE
 11331             IF DC-ELAPSED-DAYS GREATER +60
 11332                MOVE ER-2614     TO WS-ERROR
 11333                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11334
 11335 3005-EDIT-CONTINUE.
 11336
 11337     IF PB-CANCELLATION
 11338         GO TO 3700-EDIT-CANCEL.
 11339
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 207
* EL050.cbl
 11341******************************************************************
 11342*                  E D I T   I S S U E                           *
 11343******************************************************************
 11344
 11345 3020-EDIT-ISSUE.
 11346
 11347      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11348      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11349      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11350      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11351      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11352
 11353     IF PB-ISSUE-FORCE
 11354        OR PB-ISSUE-DATE-FORCED
 11355        OR PB-FORCE-OFF
 11356        OR PB-OVERCHARGE-FORCE
 11357        CONTINUE
 11358     ELSE
 11359        MOVE ER-2670             TO WS-ERROR
 11360        PERFORM 9900-ERROR-FORMAT
 11361                                 THRU 9900-EXIT
 11362     END-IF
 11363     .
 11364 3022-SET-POLICY-STATUS.
 11365
 11366     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11367
 11368     IF (PB-REISSUED-CERT)
 11369             OR
 11370        ((PB-COMPANY-ID NOT = 'DCC')
 11371         AND (PB-MONTHLY-CERT))
 11372         MOVE '5'                TO PB-I-ENTRY-STATUS
 11373         MOVE 'E'                TO PB-BATCH-ENTRY
 11374     END-IF
 11375
 11376     IF PB-COMPANY-ID = 'DCC'
 11377        IF PB-MONTHLY-CERT
 11378           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11379        END-IF
 11380        IF PB-CASH-CERT
 11381           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11382        END-IF
 11383     END-IF
 11384     IF PB-POLICY-IS-DECLINED
 11385         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11386     IF PB-POLICY-IS-VOIDED
 11387         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11388     IF PB-NEEDS-UNDERWRITING
 11389         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11390     IF PB-REIN-ONLY-CERT
 11391         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11392     IF PB-PREM-ACCTNG-ONLY
 11393         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11394
 11395     MOVE SPACE                  TO PB-I-OB-FLAG.
 11396
 11397     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11398         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 208
* EL050.cbl
 11399         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11400         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11401
 11402     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11403        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11404           MOVE 'Z'             TO PB-I-OB-FLAG.
 11405
 11406     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11407        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11408           MOVE 'Z'             TO PB-I-OB-FLAG.
 11409
 11410     IF ACCOUNT-MAST-FOUND
 11411         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11412         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11413         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11414         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11415         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11416         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11417         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11418     END-IF
 11419
 11420     IF ACCOUNT-MAST-FOUND
 11421        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11422         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11423
 11424     IF (ACCOUNT-MAST-FOUND)
 11425        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11426        IF PB-REISSUED-CERT
 11427           CONTINUE
 11428        ELSE
 11429           MOVE ER-2608          TO WS-ERROR
 11430           PERFORM 9900-ERROR-FORMAT
 11431                                 THRU 9900-EXIT
 11432         END-IF
 11433     END-IF
 11434
 11435     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11436        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11437        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11438
 11439**********   DMD CUSTOM CODE FOLLOWS  **********
 11440 3024-EDIT-DMD-FIELDS.
 11441     IF PB-COMPANY-ID NOT = 'DMD'
 11442        GO TO 3025-EDIT-REINSURANCE.
 11443
 11444*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11445*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11446*** ERROR IF THEY ARE NOT EQUAL.
 11447
 11448     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11449     SET BIN-TO-GREG               TO TRUE.
 11450     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11451     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11452**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11453
 11454     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11455     SET BIN-TO-GREG               TO TRUE.
 11456     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 209
* EL050.cbl
 11457     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11458**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11459
 11460     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11461        MOVE ER-8116               TO WS-ERROR
 11462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11463
 11464     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11465
 11466     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11467                                      WK-FULL-CERT-NO.
 11468     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11469
 11470     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11471
 11472     IF PB-VALID-LIFE
 11473        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11474     ELSE
 11475        IF PB-VALID-AH
 11476          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11477
 11478
 11479     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11480     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11481     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11482                                      DCUA-UNDRWRTR-CODE
 11483                                      DCUA-UNDRWRTR-GROUP-CODE
 11484                                      DCUA-RETURN-CODE.
 11485
 11486****************************************************************
 11487*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11488***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11489***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11490***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11491***   TO THIS RECORD.                                        ***
 11492****************************************************************
 11493     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11494     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11495     IF DCUA-SUCCESSFUL-PROCESS
 11496        GO TO 3024-EDIT-DL7-CONT.
 11497
 11498     IF DCUA-RETURN-CODE EQUAL '01'
 11499        MOVE ER-8110               TO WS-ERROR
 11500        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11502        GO TO 3024-EDIT-DL7-CONT.
 11503
 11504     IF DCUA-RETURN-CODE EQUAL '02'
 11505        MOVE ER-8111               TO WS-ERROR
 11506        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11508        GO TO 3024-EDIT-DL7-CONT.
 11509
 11510     IF DCUA-RETURN-CODE EQUAL '03'
 11511        MOVE ER-8074               TO WS-ERROR
 11512        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11514        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 210
* EL050.cbl
 11515
 11516     IF DCUA-RETURN-CODE EQUAL '04'
 11517        MOVE ER-8075               TO WS-ERROR
 11518        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11520        GO TO 3024-EDIT-DL7-CONT.
 11521
 11522     IF DCUA-RETURN-CODE EQUAL '05'
 11523        MOVE ER-8076               TO WS-ERROR
 11524        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11526        GO TO 3024-EDIT-DL7-CONT.
 11527
 11528     IF DCUA-RETURN-CODE EQUAL '06'
 11529        MOVE ER-8077               TO WS-ERROR
 11530        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11532        GO TO 3024-EDIT-DL7-CONT.
 11533
 11534     IF DCUA-RETURN-CODE EQUAL '07'
 11535        MOVE ER-8078               TO WS-ERROR
 11536        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11538        GO TO 3024-EDIT-DL7-CONT.
 11539
 11540     IF DCUA-RETURN-CODE EQUAL 'E1'
 11541        MOVE ER-8079               TO WS-ERROR
 11542        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11544        GO TO 3024-EDIT-DL7-CONT.
 11545
 11546     IF DCUA-RETURN-CODE EQUAL 'E2'
 11547        MOVE ER-8080               TO WS-ERROR
 11548        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11549        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11550        GO TO 3024-EDIT-DL7-CONT.
 11551
 11552     IF DCUA-RETURN-CODE EQUAL 'E3'
 11553        MOVE ER-8098               TO WS-ERROR
 11554        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11555        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11556        GO TO 3024-EDIT-DL7-CONT.
 11557
 11558     IF DCUA-RETURN-CODE EQUAL 'C1'
 11559        MOVE ER-8099               TO WS-ERROR
 11560        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11561        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11562        GO TO 3024-EDIT-DL7-CONT.
 11563
 11564     IF DCUA-RETURN-CODE EQUAL 'U1'
 11565        MOVE ER-8109               TO WS-ERROR
 11566        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11568        GO TO 3024-EDIT-DL7-CONT.
 11569
 11570     IF DCUA-RETURN-CODE EQUAL 'N1'
 11571        MOVE ER-8112               TO WS-ERROR
 11572        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 211
* EL050.cbl
 11573        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11574        GO TO 3024-EDIT-DL7-CONT.
 11575
 11576     IF DCUA-RETURN-CODE EQUAL 'N2'
 11577        MOVE ER-8113               TO WS-ERROR
 11578        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11580        GO TO 3024-EDIT-DL7-CONT.
 11581
 11582     IF DCUA-RETURN-CODE EQUAL 'N3'
 11583        MOVE ER-8114               TO WS-ERROR
 11584        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11586        GO TO 3024-EDIT-DL7-CONT.
 11587
 11588     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11589     MOVE ER-8097                  TO WS-ERROR.
 11590     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11591     GO TO 3024-EDIT-DL7-CONT.
 11592
 11593 3024-EDIT-DL7-CONT.
 11594
 11595     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11596     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11597     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11598        NEXT SENTENCE
 11599     ELSE
 11600        MOVE ER-9263               TO WS-ERROR
 11601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11602
 11603******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11604******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11605     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11606        NEXT SENTENCE
 11607     ELSE
 11608        MOVE ER-8039               TO WS-ERROR
 11609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11610
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 212
* EL050.cbl
 11612****************************************************************
 11613*** VALIDATE STATE  : DLO022                                 ***
 11614****************************************************************
 11615     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11616     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11617
 11618     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11619     IF DVSC-SUCCESSFUL-EDIT
 11620        GO TO 3024-EDIT-DL22-CONT.
 11621
 11622     IF DVSC-RETURN-CODE EQUAL '01'
 11623        MOVE ER-8300               TO WS-ERROR
 11624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625        GO TO 3024-EDIT-DL22-CONT.
 11626
 11627     IF DVSC-RETURN-CODE EQUAL '02'
 11628        MOVE ER-8301               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630        GO TO 3024-EDIT-DL22-CONT.
 11631
 11632     IF DVSC-RETURN-CODE EQUAL '03'
 11633        MOVE ER-8302               TO WS-ERROR
 11634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11635        GO TO 3024-EDIT-DL22-CONT.
 11636
 11637     IF DVSC-RETURN-CODE EQUAL 'N1'
 11638        MOVE ER-8304               TO WS-ERROR
 11639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11640        GO TO 3024-EDIT-DL22-CONT.
 11641
 11642     MOVE ER-8303                  TO WS-ERROR
 11643     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11644
 11645 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 213
* EL050.cbl
 11647****************************************************************
 11648*** VALIDATE LOAN OFFICER : DLO021                           ***
 11649****************************************************************
 11650
 11651     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11652     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11653     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11654     IF DVLO-SUCCESSFUL-EDIT
 11655        GO TO 3024-EDIT-DL21-CONT.
 11656
 11657     IF DVLO-RETURN-CODE EQUAL '01'
 11658        MOVE ER-8081               TO WS-ERROR
 11659        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11660        GO TO 3024-EDIT-DL21-CONT.
 11661
 11662     IF DVLO-RETURN-CODE EQUAL '02'
 11663        MOVE ER-8082               TO WS-ERROR
 11664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11665        GO TO 3024-EDIT-DL21-CONT.
 11666
 11667     IF DVLO-RETURN-CODE EQUAL '03'
 11668        MOVE ER-8083               TO WS-ERROR
 11669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11670        GO TO 3024-EDIT-DL21-CONT.
 11671
 11672     IF DVLO-RETURN-CODE EQUAL '04'
 11673        MOVE ER-8084               TO WS-ERROR
 11674        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11675        GO TO 3024-EDIT-DL21-CONT.
 11676
 11677     IF DVLO-RETURN-CODE EQUAL '05'
 11678        MOVE ER-8085               TO WS-ERROR
 11679        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11680        GO TO 3024-EDIT-DL21-CONT.
 11681
 11682     MOVE ER-7825                  TO WS-ERROR
 11683     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11684     GO TO 3024-EDIT-DL21-CONT.
 11685
 11686 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 214
* EL050.cbl
 11688
 11689****************************************************************
 11690*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11691****************************************************************
 11692
 11693     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11694     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11695     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11696     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11697     IF DIPF-SUCCESSFUL-EDIT
 11698        GO TO 3024-EDIT-DL02-CONT.
 11699
 11700     IF DIPF-RETURN-CODE EQUAL '01'
 11701        MOVE ER-8086               TO WS-ERROR
 11702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11703        GO TO 3024-EDIT-DL02-CONT.
 11704
 11705     IF DIPF-RETURN-CODE EQUAL '02'
 11706        MOVE ER-8087               TO WS-ERROR
 11707        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11708        GO TO 3024-EDIT-DL02-CONT.
 11709
 11710     IF DIPF-RETURN-CODE EQUAL '03'
 11711        MOVE ER-8088               TO WS-ERROR
 11712        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11713        GO TO 3024-EDIT-DL02-CONT.
 11714
 11715     MOVE ER-8095                  TO WS-ERROR
 11716     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11717     GO TO 3024-EDIT-DL02-CONT.
 11718
 11719 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 215
* EL050.cbl
 11721
 11722****************************************************************
 11723*** VALIDATE BANK ID : DLO003                                ***
 11724****************************************************************
 11725
 11726     MOVE WK-GREG-CENT           TO WCG-CENT.
 11727     MOVE WK-GREG-YYMM           TO WCG-REST.
 11728     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11729        MOVE ER-8040               TO WS-ERROR
 11730        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11731
 11732     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11733     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11734     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11735     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11736     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11737     IF DVBI-SUCCESSFUL-EDIT
 11738        GO TO 3024-EDIT-DL03-CONT.
 11739
 11740     IF DVBI-RETURN-CODE EQUAL '01'
 11741        MOVE ER-8089               TO WS-ERROR
 11742        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11743        GO TO 3024-EDIT-DL03-CONT.
 11744
 11745     IF DVBI-RETURN-CODE EQUAL '02'
 11746        MOVE ER-8090               TO WS-ERROR
 11747        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11748        GO TO 3024-EDIT-DL03-CONT.
 11749
 11750     IF DVBI-RETURN-CODE EQUAL '03'
 11751        MOVE ER-8091               TO WS-ERROR
 11752        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11753        GO TO 3024-EDIT-DL03-CONT.
 11754
 11755     IF DVBI-RETURN-CODE EQUAL '04'
 11756        MOVE ER-8092               TO WS-ERROR
 11757        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11758        GO TO 3024-EDIT-DL03-CONT.
 11759
 11760     IF DVBI-RETURN-CODE EQUAL '05'
 11761        MOVE ER-8093               TO WS-ERROR
 11762        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11763        GO TO 3024-EDIT-DL03-CONT.
 11764
 11765     IF DVBI-RETURN-CODE EQUAL '06'
 11766        MOVE ER-8094               TO WS-ERROR
 11767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11768        GO TO 3024-EDIT-DL03-CONT.
 11769
 11770     MOVE ER-8096                  TO WS-ERROR
 11771     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11772     GO TO 3024-EDIT-DL03-CONT.
 11773
 11774 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 216
* EL050.cbl
 11776
 11777     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11778        NEXT SENTENCE
 11779     ELSE
 11780        MOVE ER-8042               TO WS-ERROR
 11781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11782
 11783     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11784     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11785     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11786
 11787     IF DMPF-RETURN-CODE = '01'
 11788        MOVE ER-8067               TO WS-ERROR
 11789        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11790        GO TO 3024-EDIT-DL01-CONT.
 11791
 11792     IF DMPF-RETURN-CODE = '02'
 11793        MOVE ER-8068               TO WS-ERROR
 11794        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11795        GO TO 3024-EDIT-DL01-CONT.
 11796
 11797     IF DMPF-RETURN-CODE = '03'
 11798        MOVE ER-8069               TO WS-ERROR
 11799        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11800        GO TO 3024-EDIT-DL01-CONT.
 11801
 11802     IF DMPF-RETURN-CODE = 'E1'
 11803        MOVE ER-8070               TO WS-ERROR
 11804        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11805        GO TO 3024-EDIT-DL01-CONT.
 11806
 11807     IF DMPF-RETURN-CODE = 'N1'
 11808        MOVE ER-8071               TO WS-ERROR
 11809        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11810        GO TO 3024-EDIT-DL01-CONT.
 11811
 11812     IF DMPF-RETURN-CODE NOT = 'OK'
 11813        MOVE ER-8072               TO WS-ERROR
 11814        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11815
 11816 3024-EDIT-DL01-CONT.
 11817******************************************************************
 11818***  VALIDATES RATE CODES : DLO017                             ***
 11819******************************************************************
 11820
 11821      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11822      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11823      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11824      IF DVRC-SUCCESSFUL-EDIT
 11825        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11826        GO TO 3024-CHECK-VALID-RATE.
 11827
 11828      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11829
 11830      IF DVRC-RETURN-CODE EQUAL '01'
 11831         MOVE ER-7817                   TO WS-ERROR
 11832         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11833         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 217
* EL050.cbl
 11834
 11835      IF DVRC-RETURN-CODE EQUAL '02'
 11836         MOVE ER-7818                   TO WS-ERROR
 11837         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11838         GO TO 3025-EDIT-REINSURANCE.
 11839
 11840      IF DVRC-RETURN-CODE EQUAL '03'
 11841         MOVE ER-7819                   TO WS-ERROR
 11842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11843         GO TO 3025-EDIT-REINSURANCE.
 11844
 11845       MOVE ER-7820                     TO WS-ERROR.
 11846       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11847       GO TO 3025-EDIT-REINSURANCE.
 11848
 11849******************************************************************
 11850***  GET PREMIUM RATES : DLO011                                ***
 11851******************************************************************
 11852
 11853 3024-CHECK-VALID-RATE.
 11854
 11855     IF VALID-RATE-CODE
 11856        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11857        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11858        MOVE SPACES                TO DPRB-RETURN-CODE
 11859        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11860     ELSE
 11861         GO TO 3025-EDIT-REINSURANCE.
 11862
 11863      IF DPRB-SUCCESSFUL-PROCESS
 11864         IF PB-VALID-LIFE
 11865             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11866             GO TO 3025-EDIT-REINSURANCE
 11867         ELSE
 11868             IF PB-VALID-AH
 11869                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11870                 GO TO 3025-EDIT-REINSURANCE.
 11871
 11872      IF DPRB-RETURN-CODE EQUAL '01'
 11873         MOVE ER-7812                   TO WS-ERROR
 11874         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11875         GO TO 3025-EDIT-REINSURANCE.
 11876
 11877      IF DPRB-RETURN-CODE EQUAL '02'
 11878         MOVE ER-7813                   TO WS-ERROR
 11879         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11880         GO TO 3025-EDIT-REINSURANCE.
 11881
 11882      IF DPRB-RETURN-CODE EQUAL '03'
 11883         MOVE ER-7814                   TO WS-ERROR
 11884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11885         GO TO 3025-EDIT-REINSURANCE.
 11886
 11887      IF DPRB-RETURN-CODE EQUAL '04'
 11888         IF NOT DPRB-1ST-TIME
 11889            MOVE ER-7815                   TO WS-ERROR
 11890            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11891            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 218
* EL050.cbl
 11892          ELSE
 11893         IF PB-VALID-LIFE
 11894            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11895          ELSE
 11896            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11897         END-IF
 11898         MOVE SPACES                TO DOCC-RETURN-CODE
 11899         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11900         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11901         IF DOCC-RETURN-CODE = 'OK'
 11902             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11903             GO TO 3024-CHECK-VALID-RATE
 11904           ELSE
 11905             MOVE ER-7823               TO WS-ERROR
 11906             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11907             GO TO 3025-EDIT-REINSURANCE.
 11908
 11909       MOVE ER-7816                     TO WS-ERROR.
 11910       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11911       GO TO 3025-EDIT-REINSURANCE.
 11912
 11913**********   DMD CUSTOM CODE ABOVE    **********
 11914
 11915 3025-EDIT-REINSURANCE.
 11916     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11917         GO TO 3027-EDIT-CONTINUE.
 11918
 11919     MOVE LOW-VALUES               TO ERREIN-KEY.
 11920     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11921     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11922                                      REIN-CODE-2
 11923                                      REIN-CODE-3.
 11924     MOVE 'A'                      TO REIN-TYPE.
 11925
 11926     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11927
 11928     MOVE '3026' TO REIN-SW.
 11929     MOVE ' '                   TO WS-REIN-READ-SW.
 11930
 11931     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11932     IF REIN-TABLE-NOT-FOUND
 11933         GO TO 3026-NO-SPEC-TABLE.
 11934
 11935     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11936     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11937                                   WS-NSP-ST-CD-LF.
 11938     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11939                                   WS-NSP-ST-CD-AH.
 11940
 11941     GO TO 3040-EDIT-CONTINUE.
 11942
 11943 3026-NO-SPEC-TABLE.
 11944
 11945     MOVE ER-2664                TO WS-ERROR.
 11946     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11947     GO TO 3040-EDIT-CONTINUE.
 11948
 11949 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 219
* EL050.cbl
 11950
 11951     IF PB-I-REIN-TABLE = SPACES
 11952       GO TO 3040-EDIT-CONTINUE.
 11953
 11954     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11955          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11956          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11957           GO TO 3040-EDIT-CONTINUE.
 11958
 11959     MOVE LOW-VALUES            TO ERREIN-KEY.
 11960     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11961     MOVE 'A'                   TO REIN-TYPE.
 11962     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11963
 11964     MOVE '3028'                TO REIN-SW.
 11965     MOVE ' '                   TO WS-REIN-READ-SW.
 11966
 11967     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11968     IF REIN-TABLE-NOT-FOUND
 11969         GO TO 3028-NO-REIN-TABLE.
 11970
 11971     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11972     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11973                                   WS-NSP-ST-CD-LF.
 11974     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11975                                   WS-NSP-ST-CD-AH.
 11976
 11977     GO TO 3040-EDIT-CONTINUE.
 11978
 11979 3028-NO-REIN-TABLE.
 11980
 11981     MOVE ER-2615                TO WS-ERROR.
 11982     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11983     GO TO 3040-EDIT-CONTINUE.
 11984
 11985 3040-EDIT-CONTINUE.
 11986
 11987     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11988         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11989
 11990     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11991         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11992
 11993     IF (NOT PB-REISSUED-CERT)
 11994        AND (NOT PB-MONTHLY-CERT)
 11995        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11996            MOVE '001'           TO PB-I-LF-TERM
 11997            MOVE 'M'             TO PB-I-INSURED-SEX.
 11998
 11999     IF (NOT PB-REISSUED-CERT)
 12000        AND (NOT PB-MONTHLY-CERT)
 12001        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12002            MOVE '001'           TO PB-I-AH-TERM
 12003            MOVE 'M'             TO PB-I-INSURED-SEX.
 12004
 12005 3040-EDIT-1ST-PMT-DT.
 12006     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12007     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 220
* EL050.cbl
 12008         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12009
 12010******************************************************************
 12011*                                                                *
 12012*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12013*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12014*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12015*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12016*                                                                *
 12017******************************************************************
 12018
 12019     IF PB-EFF-DT-PROCESSING
 12020        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12021                                    PB-I-LF-EXPIRE-DT
 12022                                    PB-I-AH-EXPIRE-DT
 12023        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12024        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12025        MOVE ZERO                TO DC-ELAPSED-DAYS
 12026        MOVE +1                  TO DC-ELAPSED-MONTHS
 12027        SET BIN-PLUS-ELAPSED     TO TRUE
 12028*       MOVE 6                   TO DC-OPTION-CODE
 12029        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12030        IF NO-CONVERSION-ERROR
 12031           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12032
 12033******************************************************************
 12034*                                                                *
 12035*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12036*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12037*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12038*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12039*                                                                *
 12040******************************************************************
 12041
 12042     IF PB-EXT-DAYS-PROCESSING
 12043          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12044                                         PB-I-LF-EXPIRE-DT
 12045                                         PB-I-AH-EXPIRE-DT
 12046          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12047          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12048          MOVE +1                     TO DC-ELAPSED-MONTHS
 12049          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12050          SET BIN-PLUS-ELAPSED        TO TRUE
 12051*         MOVE 6                      TO DC-OPTION-CODE
 12052          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12053          IF NO-CONVERSION-ERROR
 12054             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12055
 12056******************************************************************
 12057*                                                                *
 12058*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12059*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12060*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12061*        (EXPIRE DATE - (TERM -1))  *  -1.
 12062*                                                                *
 12063******************************************************************
 12064
 12065     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 221
* EL050.cbl
 12066        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12067           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12068              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12069              MOVE PB-I-AH-TERM      TO WS-TERM
 12070           ELSE
 12071              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12072              MOVE PB-I-LF-TERM      TO WS-TERM
 12073        ELSE
 12074           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12075              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12076              MOVE PB-I-LF-TERM      TO WS-TERM
 12077           ELSE
 12078              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12079              MOVE PB-I-AH-TERM      TO WS-TERM.
 12080
 12081     IF PB-EXPIRE-DT-PROCESSING
 12082        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12083        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12084        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12085        MOVE ZERO                TO DC-ELAPSED-DAYS
 12086                                    DC-ODD-DAYS-OVER
 12087          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12088          SET BIN-PLUS-ELAPSED    TO TRUE
 12089*         MOVE 6                  TO DC-OPTION-CODE
 12090          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12091          IF NO-CONVERSION-ERROR
 12092             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12093
 12094******************************************************************
 12095*                                                                *
 12096*            1ST PAYMENT DATE PROCESSING                         *
 12097*                                                                *
 12098******************************************************************
 12099
 12100     IF PB-1ST-PMT-DT-PROCESSING
 12101        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12102                                    PB-I-AH-EXPIRE-DT
 12103        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12104
 12105     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12106         NEXT SENTENCE
 12107     ELSE
 12108         MOVE ER-2680                 TO WS-ERROR
 12109         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12110         GO TO 3060-ORIG-TERM-CHECK.
 12111
 12112     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12113     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12114     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12115*    MOVE 1                      TO DC-OPTION-CODE.
 12116     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12117                                    DC-ELAPSED-DAYS
 12118                                    DC-ODD-DAYS-OVER.
 12119
 12120     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12121
 12122     IF DATE-CONVERSION-ERROR
 12123        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 222
* EL050.cbl
 12124
 12125     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12126     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12127        AND (WS-LF-COVERAGE-TYPE = 'L')
 12128        IF (DC-ELAPSED-MONTHS > 1)
 12129                      OR
 12130           ((DC-ELAPSED-MONTHS = 1)
 12131           AND (DC-ODD-DAYS-OVER > 0))
 12132           MOVE ER-2882          TO WS-ERROR
 12133           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12134        END-IF
 12135     END-IF
 12136     if dc-elapsed-months > 0
 12137        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12138        + dc-odd-days-over
 12139     end-if
 12140     IF PB-EXT-DAYS-PROCESSING
 12141        CONTINUE
 12142     ELSE
 12143        IF DC-ELAPSED-MONTHS = +0
 12144           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12145        ELSE
 12146           IF (WS-LF-EARNINGS-CALC = '4')
 12147              AND (DC-ELAPSED-MONTHS > ZERO)
 12148              AND (DC-ELAPSED-DAYS > ZERO)
 12149              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12150           ELSE
 12151              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12152                                 THRU 6499-EXIT
 12153              MOVE WS-ODD-DAYS-OVER
 12154                                 TO PB-I-EXTENTION-DAYS
 12155           END-IF
 12156        END-IF
 12157     END-IF
 12158******************************************************************
 12159*                                                                *
 12160*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12161*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12162*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12163*            AND ANY ODD DAYS.                                   *
 12164*                                                                *
 12165******************************************************************
 12166
 12167     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12168                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12169     IF WS-LF-EARNINGS-CALC NOT = '4'
 12170        IF DC-ELAPSED-DAYS > ZEROS
 12171           MOVE ER-2681          TO WS-ERROR
 12172           PERFORM 9900-ERROR-FORMAT
 12173                                 THRU 9900-EXIT
 12174        END-IF
 12175     END-IF
 12176
 12177     IF WS-LF-EARNINGS-CALC NOT = '4'
 12178        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12179           MOVE ER-2681          TO WS-ERROR
 12180           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12181
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 223
* EL050.cbl
 12182     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12183        (PB-I-LF-TERM NOT = ZERO) AND
 12184         NOT NO-LIFE-COVERAGE
 12185          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12186          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12187          IF WS-LF-EARNINGS-CALC = '4'
 12188             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12189             PB-I-PAY-FREQUENCY
 12190          END-IF
 12191          MOVE ZERO              TO DC-ELAPSED-DAYS
 12192                                    DC-ODD-DAYS-OVER
 12193          MOVE 1                 TO DC-END-OF-MONTH
 12194          SET BIN-PLUS-ELAPSED        TO TRUE
 12195*         MOVE 6                 TO DC-OPTION-CODE
 12196          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12197          IF NO-CONVERSION-ERROR
 12198             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12199             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12200                (WS-LF-SPECIAL-CALC-CD = 'L')
 12201                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12202                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12203                  MOVE +1             TO DC-ELAPSED-MONTHS
 12204                  SET BIN-PLUS-ELAPSED  TO TRUE
 12205*                 MOVE 6              TO DC-OPTION-CODE
 12206                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12207                  IF NO-CONVERSION-ERROR
 12208                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12209
 12210* okay, i had to move the new att age edit down here because the
 12211* expiration date could get recalculated and i need the exp date
 12212     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12213        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12214        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12215        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12216           AND ZEROS
 12217           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12218           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12219           SET ELAPSED-BETWEEN-BIN TO TRUE
 12220           PERFORM 8500-DATE-CONVERT
 12221                                 THRU 8500-EXIT
 12222           IF NO-CONVERSION-ERROR
 12223              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12224                 MOVE ER-2669       TO WS-ERROR
 12225*                PERFORM 9900-ERROR-FORMAT
 12226*                                THRU 9900-EXIT
 12227              END-IF
 12228           END-IF
 12229        ELSE
 12230           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12231           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12232              MOVE ER-2669       TO WS-ERROR
 12233*             PERFORM 9900-ERROR-FORMAT
 12234*                                THRU 9900-EXIT
 12235           ELSE
 12236              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12237                 MOVE ER-1570    TO WS-ERROR
 12238                 PERFORM 9900-ERROR-FORMAT
 12239                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 224
* EL050.cbl
 12240              END-IF
 12241           END-IF
 12242        END-IF
 12243        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12244           AND ZEROS
 12245           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12246           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12247           SET ELAPSED-BETWEEN-BIN TO TRUE
 12248           PERFORM 8500-DATE-CONVERT
 12249                                 THRU 8500-EXIT
 12250           IF NO-CONVERSION-ERROR
 12251              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12252                 MOVE ER-2669       TO WS-ERROR
 12253*                PERFORM 9900-ERROR-FORMAT
 12254*                                THRU 9900-EXIT
 12255              END-IF
 12256           END-IF
 12257        ELSE
 12258           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12259             (PB-I-LF-TERM / 12)
 12260           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12261              MOVE ER-2669       TO WS-ERROR
 12262*             PERFORM 9900-ERROR-FORMAT
 12263*                                THRU 9900-EXIT
 12264           ELSE
 12265              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12266                 MOVE ER-1571    TO WS-ERROR
 12267                 PERFORM 9900-ERROR-FORMAT
 12268                                 THRU 9900-EXIT
 12269              END-IF
 12270           END-IF
 12271        END-IF
 12272        IF WS-ERROR = ER-2669
 12273           PERFORM 9900-ERROR-FORMAT
 12274                                 THRU 9900-EXIT
 12275        END-IF
 12276     END-IF
 12277     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12278        (PB-I-AH-TERM NOT = ZERO) AND
 12279         NOT NO-AH-COVERAGE
 12280          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12281             AND (PB-COMPANY-ID = 'DCC')
 12282             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12283             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12284          ELSE
 12285             IF WS-LF-EARNINGS-CALC = '4'
 12286                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12287                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12288                PB-I-PAY-FREQUENCY
 12289             ELSE
 12290                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12291                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12292             END-IF
 12293          END-IF
 12294          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12295                                         DC-ODD-DAYS-OVER
 12296          MOVE 1                      TO DC-END-OF-MONTH
 12297          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 225
* EL050.cbl
 12298*         MOVE 6                      TO DC-OPTION-CODE
 12299          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12300          IF NO-CONVERSION-ERROR
 12301             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12302     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12303        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12304        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12305        IF PB-I-BIRTHDAY > LOW-VALUES
 12306           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12307           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12308           SET ELAPSED-BETWEEN-BIN TO TRUE
 12309           PERFORM 8500-DATE-CONVERT
 12310                                 THRU 8500-EXIT
 12311           IF NO-CONVERSION-ERROR
 12312              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12313                 MOVE ER-3054       TO WS-ERROR
 12314*                PERFORM 9900-ERROR-FORMAT
 12315*                                THRU 9900-EXIT
 12316              END-IF
 12317           END-IF
 12318        ELSE
 12319           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12320           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12321              MOVE ER-3054       TO WS-ERROR
 12322*             PERFORM 9900-ERROR-FORMAT
 12323*                                THRU 9900-EXIT
 12324           END-IF
 12325        END-IF
 12326        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12327           AND ZEROS
 12328           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12329           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12330           SET ELAPSED-BETWEEN-BIN TO TRUE
 12331           PERFORM 8500-DATE-CONVERT
 12332                                 THRU 8500-EXIT
 12333           IF NO-CONVERSION-ERROR
 12334              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12335                 MOVE ER-3054       TO WS-ERROR
 12336*                PERFORM 9900-ERROR-FORMAT
 12337*                                THRU 9900-EXIT
 12338              END-IF
 12339           END-IF
 12340        ELSE
 12341           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12342             (PB-I-AH-TERM / 12)
 12343           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12344              MOVE ER-3054       TO WS-ERROR
 12345*             PERFORM 9900-ERROR-FORMAT
 12346*                                THRU 9900-EXIT
 12347           END-IF
 12348        END-IF
 12349        IF WS-ERROR = ER-3054
 12350           PERFORM 9900-ERROR-FORMAT
 12351                                 THRU 9900-EXIT
 12352        END-IF
 12353     END-IF
 12354     MOVE SPACE                       TO DC-END-OF-MONTH.
 12355
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 226
* EL050.cbl
 12356     IF PB-COMPANY-ID = 'NCB'
 12357        GO TO 3040-EDIT-EXTENSION-DAYS.
 12358
 12359     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12360       AND
 12361        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12362        NEXT SENTENCE
 12363     ELSE
 12364        GO TO 3040-EDIT-EXTENSION-DAYS.
 12365
 12366     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12367        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12368        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12369     ELSE
 12370        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12371        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12372
 12373     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12374*    MOVE '1'      TO DC-OPTION-CODE
 12375     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12376     IF (NO-CONVERSION-ERROR)
 12377        AND (DC-ELAPSED-MONTHS > +1)
 12378        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12379        MOVE ER-2668   TO WS-ERROR
 12380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12381
 12382 3040-EDIT-EXTENSION-DAYS.
 12383
 12384     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12385        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12386         GO TO 3050-EDIT-TERM-IN-DAYS
 12387     ELSE
 12388         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12389
 12390     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12391         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12392     ELSE
 12393        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12394           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12395           MOVE ER-2681         TO WS-ERROR
 12396           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12397
 12398     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12399        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12400        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12401         GO TO 3060-ORIG-TERM-CHECK.
 12402
 12403     GO TO 3060-ORIG-TERM-CHECK.
 12404
 12405 3050-EDIT-TERM-IN-DAYS.
 12406
 12407     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12408
 12409     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12410         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12411     ELSE
 12412         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12413            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 227
* EL050.cbl
 12414            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12415
 12416     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12417                                       REMAINDER WS-WORK-TERM.
 12418     IF WS-WORK-TERM GREATER THAN ZERO
 12419         ADD +1 TO PB-I-LF-TERM.
 12420
 12421     IF NOT NO-AH-COVERAGE
 12422         MOVE ER-2684            TO WS-ERROR
 12423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12424
 12425
 12426 3060-ORIG-TERM-CHECK.
 12427
 12428******************************************************************
 12429*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12430******************************************************************
 12431
 12432     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12433        NEXT SENTENCE
 12434     ELSE
 12435        IF NOT NO-LIFE-COVERAGE
 12436           IF PB-I-LF-TERM NUMERIC
 12437              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12438              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12439              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12440                  NEXT SENTENCE
 12441           ELSE
 12442              MOVE ER-2647       TO WS-ERROR
 12443              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12444
 12445     IF NOT NO-AH-COVERAGE
 12446         IF PB-I-AH-TERM NUMERIC
 12447            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12448            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12449            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12450             NEXT SENTENCE
 12451          ELSE
 12452              MOVE ER-2658       TO WS-ERROR
 12453              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12454
 12455     IF PB-COMPANY-ID = 'NCB'
 12456        GO TO 3070-LOAN-TERM-CHECK.
 12457
 12458     IF POLICY-HAS-AH
 12459       AND
 12460        POLICY-HAS-LIFE
 12461       AND
 12462        PB-I-LF-TERM NUMERIC
 12463       AND
 12464        PB-I-AH-TERM NUMERIC
 12465        NEXT SENTENCE
 12466     ELSE
 12467        GO TO 3070-LOAN-TERM-CHECK.
 12468
 12469     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12470     IF WS-TEX-FACT-2 LESS THAN +0
 12471        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 228
* EL050.cbl
 12472
 12473     IF WS-TEX-FACT-2 GREATER THAN +1
 12474        MOVE ER-2668             TO WS-ERROR
 12475        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12476
 12477 3070-LOAN-TERM-CHECK.
 12478
 12479     IF (WS-LF-BENEFIT-CD = ZERO)
 12480         OR (NO-LF-BENEFIT-MATCH)
 12481            GO TO 3125-EDIT-PMT-FREQ.
 12482*    IF PB-COMPANY-ID NOT = 'DCC'
 12483*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12484*          AND 'V' AND 'W' AND 'X'
 12485*          GO TO 3125-EDIT-PMT-FREQ
 12486*       END-IF
 12487*    ELSE
 12488*       IF WS-AH-DCC-TRUNC = 'T'
 12489*          CONTINUE
 12490*       ELSE
 12491*          GO TO 3125-EDIT-PMT-FREQ
 12492*       END-IF
 12493*    END-IF
 12494     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12495                    OR
 12496        ((PB-COMPANY-ID = 'DCC')
 12497        AND (WS-AH-DCC-TRUNC = 'T'))
 12498        CONTINUE
 12499     ELSE
 12500        GO TO 3125-EDIT-PMT-FREQ
 12501     END-IF
 12502     IF PB-I-LOAN-TERM NOT NUMERIC
 12503         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12504
 12505     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12506        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12507*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12508        PB-I-LOAN-TERM NOT GREATER THAN +360
 12509         NEXT SENTENCE
 12510     ELSE
 12511         MOVE ER-2648            TO WS-ERROR
 12512         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12513
 12514     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12515        MOVE ER-3058             TO WS-ERROR
 12516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12517     end-if
 12518
 12519     IF WS-STATE-ABBREVIATION = 'NC'
 12520        IF PB-I-LOAN-TERM > +59
 12521           CONTINUE
 12522        ELSE
 12523           MOVE ER-2792          TO WS-ERROR
 12524           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12525        END-IF
 12526     END-IF
 12527
 12528     .
 12529 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 229
* EL050.cbl
 12530     IF (WS-LF-BENEFIT-CD = ZERO)
 12531         OR (NO-LF-BENEFIT-MATCH)
 12532            GO TO 3127-EDIT-LOAN-OFFICER.
 12533     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12534                    OR
 12535        ((PB-COMPANY-ID = 'DCC')
 12536        AND (WS-AH-DCC-TRUNC = 'T'))
 12537                    OR
 12538         (PB-COMPANY-ID = 'AHL')
 12539        CONTINUE
 12540     ELSE
 12541        IF (PB-I-LOAN-TERM > ZEROS)
 12542           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12543           MOVE ER-1575          TO WS-ERROR
 12544           PERFORM 9900-ERROR-FORMAT
 12545                                 THRU 9900-EXIT
 12546        END-IF
 12547     END-IF
 12548     IF WS-LF-EARNINGS-CALC NOT = '4'
 12549         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12550            MOVE ER-2653         TO WS-ERROR
 12551            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12552            GO TO 3127-EDIT-LOAN-OFFICER
 12553         ELSE
 12554            GO TO 3127-EDIT-LOAN-OFFICER.
 12555
 12556     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12557         MOVE ER-2655            TO WS-ERROR
 12558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12559         GO TO 3127-EDIT-LOAN-OFFICER.
 12560
 12561     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12562         MOVE ER-2654            TO WS-ERROR
 12563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12564         GO TO 3127-EDIT-LOAN-OFFICER.
 12565
 12566     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12567         GIVING WS-TEX-FACT-2
 12568             REMAINDER WS-TEX-FACT-3.
 12569
 12570*    IF WS-TEX-FACT-3 NOT = ZERO
 12571*       MOVE ER-2654             TO WS-ERROR
 12572*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12573
 12574
 12575 3127-EDIT-LOAN-OFFICER.
 12576
 12577     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12578        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12579           MOVE ER-2690          TO WS-ERROR
 12580           PERFORM 9900-ERROR-FORMAT
 12581                                 THRU 9900-EXIT
 12582        ELSE
 12583           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12584           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12585           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12586           MOVE PB-SV-STATE      TO LOFC-STATE
 12587           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 230
* EL050.cbl
 12588           MOVE PB-I-LOAN-OFFICER
 12589                                 TO LOFC-CODE
 12590           PERFORM 8586-READ-LOAN-OFFICER
 12591                                 THRU 8586-EXIT
 12592           IF (NOT LOFC-MASTER-FOUND)
 12593              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12594              MOVE ER-3006       TO WS-ERROR
 12595              PERFORM 9900-ERROR-FORMAT
 12596                                 THRU 9900-EXIT
 12597           END-IF
 12598        END-IF
 12599     END-IF
 12600     .
 12601 3129-EDIT-APR.
 12602
 12603     IF (WS-LF-BENEFIT-CD = ZERO)
 12604        OR (NO-LF-BENEFIT-MATCH)
 12605        IF PB-COMPANY-ID NOT = 'DCC'
 12606           GO TO 3130-EDIT-AGE
 12607*       ELSE
 12608*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12609*             GO TO 3130-EDIT-AGE
 12610*          END-IF
 12611        END-IF
 12612     END-IF
 12613
 12614     IF (WS-STATE-ABBREVIATION = 'OH')
 12615         AND (PB-I-RATE-CLASS NOT = 'L ')
 12616         AND (PB-I-LF-TERM GREATER THAN 60)
 12617         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12618         GO TO 3129-APR-CONT.
 12619
 12620     IF (WS-STATE-ABBREVIATION = 'RI')
 12621         AND (PB-I-LF-TERM GREATER THAN 60)
 12622         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12623         GO TO 3129-APR-CONT.
 12624
 12625     IF (WS-STATE-ABBREVIATION = 'UT')
 12626         AND (PB-I-LF-TERM GREATER THAN 62)
 12627         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12628         AND (PB-CERT-EFF-DT LESS WS-830901)
 12629         GO TO 3129-APR-CONT.
 12630
 12631     IF PB-COMPANY-ID = 'LAP'
 12632        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12633           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12634              MOVE ER-2656         TO WS-ERROR
 12635              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12636              GO TO 3130-EDIT-AGE.
 12637
 12638     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12639        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12640        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12641        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12642        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12643        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12644         GO TO 3130-EDIT-AGE.
 12645
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 231
* EL050.cbl
 12646 3129-APR-CONT.
 12647     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12648         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12649         GO TO 3130-EDIT-AGE.
 12650
 12651     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12652         WS-AH-BENEFIT-CD (1:1) = 'S')
 12653        AND (PB-COMPANY-ID = 'DCC')
 12654        AND (PB-I-LOAN-APR = ZERO)
 12655        MOVE ER-2657             TO WS-ERROR
 12656        PERFORM 9900-ERROR-FORMAT
 12657                                 THRU 9900-EXIT
 12658        GO TO 3130-EDIT-AGE
 12659     END-IF
 12660*    IF PB-I-LOAN-APR = ZERO
 12661*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12662*    END-IF
 12663
 12664     if pb-i-loan-apr = +99.9999
 12665        move er-2656             to ws-error
 12666        PERFORM 9900-ERROR-FORMAT
 12667                                 THRU 9900-EXIT
 12668        GO TO 3130-EDIT-AGE
 12669     end-if
 12670*    IF PB-I-LOAN-APR = ZERO
 12671*       MOVE ER-2656             TO WS-ERROR
 12672*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12673*       GO TO 3130-EDIT-AGE.
 12674
 12675*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12676     if pb-i-loan-apr not = +99.9999
 12677        IF PB-I-LOAN-APR > +30.000
 12678           MOVE ER-2657          TO WS-ERROR
 12679           PERFORM 9900-ERROR-FORMAT
 12680                                 THRU 9900-EXIT
 12681        end-if
 12682     end-if
 12683     .
 12684 3130-EDIT-AGE.
 12685
 12686******************************************************************
 12687*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12688******************************************************************
 12689
 12690     IF NOT NO-LIFE-COVERAGE
 12691        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12692           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12693               MOVE ER-2628             TO WS-ERROR
 12694               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12695
 12696     IF NOT NO-AH-COVERAGE
 12697        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12698           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12699               MOVE ER-2628         TO WS-ERROR
 12700               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12701
 12702 3133-SEX-CODE.
 12703     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 232
* EL050.cbl
 12704         IF WS-DEFAULT-SEX = 'M'
 12705             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12706          ELSE
 12707             IF WS-DEFAULT-SEX = 'F'
 12708             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12709
 12710     IF PB-I-INSURED-SEX = '1'
 12711         MOVE 'M' TO PB-I-INSURED-SEX.
 12712
 12713     IF PB-I-INSURED-SEX = '2'
 12714         MOVE 'F' TO PB-I-INSURED-SEX.
 12715
 12716 3134-SIG-SW-EDIT.
 12717     IF PB-I-SIG-SW = SPACE
 12718         MOVE 'N'                TO  PB-I-SIG-SW.
 12719
 12720     IF PB-COMPANY-ID = 'NCL'
 12721         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12722             NEXT SENTENCE
 12723         ELSE
 12724             MOVE ER-1923        TO  WS-ERROR
 12725             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12726     ELSE
 12727     IF PB-COMPANY-ID = 'CRI'
 12728         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12729             NEXT SENTENCE
 12730         ELSE
 12731             MOVE ER-2606        TO  WS-ERROR
 12732             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12733     ELSE
 12734     IF PB-COMPANY-ID = 'TMS'
 12735         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12736             NEXT SENTENCE
 12737         ELSE
 12738             MOVE ER-2689        TO  WS-ERROR
 12739             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12740     ELSE
 12741         IF PB-I-SIG-SW = 'Y' OR 'N'
 12742             NEXT SENTENCE
 12743         ELSE
 12744             MOVE ER-2651        TO  WS-ERROR
 12745             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12746
 12747     IF PB-COMPANY-ID = 'FLA'
 12748         IF (WS-EDIT-AGE GREATER 54  OR
 12749             WS-AH-EDIT-AGE GREATER 54)  AND
 12750            PB-I-SIG-SW = 'N'
 12751            MOVE ER-2651         TO  WS-ERROR
 12752            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12753
 12754 3135-NAME-EDIT.
 12755
 12756     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12757        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12758        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12759           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12760                                 TO PB-I-JOINT-FIRST-NAME
 12761        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 233
* EL050.cbl
 12762     END-IF
 12763     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12764        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12765        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12766           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12767                                 TO PB-I-JOINT-LAST-NAME
 12768        END-PERFORM
 12769     END-IF
 12770     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12771        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12772        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12773           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12774                                 TO PB-I-INSURED-FIRST-NAME
 12775        END-PERFORM
 12776     END-IF
 12777     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12778        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12779        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12780           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12781                                 TO PB-I-INSURED-LAST-NAME
 12782        END-PERFORM
 12783     END-IF
 12784     IF PB-I-INSURED-LAST-NAME = SPACES
 12785       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12786       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12787           MOVE ER-2660    TO WS-ERROR
 12788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12789
 12790 3136-EDIT-SEX.
 12791
 12792******************************************************************
 12793*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12794******************************************************************
 12795
 12796     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12797        (WS-AH-SPECIAL-CALC-CD = 'O')
 12798        NEXT SENTENCE
 12799     ELSE
 12800        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12801           NEXT SENTENCE
 12802        ELSE
 12803           MOVE ER-2629            TO WS-ERROR
 12804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12805
 12806 3137-EDIT-EFF-DATE.
 12807
 12808     IF PB-REISSUED-CERT       OR
 12809        PB-POLICY-IS-DECLINED  OR
 12810        PB-POLICY-IS-VOIDED
 12811         GO TO 3139-EDIT-COVERAGE-CODES.
 12812
 12813     MOVE SPACE                  TO WS-2671-SW
 12814                                    WS-2672-SW.
 12815
 12816     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12817         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12818             MOVE ER-2703        TO WS-ERROR
 12819             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 234
* EL050.cbl
 12820             GO TO 3139-EDIT-COVERAGE-CODES.
 12821
 12822     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12823         GO TO 3139-EDIT-COVERAGE-CODES.
 12824
 12825     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12826     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12827*    MOVE '1'                    TO DC-OPTION-CODE.
 12828     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12829     MOVE +0                     TO DC-ELAPSED-MONTHS
 12830                                    DC-ELAPSED-DAYS.
 12831     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12832
 12833     IF DATE-CONVERSION-ERROR
 12834         GO TO 3139-EDIT-COVERAGE-CODES.
 12835
 12836     IF DC-ELAPSED-DAYS GREATER +180
 12837         MOVE ER-2672            TO WS-ERROR
 12838         MOVE 'Y'                TO WS-2672-SW
 12839         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12840     END-IF
 12841
 12842     IF WS-ERROR = ER-2671  AND
 12843        PB-COMPANY-ID  = 'LBL'
 12844        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12845        MOVE SPACE               TO WS-2671-SW
 12846        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12847
 12848     IF PB-ISSUE-DATE-FORCED  AND
 12849      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12850         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12851         MOVE ER-2673            TO WS-ERROR
 12852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12853         MOVE SPACE              TO WS-2671-SW
 12854                                    WS-2672-SW.
 12855
 12856     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12857         IF PB-ISSUE-DATE-FORCED
 12858             MOVE ER-2600          TO  WS-ERROR
 12859             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12860         ELSE
 12861             MOVE ER-2692          TO  WS-ERROR
 12862             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12863
 12864
 12865 3139-EDIT-COVERAGE-CODES.
 12866
 12867     if pb-company-id not = 'AHL'
 12868        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12869           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12870           MOVE ER-2787          TO WS-ERROR
 12871           PERFORM 9900-ERROR-FORMAT
 12872                                 THRU 9900-EXIT
 12873        END-IF
 12874     end-if
 12875     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12876        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12877                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 235
* EL050.cbl
 12878           MOVE ER-2719          TO WS-ERROR
 12879           PERFORM 9900-ERROR-FORMAT
 12880                                 THRU 9900-EXIT
 12881        END-IF
 12882     END-IF
 12883
 12884     IF PB-POLICY-IS-DECLINED  OR
 12885        PB-POLICY-IS-VOIDED
 12886         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12887
 12888     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12889        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12890         MOVE ER-2630                TO WS-ERROR
 12891         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12892
 12893     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12894        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12895        PB-I-LF-PREMIUM-AMT = ZERO
 12896         GO TO 3140-CHECK-AH-FOR-ZERO.
 12897
 12898     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12899        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12900        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12901         GO TO 3140-CHECK-AH-FOR-ZERO.
 12902
 12903     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12904        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12905        MOVE ER-2631             TO WS-ERROR
 12906        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12907     END-IF
 12908
 12909
 12910******************************************************************
 12911*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12912******************************************************************
 12913
 12914     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12915        NEXT SENTENCE
 12916     ELSE
 12917        IF PB-I-LF-BENEFIT-AMT = ZERO
 12918           MOVE ER-2632             TO WS-ERROR
 12919           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12920
 12921
 12922******************************************************************
 12923*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12924******************************************************************
 12925
 12926     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12927        CONTINUE
 12928     ELSE
 12929        IF PB-I-LF-PREMIUM-AMT = ZERO
 12930           IF (NOT PB-COMP-LF-PREM)
 12931              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12932              and (ws-lf-ben-category not = 'C')
 12933              MOVE ER-2633       TO WS-ERROR
 12934              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12935           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 236
* EL050.cbl
 12936        END-IF
 12937     END-IF
 12938     .
 12939 3140-CHECK-AH-FOR-ZERO.
 12940
 12941     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12942        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12943        PB-I-AH-PREMIUM-AMT = ZERO
 12944         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12945
 12946     IF PB-COMPANY-ID = 'CSL'  AND
 12947        PB-I-AH-BENEFIT-CD = ZERO  AND
 12948        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12949        PB-I-AH-PREMIUM-AMT = ZERO
 12950         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12951
 12952     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12953        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12954        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12955         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12956
 12957     IF PB-I-AH-BENEFIT-CD = ZERO
 12958         MOVE ER-2634            TO WS-ERROR
 12959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12960
 12961******************************************************************
 12962*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12963******************************************************************
 12964
 12965     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12966        NEXT SENTENCE
 12967     ELSE
 12968        IF PB-I-AH-BENEFIT-AMT = ZERO
 12969           MOVE ER-2635             TO WS-ERROR
 12970           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12971
 12972******************************************************************
 12973*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12974******************************************************************
 12975
 12976     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12977        NEXT SENTENCE
 12978     ELSE
 12979        IF PB-I-AH-PREMIUM-AMT = ZERO
 12980            IF NOT PB-COMP-AH-PREM
 12981                MOVE ER-2636    TO WS-ERROR
 12982                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12983
 12984
 12985 3140-EDIT-MAX-AMT-SIZES.
 12986* CUSTOM CODE FOR CLIENT    'DMD'
 12987     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12988                                     WS-RES-MUNI-TAX
 12989                                     PB-I-STATE-TAX
 12990                                     PB-I-MUNI-TAX.
 12991
 12992     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12993
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 237
* EL050.cbl
 12994     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12995        GO TO 3150-RATE-OUTSTAND-BAL.
 12996
 12997     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12998        GO TO 3150-RATE-OUTSTAND-BAL.
 12999
 13000     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13001        GO TO 3150-RATE-OUTSTAND-BAL.
 13002
 13003     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13004                             OR 'RIC')
 13005        GO TO 3150-RATE-OUTSTAND-BAL.
 13006
 13007     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13008        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13009            GO TO 3150-RATE-OUTSTAND-BAL
 13010        ELSE
 13011           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13012               GO TO 3150-RATE-OUTSTAND-BAL.
 13013
 13014     IF NOT PB-NO-MONTHS-SKIPPED
 13015        GO TO 3150-RATE-OUTSTAND-BAL.
 13016
 13017     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13018        GO TO 3150-RATE-OUTSTAND-BAL.
 13019
 13020     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13021        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13022           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13023             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13024           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13025           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13026              MOVE ER-2693     TO WS-ERROR
 13027              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13028              GO TO 3150-RATE-OUTSTAND-BAL
 13029           ELSE
 13030              GO TO 3150-RATE-OUTSTAND-BAL.
 13031
 13032 3150-RATE-OUTSTAND-BAL.
 13033
 13034* DMD RATING TEST
 13035     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13036         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13037         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13038         MOVE ER-2687                 TO WS-ERROR
 13039         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13040         MOVE 'B'                     TO PB-I-OB-FLAG
 13041         GO TO 3260-EDIT-CONTINUE.
 13042
 13043     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13044         IF  WS-ERROR    EQUAL    ER-2693
 13045             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13046                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13047                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13048                 MOVE  +0            TO  WS-ERROR.
 13049
 13050     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13051         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 238
* EL050.cbl
 13052             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13053                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13054                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13055                 MOVE  +0            TO  WS-ERROR.
 13056
 13057     IF PLAN-MASTER-AH-SW = 'Y'
 13058        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13059            IF  WS-ERROR    EQUAL    ER-2693
 13060              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13061                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13062                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13063                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13064                 MOVE  ER-1910           TO  WS-ERROR
 13065                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13066
 13067     IF PLAN-MASTER-AH-SW = 'Y'
 13068        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13069            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13070               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13071               MOVE  ER-1910           TO  WS-ERROR
 13072               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13073
 13074     IF PLAN-MASTER-AH-SW = 'Y'
 13075        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13076            IF  WS-ERROR    EQUAL    ER-2693
 13077                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13078                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13079                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13080                 MOVE  +0       TO  WS-ERROR.
 13081
 13082     IF WS-ERROR = ER-2693
 13083        IF PB-COMPANY-ID = 'JAL' AND
 13084           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13085           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13086           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13087
 13088     IF WS-ERROR = ER-2693
 13089        IF PB-COMPANY-ID = 'NCL'  AND
 13090           PB-I-AH-BENEFIT-CD = 'OA'
 13091           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13092           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13093
 13094     IF WS-ERROR = ER-2693
 13095        IF PB-COMPANY-ID = 'CNL' AND
 13096           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13097           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13098           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13099
 13100     IF WS-ERROR = ER-2693
 13101        IF PB-COMPANY-ID = 'HER'
 13102           IF WS-LEVEL
 13103              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13104              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13105
 13106     IF ((LF-BENEFIT-FOUND) AND
 13107         (NOT NO-LIFE-COVERAGE)  AND
 13108         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13109       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 239
* EL050.cbl
 13110             (NOT NO-AH-COVERAGE)    AND
 13111             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13112         NEXT SENTENCE
 13113     ELSE
 13114         GO TO 3215-EDIT-RATES.
 13115
 13116     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13117        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13118           MOVE ER-2674          TO WS-ERROR
 13119           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13120           GO TO 3215-EDIT-RATES.
 13121
 13122     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13123        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13124           MOVE ER-2674          TO WS-ERROR
 13125           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13126           GO TO 3215-EDIT-RATES.
 13127
 13128     MOVE 'B'                    TO PB-I-OB-FLAG.
 13129
 13130     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13131         NEXT SENTENCE
 13132     ELSE
 13133         IF NOT NO-LIFE-COVERAGE
 13134             IF WS-ACCT-LF-OB-RT = ZERO
 13135                MOVE ER-2641    TO WS-ERROR
 13136                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13137
 13138     IF PB-COMPANY-ID = 'CRI'
 13139       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13140         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13141         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13142         IF WS-ERROR = ER-2675
 13143            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13144            MOVE ER-2687              TO WS-ERROR
 13145            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13146         ELSE
 13147            MOVE ER-2687              TO WS-ERROR
 13148            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13149
 13150
 13151     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13152         NEXT SENTENCE
 13153     ELSE
 13154       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13155            NEXT SENTENCE
 13156       ELSE
 13157         IF NOT NO-AH-COVERAGE
 13158             IF WS-ACCT-AH-OB-RT = ZERO
 13159                MOVE ER-2642    TO WS-ERROR
 13160                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13161
 13162     IF PB-COMPANY-ID = 'CRI'
 13163       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13164         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13165         IF WS-ERROR = ER-2676
 13166            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13167            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 240
* EL050.cbl
 13168            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13169         ELSE
 13170            MOVE ER-2687              TO WS-ERROR
 13171            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13172
 13173     IF PB-COMPANY-ID NOT = 'GIC'
 13174         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13175            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13176     ELSE
 13177         IF PB-I-LF-PREM-CALC = ZEROS
 13178             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13179                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13180
 13181     IF PB-COMPANY-ID NOT = 'GIC'
 13182         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13183            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13184     ELSE
 13185         IF PB-I-AH-PREM-CALC = ZEROS
 13186             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13187                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13188
 13189     MOVE ZEROS TO PB-I-MORT-CODE.
 13190
 13191     GO TO 3260-EDIT-CONTINUE.
 13192
 13193
 13194 3215-EDIT-RATES.
 13195     IF ACCOUNT-MAST-FOUND
 13196         NEXT SENTENCE
 13197     ELSE
 13198         GO TO 3999-END-EDIT.
 13199
 13200 3220-CHECK-LF-RATES.
 13201
 13202     IF PB-COMPANY-ID = 'DCC'
 13203        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13204        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13205        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13206           AND (NOT WS-LF-CASH))
 13207                           OR
 13208           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13209           AND (NOT WS-AH-CASH)))
 13210                       AND
 13211           (PB-I-ENTRY-STATUS NOT = '5')
 13212           MOVE 'M'              TO PB-BATCH-ENTRY
 13213                                    PB-I-ENTRY-STATUS
 13214        END-IF
 13215     END-IF
 13216     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13217                                    PB-I-AH-PREM-CALC
 13218                                    PB-I-LF-ALT-PREM-CALC
 13219                                    PB-I-LF-ALT-RATE
 13220                                    PB-I-LF-REI-RATE
 13221                                    PB-I-LF-ALT-REI-RATE
 13222                                    PB-I-AH-REI-RATE
 13223                                    PB-I-TOT-FEES-CALC.
 13224
 13225     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 241
* EL050.cbl
 13226        NEXT SENTENCE
 13227     ELSE
 13228        MOVE ZEROS               TO PB-I-LF-RATE
 13229                                    PB-I-AH-RATE.
 13230
 13231     IF PB-I-TOT-FEES NOT NUMERIC
 13232        MOVE ZEROS               TO PB-I-TOT-FEES
 13233     END-IF
 13234     IF PB-I-LIVES NOT NUMERIC
 13235         MOVE ZERO               TO PB-I-LIVES.
 13236
 13237     IF PB-I-NUM-BILLED NOT NUMERIC
 13238         MOVE ZERO               TO PB-I-NUM-BILLED.
 13239
 13240     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13241        MOVE +0                  TO PB-I-LF-PREM-TAX
 13242     END-IF
 13243
 13244     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13245        MOVE +0                  TO PB-I-AH-PREM-TAX
 13246     END-IF
 13247
 13248     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13249        PB-I-PAY-FREQUENCY = ZEROS
 13250            MOVE 12 TO CP-PAY-FREQUENCY
 13251     ELSE
 13252            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13253
 13254     IF PB-I-STATE-TAX NOT NUMERIC
 13255         MOVE ZEROS               TO PB-I-STATE-TAX.
 13256
 13257     IF PB-I-MUNI-TAX NOT NUMERIC
 13258         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13259
 13260     MOVE SPACES                 TO CP-BEN-CATEGORY
 13261     IF PB-COMPANY-ID  = 'CSL'  AND
 13262        PB-I-LF-TERM NOT = ZERO
 13263        COMPUTE WS-PAYMENT-AMT =
 13264             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13265        COMPUTE WS-CSL-AMT1 =
 13266             PB-I-LF-TERM * AM-MAX-MON-BEN
 13267        COMPUTE WS-CSL-AMT2 =
 13268             WS-PAYMENT-AMT * PB-I-LF-TERM
 13269        IF CP-PAY-FREQUENCY NOT = 12
 13270           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13271           MOVE '8' TO WS-CSL-CALC-CD
 13272        ELSE
 13273           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13274              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13275               AM-MAX-TOT-BEN
 13276               MOVE '6' TO WS-CSL-CALC-CD
 13277           ELSE
 13278              IF (WS-CSL-AMT1  GREATER THAN
 13279                 AM-MAX-TOT-BEN) AND
 13280                 (WS-CSL-AMT2  GREATER THAN
 13281                 AM-MAX-TOT-BEN)
 13282                 MOVE '7' TO WS-CSL-CALC-CD
 13283              ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 242
* EL050.cbl
 13284                 MOVE '5' TO WS-CSL-CALC-CD.
 13285
 13286     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13287         NEXT SENTENCE
 13288     ELSE
 13289         GO TO 3300-CHECK-AH-RATES.
 13290
 13291*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13292
 13293     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13294        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13295              OR
 13296           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13297           MOVE ER-2618          TO WS-ERROR
 13298           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13299           GO TO 3300-CHECK-AH-RATES.
 13300
 13301     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13302           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13303                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13304
 13305     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13306         MOVE ER-2687             TO WS-ERROR
 13307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13308         MOVE 'Z000'              TO PB-I-MORT-CODE
 13309         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13310         GO TO 3300-CHECK-AH-RATES.
 13311
 13312     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13313        IF PB-I-LIVES = ZERO
 13314           MOVE ER-2688          TO WS-ERROR
 13315           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13316
 13317     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13318
 13319     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13320     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13321     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13322     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13323     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13324     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13325     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13326     MOVE '3'                    TO CP-PROCESS-TYPE.
 13327     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13328     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13329
 13330******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13331     IF PB-COMPANY-ID EQUAL 'CDL'
 13332         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13333            CP-EARN-AS-NET-PAY)
 13334             IF PB-CERT-EFF-DT GREATER  WS-931231
 13335                 MOVE '1'        TO CP-EARNING-METHOD.
 13336*******
 13337
 13338     MOVE PB-SV-STATE            TO CP-STATE.
 13339     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13340     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13341     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 243
* EL050.cbl
 13342     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13343     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13344                                    CP-RATING-BENEFIT-AMT.
 13345     IF CP-STATE-STD-ABBRV = 'OR'
 13346         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13347                                         PB-I-LF-ALT-BENEFIT-AMT.
 13348     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13349     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13350     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13351     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13352     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13353     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13354     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13355     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13356     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13357                                    CP-REMAINING-TERM
 13358                                    CP-LOAN-TERM.
 13359
 13360     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13361         NEXT SENTENCE
 13362     ELSE
 13363         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13364             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13365                                           PB-I-LF-PREMIUM-AMT.
 13366
 13367     IF PB-COMPANY-ID EQUAL 'CSL'
 13368        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13369           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13370                                         PB-I-LF-PREMIUM-AMT.
 13371
 13372     IF PB-COMPANY-ID EQUAL 'NCB'
 13373         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13374            CP-EARN-AS-NET-PAY
 13375             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13376                 PB-I-LF-PREMIUM-AMT.
 13377
 13378     IF (CP-TRUNCATED-LIFE)
 13379        or ((pb-company-id = 'AHL')
 13380           and (pb-i-loan-term > pb-i-lf-term))
 13381        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13382
 13383     IF PB-COMPANY-ID EQUAL 'CRI'
 13384        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13385
 13386     IF CP-TERM-IS-DAYS
 13387         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13388     ELSE
 13389         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13390     IF PB-COMPANY-ID = 'DCC'
 13391        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13392        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13393        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13394        IF WS-LF-BEN-CATEGORY = 'D'
 13395           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13396           MOVE PB-I-LIFE-COMMISSION
 13397                                 TO CP-DCC-ACT-COMM
 13398           MOVE WS-LF-BEN-CATEGORY
 13399                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 244
* EL050.cbl
 13400        END-IF
 13401        IF (CP-BENEFIT-CD (1:1) = 'P')
 13402           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13403           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13404           add pb-i-ah-premium-amt to cp-original-premium
 13405        END-IF
 13406     END-IF
 13407     IF PB-COMPANY-ID = 'CSL'
 13408         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13409         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13410         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13411
 13412     IF PB-COMPANY-ID = 'CSL'
 13413        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13414
 13415     IF (CP-SPECIAL-CALC-CD = 'H')
 13416        OR (PB-COMPANY-ID = 'DCC')
 13417         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13418                                    TO CP-ALTERNATE-BENEFIT
 13419         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13420     if (pb-company-id = 'CID')
 13421        and (ws-lf-earnings-calc = '4')
 13422        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13423        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13424        move pb-i-term-type      to cp-pmt-mode
 13425        move pb-i-no-of-payments to cp-no-of-pmts
 13426     end-if
 13427     move ws-net-only-state      to cp-net-only-state
 13428     IF (PB-COMPANY-ID = 'CID')
 13429        AND (WS-LF-EARNINGS-CALC = 'B')
 13430        AND (CP-STATE-STD-ABBRV = 'MN')
 13431        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13432                                 TO CP-ALTERNATE-BENEFIT
 13433        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13434     END-IF
 13435     IF (PB-COMPANY-ID = 'CID')
 13436        AND (WS-LF-EARNINGS-CALC = 'B')
 13437        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13438                                 TO CP-ALTERNATE-BENEFIT
 13439        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13440        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13441*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13442*         pb-i-lf-alt-premium-amt
 13443        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13444        IF WS-LF-BEN-CATEGORY = 'P'
 13445           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13446        ELSE
 13447           IF WS-LF-BEN-CATEGORY = 'I'
 13448              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13449           END-IF
 13450        END-IF
 13451     END-IF
 13452     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13453     MOVE 'R'                   TO CP-RATE-FILE.
 13454     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13455
 13456     IF CP-ERROR-RATE-NOT-FOUND
 13457        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 245
* EL050.cbl
 13458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13459        GO TO 3300-CHECK-AH-RATES.
 13460
 13461     IF PB-COMPANY-ID EQUAL 'CRI'
 13462        IF CP-ERROR-NO-LIMITS-CRI
 13463           IF NOT ACCOUNT-LIFE-CHECKED
 13464              MOVE ER-2607      TO WS-ERROR
 13465              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13466
 13467******************************************************************
 13468*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13469*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13470******************************************************************
 13471
 13472* CALC LIFE AGE AT EXPIRATION.
 13473
 13474     COMPUTE WS-AGE-AT-EXPIRE =
 13475          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13476
 13477*    IF PB-STATE = 'CO' OR 'UT'
 13478*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13479*        MOVE 'F'            TO PB-FATAL-FLAG
 13480*        MOVE ER-2709        TO WS-ERROR
 13481*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13482*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13483
 13484*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13485*        MOVE 'X'            TO PB-FATAL-FLAG
 13486*        MOVE ER-2718        TO WS-ERROR
 13487*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13488*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13489
 13490* CALC A & H AGE AT EXPIRATION.
 13491
 13492     COMPUTE WS-AGE-AT-EXPIRE =
 13493          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13494
 13495*    IF PB-STATE = 'CO' OR 'UT'
 13496*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13497*        MOVE 'F'            TO PB-FATAL-FLAG
 13498*        MOVE ER-2709        TO WS-ERROR
 13499*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13500*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13501
 13502*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13503*        MOVE 'X'            TO PB-FATAL-FLAG
 13504*        MOVE ER-2718        TO WS-ERROR
 13505*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13506*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13507
 13508     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13509        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13510
 13511     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13512        and (not pb-monthly-cert)
 13513        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13514     end-if
 13515
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 246
* EL050.cbl
 13516     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13517        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13518
 13519     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13520         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13521         MOVE ER-2639        TO WS-ERROR
 13522         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13523
 13524
 13525******************************************************************
 13526*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13527******************************************************************
 13528
 13529 PREMIUM-EDITING-IS-BYPASSED.
 13530     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13531        AND (CP-R-MAX-ATT-AGE > +0)
 13532        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13533        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13534           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13535           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13536           MOVE '1'              TO DC-OPTION-CODE
 13537           PERFORM 8500-DATE-CONVERT
 13538                                 THRU 8500-EXIT
 13539           IF NO-CONVERSION-ERROR
 13540              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13541                 MOVE ER-2661       TO WS-ERROR
 13542*                PERFORM 9900-ERROR-FORMAT
 13543*                                THRU 9900-EXIT
 13544              END-IF
 13545           END-IF
 13546        ELSE
 13547           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13548           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13549              MOVE ER-2661       TO WS-ERROR
 13550*             PERFORM 9900-ERROR-FORMAT
 13551*                                THRU 9900-EXIT
 13552           ELSE
 13553              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13554                 MOVE ER-1570    TO WS-ERROR
 13555                 PERFORM 9900-ERROR-FORMAT
 13556                                 THRU 9900-EXIT
 13557              END-IF
 13558           END-IF
 13559        END-IF
 13560        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13561           MOVE PB-I-JOINT-BIRTHDAY
 13562                                 TO DC-BIN-DATE-1
 13563           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13564           MOVE '1'              TO DC-OPTION-CODE
 13565           PERFORM 8500-DATE-CONVERT
 13566                                 THRU 8500-EXIT
 13567           IF NO-CONVERSION-ERROR
 13568              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13569                 MOVE ER-2661       TO WS-ERROR
 13570*                PERFORM 9900-ERROR-FORMAT
 13571*                                THRU 9900-EXIT
 13572              END-IF
 13573           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 247
* EL050.cbl
 13574              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13575           END-IF
 13576        ELSE
 13577           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13578             (PB-I-LF-TERM / 12)
 13579           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13580              MOVE ER-2661       TO WS-ERROR
 13581*             PERFORM 9900-ERROR-FORMAT
 13582*                                THRU 9900-EXIT
 13583           ELSE
 13584              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13585                 MOVE ER-1571    TO WS-ERROR
 13586                 PERFORM 9900-ERROR-FORMAT
 13587                                 THRU 9900-EXIT
 13588              END-IF
 13589           END-IF
 13590        END-IF
 13591        IF WS-ERROR = ER-2661
 13592           PERFORM 9900-ERROR-FORMAT
 13593                                 THRU 9900-EXIT
 13594        END-IF
 13595     END-IF
 13596*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13597*       MOVE ER-2661             TO WS-ERROR
 13598*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13599
 13600     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13601        MOVE ER-2662             TO WS-ERROR
 13602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13603
 13604     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13605        MOVE ER-2677             TO WS-ERROR
 13606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13607
 13608     IF CP-ERROR-LOAN-TERM
 13609        MOVE ER-2648             TO WS-ERROR
 13610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13611
 13612 3221-CHECK-ERROR-RATE-OPEN.
 13613
 13614     IF CP-ERROR-RATE-FILE-NOTOPEN
 13615         GO TO 3990-FILES-NOT-OPEN.
 13616
 13617     IF PB-COMPANY-ID NOT = 'DMD'
 13618        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13619     END-IF
 13620     .
 13621 3221-CONTINUE.
 13622     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13623                                    WS-DCC-AH-RATE
 13624     IF PB-COMPANY-ID = 'DCC'
 13625        IF WS-LF-BEN-CATEGORY = 'D'
 13626           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13627              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13628        END-IF
 13629     END-IF
 13630     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13631*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 248
* EL050.cbl
 13632     IF (PB-COMPANY-ID = 'CID')
 13633        AND (WS-LF-EARNINGS-CALC = 'B')
 13634        AND (CP-STATE-STD-ABBRV = 'MN')
 13635        AND (PB-CERT-EFF-DT > X'A4FF')
 13636        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13637     END-IF
 13638     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13639
 13640     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13641     IF (PB-COMPANY-ID = 'DCC')
 13642        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13643        AND (PB-I-POLICY-IS-MONTHLY)
 13644        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13645        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13646     END-IF
 13647     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13648     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13649     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13650     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13651     IF (PB-COMPANY-ID = 'DCC')
 13652        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13653        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13654        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13655        MOVE ER-2786             TO WS-ERROR
 13656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13657     END-IF
 13658
 13659     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13660
 13661******************************************************************
 13662*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13663******************************************************************
 13664     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13665        and ((not pb-monthly-cert)
 13666        or (ws-lf-ben-category = 'C'))
 13667        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13668
 13669     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13670        GO TO 3225-CHECK-ALT-LIFE-RATE
 13671     ELSE
 13672       IF PB-I-LF-RATE = ZERO
 13673          MOVE ER-2641          TO WS-ERROR
 13674          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13675
 13676 3225-CHECK-ALT-LIFE-RATE.
 13677
 13678     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13679        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13680        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13681         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13682
 13683     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13684         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13685             AND PB-COMPANY-ID NOT = 'DCC')
 13686                   OR
 13687              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13688              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13689              AND PB-COMPANY-ID NOT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 249
* EL050.cbl
 13690             MOVE ER-2720        TO  WS-ERROR
 13691             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13692             GO TO 3225-RATING-CONT
 13693         ELSE
 13694             GO TO 3225-RATING-CONT.
 13695     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13696        AND (AM-GPCD = 01 OR 06 OR 15)
 13697        MOVE ER-2798             TO WS-ERROR
 13698        PERFORM 9900-ERROR-FORMAT
 13699                                 THRU 9900-EXIT
 13700*       GO TO 3225-RATING-CONT
 13701     END-IF
 13702     if (pb-company-id = 'CID')
 13703        and (ws-lf-earnings-calc = 'B')
 13704        and (ws-lf-ben-category = 'P' or 'I')
 13705        and (ws-net-only-state = 'Y')
 13706        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13707        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13708        go to 3225-rating-cont
 13709     end-if
 13710     IF (PB-COMPANY-ID = 'CID')
 13711        AND (WS-LF-EARNINGS-CALC = 'B')
 13712        AND (CP-STATE-STD-ABBRV = 'MN')
 13713        AND (PB-CERT-EFF-DT > X'A4FF')
 13714        GO TO 3225-RATING-CONT
 13715     END-IF
 13716     IF PB-COMPANY-ID = 'DCC'
 13717        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13718           AND (PB-I-POLICY-IS-MONTHLY)
 13719           GO TO 3225-RATING-CONT
 13720        END-IF
 13721     END-IF
 13722
 13723     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13724        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13725        CP-EARN-AS-REG-BALLOON
 13726        NEXT SENTENCE
 13727     ELSE
 13728        MOVE '2'                 TO CP-EARNING-METHOD.
 13729
 13730 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13731
 13732     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13733
 13734     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13735        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13736        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13737         NEXT SENTENCE
 13738     ELSE
 13739         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13740
 13741     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13742     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13743     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13744                                     CP-RATING-BENEFIT-AMT.
 13745     IF CP-STATE-STD-ABBRV = 'OR'
 13746         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13747                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 250
* EL050.cbl
 13748     IF PB-COMPANY-ID = 'DCC'
 13749        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13750     END-IF
 13751     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13752     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13753     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13754                                    CP-REMAINING-TERM
 13755                                    CP-LOAN-TERM.
 13756     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13757        ADD +1                   TO CP-ORIGINAL-TERM
 13758                                    CP-REMAINING-TERM
 13759                                    CP-LOAN-TERM.
 13760
 13761     MOVE 'R'                   TO CP-RATE-FILE.
 13762     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13763
 13764     IF CP-ERROR-RATE-NOT-FOUND
 13765         MOVE ER-2641            TO WS-ERROR
 13766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13767         GO TO 3300-CHECK-AH-RATES.
 13768
 13769     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13770     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13771
 13772     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13773         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13774
 13775     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13776                               + PB-I-LF-ALT-BENEFIT-AMT.
 13777
 13778     IF ACCOUNT-LIFE-CHECKED  OR
 13779        PB-POLICY-IS-VOIDED   OR
 13780        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13781        and (not pb-monthly-cert))
 13782        GO TO 3225-CONTINUE.
 13783
 13784     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13785        GO TO 3225-CONTINUE.
 13786
 13787     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13788                             EC-RT-LF-MAX-TOT-BEN
 13789        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13790        MOVE ER-2639       TO WS-ERROR
 13791        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13792
 13793 3225-CONTINUE.
 13794     IF PB-I-LF-ALT-RATE = ZERO
 13795         MOVE ER-2659            TO WS-ERROR
 13796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13797
 13798     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13799        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13800        MOVE ER-2698             TO WS-ERROR
 13801        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13802
 13803 3225-RATING-CONT.
 13804
 13805     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 251
* EL050.cbl
 13806        and (not pb-monthly-cert)
 13807         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13808         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13809         IF (PB-COMPANY-ID = 'DCC')
 13810            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13811            CONTINUE
 13812         ELSE
 13813            MOVE ER-2687         TO WS-ERROR
 13814            PERFORM 9900-ERROR-FORMAT
 13815                                 THRU 9900-EXIT
 13816         END-IF
 13817         GO TO 3290-EDIT-LF-REIN-RATE
 13818     END-IF
 13819
 13820* DMD RATING TEST
 13821     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13822         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13823         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13824         MOVE ER-2687                 TO WS-ERROR
 13825         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13826         GO TO 3290-EDIT-LF-REIN-RATE.
 13827
 13828 3230-CLIENT-MORT-CD-SPECIALS.
 13829
 13830     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13831     SET BIN-TO-GREG          TO TRUE.
 13832*    MOVE ' '                 TO DC-OPTION-CODE.
 13833     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13834     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13835
 13836 C-POS-3230-MORT-CD.
 13837     IF PB-COMPANY-ID = 'POS' AND
 13838        PB-SV-CARRIER = '2'
 13839         NEXT SENTENCE
 13840     ELSE
 13841         GO TO C-POS-3240-MORT-CD.
 13842
 13843     IF PB-SV-GROUPING = '030'
 13844        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13845         MOVE '2350' TO PB-I-MORT-CODE
 13846      ELSE
 13847         MOVE '3300' TO PB-I-MORT-CODE.
 13848
 13849
 13850 C-POS-3240-MORT-CD.
 13851     IF PB-COMPANY-ID = 'POS' AND
 13852        PB-SV-CARRIER = '1'
 13853         NEXT SENTENCE
 13854     ELSE
 13855         GO TO 3230-CONTINUE.
 13856
 13857     IF PB-SV-STATE = '45' OR '47'
 13858        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13859         MOVE '5200' TO PB-I-MORT-CODE
 13860     ELSE
 13861         MOVE '8300' TO PB-I-MORT-CODE.
 13862
 13863 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 252
* EL050.cbl
 13864
 13865     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13866        GO TO 3240-CONTINUE
 13867     END-IF
 13868
 13869     IF PB-CERT-EFF-DT > WS-971231
 13870        GO TO 3240-CONTINUE
 13871     END-IF
 13872
 13873     IF LF-BENEFIT-FOUND AND
 13874        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13875         MOVE 'F250'       TO PB-I-MORT-CODE
 13876     ELSE
 13877         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13878             MOVE '7250'   TO PB-I-MORT-CODE
 13879         ELSE
 13880             MOVE '4251'   TO PB-I-MORT-CODE
 13881         END-IF
 13882     END-IF
 13883
 13884     .
 13885 3240-CONTINUE.
 13886
 13887     IF PB-COMPANY-ID NOT = 'GNL'
 13888         GO TO 3256-CONTINUE.
 13889
 13890     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13891         MOVE 'A300' TO PB-I-MORT-CODE
 13892     ELSE
 13893         MOVE '8350' TO PB-I-MORT-CODE.
 13894
 13895 3256-CONTINUE.
 13896     IF PB-COMPANY-ID NOT = 'ABL'
 13897         GO TO 3260-EDIT-CONTINUE.
 13898
 13899     IF PB-I-LF-TERM GREATER THAN 59
 13900         MOVE 'F550' TO PB-I-MORT-CODE
 13901     ELSE
 13902         MOVE 'E550' TO PB-I-MORT-CODE.
 13903
 13904 3260-EDIT-CONTINUE.
 13905     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13906
 13907 3290-EDIT-LF-REIN-RATE.
 13908     IF LF-REIN-NSP-NOT-USED
 13909         GO TO 3290-RATING-CONT.
 13910
 13911     IF PB-COMPANY-ID = 'DCC'
 13912        GO TO 3290-RATING-CONT.
 13913     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13914     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13915     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13916     MOVE '3'                   TO CP-PROCESS-TYPE.
 13917     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13918
 13919******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13920     IF PB-COMPANY-ID EQUAL 'CDL'
 13921         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 253
* EL050.cbl
 13922            CP-EARN-AS-NET-PAY)
 13923             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13924*            MOVE SPACE          TO DC-OPTION-CODE
 13925             SET BIN-TO-GREG     TO TRUE
 13926             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13927***  Y2K PROJ 7744
 13928             IF DC-GREG-DATE-CYMD GREATER 19931231
 13929                 MOVE '1'        TO CP-EARNING-METHOD.
 13930***  Y2K PROJ 7744
 13931*******
 13932
 13933     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13934     MOVE PB-SV-STATE           TO CP-STATE.
 13935     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13936     MOVE ZERO                  TO CP-DEVIATION-CODE
 13937                                   CP-RATE-DEV-PCT.
 13938     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13939     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13940                                   CP-RATING-BENEFIT-AMT.
 13941
 13942************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13943     IF PB-COMPANY-ID EQUAL 'NCB'
 13944         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13945            CP-EARN-AS-NET-PAY
 13946             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13947                 PB-I-LF-PREMIUM-AMT.
 13948************
 13949
 13950     IF CP-STATE-STD-ABBRV = 'OR'
 13951         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13952                                         PB-I-LF-ALT-BENEFIT-AMT.
 13953     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13954     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13955     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13956     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13957     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13958     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13959     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13960     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13961                                   CP-REMAINING-TERM
 13962                                   CP-LOAN-TERM.
 13963     IF CP-TRUNCATED-LIFE
 13964        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13965
 13966     IF CP-TERM-IS-DAYS
 13967         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13968     ELSE
 13969         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13970
 13971     IF PB-COMPANY-ID = 'DCC'
 13972        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13973     END-IF
 13974     IF PB-COMPANY-ID NOT = 'TIC'
 13975          MOVE ZERO          TO CP-CLASS-CODE.
 13976
 13977     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13978
 13979     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 254
* EL050.cbl
 13980     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13981
 13982     IF CP-ERROR-RATE-NOT-FOUND
 13983        IF PB-I-OB
 13984           MOVE ER-2625      TO WS-ERROR
 13985           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13986           GO TO 3299-EDIT-CONTINUE
 13987        ELSE
 13988           MOVE ER-2643      TO WS-ERROR
 13989           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13990           GO TO 3299-EDIT-CONTINUE.
 13991
 13992     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13993
 13994     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13995     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13996
 13997     IF PB-I-LF-REI-RATE = ZERO
 13998         MOVE ER-2643        TO WS-ERROR
 13999         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14000
 14001 3290-CHECK-ALT-REIN-RATE.
 14002
 14003     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14004        GO TO 3290-RATING-CONT.
 14005
 14006     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14007     MOVE '2'                    TO CP-EARNING-METHOD.
 14008     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14009     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14010     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14011     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14012                                     CP-RATING-BENEFIT-AMT.
 14013     IF CP-STATE-STD-ABBRV = 'OR'
 14014         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14015                                         PB-I-LF-ALT-BENEFIT-AMT.
 14016     IF PB-COMPANY-ID = 'DCC'
 14017        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14018     END-IF
 14019     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14020     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14021     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14022                                    CP-REMAINING-TERM
 14023                                    CP-LOAN-TERM.
 14024     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14025        ADD +1                   TO CP-ORIGINAL-TERM
 14026                                    CP-REMAINING-TERM
 14027                                    CP-LOAN-TERM.
 14028
 14029     MOVE 'R'                   TO CP-RATE-FILE.
 14030     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14031
 14032     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14033
 14034     IF PB-I-LF-ALT-REI-RATE = ZERO
 14035         MOVE ER-2643            TO WS-ERROR
 14036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14037
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 255
* EL050.cbl
 14038 3290-RATING-CONT.
 14039
 14040     IF PB-I-OB
 14041*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14042        GO TO 3300-CHECK-AH-RATES.
 14043
 14044 3299-EDIT-CONTINUE.
 14045
 14046     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14047         NEXT SENTENCE
 14048     ELSE
 14049         MOVE ER-2620           TO WS-ERROR
 14050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14051
 14052 3300-CHECK-AH-RATES.
 14053     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14054         NEXT SENTENCE
 14055     ELSE
 14056         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14057
 14058     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14059        and (not pb-monthly-cert))
 14060                  or
 14061        ((CF-COMPANY-ID = 'DMD') AND
 14062                (NO-DMD-RATING))
 14063         IF (PB-COMPANY-ID = 'DCC')
 14064            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14065            CONTINUE
 14066         ELSE
 14067            MOVE ER-2687         TO WS-ERROR
 14068            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14069         END-IF
 14070         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14071         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14072     END-IF
 14073
 14074     IF PB-I-OB
 14075        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14076
 14077     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14078         MOVE ER-2687             TO WS-ERROR
 14079         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14080         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14081         GO TO 3999-END-EDIT.
 14082
 14083*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14084     if pb-company-id = 'AHL'
 14085        go to 3300-skip-crit-per
 14086     end-if
 14087     if (pb-i-ah-crit-per not = zeros)
 14088        and (ws-ah-special-calc-cd not = 'C')
 14089        MOVE ER-1572             TO WS-ERROR
 14090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14091        go to 3300-skip-crit-per
 14092     END-IF
 14093     if (pb-company-id = 'DCC')
 14094        and (am-dcc-product-code not = spaces)
 14095        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 256
* EL050.cbl
 14096     end-if
 14097     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14098        IF PB-I-AH-CRIT-PER = ZERO
 14099           move ws-ah-max-bens   to pb-i-ah-crit-per
 14100*          MOVE ER-2618       TO WS-ERROR
 14101*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14102*          GO TO 3999-END-EDIT
 14103        END-IF
 14104     END-IF
 14105     if (ws-ah-special-calc-cd = 'C')
 14106        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14107        MOVE ER-1576             TO WS-ERROR
 14108        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14109     end-if
 14110
 14111     .
 14112 3300-skip-crit-per.
 14113     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14114     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14115     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14116     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14117     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14118     MOVE PB-SV-STATE            TO CP-STATE.
 14119     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14120     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14121     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14122*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14123     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14124     MOVE '3'                    TO CP-PROCESS-TYPE.
 14125     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14126     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14127                                    CP-RATING-BENEFIT-AMT.
 14128     IF PB-COMPANY-ID = 'CID'
 14129               OR
 14130        CP-STATE-STD-ABBRV = 'OR'
 14131         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14132                                         PB-I-AH-TERM.
 14133     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14134        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14135           AND (PB-I-POLICY-IS-MONTHLY)
 14136           MOVE PB-I-LF-BENEFIT-AMT
 14137                                 TO CP-NET-BENEFIT-AMT
 14138           move pb-i-ah-premium-amt to cp-original-premium
 14139           add pb-i-lf-premium-amt to cp-original-premium
 14140        END-IF
 14141     END-IF
 14142     MOVE SPACES                 TO CP-BEN-CATEGORY
 14143     IF PB-COMPANY-ID = 'DCC'
 14144        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14145        EVALUATE TRUE
 14146           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14147              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14148              MOVE PB-I-LF-BENEFIT-AMT
 14149                                 TO CP-RATING-BENEFIT-AMT
 14150              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14151           WHEN WS-AH-BEN-CATEGORY = 'G'
 14152              MOVE PB-I-UNPAID-CASH-PRICE
 14153                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 257
* EL050.cbl
 14154           WHEN WS-AH-BEN-CATEGORY = 'D'
 14155              MOVE WS-AH-PMF-COMM
 14156                                 TO CP-DCC-PMF-COMM
 14157              MOVE PB-I-AH-COMMISSION
 14158                                 TO CP-DCC-ACT-COMM
 14159        END-EVALUATE
 14160     END-IF
 14161     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14162     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14163     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14164     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14165     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14166     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14167     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14168                                    CP-REMAINING-TERM
 14169                                    WS-WORK-TERM.
 14170     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14171
 14172     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14173     SET BIN-TO-GREG             TO TRUE.
 14174*    MOVE ' '                    TO DC-OPTION-CODE.
 14175     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14176     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14177
 14178     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14179     IF NOT VALID-SKIP-CODE
 14180         MOVE ER-2683            TO WS-ERROR
 14181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14182         GO TO 3320-RATE-CONTINUE.
 14183
 14184     IF PB-NO-MONTHS-SKIPPED
 14185         GO TO 3320-RATE-CONTINUE.
 14186
 14187     MOVE SPACE TO NUMBER-OF-MONTHS.
 14188
 14189     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14190         MOVE 'S'                TO SK-MO (6).
 14191     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14192         MOVE 'S'                TO SK-MO (7).
 14193     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14194         MOVE 'S'                TO SK-MO (8).
 14195     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14196         MOVE 'S'                TO SK-MO (9).
 14197     IF PB-I-SKIP-CODE = 'A'
 14198         MOVE 'S'                TO SK-MO (10).
 14199
 14200     MOVE 1                      TO SUB2.
 14201     MOVE PB-I-AH-TERM           TO SUB3.
 14202     MOVE WS-MONTH               TO SUB1.
 14203     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14204     GO TO 3320-RATE-CONTINUE.
 14205
 14206 3310-GET-SKIP-MO.
 14207     IF SUB1 = 13
 14208         MOVE 1                  TO SUB1.
 14209
 14210     IF SK-MO (SUB1) = 'S'
 14211         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 258
* EL050.cbl
 14212
 14213     ADD 1 TO SUB2
 14214              SUB1.
 14215
 14216 3320-RATE-CONTINUE.
 14217
 14218     IF WS-WORK-TERM = ZERO
 14219         MOVE 1                  TO WS-WORK-TERM.
 14220
 14221     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14222                                    CP-LOAN-TERM.
 14223
 14224     IF PB-COMPANY-ID EQUAL 'DMD'
 14225         NEXT SENTENCE
 14226     ELSE
 14227         MOVE ZERO               TO PB-I-AH-RATE
 14228                                    PB-I-AH-REI-RATE.
 14229
 14230
 14231     IF PB-COMPANY-ID EQUAL 'CRI'
 14232        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14233
 14234     IF PB-COMPANY-ID = 'CSL'
 14235         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14236         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14237         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14238         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14239
 14240     IF PB-COMPANY-ID = 'DCC'
 14241        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14242           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14243              PB-I-RATE-DEV-PCT-LF
 14244        END-IF
 14245        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14246                                 TO CP-ALTERNATE-BENEFIT
 14247        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14248        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14249        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14250     END-IF
 14251     IF (PB-COMPANY-ID = 'CID')
 14252        AND (WS-LF-EARNINGS-CALC = 'B')
 14253        AND (CP-STATE-STD-ABBRV = 'MN')
 14254        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14255     ELSE
 14256        MOVE ' '                 TO CP-AH-BALLOON-SW
 14257     END-IF
 14258     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14259     MOVE 'R'                   TO CP-RATE-FILE.
 14260     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14261
 14262     IF (CP-ERROR-RATE-NOT-FOUND)
 14263        and (not pb-monthly-cert)
 14264        IF PB-I-OB
 14265           MOVE ER-2624          TO WS-ERROR
 14266           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14267           GO TO 3340-CALCULATE-PREMIUM-AMT
 14268        ELSE
 14269          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 259
* EL050.cbl
 14270              NEXT SENTENCE
 14271          ELSE
 14272           MOVE ER-2642          TO WS-ERROR
 14273           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14274           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14275
 14276     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14277        CP-ERROR-DIV-BY-ZERO
 14278           MOVE ER-3782          TO WS-ERROR
 14279           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14280
 14281     IF PB-COMPANY-ID EQUAL 'CRI'
 14282        IF CP-ERROR-NO-LIMITS-CRI
 14283           IF NOT ACCOUNT-AH-CHECKED
 14284              MOVE ER-2607          TO WS-ERROR
 14285              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14286
 14287     IF ACCOUNT-AH-CHECKED
 14288        NEXT SENTENCE
 14289     ELSE
 14290       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14291          MOVE ER-2640           TO WS-ERROR
 14292          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14293
 14294     IF PB-COMPANY-ID = 'CRI'
 14295         IF WS-ERROR = ER-2640
 14296             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14297     IF ACCOUNT-AH-CHECKED
 14298        CONTINUE
 14299     ELSE
 14300        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14301           AND (CP-R-MAX-ATT-AGE > +0)
 14302           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14303           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14304              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14305              MOVE PB-I-AH-EXPIRE-DT
 14306                                 TO DC-BIN-DATE-2
 14307              MOVE '1'           TO DC-OPTION-CODE
 14308              PERFORM 8500-DATE-CONVERT
 14309                                 THRU 8500-EXIT
 14310              IF NO-CONVERSION-ERROR
 14311                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14312                    MOVE ER-2661       TO WS-ERROR
 14313*                   PERFORM 9900-ERROR-FORMAT
 14314*                                THRU 9900-EXIT
 14315                 END-IF
 14316              END-IF
 14317           ELSE
 14318              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14319              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14320                 MOVE ER-2661    TO WS-ERROR
 14321*                PERFORM 9900-ERROR-FORMAT
 14322*                                THRU 9900-EXIT
 14323              ELSE
 14324                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14325                    MOVE ER-1570 TO WS-ERROR
 14326                    PERFORM 9900-ERROR-FORMAT
 14327                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 260
* EL050.cbl
 14328                 END-IF
 14329              END-IF
 14330           END-IF
 14331           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14332              MOVE PB-I-JOINT-BIRTHDAY
 14333                                    TO DC-BIN-DATE-1
 14334              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14335              MOVE '1'              TO DC-OPTION-CODE
 14336              PERFORM 8500-DATE-CONVERT
 14337                                    THRU 8500-EXIT
 14338              IF NO-CONVERSION-ERROR
 14339                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14340                    MOVE ER-2661       TO WS-ERROR
 14341*                   PERFORM 9900-ERROR-FORMAT
 14342*                                   THRU 9900-EXIT
 14343                 END-IF
 14344              END-IF
 14345           ELSE
 14346              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14347                (PB-I-AH-TERM / 12)
 14348              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14349                 MOVE ER-2661       TO WS-ERROR
 14350*                PERFORM 9900-ERROR-FORMAT
 14351*                                   THRU 9900-EXIT
 14352              ELSE
 14353                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14354                    MOVE ER-1571 TO WS-ERROR
 14355                    PERFORM 9900-ERROR-FORMAT
 14356                                 THRU 9900-EXIT
 14357                 END-IF
 14358              END-IF
 14359           END-IF
 14360           IF WS-ERROR = ER-2661
 14361              PERFORM 9900-ERROR-FORMAT
 14362                                    THRU 9900-EXIT
 14363           END-IF
 14364        END-IF
 14365     END-IF
 14366*    IF ACCOUNT-AH-CHECKED
 14367*       NEXT SENTENCE
 14368*    ELSE
 14369*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14370*          MOVE ER-2661          TO WS-ERROR
 14371*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14372
 14373     IF ACCOUNT-AH-CHECKED
 14374        NEXT SENTENCE
 14375     ELSE
 14376        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14377           MOVE ER-2663          TO WS-ERROR
 14378           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14379
 14380     IF ACCOUNT-AH-CHECKED OR
 14381        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14382         PB-POLICY-IS-VOIDED
 14383        NEXT SENTENCE
 14384     ELSE
 14385        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 261
* EL050.cbl
 14386           MOVE ER-2667            TO WS-ERROR
 14387           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14388
 14389     IF PB-COMPANY-ID = 'CRI'
 14390         IF WS-ERROR = ER-2667
 14391             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14392
 14393     IF ACCOUNT-AH-CHECKED
 14394        NEXT SENTENCE
 14395     ELSE
 14396        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14397           MOVE ER-2678            TO WS-ERROR
 14398           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14399
 14400     IF CP-ERROR-RATE-FILE-NOTOPEN
 14401         GO TO 3990-FILES-NOT-OPEN.
 14402
 14403 3321-CONTINUE.
 14404     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14405     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14406     IF (PB-COMPANY-ID = 'DCC')
 14407        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14408        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14409                                    PB-I-LF-ALT-PREM-CALC
 14410        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14411        IF WS-AH-BEN-CATEGORY = 'G'
 14412           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14413           + PB-I-ADDL-CLP)
 14414           * (1 + WS-TOL-CLP-PCT)
 14415*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14416        ELSE
 14417           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14418           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14419*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14420        END-IF
 14421        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14422                                 TO PB-I-AH-PREM-CALC
 14423        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14424           MOVE ER-8152          TO WS-ERROR
 14425           PERFORM 9900-ERROR-FORMAT
 14426                                 THRU 9900-EXIT
 14427        ELSE
 14428           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14429                 PB-I-ADDL-CLP)
 14430              MOVE ER-8148       TO WS-ERROR
 14431              PERFORM 9900-ERROR-FORMAT
 14432                                 THRU 9900-EXIT
 14433           END-IF
 14434        END-IF
 14435     END-IF
 14436     IF (PB-COMPANY-ID = 'DCC')
 14437        AND (PB-I-POLICY-IS-MONTHLY)
 14438        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14439        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14440        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14441           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14442        END-IF
 14443     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 262
* EL050.cbl
 14444     IF (PB-COMPANY-ID = 'DCC')
 14445        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14446        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14447        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14448        MOVE ER-2786             TO WS-ERROR
 14449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14450     END-IF
 14451     MOVE +0                     TO PB-I-AH-CLP
 14452     IF PB-COMPANY-ID = 'DCC'
 14453        evaluate true
 14454           when WS-AH-BEN-CATEGORY = 'D'
 14455              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14456                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14457           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14458              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14459           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14460              compute ws-cred-union-fees rounded =
 14461                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14462                    pb-i-ah-commission)
 14463              COMPUTE PB-I-AH-CLP =
 14464                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14465        end-evaluate
 14466     END-IF
 14467     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14468
 14469     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14470         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14471
 14472     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14473         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14474
 14475     if (ws-ah-special-calc-cd = 'E')
 14476        and (pb-monthly-cert)
 14477        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14478     end-if
 14479     IF PB-COMPANY-ID = 'CRI'
 14480         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14481            PB-I-PAYMENT-AMOUNT = ZERO
 14482             NEXT SENTENCE
 14483         ELSE
 14484             COMPUTE PB-I-AH-PREM-CALC =
 14485                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14486                 (CP-PREMIUM-RATE / 100)
 14487             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14488                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14489                                             PB-I-RATE-DEV-PCT-AH.
 14490
 14491     IF (PB-I-AH-RATE  = ZERO)
 14492        and (not pb-monthly-cert)
 14493       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14494           NEXT SENTENCE
 14495       ELSE
 14496         MOVE ER-2642            TO WS-ERROR
 14497         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14498
 14499     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14500     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14501     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 263
* EL050.cbl
 14502     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14503     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14504     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14505
 14506     IF (PB-COMPANY-ID = 'DCC')
 14507        AND (WS-AH-BEN-CATEGORY = 'G')
 14508        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14509        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14510        IF CP-DEVIATION-CODE NOT = '000'
 14511           MOVE '000'            TO CP-DEVIATION-CODE
 14512           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14513           IF NO-CP-ERROR
 14514              COMPUTE PB-I-DDF-IU-RATE-UP =
 14515              PB-I-AH-CLP - CP-CALC-PREMIUM
 14516           ELSE
 14517              MOVE ER-3057        TO WS-ERROR
 14518              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14519           END-IF
 14520        END-IF
 14521     END-IF
 14522     .
 14523 3335-EDIT-AH-REIN-NSP-RATE.
 14524     IF PB-COMPANY-ID = 'DCC'
 14525        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14526              compute ws-cred-union-fees rounded =
 14527                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14528                    pb-i-ah-commission)
 14529              COMPUTE PB-I-AH-CLP =
 14530                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14531        end-if
 14532     END-IF
 14533     IF AH-REIN-NSP-NOT-USED
 14534         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14535
 14536     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14537     IF PB-COMPANY-ID = 'DCC'
 14538         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14539     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14540     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14541     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14542     MOVE PB-SV-STATE            TO CP-STATE.
 14543     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14544     MOVE ZERO                   TO CP-DEVIATION-CODE
 14545                                    CP-RATE-DEV-PCT.
 14546*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14547     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14548     MOVE '3'                    TO CP-PROCESS-TYPE.
 14549     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14550     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14551                                    CP-RATING-BENEFIT-AMT.
 14552     IF CP-STATE-STD-ABBRV = 'OR'
 14553         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14554                                         PB-I-AH-TERM.
 14555     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14556     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14557     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14558     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14559     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 264
* EL050.cbl
 14560     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14561                                    CP-REMAINING-TERM
 14562                                    WS-WORK-TERM.
 14563     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14564     IF PB-COMPANY-ID = 'DCC'
 14565        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14566     END-IF
 14567     IF  PB-COMPANY-ID = 'TIC'
 14568         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14569            MOVE ZERO TO CP-CLASS-CODE.
 14570
 14571     IF PB-COMPANY-ID NOT = 'TIC'
 14572          MOVE ZERO          TO CP-CLASS-CODE.
 14573
 14574     MOVE ZERO               TO CP-DEVIATION-CODE.
 14575
 14576     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14577
 14578     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14579
 14580     MOVE 'R'                   TO CP-RATE-FILE.
 14581     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14582
 14583     IF CP-ERROR-RATE-NOT-FOUND
 14584         MOVE ER-2645        TO WS-ERROR
 14585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14586         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14587
 14588     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14589
 14590     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14591     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14592
 14593     IF PB-I-AH-REI-RATE = ZERO
 14594         MOVE ER-2645        TO WS-ERROR
 14595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14596
 14597
 14598 3340-CALCULATE-PREMIUM-AMT.
 14599
 14600     IF PB-COMPANY-ID = 'NCL'
 14601         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14602             WS-AH-SPECIAL-CALC-CD = 'O')
 14603             GO TO 3999-END-EDIT.
 14604
 14605     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14606                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14607                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14608                         OR 'AHL'
 14609         NEXT SENTENCE
 14610     ELSE
 14611         IF WS-STATE-ABBREVIATION = 'CT'
 14612             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14613                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14614                 COMPUTE PB-I-LF-PREM-CALC =
 14615                                     PB-I-LF-PREM-CALC * .90
 14616                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14617                                     PB-I-LF-ALT-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 265
* EL050.cbl
 14618                 COMPUTE PB-I-AH-PREM-CALC =
 14619                                     PB-I-AH-PREM-CALC * .90.
 14620
 14621     IF PB-COMP-LF-PREM
 14622        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14623        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14624
 14625     IF PB-COMP-AH-PREM
 14626        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14627
 14628 3340-CHECK-DCC-TOT-FEES.
 14629     IF (PB-COMPANY-ID = 'DCC')
 14630        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14631        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14632        AND (PB-I-POLICY-IS-MONTHLY)
 14633        CONTINUE
 14634     ELSE
 14635        GO TO 3340-EDIT-LF-AH-TOL
 14636     END-IF
 14637     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14638     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14639     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14640        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14641           PB-I-RATE-DEV-PCT-LF
 14642     END-IF
 14643     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14644        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14645           PB-I-RATE-DEV-PCT-AH
 14646     END-IF
 14647     MOVE 'N'                    TO CP-BEN-CATEGORY
 14648     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14649
 14650     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14651     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14652     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14653     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14654     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14655     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14656     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14657     MOVE '3'                    TO CP-PROCESS-TYPE.
 14658     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14659     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14660
 14661     MOVE PB-SV-STATE            TO CP-STATE.
 14662     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14663     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14664     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14665     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14666     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14667                                    CP-RATING-BENEFIT-AMT.
 14668     IF CP-STATE-STD-ABBRV = 'OR'
 14669         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14670                                         PB-I-LF-ALT-BENEFIT-AMT.
 14671     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14672     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14673     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14674     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14675     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 266
* EL050.cbl
 14676     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14677     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14678     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14679     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14680                                    CP-REMAINING-TERM
 14681                                    CP-LOAN-TERM.
 14682     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14683        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14684           PB-I-LF-PREMIUM-AMT
 14685     end-if
 14686
 14687     IF CP-TRUNCATED-LIFE
 14688        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14689
 14690     IF CP-TERM-IS-DAYS
 14691         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14692     ELSE
 14693         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14694
 14695     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14696     IF CP-SPECIAL-CALC-CD = 'H'
 14697         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14698                                    TO CP-ALTERNATE-BENEFIT
 14699         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14700     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14701     MOVE 'R'                    TO CP-RATE-FILE
 14702     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14703     IF NOT CP-ERROR-RATE-NOT-FOUND
 14704        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14705        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14706           AND (CP-BENEFIT-CD (1:1) = 'S')
 14707           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14708                                    PB-I-LF-PREMIUM-AMT
 14709        END-IF
 14710     ELSE
 14711        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14712     END-IF
 14713     .
 14714 3340-EDIT-LF-AH-TOL.
 14715
 14716***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14717***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14718***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14719***
 14720     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14721         PB-I-AH-PREMIUM-AMT
 14722          GIVING WS-CALC-WORK.
 14723
 14724     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14725        AND WS-CALC-WORK NOT = ZERO
 14726         MOVE ER-2649            TO WS-ERROR
 14727         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14728
 14729     SUBTRACT PB-I-LF-PREM-CALC
 14730             FROM PB-I-LF-PREMIUM-AMT
 14731                 GIVING WS-UNSIGN-WRK1.
 14732
 14733     SUBTRACT PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 267
* EL050.cbl
 14734             FROM PB-I-LF-ALT-PREMIUM-AMT
 14735                 GIVING WS-UNSIGN-WRK4.
 14736
 14737     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14738                                + WS-UNSIGN-WRK4.
 14739
 14740     SUBTRACT PB-I-AH-PREM-CALC
 14741             FROM PB-I-AH-PREMIUM-AMT
 14742                 GIVING WS-UNSIGN-WRK2.
 14743
 14744******************************************************************
 14745*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14746******************************************************************
 14747
 14748     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14749         MOVE ZERO TO WS-UNSIGN-WRK1.
 14750
 14751     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14752         MOVE ZERO TO WS-UNSIGN-WRK2.
 14753
 14754     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14755             GIVING WS-UNSIGN-WRK3.
 14756
 14757 3342-CONTINUE.
 14758
 14759     IF (PB-I-LF-RATE = ZERO  AND
 14760         PB-I-AH-RATE = ZERO)
 14761         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14762            WS-AH-SPECIAL-CALC-CD = 'O'
 14763              NEXT SENTENCE
 14764         ELSE
 14765             GO TO 3345-EDIT-CONTINUE.
 14766
 14767     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14768         NEXT SENTENCE
 14769     ELSE
 14770     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14771        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14772           IF (PB-REISSUED-CERT         OR
 14773               PB-POLICY-IS-DECLINED    OR
 14774               PB-POLICY-IS-VOIDED)
 14775              NEXT SENTENCE
 14776           ELSE
 14777              IF WS-PREM-REJECT-SW = SPACE
 14778                 MOVE ER-2652    TO WS-ERROR
 14779                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14780                 GO TO 3344-CHECK-AH
 14781              ELSE
 14782                 MOVE ER-2650    TO WS-ERROR
 14783                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14784                 GO TO 3344-CHECK-AH.
 14785
 14786***
 14787***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14788***
 14789
 14790     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14791         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 268
* EL050.cbl
 14792            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14793             (1 + WS-TOL-LF-PREM-PCT)
 14794         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14795            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14796             (1 - WS-TOL-LF-PREM-PCT)
 14797     ELSE
 14798         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14799         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14800
 14801***
 14802***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14803***
 14804
 14805     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14806         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14807          WS-TOL-LF-PREM.
 14808
 14809     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14810         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14811          WS-TOL-LF-PREM.
 14812
 14813     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14814        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14815
 14816     IF PB-REISSUED-CERT
 14817        or PB-POLICY-IS-DECLINED
 14818        or PB-POLICY-IS-VOIDED
 14819        continue
 14820     ELSE
 14821        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14822              > WS-TOL-LF-HIGH-PREM-AMT)
 14823           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14824              < WS-TOL-LF-LOW-PREM-AMT))
 14825                      or
 14826           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14827              > WS-TOL-LF-HIGH-PREM-PCT)
 14828           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14829              < WS-TOL-LF-LOW-PREM-PCT))
 14830           IF WS-PREM-REJECT-SW = SPACE
 14831              MOVE ER-2652       TO WS-ERROR
 14832              PERFORM 9900-ERROR-FORMAT
 14833                                 THRU 9900-EXIT
 14834           ELSE
 14835              MOVE ER-2650       TO WS-ERROR
 14836              PERFORM 9900-ERROR-FORMAT
 14837                                 THRU 9900-EXIT
 14838           end-if
 14839        end-if
 14840     end-if
 14841
 14842*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14843*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14844*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14845*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14846
 14847     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14848        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14849                      OR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 269
* EL050.cbl
 14850           ((PB-COMPANY-ID = 'DCC')
 14851           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14852           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14853           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14854        END-IF
 14855     END-IF
 14856
 14857     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14858        IF WS-COMP-MAX-CAP GREATER THAN +0
 14859           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14860              IF (PB-REISSUED-CERT         OR
 14861                  PB-POLICY-IS-DECLINED    OR
 14862                  PB-POLICY-IS-VOIDED)
 14863                 NEXT SENTENCE
 14864              ELSE
 14865                  MOVE ER-2646   TO  WS-ERROR
 14866                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14867
 14868 3344-CVL-TOLERANCE-CHECK.
 14869
 14870      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14871          GO TO 3344-CHECK-AH.
 14872
 14873      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14874          GO TO 3344-CHECK-AH.
 14875
 14876      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14877                                     WS-UNSIGN-WRK6.
 14878
 14879      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14880          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14881                                 + PB-I-LF-PREMIUM-AMT
 14882                                 - PB-I-LF-PREM-CALC.
 14883
 14884      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14885          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14886                                 + PB-I-LF-ALT-PREMIUM-AMT
 14887                                 - PB-I-LF-ALT-PREM-CALC.
 14888
 14889      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14890          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14891              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14892                 MOVE ER-2652    TO  WS-ERROR
 14893                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14894              ELSE
 14895                 MOVE ER-2650    TO  WS-ERROR
 14896                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14897
 14898      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14899          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14900              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14901                 MOVE ER-2652    TO  WS-ERROR
 14902                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14903              ELSE
 14904                 MOVE ER-2650    TO  WS-ERROR
 14905                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14906
 14907 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 270
* EL050.cbl
 14908
 14909****************************************************************
 14910***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14911***
 14912
 14913     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14914         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14915             (1 + WS-TOL-AH-PREM-PCT)
 14916         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14917             (1 - WS-TOL-AH-PREM-PCT)
 14918     ELSE
 14919         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14920         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14921
 14922***
 14923***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14924***
 14925
 14926     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14927         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14928
 14929     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14930         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14931
 14932     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14933        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14934
 14935     IF (PB-REISSUED-CERT)
 14936        OR (PB-POLICY-IS-DECLINED)
 14937        OR (PB-POLICY-IS-VOIDED)
 14938        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14939        CONTINUE
 14940     ELSE
 14941        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14942              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14943                          or
 14944           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14945              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14946           IF WS-PREM-REJECT-SW = SPACE
 14947              MOVE ER-3052       TO WS-ERROR
 14948              PERFORM 9900-ERROR-FORMAT
 14949                                 THRU 9900-EXIT
 14950           ELSE
 14951              MOVE ER-3050       TO WS-ERROR
 14952              PERFORM 9900-ERROR-FORMAT
 14953                                 THRU 9900-EXIT
 14954           END-IF
 14955        END-IF
 14956     END-IF
 14957     if (pb-company-id = 'DCC')
 14958        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14959        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14960        and (pb-i-policy-is-monthly)
 14961        compute ws-tol-ah-high-prem-amt =
 14962           pb-i-tot-fees-calc + ws-tol-ah-prem
 14963        compute ws-tol-ah-low-prem-amt =
 14964           pb-i-tot-fees-calc - ws-tol-ah-prem
 14965        if ws-tol-ah-prem-pct > zeros
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 271
* EL050.cbl
 14966           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14967              (1 + ws-tol-ah-prem-pct)
 14968           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14969              (1 - ws-tol-ah-prem-pct)
 14970        else
 14971           move +9999999.99      to ws-tol-ah-high-prem-pct
 14972           move +0               to ws-tol-ah-low-prem-pct
 14973        end-if
 14974        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14975            or
 14976           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14977                          or
 14978           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14979           or
 14980           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14981            move er-3049         to ws-error
 14982           perform 9900-error-format
 14983                                 thru 9900-exit
 14984
 14985        end-if
 14986     end-if
 14987     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14988         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14989             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14990             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14991
 14992     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14993        IF WS-COMP-MAX-CAP GREATER THAN +0
 14994           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14995              IF (PB-REISSUED-CERT         OR
 14996                  PB-POLICY-IS-DECLINED    OR
 14997                  PB-POLICY-IS-VOIDED)
 14998                 NEXT SENTENCE
 14999              ELSE
 15000                  MOVE ER-2646   TO  WS-ERROR
 15001                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15002
 15003     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15004        (WS-COMP-MAX-CAP EQUAL +0)
 15005           GO TO 3345-EDIT-CONTINUE.
 15006
 15007     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15008        GREATER THAN WS-COMP-MAX-CAP
 15009           MOVE ER-2646          TO  WS-ERROR
 15010           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15011
 15012 3345-EDIT-CONTINUE.
 15013
 15014*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15015*       IF PB-ENTRY-BATCH   NUMERIC
 15016*          IF PB-ISSUE
 15017*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15018*          ELSE
 15019*              IF PB-CANCELLATION
 15020*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15021
 15022*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15023*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 272
* EL050.cbl
 15024*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15025*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15026*        ELSE
 15027*            MOVE  ER-1909            TO  WS-ERROR
 15028*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15029
 15030     IF PB-I-POLICY-ACCEPTED
 15031        IF PB-POLICY-IS-DECLINED  OR
 15032           PB-REISSUED-CERT  OR
 15033           PB-REIN-ONLY-CERT  OR
 15034           PB-POLICY-IS-VOIDED
 15035            MOVE  ER-1891         TO  WS-ERROR
 15036            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15037        ELSE
 15038            MOVE SPACE            TO  PB-BATCH-ENTRY
 15039            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15040
 15041     IF PB-I-POLICY-DECLINED
 15042        IF PB-REISSUED-CERT  OR
 15043           PB-REIN-ONLY-CERT  OR
 15044           PB-POLICY-IS-VOIDED
 15045            MOVE  ER-1906         TO  WS-ERROR
 15046            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15047        ELSE
 15048            MOVE  'D'             TO  PB-BATCH-ENTRY
 15049                                      PB-I-ENTRY-STATUS.
 15050
 15051     IF PB-I-NEEDS-UNDERWRITING
 15052        IF PB-POLICY-IS-DECLINED OR
 15053           PB-REISSUED-CERT  OR
 15054           PB-REIN-ONLY-CERT  OR
 15055           PB-POLICY-IS-VOIDED
 15056            MOVE  ER-1907         TO  WS-ERROR
 15057            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15058        ELSE
 15059            MOVE 'U'              TO  PB-BATCH-ENTRY
 15060                                      PB-I-ENTRY-STATUS.
 15061
 15062     IF PB-NEEDS-UNDERWRITING
 15063        MOVE  ER-1901             TO  WS-ERROR
 15064        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15065     IF PB-COMPANY-ID = 'DCC'
 15066        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15067        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15068        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15069           AND (NOT WS-LF-CASH))
 15070                           OR
 15071           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15072           AND (NOT WS-AH-CASH)))
 15073                       AND
 15074           (PB-I-ENTRY-STATUS NOT = '5')
 15075           MOVE 'M'              TO PB-BATCH-ENTRY
 15076                                    PB-I-ENTRY-STATUS
 15077        END-IF
 15078     END-IF
 15079     move pending-business       to ws-passed-erpndb
 15080     move ' '                    to ws-exceed-limit-yn
 15081     perform 7780-call-agg       thru 7780-exit
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 273
* EL050.cbl
 15082     display ' el050 exceed ' ws-exceed-limit-yn
 15083     if ws-exceed-limit-yn = 'Y'
 15084        MOVE  ER-9813            TO WS-ERROR
 15085        PERFORM  9900-ERROR-FORMAT
 15086                                 THRU 9900-EXIT
 15087     end-if
 15088     IF  PB-COMPANY-ID NOT = 'NCL'
 15089         GO TO 3999-END-EDIT.
 15090
 15091     IF PB-REISSUED-CERT  OR
 15092        PB-POLICY-IS-DECLINED  OR
 15093        PB-POLICY-IS-VOIDED  OR
 15094        PB-I-OB
 15095         GO TO 3999-END-EDIT.
 15096
 15097     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15098         MOVE  ER-2644            TO  WS-ERROR
 15099         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15100         GO TO 3999-END-EDIT.
 15101
 15102     MOVE 'N'                     TO  FORM-MASTER-SW.
 15103     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15104
 15105     IF NOT FORM-MASTER-FOUND
 15106         GO TO 3999-END-EDIT.
 15107
 15108     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15109                                      FORM-MASTER-AH-SW.
 15110
 15111     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15112         MOVE  +1                 TO SUB6
 15113         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15114
 15115     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15116         MOVE  +1                 TO SUB6
 15117         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15118
 15119     IF LF-FORM-MASTER-FOUND  OR
 15120        AH-FORM-MASTER-FOUND
 15121         GO TO 3360-CHECK-FORM-LIMITS
 15122     ELSE
 15123         GO TO 3999-END-EDIT.
 15124
 15125******************************************************************
 15126*                  3350-GET-ERFORM                               *
 15127*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15128*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15129******************************************************************
 15130
 15131 3350-GET-ERFORM.
 15132
 15133     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15134         GO TO  3350-ERFORM-GETMAIN.
 15135
 15136     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15137     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15138     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15139     MOVE 'Y'                     TO FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 274
* EL050.cbl
 15140
 15141     IF PB-CANCELLATION
 15142         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15143            PB-SV-STATE          EQUAL   FO-STATE       AND
 15144            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15145              GO TO 3350-EXIT
 15146         ELSE
 15147             NEXT SENTENCE
 15148     ELSE
 15149         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15150            PB-SV-STATE          EQUAL   FO-STATE       AND
 15151            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15152              GO TO 3350-EXIT.
 15153
 15154 3350-ERFORM-GETMAIN.
 15155
 15156     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15157     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15158
 15159 3350-ERFORM-READ.
 15160
 15161     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15162     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15163     IF PB-CANCELLATION
 15164         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15165     ELSE
 15166         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15167     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15168
 15169     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15170
 15171     IF FORM-MASTER-FOUND
 15172       IF PB-CANCELLATION
 15173          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15174             PB-SV-STATE          EQUAL   FO-STATE       AND
 15175             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15176              GO  TO 3350-EXIT
 15177          ELSE
 15178              NEXT SENTENCE
 15179       ELSE
 15180          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15181             PB-SV-STATE          EQUAL   FO-STATE       AND
 15182             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15183              GO  TO 3350-EXIT.
 15184
 15185     MOVE  'N'                    TO  FORM-MASTER-SW.
 15186     MOVE  ER-1895                TO  WS-ERROR.
 15187     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15188
 15189 3350-EXIT.
 15190      EXIT.
 15191
 15192******************************************************************
 15193*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15194*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15195*   VALID FOR THE POLICY FORM USED.                              *
 15196******************************************************************
 15197
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 275
* EL050.cbl
 15198 3355-EDIT-FORM-LF-BENEFITS.
 15199
 15200     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15201        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15202         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15203         GO TO   3355-EXIT.
 15204
 15205     IF  SUB6    LESS THAN   +40
 15206         ADD  +1      TO  SUB6
 15207         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15208
 15209     MOVE  ER-1896         TO  WS-ERROR.
 15210     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15211
 15212 3355-EXIT.
 15213      EXIT.
 15214
 15215******************************************************************
 15216*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15217*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15218*   VALID FOR THE POLICY FORM USED.                              *
 15219******************************************************************
 15220
 15221 3356-EDIT-FORM-AH-BENEFITS.
 15222
 15223     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15224        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15225         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15226         GO TO  3356-EXIT.
 15227
 15228      IF  SUB6    LESS THAN     +40
 15229          ADD  +1      TO  SUB6
 15230          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15231
 15232     MOVE  ER-1897         TO  WS-ERROR.
 15233     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15234
 15235 3356-EXIT.
 15236      EXIT.
 15237
 15238******************************************************************
 15239*                  3357-BENEFIT-SEARCH                           *
 15240*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15241*   CANCELLATIONS ONLY.                                          *
 15242******************************************************************
 15243 3357-BENEFIT-SEARCH.
 15244     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15245         MOVE +1                          TO SUB6
 15246         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15247
 15248     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15249         MOVE +1                          TO SUB6
 15250         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15251
 15252 3357-EXIT.
 15253     EXIT.
 15254
 15255******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 276
* EL050.cbl
 15256*                  3358-BENEFIT-LIFE-SEARCH                      *
 15257*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15258*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15259*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15260******************************************************************
 15261 3358-BENEFIT-LIFE-SEARCH.
 15262     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15263       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15264         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15265           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15266              IF FO-PLAN-REFUND-METHOD (SUB6)
 15267                     IS GREATER THAN SPACES
 15268                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15269                                          WS-LF-REFUND-CALC
 15270                 GO TO 3358-EXIT.
 15271
 15272     IF SUB6 LESS THAN +40
 15273         ADD +1                 TO SUB6
 15274         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15275
 15276 3358-EXIT.
 15277     EXIT.
 15278******************************************************************
 15279*                  3359-BENEFIT-AH-SEARCH                        *
 15280*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15281*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15282*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15283******************************************************************
 15284 3359-BENEFIT-AH-SEARCH.
 15285     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15286       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15287         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15288           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15289              IF FO-PLAN-REFUND-METHOD (SUB6)
 15290                      IS GREATER THAN SPACES
 15291                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15292                                          WS-AH-REFUND-CALC
 15293                 GO TO 3359-EXIT.
 15294
 15295     IF SUB6 LESS THAN +40
 15296         ADD +1                 TO SUB6
 15297         GO TO 3359-BENEFIT-AH-SEARCH.
 15298
 15299 3359-EXIT.
 15300     EXIT.
 15301
 15302******************************************************************
 15303*                  3360-CHECK-FORM-LIMITS                        *
 15304*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15305*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15306******************************************************************
 15307
 15308 3360-CHECK-FORM-LIMITS.
 15309
 15310     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15311         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15312
 15313     IF NOT LF-FORM-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 277
* EL050.cbl
 15314         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15315
 15316 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15317
 15318     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15319       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15320        WS-LF-JOINT-INDICATOR = 'J'  AND
 15321        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15322         IF PB-COMPANY-ID = 'NCL'
 15323            MOVE  ER-1911          TO  WS-ERROR
 15324            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15325         ELSE
 15326            MOVE  ER-1892          TO  WS-ERROR
 15327            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15328
 15329 3360-CHECK-FORM-LF-ATT-AGE.
 15330
 15331     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15332
 15333     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15334         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15335         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15336            IF PB-COMPANY-ID = 'NCL'
 15337                MOVE  ER-1913      TO  WS-ERROR
 15338                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15339            ELSE
 15340                MOVE  ER-1894      TO  WS-ERROR
 15341                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15342
 15343 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15344
 15345     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15346         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15347         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15348            IF PB-COMPANY-ID = 'NCL'
 15349                MOVE  ER-1914      TO  WS-ERROR
 15350                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15351            ELSE
 15352                MOVE  ER-1899      TO  WS-ERROR
 15353                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15354
 15355 3360-CHECK-FORM-LF-TERM-BAMT.
 15356
 15357     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15358         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15359         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15360           IF  PB-COMPANY-ID = 'NCL'
 15361               MOVE  ER-1916       TO  WS-ERROR
 15362               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15363           ELSE
 15364               MOVE  ER-1902       TO  WS-ERROR
 15365               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15366
 15367     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15368                                    PB-I-LF-ALT-BENEFIT-AMT.
 15369
 15370     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15371         FO-MAX-LF-AMT   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 278
* EL050.cbl
 15372         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15373             IF  PB-COMPANY-ID = 'NCL'
 15374                 MOVE  ER-1918     TO  WS-ERROR
 15375                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15376             ELSE
 15377                 MOVE  ER-1904     TO  WS-ERROR
 15378                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15379
 15380******************************************************************
 15381*                  3360-CHECK-FORM-AH-LIMITS                     *
 15382*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15383*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15384******************************************************************
 15385
 15386 3360-CHECK-FORM-AH-LIMITS.
 15387
 15388     IF NOT AH-FORM-MASTER-FOUND
 15389         GO TO 3999-END-EDIT.
 15390
 15391 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15392
 15393     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15394       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15395        WS-AH-JOINT-INDICATOR = 'J'  AND
 15396        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15397         IF PB-COMPANY-ID = 'NCL'
 15398            MOVE  ER-1912          TO  WS-ERROR
 15399            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15400         ELSE
 15401            MOVE  ER-1893          TO  WS-ERROR
 15402            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15403
 15404 3360-CHECK-FORM-AH-ATT-AGE.
 15405
 15406     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15407
 15408     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15409         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15410         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15411            IF PB-COMPANY-ID = 'NCL'
 15412                MOVE  ER-1913      TO  WS-ERROR
 15413                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15414            ELSE
 15415                MOVE  ER-1894      TO  WS-ERROR
 15416                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15417
 15418 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15419
 15420     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15421         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15422         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15423            IF PB-COMPANY-ID = 'NCL'
 15424                MOVE  ER-1915      TO  WS-ERROR
 15425                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15426            ELSE
 15427                MOVE  ER-1900      TO  WS-ERROR
 15428                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15429
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 279
* EL050.cbl
 15430 3360-CHECK-FORM-AH-TERM-BAMT.
 15431
 15432     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15433         FO-AH-MAX-TERM    GREATER THAN  +0
 15434         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15435             IF  PB-COMPANY-ID = 'NCL'
 15436                 MOVE  ER-1917     TO  WS-ERROR
 15437                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15438             ELSE
 15439                  MOVE  ER-1903    TO  WS-ERROR
 15440                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15441
 15442     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15443         FO-MAX-AH-AMT    GREATER THAN  +0
 15444         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15445             IF  PB-COMPANY-ID = 'NCL'
 15446                 MOVE  ER-1919     TO  WS-ERROR
 15447                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15448             ELSE
 15449                 MOVE  ER-1905     TO  WS-ERROR
 15450                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15451
 15452     GO TO 3999-END-EDIT.
 15453
 15454******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 280
* EL050.cbl
 15456 3400-edit-vin.
 15457
 15458     MOVE PB-I-VIN               TO WS-WORK-VIN
 15459     MOVE +8                     TO V2
 15460     MOVE ZEROS                  TO WS-VIN-TOTAL
 15461     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15462      (V1 > 17)
 15463        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15464           MOVE ER-3825          TO WS-ERROR
 15465           PERFORM 9900-ERROR-FORMAT
 15466                                 THRU 9900-EXIT
 15467        ELSE
 15468           IF V1 = 8
 15469              MOVE 10            TO V2
 15470           END-IF
 15471           IF V1 = 9
 15472              MOVE 0             TO V2
 15473           END-IF
 15474           IF V1 = 10
 15475              MOVE 9             TO V2
 15476           END-IF
 15477           IF WS-WORK-VIN (V1:1) NUMERIC
 15478              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15479               + (WS-WORK-VIN-N (V1) * V2)
 15480           ELSE
 15481              MOVE WS-WORK-VIN (V1:1)
 15482                            TO WS-HEX-BYTE
 15483              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15484              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15485               + (WS-NUM (V3) * V2)
 15486           END-IF
 15487           COMPUTE V2 = V2 - 1
 15488        END-IF
 15489     END-PERFORM
 15490     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15491     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15492        REMAINDER WS-VIN-REMAINDER
 15493     IF ((WS-WORK-VIN (9:1) = 'X')
 15494        AND (WS-VIN-REMAINDER = 10))
 15495                OR
 15496        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15497        CONTINUE
 15498     ELSE
 15499        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15500           MOVE ER-3826          TO WS-ERROR
 15501           PERFORM 9900-ERROR-FORMAT
 15502                                 THRU 9900-EXIT
 15503        ELSE
 15504           MOVE ER-3827          TO WS-ERROR
 15505           PERFORM 9900-ERROR-FORMAT
 15506                                 THRU 9900-EXIT
 15507        END-IF
 15508     END-IF
 15509
 15510     .
 15511 3400-exit.
 15512     exit.
 15513******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 281
* EL050.cbl
 15514*                  E D I T   C A N C E L                         *
 15515******************************************************************
 15516
 15517 3700-EDIT-CANCEL.
 15518     IF PB-COMPANY-ID = 'DMD'
 15519         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15520                                         WS-RES-MUNI-TAX
 15521                                         PB-CI-STATE-TAX
 15522                                         PB-CI-MUNI-TAX
 15523         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15524
 15525*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15526*       IF PB-ENTRY-BATCH  NUMERIC
 15527*          IF PB-CANCELLATION
 15528*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15529*          ELSE
 15530*             IF PB-ISSUE
 15531*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15532
 15533     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15534        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15535     END-IF
 15536*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15537*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15538
 15539     IF CM-ENTRY-STATUS = 'V'
 15540        MOVE ER-2780             TO WS-ERROR
 15541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15542        GO TO 3999-END-EDIT.
 15543
 15544     IF CM-ENTRY-STATUS = 'D'
 15545        MOVE ER-2781             TO WS-ERROR
 15546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15547        GO TO 3999-END-EDIT.
 15548
 15549     IF CM-ENTRY-STATUS = 'U'
 15550        MOVE ER-2782             TO WS-ERROR
 15551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15552
 15553***************************************************************
 15554*                                                             *
 15555*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15556*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15557*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15558*   OF ANOTHER COVERAGE.                                      *
 15559*                                                             *
 15560***************************************************************
 15561
 15562     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15563                                    PB-C-AH-CANCEL-VOID-SW.
 15564
 15565     IF PB-C-LF-CANCEL-AMT = ZERO
 15566        NEXT SENTENCE
 15567     ELSE
 15568        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15569           AND
 15570           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15571               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 282
* EL050.cbl
 15572               MOVE ER-2745           TO WS-ERROR
 15573               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15574
 15575     IF PB-C-AH-CANCEL-AMT = ZERO
 15576        NEXT SENTENCE
 15577     ELSE
 15578        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15579           AND
 15580           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15581               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15582               MOVE ER-2745           TO WS-ERROR
 15583               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15584
 15585     IF WS-LF-EARNINGS-CALC = '4'
 15586        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15587
 15588     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15589     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15590     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15591     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15592     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15593     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15594
 15595     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15596                                      PB-C-AH-REF-CALC.
 15597     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15598
 15599******************************************************************
 15600*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15601*             TO VALIDATE COVERAGE.                              *
 15602******************************************************************
 15603
 15604     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15605        PB-C-LF-CANCEL-AMT = ZEROS
 15606          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15607      ELSE
 15608          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15609
 15610     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15611        PB-C-AH-CANCEL-AMT = ZEROS
 15612          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15613      ELSE
 15614          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15615
 15616     EVALUATE TRUE
 15617         WHEN PB-CANCEL-FORCE             OR
 15618              PB-CANCEL-DATE-FORCED       OR
 15619              PB-FORCE-OFF
 15620                  IF PB-COMPANY-ID = 'ACE'
 15621                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15622                  END-IF
 15623         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15624               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15625              (PB-COMPANY-ID = 'ACE' )
 15626                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15627         WHEN OTHER
 15628              IF PB-COMPANY-ID = 'ACE'
 15629                 MOVE ER-2794              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 283
* EL050.cbl
 15630              ELSE
 15631                 MOVE ER-2749              TO WS-ERROR
 15632              END-IF
 15633              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15634     END-EVALUATE.
 15635
 15636
 15637*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15638*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15639*            MOVE  ER-1909            TO  WS-ERROR
 15640*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15641*        ELSE
 15642*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15643
 15644     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15645     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15646        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15647     ELSE
 15648        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15649     END-IF
 15650     .
 15651 3705-EDIT-CANCEL-DT.
 15652
 15653     IF LF-COVERAGE-CANCELLED
 15654        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15655         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15656         MOVE WS-CURRENT-MONTH-END
 15657                                 TO DC-BIN-DATE-2
 15658         SET ELAPSED-BETWEEN-BIN TO TRUE
 15659*        MOVE 1                  TO DC-OPTION-CODE
 15660         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15661         IF DATE-CONVERSION-ERROR
 15662            NEXT SENTENCE
 15663          ELSE
 15664             IF DC-ELAPSED-DAYS GREATER +180
 15665                IF PB-CANCEL-DATE-FORCED  OR
 15666                   PB-CANCEL-DATE-FORCED-NO-FEE
 15667                      MOVE ER-2751  TO WS-ERROR
 15668                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15669                 ELSE
 15670                   MOVE ER-2752  TO WS-ERROR
 15671                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15672
 15673     IF AH-COVERAGE-CANCELLED
 15674        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15675         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15676         MOVE WS-CURRENT-MONTH-END
 15677                                 TO DC-BIN-DATE-2
 15678         SET ELAPSED-BETWEEN-BIN TO TRUE
 15679*        MOVE 1                  TO DC-OPTION-CODE
 15680         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15681         IF DATE-CONVERSION-ERROR
 15682            NEXT SENTENCE
 15683          ELSE
 15684             IF DC-ELAPSED-DAYS GREATER +180
 15685                IF PB-CANCEL-DATE-FORCED OR
 15686                   PB-CANCEL-DATE-FORCED-NO-FEE
 15687                      MOVE ER-2751  TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 284
* EL050.cbl
 15688                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15689                 ELSE
 15690                   MOVE ER-2752  TO WS-ERROR
 15691                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15692
 15693     IF WS-ERROR = ER-2752
 15694        AND (PB-COMPANY-ID = 'ABL'
 15695         OR  PB-COMPANY-ID = 'FGL'
 15696         OR  PB-COMPANY-ID = 'IST'
 15697         OR  PB-COMPANY-ID = 'JHL'
 15698         OR  PB-COMPANY-ID = 'LAP'
 15699         OR  PB-COMPANY-ID = 'LBL'
 15700         OR  PB-COMPANY-ID = 'NCB'
 15701         OR  PB-COMPANY-ID = 'NLI'
 15702         OR  PB-COMPANY-ID = 'OFI'
 15703         OR  PB-COMPANY-ID = 'PLI'
 15704         OR  PB-COMPANY-ID = 'TAO'
 15705         OR  PB-COMPANY-ID = 'TIC'
 15706         OR  PB-COMPANY-ID = 'HER'
 15707         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15708         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15709            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15710            MOVE ER-2762     TO WS-ERROR
 15711            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15712
 15713     IF LF-COVERAGE-CANCELLED
 15714        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15715        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15716             MOVE ER-2733         TO WS-ERROR
 15717             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15718
 15719     IF AH-COVERAGE-CANCELLED
 15720        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15721        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15722              MOVE ER-2733        TO WS-ERROR
 15723              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15724
 15725     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15726        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15727        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15728           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15729            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15730              IF PB-COMPANY-ID NOT = 'LAP'
 15731               MOVE ER-2704            TO WS-ERROR
 15732               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15733
 15734     IF CERT-WAS-NOT-FOUND
 15735         GO TO 3999-END-EDIT.
 15736
 15737     IF PB-COMPANY-ID EQUAL 'CDC'
 15738        IF LF-COVERAGE-CANCELLED
 15739           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15740            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15741            MOVE PB-C-LF-CANCEL-DT
 15742                                 TO DC-BIN-DATE-2
 15743            SET ELAPSED-BETWEEN-BIN TO TRUE
 15744*           MOVE 1               TO DC-OPTION-CODE
 15745            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 285
* EL050.cbl
 15746            IF DATE-CONVERSION-ERROR
 15747               NEXT SENTENCE
 15748             ELSE
 15749                IF DC-ELAPSED-DAYS GREATER +60
 15750                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15751
 15752     IF PB-COMPANY-ID EQUAL 'CDC'
 15753        IF AH-COVERAGE-CANCELLED
 15754           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15755            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15756            MOVE PB-C-AH-CANCEL-DT
 15757                                 TO DC-BIN-DATE-2
 15758            MOVE +0              TO DC-ELAPSED-DAYS
 15759                                    DC-ELAPSED-MONTHS
 15760            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15761*           MOVE 1               TO DC-OPTION-CODE
 15762            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15763            IF DATE-CONVERSION-ERROR
 15764               NEXT SENTENCE
 15765             ELSE
 15766                IF DC-ELAPSED-DAYS GREATER +60
 15767                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15768
 15769     MOVE +0                     TO DC-ELAPSED-DAYS
 15770                                    DC-ELAPSED-MONTHS.
 15771
 15772     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15773        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15774          MOVE 'Z'                TO PB-CI-OB-FLAG
 15775          MOVE ER-2767            TO WS-ERROR
 15776          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15777          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15778          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15779          GO TO 3775-OVER-REF-CHK
 15780        ELSE
 15781          MOVE ZEROS              TO PB-CI-LIVES
 15782                                     PB-C-LIVES
 15783          IF PB-CI-OB-FLAG NOT = 'B'
 15784             MOVE SPACE           TO PB-CI-OB-FLAG.
 15785
 15786     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15787         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15788     ELSE
 15789         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15790
 15791     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15792        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15793            MOVE ER-2760         TO WS-ERROR
 15794            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15795
 15796     IF LF-COVERAGE-CANCELLED
 15797        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15798         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15799            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15800               MOVE ER-2774       TO WS-ERROR
 15801               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15802
 15803     IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 286
* EL050.cbl
 15804        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15805         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15806            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15807               MOVE ER-2775       TO WS-ERROR
 15808               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15809
 15810     IF LF-COVERAGE-CANCELLED
 15811        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15812         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15813            MOVE ER-2776         TO WS-ERROR
 15814            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15815
 15816     IF AH-COVERAGE-CANCELLED
 15817        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15818         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15819            MOVE ER-2777         TO WS-ERROR
 15820            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15821
 15822     IF LF-COVERAGE-CANCELLED
 15823        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15824        if pb-ci-lf-expire-dt = low-values or spaces
 15825           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15826           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15827           MOVE PB-CI-EXTENTION-DAYS
 15828                                 TO DC-ELAPSED-DAYS
 15829           SET BIN-PLUS-ELAPSED  TO TRUE
 15830           PERFORM 8500-DATE-CONVERT
 15831                                 THRU 8500-EXIT
 15832           IF DATE-CONVERSION-ERROR
 15833              move low-values    to dc-bin-date-2
 15834           end-if
 15835        else
 15836           move pb-ci-lf-expire-dt
 15837                                 to dc-bin-date-2
 15838        end-if
 15839        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15840           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15841                             OR  'FIA'
 15842              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15843           ELSE
 15844              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15845              MOVE ER-2731       TO WS-ERROR
 15846              PERFORM 9900-ERROR-FORMAT
 15847                                 THRU 9900-EXIT
 15848           end-if
 15849        end-if
 15850     end-if
 15851*    IF LF-COVERAGE-CANCELLED
 15852*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15853*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15854*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15855*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15856*        SET BIN-PLUS-ELAPSED      TO TRUE
 15857*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15858*        IF DATE-CONVERSION-ERROR
 15859*           NEXT SENTENCE
 15860*         ELSE
 15861*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 287
* EL050.cbl
 15862*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15863*                            OR  'FIA'
 15864*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15865*              ELSE
 15866*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15867*               MOVE ER-2731       TO WS-ERROR
 15868*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15869     .
 15870 3705-EDIT-AH-CANCEL-DT.
 15871     IF AH-COVERAGE-CANCELLED
 15872        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15873        if pb-ci-AH-expire-dt = low-values or spaces
 15874           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15875           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15876           MOVE PB-CI-EXTENTION-DAYS
 15877                                 TO DC-ELAPSED-DAYS
 15878           SET BIN-PLUS-ELAPSED  TO TRUE
 15879           PERFORM 8500-DATE-CONVERT
 15880                                 THRU 8500-EXIT
 15881           IF DATE-CONVERSION-ERROR
 15882              move low-values    to dc-bin-date-2
 15883           end-if
 15884        else
 15885           move pb-ci-ah-expire-dt
 15886                                 to dc-bin-date-2
 15887        end-if
 15888        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15889           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15890                             OR  'FIA'
 15891              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15892           ELSE
 15893              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15894              MOVE ER-2771       TO WS-ERROR
 15895              PERFORM 9900-ERROR-FORMAT
 15896                                 THRU 9900-EXIT
 15897           end-if
 15898        end-if
 15899     end-if
 15900*    IF AH-COVERAGE-CANCELLED
 15901*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15902*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15903*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15904*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15905**       MOVE 6                    TO DC-OPTION-CODE
 15906*        SET BIN-PLUS-ELAPSED      TO TRUE
 15907*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15908*        IF DATE-CONVERSION-ERROR
 15909*           NEXT SENTENCE
 15910*         ELSE
 15911*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15912*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15913*                             OR 'FIA'
 15914*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15915*             ELSE
 15916*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15917*              MOVE ER-2771       TO WS-ERROR
 15918*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15919     .
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 288
* EL050.cbl
 15920 3705-EDIT-CONTINUED.
 15921
 15922*    IF LF-COVERAGE-CANCELLED
 15923*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15924*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15925*            MOVE ER-2727         TO WS-ERROR
 15926*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15927*
 15928*    IF AH-COVERAGE-CANCELLED
 15929*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15930*        IF PB-COMPANY-ID = 'ACE'
 15931*           MOVE ER-2727        TO WS-ERROR
 15932*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15933*        ELSE
 15934*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15935*              MOVE ER-2727     TO WS-ERROR
 15936*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15937
 15938     IF PB-COMPANY-ID = 'ACE'
 15939       IF AH-COVERAGE-CANCELLED
 15940         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15941           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15942              MOVE ER-2732      TO WS-ERROR
 15943              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15944
 15945     IF PB-COMPANY-ID      EQUAL   'HER'
 15946        IF WS-ERROR        EQUAL   ER-2727
 15947            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15948            MOVE  ER-2725          TO  WS-ERROR
 15949            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15950
 15951     IF PB-C-CLAIM-CREATED-CANCEL
 15952            MOVE ER-2748         TO WS-ERROR
 15953            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15954
 15955     IF PB-C-LAST-NAME NOT = SPACES
 15956         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15957            MOVE ER-2747         TO WS-ERROR
 15958            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15959
 15960 3710-EDIT-LUMP-SUM-PRIOR.
 15961
 15962     IF AH-COVERAGE-CANCELLED
 15963         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15964             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15965                MOVE ER-2735    TO WS-ERROR
 15966                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15967
 15968     IF LF-COVERAGE-CANCELLED
 15969         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15970             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15971                MOVE ER-2735    TO WS-ERROR
 15972                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15973
 15974 3710-EDIT-PRIOR-DEATH.
 15975
 15976*    IF LF-COVERAGE-CANCELLED
 15977*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 289
* EL050.cbl
 15978*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15979*           (NOT PB-CI-OB)
 15980*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15981*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15982*                   MOVE ER-2732  TO WS-ERROR
 15983*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15984*
 15985*    IF AH-COVERAGE-CANCELLED
 15986*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15987*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15988*           (NOT PB-CI-OB)
 15989*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15990*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15991*                   MOVE ER-2732  TO WS-ERROR
 15992*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15993
 15994     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15995         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15996            (NOT PB-COMP-LF-CANCEL)
 15997             NEXT SENTENCE
 15998         ELSE
 15999           IF PB-C-LF-CANCEL-VOIDED
 16000              NEXT SENTENCE
 16001           ELSE
 16002              MOVE ER-2753      TO WS-ERROR
 16003              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16004
 16005     IF CANCEL-FUTURE-DT
 16006         GO TO 3999-END-EDIT.
 16007
 16008 3715-GET-REMAIN-TERM-LF.
 16009
 16010     IF NO-LF-BENEFIT-MATCH  OR
 16011        WS-LF-BENEFIT-CD = ZEROS
 16012        GO TO 3730-GET-AH-REMAIN-TERM.
 16013
 16014     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16015     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16016     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16017     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16018     MOVE PB-SV-STATE            TO CP-STATE.
 16019     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16020     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16021     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16022     MOVE '2'                    TO CP-PROCESS-TYPE.
 16023     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16024     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16025     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16026     IF (PB-COMPANY-ID = 'CID')
 16027        AND (CP-STATE-STD-ABBRV = 'WI')
 16028        MOVE '7'                 TO CP-REM-TERM-METHOD
 16029        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16030     ELSE
 16031        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16032        MOVE WS-REM-TRM-CALC-OPTION
 16033                                 TO CP-REM-TRM-CALC-OPTION
 16034     END-IF
 16035**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 290
* EL050.cbl
 16036     IF (PB-COMPANY-ID = 'CID')
 16037        AND (CP-STATE-STD-ABBRV = 'MO')
 16038        AND (PB-CERT-EFF-DT >= X'9B41')
 16039        AND (PB-CERT-EFF-DT <= X'A2FB')
 16040        MOVE '7'                 TO CP-REM-TERM-METHOD
 16041        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16042     END-IF
 16043     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16044                                    CP-LOAN-TERM.
 16045     IF CP-TRUNCATED-LIFE
 16046        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16047
 16048     IF CP-TERM-IS-DAYS
 16049         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16050     ELSE
 16051         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16052
 16053     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16054
 16055     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16056
 16057     IF LF-COVERAGE-CANCELLED
 16058        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16059        NEXT SENTENCE
 16060      ELSE
 16061          GO TO 3730-GET-AH-REMAIN-TERM.
 16062
 16063 3720-GET-LF-REFUND.
 16064
 16065     IF PB-C-LF-CANCEL-VOIDED
 16066        GO TO 3730-GET-AH-REMAIN-TERM
 16067     end-if
 16068
 16069     IF PB-COMPANY-ID EQUAL 'BOA'
 16070         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16071         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16072         GO TO 3730-GET-AH-REMAIN-TERM.
 16073
 16074     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16075        (WS-AH-SPECIAL-CALC-CD = 'M')
 16076         MOVE ER-2767            TO WS-ERROR
 16077         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16078         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16079         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16080         GO TO 3780-UPDATE-CANCEL-CERT.
 16081
 16082*    if (ws-lf-earnings-calc = '6')
 16083*       or (pb-c-lf-refund-override = '6')
 16084*       move cp-remaining-term-1 to cp-remaining-term-2
 16085*    end-if
 16086     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16087
 16088     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16089     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16090     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16091     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16092     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16093     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 291
* EL050.cbl
 16094     IF (PB-COMPANY-ID = 'DCC')
 16095        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16096        IF PDEF-MASTER-FOUND
 16097           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16098              (V1 > +8)
 16099              OR (PD-PROD-CODE (V1) = 'L')
 16100           END-PERFORM
 16101           IF V1 < +9
 16102              MOVE PD-MAX-AMT (V1)
 16103                           TO CP-R-MAX-TOT-BEN
 16104                              EC-AM-LF-MAX-TOT-BEN
 16105           END-IF
 16106        ELSE
 16107        MOVE ' '                 TO PDEF-MASTER-SW
 16108        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16109        MOVE PB-STATE            TO ERPDEF-STATE
 16110        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16111        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16112        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16113        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16114        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16115        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16116        IF PDEF-MASTER-FOUND
 16117           MOVE 'N'              TO PDEF-MASTER-SW
 16118           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16119           IF PDEF-MASTER-FOUND
 16120              IF (ERPDEF-KEY-SAVE (1:16) =
 16121                           PD-CONTROL-PRIMARY (1:16))
 16122                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16123                 CONTINUE
 16124              ELSE
 16125                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16126                 IF (ERPDEF-KEY-SAVE (1:16) =
 16127                           PD-CONTROL-PRIMARY (1:16))
 16128                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16129                    CONTINUE
 16130                 ELSE
 16131                    MOVE 'N'     TO PDEF-MASTER-SW
 16132                 END-IF
 16133              END-IF
 16134
 16135              IF PDEF-MASTER-FOUND
 16136                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16137                    (V1 > +8)
 16138                    OR (PD-PROD-CODE (V1) = 'L')
 16139                 END-PERFORM
 16140                 IF V1 < +9
 16141                    MOVE PD-MAX-AMT (V1)
 16142                                 TO CP-R-MAX-TOT-BEN
 16143                                    EC-AM-LF-MAX-TOT-BEN
 16144                 END-IF
 16145              END-IF
 16146           END-IF
 16147           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16148        END-IF
 16149        END-IF
 16150     END-IF
 16151     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 292
* EL050.cbl
 16152
 16153     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16154
 16155     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16156                                    PB-C-LF-REM-TERM.
 16157
 16158     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16159     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16160
 16161     IF PB-COMPANY-ID EQUAL 'FLC'
 16162        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16163           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16164           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16165                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16166                    - CM-LF-ITD-DEATH-AMT
 16167           IF PB-C-LF-REF-CALC LESS THAN +0
 16168              MOVE +0            TO PB-C-LF-REF-CALC
 16169              GO TO 3730-GET-AH-REMAIN-TERM
 16170           ELSE
 16171              GO TO 3730-GET-AH-REMAIN-TERM.
 16172
 16173     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16174                            OR '4' OR '5' OR '6' OR '8'
 16175                            OR '9' OR 'G'
 16176        MOVE PB-C-LF-REFUND-OVERRIDE
 16177                                 TO CP-EARNING-METHOD.
 16178
 16179     if pb-company-id = 'AHL'
 16180        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16181        if cp-class-code = spaces
 16182           move zeros            to cp-class-code
 16183        end-if
 16184     ELSE
 16185        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16186     END-IF
 16187*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16188     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16189     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16190                                    CP-RATING-BENEFIT-AMT.
 16191     IF CP-STATE-STD-ABBRV = 'OR'
 16192         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16193                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16194     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16195     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16196     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16197     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16198     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16199     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16200     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16201     IF WS-DEFAULT-APR NOT NUMERIC
 16202         MOVE ZEROS TO WS-DEFAULT-APR.
 16203****   N O T E   ****
 16204*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16205*      THE OH HARD CODING IN ELCRFNDP
 16206
 16207     IF PB-COMPANY-ID = 'CID'
 16208        IF CP-STATE-STD-ABBRV = 'OH'
 16209           MOVE WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 293
* EL050.cbl
 16210                                 TO CP-EARNING-METHOD
 16211        END-IF
 16212     END-IF
 16213
 16214****   N O T E   ****
 16215
 16216     IF CP-EARN-AS-NET-PAY
 16217         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16218            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16219                MOVE WS-DEFAULT-APR
 16220                                 TO  CP-LOAN-APR
 16221                MOVE ER-3780     TO  WS-ERROR
 16222                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16223            ELSE
 16224                MOVE ER-3781     TO  WS-ERROR
 16225                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16226*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16227     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16228
 16229     IF CP-REFUND-TYPE-USED NOT = SPACE
 16230         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16231
 16232     IF CP-ERROR-RATE-IS-ZERO OR
 16233        CP-ERROR-RATE-NOT-FOUND
 16234        MOVE ER-2740             TO WS-ERROR
 16235        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16236
 16237     IF CP-ERROR-RATE-FILE-NOTOPEN
 16238        MOVE ER-2617             TO WS-ERROR
 16239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16240
 16241     IF PB-COMPANY-ID = 'DCC'
 16242        AND PB-CI-ENTRY-STATUS = 'M'
 16243        MOVE +0                  TO PB-C-LF-REF-CALC
 16244     ELSE
 16245        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16246     END-IF
 16247
 16248     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16249         GO TO 3730-GET-AH-REMAIN-TERM.
 16250
 16251*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16252*       ADD +1                   TO PB-C-LF-REM-TERM
 16253*                                   CP-REMAINING-TERM
 16254*                                   CP-ORIGINAL-TERM.
 16255
 16256     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16257     MOVE '2'                    TO CP-EARNING-METHOD
 16258                                    CP-RATING-METHOD.
 16259     IF PB-COMPANY-ID = 'CID'
 16260        IF (CP-STATE-STD-ABBRV = 'MN')
 16261           AND (PB-CERT-EFF-DT > X'A4FF')
 16262           AND (WS-LF-EARNINGS-CALC = 'B')
 16263           MOVE '5'              TO CP-EARNING-METHOD
 16264           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16265        END-IF
 16266     END-IF
 16267     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 294
* EL050.cbl
 16268                                        CP-REMAINING-BENEFIT
 16269                                        CP-RATING-BENEFIT-AMT.
 16270     IF CP-STATE-STD-ABBRV = 'OR'
 16271         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16272                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16273     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16274     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16275
 16276     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16277
 16278     IF CP-ERROR-RATE-IS-ZERO OR
 16279        CP-ERROR-RATE-NOT-FOUND
 16280        MOVE ER-2740             TO WS-ERROR
 16281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16282
 16283     IF CP-ERROR-RATE-FILE-NOTOPEN
 16284        MOVE ER-2617             TO WS-ERROR
 16285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16286
 16287     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16288
 16289******************************************************************
 16290
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 295
* EL050.cbl
 16292 3730-GET-AH-REMAIN-TERM.
 16293     IF NO-AH-BENEFIT-MATCH  OR
 16294        WS-AH-BENEFIT-CD = ZEROS
 16295         GO TO 3770-CHECK-REFUNDS.
 16296
 16297     IF PB-CI-AH-LUMP-SUM-DISAB
 16298         IF  PB-C-AH-CANCEL-AMT = ZERO
 16299            IF NOT PB-COMP-AH-CANCEL
 16300             GO TO 3770-CHECK-REFUNDS.
 16301
 16302     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16303     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16304     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16305     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16306     MOVE PB-SV-STATE            TO CP-STATE.
 16307     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16308     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16309     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16310     MOVE '2'                    TO CP-PROCESS-TYPE.
 16311     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16312     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16313     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16314     IF (PB-COMPANY-ID = 'CID')
 16315        AND (CP-STATE-STD-ABBRV = 'WI')
 16316        MOVE '7'                 TO CP-REM-TERM-METHOD
 16317        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16318     ELSE
 16319        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16320        MOVE WS-REM-TRM-CALC-OPTION
 16321                                 TO CP-REM-TRM-CALC-OPTION
 16322     END-IF
 16323     IF (PB-COMPANY-ID = 'CID')
 16324        AND (CP-STATE-STD-ABBRV = 'MO')
 16325        AND (PB-CERT-EFF-DT >= X'9B41')
 16326        AND (PB-CERT-EFF-DT <= X'A2FB')
 16327        MOVE '7'                 TO CP-REM-TERM-METHOD
 16328        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16329     END-IF
 16330     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16331                                    CP-LOAN-TERM.
 16332     IF NOT CP-TERM-IS-DAYS
 16333         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16334
 16335     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16336
 16337     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16338
 16339     IF AH-COVERAGE-CANCELLED
 16340        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16341        NEXT SENTENCE
 16342      ELSE
 16343         GO TO 3770-CHECK-REFUNDS.
 16344
 16345 3740-GET-AH-REFUND.
 16346
 16347     IF PB-C-AH-CANCEL-VOIDED
 16348        GO TO 3780-UPDATE-CANCEL-CERT
 16349     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 296
* EL050.cbl
 16350
 16351     IF PB-COMPANY-ID = 'BOA'
 16352         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16353         GO TO 3770-CHECK-REFUNDS.
 16354
 16355     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16356*    MOVE ' '                    TO DC-OPTION-CODE
 16357     SET BIN-TO-GREG             TO TRUE
 16358     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16359     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16360                                    PB-C-AH-REM-TERM.
 16361     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16362     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16363
 16364     IF PB-COMPANY-ID EQUAL 'FLC'
 16365        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16366           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16367           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16368                    - CM-AH-ITD-AH-PMT)
 16369           IF PB-C-AH-REF-CALC LESS THAN +0
 16370              MOVE +0            TO PB-C-AH-REF-CALC
 16371              GO TO 3770-CHECK-REFUNDS
 16372           ELSE
 16373              GO TO 3770-CHECK-REFUNDS.
 16374
 16375     IF PB-COMPANY-ID = 'DCC'
 16376        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16377            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16378           MOVE 'S'              TO CP-EARNING-METHOD
 16379        END-IF
 16380     END-IF
 16381     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16382                            OR '4' OR '5' OR '6' OR '8'
 16383                            OR '9' OR 'G' OR 'S'
 16384        MOVE PB-C-AH-REFUND-OVERRIDE
 16385                                 TO CP-EARNING-METHOD.
 16386
 16387     if pb-company-id = 'AHL'
 16388        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16389        if cp-class-code = spaces
 16390           move zeros            to cp-class-code
 16391        end-if
 16392     ELSE
 16393        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16394     END-IF
 16395*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16396     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16397     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16398                                    CP-RATING-BENEFIT-AMT.
 16399     IF CP-STATE-STD-ABBRV = 'OR'
 16400         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16401                                         PB-CI-AH-TERM.
 16402     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16403     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16404     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16405     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16406     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16407     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 297
* EL050.cbl
 16408
 16409     IF CP-STATE-STD-ABBRV = 'OH'
 16410        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16411                                AND 'CID' AND 'DCC' AND 'AHL')
 16412           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16413              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16414              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16415              MOVE '6' TO CP-EARNING-METHOD
 16416           END-IF
 16417        END-IF
 16418        IF PB-COMPANY-ID = 'CID'
 16419           IF NO-LIFE-COVERAGE
 16420              IF CP-CRITICAL-PERIOD
 16421                 MOVE '2'       TO CP-EARNING-METHOD
 16422              ELSE
 16423                 MOVE '6'       TO CP-EARNING-METHOD
 16424              END-IF
 16425           ELSE
 16426              IF WS-LF-COVERAGE-TYPE = 'L'
 16427                 MOVE '2'       TO CP-EARNING-METHOD
 16428              ELSE
 16429                 IF (PB-CI-LF-TERM > +60) OR
 16430                    (WS-LF-EARNINGS-CALC = '5')
 16431                    IF CP-CRITICAL-PERIOD
 16432                       MOVE '2'  TO CP-EARNING-METHOD
 16433                    ELSE
 16434                       MOVE '6'  TO CP-EARNING-METHOD
 16435                    END-IF
 16436                 ELSE
 16437                    MOVE '1'     TO CP-EARNING-METHOD
 16438                 END-IF
 16439              END-IF
 16440           END-IF
 16441        END-IF
 16442     END-IF
 16443
 16444*    IF CP-STATE-STD-ABBRV = 'VA'
 16445*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16446*          IF CP-ORIGINAL-TERM GREATER 61
 16447*             MOVE '6' TO CP-EARNING-METHOD
 16448*          ELSE
 16449*             MOVE '1' TO CP-EARNING-METHOD.
 16450
 16451     IF WS-DEFAULT-APR NOT NUMERIC
 16452         MOVE ZEROS TO WS-DEFAULT-APR.
 16453     IF CP-EARN-AS-NET-PAY
 16454         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16455            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16456                MOVE WS-DEFAULT-APR
 16457                                 TO  CP-LOAN-APR
 16458                MOVE ER-3780     TO  WS-ERROR
 16459                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16460            ELSE
 16461                MOVE ER-3781     TO  WS-ERROR
 16462                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16463     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16464     IF PB-COMPANY-ID = 'DCC'
 16465        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 298
* EL050.cbl
 16466        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16467        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16468     END-IF
 16469     IF PB-COMPANY-ID = 'DCC'
 16470        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16471        AND (CP-EARNING-METHOD = 'D')
 16472        AND (CP-CANCEL-REASON NOT = 'R')
 16473        CONTINUE
 16474     ELSE
 16475        GO TO 3750-CONTINUE
 16476     END-IF
 16477     MOVE ' '                    TO DD-IU-SW
 16478     IF NOT PDEF-MASTER-FOUND
 16479        MOVE ' '                 TO PDEF-MASTER-SW
 16480        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16481        MOVE PB-STATE            TO ERPDEF-STATE
 16482        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16483        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16484        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16485        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16486        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16487        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16488        IF PDEF-MASTER-FOUND
 16489           MOVE 'N'              TO PDEF-MASTER-SW
 16490           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16491           IF PDEF-MASTER-FOUND
 16492              IF (ERPDEF-KEY-SAVE (1:16) =
 16493                           PD-CONTROL-PRIMARY (1:16))
 16494                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16495                 CONTINUE
 16496              ELSE
 16497                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16498                 IF (ERPDEF-KEY-SAVE (1:16) =
 16499                           PD-CONTROL-PRIMARY (1:16))
 16500                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16501                    CONTINUE
 16502                 ELSE
 16503                    MOVE ER-2740 TO WS-ERROR
 16504                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16505                    GO TO 3770-CHECK-REFUNDS
 16506                 END-IF
 16507              END-IF
 16508           END-IF
 16509           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16510        END-IF
 16511     END-IF
 16512     IF PDEF-MASTER-FOUND
 16513        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16514           (V1 > +8)
 16515           OR (PD-PROD-CODE (V1) = 'I')
 16516        END-PERFORM
 16517        IF V1 < +9
 16518           SET DD-IU-PRESENT        TO TRUE
 16519        END-IF
 16520        IF WS-AH-DCC-TRUNC = 'T'
 16521           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16522        ELSE
 16523           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 299
* EL050.cbl
 16524        END-IF
 16525        EVALUATE TRUE
 16526           WHEN WS-TERM > +168
 16527              MOVE 15               TO V1
 16528           WHEN WS-TERM > +156
 16529              MOVE 14               TO V1
 16530           WHEN WS-TERM > +144
 16531              MOVE 13               TO V1
 16532           WHEN WS-TERM > +132
 16533              MOVE 12               TO V1
 16534           WHEN WS-TERM > +120
 16535              MOVE 11               TO V1
 16536           WHEN WS-TERM > +108
 16537              MOVE 10               TO V1
 16538           WHEN WS-TERM > +96
 16539              MOVE 9                TO V1
 16540           WHEN WS-TERM > +84
 16541              MOVE 8                TO V1
 16542           WHEN WS-TERM > +72
 16543              MOVE 7                TO V1
 16544           WHEN WS-TERM > +60
 16545              MOVE 6                TO V1
 16546           WHEN WS-TERM > +48
 16547              MOVE 5                TO V1
 16548           WHEN WS-TERM > +36
 16549              MOVE 4                TO V1
 16550           WHEN WS-TERM > +24
 16551              MOVE 3                TO V1
 16552           WHEN WS-TERM > +12
 16553              MOVE 2                TO V1
 16554           WHEN OTHER
 16555              MOVE 1                TO V1
 16556        END-EVALUATE
 16557
 16558        EVALUATE TRUE
 16559*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16560*             < +13)
 16561*             AND (DD-IU-PRESENT)
 16562*             MOVE 2                TO V2
 16563*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16564*             MOVE 1                TO V2
 16565           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16566              MOVE 2                TO V2
 16567           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16568              MOVE 3                TO V2
 16569           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16570              MOVE 4                TO V2
 16571           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16572              MOVE 5                TO V2
 16573           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16574              MOVE 6                TO V2
 16575           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16576              MOVE 7                TO V2
 16577           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16578              MOVE 8                TO V2
 16579           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16580              MOVE 9                TO V2
 16581           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 300
* EL050.cbl
 16582              MOVE 10               TO V2
 16583           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16584              MOVE 11               TO V2
 16585           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16586              MOVE 12               TO V2
 16587           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16588              MOVE 13               TO V2
 16589           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16590              MOVE 14               TO V2
 16591           WHEN OTHER
 16592              MOVE 15               TO V2
 16593        END-EVALUATE
 16594
 16595        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16596                                 TO CP-DDF-LO-FACT
 16597        MOVE PD-UEP-FACTOR (V1 V2)
 16598                                 TO CP-DDF-HI-FACT
 16599
 16600        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16601        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16602        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16603           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16604        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16605        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16606        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16607           + PD-1ST-YR-ADMIN-ALLOW
 16608
 16609        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16610*       IF PI-CLP-YN = 'Y'
 16611*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16612*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16613*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16614*       END-IF
 16615
 16616        IF DD-IU-PRESENT
 16617           MOVE 'I'              TO CP-EARNING-METHOD
 16618        END-IF
 16619        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16620                                     CP-CLP-RATE-UP
 16621        IF CP-IU-RATE-UP NOT = ZEROS
 16622           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16623              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16624           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16625              / (1 - WS-WORK-FACT)
 16626        END-IF
 16627     END-IF
 16628     .
 16629 3750-CONTINUE.
 16630     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16631
 16632     IF CP-REFUND-TYPE-USED NOT = SPACE
 16633         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16634
 16635     IF CP-ERROR-RATE-IS-ZERO OR
 16636        CP-ERROR-RATE-NOT-FOUND
 16637        MOVE ER-2740             TO WS-ERROR
 16638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16639
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 301
* EL050.cbl
 16640     IF CP-ERROR-RATE-FILE-NOTOPEN
 16641        MOVE ER-2617             TO WS-ERROR
 16642        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16643     IF PB-COMPANY-ID = 'DCC'
 16644        AND PB-CI-ENTRY-STATUS = 'M'
 16645        MOVE +0                  TO PB-C-AH-REF-CALC
 16646     ELSE
 16647        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16648     END-IF
 16649     IF PB-COMPANY-ID = 'DCC'
 16650        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16651        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16652        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16653        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16654        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16655        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16656        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16657        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16658*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16659     END-IF
 16660     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 302
* EL050.cbl
 16662
 16663 3770-CHECK-REFUNDS.
 16664
 16665     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16666        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16667           MOVE ER-2766          TO WS-ERROR
 16668           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16669           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16670           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16671              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16672
 16673     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16674        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16675           MOVE ER-2766          TO WS-ERROR
 16676           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16677           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16678           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16679              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16680
 16681     IF PB-COMP-LF-CANCEL
 16682        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16683        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16684           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16685              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16686
 16687     IF PB-COMP-AH-CANCEL
 16688        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16689        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16690           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16691              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16692
 16693     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16694             GIVING WS-UNSIGN-WRK1
 16695     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16696             GIVING WS-UNSIGN-WRK2.
 16697
 16698     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16699         MOVE ZERO TO WS-UNSIGN-WRK1.
 16700
 16701     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16702         MOVE ZERO TO WS-UNSIGN-WRK2.
 16703
 16704     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16705
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 303
* EL050.cbl
 16707
 16708 3772-CONTINUE.
 16709
 16710**********************************
 16711*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16712*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16713*** DOUBLES THE TOLERANCE AMOUNT.
 16714***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16715**********************************
 16716     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'CAP'
 16717     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16718         IF WS-REF-REJECT-SW = SPACE
 16719             MOVE ER-2754        TO WS-ERROR
 16720             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16721           ELSE
 16722             MOVE ER-2736        TO WS-ERROR
 16723             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16724**********************************
 16725
 16726 3773-CONTINUE.
 16727
 16728     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16729        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16730           MOVE ER-2723          TO WS-ERROR
 16731           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16732
 16733     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16734        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16735           MOVE ER-2724          TO WS-ERROR
 16736           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16737
 16738     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16739         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16740             (1 + WS-LF-REFUND-OVS-PCT)
 16741     ELSE
 16742         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16743
 16744     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16745         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16746             (1 - WS-TOL-LF-REFUND-PCT)
 16747     ELSE
 16748         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16749
 16750     IF (PB-COMPANY-ID = 'DCC')
 16751        AND (PB-CI-ENTRY-STATUS = 'M')
 16752        AND (PB-C-LF-CANCEL-AMT > +0)
 16753        MOVE ER-3843             TO WS-ERROR
 16754        PERFORM 9900-ERROR-FORMAT
 16755                                 THRU 9900-EXIT
 16756     END-IF
 16757     EVALUATE TRUE
 16758        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16759           CONTINUE
 16760        WHEN PB-C-LF-CANCEL-AMT = +0
 16761                 AND PB-C-LF-REF-CALC > +0
 16762           CONTINUE
 16763        WHEN WS-LF-REFUND-OVS-AMT = 0
 16764                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 304
* EL050.cbl
 16765           CONTINUE
 16766        WHEN OTHER
 16767           IF WS-TOL-LF-REFUND  = +0
 16768              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16769           END-IF
 16770           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16771                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16772                          (PB-C-LF-CANCEL-AMT))
 16773              CONTINUE
 16774           ELSE
 16775              IF WS-LF-REFUND-OVS-AMT = +0
 16776                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16777              END-IF
 16778              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16779                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16780                                       PB-C-LF-CANCEL-AMT)
 16781                 CONTINUE
 16782              ELSE
 16783                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16784                   MOVE ER-2754   TO  WS-ERROR
 16785                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16786                 ELSE
 16787                    MOVE ER-2736   TO  WS-ERROR
 16788                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16789                 END-IF
 16790              END-IF
 16791           END-IF
 16792     END-EVALUATE.
 16793
 16794     EVALUATE TRUE
 16795        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16796           CONTINUE
 16797        WHEN PB-C-LF-CANCEL-AMT = +0
 16798                 AND PB-C-LF-REF-CALC > +0
 16799           CONTINUE
 16800        WHEN OTHER
 16801           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16802               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16803              CONTINUE
 16804           ELSE
 16805              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16806               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16807                CONTINUE
 16808              ELSE
 16809                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16810                     MOVE ER-2754   TO  WS-ERROR
 16811                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16812                 ELSE
 16813                     MOVE ER-2736   TO  WS-ERROR
 16814                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16815                 END-IF
 16816              END-IF
 16817           END-IF
 16818     END-EVALUATE.
 16819
 16820     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16821         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16822             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 305
* EL050.cbl
 16823     ELSE
 16824         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16825
 16826     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16827         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16828             (1 - WS-TOL-AH-REFUND-PCT)
 16829     ELSE
 16830         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16831
 16832     IF (PB-COMPANY-ID = 'DCC')
 16833        AND (PB-CI-ENTRY-STATUS = 'M')
 16834        AND (PB-C-AH-CANCEL-AMT > +0)
 16835        MOVE ER-3843             TO WS-ERROR
 16836        PERFORM 9900-ERROR-FORMAT
 16837                                 THRU 9900-EXIT
 16838     END-IF
 16839     EVALUATE TRUE
 16840        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16841           CONTINUE
 16842*       WHEN PB-C-AH-REF-CALC = +0 AND
 16843*                  PB-C-AH-CANCEL-AMT > +0
 16844        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16845                   PB-C-AH-REF-CALC > +0
 16846           CONTINUE
 16847        WHEN WS-AH-REFUND-OVS-AMT = +0
 16848                AND WS-TOL-AH-REFUND = +0
 16849           CONTINUE
 16850        WHEN OTHER
 16851           IF WS-TOL-AH-REFUND = +0
 16852              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16853           END-IF
 16854           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16855               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16856                                         PB-C-AH-CANCEL-AMT)
 16857              CONTINUE
 16858           ELSE
 16859              IF WS-AH-REFUND-OVS-AMT = +0
 16860                 MOVE +9999999.99 TO
 16861                         WS-AH-REFUND-OVS-AMT
 16862              END-IF
 16863              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16864                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16865                                         PB-C-AH-CANCEL-AMT)
 16866                 CONTINUE
 16867              ELSE
 16868                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16869                    MOVE ER-2754   TO  WS-ERROR
 16870                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16871                 ELSE
 16872                    MOVE ER-2736   TO  WS-ERROR
 16873                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16874                 END-IF
 16875              END-IF
 16876           END-IF
 16877     END-EVALUATE.
 16878
 16879     EVALUATE TRUE
 16880        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 306
* EL050.cbl
 16881           CONTINUE
 16882*       WHEN PB-C-AH-REF-CALC > +0 AND
 16883*                  PB-C-AH-CANCEL-AMT = +0
 16884        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16885                   PB-C-AH-REF-CALC = +0
 16886           CONTINUE
 16887        WHEN OTHER
 16888           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16889               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16890              CONTINUE
 16891           ELSE
 16892              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16893                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16894                 CONTINUE
 16895              ELSE
 16896                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16897                     MOVE ER-2754   TO  WS-ERROR
 16898                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16899                 ELSE
 16900                     MOVE ER-2736   TO  WS-ERROR
 16901                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16902                 END-IF
 16903              END-IF
 16904           END-IF
 16905     END-EVALUATE.
 16906
 16907     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16908        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16909        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16910           AND  PB-C-LF-REF-CALC < +1.00
 16911           AND  PB-C-AH-REF-CALC < +1.00
 16912           CONTINUE
 16913        ELSE
 16914           IF (PB-COMPANY-ID = 'DCC')
 16915              AND (PB-CI-ENTRY-STATUS = 'M')
 16916              CONTINUE
 16917           ELSE
 16918              MOVE ER-2741       TO WS-ERROR
 16919              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16920           END-IF
 16921        END-IF
 16922     END-IF
 16923
 16924     IF (PB-C-LF-CANCEL-AMT = ZERO
 16925        AND WS-LF-BENEFIT-CD NOT = ZERO
 16926        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16927        AND PB-C-LF-REF-CALC NOT = ZERO)
 16928        OR
 16929        (PB-C-LF-CANCEL-AMT = ZERO
 16930        AND WS-LF-BENEFIT-CD NOT = ZERO
 16931        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16932             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16933                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16934                NEXT SENTENCE
 16935             ELSE
 16936                MOVE ER-2739        TO WS-ERROR
 16937                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16938
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 307
* EL050.cbl
 16939     IF (PB-C-AH-CANCEL-AMT = ZERO
 16940        AND WS-AH-BENEFIT-CD NOT = ZERO
 16941        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16942        AND PB-C-AH-REF-CALC NOT = ZERO)
 16943        OR
 16944        (PB-C-AH-CANCEL-AMT = ZERO
 16945        AND WS-AH-BENEFIT-CD NOT = ZERO
 16946        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16947             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16948                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16949                NEXT SENTENCE
 16950             ELSE
 16951                MOVE ER-2738        TO WS-ERROR
 16952                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16953
 16954 3775-OVER-REF-CHK.
 16955
 16956     IF PB-CI-ENTRY-STATUS = '5'
 16957        GO TO 3780-UPDATE-CANCEL-CERT.
 16958
 16959     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16960                              PB-CI-LF-ALT-PREMIUM-AMT.
 16961
 16962     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16963        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16964                                 PB-C-LF-REF-CALC
 16965      ELSE
 16966        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16967                                 PB-C-LF-CANCEL-AMT.
 16968
 16969     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16970        MOVE ER-2755             TO WS-ERROR
 16971        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16972
 16973     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16974
 16975     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16976        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16977                                 PB-C-AH-REF-CALC
 16978      ELSE
 16979        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16980                                 PB-C-AH-CANCEL-AMT.
 16981
 16982     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16983        MOVE ER-2778             TO WS-ERROR
 16984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16985
 16986     IF PB-CI-OB-FLAG NOT = 'Z'
 16987        NEXT SENTENCE
 16988       ELSE
 16989         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16990            MOVE ER-2757           TO WS-ERROR
 16991            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16992
 16993 3780-UPDATE-CANCEL-CERT.
 16994
 16995     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16996        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 308
* EL050.cbl
 16997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16998
 16999     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17000         MOVE ER-2729              TO WS-ERROR
 17001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17002
 17003     IF PB-CI-LF-BENEFIT-CD = ZERO
 17004         GO TO 3780-UPDATE-CONT-1.
 17005
 17006     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17007         GO TO 3780-UPDATE-CONT-1.
 17008
 17009     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17010       AND
 17011        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17012       AND
 17013        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17014       AND
 17015        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17016            NEXT SENTENCE
 17017       ELSE
 17018        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17019          AND
 17020***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17021***       AND
 17022           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17023            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17024               MOVE ER-2730      TO WS-ERROR
 17025               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17026               GO TO 3999-END-EDIT
 17027            ELSE
 17028               GO TO 3999-END-EDIT
 17029        ELSE
 17030            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17031               MOVE ER-2765           TO WS-ERROR
 17032               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17033               GO TO 3785-CHECK-NH.
 17034*              GO TO 3999-END-EDIT.
 17035
 17036 3780-UPDATE-CONT-1.
 17037     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17038
 17039     IF PB-CI-AH-BENEFIT-CD = ZERO
 17040         GO TO 3780-UPDATE-CONT-2.
 17041
 17042     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17043         GO TO 3780-UPDATE-CONT-2.
 17044
 17045     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17046
 17047     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17048       AND
 17049        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17050       AND
 17051        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17052       AND
 17053        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17054            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 309
* EL050.cbl
 17055       ELSE
 17056        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17057          AND
 17058***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17059***       AND
 17060           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17061           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17062            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17063               MOVE ER-2773      TO WS-ERROR
 17064               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17065               GO TO 3999-END-EDIT
 17066            ELSE
 17067               GO TO 3999-END-EDIT
 17068            END-IF
 17069           ELSE
 17070             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17071                IF MSTR-CERT-NO = W-CL-CERT-NO
 17072                   MOVE ER-2890 TO WS-ERROR
 17073                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17074                   GO TO 3999-END-EDIT
 17075                ELSE
 17076                   MOVE ER-2898 TO WS-ERROR
 17077                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17078                   GO TO 3999-END-EDIT
 17079                END-IF
 17080             ELSE
 17081                GO TO 3785-CHECK-NH
 17082             END-IF
 17083           END-IF
 17084          ELSE
 17085            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17086              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17087                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17088                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17089                      MOVE ER-2890 TO WS-ERROR
 17090                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17091                      GO TO 3999-END-EDIT
 17092                   ELSE
 17093                      MOVE ER-2898 TO WS-ERROR
 17094                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17095                      GO TO 3999-END-EDIT
 17096                   END-IF
 17097                ELSE
 17098                   MOVE ER-2765 TO WS-ERROR
 17099                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17100                   GO TO 3785-CHECK-NH
 17101                END-IF
 17102              ELSE
 17103               MOVE ER-2765      TO WS-ERROR
 17104               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17105               GO TO 3785-CHECK-NH.
 17106*              GO TO 3999-END-EDIT.
 17107
 17108 3780-UPDATE-CONT-2.
 17109
 17110     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17111        AND WS-LF-BENEFIT-CD = ZERO
 17112           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 310
* EL050.cbl
 17113           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17114
 17115     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17116        AND WS-AH-BENEFIT-CD = ZERO
 17117           MOVE ER-2744           TO WS-ERROR
 17118           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17119
 17120     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17121        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17122        AND
 17123        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17124         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17125           MOVE ER-2746           TO WS-ERROR
 17126           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17127
 17128     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17129       AND
 17130        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17131             MOVE ER-2737        TO WS-ERROR
 17132             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17133
 17134     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17135       AND
 17136        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17137             MOVE ER-2737        TO WS-ERROR
 17138             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17139
 17140     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17141         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17142             OR 'CID' OR 'DCC' OR 'AHL'
 17143             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17144         ELSE
 17145             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17146                 MOVE ER-2768    TO WS-ERROR
 17147                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17148             ELSE
 17149                 MOVE ER-2756    TO WS-ERROR
 17150                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17151
 17152     IF CERT-PEND-ISSUE-RETURNED
 17153        MOVE ER-2772             TO WS-ERROR
 17154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17155 3785-CHECK-NH.
 17156     IF PB-STATE NOT = 'NH'
 17157        GO TO 3999-END-EDIT
 17158     END-IF
 17159
 17160     MOVE ER-2796                TO WS-ERROR
 17161     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17162     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17163        OR (CM-NH-INTERFACE-SW = 'Y')
 17164        MOVE ER-2793             TO WS-ERROR
 17165        PERFORM 9900-ERROR-FORMAT
 17166                                 THRU 9900-EXIT
 17167     END-IF
 17168     MOVE +0                     TO WS-PAYMENT-AMT
 17169     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17170        GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 311
* EL050.cbl
 17171     END-IF
 17172     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17173        GO TO 3999-END-EDIT
 17174     END-IF
 17175     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17176     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17177     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17178        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17179     END-IF
 17180     MOVE '1'                    TO DC-OPTION-CODE
 17181     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17182     IF NO-CONVERSION-ERROR
 17183        IF DC-ELAPSED-DAYS < +16
 17184           GO TO 3999-END-EDIT
 17185        END-IF
 17186     END-IF
 17187     MOVE +0                     TO DC-ELAPSED-DAYS
 17188     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17189     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17190     MOVE '1'                    TO DC-OPTION-CODE
 17191     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17192     IF NO-CONVERSION-ERROR
 17193        IF DC-ELAPSED-DAYS > +30
 17194           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17195        ELSE
 17196           GO TO 3999-END-EDIT
 17197        END-IF
 17198     ELSE
 17199        GO TO 3999-END-EDIT
 17200     END-IF
 17201     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17202        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17203           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17204     IF WS-PAYMENT-AMT < 600.00
 17205        GO TO 3999-END-EDIT
 17206     END-IF
 17207     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17208
 17209     IF (ERMAIL-FOUND = ' ')
 17210         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17211         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17212        GO TO 3999-END-EDIT
 17213     END-IF
 17214     MOVE ER-2795                TO WS-ERROR
 17215     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17216
 17217     GO TO 3999-END-EDIT.
 17218******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 312
* EL050.cbl
 17220 3990-FILES-NOT-OPEN.
 17221
 17222     MOVE ER-2617                TO WS-ERROR.
 17223     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17224     GO TO 9990-RETURN.
 17225
 17226 3999-END-EDIT.
 17227
 17228     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17229
 17230     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17231         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17232         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17233             PERFORM 9250-UNLOCK-RETURN
 17234             GO TO 9990-RETURN
 17235          ELSE
 17236             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17237             GO TO 9990-RETURN.
 17238
 17239     IF PB-CANCELLATION
 17240          GO TO 9990-RETURN.
 17241
 17242     IF CERT-WAS-NOT-FOUND
 17243        MOVE SPACES              TO CERTIFICATE-MASTER.
 17244
 17245     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17246
 17247     IF CERT-WAS-FOUND
 17248         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17249             PERFORM 9250-UNLOCK-RETURN
 17250          ELSE
 17251            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17252      ELSE
 17253         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17254
 17255     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17256        IF ((PB-COMPANY-ID = 'DCC')
 17257           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17258                         or
 17259            (pb-company-id = 'CID')
 17260            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17261        END-IF
 17262     END-IF.
 17263
 17264     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17265         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17266     END-IF.
 17267     move ' '                    to ws-ins-age-defaulted
 17268     perform 8150-read-elcrtt    thru 8150-exit
 17269     if ws-ins-age-defaulted = 'Y'
 17270        move er-1573             to ws-error
 17271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17272     end-if
 17273
 17274     if ws-jnt-age-defaulted = 'Y'
 17275        move er-1574             to ws-error
 17276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17277     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 313
* EL050.cbl
 17278***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17279***                                                           ****
 17280***  Set an error if the state requires verification of agent ****
 17281***  and agent hasn't verified yet and the status is not =    ****
 17282***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17283***  and the entry date > 09/01/2015.                         ****
 17284***                                                           ****
 17285***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17286     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17287        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17288        and (pb-account (9:2) not = 'OB')
 17289        if (ws-st-agent-sig-edit = 'Y')
 17290           and (am-report-code-1 not = 'CONLEY')
 17291           evaluate true
 17292              when cs-agent-edit-status = 'C'
 17293                 move er-1743    to ws-error
 17294                 perform 9900-error-format
 17295                                 thru 9900-exit
 17296              when cs-agent-edit-status = 'S'
 17297                 move er-1744    to ws-error
 17298                 perform 9900-error-format
 17299                                 thru 9900-exit
 17300              when cs-agent-edit-status = 'M'
 17301                 move er-1745    to ws-error
 17302                 perform 9900-error-format
 17303                                 thru 9900-exit
 17304              when cs-agent-edit-status = 'R'
 17305                 move er-1747    to ws-error
 17306                 perform 9900-error-format
 17307                                 thru 9900-exit
 17308              when cs-agent-edit-status = 'N'
 17309                 move er-1748    to ws-error
 17310                 perform 9900-error-format
 17311                                 thru 9900-exit
 17312              when cs-agent-edit-status <> 'V' and 'U' and
 17313                                           'R' and 'N'
 17314                 move er-1746    to ws-error
 17315                 perform 9900-error-format
 17316                                 thru 9900-exit
 17317           end-evaluate
 17318        end-if
 17319     end-if
 17320     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17321     IF ((PB-COMPANY-ID = 'DCC')
 17322        AND (WS-NO-SECURE-PAY))
 17323                  OR
 17324        (WS-LF-SPECIAL-CALC-CD = 'O'
 17325        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17326        SET SKIP-ADDR-EDIT       TO TRUE
 17327     END-IF
 17328     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17329        AND (NOT SKIP-ADDR-EDIT)
 17330        MOVE ER-2963             TO WS-ERROR
 17331        PERFORM 9900-ERROR-FORMAT
 17332                                 THRU 9900-EXIT
 17333        GO TO 9990-RETURN
 17334     END-IF
 17335     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 314
* EL050.cbl
 17336     IF ERPNDM-FOUND NOT = 'X'
 17337        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17338           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17339           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17340           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17341           AND (NOT SKIP-ADDR-EDIT)
 17342           MOVE ER-2694          TO WS-ERROR
 17343           PERFORM 9900-ERROR-FORMAT
 17344                                 THRU 9900-EXIT
 17345        END-IF
 17346        MOVE ' '                 TO STATE-RECORD-ERROR
 17347        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17348        MOVE PM-STATE            TO CNTL-ACCESS
 17349        MOVE '3'                 TO CNTL-REC-TYPE
 17350        MOVE +0                  TO CNTL-SEQ-NO
 17351        MOVE '0'                 TO RC-SW-2
 17352        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17353        IF (NO-STATE-RECORD)
 17354           OR (CF-RECORD-TYPE NOT = '3')
 17355           OR (PM-STATE NOT = CF-STATE-CODE)
 17356           IF (PM-STATE = SPACES)
 17357              AND (SKIP-ADDR-EDIT)
 17358              CONTINUE
 17359           ELSE
 17360              MOVE ER-2963       TO WS-ERROR
 17361              PERFORM 9900-ERROR-FORMAT
 17362                                 THRU 9900-EXIT
 17363           END-IF
 17364        END-IF
 17365        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17366           MOVE ER-2883          TO WS-ERROR
 17367           PERFORM 9900-ERROR-FORMAT
 17368                                 THRU 9900-EXIT
 17369        END-IF
 17370        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17371           MOVE ' '                 TO STATE-RECORD-ERROR
 17372           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17373           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17374           MOVE '3'                 TO CNTL-REC-TYPE
 17375           MOVE +0                  TO CNTL-SEQ-NO
 17376           MOVE '0'                 TO RC-SW-2
 17377           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17378           IF NO-STATE-RECORD
 17379              OR (CF-RECORD-TYPE NOT = '3')
 17380              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17381              MOVE ER-2964          TO WS-ERROR
 17382              PERFORM 9900-ERROR-FORMAT
 17383                                    THRU 9900-EXIT
 17384           END-IF
 17385        END-IF
 17386     ELSE
 17387        IF NOT SKIP-ADDR-EDIT
 17388           MOVE ER-2393          TO WS-ERROR
 17389           PERFORM 9900-ERROR-FORMAT
 17390                                 THRU 9900-EXIT
 17391        END-IF
 17392     END-IF
 17393
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 315
* EL050.cbl
 17394     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17395
 17396     IF (ERMAIL-FOUND = ' ' AND
 17397        ERPNDM-FOUND = ' ')
 17398        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17399           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17400           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17401          OR
 17402           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17403          OR
 17404           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17405           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17406           GO TO 3999-UNLOCK-ERMAIL.
 17407
 17408     IF ERPNDM-FOUND = 'X'
 17409        GO TO 3999-UNLOCK-ERMAIL.
 17410
 17411     IF PM-INSURED-LAST-NAME      = SPACES
 17412        AND PM-INSURED-FIRST-NAME = SPACES
 17413        AND PM-ADDRESS-LINE-1     = SPACES
 17414        AND PM-ADDRESS-LINE-2     = SPACES
 17415        AND PM-CITY-STATE         = SPACES
 17416        AND PM-CRED-BENE-NAME     = SPACES
 17417        AND PM-CRED-BENE-ADDR     = SPACES
 17418        AND PM-CRED-BENE-CTYST    = SPACES
 17419        GO TO 3999-UNLOCK-ERMAIL
 17420     END-IF
 17421
 17422     MOVE SPACES                 TO MAILING-DATA.
 17423
 17424     MOVE 'MA'                   TO MA-RECORD-ID.
 17425     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17426     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17427     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17428     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17429     MOVE PB-SV-STATE            TO MA-STATE.
 17430     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17431     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17432
 17433     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17434     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17435
 17436     IF ERMAIL-FOUND = ' '
 17437        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17438     ELSE
 17439        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17440        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17441        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17442
 17443     GO TO 9990-RETURN.
 17444
 17445 3999-UNLOCK-ERMAIL.
 17446     IF ERMAIL-FOUND = ' '
 17447        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17448
 17449     GO TO 9990-RETURN.
 17450******************************************************************
 17451
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 316
* EL050.cbl
 17453 4000-UPDATE-CANCELLED-CERT.
 17454     IF CERT-WAS-NOT-FOUND
 17455        GO TO 4299-EXIT.
 17456
 17457*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17458     IF PB-C-NH-INT-ON-REFS > ZEROS
 17459        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17460     END-IF
 17461     IF PB-C-REF-INTERFACE-SW = 'Y'
 17462        MOVE PB-C-REF-INTERFACE-SW
 17463                                 TO CM-NH-INTERFACE-SW
 17464     END-IF
 17465     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17466     IF ERMAIL-FOUND = 'X'
 17467        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17468        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17469        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17470        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17471           MOVE ER-2694          TO WS-ERROR
 17472           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17473     END-IF
 17474
 17475     IF PB-C-POST-CARD-IND = 'Y'
 17476        MOVE +8                  TO SUB
 17477*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17478        IF ERMAIL-FOUND = ' '
 17479           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17480              (SUB > +7)
 17481              OR (MA-MAIL-STATUS (SUB) = '1')
 17482           END-PERFORM
 17483        END-IF
 17484        IF (SUB > +7)
 17485           OR (ERMAIL-FOUND = 'X')
 17486           MOVE ER-3789          TO WS-ERROR
 17487           PERFORM 9900-ERROR-FORMAT
 17488                                 THRU 9900-EXIT
 17489        END-IF
 17490     ELSE
 17491        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17492     END-IF
 17493
 17494     IF ERMAIL-FOUND = ' '
 17495        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17496     END-IF.
 17497
 17498     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17499
 17500     IF PB-CI-OB-FLAG = 'Z'
 17501        GO TO 4150-SUMMARY-CERT-CANCEL.
 17502
 17503     IF PB-C-LF-CANCEL-VOIDED
 17504         PERFORM 4200-REVERSE-LF-CANCEL.
 17505     IF PB-C-AH-CANCEL-VOIDED
 17506         PERFORM 4200-REVERSE-AH-CANCEL.
 17507
 17508 4100-APPLY-LF-CANCEL.
 17509
 17510     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 317
* EL050.cbl
 17511
 17512 4100-CHECK-LF-ERRORS.
 17513
 17514     ADD +1                       TO WS-SUB.
 17515
 17516     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17517        IF LF-COVERAGE-CANCELLED
 17518           GO TO 4100-LF-CANCEL-CONT
 17519        ELSE
 17520           GO TO 4100-UPDATE-LF-COVERAGE.
 17521
 17522     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17523                                   ER-2729 OR
 17524                                   ER-2730 OR
 17525                                   ER-2731 OR
 17526                                   ER-2732 OR
 17527                                   ER-2737 OR
 17528                                   ER-2740 OR
 17529                                   ER-2743 OR
 17530                                   ER-2749 OR
 17531                                   ER-2750 OR
 17532                                   ER-2755 OR
 17533                                   ER-2757 OR
 17534                                   ER-2760 OR
 17535                                   ER-2772 OR
 17536                                   ER-2774 OR
 17537                                   ER-2776 OR
 17538                                   ER-2794
 17539        GO TO 4100-UPDATE-LF-COVERAGE.
 17540
 17541     GO TO 4100-CHECK-LF-ERRORS.
 17542
 17543 4100-UPDATE-LF-COVERAGE.
 17544
 17545     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17546     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17547     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17548        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17549     END-IF
 17550     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17551                                      TO CM-CREDIT-INTERFACE-SW-2.
 17552     IF CM-LF-CANCEL-DT = LOW-VALUE
 17553         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17554
 17555     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17556         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17557                                         CM-LF-STATUS-AT-CANCEL.
 17558
 17559     GO TO 4100-APPLY-AH-CANCEL.
 17560
 17561 4100-LF-CANCEL-CONT.
 17562     IF PB-C-LF-CANCEL-VOIDED
 17563         GO TO 4100-APPLY-AH-CANCEL.
 17564
 17565     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17566         GO TO 4100-APPLY-AH-CANCEL.
 17567
 17568     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 318
* EL050.cbl
 17569        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17570           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17571        ELSE
 17572           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17573
 17574     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17575     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17576
 17577     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17578         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17579
 17580     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17581        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17582         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17583         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17584
 17585     IF PB-RECORD-RETURNED
 17586        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17587      ELSE
 17588        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17589
 17590 4100-APPLY-AH-CANCEL.
 17591
 17592     MOVE +0                      TO WS-SUB.
 17593
 17594 4100-CHECK-AH-ERRORS.
 17595
 17596     ADD +1                       TO WS-SUB.
 17597
 17598     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17599        IF AH-COVERAGE-CANCELLED
 17600           GO TO 4100-AH-CANCEL-CONT
 17601        ELSE
 17602           GO TO 4100-UPDATE-AH-COVERAGE.
 17603
 17604     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17605                                   ER-2729 OR
 17606                                   ER-2732 OR
 17607                                   ER-2737 OR
 17608                                   ER-2740 OR
 17609                                   ER-2744 OR
 17610                                   ER-2749 OR
 17611                                   ER-2750 OR
 17612                                   ER-2755 OR
 17613                                   ER-2757 OR
 17614                                   ER-2760 OR
 17615                                   ER-2771 OR
 17616                                   ER-2772 OR
 17617                                   ER-2773 OR
 17618                                   ER-2775 OR
 17619                                   ER-2777 OR
 17620                                   ER-2778 OR
 17621                                   ER-2794
 17622        GO TO 4100-UPDATE-AH-COVERAGE.
 17623
 17624     GO TO 4100-CHECK-AH-ERRORS.
 17625
 17626 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 319
* EL050.cbl
 17627
 17628     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17629     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17630     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17631     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17632                                      TO CM-CREDIT-INTERFACE-SW-2.
 17633     IF CM-AH-CANCEL-DT = LOW-VALUE
 17634         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17635
 17636     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17637         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17638                                         CM-AH-STATUS-AT-CANCEL.
 17639
 17640     IF LF-COVERAGE-CANCELLED
 17641         IF PB-RECORD-RETURNED
 17642              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17643          ELSE
 17644              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17645
 17646     GO TO 4299-EXIT.
 17647
 17648 4100-AH-CANCEL-CONT.
 17649     IF PB-C-AH-CANCEL-VOIDED
 17650         GO TO 4299-EXIT.
 17651
 17652     if cm-credit-interface-sw-2 = ' '
 17653        if pb-fatal-errors or pb-unforced-errors
 17654           move '4'              to cm-credit-interface-sw-2
 17655        else
 17656           move '1'              to cm-credit-interface-sw-2
 17657        end-if
 17658     end-if
 17659     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17660         GO TO 4299-EXIT.
 17661
 17662     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17663        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17664           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17665        ELSE
 17666           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17667
 17668     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17669     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17670
 17671     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17672         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17673
 17674     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17675         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17676         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17677
 17678     IF PB-RECORD-RETURNED
 17679        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17680      ELSE
 17681        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17682
 17683     GO TO 4299-EXIT.
 17684
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 320
* EL050.cbl
 17685 4150-SUMMARY-CERT-CANCEL.
 17686     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17687
 17688     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17689        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17690                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17691     ELSE
 17692        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17693                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17694
 17695     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17696        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17697                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17698     ELSE
 17699        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17700                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17701
 17702     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17703        NEXT SENTENCE
 17704     ELSE
 17705        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17706
 17707     GO TO 4299-EXIT.
 17708
 17709 4200-REVERSE-LF-CANCEL.
 17710     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17711
 17712     IF CM-LF-CANCEL-APPLIED
 17713        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17714        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17715        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17716
 17717     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17718
 17719     IF PB-RECORD-RETURNED
 17720        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17721       ELSE
 17722        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17723
 17724 4200-REVERSE-LF-EXIT.
 17725       EXIT.
 17726
 17727 4200-REVERSE-AH-CANCEL.
 17728     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17729
 17730     IF CM-AH-CANCEL-APPLIED
 17731        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17732        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17733        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17734
 17735     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17736
 17737     IF PB-RECORD-RETURNED
 17738        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17739       ELSE
 17740        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17741
 17742 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 321
* EL050.cbl
 17743       EXIT.
 17744
 17745 4299-EXIT.
 17746       EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 322
* EL050.cbl
 17748
 17749 4500-UPDATE-NEW-CERT.
 17750     IF CERT-WAS-FOUND
 17751         NEXT SENTENCE
 17752       ELSE
 17753         GO TO 4520-BUILD-NEW-KEY.
 17754
 17755     IF  CLASIC-CREATED-CERT
 17756         GO TO 4999-EXIT.
 17757
 17758     IF  CERT-WAS-CREATED-FOR-CLAIM
 17759         GO TO 4520-BUILD-NEW-KEY.
 17760
 17761     IF CERT-ADDED-BATCH
 17762        IF CM-RECORD-ID = 'CM'
 17763            GO TO 4999-EXIT.
 17764
 17765 4520-BUILD-NEW-KEY.
 17766* BUILD CONTROL PRIMARY
 17767
 17768     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17769                                       CM-COMPANY-CD-A1
 17770                                       CM-COMPANY-CD-A2
 17771                                       CM-COMPANY-CD-A4
 17772                                       CM-COMPANY-CD-A5.
 17773
 17774     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17775     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17776     MOVE PB-SV-STATE               TO CM-STATE.
 17777     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17778     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17779     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17780     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17781
 17782     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17783
 17784     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17785     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17786     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17787     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17788
 17789     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17790        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17791
 17792     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17793         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17794         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17795         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17796         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17797     ELSE
 17798         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17799
 17800     IF PB-COMPANY-ID   EQUAL  'CRI'
 17801         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17802         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17803         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17804         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17805         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 323
* EL050.cbl
 17806
 17807     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17808        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17809         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17810
 17811     IF PB-COMPANY-ID  = 'LBL'
 17812        IF PB-I-JOINT-COVERAGE
 17813            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17814                                           PB-I-MEMBER-NO
 17815            GO TO 4550-CONT-CERT-PROCESS.
 17816
 17817     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17818        NEXT SENTENCE
 17819     ELSE
 17820        GO TO 4540-BUILD-MEMBER-NO.
 17821
 17822******************************************************************
 17823*                                                                *
 17824*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17825*    FOR 'MON'.                                                  *
 17826*                                                                *
 17827******************************************************************
 17828
 17829     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17830     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17831     MOVE +1                     TO WS-SUB1
 17832                                    WS-SUB2.
 17833
 17834 4530-EDIT-MEMB-NAME.
 17835
 17836     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17837        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17838        ADD +1                       TO WS-SUB2.
 17839
 17840     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17841        ADD +1                       TO WS-SUB1
 17842        GO TO 4530-EDIT-MEMB-NAME.
 17843
 17844     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17845     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17846     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17847*    MOVE SPACE                      TO DC-OPTION-CODE.
 17848     SET  BIN-TO-GREG                TO TRUE.
 17849     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17850     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17851
 17852     GO TO 4550-CONT-CERT-PROCESS.
 17853
 17854******************************************************************
 17855*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17856******************************************************************
 17857
 17858 4540-BUILD-MEMBER-NO.
 17859
 17860     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17861         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17862         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17863         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 324
* EL050.cbl
 17864         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17865     ELSE
 17866         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17867
 17868     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17869        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17870         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17871
 17872 4550-CONT-CERT-PROCESS.
 17873
 17874*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17875*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17876*    ELSE
 17877*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17878
 17879     IF CERT-WAS-CREATED-FOR-CLAIM
 17880        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17881        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17882
 17883     IF CERT-AND-CLAIM-ONLINE
 17884        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17885        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17886
 17887     MOVE 'CM'                     TO CM-RECORD-ID.
 17888     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17889
 17890     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17891        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17892        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17893     ELSE
 17894        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17895        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17896
 17897     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17898     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17899     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17900     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17901     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17902     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17903     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17904                                      CM-LF-ITD-CANCEL-AMT
 17905                                      CM-LF-ITD-DEATH-AMT
 17906                                      CM-AH-ITD-AH-PMT
 17907                                      CM-AH-ITD-LUMP-PMT
 17908                                      CM-AH-ITD-CANCEL-AMT
 17909                                      CM-LF-NSP-PREMIUM-AMT
 17910                                      CM-AH-NSP-PREMIUM-AMT.
 17911*                                     CM-CLAIM-DEDUCT-WITHHELD
 17912*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17913     if pb-i-loan-apr = +99.9999
 17914        move zeros                 to cm-loan-apr
 17915     else
 17916        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17917     end-if
 17918     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17919     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17920     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17921     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 325
* EL050.cbl
 17922     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17923     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17924     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17925     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17926     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17927     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17928     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17929
 17930     IF PB-I-LIVES NOT NUMERIC
 17931         MOVE ZERO                 TO PB-I-LIVES.
 17932
 17933     IF PB-I-NUM-BILLED NOT NUMERIC
 17934         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17935
 17936     MOVE PB-I-LIVES               TO CM-LIVES.
 17937     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17938
 17939     IF PB-COMPANY-ID EQUAL  'DMD'
 17940         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17941         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17942
 17943     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17944     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17945     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17946     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17947     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17948     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17949
 17950     IF PB-I-LF-POLICY-FEE NUMERIC
 17951        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17952     ELSE
 17953        MOVE +0                    TO CM-LF-POLICY-FEE.
 17954
 17955     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17956        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17957        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17958     ELSE
 17959        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17960
 17961     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17962     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17963     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17964     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17965     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17966     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17967     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17968     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17969     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17970
 17971     IF PB-I-AH-POLICY-FEE NUMERIC
 17972        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17973     ELSE
 17974        MOVE +0                    TO CM-AH-POLICY-FEE.
 17975
 17976     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17977        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17978     ELSE
 17979        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 326
* EL050.cbl
 17980
 17981     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17982     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17983
 17984     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17985                                      CM-LF-DEATH-EXIT-DT
 17986                                      CM-AH-SETTLEMENT-EXIT-DT.
 17987
 17988*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17989*                       'TIH' OR 'OFL' OR 'FLA' OR
 17990*                       'TII' OR 'TMS' OR 'CRI' OR
 17991*                       'NCL'
 17992     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17993
 17994     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17995         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17996            MOVE '2'                TO CM-PREMIUM-TYPE.
 17997
 17998     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17999         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18000            MOVE '2'                TO CM-PREMIUM-TYPE.
 18001
 18002     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18003         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18004     ELSE
 18005         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18006         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18007
 18008     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18009     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18010     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18011     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18012     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18013     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18014     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18015     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18016
 18017     IF PB-NO-MONTHS-SKIPPED
 18018         MOVE SPACE                 TO CM-SKIP-CODE
 18019     ELSE
 18020         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18021
 18022     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18023     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18024                                       CM-LF-STATUS-AT-CANCEL.
 18025
 18026     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18027     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18028                                       CM-AH-STATUS-AT-CANCEL.
 18029
 18030     MOVE '1'                       TO CM-ENTRY-STATUS.
 18031
 18032     IF PB-REISSUED-CERT
 18033        MOVE '5'                    TO CM-ENTRY-STATUS.
 18034
 18035     IF PB-MONTHLY-CERT
 18036        MOVE 'M'                    TO CM-ENTRY-STATUS.
 18037
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 327
* EL050.cbl
 18038     IF PB-CASH-CERT
 18039        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18040
 18041     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18042     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18043     IF PB-POLICY-IS-DECLINED
 18044        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18045
 18046     IF PB-POLICY-IS-VOIDED
 18047        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18048
 18049     IF PB-NEEDS-UNDERWRITING
 18050        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18051
 18052     IF PB-REIN-ONLY-CERT
 18053        MOVE '9'                    TO CM-ENTRY-STATUS.
 18054
 18055     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18056         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18057     ELSE
 18058         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18059
 18060     IF PB-RECORD-RETURNED
 18061        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18062      ELSE
 18063        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18064
 18065     IF PB-I-MAIL-ADDRS-PRESENT
 18066        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18067
 18068     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18069                                       CM-ENTRY-DT.
 18070
 18071 4999-EXIT.
 18072     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 328
* EL050.cbl
 18074
 18075 5000-PROCESS-REPS.
 18076     MOVE ' '                    TO AGTC-MASTER-SW
 18077     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18078     MOVE CO-TYPE                TO AGTC-TYPE
 18079     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18080     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18081     IF (AGTC-MASTER-SW NOT = 'N')
 18082        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18083        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18084        PERFORM 8583-READ-ERAGTC-NEXT
 18085                                 THRU 8583-EXIT
 18086     END-IF
 18087     IF AGTC-MASTER-SW = 'N'
 18088        CONTINUE
 18089     ELSE
 18090        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18091           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18092              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18093              MOVE 'Y'           TO AGTC-MASTER-SW
 18094           END-IF
 18095        END-IF
 18096     END-IF
 18097     .
 18098 5000-EXIT.
 18099     EXIT.
 18100 6370-EDIT-INPUT-LF-CODE.
 18101     move ' ' to ws-benefit-cd-chg-sw
 18102     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18103        MOVE +1                  TO SUB
 18104        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18105        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18106        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18107        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18108        GO TO 6370-SEARCH-LOOP.
 18109
 18110     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18111
 18112     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18113     MOVE SPACES                 TO CNTL-ACCESS.
 18114*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18115     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18116     MOVE +0                     TO CNTL-SEQ-NO.
 18117     MOVE '4' TO RC-SW-2.
 18118     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18119
 18120     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18121        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18122        GO TO 6370-NO-LF-FOUND.
 18123
 18124     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18125     MOVE +1                     TO SUB.
 18126
 18127 6370-SEARCH-LOOP.
 18128     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18129         GO TO 6370-NO-LF-FOUND.
 18130
 18131     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 329
* EL050.cbl
 18132        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18133           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18134           set benefit-code-chg to true
 18135        end-if
 18136        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18137        GO TO 6370-HER-NET-PAY-CHECK.
 18138
 18139     ADD 1   TO SUB.
 18140*    IF SUB GREATER 120
 18141     IF SUB GREATER 200
 18142         GO TO 6370-NO-LF-FOUND.
 18143
 18144     GO TO 6370-SEARCH-LOOP.
 18145
 18146 6370-NO-LF-FOUND.
 18147
 18148     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18149        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18150        set benefit-code-chg to true
 18151     end-if
 18152     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18153
 18154 6370-HER-NET-PAY-CHECK.
 18155
 18156     IF PB-COMPANY-ID = 'CID'
 18157        IF PB-SV-STATE = 'CA' OR 'MN'
 18158           IF PB-I-LF-BENEFIT-CD = '02'
 18159              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18160           ELSE
 18161              IF PB-I-LF-BENEFIT-CD = '04'
 18162                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18163              END-IF
 18164           END-IF
 18165        END-IF
 18166     END-IF
 18167
 18168     IF PB-COMPANY-ID NOT = 'HER'
 18169         GO TO 6370-EXIT.
 18170
 18171     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18172         GO TO 6370-EXIT.
 18173
 18174     IF PB-I-LF-TERM NOT NUMERIC
 18175         MOVE ZEROS              TO PB-I-LF-TERM.
 18176
 18177     IF PB-I-LOAN-TERM NOT NUMERIC
 18178         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18179
 18180     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18181         GO TO 6370-EXIT.
 18182
 18183     IF PB-I-LF-BENEFIT-CD = '33'
 18184         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18185
 18186     IF PB-I-LF-BENEFIT-CD = '34'
 18187         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18188
 18189 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 330
* EL050.cbl
 18190     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 331
* EL050.cbl
 18192
 18193 6380-EDIT-INPUT-AH-CODE.
 18194     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18195        MOVE +1                  TO SUB
 18196        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18197        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18198        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18199        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18200        GO TO 6380-SEARCH-LOOP.
 18201
 18202     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18203
 18204     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18205     MOVE SPACES                 TO CNTL-ACCESS.
 18206     MOVE 'A'                    TO CNTL-REC-TYPE.
 18207*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18208     MOVE +0                     TO CNTL-SEQ-NO.
 18209     MOVE '5' TO RC-SW-2.
 18210     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18211
 18212     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18213        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18214        GO TO 6380-NO-AH-FOUND.
 18215
 18216     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18217     MOVE +1 TO SUB.
 18218
 18219 6380-SEARCH-LOOP.
 18220     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18221         GO TO 6380-NO-AH-FOUND.
 18222
 18223     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18224         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18225         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18226
 18227     ADD 1   TO SUB.
 18228     IF SUB GREATER THAN 96
 18229*    IF SUB GREATER THAN 300
 18230         GO TO 6380-NO-AH-FOUND.
 18231
 18232     GO TO 6380-SEARCH-LOOP.
 18233
 18234 6380-NO-AH-FOUND.
 18235
 18236     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18237
 18238     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18239         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18240     ELSE
 18241         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18242
 18243 6380-CSO-AH-ONLY-CHECKS.
 18244
 18245     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18246        NEXT SENTENCE
 18247      ELSE
 18248        GO TO 6380-EXIT.
 18249
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 332
* EL050.cbl
 18250     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18251         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18252
 18253
 18254     GO TO 6380-EXIT
 18255     .
 18256 6380-CSO-LIFE-WITH-AH-CHECKS.
 18257
 18258
 18259     .
 18260 6380-EXIT.
 18261     EXIT.
 18262
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 333
* EL050.cbl
 18264
 18265 6400-COMPUTE-EXTENSION-DAYS.
 18266
 18267******************************************************************
 18268*                                                                *
 18269*                   COMPUTE EXTENSION DAYS                       *
 18270*                                                                *
 18271*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18272*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18273*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18274*    THE EXTENSION DAYS.                                         *
 18275*                                                                *
 18276******************************************************************
 18277
 18278     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18279     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18280
 18281******************************************************************
 18282*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18283*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18284******************************************************************
 18285
 18286     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18287        COMPUTE WS-ODD-DAYS-OVER =
 18288               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18289     ELSE
 18290        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18291
 18292     IF WS-ODD-DAYS-OVER = ZEROS
 18293           GO TO 6499-EXIT
 18294     ELSE
 18295        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18296           IF WS-WDF-MONTH = 02
 18297              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18298              ADD 2       TO  WS-ODD-DAYS-OVER
 18299              GO TO 6499-EXIT
 18300           ELSE
 18301              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18302                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18303                 GO TO 6499-EXIT
 18304               ELSE
 18305                 GO TO 6499-EXIT
 18306        ELSE
 18307           GO TO 6499-EXIT.
 18308
 18309 6412-CHECK-TO-DAY.
 18310
 18311        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18312           IF WS-WDT-DAY = 28
 18313              ADD 2              TO WS-ODD-DAYS-OVER
 18314           ELSE
 18315              IF WS-WDT-DAY = 29
 18316                 ADD 1           TO WS-ODD-DAYS-OVER
 18317              ELSE
 18318                 NEXT SENTENCE
 18319        ELSE
 18320           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18321              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 334
* EL050.cbl
 18322
 18323     GO TO 6499-EXIT.
 18324
 18325
 18326 6415-CHECK-LEAP-YEAR.
 18327
 18328     IF DC-DAYS-IN-MONTH = 29
 18329        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18330
 18331 6415-EXIT.
 18332     EXIT.
 18333
 18334 6499-EXIT.
 18335      EXIT.
 18336
 18337 6500-END.
 18338     EXIT.
 18339
 18340
 18341******************************************************************
 18342************* PROCEDURE DIVISION FOR EL050 ***********************
 18343********************** ELC50PD END *******************************
 18344
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 335
* EL050.cbl
 18346
 18347**START***********************************************************
 18348*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18349*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18350******************************************************************
 18351*
 18352 6600-GET-STATE-MUNICIPAL-TAX.
 18353
 18354     IF PB-COMPANY-ID NOT = 'DMD'
 18355         GO TO 6640-EXIT.
 18356
 18357     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18358     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18359     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18360*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18361*
 18362***  Y2K PROJ 7744
 18363     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18364     SET BIN-TO-GREG          TO TRUE.
 18365     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18366
 18367     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18368
 18369     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18370     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18371
 18372
 18373* EXEC CICS HANDLE CONDITION
 18374*        INVREQ    (6610-START-BROWSE)
 18375*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18376*        NOTFND    (6630-END-OF-FILE)
 18377*    END-EXEC.
 18378*    MOVE '"$8JI                 ! # #00018360' TO DFHEIV0
 18379     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18381     MOVE X'2320233030303138333630' TO DFHEIV0(25:11)
 18382     CALL 'kxdfhei1' USING DFHEIV0
 18383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18384
 18385
 18386 6610-START-BROWSE.
 18387
 18388
 18389* EXEC CICS HANDLE CONDITION
 18390*        NOTFND    (6630-END-OF-FILE)
 18391*        DISABLED  (6630-ERRESS-PROBLEM)
 18392*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18393*        ENDFILE   (6630-END-OF-FILE)
 18394*    END-EXEC.
 18395*    MOVE '"$IcJ''                ! $ #00018368' TO DFHEIV0
 18396     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18398     MOVE X'2420233030303138333638' TO DFHEIV0(25:11)
 18399     CALL 'kxdfhei1' USING DFHEIV0
 18400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18401
 18402
 18403
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 336
* EL050.cbl
 18404* EXEC CICS STARTBR
 18405*        DATASET (FILE-ID-ERRESS)
 18406*        RIDFLD  (WS-ERRESS-KEY)
 18407*        GTEQ
 18408*    END-EXEC.
 18409     MOVE 0
 18410       TO DFHEIV11
 18411*    MOVE '&,         G          &   #00018375' TO DFHEIV0
 18412     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18413     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18414     MOVE X'2020233030303138333735' TO DFHEIV0(25:11)
 18415     CALL 'kxdfhei1' USING DFHEIV0,
 18416           FILE-ID-ERRESS,
 18417           WS-ERRESS-KEY,
 18418           DFHEIV99,
 18419           DFHEIV11,
 18420           DFHEIV99
 18421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18422
 18423
 18424 6620-READ-NEXT-ERRESS-MASTER.
 18425
 18426
 18427* EXEC CICS HANDLE CONDITION
 18428*        NOTFND    (6630-END-OF-FILE)
 18429*        ENDFILE   (6630-END-OF-FILE)
 18430*        DISABLED  (6630-ERRESS-PROBLEM)
 18431*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18432*    END-EXEC.
 18433*    MOVE '"$I''cJ                ! % #00018383' TO DFHEIV0
 18434     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18436     MOVE X'2520233030303138333833' TO DFHEIV0(25:11)
 18437     CALL 'kxdfhei1' USING DFHEIV0
 18438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18439
 18440
 18441
 18442* EXEC CICS READNEXT
 18443*        DATASET (FILE-ID-ERRESS)
 18444*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18445*        RIDFLD  (WS-ERRESS-KEY)
 18446*    END-EXEC.
 18447     MOVE LENGTH OF
 18448      RESIDENT-STATE-TAX-MASTER
 18449       TO DFHEIV12
 18450     MOVE 0
 18451       TO DFHEIV11
 18452*    MOVE '&.IL                  )   #00018390' TO DFHEIV0
 18453     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18454     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18455     MOVE X'2020233030303138333930' TO DFHEIV0(25:11)
 18456     CALL 'kxdfhei1' USING DFHEIV0,
 18457           FILE-ID-ERRESS,
 18458           RESIDENT-STATE-TAX-MASTER,
 18459           DFHEIV12,
 18460           WS-ERRESS-KEY,
 18461           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 337
* EL050.cbl
 18462           DFHEIV11,
 18463           DFHEIV99,
 18464           DFHEIV99
 18465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18466
 18467
 18468     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18469
 18470* EXEC CICS ENDBR
 18471*            DATASET (FILE-ID-ERRESS)
 18472*       END-EXEC
 18473     MOVE 0
 18474       TO DFHEIV11
 18475*    MOVE '&2                    $   #00018397' TO DFHEIV0
 18476     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18477     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18478     MOVE X'2020233030303138333937' TO DFHEIV0(25:11)
 18479     CALL 'kxdfhei1' USING DFHEIV0,
 18480           FILE-ID-ERRESS,
 18481           DFHEIV11,
 18482           DFHEIV99
 18483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18484        GO TO 6630-END-OF-FILE.
 18485
 18486     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18487        NEXT SENTENCE
 18488      ELSE
 18489        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18490
 18491*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18492*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18493*
 18494     MOVE +2                     TO WS-SUB1.
 18495
 18496     IF PB-ISSUE
 18497     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18498        MOVE +1                  TO WS-SUB1.
 18499
 18500     IF PB-CANCELLATION
 18501     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18502        MOVE +1                  TO WS-SUB1.
 18503*
 18504*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18505*
 18506***  Y2K PROJ 7744
 18507     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18508***  Y2K PROJ 7744
 18509
 18510*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18511* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18512* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18513
 18514     ADD 1                    TO WS-YEAR-YY.
 18515
 18516     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18517         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18518                              TO WS-RES-STATE-TAX
 18519         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 338
* EL050.cbl
 18520                              TO WS-RES-MUNI-TAX
 18521     ELSE
 18522         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18523                              TO WS-RES-STATE-TAX
 18524         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18525                              TO WS-RES-MUNI-TAX.
 18526
 18527*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18528
 18529     IF PB-CANCELLATION
 18530         GO TO 6640-CANCEL-TAX.
 18531
 18532     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18533         COMPUTE PB-I-STATE-TAX ROUNDED =
 18534                                   PB-I-LF-PREMIUM-AMT
 18535                                 * WS-RES-STATE-TAX
 18536         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18537                                   PB-I-LF-PREMIUM-AMT
 18538                                 * WS-RES-MUNI-TAX
 18539     ELSE
 18540     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18541         COMPUTE PB-I-STATE-TAX ROUNDED =
 18542                                   PB-I-AH-PREMIUM-AMT
 18543                                 * WS-RES-STATE-TAX
 18544         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18545                                   PB-I-AH-PREMIUM-AMT
 18546                                 * WS-RES-MUNI-TAX.
 18547
 18548
 18549* EXEC CICS ENDBR
 18550*         DATASET (FILE-ID-ERRESS)
 18551*    END-EXEC.
 18552     MOVE 0
 18553       TO DFHEIV11
 18554*    MOVE '&2                    $   #00018464' TO DFHEIV0
 18555     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18556     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18557     MOVE X'2020233030303138343634' TO DFHEIV0(25:11)
 18558     CALL 'kxdfhei1' USING DFHEIV0,
 18559           FILE-ID-ERRESS,
 18560           DFHEIV11,
 18561           DFHEIV99
 18562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18563
 18564
 18565     GO TO 6640-EXIT.
 18566
 18567 6640-CANCEL-TAX.
 18568     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18569
 18570     IF PB-C-LF-CANCEL-AMT > ZEROS
 18571         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18572                                   PB-C-LF-CANCEL-AMT
 18573                                 * WS-RES-STATE-TAX
 18574         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18575                                   PB-C-LF-CANCEL-AMT
 18576                                *  WS-RES-MUNI-TAX
 18577     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 339
* EL050.cbl
 18578     IF PB-C-AH-CANCEL-AMT > ZEROS
 18579         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18580                                   PB-C-AH-CANCEL-AMT
 18581                                 * WS-RES-STATE-TAX
 18582         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18583                                   PB-C-AH-CANCEL-AMT
 18584                                *  WS-RES-MUNI-TAX.
 18585
 18586
 18587* EXEC CICS ENDBR
 18588*         DATASET (FILE-ID-ERRESS)
 18589*    END-EXEC.
 18590     MOVE 0
 18591       TO DFHEIV11
 18592*    MOVE '&2                    $   #00018489' TO DFHEIV0
 18593     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18594     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18595     MOVE X'2020233030303138343839' TO DFHEIV0(25:11)
 18596     CALL 'kxdfhei1' USING DFHEIV0,
 18597           FILE-ID-ERRESS,
 18598           DFHEIV11,
 18599           DFHEIV99
 18600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18601
 18602
 18603     GO TO 6640-EXIT.
 18604
 18605 6630-END-OF-FILE.
 18606     MOVE ER-8002              TO WS-ERROR.
 18607     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18608
 18609     GO TO 6640-EXIT.
 18610
 18611 6630-ERRESS-PROBLEM.
 18612     MOVE ER-8044              TO WS-ERROR.
 18613     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18614
 18615 6640-EXIT.
 18616     EXIT.
 18617
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 340
* EL050.cbl
 18619 6650-GET-RES-STATE-COMM.
 18620
 18621     IF PB-COMPANY-ID NOT = 'DMD'
 18622         GO TO 6700-COMM-EXIT.
 18623
 18624     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18625     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18626     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18627     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18628     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18629     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18630     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18631
 18632*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18633*
 18634***  Y2K PROJ 7744
 18635     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18636     SET BIN-TO-GREG          TO TRUE.
 18637     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18638
 18639     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18640***  Y2K PROJ 7744
 18641
 18642     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18643
 18644
 18645* EXEC CICS HANDLE CONDITION
 18646*        INVREQ    (6660-START-BROWSE)
 18647*        DISABLED  (6690-ERRESC-PROBLEM)
 18648*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18649*        NOTFND    (6690-END-OF-FILE)
 18650*    END-EXEC.
 18651*    MOVE '"$8cJI                ! & #00018534' TO DFHEIV0
 18652     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18653     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18654     MOVE X'2620233030303138353334' TO DFHEIV0(25:11)
 18655     CALL 'kxdfhei1' USING DFHEIV0
 18656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18657
 18658
 18659
 18660* EXEC CICS RESETBR
 18661*        DATASET (FILE-ID-ERRESC)
 18662*        RIDFLD  (WS-ERRESC-KEY)
 18663*    END-EXEC.
 18664     MOVE 0
 18665       TO DFHEIV11
 18666*    MOVE '&4         G          &   #00018541' TO DFHEIV0
 18667     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18668     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18669     MOVE X'2020233030303138353431' TO DFHEIV0(25:11)
 18670     CALL 'kxdfhei1' USING DFHEIV0,
 18671           FILE-ID-ERRESC,
 18672           WS-ERRESC-KEY,
 18673           DFHEIV99,
 18674           DFHEIV11,
 18675           DFHEIV99
 18676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 341
* EL050.cbl
 18677
 18678
 18679 6660-START-BROWSE.
 18680
 18681
 18682* EXEC CICS HANDLE CONDITION
 18683*        NOTFND    (6690-END-OF-FILE)
 18684*        DISABLED  (6690-ERRESC-PROBLEM)
 18685*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18686*        ENDFILE   (6690-END-OF-FILE)
 18687*    END-EXEC.
 18688*    MOVE '"$IcJ''                ! '' #00018548' TO DFHEIV0
 18689     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18691     MOVE X'2720233030303138353438' TO DFHEIV0(25:11)
 18692     CALL 'kxdfhei1' USING DFHEIV0
 18693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18694
 18695
 18696
 18697* EXEC CICS STARTBR
 18698*        DATASET (FILE-ID-ERRESC)
 18699*        RIDFLD  (WS-ERRESC-KEY)
 18700*        GTEQ
 18701*    END-EXEC.
 18702     MOVE 0
 18703       TO DFHEIV11
 18704*    MOVE '&,         G          &   #00018555' TO DFHEIV0
 18705     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18706     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18707     MOVE X'2020233030303138353535' TO DFHEIV0(25:11)
 18708     CALL 'kxdfhei1' USING DFHEIV0,
 18709           FILE-ID-ERRESC,
 18710           WS-ERRESC-KEY,
 18711           DFHEIV99,
 18712           DFHEIV11,
 18713           DFHEIV99
 18714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18715
 18716
 18717     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18718
 18719 6670-READ-NEXT-ERRESC-MASTER.
 18720
 18721
 18722* EXEC CICS HANDLE CONDITION
 18723*        NOTFND    (6690-END-OF-FILE)
 18724*        DISABLED  (6690-ERRESC-PROBLEM)
 18725*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18726*        ENDFILE   (6690-END-OF-FILE)
 18727*    END-EXEC.
 18728*    MOVE '"$IcJ''                ! ( #00018565' TO DFHEIV0
 18729     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18731     MOVE X'2820233030303138353635' TO DFHEIV0(25:11)
 18732     CALL 'kxdfhei1' USING DFHEIV0
 18733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18734
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 342
* EL050.cbl
 18735
 18736
 18737* EXEC CICS READNEXT
 18738*        DATASET (FILE-ID-ERRESC)
 18739*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18740*        RIDFLD  (ERRESC-RECORD-KEY)
 18741*    END-EXEC.
 18742     MOVE LENGTH OF
 18743      ACCOUNT-RESIDENT-ST-COMMISSION
 18744       TO DFHEIV12
 18745     MOVE 0
 18746       TO DFHEIV11
 18747*    MOVE '&.IL                  )   #00018572' TO DFHEIV0
 18748     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18749     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18750     MOVE X'2020233030303138353732' TO DFHEIV0(25:11)
 18751     CALL 'kxdfhei1' USING DFHEIV0,
 18752           FILE-ID-ERRESC,
 18753           ACCOUNT-RESIDENT-ST-COMMISSION,
 18754           DFHEIV12,
 18755           ERRESC-RECORD-KEY,
 18756           DFHEIV99,
 18757           DFHEIV11,
 18758           DFHEIV99,
 18759           DFHEIV99
 18760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18761
 18762
 18763     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18764        NEXT SENTENCE
 18765     ELSE
 18766
 18767* EXEC CICS ENDBR
 18768*            DATASET (FILE-ID-ERRESC)
 18769*       END-EXEC
 18770     MOVE 0
 18771       TO DFHEIV11
 18772*    MOVE '&2                    $   #00018581' TO DFHEIV0
 18773     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18774     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18775     MOVE X'2020233030303138353831' TO DFHEIV0(25:11)
 18776     CALL 'kxdfhei1' USING DFHEIV0,
 18777           FILE-ID-ERRESC,
 18778           DFHEIV11,
 18779           DFHEIV99
 18780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18781        GO TO 6690-END-OF-FILE.
 18782
 18783     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18784
 18785* EXEC CICS ENDBR
 18786*            DATASET (FILE-ID-ERRESC)
 18787*       END-EXEC
 18788     MOVE 0
 18789       TO DFHEIV11
 18790*    MOVE '&2                    $   #00018587' TO DFHEIV0
 18791     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18792     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 343
* EL050.cbl
 18793     MOVE X'2020233030303138353837' TO DFHEIV0(25:11)
 18794     CALL 'kxdfhei1' USING DFHEIV0,
 18795           FILE-ID-ERRESC,
 18796           DFHEIV11,
 18797           DFHEIV99
 18798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18799        GO TO 6690-END-OF-FILE.
 18800
 18801     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18802        NEXT SENTENCE
 18803      ELSE
 18804        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18805
 18806* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18807*
 18808     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18809
 18810     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18811
 18812     IF WS-SUB1 > ZERO
 18813         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18814             PERFORM 6680-SET-COMMISSION
 18815         ELSE
 18816             PERFORM 6680-SET-TABLE-CODE.
 18817
 18818
 18819* EXEC CICS ENDBR
 18820*         DATASET (FILE-ID-ERRESC)
 18821*    END-EXEC.
 18822     MOVE 0
 18823       TO DFHEIV11
 18824*    MOVE '&2                    $   #00018609' TO DFHEIV0
 18825     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18827     MOVE X'2020233030303138363039' TO DFHEIV0(25:11)
 18828     CALL 'kxdfhei1' USING DFHEIV0,
 18829           FILE-ID-ERRESC,
 18830           DFHEIV11,
 18831           DFHEIV99
 18832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18833
 18834
 18835     GO TO 6700-COMM-EXIT.
 18836
 18837 6680-SET-TABLE-CODE.
 18838     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18839        MOVE ZEROS             TO WS-SUB1
 18840     ELSE
 18841* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18842* TO COMPUTE AH COMMISSION.
 18843        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18844        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18845        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18846        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18847        PERFORM 6680-READ-CTBL-TABLE
 18848        IF WS-CTBL-READ-SW NOT = 'Y'
 18849           MOVE ZEROS          TO WS-SUB1.
 18850
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 344
* EL050.cbl
 18851 6680-READ-CTBL-TABLE.
 18852*
 18853* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18854* TO COMPUTE LIFE COMMISSION
 18855
 18856     IF CTBL-SW = '0540'
 18857        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18858        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18859        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18860
 18861     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18862
 18863     IF CTBL-TABLE-FOUND
 18864        IF CTBL-SW = '0530'
 18865             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18866                                    * PB-I-AH-TERM
 18867             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18868             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18869        ELSE
 18870             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18871             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18872             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18873     ELSE
 18874        IF FIRST-TIME-THROUGH
 18875            GO TO 6680-READ-CTBL-TABLE
 18876        ELSE
 18877            MOVE ZEROS         TO WS-SUB1.
 18878
 18879 6680-SET-COMMISSION.
 18880     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18881           MOVE ZEROS          TO WS-SUB1
 18882       ELSE
 18883           MOVE RESC-COMMISSION-PER (WS-SUB)
 18884                               TO WS-COMMISSION
 18885           IF CTBL-SW = '0530'
 18886               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18887           ELSE
 18888               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18889
 18890 6680-SEARCH-CATEGORY.
 18891     ADD +1                   TO WS-SUB.
 18892     IF WS-SUB > +12
 18893         GO TO 6680-EXIT.
 18894
 18895     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18896          MOVE WS-SUB         TO WS-SUB1
 18897          GO TO 6680-EXIT.
 18898
 18899     GO TO 6680-SEARCH-CATEGORY.
 18900
 18901 6680-EXIT.
 18902     EXIT.
 18903
 18904 6690-END-OF-FILE.
 18905     GO TO 6700-COMM-EXIT.
 18906
 18907 6690-ERRESC-PROBLEM.
 18908      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 345
* EL050.cbl
 18909      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18910
 18911      GO TO 6700-COMM-EXIT.
 18912
 18913 6700-COMM-EXIT.
 18914     EXIT.
 18915
 18916 7000-GET-RATE.
 18917
 18918* EXEC CICS LINK
 18919*        PROGRAM    ('ELRATE')
 18920*        COMMAREA   (CALCULATION-PASS-AREA)
 18921*        LENGTH     (CP-COMM-LENGTH)
 18922*    END-EXEC.
 18923     MOVE 'ELRATE' TO DFHEIV1
 18924*    MOVE '."C                   (   #00018695' TO DFHEIV0
 18925     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18926     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18927     MOVE X'2020233030303138363935' TO DFHEIV0(25:11)
 18928     CALL 'kxdfhei1' USING DFHEIV0,
 18929           DFHEIV1,
 18930           CALCULATION-PASS-AREA,
 18931           CP-COMM-LENGTH,
 18932           DFHEIV99,
 18933           DFHEIV99,
 18934           DFHEIV99,
 18935           DFHEIV99
 18936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18937
 18938
 18939 7000-EXIT.
 18940     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 346
* EL050.cbl
 18942 7100-FIND-BENEFIT-IN-STATE.
 18943     MOVE 'N'                    TO BEN-SEARCH-SW.
 18944
 18945     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18946         VARYING SUB3 FROM 1 BY 1 UNTIL
 18947            ((SUB3 GREATER 50) OR
 18948              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18949               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18950
 18951     IF SUB3 NOT = 51
 18952         MOVE 'Y'                TO BEN-SEARCH-SW.
 18953
 18954     GO TO 7199-EXIT.
 18955
 18956 7100-BENEFIT-DUMMY.
 18957
 18958 7100-DUMMY-EXIT.
 18959     EXIT.
 18960
 18961 7199-EXIT.
 18962     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 347
* EL050.cbl
 18964 7200-FIND-BENEFIT.
 18965     MOVE 'N'                    TO BEN-SEARCH-SW.
 18966
 18967     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18968         VARYING SUB3 FROM 1 BY 1 UNTIL
 18969            ((SUB3 GREATER 8) OR
 18970            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18971
 18972     IF SUB3 NOT = 9
 18973         MOVE 'Y'                TO BEN-SEARCH-SW.
 18974
 18975     GO TO 7200-EXIT.
 18976
 18977 7200-BENEFIT-DUMMY.
 18978
 18979 7200-DUMMY-EXIT.
 18980     EXIT.
 18981
 18982 7200-EXIT.
 18983     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 348
* EL050.cbl
 18985 7250-LOOK-FOR-RESCINDED-CLAIM.
 18986     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18987                                    W-CL-COMP-CD.
 18988     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18989                                    W-CL-CERT-NO.
 18990
 18991
 18992* EXEC CICS HANDLE CONDITION
 18993*        NOTFND  (7250-CONTINUE)
 18994*        ENDFILE (7250-CONTINUE)
 18995*    END-EXEC.
 18996*    MOVE '"$I''                  ! ) #00018753' TO DFHEIV0
 18997     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18998     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18999     MOVE X'2920233030303138373533' TO DFHEIV0(25:11)
 19000     CALL 'kxdfhei1' USING DFHEIV0
 19001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19002
 19003
 19004
 19005* EXEC CICS IGNORE CONDITION
 19006*        DUPKEY
 19007*    END-EXEC.
 19008*    MOVE '"*$                   !   #00018758' TO DFHEIV0
 19009     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19011     MOVE X'2020233030303138373538' TO DFHEIV0(25:11)
 19012     CALL 'kxdfhei1' USING DFHEIV0
 19013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19014
 19015
 19016
 19017* EXEC CICS STARTBR
 19018*        DATASET   (CLMS-ID)
 19019*        RIDFLD    (ELMSTR-KEY)
 19020*        GENERIC   EQUAL
 19021*        KEYLENGTH (ELMSTR-LENGTH)
 19022*    END-EXEC.
 19023     MOVE 0
 19024       TO DFHEIV11
 19025*    MOVE '&,   KG    E          &   #00018762' TO DFHEIV0
 19026     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19027     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19028     MOVE X'2020233030303138373632' TO DFHEIV0(25:11)
 19029     CALL 'kxdfhei1' USING DFHEIV0,
 19030           CLMS-ID,
 19031           ELMSTR-KEY,
 19032           ELMSTR-LENGTH,
 19033           DFHEIV11,
 19034           DFHEIV99
 19035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19036
 19037
 19038     MOVE 'Y'                    TO W-BROWSE-SW.
 19039
 19040 7250-NEXT-CLAIM.
 19041
 19042
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 349
* EL050.cbl
 19043* EXEC CICS READNEXT
 19044*        DATASET   (CLMS-ID)
 19045*        RIDFLD    (ELMSTR-KEY)
 19046*        SET       (ADDRESS OF CLAIM-MASTER)
 19047*    END-EXEC.
 19048     MOVE 0
 19049       TO DFHEIV11
 19050*    MOVE '&.S                   )   #00018773' TO DFHEIV0
 19051     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19052     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19053     MOVE X'2020233030303138373733' TO DFHEIV0(25:11)
 19054     CALL 'kxdfhei1' USING DFHEIV0,
 19055           CLMS-ID,
 19056           DFHEIV20,
 19057           DFHEIV99,
 19058           ELMSTR-KEY,
 19059           DFHEIV99,
 19060           DFHEIV11,
 19061           DFHEIV99,
 19062           DFHEIV99
 19063     SET ADDRESS OF CLAIM-MASTER TO
 19064         DFHEIV20
 19065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19066
 19067
 19068     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19069        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19070         GO TO 7250-CONTINUE
 19071     END-IF.
 19072
 19073     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19074        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19075        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19076        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19077        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19078         GO TO 7250-NEXT-CLAIM
 19079     END-IF.
 19080
 19081     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19082        OR (CL-CLAIM-TYPE = 'I')
 19083        OR (CL-CLAIM-TYPE = 'G')
 19084        OR (CL-CLAIM-TYPE = 'F')
 19085          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19086              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19087              GO TO 7250-CONTINUE
 19088          END-IF
 19089     END-IF.
 19090
 19091     GO TO 7250-NEXT-CLAIM.
 19092
 19093 7250-CONTINUE.
 19094
 19095     IF W-BROWSE-SW = 'Y'
 19096
 19097* EXEC CICS ENDBR
 19098*            DATASET   (CLMS-ID)
 19099*        END-EXEC
 19100     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 350
* EL050.cbl
 19101       TO DFHEIV11
 19102*    MOVE '&2                    $   #00018807' TO DFHEIV0
 19103     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19104     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19105     MOVE X'2020233030303138383037' TO DFHEIV0(25:11)
 19106     CALL 'kxdfhei1' USING DFHEIV0,
 19107           CLMS-ID,
 19108           DFHEIV11,
 19109           DFHEIV99
 19110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19111         MOVE 'N' TO W-BROWSE-SW
 19112     END-IF.
 19113
 19114 7250-EXIT.
 19115     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 351
* EL050.cbl
 19117 7300-CHECK-FOR-OPEN-CLMS.
 19118
 19119*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19120*    MOVE SPACES                 TO CNTL-ACCESS.
 19121*    MOVE '1'                    TO CNTL-REC-TYPE.
 19122*    MOVE +0                     TO CNTL-SEQ-NO.
 19123
 19124*    MOVE '3'                    TO RC-SW-1.
 19125*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19126
 19127*    IF NOT CF-COMPANY-MASTER
 19128*         PERFORM 0099-COMPANY-NOT-FOUND
 19129*         GO TO 7300-EXIT.
 19130
 19131     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19132                                    W-CL-COMP-CD.
 19133     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19134                                    W-CL-CERT-NO.
 19135
 19136
 19137* EXEC CICS HANDLE CONDITION
 19138*        NOTFND  (7300-CONTINUE)
 19139*        ENDFILE (7300-CONTINUE)
 19140*    END-EXEC.
 19141*    MOVE '"$I''                  ! * #00018835' TO DFHEIV0
 19142     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19144     MOVE X'2A20233030303138383335' TO DFHEIV0(25:11)
 19145     CALL 'kxdfhei1' USING DFHEIV0
 19146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19147
 19148
 19149
 19150* EXEC CICS IGNORE CONDITION
 19151*        DUPKEY
 19152*    END-EXEC.
 19153*    MOVE '"*$                   !   #00018840' TO DFHEIV0
 19154     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19155     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19156     MOVE X'2020233030303138383430' TO DFHEIV0(25:11)
 19157     CALL 'kxdfhei1' USING DFHEIV0
 19158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19159
 19160
 19161
 19162* EXEC CICS STARTBR
 19163*        DATASET   (CLMS-ID)
 19164*        RIDFLD    (ELMSTR-KEY)
 19165*        GENERIC   EQUAL
 19166*        KEYLENGTH (ELMSTR-LENGTH)
 19167*    END-EXEC.
 19168     MOVE 0
 19169       TO DFHEIV11
 19170*    MOVE '&,   KG    E          &   #00018844' TO DFHEIV0
 19171     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19172     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19173     MOVE X'2020233030303138383434' TO DFHEIV0(25:11)
 19174     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 352
* EL050.cbl
 19175           CLMS-ID,
 19176           ELMSTR-KEY,
 19177           ELMSTR-LENGTH,
 19178           DFHEIV11,
 19179           DFHEIV99
 19180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19181
 19182
 19183     MOVE 'Y'                    TO W-BROWSE-SW.
 19184
 19185 7300-NEXT-CLAIM.
 19186
 19187
 19188* EXEC CICS READNEXT
 19189*        DATASET   (CLMS-ID)
 19190*        RIDFLD    (ELMSTR-KEY)
 19191*        SET       (ADDRESS OF CLAIM-MASTER)
 19192*    END-EXEC.
 19193     MOVE 0
 19194       TO DFHEIV11
 19195*    MOVE '&.S                   )   #00018855' TO DFHEIV0
 19196     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19197     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19198     MOVE X'2020233030303138383535' TO DFHEIV0(25:11)
 19199     CALL 'kxdfhei1' USING DFHEIV0,
 19200           CLMS-ID,
 19201           DFHEIV20,
 19202           DFHEIV99,
 19203           ELMSTR-KEY,
 19204           DFHEIV99,
 19205           DFHEIV11,
 19206           DFHEIV99,
 19207           DFHEIV99
 19208     SET ADDRESS OF CLAIM-MASTER TO
 19209         DFHEIV20
 19210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19211
 19212
 19213     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19214        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19215         GO TO 7300-CONTINUE.
 19216
 19217     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19218        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19219        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19220        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19221        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19222         GO TO 7300-NEXT-CLAIM.
 19223
 19224*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19225     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19226        OR (CL-CLAIM-TYPE = 'I')
 19227        OR (CL-CLAIM-TYPE = 'G')
 19228        OR (CL-CLAIM-TYPE = 'F')
 19229        IF CLAIM-IS-OPEN
 19230           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19231             AND PB-C-AH-CANCEL-DT > SPACES
 19232              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 353
* EL050.cbl
 19233              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19234           END-IF
 19235           EVALUATE TRUE
 19236             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19237                 MOVE ER-2884      TO WS-ERROR
 19238             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19239                 MOVE ER-2887      TO WS-ERROR
 19240             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19241                 MOVE ER-2886      TO WS-ERROR
 19242             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19243                 MOVE ER-2888      TO WS-ERROR
 19244             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19245                 MOVE ER-2885      TO WS-ERROR
 19246             WHEN OTHER
 19247                 MOVE ER-2768      TO WS-ERROR
 19248           END-EVALUATE
 19249           IF PB-C-AH-CANCEL-VOIDED OR
 19250              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19251                NOT AH-COVERAGE-CANCELLED)
 19252               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19253               MOVE ER-2768      TO WS-ERROR
 19254           END-IF
 19255           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19256           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19257              PB-FORCE-CODE NOT EQUAL '8'
 19258               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19259           END-IF
 19260           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19261           GO TO 7300-NEXT-CLAIM
 19262        ELSE
 19263           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19264*****THIS IS A RESCISSION OR REFORMATION
 19265              IF AH-COVERAGE-CANCELLED
 19266                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19267                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19268                    MOVE 1                   TO DC-ELAPSED-DAYS
 19269                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19270                    SET BIN-PLUS-ELAPSED     TO TRUE
 19271                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19272                    IF NO-CONVERSION-ERROR
 19273                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19274                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19275                          MOVE ER-2897 TO WS-ERROR
 19276                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19277                          GO TO 7300-NEXT-CLAIM
 19278                       END-IF
 19279                    END-IF
 19280                 ELSE
 19281                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19282                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19283                         MOVE ER-2890 TO WS-ERROR
 19284                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19285                         GO TO 7300-NEXT-CLAIM
 19286                      ELSE
 19287                         MOVE ER-2898 TO WS-ERROR
 19288                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19289                         GO TO 7300-NEXT-CLAIM
 19290                      END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 354
* EL050.cbl
 19291                   END-IF
 19292                 END-IF
 19293              END-IF
 19294           ELSE
 19295              IF CL-DENIAL-TYPE = '1'  AND
 19296                 CL-TOTAL-PAID-AMT = 0
 19297                    GO TO 7300-NEXT-CLAIM
 19298              END-IF
 19299              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19300               AND PB-C-AH-CANCEL-DT > SPACES
 19301                 MOVE ER-2756        TO WS-ERROR
 19302                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19303                 GO TO 7300-NEXT-CLAIM
 19304              END-IF
 19305           END-IF
 19306        END-IF
 19307     ELSE
 19308*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19309        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19310           IF (CLAIM-IS-OPEN)
 19311              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19312                 <> zeros
 19313              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19314                 <> zeros)
 19315              MOVE ER-2889      TO WS-ERROR
 19316              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19317              GO TO 7300-NEXT-CLAIM
 19318           ELSE
 19319              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19320*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19321                 IF (LF-COVERAGE-CANCELLED AND
 19322                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19323                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19324                         MOVE ER-2890 TO WS-ERROR
 19325                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19326                         GO TO 7300-NEXT-CLAIM
 19327                      ELSE
 19328                         MOVE ER-2898 TO WS-ERROR
 19329                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19330                         GO TO 7300-NEXT-CLAIM
 19331                      END-IF
 19332                 END-IF
 19333              ELSE
 19334                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19335                    and (CL-TOTAL-PAID-AMT = 0)
 19336                    GO TO 7300-NEXT-CLAIM
 19337                 END-IF
 19338                 IF (
 19339                      (AH-COVERAGE-CANCELLED)
 19340                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19341                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19342                      and (pb-ci-ah-cancel-amt +
 19343                         pb-c-ah-cancel-amt) <> zeros
 19344                    )
 19345                               OR
 19346                    (
 19347                      (LF-COVERAGE-CANCELLED)
 19348                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 355
* EL050.cbl
 19349                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19350                      and (pb-ci-lf-cancel-amt +
 19351                         pb-c-lf-cancel-amt) <> zeros
 19352                    )
 19353                       MOVE ER-2965 TO WS-ERROR
 19354                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19355                       GO TO 7300-NEXT-CLAIM
 19356                 END-IF
 19357                 IF LF-COVERAGE-CANCELLED
 19358                  IF CL-TOTAL-PAID-AMT > 0
 19359                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19360                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19361                        MOVE ER-2891 TO WS-ERROR
 19362                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19363                        GO TO 7300-NEXT-CLAIM
 19364                      END-IF
 19365                    ELSE
 19366****only show this error if cert num matches exactly
 19367                      IF PB-CERT-NO = CL-CERT-NO
 19368                         MOVE ER-2892 TO WS-ERROR
 19369                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19370                         GO TO 7300-NEXT-CLAIM
 19371                      END-IF
 19372                    END-IF
 19373                  END-IF
 19374                 END-IF
 19375              END-IF
 19376           END-IF
 19377        END-IF
 19378     END-IF
 19379
 19380     GO TO 7300-NEXT-CLAIM.
 19381
 19382 7300-CONTINUE.
 19383
 19384     IF W-BROWSE-SW = 'Y'
 19385
 19386* EXEC CICS ENDBR
 19387*            DATASET   (CLMS-ID)
 19388*        END-EXEC.
 19389     MOVE 0
 19390       TO DFHEIV11
 19391*    MOVE '&2                    $   #00019033' TO DFHEIV0
 19392     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19393     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19394     MOVE X'2020233030303139303333' TO DFHEIV0(25:11)
 19395     CALL 'kxdfhei1' USING DFHEIV0,
 19396           CLMS-ID,
 19397           DFHEIV11,
 19398           DFHEIV99
 19399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19400
 19401
 19402 7300-EXIT.
 19403     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 356
* EL050.cbl
 19405
 19406 7400-GET-REMAIN-TERM.
 19407
 19408* EXEC CICS LINK
 19409*        PROGRAM    ('ELRTRM')
 19410*        COMMAREA   (CALCULATION-PASS-AREA)
 19411*        LENGTH     (CP-COMM-LENGTH)
 19412*    END-EXEC.
 19413     MOVE 'ELRTRM' TO DFHEIV1
 19414*    MOVE '."C                   (   #00019042' TO DFHEIV0
 19415     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19417     MOVE X'2020233030303139303432' TO DFHEIV0(25:11)
 19418     CALL 'kxdfhei1' USING DFHEIV0,
 19419           DFHEIV1,
 19420           CALCULATION-PASS-AREA,
 19421           CP-COMM-LENGTH,
 19422           DFHEIV99,
 19423           DFHEIV99,
 19424           DFHEIV99,
 19425           DFHEIV99
 19426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19427
 19428
 19429 7400-EXIT.
 19430     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 357
* EL050.cbl
 19432
 19433 7500-GET-REMAIN-AMOUNT.
 19434
 19435* EXEC CICS LINK
 19436*        PROGRAM    ('ELRAMT')
 19437*        COMMAREA   (CALCULATION-PASS-AREA)
 19438*        LENGTH     (CP-COMM-LENGTH)
 19439*    END-EXEC.
 19440     MOVE 'ELRAMT' TO DFHEIV1
 19441*    MOVE '."C                   (   #00019053' TO DFHEIV0
 19442     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19443     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19444     MOVE X'2020233030303139303533' TO DFHEIV0(25:11)
 19445     CALL 'kxdfhei1' USING DFHEIV0,
 19446           DFHEIV1,
 19447           CALCULATION-PASS-AREA,
 19448           CP-COMM-LENGTH,
 19449           DFHEIV99,
 19450           DFHEIV99,
 19451           DFHEIV99,
 19452           DFHEIV99
 19453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19454
 19455
 19456 7500-EXIT.
 19457     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 358
* EL050.cbl
 19459
 19460 7600-GET-REFUND.
 19461
 19462* EXEC CICS LINK
 19463*        PROGRAM    ('ELRFND')
 19464*        COMMAREA   (CALCULATION-PASS-AREA)
 19465*        LENGTH     (CP-COMM-LENGTH)
 19466*    END-EXEC.
 19467     MOVE 'ELRFND' TO DFHEIV1
 19468*    MOVE '."C                   (   #00019064' TO DFHEIV0
 19469     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19471     MOVE X'2020233030303139303634' TO DFHEIV0(25:11)
 19472     CALL 'kxdfhei1' USING DFHEIV0,
 19473           DFHEIV1,
 19474           CALCULATION-PASS-AREA,
 19475           CP-COMM-LENGTH,
 19476           DFHEIV99,
 19477           DFHEIV99,
 19478           DFHEIV99,
 19479           DFHEIV99
 19480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19481
 19482
 19483 7600-EXIT.
 19484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 359
* EL050.cbl
 19486 7700-CALL-DL1.
 19487
 19488* EXEC CICS LINK
 19489*        PROGRAM    ('DLO001')
 19490*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19491*        LENGTH     (DLO001-COMM-LENGTH)
 19492*    END-EXEC.
 19493     MOVE 'DLO001' TO DFHEIV1
 19494*    MOVE '."C                   (   #00019074' TO DFHEIV0
 19495     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19497     MOVE X'2020233030303139303734' TO DFHEIV0(25:11)
 19498     CALL 'kxdfhei1' USING DFHEIV0,
 19499           DFHEIV1,
 19500           WS-DLO-MASTER-POLICY-FORM,
 19501           DLO001-COMM-LENGTH,
 19502           DFHEIV99,
 19503           DFHEIV99,
 19504           DFHEIV99,
 19505           DFHEIV99
 19506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19507
 19508
 19509 7700-EXIT.
 19510     EXIT.
 19511
 19512 7710-CALL-DL2.
 19513
 19514* EXEC CICS LINK
 19515*        PROGRAM    ('DLO002')
 19516*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19517*        LENGTH     (DLO002-COMM-LENGTH)
 19518*    END-EXEC.
 19519     MOVE 'DLO002' TO DFHEIV1
 19520*    MOVE '."C                   (   #00019084' TO DFHEIV0
 19521     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19523     MOVE X'2020233030303139303834' TO DFHEIV0(25:11)
 19524     CALL 'kxdfhei1' USING DFHEIV0,
 19525           DFHEIV1,
 19526           WS-DLO-INTERNAL-POLICY-FORM,
 19527           DLO002-COMM-LENGTH,
 19528           DFHEIV99,
 19529           DFHEIV99,
 19530           DFHEIV99,
 19531           DFHEIV99
 19532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19533
 19534
 19535 7710-EXIT.
 19536     EXIT.
 19537
 19538 7720-CALL-DL3.
 19539
 19540* EXEC CICS LINK
 19541*        PROGRAM    ('DLO003')
 19542*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19543*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 360
* EL050.cbl
 19544*    END-EXEC.
 19545     MOVE 'DLO003' TO DFHEIV1
 19546*    MOVE '."C                   (   #00019094' TO DFHEIV0
 19547     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19548     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19549     MOVE X'2020233030303139303934' TO DFHEIV0(25:11)
 19550     CALL 'kxdfhei1' USING DFHEIV0,
 19551           DFHEIV1,
 19552           WS-DLO-VALID-BANK-ID,
 19553           DLO003-COMM-LENGTH,
 19554           DFHEIV99,
 19555           DFHEIV99,
 19556           DFHEIV99,
 19557           DFHEIV99
 19558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19559
 19560
 19561 7720-EXIT.
 19562     EXIT.
 19563
 19564 7730-CALL-DL7.
 19565
 19566* EXEC CICS LINK
 19567*        PROGRAM    ('DLO007')
 19568*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19569*        LENGTH     (DLO007-COMM-LENGTH)
 19570*    END-EXEC.
 19571     MOVE 'DLO007' TO DFHEIV1
 19572*    MOVE '."C                   (   #00019104' TO DFHEIV0
 19573     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19574     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19575     MOVE X'2020233030303139313034' TO DFHEIV0(25:11)
 19576     CALL 'kxdfhei1' USING DFHEIV0,
 19577           DFHEIV1,
 19578           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19579           DLO007-COMM-LENGTH,
 19580           DFHEIV99,
 19581           DFHEIV99,
 19582           DFHEIV99,
 19583           DFHEIV99
 19584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19585
 19586
 19587 7730-EXIT.
 19588     EXIT.
 19589
 19590 7740-CALL-DL11.
 19591
 19592* EXEC CICS LINK
 19593*        PROGRAM    ('DLO011')
 19594*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19595*        LENGTH     (DLO011-COMM-LENGTH)
 19596*    END-EXEC.
 19597     MOVE 'DLO011' TO DFHEIV1
 19598*    MOVE '."C                   (   #00019114' TO DFHEIV0
 19599     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19600     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19601     MOVE X'2020233030303139313134' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 361
* EL050.cbl
 19602     CALL 'kxdfhei1' USING DFHEIV0,
 19603           DFHEIV1,
 19604           WS-DLO-PREM-RATES-BEN-TYPE,
 19605           DLO011-COMM-LENGTH,
 19606           DFHEIV99,
 19607           DFHEIV99,
 19608           DFHEIV99,
 19609           DFHEIV99
 19610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19611
 19612
 19613 7740-EXIT.
 19614     EXIT.
 19615
 19616 7750-CALL-DL17.
 19617
 19618* EXEC CICS LINK
 19619*        PROGRAM    ('DLO017')
 19620*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19621*        LENGTH     (DLO017-COMM-LENGTH)
 19622*    END-EXEC.
 19623     MOVE 'DLO017' TO DFHEIV1
 19624*    MOVE '."C                   (   #00019124' TO DFHEIV0
 19625     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19627     MOVE X'2020233030303139313234' TO DFHEIV0(25:11)
 19628     CALL 'kxdfhei1' USING DFHEIV0,
 19629           DFHEIV1,
 19630           WS-DLO-VALID-RATE-CODE,
 19631           DLO017-COMM-LENGTH,
 19632           DFHEIV99,
 19633           DFHEIV99,
 19634           DFHEIV99,
 19635           DFHEIV99
 19636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19637
 19638
 19639 7750-EXIT.
 19640     EXIT.
 19641
 19642 7755-CALL-DL19.
 19643
 19644* EXEC CICS LINK
 19645*        PROGRAM    ('DLO019')
 19646*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19647*        LENGTH     (DLO019-COMM-LENGTH)
 19648*    END-EXEC.
 19649     MOVE 'DLO019' TO DFHEIV1
 19650*    MOVE '."C                   (   #00019134' TO DFHEIV0
 19651     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19653     MOVE X'2020233030303139313334' TO DFHEIV0(25:11)
 19654     CALL 'kxdfhei1' USING DFHEIV0,
 19655           DFHEIV1,
 19656           WS-DLO-ORIG-COV-CAT,
 19657           DLO019-COMM-LENGTH,
 19658           DFHEIV99,
 19659           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 362
* EL050.cbl
 19660           DFHEIV99,
 19661           DFHEIV99
 19662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19663
 19664
 19665 7755-EXIT.
 19666     EXIT.
 19667
 19668 7760-CALL-DL21.
 19669
 19670* EXEC CICS LINK
 19671*        PROGRAM    ('DLO021')
 19672*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19673*        LENGTH     (DLO021-COMM-LENGTH)
 19674*    END-EXEC.
 19675     MOVE 'DLO021' TO DFHEIV1
 19676*    MOVE '."C                   (   #00019144' TO DFHEIV0
 19677     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19678     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19679     MOVE X'2020233030303139313434' TO DFHEIV0(25:11)
 19680     CALL 'kxdfhei1' USING DFHEIV0,
 19681           DFHEIV1,
 19682           WS-DLO-VALID-LOAN-OFFICER,
 19683           DLO021-COMM-LENGTH,
 19684           DFHEIV99,
 19685           DFHEIV99,
 19686           DFHEIV99,
 19687           DFHEIV99
 19688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19689
 19690
 19691 7760-EXIT.
 19692     EXIT.
 19693
 19694 7770-CALL-DL22.
 19695
 19696* EXEC CICS LINK
 19697*        PROGRAM    ('DLO022')
 19698*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19699*        LENGTH     (DLO022-COMM-LENGTH)
 19700*    END-EXEC.
 19701     MOVE 'DLO022' TO DFHEIV1
 19702*    MOVE '."C                   (   #00019154' TO DFHEIV0
 19703     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19705     MOVE X'2020233030303139313534' TO DFHEIV0(25:11)
 19706     CALL 'kxdfhei1' USING DFHEIV0,
 19707           DFHEIV1,
 19708           WS-DLO-VALID-STATE-CODE,
 19709           DLO022-COMM-LENGTH,
 19710           DFHEIV99,
 19711           DFHEIV99,
 19712           DFHEIV99,
 19713           DFHEIV99
 19714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19715
 19716
 19717 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 363
* EL050.cbl
 19718     EXIT.
 19719
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 364
* EL050.cbl
 19721
 19722 7780-CALL-AGG.
 19723
 19724* EXEC CICS LINK
 19725*        PROGRAM    ('ELAGGO')
 19726*        COMMAREA   (WS-PASS-to-pemaggo)
 19727*        LENGTH     (ws-passed-key-LENGTH)
 19728*    END-EXEC.
 19729     MOVE 'ELAGGO' TO DFHEIV1
 19730*    MOVE '."C                   (   #00019166' TO DFHEIV0
 19731     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19733     MOVE X'2020233030303139313636' TO DFHEIV0(25:11)
 19734     CALL 'kxdfhei1' USING DFHEIV0,
 19735           DFHEIV1,
 19736           WS-PASS-to-pemaggo,
 19737           ws-passed-key-LENGTH,
 19738           DFHEIV99,
 19739           DFHEIV99,
 19740           DFHEIV99,
 19741           DFHEIV99
 19742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19743
 19744 7780-EXIT.
 19745     EXIT.
 19746 7800-REWRITE-CERT.
 19747******************************************************************
 19748*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19749*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19750******************************************************************
 19751
 19752     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19753        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19754        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19755        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19756
 19757* EXEC CICS REWRITE
 19758*                  DATASET (CERT-ID)
 19759*                  FROM    (CERTIFICATE-MASTER)
 19760*              END-EXEC
 19761     MOVE LENGTH OF
 19762      CERTIFICATE-MASTER
 19763       TO DFHEIV11
 19764*    MOVE '&& L                  %   #00019183' TO DFHEIV0
 19765     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19766     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19767     MOVE X'2020233030303139313833' TO DFHEIV0(25:11)
 19768     CALL 'kxdfhei1' USING DFHEIV0,
 19769           CERT-ID,
 19770           CERTIFICATE-MASTER,
 19771           DFHEIV11,
 19772           DFHEIV99
 19773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19774        GO TO 7800-EXIT.
 19775
 19776       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19777       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19778
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 365
* EL050.cbl
 19779 7800-EXIT.
 19780      EXIT.
 19781
 19782 7900-DELETE-CERT.
 19783
 19784* EXEC CICS DELETE
 19785*        DATASET (CERT-ID)
 19786*    END-EXEC.
 19787*    MOVE '&(                    &   #00019196' TO DFHEIV0
 19788     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19789     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19790     MOVE X'2020233030303139313936' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0,
 19792           CERT-ID,
 19793           DFHEIV99,
 19794           DFHEIV99,
 19795           DFHEIV99,
 19796           DFHEIV99
 19797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19798
 19799
 19800 7900-EXIT.
 19801     EXIT.
 19802
 19803 8000-WRITE-CERT.
 19804
 19805* EXEC CICS HANDLE CONDITION
 19806*        DUPKEY    (8000-FREE-MAIN)
 19807*    END-EXEC.
 19808*    MOVE '"$$                   ! + #00019204' TO DFHEIV0
 19809     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19810     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19811     MOVE X'2B20233030303139323034' TO DFHEIV0(25:11)
 19812     CALL 'kxdfhei1' USING DFHEIV0
 19813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19814
 19815
 19816
 19817* EXEC CICS WRITE
 19818*        DATASET     (CERT-ID)
 19819*        FROM        (CERTIFICATE-MASTER)
 19820*        RIDFLD      (ELCERT-KEY)
 19821*    END-EXEC.
 19822     MOVE LENGTH OF
 19823      CERTIFICATE-MASTER
 19824       TO DFHEIV11
 19825*    MOVE '&$ L                  ''   #00019208' TO DFHEIV0
 19826     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19827     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19828     MOVE X'2020233030303139323038' TO DFHEIV0(25:11)
 19829     CALL 'kxdfhei1' USING DFHEIV0,
 19830           CERT-ID,
 19831           CERTIFICATE-MASTER,
 19832           DFHEIV11,
 19833           ELCERT-KEY,
 19834           DFHEIV99,
 19835           DFHEIV99
 19836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 366
* EL050.cbl
 19837
 19838
 19839 8000-FREE-MAIN.
 19840
 19841 8000-EXIT.
 19842      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 367
* EL050.cbl
 19844
 19845 8100-READ-ERPNDM.
 19846
 19847* EXEC CICS HANDLE CONDITION
 19848*         NOTFND     (8100-NOTFND)
 19849*         ENDFILE    (8100-NOTFND)
 19850*    END-EXEC.
 19851*    MOVE '"$I''                  ! , #00019221' TO DFHEIV0
 19852     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19853     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19854     MOVE X'2C20233030303139323231' TO DFHEIV0(25:11)
 19855     CALL 'kxdfhei1' USING DFHEIV0
 19856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19857
 19858
 19859     MOVE SPACES                 TO ERPNDM-FOUND.
 19860     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19861
 19862
 19863* EXEC CICS READ
 19864*         DATASET   (FILE-ERPNDM)
 19865*         RIDFLD    (PM-CONTROL-PRIMARY)
 19866*         INTO      (PENDING-MAILING-DATA)
 19867*    END-EXEC.
 19868     MOVE LENGTH OF
 19869      PENDING-MAILING-DATA
 19870       TO DFHEIV11
 19871*    MOVE '&"IL       E          (   #00019229' TO DFHEIV0
 19872     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19874     MOVE X'2020233030303139323239' TO DFHEIV0(25:11)
 19875     CALL 'kxdfhei1' USING DFHEIV0,
 19876           FILE-ERPNDM,
 19877           PENDING-MAILING-DATA,
 19878           DFHEIV11,
 19879           PM-CONTROL-PRIMARY,
 19880           DFHEIV99,
 19881           DFHEIV99,
 19882           DFHEIV99
 19883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19884
 19885
 19886     GO TO 8100-EXIT.
 19887
 19888 8100-NOTFND.
 19889
 19890     MOVE 'X'                    TO ERPNDM-FOUND.
 19891     MOVE ER-2694                TO WS-ERROR.
 19892     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19893     MOVE ER-2883                TO WS-ERROR
 19894     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19895     .
 19896 8100-EXIT.
 19897     EXIT.
 19898
 19899 8110-READ-ERMAIL.
 19900
 19901* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 368
* EL050.cbl
 19902*         NOTFND     (8110-NOTFND)
 19903*         ENDFILE    (8110-NOTFND)
 19904*    END-EXEC.
 19905*    MOVE '"$I''                  ! - #00019249' TO DFHEIV0
 19906     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19908     MOVE X'2D20233030303139323439' TO DFHEIV0(25:11)
 19909     CALL 'kxdfhei1' USING DFHEIV0
 19910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19911
 19912
 19913     MOVE SPACES                 TO ERMAIL-FOUND.
 19914     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19915     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19916     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19917     MOVE PB-SV-STATE            TO MA-STATE.
 19918
 19919
 19920* EXEC CICS READ
 19921*         UPDATE
 19922*         DATASET   (FILE-ERMAIL)
 19923*         RIDFLD    (MA-CONTROL-PRIMARY)
 19924*         INTO      (MAILING-DATA)
 19925*    END-EXEC.
 19926     MOVE LENGTH OF
 19927      MAILING-DATA
 19928       TO DFHEIV11
 19929*    MOVE '&"IL       EU         (   #00019260' TO DFHEIV0
 19930     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19931     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19932     MOVE X'2020233030303139323630' TO DFHEIV0(25:11)
 19933     CALL 'kxdfhei1' USING DFHEIV0,
 19934           FILE-ERMAIL,
 19935           MAILING-DATA,
 19936           DFHEIV11,
 19937           MA-CONTROL-PRIMARY,
 19938           DFHEIV99,
 19939           DFHEIV99,
 19940           DFHEIV99
 19941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19942
 19943
 19944     GO TO 8110-EXIT.
 19945
 19946 8110-NOTFND.
 19947     MOVE 'X'                    TO ERMAIL-FOUND.
 19948
 19949 8110-EXIT.
 19950     EXIT.
 19951
 19952 8120-REWRITE-ERMAIL.
 19953
 19954* EXEC CICS REWRITE
 19955*         DATASET    (FILE-ERMAIL)
 19956*         FROM       (MAILING-DATA)
 19957*    END-EXEC.
 19958     MOVE LENGTH OF
 19959      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 369
* EL050.cbl
 19960       TO DFHEIV11
 19961*    MOVE '&& L                  %   #00019276' TO DFHEIV0
 19962     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19963     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19964     MOVE X'2020233030303139323736' TO DFHEIV0(25:11)
 19965     CALL 'kxdfhei1' USING DFHEIV0,
 19966           FILE-ERMAIL,
 19967           MAILING-DATA,
 19968           DFHEIV11,
 19969           DFHEIV99
 19970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19971
 19972
 19973 8120-EXIT.
 19974     EXIT.
 19975
 19976 8130-WRITE-ERMAIL.
 19977
 19978* EXEC CICS HANDLE CONDITION
 19979*         DUPKEY   (8130-EXIT)
 19980*    END-EXEC.
 19981*    MOVE '"$$                   ! . #00019285' TO DFHEIV0
 19982     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19983     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19984     MOVE X'2E20233030303139323835' TO DFHEIV0(25:11)
 19985     CALL 'kxdfhei1' USING DFHEIV0
 19986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19987
 19988
 19989
 19990* EXEC CICS WRITE
 19991*         DATASET     (FILE-ERMAIL)
 19992*         RIDFLD      (MA-CONTROL-PRIMARY)
 19993*         FROM        (MAILING-DATA)
 19994*    END-EXEC.
 19995     MOVE LENGTH OF
 19996      MAILING-DATA
 19997       TO DFHEIV11
 19998*    MOVE '&$ L                  ''   #00019289' TO DFHEIV0
 19999     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20000     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20001     MOVE X'2020233030303139323839' TO DFHEIV0(25:11)
 20002     CALL 'kxdfhei1' USING DFHEIV0,
 20003           FILE-ERMAIL,
 20004           MAILING-DATA,
 20005           DFHEIV11,
 20006           MA-CONTROL-PRIMARY,
 20007           DFHEIV99,
 20008           DFHEIV99
 20009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20010
 20011
 20012 8130-EXIT.
 20013     EXIT.
 20014
 20015 8140-UNLOCK-ERMAIL.
 20016
 20017* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 370
* EL050.cbl
 20018*         DATASET   (FILE-ERMAIL)
 20019*    END-EXEC.
 20020*    MOVE '&*                    #   #00019299' TO DFHEIV0
 20021     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20022     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20023     MOVE X'2020233030303139323939' TO DFHEIV0(25:11)
 20024     CALL 'kxdfhei1' USING DFHEIV0,
 20025           FILE-ERMAIL,
 20026           DFHEIV99
 20027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20028
 20029
 20030 8140-EXIT.
 20031     EXIT.
 20032
 20033 8150-read-elcrtt.
 20034
 20035
 20036* EXEC CICS HANDLE CONDITION
 20037*        NOTFND   (8150-exit)
 20038*    END-EXEC
 20039*    MOVE '"$I                   ! / #00019308' TO DFHEIV0
 20040     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20042     MOVE X'2F20233030303139333038' TO DFHEIV0(25:11)
 20043     CALL 'kxdfhei1' USING DFHEIV0
 20044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20045
 20046     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20047     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20048
 20049
 20050* EXEC CICS READ
 20051*        DATASET  (CRTT-ID)
 20052*        RIDFLD   (WS-ELCRTT-KEY)
 20053*        INTO     (CERTIFICATE-TRAILERS)
 20054*    END-EXEC
 20055     MOVE LENGTH OF
 20056      CERTIFICATE-TRAILERS
 20057       TO DFHEIV11
 20058*    MOVE '&"IL       E          (   #00019315' TO DFHEIV0
 20059     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20061     MOVE X'2020233030303139333135' TO DFHEIV0(25:11)
 20062     CALL 'kxdfhei1' USING DFHEIV0,
 20063           CRTT-ID,
 20064           CERTIFICATE-TRAILERS,
 20065           DFHEIV11,
 20066           WS-ELCRTT-KEY,
 20067           DFHEIV99,
 20068           DFHEIV99,
 20069           DFHEIV99
 20070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20071
 20072     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20073     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20074
 20075     .
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 371
* EL050.cbl
 20076 8150-exit.
 20077     exit.
 20078 8180-UPDATE-VIN-NUMBER.
 20079
 20080* EXEC CICS HANDLE CONDITION
 20081*        NOTFND   (8180-NOTFND)
 20082*    END-EXEC.
 20083*    MOVE '"$I                   ! 0 #00019328' TO DFHEIV0
 20084     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20086     MOVE X'3020233030303139333238' TO DFHEIV0(25:11)
 20087     CALL 'kxdfhei1' USING DFHEIV0
 20088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20089
 20090
 20091     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20092     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20093
 20094
 20095* EXEC CICS READ
 20096*        UPDATE
 20097*        DATASET  (CRTT-ID)
 20098*        RIDFLD   (WS-ELCRTT-KEY)
 20099*        INTO     (CERTIFICATE-TRAILERS)
 20100*    END-EXEC.
 20101     MOVE LENGTH OF
 20102      CERTIFICATE-TRAILERS
 20103       TO DFHEIV11
 20104*    MOVE '&"IL       EU         (   #00019335' TO DFHEIV0
 20105     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20106     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20107     MOVE X'2020233030303139333335' TO DFHEIV0(25:11)
 20108     CALL 'kxdfhei1' USING DFHEIV0,
 20109           CRTT-ID,
 20110           CERTIFICATE-TRAILERS,
 20111           DFHEIV11,
 20112           WS-ELCRTT-KEY,
 20113           DFHEIV99,
 20114           DFHEIV99,
 20115           DFHEIV99
 20116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20117
 20118
 20119     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20120         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20121
 20122* EXEC CICS REWRITE
 20123*           DATASET  (CRTT-ID)
 20124*           FROM     (CERTIFICATE-TRAILERS)
 20125*        END-EXEC
 20126     MOVE LENGTH OF
 20127      CERTIFICATE-TRAILERS
 20128       TO DFHEIV11
 20129*    MOVE '&& L                  %   #00019344' TO DFHEIV0
 20130     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20131     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20132     MOVE X'2020233030303139333434' TO DFHEIV0(25:11)
 20133     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 372
* EL050.cbl
 20134           CRTT-ID,
 20135           CERTIFICATE-TRAILERS,
 20136           DFHEIV11,
 20137           DFHEIV99
 20138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20139     ELSE
 20140
 20141* EXEC CICS UNLOCK
 20142*          DATASET  (CRTT-ID)
 20143*       END-EXEC
 20144*    MOVE '&*                    #   #00019349' TO DFHEIV0
 20145     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20146     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20147     MOVE X'2020233030303139333439' TO DFHEIV0(25:11)
 20148     CALL 'kxdfhei1' USING DFHEIV0,
 20149           CRTT-ID,
 20150           DFHEIV99
 20151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20152     END-IF.
 20153
 20154     GO TO 8180-EXIT.
 20155
 20156 8180-NOTFND.
 20157
 20158     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20159     MOVE 'CS'         TO CS-RECORD-ID.
 20160     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20161     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20162     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20163     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20164
 20165* EXEC CICS WRITE
 20166*       DATASET  (CRTT-ID)
 20167*       RIDFLD   (WS-ELCRTT-KEY)
 20168*       FROM     (CERTIFICATE-TRAILERS)
 20169*    END-EXEC.
 20170     MOVE LENGTH OF
 20171      CERTIFICATE-TRAILERS
 20172       TO DFHEIV11
 20173*    MOVE '&$ L                  ''   #00019364' TO DFHEIV0
 20174     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20175     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20176     MOVE X'2020233030303139333634' TO DFHEIV0(25:11)
 20177     CALL 'kxdfhei1' USING DFHEIV0,
 20178           CRTT-ID,
 20179           CERTIFICATE-TRAILERS,
 20180           DFHEIV11,
 20181           WS-ELCRTT-KEY,
 20182           DFHEIV99,
 20183           DFHEIV99
 20184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20185
 20186
 20187 8180-EXIT.
 20188     EXIT.
 20189
 20190 8190-UPDATE-REFUND-CLAIM-FLAG.
 20191
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 373
* EL050.cbl
 20192* EXEC CICS HANDLE CONDITION
 20193*        NOTFND   (8190-NOTFND)
 20194*    END-EXEC.
 20195*    MOVE '"$I                   ! 1 #00019374' TO DFHEIV0
 20196     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20198     MOVE X'3120233030303139333734' TO DFHEIV0(25:11)
 20199     CALL 'kxdfhei1' USING DFHEIV0
 20200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20201
 20202
 20203     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20204     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20205
 20206
 20207* EXEC CICS READ
 20208*        UPDATE
 20209*        DATASET  (CRTT-ID)
 20210*        RIDFLD   (WS-ELCRTT-KEY)
 20211*        INTO     (CERTIFICATE-TRAILERS)
 20212*    END-EXEC.
 20213     MOVE LENGTH OF
 20214      CERTIFICATE-TRAILERS
 20215       TO DFHEIV11
 20216*    MOVE '&"IL       EU         (   #00019381' TO DFHEIV0
 20217     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20218     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20219     MOVE X'2020233030303139333831' TO DFHEIV0(25:11)
 20220     CALL 'kxdfhei1' USING DFHEIV0,
 20221           CRTT-ID,
 20222           CERTIFICATE-TRAILERS,
 20223           DFHEIV11,
 20224           WS-ELCRTT-KEY,
 20225           DFHEIV99,
 20226           DFHEIV99,
 20227           DFHEIV99
 20228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20229
 20230
 20231     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20232
 20233* EXEC CICS REWRITE
 20234*       DATASET  (CRTT-ID)
 20235*       FROM     (CERTIFICATE-TRAILERS)
 20236*    END-EXEC.
 20237     MOVE LENGTH OF
 20238      CERTIFICATE-TRAILERS
 20239       TO DFHEIV11
 20240*    MOVE '&& L                  %   #00019389' TO DFHEIV0
 20241     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20243     MOVE X'2020233030303139333839' TO DFHEIV0(25:11)
 20244     CALL 'kxdfhei1' USING DFHEIV0,
 20245           CRTT-ID,
 20246           CERTIFICATE-TRAILERS,
 20247           DFHEIV11,
 20248           DFHEIV99
 20249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 374
* EL050.cbl
 20250
 20251
 20252     GO TO 8190-EXIT.
 20253
 20254 8190-NOTFND.
 20255
 20256     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20257     MOVE 'CS'         TO CS-RECORD-ID.
 20258     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20259     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20260     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20261     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20262
 20263* EXEC CICS WRITE
 20264*       DATASET  (CRTT-ID)
 20265*       RIDFLD   (WS-ELCRTT-KEY)
 20266*       FROM     (CERTIFICATE-TRAILERS)
 20267*    END-EXEC.
 20268     MOVE LENGTH OF
 20269      CERTIFICATE-TRAILERS
 20270       TO DFHEIV11
 20271*    MOVE '&$ L                  ''   #00019404' TO DFHEIV0
 20272     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20273     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20274     MOVE X'2020233030303139343034' TO DFHEIV0(25:11)
 20275     CALL 'kxdfhei1' USING DFHEIV0,
 20276           CRTT-ID,
 20277           CERTIFICATE-TRAILERS,
 20278           DFHEIV11,
 20279           WS-ELCRTT-KEY,
 20280           DFHEIV99,
 20281           DFHEIV99
 20282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20283
 20284
 20285 8190-EXIT.
 20286     EXIT.
 20287
 20288 8195-UPDATE-AGE-FLAGS.
 20289
 20290* EXEC CICS HANDLE CONDITION
 20291*        NOTFND   (8195-NOTFND)
 20292*    END-EXEC.
 20293*    MOVE '"$I                   ! 2 #00019414' TO DFHEIV0
 20294     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20296     MOVE X'3220233030303139343134' TO DFHEIV0(25:11)
 20297     CALL 'kxdfhei1' USING DFHEIV0
 20298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20299
 20300
 20301     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20302     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20303
 20304
 20305* EXEC CICS READ
 20306*        UPDATE
 20307*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 375
* EL050.cbl
 20308*        RIDFLD   (WS-ELCRTT-KEY)
 20309*        INTO     (CERTIFICATE-TRAILERS)
 20310*    END-EXEC.
 20311     MOVE LENGTH OF
 20312      CERTIFICATE-TRAILERS
 20313       TO DFHEIV11
 20314*    MOVE '&"IL       EU         (   #00019421' TO DFHEIV0
 20315     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20316     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20317     MOVE X'2020233030303139343231' TO DFHEIV0(25:11)
 20318     CALL 'kxdfhei1' USING DFHEIV0,
 20319           CRTT-ID,
 20320           CERTIFICATE-TRAILERS,
 20321           DFHEIV11,
 20322           WS-ELCRTT-KEY,
 20323           DFHEIV99,
 20324           DFHEIV99,
 20325           DFHEIV99
 20326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20327
 20328
 20329     IF WS-INS-AGE-SET = 'Y'
 20330        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20331     END-IF
 20332     IF WS-JNT-AGE-SET = 'Y'
 20333        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20334     END-IF
 20335
 20336
 20337* EXEC CICS REWRITE
 20338*       DATASET  (CRTT-ID)
 20339*       FROM     (CERTIFICATE-TRAILERS)
 20340*    END-EXEC.
 20341     MOVE LENGTH OF
 20342      CERTIFICATE-TRAILERS
 20343       TO DFHEIV11
 20344*    MOVE '&& L                  %   #00019435' TO DFHEIV0
 20345     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20347     MOVE X'2020233030303139343335' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           CRTT-ID,
 20350           CERTIFICATE-TRAILERS,
 20351           DFHEIV11,
 20352           DFHEIV99
 20353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20354
 20355
 20356     GO TO 8195-EXIT.
 20357
 20358 8195-NOTFND.
 20359
 20360     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20361     MOVE 'CS'         TO CS-RECORD-ID.
 20362     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20363     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20364     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20365     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 376
* EL050.cbl
 20366     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20367
 20368* EXEC CICS WRITE
 20369*       DATASET  (CRTT-ID)
 20370*       RIDFLD   (WS-ELCRTT-KEY)
 20371*       FROM     (CERTIFICATE-TRAILERS)
 20372*    END-EXEC.
 20373     MOVE LENGTH OF
 20374      CERTIFICATE-TRAILERS
 20375       TO DFHEIV11
 20376*    MOVE '&$ L                  ''   #00019451' TO DFHEIV0
 20377     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20378     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20379     MOVE X'2020233030303139343531' TO DFHEIV0(25:11)
 20380     CALL 'kxdfhei1' USING DFHEIV0,
 20381           CRTT-ID,
 20382           CERTIFICATE-TRAILERS,
 20383           DFHEIV11,
 20384           WS-ELCRTT-KEY,
 20385           DFHEIV99,
 20386           DFHEIV99
 20387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20388
 20389
 20390 8195-EXIT.
 20391     EXIT.
 20392
 20393 8200-READ-REIN-TABLE.
 20394
 20395* EXEC CICS HANDLE CONDITION
 20396*         NOTFND   (8200-NOTFND)
 20397*    END-EXEC.
 20398*    MOVE '"$I                   ! 3 #00019461' TO DFHEIV0
 20399     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20401     MOVE X'3320233030303139343631' TO DFHEIV0(25:11)
 20402     CALL 'kxdfhei1' USING DFHEIV0
 20403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20404
 20405
 20406
 20407* EXEC CICS READ
 20408*        DATASET     (REIN-ID)
 20409*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20410*        RIDFLD      (ERREIN-KEY)
 20411*    END-EXEC.
 20412*    MOVE '&"S        E          (   #00019465' TO DFHEIV0
 20413     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20415     MOVE X'2020233030303139343635' TO DFHEIV0(25:11)
 20416     CALL 'kxdfhei1' USING DFHEIV0,
 20417           REIN-ID,
 20418           DFHEIV20,
 20419           DFHEIV99,
 20420           ERREIN-KEY,
 20421           DFHEIV99,
 20422           DFHEIV99,
 20423           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 377
* EL050.cbl
 20424     SET ADDRESS OF REINSURANCE-RECORD TO
 20425         DFHEIV20
 20426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20427
 20428
 20429     GO TO 8200-EXIT.
 20430
 20431 8200-NOTFND.
 20432     MOVE 'N'             TO WS-REIN-READ-SW.
 20433
 20434 8200-EXIT.
 20435      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 378
* EL050.cbl
 20437
 20438 8300-READ-CTBL-TABLE.
 20439
 20440* EXEC CICS HANDLE CONDITION
 20441*        NOTFND    (8300-NOTFND)
 20442*        DISABLED  (8300-ERRESS-PROBLEM)
 20443*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20444*        ENDFILE   (8300-NOTFND)
 20445*    END-EXEC.
 20446*    MOVE '"$IcJ''                ! 4 #00019481' TO DFHEIV0
 20447     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20449     MOVE X'3420233030303139343831' TO DFHEIV0(25:11)
 20450     CALL 'kxdfhei1' USING DFHEIV0
 20451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20452
 20453
 20454
 20455* EXEC CICS READ
 20456*        DATASET     (CTBL-ID)
 20457*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20458*        RIDFLD      (ERCTBL-KEY)
 20459*    END-EXEC.
 20460*    MOVE '&"S        E          (   #00019488' TO DFHEIV0
 20461     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20462     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20463     MOVE X'2020233030303139343838' TO DFHEIV0(25:11)
 20464     CALL 'kxdfhei1' USING DFHEIV0,
 20465           CTBL-ID,
 20466           DFHEIV20,
 20467           DFHEIV99,
 20468           ERCTBL-KEY,
 20469           DFHEIV99,
 20470           DFHEIV99,
 20471           DFHEIV99
 20472     SET ADDRESS OF COMM-TABLE-RECORD TO
 20473         DFHEIV20
 20474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20475
 20476
 20477     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20478
 20479     GO TO 8300-EXIT.
 20480
 20481 8300-NOTFND.
 20482
 20483     IF CTBL-SW = '0530'
 20484         MOVE 'AA'                     TO WS-AH-COMP-CD
 20485         MOVE '0550'                   TO CTBL-SW
 20486         MOVE '1'                      TO WS-CTBL-READ-SW
 20487         GO TO 8300-EXIT.
 20488
 20489     IF CTBL-SW = '0540'
 20490         MOVE 'AA'                     TO WS-LF-COMP-CD
 20491         MOVE '0550'                   TO CTBL-SW
 20492         MOVE '1'                      TO WS-CTBL-READ-SW
 20493         GO TO 8300-EXIT.
 20494
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 379
* EL050.cbl
 20495     IF CTBL-SW = '0550'
 20496         MOVE '2'                      TO WS-CTBL-READ-SW
 20497         GO TO 8300-EXIT.
 20498
 20499     GO TO 8300-EXIT.
 20500
 20501 8300-ERRESS-PROBLEM.
 20502
 20503      MOVE ER-8050              TO WS-ERROR.
 20504      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20505
 20506     GO TO 8300-EXIT.
 20507
 20508 8300-EXIT.
 20509      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 380
* EL050.cbl
 20511
 20512
 20513 8400-GETMAIN-ERFORM.
 20514
 20515
 20516* EXEC CICS   GETMAIN
 20517*        LENGTH  (500)
 20518*        SET     (ADDRESS OF FORM-MASTER)
 20519*    END-EXEC.
 20520     MOVE 500
 20521       TO DFHEIV11
 20522*    MOVE '," L                  $   #00019532' TO DFHEIV0
 20523     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20524     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20525     MOVE X'2020233030303139353332' TO DFHEIV0(25:11)
 20526     CALL 'kxdfhei1' USING DFHEIV0,
 20527           DFHEIV20,
 20528           DFHEIV11,
 20529           DFHEIV99
 20530     SET ADDRESS OF FORM-MASTER TO
 20531         DFHEIV20
 20532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20533
 20534
 20535     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20536
 20537 8400-EXIT.
 20538      EXIT.
 20539
 20540 8450-READ-FORM-MASTER.
 20541
 20542
 20543* EXEC CICS  HANDLE CONDITION
 20544*        NOTFND   (8450-FORM-NOT-FOUND)
 20545*        ENDFILE  (8450-FORM-NOT-FOUND)
 20546*    END-EXEC.
 20547*    MOVE '"$I''                  ! 5 #00019544' TO DFHEIV0
 20548     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20550     MOVE X'3520233030303139353434' TO DFHEIV0(25:11)
 20551     CALL 'kxdfhei1' USING DFHEIV0
 20552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20553
 20554
 20555
 20556* EXEC CICS   READ
 20557*        DATASET   (FORM-ID)
 20558*        RIDFLD    (ERFORM-KEY)
 20559*        INTO      (FORM-MASTER)
 20560*        GTEQ
 20561*    END-EXEC.
 20562     MOVE LENGTH OF
 20563      FORM-MASTER
 20564       TO DFHEIV11
 20565*    MOVE '&"IL       G          (   #00019549' TO DFHEIV0
 20566     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20567     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20568     MOVE X'2020233030303139353439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 381
* EL050.cbl
 20569     CALL 'kxdfhei1' USING DFHEIV0,
 20570           FORM-ID,
 20571           FORM-MASTER,
 20572           DFHEIV11,
 20573           ERFORM-KEY,
 20574           DFHEIV99,
 20575           DFHEIV99,
 20576           DFHEIV99
 20577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20578
 20579
 20580     MOVE  'Y'           TO  FORM-MASTER-SW.
 20581
 20582     GO TO  8450-EXIT.
 20583
 20584 8450-FORM-NOT-FOUND.
 20585
 20586     MOVE  'N'           TO  FORM-MASTER-SW.
 20587
 20588 8450-EXIT.
 20589      EXIT.
 20590
 20591 8500-DATE-CONVERT.
 20592
 20593* EXEC CICS LINK
 20594*        PROGRAM    ('ELDATCV')
 20595*        COMMAREA   (DATE-CONVERSION-DATA)
 20596*        LENGTH     (DC-COMM-LENGTH)
 20597*    END-EXEC.
 20598     MOVE 'ELDATCV' TO DFHEIV1
 20599*    MOVE '."C                   (   #00019568' TO DFHEIV0
 20600     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20601     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20602     MOVE X'2020233030303139353638' TO DFHEIV0(25:11)
 20603     CALL 'kxdfhei1' USING DFHEIV0,
 20604           DFHEIV1,
 20605           DATE-CONVERSION-DATA,
 20606           DC-COMM-LENGTH,
 20607           DFHEIV99,
 20608           DFHEIV99,
 20609           DFHEIV99,
 20610           DFHEIV99
 20611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20612
 20613
 20614 8500-EXIT.
 20615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 382
* EL050.cbl
 20617
 20618 8555-RELOAD-CONTROL-FILE.
 20619     CONTINUE.
 20620
 20621 8555-EXIT.
 20622     EXIT.
 20623
 20624 8557-GETMAIN-ERPLAN.
 20625
 20626
 20627* EXEC CICS GETMAIN
 20628*        LENGTH    (840)
 20629*        SET       (ADDRESS OF PLAN-RECORDS)
 20630*    END-EXEC.
 20631     MOVE 840
 20632       TO DFHEIV11
 20633*    MOVE '," L                  $   #00019586' TO DFHEIV0
 20634     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20635     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20636     MOVE X'2020233030303139353836' TO DFHEIV0(25:11)
 20637     CALL 'kxdfhei1' USING DFHEIV0,
 20638           DFHEIV20,
 20639           DFHEIV11,
 20640           DFHEIV99
 20641     SET ADDRESS OF PLAN-RECORDS TO
 20642         DFHEIV20
 20643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20644
 20645
 20646     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20647
 20648 8557-EXIT.
 20649     EXIT.
 20650
 20651 8560-GETMAIN.
 20652
 20653* EXEC CICS GETMAIN
 20654*        LENGTH    (2000)
 20655*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20656*    END-EXEC.
 20657     MOVE 2000
 20658       TO DFHEIV11
 20659*    MOVE '," L                  $   #00019597' TO DFHEIV0
 20660     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20661     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20662     MOVE X'2020233030303139353937' TO DFHEIV0(25:11)
 20663     CALL 'kxdfhei1' USING DFHEIV0,
 20664           DFHEIV20,
 20665           DFHEIV11,
 20666           DFHEIV99
 20667     SET ADDRESS OF ACCOUNT-MASTER TO
 20668         DFHEIV20
 20669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20670
 20671
 20672     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20673
 20674 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 383
* EL050.cbl
 20675     EXIT.
 20676
 20677 8570-START-ACCOUNT-MASTER.
 20678
 20679* EXEC CICS HANDLE CONDITION
 20680*        NOTFND    (0199-ACCT-NOT-FOUND)
 20681*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20682*    END-EXEC.
 20683*    MOVE '"$I''                  ! 6 #00019608' TO DFHEIV0
 20684     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20686     MOVE X'3620233030303139363038' TO DFHEIV0(25:11)
 20687     CALL 'kxdfhei1' USING DFHEIV0
 20688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20689
 20690
 20691
 20692* EXEC CICS STARTBR
 20693*        DATASET    (ACCT-ID)
 20694*        RIDFLD     (ERACCT-KEY)
 20695*        GTEQ
 20696*    END-EXEC.
 20697     MOVE 0
 20698       TO DFHEIV11
 20699*    MOVE '&,         G          &   #00019613' TO DFHEIV0
 20700     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20701     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20702     MOVE X'2020233030303139363133' TO DFHEIV0(25:11)
 20703     CALL 'kxdfhei1' USING DFHEIV0,
 20704           ACCT-ID,
 20705           ERACCT-KEY,
 20706           DFHEIV99,
 20707           DFHEIV11,
 20708           DFHEIV99
 20709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20710
 20711
 20712 8570-EXIT.
 20713     EXIT.
 20714
 20715 8580-READ-ACCOUNT-MASTER.
 20716
 20717* EXEC CICS HANDLE CONDITION
 20718*        NOTFND    (0199-ACCT-NOT-FOUND)
 20719*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20720*    END-EXEC.
 20721*    MOVE '"$I''                  ! 7 #00019623' TO DFHEIV0
 20722     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20724     MOVE X'3720233030303139363233' TO DFHEIV0(25:11)
 20725     CALL 'kxdfhei1' USING DFHEIV0
 20726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20727
 20728
 20729
 20730* EXEC CICS READNEXT
 20731*        DATASET     (ACCT-ID)
 20732*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 384
* EL050.cbl
 20733*        RIDFLD      (ERACCT-KEY)
 20734*    END-EXEC.
 20735     MOVE LENGTH OF
 20736      ACCOUNT-MASTER
 20737       TO DFHEIV12
 20738     MOVE 0
 20739       TO DFHEIV11
 20740*    MOVE '&.IL                  )   #00019628' TO DFHEIV0
 20741     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20742     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20743     MOVE X'2020233030303139363238' TO DFHEIV0(25:11)
 20744     CALL 'kxdfhei1' USING DFHEIV0,
 20745           ACCT-ID,
 20746           ACCOUNT-MASTER,
 20747           DFHEIV12,
 20748           ERACCT-KEY,
 20749           DFHEIV99,
 20750           DFHEIV11,
 20751           DFHEIV99,
 20752           DFHEIV99
 20753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20754
 20755
 20756 8580-EXIT.
 20757     EXIT.
 20758
 20759 8582-READ-COMPENSATION-MASTER.
 20760
 20761* EXEC CICS HANDLE CONDITION
 20762*        NOTFND    (8582-COMP-NOT-FOUND)
 20763*        ENDFILE   (8582-COMP-NOT-FOUND)
 20764*    END-EXEC.
 20765*    MOVE '"$I''                  ! 8 #00019638' TO DFHEIV0
 20766     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20768     MOVE X'3820233030303139363338' TO DFHEIV0(25:11)
 20769     CALL 'kxdfhei1' USING DFHEIV0
 20770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20771
 20772
 20773
 20774* EXEC CICS READ
 20775*        DATASET     (COMP-ID)
 20776*        INTO        (COMPENSATION-MASTER)
 20777*        RIDFLD      (ERCOMP-KEY)
 20778*    END-EXEC.
 20779     MOVE LENGTH OF
 20780      COMPENSATION-MASTER
 20781       TO DFHEIV11
 20782*    MOVE '&"IL       E          (   #00019643' TO DFHEIV0
 20783     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20785     MOVE X'2020233030303139363433' TO DFHEIV0(25:11)
 20786     CALL 'kxdfhei1' USING DFHEIV0,
 20787           COMP-ID,
 20788           COMPENSATION-MASTER,
 20789           DFHEIV11,
 20790           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 385
* EL050.cbl
 20791           DFHEIV99,
 20792           DFHEIV99,
 20793           DFHEIV99
 20794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20795
 20796
 20797     MOVE 'Y'                    TO COMP-MASTER-SW
 20798
 20799     GO TO 8582-EXIT
 20800     .
 20801 8582-COMP-NOT-FOUND.
 20802
 20803     MOVE 'N'                    TO COMP-MASTER-SW.
 20804
 20805 8582-EXIT.
 20806     EXIT.
 20807
 20808 8583-READ-ERAGTC.
 20809
 20810* EXEC CICS HANDLE CONDITION
 20811*        NOTFND    (8583-AGTC-NOT-FOUND)
 20812*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20813*    END-EXEC.
 20814*    MOVE '"$I''                  ! 9 #00019661' TO DFHEIV0
 20815     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20817     MOVE X'3920233030303139363631' TO DFHEIV0(25:11)
 20818     CALL 'kxdfhei1' USING DFHEIV0
 20819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20820
 20821
 20822
 20823* EXEC CICS STARTBR
 20824*        DATASET    (AGTC-ID)
 20825*        RIDFLD     (ERAGTC-KEY)
 20826*        GTEQ
 20827*    END-EXEC.
 20828     MOVE 0
 20829       TO DFHEIV11
 20830*    MOVE '&,         G          &   #00019666' TO DFHEIV0
 20831     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20832     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20833     MOVE X'2020233030303139363636' TO DFHEIV0(25:11)
 20834     CALL 'kxdfhei1' USING DFHEIV0,
 20835           AGTC-ID,
 20836           ERAGTC-KEY,
 20837           DFHEIV99,
 20838           DFHEIV11,
 20839           DFHEIV99
 20840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20841
 20842
 20843 8583-READ-ERAGTC-NEXT.
 20844
 20845* EXEC CICS READNEXT
 20846*        DATASET     (AGTC-ID)
 20847*        INTO        (AGENT-COMMISSIONS)
 20848*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 386
* EL050.cbl
 20849*    END-EXEC.
 20850     MOVE LENGTH OF
 20851      AGENT-COMMISSIONS
 20852       TO DFHEIV12
 20853     MOVE 0
 20854       TO DFHEIV11
 20855*    MOVE '&.IL                  )   #00019673' TO DFHEIV0
 20856     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20857     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20858     MOVE X'2020233030303139363733' TO DFHEIV0(25:11)
 20859     CALL 'kxdfhei1' USING DFHEIV0,
 20860           AGTC-ID,
 20861           AGENT-COMMISSIONS,
 20862           DFHEIV12,
 20863           ERAGTC-KEY,
 20864           DFHEIV99,
 20865           DFHEIV11,
 20866           DFHEIV99,
 20867           DFHEIV99
 20868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20869
 20870
 20871*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20872
 20873     GO TO 8583-EXIT
 20874     .
 20875 8583-AGTC-NOT-FOUND.
 20876
 20877     MOVE 'N'                    TO AGTC-MASTER-SW.
 20878
 20879 8583-EXIT.
 20880     EXIT.
 20881
 20882 8584-READ-BANK-CROSS-REF.
 20883
 20884* EXEC CICS HANDLE CONDITION
 20885*        NOTFND    (8584-BXRF-NOT-FOUND)
 20886*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20887*    END-EXEC.
 20888*    MOVE '"$I''                  ! : #00019691' TO DFHEIV0
 20889     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20891     MOVE X'3A20233030303139363931' TO DFHEIV0(25:11)
 20892     CALL 'kxdfhei1' USING DFHEIV0
 20893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20894
 20895
 20896
 20897* EXEC CICS READ
 20898*        DATASET     (BXRF-ID)
 20899*        INTO        (BANK-CROSS-REFERENCE)
 20900*        RIDFLD      (ERBXRF-KEY)
 20901*        LENGTH      (BXRF-REC-LENGTH)
 20902*    END-EXEC.
 20903*    MOVE '&"IL       E          (   #00019696' TO DFHEIV0
 20904     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20906     MOVE X'2020233030303139363936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 387
* EL050.cbl
 20907     CALL 'kxdfhei1' USING DFHEIV0,
 20908           BXRF-ID,
 20909           BANK-CROSS-REFERENCE,
 20910           BXRF-REC-LENGTH,
 20911           ERBXRF-KEY,
 20912           DFHEIV99,
 20913           DFHEIV99,
 20914           DFHEIV99
 20915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20916
 20917
 20918     MOVE 'Y'                    TO BXRF-MASTER-SW
 20919
 20920     GO TO 8584-EXIT
 20921     .
 20922 8584-BXRF-NOT-FOUND.
 20923
 20924     MOVE 'N'                    TO BXRF-MASTER-SW.
 20925
 20926 8584-EXIT.
 20927     EXIT.
 20928
 20929 8585-READ-PLAN-MASTER.
 20930
 20931
 20932* EXEC CICS HANDLE CONDITION
 20933*        NOTFND    (8585-PLAN-NOT-FOUND)
 20934*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20935*    END-EXEC.
 20936*    MOVE '"$I''                  ! ; #00019716' TO DFHEIV0
 20937     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20939     MOVE X'3B20233030303139373136' TO DFHEIV0(25:11)
 20940     CALL 'kxdfhei1' USING DFHEIV0
 20941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20942
 20943
 20944
 20945* EXEC CICS READ
 20946*        DATASET     (PLAN-ID)
 20947*        INTO        (PLAN-MASTER)
 20948*        RIDFLD      (ERPLAN-KEY)
 20949*    END-EXEC.
 20950     MOVE LENGTH OF
 20951      PLAN-MASTER
 20952       TO DFHEIV11
 20953*    MOVE '&"IL       E          (   #00019721' TO DFHEIV0
 20954     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20955     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20956     MOVE X'2020233030303139373231' TO DFHEIV0(25:11)
 20957     CALL 'kxdfhei1' USING DFHEIV0,
 20958           PLAN-ID,
 20959           PLAN-MASTER,
 20960           DFHEIV11,
 20961           ERPLAN-KEY,
 20962           DFHEIV99,
 20963           DFHEIV99,
 20964           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 388
* EL050.cbl
 20965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20966
 20967
 20968     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20969
 20970     GO TO 8585-EXIT.
 20971
 20972 8585-PLAN-NOT-FOUND.
 20973
 20974     MOVE 'N'                    TO PLAN-MASTER-SW.
 20975
 20976 8585-EXIT.
 20977     EXIT.
 20978
 20979 8586-READ-LOAN-OFFICER.
 20980
 20981* EXEC CICS READ
 20982*        DATASET     (LOFC-ID)
 20983*        INTO        (LOAN-OFFICER-MASTER)
 20984*        RIDFLD      (ERLOFC-KEY)
 20985*        RESP        (WS-RESPONSE)
 20986*    END-EXEC
 20987     MOVE LENGTH OF
 20988      LOAN-OFFICER-MASTER
 20989       TO DFHEIV11
 20990*    MOVE '&"IL       E          (  N#00019739' TO DFHEIV0
 20991     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20993     MOVE X'204E233030303139373339' TO DFHEIV0(25:11)
 20994     CALL 'kxdfhei1' USING DFHEIV0,
 20995           LOFC-ID,
 20996           LOAN-OFFICER-MASTER,
 20997           DFHEIV11,
 20998           ERLOFC-KEY,
 20999           DFHEIV99,
 21000           DFHEIV99,
 21001           DFHEIV99
 21002     MOVE EIBRESP  TO WS-RESPONSE
 21003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21004
 21005     IF WS-RESP-NORMAL
 21006        MOVE 'Y'                 TO LOFC-MASTER-SW
 21007     ELSE
 21008        MOVE 'N'                 TO LOFC-MASTER-SW
 21009     END-IF
 21010     .
 21011 8586-EXIT.
 21012     EXIT.
 21013 8587-START-ERPDEF.
 21014
 21015* EXEC CICS STARTBR
 21016*       DATASET   (PDEF-ID)
 21017*       RIDFLD    (ERPDEF-KEY)
 21018*       GTEQ
 21019*       RESP      (WS-RESPONSE)
 21020*    END-EXEC
 21021     MOVE 0
 21022       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 389
* EL050.cbl
 21023*    MOVE '&,         G          &  N#00019755' TO DFHEIV0
 21024     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21025     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21026     MOVE X'204E233030303139373535' TO DFHEIV0(25:11)
 21027     CALL 'kxdfhei1' USING DFHEIV0,
 21028           PDEF-ID,
 21029           ERPDEF-KEY,
 21030           DFHEIV99,
 21031           DFHEIV11,
 21032           DFHEIV99
 21033     MOVE EIBRESP  TO WS-RESPONSE
 21034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21035     IF WS-RESP-NORMAL
 21036        MOVE 'Y'                 TO PDEF-MASTER-SW
 21037     ELSE
 21038        MOVE 'N'                 TO PDEF-MASTER-SW
 21039     END-IF
 21040     .
 21041 8587-EXIT.
 21042     EXIT.
 21043 8588-READ-ERPDEF.
 21044
 21045* EXEC CICS READNEXT
 21046*       DATASET   (PDEF-ID)
 21047*       RIDFLD    (ERPDEF-KEY)
 21048*       INTO      (PRODUCT-MASTER)
 21049*       RESP      (WS-RESPONSE)
 21050*    END-EXEC
 21051     MOVE LENGTH OF
 21052      PRODUCT-MASTER
 21053       TO DFHEIV12
 21054     MOVE 0
 21055       TO DFHEIV11
 21056*    MOVE '&.IL                  )  N#00019770' TO DFHEIV0
 21057     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21058     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21059     MOVE X'204E233030303139373730' TO DFHEIV0(25:11)
 21060     CALL 'kxdfhei1' USING DFHEIV0,
 21061           PDEF-ID,
 21062           PRODUCT-MASTER,
 21063           DFHEIV12,
 21064           ERPDEF-KEY,
 21065           DFHEIV99,
 21066           DFHEIV11,
 21067           DFHEIV99,
 21068           DFHEIV99
 21069     MOVE EIBRESP  TO WS-RESPONSE
 21070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21071     IF WS-RESP-NORMAL
 21072        MOVE 'Y'                 TO PDEF-MASTER-SW
 21073     ELSE
 21074        MOVE 'N'                 TO PDEF-MASTER-SW
 21075     END-IF
 21076     .
 21077 8588-EXIT.
 21078     EXIT.
 21079 8589-ENDBR-ERPDEF.
 21080
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 390
* EL050.cbl
 21081* EXEC CICS ENDBR
 21082*       DATASET   (PDEF-ID)
 21083*    END-EXEC
 21084     MOVE 0
 21085       TO DFHEIV11
 21086*    MOVE '&2                    $   #00019785' TO DFHEIV0
 21087     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21088     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21089     MOVE X'2020233030303139373835' TO DFHEIV0(25:11)
 21090     CALL 'kxdfhei1' USING DFHEIV0,
 21091           PDEF-ID,
 21092           DFHEIV11,
 21093           DFHEIV99
 21094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21095     .
 21096 8589-EXIT.
 21097     EXIT.
 21098 8590-READ-CERT-MASTER.
 21099     IF PB-COMPANY-ID = 'UCL'
 21100         GO TO 8690-READ-CERT-MASTER-UCL.
 21101
 21102
 21103* EXEC CICS HANDLE CONDITION
 21104*         NOTFND    (0299-CERT-NOT-FOUND)
 21105*    END-EXEC.
 21106*    MOVE '"$I                   ! < #00019795' TO DFHEIV0
 21107     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21109     MOVE X'3C20233030303139373935' TO DFHEIV0(25:11)
 21110     CALL 'kxdfhei1' USING DFHEIV0
 21111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21112
 21113
 21114
 21115* EXEC CICS READ
 21116*        DATASET     (CERT-ID)
 21117*        INTO        (CERTIFICATE-MASTER)
 21118*        RIDFLD      (ELCERT-KEY)
 21119*        UPDATE
 21120*    END-EXEC.
 21121     MOVE LENGTH OF
 21122      CERTIFICATE-MASTER
 21123       TO DFHEIV11
 21124*    MOVE '&"IL       EU         (   #00019799' TO DFHEIV0
 21125     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21126     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21127     MOVE X'2020233030303139373939' TO DFHEIV0(25:11)
 21128     CALL 'kxdfhei1' USING DFHEIV0,
 21129           CERT-ID,
 21130           CERTIFICATE-MASTER,
 21131           DFHEIV11,
 21132           ELCERT-KEY,
 21133           DFHEIV99,
 21134           DFHEIV99,
 21135           DFHEIV99
 21136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21137
 21138
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 391
* EL050.cbl
 21139 8590-EXIT.
 21140     EXIT.
 21141
 21142 8690-READ-CERT-MASTER-UCL.
 21143
 21144* EXEC CICS HANDLE CONDITION
 21145*         NOTFND    (8700-READ-CERT-MASTER)
 21146*    END-EXEC.
 21147*    MOVE '"$I                   ! = #00019810' TO DFHEIV0
 21148     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21150     MOVE X'3D20233030303139383130' TO DFHEIV0(25:11)
 21151     CALL 'kxdfhei1' USING DFHEIV0
 21152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21153
 21154
 21155 8690-READ-CERT-CONT.
 21156
 21157* EXEC CICS READ
 21158*        DATASET     (CERT-ID)
 21159*        INTO        (CERTIFICATE-MASTER)
 21160*        RIDFLD      (ELCERT-KEY)
 21161*        UPDATE
 21162*    END-EXEC.
 21163     MOVE LENGTH OF
 21164      CERTIFICATE-MASTER
 21165       TO DFHEIV11
 21166*    MOVE '&"IL       EU         (   #00019815' TO DFHEIV0
 21167     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21168     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21169     MOVE X'2020233030303139383135' TO DFHEIV0(25:11)
 21170     CALL 'kxdfhei1' USING DFHEIV0,
 21171           CERT-ID,
 21172           CERTIFICATE-MASTER,
 21173           DFHEIV11,
 21174           ELCERT-KEY,
 21175           DFHEIV99,
 21176           DFHEIV99,
 21177           DFHEIV99
 21178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21179
 21180
 21181     GO TO 8590-EXIT.
 21182
 21183 8700-READ-CERT-MASTER.
 21184     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21185     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21186
 21187* EXEC CICS HANDLE CONDITION
 21188*         DUPKEY    (8720-COMP-ACCOUNTS)
 21189*         ENDFILE   (8730-END-BROWSE)
 21190*         NOTFND    (8740-NOT-FOUND)
 21191*    END-EXEC.
 21192*    MOVE '"$$''I                 ! > #00019827' TO DFHEIV0
 21193     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21195     MOVE X'3E20233030303139383237' TO DFHEIV0(25:11)
 21196     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 392
* EL050.cbl
 21197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21198
 21199
 21200
 21201* EXEC CICS STARTBR
 21202*        DATASET     ('ELCERT5')
 21203*        RIDFLD      (ELCERT2-KEY)
 21204*        EQUAL
 21205*    END-EXEC.
 21206     MOVE 'ELCERT5' TO DFHEIV1
 21207     MOVE 0
 21208       TO DFHEIV11
 21209*    MOVE '&,         E          &   #00019833' TO DFHEIV0
 21210     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21211     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21212     MOVE X'2020233030303139383333' TO DFHEIV0(25:11)
 21213     CALL 'kxdfhei1' USING DFHEIV0,
 21214           DFHEIV1,
 21215           ELCERT2-KEY,
 21216           DFHEIV99,
 21217           DFHEIV11,
 21218           DFHEIV99
 21219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21220
 21221
 21222 8710-READ-NEXT.
 21223
 21224* EXEC CICS READNEXT
 21225*        DATASET     ('ELCERT5')
 21226*        INTO        (CERTIFICATE-MASTER)
 21227*        RIDFLD      (ELCERT2-KEY)
 21228*    END-EXEC.
 21229     MOVE LENGTH OF
 21230      CERTIFICATE-MASTER
 21231       TO DFHEIV12
 21232     MOVE 'ELCERT5' TO DFHEIV1
 21233     MOVE 0
 21234       TO DFHEIV11
 21235*    MOVE '&.IL                  )   #00019840' TO DFHEIV0
 21236     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21237     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21238     MOVE X'2020233030303139383430' TO DFHEIV0(25:11)
 21239     CALL 'kxdfhei1' USING DFHEIV0,
 21240           DFHEIV1,
 21241           CERTIFICATE-MASTER,
 21242           DFHEIV12,
 21243           ELCERT2-KEY,
 21244           DFHEIV99,
 21245           DFHEIV11,
 21246           DFHEIV99,
 21247           DFHEIV99
 21248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21249
 21250
 21251 8720-COMP-ACCOUNTS.
 21252
 21253* EXEC CICS ENTER
 21254*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 393
* EL050.cbl
 21255*         FROM (PB-C-LAST-NAME)
 21256*    END-EXEC.
 21257     MOVE 001
 21258       TO DFHEIV11
 21259*    MOVE ':$F                   %   #00019847' TO DFHEIV0
 21260     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21261     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21262     MOVE X'2020233030303139383437' TO DFHEIV0(25:11)
 21263     CALL 'kxdfhei1' USING DFHEIV0,
 21264           DFHEIV11,
 21265           PB-C-LAST-NAME,
 21266           DFHEIV99,
 21267           DFHEIV99
 21268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21269
 21270
 21271
 21272* EXEC CICS ENTER
 21273*         TRACEID (002)
 21274*         FROM (CM-INSURED-LAST-NAME)
 21275*    END-EXEC.
 21276     MOVE 002
 21277       TO DFHEIV11
 21278*    MOVE ':$F                   %   #00019852' TO DFHEIV0
 21279     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21280     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21281     MOVE X'2020233030303139383532' TO DFHEIV0(25:11)
 21282     CALL 'kxdfhei1' USING DFHEIV0,
 21283           DFHEIV11,
 21284           CM-INSURED-LAST-NAME,
 21285           DFHEIV99,
 21286           DFHEIV99
 21287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21288
 21289
 21290     IF PB-CERT-NO NOT = CM-CERT-NO
 21291         GO TO 8730-END-BROWSE.
 21292
 21293     IF PB-ACCOUNT = CM-ACCOUNT
 21294         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21295             MOVE ER-2799        TO WS-ERROR
 21296             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21297             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21298             GO TO 8730-END-BROWSE.
 21299
 21300     GO TO 8710-READ-NEXT.
 21301
 21302 8730-END-BROWSE.
 21303
 21304* EXEC CICS ENDBR
 21305*         DATASET    ('ELCERT5')
 21306*    END-EXEC.
 21307     MOVE 'ELCERT5' TO DFHEIV1
 21308     MOVE 0
 21309       TO DFHEIV11
 21310*    MOVE '&2                    $   #00019870' TO DFHEIV0
 21311     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21312     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 394
* EL050.cbl
 21313     MOVE X'2020233030303139383730' TO DFHEIV0(25:11)
 21314     CALL 'kxdfhei1' USING DFHEIV0,
 21315           DFHEIV1,
 21316           DFHEIV11,
 21317           DFHEIV99
 21318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21319
 21320
 21321 8740-NOT-FOUND.
 21322     GO TO 0299-CERT-NOT-FOUND.
 21323
 21324 8750-START-ELSTAT.
 21325
 21326* EXEC CICS STARTBR
 21327*       DATASET   (STAT-ID)
 21328*       RIDFLD    (ELSTAT-KEY)
 21329*       GTEQ
 21330*       RESP      (WS-RESPONSE)
 21331*    END-EXEC
 21332     MOVE 0
 21333       TO DFHEIV11
 21334*    MOVE '&,         G          &  N#00019878' TO DFHEIV0
 21335     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21336     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21337     MOVE X'204E233030303139383738' TO DFHEIV0(25:11)
 21338     CALL 'kxdfhei1' USING DFHEIV0,
 21339           STAT-ID,
 21340           ELSTAT-KEY,
 21341           DFHEIV99,
 21342           DFHEIV11,
 21343           DFHEIV99
 21344     MOVE EIBRESP  TO WS-RESPONSE
 21345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21346     IF WS-RESP-NORMAL
 21347        MOVE 'Y'                 TO STAT-MASTER-SW
 21348     ELSE
 21349        MOVE 'N'                 TO STAT-MASTER-SW
 21350     END-IF
 21351     .
 21352 8750-EXIT.
 21353     EXIT.
 21354 8752-READ-ELSTAT.
 21355
 21356* EXEC CICS READNEXT
 21357*       DATASET   (STAT-ID)
 21358*       RIDFLD    (ELSTAT-KEY)
 21359*       INTO      (STATE-FILE)
 21360*       RESP      (WS-RESPONSE)
 21361*    END-EXEC
 21362     MOVE LENGTH OF
 21363      STATE-FILE
 21364       TO DFHEIV12
 21365     MOVE 0
 21366       TO DFHEIV11
 21367*    MOVE '&.IL                  )  N#00019893' TO DFHEIV0
 21368     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21369     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21370     MOVE X'204E233030303139383933' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 395
* EL050.cbl
 21371     CALL 'kxdfhei1' USING DFHEIV0,
 21372           STAT-ID,
 21373           STATE-FILE,
 21374           DFHEIV12,
 21375           ELSTAT-KEY,
 21376           DFHEIV99,
 21377           DFHEIV11,
 21378           DFHEIV99,
 21379           DFHEIV99
 21380     MOVE EIBRESP  TO WS-RESPONSE
 21381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21382     IF WS-RESP-NORMAL
 21383        MOVE 'Y'                 TO STAT-MASTER-SW
 21384     ELSE
 21385        MOVE 'N'                 TO STAT-MASTER-SW
 21386     END-IF
 21387     .
 21388 8752-EXIT.
 21389     EXIT.
 21390 8800-GET-COMP-RATE.
 21391     MOVE +1 TO IB.
 21392     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21393         ADD +9 TO IB
 21394         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21395             ADD +9 TO IB
 21396             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21397                MOVE ZEROS       TO WS-WK-RATE
 21398                GO TO 8800-EXIT.
 21399
 21400     IF PB-I-AGE GREATER CT-AGE (1)
 21401         ADD +3 TO IB
 21402         IF PB-I-AGE GREATER CT-AGE (2)
 21403             ADD +3 TO IB
 21404             IF PB-I-AGE GREATER CT-AGE (3)
 21405                MOVE ZEROS       TO WS-WK-RATE
 21406                GO TO 8800-EXIT.
 21407
 21408     IF WS-WORK-TERM GREATER CT-TRM (1)
 21409         ADD +1 TO IB
 21410         IF WS-WORK-TERM GREATER CT-TRM (2)
 21411             ADD +1 TO IB
 21412             IF WS-WORK-TERM GREATER CT-TRM (3)
 21413                MOVE ZEROS       TO WS-WK-RATE
 21414                GO TO 8800-EXIT.
 21415
 21416     IF CT-RT (IB) NOT NUMERIC
 21417         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21418         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21419         GO TO 8800-GET-COMP-RATE.
 21420
 21421     MOVE CT-RT (IB) TO WS-WK-RATE.
 21422
 21423 8800-EXIT.
 21424     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 396
* EL050.cbl
 21426 8900-ADDRESS-FILE.
 21427     IF ERACCT-FILE-ADDRESSED
 21428         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21429         GO TO 8900-ADDRESS-EXIT.
 21430
 21431     IF ELCNTL-FILE-ADDRESSED
 21432         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21433         GO TO 8900-ADDRESS-EXIT.
 21434
 21435     IF ERPLAN-FILE-ADDRESSED
 21436         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21437         GO TO 8900-ADDRESS-EXIT.
 21438
 21439     IF ERFORM-FILE-ADDRESSED
 21440         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21441         GO TO 8900-ADDRESS-EXIT.
 21442
 21443 8900-ADDRESS-EXIT.
 21444     EXIT.
 21445
 21446 9000-READ-CONTROL.
 21447
 21448* EXEC CICS HANDLE CONDITION
 21449*        NOTFND    (9000-NOTFND)
 21450*    END-EXEC.
 21451*    MOVE '"$I                   ! ? #00019964' TO DFHEIV0
 21452     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21454     MOVE X'3F20233030303139393634' TO DFHEIV0(25:11)
 21455     CALL 'kxdfhei1' USING DFHEIV0
 21456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21457
 21458
 21459
 21460* EXEC CICS READ
 21461*        DATASET     (CNTL-ID)
 21462*        SET         (ADDRESS OF CONTROL-FILE)
 21463*        RIDFLD      (ELCNTL-KEY)
 21464*        GTEQ
 21465*    END-EXEC.
 21466*    MOVE '&"S        G          (   #00019968' TO DFHEIV0
 21467     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21469     MOVE X'2020233030303139393638' TO DFHEIV0(25:11)
 21470     CALL 'kxdfhei1' USING DFHEIV0,
 21471           CNTL-ID,
 21472           DFHEIV20,
 21473           DFHEIV99,
 21474           ELCNTL-KEY,
 21475           DFHEIV99,
 21476           DFHEIV99,
 21477           DFHEIV99
 21478     SET ADDRESS OF CONTROL-FILE TO
 21479         DFHEIV20
 21480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21481
 21482
 21483     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 397
* EL050.cbl
 21484
 21485 9000-NOTFND.
 21486     IF RC-SW-1 = '1'
 21487        MOVE ER-2616              TO WS-ERROR
 21488        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21489        GO TO 9000-EXIT.
 21490
 21491     IF RC-SW-1 = '2'
 21492        MOVE ER-2602              TO WS-ERROR
 21493        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21494
 21495 9000-EXIT.
 21496      EXIT.
 21497
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 398
* EL050.cbl
 21499 9100-READ-CONTROL.
 21500
 21501* EXEC CICS HANDLE CONDITION
 21502*        NOTFND  (9100-NOTFND)
 21503*        ENDFILE (9100-NOTFND)
 21504*    END-EXEC.
 21505*    MOVE '"$I''                  ! @ #00019992' TO DFHEIV0
 21506     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21507     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21508     MOVE X'4020233030303139393932' TO DFHEIV0(25:11)
 21509     CALL 'kxdfhei1' USING DFHEIV0
 21510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21511
 21512
 21513
 21514* EXEC CICS READ
 21515*        DATASET     (CNTL-ID)
 21516*        INTO        (CONTROL-FILE)
 21517*        RIDFLD      (ELCNTL-KEY)
 21518*        GTEQ
 21519*    END-EXEC.
 21520     MOVE LENGTH OF
 21521      CONTROL-FILE
 21522       TO DFHEIV11
 21523*    MOVE '&"IL       G          (   #00019997' TO DFHEIV0
 21524     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21526     MOVE X'2020233030303139393937' TO DFHEIV0(25:11)
 21527     CALL 'kxdfhei1' USING DFHEIV0,
 21528           CNTL-ID,
 21529           CONTROL-FILE,
 21530           DFHEIV11,
 21531           ELCNTL-KEY,
 21532           DFHEIV99,
 21533           DFHEIV99,
 21534           DFHEIV99
 21535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21536
 21537
 21538     GO TO 9100-EXIT.
 21539
 21540 9100-NOTFND.
 21541     IF RC-SW-2 = '0'
 21542        MOVE '1'                  TO STATE-RECORD-ERROR
 21543        GO TO 9100-EXIT
 21544     END-IF
 21545     IF RC-SW-2 = '1'
 21546        MOVE '1'                  TO LF-BENEFIT-ERROR
 21547        MOVE ER-2604              TO WS-ERROR
 21548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21549        GO TO 9100-EXIT.
 21550
 21551     IF RC-SW-2 = '2'
 21552        MOVE '1'                  TO AH-BENEFIT-ERROR
 21553        MOVE ER-2605              TO WS-ERROR
 21554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21555        GO TO 9100-EXIT.
 21556
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 399
* EL050.cbl
 21557     IF RC-SW-2 = '3'
 21558         MOVE ER-2603           TO WS-ERROR
 21559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21560         GO TO 9100-EXIT.
 21561
 21562     IF RC-SW-2 = '4'
 21563         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21564         GO TO 9100-EXIT.
 21565
 21566     IF RC-SW-2 = '5'
 21567         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21568         IF WS-AH-INPUT-CD-1 = SPACE
 21569             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21570         ELSE
 21571             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21572
 21573 9100-EXIT.
 21574      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 400
* EL050.cbl
 21576 9200-CONTROL-GETMAIN.
 21577
 21578* EXEC CICS GETMAIN
 21579*         LENGTH   (750)
 21580*         SET      (ADDRESS OF CONTROL-FILE)
 21581*    END-EXEC.
 21582     MOVE 750
 21583       TO DFHEIV11
 21584*    MOVE '," L                  $   #00020043' TO DFHEIV0
 21585     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21586     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21587     MOVE X'2020233030303230303433' TO DFHEIV0(25:11)
 21588     CALL 'kxdfhei1' USING DFHEIV0,
 21589           DFHEIV20,
 21590           DFHEIV11,
 21591           DFHEIV99
 21592     SET ADDRESS OF CONTROL-FILE TO
 21593         DFHEIV20
 21594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21595
 21596
 21597     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21598
 21599 9200-EXIT.
 21600     EXIT.
 21601
 21602 9250-UNLOCK-RETURN.
 21603
 21604* EXEC CICS UNLOCK
 21605*        DATASET   (CERT-ID)
 21606*    END-EXEC.
 21607*    MOVE '&*                    #   #00020054' TO DFHEIV0
 21608     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21609     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21610     MOVE X'2020233030303230303534' TO DFHEIV0(25:11)
 21611     CALL 'kxdfhei1' USING DFHEIV0,
 21612           CERT-ID,
 21613           DFHEIV99
 21614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21615
 21616
 21617 9300-ABEND.
 21618     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21619
 21620
 21621* EXEC CICS LINK
 21622*        PROGRAM   ('EL004')
 21623*        COMMAREA  (WS-ERROR-LINE)
 21624*        LENGTH    (72)
 21625*    END-EXEC.
 21626     MOVE 'EL004' TO DFHEIV1
 21627     MOVE 72
 21628       TO DFHEIV11
 21629*    MOVE '."C                   (   #00020061' TO DFHEIV0
 21630     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21632     MOVE X'2020233030303230303631' TO DFHEIV0(25:11)
 21633     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 401
* EL050.cbl
 21634           DFHEIV1,
 21635           WS-ERROR-LINE,
 21636           DFHEIV11,
 21637           DFHEIV99,
 21638           DFHEIV99,
 21639           DFHEIV99,
 21640           DFHEIV99
 21641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21642
 21643
 21644     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21645
 21646
 21647* EXEC CICS ABEND
 21648*        ABCODE ('EL50')
 21649*    END-EXEC.
 21650     MOVE 'EL50' TO DFHEIV5
 21651*    MOVE '.,A                   "   #00020069' TO DFHEIV0
 21652     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21653     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21654     MOVE X'2020233030303230303639' TO DFHEIV0(25:11)
 21655     CALL 'kxdfhei1' USING DFHEIV0,
 21656           DFHEIV5
 21657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21658
 21659
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 402
* EL050.cbl
 21661
 21662******************************************************************
 21663*                                                                *
 21664*            E R R O R   F O R M A T   R O U T I N E             *
 21665*                                                                *
 21666******************************************************************
 21667
 21668 9900-ERROR-FORMAT.
 21669
 21670     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21671                    PB-COMMON-ERROR (2) OR
 21672                    PB-COMMON-ERROR (3) OR
 21673                    PB-COMMON-ERROR (4) OR
 21674                    PB-COMMON-ERROR (5) OR
 21675                    PB-COMMON-ERROR (6) OR
 21676                    PB-COMMON-ERROR (7) OR
 21677                    PB-COMMON-ERROR (8) OR
 21678                    PB-COMMON-ERROR (9) OR
 21679                    PB-COMMON-ERROR (10)
 21680        GO TO 9900-EXIT.
 21681
 21682     IF PB-NO-OF-ERRORS = +10
 21683        GO TO 9900-EXIT.
 21684
 21685     ADD +1  TO PB-NO-OF-ERRORS.
 21686     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21687                                       (PB-NO-OF-ERRORS).
 21688 9900-EXIT.
 21689     EXIT.
 21690
 21691 9990-RETURN.
 21692     IF BROWSE-STARTED
 21693
 21694* EXEC CICS ENDBR
 21695*            DATASET  (ACCT-ID)
 21696*       END-EXEC.
 21697     MOVE 0
 21698       TO DFHEIV11
 21699*    MOVE '&2                    $   #00020106' TO DFHEIV0
 21700     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21701     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21702     MOVE X'2020233030303230313036' TO DFHEIV0(25:11)
 21703     CALL 'kxdfhei1' USING DFHEIV0,
 21704           ACCT-ID,
 21705           DFHEIV11,
 21706           DFHEIV99
 21707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21708
 21709
 21710 9990-EXIT.
 21711     EXIT.
 21712
 21713
 21714****Check for CRTO record, add one if not found.
 21715 9991-CHECK-FOR-ELCRTO.
 21716
 21717* EXEC CICS HANDLE CONDITION
 21718*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 403
* EL050.cbl
 21719*         ENDFILE (9991-CRTO-NOT-FOUND)
 21720*     END-EXEC.
 21721*    MOVE '"$I''                  ! A #00020116' TO DFHEIV0
 21722     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21724     MOVE X'4120233030303230313136' TO DFHEIV0(25:11)
 21725     CALL 'kxdfhei1' USING DFHEIV0
 21726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21727
 21728     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21729     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21730     MOVE +0                     TO ELCRTO-SEQ-NO
 21731
 21732
 21733* EXEC CICS READ
 21734*       DATASET   ('ELCRTO')
 21735*       INTO      (ORIGINAL-CERTIFICATE)
 21736*       RIDFLD    (ELCRTO-KEY)
 21737*       GTEQ
 21738*       RESP      (WS-RESPONSE)
 21739*    END-EXEC
 21740     MOVE LENGTH OF
 21741      ORIGINAL-CERTIFICATE
 21742       TO DFHEIV11
 21743     MOVE 'ELCRTO' TO DFHEIV1
 21744*    MOVE '&"IL       G          (  N#00020124' TO DFHEIV0
 21745     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21746     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21747     MOVE X'204E233030303230313234' TO DFHEIV0(25:11)
 21748     CALL 'kxdfhei1' USING DFHEIV0,
 21749           DFHEIV1,
 21750           ORIGINAL-CERTIFICATE,
 21751           DFHEIV11,
 21752           ELCRTO-KEY,
 21753           DFHEIV99,
 21754           DFHEIV99,
 21755           DFHEIV99
 21756     MOVE EIBRESP  TO WS-RESPONSE
 21757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21758
 21759     IF WS-RESP-NORMAL
 21760        AND (OC-CONTROL-PRIMARY (1:33) =
 21761                 PB-CONTROL-BY-ACCOUNT (1:33))
 21762        AND (OC-RECORD-TYPE =  'I')
 21763           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21764               GO TO 9991-CHECK-INDICATORS
 21765           ELSE
 21766               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21767               GO TO 9991-CRTO-ADD-REC
 21768           END-IF
 21769     END-IF.
 21770
 21771 9991-CRTO-NOT-FOUND.
 21772
 21773     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21774     MOVE 'OC'                TO OC-RECORD-ID
 21775     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21776                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 404
* EL050.cbl
 21777     MOVE +4096               TO OC-KEY-SEQ-NO.
 21778
 21779 9991-CRTO-ADD-REC.
 21780
 21781     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21782     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21783     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21784     MOVE 'I'                 TO OC-RECORD-TYPE
 21785     IF PB-ISSUE
 21786         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21787         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21788         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21789         MOVE PB-I-AGE               TO OC-INS-AGE
 21790         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21791         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21792         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21793         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21794         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21795         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21796         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21797         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21798         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21799         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21800         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21801         IF PB-I-JOINT-COMMISSION > +0
 21802             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21803         ELSE
 21804             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21805         END-IF
 21806         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21807         MOVE +0                     TO OC-LF-CANCEL-AMT
 21808                                        OC-LF-ITD-CANCEL-AMT
 21809         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21810         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21811         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21812         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21813         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21814         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21815         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21816         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21817         MOVE +0                     TO OC-AH-CANCEL-AMT
 21818                                        OC-AH-ITD-CANCEL-AMT
 21819         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21820         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21821         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21822     ELSE
 21823         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21824         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21825         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21826         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21827         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21828         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21829         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21830         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21831         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21832          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21833             MOVE SPACES             TO OC-LF-BENCD
 21834             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 405
* EL050.cbl
 21835                                        OC-LF-BEN-AMT
 21836                                        OC-LF-PRM-AMT
 21837                                        OC-LF-ALT-BEN-AMT
 21838                                        OC-LF-ALT-PRM-AMT
 21839                                        OC-LF-COMM-PCT
 21840                                        OC-LF-CANCEL-AMT
 21841             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21842             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21843         ELSE
 21844             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21845             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21846             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21847             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21848             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21849             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21850             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21851             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21852             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21853             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21854         END-IF
 21855         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21856         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21857          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21858             MOVE SPACES             TO OC-AH-BENCD
 21859             MOVE ZEROS              TO OC-AH-TERM
 21860                                        OC-AH-BEN-AMT
 21861                                        OC-AH-PRM-AMT
 21862                                        OC-AH-COMM-PCT
 21863                                        OC-AH-CANCEL-AMT
 21864                                        OC-AH-CP
 21865             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21866             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21867         ELSE
 21868             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21869             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21870             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21871             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21872             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21873             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21874             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21875             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21876             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21877         END-IF
 21878         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21879         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21880         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21881         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21882     END-IF
 21883     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21884
 21885     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21886
 21887
 21888* EXEC CICS READ
 21889*         DATASET   (FILE-ERMAIL)
 21890*         RIDFLD    (MA-CONTROL-PRIMARY)
 21891*         INTO      (MAILING-DATA)
 21892*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 406
* EL050.cbl
 21893*    END-EXEC
 21894     MOVE LENGTH OF
 21895      MAILING-DATA
 21896       TO DFHEIV11
 21897*    MOVE '&"IL       E          (  N#00020260' TO DFHEIV0
 21898     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21900     MOVE X'204E233030303230323630' TO DFHEIV0(25:11)
 21901     CALL 'kxdfhei1' USING DFHEIV0,
 21902           FILE-ERMAIL,
 21903           MAILING-DATA,
 21904           DFHEIV11,
 21905           MA-CONTROL-PRIMARY,
 21906           DFHEIV99,
 21907           DFHEIV99,
 21908           DFHEIV99
 21909     MOVE EIBRESP  TO WS-RESPONSE
 21910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21911
 21912     IF WS-RESP-NORMAL
 21913         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21914     END-IF.
 21915
 21916     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21917     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21918
 21919
 21920* EXEC CICS READ
 21921*         DATASET  (CRTT-ID)
 21922*         RIDFLD   (WS-ELCRTT-KEY)
 21923*         INTO     (CERTIFICATE-TRAILERS)
 21924*         RESP     (WS-RESPONSE)
 21925*    END-EXEC
 21926     MOVE LENGTH OF
 21927      CERTIFICATE-TRAILERS
 21928       TO DFHEIV11
 21929*    MOVE '&"IL       E          (  N#00020274' TO DFHEIV0
 21930     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21931     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21932     MOVE X'204E233030303230323734' TO DFHEIV0(25:11)
 21933     CALL 'kxdfhei1' USING DFHEIV0,
 21934           CRTT-ID,
 21935           CERTIFICATE-TRAILERS,
 21936           DFHEIV11,
 21937           WS-ELCRTT-KEY,
 21938           DFHEIV99,
 21939           DFHEIV99,
 21940           DFHEIV99
 21941     MOVE EIBRESP  TO WS-RESPONSE
 21942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21943
 21944     IF WS-RESP-NORMAL
 21945         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21946         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21947     END-IF.
 21948
 21949
 21950* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 407
* EL050.cbl
 21951*       DATASET   ('ELCRTO')
 21952*       FROM      (ORIGINAL-CERTIFICATE)
 21953*       RIDFLD    (OC-CONTROL-PRIMARY)
 21954*       RESP      (WS-RESPONSE)
 21955*    END-EXEC.
 21956     MOVE LENGTH OF
 21957      ORIGINAL-CERTIFICATE
 21958       TO DFHEIV11
 21959     MOVE 'ELCRTO' TO DFHEIV1
 21960*    MOVE '&$ L                  ''  N#00020286' TO DFHEIV0
 21961     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21962     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21963     MOVE X'204E233030303230323836' TO DFHEIV0(25:11)
 21964     CALL 'kxdfhei1' USING DFHEIV0,
 21965           DFHEIV1,
 21966           ORIGINAL-CERTIFICATE,
 21967           DFHEIV11,
 21968           OC-CONTROL-PRIMARY,
 21969           DFHEIV99,
 21970           DFHEIV99
 21971     MOVE EIBRESP  TO WS-RESPONSE
 21972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21973
 21974
 21975     GO TO 9991-EXIT.
 21976
 21977 9991-CHECK-INDICATORS.
 21978
 21979     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21980         GO TO 9991-EXIT
 21981     END-IF.
 21982
 21983     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21984         GO TO 9991-EXIT
 21985     END-IF.
 21986
 21987
 21988* EXEC CICS READ
 21989*       DATASET   ('ELCRTO')
 21990*       INTO      (ORIGINAL-CERTIFICATE)
 21991*       RIDFLD    (OC-CONTROL-PRIMARY)
 21992*       UPDATE
 21993*       RESP      (WS-RESPONSE)
 21994*    END-EXEC
 21995     MOVE LENGTH OF
 21996      ORIGINAL-CERTIFICATE
 21997       TO DFHEIV11
 21998     MOVE 'ELCRTO' TO DFHEIV1
 21999*    MOVE '&"IL       EU         (  N#00020305' TO DFHEIV0
 22000     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22001     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22002     MOVE X'204E233030303230333035' TO DFHEIV0(25:11)
 22003     CALL 'kxdfhei1' USING DFHEIV0,
 22004           DFHEIV1,
 22005           ORIGINAL-CERTIFICATE,
 22006           DFHEIV11,
 22007           OC-CONTROL-PRIMARY,
 22008           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 408
* EL050.cbl
 22009           DFHEIV99,
 22010           DFHEIV99
 22011     MOVE EIBRESP  TO WS-RESPONSE
 22012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22013     IF WS-RESP-NORMAL
 22014        IF PB-ISSUE
 22015          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22016          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22017          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22018          MOVE PB-I-AGE               TO OC-INS-AGE
 22019          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22020          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22021          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22022          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22023          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22024          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22025          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22026          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22027          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22028          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22029          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22030          IF PB-I-JOINT-COMMISSION > +0
 22031              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22032          ELSE
 22033              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22034          END-IF
 22035          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22036          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22037          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22038          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22039          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22040          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22041          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22042          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22043          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22044
 22045          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22046
 22047* EXEC CICS READ
 22048*             DATASET   (FILE-ERMAIL)
 22049*             RIDFLD    (MA-CONTROL-PRIMARY)
 22050*             INTO      (MAILING-DATA)
 22051*             RESP      (WS-RESPONSE)
 22052*         END-EXEC
 22053     MOVE LENGTH OF
 22054      MAILING-DATA
 22055       TO DFHEIV11
 22056*    MOVE '&"IL       E          (  N#00020345' TO DFHEIV0
 22057     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22059     MOVE X'204E233030303230333435' TO DFHEIV0(25:11)
 22060     CALL 'kxdfhei1' USING DFHEIV0,
 22061           FILE-ERMAIL,
 22062           MAILING-DATA,
 22063           DFHEIV11,
 22064           MA-CONTROL-PRIMARY,
 22065           DFHEIV99,
 22066           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 409
* EL050.cbl
 22067           DFHEIV99
 22068     MOVE EIBRESP  TO WS-RESPONSE
 22069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22070          IF WS-RESP-NORMAL
 22071             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22072          END-IF
 22073
 22074          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22075          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22076
 22077* EXEC CICS READ
 22078*             DATASET  (CRTT-ID)
 22079*             RIDFLD   (WS-ELCRTT-KEY)
 22080*             INTO     (CERTIFICATE-TRAILERS)
 22081*             RESP     (WS-RESPONSE)
 22082*         END-EXEC
 22083     MOVE LENGTH OF
 22084      CERTIFICATE-TRAILERS
 22085       TO DFHEIV11
 22086*    MOVE '&"IL       E          (  N#00020357' TO DFHEIV0
 22087     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22088     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22089     MOVE X'204E233030303230333537' TO DFHEIV0(25:11)
 22090     CALL 'kxdfhei1' USING DFHEIV0,
 22091           CRTT-ID,
 22092           CERTIFICATE-TRAILERS,
 22093           DFHEIV11,
 22094           WS-ELCRTT-KEY,
 22095           DFHEIV99,
 22096           DFHEIV99,
 22097           DFHEIV99
 22098     MOVE EIBRESP  TO WS-RESPONSE
 22099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22100          IF WS-RESP-NORMAL
 22101             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22102                               OC-INS-AGE-DEFAULT-FLAG
 22103             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22104                               OC-JNT-AGE-DEFAULT-FLAG
 22105          END-IF
 22106
 22107        ELSE
 22108          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22109             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22110             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22111             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22112          END-IF
 22113          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22114             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22115             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22116             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22117          END-IF
 22118          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22119        END-IF
 22120
 22121* EXEC CICS REWRITE
 22122*          DATASET   ('ELCRTO')
 22123*          FROM      (ORIGINAL-CERTIFICATE)
 22124*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 410
* EL050.cbl
 22125*       END-EXEC
 22126     MOVE LENGTH OF
 22127      ORIGINAL-CERTIFICATE
 22128       TO DFHEIV11
 22129     MOVE 'ELCRTO' TO DFHEIV1
 22130*    MOVE '&& L                  %  N#00020383' TO DFHEIV0
 22131     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22132     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22133     MOVE X'204E233030303230333833' TO DFHEIV0(25:11)
 22134     CALL 'kxdfhei1' USING DFHEIV0,
 22135           DFHEIV1,
 22136           ORIGINAL-CERTIFICATE,
 22137           DFHEIV11,
 22138           DFHEIV99
 22139     MOVE EIBRESP  TO WS-RESPONSE
 22140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22141     END-IF.
 22142
 22143 9991-EXIT.
 22144     EXIT.
 22145
 22146
 22147 9999-RETURN.
 22148     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22149
 22150
 22151* EXEC CICS RETURN
 22152*    END-EXEC.
 22153*    MOVE '.(                    ''   #00020397' TO DFHEIV0
 22154     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22155     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22156     MOVE X'2020233030303230333937' TO DFHEIV0(25:11)
 22157     CALL 'kxdfhei1' USING DFHEIV0,
 22158           DFHEIV99,
 22159           DFHEIV99,
 22160           DFHEIV99,
 22161           DFHEIV99,
 22162           DFHEIV99,
 22163           DFHEIV99
 22164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22165
 22166
 22167
 22168* GOBACK.
 22169     MOVE '9%                    "   ' TO DFHEIV0
 22170     MOVE 'EL050' TO DFHEIV1
 22171     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22172     GOBACK.
 22173
 22174 9999-DFHBACK SECTION.
 22175     MOVE '9%                    "   ' TO DFHEIV0
 22176     MOVE 'EL050' TO DFHEIV1
 22177     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22178     GOBACK.
 22179 9999-DFHEXIT.
 22180     IF DFHEIGDJ EQUAL 0001
 22181         NEXT SENTENCE
 22182     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 411
* EL050.cbl
 22183         GO TO 9300-ABEND,
 22184               3990-FILES-NOT-OPEN
 22185         DEPENDING ON DFHEIGDI
 22186     ELSE IF DFHEIGDJ EQUAL 3
 22187         GO TO 6610-START-BROWSE,
 22188               6630-ERRESS-PROBLEM,
 22189               6630-END-OF-FILE
 22190         DEPENDING ON DFHEIGDI
 22191     ELSE IF DFHEIGDJ EQUAL 4
 22192         GO TO 6630-END-OF-FILE,
 22193               6630-ERRESS-PROBLEM,
 22194               6630-ERRESS-PROBLEM,
 22195               6630-END-OF-FILE
 22196         DEPENDING ON DFHEIGDI
 22197     ELSE IF DFHEIGDJ EQUAL 5
 22198         GO TO 6630-END-OF-FILE,
 22199               6630-END-OF-FILE,
 22200               6630-ERRESS-PROBLEM,
 22201               6630-ERRESS-PROBLEM
 22202         DEPENDING ON DFHEIGDI
 22203     ELSE IF DFHEIGDJ EQUAL 6
 22204         GO TO 6660-START-BROWSE,
 22205               6690-ERRESC-PROBLEM,
 22206               6690-ERRESC-PROBLEM,
 22207               6690-END-OF-FILE
 22208         DEPENDING ON DFHEIGDI
 22209     ELSE IF DFHEIGDJ EQUAL 7
 22210         GO TO 6690-END-OF-FILE,
 22211               6690-ERRESC-PROBLEM,
 22212               6690-ERRESC-PROBLEM,
 22213               6690-END-OF-FILE
 22214         DEPENDING ON DFHEIGDI
 22215     ELSE IF DFHEIGDJ EQUAL 8
 22216         GO TO 6690-END-OF-FILE,
 22217               6690-ERRESC-PROBLEM,
 22218               6690-ERRESC-PROBLEM,
 22219               6690-END-OF-FILE
 22220         DEPENDING ON DFHEIGDI
 22221     ELSE IF DFHEIGDJ EQUAL 9
 22222         GO TO 7250-CONTINUE,
 22223               7250-CONTINUE
 22224         DEPENDING ON DFHEIGDI
 22225     ELSE IF DFHEIGDJ EQUAL 10
 22226         GO TO 7300-CONTINUE,
 22227               7300-CONTINUE
 22228         DEPENDING ON DFHEIGDI
 22229     ELSE IF DFHEIGDJ EQUAL 11
 22230         GO TO 8000-FREE-MAIN
 22231         DEPENDING ON DFHEIGDI
 22232     ELSE IF DFHEIGDJ EQUAL 12
 22233         GO TO 8100-NOTFND,
 22234               8100-NOTFND
 22235         DEPENDING ON DFHEIGDI
 22236     ELSE IF DFHEIGDJ EQUAL 13
 22237         GO TO 8110-NOTFND,
 22238               8110-NOTFND
 22239         DEPENDING ON DFHEIGDI
 22240     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 412
* EL050.cbl
 22241         GO TO 8130-EXIT
 22242         DEPENDING ON DFHEIGDI
 22243     ELSE IF DFHEIGDJ EQUAL 15
 22244         GO TO 8150-exit
 22245         DEPENDING ON DFHEIGDI
 22246     ELSE IF DFHEIGDJ EQUAL 16
 22247         GO TO 8180-NOTFND
 22248         DEPENDING ON DFHEIGDI
 22249     ELSE IF DFHEIGDJ EQUAL 17
 22250         GO TO 8190-NOTFND
 22251         DEPENDING ON DFHEIGDI
 22252     ELSE IF DFHEIGDJ EQUAL 18
 22253         GO TO 8195-NOTFND
 22254         DEPENDING ON DFHEIGDI
 22255     ELSE IF DFHEIGDJ EQUAL 19
 22256         GO TO 8200-NOTFND
 22257         DEPENDING ON DFHEIGDI
 22258     ELSE IF DFHEIGDJ EQUAL 20
 22259         GO TO 8300-NOTFND,
 22260               8300-ERRESS-PROBLEM,
 22261               8300-ERRESS-PROBLEM,
 22262               8300-NOTFND
 22263         DEPENDING ON DFHEIGDI
 22264     ELSE IF DFHEIGDJ EQUAL 21
 22265         GO TO 8450-FORM-NOT-FOUND,
 22266               8450-FORM-NOT-FOUND
 22267         DEPENDING ON DFHEIGDI
 22268     ELSE IF DFHEIGDJ EQUAL 22
 22269         GO TO 0199-ACCT-NOT-FOUND,
 22270               0199-ACCT-NOT-FOUND
 22271         DEPENDING ON DFHEIGDI
 22272     ELSE IF DFHEIGDJ EQUAL 23
 22273         GO TO 0199-ACCT-NOT-FOUND,
 22274               0199-ACCT-NOT-FOUND
 22275         DEPENDING ON DFHEIGDI
 22276     ELSE IF DFHEIGDJ EQUAL 24
 22277         GO TO 8582-COMP-NOT-FOUND,
 22278               8582-COMP-NOT-FOUND
 22279         DEPENDING ON DFHEIGDI
 22280     ELSE IF DFHEIGDJ EQUAL 25
 22281         GO TO 8583-AGTC-NOT-FOUND,
 22282               8583-AGTC-NOT-FOUND
 22283         DEPENDING ON DFHEIGDI
 22284     ELSE IF DFHEIGDJ EQUAL 26
 22285         GO TO 8584-BXRF-NOT-FOUND,
 22286               8584-BXRF-NOT-FOUND
 22287         DEPENDING ON DFHEIGDI
 22288     ELSE IF DFHEIGDJ EQUAL 27
 22289         GO TO 8585-PLAN-NOT-FOUND,
 22290               8585-PLAN-NOT-FOUND
 22291         DEPENDING ON DFHEIGDI
 22292     ELSE IF DFHEIGDJ EQUAL 28
 22293         GO TO 0299-CERT-NOT-FOUND
 22294         DEPENDING ON DFHEIGDI
 22295     ELSE IF DFHEIGDJ EQUAL 29
 22296         GO TO 8700-READ-CERT-MASTER
 22297         DEPENDING ON DFHEIGDI
 22298     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 06-Jan-16 11:10 Page 413
* EL050.cbl
 22299         GO TO 8720-COMP-ACCOUNTS,
 22300               8730-END-BROWSE,
 22301               8740-NOT-FOUND
 22302         DEPENDING ON DFHEIGDI
 22303     ELSE IF DFHEIGDJ EQUAL 31
 22304         GO TO 9000-NOTFND
 22305         DEPENDING ON DFHEIGDI
 22306     ELSE IF DFHEIGDJ EQUAL 32
 22307         GO TO 9100-NOTFND,
 22308               9100-NOTFND
 22309         DEPENDING ON DFHEIGDI
 22310     ELSE IF DFHEIGDJ EQUAL 33
 22311         GO TO 9991-CRTO-NOT-FOUND,
 22312               9991-CRTO-NOT-FOUND
 22313         DEPENDING ON DFHEIGDI.
 22314     MOVE '9%                    "   ' TO DFHEIV0
 22315     MOVE 'EL050' TO DFHEIV1
 22316     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22317     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40688     Code:       90230
