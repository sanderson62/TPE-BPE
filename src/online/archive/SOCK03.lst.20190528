* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51*071117   IR2017061900003  PEMA  ALLOW 0% APR ON REFUNDS
    52* 100417  CR2017051000002  PEMA  Add fields to interface
    53* 100418  CR2018073000001  PEMA  REWORD REFUND METHODS
    54* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    55******************************************************************
    56 environment division.
    57 data division.
    58 working-storage section.
    59 01  DFH-START PIC X(04).
    60*
    61* program buffers
    62*
    63 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    64     88  ALREADY-SENT              VALUE 'Y'.
    65 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    66 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    67     88  ELCERT-FINISHED            VALUE 'Y'.
    68 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    69 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    70     88  ERACCT-FOUND               VALUE 'Y'.
    71 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page   3
* SOCK03.cbl
    72 77 ws-send-msg-size           pic s9(8) comp value 4096.
    73 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    74 77 ws-recv-buf                pic x(4096).
    75 77 ws-send-buf                pic x(4096) VALUE SPACES.
    76 77 ws-recv-total              pic s9(8) comp value 0.
    77 77 ws-recv-left               pic s9(8) comp value 0.
    78 77 ws-seq-num                 pic s9(8) comp value 0.
    79 77 ws-flags                   pic s9(8) comp value 0.
    80 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    81 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    82 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    83 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    84 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    85 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    86 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    87 77  ws-cancel-reason            pic x   value spaces.
    88 77  P1                          PIC S999 COMP-3 VALUE +0.
    89 77  P2                          PIC S999 COMP-3 VALUE +0.
    90 77  C0                          PIC S999 COMP-3 VALUE +0.
    91 77  C1                          PIC S999 COMP-3 VALUE +0.
    92 77  C2                          PIC S999 COMP-3 VALUE +0.
    93 77  C3                          PIC S999 COMP-3 VALUE +0.
    94 77 S1                           PIC S999 COMP-3 VALUE +0.
    95 77 S2                           PIC S999 COMP-3 VALUE +0.
    96 77 L1                           PIC S999 COMP-3 VALUE +0.
    97 77 L2                           PIC S999 COMP-3 VALUE +0.
    98 77 F1                           PIC S999 COMP-3 VALUE +0.
    99 77 WS-BUILD-SW                  PIC X.
   100    88  TIME-TO-BUILD               VALUE 'Y'.
   101 77 WS-SAVE-ERACCT               PIC X(2000).
   102 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
   103 77 WS-STOP-SW                   PIC X  VALUE ' '.
   104    88  TOLD-TO-STOP               VALUE 'Y'.
   105 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   106    88  GET-RATES                    VALUE 'R'.
   107    88  GET-ACT-ACCTS                VALUE 'A'.
   108 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   109 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   110 77 ws-disp-rate                 pic z9.99999.
   111 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   112     88  END-OF-ERCTBL                 VALUE 'Y'.
   113 77  WS-STATUS                   PIC X.
   114 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   115 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   116 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   117 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   118 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   119 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   120 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   121 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   122 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   123 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   124 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   125 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   126     88  WS-ELCERT-FULL             VALUE '1'.
   127     88  WS-ELCERT-NAME             VALUE '2'.
   128     88  WS-ELCERT-CERT-NO          VALUE '3'.
   129     88  WS-ELCERT-ACT-NAME         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page   4
* SOCK03.cbl
   130 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   131 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   132     88  I-SAY-TO-STOP      VALUE 'Y'.
   133 77  WS-HEX-0A                   PIC X.
   134 77  WS-CALL-TYPE                PIC X(6).
   135 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   136 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   137 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   138 77  DD-IU-SW                    PIC X   VALUE ' '.
   139     88  DD-IU-PRESENT                 VALUE 'Y'.
   140 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   141 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   142 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   143 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   144 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   145 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   146 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   147 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   148 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   149     88  PDEF-FOUND                              VALUE 'Y'.
   150 77  ws-epiq-sw                  pic x  value ' '.
   151     88  ws-epiq-request           value 'Y'.
   152 77  ws-epiq-max                 pic s999 value +0 comp-3.
   153 01  WS-STRING-DATA.
   154     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   155     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   156     05  WS-CARRIER              PIC X        VALUE SPACES.
   157     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   158     05  WS-STATE                PIC XX       VALUE SPACES.
   159     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   160     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   161     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   162     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   163     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   164     05  WS-MID-INIT             PIC X        VALUE SPACES.
   165     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   166     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   167     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   168     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   169     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   170     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   171     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   172     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   173     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   174     05  WS-LF-METHOD            PIC X(15)    VALUE SPACES.
   175     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   176     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   177     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   178     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   179     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   180     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   181     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   182     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   183     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   184     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   185     05  WS-AH-METHOD            PIC X(15)    VALUE SPACES.
   186     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   187     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page   5
* SOCK03.cbl
   188     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   189     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   190     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   191     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   192     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   193     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   194     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   195     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   196     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   197     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   198     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   199     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   200     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   201     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   202     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   203     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   204     05  WS-LF-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   205     05  WS-AH-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   206     05  WS-VIN                  PIC X(17)  VALUE SPACES.
   207     05  WS-CRED-BENE-NAME       PIC X(30)  VALUE SPACES.
   208 01  ws-work-date.
   209     05  ws-work-ccyy            pic x(4).
   210     05  ws-work-mm              pic xx.
   211     05  ws-work-dd              pic xx.
   212 01  ws-work-date-num redefines ws-work-date
   213                                 pic 9(8).
   214 01  FILLER.
   215     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   216     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   217     12  WS-STATE-ABBREVIATION   PIC XX.
   218     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   219     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   220     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   221     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   222     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   223     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   224     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   225     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   226     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   227     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   228     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   229     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   230     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   231     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   232     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   233     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   234     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   235     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   236     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   237     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   238     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   239     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   240     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   241     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   242     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   243     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   244         88  WS-REDUCING                         VALUE 'R'.
   245         88  WS-LEVEL                            VALUE 'L'  'P'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page   6
* SOCK03.cbl
   246 01  ELMSTR-KEY.
   247     12  ELMSTR-COMP-CD          PIC X.
   248     12  ELMSTR-CERT-NO          PIC X(11).
   249 01  CTBL-KEY-SAVE               PIC X(5).
   250 01  CTBL-KEY.
   251     05  CTBL-COMPANY-CD         PIC X.
   252     05  CTBL-TABLE              PIC XXX.
   253     05  CTBL-BEN-TYPE           PIC X.
   254     05  CTBL-BEN-CODE           PIC XX.
   255 01  ERPDEF-KEY-SAVE             PIC X(18).
   256 01  ERPDEF-KEY.
   257     12  ERPDEF-COMPANY-CD       PIC X.
   258     12  ERPDEF-STATE            PIC XX.
   259     12  ERPDEF-PROD-CD          PIC XXX.
   260     12  F                       PIC X(7).
   261     12  ERPDEF-BEN-TYPE         PIC X.
   262     12  ERPDEF-BEN-CODE         PIC XX.
   263     12  ERPDEF-EXP-DT           PIC XX.
   264 01  WS-AM3-KEY.
   265     12  WS-AM3-ACCOUNT          PIC X(10).
   266     12  WS-AM3-EXP-DT           PIC XX.
   267 01  WS-AM-KEY.
   268     12  WS-AM-COMPANY-CD        PIC X.
   269     12  WS-AM-CARRIER           PIC X.
   270     12  WS-AM-GROUPING          PIC X(6).
   271     12  WS-AM-STATE             PIC XX.
   272     12  WS-AM-ACCOUNT           PIC X(10).
   273     12  WS-AM-EXPIRATION-DT     PIC XX.
   274     12  WS-AM-FILLER            PIC XXXX.
   275 01  WS-CO-DATA.
   276     05  WS-CO-NUM               PIC X(10).
   277     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   278     05  WS-CO-NAME              PIC X(30).
   279     05  WS-CO-MAIL-NAME         PIC X(30).
   280     05  WS-CO-ADDR1             PIC X(30).
   281     05  WS-CO-ADDR2             PIC X(30).
   282     05  WS-CO-ADDR3             PIC X(30).
   283     05  WS-CO-ZIP               PIC X(9).
   284     05  WS-CO-PHONE             PIC X(10).
   285 01  WS-CF-KEY.
   286     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   287     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   288*        88  COMPANY-MASTER                      VALUE '1'.
   289*        88  STATE-MASTER                        VALUE '3'.
   290*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   291*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   292     12  WS-CF-ACCESS.
   293         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   294         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   295             20  FILLER          PIC  X(01).
   296             20  WS-CF-CARRIER   PIC  X(01).
   297     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   298 01  WS-CS-KEY.
   299     05  WS-CS-COMPANY-CD        PIC X.
   300     05  WS-CS-CARRIER           PIC X.
   301     05  WS-CS-GROUP             PIC X(6).
   302     05  WS-CS-STATE             PIC XX.
   303     05  WS-CS-ACCOUNT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page   7
* SOCK03.cbl
   304     05  WS-CS-EFF-DT            PIC XX.
   305     05  WS-CS-CERT-NO           PIC X(11).
   306     05  WS-CS-TRLR-TYPE         PIC X.
   307 01  WS-MA-KEY.
   308     05  WS-MA-COMPANY-CD        PIC X.
   309     05  WS-MA-CARRIER           PIC X.
   310     05  WS-MA-GROUP             PIC X(6).
   311     05  WS-MA-STATE             PIC XX.
   312     05  WS-MA-ACCOUNT           PIC X(10).
   313     05  WS-MA-EFF-DT            PIC XX.
   314     05  WS-MA-CERT-NO           PIC X(11).
   315 01  WS-CM-KEY.
   316     05  WS-CM-COMPANY-CD        PIC X.
   317     05  WS-CM-CARRIER           PIC X.
   318     05  WS-CM-GROUP             PIC X(6).
   319     05  WS-CM-STATE             PIC XX.
   320     05  WS-CM-ACCOUNT           PIC X(10).
   321     05  WS-CM-EFF-DT            PIC XX.
   322     05  WS-CM-CERT-NO           PIC X(11).
   323 01  WS-CM-KEY-A1.
   324     05  WS-CM-COMPANY-CD-A1     PIC X.
   325     05  WS-CM-LAST-NAME         PIC X(15).
   326     05  WS-CM-INITIALS          PIC XX.
   327 01  WS-CM-KEY-A4.
   328     05  WS-CM-COMPANY-CD-A4     PIC X.
   329     05  WS-CM-CERT-NO-A4        PIC X(11).
   330 01  WS-CID-NO                   PIC X(8).
   331 01  WS-DISP-RESP                PIC 9(5).
   332 01  WS-RESPONSE                 PIC S9(8)   COMP.
   333     88  RESP-NORMAL                  VALUE +00.
   334     88  RESP-NOTFND                  VALUE +13.
   335     88  RESP-DUPKEY                  VALUE +15.
   336     88  RESP-NOTOPEN                 VALUE +19.
   337     88  RESP-ENDFILE                 VALUE +20.
   338*                                 COPY ELCCERT.
   339******************************************************************
   340*                                                                *
   341*                            ELCCERT.                            *
   342*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   343*                            VMOD=2.013                          *
   344*                                                                *
   345*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   346*                                                                *
   347*   FILE TYPE = VSAM,KSDS                                        *
   348*   RECORD SIZE = 450  RECFORM = FIXED                           *
   349*                                                                *
   350*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   351*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   352*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   353*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   354*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   355*                                                                *
   356*   LOG = YES                                                    *
   357*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   358******************************************************************
   359*                   C H A N G E   L O G
   360*
   361* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page   8
* SOCK03.cbl
   362*-----------------------------------------------------------------
   363*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   364* EFFECTIVE    NUMBER
   365*-----------------------------------------------------------------
   366* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   367* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   368* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   369* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   370* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   371* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   372* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   373* 032612  CR2011110200001  PEMA  AHL CHANGES
   374* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   375* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   376* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   377******************************************************************
   378
   379 01  CERTIFICATE-MASTER.
   380     12  CM-RECORD-ID                      PIC XX.
   381         88  VALID-CM-ID                      VALUE 'CM'.
   382
   383     12  CM-CONTROL-PRIMARY.
   384         16  CM-COMPANY-CD                 PIC X.
   385         16  CM-CARRIER                    PIC X.
   386         16  CM-GROUPING.
   387             20  CM-GROUPING-PREFIX        PIC X(3).
   388             20  CM-GROUPING-PRIME         PIC X(3).
   389         16  CM-STATE                      PIC XX.
   390         16  CM-ACCOUNT.
   391             20  CM-ACCOUNT-PREFIX         PIC X(4).
   392             20  CM-ACCOUNT-PRIME          PIC X(6).
   393         16  CM-CERT-EFF-DT                PIC XX.
   394         16  CM-CERT-NO.
   395             20  CM-CERT-PRIME             PIC X(10).
   396             20  CM-CERT-SFX               PIC X.
   397
   398     12  CM-CONTROL-BY-NAME.
   399         16  CM-COMPANY-CD-A1              PIC X.
   400         16  CM-INSURED-LAST-NAME          PIC X(15).
   401         16  CM-INSURED-INITIALS.
   402             20  CM-INSURED-INITIAL1       PIC X.
   403             20  CM-INSURED-INITIAL2       PIC X.
   404
   405     12  CM-CONTROL-BY-SSN.
   406         16  CM-COMPANY-CD-A2              PIC X.
   407         16  CM-SOC-SEC-NO.
   408             20  CM-SSN-STATE              PIC XX.
   409             20  CM-SSN-ACCOUNT            PIC X(6).
   410             20  CM-SSN-LN3.
   411                 25  CM-INSURED-INITIALS-A2.
   412                     30 CM-INSURED-INITIAL1-A2   PIC X.
   413                     30 CM-INSURED-INITIAL2-A2   PIC X.
   414                 25 CM-PART-LAST-NAME-A2         PIC X.
   415
   416     12  CM-CONTROL-BY-CERT-NO.
   417         16  CM-COMPANY-CD-A4              PIC X.
   418         16  CM-CERT-NO-A4                 PIC X(11).
   419
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page   9
* SOCK03.cbl
   420     12  CM-CONTROL-BY-MEMB.
   421         16  CM-COMPANY-CD-A5              PIC X.
   422         16  CM-MEMBER-NO.
   423             20  CM-MEMB-STATE             PIC XX.
   424             20  CM-MEMB-ACCOUNT           PIC X(6).
   425             20  CM-MEMB-LN4.
   426                 25  CM-INSURED-INITIALS-A5.
   427                     30 CM-INSURED-INITIAL1-A5   PIC X.
   428                     30 CM-INSURED-INITIAL2-A5   PIC X.
   429                 25 CM-PART-LAST-NAME-A5         PIC XX.
   430
   431     12  CM-INSURED-PROFILE-DATA.
   432         16  CM-INSURED-FIRST-NAME.
   433             20  CM-INSURED-1ST-INIT       PIC X.
   434             20  FILLER                    PIC X(9).
   435         16  CM-INSURED-ISSUE-AGE          PIC 99.
   436         16  CM-INSURED-SEX                PIC X.
   437             88  CM-SEX-MALE                  VALUE 'M'.
   438             88  CM-SEX-FEMAL                 VALUE 'F'.
   439         16  CM-INSURED-JOINT-AGE          PIC 99.
   440         16  CM-JOINT-INSURED-NAME.
   441             20  CM-JT-LAST-NAME           PIC X(15).
   442             20  CM-JT-FIRST-NAME.
   443                 24  CM-JT-1ST-INIT        PIC X.
   444                 24  FILLER                PIC X(9).
   445             20  CM-JT-INITIAL             PIC X.
   446
   447     12  CM-LIFE-DATA.
   448         16  CM-LF-BENEFIT-CD              PIC XX.
   449         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   450         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   451         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   452         16  CM-LF-DEV-CODE                PIC XXX.
   453         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   454         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   455         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   456         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   457         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   458         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   459         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   460         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   461         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   462         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   463         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   464         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   465         16  cm-temp-epiq                  pic xx.
   466             88  EPIQ-CLASS                  value 'EQ'.
   467*        16  FILLER                        PIC XX.
   468
   469     12  CM-AH-DATA.
   470         16  CM-AH-BENEFIT-CD              PIC XX.
   471         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   472         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   473         16  CM-AH-DEV-CODE                PIC XXX.
   474         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   475         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   476         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   477         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  10
* SOCK03.cbl
   478         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   479         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   480         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   481         16  CM-AH-PAID-THRU-DT            PIC XX.
   482             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   483         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   484         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   485         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   486         16  FILLER                        PIC X.
   487
   488     12  CM-LOAN-INFORMATION.
   489         16  CM-LIVES                      PIC S9(7)     COMP-3.
   490         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   491                                           PIC S9(5)V99  COMP-3.
   492         16  CM-BILLED                     PIC S9(7)     COMP-3.
   493         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   494         16  CM-PAY-FREQUENCY              PIC S99.
   495         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   496         16  CM-RATE-CLASS                 PIC XX.
   497         16  CM-BENEFICIARY                PIC X(25).
   498         16  CM-POLICY-FORM-NO             PIC X(12).
   499         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   500         16  CM-LAST-ADD-ON-DT             PIC XX.
   501         16  CM-DEDUCTIBLE-AMOUNTS.
   502             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   503             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   504         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   505             20  CM-RESIDENT-STATE         PIC XX.
   506             20  CM-RATE-CODE              PIC X(4).
   507             20  FILLER                    PIC XX.
   508         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   509             20  CM-LOAN-OFFICER           PIC X(5).
   510             20  FILLER                    PIC XXX.
   511         16  CM-CSR-CODE                   PIC XXX.
   512         16  CM-UNDERWRITING-CODE          PIC X.
   513             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   514         16  CM-POST-CARD-IND              PIC X.
   515         16  CM-REF-INTERFACE-SW           PIC X.
   516         16  CM-PREMIUM-TYPE               PIC X.
   517             88  CM-SING-PRM                  VALUE '1'.
   518             88  CM-O-B-COVERAGE              VALUE '2'.
   519             88  CM-OPEN-END                  VALUE '3'.
   520         16  CM-IND-GRP-TYPE               PIC X.
   521             88  CM-INDIVIDUAL                VALUE 'I'.
   522             88  CM-GROUP                     VALUE 'G'.
   523         16  CM-SKIP-CODE                  PIC X.
   524             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   525             88  SKIP-JULY                    VALUE '1'.
   526             88  SKIP-AUGUST                  VALUE '2'.
   527             88  SKIP-SEPTEMBER               VALUE '3'.
   528             88  SKIP-JULY-AUG                VALUE '4'.
   529             88  SKIP-AUG-SEPT                VALUE '5'.
   530             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   531             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   532             88  SKIP-JUNE                    VALUE '8'.
   533             88  SKIP-JUNE-JULY               VALUE '9'.
   534             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   535             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  11
* SOCK03.cbl
   536         16  CM-PAYMENT-MODE               PIC X.
   537             88  PAY-MONTHLY                  VALUE SPACE.
   538             88  PAY-WEEKLY                   VALUE '1'.
   539             88  PAY-SEMI-MONTHLY             VALUE '2'.
   540             88  PAY-BI-WEEKLY                VALUE '3'.
   541             88  PAY-SEMI-ANUALLY             VALUE '4'.
   542         16  CM-LOAN-NUMBER                PIC X(8).
   543         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   544         16  CM-OLD-LOF                    PIC XXX.
   545*        16  CM-LOAN-OFFICER               PIC XXX.
   546         16  CM-REIN-TABLE                 PIC XXX.
   547         16  CM-SPECIAL-REIN-CODE          PIC X.
   548         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   549         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   550         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   551
   552     12  CM-STATUS-DATA.
   553         16  CM-ENTRY-STATUS               PIC X.
   554         16  CM-ENTRY-DT                   PIC XX.
   555
   556         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   557         16  CM-LF-CANCEL-DT               PIC XX.
   558         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   559
   560         16  CM-LF-STATUS-AT-DEATH         PIC X.
   561         16  CM-LF-DEATH-DT                PIC XX.
   562         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   563
   564         16  CM-LF-CURRENT-STATUS          PIC X.
   565             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   566                                                'M' '4' '5' '9'.
   567             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   568             88  CM-LF-POLICY-PENDING         VALUE '2'.
   569             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   570             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   571             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   572             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   573             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   574             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   575             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   576             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   577             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   578             88  CM-LF-DECLINED               VALUE 'D'.
   579             88  CM-LF-VOIDED                 VALUE 'V'.
   580
   581         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   582         16  CM-AH-CANCEL-DT               PIC XX.
   583         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   584
   585         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   586         16  CM-AH-SETTLEMENT-DT           PIC XX.
   587         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   588
   589         16  CM-AH-CURRENT-STATUS          PIC X.
   590             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   591                                                'M' '4' '5' '9'.
   592             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   593             88  CM-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  12
* SOCK03.cbl
   594             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   595             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   596             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   597             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   598             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   599             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   600             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   601             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   602             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   603             88  CM-AH-DECLINED               VALUE 'D'.
   604             88  CM-AH-VOIDED                 VALUE 'V'.
   605
   606         16  CM-CLAIM-INTERFACE-SW         PIC X.
   607             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   608             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   609             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   610         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   611
   612         16  CM-ENTRY-BATCH                PIC X(6).
   613         16  CM-LF-EXIT-BATCH              PIC X(6).
   614         16  CM-AH-EXIT-BATCH              PIC X(6).
   615         16  CM-LAST-MONTH-END             PIC XX.
   616
   617     12  CM-NOTE-SW                        PIC X.
   618         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   619         88  CERT-NOTES-PRESENT               VALUE '1'.
   620         88  BILLING-NOTES-PRESENT            VALUE '2'.
   621         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   622         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   623         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   624         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   625         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   626     12  CM-COMP-EXCP-SW                   PIC X.
   627         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   628         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   629     12  CM-INSURED-ADDRESS-SW             PIC X.
   630         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   631         88  INSURED-ADDR-PRESENT             VALUE '1'.
   632
   633*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   634     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   635     12  FILLER                            PIC X.
   636
   637*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   638     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   639     12  FILLER                            PIC X.
   640*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   641     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   642
   643     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   644         88  CERT-ADDED-BATCH                 VALUE ' '.
   645         88  CERT-ADDED-ONLINE                VALUE '1'.
   646         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   647         88  CERT-PURGED-OFFLINE              VALUE '3'.
   648         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   649     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   650         88  CERT-AS-LOADED                   VALUE ' '.
   651         88  CERT-CANCELLED-ONLINE            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  13
* SOCK03.cbl
   652         88  CERT-CLAIM-ONLINE                VALUE '2'.
   653         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   654         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   655         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   656         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   657         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   658
   659     12  CM-ACCOUNT-COMM-PCTS.
   660         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   661         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   662
   663     12  CM-USER-FIELD                     PIC X.
   664     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   665     12  CM-CLP-STATE                      PIC XX.
   666     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   667     12  CM-USER-RESERVED                  PIC XXX.
   668     12  FILLER REDEFINES CM-USER-RESERVED.
   669         16  CM-AH-CLASS-CD                PIC XX.
   670         16  F                             PIC X.
   671******************************************************************
   672*                                 COPY ELCMSTR.
   673******************************************************************
   674*                                                                *
   675*                            ELCMSTR.                            *
   676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   677*                            VMOD=2.012                          *
   678*                                                                *
   679*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   680*                                                                *
   681*   FILE TYPE = VSAM,KSDS                                        *
   682*   RECORD SIZE = 350  RECFORM = FIXED                           *
   683*                                                                *
   684*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   685*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   686*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   687*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   688*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   689*                                                 RKP=75,LEN=21  *
   690*                                                                *
   691*   **** NOTE ****                                               *
   692*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   693*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   694*                                                                *
   695*   LOG = YES                                                    *
   696*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   697******************************************************************
   698*                   C H A N G E   L O G
   699*
   700* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   701*-----------------------------------------------------------------
   702*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   703* EFFECTIVE    NUMBER
   704*-----------------------------------------------------------------
   705* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   706* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   707* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   708* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   709* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  14
* SOCK03.cbl
   710* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   711* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   712******************************************************************
   713 01  CLAIM-MASTER.
   714     12  CL-RECORD-ID                PIC XX.
   715         88  VALID-CL-ID         VALUE 'CL'.
   716
   717     12  CL-CONTROL-PRIMARY.
   718         16  CL-COMPANY-CD           PIC X.
   719         16  CL-CARRIER              PIC X.
   720         16  CL-CLAIM-NO             PIC X(7).
   721         16  CL-CERT-NO.
   722             20  CL-CERT-PRIME       PIC X(10).
   723             20  CL-CERT-SFX         PIC X.
   724
   725     12  CL-CONTROL-BY-NAME.
   726         16  CL-COMPANY-CD-A1        PIC X.
   727         16  CL-INSURED-LAST-NAME    PIC X(15).
   728         16  CL-INSURED-NAME.
   729             20  CL-INSURED-1ST-NAME PIC X(12).
   730             20  CL-INSURED-MID-INIT PIC X.
   731
   732     12  CL-CONTROL-BY-SSN.
   733         16  CL-COMPANY-CD-A2        PIC X.
   734         16  CL-SOC-SEC-NO.
   735             20  CL-SSN-STATE        PIC XX.
   736             20  CL-SSN-ACCOUNT      PIC X(6).
   737             20  CL-SSN-LN3          PIC X(3).
   738
   739     12  CL-CONTROL-BY-CERT-NO.
   740         16  CL-COMPANY-CD-A4        PIC X.
   741         16  CL-CERT-NO-A4.
   742             20  CL-CERT-A4-PRIME    PIC X(10).
   743             20  CL-CERT-A4-SFX      PIC X.
   744
   745     12  CL-CONTROL-BY-CCN.
   746         16  CL-COMPANY-CD-A5        PIC X.
   747         16  CL-CCN-A5.
   748             20  CL-CCN.
   749                 24  CL-CCN-PREFIX-A5 PIC X(4).
   750                 24  CL-CCN-PRIME-A5 PIC X(12).
   751             20  CL-CCN-FILLER-A5    PIC X(4).
   752
   753     12  CL-INSURED-PROFILE-DATA.
   754         16  CL-INSURED-BIRTH-DT     PIC XX.
   755         16  CL-INSURED-SEX-CD       PIC X.
   756             88  INSURED-IS-MALE        VALUE 'M'.
   757             88  INSURED-IS-FEMALE      VALUE 'F'.
   758             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   759         16  CL-INSURED-OCC-CD       PIC X(6).
   760         16  FILLER                  PIC X(5).
   761
   762     12  CL-PROCESSING-INFO.
   763         16  CL-PROCESSOR-ID         PIC X(4).
   764         16  CL-CLAIM-STATUS         PIC X.
   765             88  CLAIM-IS-OPEN          VALUE 'O'.
   766             88  CLAIM-IS-CLOSED        VALUE 'C'.
   767         16  CL-CLAIM-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  15
* SOCK03.cbl
   768*            88  AH-CLAIM               VALUE 'A'.
   769*            88  LIFE-CLAIM             VALUE 'L'.
   770*            88  PROPERTY-CLAIM         VALUE 'P'.
   771*            88  IUI-CLAIM              VALUE 'I'.
   772*            88  GAP-CLAIM              VALUE 'G'.
   773*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   774*            88  OTHER-CLAIM            VALUE 'O'.
   775         16  CL-CLAIM-PREM-TYPE      PIC X.
   776             88  SINGLE-PREMIUM         VALUE '1'.
   777             88  O-B-COVERAGE           VALUE '2'.
   778             88  OPEN-END-COVERAGE      VALUE '3'.
   779         16  CL-INCURRED-DT          PIC XX.
   780         16  CL-REPORTED-DT          PIC XX.
   781         16  CL-FILE-ESTABLISH-DT    PIC XX.
   782         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   783         16  CL-LAST-PMT-DT          PIC XX.
   784         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   785         16  CL-PAID-THRU-DT         PIC XX.
   786         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   787         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   788         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   789         16  CL-PMT-CALC-METHOD      PIC X.
   790             88  CL-360-DAY-YR          VALUE '1'.
   791             88  CL-365-DAY-YR          VALUE '2'.
   792             88  CL-FULL-MONTHS         VALUE '3'.
   793         16  CL-CAUSE-CD             PIC X(6).
   794
   795         16  CL-PRIME-CERT-NO.
   796             20  CL-PRIME-CERT-PRIME PIC X(10).
   797             20  CL-PRIME-CERT-SFX   PIC X.
   798
   799         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   800             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   801             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   802
   803         16  CL-MICROFILM-NO         PIC X(10).
   804         16  FILLER REDEFINES CL-MICROFILM-NO.
   805             20  CL-BENEFIT-PERIOD   PIC 99.
   806             20  FILLER              PIC X(8).
   807         16  CL-PROG-FORM-TYPE       PIC X.
   808         16  CL-LAST-ADD-ON-DT       PIC XX.
   809
   810         16  CL-LAST-REOPEN-DT       PIC XX.
   811         16  CL-LAST-CLOSE-DT        PIC XX.
   812         16  CL-LAST-CLOSE-REASON    PIC X(01).
   813             88  FINAL-PAID             VALUE '1'.
   814             88  CLAIM-DENIED           VALUE '2'.
   815             88  AUTO-CLOSE             VALUE '3'.
   816             88  MANUAL-CLOSE           VALUE '4'.
   817             88  BENEFITS-CHANGED       VALUE 'C'.
   818             88  SETUP-ERRORS           VALUE 'E'.
   819         16  CL-ASSOC-CERT-SEQU      PIC S99.
   820         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   821         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   822             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   823         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   824         16  FILLER                  PIC X.
   825
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  16
* SOCK03.cbl
   826     12  CL-CERTIFICATE-DATA.
   827         16  CL-CERT-ORIGIN          PIC X.
   828             88  CERT-WAS-ONLINE        VALUE '1'.
   829             88  CERT-WAS-CREATED       VALUE '2'.
   830             88  COVERAGE-WAS-ADDED     VALUE '3'.
   831         16  CL-CERT-KEY-DATA.
   832             20  CL-CERT-CARRIER     PIC X.
   833             20  CL-CERT-GROUPING    PIC X(6).
   834             20  CL-CERT-STATE       PIC XX.
   835             20  CL-CERT-ACCOUNT.
   836                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   837                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   838             20  CL-CERT-EFF-DT      PIC XX.
   839
   840     12  CL-STATUS-CONTROLS.
   841         16  CL-PRIORITY-CD          PIC X.
   842             88  CONFIDENTIAL-DATA      VALUE '8'.
   843             88  HIGHEST-PRIORITY       VALUE '9'.
   844         16  CL-SUPV-ATTN-CD         PIC X.
   845             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   846             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   847         16  CL-PURGED-DT            PIC XX.
   848         16  CL-RESTORED-DT          PIC XX.
   849         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   850         16  CL-NEXT-RESEND-DT       PIC XX.
   851         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   852         16  CL-CRITICAL-PERIOD      PIC 99.
   853*        16  FILLER                  PIC XX.
   854         16  CL-LAST-MAINT-DT        PIC XX.
   855         16  CL-LAST-MAINT-USER      PIC X(4).
   856         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   857         16  CL-LAST-MAINT-TYPE      PIC X.
   858             88  CLAIM-SET-UP           VALUE ' '.
   859             88  PAYMENT-MADE           VALUE '1'.
   860             88  LETTER-SENT            VALUE '2'.
   861             88  MASTER-WAS-ALTERED     VALUE '3'.
   862             88  MASTER-WAS-RESTORED    VALUE '4'.
   863             88  INCURRED-DATE-CHANGED  VALUE '5'.
   864             88  FILE-CONVERTED         VALUE '6'.
   865             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   866             88  ERROR-CORRECTION       VALUE 'E'.
   867         16  CL-RELATED-CLAIM-NO     PIC X(7).
   868         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   869         16  CL-BENEFICIARY          PIC X(10).
   870         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   871         16  CL-DENIAL-TYPE          PIC X.
   872             88  CL-TYPE-DENIAL          VALUE '1'.
   873             88  CL-TYPE-RESCISSION      VALUE '2'.
   874             88  CL-TYPE-REFORMATION     VALUE '3'.
   875             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   876             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   877         16  CL-NO-OF-EXTENSIONS     PIC 99.
   878         16  filler                  pic x(3).
   879*        16  CL-CRIT-PER-RECURRENT   PIC X.
   880*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   881*        16  CL-RTW-DT               PIC XX.
   882
   883     12  CL-TRAILER-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  17
* SOCK03.cbl
   884         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   885             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   886             88  CL-LAST-TRL-AVAIL      VALUE +100.
   887             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   888         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   889         16  FILLER                  PIC XX.
   890         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   891         16  CL-ADDRESS-TRAILER-CNT.
   892             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   893                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   894             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   895                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   896             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   897                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   898             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   899                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   900             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   901                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   902             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   903                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   904             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   905                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   906
   907     12  CL-CV-REFERENCE-NO.
   908         16  CL-CV-REFNO-PRIME       PIC X(18).
   909         16  CL-CV-REFNO-SFX         PIC XX.
   910
   911     12  CL-FILE-LOCATION            PIC X(4).
   912
   913     12  CL-PROCESS-ERRORS.
   914         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   915             88  NO-FATAL-ERRORS        VALUE ZERO.
   916         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   917             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   918
   919     12  CL-PRODUCT-CD               PIC X.
   920
   921     12  CL-CURRENT-KEY-DATA.
   922         16  CL-CURRENT-CARRIER      PIC X.
   923         16  CL-CURRENT-GROUPING     PIC X(6).
   924         16  CL-CURRENT-STATE        PIC XX.
   925         16  CL-CURRENT-ACCOUNT      PIC X(10).
   926
   927     12  CL-ASSOCIATES               PIC X.
   928         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   929         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   930         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   931         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   932
   933     12  CL-ACTIVITY-CODE            PIC 99.
   934     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   935     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   936
   937     12  CL-LAPSE-REPORT-CODE        PIC 9.
   938     12  CL-LAG-REPORT-CODE          PIC 9.
   939     12  CL-LOAN-TYPE                PIC XX.
   940     12  CL-LEGAL-STATE              PIC XX.
   941
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  18
* SOCK03.cbl
   942     12  CL-YESNOSW                  PIC X.
   943     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   944         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   945         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   946         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   947     12  cl-insured-type             pic x.
   948         88  cl-claim-on-primary         value 'P'.
   949         88  cl-claim-on-co-borrower     value 'C'.
   950     12  cl-benefit-expiration-dt    PIC XX.
   951*                                 COPY ERCPDEF.
   952******************************************************************
   953*                                                                *
   954*                                                                *
   955*                            ERCPDEF.                            *
   956*                                                                *
   957*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   958*                                                                *
   959*    FILE TYPE = VSAM,KSDS                                       *
   960*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   961*                                                                *
   962*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   963*                                                                *
   964*    LOG = YES                                                   *
   965*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   966******************************************************************
   967*                   C H A N G E   L O G
   968*
   969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   970*-----------------------------------------------------------------
   971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   972* EFFECTIVE    NUMBER
   973*-----------------------------------------------------------------
   974* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   975* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   976* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   977* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   978******************************************************************
   979 01  PRODUCT-MASTER.
   980    12  PD-RECORD-ID                 PIC X(02).
   981        88  VALID-PD-ID                  VALUE 'PD'.
   982    12  PD-CONTROL-PRIMARY.
   983        16  PD-COMPANY-CD            PIC X.
   984        16  PD-STATE                 PIC XX.
   985        16  PD-PRODUCT-CD            PIC XXX.
   986        16  PD-FILLER                PIC X(7).
   987        16  PD-BEN-TYPE              PIC X.
   988        16  PD-BEN-CODE              PIC XX.
   989        16  PD-PROD-EXP-DT           PIC XX.
   990    12  FILLER                       PIC X(50).
   991    12  PD-PRODUCT-DATA OCCURS 8.
   992        16  PD-PROD-CODE             PIC X.
   993            88  PD-PROD-LIFE           VALUE 'L'.
   994            88  PD-PROD-PROP           VALUE 'P'.
   995            88  PD-PROD-AH             VALUE 'A'.
   996            88  PD-PROD-IU             VALUE 'I'.
   997            88  PD-PROD-GAP            VALUE 'G'.
   998            88  PD-PROD-FAML           VALUE 'F'.
   999            88  PD-PROD-OTH            VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  19
* SOCK03.cbl
  1000        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  1001        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  1002        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  1003        16  PD-MAX-TERM              PIC S999        COMP-3.
  1004        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  1005        16  FILLER                   PIC X.
  1006        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  1007        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  1008        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  1009        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  1010        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  1011        16  PD-REC-CRIT-PERIOD       PIC 99.
  1012        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  1013            20  PD-RECURRING-YN      PIC X.
  1014            20  FILLER               PIC X.
  1015        16  PD-RTW-MOS               PIC 99.
  1016        16  PD-MAX-EXTENSION         PIC 99.
  1017        16  pd-ben-pct               pic sv999 comp-3.
  1018*       16  FILLER                   PIC XX.
  1019    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  1020    12  PD-TERM-LIMITS OCCURS 15.
  1021        16  PD-LOW-TERM              PIC S999        COMP-3.
  1022        16  PD-HI-TERM               PIC S999        COMP-3.
  1023*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  1024    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  1025        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  1026        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  1027    12  PD-EARN-FACTORS.
  1028        16  FILLER OCCURS 15.
  1029            20  FILLER OCCURS 15.
  1030                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1031    12  PD-PRODUCT-DESC              PIC X(80).
  1032    12  PD-TRUNCATED                 PIC X.
  1033    12  FILLER                       PIC X(59).
  1034    12  PD-MAINT-INFORMATION.
  1035        16  PD-LAST-MAINT-DT         PIC X(02).
  1036        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1037        16  PD-LAST-MAINT-BY         PIC X(04).
  1038*                                 COPY ERCCTBL.
  1039******************************************************************
  1040*                                                                *
  1041*                                                                *
  1042*                            ERCCTBL                             *
  1043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1044*                            VMOD=2.003
  1045*                                                                *
  1046*   ONLINE CREDIT SYSTEM                                         *
  1047*                                                                *
  1048*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1049*                                                                *
  1050*   FILE TYPE = VSAM,KSDS                                        *
  1051*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1052*                                                                *
  1053*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1054*       ALTERNATE PATH = NONE                                    *
  1055*                                                                *
  1056*   LOG = NO                                                     *
  1057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  20
* SOCK03.cbl
  1058*                                                                *
  1059*                                                                *
  1060******************************************************************
  1061
  1062 01  COMM-TABLE-RECORD.
  1063     12  CT-RECORD-ID                      PIC XX.
  1064         88  VALID-CT-ID                      VALUE 'CT'.
  1065
  1066     12  CT-CONTROL-PRIMARY.
  1067         16  CT-COMPANY-CD                 PIC X.
  1068         16  CT-TABLE                      PIC XXX.
  1069         16  CT-CNTRL-2.
  1070             20  CT-BEN-TYPE               PIC X.
  1071             20  CT-BEN-CODE               PIC XX.
  1072
  1073     12  CT-MAINT-INFORMATION.
  1074         16  CT-LAST-MAINT-DT              PIC XX.
  1075         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1076         16  CT-LAST-MAINT-USER            PIC X(4).
  1077         16  FILLER                        PIC X(31).
  1078
  1079     12  CT-LIMITS.
  1080         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1081
  1082         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1083
  1084         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1085
  1086     12  CT-RATES.
  1087         16  CT-RTX          OCCURS 27 TIMES.
  1088             20  CT-RT                     PIC SV9(5)     COMP-3.
  1089             20  CT-RT-R   REDEFINES
  1090                 CT-RT                     PIC XXX.
  1091
  1092     12  FILLER                            PIC  X(42).
  1093
  1094******************************************************************
  1095*                                 COPY ELCCNTL.
  1096******************************************************************
  1097*                                                                *
  1098*                                                                *
  1099*                            ELCCNTL.                            *
  1100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1101*                            VMOD=2.059                          *
  1102*                                                                *
  1103*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1104*                                                                *
  1105*   FILE TYPE = VSAM,KSDS                                        *
  1106*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1107*                                                                *
  1108*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1109*       ALTERNATE INDEX = NONE                                   *
  1110*                                                                *
  1111*   LOG = YES                                                    *
  1112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1113******************************************************************
  1114*                   C H A N G E   L O G
  1115*
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  21
* SOCK03.cbl
  1116* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1117*-----------------------------------------------------------------
  1118*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1119* EFFECTIVE    NUMBER
  1120*-----------------------------------------------------------------
  1121* 082503                   PEMA  ADD BENEFIT GROUP
  1122* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1123* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1124* 092705    2005050300006  PEMA  ADD SPP LEASES
  1125* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1126* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1127* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1128* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1129* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1130* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1131* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1132* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1133* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1134* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1135* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1136******************************************************************
  1137*
  1138 01  CONTROL-FILE.
  1139     12  CF-RECORD-ID                       PIC XX.
  1140         88  VALID-CF-ID                        VALUE 'CF'.
  1141
  1142     12  CF-CONTROL-PRIMARY.
  1143         16  CF-COMPANY-ID                  PIC XXX.
  1144         16  CF-RECORD-TYPE                 PIC X.
  1145             88  CF-COMPANY-MASTER              VALUE '1'.
  1146             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1147             88  CF-STATE-MASTER                VALUE '3'.
  1148             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1149             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1150             88  CF-CARRIER-MASTER              VALUE '6'.
  1151             88  CF-MORTALITY-MASTER            VALUE '7'.
  1152             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1153             88  CF-TERMINAL-MASTER             VALUE '9'.
  1154             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1155             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1156             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1157             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1158             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1159             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1160             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1161             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1162             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1163         16  CF-ACCESS-CD-GENL              PIC X(4).
  1164         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1165             20  CF-PROCESSOR               PIC X(4).
  1166         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1167             20  CF-STATE-CODE              PIC XX.
  1168             20  FILLER                     PIC XX.
  1169         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1170             20  FILLER                     PIC XX.
  1171             20  CF-HI-BEN-IN-REC           PIC XX.
  1172         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1173             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  22
* SOCK03.cbl
  1174             20  CF-CARRIER-CNTL            PIC X.
  1175         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1176             20  FILLER                     PIC XX.
  1177             20  CF-HI-TYPE-IN-REC          PIC 99.
  1178         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1179             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1180                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1181             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1182             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1183         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1184             20  FILLER                     PIC X.
  1185             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1186         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1187             20  FILLER                     PIC XX.
  1188             20  CF-MORTGAGE-PLAN           PIC XX.
  1189         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1190
  1191     12  CF-LAST-MAINT-DT                   PIC XX.
  1192     12  CF-LAST-MAINT-BY                   PIC X(4).
  1193     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1194
  1195     12  CF-RECORD-BODY                     PIC X(728).
  1196
  1197
  1198****************************************************************
  1199*             COMPANY MASTER RECORD                            *
  1200****************************************************************
  1201
  1202     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1203         16  CF-COMPANY-ADDRESS.
  1204             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1205             20  CF-CL-IN-CARE-OF           PIC X(30).
  1206             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1207             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1208             20  CF-CL-CITY-STATE           PIC X(30).
  1209             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1210             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1211         16  CF-COMPANY-CD                  PIC X.
  1212         16  CF-COMPANY-PASSWORD            PIC X(8).
  1213         16  CF-SECURITY-OPTION             PIC X.
  1214             88  ALL-SECURITY                   VALUE '1'.
  1215             88  COMPANY-VERIFY                 VALUE '2'.
  1216             88  PROCESSOR-VERIFY               VALUE '3'.
  1217             88  NO-SECURITY                    VALUE '4'.
  1218             88  ALL-BUT-TERM                   VALUE '5'.
  1219         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1220             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1221         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1222             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1223         16  CF-INFORCE-LOCATION            PIC X.
  1224             88  CERTS-ARE-ONLINE               VALUE '1'.
  1225             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1226             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1227         16  CF-LOWER-CASE-LETTERS          PIC X.
  1228         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1229             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1230             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1231             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  23
* SOCK03.cbl
  1232             88  CF-ACCNT-CNTL                  VALUE '3'.
  1233             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1234
  1235         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1236         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1237
  1238         16  CF-LGX-CREDIT-USER             PIC X.
  1239             88  CO-IS-NOT-USER                 VALUE 'N'.
  1240             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1241
  1242         16 CF-CREDIT-CALC-CODES.
  1243             20  CF-CR-REM-TERM-CALC PIC X.
  1244               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1245               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1246               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1247               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1248               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1249               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1250               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1251             20  CF-CR-R78-METHOD           PIC X.
  1252               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1253               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1254
  1255         16  CF-CLAIM-CONTROL-COUNTS.
  1256             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1257                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1258
  1259             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1260                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1261
  1262             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1263                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1264
  1265             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1266                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1267
  1268         16  CF-CURRENT-MONTH-END           PIC XX.
  1269
  1270         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1271             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1272             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1273             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1274             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1275                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1276                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1277             20  CF-CO-PREM-REJECT-SW       PIC X.
  1278                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1279                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1280             20  CF-CO-REF-REJECT-SW        PIC X.
  1281                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1282                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1283
  1284         16  CF-CO-REPORTING-DT             PIC XX.
  1285         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1286         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1287           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1288           88  CF-CO-MONTH-END                  VALUE '1'.
  1289
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  24
* SOCK03.cbl
  1290         16  CF-LGX-CLAIM-USER              PIC X.
  1291             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1292             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1293
  1294         16  CF-CREDIT-EDIT-CONTROLS.
  1295             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1296             20  CF-MIN-AGE                 PIC 99.
  1297             20  CF-DEFAULT-AGE             PIC 99.
  1298             20  CF-MIN-TERM                PIC S999      COMP-3.
  1299             20  CF-MAX-TERM                PIC S999      COMP-3.
  1300             20  CF-DEFAULT-SEX             PIC X.
  1301             20  CF-JOINT-AGE-INPUT         PIC X.
  1302                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1303             20  CF-BIRTH-DATE-INPUT        PIC X.
  1304                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1305             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1306                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1307                 88  CF-ZERO-CARRIER            VALUE '1'.
  1308                 88  CF-ZERO-GROUPING           VALUE '2'.
  1309                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1310             20  CF-EDIT-SW                 PIC X.
  1311                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1312             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1313             20  CF-CR-PR-METHOD            PIC X.
  1314               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1315               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1316             20  FILLER                     PIC X.
  1317
  1318         16  CF-CREDIT-MISC-CONTROLS.
  1319             20  CF-REIN-TABLE-SW           PIC X.
  1320                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1321             20  CF-COMP-TABLE-SW           PIC X.
  1322                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1323             20  CF-EXPERIENCE-RETENTION-AGE
  1324                                            PIC S9        COMP-3.
  1325             20  CF-CONVERSION-DT           PIC XX.
  1326             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1327             20  CF-RUN-FREQUENCY-SW        PIC X.
  1328                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1329                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1330
  1331             20  CF-CR-CHECK-NO-CONTROL.
  1332                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1333                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1334                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1335                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1336                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1337                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1338
  1339                 24  CF-CR-CHECK-COUNT       REDEFINES
  1340                     CF-CR-CHECK-COUNTER      PIC X(4).
  1341
  1342                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1343                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1344
  1345                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1346                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1347                 24  CF-MAIL-PROCESSING       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  25
* SOCK03.cbl
  1348                     88  MAIL-PROCESSING          VALUE 'Y'.
  1349
  1350         16  CF-MISC-SYSTEM-CONTROL.
  1351             20  CF-SYSTEM-C                 PIC X.
  1352                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1353             20  CF-SYSTEM-D                 PIC X.
  1354                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1355             20  CF-SOC-SEC-NO-SW            PIC X.
  1356                 88  SOC-SEC-NO-USED             VALUE '1'.
  1357             20  CF-MEMBER-NO-SW             PIC X.
  1358                 88  MEMBER-NO-USED              VALUE '1'.
  1359             20  CF-TAX-ID-NUMBER            PIC X(11).
  1360             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1361             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1362                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1363                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1364                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1365                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1366             20  CF-SYSTEM-E                 PIC X.
  1367                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1368
  1369         16  CF-LGX-LIFE-USER               PIC X.
  1370             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1371             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1372
  1373         16  CF-CR-MONTH-END-DT             PIC XX.
  1374
  1375         16  CF-FILE-MAINT-DATES.
  1376             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1377                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1378             20  CF-LAST-BATCH       REDEFINES
  1379                 CF-LAST-BATCH-NO               PIC X(4).
  1380             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1381             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1382             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1383             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1384             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1385             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1386             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1387             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1388             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1389             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1390
  1391         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1392         16  FILLER                         PIC X.
  1393
  1394         16  CF-ALT-MORT-CODE               PIC X(4).
  1395         16  CF-MEMBER-CAPTION              PIC X(10).
  1396
  1397         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1398             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1399             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1400             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1401             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1402             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1403
  1404         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1405
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  26
* SOCK03.cbl
  1406         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1407         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1408         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1409         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1410
  1411         16  CF-AH-OVERRIDE-L1              PIC X.
  1412         16  CF-AH-OVERRIDE-L2              PIC XX.
  1413         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1414         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1415
  1416         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1417         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1418
  1419         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1420         16  CF-AR-LAST-EL860-DT            PIC XX.
  1421         16  CF-MP-MONTH-END-DT             PIC XX.
  1422
  1423         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1424         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1425             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1426
  1427         16  CF-AR-MONTH-END-DT             PIC XX.
  1428
  1429         16  CF-CRDTCRD-USER                PIC X.
  1430             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1431             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1432
  1433         16  CF-CC-MONTH-END-DT             PIC XX.
  1434
  1435         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1436
  1437         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1438             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1439             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1440             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1441         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1442         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1443         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1444         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1445             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1446             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1447         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1448         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1449         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1450             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1451         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1452
  1453         16  CF-CL-ZIP-CODE.
  1454             20  CF-CL-ZIP-PRIME.
  1455                 24  CF-CL-ZIP-1ST          PIC X.
  1456                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1457                 24  FILLER                 PIC X(4).
  1458             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1459         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1460             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1461             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1462             20  FILLER                     PIC XXX.
  1463
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  27
* SOCK03.cbl
  1464         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1465         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1466         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1467         16  CF-CO-OPTION-START-DATE        PIC XX.
  1468         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1469           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1470                                                      '3' '4'.
  1471           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1472           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1473           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1474           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1475           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1476           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1477
  1478         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1479
  1480         16  CF-PAYMENT-APPROVAL-LEVELS.
  1481             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1482             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1483             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1484             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1485             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1486             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1487
  1488         16  CF-END-USER-REPORTING-USER     PIC X.
  1489             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1490             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1491
  1492         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1493             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1494             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1495
  1496         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1497
  1498         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1499         16  FILLER                         PIC X.
  1500
  1501         16  CF-CREDIT-ARCHIVE-CNTL.
  1502             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1503             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1504             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1505
  1506         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1507
  1508         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1509             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1510             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1511
  1512         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1513             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1514             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1515
  1516         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1517
  1518         16  CF-CO-ACH-ID-CODE              PIC  X.
  1519             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1520             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1521             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  28
* SOCK03.cbl
  1522         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1523         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1524         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1525         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1526         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1527         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1528         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1529         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1530         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1531                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1532         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1533                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1534
  1535         16  CF-CO-OVER-SHORT.
  1536             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1537             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1538
  1539*         16  FILLER                         PIC X(102).
  1540         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1541             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1542             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1543
  1544         16  CF-AH-APPROVAL-DAYS.
  1545             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1546             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1547             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1548             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1549
  1550         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1551
  1552         16  CF-APPROV-LEV-5.
  1553             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1554             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1555             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1556
  1557         16  FILLER                         PIC X(68).
  1558****************************************************************
  1559*             PROCESSOR/USER RECORD                            *
  1560****************************************************************
  1561
  1562     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1563         16  CF-PROCESSOR-NAME              PIC X(30).
  1564         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1565         16  CF-PROCESSOR-TITLE             PIC X(26).
  1566         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1567                 88  MESSAGE-YES                VALUE 'Y'.
  1568                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1569
  1570*****************************************************
  1571****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1572****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1573****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1574****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1575*****************************************************
  1576
  1577         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1578             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1579             20  CF-APPLICATION-FORCE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  29
* SOCK03.cbl
  1580             20  CF-INDIVIDUAL-APP.
  1581                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1582                     28  CF-BROWSE-APP      PIC X.
  1583                     28  CF-UPDATE-APP      PIC X.
  1584
  1585         16  CF-CURRENT-TERM-ON             PIC X(4).
  1586         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1587             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1588             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1589             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1590             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1591             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1592             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1593             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1594         16  CF-PROCESSOR-CARRIER           PIC X.
  1595             88  NO-CARRIER-SECURITY            VALUE ' '.
  1596         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1597             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1598         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1599             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1600         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1601             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1602
  1603         16  CF-PROC-SYS-ACCESS-SW.
  1604             20  CF-PROC-CREDIT-CLAIMS-SW.
  1605                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1606                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1607                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1608                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1609             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1610                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1611                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1612             20  CF-PROC-LIFE-GNRLDGR-SW.
  1613                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1614                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1615                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1616                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1617             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1618                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1619                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1620         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1621             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1622             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1623         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1624
  1625         16  CF-APPROVAL-LEVEL                  PIC X.
  1626             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1627             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1628             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1629             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1630             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1631
  1632         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1633
  1634         16  CF-LANGUAGE-TYPE                   PIC X.
  1635             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1636             88  CF-LANG-IS-FR                      VALUE 'F'.
  1637
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  30
* SOCK03.cbl
  1638         16  CF-CSR-IND                         PIC X.
  1639         16  FILLER                             PIC X(239).
  1640
  1641****************************************************************
  1642*             PROCESSOR/REMINDERS RECORD                       *
  1643****************************************************************
  1644
  1645     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1646         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1647             20  CF-START-REMIND-DT         PIC XX.
  1648             20  CF-END-REMIND-DT           PIC XX.
  1649             20  CF-REMINDER-TEXT           PIC X(50).
  1650         16  FILLER                         PIC X(296).
  1651
  1652
  1653****************************************************************
  1654*             STATE MASTER RECORD                              *
  1655****************************************************************
  1656
  1657     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1658         16  CF-STATE-ABBREVIATION          PIC XX.
  1659         16  CF-STATE-NAME                  PIC X(25).
  1660         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1661         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1662             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1663             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1664             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1665             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1666                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1667                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1668             20  CF-ST-PREM-REJECT-SW       PIC X.
  1669                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1670                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1671             20  CF-ST-REF-REJECT-SW        PIC X.
  1672                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1673                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1674         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1675         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1676         16  CF-ST-REFUND-RULES.
  1677             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1678             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1679             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1680         16  CF-ST-FST-PMT-EXTENSION.
  1681             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1682             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1683                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1684                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1685                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1686                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1687         16  CF-ST-STATE-CALL.
  1688             20  CF-ST-CALL-UNEARNED        PIC X.
  1689             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1690             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1691         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1692             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1693             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1694         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1695         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  31
* SOCK03.cbl
  1696         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1697         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1698         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1699         16  FILLER                         PIC X.
  1700         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1701             20  CF-ST-BENEFIT-CD           PIC XX.
  1702             20  CF-ST-BENEFIT-KIND         PIC X.
  1703                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1704                 88  CF-ST-AH-KIND              VALUE 'A'.
  1705             20  CF-ST-REM-TERM-CALC        PIC X.
  1706                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1707                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1708                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1709                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1710                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1711                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1712                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1713                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1714
  1715             20  CF-ST-REFUND-CALC          PIC X.
  1716                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1717                 88  ST-REFD-BY-R78             VALUE '1'.
  1718                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1719                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1720                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1721                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1722                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1723                 88  ST-REFD-UTAH               VALUE '7'.
  1724                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1725                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1726                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1727
  1728             20  CF-ST-EARNING-CALC         PIC X.
  1729                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1730                 88  ST-EARN-BY-R78             VALUE '1'.
  1731                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1732                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1733                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1734                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1735                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1736                 88  ST-EARN-MEAN               VALUE '8'.
  1737                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1738
  1739             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1740                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1741                 88  ST-OVRD-BY-R78             VALUE '1'.
  1742                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1743                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1744                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1745                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1746                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1747                 88  ST-OVRD-MEAN               VALUE '8'.
  1748                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1749             20  cf-st-extra-periods        pic 9.
  1750*            20  FILLER                     PIC X.
  1751
  1752         16  CF-ST-COMMISSION-CAPS.
  1753             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  32
* SOCK03.cbl
  1754             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1755             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1756             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1757         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1758                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1759                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1760                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1761
  1762         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1763
  1764         16  CF-ST-STATUTORY-INTEREST.
  1765             20  CF-ST-STAT-DATE-FROM       PIC X.
  1766                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1767                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1768             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1769             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1770             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1771             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1772             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1773
  1774         16  CF-ST-OVER-SHORT.
  1775             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1776             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1777
  1778         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1779
  1780         16  CF-ST-RT-CALC                  PIC X.
  1781
  1782         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1783         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1784         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1785         16  CF-ST-RF-LR-CALC               PIC X.
  1786         16  CF-ST-RF-LL-CALC               PIC X.
  1787         16  CF-ST-RF-LN-CALC               PIC X.
  1788         16  CF-ST-RF-AH-CALC               PIC X.
  1789         16  CF-ST-RF-CP-CALC               PIC X.
  1790*        16  FILLER                         PIC X(206).
  1791*CIDMOD         16  FILLER                         PIC X(192).
  1792         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1793             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1794         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1795         16  CF-ST-VFY-2ND-BENE             PIC X.
  1796         16  CF-ST-CAUSAL-STATE             PIC X.
  1797         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1798         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1799         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1800             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1801         16  CF-ST-NET-ONLY-STATE           PIC X.
  1802             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1803         16  cf-commission-cap-required     pic x.
  1804         16  CF-ST-GA-COMMISSION-CAPS.
  1805             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1806             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1807             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1808             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1809         16  CF-ST-TOT-COMMISSION-CAPS.
  1810             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1811             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  33
* SOCK03.cbl
  1812             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1813             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1814         16  FILLER                         PIC X(156).
  1815
  1816****************************************************************
  1817*             BENEFIT MASTER RECORD                            *
  1818****************************************************************
  1819
  1820     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1821         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1822             20  CF-BENEFIT-CODE            PIC XX.
  1823             20  CF-BENEFIT-NUMERIC  REDEFINES
  1824                 CF-BENEFIT-CODE            PIC XX.
  1825             20  CF-BENEFIT-ALPHA           PIC XXX.
  1826             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1827             20  CF-BENEFIT-COMMENT         PIC X(10).
  1828
  1829             20  CF-LF-COVERAGE-TYPE        PIC X.
  1830                 88  CF-REDUCING                VALUE 'R'.
  1831                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1832
  1833             20  CF-SPECIAL-CALC-CD         PIC X.
  1834                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1835                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1836                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1837                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1838                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1839                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1840                 88  CF-FARM-PLAN               VALUE 'F'.
  1841                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1842                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1843                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1844                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1845                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1846                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1847                 88  CF-PRUDENTIAL              VALUE 'P'.
  1848                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1849                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1850                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1851                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1852                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1853                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1854
  1855             20  CF-JOINT-INDICATOR         PIC X.
  1856                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1857
  1858*            20  FILLER                     PIC X(12).
  1859             20  cf-maximum-benefits        pic s999 comp-3.
  1860             20  FILLER                     PIC X(09).
  1861             20  CF-BENEFIT-CATEGORY        PIC X.
  1862             20  CF-LOAN-TYPE               PIC X(8).
  1863
  1864             20  CF-CO-REM-TERM-CALC        PIC X.
  1865                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1866                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1867                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1868                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1869                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  34
* SOCK03.cbl
  1870
  1871             20  CF-CO-EARNINGS-CALC        PIC X.
  1872                 88  CO-EARN-BY-R78             VALUE '1'.
  1873                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1874                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1875                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1876                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1877                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1878                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1879                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1880
  1881             20  CF-CO-REFUND-CALC          PIC X.
  1882                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1883                 88  CO-REFD-BY-R78             VALUE '1'.
  1884                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1885                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1886                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1887                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1888                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1889                 88  CO-REFD-MEAN               VALUE '8'.
  1890                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1891                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1892                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1893
  1894             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1895                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1896                 88  CO-OVRD-BY-R78             VALUE '1'.
  1897                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1898                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1899                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1900                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1901                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1902                 88  CO-OVRD-MEAN               VALUE '8'.
  1903                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1904
  1905             20  CF-CO-BEN-I-G-CD           PIC X.
  1906                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1907                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1908                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1909
  1910         16  FILLER                         PIC X(304).
  1911
  1912
  1913****************************************************************
  1914*             CARRIER MASTER RECORD                            *
  1915****************************************************************
  1916
  1917     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1918         16  CF-ADDRESS-DATA.
  1919             20  CF-MAIL-TO-NAME            PIC X(30).
  1920             20  CF-IN-CARE-OF              PIC X(30).
  1921             20  CF-ADDRESS-LINE-1          PIC X(30).
  1922             20  CF-ADDRESS-LINE-2          PIC X(30).
  1923             20  CF-CITY-STATE              PIC X(30).
  1924             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1925             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1926
  1927         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  35
* SOCK03.cbl
  1928             20  CF-CLAIM-NO-METHOD         PIC X.
  1929                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1930                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1931                 88  CLAIM-NO-SEQ               VALUE '3'.
  1932                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1933             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1934                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1935                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1936                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1937
  1938         16  CF-CHECK-NO-CONTROL.
  1939             20  CF-CHECK-NO-METHOD         PIC X.
  1940                 88  CHECK-NO-MANUAL            VALUE '1'.
  1941                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1942                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1943                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1944             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1945                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1946
  1947         16  CF-DOMICILE-STATE              PIC XX.
  1948
  1949         16  CF-EXPENSE-CONTROLS.
  1950             20  CF-EXPENSE-METHOD          PIC X.
  1951                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1952                 88  DOLLARS-PER-PMT            VALUE '2'.
  1953                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1954                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1955             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1956             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1957
  1958         16  CF-CORRESPONDENCE-CONTROL.
  1959             20  CF-LETTER-RESEND-OPT       PIC X.
  1960                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1961                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1962             20  FILLER                     PIC X(4).
  1963
  1964         16  CF-RESERVE-CONTROLS.
  1965             20  CF-MANUAL-SW               PIC X.
  1966                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1967             20  CF-FUTURE-SW               PIC X.
  1968                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1969             20  CF-PTC-SW                  PIC X.
  1970                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1971             20  CF-IBNR-SW                 PIC X.
  1972                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1973             20  CF-PTC-LF-SW               PIC X.
  1974                 88  CF-LF-PTC-USED             VALUE '1'.
  1975             20  CF-CDT-ACCESS-METHOD       PIC X.
  1976                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1977                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1978                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1979             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1980
  1981         16  CF-CLAIM-CALC-METHOD           PIC X.
  1982             88  360-PLUS-MONTHS                VALUE '1'.
  1983             88  365-PLUS-MONTHS                VALUE '2'.
  1984             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1985             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  36
* SOCK03.cbl
  1986             88  365-DAILY                      VALUE '5'.
  1987
  1988         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1989         16  FILLER                         PIC X(11).
  1990
  1991         16  CF-LIMIT-AMOUNTS.
  1992             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1993             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1994             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1995             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1996             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1997             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1998             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1999             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2000             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2001             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2002
  2003         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2004         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2005         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2006
  2007         16  CF-ZIP-CODE.
  2008             20  CF-ZIP-PRIME.
  2009                 24  CF-ZIP-1ST             PIC X.
  2010                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2011                 24  FILLER                 PIC X(4).
  2012             20  CF-ZIP-PLUS4               PIC X(4).
  2013         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2014             20  CF-CAN-POSTAL-1            PIC XXX.
  2015             20  CF-CAN-POSTAL-2            PIC XXX.
  2016             20  FILLER                     PIC XXX.
  2017
  2018         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2019         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2020         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2021
  2022         16  CF-RATING-SWITCH               PIC X.
  2023             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2024             88  CF-NO-RATING                   VALUE 'N'.
  2025
  2026         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2027
  2028         16  CF-CARRIER-OVER-SHORT.
  2029             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2030             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2031
  2032         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2033         16  CF-SECPAY-SWITCH               PIC X.
  2034             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2035             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2036         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2037         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2038         16  FILLER                         PIC X(444).
  2039*        16  FILLER                         PIC X(452).
  2040
  2041
  2042****************************************************************
  2043*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  37
* SOCK03.cbl
  2044****************************************************************
  2045
  2046     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2047         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2048                                INDEXED BY CF-MORT-NDX.
  2049             20  CF-MORT-TABLE              PIC X(5).
  2050             20  CF-MORT-TABLE-TYPE         PIC X.
  2051                 88  CF-MORT-JOINT              VALUE 'J'.
  2052                 88  CF-MORT-SINGLE             VALUE 'S'.
  2053                 88  CF-MORT-COMBINED           VALUE 'C'.
  2054                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2055                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2056             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2057             20  CF-MORT-AGE-METHOD         PIC XX.
  2058                 88  CF-AGE-LAST                VALUE 'AL'.
  2059                 88  CF-AGE-NEAR                VALUE 'AN'.
  2060             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2061             20  CF-MORT-ADJUSTMENT-DIRECTION
  2062                                            PIC X.
  2063                 88  CF-MINUS                   VALUE '-'.
  2064                 88  CF-PLUS                    VALUE '+'.
  2065             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2066             20  CF-MORT-JOINT-CODE         PIC X.
  2067                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2068             20  CF-MORT-PC-Q               PIC X.
  2069                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2070             20  CF-MORT-TABLE-CODE         PIC X(4).
  2071             20  CF-MORT-COMMENTS           PIC X(15).
  2072             20  FILLER                     PIC X(14).
  2073
  2074         16  FILLER                         PIC X(251).
  2075
  2076
  2077****************************************************************
  2078*             BUSSINESS TYPE MASTER RECORD                     *
  2079****************************************************************
  2080
  2081     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2082* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2083* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2084* AND RECORD 05 IS TYPES 81-99
  2085         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2086             20  CF-BUSINESS-TITLE          PIC  X(19).
  2087             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2088                                            PIC S9V9(4) COMP-3.
  2089             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2090             20  FILLER                     PIC  X.
  2091         16  FILLER                         PIC  X(248).
  2092
  2093
  2094****************************************************************
  2095*             TERMINAL MASTER RECORD                           *
  2096****************************************************************
  2097
  2098     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2099
  2100         16  CF-COMPANY-TERMINALS.
  2101             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  38
* SOCK03.cbl
  2102                                  PIC X(4).
  2103         16  FILLER               PIC X(248).
  2104
  2105
  2106****************************************************************
  2107*             LIFE EDIT MASTER RECORD                          *
  2108****************************************************************
  2109
  2110     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2111         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2112             20  CF-LIFE-CODE-IN            PIC XX.
  2113             20  CF-LIFE-CODE-OUT           PIC XX.
  2114         16  FILLER                         PIC X(248).
  2115
  2116
  2117****************************************************************
  2118*             AH EDIT MASTER RECORD                            *
  2119****************************************************************
  2120
  2121     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2122         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2123             20  CF-AH-CODE-IN              PIC XXX.
  2124             20  CF-AH-CODE-OUT             PIC XX.
  2125         16  FILLER                         PIC X(248).
  2126
  2127
  2128****************************************************************
  2129*             CREDIBILITY TABLES                               *
  2130****************************************************************
  2131
  2132     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2133         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2134                             INDEXED BY CF-CRDB-NDX.
  2135             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2136             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2137             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2138         16  FILLER                         PIC  X(332).
  2139
  2140
  2141****************************************************************
  2142*             REPORT CUSTOMIZATION RECORD                      *
  2143****************************************************************
  2144
  2145     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2146         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2147             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2148             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2149             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2150**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2151****       A T-TRANSFER.                                   ****
  2152             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2153
  2154         16  FILLER                         PIC XX.
  2155
  2156         16  CF-CARRIER-CNTL-OPT.
  2157             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2158                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2159                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  39
* SOCK03.cbl
  2160             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2161                                            PIC X.
  2162         16  CF-GROUP-CNTL-OPT.
  2163             20  CF-GROUP-OPT-SEQ           PIC 9.
  2164                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2165                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2166             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2167                                            PIC X(6).
  2168         16  CF-STATE-CNTL-OPT.
  2169             20  CF-STATE-OPT-SEQ           PIC 9.
  2170                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2171                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2172             20  CF-STATE-SELECT OCCURS 3 TIMES
  2173                                            PIC XX.
  2174         16  CF-ACCOUNT-CNTL-OPT.
  2175             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2176                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2177                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2178             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2179                                            PIC X(10).
  2180         16  CF-BUS-TYP-CNTL-OPT.
  2181             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2182                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2183                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2184             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2185                                            PIC XX.
  2186         16  CF-LF-TYP-CNTL-OPT.
  2187             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2188                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2189                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2190             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2191                                            PIC XX.
  2192         16  CF-AH-TYP-CNTL-OPT.
  2193             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2194                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2195                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2196             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2197                                            PIC XX.
  2198         16  CF-REPTCD1-CNTL-OPT.
  2199             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2200                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2201                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2202             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2203                                            PIC X(10).
  2204         16  CF-REPTCD2-CNTL-OPT.
  2205             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2206                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2207                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2208             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2209                                            PIC X(10).
  2210         16  CF-USER1-CNTL-OPT.
  2211             20  CF-USER1-OPT-SEQ           PIC 9.
  2212                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2213                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2214             20  CF-USER1-SELECT OCCURS 3 TIMES
  2215                                            PIC X(10).
  2216         16  CF-USER2-CNTL-OPT.
  2217             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  40
* SOCK03.cbl
  2218                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2219                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2220             20  CF-USER2-SELECT OCCURS 3 TIMES
  2221                                            PIC X(10).
  2222         16  CF-USER3-CNTL-OPT.
  2223             20  CF-USER3-OPT-SEQ           PIC 9.
  2224                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2225                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2226             20  CF-USER3-SELECT OCCURS 3 TIMES
  2227                                            PIC X(10).
  2228         16  CF-USER4-CNTL-OPT.
  2229             20  CF-USER4-OPT-SEQ           PIC 9.
  2230                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2231                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2232             20  CF-USER4-SELECT OCCURS 3 TIMES
  2233                                            PIC X(10).
  2234         16  CF-USER5-CNTL-OPT.
  2235             20  CF-USER5-OPT-SEQ           PIC 9.
  2236                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2237                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2238             20  CF-USER5-SELECT OCCURS 3 TIMES
  2239                                            PIC X(10).
  2240         16  CF-REINS-CNTL-OPT.
  2241             20  CF-REINS-OPT-SEQ           PIC 9.
  2242                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2243                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2244             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2245                 24  CF-REINS-PRIME         PIC XXX.
  2246                 24  CF-REINS-SUB           PIC XXX.
  2247
  2248         16  CF-AGENT-CNTL-OPT.
  2249             20  CF-AGENT-OPT-SEQ           PIC 9.
  2250                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2251                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2252             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2253                                            PIC X(10).
  2254
  2255         16  FILLER                         PIC X(43).
  2256
  2257         16  CF-LOSS-RATIO-SELECT.
  2258             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2259             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2260         16  CF-ENTRY-DATE-SELECT.
  2261             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2262             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2263         16  CF-EFFECTIVE-DATE-SELECT.
  2264             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2265             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2266
  2267         16  CF-EXCEPTION-LIST-IND          PIC X.
  2268             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2269
  2270         16  FILLER                         PIC X(318).
  2271
  2272****************************************************************
  2273*                  EXCEPTION REPORTING RECORD                  *
  2274****************************************************************
  2275
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  41
* SOCK03.cbl
  2276     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2277         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2278             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2279
  2280         16  CF-COMBINED-LIFE-AH-OPT.
  2281             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2282             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2283             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2284             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2285
  2286         16  CF-LIFE-OPT.
  2287             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2288             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2289             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2290             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2291             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2292             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2293             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2294             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2295             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2296             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2297
  2298         16  CF-AH-OPT.
  2299             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2300             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2301             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2302             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2303             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2304             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2305             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2306             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2307             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2308             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2309
  2310         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2311             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2312             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2313             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2314
  2315         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2316
  2317         16  FILLER                         PIC X(673).
  2318
  2319
  2320****************************************************************
  2321*             MORTGAGE SYSTEM PLAN RECORD                      *
  2322****************************************************************
  2323
  2324     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2325         16  CF-PLAN-TYPE                   PIC X.
  2326             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2327             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2328             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2329         16  CF-PLAN-ABBREV                 PIC XXX.
  2330         16  CF-PLAN-DESCRIPT               PIC X(10).
  2331         16  CF-PLAN-NOTES                  PIC X(20).
  2332         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2333         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  42
* SOCK03.cbl
  2334             20  CF-PLAN-TERM-DATA.
  2335                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2336                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2337             20  CF-PLAN-AGE-DATA.
  2338                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2339                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2340                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2341             20  CF-PLAN-BENEFIT-DATA.
  2342                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2343                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2344                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2345                                            PIC S9(7)V99  COMP-3.
  2346         16  CF-PLAN-POLICY-FORMS.
  2347             20  CF-POLICY-FORM             PIC X(12).
  2348             20  CF-MASTER-APPLICATION      PIC X(12).
  2349             20  CF-MASTER-POLICY           PIC X(12).
  2350         16  CF-PLAN-RATING.
  2351             20  CF-RATE-CODE               PIC X(5).
  2352             20  CF-SEX-RATING              PIC X.
  2353                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2354                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2355             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2356             20  CF-SUB-STD-TYPE            PIC X.
  2357                 88  CF-PCT-OF-PREM            VALUE '1'.
  2358                 88  CF-PCT-OF-BENE            VALUE '2'.
  2359         16  CF-PLAN-PREM-TOLERANCES.
  2360             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2361             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2362         16  CF-PLAN-PYMT-TOLERANCES.
  2363             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2364             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2365         16  CF-PLAN-MISC-DATA.
  2366             20  FILLER                     PIC X.
  2367             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2368             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2369         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2370         16  CF-PLAN-IND-GRP                PIC X.
  2371             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2372                                                     '1'.
  2373             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2374                                                     '2'.
  2375         16  CF-MIB-SEARCH-SW               PIC X.
  2376             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2377             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2378             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2379             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2380         16  CF-ALPHA-SEARCH-SW             PIC X.
  2381             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2382             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2383             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2384             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2385             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2386             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2387             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2388             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2389             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2390             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2391                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  43
* SOCK03.cbl
  2392                                                     'X' 'Y' 'Z'.
  2393         16  CF-EFF-DT-RULE-SW              PIC X.
  2394             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2395             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2396             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2397             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2398             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2399         16  FILLER                         PIC X(4).
  2400         16  CF-HEALTH-QUESTIONS            PIC X.
  2401             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2402         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2403         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2404         16  CF-PLAN-SNGL-JNT               PIC X.
  2405             88  CF-COMBINED-PLAN              VALUE 'C'.
  2406             88  CF-JNT-PLAN                   VALUE 'J'.
  2407             88  CF-SNGL-PLAN                  VALUE 'S'.
  2408         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2409         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2410         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2411         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2412         16  CF-RERATE-CNTL                 PIC  X.
  2413             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2414             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2415             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2416             88  CF-AUTO-RECALC                 VALUE '4'.
  2417         16  CF-BENEFIT-TYPE                PIC  X.
  2418             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2419             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2420         16  CF-POLICY-FEE                  PIC S999V99
  2421                                                    COMP-3.
  2422         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2423         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2424         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2425         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2426         16  FILLER                         PIC  X(32).
  2427         16  CF-TERMINATION-FORM            PIC  X(04).
  2428         16  FILLER                         PIC  X(08).
  2429         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2430                                                       COMP-3.
  2431         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2432         16  CF-ISSUE-LETTER                PIC  X(4).
  2433         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2434         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2435             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2436             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2437         16  CF-MP-REFUND-CALC              PIC X.
  2438             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2439             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2440             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2441             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2442             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2443             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2444             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2445             88  CF-MP-REFD-MEAN                VALUE '8'.
  2446         16  CF-ALT-RATE-CODE               PIC  X(5).
  2447
  2448
  2449         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  44
* SOCK03.cbl
  2450****************************************************************
  2451*             MORTGAGE COMPANY MASTER RECORD                   *
  2452****************************************************************
  2453
  2454     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2455         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2456         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2457             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2458             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2459             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2460             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2461             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2462
  2463         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2464         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2465         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2466         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2467         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2468
  2469         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2470             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2471         16  CF-MP-RECON-USE-IND            PIC X(1).
  2472             88  CF-MP-USE-RECON             VALUE 'Y'.
  2473         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2474             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2475         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2476             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2477             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2478         16  FILLER                         PIC X(1).
  2479         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2480             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2481         16  CF-MORTG-MIB-VERSION           PIC X.
  2482             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2483             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2484             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2485         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2486             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2487                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2488             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2489                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2490             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2491                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2492             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2493                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2494             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2495                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2496             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2497                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2498         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2499         16  FILLER                         PIC X(7).
  2500         16  CF-MORTG-DESTINATION-SYMBOL.
  2501             20  CF-MORTG-MIB-COMM          PIC X(5).
  2502             20  CF-MORTG-MIB-TERM          PIC X(5).
  2503         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2504             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2505         16  FILLER                         PIC X(03).
  2506         16  CF-MP-CHECK-NO-CONTROL.
  2507             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  45
* SOCK03.cbl
  2508                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2509                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2510                                                ' ' LOW-VALUES.
  2511                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2512                                               VALUE '3'.
  2513         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2514         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2515         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2516             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2517                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2518             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2519                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2520             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2521                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2522             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2523                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2524             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2525                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2526             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2527                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2528         16  CF-MORTG-BILLING-AREA.
  2529             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2530                                            PIC X.
  2531         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2532         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2533         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2534         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2535             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2536             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2537         16  FILLER                         PIC X.
  2538         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2539             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2540             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2541         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2542         16  FILLER                         PIC X(8).
  2543         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2544         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2545         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2546         16  CF-ACH-COMPANY-ID.
  2547             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2548                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2549                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2550                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2551             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2552         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2553             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2554         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2555             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2556             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2557         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2558         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2559         16  FILLER                         PIC X(536).
  2560
  2561****************************************************************
  2562*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2563****************************************************************
  2564
  2565     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  46
* SOCK03.cbl
  2566         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2567             20  CF-FEMALE-HEIGHT.
  2568                 24  CF-FEMALE-FT           PIC 99.
  2569                 24  CF-FEMALE-IN           PIC 99.
  2570             20  CF-FEMALE-MIN-WT           PIC 999.
  2571             20  CF-FEMALE-MAX-WT           PIC 999.
  2572         16  FILLER                         PIC X(428).
  2573
  2574     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2575         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2576             20  CF-MALE-HEIGHT.
  2577                 24  CF-MALE-FT             PIC 99.
  2578                 24  CF-MALE-IN             PIC 99.
  2579             20  CF-MALE-MIN-WT             PIC 999.
  2580             20  CF-MALE-MAX-WT             PIC 999.
  2581         16  FILLER                         PIC X(428).
  2582******************************************************************
  2583*             AUTOMATIC ACTIVITY RECORD                          *
  2584******************************************************************
  2585     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2586         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2587             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2588             20  CF-SYS-LETTER-ID           PIC X(04).
  2589             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2590             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2591             20  CF-SYS-RESET-SW            PIC X(01).
  2592             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2593             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2594
  2595         16  FILLER                         PIC X(50).
  2596
  2597         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2598             20  CF-USER-ACTIVE-SW          PIC X(01).
  2599             20  CF-USER-LETTER-ID          PIC X(04).
  2600             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2601             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2602             20  CF-USER-RESET-SW           PIC X(01).
  2603             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2604             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2605             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2606
  2607         16  FILLER                         PIC X(246).
  2608*                                 COPY ERCACCT.
  2609******************************************************************
  2610*                                                                *
  2611*                                                                *
  2612*                            ERCACCT                             *
  2613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2614*                            VMOD=2.031                          *
  2615*                                                                *
  2616*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2617*                                                                *
  2618*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2619*   VSAM ACCOUNT MASTER FILES.                                   *
  2620*                                                                *
  2621*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2622*                                                                *
  2623*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  47
* SOCK03.cbl
  2624*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2625*                                                                *
  2626*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2627*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2628*                                                                *
  2629*   LOG = NO                                                     *
  2630*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2631*                                                                *
  2632*                                                                *
  2633******************************************************************
  2634*                   C H A N G E   L O G
  2635*
  2636* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2637*-----------------------------------------------------------------
  2638*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2639* EFFECTIVE    NUMBER
  2640*-----------------------------------------------------------------
  2641* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2642* 092705    2005050300006  PEMA  ADD SPP LEASES
  2643* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2644* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2645* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2646* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2647* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2648* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2649******************************************************************
  2650
  2651 01  ACCOUNT-MASTER.
  2652     12  AM-RECORD-ID                      PIC XX.
  2653         88  VALID-AM-ID                      VALUE 'AM'.
  2654
  2655     12  AM-CONTROL-PRIMARY.
  2656         16  AM-COMPANY-CD                 PIC X.
  2657         16  AM-MSTR-CNTRL.
  2658             20  AM-CONTROL-A.
  2659                 24  AM-CARRIER            PIC X.
  2660                 24  AM-GROUPING.
  2661                     28 AM-GROUPING-PREFIX PIC XXX.
  2662                     28 AM-GROUPING-PRIME  PIC XXX.
  2663                 24  AM-STATE              PIC XX.
  2664                 24  AM-ACCOUNT.
  2665                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2666                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2667             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2668                                           PIC X(19).
  2669             20  AM-CNTRL-B.
  2670                 24  AM-EXPIRATION-DT      PIC XX.
  2671                 24  FILLER                PIC X(4).
  2672             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2673                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2674
  2675     12  AM-CONTROL-BY-VAR-GRP.
  2676         16  AM-COMPANY-CD-A1              PIC X.
  2677         16  AM-VG-CARRIER                 PIC X.
  2678         16  AM-VG-GROUPING                PIC X(6).
  2679         16  AM-VG-STATE                   PIC XX.
  2680         16  AM-VG-ACCOUNT                 PIC X(10).
  2681         16  AM-VG-DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  48
* SOCK03.cbl
  2682             20  AM-VG-EXPIRATION-DT       PIC XX.
  2683             20  FILLER                    PIC X(4).
  2684         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2685                                           PIC 9(11)      COMP-3.
  2686     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2687         16  FILLER                        PIC X(10).
  2688         16  AM-VG-KEY3.
  2689             20  AM-VG3-ACCOUNT            PIC X(10).
  2690             20  AM-VG3-EXP-DT             PIC XX.
  2691         16  FILLER                        PIC X(4).
  2692     12  AM-MAINT-INFORMATION.
  2693         16  AM-LAST-MAINT-DT              PIC XX.
  2694         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2695         16  AM-LAST-MAINT-USER            PIC X(4).
  2696         16  FILLER                        PIC XX.
  2697
  2698     12  AM-EFFECTIVE-DT                   PIC XX.
  2699     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2700
  2701     12  AM-PREV-DATES  COMP-3.
  2702         16  AM-PREV-EXP-DT                PIC 9(11).
  2703         16  AM-PREV-EFF-DT                PIC 9(11).
  2704
  2705     12  AM-REPORT-CODE-1                  PIC X(10).
  2706     12  AM-REPORT-CODE-2                  PIC X(10).
  2707
  2708     12  AM-CITY-CODE                      PIC X(4).
  2709     12  AM-COUNTY-PARISH                  PIC X(6).
  2710
  2711     12  AM-NAME                           PIC X(30).
  2712     12  AM-PERSON                         PIC X(30).
  2713     12  AM-ADDRS                          PIC X(30).
  2714     12  AM-CITY.
  2715         16  AM-ADDR-CITY                  PIC X(28).
  2716         16  AM-ADDR-STATE                 PIC XX.
  2717     12  AM-ZIP.
  2718         16  AM-ZIP-PRIME.
  2719             20  AM-ZIP-PRI-1ST            PIC X.
  2720                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2721             20  FILLER                    PIC X(4).
  2722         16  AM-ZIP-PLUS4                  PIC X(4).
  2723     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2724         16  AM-CAN-POSTAL-1               PIC XXX.
  2725         16  AM-CAN-POSTAL-2               PIC XXX.
  2726         16  FILLER                        PIC XXX.
  2727     12  AM-TEL-NO.
  2728         16  AM-AREA-CODE                  PIC 999.
  2729         16  AM-TEL-PRE                    PIC 999.
  2730         16  AM-TEL-NBR                    PIC 9(4).
  2731     12  AM-TEL-LOC                        PIC X.
  2732         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2733         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2734
  2735     12  AM-COMM-STRUCTURE.
  2736         16  AM-DEFN-1.
  2737             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2738                 24  AM-AGT.
  2739                     28  AM-AGT-PREFIX     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  49
* SOCK03.cbl
  2740                     28  AM-AGT-PRIME      PIC X(6).
  2741                 24  AM-COM-TYP            PIC X.
  2742                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2743                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2744                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2745                 24  AM-RECALC-LV-INDIC    PIC X.
  2746                 24  AM-RETRO-LV-INDIC     PIC X.
  2747                 24  AM-GL-CODES           PIC X.
  2748                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2749                 24  FILLER                PIC X(01).
  2750         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2751             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2752                 24  FILLER                PIC X(11).
  2753                 24  AM-L-COMA             PIC XXX.
  2754                 24  AM-J-COMA             PIC XXX.
  2755                 24  AM-A-COMA             PIC XXX.
  2756                 24  FILLER                PIC X(6).
  2757
  2758     12  AM-COMM-CHANGE-STATUS             PIC X.
  2759         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2760
  2761     12  AM-CSR-CODE                       PIC X(4).
  2762
  2763     12  AM-BILLING-STATUS                 PIC X.
  2764         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2765         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2766     12  AM-AUTO-REFUND-SW                 PIC X.
  2767         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2768         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2769     12  AM-GPCD                           PIC 99.
  2770     12  AM-IG                             PIC X.
  2771         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2772         88  AM-HAS-GROUP                     VALUE '2'.
  2773     12  AM-STATUS                         PIC X.
  2774         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2775         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2776         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2777         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2778         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2779         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2780         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2781         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2782         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2783         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2784     12  AM-REMIT-TO                       PIC 99.
  2785     12  AM-ID-NO                          PIC X(11).
  2786
  2787     12  AM-CAL-TABLE                      PIC XX.
  2788     12  AM-LF-DEVIATION                   PIC XXX.
  2789     12  AM-AH-DEVIATION                   PIC XXX.
  2790     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2791     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2792     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2793     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2794     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2795     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2796
  2797     12  AM-USER-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  50
* SOCK03.cbl
  2798         16  AM-FLD-1                      PIC XX.
  2799         16  AM-FLD-2                      PIC XX.
  2800         16  AM-FLD-3                      PIC XX.
  2801         16  AM-FLD-4                      PIC XX.
  2802         16  AM-FLD-5                      PIC XX.
  2803
  2804     12  AM-1ST-PROD-DATE.
  2805         16  AM-1ST-PROD-YR                PIC XX.
  2806         16  AM-1ST-PROD-MO                PIC XX.
  2807         16  AM-1ST-PROD-DA                PIC XX.
  2808     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2809     12  AM-CERTS-PURGED-DATE.
  2810         16  AM-PUR-YR                     PIC XX.
  2811         16  AM-PUR-MO                     PIC XX.
  2812         16  AM-PUR-DA                     PIC XX.
  2813     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2814     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2815     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2816     12  AM-INACTIVE-DATE.
  2817         16  AM-INA-MO                     PIC 99.
  2818         16  AM-INA-DA                     PIC 99.
  2819         16  AM-INA-YR                     PIC 99.
  2820     12  AM-AR-HI-CERT-DATE                PIC XX.
  2821
  2822     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2823     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2824
  2825     12  AM-OB-PAYMENT-MODE                PIC X.
  2826         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2827         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2828         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2829         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2830
  2831     12  AM-AH-ONLY-INDICATOR              PIC X.
  2832         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2833         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2834
  2835     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2836
  2837     12  AM-OVER-SHORT.
  2838         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2839         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2840
  2841     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2842     12  AM-DCC-CLP-STATE                  PIC XX.
  2843
  2844     12  AM-RECALC-COMM                    PIC X.
  2845     12  AM-RECALC-REIN                    PIC X.
  2846
  2847     12  AM-REI-TABLE                      PIC XXX.
  2848     12  AM-REI-ET-LF                      PIC X.
  2849     12  AM-REI-ET-AH                      PIC X.
  2850     12  AM-REI-PE-LF                      PIC X.
  2851     12  AM-REI-PE-AH                      PIC X.
  2852     12  AM-REI-PRT-ST                     PIC X.
  2853     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2854     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2855     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  51
* SOCK03.cbl
  2856     12  AM-REI-GROUP-A                    PIC X(6).
  2857     12  AM-REI-MORT                       PIC X(4).
  2858     12  AM-REI-PRT-OW                     PIC X.
  2859     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2860     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2861     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2862     12  AM-REI-GROUP-B                    PIC X(6).
  2863
  2864     12  AM-TRUST-TYPE                     PIC X(2).
  2865
  2866     12  AM-EMPLOYER-STMT-USED             PIC X.
  2867     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2868
  2869     12  AM-STD-AH-TYPE                    PIC XX.
  2870     12  AM-EARN-METHODS.
  2871         16  AM-EARN-METHOD-R              PIC X.
  2872             88 AM-REF-RL-R78                 VALUE 'R'.
  2873             88 AM-REF-RL-PR                  VALUE 'P'.
  2874             88 AM-REF-RL-MEAN                VALUE 'M'.
  2875             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2876         16  AM-EARN-METHOD-L              PIC X.
  2877             88 AM-REF-LL-R78                 VALUE 'R'.
  2878             88 AM-REF-LL-PR                  VALUE 'P'.
  2879             88 AM-REF-LL-MEAN                VALUE 'M'.
  2880             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2881         16  AM-EARN-METHOD-A              PIC X.
  2882             88 AM-REF-AH-R78                 VALUE 'R'.
  2883             88 AM-REF-AH-PR                  VALUE 'P'.
  2884             88 AM-REF-AH-MEAN                VALUE 'M'.
  2885             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2886             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2887             88 AM-REF-AH-NET                 VALUE 'N'.
  2888
  2889     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2890     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2891     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2892
  2893     12  AM-RET-Y-N                        PIC X.
  2894     12  AM-RET-P-E                        PIC X.
  2895     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2896     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2897     12  AM-RET-GRP                        PIC X(6).
  2898     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2899         16  AM-POOL-PRIME                 PIC XXX.
  2900         16  AM-POOL-SUB                   PIC XXX.
  2901     12  AM-RETRO-EARNINGS.
  2902         16  AM-RET-EARN-R                 PIC X.
  2903         16  AM-RET-EARN-L                 PIC X.
  2904         16  AM-RET-EARN-A                 PIC X.
  2905     12  AM-RET-ST-TAX-USE                 PIC X.
  2906         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2907         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2908     12  AM-RETRO-BEG-EARNINGS.
  2909         16  AM-RET-BEG-EARN-R             PIC X.
  2910         16  AM-RET-BEG-EARN-L             PIC X.
  2911         16  AM-RET-BEG-EARN-A             PIC X.
  2912     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2913     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  52
* SOCK03.cbl
  2914
  2915     12  AM-USER-SELECT-OPTIONS.
  2916         16  AM-USER-SELECT-1              PIC X(10).
  2917         16  AM-USER-SELECT-2              PIC X(10).
  2918         16  AM-USER-SELECT-3              PIC X(10).
  2919         16  AM-USER-SELECT-4              PIC X(10).
  2920         16  AM-USER-SELECT-5              PIC X(10).
  2921
  2922     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2923
  2924     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2925
  2926     12  AM-RPT045A-SWITCH                 PIC X.
  2927         88  RPT045A-OFF                   VALUE 'N'.
  2928
  2929     12  AM-INSURANCE-LIMITS.
  2930         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2931         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2932
  2933     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2934         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2935
  2936     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2937         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2938         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2939
  2940     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2941
  2942     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2943     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2944     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2945     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2946     12  AM-DCC-UEF-STATE                  PIC XX.
  2947     12  FILLER                            PIC XXX.
  2948     12  AM-REPORT-CODE-3                  PIC X(10).
  2949*    12  FILLER                            PIC X(22).
  2950
  2951     12  AM-RESERVE-DATE.
  2952         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2953         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2954         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2955
  2956     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2957     12  AM-NOTIFICATION-TYPES.
  2958         16  AM-NOTIF-OF-LETTERS           PIC X.
  2959         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2960         16  AM-NOTIF-OF-REPORTS           PIC X.
  2961         16  AM-NOTIF-OF-STATUS            PIC X.
  2962
  2963     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2964         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2965         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2966         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2967         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2968
  2969     12  AM-BENEFIT-CONTROLS.
  2970         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2971             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  53
* SOCK03.cbl
  2972             20  AM-BENEFIT-TYPE           PIC X.
  2973             20  AM-BENEFIT-REVISION       PIC XXX.
  2974             20  AM-BENEFIT-REM-TERM       PIC X.
  2975             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2976             20  FILLER                    PIC XX.
  2977         16  FILLER                        PIC X(80).
  2978
  2979     12  AM-TRANSFER-DATA.
  2980         16  AM-TRANSFERRED-FROM.
  2981             20  AM-TRNFROM-CARRIER        PIC X.
  2982             20  AM-TRNFROM-GROUPING.
  2983                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2984                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2985             20  AM-TRNFROM-STATE          PIC XX.
  2986             20  AM-TRNFROM-ACCOUNT.
  2987                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2988                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2989             20  AM-TRNFROM-DTE            PIC XX.
  2990         16  AM-TRANSFERRED-TO.
  2991             20  AM-TRNTO-CARRIER          PIC X.
  2992             20  AM-TRNTO-GROUPING.
  2993                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2994                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2995             20  AM-TRNTO-STATE            PIC XX.
  2996             20  AM-TRNTO-ACCOUNT.
  2997                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2998                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2999             20  AM-TRNTO-DTE              PIC XX.
  3000         16  FILLER                        PIC X(10).
  3001
  3002     12  AM-SAVED-REMIT-TO                 PIC 99.
  3003
  3004     12  AM-COMM-STRUCTURE-SAVED.
  3005         16  AM-DEFN-1-SAVED.
  3006             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3007                 24  AM-AGT-SV             PIC X(10).
  3008                 24  AM-COM-TYP-SV         PIC X.
  3009                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3010                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3011                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3012                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3013                 24  FILLER                PIC X.
  3014                 24  AM-GL-CODES-SV        PIC X.
  3015                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3016                 24  FILLER                PIC X.
  3017         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3018             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3019                 24  FILLER                PIC X(11).
  3020                 24  AM-L-COMA-SV          PIC XXX.
  3021                 24  AM-J-COMA-SV          PIC XXX.
  3022                 24  AM-A-COMA-SV          PIC XXX.
  3023                 24  FILLER                PIC X(6).
  3024
  3025     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3026         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3027            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3028            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3029            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  54
* SOCK03.cbl
  3030
  3031     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3032     12  FILLER                            PIC X(120).
  3033
  3034     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3035         16  AM-CONTROL-NAME               PIC X(30).
  3036         16  AM-EXECUTIVE-ONE.
  3037             20  AM-EXEC1-NAME             PIC X(15).
  3038             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3039                                                          COMP-3.
  3040             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3041                                                          COMP-3.
  3042         16  AM-EXECUTIVE-TWO.
  3043             20  AM-EXEC2-NAME             PIC X(15).
  3044             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3045                                                          COMP-3.
  3046             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3047                                                          COMP-3.
  3048
  3049     12  AM-RETRO-ADDITIONAL-DATA.
  3050         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3051         16  AM-RETRO-PREM-P-E             PIC X.
  3052         16  AM-RETRO-CLMS-P-I             PIC X.
  3053         16  AM-RETRO-RET-BRACKET-LF.
  3054             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3055                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3056                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3057             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3058                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3059                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3060             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3061                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3062                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3063         16  AM-RETRO-RET-BRACKET-AH.
  3064             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3065                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3066                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3067                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3068             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3069                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3070                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3071             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3072                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3073                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3074
  3075     12  AM-COMMENTS.
  3076         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3077
  3078     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3079         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3080         16  AM-FLI-BILLING-CODE           PIC X.
  3081         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3082         16  AM-FLI-UNITED-IDENT           PIC X.
  3083         16  AM-FLI-INTEREST-LOST-DATA.
  3084             20  AM-FLI-BANK-NO            PIC X(5).
  3085             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3086             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3087             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  55
* SOCK03.cbl
  3088         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3089             20  AM-FLI-AGT                PIC X(9).
  3090             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3091             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3092         16  FILLER                        PIC X(102).
  3093
  3094     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3095         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3096             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3097             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3098             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3099             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3100             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3101         16  FILLER                          PIC X(10).
  3102******************************************************************
  3103*                                 COPY ERCMAIL.
  3104******************************************************************
  3105*                                                                *
  3106*                                                                *
  3107*                            ERCMAIL                             *
  3108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3109*                            VMOD=2.003                          *
  3110*                                                                *
  3111*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3112*                                                                *
  3113*   FILE TYPE = VSAM,KSDS                                        *
  3114*   RECORD SIZE = 374   RECFORM = FIX                            *
  3115*                                                                *
  3116*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3117*   ALTERNATE PATH    = NOT USED                                 *
  3118*                                                                *
  3119*   LOG = YES                                                    *
  3120*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3121******************************************************************
  3122*                   C H A N G E   L O G
  3123*
  3124* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3125*-----------------------------------------------------------------
  3126*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3127* EFFECTIVE    NUMBER
  3128*-----------------------------------------------------------------
  3129* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3130* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3131* 111108                   PEMA  ADD CRED BENE ADDR2
  3132******************************************************************
  3133
  3134 01  MAILING-DATA.
  3135     12  MA-RECORD-ID                      PIC XX.
  3136         88  VALID-MA-ID                       VALUE 'MA'.
  3137
  3138     12  MA-CONTROL-PRIMARY.
  3139         16  MA-COMPANY-CD                 PIC X.
  3140         16  MA-CARRIER                    PIC X.
  3141         16  MA-GROUPING.
  3142             20  MA-GROUPING-PREFIX        PIC XXX.
  3143             20  MA-GROUPING-PRIME         PIC XXX.
  3144         16  MA-STATE                      PIC XX.
  3145         16  MA-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  56
* SOCK03.cbl
  3146             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3147             20  MA-ACCOUNT-PRIME          PIC X(6).
  3148         16  MA-CERT-EFF-DT                PIC XX.
  3149         16  MA-CERT-NO.
  3150             20  MA-CERT-PRIME             PIC X(10).
  3151             20  MA-CERT-SFX               PIC X.
  3152
  3153     12  FILLER                            PIC XX.
  3154
  3155     12  MA-ACCESS-CONTROL.
  3156         16  MA-SOURCE-SYSTEM              PIC XX.
  3157             88  MA-FROM-CREDIT                VALUE 'CR'.
  3158             88  MA-FROM-VSI                   VALUE 'VS'.
  3159             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3160             88  MA-FROM-OTHER                 VALUE 'OT'.
  3161         16  MA-RECORD-ADD-DT              PIC XX.
  3162         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3163         16  MA-LAST-MAINT-DT              PIC XX.
  3164         16  MA-LAST-MAINT-BY              PIC XXXX.
  3165         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3166
  3167     12  MA-PROFILE-INFO.
  3168         16  MA-QUALIFY-CODE-1             PIC XX.
  3169         16  MA-QUALIFY-CODE-2             PIC XX.
  3170         16  MA-QUALIFY-CODE-3             PIC XX.
  3171         16  MA-QUALIFY-CODE-4             PIC XX.
  3172         16  MA-QUALIFY-CODE-5             PIC XX.
  3173
  3174         16  MA-INSURED-LAST-NAME          PIC X(15).
  3175         16  MA-INSURED-FIRST-NAME         PIC X(10).
  3176         16  MA-INSURED-MIDDLE-INIT        PIC X.
  3177         16  MA-INSURED-ISSUE-AGE          PIC 99.
  3178         16  MA-INSURED-BIRTH-DT           PIC XX.
  3179         16  MA-INSURED-SEX                PIC X.
  3180             88  MA-SEX-MALE                   VALUE 'M'.
  3181             88  MA-SEX-FEMALE                 VALUE 'F'.
  3182         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  3183
  3184         16  MA-ADDRESS-CORRECTED          PIC X.
  3185         16  MA-JOINT-BIRTH-DT             PIC XX.
  3186*        16  FILLER                        PIC X(12).
  3187
  3188         16  MA-ADDRESS-LINE-1             PIC X(30).
  3189         16  MA-ADDRESS-LINE-2             PIC X(30).
  3190         16  MA-CITY-STATE.
  3191             20  MA-CITY                   PIC X(28).
  3192             20  MA-ADDR-STATE             PIC XX.
  3193         16  MA-ZIP.
  3194             20  MA-ZIP-CODE.
  3195                 24  MA-ZIP-CODE-1ST       PIC X(1).
  3196                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3197                 24  FILLER                PIC X(4).
  3198             20  MA-ZIP-PLUS4              PIC X(4).
  3199         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  3200             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  3201             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  3202             20  FILLER                    PIC X(3).
  3203
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  57
* SOCK03.cbl
  3204         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  3205
  3206         16  FILLER                        PIC XXX.
  3207*        16  FILLER                        PIC X(10).
  3208
  3209     12  MA-CRED-BENE-INFO.
  3210         16  MA-CRED-BENE-NAME                 PIC X(25).
  3211         16  MA-CRED-BENE-ADDR                 PIC X(30).
  3212         16  MA-CRED-BENE-ADDR2                PIC X(30).
  3213         16  MA-CRED-BENE-CTYST.
  3214             20  MA-CRED-BENE-CITY             PIC X(28).
  3215             20  MA-CRED-BENE-STATE            PIC XX.
  3216         16  MA-CRED-BENE-ZIP.
  3217             20  MA-CB-ZIP-CODE.
  3218                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  3219                     88  MA-CB-CANADIAN-POST-CODE
  3220                                           VALUE 'A' THRU 'Z'.
  3221                 24  FILLER                    PIC X(4).
  3222             20  MA-CB-ZIP-PLUS4               PIC X(4).
  3223         16  MA-CB-CANADIAN-POSTAL-CODE
  3224                            REDEFINES MA-CRED-BENE-ZIP.
  3225             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  3226             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  3227             20  FILLER                        PIC X(3).
  3228     12  MA-POST-CARD-MAIL-DATA.
  3229         16  MA-MAIL-DATA OCCURS 7.
  3230             20  MA-MAIL-TYPE              PIC X.
  3231                 88  MA-12MO-MAILING           VALUE '1'.
  3232                 88  MA-EXP-MAILING            VALUE '2'.
  3233             20  MA-MAIL-STATUS            PIC X.
  3234                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  3235                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  3236                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  3237             20  MA-MAIL-DATE              PIC XX.
  3238     12  FILLER                            PIC XX.
  3239     12  FILLER                            PIC XX.
  3240*    12  FILLER                            PIC X(30).
  3241******************************************************************
  3242*                                 COPY ELCCRTT.
  3243******************************************************************
  3244*                                                                *
  3245*                            ELCCRTT.                            *
  3246*                                                                *
  3247*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3248*                                                                *
  3249*   FILE TYPE = VSAM,KSDS                                        *
  3250*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3251*                                                                *
  3252*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3253*                                                                *
  3254*   LOG = YES                                                    *
  3255*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3256******************************************************************
  3257*                   C H A N G E   L O G
  3258*
  3259* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3260*-----------------------------------------------------------------
  3261*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  58
* SOCK03.cbl
  3262* EFFECTIVE    NUMBER
  3263*-----------------------------------------------------------------
  3264* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3265* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3266* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3267* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3268* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3269* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3270* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3271* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3272* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3273* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3274* 091318  CR2018073000001  PEMA  ADD Refund methods
  3275* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3276******************************************************************
  3277
  3278 01  CERTIFICATE-TRAILERS.
  3279     12  CS-RECORD-ID                      PIC XX.
  3280         88  VALID-CS-ID                      VALUE 'CS'.
  3281
  3282     12  CS-CONTROL-PRIMARY.
  3283         16  CS-COMPANY-CD                 PIC X.
  3284         16  CS-CARRIER                    PIC X.
  3285         16  CS-GROUPING                   PIC X(6).
  3286         16  CS-STATE                      PIC XX.
  3287         16  CS-ACCOUNT                    PIC X(10).
  3288         16  CS-CERT-EFF-DT                PIC XX.
  3289         16  CS-CERT-NO.
  3290             20  CS-CERT-PRIME             PIC X(10).
  3291             20  CS-CERT-SFX               PIC X.
  3292         16  CS-TRAILER-TYPE               PIC X.
  3293             88  COMM-TRLR           VALUE 'A'.
  3294             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3295             88  CERT-DATA-TRLR      VALUE 'C'.
  3296
  3297     12  CS-DATA-AREA                      PIC X(516).
  3298
  3299     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3300         16  CS-BANK-COMMISSION-AREA.
  3301             20  CS-BANK-COMMS       OCCURS 10.
  3302                 24  CS-AGT                PIC X(10).
  3303                 24  CS-COM-TYP            PIC X.
  3304                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3305                 24  CS-RECALC-LV-INDIC    PIC X.
  3306                 24  FILLER                PIC X(10).
  3307         16  FILLER                        PIC X(256).
  3308
  3309     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3310****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3311         16  CS-MB-CLAIM-DATA OCCURS 24.
  3312             20  CS-CLAIM-NO               PIC X(7).
  3313             20  CS-CLAIM-TYPE             PIC X.
  3314                 88  CS-AH-CLM               VALUE 'A'.
  3315                 88  CS-IU-CLM               VALUE 'I'.
  3316                 88  CS-GP-CLM               VALUE 'G'.
  3317                 88  CS-LF-CLM               VALUE 'L'.
  3318                 88  CS-PR-CLM               VALUE 'P'.
  3319                 88  CS-FL-CLM               VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  59
* SOCK03.cbl
  3320                 88  CS-OT-CLM               VALUE 'O'.
  3321             20  CS-INSURED-TYPE           PIC X.
  3322                 88  CS-PRIM-INSURED          VALUE 'P'.
  3323                 88  CS-CO-BORROWER           VALUE 'C'.
  3324             20  CS-BENEFIT-PERIOD         PIC 99.
  3325             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3326             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3327             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3328         16  FILLER                        PIC X(12).
  3329     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3330         16  CS-VIN-NUMBER                 PIC X(17).
  3331         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3332         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3333         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3334         16  cs-agent-name.
  3335             20  cs-agent-fname            pic x(20).
  3336             20  cs-agent-mi               pic x.
  3337             20  cs-agent-lname            pic x(25).
  3338         16  cs-license-no                 pic x(15).
  3339         16  cs-npn-number                 pic x(10).
  3340         16  cs-agent-edit-status          pic x.
  3341             88  cs-ae-refer-to-manager      value 'M'.
  3342             88  cs-ae-cover-sheet           value 'C'.
  3343             88  cs-ae-sig-form              value 'S'.
  3344             88  cs-ae-verified              value 'V'.
  3345             88  cs-unidentified-signature   value 'U'.
  3346             88  cs-cert-returned            value 'R'.
  3347             88  cs-accept-no-commission     value 'N'.
  3348         16  cs-year                       pic 9999.
  3349         16  cs-make                       pic x(20).
  3350         16  cs-model                      pic x(20).
  3351         16  cs-future                     pic x(20).
  3352         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3353         16  cs-claim-verification-status  pic x.
  3354             88  cs-clm-ver-eligible         value 'A'.
  3355             88  cs-clm-ver-partial-elig     value 'B'.
  3356             88  cs-clm-ver-not-eligible     value 'C'.
  3357             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3358             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3359             88  cs-clm-ver-ND-CERT          value 'F'.
  3360             88  cs-clm-ver-spec-other       value 'G'.
  3361             88  cs-clam-ver-pratial-corrected
  3362                                             value 'H'.
  3363             88  cs-clm-ver-no-matches       value 'I'.
  3364             88  cs-clm-ver-not-elig-corrected
  3365                                             value 'J'.
  3366             88  cs-clm-ver-needs-review     value 'R'.
  3367             88  cs-clm-ver-sent-to-claims   value 'W'.
  3368         16  CS-LF-REFUND-METHOD           PIC X.
  3369         16  CS-AH-REFUND-METHOD           PIC X.
  3370         16  FILLER                        PIC X(353). *> was 420
  3371*        16  FILLER                        PIC X(496).
  3372*                                 COPY ELCDATE.
  3373******************************************************************
  3374*                                                                *
  3375*                                                                *
  3376*                            ELCDATE.                            *
  3377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  60
* SOCK03.cbl
  3378*                            VMOD=2.003
  3379*                                                                *
  3380*                                                                *
  3381*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3382*                 LENGTH = 200                                   *
  3383******************************************************************
  3384
  3385 01  DATE-CONVERSION-DATA.
  3386     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3387     12  DC-OPTION-CODE                PIC X.
  3388         88  BIN-TO-GREG                VALUE ' '.
  3389         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3390         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3391         88  YMD-GREG-TO-BIN            VALUE '3'.
  3392         88  MDY-GREG-TO-BIN            VALUE '4'.
  3393         88  JULIAN-TO-BIN              VALUE '5'.
  3394         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3395         88  FIND-CENTURY               VALUE '7'.
  3396         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3397         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3398         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3399         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3400         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3401         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3402         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3403         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3404         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3405         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3406         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3407         88  BIN-3-TO-GREG              VALUE 'I'.
  3408         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3409         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3410         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3411         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3412         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3413         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3414         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3415         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3416         88  THREE-CHARACTER-BIN
  3417                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3418         88  GREGORIAN-TO-BIN
  3419                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3420         88  BIN-TO-GREGORIAN
  3421                  VALUES ' ' '1' 'I' '8' 'G'.
  3422         88  JULIAN-TO-BINARY
  3423                  VALUES '5' 'C' 'E' 'F'.
  3424     12  DC-ERROR-CODE                 PIC X.
  3425         88  NO-CONVERSION-ERROR        VALUE ' '.
  3426         88  DATE-CONVERSION-ERROR
  3427                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3428         88  DATE-IS-ZERO               VALUE '1'.
  3429         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3430         88  DATE-IS-INVALID            VALUE '3'.
  3431         88  DATE1-GREATER-DATE2        VALUE '4'.
  3432         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3433         88  DATE-INVALID-OPTION        VALUE '9'.
  3434         88  INVALID-CENTURY            VALUE 'A'.
  3435         88  ONLY-CENTURY               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  61
* SOCK03.cbl
  3436         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3437         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3438     12  DC-END-OF-MONTH               PIC X.
  3439         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3440     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3441         88  USE-NORMAL-PROCESS         VALUE ' '.
  3442         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3443         88  ADJUST-UP-100-YRS          VALUE '2'.
  3444     12  FILLER                        PIC X.
  3445     12  DC-CONVERSION-DATES.
  3446         16  DC-BIN-DATE-1             PIC XX.
  3447         16  DC-BIN-DATE-2             PIC XX.
  3448         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3449         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3450                       DC-GREG-DATE-1-EDIT.
  3451             20  DC-EDIT1-MONTH        PIC 99.
  3452             20  SLASH1-1              PIC X.
  3453             20  DC-EDIT1-DAY          PIC 99.
  3454             20  SLASH1-2              PIC X.
  3455             20  DC-EDIT1-YEAR         PIC 99.
  3456         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3457         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3458                     DC-GREG-DATE-2-EDIT.
  3459             20  DC-EDIT2-MONTH        PIC 99.
  3460             20  SLASH2-1              PIC X.
  3461             20  DC-EDIT2-DAY          PIC 99.
  3462             20  SLASH2-2              PIC X.
  3463             20  DC-EDIT2-YEAR         PIC 99.
  3464         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3465         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3466                     DC-GREG-DATE-1-YMD.
  3467             20  DC-YMD-YEAR           PIC 99.
  3468             20  DC-YMD-MONTH          PIC 99.
  3469             20  DC-YMD-DAY            PIC 99.
  3470         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3471         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3472                      DC-GREG-DATE-1-MDY.
  3473             20  DC-MDY-MONTH          PIC 99.
  3474             20  DC-MDY-DAY            PIC 99.
  3475             20  DC-MDY-YEAR           PIC 99.
  3476         16  DC-GREG-DATE-1-ALPHA.
  3477             20  DC-ALPHA-MONTH        PIC X(10).
  3478             20  DC-ALPHA-DAY          PIC 99.
  3479             20  FILLER                PIC XX.
  3480             20  DC-ALPHA-CENTURY.
  3481                 24 DC-ALPHA-CEN-N     PIC 99.
  3482             20  DC-ALPHA-YEAR         PIC 99.
  3483         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3484         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3485         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3486         16  DC-JULIAN-DATE            PIC 9(05).
  3487         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3488                                       PIC 9(05).
  3489         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3490             20  DC-JULIAN-YEAR        PIC 99.
  3491             20  DC-JULIAN-DAYS        PIC 999.
  3492         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3493         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  62
* SOCK03.cbl
  3494         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3495     12  DATE-CONVERSION-VARIBLES.
  3496         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3497         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3498             20  FILLER                PIC 9(3).
  3499             20  HOLD-CEN-1-CCYY.
  3500                 24  HOLD-CEN-1-CC     PIC 99.
  3501                 24  HOLD-CEN-1-YY     PIC 99.
  3502             20  HOLD-CEN-1-MO         PIC 99.
  3503             20  HOLD-CEN-1-DA         PIC 99.
  3504         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3505             20  HOLD-CEN-1-R-MO       PIC 99.
  3506             20  HOLD-CEN-1-R-DA       PIC 99.
  3507             20  HOLD-CEN-1-R-CCYY.
  3508                 24  HOLD-CEN-1-R-CC   PIC 99.
  3509                 24  HOLD-CEN-1-R-YY   PIC 99.
  3510             20  FILLER                PIC 9(3).
  3511         16  HOLD-CENTURY-1-X.
  3512             20  FILLER                PIC X(3)  VALUE SPACES.
  3513             20  HOLD-CEN-1-X-CCYY.
  3514                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3515                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3516             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3517             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3518         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3519             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3520             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3521             20  HOLD-CEN-1-R-X-CCYY.
  3522                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3523                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3524             20  FILLER                PIC XXX.
  3525         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3526         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3527         16  DC-JULIAN-DATE-1          PIC 9(07).
  3528         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3529             20  DC-JULIAN-1-CCYY.
  3530                 24  DC-JULIAN-1-CC    PIC 99.
  3531                 24  DC-JULIAN-1-YR    PIC 99.
  3532             20  DC-JULIAN-DA-1        PIC 999.
  3533         16  DC-JULIAN-DATE-2          PIC 9(07).
  3534         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3535             20  DC-JULIAN-2-CCYY.
  3536                 24  DC-JULIAN-2-CC    PIC 99.
  3537                 24  DC-JULIAN-2-YR    PIC 99.
  3538             20  DC-JULIAN-DA-2        PIC 999.
  3539         16  DC-GREG-DATE-A-EDIT.
  3540             20  DC-EDITA-MONTH        PIC 99.
  3541             20  SLASHA-1              PIC X VALUE '/'.
  3542             20  DC-EDITA-DAY          PIC 99.
  3543             20  SLASHA-2              PIC X VALUE '/'.
  3544             20  DC-EDITA-CCYY.
  3545                 24  DC-EDITA-CENT     PIC 99.
  3546                 24  DC-EDITA-YEAR     PIC 99.
  3547         16  DC-GREG-DATE-B-EDIT.
  3548             20  DC-EDITB-MONTH        PIC 99.
  3549             20  SLASHB-1              PIC X VALUE '/'.
  3550             20  DC-EDITB-DAY          PIC 99.
  3551             20  SLASHB-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  63
* SOCK03.cbl
  3552             20  DC-EDITB-CCYY.
  3553                 24  DC-EDITB-CENT     PIC 99.
  3554                 24  DC-EDITB-YEAR     PIC 99.
  3555         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3556         16  DC-GREG-DATE-CYMD-R REDEFINES
  3557                              DC-GREG-DATE-CYMD.
  3558             20  DC-CYMD-CEN           PIC 99.
  3559             20  DC-CYMD-YEAR          PIC 99.
  3560             20  DC-CYMD-MONTH         PIC 99.
  3561             20  DC-CYMD-DAY           PIC 99.
  3562         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3563         16  DC-GREG-DATE-MDCY-R REDEFINES
  3564                              DC-GREG-DATE-MDCY.
  3565             20  DC-MDCY-MONTH         PIC 99.
  3566             20  DC-MDCY-DAY           PIC 99.
  3567             20  DC-MDCY-CEN           PIC 99.
  3568             20  DC-MDCY-YEAR          PIC 99.
  3569    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3570        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3571    12  DC-EL310-DATE                  PIC X(21).
  3572    12  FILLER                         PIC X(28).
  3573*                                 COPY ELCCALC.
  3574******************************************************************
  3575*                                                                *
  3576*                           ELCCALC.                            *
  3577*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3578*                            VMOD=2.025                          *
  3579*                                                                *
  3580*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3581*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3582*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3583*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3584*                                                                *
  3585*  PASSED TO ELRTRM                                              *
  3586*  -----------------                                             *
  3587*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3588*  ORIGINAL TERM                                                 *
  3589*  BEGINNING DATE                                                *
  3590*  ENDING DATE                                                   *
  3591*  COMPANY I.D.                                                  *
  3592*  ACCOUNT MASTER USER FIELD                                     *
  3593*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3594*  FREE LOOK DAYS                                                *
  3595*                                                                *
  3596*  RETURNED FROM ELRTRM                                          *
  3597*  ---------------------                                         *
  3598*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3599*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3600*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3601*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3602*----------------------------------------------------------------*
  3603*  PASSED TO ELRAMT                                              *
  3604*  ----------------                                              *
  3605*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3606*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3607*  ORIGINAL AMOUNT                                               *
  3608*  ALTERNATE BENEFIT (BALLON)                                    *
  3609*  A.P.R. - NET PAY ONLY                                         *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  64
* SOCK03.cbl
  3610*  METHOD
  3611*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3612*  COMPANY I.D.                                                  *
  3613*  BENEFIT TYPE                                                  *
  3614*                                                                *
  3615*  RETURNED FROM ELRAMT                                          *
  3616*  --------------------                                          *
  3617*  REMAINING AMOUNT 1 - CURRENT                                  *
  3618*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3619*  REMAINING AMOUNT FACTOR
  3620*----------------------------------------------------------------*
  3621*  PASSED TO ELRESV                                              *
  3622*  -----------------                                             *
  3623*  CERTIFICATE EFFECTIVE DATE                                    *
  3624*  VALUATION DATE                                                *
  3625*  PAID THRU DATE                                                *
  3626*  BENEFIT                                                       *
  3627*  INCURRED DATE                                                 *
  3628*  REPORTED DATE                                                 *
  3629*  ISSUE AGE                                                     *
  3630*  TERM                                                          *
  3631*  CDT PERCENT                                                   *
  3632*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3633* *CLAIM TYPE (LIFE, A/H)                                        *
  3634* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3635* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3636*                                                                *
  3637*  RETURNED FROM ELRESV                                          *
  3638*  --------------------                                          *
  3639*  CDT TABLE USED                                                *
  3640*  CDT FACTOR USED                                               *
  3641*  PAY TO CURRENT RESERVE                                        *
  3642*  I.B.N.R. - A/H ONLY                                           *
  3643*  FUTURE (ACCRUED) AH ONLY                                      *
  3644*----------------------------------------------------------------*
  3645*  PASSED TO ELRATE                                              *
  3646*  ----------------                                              *
  3647*  CERT ISSUE DATE                                               *
  3648*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3649*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3650*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3651*  STATE CODE (CLIENT DEFINED)                                   *
  3652*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3653*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3654*  DEVIATION CODE                                                *
  3655*  ISSUE AGE                                                     *
  3656*  ORIGINAL BENEFIT AMOUNT                                       *
  3657*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3658*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3659*  BENEFIT KIND (LIFE OR A/H)                                    *
  3660*  A.P.R.                                                        *
  3661*  METHOD
  3662*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3663*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3664*  COMPANY I.D. (3 CHARACTER)                                    *
  3665*  BENEFIT CODE                                                  *
  3666*  BENEFIT OVERRIDE CODE                                         *
  3667*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  65
* SOCK03.cbl
  3668*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3669*  JOINT INDICATOR (CSL ONLY)                                    *
  3670*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3671*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3672*                                                                *
  3673*  RETURNED FROM ELRATE                                          *
  3674*  --------------------                                          *
  3675*  CALCULATED PREMIUM                                            *
  3676*  PREMIUM RATE                                                  *
  3677*  MORTALITY CODE                                                *
  3678*  MAX ATTAINED AGE                                              *
  3679*  MAX AGE                                                       *
  3680*  MAX TERM                                                      *
  3681*  MAX MONTHLY BENEFIT                                           *
  3682*  MAX TOTAL BENIFIT                                             *
  3683*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3684*----------------------------------------------------------------*
  3685*  PASSED TO ELRFND                                              *
  3686*  ----------------                                              *
  3687*  CERT ISSUE DATE                                               *
  3688*  REFUND DATE                                                   *
  3689*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3690*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3691*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3692*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3693*  STATE CODE (CLIENT DEFINED)                                   *
  3694*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3695*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3696*  DEVIATION CODE                                                *
  3697*  ISSUE AGE                                                     *
  3698*  ORIGINAL BENEFIT AMOUNT                                       *
  3699*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3700*  PROCESS TYPE (CANCEL)                                         *
  3701*  BENEFIT KIND (LIFE OR A/H)                                    *
  3702*  A.P.R.                                                        *
  3703*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3704*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3705*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3706*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3707*  COMPANY I.D. (3 CHARACTER)                                    *
  3708*  BENEFIT CODE                                                  *
  3709*  BENEFIT OVERRIDE CODE                                         *
  3710*                                                                *
  3711*  RETURNED FROM ELRFND                                          *
  3712*  --------------------                                          *
  3713*  CALCULATED REFUND                                             *
  3714*----------------------------------------------------------------*
  3715*  PASSED TO ELEARN                                              *
  3716*  ----------------                                              *
  3717*  CERT ISSUE DATE                                               *
  3718*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3719*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3720*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3721*  STATE CODE (CLIENT DEFINED)                                   *
  3722*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3723*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3724*  DEVIATION CODE                                                *
  3725*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  66
* SOCK03.cbl
  3726*  ORIGINAL BENEFIT AMOUNT                                       *
  3727*  BENEFIT KIND (LIFE OR A/H)                                    *
  3728*  A.P.R.                                                        *
  3729*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3730*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3731*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3732*  COMPANY I.D. (3 CHARACTER)                                    *
  3733*  BENEFIT CODE                                                  *
  3734*  BENEFIT OVERRIDE CODE                                         *
  3735*                                                                *
  3736*  RETURNED FROM ELEARN                                          *
  3737*  --------------------                                          *
  3738*  INDICATED  EARNINGS                                           *
  3739*----------------------------------------------------------------*
  3740*                 LENGTH = 450                                   *
  3741*                                                                *
  3742******************************************************************
  3743******************************************************************
  3744*                   C H A N G E   L O G
  3745*
  3746* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3747*-----------------------------------------------------------------
  3748*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3749* EFFECTIVE    NUMBER
  3750*-----------------------------------------------------------------
  3751* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3752* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3753* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3754* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3755* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3756* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3757* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3758* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3759* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3760* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3761* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3762******************************************************************
  3763
  3764 01  CALCULATION-PASS-AREA.
  3765     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3766                                     COMP.
  3767
  3768     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3769       88  NO-CP-ERROR                             VALUE ZERO.
  3770       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3771                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3772       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3773       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3774       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3775       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3776       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3777       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3778       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3779       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3780       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3781       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3782       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3783       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  67
* SOCK03.cbl
  3784       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3785       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3786       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3787       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3788       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3789
  3790     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3791       88  NO-CP-ERROR-2                           VALUE ZERO.
  3792***********************  INPUT AREAS ****************************
  3793
  3794     12  CP-CALCULATION-AREA.
  3795         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3796         16  CP-CERT-EFF-DT        PIC XX.
  3797         16  CP-VALUATION-DT       PIC XX.
  3798         16  CP-PAID-THRU-DT       PIC XX.
  3799         16  CP-BENEFIT-TYPE       PIC X.
  3800           88  CP-AH                               VALUE 'A' 'D'
  3801                                                   'I' 'U'.
  3802           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3803           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3804         16  CP-INCURRED-DT        PIC XX.
  3805         16  CP-REPORTED-DT        PIC XX.
  3806         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3807         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3808         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3809                                     COMP-3.
  3810         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3811                                     COMP-3.
  3812         16  CP-CDT-METHOD         PIC X.
  3813           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3814           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3815           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3816         16  CP-CLAIM-TYPE         PIC X.
  3817           88  CP-AH-CLAIM                         VALUE 'A'.
  3818           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3819         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3820                                     COMP-3.
  3821         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3822                                     COMP-3.
  3823         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3824                                     COMP-3.
  3825         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3826                                     COMP-3.
  3827         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3828                                     COMP-3.
  3829         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3830                                     COMP-3.
  3831         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3832                                     COMP-3.
  3833         16  CP-REM-TERM-METHOD    PIC X.
  3834           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3835           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3836           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3837           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3838           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3839           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3840           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3841         16  CP-EARNING-METHOD     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  68
* SOCK03.cbl
  3842           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3843           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3844           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3845           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3846           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3847           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3848           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3849           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3850           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3851           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3852           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3853           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3854           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3855           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3856         16  CP-PROCESS-TYPE       PIC X.
  3857           88  CP-CLAIM                            VALUE '1'.
  3858           88  CP-CANCEL                           VALUE '2'.
  3859           88  CP-ISSUE                            VALUE '3'.
  3860         16  CP-SPECIAL-CALC-CD    PIC X.
  3861           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3862           88  CP-1-MTH-INTEREST               VALUE ' '.
  3863           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3864           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3865           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3866           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3867           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3868           88  CP-FARM-PLAN                    VALUE 'F'.
  3869           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3870           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3871           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3872           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3873           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3874           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3875           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3876           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3877           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3878           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3879                                                     'W' 'X'.
  3880           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3881           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3882           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3883           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3884           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3885           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3886           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3887           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3888           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3889           88  CP-CSL-METH-1                   VALUE '5'.
  3890           88  CP-CSL-METH-2                   VALUE '6'.
  3891           88  CP-CSL-METH-3                   VALUE '7'.
  3892           88  CP-CSL-METH-4                   VALUE '8'.
  3893
  3894         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3895                                     COMP-3.
  3896         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3897         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3898         16  CP-STATE              PIC XX          VALUE SPACE.
  3899         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  69
* SOCK03.cbl
  3900         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3901           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3902               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3903         16  CP-R78-OPTION         PIC X.
  3904           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3905           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3906
  3907         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3908         16  CP-IBNR-RESERVE-SW    PIC X.
  3909         16  CP-CLAIM-STATUS       PIC X.
  3910         16  CP-RATE-FILE          PIC X.
  3911         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3912                                     COMP-3.
  3913
  3914         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3915         16  CP-AH-OVERRIDE-CODE   PIC X.
  3916
  3917         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3918                                     COMP-3.
  3919         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3920                                   PIC S9(5)V99 COMP-3.
  3921         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3922                                     COMP-3.
  3923         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3924                                     COMP-3.
  3925         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3926                                     COMP-3.
  3927         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3928                                  PIC S9(7)V99 COMP-3.
  3929
  3930         16  CP-PAID-FROM-DATE     PIC X(02).
  3931         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3932         16  CP-EXT-DAYS-CALC      PIC X.
  3933           88  CP-EXT-NO-CHG                   VALUE ' '.
  3934           88  CP-EXT-CHG-LF                   VALUE '1'.
  3935           88  CP-EXT-CHG-AH                   VALUE '2'.
  3936           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3937         16  CP-DOMICILE-STATE     PIC XX.
  3938         16  CP-CARRIER            PIC X.
  3939         16  CP-REIN-FLAG          PIC X.
  3940         16  CP-REM-TRM-CALC-OPTION PIC X.
  3941           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3942                      '2' '3' '4' '5'.
  3943           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3944           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3945           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3946           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3947           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3948           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3949           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3950           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3951         16  CP-SIG-SWITCH         PIC X.
  3952         16  CP-RATING-METHOD      PIC X.
  3953           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3954           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3955           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3956           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3957           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  70
* SOCK03.cbl
  3958           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3959           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3960           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3961           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3962         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3963                                     COMP-3.
  3964         16  CP-BEN-CATEGORY       PIC X.
  3965         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3966         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3967                                   PIC S99V9(5) COMP-3.
  3968         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3969         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3970                                   PIC S99V9(5) COMP-3.
  3971         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3972         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3973         16  CP-EXPIRE-DT          PIC XX.
  3974         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3975         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3976         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3977         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3978         16  CP-DDF-SPEC-CALC      PIC X.
  3979             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3980             88  CP-CALC-CLP              VALUE 'C'.
  3981         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3982         16  CP-CANCEL-REASON      PIC X.
  3983         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3984         16  CP-PMT-MODE           PIC X.
  3985         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3986         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3987         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3988         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3989         16  FILLER                PIC X.
  3990
  3991***************    OUTPUT FROM ELRESV   ************************
  3992
  3993         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3994
  3995         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3996                                     COMP-3.
  3997         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3998                                     COMP-3.
  3999         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  4000                                     COMP-3.
  4001         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  4002                                     COMP-3.
  4003         16  FILLER                PIC X(09).
  4004***************    OUTPUT FROM ELRTRM   *************************
  4005
  4006         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  4007                                     COMP-3.
  4008         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  4009                                     COMP-3.
  4010         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  4011                                     COMP-3.
  4012         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  4013                                     COMP-3.
  4014         16  FILLER                PIC X(12).
  4015
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  71
* SOCK03.cbl
  4016***************    OUTPUT FROM ELRAMT   *************************
  4017
  4018         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  4019                                     COMP-3.
  4020         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  4021                                     COMP-3.
  4022         16  FILLER                PIC X(12).
  4023
  4024***************    OUTPUT FROM ELRATE   *************************
  4025
  4026         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  4027                                     COMP-3.
  4028         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  4029                                     COMP-3.
  4030         16  CP-MORTALITY-CODE     PIC X(4).
  4031         16  CP-RATE-EDIT-FLAG     PIC X.
  4032             88  CP-RATES-NEED-APR                  VALUE '1'.
  4033         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  4034                                     COMP-3.
  4035         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  4036         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  4037         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  4038                                   PIC S9(7)V99 COMP-3.
  4039         16  FILLER                PIC X(07).
  4040
  4041***************    OUTPUT FROM ELRFND   *************************
  4042
  4043         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  4044                                     COMP-3.
  4045         16  CP-REFUND-TYPE-USED   PIC X.
  4046           88  CP-R-AS-R78                         VALUE '1'.
  4047           88  CP-R-AS-PRORATA                     VALUE '2'.
  4048           88  CP-R-AS-CALIF                       VALUE '3'.
  4049           88  CP-R-AS-TEXAS                       VALUE '4'.
  4050           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  4051           88  CP-R-AS-NET-PAY                     VALUE '5'.
  4052           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  4053           88  CP-R-AS-MEAN                        VALUE '8'.
  4054           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  4055           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4056           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  4057           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4058           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4059           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4060         16  FILLER                PIC X(12).
  4061
  4062***************    OUTPUT FROM ELEARN   *************************
  4063
  4064         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  4065                                     COMP-3.
  4066         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  4067                                     COMP-3.
  4068         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  4069                                     COMP-3.
  4070         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  4071                                     COMP-3.
  4072         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  4073                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  72
* SOCK03.cbl
  4074         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  4075                                     COMP-3.
  4076         16  CP-EARNING-TYPE-USED  PIC X.
  4077           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  4078           88  CP-E-AS-R78                         VALUE '1'.
  4079           88  CP-E-AS-PRORATA                     VALUE '2'.
  4080           88  CP-E-AS-TEXAS                       VALUE '4'.
  4081           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  4082           88  CP-E-AS-NET-PAY                     VALUE '5'.
  4083           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  4084           88  CP-E-AS-MEAN                        VALUE '8'.
  4085           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4086         16  FILLER                PIC X(12).
  4087
  4088***************    OUTPUT FROM ELPMNT   *************************
  4089
  4090         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4091                                     COMP-3.
  4092         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4093                                     COMP-3.
  4094         16  FILLER                PIC X(12).
  4095
  4096***************   MISC WORK AREAS    *****************************
  4097         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4098                                     COMP-3.
  4099         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4100                                     COMP-3.
  4101         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4102                                     COMP-3.
  4103         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4104                                     COMP-3.
  4105         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4106                                     COMP-3.
  4107         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4108                                     COMP-3.
  4109         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4110             88  OPEN-RATE-FILE                   VALUE 'O'.
  4111             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4112             88  IO-ERROR                         VALUE 'E'.
  4113
  4114         16  CP-FIRST-PAY-DATE     PIC XX.
  4115
  4116         16  CP-JOINT-INDICATOR    PIC X.
  4117
  4118         16  CP-RESERVE-REMAINING-TERM
  4119                                   PIC S9(4)V9    VALUE ZERO
  4120                                     COMP-3.
  4121
  4122         16  CP-INSURED-BIRTH-DT   PIC XX.
  4123
  4124         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4125                                     COMP-3.
  4126
  4127         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4128                                     COMP-3.
  4129
  4130         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4131                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  73
* SOCK03.cbl
  4132
  4133         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4134                                     COMP-3.
  4135
  4136         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4137                                     COMP-3.
  4138
  4139         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4140                                     COMP-3.
  4141
  4142         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4143                                     COMP-3.
  4144
  4145         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4146             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4147
  4148         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4149                                     COMP-3.
  4150         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4151                                     COMP-3.
  4152         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4153         16  cp-extra-periods      pic 9 value zeros.
  4154         16  cp-net-only-state     pic x value spaces.
  4155         16  FILLER                PIC X(13).
  4156******************************************************************
  4157****************************************************************
  4158*
  4159* Copyright (c) 2007-2013 Dell Inc.
  4160* All rights reserved.
  4161*
  4162****************************************************************
  4163 01  DFHEIV.
  4164   02  DFHEIV0               PIC X(35).
  4165   02  DFHEIV1               PIC X(08).
  4166   02  DFHEIV2               PIC X(08).
  4167   02  DFHEIV3               PIC X(08).
  4168   02  DFHEIV4               PIC X(06).
  4169   02  DFHEIV5               PIC X(04).
  4170   02  DFHEIV6               PIC X(04).
  4171   02  DFHEIV7               PIC X(02).
  4172   02  DFHEIV8               PIC X(02).
  4173   02  DFHEIV9               PIC X(01).
  4174   02  DFHEIV10              PIC S9(7) COMP-3.
  4175   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4176   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4177   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4178   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4179   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4180   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4181   02  DFHEIV17              PIC X(04).
  4182   02  DFHEIV18              PIC X(04).
  4183   02  DFHEIV19              PIC X(04).
  4184   02  DFHEIV20              USAGE IS POINTER.
  4185   02  DFHEIV21              USAGE IS POINTER.
  4186   02  DFHEIV22              USAGE IS POINTER.
  4187   02  DFHEIV23              USAGE IS POINTER.
  4188   02  DFHEIV24              USAGE IS POINTER.
  4189   02  DFHEIV25              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  74
* SOCK03.cbl
  4190   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4191   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4192   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4193   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4194   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4195   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4196   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4197   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4198   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4199   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4200   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4201   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4202   02  FILLER                PIC X(02).
  4203   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4204   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4205   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4206   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4207   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4208   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4209   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4210 LINKAGE  SECTION.
  4211*****************************************************************
  4212*                                                               *
  4213* Copyright (c) 2007-2013 Dell Inc.                             *
  4214* All rights reserved.                                          *
  4215*                                                               *
  4216*****************************************************************
  4217 01  dfheiblk.
  4218     02  eibtime          pic s9(7) comp-3.
  4219     02  eibdate          pic s9(7) comp-3.
  4220     02  eibtrnid         pic x(4).
  4221     02  eibtaskn         pic s9(7) comp-3.
  4222     02  eibtrmid         pic x(4).
  4223     02  dfheigdi         pic s9(4) comp.
  4224     02  eibcposn         pic s9(4) comp.
  4225     02  eibcalen         pic s9(4) comp.
  4226     02  eibaid           pic x(1).
  4227     02  eibfiller1       pic x(1).
  4228     02  eibfn            pic x(2).
  4229     02  eibfiller2       pic x(2).
  4230     02  eibrcode         pic x(6).
  4231     02  eibfiller3       pic x(2).
  4232     02  eibds            pic x(8).
  4233     02  eibreqid         pic x(8).
  4234     02  eibrsrce         pic x(8).
  4235     02  eibsync          pic x(1).
  4236     02  eibfree          pic x(1).
  4237     02  eibrecv          pic x(1).
  4238     02  eibsend          pic x(1).
  4239     02  eibatt           pic x(1).
  4240     02  eibeoc           pic x(1).
  4241     02  eibfmh           pic x(1).
  4242     02  eibcompl         pic x(1).
  4243     02  eibsig           pic x(1).
  4244     02  eibconf          pic x(1).
  4245     02  eiberr           pic x(1).
  4246     02  eibrldbk         pic x(1).
  4247     02  eiberrcd         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  75
* SOCK03.cbl
  4248     02  eibsynrb         pic x(1).
  4249     02  eibnodat         pic x(1).
  4250     02  eibfiller5       pic x(2).
  4251     02  eibresp          pic s9(8) comp.
  4252     02  eibresp2         pic s9(8) comp.
  4253     02  dfheigdj         pic s9(4) comp.
  4254     02  dfheigdk         pic s9(4) comp.
  4255 01  DFHCOMMAREA.
  4256   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  4257   05 LSTN-NAME                PIC X(8).
  4258   05 LSTN-SUBNAME             PIC X(8).
  4259   05 CLIENT-IN-DATA.
  4260      15  CLIENT-CAR           PIC X.
  4261      15  CLIENT-GRP           PIC X(6).
  4262      15  CLIENT-STATE         PIC XX.
  4263      15  CLIENT-ACCOUNT       PIC X(10).
  4264*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  4265      15  CLIENT-EFF-DT        PIC X(8).
  4266      15  CLIENT-CERT-NO       PIC X(11).
  4267      15  CLIENT-LAST-NAME     PIC X(15).
  4268      15  CLIENT-FIRST-NAME    PIC X(10).
  4269      15  CLIENT-VAL-DT        PIC X(8).
  4270      15  CLIENT-CAN-REASON    PIC X.
  4271   05 SOCKADDR-IN-PARM.
  4272     15 SIN-FAMILY             PIC 9(4) COMP.
  4273     15 SIN-PORT               PIC 9(4) COMP.
  4274     15 SIN-ADDRESS            PIC 9(8) COMP.
  4275     15 SIN-ZERO               PIC X(8).
  4276 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4277 0000-DFHEXIT SECTION.
  4278     MOVE '9#                    $   ' TO DFHEIV0.
  4279     MOVE 'SOCK03' TO DFHEIV1.
  4280     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4281     display '  BEGIN SOCK03 '
  4282     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  4283     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  4284     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  4285        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  4286        evaluate true
  4287           when client-in-data (8:3) = 'AHL'
  4288              MOVE X'06'         TO WS-COMP-CD
  4289              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  4290                                    WS-COMP-ID
  4291           when CLIENT-IN-DATA (8:3) = 'DCC'
  4292              MOVE X'05'         TO WS-COMP-CD
  4293              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  4294                                    WS-COMP-ID
  4295           when CLIENT-IN-DATA (8:3) = 'VPP'
  4296              MOVE X'07'         TO WS-COMP-CD
  4297              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  4298                                    WS-COMP-ID
  4299           when other
  4300              MOVE X'04'         TO WS-COMP-CD
  4301              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  4302                                    WS-COMP-ID
  4303        end-evaluate
  4304        move 'CSO'               to ws-send-buf (1:3)
  4305        move +25                 to ws-send-msg-size
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  76
* SOCK03.cbl
  4306     END-IF
  4307     display 'SOCK03:sequence number  =', ws-seq-num.
  4308     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  4309     call "send" using by value GIVE-TAKE-SOCKET,
  4310         by reference ws-send-buf,
  4311         by value ws-send-msg-size,
  4312         by value ws-flags.
  4313     if return-code <= zero
  4314         display 'SOCK03:send error ',
  4315         go to socket-error.
  4316     move low-values to ws-recv-buf.
  4317     set ws-recv-total to zero.
  4318     compute ws-recv-left = ws-recv-msg-size.
  4319     display 'SOCK03:About to recv '
  4320     call "recv" using by value GIVE-TAKE-SOCKET,
  4321         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4322         by value ws-recv-left,
  4323         by value ws-flags.
  4324     if return-code < zero
  4325        display 'SOCK03:recv error ',
  4326        go to socket-error.
  4327     if return-code = zero
  4328        display 'SOCK03:client disconnected',
  4329        go to socket-error.
  4330*
  4331     display 'SOCK03:Good recv  '
  4332     display 'SOCK03:return code      = ', return-code
  4333     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  4334     move +4096                  to ws-send-msg-size
  4335*    move +750                   to ws-send-msg-size
  4336     move ws-recv-buf (1:72)     to client-in-data
  4337     MOVE SPACES                 TO WS-ELCERT-SW
  4338     MOVE X'0A'                  TO WS-HEX-0A
  4339     if client-account = 'EPIQ000001'
  4340        set ws-epiq-request to true
  4341        move spaces              to client-account
  4342     end-if
  4343     move +0 to ws-epiq-max
  4344     EVALUATE TRUE
  4345        WHEN (CLIENT-CAR NOT = SPACES)
  4346           AND (CLIENT-STATE NOT = SPACES)
  4347           AND (CLIENT-ACCOUNT NOT = SPACES)
  4348           AND (CLIENT-EFF-DT NOT = SPACES)
  4349           AND (CLIENT-CERT-NO NOT = SPACES)
  4350           SET WS-ELCERT-FULL    TO TRUE
  4351           DISPLAY ' SETTING FULL '
  4352        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4353           SET WS-ELCERT-CERT-NO TO TRUE
  4354           DISPLAY ' SETTING CERT NO '
  4355*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4356*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4357        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4358           AND (CLIENT-LAST-NAME NOT = SPACES)
  4359           SET WS-ELCERT-ACT-NAME TO TRUE
  4360        WHEN CLIENT-LAST-NAME NOT = SPACES
  4361           SET WS-ELCERT-NAME    TO TRUE
  4362           DISPLAY ' SETTING NAME '
  4363        WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  77
* SOCK03.cbl
  4364           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4365           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4366           MOVE ZEROS            TO WS-RESP
  4367           PERFORM 0030-BUILD-BUFFER
  4368                                 THRU 0030-EXIT
  4369           PERFORM 0020-SEND-BUFFER
  4370                                 THRU 0020-EXIT
  4371           PERFORM 0025-CLOSE-SOCKET
  4372                                 THRU 0025-EXIT
  4373           GO TO 0010-RETURN
  4374     END-EVALUATE
  4375     IF CLIENT-CAN-REASON = 'R'
  4376        MOVE 'R'                 TO WS-CANCEL-REASON
  4377     ELSE
  4378        MOVE ' '                 TO WS-CANCEL-REASON
  4379     END-IF
  4380     IF WS-ELCERT-KEY-SW NOT = SPACES
  4381        PERFORM 0050-BEGIN-REFUND-PROCESS
  4382                                 THRU 0050-EXIT
  4383     END-IF
  4384     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4385     .
  4386 0010-RETURN.
  4387
  4388* exec cics return end-exec.
  4389*    MOVE '.(                    ''   #00004383' TO DFHEIV0
  4390     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4391     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4392     MOVE X'2020233030303034333833' TO DFHEIV0(25:11)
  4393     CALL 'kxdfhei1' USING DFHEIV0,
  4394           DFHEIV99,
  4395           DFHEIV99,
  4396           DFHEIV99,
  4397           DFHEIV99,
  4398           DFHEIV99,
  4399           DFHEIV99
  4400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4401
  4402
  4403* goback.
  4404     MOVE '9%                    "   ' TO DFHEIV0
  4405     MOVE 'SOCK03' TO DFHEIV1
  4406     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4407     goback.
  4408*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4409     .
  4410 0020-SEND-BUFFER.
  4411     display 'SOCK03:About to send      '
  4412     display 'SOCK03:sequence number  =', ws-seq-num.
  4413     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  4414     call "send" using by value GIVE-TAKE-SOCKET,
  4415         by reference ws-send-buf,
  4416         by value ws-send-msg-size,
  4417         by value ws-flags.
  4418     if return-code <= zero
  4419         display 'SOCK03:send error ' return-code,
  4420         go to socket-error.
  4421 0020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  78
* SOCK03.cbl
  4422     EXIT.
  4423 0025-CLOSE-SOCKET.
  4424*    display 'SOCK03:closing socket'.
  4425*    call "close" using by value GIVE-TAKE-SOCKET .
  4426     display 'SOCK03:done'.
  4427     .
  4428 0025-EXIT.
  4429     EXIT.
  4430*
  4431* set up the receive buffer
  4432*
  4433     move low-values to ws-recv-buf.
  4434     set ws-recv-total to zero.
  4435     compute ws-recv-left = ws-recv-msg-size.
  4436*
  4437* receive data
  4438*
  4439 recv-1.
  4440     call "recv" using by value GIVE-TAKE-SOCKET,
  4441         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4442         by value ws-recv-left,
  4443         by value ws-flags.
  4444*
  4445* test what was received and decide what we should do
  4446*
  4447     if return-code < zero
  4448        display 'SOCK03:recv error ',
  4449        go to socket-error.
  4450     if return-code = zero
  4451        display 'SOCK03:client disconnected',
  4452        go to socket-error.
  4453*
  4454* have we received all the data yet?
  4455*
  4456     compute ws-recv-total = ws-recv-total + return-code.
  4457     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4458*
  4459* not yet
  4460*
  4461     if ws-recv-left > 0 go to recv-1.
  4462*
  4463* received all the data
  4464*
  4465     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4466*
  4467* make sure what we received was what we sent
  4468*
  4469*    if ws-recv-buf <> ws-send-buf
  4470*        display "SOCK03:data doesn't match",
  4471*        go to socket-error.
  4472*
  4473* end of pass
  4474*
  4475*loop-end.
  4476*    if ws-seq-num = 5 go to socket-error.
  4477*    go to loop-1.
  4478*
  4479* program end
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  79
* SOCK03.cbl
  4480*
  4481 socket-error.
  4482     if ws-seq-num <> 0
  4483         display "SOCK03:did not complete".
  4484*
  4485* flush the send buffer and deallocate
  4486*
  4487*    display 'SOCK03:closing socket'.
  4488*    call "close" using by value GIVE-TAKE-SOCKET .
  4489*
  4490* finised return to cics
  4491*
  4492 socket-fin.
  4493*    display 'SOCK03:closing socket'.
  4494*    call "close" using by value GIVE-TAKE-SOCKET .
  4495     display 'SOCK03:done'.
  4496
  4497* exec cics return end-exec.
  4498*    MOVE '.(                    ''   #00004473' TO DFHEIV0
  4499     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4501     MOVE X'2020233030303034343733' TO DFHEIV0(25:11)
  4502     CALL 'kxdfhei1' USING DFHEIV0,
  4503           DFHEIV99,
  4504           DFHEIV99,
  4505           DFHEIV99,
  4506           DFHEIV99,
  4507           DFHEIV99,
  4508           DFHEIV99
  4509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4510
  4511
  4512* goback.
  4513     MOVE '9%                    "   ' TO DFHEIV0
  4514     MOVE 'SOCK03' TO DFHEIV1
  4515     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4516     goback.
  4517 0030-BUILD-BUFFER.
  4518     MOVE SPACES                 TO WS-SEND-BUF
  4519     IF WS-CALL-TYPE = 'NEWBUS'
  4520        STRING
  4521           WS-COMMENT            ';'
  4522           WS-RESP               ';'
  4523           WS-CARRIER            ';'
  4524           WS-GROUPING           ';'
  4525           WS-STATE              ';'
  4526           WS-ACCOUNT            ';'
  4527           WS-CERT-EFF-DATE      ';'
  4528           WS-CERT-NO            ';'
  4529           WS-LAST-NAME          ';'
  4530           WS-FIRST-NAME         ';'
  4531           WS-MID-INIT           ';'
  4532           WS-LAST-JNAME         ';'
  4533           WS-FIRST-JNAME        ';'
  4534           WS-MID-JINIT          ';'
  4535           WS-POST-CARD-SW       ';'
  4536           ws-lf-coverage-type   ';'
  4537           WS-LF-STATUS          ';'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  80
* SOCK03.cbl
  4538           WS-LF-BEN-CODE        ';'
  4539           WS-LF-BEN-CODE-DESC   ';'
  4540           WS-LF-TERM            ';'
  4541           WS-LF-REM-TERM        ';'
  4542           WS-LF-PREM            ';'
  4543           WS-LF-REFUND          ';'
  4544           WS-LF-METHOD          ';'
  4545           WS-LF-ORIG-BENEFIT    ';'
  4546           WS-LF-REM-BEN         ';'
  4547           WS-LF-EXPIRE-DATE     ';'
  4548           WS-LF-COMM            ';'
  4549           WS-LF-UEC             ';'
  4550           WS-AH-COVERAGE-TYPE   ';'
  4551           WS-AH-STATUS          ';'
  4552           WS-AH-BEN-CODE        ';'
  4553           WS-AH-BEN-CODE-DESC   ';'
  4554           WS-AH-TERM            ';'
  4555           WS-AH-REM-TERM        ';'
  4556           WS-AH-PREM            ';'
  4557           WS-AH-REFUND          ';'
  4558           WS-AH-METHOD          ';'
  4559           WS-AH-ORIG-BENEFIT    ';'
  4560           WS-AH-REM-BEN         ';'
  4561           WS-AH-EXPIRE-DATE     ';'
  4562           WS-AH-COMM            ';'
  4563           WS-AH-UEC             ';'
  4564           WS-ACCOUNT-NAME       ';'
  4565           WS-REPORT-CODE-1      ';'
  4566           WS-REPORT-CODE-2      ';'
  4567           WS-REPORT-CODE-3      ';'
  4568           WS-CLM-PAID-THRU-DT   ';'
  4569           WS-LF-CANCEL-DATE     ';'
  4570           WS-AH-CANCEL-DATE     ';'
  4571           WS-VIN                ';'
  4572           WS-CRED-BENE-NAME     ';'
  4573           WS-HEX-0A
  4574            DELIMITED BY '  ' INTO WS-SEND-BUF
  4575        END-STRING
  4576     ELSE
  4577        STRING
  4578           WS-COMMENT            ';'  *> 0
  4579           WS-RESP               ';'
  4580           WS-CARRIER            ';'
  4581           WS-GROUPING           ';'
  4582           WS-STATE              ';'
  4583           WS-ACCOUNT            ';'
  4584           WS-CERT-EFF-DATE      ';'
  4585           WS-CERT-NO            ';'
  4586           WS-LAST-NAME          ';'
  4587           WS-FIRST-NAME         ';'
  4588           WS-MID-INIT           ';'
  4589           WS-LAST-JNAME         ';'
  4590           WS-FIRST-JNAME        ';'
  4591           WS-MID-JINIT          ';'
  4592           WS-POST-CARD-SW       ';'
  4593           WS-LF-STATUS          ';'
  4594           WS-LF-BEN-CODE        ';'  *> 16
  4595           WS-LF-BEN-CODE-DESC   ';'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  81
* SOCK03.cbl
  4596           WS-LF-TERM            ';'
  4597           WS-LF-REM-TERM        ';'
  4598           WS-LF-PREM            ';'
  4599           WS-LF-REFUND          ';'
  4600           WS-LF-METHOD          ';'
  4601           WS-LF-ORIG-BENEFIT    ';'
  4602           WS-LF-REM-BEN         ';'
  4603           WS-LF-EXPIRE-DATE     ';'
  4604           WS-LF-COMM            ';'
  4605           WS-LF-UEC             ';'
  4606           WS-AH-STATUS          ';'
  4607           WS-AH-BEN-CODE        ';'   *> 29
  4608           WS-AH-BEN-CODE-DESC   ';'
  4609           WS-AH-TERM            ';'
  4610           WS-AH-REM-TERM        ';'
  4611           WS-AH-PREM            ';'   *> 32
  4612           WS-AH-REFUND          ';'   *> 33
  4613           WS-AH-METHOD          ';'
  4614           WS-AH-ORIG-BENEFIT    ';'   *> 36
  4615           WS-AH-REM-BEN         ';'
  4616           WS-AH-EXPIRE-DATE     ';'
  4617           WS-AH-COMM            ';'
  4618           WS-AH-UEC             ';'
  4619           WS-ACCOUNT-NAME       ';'
  4620           WS-REPORT-CODE-1      ';'
  4621           WS-REPORT-CODE-2      ';'
  4622           WS-REPORT-CODE-3      ';'
  4623           WS-CLM-PAID-THRU-DT   ';'
  4624           WS-LF-CANCEL-DATE     ';'
  4625           WS-AH-CANCEL-DATE     ';'
  4626           WS-VIN                ';'
  4627           WS-CRED-BENE-NAME     ';'
  4628           'E'                   ';'
  4629            DELIMITED BY '  ' INTO WS-SEND-BUF
  4630        END-STRING
  4631     END-IF
  4632     .
  4633 0030-EXIT.
  4634     EXIT.
  4635 0050-BEGIN-REFUND-PROCESS.
  4636     IF WS-ELCERT-ACT-NAME
  4637        PERFORM 0060-FIND-FULL-KEY
  4638                                 THRU 0060-EXIT
  4639        MOVE AM-CARRIER          TO CLIENT-CAR
  4640        MOVE AM-GROUPING         TO CLIENT-GRP
  4641        MOVE AM-STATE            TO CLIENT-STATE
  4642     END-IF
  4643     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4644     IF NOT RESP-NORMAL
  4645        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4646        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4647        MOVE WS-RESPONSE         TO WS-RESP
  4648        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4649        PERFORM 0020-SEND-BUFFER
  4650                                 THRU 0020-EXIT
  4651        PERFORM 0025-CLOSE-SOCKET
  4652                                 THRU 0025-EXIT
  4653        GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  82
* SOCK03.cbl
  4654     END-IF
  4655     PERFORM 0150-READ-NEXT-ELCERT
  4656                                 THRU 0150-EXIT
  4657*    display ' came back from 0150 ' ws-response
  4658     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4659        DISPLAY ' CERT NOT FOUND '
  4660        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4661        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4662        MOVE WS-RESPONSE         TO WS-RESP
  4663        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4664        PERFORM 0020-SEND-BUFFER
  4665                                 THRU 0020-EXIT
  4666        PERFORM 0025-CLOSE-SOCKET
  4667                                 THRU 0025-EXIT
  4668        GO TO 0010-RETURN
  4669     END-IF
  4670     PERFORM 0200-BEGIN-REFUND-PROCESS
  4671                                 THRU 0200-EXIT UNTIL
  4672        ELCERT-FINISHED
  4673     .
  4674 0050-EXIT.
  4675     EXIT.
  4676 0060-FIND-FULL-KEY.
  4677     MOVE ' ' TO WS-STOP-SW
  4678     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4679     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4680
  4681* EXEC CICS STARTBR
  4682*       DATASET  ('ERACCT3')
  4683*       RIDFLD   (WS-AM3-KEY)
  4684*       GTEQ
  4685*       RESP (WS-RESPONSE)
  4686*    END-EXEC
  4687     MOVE 'ERACCT3' TO DFHEIV1
  4688     MOVE 0
  4689       TO DFHEIV11
  4690*    MOVE '&,         G          &  N#00004638' TO DFHEIV0
  4691     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4692     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4693     MOVE X'204E233030303034363338' TO DFHEIV0(25:11)
  4694     CALL 'kxdfhei1' USING DFHEIV0,
  4695           DFHEIV1,
  4696           WS-AM3-KEY,
  4697           DFHEIV99,
  4698           DFHEIV11,
  4699           DFHEIV99
  4700     MOVE EIBRESP  TO WS-RESPONSE
  4701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4702     IF RESP-NORMAL
  4703        PERFORM UNTIL TOLD-TO-STOP
  4704
  4705* EXEC CICS READNEXT
  4706*             DATASET  ('ERACCT3')
  4707*             INTO     (ACCOUNT-MASTER)
  4708*             RIDFLD   (WS-AM3-KEY)
  4709*          END-EXEC
  4710     MOVE LENGTH OF
  4711      ACCOUNT-MASTER
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  83
* SOCK03.cbl
  4712       TO DFHEIV12
  4713     MOVE 'ERACCT3' TO DFHEIV1
  4714     MOVE 0
  4715       TO DFHEIV11
  4716*    MOVE '&.IL                  )   #00004646' TO DFHEIV0
  4717     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4718     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4719     MOVE X'2020233030303034363436' TO DFHEIV0(25:11)
  4720     CALL 'kxdfhei1' USING DFHEIV0,
  4721           DFHEIV1,
  4722           ACCOUNT-MASTER,
  4723           DFHEIV12,
  4724           WS-AM3-KEY,
  4725           DFHEIV99,
  4726           DFHEIV11,
  4727           DFHEIV99,
  4728           DFHEIV99
  4729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4730           EVALUATE TRUE
  4731              WHEN (RESP-NORMAL)
  4732                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4733                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4734                 SET TOLD-TO-STOP TO TRUE
  4735              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4736                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4737                 CONTINUE
  4738              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4739                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4740                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4741                 MOVE ZEROS      TO WS-RESP
  4742                 PERFORM 0030-BUILD-BUFFER
  4743                                 THRU 0030-EXIT
  4744                 PERFORM 0020-SEND-BUFFER
  4745                                 THRU 0020-EXIT
  4746                 PERFORM 0025-CLOSE-SOCKET
  4747                                 THRU 0025-EXIT
  4748                 GO TO 0010-RETURN
  4749           END-EVALUATE
  4750        END-PERFORM
  4751
  4752* EXEC CICS ENDBR
  4753*          DATASET   ('ERACCT3')
  4754*       END-EXEC
  4755     MOVE 'ERACCT3' TO DFHEIV1
  4756     MOVE 0
  4757       TO DFHEIV11
  4758*    MOVE '&2                    $   #00004672' TO DFHEIV0
  4759     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4760     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4761     MOVE X'2020233030303034363732' TO DFHEIV0(25:11)
  4762     CALL 'kxdfhei1' USING DFHEIV0,
  4763           DFHEIV1,
  4764           DFHEIV11,
  4765           DFHEIV99
  4766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4767     ELSE
  4768        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4769        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  84
* SOCK03.cbl
  4770        MOVE ZEROS      TO WS-RESP
  4771        PERFORM 0030-BUILD-BUFFER
  4772                                 THRU 0030-EXIT
  4773        PERFORM 0020-SEND-BUFFER
  4774                                 THRU 0020-EXIT
  4775        PERFORM 0025-CLOSE-SOCKET
  4776                                 THRU 0025-EXIT
  4777        GO TO 0010-RETURN
  4778     END-IF
  4779     .
  4780 0060-EXIT.
  4781     EXIT.
  4782 0100-START-ELCERT.
  4783     MOVE SPACES                 TO WS-SEND-BUF
  4784     INITIALIZE WS-STRING-DATA
  4785     MOVE LOW-VALUES             TO WS-CM-KEY
  4786                                    WS-CM-KEY-A1
  4787                                    WS-CM-KEY-A4
  4788     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4789                                    WS-CM-COMPANY-CD-A1
  4790                                    WS-CM-COMPANY-CD-A4
  4791     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4792     MOVE 'L'                    TO DC-OPTION-CODE
  4793     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4794     IF NO-CONVERSION-ERROR
  4795        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4796     ELSE
  4797        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4798        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4799        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4800        PERFORM 0020-SEND-BUFFER
  4801                                 THRU 0020-EXIT
  4802        PERFORM 0025-CLOSE-SOCKET
  4803                                 THRU 0025-EXIT
  4804        GO TO 0010-RETURN
  4805     END-IF
  4806     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4807        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4808        MOVE 'L'                 TO DC-OPTION-CODE
  4809        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4810        IF NO-CONVERSION-ERROR
  4811           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4812        ELSE
  4813           MOVE 'BAD EFF DT CONVERT '
  4814                                 TO WS-COMMENT
  4815           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4816           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4817           PERFORM 0020-SEND-BUFFER
  4818                                 THRU 0020-EXIT
  4819           PERFORM 0025-CLOSE-SOCKET
  4820                                 THRU 0025-EXIT
  4821           GO TO 0010-RETURN
  4822        END-IF
  4823     END-IF
  4824     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4825        (F1 > +10)
  4826        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4827     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  85
* SOCK03.cbl
  4828     IF F1 > +1
  4829        SUBTRACT +1 FROM F1
  4830     END-IF
  4831     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4832        (L1 > +15)
  4833        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4834     END-PERFORM
  4835     IF L1 > +1
  4836        SUBTRACT +1 FROM L1
  4837     END-IF
  4838     EVALUATE TRUE
  4839        WHEN WS-ELCERT-FULL
  4840           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4841           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4842           MOVE CLIENT-STATE        TO WS-CM-STATE
  4843           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4844           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4845           MOVE CLIENT-CERT-NO (1:10)
  4846                                    TO WS-CM-CERT-NO
  4847
  4848* EXEC CICS READ
  4849*             INTO    (CERTIFICATE-MASTER)
  4850*             DATASET ('ELCERT')
  4851*             RIDFLD  (WS-CM-KEY)
  4852*             RESP    (WS-RESPONSE)
  4853*          END-EXEC
  4854     MOVE LENGTH OF
  4855      CERTIFICATE-MASTER
  4856       TO DFHEIV11
  4857     MOVE 'ELCERT' TO DFHEIV1
  4858*    MOVE '&"IL       E          (  N#00004756' TO DFHEIV0
  4859     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4861     MOVE X'204E233030303034373536' TO DFHEIV0(25:11)
  4862     CALL 'kxdfhei1' USING DFHEIV0,
  4863           DFHEIV1,
  4864           CERTIFICATE-MASTER,
  4865           DFHEIV11,
  4866           WS-CM-KEY,
  4867           DFHEIV99,
  4868           DFHEIV99,
  4869           DFHEIV99
  4870     MOVE EIBRESP  TO WS-RESPONSE
  4871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4872        WHEN WS-ELCERT-ACT-NAME
  4873           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4874           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4875           MOVE CLIENT-STATE        TO WS-CM-STATE
  4876           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4877           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4878           MOVE ZEROS               TO WS-CM-CERT-NO
  4879
  4880* EXEC CICS STARTBR
  4881*             DATASET ('ELCERT')
  4882*             RIDFLD  (WS-CM-KEY)
  4883*             RESP    (WS-RESPONSE)
  4884*          END-EXEC
  4885     MOVE 'ELCERT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  86
* SOCK03.cbl
  4886     MOVE 0
  4887       TO DFHEIV11
  4888*    MOVE '&,         G          &  N#00004769' TO DFHEIV0
  4889     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4890     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4891     MOVE X'204E233030303034373639' TO DFHEIV0(25:11)
  4892     CALL 'kxdfhei1' USING DFHEIV0,
  4893           DFHEIV1,
  4894           WS-CM-KEY,
  4895           DFHEIV99,
  4896           DFHEIV11,
  4897           DFHEIV99
  4898     MOVE EIBRESP  TO WS-RESPONSE
  4899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4900        WHEN WS-ELCERT-NAME
  4901           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4902           MOVE SPACES           TO WS-CM-INITIALS
  4903           COMPUTE WS-LENGTH = L1 + +1
  4904
  4905* EXEC CICS STARTBR
  4906*             DATASET   ('ELCERT2')
  4907*             RIDFLD    (WS-CM-KEY-A1)
  4908*             GENERIC
  4909*             KEYLENGTH (WS-LENGTH)
  4910*             GTEQ
  4911*             RESP      (WS-RESPONSE)
  4912*          END-EXEC
  4913     MOVE 'ELCERT2' TO DFHEIV1
  4914     MOVE 0
  4915       TO DFHEIV11
  4916*    MOVE '&,   KG    G          &  N#00004778' TO DFHEIV0
  4917     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4918     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4919     MOVE X'204E233030303034373738' TO DFHEIV0(25:11)
  4920     CALL 'kxdfhei1' USING DFHEIV0,
  4921           DFHEIV1,
  4922           WS-CM-KEY-A1,
  4923           WS-LENGTH,
  4924           DFHEIV11,
  4925           DFHEIV99
  4926     MOVE EIBRESP  TO WS-RESPONSE
  4927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4928*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4929*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4930        WHEN WS-ELCERT-CERT-NO
  4931* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4932           MOVE +11 TO WS-LENGTH
  4933           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4934
  4935* EXEC CICS STARTBR
  4936*             DATASET   ('ELCERT5')
  4937*             RIDFLD    (WS-CM-KEY-A4)
  4938*             GENERIC
  4939*             KEYLENGTH (WS-LENGTH)
  4940*             GTEQ
  4941*             RESP      (WS-RESPONSE)
  4942*          END-EXEC
  4943     MOVE 'ELCERT5' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  87
* SOCK03.cbl
  4944     MOVE 0
  4945       TO DFHEIV11
  4946*    MOVE '&,   KG    G          &  N#00004792' TO DFHEIV0
  4947     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4948     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4949     MOVE X'204E233030303034373932' TO DFHEIV0(25:11)
  4950     CALL 'kxdfhei1' USING DFHEIV0,
  4951           DFHEIV1,
  4952           WS-CM-KEY-A4,
  4953           WS-LENGTH,
  4954           DFHEIV11,
  4955           DFHEIV99
  4956     MOVE EIBRESP  TO WS-RESPONSE
  4957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4958     END-EVALUATE
  4959     .
  4960 0100-EXIT.
  4961     EXIT.
  4962 0150-READ-NEXT-ELCERT.
  4963     EVALUATE TRUE
  4964        WHEN WS-ELCERT-ACT-NAME
  4965*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4966
  4967* EXEC CICS READNEXT
  4968*             DATASET   ('ELCERT')
  4969*             RIDFLD    (WS-CM-KEY)
  4970*             INTO      (CERTIFICATE-MASTER)
  4971*             RESP      (WS-RESPONSE)
  4972*          END-EXEC
  4973     MOVE LENGTH OF
  4974      CERTIFICATE-MASTER
  4975       TO DFHEIV12
  4976     MOVE 'ELCERT' TO DFHEIV1
  4977     MOVE 0
  4978       TO DFHEIV11
  4979*    MOVE '&.IL                  )  N#00004809' TO DFHEIV0
  4980     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4981     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4982     MOVE X'204E233030303034383039' TO DFHEIV0(25:11)
  4983     CALL 'kxdfhei1' USING DFHEIV0,
  4984           DFHEIV1,
  4985           CERTIFICATE-MASTER,
  4986           DFHEIV12,
  4987           WS-CM-KEY,
  4988           DFHEIV99,
  4989           DFHEIV11,
  4990           DFHEIV99,
  4991           DFHEIV99
  4992     MOVE EIBRESP  TO WS-RESPONSE
  4993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4994        WHEN WS-ELCERT-NAME
  4995*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4996
  4997* EXEC CICS READNEXT
  4998*             DATASET   ('ELCERT2')
  4999*             RIDFLD    (WS-CM-KEY-A1)
  5000*             INTO      (CERTIFICATE-MASTER)
  5001*             RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  88
* SOCK03.cbl
  5002*          END-EXEC
  5003     MOVE LENGTH OF
  5004      CERTIFICATE-MASTER
  5005       TO DFHEIV12
  5006     MOVE 'ELCERT2' TO DFHEIV1
  5007     MOVE 0
  5008       TO DFHEIV11
  5009*    MOVE '&.IL                  )  N#00004817' TO DFHEIV0
  5010     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5011     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5012     MOVE X'204E233030303034383137' TO DFHEIV0(25:11)
  5013     CALL 'kxdfhei1' USING DFHEIV0,
  5014           DFHEIV1,
  5015           CERTIFICATE-MASTER,
  5016           DFHEIV12,
  5017           WS-CM-KEY-A1,
  5018           DFHEIV99,
  5019           DFHEIV11,
  5020           DFHEIV99,
  5021           DFHEIV99
  5022     MOVE EIBRESP  TO WS-RESPONSE
  5023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5024        WHEN WS-ELCERT-CERT-NO
  5025
  5026* EXEC CICS READNEXT
  5027*             DATASET   ('ELCERT5')
  5028*             RIDFLD    (WS-CM-KEY-A4)
  5029*             INTO      (CERTIFICATE-MASTER)
  5030*             RESP      (WS-RESPONSE)
  5031*          END-EXEC
  5032     MOVE LENGTH OF
  5033      CERTIFICATE-MASTER
  5034       TO DFHEIV12
  5035     MOVE 'ELCERT5' TO DFHEIV1
  5036     MOVE 0
  5037       TO DFHEIV11
  5038*    MOVE '&.IL                  )  N#00004824' TO DFHEIV0
  5039     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5040     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5041     MOVE X'204E233030303034383234' TO DFHEIV0(25:11)
  5042     CALL 'kxdfhei1' USING DFHEIV0,
  5043           DFHEIV1,
  5044           CERTIFICATE-MASTER,
  5045           DFHEIV12,
  5046           WS-CM-KEY-A4,
  5047           DFHEIV99,
  5048           DFHEIV11,
  5049           DFHEIV99,
  5050           DFHEIV99
  5051     MOVE EIBRESP  TO WS-RESPONSE
  5052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5053     END-EVALUATE
  5054     .
  5055 0150-EXIT.
  5056     EXIT.
  5057 0200-BEGIN-REFUND-PROCESS.
  5058     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5059                                    WS-ERACCT-SW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  89
* SOCK03.cbl
  5060     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  5061                                    WS-NCB-DIFF-ODD-DAYS
  5062     INITIALIZE WS-STRING-DATA
  5063     IF RESP-NORMAL OR RESP-DUPKEY
  5064        EVALUATE TRUE
  5065           WHEN WS-ELCERT-ACT-NAME
  5066              EVALUATE TRUE
  5067                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  5068                    OR (CM-CARRIER NOT = CLIENT-CAR)
  5069                    OR (CM-GROUPING NOT = CLIENT-GRP)
  5070                    OR (CM-STATE NOT = CLIENT-STATE)
  5071                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  5072                    SET ELCERT-FINISHED TO TRUE
  5073                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  5074                    CLIENT-LAST-NAME (1:L1))
  5075                    GO TO 0200-CONTINUE
  5076                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  5077                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5078                    GO TO 0200-CONTINUE
  5079                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  5080                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5081                     CLIENT-FIRST-NAME (1:F1)))
  5082                    GO TO 0200-CONTINUE
  5083                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  5084                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5085                    GO TO 0200-CONTINUE
  5086              END-EVALUATE
  5087           WHEN WS-ELCERT-CERT-NO
  5088              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5089                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  5090                 SET ELCERT-FINISHED TO TRUE
  5091              ELSE
  5092                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5093                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5094                              OR
  5095                    ((CLIENT-LAST-NAME NOT = SPACES)
  5096                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  5097                        CLIENT-LAST-NAME (1:L1)))
  5098                              OR
  5099                    ((CLIENT-FIRST-NAME NOT = SPACES)
  5100                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5101                        CLIENT-FIRST-NAME (1:F1)))
  5102                              OR
  5103                    ((CLIENT-ACCOUNT NOT = SPACES)
  5104                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5105                     GO TO 0200-CONTINUE
  5106                 END-IF
  5107              END-IF
  5108           WHEN WS-ELCERT-NAME
  5109              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5110                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  5111                    CLIENT-LAST-NAME (1:L1))
  5112                  SET ELCERT-FINISHED TO TRUE
  5113              ELSE
  5114                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5115                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5116                           OR
  5117                 ((CLIENT-FIRST-NAME NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  90
* SOCK03.cbl
  5118                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5119                     CLIENT-FIRST-NAME (1:F1)))
  5120                           OR
  5121                 ((CLIENT-ACCOUNT NOT = SPACES)
  5122                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5123                  GO TO 0200-CONTINUE
  5124                 END-IF
  5125              END-IF
  5126           WHEN OTHER
  5127              SET ELCERT-FINISHED   TO TRUE
  5128        END-EVALUATE
  5129     ELSE
  5130        SET ELCERT-FINISHED TO TRUE
  5131     END-IF
  5132*       IF WS-ELCERT-CERT-NO
  5133*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5134*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  5135*                          OR
  5136*                ((CLIENT-EFF-DT NOT = SPACES)
  5137*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5138*                          OR
  5139*                ((CLIENT-LAST-NAME NOT = SPACES)
  5140*                 AND (CM-INSURED-LAST-NAME NOT =
  5141*                    CLIENT-LAST-NAME))
  5142*                 SET ELCERT-FINISHED TO TRUE
  5143*          END-IF
  5144*          IF WS-ELCERT-NAME
  5145*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5146*                OR (CM-INSURED-LAST-NAME NOT =
  5147*                   CLIENT-LAST-NAME)
  5148*                            OR
  5149*                ((CLIENT-EFF-DT NOT = SPACES)
  5150*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5151*                 SET ELCERT-FINISHED TO TRUE
  5152*             END-IF
  5153*          ELSE
  5154*             SET ELCERT-FINISHED   TO TRUE
  5155*          END-IF
  5156     IF NOT WS-ELCERT-FULL
  5157        IF ELCERT-FINISHED
  5158           GO TO 0200-EXIT
  5159        END-IF
  5160     END-IF
  5161     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  5162        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  5163        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5164        PERFORM 0030-BUILD-BUFFER
  5165                                 THRU 0030-EXIT
  5166        PERFORM 0020-SEND-BUFFER
  5167                                 THRU 0020-EXIT
  5168        GO TO 0200-CONTINUE
  5169     END-IF
  5170     if (ws-epiq-request)
  5171        and (not EPIQ-CLASS)
  5172        go to 0200-continue
  5173     end-if
  5174
  5175     if ws-epiq-request
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  91
* SOCK03.cbl
  5176        add +1 to ws-epiq-max
  5177        if ws-epiq-max > +100
  5178           go to 0200-continue
  5179        end-if
  5180     end-if
  5181     PERFORM 0300-GET-ELCNTL-RECORDS
  5182                                 THRU 0300-EXIT
  5183     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  5184     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  5185     MOVE +0                     TO DC-ELAPSED-MONTHS
  5186                                    DC-ELAPSED-DAYS
  5187     MOVE '1'                    TO DC-OPTION-CODE
  5188     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5189     IF NO-CONVERSION-ERROR
  5190        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  5191        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  5192     END-IF
  5193     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  5194     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  5195     perform 0610-get-ermail     thru 0610-exit
  5196     perform 0620-get-elcrtt     thru 0620-exit
  5197     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  5198     IF NOT ALREADY-SENT
  5199        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  5200     END-IF
  5201     .
  5202 0200-CONTINUE.
  5203     PERFORM 0150-READ-NEXT-ELCERT
  5204                                 THRU 0150-EXIT
  5205     .
  5206 0200-EXIT.
  5207     EXIT.
  5208 0300-GET-ELCNTL-RECORDS.
  5209     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  5210     IF NOT RESP-NORMAL
  5211        MOVE ' COMPANY RECORD NOT FOUND '
  5212                                 TO WS-COMMENT
  5213        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5214        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5215        PERFORM 0020-SEND-BUFFER
  5216                                 THRU 0020-EXIT
  5217        PERFORM 0025-CLOSE-SOCKET
  5218                                 THRU 0025-EXIT
  5219        GO TO 0010-RETURN
  5220     END-IF
  5221     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  5222        PERFORM 0320-GET-LIFE-RECORD
  5223                                 THRU 0320-EXIT
  5224        IF NOT RESP-NORMAL
  5225           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  5226                                 TO WS-COMMENT
  5227           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5228           PERFORM 0030-BUILD-BUFFER
  5229                                 THRU 0030-EXIT
  5230           PERFORM 0020-SEND-BUFFER
  5231                                 THRU 0020-EXIT
  5232           PERFORM 0025-CLOSE-SOCKET
  5233                                 THRU 0025-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  92
* SOCK03.cbl
  5234           GO TO 0010-RETURN
  5235        END-IF
  5236     END-IF
  5237     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5238        PERFORM 0330-GET-AH-RECORD
  5239                                 THRU 0330-EXIT
  5240        IF NOT RESP-NORMAL
  5241           MOVE ' AH BENEFIT RECORD NOT FOUND '
  5242                                 TO WS-COMMENT
  5243           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5244           PERFORM 0030-BUILD-BUFFER
  5245                                 THRU 0030-EXIT
  5246           PERFORM 0020-SEND-BUFFER
  5247                                 THRU 0020-EXIT
  5248           PERFORM 0025-CLOSE-SOCKET
  5249                                 THRU 0025-EXIT
  5250           GO TO 0010-RETURN
  5251        END-IF
  5252     END-IF
  5253     PERFORM 0340-GET-STATE-RECORD
  5254                                 THRU 0340-EXIT
  5255     IF NOT RESP-NORMAL
  5256        MOVE ' STATE RECORD NOT FOUND '
  5257                                 TO WS-COMMENT
  5258        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5259        PERFORM 0030-BUILD-BUFFER
  5260                                 THRU 0030-EXIT
  5261        PERFORM 0020-SEND-BUFFER
  5262                                 THRU 0020-EXIT
  5263        PERFORM 0025-CLOSE-SOCKET
  5264                                 THRU 0025-EXIT
  5265        GO TO 0010-RETURN
  5266     END-IF
  5267     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  5268     IF NOT ERACCT-FOUND
  5269        MOVE ' ACCOUNT NOT FOUND '
  5270                                 TO WS-COMMENT
  5271        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5272        PERFORM 0030-BUILD-BUFFER
  5273                                 THRU 0030-EXIT
  5274        PERFORM 0020-SEND-BUFFER
  5275                                 THRU 0020-EXIT
  5276        PERFORM 0025-CLOSE-SOCKET
  5277                                 THRU 0025-EXIT
  5278        GO TO 0010-RETURN
  5279     ELSE
  5280        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  5281        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  5282        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  5283        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  5284     END-IF
  5285     .
  5286 0300-EXIT.
  5287     EXIT.
  5288 0310-GET-COMPANY.
  5289     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  5290     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  5291     MOVE SPACES                 TO  WS-CF-ACCESS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  93
* SOCK03.cbl
  5292     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  5293
  5294* EXEC CICS READ
  5295*       INTO    (CONTROL-FILE)
  5296*       DATASET ('ELCNTL')
  5297*       RIDFLD  (WS-CF-KEY)
  5298*       RESP    (WS-RESPONSE)
  5299*    END-EXEC
  5300     MOVE LENGTH OF
  5301      CONTROL-FILE
  5302       TO DFHEIV11
  5303     MOVE 'ELCNTL' TO DFHEIV1
  5304*    MOVE '&"IL       E          (  N#00005071' TO DFHEIV0
  5305     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5307     MOVE X'204E233030303035303731' TO DFHEIV0(25:11)
  5308     CALL 'kxdfhei1' USING DFHEIV0,
  5309           DFHEIV1,
  5310           CONTROL-FILE,
  5311           DFHEIV11,
  5312           WS-CF-KEY,
  5313           DFHEIV99,
  5314           DFHEIV99,
  5315           DFHEIV99
  5316     MOVE EIBRESP  TO WS-RESPONSE
  5317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5318     IF (RESP-NORMAL)
  5319        AND (CF-COMPANY-ID = WS-COMP-ID)
  5320        AND (CF-RECORD-TYPE = '1')
  5321        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  5322        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  5323        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  5324        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  5325        IF CF-DEFAULT-APR NUMERIC
  5326           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  5327        ELSE
  5328           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  5329        END-IF
  5330        IF CF-VALID-REM-TRM-OPTION
  5331           MOVE CF-REM-TRM-CALC-OPTION
  5332                                 TO WS-CF-REM-TRM-CALC-OPTION
  5333        ELSE
  5334           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  5335        END-IF
  5336     END-IF
  5337     .
  5338 0310-EXIT.
  5339     EXIT.
  5340 0320-GET-LIFE-RECORD.
  5341     MOVE '4'                    TO WS-CF-RECORD-TYPE
  5342     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5343                                    WS-LF-BEN-CODE
  5344     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5345
  5346* EXEC CICS READ
  5347*       INTO    (CONTROL-FILE)
  5348*       DATASET ('ELCNTL')
  5349*       RIDFLD  (WS-CF-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  94
* SOCK03.cbl
  5350*       GTEQ
  5351*       RESP    (WS-RESPONSE)
  5352*    END-EXEC
  5353     MOVE LENGTH OF
  5354      CONTROL-FILE
  5355       TO DFHEIV11
  5356     MOVE 'ELCNTL' TO DFHEIV1
  5357*    MOVE '&"IL       G          (  N#00005104' TO DFHEIV0
  5358     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5360     MOVE X'204E233030303035313034' TO DFHEIV0(25:11)
  5361     CALL 'kxdfhei1' USING DFHEIV0,
  5362           DFHEIV1,
  5363           CONTROL-FILE,
  5364           DFHEIV11,
  5365           WS-CF-KEY,
  5366           DFHEIV99,
  5367           DFHEIV99,
  5368           DFHEIV99
  5369     MOVE EIBRESP  TO WS-RESPONSE
  5370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5371     IF RESP-NORMAL
  5372        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5373        AND (CF-RECORD-TYPE = '4')
  5374        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5375           (S1 > +8)
  5376           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5377        END-PERFORM
  5378        IF S1 > +8
  5379           CONTINUE
  5380        ELSE
  5381           MOVE CF-BENEFIT-DESCRIP (S1)
  5382                                 TO WS-LF-BEN-CODE-DESC
  5383           MOVE CF-LF-COVERAGE-TYPE (S1)
  5384                                 TO WS-CF-LF-COVERAGE-TYPE
  5385           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5386              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5387           ELSE
  5388              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5389           END-IF
  5390           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5391               MOVE CF-CO-REM-TERM-CALC (S1)
  5392                                 TO WS-LF-CO-REM-TERM-CALC
  5393           END-IF
  5394           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5395               MOVE CF-CO-EARNINGS-CALC (S1)
  5396                                 TO WS-LF-CO-EARNINGS-CALC
  5397                                    WS-LF-CO-REFUND-CALC
  5398           END-IF
  5399           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5400               MOVE CF-SPECIAL-CALC-CD (S1)
  5401                                 TO WS-LF-SPECIAL-CALC-CD
  5402           END-IF
  5403           IF CF-CO-REFUND-CALC (S1) > '0'
  5404               MOVE CF-CO-REFUND-CALC (S1)
  5405                                 TO WS-LF-CO-REFUND-CALC
  5406        END-IF
  5407     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  95
* SOCK03.cbl
  5408     .
  5409 0320-EXIT.
  5410     EXIT.
  5411 0330-GET-AH-RECORD.
  5412     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5413     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5414     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5415
  5416* EXEC CICS READ
  5417*       INTO    (CONTROL-FILE)
  5418*       DATASET ('ELCNTL')
  5419*       RIDFLD  (WS-CF-KEY)
  5420*       GTEQ
  5421*       RESP    (WS-RESPONSE)
  5422*    END-EXEC
  5423     MOVE LENGTH OF
  5424      CONTROL-FILE
  5425       TO DFHEIV11
  5426     MOVE 'ELCNTL' TO DFHEIV1
  5427*    MOVE '&"IL       G          (  N#00005155' TO DFHEIV0
  5428     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5430     MOVE X'204E233030303035313535' TO DFHEIV0(25:11)
  5431     CALL 'kxdfhei1' USING DFHEIV0,
  5432           DFHEIV1,
  5433           CONTROL-FILE,
  5434           DFHEIV11,
  5435           WS-CF-KEY,
  5436           DFHEIV99,
  5437           DFHEIV99,
  5438           DFHEIV99
  5439     MOVE EIBRESP  TO WS-RESPONSE
  5440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5441     IF RESP-NORMAL
  5442        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5443        AND (CF-RECORD-TYPE = '5')
  5444        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5445           (S1 > +8)
  5446           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5447        END-PERFORM
  5448        IF S1 > +8
  5449           CONTINUE
  5450        ELSE
  5451           MOVE CF-BENEFIT-DESCRIP (S1)
  5452                                 TO WS-AH-BEN-CODE-DESC
  5453           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5454              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5455           ELSE
  5456              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5457           END-IF
  5458           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5459              MOVE CF-CO-REM-TERM-CALC (S1)
  5460                                 TO WS-AH-CO-REM-TERM-CALC
  5461           END-IF
  5462           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5463              MOVE CF-CO-EARNINGS-CALC (S1)
  5464                                 TO WS-AH-CO-EARNINGS-CALC
  5465                                    WS-AH-CO-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  96
* SOCK03.cbl
  5466           END-IF
  5467           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5468              MOVE CF-SPECIAL-CALC-CD (S1)
  5469                                 TO WS-AH-SPECIAL-CALC-CD
  5470           END-IF
  5471           IF CF-CO-REFUND-CALC (S1) > '0'
  5472              MOVE CF-CO-REFUND-CALC (S1)
  5473                                 TO WS-AH-CO-REFUND-CALC
  5474           END-IF
  5475           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5476              MOVE CF-BENEFIT-CATEGORY (S1)
  5477                                 TO WS-AH-BEN-CATEGORY
  5478           END-IF
  5479        END-IF
  5480     END-IF
  5481     .
  5482 0330-EXIT.
  5483     EXIT.
  5484 0340-GET-STATE-RECORD.
  5485     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5486     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5487     MOVE CM-STATE               TO WS-CF-ACCESS
  5488     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5489
  5490* EXEC CICS READ
  5491*       INTO    (CONTROL-FILE)
  5492*       DATASET ('ELCNTL')
  5493*       RIDFLD  (WS-CF-KEY)
  5494*       RESP    (WS-RESPONSE)
  5495*    END-EXEC
  5496     MOVE LENGTH OF
  5497      CONTROL-FILE
  5498       TO DFHEIV11
  5499     MOVE 'ELCNTL' TO DFHEIV1
  5500*    MOVE '&"IL       E          (  N#00005210' TO DFHEIV0
  5501     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5503     MOVE X'204E233030303035323130' TO DFHEIV0(25:11)
  5504     CALL 'kxdfhei1' USING DFHEIV0,
  5505           DFHEIV1,
  5506           CONTROL-FILE,
  5507           DFHEIV11,
  5508           WS-CF-KEY,
  5509           DFHEIV99,
  5510           DFHEIV99,
  5511           DFHEIV99
  5512     MOVE EIBRESP  TO WS-RESPONSE
  5513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5514     IF (RESP-NORMAL)
  5515        AND (CF-COMPANY-ID = WS-COMP-ID)
  5516        AND (CF-RECORD-TYPE = '3')
  5517        AND (CF-STATE-CODE = CM-STATE)
  5518        MOVE CF-ST-FREE-LOOK-PERIOD
  5519                                 TO WS-FREE-LOOK
  5520        MOVE CF-STATE-ABBREVIATION
  5521                                 TO WS-STATE-ABBREVIATION
  5522        MOVE CF-ST-FST-PMT-DAYS-CHG
  5523                                 TO  WS-STATE-EXT-DAYS-CHG
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  97
* SOCK03.cbl
  5524        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5525           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5526           IF CF-ST-RT-CALC NOT = SPACES
  5527              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5528           END-IF
  5529           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5530              IF CF-ST-RF-LR-CALC > '0'
  5531                 MOVE CF-ST-RF-LR-CALC
  5532                                 TO WS-LF-ST-REFUND-CALC
  5533              END-IF
  5534              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5535                 IF CF-ST-RF-LN-CALC > '0'
  5536                    MOVE CF-ST-RF-LN-CALC
  5537                                 TO WS-LF-ST-REFUND-CALC
  5538                 END-IF
  5539              END-IF
  5540           ELSE
  5541              IF CF-ST-RF-LL-CALC > '0'
  5542                 MOVE CF-ST-RF-LL-CALC
  5543                                 TO WS-LF-ST-REFUND-CALC
  5544              END-IF
  5545           END-IF
  5546           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5547              (S1 > 50)
  5548              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5549                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5550           END-PERFORM
  5551           IF S1 < +51
  5552              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5553                 MOVE CF-ST-REM-TERM-CALC (S1)
  5554                                 TO WS-LF-ST-REM-TERM-CALC
  5555              END-IF
  5556              IF CF-ST-REFUND-CALC (S1) > '0'
  5557                 MOVE CF-ST-REFUND-CALC (S1)
  5558                                 TO WS-LF-ST-REFUND-CALC
  5559              END-IF
  5560           END-IF
  5561        END-IF
  5562        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5563           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5564           IF CF-ST-RT-CALC NOT = SPACES
  5565              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5566           END-IF
  5567           IF CF-ST-RF-AH-CALC > '0'
  5568              MOVE CF-ST-RF-AH-CALC
  5569                                 TO WS-AH-ST-REFUND-CALC
  5570           END-IF
  5571           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5572              IF CF-ST-RF-CP-CALC > '0'
  5573                 MOVE CF-ST-RF-CP-CALC
  5574                                 TO WS-AH-ST-REFUND-CALC
  5575              END-IF
  5576           END-IF
  5577           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5578              (S1 > 50)
  5579              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5580                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5581           END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  98
* SOCK03.cbl
  5582           IF S1 < +51
  5583              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5584                 MOVE CF-ST-REM-TERM-CALC (S1)
  5585                                 TO WS-AH-ST-REM-TERM-CALC
  5586              END-IF
  5587              IF CF-ST-REFUND-CALC (S1) > '0'
  5588                 MOVE CF-ST-REFUND-CALC (S1)
  5589                                 TO WS-AH-ST-REFUND-CALC
  5590              END-IF
  5591           END-IF
  5592        END-IF
  5593     END-IF
  5594     .
  5595 0340-EXIT.
  5596     EXIT.
  5597 0350-GET-ERACCT.
  5598     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5599                                    WS-AM-EARN-METHOD-R
  5600                                    WS-AM-EARN-METHOD-A
  5601                                    WS-LF-AM-REM-TERM-CALC
  5602                                    WS-AH-AM-REM-TERM-CALC
  5603     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5604     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5605     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5606     MOVE CM-STATE               TO WS-AM-STATE
  5607     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5608     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5609     MOVE LOW-VALUES             TO WS-AM-FILLER
  5610     MOVE ' '                    TO WS-STOP-SW
  5611
  5612* EXEC CICS STARTBR
  5613*       DATASET  ('ERACCT')
  5614*       RIDFLD   (WS-AM-KEY)
  5615*       GTEQ
  5616*       RESP (WS-RESPONSE)
  5617*    END-EXEC
  5618     MOVE 'ERACCT' TO DFHEIV1
  5619     MOVE 0
  5620       TO DFHEIV11
  5621*    MOVE '&,         G          &  N#00005313' TO DFHEIV0
  5622     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5623     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5624     MOVE X'204E233030303035333133' TO DFHEIV0(25:11)
  5625     CALL 'kxdfhei1' USING DFHEIV0,
  5626           DFHEIV1,
  5627           WS-AM-KEY,
  5628           DFHEIV99,
  5629           DFHEIV11,
  5630           DFHEIV99
  5631     MOVE EIBRESP  TO WS-RESPONSE
  5632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5633     IF RESP-NORMAL
  5634        PERFORM UNTIL TOLD-TO-STOP
  5635
  5636* EXEC CICS READNEXT
  5637*             DATASET  ('ERACCT')
  5638*             INTO     (ACCOUNT-MASTER)
  5639*             RIDFLD   (WS-AM-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page  99
* SOCK03.cbl
  5640*          END-EXEC
  5641     MOVE LENGTH OF
  5642      ACCOUNT-MASTER
  5643       TO DFHEIV12
  5644     MOVE 'ERACCT' TO DFHEIV1
  5645     MOVE 0
  5646       TO DFHEIV11
  5647*    MOVE '&.IL                  )   #00005321' TO DFHEIV0
  5648     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5649     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5650     MOVE X'2020233030303035333231' TO DFHEIV0(25:11)
  5651     CALL 'kxdfhei1' USING DFHEIV0,
  5652           DFHEIV1,
  5653           ACCOUNT-MASTER,
  5654           DFHEIV12,
  5655           WS-AM-KEY,
  5656           DFHEIV99,
  5657           DFHEIV11,
  5658           DFHEIV99,
  5659           DFHEIV99
  5660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5661           IF RESP-NORMAL
  5662              EVALUATE TRUE
  5663                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5664                    CM-CONTROL-PRIMARY (1:20)
  5665                    SET TOLD-TO-STOP TO TRUE
  5666                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5667                    CM-CONTROL-PRIMARY (1:20))
  5668                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5669                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5670                    SET ERACCT-FOUND      TO TRUE
  5671                    SET TOLD-TO-STOP TO TRUE
  5672              END-EVALUATE
  5673           ELSE
  5674              SET TOLD-TO-STOP TO TRUE
  5675           END-IF
  5676        END-PERFORM
  5677
  5678* EXEC CICS ENDBR
  5679*          DATASET   ('ERACCT')
  5680*       END-EXEC
  5681     MOVE 'ERACCT' TO DFHEIV1
  5682     MOVE 0
  5683       TO DFHEIV11
  5684*    MOVE '&2                    $   #00005342' TO DFHEIV0
  5685     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5686     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5687     MOVE X'2020233030303035333432' TO DFHEIV0(25:11)
  5688     CALL 'kxdfhei1' USING DFHEIV0,
  5689           DFHEIV1,
  5690           DFHEIV11,
  5691           DFHEIV99
  5692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5693     END-IF
  5694     .
  5695 0350-EXIT.
  5696     EXIT.
  5697 0400-PROCESS-LIFE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 100
* SOCK03.cbl
  5698     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5699     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5700     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5701     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5702     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5703     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5704     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5705     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5706     MOVE CM-CARRIER             TO WS-CARRIER
  5707     MOVE CM-GROUPING            TO WS-GROUPING
  5708     MOVE CM-STATE               TO WS-STATE
  5709     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5710     MOVE CM-CERT-NO             TO WS-CERT-NO
  5711     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5712     MOVE ' '                    TO  DC-OPTION-CODE.
  5713     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5714     IF NO-CONVERSION-ERROR
  5715        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5716     ELSE
  5717        MOVE 99999999            TO WS-CERT-EFF-DATE
  5718     END-IF
  5719     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5720        GO TO 0400-EXIT
  5721     END-IF
  5722     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5723                                    WS-TOT-LF-PREM
  5724                                    WS-TOT-LF-COMM
  5725                                    WS-LF-CANCEL-DATE
  5726     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5727     MOVE ' '                    TO  DC-OPTION-CODE
  5728     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5729     IF NO-CONVERSION-ERROR
  5730        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5731     ELSE
  5732        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5733     END-IF
  5734     IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5735        MOVE CM-LF-DEATH-DT      TO DC-BIN-DATE-1
  5736        MOVE ' '                 TO DC-OPTION-CODE
  5737
  5738        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5739        IF NO-CONVERSION-ERROR
  5740           MOVE DC-GREG-DATE-CYMD
  5741                                 TO WS-LF-CANCEL-DATE
  5742        ELSE
  5743           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5744        END-IF
  5745     END-IF
  5746     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5747        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
  5748        MOVE ' '                 TO DC-OPTION-CODE
  5749
  5750        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5751        IF NO-CONVERSION-ERROR
  5752           MOVE DC-GREG-DATE-CYMD
  5753                                 TO WS-LF-CANCEL-DATE
  5754        ELSE
  5755           MOVE ZEROS            TO WS-LF-CANCEL-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 101
* SOCK03.cbl
  5756        END-IF
  5757     END-IF
  5758     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5759     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5760     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5761     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5762     MOVE CM-STATE               TO CP-STATE
  5763     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5764     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5765     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5766     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5767     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5768     MOVE '2'                    TO CP-PROCESS-TYPE
  5769     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5770     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5771     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5772     MOVE WS-CF-REM-TRM-CALC-OPTION
  5773                                 TO CP-REM-TRM-CALC-OPTION
  5774     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5775     IF WS-LF-CO-REM-TERM-CALC > '0'
  5776        MOVE WS-LF-CO-REM-TERM-CALC
  5777                                 TO CP-REM-TERM-METHOD
  5778     END-IF
  5779     IF WS-LF-ST-REM-TERM-CALC > '0'
  5780         MOVE WS-LF-ST-REM-TERM-CALC
  5781                                 TO  CP-REM-TERM-METHOD.
  5782     IF WS-LF-AM-REM-TERM-CALC > '0'
  5783         MOVE WS-LF-AM-REM-TERM-CALC
  5784                                 TO  CP-REM-TERM-METHOD.
  5785     IF (WS-COMP-ID = 'CID')
  5786        AND (CP-STATE-STD-ABBRV = 'WI')
  5787        MOVE '7'                 TO CP-REM-TERM-METHOD
  5788        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5789     END-IF
  5790     IF (WS-COMP-ID = 'CID')
  5791        AND (CP-STATE-STD-ABBRV = 'MO')
  5792        AND (CM-CERT-EFF-DT >= X'9B41')
  5793        AND (CM-CERT-EFF-DT <= X'A2FB')
  5794        MOVE '7'                 TO CP-REM-TERM-METHOD
  5795        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5796     END-IF
  5797     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5798                                    CP-LOAN-TERM
  5799                                    WS-LF-TERM
  5800     IF CP-TRUNCATED-LIFE
  5801         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5802     IF CP-TERM-IS-DAYS
  5803        IF CM-LF-TERM-IN-DAYS NUMERIC
  5804           MOVE CM-LF-TERM-IN-DAYS
  5805                                 TO CP-TERM-OR-EXT-DAYS
  5806        ELSE
  5807           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5808        END-IF
  5809     ELSE
  5810        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5811           MOVE CM-PMT-EXTENSION-DAYS
  5812                                 TO CP-TERM-OR-EXT-DAYS
  5813        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 102
* SOCK03.cbl
  5814           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5815        END-IF
  5816     END-IF
  5817     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5818     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5819        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5820        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5821     END-IF
  5822     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5823     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5824     MOVE ' '                    TO WS-CLM-STOP-SW
  5825     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5826     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5827
  5828* EXEC CICS STARTBR
  5829*       DATASET     ('ELMSTR5')
  5830*       RIDFLD      (ELMSTR-KEY)
  5831*       RESP        (WS-RESPONSE)
  5832*    END-EXEC
  5833     MOVE 'ELMSTR5' TO DFHEIV1
  5834     MOVE 0
  5835       TO DFHEIV11
  5836*    MOVE '&,         G          &  N#00005479' TO DFHEIV0
  5837     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5838     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5839     MOVE X'204E233030303035343739' TO DFHEIV0(25:11)
  5840     CALL 'kxdfhei1' USING DFHEIV0,
  5841           DFHEIV1,
  5842           ELMSTR-KEY,
  5843           DFHEIV99,
  5844           DFHEIV11,
  5845           DFHEIV99
  5846     MOVE EIBRESP  TO WS-RESPONSE
  5847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5848     DISPLAY ' AFTER START ' WS-RESPONSE
  5849     IF RESP-NORMAL
  5850        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5851
  5852* EXEC CICS READNEXT
  5853*             DATASET   ('ELMSTR5')
  5854*             RIDFLD    (ELMSTR-KEY)
  5855*             INTO      (CLAIM-MASTER)
  5856*             RESP      (WS-RESPONSE)
  5857*          END-EXEC
  5858     MOVE LENGTH OF
  5859      CLAIM-MASTER
  5860       TO DFHEIV12
  5861     MOVE 'ELMSTR5' TO DFHEIV1
  5862     MOVE 0
  5863       TO DFHEIV11
  5864*    MOVE '&.IL                  )  N#00005487' TO DFHEIV0
  5865     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5866     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5867     MOVE X'204E233030303035343837' TO DFHEIV0(25:11)
  5868     CALL 'kxdfhei1' USING DFHEIV0,
  5869           DFHEIV1,
  5870           CLAIM-MASTER,
  5871           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 103
* SOCK03.cbl
  5872           ELMSTR-KEY,
  5873           DFHEIV99,
  5874           DFHEIV11,
  5875           DFHEIV99,
  5876           DFHEIV99
  5877     MOVE EIBRESP  TO WS-RESPONSE
  5878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5879        IF (RESP-NORMAL OR RESP-DUPKEY)
  5880           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5881           AND (CM-CERT-NO = CL-CERT-NO)
  5882           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5883              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5884              IF CL-CLAIM-TYPE = 'L' OR 'O'
  5885                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5886                    MOVE 'D'     TO WS-AH-STATUS
  5887                 END-IF
  5888                 IF CLAIM-IS-OPEN
  5889                    MOVE ' OPEN LIFE CLAIM '
  5890                                 TO WS-COMMENT
  5891                    MOVE 'L'     TO WS-LF-STATUS
  5892                    GO TO 0400-EXIT
  5893                 ELSE
  5894                    MOVE ' DEATH CLAIM APPLIED '
  5895                                 TO WS-COMMENT
  5896                    MOVE 'D'     TO WS-LF-STATUS
  5897*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5898*                      MOVE CL-PAID-THRU-DT
  5899*                                TO WS-LF-BIN-PAID-THRU-DT
  5900*                   END-IF
  5901                 END-IF
  5902              END-IF
  5903           END-IF
  5904        ELSE
  5905           SET I-SAY-TO-STOP TO TRUE
  5906        END-IF
  5907        END-PERFORM
  5908
  5909* EXEC CICS ENDBR
  5910*          DATASET   ('ELMSTR5')
  5911*       END-EXEC
  5912     MOVE 'ELMSTR5' TO DFHEIV1
  5913     MOVE 0
  5914       TO DFHEIV11
  5915*    MOVE '&2                    $   #00005522' TO DFHEIV0
  5916     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5917     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5918     MOVE X'2020233030303035353232' TO DFHEIV0(25:11)
  5919     CALL 'kxdfhei1' USING DFHEIV0,
  5920           DFHEIV1,
  5921           DFHEIV11,
  5922           DFHEIV99
  5923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5924     END-IF
  5925     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5926*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5927        MOVE WS-LF-BIN-PAID-THRU-DT
  5928                                 TO DC-BIN-DATE-1
  5929        MOVE ' '                 TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 104
* SOCK03.cbl
  5930        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5931        IF NO-CONVERSION-ERROR
  5932           MOVE DC-GREG-DATE-CYMD
  5933                                 TO WS-CLM-PAID-THRU-DT
  5934        ELSE
  5935           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5936        END-IF
  5937*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5938*          MOVE 'CAN DT =< CLM PD THRU DT'
  5939*                                TO WS-COMMENT
  5940*          MOVE 'P'              TO WS-LF-STATUS
  5941*          GO TO 0400-EXIT
  5942*       END-IF
  5943        GO TO 0400-EXIT
  5944     END-IF
  5945     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5946     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5947        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5948        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5949        COMPUTE CP-REMAINING-TERM-1 =
  5950                CP-REMAINING-TERM-1 - +1
  5951        COMPUTE CP-REMAINING-TERM-2 =
  5952                CP-REMAINING-TERM-2 - +1
  5953     END-IF
  5954     IF CP-REMAINING-TERM-1 NEGATIVE
  5955        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5956     END-IF
  5957     IF CP-REMAINING-TERM-2 NEGATIVE
  5958        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5959     END-IF
  5960     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5961        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5962     END-IF
  5963     IF CM-LIFE-COMM-PCT > ZEROS
  5964        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5965           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5966     END-IF
  5967     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5968     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5969     IF CM-LF-CURRENT-STATUS = '8'
  5970        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5971           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5972                                 TO WS-COMMENT
  5973           MOVE 'C'              TO WS-LF-STATUS
  5974           move cm-lf-itd-cancel-amt
  5975                                 to ws-lf-refund
  5976*          PERFORM 0030-BUILD-BUFFER
  5977*                                THRU 0030-EXIT
  5978*          PERFORM 0020-SEND-BUFFER
  5979*                                THRU 0020-EXIT
  5980*          SET ALREADY-SENT      TO TRUE
  5981*          MOVE SPACES           TO WS-COMMENT
  5982           GO TO 0400-EXIT
  5983*          PERFORM 0025-CLOSE-SOCKET
  5984*                                THRU 0025-EXIT
  5985*          GO TO 0010-RETURN
  5986        END-IF
  5987     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 105
* SOCK03.cbl
  5988     IF CM-LF-CURRENT-STATUS = '7'
  5989        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5990           MOVE ' DEATH CLAIM APPLIED '
  5991                                 TO WS-COMMENT
  5992           MOVE 'D'              TO WS-LF-STATUS
  5993*          PERFORM 0030-BUILD-BUFFER
  5994*                                THRU 0030-EXIT
  5995*          IF NOT ALREADY-SENT
  5996*             PERFORM 0020-SEND-BUFFER
  5997*                                THRU 0020-EXIT
  5998*             SET ALREADY-SENT   TO TRUE
  5999*          END-IF
  6000           GO TO 0400-EXIT
  6001*          PERFORM 0025-CLOSE-SOCKET
  6002*                                THRU 0025-EXIT
  6003*          GO TO 0010-RETURN
  6004        END-IF
  6005     END-IF
  6006     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6007        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  6008        MOVE 'LF COVERAGE EXPIRED '
  6009                                 TO WS-COMMENT
  6010        MOVE 'E'                 TO WS-LF-STATUS
  6011        GO TO 0400-EXIT
  6012     END-IF
  6013     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6014        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6015        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6016     ELSE
  6017        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  6018     END-IF
  6019     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  6020     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6021*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6022     if ws-comp-id = 'AHL'
  6023        move cm-lf-class-cd      to cp-class-code
  6024        if cp-class-code = spaces
  6025           move zeros            to cp-class-code
  6026        end-if
  6027     else
  6028        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6029     end-if
  6030     IF (ws-comp-id = 'DCC' or 'VPP')
  6031        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6032        MOVE ' '                 TO WS-PDEF-RECORD-SW
  6033        PERFORM 0730-GET-DDF-FACTORS
  6034                                 THRU 0730-EXIT
  6035        IF PDEF-FOUND
  6036           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6037              (P1 > +8)
  6038              OR (PD-PROD-CODE (P1) = 'L')
  6039           END-PERFORM
  6040           IF P1 < +9
  6041              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  6042           END-IF
  6043        END-IF
  6044     END-IF
  6045     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 106
* SOCK03.cbl
  6046*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  6047     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  6048        CM-LF-ALT-BENEFIT-AMT
  6049*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  6050     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  6051                                    WS-LF-REM-BEN
  6052     move cm-lf-premium-amt      to ws-tot-lf-prem
  6053     if ws-lf-co-earnings-calc = 'B'
  6054        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  6055           + CM-LF-ALT-PREMIUM-AMT
  6056     end-if
  6057     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  6058     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6059        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6060        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6061     ELSE
  6062        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6063     END-IF
  6064     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6065     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6066     IF WS-LF-ST-REFUND-CALC > ZERO
  6067         MOVE WS-LF-ST-REFUND-CALC
  6068                                 TO  CP-EARNING-METHOD.
  6069     IF WS-LF-FO-REFUND-CALC > ZERO
  6070         MOVE WS-LF-FO-REFUND-CALC
  6071                                 TO  CP-EARNING-METHOD.
  6072     IF CP-RATING-METHOD = '4'
  6073        MOVE '4'                 TO CP-EARNING-METHOD
  6074     END-IF
  6075*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6076     if ws-comp-id = 'AHL'
  6077        move cm-lf-class-cd      to cp-class-code
  6078        if cp-class-code = spaces
  6079           move zeros            to cp-class-code
  6080        end-if
  6081     else
  6082        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6083     end-if
  6084     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6085     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6086                                     CP-RATING-BENEFIT-AMT.
  6087     IF CP-STATE-STD-ABBRV = 'OR'
  6088         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6089                                         CM-LF-ALT-BENEFIT-AMT.
  6090****   N O T E   ****
  6091*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6092*      THE OH HARD CODING IN ELCRFNDP
  6093     IF WS-COMP-ID = 'CID'
  6094        IF CP-STATE-STD-ABBRV = 'OH'
  6095           MOVE WS-LF-CO-EARNINGS-CALC
  6096                                 TO CP-EARNING-METHOD
  6097        END-IF
  6098     END-IF
  6099****   N O T E   ****
  6100     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6101     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6102     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  6103     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 107
* SOCK03.cbl
  6104     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6105*    IF CP-EARN-AS-NET-PAY
  6106*       IF CP-LOAN-APR <= ZEROS
  6107*          IF WS-CF-DEFAULT-APR > ZEROS
  6108*             MOVE WS-CF-DEFAULT-APR
  6109*                                TO  CP-LOAN-APR
  6110*          END-IF
  6111*       END-IF
  6112*    END-IF
  6113*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  6114*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  6115*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  6116*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  6117*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  6118*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  6119*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6120*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  6121*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6122*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  6123*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  6124*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  6125*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  6126*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6127*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  6128*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  6129*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  6130*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6131     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6132     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  6133     DISPLAY ' MADE IT BACK FROM ELRFND '
  6134     IF (CP-ERROR-RATE-IS-ZERO)
  6135        OR (CP-ERROR-RATE-NOT-FOUND)
  6136        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6137        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  6138          DELIMITED BY SIZE INTO WS-COMMENT
  6139        END-STRING
  6140        MOVE 'X'                 TO WS-LF-STATUS
  6141        GO TO 0400-EXIT
  6142*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6143*       IF NOT ALREADY-SENT
  6144*          PERFORM 0020-SEND-BUFFER
  6145*                                THRU 0020-EXIT
  6146*          SET ALREADY-SENT      TO TRUE
  6147*       END-IF
  6148*       PERFORM 0025-CLOSE-SOCKET
  6149*                                THRU 0025-EXIT
  6150*       GO TO 0010-RETURN
  6151     END-IF
  6152     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  6153                                    WS-TOT-LF-RFND
  6154     IF (WS-LF-STATUS = SPACES)
  6155        OR (CP-CALC-REFUND > ZEROS)
  6156        MOVE 'A'                 TO WS-LF-STATUS
  6157     END-IF
  6158     EVALUATE TRUE
  6159        WHEN CP-R-AS-R78
  6160           MOVE 'RULE 78'          TO  WS-LF-METHOD
  6161        WHEN  CP-R-AS-PRORATA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 108
* SOCK03.cbl
  6162           MOVE 'PRORATA'          TO  WS-LF-METHOD
  6163        WHEN CP-R-AS-CALIF
  6164           MOVE 'CALIF'            TO  WS-LF-METHOD
  6165        WHEN CP-R-AS-TEXAS
  6166           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6167        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  6168           MOVE 'UTAH'             TO  WS-LF-METHOD
  6169        WHEN CP-R-AS-FARM-PLAN
  6170           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6171        WHEN CP-R-AS-NET-PAY
  6172           MOVE 'NET PAY'          TO  WS-LF-METHOD
  6173        WHEN CP-R-AS-ANTICIPATION
  6174           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  6175        WHEN CP-R-AS-MEAN
  6176           MOVE 'MEAN'             TO  WS-LF-METHOD
  6177        WHEN CP-R-AS-SUM-OF-DIGITS
  6178           MOVE 'SUM OF DIGITS'    TO  WS-LF-METHOD
  6179        WHEN CP-R-AS-REPOSSESSION
  6180           MOVE 'REPOSSESSION'     TO  WS-LF-METHOD
  6181     END-EVALUATE
  6182     IF WS-TOT-LF-RFND > ZEROS
  6183        COMPUTE WS-WORK-FACTOR ROUNDED =
  6184           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  6185        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  6186           WS-TOT-LF-COMM
  6187     END-IF
  6188     IF ERACCT-FOUND
  6189        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6190           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6191        END-IF
  6192        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6193           IF (AM-COMM-CHARGEBACK (1) = 99)
  6194                     OR
  6195              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6196                     OR
  6197              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6198              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6199              MOVE ZEROS         TO WS-LF-UEC
  6200           END-IF
  6201        END-IF
  6202     END-IF
  6203     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  6204        GO TO 0400-EXIT
  6205     END-IF
  6206     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6207     MOVE '2'                    TO  CP-EARNING-METHOD
  6208                                     CP-RATING-METHOD.
  6209     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6210                                     CP-REMAINING-BENEFIT
  6211                                     CP-RATING-BENEFIT-AMT.
  6212     IF CP-STATE-STD-ABBRV = 'OR'
  6213         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6214                                         CM-LF-ALT-BENEFIT-AMT.
  6215     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6216     IF ws-comp-id = 'CID'
  6217        IF (CP-STATE-STD-ABBRV = 'MN')
  6218           AND (CM-CERT-EFF-DT > X'A4FF')
  6219           AND (WS-LF-CO-EARNINGS-CALC = 'B')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 109
* SOCK03.cbl
  6220           MOVE '5'              TO CP-EARNING-METHOD
  6221           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6222        END-IF
  6223     END-IF
  6224     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6225     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  6226     IF (CP-ERROR-RATE-IS-ZERO)
  6227        OR (CP-ERROR-RATE-NOT-FOUND)
  6228        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6229        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  6230          DELIMITED BY SIZE INTO WS-COMMENT
  6231        END-STRING
  6232        MOVE 'X'              TO WS-LF-STATUS
  6233        GO TO 0400-EXIT
  6234*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6235*       IF NOT ALREADY-SENT
  6236*          PERFORM 0020-SEND-BUFFER
  6237*                                THRU 0020-EXIT
  6238*          SET ALREADY-SENT      TO TRUE
  6239*       END-IF
  6240*       PERFORM 0025-CLOSE-SOCKET
  6241*                                THRU 0025-EXIT
  6242*       GO TO 0010-RETURN
  6243     END-IF
  6244     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  6245     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  6246     IF WS-TOT-LF-RFND > ZEROS
  6247        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  6248           WS-TOT-LF-COMM
  6249     END-IF
  6250     IF ERACCT-FOUND
  6251        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6252           IF (AM-COMM-CHARGEBACK (1) = 99)
  6253                     OR
  6254              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6255                     OR
  6256              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6257              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6258              MOVE ZEROS         TO WS-LF-UEC
  6259           END-IF
  6260        END-IF
  6261     END-IF
  6262     .
  6263 0400-EXIT.
  6264     EXIT.
  6265 0500-PROCESS-AH.
  6266     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  6267        GO TO 0500-EXIT
  6268     END-IF
  6269     MOVE ZEROS                  TO WS-TOT-AH-RFND
  6270                                    WS-TOT-AH-PREM
  6271                                    WS-TOT-AH-COMM
  6272                                    WS-AH-CANCEL-DATE
  6273     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  6274     MOVE ' '                    TO  DC-OPTION-CODE
  6275     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6276     IF NO-CONVERSION-ERROR
  6277        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 110
* SOCK03.cbl
  6278     ELSE
  6279        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  6280     END-IF
  6281     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6282        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
  6283        MOVE ' '                 TO DC-OPTION-CODE
  6284
  6285        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6286        IF NO-CONVERSION-ERROR
  6287           MOVE DC-GREG-DATE-CYMD TO WS-AH-CANCEL-DATE
  6288        ELSE
  6289           MOVE ZEROS            TO WS-AH-CANCEL-DATE
  6290        END-IF
  6291     END-IF
  6292     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  6293     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  6294     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  6295     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6296     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6297     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  6298     MOVE CM-STATE               TO  CP-STATE.
  6299     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6300     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6301     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6302     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6303     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  6304     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6305     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6306     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  6307     MOVE WS-CF-CR-REM-TERM-CALC
  6308                                 TO  CP-REM-TERM-METHOD.
  6309     IF WS-AH-CO-REM-TERM-CALC > '0'
  6310         MOVE WS-AH-CO-REM-TERM-CALC
  6311                                 TO  CP-REM-TERM-METHOD.
  6312     IF WS-AH-ST-REM-TERM-CALC > '0'
  6313         MOVE WS-AH-ST-REM-TERM-CALC
  6314                                 TO  CP-REM-TERM-METHOD.
  6315     IF WS-AH-AM-REM-TERM-CALC > '0'
  6316         MOVE WS-AH-AM-REM-TERM-CALC
  6317                                 TO  CP-REM-TERM-METHOD.
  6318     IF (WS-COMP-ID = 'CID')
  6319        AND (CP-STATE-STD-ABBRV = 'WI')
  6320        MOVE '7'                 TO CP-REM-TERM-METHOD
  6321        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6322     END-IF
  6323     IF (WS-COMP-ID = 'CID')
  6324        AND (CP-STATE-STD-ABBRV = 'MO')
  6325        AND (CM-CERT-EFF-DT >= X'9B41')
  6326        AND (CM-CERT-EFF-DT <= X'A2FB')
  6327        MOVE '7'                 TO CP-REM-TERM-METHOD
  6328        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6329     END-IF
  6330     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  6331                                     CP-LOAN-TERM.
  6332     IF  NOT  CP-TERM-IS-DAYS
  6333         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6334             MOVE CM-PMT-EXTENSION-DAYS
  6335                                 TO  CP-TERM-OR-EXT-DAYS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 111
* SOCK03.cbl
  6336         ELSE
  6337             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6338     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  6339     IF CM-AH-COMM-PCT > ZEROS
  6340        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  6341           CM-AH-PREMIUM-AMT
  6342     END-IF
  6343     IF (ws-comp-id = 'DCC' or 'VPP')
  6344        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6345        compute ws-tot-ah-comm = cm-ah-premium-amt -
  6346           (cm-ah-clp + cm-addl-clp)
  6347     end-if
  6348     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  6349     IF WS-AH-STATUS = 'D'
  6350        GO TO 0500-EXIT
  6351     END-IF
  6352     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  6353     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  6354     MOVE ' '                    TO WS-CLM-STOP-SW
  6355     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6356     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6357
  6358* EXEC CICS STARTBR
  6359*       DATASET     ('ELMSTR5')
  6360*       RIDFLD      (ELMSTR-KEY)
  6361*       RESP        (WS-RESPONSE)
  6362*    END-EXEC
  6363     MOVE 'ELMSTR5' TO DFHEIV1
  6364     MOVE 0
  6365       TO DFHEIV11
  6366*    MOVE '&,         G          &  N#00005958' TO DFHEIV0
  6367     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6368     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6369     MOVE X'204E233030303035393538' TO DFHEIV0(25:11)
  6370     CALL 'kxdfhei1' USING DFHEIV0,
  6371           DFHEIV1,
  6372           ELMSTR-KEY,
  6373           DFHEIV99,
  6374           DFHEIV11,
  6375           DFHEIV99
  6376     MOVE EIBRESP  TO WS-RESPONSE
  6377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6378     DISPLAY ' AFTER START ' WS-RESPONSE
  6379     IF RESP-NORMAL
  6380        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6381           DISPLAY ' AH READNEXT '
  6382
  6383* EXEC CICS READNEXT
  6384*             DATASET   ('ELMSTR5')
  6385*             RIDFLD    (ELMSTR-KEY)
  6386*             INTO      (CLAIM-MASTER)
  6387*             RESP      (WS-RESPONSE)
  6388*          END-EXEC
  6389     MOVE LENGTH OF
  6390      CLAIM-MASTER
  6391       TO DFHEIV12
  6392     MOVE 'ELMSTR5' TO DFHEIV1
  6393     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 112
* SOCK03.cbl
  6394       TO DFHEIV11
  6395*    MOVE '&.IL                  )  N#00005967' TO DFHEIV0
  6396     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6397     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6398     MOVE X'204E233030303035393637' TO DFHEIV0(25:11)
  6399     CALL 'kxdfhei1' USING DFHEIV0,
  6400           DFHEIV1,
  6401           CLAIM-MASTER,
  6402           DFHEIV12,
  6403           ELMSTR-KEY,
  6404           DFHEIV99,
  6405           DFHEIV11,
  6406           DFHEIV99,
  6407           DFHEIV99
  6408     MOVE EIBRESP  TO WS-RESPONSE
  6409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6410        IF (RESP-NORMAL OR RESP-DUPKEY)
  6411           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6412           AND (CM-CERT-NO = CL-CERT-NO)
  6413           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6414              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6415              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6416                 IF CLAIM-IS-OPEN
  6417                    DISPLAY ' FOUND OPEN AH CLAIM '
  6418                    MOVE ' OPEN HEALTH CLAIM '
  6419                                 TO WS-COMMENT
  6420                    MOVE 'H'     TO WS-AH-STATUS
  6421                 ELSE
  6422                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6423                    MOVE ' CLOSED HEALTH CLAIM '
  6424                                 TO WS-COMMENT
  6425                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6426                       MOVE CL-PAID-THRU-DT
  6427                                 TO WS-AH-BIN-PAID-THRU-DT
  6428                    END-IF
  6429                 END-IF
  6430              END-IF
  6431           END-IF
  6432        ELSE
  6433           SET I-SAY-TO-STOP TO TRUE
  6434        END-IF
  6435        END-PERFORM
  6436
  6437* EXEC CICS ENDBR
  6438*          DATASET   ('ELMSTR5')
  6439*       END-EXEC
  6440     MOVE 'ELMSTR5' TO DFHEIV1
  6441     MOVE 0
  6442       TO DFHEIV11
  6443*    MOVE '&2                    $   #00005999' TO DFHEIV0
  6444     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6445     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6446     MOVE X'2020233030303035393939' TO DFHEIV0(25:11)
  6447     CALL 'kxdfhei1' USING DFHEIV0,
  6448           DFHEIV1,
  6449           DFHEIV11,
  6450           DFHEIV99
  6451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 113
* SOCK03.cbl
  6452     END-IF
  6453     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6454*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6455        MOVE WS-AH-BIN-PAID-THRU-DT
  6456                                 TO DC-BIN-DATE-1
  6457        MOVE ' '                 TO DC-OPTION-CODE
  6458        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6459        IF NO-CONVERSION-ERROR
  6460           MOVE DC-GREG-DATE-CYMD
  6461                                 TO WS-CLM-PAID-THRU-DT
  6462        ELSE
  6463           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6464        END-IF
  6465        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6466           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6467                                 TO WS-COMMENT
  6468           MOVE 'P'              TO WS-AH-STATUS
  6469           GO TO 0500-EXIT
  6470        END-IF
  6471     END-IF
  6472     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6473     IF CM-AH-CURRENT-STATUS = '8'
  6474        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6475           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6476                                 TO WS-COMMENT
  6477           MOVE 'C'              TO WS-AH-STATUS
  6478           move cm-ah-itd-cancel-amt
  6479                                 to ws-ah-refund
  6480           GO TO 0500-EXIT
  6481        END-IF
  6482     END-IF
  6483     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6484        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6485           MOVE ' SETTLEMENT CLAIM APPLIED '
  6486                                 TO WS-COMMENT
  6487           MOVE 'S'              TO WS-AH-STATUS
  6488*          PERFORM 0030-BUILD-BUFFER
  6489*                                THRU 0030-EXIT
  6490*          IF NOT ALREADY-SENT
  6491*             PERFORM 0020-SEND-BUFFER
  6492*                                THRU 0020-EXIT
  6493*             SET ALREADY-SENT   TO TRUE
  6494*          END-IF
  6495           GO TO 0500-EXIT
  6496*          PERFORM 0025-CLOSE-SOCKET
  6497*                                THRU 0025-EXIT
  6498*          GO TO 0010-RETURN
  6499        END-IF
  6500     END-IF
  6501     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6502        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6503        MOVE 'AH COVERAGE EXPIRED '
  6504                                 TO WS-COMMENT
  6505        MOVE 'E'                 TO WS-AH-STATUS
  6506        GO TO 0500-EXIT
  6507     END-IF
  6508     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6509                                    WS-AH-PREM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 114
* SOCK03.cbl
  6510     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6511     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6512        * CP-REMAINING-TERM-1
  6513     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6514                                     WS-AH-REM-TERM
  6515     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6516     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6517     IF WS-AH-ST-REFUND-CALC > ZERO
  6518         MOVE WS-AH-ST-REFUND-CALC
  6519                                 TO  CP-EARNING-METHOD.
  6520     IF WS-AH-FO-REFUND-CALC > ZERO
  6521         MOVE WS-AH-FO-REFUND-CALC
  6522                                 TO  CP-EARNING-METHOD.
  6523*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6524     if ws-comp-id = 'AHL'
  6525        move cm-ah-class-cd      to cp-class-code
  6526        if cp-class-code = spaces
  6527           move zeros            to cp-class-code
  6528        end-if
  6529     else
  6530        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6531     end-if
  6532     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6533     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6534                                     CP-RATING-BENEFIT-AMT.
  6535     IF CP-STATE-STD-ABBRV = 'OR'
  6536         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6537                                         CM-AH-ORIG-TERM.
  6538     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6539     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6540     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6541     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6542     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6543     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6544     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6545     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6546     MOVE ' '                    TO  DC-OPTION-CODE.
  6547     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6548     IF CP-STATE-STD-ABBRV = 'OH'
  6549        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6550         IF (CP-ORIGINAL-TERM > 60)
  6551           AND (DC-GREG-DATE-1-YMD > '831101')
  6552           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6553             MOVE '6'            TO  CP-EARNING-METHOD
  6554         END-IF
  6555        END-IF
  6556        IF WS-COMP-ID = 'CID'
  6557           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6558                           LOW-VALUES)
  6559              IF CP-CRITICAL-PERIOD
  6560                 MOVE '2'       TO CP-EARNING-METHOD
  6561              ELSE
  6562                 MOVE '6'       TO CP-EARNING-METHOD
  6563              END-IF
  6564           ELSE
  6565              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6566                 MOVE '2'       TO CP-EARNING-METHOD
  6567              ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 115
* SOCK03.cbl
  6568                 IF ((CM-LF-ORIG-TERM > 60) AND
  6569                    (CM-RATE-CLASS NOT = 'L '))
  6570                               OR
  6571                    (WS-LF-CO-EARNINGS-CALC = '5')
  6572                    IF CP-CRITICAL-PERIOD
  6573                       MOVE '2'  TO CP-EARNING-METHOD
  6574                    ELSE
  6575                       MOVE '6'  TO CP-EARNING-METHOD
  6576                    END-IF
  6577                 ELSE
  6578                    MOVE '1'     TO CP-EARNING-METHOD
  6579                 END-IF
  6580              END-IF
  6581           END-IF
  6582        END-IF
  6583     END-IF
  6584     IF CP-STATE-STD-ABBRV = 'VA'
  6585       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6586         IF DC-GREG-DATE-1-YMD > '921231'
  6587            IF CP-ORIGINAL-TERM > 61
  6588                MOVE '6'            TO  CP-EARNING-METHOD
  6589            ELSE
  6590                MOVE '1'            TO  CP-EARNING-METHOD.
  6591*    IF CP-EARN-AS-NET-PAY
  6592*       IF CP-LOAN-APR <= ZEROS
  6593*          IF WS-CF-DEFAULT-APR > ZEROS
  6594*             MOVE WS-CF-DEFAULT-APR
  6595*                                TO  CP-LOAN-APR
  6596*          END-IF
  6597*       END-IF
  6598*    END-IF
  6599     IF WS-COMP-ID = 'DCC' or 'VPP'
  6600        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6601           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6602           MOVE 'S'              TO CP-EARNING-METHOD
  6603        END-IF
  6604     END-IF
  6605     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6606     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6607        AND (CP-EARNING-METHOD = 'D')
  6608        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6609                                    WS-DDF-CSO-ADMIN-FEE
  6610                                    WS-DDF-1ST-YR-TOT-EXP
  6611                                    WS-DDF-COMM-AND-MFEE
  6612        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6613           S1 > +10
  6614           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6615              IF (AM-A-COM (S1) NUMERIC)
  6616                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6617                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6618              ELSE
  6619                 MOVE +0         TO WS-COMM-PCT C0
  6620                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6621                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6622              END-IF
  6623              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6624                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6625                    + WS-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 116
* SOCK03.cbl
  6626              END-IF
  6627              IF AM-COM-TYP (S1) = 'N'
  6628                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6629                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6630              END-IF
  6631              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6632                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6633                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6634              END-IF
  6635              IF AM-COM-TYP (S1) = 'I'
  6636                 COMPUTE WS-DDF-COMM-AND-MFEE
  6637                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6638              END-IF
  6639           END-IF
  6640        END-PERFORM
  6641        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6642        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6643        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6644           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6645     END-IF
  6646     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6647        AND (CP-EARNING-METHOD = 'D')
  6648        AND (ws-CANCEL-REASON NOT = 'R')
  6649        PERFORM 0730-GET-DDF-FACTORS
  6650                                 THRU 0730-EXIT
  6651        IF NOT PDEF-FOUND
  6652           MOVE ' DDF UE FACTORS  NOT FOUND '
  6653                                 TO WS-COMMENT
  6654           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6655           PERFORM 0030-BUILD-BUFFER
  6656                                 THRU 0030-EXIT
  6657           PERFORM 0020-SEND-BUFFER
  6658                                 THRU 0020-EXIT
  6659           PERFORM 0025-CLOSE-SOCKET
  6660                                 THRU 0025-EXIT
  6661           GO TO 0010-RETURN
  6662        END-IF
  6663*       IF NOT PDEF-FOUND
  6664*          MOVE ER-9999          TO EMI-ERROR
  6665*          PERFORM 9700-ERROR-FORMAT
  6666*                                THRU 9799-EXIT
  6667*          GO TO 8200-SEND-DATAONLY
  6668*       END-IF
  6669        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6670                                 TO CP-DDF-LO-FACT
  6671        MOVE PD-UEP-FACTOR (P1 P2)
  6672                                 TO CP-DDF-HI-FACT
  6673        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6674        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6675        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6676        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6677           + PD-1ST-YR-ADMIN-ALLOW
  6678        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6679*       IF PI-CLP-YN = 'Y'
  6680*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6681*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6682*                                   CP-DDF-CLP
  6683*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 117
* SOCK03.cbl
  6684*       END-IF
  6685        IF DD-IU-PRESENT
  6686           MOVE 'I'              TO CP-EARNING-METHOD
  6687        END-IF
  6688        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6689                                    CP-CLP-RATE-UP
  6690        IF (CP-CALC-GROSS-FEE)
  6691           AND (CP-IU-RATE-UP NOT = ZEROS)
  6692           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6693              / CP-ORIGINAL-PREMIUM)
  6694           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6695              / (1 - TEX-FACT-8)
  6696        END-IF
  6697     END-IF
  6698     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6699     IF (CP-ERROR-RATE-IS-ZERO)
  6700        OR (CP-ERROR-RATE-NOT-FOUND)
  6701        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6702        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6703          DELIMITED BY SIZE INTO WS-COMMENT
  6704        END-STRING
  6705        IF WS-AH-STATUS NOT = 'H'
  6706           MOVE 'X'                 TO WS-AH-STATUS
  6707        END-IF
  6708        GO TO 0500-EXIT
  6709*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6710*       IF NOT ALREADY-SENT
  6711*          PERFORM 0020-SEND-BUFFER
  6712*                                THRU 0020-EXIT
  6713*          SET ALREADY-SENT      TO TRUE
  6714*       END-IF
  6715*       PERFORM 0025-CLOSE-SOCKET
  6716*                                THRU 0025-EXIT
  6717*       GO TO 0010-RETURN
  6718     END-IF
  6719     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6720                                    WS-TOT-AH-RFND
  6721     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6722     IF ((WS-AH-STATUS = SPACES)
  6723        OR (CP-CALC-REFUND > ZEROS))
  6724                  AND
  6725          (WS-AH-STATUS NOT = 'H')
  6726        MOVE 'A'                 TO WS-AH-STATUS
  6727     END-IF
  6728     IF WS-COMP-ID = 'DCC' or 'VPP'
  6729        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6730        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6731        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6732        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6733        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6734        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6735        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6736        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6737        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6738     END-IF
  6739     EVALUATE TRUE
  6740        WHEN CP-R-AS-R78
  6741           MOVE 'RULE 78'          TO  WS-AH-METHOD
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 118
* SOCK03.cbl
  6742        WHEN CP-R-AS-PRORATA
  6743           MOVE 'PRORATA'          TO  WS-AH-METHOD
  6744        WHEN CP-REFUND-TYPE-USED = '3'
  6745           MOVE 'CALIF'            TO  WS-AH-METHOD
  6746        WHEN CP-R-AS-TEXAS
  6747           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6748        WHEN CP-R-AS-FARM-PLAN
  6749           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6750        WHEN CP-R-AS-NET-PAY
  6751           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6752        WHEN CP-R-AS-ANTICIPATION
  6753           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6754        WHEN CP-R-AS-MEAN
  6755           MOVE 'MEAN'             TO  WS-AH-METHOD
  6756        WHEN CP-R-AS-SUM-OF-DIGITS
  6757           MOVE 'SUM OF DIGITS'    TO  WS-AH-METHOD
  6758        WHEN CP-GAP-ACTUARIAL
  6759           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6760        WHEN CP-R-AS-REPOSSESSION
  6761           MOVE 'REPOSSESSION'     TO WS-AH-METHOD
  6762     END-EVALUATE
  6763     IF WS-TOT-AH-RFND > ZEROS
  6764        IF (ws-comp-id = 'DCC' or 'VPP')
  6765           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6766           compute ws-work-factor rounded =
  6767              ws-ah-rfnd-clp / cm-ah-clp
  6768        else
  6769           COMPUTE WS-WORK-FACTOR ROUNDED =
  6770              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6771        end-if
  6772        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6773           WS-TOT-AH-COMM
  6774     END-IF
  6775     IF ERACCT-FOUND
  6776        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6777           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6778        END-IF
  6779        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6780           IF (AM-COMM-CHARGEBACK (1) = 99)
  6781                     OR
  6782              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6783                     OR
  6784              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6785              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6786              MOVE ZEROS         TO WS-AH-UEC
  6787           END-IF
  6788        END-IF
  6789     END-IF
  6790     .
  6791 0500-EXIT.
  6792     EXIT.
  6793 0610-GET-ERMAIL.
  6794
  6795     MOVE WS-CM-KEY              TO WS-MA-KEY
  6796
  6797* EXEC CICS READ
  6798*       INTO    (MAILING-DATA)
  6799*       DATASET ('ERMAIL')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 119
* SOCK03.cbl
  6800*       RIDFLD  (WS-MA-KEY)
  6801*       RESP    (WS-RESPONSE)
  6802*    END-EXEC
  6803     MOVE LENGTH OF
  6804      MAILING-DATA
  6805       TO DFHEIV11
  6806     MOVE 'ERMAIL' TO DFHEIV1
  6807*    MOVE '&"IL       E          (  N#00006346' TO DFHEIV0
  6808     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6810     MOVE X'204E233030303036333436' TO DFHEIV0(25:11)
  6811     CALL 'kxdfhei1' USING DFHEIV0,
  6812           DFHEIV1,
  6813           MAILING-DATA,
  6814           DFHEIV11,
  6815           WS-MA-KEY,
  6816           DFHEIV99,
  6817           DFHEIV99,
  6818           DFHEIV99
  6819     MOVE EIBRESP  TO WS-RESPONSE
  6820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6821
  6822     IF RESP-NORMAL
  6823        MOVE MA-CRED-BENE-NAME   to ws-cred-bene-name
  6824     else
  6825        move spaces              to ws-cred-bene-name
  6826     end-if
  6827
  6828     .
  6829 0610-EXIT.
  6830     EXIT.
  6831 0620-GET-ELCRTT.
  6832
  6833     MOVE WS-CM-KEY              TO WS-CS-KEY
  6834     move 'C'                    to WS-CS-TRLR-TYPE
  6835
  6836
  6837* EXEC CICS READ
  6838*       INTO    (CERTIFICATE-TRAILERS)
  6839*       DATASET ('ELCRTT')
  6840*       RIDFLD  (WS-CS-KEY)
  6841*       RESP    (WS-RESPONSE)
  6842*    END-EXEC
  6843     MOVE LENGTH OF
  6844      CERTIFICATE-TRAILERS
  6845       TO DFHEIV11
  6846     MOVE 'ELCRTT' TO DFHEIV1
  6847*    MOVE '&"IL       E          (  N#00006367' TO DFHEIV0
  6848     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6850     MOVE X'204E233030303036333637' TO DFHEIV0(25:11)
  6851     CALL 'kxdfhei1' USING DFHEIV0,
  6852           DFHEIV1,
  6853           CERTIFICATE-TRAILERS,
  6854           DFHEIV11,
  6855           WS-CS-KEY,
  6856           DFHEIV99,
  6857           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 120
* SOCK03.cbl
  6858           DFHEIV99
  6859     MOVE EIBRESP  TO WS-RESPONSE
  6860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6861
  6862     IF RESP-NORMAL
  6863        MOVE cs-vin-number       to ws-vin
  6864     else
  6865        move spaces              to ws-vin
  6866     end-if
  6867
  6868     .
  6869 0620-EXIT.
  6870     EXIT.
  6871 0700-LINK-REM-TERM.
  6872
  6873* EXEC CICS LINK
  6874*        PROGRAM   ('ELRTRM')
  6875*        COMMAREA  (CALCULATION-PASS-AREA)
  6876*        LENGTH    (CP-COMM-LENGTH)
  6877*    END-EXEC.
  6878     MOVE 'ELRTRM' TO DFHEIV1
  6879*    MOVE '."C                   (   #00006384' TO DFHEIV0
  6880     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6881     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6882     MOVE X'2020233030303036333834' TO DFHEIV0(25:11)
  6883     CALL 'kxdfhei1' USING DFHEIV0,
  6884           DFHEIV1,
  6885           CALCULATION-PASS-AREA,
  6886           CP-COMM-LENGTH,
  6887           DFHEIV99,
  6888           DFHEIV99,
  6889           DFHEIV99,
  6890           DFHEIV99
  6891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6892
  6893 0700-EXIT.
  6894     EXIT.
  6895 0710-LINK-REM-AMOUNT.
  6896
  6897* EXEC CICS LINK
  6898*        PROGRAM   ('ELRAMT')
  6899*        COMMAREA  (CALCULATION-PASS-AREA)
  6900*        LENGTH    (CP-COMM-LENGTH)
  6901*    END-EXEC
  6902     MOVE 'ELRAMT' TO DFHEIV1
  6903*    MOVE '."C                   (   #00006392' TO DFHEIV0
  6904     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6906     MOVE X'2020233030303036333932' TO DFHEIV0(25:11)
  6907     CALL 'kxdfhei1' USING DFHEIV0,
  6908           DFHEIV1,
  6909           CALCULATION-PASS-AREA,
  6910           CP-COMM-LENGTH,
  6911           DFHEIV99,
  6912           DFHEIV99,
  6913           DFHEIV99,
  6914           DFHEIV99
  6915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 121
* SOCK03.cbl
  6916     .
  6917 0710-EXIT.
  6918     EXIT.
  6919 0720-LINK-REFUND.
  6920
  6921* EXEC CICS LINK
  6922*        PROGRAM   ('ELRFND')
  6923*        COMMAREA  (CALCULATION-PASS-AREA)
  6924*        LENGTH    (CP-COMM-LENGTH)
  6925*    END-EXEC
  6926     MOVE 'ELRFND' TO DFHEIV1
  6927*    MOVE '."C                   (   #00006401' TO DFHEIV0
  6928     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6930     MOVE X'2020233030303036343031' TO DFHEIV0(25:11)
  6931     CALL 'kxdfhei1' USING DFHEIV0,
  6932           DFHEIV1,
  6933           CALCULATION-PASS-AREA,
  6934           CP-COMM-LENGTH,
  6935           DFHEIV99,
  6936           DFHEIV99,
  6937           DFHEIV99,
  6938           DFHEIV99
  6939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6940     .
  6941 0720-EXIT.
  6942     EXIT.
  6943 0730-GET-DDF-FACTORS.
  6944     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6945     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6946     MOVE CM-STATE               TO ERPDEF-STATE
  6947     if cm-clp-state not = cm-state and spaces and zeros
  6948        move cm-clp-state        to erpdef-state
  6949     end-if
  6950     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6951     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6952     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6953     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6954     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6955
  6956* EXEC CICS STARTBR
  6957*        DATASET  ('ERPDEF')
  6958*        RIDFLD   (ERPDEF-KEY)
  6959*        GTEQ
  6960*        RESP     (WS-RESPONSE)
  6961*    END-EXEC
  6962     MOVE 'ERPDEF' TO DFHEIV1
  6963     MOVE 0
  6964       TO DFHEIV11
  6965*    MOVE '&,         G          &  N#00006421' TO DFHEIV0
  6966     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6967     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6968     MOVE X'204E233030303036343231' TO DFHEIV0(25:11)
  6969     CALL 'kxdfhei1' USING DFHEIV0,
  6970           DFHEIV1,
  6971           ERPDEF-KEY,
  6972           DFHEIV99,
  6973           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 122
* SOCK03.cbl
  6974           DFHEIV99
  6975     MOVE EIBRESP  TO WS-RESPONSE
  6976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6977     IF NOT RESP-NORMAL
  6978        GO TO 0730-EXIT
  6979     END-IF
  6980     .
  6981 0730-READNEXT.
  6982
  6983* EXEC CICS READNEXT
  6984*       DATASET  ('ERPDEF')
  6985*       INTO     (PRODUCT-MASTER)
  6986*       RIDFLD   (ERPDEF-KEY)
  6987*       RESP     (WS-RESPONSE)
  6988*    END-EXEC
  6989     MOVE LENGTH OF
  6990      PRODUCT-MASTER
  6991       TO DFHEIV12
  6992     MOVE 'ERPDEF' TO DFHEIV1
  6993     MOVE 0
  6994       TO DFHEIV11
  6995*    MOVE '&.IL                  )  N#00006432' TO DFHEIV0
  6996     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6997     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6998     MOVE X'204E233030303036343332' TO DFHEIV0(25:11)
  6999     CALL 'kxdfhei1' USING DFHEIV0,
  7000           DFHEIV1,
  7001           PRODUCT-MASTER,
  7002           DFHEIV12,
  7003           ERPDEF-KEY,
  7004           DFHEIV99,
  7005           DFHEIV11,
  7006           DFHEIV99,
  7007           DFHEIV99
  7008     MOVE EIBRESP  TO WS-RESPONSE
  7009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7010     IF NOT RESP-NORMAL
  7011        GO TO 0730-ENDBR
  7012     END-IF
  7013     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7014        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7015           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7016        ELSE
  7017           GO TO 0730-READNEXT
  7018        END-IF
  7019     ELSE
  7020        GO TO 0730-ENDBR
  7021     END-IF
  7022     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7023        (P1 > +8)
  7024        OR (PD-PROD-CODE (P1) = 'I')
  7025     END-PERFORM
  7026     IF P1 < +9
  7027        SET DD-IU-PRESENT        TO TRUE
  7028     END-IF
  7029     IF CM-LOAN-TERM = ZEROS
  7030        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7031     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 123
* SOCK03.cbl
  7032     IF PD-TRUNCATED = 'Y'
  7033        MOVE CM-LOAN-TERM        TO WS-TERM
  7034     ELSE
  7035        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7036     END-IF
  7037     EVALUATE TRUE
  7038        WHEN WS-TERM > +168
  7039           MOVE 15               TO P1
  7040        WHEN WS-TERM > +156
  7041           MOVE 14               TO P1
  7042        WHEN WS-TERM > +144
  7043           MOVE 13               TO P1
  7044        WHEN WS-TERM > +132
  7045           MOVE 12               TO P1
  7046        WHEN WS-TERM > +120
  7047           MOVE 11               TO P1
  7048        WHEN WS-TERM > +108
  7049           MOVE 10               TO P1
  7050        WHEN WS-TERM > +96
  7051           MOVE 9                TO P1
  7052        WHEN WS-TERM > +84
  7053           MOVE 8                TO P1
  7054        WHEN WS-TERM > +72
  7055           MOVE 7                TO P1
  7056        WHEN WS-TERM > +60
  7057           MOVE 6                TO P1
  7058        WHEN WS-TERM > +48
  7059           MOVE 5                TO P1
  7060        WHEN WS-TERM > +36
  7061           MOVE 4                TO P1
  7062        WHEN WS-TERM > +24
  7063           MOVE 3                TO P1
  7064        WHEN WS-TERM > +12
  7065           MOVE 2                TO P1
  7066        WHEN OTHER
  7067           MOVE 1                TO P1
  7068     END-EVALUATE
  7069     EVALUATE TRUE
  7070*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7071*          AND (DD-IU-PRESENT)
  7072*          MOVE 2                TO P2
  7073*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7074*          MOVE 1                TO P2
  7075        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7076           MOVE 2                TO P2
  7077        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7078           MOVE 3                TO P2
  7079        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7080           MOVE 4                TO P2
  7081        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7082           MOVE 5                TO P2
  7083        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7084           MOVE 6                TO P2
  7085        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7086           MOVE 7                TO P2
  7087        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7088           MOVE 8                TO P2
  7089        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 124
* SOCK03.cbl
  7090           MOVE 9                TO P2
  7091        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7092           MOVE 10               TO P2
  7093        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7094           MOVE 11               TO P2
  7095        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7096           MOVE 12               TO P2
  7097        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7098           MOVE 13               TO P2
  7099        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7100           MOVE 14               TO P2
  7101        WHEN OTHER
  7102           MOVE 15               TO P2
  7103     END-EVALUATE
  7104     .
  7105 0730-ENDBR.
  7106
  7107* EXEC CICS ENDBR
  7108*       DATASET  ('ERPDEF')
  7109*    END-EXEC
  7110     MOVE 'ERPDEF' TO DFHEIV1
  7111     MOVE 0
  7112       TO DFHEIV11
  7113*    MOVE '&2                    $   #00006534' TO DFHEIV0
  7114     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7115     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7116     MOVE X'2020233030303036353334' TO DFHEIV0(25:11)
  7117     CALL 'kxdfhei1' USING DFHEIV0,
  7118           DFHEIV1,
  7119           DFHEIV11,
  7120           DFHEIV99
  7121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7122     .
  7123 0730-EXIT.
  7124     EXIT.
  7125 0740-GET-ERCTBL.
  7126     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7127     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7128     MOVE 'A'                    TO CTBL-BEN-TYPE
  7129     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7130     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7131     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7132     IF RESP-NORMAL
  7133        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7134     ELSE
  7135        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7136        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7137        MOVE 'A'                    TO CTBL-BEN-TYPE
  7138        MOVE 'AA'                   TO CTBL-BEN-CODE
  7139        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7140        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7141        IF RESP-NORMAL
  7142           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7143        END-IF
  7144     END-IF
  7145     .
  7146 0740-EXIT.
  7147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 125
* SOCK03.cbl
  7148 0750-READ-ERCTBL.
  7149
  7150* EXEC CICS READ
  7151*         INTO    (COMM-TABLE-RECORD)
  7152*         DATASET ('ERCTBL')
  7153*         RIDFLD  (CTBL-KEY)
  7154*         RESP    (WS-RESPONSE)
  7155*    END-EXEC
  7156     MOVE LENGTH OF
  7157      COMM-TABLE-RECORD
  7158       TO DFHEIV11
  7159     MOVE 'ERCTBL' TO DFHEIV1
  7160*    MOVE '&"IL       E          (  N#00006564' TO DFHEIV0
  7161     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7163     MOVE X'204E233030303036353634' TO DFHEIV0(25:11)
  7164     CALL 'kxdfhei1' USING DFHEIV0,
  7165           DFHEIV1,
  7166           COMM-TABLE-RECORD,
  7167           DFHEIV11,
  7168           CTBL-KEY,
  7169           DFHEIV99,
  7170           DFHEIV99,
  7171           DFHEIV99
  7172     MOVE EIBRESP  TO WS-RESPONSE
  7173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7174     .
  7175 0750-EXIT.
  7176     EXIT.
  7177 0760-FIND-COMM.
  7178     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7179        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7180        OR (C1 > +3)
  7181     END-PERFORM
  7182     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7183        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7184        OR (C2 > +3)
  7185     END-PERFORM
  7186     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7187        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7188        OR (C3 > +3)
  7189     END-PERFORM
  7190     IF C1 > +3
  7191        MOVE +1                  TO C1
  7192     END-IF
  7193     IF C2 > +3
  7194        MOVE +1                  TO C2
  7195     END-IF
  7196     IF C3 > +3
  7197        MOVE +1                  TO C3
  7198     END-IF
  7199     IF C1 = +3
  7200        MOVE +18                 TO C0
  7201     ELSE
  7202        IF C1 = +2
  7203           MOVE +9               TO C0
  7204        END-IF
  7205     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 14:26 Page 126
* SOCK03.cbl
  7206     IF C2 = +3
  7207        ADD +6                   TO C0
  7208     ELSE
  7209        IF C2 = +2
  7210           ADD +3                TO C0
  7211        END-IF
  7212     END-IF
  7213     ADD C3                      TO C0
  7214     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7215     .
  7216 0760-EXIT.
  7217     EXIT.
  7218 9700-DATE-LINK.
  7219
  7220* EXEC CICS LINK
  7221*         PROGRAM  ('ELDATCV')
  7222*         COMMAREA (DATE-CONVERSION-DATA)
  7223*         LENGTH   (DC-COMM-LENGTH)
  7224*    END-EXEC.
  7225     MOVE 'ELDATCV' TO DFHEIV1
  7226*    MOVE '."C                   (   #00006615' TO DFHEIV0
  7227     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7229     MOVE X'2020233030303036363135' TO DFHEIV0(25:11)
  7230     CALL 'kxdfhei1' USING DFHEIV0,
  7231           DFHEIV1,
  7232           DATE-CONVERSION-DATA,
  7233           DC-COMM-LENGTH,
  7234           DFHEIV99,
  7235           DFHEIV99,
  7236           DFHEIV99,
  7237           DFHEIV99
  7238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7239
  7240 9700-EXIT.
  7241      EXIT.
  7242
  7243 9999-DFHBACK SECTION.
  7244     MOVE '9%                    "   ' TO DFHEIV0
  7245     MOVE 'SOCK03' TO DFHEIV1
  7246     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7247     GOBACK.
  7248 9999-DFHEXIT.
  7249     IF DFHEIGDJ EQUAL 0001
  7250         NEXT SENTENCE.
  7251     MOVE '9%                    "   ' TO DFHEIV0
  7252     MOVE 'SOCK03' TO DFHEIV1
  7253     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7254     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       20048     Code:       30189
