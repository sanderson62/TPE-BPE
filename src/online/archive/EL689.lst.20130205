* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL689 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:10:07.
     7*                            VMOD=2.037
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*DATE-COMPILED.
    12*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
    13*
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   2
* EL689.cbl
    14******************************************************************
    15
    16* W-FILE-USED REFERENCE LIST:
    17* (1)  ELCNTL - COMPANY
    18* (2)  ELCNTL - LIFE BENEFIT
    19* (3)  ELCNTL - A&H BENEFIT
    20* (4)  ELCNTL - CARRIER
    21* (5)  MAIL
    22* (6)  ERACCT
    23* (7)  USED FOR SYSTEM VARIABLES ?
    24* (8)  ELCERT
    25* (9)  PENDING BUSINESS
    26* (10) COMPENSATION
    27* (11) ELCNTL - PROCESSOR DATA ?
    28* (12) ERCHEK
    29* (13) ERPYAJ
    30* (14) NOT USED
    31* (15) NOT USED
    32* (16) NOT USED
    33* (17) NOT USED
    34* (18) NOT USED
    35* (19) NOT USED
    36* (20) NOT USED
    37*
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 101501    2001100100006  SMVA  ADD USERID to screen header
    47*                                ADJUSTED REDEFINES EL689AI FILLER
    48* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    49* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    50* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    51* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    52* 092908    2008013100006  PEMA  MOVE VAR 154
    53* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    54* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    55* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    56* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    57* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    58* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    59* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    60* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    61* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    62* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    63* 122011  CR2011022800001  AJRA  NAPERSOFT
    64* 090612  IR2012090600001  AJRA  NAPERSOFT
    65* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    66* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    67* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    68* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    69* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    70* 011013  CR2012101700002  AJRA  CHECK REQ REASON CODE IND
    71******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   3
* EL689.cbl
    72
    73 DATA DIVISION.
    74 WORKING-STORAGE SECTION.
    75 01  DFH-START PIC X(04).
    76 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    77 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    78                                   USAGE POINTER.
    79 77  FILLER  PIC X(32) VALUE '********************************'.
    80 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    81 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    82 01  P pointer.
    83 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    84 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    85 01  var-ptr pointer.
    86 01  env-var-len                 pic 9(4)  binary.
    87 01  rc                          pic 9(9)  binary.
    88 01  WS-KIXHOST                  PIC X(10).
    89 01  WS-KIXSYS.
    90     05  WS-KIX-FIL1             PIC X(10).
    91     05  WS-KIX-APPS             PIC X(10).
    92     05  WS-KIX-ENV              PIC X(10).
    93     05  WS-KIX-MYENV            PIC X(10).
    94     05  WS-KIX-SYS              PIC X(10).
    95 01 srch-commarea.
    96*                                copy ELCADLTRSPI.
    97******************************************************************
    98*                   C H A N G E   L O G
    99*
   100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   101*-----------------------------------------------------------------
   102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   103* EFFECTIVE    NUMBER
   104*-----------------------------------------------------------------
   105* 060611    2011022800001  PEMA  NEW COPYBOOK
   106* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   107* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   108******************************************************************
   109****************************************
   110*  commarea for NaperSoft On Demand Admin services letters
   111*  (business logic input & output)
   112****************************************
   113     03  BL-INPUT.
   114         05  BL-DATA-SRCE        PIC X.
   115         05  BL-LETTER-ID        PIC XXXX.
   116         05  BL-CARRIER          PIC X.
   117         05  BL-GROUP            PIC X(6).
   118         05  BL-STATE            PIC XX.
   119         05  BL-ACCOUNT          PIC X(10).
   120         05  BL-EFF-DT           PIC X(10).
   121         05  BL-CERT-NO          PIC X(11).
   122         05  BL-BATCH-NO         PIC X(6).
   123         05  BL-BATCH-SEQ        PIC 9(8).
   124         05  BL-RESP-NO          PIC X(10).
   125         05  BL-NO-OF-COPIES     PIC 99.
   126         05  BL-PROC-ID          PIC XXXX.
   127         05  BL-COMP-ID          PIC XXX.
   128         05  BL-PRINT-NOW-SW     PIC X.
   129         05  BL-ENC-CD           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   4
* EL689.cbl
   130         05  BL-RESEND-DT        PIC X(10).
   131         05  BL-FOLLOW-UP-DT     PIC X(10).
   132         05  BL-ARCHIVE-NO       PIC 9(8).
   133         05  BL-FUNC             PIC X(8).
   134         05  BL-COMMENTS         PIC X(100).
   135         05  FILLER REDEFINES BL-COMMENTS.
   136             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   137             10  BL-LETTER-TO-ACCT PIC X.
   138             10  BL-LETTER-TO-BENE PIC X.
   139             10  BL-WRITE-ERARCH   PIC X.
   140                 88  ERARCH-QWS      VALUE 'Q'.
   141                 88  ERARCH-BATCH    VALUE 'B'.
   142                 88  ERARCH-TEMP     VALUE 'T'.
   143             10  BL-PROCESS-TYPE PIC X(07).
   144             10  BL-CERT-FORM-ID PIC X(05).
   145             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   146             10  BL-SOURCE-SCREEN PIC X(8).
   147             10  FILLER          PIC X(25).
   148     03  BL-OUTPUT.
   149         05  BL-STATUS                   PIC X.
   150             88  BL-OK                      VALUE "P".
   151             88  BL-FAIL                  VALUE "F".
   152         05  BL-MESSAGE          PIC X(50).
   153     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   154     03  FILLER                  PIC X(31).
   155 01  W-WORK-AREAS.
   156     12  FILLER                  PIC  X(18)
   157                                      VALUE 'PROGRAM WORK AREA:'.
   158
   159     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   160     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   161     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   162     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   163     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   164     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   165     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   166     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   167     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   168     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   169
   170     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   171     12  W-DIFFERENCE            PIC S9(07)V9(02)
   172                                            VALUE +0   COMP-3.
   173     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   174     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   175     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   176     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
   177     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   178     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   179     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   180     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   181     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   182     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   183     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   184     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   185     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   186     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   187     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   5
* EL689.cbl
   188     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   189     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   190     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   191     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   192     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   193     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   194     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   195     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   196     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   197     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   198                                            VALUE +0   COMP-3.
   199
   200     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   201     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   202         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   203     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   204     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   205     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   206     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   207     12  W-SAVE-REVISION         PIC  9(03) value 0.
   208     12  W-DISPLAY-3             PIC  9(03) value 0.
   209     12  W-DISPLAY-8             PIC  9(08) value 0.
   210     12  W-DISPLAY-7             PIC  9(07) value 0.
   211     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   212     12  W-EDIT-3-0              PIC  ZZ9.
   213     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   214     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   215     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   216     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   217
   218     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   219         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   220
   221     12  W-ARCH-SUPPRESS         PIC 99999999.
   222     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   223                                 PIC  X(08).
   224     12  W-COMP-WORK-AREA.
   225         16  W-CWA-CHAR OCCURS 10 TIMES
   226                                 PIC  X(01).
   227     12  W-INCOMING-ARCHIVE      PIC  X(08).
   228     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   229                                 PIC  9(08).
   230
   231     12  W-BATCH-BREAKDOWN.
   232         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   233         16  W-BATCH-SEQ         PIC S9(04) COMP.
   234     12  W-BEN-HOLD              PIC  X(02).
   235     12  W-BENEFIT-WORK          PIC  X(03).
   236     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   237         16  W-ELIM-DAYS         PIC  X(02).
   238         16  FILLER              PIC  X(01).
   239     12  W-CALL-PGM              PIC  X(08).
   240     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   241
   242     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   243     12  W-LINE-CONTROL-RECORD.
   244         16  W-LC-LINE-WIDTH     PIC  9(02).
   245         16  FILLER              PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   6
* EL689.cbl
   246         16  W-LC-PARAGRAPH-INDENT
   247                                 PIC  9(02).
   248         16  FILLER              PIC  X(01).
   249         16  W-LC-MAX-LINES-PER-PAGE
   250                                 PIC  9(02).
   251         16  FILLER              PIC  X(01).
   252         16  W-LC-LINE-ADJUST    PIC  9(02).
   253         16  FILLER              PIC  X(01).
   254         16  W-LC-LINE-INDENT-1  PIC  9(02).
   255         16  FILLER              PIC  X(01).
   256         16  W-LC-LINE-INDENT-2  PIC  9(02).
   257         16  FILLER              PIC  X(01).
   258         16  W-LC-LINE-INDENT-3  PIC  9(02).
   259         16  FILLER              PIC  X(01).
   260         16  W-LC-LINE-INDENT-4  PIC  9(02).
   261         16  FILLER              PIC  X(01).
   262         16  W-LC-LINE-INDENT-5  PIC  9(02).
   263         16  FILLER              PIC  X(01).
   264         16  W-LC-TOP-MARGIN     PIC  9(02).
   265         16  FILLER              PIC  X(01).
   266         16  W-LC-CASE-IND       PIC  X(01).
   267             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   268         16  FILLER              PIC  X(01).
   269         16  W-LC-PAGE-IND       PIC  X(01).
   270             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   271     12  W-DATE-WORK             PIC  9(07).
   272     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   273         16  FILLER              PIC  X(02).
   274         16  W-DT-WORK           PIC  9(05).
   275
   276     12  W-DEEDIT-FIELD          PIC  X(15).
   277     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   278
   279     12  W-EDIT-DATE-1.
   280         16  W-ED1-MM            PIC  X(02).
   281         16  FILLER              PIC  X(01) VALUE '/'.
   282         16  W-ED1-DD            PIC  X(02).
   283         16  FILLER              PIC  X(01) VALUE '/'.
   284         16  W-ED1-YY            PIC  X(02).
   285
   286     12  W-EDIT-DATE-2.
   287         16  W-ED2-DD            PIC  X(02).
   288         16  FILLER              PIC  X(01) VALUE '/'.
   289         16  W-ED2-MM            PIC  X(02).
   290         16  FILLER              PIC  X(01) VALUE '/'.
   291         16  W-ED2-YY            PIC  X(02).
   292
   293     12  W-LABEL-HOLD-AREA.
   294         16  W-LABEL-LINES OCCURS 6 TIMES.
   295             20  W-LABEL-ZIP.
   296                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   297                 24  W-LABEL-DASH     PIC  X(01).
   298                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   299             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   300                 24  W-LAB-CAN-POSTAL-CD-1
   301                                      PIC  X(03).
   302                 24  W-LAB-CAN-DASH   PIC  X(01).
   303                 24  W-LAB-CAN-POSTAL-CD-2
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   7
* EL689.cbl
   304                                      PIC  X(03).
   305                 24  W-LAB-CAN-FILLER PIC  X(03).
   306             20  FILLER               PIC  X(10).
   307             20  W-LAST-ZIP.
   308                 24  W-LAST-1ST-ZIP   PIC  X(05).
   309                 24  W-LABEL-DASH-LAST
   310                                      PIC  X(01).
   311                 24  W-LAST-2ND-ZIP   PIC  X(04).
   312             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   313                 24  W-LAST-CAN-POSTAL-CD-1
   314                                      PIC  X(03).
   315                 24  W-LAST-CAN-DASH  PIC  X(01).
   316                 24  W-LAST-CAN-POSTAL-CD-2
   317                                      PIC  X(03).
   318                 24  W-LAST-CAN-FILLER
   319                                      PIC  X(03).
   320
   321     12  W-LAST-CHAR             PIC  X(01).
   322         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   323     12  W-LAST-SQ-CHAR          PIC  X(01).
   324
   325     12  W-LINE-NUM.
   326         16  W-LINE1             PIC  X(01).
   327         16  W-LINE23            PIC  9(02).
   328     12  W-LIN-NUM REDEFINES W-LINE-NUM
   329                                 PIC  9(03).
   330
   331     12  W-NAME-LAST             PIC  X(15).
   332     12  W-NAME-FIRST.
   333         16  W-NAME-FIRST-INIT   PIC  X(01).
   334         16  W-NAME-FIRST-REMAIN PIC  X(14).
   335     12  W-NAME-MIDDLE.
   336         16  FILLER              PIC  X(01).
   337         16  W-NAME-MIDDLE-2     PIC  X(01).
   338         16  FILLER              PIC  X(13).
   339
   340     12  W-PAGE-PRT.
   341         16  FILLER              PIC  X(34) VALUE SPACES.
   342         16  W-PAGE-NUMBER       PIC  Z9.
   343         16  FILLER              PIC  X(01) VALUE '.'.
   344         16  FILLER              PIC  X(33) VALUE SPACES.
   345
   346     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   347     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   348         16  FILLER              PIC  9(01).
   349         16  W-PHI-AREA          PIC  9(03).
   350         16  W-PHI-PFX           PIC  9(03).
   351         16  W-PHI-SFX           PIC  9(04).
   352     12  W-PHONE-OUT.
   353         16  W-PO-AREA           PIC  X(03).
   354         16  FILLER              PIC  X(01) VALUE '-'.
   355         16  W-PO-PFX            PIC  X(03).
   356         16  FILLER              PIC  X(01) VALUE '-'.
   357         16  W-PO-SFX            PIC  X(04).
   358
   359     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   360     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   361     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   8
* EL689.cbl
   362
   363     12  W-SINGLE-LINE           PIC  X(70).
   364     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   365         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   366                                 PIC  X(01).
   367
   368     12  W-SQUEEZED-LINE.
   369         16  W-SQ-CHAR OCCURS 70 TIMES
   370                       INDEXED BY W-SQ-NDX
   371                                 PIC  X(01).
   372
   373     12  W-TIME-IN               PIC S9(07).
   374     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   375         16  FILLER              PIC  X(01).
   376         16  W-TIME-OUT          PIC  99V9(02).
   377         16  FILLER              PIC  X(02).
   378
   379     12  W-TS-NAME-TEXT.
   380         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   381         16  W-TS-ID-TIME
   382             REDEFINES W-TS-ID-TEXT
   383                                 PIC S9(07) COMP-3.
   384         16  W-TS-TERM-TEXT.
   385             20 W-TS-TERM-PREFIX PIC  X(02).
   386             20 FILLER           PIC  X(02).
   387     12  W-TS-NAME-SCREEN.
   388         16  FILLER              PIC  X(04) VALUE '689X'.
   389         16  W-TS-TERM-SCREEN    PIC  X(04).
   390
   391     12  W-WORK-LINE.
   392         16  W-WORK-CHAR OCCURS 70 TIMES
   393                       INDEXED BY W-WC-NDX
   394                                  W-WC-NDX2
   395                                  W-WC-NDX3
   396                                 PIC  X(01).
   397
   398     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   399     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   400         16  W-WORK-ZIP5         PIC  X(05).
   401         16  W-WORK-ZIP4         PIC  X(04).
   402     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   403         16  W-CAN-POSTAL-CD-1.
   404             20  FILLER          PIC  X(01).
   405                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   406             20  FILLER          PIC  X(02).
   407         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   408         16  W-FILLER            PIC  X(03).
   409
   410**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   411*                   COPY ELCZREC.
   412******************************************************************
   413*                                                                *
   414*                                                                *
   415*                            ELCZREC.                            *
   416*                                                                *
   417*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   418*                                                                *
   419******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   9
* EL689.cbl
   420*-----------------------------------------------------------------
   421*                   C H A N G E   L O G
   422*
   423* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   424*-----------------------------------------------------------------
   425*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   426* EFFECTIVE    NUMBER
   427*-----------------------------------------------------------------
   428* 122011    2011022800001  AJRA  NEW FILE
   429* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   430* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   431*-----------------------------------------------------------------
   432 01  W-Z-CONTROL-DATA.
   433     05  W-NUMBER-OF-COPIES      PIC  9.
   434     05  FILLER                  PIC  X.
   435     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   436     05  FILLER                  PIC  X.
   437     05  W-DAYS-TO-RESEND        PIC  999.
   438     05  FILLER                  PIC  X.
   439     05  W-FORM-TO-RESEND        PIC  X(4).
   440     05  FILLER                  PIC  X.
   441     05  W-PROMPT-LETTER         PIC  X.
   442     05  FILLER                  PIC  X.
   443     05  W-ENCLOSURE-CD          PIC  XXX.
   444     05  FILLER                  PIC  X.
   445     05  W-AUTO-CLOSE-IND        PIC  X.
   446     05  FILLER                  PIC  X.
   447     05  W-LETTER-TO-BENE        PIC  X.
   448     05  FILLER                  PIC  X.
   449     05  W-LETTER-TO-ACCT        PIC  X.
   450     05  FILLER                  PIC  X.
   451     05  W-LETTER-TYPE           PIC  X.
   452     05  FILLER                  PIC  X.
   453     05  W-PRINT-CERTIFICATE     PIC  X.
   454     05  FILLER                  PIC  X.
   455     05  W-REFUND-REQUIRED       PIC  X.
   456     05  FILLER                  PIC  X.
   457     05  W-ONBASE-CODE           PIC  XX.
   458     05  FILLER                  PIC  X.
   459     05  W-ACCT-SUMM             PIC  X.
   460     05  FILLER                  PIC  X.
   461     05  W-CSO-SUMM              PIC  X.
   462     05  FILLER                  PIC  X.
   463     05  W-REASONS-REQUIRED      PIC  X.
   464     05  FILLER                  PIC  X(29).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  10
* EL689.cbl
   466 01  W-SWITCH-INDICATORS-AREA.
   467     12  FILLER                  PIC  X(16)
   468                                      VALUE 'PROGRAM SWITCHS:'.
   469     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   470         88  W-ADDRESS-ONLY      VALUE 'Y'.
   471         88  W-FULL-DATA         VALUE ' '.
   472     12  W-ACCT-BROWSE-STARTED-SW
   473                                 PIC  X(01) VALUE 'N'.
   474         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   475     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   476     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   477         88  W-CERT-FOUND                   VALUE 'Y'.
   478     12  W-CHARACTER-TYPE        PIC  X(01).
   479         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   480         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   481         88  W-SPACE             VALUE ' '.
   482     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   483         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   484     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   485         88  W-DATA-SHRINKING    VALUE 'Y'.
   486     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   487         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   488     12  W-FIRST-BAD-VARIABLE-IND
   489                                 PIC  X(01) VALUE SPACES.
   490         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   491     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   492         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   493         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   494     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   495         88  W-FORM-CHANGED                 VALUE 'Y'.
   496     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   497         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   498         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   499     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   500         88  W-HOLD-ON                      VALUE 'Y'.
   501         88  W-HOLD-OFF                     VALUE ' '.
   502     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   503         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   504         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   505     12  W-KEY-FIELDS-CHANGED-IND
   506                                 PIC  X(01) VALUE ' '.
   507         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   508         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   509     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   510         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   511     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   512         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   513                                                   'T' 'U'.
   514         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   515                                                   'G' 'H'.
   516         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   517         88  W-DO-NOT-ADJUST                VALUE 'N'.
   518         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   519         88  W-AS-IS                        VALUE 'A' 'N'.
   520         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   521                                                   '4' '5'.
   522
   523     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  11
* EL689.cbl
   524         88  W-PNDB-FOUND                   VALUE 'Y'.
   525     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   526         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   527     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   528         88  W-REVERSE-DATE                 VALUE 'Y'.
   529     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   530         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   531         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   532
   533     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   534         88  W-VALID-ENDT                   VALUE 'Y'.
   535     12  W-RESPONSE              PIC S9(8)   COMP.
   536         88  RESP-NORMAL                  VALUE +00.
   537         88  RESP-NOTFND                  VALUE +13.
   538         88  RESP-DUPREC                  VALUE +14.
   539         88  RESP-DUPKEY                  VALUE +15.
   540         88  RESP-NOTOPEN                 VALUE +19.
   541         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  12
* EL689.cbl
   543 01  WS-SAVE-AREA.
   544     12  WS-SAV-AM-DEFN-1.
   545         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   546             20  WS-SAV-AM-AGT             PIC  X(10).
   547             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   548             20  FILLER                    PIC  X(15).
   549     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   550     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   551     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   552     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   553     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   554     12  WS-SAV-AM-NAME                    PIC  X(30).
   555     12  WS-SAV-AM-PERSON                  PIC  X(30).
   556     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   557     12  WS-SAV-AM-CITY                    PIC  X(30).
   558     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   559     12  WS-SAV-AM-ZIP.
   560         16  WS-SAV-AM-ZIP-PRIME.
   561             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   562                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   563                     'A' THRU 'Z'.
   564             20  FILLER                    PIC  X(04).
   565         16  FILLER                        PIC  X(04).
   566     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   567                        WS-SAV-AM-ZIP      PIC  X(09).
   568     12  WS-SAV-AM-TEL-NO.
   569         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   570         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   571         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   572 01  W-KEY-AREAS.
   573     12  FILLER                    PIC  X(13)
   574                                      VALUE 'PROGRAM KEYS:'.
   575
   576     12  W-ACCT-SAVE-KEY           PIC  X(20).
   577     12  W-ACCT-KEY.
   578         16  W-ACCT-PARTIAL-KEY.
   579             20  W-ACCT-COMPANY-CD PIC  X(01).
   580             20  W-ACCT-CARRIER    PIC  X(01).
   581             20  W-ACCT-GROUPING   PIC  X(06).
   582             20  W-ACCT-STATE      PIC  X(02).
   583             20  W-ACCT-ACCOUNT    PIC  X(10).
   584         16  W-ACCT-EXP-DT         PIC  X(02).
   585
   586     12  W-ARCH-SAVE-KEY         PIC  X(05).
   587     12  W-ARCH-KEY.
   588         16  W-ARCH-PARTIAL-KEY.
   589             20  W-ARCH-COMPANY-CD
   590                                 PIC  X(01).
   591             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   592         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   593
   594     12  W-ARCT-KEY.
   595         16  W-ARCT-PARTIAL-KEY.
   596             20  W-ARCT-COMPANY-CD
   597                                 PIC  X(01).
   598             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   599         16  W-ARCT-REC-TYPE     PIC  X(01).
   600         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  13
* EL689.cbl
   601
   602     12  W-CERT-KEY.
   603         16  W-CERT-COMPANY-CD   PIC  X(01).
   604         16  W-CERT-CARRIER      PIC  X(01).
   605         16  W-CERT-GROUPING     PIC  X(06).
   606         16  W-CERT-STATE        PIC  X(02).
   607         16  W-CERT-ACCOUNT      PIC  X(10).
   608         16  W-CERT-EFF-DT       PIC  X(02).
   609         16  W-CERT-CERT-NO.
   610             20  W-CERT-CERT-PRIME
   611                                 PIC  X(10).
   612             20  W-CERT-CERT-SFX PIC  X(01).
   613
   614     12  W-CHEK-KEY.
   615         16  W-CHEK-COMPANY-CD   PIC  X(01).
   616         16  W-CHEK-CARRIER      PIC  X(01).
   617         16  W-CHEK-GROUPING     PIC  X(06).
   618         16  W-CHEK-STATE        PIC  X(02).
   619         16  W-CHEK-ACCOUNT      PIC  X(10).
   620         16  W-CHEK-EFF-DT       PIC  X(02).
   621         16  W-CHEK-CERT-NO.
   622             20  W-CHEK-CERT-PRIME
   623                                 PIC  X(10).
   624             20  W-CHEK-CERT-SFX PIC  X(01).
   625         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   626
   627     12  W-CNTL-KEY.
   628         16  W-CNTL-COMPANY-ID   PIC  X(03).
   629         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   630         16  W-CNTL-GENL.
   631             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   632             20  W-CNTL-GEN2.
   633                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   634                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   635         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   636
   637     12  W-COMP-SAVE-KEY         PIC  X(29).
   638     12  W-COMP-KEY.
   639         16  W-COMP-COMPANY-CD   PIC  X(01).
   640         16  W-COMP-CARRIER      PIC  X(01).
   641         16  W-COMP-GROUPING     PIC  X(06).
   642         16  W-COMP-RESP-PERSON.
   643             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   644                                INDEXED BY W-COMP-NDX
   645                                 PIC  X(01).
   646         16  W-COMP-ACCOUNT      PIC  X(10).
   647         16  W-COMP-TYPE         PIC  X(01).
   648
   649     12  W-DELETE-KEY.
   650         16  W-DELETE-PARTIAL-KEY.
   651             20  W-DELETE-COMPANY-CD
   652                                 PIC  X(01).
   653             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   654         16  W-DELETE-RECORD-TYPE
   655                                 PIC  X(01).
   656         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   657
   658     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  14
* EL689.cbl
   659         16  W-MAIL-COMPANY-CD   PIC  X(01).
   660         16  W-MAIL-CARRIER      PIC  X(01).
   661         16  W-MAIL-GROUPING     PIC  X(06).
   662         16  W-MAIL-STATE        PIC  X(02).
   663         16  W-MAIL-ACCOUNT      PIC  X(10).
   664         16  W-MAIL-EFF-DT       PIC  X(02).
   665         16  W-MAIL-CERT-NO.
   666             20  W-MAIL-CERT-PRIME
   667                                 PIC  X(10).
   668             20  W-MAIL-CERT-SFX PIC  X(01).
   669
   670     12  W-PNDB-KEY.
   671         16  W-PNDB-COMPANY-CD   PIC  X(01).
   672         16  W-PNDB-ENTRY        PIC  X(06).
   673         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   674         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   675
   676     12  W-PNDB2-KEY.
   677         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   678         16  W-PNDB2-CARRIER     PIC  X(01).
   679         16  W-PNDB2-GROUPING    PIC  X(06).
   680         16  W-PNDB2-STATE       PIC  X(02).
   681         16  W-PNDB2-ACCOUNT     PIC  X(10).
   682         16  W-PNDB2-EFF-DT      PIC  X(02).
   683         16  W-PNDB2-CERT-NO.
   684             20  W-PNDB2-CERT-PRIME
   685                                 PIC  X(10).
   686             20  W-PNDB2-CERT-SFX
   687                                 PIC  X(01).
   688         16  W-PNDB2-ALT-CHG-SEQ-NO
   689                                 PIC S9(04)  COMP.
   690         16  W-PNDB2-TYPE        PIC  X(01).
   691
   692     12  W-PYAJ-KEY.
   693         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   694         16  W-PYAJ-CARRIER      PIC  X(01).
   695         16  W-PYAJ-GROUPING     PIC  X(06).
   696         16  W-PYAJ-FIN-RESP     PIC  X(10).
   697         16  W-PYAJ-ACCOUNT      PIC  X(10).
   698         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   699         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   700
   701     12  W-SC-QUID-KEY.
   702         16  W-SC-QUID-TERMINAL  PIC  X(04).
   703         16  W-SC-QUID-SYSTEM    PIC  X(04).
   704
   705     12  W-TEXT-SAVE-KEY         PIC  X(05).
   706     12  W-TEXT-KEY.
   707         16  W-TEXT-PARTIAL-KEY.
   708             20  W-TEXT-COMPANY-CD
   709                                 PIC  X(01).
   710             20  W-TEXT-LETTER   PIC  X(04).
   711         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   712         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   713
   714     12  W-ERENDT-KEY-BY-ARCH.
   715         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   716         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  15
* EL689.cbl
   717
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  16
* EL689.cbl
   719 01  FILLER                      PIC  X(22)
   720                                 VALUE 'INTERFACE AREA STARTS:'.
   721*    COPY ELCINTF.
   722******************************************************************
   723*                                                                *
   724*                                                                *
   725*                            ELCINTF.                            *
   726*                            VMOD=2.017                          *
   727*                                                                *
   728*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   729*                                                                *
   730*       LENGTH = 1024                                            *
   731*                                                                *
   732******************************************************************
   733*                   C H A N G E   L O G
   734*
   735* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   736*-----------------------------------------------------------------
   737*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   738* EFFECTIVE    NUMBER
   739*-----------------------------------------------------------------
   740* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   741******************************************************************
   742 01  PROGRAM-INTERFACE-BLOCK.
   743     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   744     12  PI-CALLING-PROGRAM              PIC X(8).
   745     12  PI-SAVED-PROGRAM-1              PIC X(8).
   746     12  PI-SAVED-PROGRAM-2              PIC X(8).
   747     12  PI-SAVED-PROGRAM-3              PIC X(8).
   748     12  PI-SAVED-PROGRAM-4              PIC X(8).
   749     12  PI-SAVED-PROGRAM-5              PIC X(8).
   750     12  PI-SAVED-PROGRAM-6              PIC X(8).
   751     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   752     12  PI-COMPANY-ID                   PIC XXX.
   753     12  PI-COMPANY-CD                   PIC X.
   754
   755     12  PI-COMPANY-PASSWORD             PIC X(8).
   756
   757     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   758
   759     12  PI-CONTROL-IN-PROGRESS.
   760         16  PI-CARRIER                  PIC X.
   761         16  PI-GROUPING                 PIC X(6).
   762         16  PI-STATE                    PIC XX.
   763         16  PI-ACCOUNT                  PIC X(10).
   764         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   765                                         PIC X(10).
   766         16  PI-CLAIM-CERT-GRP.
   767             20  PI-CLAIM-NO             PIC X(7).
   768             20  PI-CERT-NO.
   769                 25  PI-CERT-PRIME       PIC X(10).
   770                 25  PI-CERT-SFX         PIC X.
   771             20  PI-CERT-EFF-DT          PIC XX.
   772         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   773             20  PI-PLAN-CODE            PIC X(2).
   774             20  PI-REVISION-NUMBER      PIC X(3).
   775             20  PI-PLAN-EFF-DT          PIC X(2).
   776             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  17
* EL689.cbl
   777             20  FILLER                  PIC X(11).
   778         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   779             20  PI-OE-REFERENCE-1.
   780                 25  PI-OE-REF-1-PRIME   PIC X(18).
   781                 25  PI-OE-REF-1-SUFF    PIC XX.
   782
   783     12  PI-SESSION-IN-PROGRESS          PIC X.
   784         88  CLAIM-SESSION                   VALUE '1'.
   785         88  CREDIT-SESSION                  VALUE '2'.
   786         88  WARRANTY-SESSION                VALUE '3'.
   787         88  MORTGAGE-SESSION                VALUE '4'.
   788         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   789
   790
   791*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   792
   793     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   794     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   795
   796     12  PI-CREDIT-USER                  PIC X.
   797         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   798         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   799
   800     12  PI-CLAIM-USER                   PIC X.
   801         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   802         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   803
   804     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   805         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   806         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   807         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   808         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   809         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   810
   811     12  PI-PROCESSOR-ID                 PIC X(4).
   812
   813     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   814
   815     12  PI-MEMBER-CAPTION               PIC X(10).
   816
   817     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   818         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   819
   820     12  PI-LIFE-OVERRIDE-L1             PIC X.
   821     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   822     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   823     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   824
   825     12  PI-AH-OVERRIDE-L1               PIC X.
   826     12  PI-AH-OVERRIDE-L2               PIC XX.
   827     12  PI-AH-OVERRIDE-L6               PIC X(6).
   828     12  PI-AH-OVERRIDE-L12              PIC X(12).
   829
   830     12  PI-NEW-SYSTEM                   PIC X(2).
   831
   832     12  PI-PRIMARY-CERT-NO              PIC X(11).
   833     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   834         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  18
* EL689.cbl
   835     12  PI-CRDTCRD-SYSTEM.
   836         16  PI-CRDTCRD-USER             PIC X.
   837             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   838             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   839         16  PI-CC-MONTH-END-DT          PIC XX.
   840     12  PI-PROCESSOR-PRINTER            PIC X(4).
   841
   842     12  PI-OE-REFERENCE-2.
   843         16  PI-OE-REF-2-PRIME           PIC X(10).
   844         16  PI-OE-REF-2-SUFF            PIC X.
   845
   846     12  PI-REM-TRM-CALC-OPTION          PIC X.
   847
   848     12  PI-LANGUAGE-TYPE                PIC X.
   849             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   850             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   851             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   852
   853     12  PI-POLICY-LINKAGE-IND           PIC X.
   854         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   855         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   856                                                   LOW-VALUES.
   857
   858     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   859     12  PI-CLAIM-PW-SESSION             PIC X(1).
   860         88  PI-CLAIM-CREDIT                 VALUE '1'.
   861         88  PI-CLAIM-CONVEN                 VALUE '2'.
   862
   863     12  PI-PROCESSOR-CSR-IND            PIC X.
   864         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   865         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   866
   867     12  FILLER                          PIC X(3).
   868
   869     12  PI-SYSTEM-LEVEL                 PIC X(145).
   870
   871     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   872         PI-SYSTEM-LEVEL.
   873
   874         16  PI-ENTRY-CODES.
   875             20  PI-ENTRY-CD-1           PIC X.
   876             20  PI-ENTRY-CD-2           PIC X.
   877
   878         16  PI-RETURN-CODES.
   879             20  PI-RETURN-CD-1          PIC X.
   880             20  PI-RETURN-CD-2          PIC X.
   881
   882         16  PI-UPDATE-STATUS-SAVE.
   883             20  PI-UPDATE-BY            PIC X(4).
   884             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   885
   886         16  PI-LOWER-CASE-LETTERS       PIC X.
   887             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   888
   889*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   890*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   891*            88  CARRIER-CLM-CNTL            VALUE '2'.
   892
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  19
* EL689.cbl
   893         16  PI-CERT-ACCESS-CONTROL      PIC X.
   894             88  ST-ACCNT-CNTL               VALUE ' '.
   895             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   896             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   897             88  ACCNT-CNTL                  VALUE '3'.
   898             88  CARR-ACCNT-CNTL             VALUE '4'.
   899
   900         16  PI-PROCESSOR-CAP-LIST.
   901             20  PI-SYSTEM-CONTROLS.
   902                24 PI-SYSTEM-DISPLAY     PIC X.
   903                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   904                24 PI-SYSTEM-MODIFY      PIC X.
   905                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   906             20  FILLER                  PIC XX.
   907             20  PI-DISPLAY-CAP          PIC X.
   908                 88  DISPLAY-CAP             VALUE 'Y'.
   909             20  PI-MODIFY-CAP           PIC X.
   910                 88  MODIFY-CAP              VALUE 'Y'.
   911             20  PI-MSG-AT-LOGON-CAP     PIC X.
   912                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   913             20  PI-FORCE-CAP            PIC X.
   914                 88  FORCE-CAP               VALUE 'Y'.
   915
   916         16  PI-PROGRAM-CONTROLS.
   917             20  PI-PGM-PRINT-OPT        PIC X.
   918             20  PI-PGM-FORMAT-OPT       PIC X.
   919             20  PI-PGM-PROCESS-OPT      PIC X.
   920             20  PI-PGM-TOTALS-OPT       PIC X.
   921
   922         16  PI-HELP-INTERFACE.
   923             20  PI-LAST-ERROR-NO        PIC X(4).
   924             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   925
   926         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   927             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   928
   929         16  PI-CR-CONTROL-IN-PROGRESS.
   930             20  PI-CR-CARRIER           PIC X.
   931             20  PI-CR-GROUPING          PIC X(6).
   932             20  PI-CR-STATE             PIC XX.
   933             20  PI-CR-ACCOUNT           PIC X(10).
   934             20  PI-CR-FIN-RESP          PIC X(10).
   935             20  PI-CR-TYPE              PIC X.
   936
   937         16  PI-CR-BATCH-NUMBER          PIC X(6).
   938
   939         16  PI-CR-MONTH-END-DT          PIC XX.
   940
   941         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   942             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   943             88  PI-ZERO-CARRIER             VALUE '1'.
   944             88  PI-ZERO-GROUPING            VALUE '2'.
   945             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   946
   947         16  PI-CARRIER-SECURITY         PIC X.
   948             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   949
   950         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  20
* EL689.cbl
   951             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   952             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   953
   954         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   955             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   956                                         INDEXED BY PI-ACCESS-NDX
   957                                         PIC X.
   958
   959         16  PI-GA-BILLING-CONTROL       PIC X.
   960             88  PI-GA-BILLING               VALUE '1'.
   961
   962         16  PI-MAIL-PROCESSING          PIC X.
   963             88  PI-MAIL-YES                 VALUE 'Y'.
   964
   965         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   966
   967         16  PI-AR-SYSTEM.
   968             20  PI-AR-PROCESSING-CNTL   PIC X.
   969                 88  PI-AR-PROCESSING        VALUE 'Y'.
   970             20  PI-AR-SUMMARY-CODE      PIC X(6).
   971             20  PI-AR-MONTH-END-DT      PIC XX.
   972
   973         16  PI-MP-SYSTEM.
   974             20  PI-MORTGAGE-USER            PIC X.
   975                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   976                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   977             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   978                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   979                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   980                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   981                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   982                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   983             20  PI-MP-MONTH-END-DT          PIC XX.
   984             20  PI-MP-REFERENCE-NO.
   985                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   986                 24  PI-MP-REFERENCE-SFX     PIC XX.
   987
   988         16  PI-LABEL-CONTROL            PIC X(01).
   989             88  PI-CREATE-LABELS                    VALUE 'Y'.
   990             88  PI-BYPASS-LABELS                    VALUE 'N'.
   991
   992         16  PI-BILL-GROUPING-CODE       PIC X(01).
   993             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   994
   995         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   996             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   997             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   998
   999         16  FILLER                      PIC X(14).
  1000
  1001     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1002******************************************************************
  1003     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1004*    COPY ELC1042.
  1005******************************************************************
  1006*                                                                *
  1007*                                                                *
  1008*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  21
* EL689.cbl
  1009*                            VMOD=2.002                          *
  1010*                                                                *
  1011*    NOTE                                                        *
  1012*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1013*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1014*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1015*        TO THESE PROGRAMS.                                      *
  1016*                                                                *
  1017*    NOTE                                                        *
  1018*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1019*        USE ONLY!                                               *
  1020*                                                                *
  1021******************************************************************
  1022
  1023         16  PI-1042-WA.
  1024             20  PI-ACTION       PIC  X(01).
  1025                 88 PI-SHOW-MODE           VALUE '1'.
  1026                 88 PI-CLEAR-MODE          VALUE '2'.
  1027                 88 PI-CREATE-MODE         VALUE '3'.
  1028             20  PI-COMM-CONTROL PIC  X(12).
  1029             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1030             20  PI-EOF-SW       PIC  X(01).
  1031                 88  PI-FILE-EOF           VALUE 'Y'.
  1032             20  PI-FILETYP      PIC  X(01).
  1033             20  PI-FORM-SQUEEZE-CONTROL
  1034                                 PIC  X(01).
  1035                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1036                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1037             20  PI-LAST-CONTROL PIC  X(12).
  1038             20  PI-TEMP-STOR-ITEMS
  1039                                 PIC S9(04) COMP.
  1040             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1041             20  PI-UPDATE-SW    PIC  9(01).
  1042                 88 ANY-UPDATES            VALUE 1.
  1043             20  PI-104-SCREEN-SENT-IND
  1044                                 PIC  X(01).
  1045                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1046                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1047             20  PI-1042-SCREEN-SENT-IND
  1048                                 PIC  X(01).
  1049                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1050                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1051             20  PI-1042-ARCHIVE-IND
  1052                                 PIC  X(01).
  1053                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1054             20  FILLER          PIC  X(29).
  1055*    COPY ELC689PI.
  1056******************************************************************
  1057*                                                                *
  1058*                            ELC689PI                            *
  1059*                            VMOD=2.003                          *
  1060*                                                                *
  1061*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1062*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1063*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1064*                                                                *
  1065*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1066*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  22
* EL689.cbl
  1067*    BETWEEN PROGRAMS.                                           *
  1068*                                                                *
  1069*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1070*                                                                *
  1071*               EL631 - EL689  - EL6891 - EL6892                 *
  1072*                                                                *
  1073******************************************************************
  1074*                   C H A N G E   L O G
  1075*
  1076* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1077*-----------------------------------------------------------------
  1078*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1079* EFFECTIVE    NUMBER
  1080*-----------------------------------------------------------------
  1081* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1082* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1083* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1084******************************************************************
  1085
  1086
  1087         16  PI-689-WORK-AREA.
  1088             20  PI-689-ALT-PRINTER-ID
  1089                                 PIC  X(04).
  1090             20  PI-689-ARCHIVE-NUMBER
  1091                                 PIC  9(08).
  1092             20  PI-689-ARCHIVE-SW
  1093                                 PIC  X(01).
  1094                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1095             20  PI-689-DATA-SOURCE
  1096                                 PIC  X(01).
  1097                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1098                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1099                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1100                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1101                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1102             20  PI-689-ERROR-IND
  1103                                 PIC  X(01).
  1104                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1105             20  PI-689-ERROR    PIC  9(04).
  1106                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1107                 88  PI-689-FATAL-ERROR
  1108                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1109                            0042 0047 0051 0066 0067 0070
  1110                            0168 0169 0174 0175 0176 0177 0179
  1111                            0180 0181 0182 0184 0185 0189 0190
  1112                            0191
  1113                            0215 0279 0280
  1114                            0412 0413 0454
  1115                            0533 0537
  1116                            2055 2114 2208 2209 2216 2232 2369
  1117                            2398 2433 2908 2999
  1118                            3000 3770 3771 3775
  1119                            7250 7365 7367 7368 7369 7370 7371
  1120                            7272 7373 7374 7376 7377 7378 7379
  1121                            7381 7388 7390 7393 7395 7396 7398
  1122                            9095 9096 9281 9298 9299 9320 9327
  1123                            9426 9427.
  1124                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  23
* EL689.cbl
  1125                     VALUES 0004 0008 0013 0023 0029 0033
  1126                            0042 0047 0066 0067 0070
  1127                            0168 0169 0174 0175 0176 0177
  1128                            0181 0182 0184 0185 0189 0190
  1129                            0279 0280
  1130                            0412 0413 0454
  1131                            2055 2208 2209 2216 2232
  1132                            2398 2999
  1133                            3000 3770 3771 3775
  1134                            7250 7365 7369 7370 7371
  1135                            7272 7373 7374 7376 7377 7378 7379
  1136                            7381 7388 7390 7393 7396 7398
  1137                            9095 9096 9299 9320 9426.
  1138             20  PI-689-FOLLOW-UP-DATE
  1139                                 PIC  X(02).
  1140             20  PI-689-FORM-NUMBER
  1141                                 PIC  X(04).
  1142             20  PI-689-LABEL-SOURCE
  1143                                 PIC X(01).
  1144                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1145                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1146                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1147                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1148                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1149                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1150                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1151             20  PI-689-NUMBER-COPIES
  1152                                 PIC  9(01).
  1153             20  PI-689-NUMBER-LABEL-LINES
  1154                                 PIC  9(01).
  1155             20  PI-689-NUMBER-TEXT-RECORDS
  1156                                 PIC  9(03).
  1157             20  PI-689-PRINT-ORDER-SW
  1158                                 PIC  X(01).
  1159                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1160                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1161                 88  PI-689-PRINT-LATER     VALUE '3'.
  1162                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1163             20  PI-689-PRINT-RESTRICTION
  1164                                 PIC  X(01).
  1165                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1166                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1167                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1168             20  PI-689-PRINT-SW PIC  X(01).
  1169                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1170             20  PI-689-RESEND-DATE-1
  1171                                 PIC  X(02).
  1172             20  PI-689-RESEND-LETR-1
  1173                                 PIC X(4).
  1174             20  PI-689-TEMP-STOR-ID
  1175                                 PIC  X(08).
  1176             20  PI-689-USE-SCREEN-IND
  1177                                 PIC  X(01).
  1178                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1179             20  PI-689-ARCH-POINTER
  1180                                 PIC S9(08) COMP.
  1181                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1182             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  24
* EL689.cbl
  1183                                 PIC S9(08) COMP.
  1184                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1185             20  PI-689-VARIABLE-DATA-GRP.
  1186                 24  PI-689-VARIABLE-DATA-1
  1187                                 PIC  X(30).
  1188                 24  PI-689-VARIABLE-DATA-2
  1189                                 PIC  X(30).
  1190                 24  PI-689-VARIABLE-DATA-3
  1191                                 PIC  X(30).
  1192                 24  PI-689-VARIABLE-DATA-4
  1193                                 PIC  X(30).
  1194
  1195         16  PI-689-KEY-DATA-FIELDS.
  1196             20  PI-689-ACCOUNT  PIC  X(10).
  1197             20  PI-689-CARRIER  PIC  X(01).
  1198             20  PI-689-CERT-NO.
  1199                 24  PI-689-CERT-PRIME
  1200                                 PIC  X(10).
  1201                 24  PI-689-CERT-SFX
  1202                                 PIC  X(01).
  1203             20  PI-689-CHG-SEQ-NO
  1204                                 PIC S9(04)    COMP.
  1205             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1206                                 PIC  X(02).
  1207             20  PI-689-ENTRY-BATCH
  1208                                 PIC  X(06).
  1209             20  PI-689-EFF-DATE PIC  X(02).
  1210             20  PI-689-EXP-DATE PIC  X(02).
  1211             20  PI-689-GROUPING PIC  X(06).
  1212             20  PI-689-RESP-PERSON
  1213                                 PIC  X(10).
  1214             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1215             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1216                                 PIC  X(04).
  1217             20  PI-689-STATE    PIC  X(02).
  1218             20  PI-689-TYPE     PIC  X(01).
  1219             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1220             20  PI-689-ALT-SEQ-NO
  1221                                 PIC S9(04)    COMP.
  1222         16  PI-689-DATE-EDIT    PIC  X(08).
  1223         16  PI-689-FOLLOW-UP-EDIT
  1224                                 PIC  X(08).
  1225         16  PI-689-RESEND1-EDIT PIC  X(08).
  1226         16  PI-689-SEQ-EDIT     PIC  X(08).
  1227         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1228         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1229             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1230         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1231         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1232         16  PI-PROMPT-IND       PIC X(1).
  1233         16  PI-CERT-FORM-ID     PIC X(5).
  1234         16  PI-PRINT-NOW        PIC X(1).
  1235         16  PI-ENCLOSURE-CD     PIC X(3).
  1236         16  PI-CERT-REQ-IND     PIC X(1).
  1237         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1238         16  PI-REASON-REQ-IND   PIC X(1).
  1239         16  FILLER              PIC X(244).
  1240*        16  FILLER                        PIC X(276).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  25
* EL689.cbl
  1241*        16  FILLER                        PIC X(280).
  1242
  1243 01  FILLER                      PIC  X(20)
  1244                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  26
* EL689.cbl
  1246 01  FILLER                      PIC  X(16)
  1247                        VALUE 'MAP AREA STARTS:'.
  1248*    COPY EL689S.
  1249 01  EL689AI.
  1250     05  FILLER            PIC  X(0012).
  1251*    -------------------------------
  1252     05  RUNDTEL PIC S9(0004) COMP.
  1253     05  RUNDTEF PIC  X(0001).
  1254     05  FILLER REDEFINES RUNDTEF.
  1255         10  RUNDTEA PIC  X(0001).
  1256     05  RUNDTEI PIC  X(0008).
  1257*    -------------------------------
  1258     05  RUNTIMEL PIC S9(0004) COMP.
  1259     05  RUNTIMEF PIC  X(0001).
  1260     05  FILLER REDEFINES RUNTIMEF.
  1261         10  RUNTIMEA PIC  X(0001).
  1262     05  RUNTIMEI PIC  X(0005).
  1263*    -------------------------------
  1264     05  HOSTL PIC S9(0004) COMP.
  1265     05  HOSTF PIC  X(0001).
  1266     05  FILLER REDEFINES HOSTF.
  1267         10  HOSTA PIC  X(0001).
  1268     05  HOSTI PIC  X(0010).
  1269*    -------------------------------
  1270     05  SYSL PIC S9(0004) COMP.
  1271     05  SYSF PIC  X(0001).
  1272     05  FILLER REDEFINES SYSF.
  1273         10  SYSA PIC  X(0001).
  1274     05  SYSI PIC  X(0008).
  1275*    -------------------------------
  1276     05  COMPANYL PIC S9(0004) COMP.
  1277     05  COMPANYF PIC  X(0001).
  1278     05  FILLER REDEFINES COMPANYF.
  1279         10  COMPANYA PIC  X(0001).
  1280     05  COMPANYI PIC  X(0003).
  1281*    -------------------------------
  1282     05  USERIDL PIC S9(0004) COMP.
  1283     05  USERIDF PIC  X(0001).
  1284     05  FILLER REDEFINES USERIDF.
  1285         10  USERIDA PIC  X(0001).
  1286     05  USERIDI PIC  X(0004).
  1287*    -------------------------------
  1288     05  MAINTL PIC S9(0004) COMP.
  1289     05  MAINTF PIC  X(0001).
  1290     05  FILLER REDEFINES MAINTF.
  1291         10  MAINTA PIC  X(0001).
  1292     05  MAINTI PIC  X(0001).
  1293*    -------------------------------
  1294     05  FORML PIC S9(0004) COMP.
  1295     05  FORMF PIC  X(0001).
  1296     05  FILLER REDEFINES FORMF.
  1297         10  FORMA PIC  X(0001).
  1298     05  FORMI PIC  X(0004).
  1299*    -------------------------------
  1300     05  ARCHNUML PIC S9(0004) COMP.
  1301     05  ARCHNUMF PIC  X(0001).
  1302     05  FILLER REDEFINES ARCHNUMF.
  1303         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  27
* EL689.cbl
  1304     05  ARCHNUMI PIC  99999999.
  1305*    -------------------------------
  1306     05  PRTNOWL PIC S9(0004) COMP.
  1307     05  PRTNOWF PIC  X(0001).
  1308     05  FILLER REDEFINES PRTNOWF.
  1309         10  PRTNOWA PIC  X(0001).
  1310     05  PRTNOWI PIC  X(0001).
  1311*    -------------------------------
  1312     05  CARRIERL PIC S9(0004) COMP.
  1313     05  CARRIERF PIC  X(0001).
  1314     05  FILLER REDEFINES CARRIERF.
  1315         10  CARRIERA PIC  X(0001).
  1316     05  CARRIERI PIC  X(0001).
  1317*    -------------------------------
  1318     05  GROUPL PIC S9(0004) COMP.
  1319     05  GROUPF PIC  X(0001).
  1320     05  FILLER REDEFINES GROUPF.
  1321         10  GROUPA PIC  X(0001).
  1322     05  GROUPI PIC  X(0006).
  1323*    -------------------------------
  1324     05  STATEL PIC S9(0004) COMP.
  1325     05  STATEF PIC  X(0001).
  1326     05  FILLER REDEFINES STATEF.
  1327         10  STATEA PIC  X(0001).
  1328     05  STATEI PIC  X(0002).
  1329*    -------------------------------
  1330     05  ACCTL PIC S9(0004) COMP.
  1331     05  ACCTF PIC  X(0001).
  1332     05  FILLER REDEFINES ACCTF.
  1333         10  ACCTA PIC  X(0001).
  1334     05  ACCTI PIC  X(0010).
  1335*    -------------------------------
  1336     05  CERTL PIC S9(0004) COMP.
  1337     05  CERTF PIC  X(0001).
  1338     05  FILLER REDEFINES CERTF.
  1339         10  CERTA PIC  X(0001).
  1340     05  CERTI PIC  X(0010).
  1341*    -------------------------------
  1342     05  SFXL PIC S9(0004) COMP.
  1343     05  SFXF PIC  X(0001).
  1344     05  FILLER REDEFINES SFXF.
  1345         10  SFXA PIC  X(0001).
  1346     05  SFXI PIC  X(0001).
  1347*    -------------------------------
  1348     05  TYPEL PIC S9(0004) COMP.
  1349     05  TYPEF PIC  X(0001).
  1350     05  FILLER REDEFINES TYPEF.
  1351         10  TYPEA PIC  X(0001).
  1352     05  TYPEI PIC  X(0001).
  1353*    -------------------------------
  1354     05  DATEL PIC S9(0004) COMP.
  1355     05  DATEF PIC  X(0001).
  1356     05  FILLER REDEFINES DATEF.
  1357         10  DATEA PIC  X(0001).
  1358     05  DATEI PIC  X(0008).
  1359*    -------------------------------
  1360     05  FOLLOWL PIC S9(0004) COMP.
  1361     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  28
* EL689.cbl
  1362     05  FILLER REDEFINES FOLLOWF.
  1363         10  FOLLOWA PIC  X(0001).
  1364     05  FOLLOWI PIC  X(0008).
  1365*    -------------------------------
  1366     05  RESEND1L PIC S9(0004) COMP.
  1367     05  RESEND1F PIC  X(0001).
  1368     05  FILLER REDEFINES RESEND1F.
  1369         10  RESEND1A PIC  X(0001).
  1370     05  RESEND1I PIC  X(0008).
  1371*    -------------------------------
  1372     05  ENCL PIC S9(0004) COMP.
  1373     05  ENCF PIC  X(0001).
  1374     05  FILLER REDEFINES ENCF.
  1375         10  ENCA PIC  X(0001).
  1376     05  ENCI PIC  X(0003).
  1377*    -------------------------------
  1378     05  ENDARCHL PIC S9(0004) COMP.
  1379     05  ENDARCHF PIC  X(0001).
  1380     05  FILLER REDEFINES ENDARCHF.
  1381         10  ENDARCHA PIC  X(0001).
  1382     05  ENDARCHI PIC  99999999.
  1383*    -------------------------------
  1384     05  CERTIDL PIC S9(0004) COMP.
  1385     05  CERTIDF PIC  X(0001).
  1386     05  FILLER REDEFINES CERTIDF.
  1387         10  CERTIDA PIC  X(0001).
  1388     05  CERTIDI PIC  X(0005).
  1389*    -------------------------------
  1390     05  ADDRSL PIC S9(0004) COMP.
  1391     05  ADDRSF PIC  X(0001).
  1392     05  FILLER REDEFINES ADDRSF.
  1393         10  ADDRSA PIC  X(0001).
  1394     05  ADDRSI PIC  X(0001).
  1395*    -------------------------------
  1396     05  PRINTERL PIC S9(0004) COMP.
  1397     05  PRINTERF PIC  X(0001).
  1398     05  FILLER REDEFINES PRINTERF.
  1399         10  PRINTERA PIC  X(0001).
  1400     05  PRINTERI PIC  X(0004).
  1401*    -------------------------------
  1402     05  COPIESL PIC S9(0004) COMP.
  1403     05  COPIESF PIC  X(0001).
  1404     05  FILLER REDEFINES COPIESF.
  1405         10  COPIESA PIC  X(0001).
  1406     05  COPIESI PIC  X(0001).
  1407*    -------------------------------
  1408     05  DATASORL PIC S9(0004) COMP.
  1409     05  DATASORF PIC  X(0001).
  1410     05  FILLER REDEFINES DATASORF.
  1411         10  DATASORA PIC  X(0001).
  1412     05  DATASORI PIC  X(0001).
  1413*    -------------------------------
  1414     05  ADDRLBLL PIC S9(0004) COMP.
  1415     05  ADDRLBLF PIC  X(0001).
  1416     05  FILLER REDEFINES ADDRLBLF.
  1417         10  ADDRLBLA PIC  X(0001).
  1418     05  ADDRLBLI PIC  X(0001).
  1419*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  29
* EL689.cbl
  1420     05  RPERSONL PIC S9(0004) COMP.
  1421     05  RPERSONF PIC  X(0001).
  1422     05  FILLER REDEFINES RPERSONF.
  1423         10  RPERSONA PIC  X(0001).
  1424     05  RPERSONI PIC  X(0010).
  1425*    -------------------------------
  1426     05  BENTRYL PIC S9(0004) COMP.
  1427     05  BENTRYF PIC  X(0001).
  1428     05  FILLER REDEFINES BENTRYF.
  1429         10  BENTRYA PIC  X(0001).
  1430     05  BENTRYI PIC  X(0006).
  1431*    -------------------------------
  1432     05  SEQL PIC S9(0004) COMP.
  1433     05  SEQF PIC  X(0001).
  1434     05  FILLER REDEFINES SEQF.
  1435         10  SEQA PIC  X(0001).
  1436     05  SEQI PIC  X(0008).
  1437*    -------------------------------
  1438     05  BCSEQL PIC S9(0004) COMP.
  1439     05  BCSEQF PIC  X(0001).
  1440     05  FILLER REDEFINES BCSEQF.
  1441         10  BCSEQA PIC  X(0001).
  1442     05  BCSEQI PIC  X(0004).
  1443*    -------------------------------
  1444     05  L1L PIC S9(0004) COMP.
  1445     05  L1F PIC  X(0001).
  1446     05  FILLER REDEFINES L1F.
  1447         10  L1A PIC  X(0001).
  1448     05  L1I PIC  X(0003).
  1449*    -------------------------------
  1450     05  TEXT1L PIC S9(0004) COMP.
  1451     05  TEXT1F PIC  X(0001).
  1452     05  FILLER REDEFINES TEXT1F.
  1453         10  TEXT1A PIC  X(0001).
  1454     05  TEXT1I PIC  X(0070).
  1455*    -------------------------------
  1456     05  L2L PIC S9(0004) COMP.
  1457     05  L2F PIC  X(0001).
  1458     05  FILLER REDEFINES L2F.
  1459         10  L2A PIC  X(0001).
  1460     05  L2I PIC  X(0003).
  1461*    -------------------------------
  1462     05  TEXT2L PIC S9(0004) COMP.
  1463     05  TEXT2F PIC  X(0001).
  1464     05  FILLER REDEFINES TEXT2F.
  1465         10  TEXT2A PIC  X(0001).
  1466     05  TEXT2I PIC  X(0070).
  1467*    -------------------------------
  1468     05  L3L PIC S9(0004) COMP.
  1469     05  L3F PIC  X(0001).
  1470     05  FILLER REDEFINES L3F.
  1471         10  L3A PIC  X(0001).
  1472     05  L3I PIC  X(0003).
  1473*    -------------------------------
  1474     05  TEXT3L PIC S9(0004) COMP.
  1475     05  TEXT3F PIC  X(0001).
  1476     05  FILLER REDEFINES TEXT3F.
  1477         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  30
* EL689.cbl
  1478     05  TEXT3I PIC  X(0070).
  1479*    -------------------------------
  1480     05  L4L PIC S9(0004) COMP.
  1481     05  L4F PIC  X(0001).
  1482     05  FILLER REDEFINES L4F.
  1483         10  L4A PIC  X(0001).
  1484     05  L4I PIC  X(0003).
  1485*    -------------------------------
  1486     05  TEXT4L PIC S9(0004) COMP.
  1487     05  TEXT4F PIC  X(0001).
  1488     05  FILLER REDEFINES TEXT4F.
  1489         10  TEXT4A PIC  X(0001).
  1490     05  TEXT4I PIC  X(0070).
  1491*    -------------------------------
  1492     05  L5L PIC S9(0004) COMP.
  1493     05  L5F PIC  X(0001).
  1494     05  FILLER REDEFINES L5F.
  1495         10  L5A PIC  X(0001).
  1496     05  L5I PIC  X(0003).
  1497*    -------------------------------
  1498     05  TEXT5L PIC S9(0004) COMP.
  1499     05  TEXT5F PIC  X(0001).
  1500     05  FILLER REDEFINES TEXT5F.
  1501         10  TEXT5A PIC  X(0001).
  1502     05  TEXT5I PIC  X(0070).
  1503*    -------------------------------
  1504     05  L6L PIC S9(0004) COMP.
  1505     05  L6F PIC  X(0001).
  1506     05  FILLER REDEFINES L6F.
  1507         10  L6A PIC  X(0001).
  1508     05  L6I PIC  X(0003).
  1509*    -------------------------------
  1510     05  TEXT6L PIC S9(0004) COMP.
  1511     05  TEXT6F PIC  X(0001).
  1512     05  FILLER REDEFINES TEXT6F.
  1513         10  TEXT6A PIC  X(0001).
  1514     05  TEXT6I PIC  X(0070).
  1515*    -------------------------------
  1516     05  L7L PIC S9(0004) COMP.
  1517     05  L7F PIC  X(0001).
  1518     05  FILLER REDEFINES L7F.
  1519         10  L7A PIC  X(0001).
  1520     05  L7I PIC  X(0003).
  1521*    -------------------------------
  1522     05  TEXT7L PIC S9(0004) COMP.
  1523     05  TEXT7F PIC  X(0001).
  1524     05  FILLER REDEFINES TEXT7F.
  1525         10  TEXT7A PIC  X(0001).
  1526     05  TEXT7I PIC  X(0070).
  1527*    -------------------------------
  1528     05  L8L PIC S9(0004) COMP.
  1529     05  L8F PIC  X(0001).
  1530     05  FILLER REDEFINES L8F.
  1531         10  L8A PIC  X(0001).
  1532     05  L8I PIC  X(0003).
  1533*    -------------------------------
  1534     05  TEXT8L PIC S9(0004) COMP.
  1535     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  31
* EL689.cbl
  1536     05  FILLER REDEFINES TEXT8F.
  1537         10  TEXT8A PIC  X(0001).
  1538     05  TEXT8I PIC  X(0070).
  1539*    -------------------------------
  1540     05  L9L PIC S9(0004) COMP.
  1541     05  L9F PIC  X(0001).
  1542     05  FILLER REDEFINES L9F.
  1543         10  L9A PIC  X(0001).
  1544     05  L9I PIC  X(0003).
  1545*    -------------------------------
  1546     05  TEXT9L PIC S9(0004) COMP.
  1547     05  TEXT9F PIC  X(0001).
  1548     05  FILLER REDEFINES TEXT9F.
  1549         10  TEXT9A PIC  X(0001).
  1550     05  TEXT9I PIC  X(0070).
  1551*    -------------------------------
  1552     05  L10L PIC S9(0004) COMP.
  1553     05  L10F PIC  X(0001).
  1554     05  FILLER REDEFINES L10F.
  1555         10  L10A PIC  X(0001).
  1556     05  L10I PIC  X(0003).
  1557*    -------------------------------
  1558     05  TEXT10L PIC S9(0004) COMP.
  1559     05  TEXT10F PIC  X(0001).
  1560     05  FILLER REDEFINES TEXT10F.
  1561         10  TEXT10A PIC  X(0001).
  1562     05  TEXT10I PIC  X(0070).
  1563*    -------------------------------
  1564     05  L11L PIC S9(0004) COMP.
  1565     05  L11F PIC  X(0001).
  1566     05  FILLER REDEFINES L11F.
  1567         10  L11A PIC  X(0001).
  1568     05  L11I PIC  X(0003).
  1569*    -------------------------------
  1570     05  TEXT11L PIC S9(0004) COMP.
  1571     05  TEXT11F PIC  X(0001).
  1572     05  FILLER REDEFINES TEXT11F.
  1573         10  TEXT11A PIC  X(0001).
  1574     05  TEXT11I PIC  X(0070).
  1575*    -------------------------------
  1576     05  L12L PIC S9(0004) COMP.
  1577     05  L12F PIC  X(0001).
  1578     05  FILLER REDEFINES L12F.
  1579         10  L12A PIC  X(0001).
  1580     05  L12I PIC  X(0003).
  1581*    -------------------------------
  1582     05  TEXT12L PIC S9(0004) COMP.
  1583     05  TEXT12F PIC  X(0001).
  1584     05  FILLER REDEFINES TEXT12F.
  1585         10  TEXT12A PIC  X(0001).
  1586     05  TEXT12I PIC  X(0070).
  1587*    -------------------------------
  1588     05  ERRMSGL PIC S9(0004) COMP.
  1589     05  ERRMSGF PIC  X(0001).
  1590     05  FILLER REDEFINES ERRMSGF.
  1591         10  ERRMSGA PIC  X(0001).
  1592     05  ERRMSGI PIC  X(0079).
  1593*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  32
* EL689.cbl
  1594     05  ENTERPFL PIC S9(0004) COMP.
  1595     05  ENTERPFF PIC  X(0001).
  1596     05  FILLER REDEFINES ENTERPFF.
  1597         10  ENTERPFA PIC  X(0001).
  1598     05  ENTERPFI PIC  99.
  1599*    -------------------------------
  1600     05  PF8HDL PIC S9(0004) COMP.
  1601     05  PF8HDF PIC  X(0001).
  1602     05  FILLER REDEFINES PF8HDF.
  1603         10  PF8HDA PIC  X(0001).
  1604     05  PF8HDI PIC  X(0022).
  1605 01  EL689AO REDEFINES EL689AI.
  1606     05  FILLER            PIC  X(0012).
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  RUNDTEO PIC  X(0008).
  1610*    -------------------------------
  1611     05  FILLER            PIC  X(0003).
  1612     05  RUNTIMEO PIC  99.99.
  1613*    -------------------------------
  1614     05  FILLER            PIC  X(0003).
  1615     05  HOSTO PIC  X(0010).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  SYSO PIC  X(0008).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  COMPANYO PIC  X(0003).
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
  1624     05  USERIDO PIC  X(0004).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  MAINTO PIC  X(0001).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  FORMO PIC  X(0004).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  ARCHNUMO PIC  99999999.
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  PRTNOWO PIC  X(0001).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  CARRIERO PIC  X(0001).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  GROUPO PIC  X(0006).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  STATEO PIC  X(0002).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  ACCTO PIC  X(0010).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  33
* EL689.cbl
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  SFXO PIC  X(0001).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  TYPEO PIC  X(0001).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  DATEO PIC  X(0008).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  FOLLOWO PIC  X(0008).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  RESEND1O PIC  X(0008).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  ENCO PIC  X(0003).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  ENDARCHO PIC  99999999.
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  CERTIDO PIC  X(0005).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  ADDRSO PIC  X(0001).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  PRINTERO PIC  X(0004).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  COPIESO PIC  X(0001).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  DATASORO PIC  X(0001).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  ADDRLBLO PIC  X(0001).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  RPERSONO PIC  X(0010).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  BENTRYO PIC  X(0006).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  SEQO PIC  X(0008).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  BCSEQO PIC  X(0004).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  L1O PIC  X(0003).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  TEXT1O PIC  X(0070).
  1709*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  34
* EL689.cbl
  1710     05  FILLER            PIC  X(0003).
  1711     05  L2O PIC  X(0003).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  TEXT2O PIC  X(0070).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  L3O PIC  X(0003).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  TEXT3O PIC  X(0070).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  L4O PIC  X(0003).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  TEXT4O PIC  X(0070).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  L5O PIC  X(0003).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  TEXT5O PIC  X(0070).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  L6O PIC  X(0003).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  TEXT6O PIC  X(0070).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  L7O PIC  X(0003).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  TEXT7O PIC  X(0070).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  L8O PIC  X(0003).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  TEXT8O PIC  X(0070).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  L9O PIC  X(0003).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  TEXT9O PIC  X(0070).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  L10O PIC  X(0003).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  TEXT10O PIC  X(0070).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  L11O PIC  X(0003).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  35
* EL689.cbl
  1768     05  TEXT11O PIC  X(0070).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  L12O PIC  X(0003).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  TEXT12O PIC  X(0070).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  ERRMSGO PIC  X(0079).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  ENTERPFO PIC  X(0002).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  PF8HDO PIC  X(0022).
  1784*    -------------------------------
  1785 01  W-MAP-REDEF REDEFINES EL689AI.
  1786*    12  FILLER                  PIC X(218).
  1787     12  FILLER                  PIC X(267).
  1788     12  EL689RI.
  1789         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1790             20  W-SC-LINEL      PIC S9(04) COMP.
  1791             20  W-SC-LINEA      PIC  X(01).
  1792             20  W-SC-LINE       PIC  X(03).
  1793             20  W-SC-TEXTL      PIC S9(04) COMP.
  1794             20  W-SC-TEXTA      PIC  X(01).
  1795             20  W-SC-TEXT       PIC  X(70).
  1796*    12  FILLER                  PIC  X(87).
  1797     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  36
* EL689.cbl
  1799 01  W-CONSTANT-AREA.
  1800     12  FILLER                  PIC  X(18)
  1801                                 VALUE 'PROGRAM CONSTANTS:'.
  1802     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1803     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1804     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1805     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1806     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1807     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1808     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1809     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1810     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1811     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1812
  1813     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  1814     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  1815     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  1816     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  1817     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  1818     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  1819     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  1820     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  1821     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  1822     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  1823     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  1824     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  1825     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  1826     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  1827     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  1828     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  1829     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  1830     12  W-LOWER-CASE            PIC  X(26)
  1831         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  1832     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  1833     12  W-MAP.
  1834         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  1835         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  1836         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  1837     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  1838     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  1839     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  1840     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  1841     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  1842     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  1843     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  1844
  1845     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  1846     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  1847     12  W-TOP-FORM              PIC  X(70)
  1848                              VALUE '*****TOP OF FORM *****'.
  1849     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  1850     12  W-UPPER-CASE            PIC  X(26)
  1851         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  1852     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  1853     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  1854     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  37
* EL689.cbl
  1856 01  W-VARIABLE-PROCESS-CNTLS.
  1857     12  FILLER                  PIC  X(26)
  1858                        VALUE 'VARIABLE WORK AREA STARTS:'.
  1859     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  1860     12  W-VAR-HOLD.
  1861         16  W-V1                PIC  X(01).
  1862         16  W-V2                PIC  X(01).
  1863         16  W-V3                PIC  X(01).
  1864     12  FILLER REDEFINES W-VAR-HOLD.
  1865         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  1866     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  1867         88  W-SQUEEZE-FIELD          VALUE '#'.
  1868
  1869 01  W-SUPPORTED-VARIABLES.
  1870
  1871*****************COMPANY VARIABLES - ELCNTL ********************
  1872*****COMPANY NAME
  1873     12  FILLER                  PIC  X(03) VALUE '001'.
  1874     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1875     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1876     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1877     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1878
  1879*****FULL COMPANY ADDRESS
  1880     12  FILLER                  PIC  X(03) VALUE '002'.
  1881     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1882     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1883     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1884     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1885
  1886     12  FILLER                  PIC  X(03) VALUE '003'.
  1887     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1888     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1889     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1890     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1891
  1892     12  FILLER                  PIC  X(03) VALUE '004'.
  1893     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1894     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1895     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1896     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1897
  1898     12  FILLER                  PIC  X(03) VALUE '005'.
  1899     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1900     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1901     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1902     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1903
  1904     12  FILLER                  PIC  X(03) VALUE '006'.
  1905     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1906     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1907     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1908     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1909
  1910*****REMAINING 4 ARE NOT CURRENTLY USED
  1911     12  FILLER                  PIC  X(03) VALUE '007'.
  1912     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1913     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  38
* EL689.cbl
  1914     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1915     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1916
  1917     12  FILLER                  PIC  X(03) VALUE '008'.
  1918     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1919     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1920     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1921     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1922
  1923     12  FILLER                  PIC  X(03) VALUE '009'.
  1924     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1925     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1926     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1927     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1928
  1929     12  FILLER                  PIC  X(03) VALUE '010'.
  1930     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1931     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1932     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1933     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1934
  1935************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  1936*****LIFE BENEFIT DESCRIPTION
  1937     12  FILLER                  PIC  X(03) VALUE '011'.
  1938     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1939     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1940     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1941     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1942
  1943*****REMAINING 3 ARE NOT CURRENTLY USED
  1944     12  FILLER                  PIC  X(03) VALUE '012'.
  1945     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1946     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1947     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1948     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1949
  1950     12  FILLER                  PIC  X(03) VALUE '013'.
  1951     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1952     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1953     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1954     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1955
  1956     12  FILLER                  PIC  X(03) VALUE '014'.
  1957     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1958     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1959     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1960     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1961
  1962************* A&H BENEFIT VARIABLES - ELCNTL *******************
  1963*****AH BENEFIT DESCRIPTION
  1964     12  FILLER                  PIC  X(03) VALUE '015'.
  1965     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1966     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1967     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1968     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1969
  1970*****ELIMINATION PERIOD
  1971     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  39
* EL689.cbl
  1972     12  FILLER                  PIC S9(04) COMP VALUE +2.
  1973     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1974     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1975     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1976
  1977*****REMAINING 3 ARE NOT CURRENTLY USED
  1978     12  FILLER                  PIC  X(03) VALUE '017'.
  1979     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1980     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1981     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1982     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1983
  1984     12  FILLER                  PIC  X(03) VALUE '018'.
  1985     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1986     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1987     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1988     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1989
  1990     12  FILLER                  PIC  X(03) VALUE '019'.
  1991     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1992     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1993     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1994     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1995
  1996*****************CARRIER VARIABLES - ELCNTL ********************
  1997*****CARRIER NAME
  1998     12  FILLER                  PIC  X(03) VALUE '020'.
  1999     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2000     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2001     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2002     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2003
  2004*****FULL CARRIER ADDRESS
  2005     12  FILLER                  PIC  X(03) VALUE '021'.
  2006     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2007     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2008     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2009     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2010
  2011     12  FILLER                  PIC  X(03) VALUE '022'.
  2012     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2013     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2014     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2015     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2016
  2017     12  FILLER                  PIC  X(03) VALUE '023'.
  2018     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2019     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2020     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2021     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2022
  2023     12  FILLER                  PIC  X(03) VALUE '024'.
  2024     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2025     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2026     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2027     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2028
  2029     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  40
* EL689.cbl
  2030     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2031     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2032     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2033     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2034
  2035*****CARRIER PHONE NUMBER
  2036     12  FILLER                  PIC  X(03) VALUE '026'.
  2037     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2038     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2039     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2040     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2041
  2042*****REMAINING 4 ARE NOT CURRENTLY USED
  2043     12  FILLER                  PIC  X(03) VALUE '027'.
  2044     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2045     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2046     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2047     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2048
  2049     12  FILLER                  PIC  X(03) VALUE '028'.
  2050     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2051     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2052     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2053     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2054
  2055     12  FILLER                  PIC  X(03) VALUE '029'.
  2056     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2057     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2058     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2059     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2060
  2061     12  FILLER                  PIC  X(03) VALUE '030'.
  2062     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2063     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2064     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2065     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2066
  2067***************** MAIL VARIABLES - ELMAIL **********************
  2068*****FULL MAIL ADDRESS
  2069     12  FILLER                  PIC  X(03) VALUE '031'.
  2070     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2071     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2072     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2073     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2074
  2075     12  FILLER                  PIC  X(03) VALUE '032'.
  2076     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2077     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2078     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2079     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2080
  2081     12  FILLER                  PIC  X(03) VALUE '033'.
  2082     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2083     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2084     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2085     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2086
  2087     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  41
* EL689.cbl
  2088     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2089     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2090     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2091     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2092
  2093     12  FILLER                  PIC  X(03) VALUE '035'.
  2094     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2095     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2096     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2097     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2098
  2099     12  FILLER                  PIC  X(03) VALUE '036'.
  2100     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2101     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2102     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2103     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2104**** CRED BENE NAME FROM ERMAIL
  2105     12  FILLER                  PIC  X(03) VALUE '037'.
  2106     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2107     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2108     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2109     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2110*****REMAINING 2 ARE NOT CURRENTLY USED
  2111     12  FILLER                  PIC  X(03) VALUE '038'.
  2112     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2113     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2114     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2115     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2116
  2117     12  FILLER                  PIC  X(03) VALUE '039'.
  2118     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2119     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2120     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2121     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2122
  2123*************** ACCOUNT VARIABLES - ERACCT *********************
  2124*****ACCOUNT NAME
  2125     12  FILLER                  PIC  X(03) VALUE '040'.
  2126     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2127     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2128     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2129     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2130
  2131*****FULL ACCOUNT ADDRESS
  2132     12  FILLER                  PIC  X(03) VALUE '041'.
  2133     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2134     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2135     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2136     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2137
  2138     12  FILLER                  PIC  X(03) VALUE '042'.
  2139     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2140     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2141     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2142     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2143
  2144     12  FILLER                  PIC  X(03) VALUE '043'.
  2145     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  42
* EL689.cbl
  2146     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2147     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2148     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2149
  2150     12  FILLER                  PIC  X(03) VALUE '044'.
  2151     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2152     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2153     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2154     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2155
  2156     12  FILLER                  PIC  X(03) VALUE '045'.
  2157     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2158     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2159     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2160     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2161
  2162*****ACCOUNT PHONE NUMBER
  2163     12  FILLER                  PIC  X(03) VALUE '046'.
  2164     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2165     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2166     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2167     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2168
  2169*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2170     12  FILLER                  PIC  X(03) VALUE '047'.
  2171     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2172     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2173     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2174     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2175
  2176****ACCOUNT CSR CODE
  2177     12  FILLER                  PIC  X(03) VALUE '048'.
  2178     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2179     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2180     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2181     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2182****ACCOUNT ACCOUNT NUMBER
  2183     12  FILLER                  PIC  X(03) VALUE '049'.
  2184     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2185     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2186     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2187     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2188
  2189**** CRED BENE ADDRESS LINE 1 ERMAIL
  2190     12  FILLER                  PIC  X(03) VALUE '050'.
  2191     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2192     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2193     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2194     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2195
  2196**** CRED BENE ADDRESS LINE 2 ERMAIL
  2197     12  FILLER                  PIC  X(03) VALUE '051'.
  2198     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2199     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2200     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2201     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2202
  2203**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  43
* EL689.cbl
  2204     12  FILLER                  PIC  X(03) VALUE '052'.
  2205     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2206     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2207     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2208     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2209
  2210**** CRED BENE ZIP  1 ERMAIL
  2211     12  FILLER                  PIC  X(03) VALUE '053'.
  2212     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2213     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2214     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2215     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2216
  2217*****REMAINING 6 ARE NOT CURRENTLY USED
  2218     12  FILLER                  PIC  X(03) VALUE '054'.
  2219     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2220     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2221     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2222     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2223
  2224     12  FILLER                  PIC  X(03) VALUE '055'.
  2225     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2226     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2227     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2228     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2229
  2230     12  FILLER                  PIC  X(03) VALUE '056'.
  2231     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2232     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2233     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2234     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2235
  2236     12  FILLER                  PIC  X(03) VALUE '057'.
  2237     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2238     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2239     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2240     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2241
  2242     12  FILLER                  PIC  X(03) VALUE '058'.
  2243     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2244     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2245     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2246     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2247
  2248     12  FILLER                  PIC  X(03) VALUE '059'.
  2249     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2250     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2251     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2252     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2253
  2254*************** NON FILE VARIABLES *****************************
  2255*****CURRENT DATE
  2256     12  FILLER                  PIC  X(03) VALUE '060'.
  2257     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2258     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2259     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2260     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2261
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  44
* EL689.cbl
  2262*****FULL CURRENT DATE
  2263     12  FILLER                  PIC  X(03) VALUE '061'.
  2264     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2265     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2266     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2267     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2268
  2269*****FORM
  2270     12  FILLER                  PIC  X(03) VALUE '062'.
  2271     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2272     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2273     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2274     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2275
  2276*****VARIABLE 1
  2277     12  FILLER                  PIC  X(03) VALUE '063'.
  2278     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2279     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2280     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2281     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2282
  2283*****VARIABLE 2
  2284     12  FILLER                  PIC  X(03) VALUE '064'.
  2285     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2286     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2287     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2288     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2289
  2290*****VARIABLE 3
  2291     12  FILLER                  PIC  X(03) VALUE '065'.
  2292     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2293     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2294     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2295     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2296
  2297*****VARIABLE 4
  2298     12  FILLER                  PIC  X(03) VALUE '066'.
  2299     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2300     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2301     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2302     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2303
  2304*****REMAINING 3 ARE NOT CURRENTLY USED
  2305     12  FILLER                  PIC  X(03) VALUE '067'.
  2306     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2307     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2308     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2309     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2310
  2311     12  FILLER                  PIC  X(03) VALUE '068'.
  2312     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2313     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2314     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2315     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2316
  2317     12  FILLER                  PIC  X(03) VALUE '069'.
  2318     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2319     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  45
* EL689.cbl
  2320     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2321     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2322
  2323************** CERTIFICATE VARIABLES - ELCERT *****************
  2324*****CARRIER CODE IN CERT
  2325     12  FILLER                  PIC  X(03) VALUE '070'.
  2326     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2327     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2328     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2329     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2330
  2331*****GROUPING CODE IN CERT
  2332     12  FILLER                  PIC  X(03) VALUE '071'.
  2333     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2334     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2335     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2336     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2337
  2338*****ACCOUNT NUMBER IN CERT
  2339     12  FILLER                  PIC  X(03) VALUE '072'.
  2340     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2341     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2342     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2343     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2344
  2345*****CERTIFICATE NUMBER
  2346     12  FILLER                  PIC  X(03) VALUE '073'.
  2347     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2348     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2349     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2350     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2351
  2352*****CERT EFFECTIVE DATE
  2353     12  FILLER                  PIC  X(03) VALUE '074'.
  2354     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2355     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2356     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2357     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2358
  2359*****CERT EXPIRATION DATE (LIFE)
  2360     12  FILLER                  PIC  X(03) VALUE '075'.
  2361     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2362     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2363     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2364     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2365
  2366*****CERT EXPIRATION DATE (AH)
  2367     12  FILLER                  PIC  X(03) VALUE '076'.
  2368     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2369     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2370     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2371     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2372
  2373*****LIFE TERM
  2374     12  FILLER                  PIC  X(03) VALUE '077'.
  2375     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2376     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2377     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  46
* EL689.cbl
  2378     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2379
  2380*****AH  TERM
  2381     12  FILLER                  PIC  X(03) VALUE '078'.
  2382     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2383     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2384     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2385     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2386
  2387*****LIFE COVERAGE AMOUNT
  2388     12  FILLER                  PIC  X(03) VALUE '079'.
  2389     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2390     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2391     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2392     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2393
  2394*****AH MONTHLY BENEFIT
  2395     12  FILLER                  PIC  X(03) VALUE '080'.
  2396     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2397     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2398     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2399     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2400
  2401*****LIFE CANCEL DATE
  2402     12  FILLER                  PIC  X(03) VALUE '081'.
  2403     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2404     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2405     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2406     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2407
  2408*****AH CANCEL DATE
  2409     12  FILLER                  PIC  X(03) VALUE '082'.
  2410     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2411     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2412     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2413     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2414
  2415*****LIFE COVERAGE FORM NUMBER
  2416     12  FILLER                  PIC  X(03) VALUE '083'.
  2417     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2418     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2419     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2420     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2421
  2422*****UNUSED
  2423     12  FILLER                  PIC  X(03) VALUE '084'.
  2424     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2425     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2426     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2427     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2428
  2429*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2430     12  FILLER                  PIC  X(03) VALUE '085'.
  2431     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2432     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2433     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2434     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2435
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  47
* EL689.cbl
  2436*****LOAN NUMBER
  2437     12  FILLER                  PIC  X(03) VALUE '086'.
  2438     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2439     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2440     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2441     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2442
  2443*****LOAN BALANCE
  2444     12  FILLER                  PIC  X(03) VALUE '087'.
  2445     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2446     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2447     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2448     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2449
  2450*****MEMBER NUMBER
  2451     12  FILLER                  PIC  X(03) VALUE '088'.
  2452     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2453     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2454     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2455     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2456
  2457*****INSURED SOC SEC NUMBER
  2458     12  FILLER                  PIC  X(03) VALUE '089'.
  2459     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2460     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2461     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2462     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2463
  2464*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2465     12  FILLER                  PIC  X(03) VALUE '090'.
  2466     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2467     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2468     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2469     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2470
  2471*****INSURED FIRST NAME (CERTIFICATE)
  2472     12  FILLER                  PIC  X(03) VALUE '091'.
  2473     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2474     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2475     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2476     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2477
  2478*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2479     12  FILLER                  PIC  X(03) VALUE '092'.
  2480     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2481     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2482     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2483     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2484
  2485*****ORIG TERM * MON BEN
  2486     12  FILLER                  PIC  X(03) VALUE '093'.
  2487     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2488     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2489     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2490     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2491
  2492*****INSURED'S NAME (LAST, FIRST, INIT)
  2493     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  48
* EL689.cbl
  2494     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2495     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2496     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2497     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2498
  2499*****INSURED'S NAME (FIRST, INIT, LAST)
  2500     12  FILLER                  PIC  X(03) VALUE  '095'.
  2501     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2502     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2503     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2504     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2505
  2506*****TITLE (MR/MS)
  2507     12  FILLER                  PIC  X(03) VALUE '096'.
  2508     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2509     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2510     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2511     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2512
  2513*****LIFE PREMIUM (CERTIFICATE)
  2514     12  FILLER                  PIC  X(03) VALUE '097'.
  2515     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2516     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2517     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2518     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2519
  2520*****A/H PREMIUM (CERTIFICATE)
  2521     12  FILLER                  PIC  X(03) VALUE '098'.
  2522     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2523     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2524     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2525     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2526
  2527*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2528     12  FILLER                  PIC  X(03) VALUE '099'.
  2529     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2530     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2531     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2532     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2533
  2534*****JOINT'S FIRST NAME (CERTIFICATE)
  2535     12  FILLER                  PIC  X(03) VALUE '100'.
  2536     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2537     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2538     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2539     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2540
  2541*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2542     12  FILLER                  PIC  X(03) VALUE '101'.
  2543     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2544     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2545     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2546     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2547
  2548*****JOINT'S NAME (LAST, FIRST, INIT)
  2549     12  FILLER                  PIC  X(03) VALUE '102'.
  2550     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2551     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  49
* EL689.cbl
  2552     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2553     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2554
  2555*****JOINT'S NAME (FIRST, INIT, LAST)
  2556     12  FILLER                  PIC  X(03) VALUE '103'.
  2557     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2558     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2559     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2560     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2561
  2562*****INSURED'S FIRST AND LAST NAME
  2563     12  FILLER                  PIC  X(03) VALUE '104'.
  2564     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2565     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2566     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2567     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2568
  2569*****JOINT'S FIRST AND LAST NAME
  2570     12  FILLER                  PIC  X(03) VALUE '105'.
  2571     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2572     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2573     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2574     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2575
  2576*****ENTERED LIFE REFUND (CERT)
  2577     12  FILLER                  PIC  X(03) VALUE '106'.
  2578     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2579     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2580     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2581     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2582
  2583*****ENTERED A/H REFUND (CERT)
  2584     12  FILLER                  PIC  X(03) VALUE '107'.
  2585     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2586     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2587     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2588     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2589
  2590*****INSURED'S LAST NAME
  2591     12  FILLER                  PIC  X(03) VALUE '108'.
  2592     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2593     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2594     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2595     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2596
  2597*****BENEFICIARY
  2598     12  FILLER                  PIC  X(03) VALUE  '109'.
  2599     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2600     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2601     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2602     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2603
  2604************** PENDING VARIABLES - ERPNDB *********************
  2605*****INSURED DATE OF BIRTH
  2606     12  FILLER                  PIC  X(03) VALUE '110'.
  2607     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2608     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2609     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  50
* EL689.cbl
  2610     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2611
  2612*****ENTERED LIFE PREMIUM (PENDING)
  2613     12  FILLER                  PIC  X(03) VALUE '111'.
  2614     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2615     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2616     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2617     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2618
  2619*****ENTERED A/H PREMIUM (PENDING)
  2620     12  FILLER                  PIC  X(03) VALUE '112'.
  2621     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2622     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2623     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2624     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2625
  2626*****CALCULATED LIFE PREMIUM (PENDING)
  2627     12  FILLER                  PIC  X(03) VALUE '113'.
  2628     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2629     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2630     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2631     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2632
  2633*****CALCULATED A/H PREMIUM (PENDING)
  2634     12  FILLER                  PIC  X(03) VALUE '114'.
  2635     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2636     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2637     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2638     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2639
  2640*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2641     12  FILLER                  PIC  X(03) VALUE '115'.
  2642     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2643     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2644     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2645     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2646
  2647*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2648     12  FILLER                  PIC  X(03) VALUE '116'.
  2649     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2650     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2651     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2652     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2653
  2654*****PRIOR CANCEL DATE
  2655     12  FILLER                  PIC  X(03) VALUE '117'.
  2656     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2657     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2658     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2659     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2660
  2661*****ENTERED LIFE REFUND (PENDING)
  2662     12  FILLER                  PIC  X(03) VALUE '118'.
  2663     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2664     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2665     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2666     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2667
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  51
* EL689.cbl
  2668*****ENTERED A/H REFUND (PENDING)
  2669     12  FILLER                  PIC  X(03) VALUE '119'.
  2670     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2671     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2672     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2673     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2674
  2675*****CALCULATED LIFE REFUND (PENDING)
  2676     12  FILLER                  PIC  X(03) VALUE '120'.
  2677     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2678     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2679     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2680     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2681
  2682*****CALCULATED A/H REFUND (PENDING)
  2683     12  FILLER                  PIC  X(03) VALUE '121'.
  2684     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2685     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2686     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2687     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2688
  2689*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2690     12  FILLER                  PIC  X(03) VALUE '122'.
  2691     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2692     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2693     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2694     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2695
  2696*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2697     12  FILLER                  PIC  X(03) VALUE '123'.
  2698     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2699     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2700     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2701     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2702
  2703*****INSUREDS AGE
  2704     12  FILLER                  PIC  X(03) VALUE '124'.
  2705     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2706     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2707     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2708     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2709
  2710*****LIFE BENEFIT (PENDING)
  2711     12  FILLER                  PIC  X(03) VALUE '125'.
  2712     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2713     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2714     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2715     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2716
  2717*****A/H BENEFIT (PENDING)
  2718     12  FILLER                  PIC  X(03) VALUE '126'.
  2719     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2720     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2721     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2722     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2723
  2724*****LIFE RATE
  2725     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  52
* EL689.cbl
  2726     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2727     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2728     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2729     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2730
  2731*****A/H RATE
  2732     12  FILLER                  PIC  X(03) VALUE '128'.
  2733     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2734     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2735     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2736     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2737
  2738*****TERM (PENDING)
  2739     12  FILLER                  PIC  X(03) VALUE '129'.
  2740     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2741     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2742     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2743     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2744
  2745*****BATCH NUMBER
  2746     12  FILLER                  PIC  X(03) VALUE '130'.
  2747     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2748     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2749     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2750     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2751
  2752*****TOTAL OF LIFE AND A&H REFUND
  2753     12  FILLER                  PIC  X(03) VALUE '131'.
  2754     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2755     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2756     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2757     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2758
  2759*****NH INTEREST ON REFUNDS
  2760     12  FILLER                  PIC  X(03) VALUE '132'.
  2761     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2762     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2763     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2764     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2765*****GREATER OF THE LIFE AND AH CANCEL DATE
  2766     12  FILLER                  PIC  X(03) VALUE '133'.
  2767     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2768     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2769     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2770     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2771
  2772*****THE NEXT 6 NOT CURRENTLY USED
  2773     12  FILLER                  PIC  X(03) VALUE '134'.
  2774     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2775     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2776     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2777     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2778
  2779     12  FILLER                  PIC  X(03) VALUE '135'.
  2780     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2781     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2782     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2783     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  53
* EL689.cbl
  2784
  2785     12  FILLER                  PIC  X(03) VALUE '136'.
  2786     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2787     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2788     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2789     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2790
  2791     12  FILLER                  PIC  X(03) VALUE '137'.
  2792     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2793     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2794     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2795     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2796
  2797     12  FILLER                  PIC  X(03) VALUE '138'.
  2798     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2799     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2800     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2801     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2802
  2803     12  FILLER                  PIC  X(03) VALUE '139'.
  2804     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2805     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2806     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2807     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2808
  2809************** COMPENSATION VARIABLES - ERCOMP ****************
  2810*****COMPENSATION ACCT NAME
  2811     12  FILLER                  PIC  X(03) VALUE '140'.
  2812     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2813     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2814     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2815     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2816
  2817*****FULL COMPENSATION ADDRESS TYPE 'A'
  2818     12  FILLER                  PIC  X(03) VALUE '141'.
  2819     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2820     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2821     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2822     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2823
  2824     12  FILLER                  PIC  X(03) VALUE '142'.
  2825     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2826     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2827     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2828     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2829
  2830     12  FILLER                  PIC  X(03) VALUE '143'.
  2831     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2832     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2833     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2834     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2835
  2836     12  FILLER                  PIC  X(03) VALUE '144'.
  2837     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2838     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2839     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2840     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2841
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  54
* EL689.cbl
  2842     12  FILLER                  PIC  X(03) VALUE '145'.
  2843     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2844     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2845     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2846     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2847
  2848     12  FILLER                  PIC  X(03) VALUE '146'.
  2849     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2850     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2851     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2852     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2853
  2854*****COMPENSATION PHONE NUMBER
  2855     12  FILLER                  PIC  X(03) VALUE '147'.
  2856     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2857     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2858     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2859     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2860
  2861*****COMPENSATION CSR NAME
  2862     12  FILLER                  PIC  X(03) VALUE '148'.
  2863     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2864     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2865     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2866     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2867
  2868*****COMPENSATION LAST STATEMENT DATE
  2869     12  FILLER                  PIC  X(03) VALUE '149'.
  2870     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2871     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2872     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2873     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2874
  2875*****COMPENSATION ENDING BALANCE
  2876     12  FILLER                  PIC  X(03) VALUE '150'.
  2877     12  FILLER                  PIC S9(04) COMP VALUE +14.
  2878     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2879     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2880     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2881
  2882******************  PROCESSOR DATA - ELCNTL (2) ****************
  2883*****EXECUTING PROCESSOR NAME
  2884     12  FILLER                  PIC  X(03) VALUE '151'.
  2885     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2886     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2887     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2888     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2889
  2890*****PROCESSOR TITLE
  2891     12  FILLER                  PIC  X(03) VALUE '152'.
  2892     12  FILLER                  PIC S9(04) COMP VALUE +26.
  2893     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2894     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2895     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2896
  2897*****PROCESSOR
  2898     12  FILLER                  PIC  X(03) VALUE '153'.
  2899     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  55
* EL689.cbl
  2900     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2901     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2902     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2903
  2904*****CSR TITLE
  2905     12  FILLER                  PIC  X(03) VALUE '154'.
  2906     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2907     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2908     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2909     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2910*****REMAINING 2 ARE NOT CURRENTLY USED
  2911     12  FILLER                  PIC  X(03) VALUE '155'.
  2912     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2913     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2914     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2915     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2916
  2917     12  FILLER                  PIC  X(03) VALUE '156'.
  2918     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2919     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2920     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2921     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2922
  2923******************  CHECK DATA - ERCHEK    *********************
  2924*****CHECK AMOUNT
  2925     12  FILLER                  PIC  X(03) VALUE '157'.
  2926     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2927     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2928     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2929     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2930
  2931*****CHECK NUMBER
  2932     12  FILLER                  PIC  X(03) VALUE '158'.
  2933     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2934     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2935     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2936     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2937
  2938*****PAYEE 1 NAME
  2939     12  FILLER                  PIC  X(03) VALUE '159'.
  2940     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2941     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2942     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2943     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2944
  2945*****PAYEE 2 NAME
  2946     12  FILLER                  PIC  X(03) VALUE '160'.
  2947     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2948     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2949     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2950     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2951
  2952*****ADDRSS 1
  2953     12  FILLER                  PIC  X(03) VALUE '161'.
  2954     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2955     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2956     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2957     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  56
* EL689.cbl
  2958
  2959*****ADDRESS 2
  2960     12  FILLER                  PIC  X(03) VALUE '162'.
  2961     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2962     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2963     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2964     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2965
  2966*****PAYEE CITY STATE
  2967     12  FILLER                  PIC  X(03) VALUE '163'.
  2968     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2969     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2970     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2971     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2972
  2973*****ZIP CODE
  2974     12  FILLER                  PIC  X(03) VALUE '164'.
  2975     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2976     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2977     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2978     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2979
  2980*****CHECK CONTROL
  2981     12  FILLER                  PIC  X(03) VALUE '165'.
  2982     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2983     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2984     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2985     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2986
  2987*****REASON FOR CHECK
  2988     12  FILLER                  PIC  X(03) VALUE '166'.
  2989     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2990     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2991     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2992     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2993
  2994*****REMAINING 3 ARE NOT CURRENTLY USED
  2995     12  FILLER                  PIC  X(03) VALUE '167'.
  2996     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2997     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2998     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2999     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3000
  3001     12  FILLER                  PIC  X(03) VALUE '168'.
  3002     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3003     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3004     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3005     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3006
  3007     12  FILLER                  PIC  X(03) VALUE '169'.
  3008     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3009     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3010     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3011     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3012
  3013
  3014*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3015*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  57
* EL689.cbl
  3016     12  FILLER                  PIC  X(03) VALUE '170'.
  3017     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3018     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3019     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3020     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3021
  3022*****CHECK NUMBER - PYAJ
  3023     12  FILLER                  PIC  X(03) VALUE '171'.
  3024     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3025     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3026     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3027     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3028
  3029*****CHECK CONTROL - PYAJ
  3030     12  FILLER                  PIC  X(03) VALUE '172'.
  3031     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3032     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3033     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3034     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3035
  3036***** COMMENT - PYAJ
  3037     12  FILLER                  PIC  X(03) VALUE '173'.
  3038     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3039     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3040     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3041     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3042
  3043*****NEW FIELDS.
  3044*****COMPENSATION FULL ADDRESS TYPE 'G'
  3045     12  FILLER                  PIC  X(03) VALUE '174'.
  3046     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3047     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3048     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3049     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3050
  3051     12  FILLER                  PIC  X(03) VALUE '175'.
  3052     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3053     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3054     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3055     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3056
  3057     12  FILLER                  PIC  X(03) VALUE '176'.
  3058     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3059     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3060     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3061     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3062
  3063     12  FILLER                  PIC  X(03) VALUE '177'.
  3064     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3065     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3066     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3067     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3068
  3069     12  FILLER                  PIC  X(03) VALUE '178'.
  3070     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3071     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3072     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3073     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  58
* EL689.cbl
  3074
  3075     12  FILLER                  PIC  X(03) VALUE '179'.
  3076     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3077     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3078     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3079     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3080
  3081*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3082     12  FILLER                  PIC  X(03) VALUE '180'.
  3083     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3084     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3085     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3086     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3087**** COMPENSATION BILLING SWITCH
  3088     12  FILLER                  PIC XXX    VALUE '181'.
  3089     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3090     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3091     12  FILLER                  PIC X      VALUE ALL 'N'.
  3092     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3093*****COMPENSATION FAX NUMBER
  3094     12  FILLER                  PIC  X(03) VALUE '182'.
  3095     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3096     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3097     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3098     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3099**** COMPENSATION STATUS
  3100     12  FILLER                  PIC XXX    VALUE '183'.
  3101     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3102     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3103     12  FILLER                  PIC X      VALUE ALL 'N'.
  3104     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3105***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3106*****COMPENSATION FULL ADDRESS TYPE 'B'
  3107     12  FILLER                  PIC  X(03) VALUE '184'.
  3108     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3109     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3110     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3111     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3112
  3113     12  FILLER                  PIC  X(03) VALUE '185'.
  3114     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3115     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3116     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3117     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3118
  3119     12  FILLER                  PIC  X(03) VALUE '186'.
  3120     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3121     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3122     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3123     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3124
  3125     12  FILLER                  PIC  X(03) VALUE '187'.
  3126     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3127     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3128     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3129     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3130
  3131     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  59
* EL689.cbl
  3132     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3133     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3134     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3135     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3136
  3137     12  FILLER                  PIC  X(03) VALUE '189'.
  3138     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3139     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3140     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3141     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3142
  3143
  3144 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3145*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3146     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3147                        INDEXED BY W-VG-NDX.
  3148         16  W-VARIABLE-ID         PIC  X(03).
  3149         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3150         16  W-VG-TEXT.
  3151             20  W-VAR-CHAR
  3152                        OCCURS 30 TIMES
  3153                        INDEXED BY W-VC-NDX
  3154                                   PIC  X(01).
  3155         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3156             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3157
  3158         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3159
  3160 01  W-VAR-END                   PIC  X(23)
  3161                        VALUE ':VARIABLE WORK AREA END'.
  3162
  3163 01  W-PROGRAM-TABLE-AREA.
  3164     12  FILLER                  PIC  X(15)
  3165                                 VALUE 'PROGRAM TABLES:'.
  3166
  3167     12  W-RECORD-TABLE              VALUE SPACES.
  3168         16  W-RC-GRP OCCURS 500 TIMES
  3169                       INDEXED BY W-RG-NDX
  3170                                  W-RG-NDX1.
  3171             20  W-RC-TEXT.
  3172                 24  W-RC-CHAR OCCURS 70 TIMES
  3173                                INDEXED BY W-RC-NDX
  3174                                           W-RC-NDX1
  3175                                 PIC  X(01).
  3176             20  W-RC-PC         PIC  9(02).
  3177             20  W-RC-SC         PIC  X(01).
  3178
  3179     12  FILLER REDEFINES W-RECORD-TABLE.
  3180         16  W-REC-CHAR OCCURS 36500 TIMES
  3181                        INDEXED BY W-RVS-NDX
  3182                                   W-RVS-NDX2
  3183                                 PIC  X(01).
  3184     12  FILLER REDEFINES W-RECORD-TABLE.
  3185         16  W-TS-GROUP OCCURS 10 TIMES
  3186                        INDEXED BY W-TS-NDX
  3187                                 PIC X(3650).
  3188
  3189     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  60
* EL689.cbl
  3190                                 VALUE 'TEXT TABLE:'.
  3191     12  W-TX-TABLE                  VALUE SPACES.
  3192         16  W-TX-GRP OCCURS 500 TIMES
  3193                       INDEXED BY W-TG-NDX
  3194                                  W-TG-NDX2.
  3195             20  W-TX-TEXT.
  3196                 24  W-TX-CHAR OCCURS 70 TIMES
  3197                                    INDEXED BY W-TX-NDX
  3198                                               W-TX-NDX1
  3199                                               W-TX-NDX2
  3200                                 PIC  X(01).
  3201             20  W-TX-PC         PIC  9(02).
  3202             20  W-TX-SC         PIC  X(01).
  3203
  3204     12  FILLER                  PIC  X(11)
  3205                                 VALUE 'FILE TABLE:'.
  3206     12  W-FILE-TABLE                VALUE SPACES.
  3207         16  W-FILE-USE-IND OCCURS 20 TIMES
  3208                       INDEXED BY W-FILE-NDX
  3209                                 PIC  X(01).
  3210             88  W-FILE-NOT-USED     VALUE SPACE.
  3211             88  W-FILE-USED         VALUE 'Y'.
  3212
  3213     12  FILLER                  PIC  X(14)
  3214                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  61
* EL689.cbl
  3216 01  ERROR-MESSAGES.
  3217     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3218     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3219     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3220     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3221     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3222     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3223     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3224     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3225     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3226     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3227     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3228     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3229     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3230     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3231     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3232     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3233     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3234     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3235     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3236     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3237     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3238     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3239     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3240     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3241     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3242     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3243     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3244     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3245     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3246     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3247     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3248     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3249     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3250     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3251     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3252     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3253     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3254     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3255     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3256     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3257     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3258     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3259     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3260     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3261     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3262     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3263     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3264     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3265     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3266     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3267     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3268     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3269     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3270     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3271     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3272     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3273     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  62
* EL689.cbl
  3274     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3275     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3276     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3277     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3278     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3279     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3280     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3281     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3282     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3283     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3284     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3285     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3286     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3287     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3288     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3289     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3290     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3291     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3292     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3293     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3294     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3295     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3296     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3297     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3298     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3299     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3300     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3301     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3302     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3303     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3304     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3305     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3306     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3307     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3308     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3309     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3310     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3311     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3312     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3313     12  ER-9427                 PIC  X(04) VALUE '9427'.
  3314     12  ER-9840                 PIC  X(04) VALUE '9840'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  63
* EL689.cbl
  3316*    COPY ELCAID.
  3317******************************************************************
  3318*                                                                *
  3319*                            ELCAID.                             *
  3320*                            VMOD=2.001                          *
  3321*                                                                *
  3322*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3323*                                                                *
  3324*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3325*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3326******************************************************************
  3327
  3328 01  DFHAID.
  3329   02  DFHNULL   PIC  X  VALUE  ' '.
  3330   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3331   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3332   02  DFHPEN    PIC  X  VALUE  '='.
  3333   02  DFHOPID   PIC  X  VALUE  'W'.
  3334   02  DFHPA1    PIC  X  VALUE  '%'.
  3335   02  DFHPA2    PIC  X  VALUE  '>'.
  3336   02  DFHPA3    PIC  X  VALUE  ','.
  3337   02  DFHPF1    PIC  X  VALUE  '1'.
  3338   02  DFHPF2    PIC  X  VALUE  '2'.
  3339   02  DFHPF3    PIC  X  VALUE  '3'.
  3340   02  DFHPF4    PIC  X  VALUE  '4'.
  3341   02  DFHPF5    PIC  X  VALUE  '5'.
  3342   02  DFHPF6    PIC  X  VALUE  '6'.
  3343   02  DFHPF7    PIC  X  VALUE  '7'.
  3344   02  DFHPF8    PIC  X  VALUE  '8'.
  3345   02  DFHPF9    PIC  X  VALUE  '9'.
  3346   02  DFHPF10   PIC  X  VALUE  ':'.
  3347   02  DFHPF11   PIC  X  VALUE  '#'.
  3348   02  DFHPF12   PIC  X  VALUE  '@'.
  3349   02  DFHPF13   PIC  X  VALUE  'A'.
  3350   02  DFHPF14   PIC  X  VALUE  'B'.
  3351   02  DFHPF15   PIC  X  VALUE  'C'.
  3352   02  DFHPF16   PIC  X  VALUE  'D'.
  3353   02  DFHPF17   PIC  X  VALUE  'E'.
  3354   02  DFHPF18   PIC  X  VALUE  'F'.
  3355   02  DFHPF19   PIC  X  VALUE  'G'.
  3356   02  DFHPF20   PIC  X  VALUE  'H'.
  3357   02  DFHPF21   PIC  X  VALUE  'I'.
  3358*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3359   02  DFHPF22   PIC  X  VALUE  '['.
  3360   02  DFHPF23   PIC  X  VALUE  '.'.
  3361   02  DFHPF24   PIC  X  VALUE  '<'.
  3362   02  DFHMSRE   PIC  X  VALUE  'X'.
  3363   02  DFHSTRF   PIC  X  VALUE  'h'.
  3364   02  DFHTRIG   PIC  X  VALUE  '"'.
  3365 01  FILLER    REDEFINES DFHAID.
  3366     12  FILLER                  PIC  X(08).
  3367     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  64
* EL689.cbl
  3369*    COPY ELCATTR.
  3370******************************************************************
  3371*                                                                *
  3372*                            ELCATTR.                            *
  3373*                            VMOD=2.001                          *
  3374*                                                                *
  3375*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3376*                                                                *
  3377*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3378*                                                                *
  3379*                   POS 1   P=PROTECTED                          *
  3380*                           U=UNPROTECTED                        *
  3381*                           S=ASKIP                              *
  3382*                   POS 2   A=ALPHA/NUMERIC                      *
  3383*                           N=NUMERIC                            *
  3384*                   POS 3   N=NORMAL                             *
  3385*                           B=BRIGHT                             *
  3386*                           D=DARK                               *
  3387*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3388*                           OF=MODIFIED DATA TAG OFF             *
  3389*                                                                *
  3390*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3391******************************************************************
  3392 01  ATTRIBUTE-LIST.
  3393     12  AL-PABOF            PIC X       VALUE 'Y'.
  3394     12  AL-PABON            PIC X       VALUE 'Z'.
  3395     12  AL-PADOF            PIC X       VALUE '%'.
  3396     12  AL-PADON            PIC X       VALUE '_'.
  3397     12  AL-PANOF            PIC X       VALUE '-'.
  3398     12  AL-PANON            PIC X       VALUE '/'.
  3399     12  AL-SABOF            PIC X       VALUE '8'.
  3400     12  AL-SABON            PIC X       VALUE '9'.
  3401     12  AL-SADOF            PIC X       VALUE '@'.
  3402     12  AL-SADON            PIC X       VALUE QUOTE.
  3403     12  AL-SANOF            PIC X       VALUE '0'.
  3404     12  AL-SANON            PIC X       VALUE '1'.
  3405     12  AL-UABOF            PIC X       VALUE 'H'.
  3406     12  AL-UABON            PIC X       VALUE 'I'.
  3407     12  AL-UADOF            PIC X       VALUE '<'.
  3408     12  AL-UADON            PIC X       VALUE '('.
  3409     12  AL-UANOF            PIC X       VALUE ' '.
  3410     12  AL-UANON            PIC X       VALUE 'A'.
  3411     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3412     12  AL-UNBON            PIC X       VALUE 'R'.
  3413     12  AL-UNDOF            PIC X       VALUE '*'.
  3414     12  AL-UNDON            PIC X       VALUE ')'.
  3415     12  AL-UNNOF            PIC X       VALUE '&'.
  3416     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  65
* EL689.cbl
  3418*    COPY ELCDATE.
  3419******************************************************************
  3420*                                                                *
  3421*                                                                *
  3422*                            ELCDATE.                            *
  3423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3424*                            VMOD=2.003
  3425*                                                                *
  3426*                                                                *
  3427*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3428*                 LENGTH = 200                                   *
  3429******************************************************************
  3430
  3431 01  DATE-CONVERSION-DATA.
  3432     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3433     12  DC-OPTION-CODE                PIC X.
  3434         88  BIN-TO-GREG                VALUE ' '.
  3435         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3436         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3437         88  YMD-GREG-TO-BIN            VALUE '3'.
  3438         88  MDY-GREG-TO-BIN            VALUE '4'.
  3439         88  JULIAN-TO-BIN              VALUE '5'.
  3440         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3441         88  FIND-CENTURY               VALUE '7'.
  3442         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3443         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3444         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3445         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3446         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3447         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3448         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3449         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3450         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3451         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3452         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3453         88  BIN-3-TO-GREG              VALUE 'I'.
  3454         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3455         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3456         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3457         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3458         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3459         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3460         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3461         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3462         88  THREE-CHARACTER-BIN
  3463                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3464         88  GREGORIAN-TO-BIN
  3465                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3466         88  BIN-TO-GREGORIAN
  3467                  VALUES ' ' '1' 'I' '8' 'G'.
  3468         88  JULIAN-TO-BINARY
  3469                  VALUES '5' 'C' 'E' 'F'.
  3470     12  DC-ERROR-CODE                 PIC X.
  3471         88  NO-CONVERSION-ERROR        VALUE ' '.
  3472         88  DATE-CONVERSION-ERROR
  3473                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3474         88  DATE-IS-ZERO               VALUE '1'.
  3475         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  66
* EL689.cbl
  3476         88  DATE-IS-INVALID            VALUE '3'.
  3477         88  DATE1-GREATER-DATE2        VALUE '4'.
  3478         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3479         88  DATE-INVALID-OPTION        VALUE '9'.
  3480         88  INVALID-CENTURY            VALUE 'A'.
  3481         88  ONLY-CENTURY               VALUE 'B'.
  3482         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3483         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3484     12  DC-END-OF-MONTH               PIC X.
  3485         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3486     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3487         88  USE-NORMAL-PROCESS         VALUE ' '.
  3488         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3489         88  ADJUST-UP-100-YRS          VALUE '2'.
  3490     12  FILLER                        PIC X.
  3491     12  DC-CONVERSION-DATES.
  3492         16  DC-BIN-DATE-1             PIC XX.
  3493         16  DC-BIN-DATE-2             PIC XX.
  3494         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3495         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3496                       DC-GREG-DATE-1-EDIT.
  3497             20  DC-EDIT1-MONTH        PIC 99.
  3498             20  SLASH1-1              PIC X.
  3499             20  DC-EDIT1-DAY          PIC 99.
  3500             20  SLASH1-2              PIC X.
  3501             20  DC-EDIT1-YEAR         PIC 99.
  3502         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3503         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3504                     DC-GREG-DATE-2-EDIT.
  3505             20  DC-EDIT2-MONTH        PIC 99.
  3506             20  SLASH2-1              PIC X.
  3507             20  DC-EDIT2-DAY          PIC 99.
  3508             20  SLASH2-2              PIC X.
  3509             20  DC-EDIT2-YEAR         PIC 99.
  3510         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3511         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3512                     DC-GREG-DATE-1-YMD.
  3513             20  DC-YMD-YEAR           PIC 99.
  3514             20  DC-YMD-MONTH          PIC 99.
  3515             20  DC-YMD-DAY            PIC 99.
  3516         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3517         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3518                      DC-GREG-DATE-1-MDY.
  3519             20  DC-MDY-MONTH          PIC 99.
  3520             20  DC-MDY-DAY            PIC 99.
  3521             20  DC-MDY-YEAR           PIC 99.
  3522         16  DC-GREG-DATE-1-ALPHA.
  3523             20  DC-ALPHA-MONTH        PIC X(10).
  3524             20  DC-ALPHA-DAY          PIC 99.
  3525             20  FILLER                PIC XX.
  3526             20  DC-ALPHA-CENTURY.
  3527                 24 DC-ALPHA-CEN-N     PIC 99.
  3528             20  DC-ALPHA-YEAR         PIC 99.
  3529         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3530         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3531         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3532         16  DC-JULIAN-DATE            PIC 9(05).
  3533         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  67
* EL689.cbl
  3534                                       PIC 9(05).
  3535         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3536             20  DC-JULIAN-YEAR        PIC 99.
  3537             20  DC-JULIAN-DAYS        PIC 999.
  3538         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3539         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3540         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3541     12  DATE-CONVERSION-VARIBLES.
  3542         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3543         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3544             20  FILLER                PIC 9(3).
  3545             20  HOLD-CEN-1-CCYY.
  3546                 24  HOLD-CEN-1-CC     PIC 99.
  3547                 24  HOLD-CEN-1-YY     PIC 99.
  3548             20  HOLD-CEN-1-MO         PIC 99.
  3549             20  HOLD-CEN-1-DA         PIC 99.
  3550         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3551             20  HOLD-CEN-1-R-MO       PIC 99.
  3552             20  HOLD-CEN-1-R-DA       PIC 99.
  3553             20  HOLD-CEN-1-R-CCYY.
  3554                 24  HOLD-CEN-1-R-CC   PIC 99.
  3555                 24  HOLD-CEN-1-R-YY   PIC 99.
  3556             20  FILLER                PIC 9(3).
  3557         16  HOLD-CENTURY-1-X.
  3558             20  FILLER                PIC X(3)  VALUE SPACES.
  3559             20  HOLD-CEN-1-X-CCYY.
  3560                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3561                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3562             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3563             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3564         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3565             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3566             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3567             20  HOLD-CEN-1-R-X-CCYY.
  3568                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3569                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3570             20  FILLER                PIC XXX.
  3571         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3572         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3573         16  DC-JULIAN-DATE-1          PIC 9(07).
  3574         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3575             20  DC-JULIAN-1-CCYY.
  3576                 24  DC-JULIAN-1-CC    PIC 99.
  3577                 24  DC-JULIAN-1-YR    PIC 99.
  3578             20  DC-JULIAN-DA-1        PIC 999.
  3579         16  DC-JULIAN-DATE-2          PIC 9(07).
  3580         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3581             20  DC-JULIAN-2-CCYY.
  3582                 24  DC-JULIAN-2-CC    PIC 99.
  3583                 24  DC-JULIAN-2-YR    PIC 99.
  3584             20  DC-JULIAN-DA-2        PIC 999.
  3585         16  DC-GREG-DATE-A-EDIT.
  3586             20  DC-EDITA-MONTH        PIC 99.
  3587             20  SLASHA-1              PIC X VALUE '/'.
  3588             20  DC-EDITA-DAY          PIC 99.
  3589             20  SLASHA-2              PIC X VALUE '/'.
  3590             20  DC-EDITA-CCYY.
  3591                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  68
* EL689.cbl
  3592                 24  DC-EDITA-YEAR     PIC 99.
  3593         16  DC-GREG-DATE-B-EDIT.
  3594             20  DC-EDITB-MONTH        PIC 99.
  3595             20  SLASHB-1              PIC X VALUE '/'.
  3596             20  DC-EDITB-DAY          PIC 99.
  3597             20  SLASHB-2              PIC X VALUE '/'.
  3598             20  DC-EDITB-CCYY.
  3599                 24  DC-EDITB-CENT     PIC 99.
  3600                 24  DC-EDITB-YEAR     PIC 99.
  3601         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3602         16  DC-GREG-DATE-CYMD-R REDEFINES
  3603                              DC-GREG-DATE-CYMD.
  3604             20  DC-CYMD-CEN           PIC 99.
  3605             20  DC-CYMD-YEAR          PIC 99.
  3606             20  DC-CYMD-MONTH         PIC 99.
  3607             20  DC-CYMD-DAY           PIC 99.
  3608         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3609         16  DC-GREG-DATE-MDCY-R REDEFINES
  3610                              DC-GREG-DATE-MDCY.
  3611             20  DC-MDCY-MONTH         PIC 99.
  3612             20  DC-MDCY-DAY           PIC 99.
  3613             20  DC-MDCY-CEN           PIC 99.
  3614             20  DC-MDCY-YEAR          PIC 99.
  3615    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3616        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3617    12  DC-EL310-DATE                  PIC X(21).
  3618    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  69
* EL689.cbl
  3620*    COPY ELCNWA.
  3621*****************************************************************
  3622*                                                               *
  3623*                                                               *
  3624*                            ELCNWA.                            *
  3625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3626*                            VMOD=2.003                         *
  3627*                                                               *
  3628*            M O V E   N A M E   W O R K   A R E A.             *
  3629*                                                               *
  3630*****************************************************************.
  3631
  3632 01  WS-NAME-WORK-AREA.
  3633     05  WS-INSURED-LAST-NAME        PIC X(15).
  3634     05  WS-INSURED-1ST-NAME         PIC X(12).
  3635     05  WS-INSURED-MID-INIT         PIC X.
  3636
  3637     05  WS-NAME-WORK.
  3638         10  WS-NW                   PIC X
  3639             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3640
  3641     05  WS-NAME-WORK2.
  3642         10  WS-NW2                  PIC X
  3643             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3644                                        NWA-INDEX0.
  3645
  3646     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3647                                     COMP-3.
  3648
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  70
* EL689.cbl
  3650*    COPY ELCEMIB.
  3651******************************************************************
  3652*                                                                *
  3653*                                                                *
  3654*                            ELCEMIB.                            *
  3655*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3656*                            VMOD=2.005                          *
  3657*                                                                *
  3658*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3659*                                                                *
  3660******************************************************************
  3661 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3662     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3663     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3664     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3665     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3666     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3667     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3668     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3669     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3670     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3671         88  EMI-NO-ERRORS                    VALUE '1'.
  3672         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3673         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3674     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3675         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3676     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3677         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3678         88  EMI-AREA1-FULL                   VALUE '2'.
  3679     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3680         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3681         88  EMI-AREA2-FULL                   VALUE '2'.
  3682     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3683         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3684         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3685         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3686         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3687         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3688     12  EMI-ERROR-LINES.
  3689         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3690         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3691         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3692         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3693             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3694                 24  EMI-ERR-NUM         PIC X(4).
  3695                 24  EMI-FILLER          PIC X.
  3696                 24  EMI-SEV             PIC X.
  3697                 24  FILLER              PIC X.
  3698             20  FILLER                  PIC X(02).
  3699     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3700         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3701             20  EMI-ERROR-NUMBER    PIC X(4).
  3702             20  EMI-FILL            PIC X.
  3703             20  EMI-SEVERITY        PIC X.
  3704             20  FILLER              PIC X.
  3705             20  EMI-ERROR-TEXT.
  3706                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3707                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  71
* EL689.cbl
  3708     12  EMI-SEVERITY-SAVE           PIC X.
  3709         88  EMI-NOTE                    VALUE 'N'.
  3710         88  EMI-WARNING                 VALUE 'W'.
  3711         88  EMI-FORCABLE                VALUE 'F'.
  3712         88  EMI-FATAL                   VALUE 'X'.
  3713     12  EMI-MESSAGE-FLAG            PIC X.
  3714         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3715         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3716     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3717     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3718         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3719         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3720         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3721     12  FILLER                      PIC X(137)  VALUE SPACES.
  3722     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3723     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3724     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3725     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3726 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  72
* EL689.cbl
  3728*    COPY ELCLOGOF.
  3729******************************************************************
  3730*                                                                *
  3731*                                                                *
  3732*                            ELCLOGOF.                           *
  3733*                            VMOD=2.001                          *
  3734*                                                                *
  3735*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3736*                                                                *
  3737******************************************************************
  3738 01  CLASIC-LOGOFF.
  3739     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3740     12  LOGOFF-TEXT.
  3741         16  FILLER          PIC X(5)    VALUE SPACES.
  3742         16  LOGOFF-MSG.
  3743             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3744             20  FILLER      PIC X       VALUE SPACES.
  3745             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3746         16  FILLER          PIC X(80)
  3747           VALUE '* YOU ARE NOW LOGGED OFF'.
  3748         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3749         16  FILLER          PIC X       VALUE QUOTE.
  3750         16  LOGOFF-SYS-MSG  PIC X(17)
  3751           VALUE 'S CLAS-IC SYSTEM '.
  3752     12  TEXT-MESSAGES.
  3753         16  UNACCESS-MSG    PIC X(29)
  3754             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3755         16  PGMIDERR-MSG    PIC X(17)
  3756             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  73
* EL689.cbl
  3758*    COPY ELCSCTM.
  3759******************************************************************
  3760*                                                                *
  3761*                                                                *
  3762*                            ELCSCTM                             *
  3763*                            VMOD=2.001                          *
  3764*                                                                *
  3765*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3766*                                                                *
  3767******************************************************************
  3768 01  SECURITY-MESSAGE.
  3769     12  FILLER                          PIC X(30)
  3770            VALUE '** LOGIC SECURITY VIOLATION -'.
  3771     12  SM-READ                         PIC X(6).
  3772     12  FILLER                          PIC X(5)
  3773            VALUE ' PGM='.
  3774     12  SM-PGM                          PIC X(6).
  3775     12  FILLER                          PIC X(5)
  3776            VALUE ' OPR='.
  3777     12  SM-PROCESSOR-ID                 PIC X(4).
  3778     12  FILLER                          PIC X(6)
  3779            VALUE ' TERM='.
  3780     12  SM-TERMID                       PIC X(4).
  3781     12  FILLER                          PIC XX   VALUE SPACE.
  3782     12  SM-JUL-DATE                     PIC 9(5).
  3783     12  FILLER                          PIC X    VALUE SPACE.
  3784     12  SM-TIME                         PIC 99.99.
  3785
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  74
* EL689.cbl
  3787*    COPY ELCSCRTY.
  3788******************************************************************
  3789*                                                                *
  3790*                                                                *
  3791*                            ELCSCRTY                            *
  3792*                            VMOD=2.001                          *
  3793*                                                                *
  3794*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3795*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3796*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3797*                                                                *
  3798******************************************************************
  3799 01  SECURITY-CONTROL.
  3800     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3801     12  FILLER                       PIC XX    VALUE 'SC'.
  3802     12  SC-CREDIT-CODES.
  3803         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3804             20  SC-CREDIT-DISPLAY    PIC X.
  3805             20  SC-CREDIT-UPDATE     PIC X.
  3806     12  SC-CLAIMS-CODES.
  3807         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3808             20  SC-CLAIMS-DISPLAY    PIC X.
  3809             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  75
* EL689.cbl
  3811
  3812 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  76
* EL689.cbl
  3814****************************************************************
  3815*
  3816* Copyright (c) 2007 by Clerity Solutions, Inc.
  3817* All rights reserved.
  3818*
  3819****************************************************************
  3820 01  DFHEIV.
  3821   02  DFHEIV0               PIC X(35).
  3822   02  DFHEIV1               PIC X(08).
  3823   02  DFHEIV2               PIC X(08).
  3824   02  DFHEIV3               PIC X(08).
  3825   02  DFHEIV4               PIC X(06).
  3826   02  DFHEIV5               PIC X(04).
  3827   02  DFHEIV6               PIC X(04).
  3828   02  DFHEIV7               PIC X(02).
  3829   02  DFHEIV8               PIC X(02).
  3830   02  DFHEIV9               PIC X(01).
  3831   02  DFHEIV10              PIC S9(7) COMP-3.
  3832   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3833   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3834   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3835   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3836   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3837   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3838   02  DFHEIV17              PIC X(04).
  3839   02  DFHEIV18              PIC X(04).
  3840   02  DFHEIV19              PIC X(04).
  3841   02  DFHEIV20              USAGE IS POINTER.
  3842   02  DFHEIV21              USAGE IS POINTER.
  3843   02  DFHEIV22              USAGE IS POINTER.
  3844   02  DFHEIV23              USAGE IS POINTER.
  3845   02  DFHEIV24              USAGE IS POINTER.
  3846   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3847   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3848   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3849   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3850   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3851   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3852   02  FILLER                PIC X(02).
  3853   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3854   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3855   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3856   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3857   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3858 LINKAGE  SECTION.
  3859*****************************************************************
  3860*                                                               *
  3861* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3862* All rights reserved.                                          *
  3863*                                                               *
  3864*****************************************************************
  3865 01  dfheiblk.
  3866     02  eibtime          pic s9(7) comp-3.
  3867     02  eibdate          pic s9(7) comp-3.
  3868     02  eibtrnid         pic x(4).
  3869     02  eibtaskn         pic s9(7) comp-3.
  3870     02  eibtrmid         pic x(4).
  3871     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  77
* EL689.cbl
  3872     02  eibcposn         pic s9(4) comp.
  3873     02  eibcalen         pic s9(4) comp.
  3874     02  eibaid           pic x(1).
  3875     02  eibfiller1       pic x(1).
  3876     02  eibfn            pic x(2).
  3877     02  eibfiller2       pic x(2).
  3878     02  eibrcode         pic x(6).
  3879     02  eibfiller3       pic x(2).
  3880     02  eibds            pic x(8).
  3881     02  eibreqid         pic x(8).
  3882     02  eibrsrce         pic x(8).
  3883     02  eibsync          pic x(1).
  3884     02  eibfree          pic x(1).
  3885     02  eibrecv          pic x(1).
  3886     02  eibsend          pic x(1).
  3887     02  eibatt           pic x(1).
  3888     02  eibeoc           pic x(1).
  3889     02  eibfmh           pic x(1).
  3890     02  eibcompl         pic x(1).
  3891     02  eibsig           pic x(1).
  3892     02  eibconf          pic x(1).
  3893     02  eiberr           pic x(1).
  3894     02  eibrldbk         pic x(1).
  3895     02  eiberrcd         pic x(4).
  3896     02  eibsynrb         pic x(1).
  3897     02  eibnodat         pic x(1).
  3898     02  eibfiller5       pic x(2).
  3899     02  eibresp          pic 9(09) comp.
  3900     02  eibresp2         pic 9(09) comp.
  3901     02  dfheigdj         pic s9(4) comp.
  3902     02  dfheigdk         pic s9(4) comp.
  3903 01  DFHCOMMAREA                 PIC X(1024).
  3904 01  var  pic x(30).
  3905
  3906*    COPY ERCACCT.
  3907******************************************************************
  3908*                                                                *
  3909*                                                                *
  3910*                            ERCACCT                             *
  3911*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3912*                            VMOD=2.031                          *
  3913*                                                                *
  3914*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3915*                                                                *
  3916*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3917*   VSAM ACCOUNT MASTER FILES.                                   *
  3918*                                                                *
  3919*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3920*                                                                *
  3921*   FILE TYPE = VSAM,KSDS                                        *
  3922*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3923*                                                                *
  3924*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3925*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3926*                                                                *
  3927*   LOG = NO                                                     *
  3928*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3929*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  78
* EL689.cbl
  3930*                                                                *
  3931******************************************************************
  3932*                   C H A N G E   L O G
  3933*
  3934* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3935*-----------------------------------------------------------------
  3936*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3937* EFFECTIVE    NUMBER
  3938*-----------------------------------------------------------------
  3939* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3940* 092705    2005050300006  PEMA  ADD SPP LEASES
  3941* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3942* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3943* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3944* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3945* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3946******************************************************************
  3947
  3948 01  ACCOUNT-MASTER.
  3949     12  AM-RECORD-ID                      PIC XX.
  3950         88  VALID-AM-ID                      VALUE 'AM'.
  3951
  3952     12  AM-CONTROL-PRIMARY.
  3953         16  AM-COMPANY-CD                 PIC X.
  3954         16  AM-MSTR-CNTRL.
  3955             20  AM-CONTROL-A.
  3956                 24  AM-CARRIER            PIC X.
  3957                 24  AM-GROUPING.
  3958                     28 AM-GROUPING-PREFIX PIC XXX.
  3959                     28 AM-GROUPING-PRIME  PIC XXX.
  3960                 24  AM-STATE              PIC XX.
  3961                 24  AM-ACCOUNT.
  3962                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3963                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3964             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3965                                           PIC X(19).
  3966             20  AM-CNTRL-B.
  3967                 24  AM-EXPIRATION-DT      PIC XX.
  3968                 24  FILLER                PIC X(4).
  3969             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3970                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3971
  3972     12  AM-CONTROL-BY-VAR-GRP.
  3973         16  AM-COMPANY-CD-A1              PIC X.
  3974         16  AM-VG-CARRIER                 PIC X.
  3975         16  AM-VG-GROUPING                PIC X(6).
  3976         16  AM-VG-STATE                   PIC XX.
  3977         16  AM-VG-ACCOUNT                 PIC X(10).
  3978         16  AM-VG-DATE.
  3979             20  AM-VG-EXPIRATION-DT       PIC XX.
  3980             20  FILLER                    PIC X(4).
  3981         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3982                                           PIC 9(11)      COMP-3.
  3983     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3984         16  FILLER                        PIC X(10).
  3985         16  AM-VG-KEY3.
  3986             20  AM-VG3-ACCOUNT            PIC X(10).
  3987             20  AM-VG3-EXP-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  79
* EL689.cbl
  3988         16  FILLER                        PIC X(4).
  3989     12  AM-MAINT-INFORMATION.
  3990         16  AM-LAST-MAINT-DT              PIC XX.
  3991         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3992         16  AM-LAST-MAINT-USER            PIC X(4).
  3993         16  FILLER                        PIC XX.
  3994
  3995     12  AM-EFFECTIVE-DT                   PIC XX.
  3996     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3997
  3998     12  AM-PREV-DATES  COMP-3.
  3999         16  AM-PREV-EXP-DT                PIC 9(11).
  4000         16  AM-PREV-EFF-DT                PIC 9(11).
  4001
  4002     12  AM-REPORT-CODE-1                  PIC X(10).
  4003     12  AM-REPORT-CODE-2                  PIC X(10).
  4004
  4005     12  AM-CITY-CODE                      PIC X(4).
  4006     12  AM-COUNTY-PARISH                  PIC X(6).
  4007
  4008     12  AM-NAME                           PIC X(30).
  4009     12  AM-PERSON                         PIC X(30).
  4010     12  AM-ADDRS                          PIC X(30).
  4011     12  AM-CITY.
  4012         16  AM-ADDR-CITY                  PIC X(28).
  4013         16  AM-ADDR-STATE                 PIC XX.
  4014     12  AM-ZIP.
  4015         16  AM-ZIP-PRIME.
  4016             20  AM-ZIP-PRI-1ST            PIC X.
  4017                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4018             20  FILLER                    PIC X(4).
  4019         16  AM-ZIP-PLUS4                  PIC X(4).
  4020     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4021         16  AM-CAN-POSTAL-1               PIC XXX.
  4022         16  AM-CAN-POSTAL-2               PIC XXX.
  4023         16  FILLER                        PIC XXX.
  4024     12  AM-TEL-NO.
  4025         16  AM-AREA-CODE                  PIC 999.
  4026         16  AM-TEL-PRE                    PIC 999.
  4027         16  AM-TEL-NBR                    PIC 9(4).
  4028     12  AM-TEL-LOC                        PIC X.
  4029         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4030         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4031
  4032     12  AM-COMM-STRUCTURE.
  4033         16  AM-DEFN-1.
  4034             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4035                 24  AM-AGT.
  4036                     28  AM-AGT-PREFIX     PIC X(4).
  4037                     28  AM-AGT-PRIME      PIC X(6).
  4038                 24  AM-COM-TYP            PIC X.
  4039                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4040                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4041                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4042                 24  AM-RECALC-LV-INDIC    PIC X.
  4043                 24  AM-RETRO-LV-INDIC     PIC X.
  4044                 24  AM-GL-CODES           PIC X.
  4045                 24  AM-COMM-CHARGEBACK    PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  80
* EL689.cbl
  4046                 24  FILLER                PIC X(01).
  4047         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4048             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4049                 24  FILLER                PIC X(11).
  4050                 24  AM-L-COMA             PIC XXX.
  4051                 24  AM-J-COMA             PIC XXX.
  4052                 24  AM-A-COMA             PIC XXX.
  4053                 24  FILLER                PIC X(6).
  4054
  4055     12  AM-COMM-CHANGE-STATUS             PIC X.
  4056         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4057
  4058     12  AM-CSR-CODE                       PIC X(4).
  4059
  4060     12  AM-BILLING-STATUS                 PIC X.
  4061         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4062         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4063     12  AM-AUTO-REFUND-SW                 PIC X.
  4064         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4065         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4066     12  AM-GPCD                           PIC 99.
  4067     12  AM-IG                             PIC X.
  4068         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4069         88  AM-HAS-GROUP                     VALUE '2'.
  4070     12  AM-STATUS                         PIC X.
  4071         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4072         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4073         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4074         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4075         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4076         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4077     12  AM-REMIT-TO                       PIC 99.
  4078     12  AM-ID-NO                          PIC X(11).
  4079
  4080     12  AM-CAL-TABLE                      PIC XX.
  4081     12  AM-LF-DEVIATION                   PIC XXX.
  4082     12  AM-AH-DEVIATION                   PIC XXX.
  4083     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4084     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4085     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4086     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4087     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4088     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4089
  4090     12  AM-USER-FIELDS.
  4091         16  AM-FLD-1                      PIC XX.
  4092         16  AM-FLD-2                      PIC XX.
  4093         16  AM-FLD-3                      PIC XX.
  4094         16  AM-FLD-4                      PIC XX.
  4095         16  AM-FLD-5                      PIC XX.
  4096
  4097     12  AM-1ST-PROD-DATE.
  4098         16  AM-1ST-PROD-YR                PIC XX.
  4099         16  AM-1ST-PROD-MO                PIC XX.
  4100         16  AM-1ST-PROD-DA                PIC XX.
  4101     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4102     12  AM-CERTS-PURGED-DATE.
  4103         16  AM-PUR-YR                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  81
* EL689.cbl
  4104         16  AM-PUR-MO                     PIC XX.
  4105         16  AM-PUR-DA                     PIC XX.
  4106     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4107     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4108     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4109     12  AM-INACTIVE-DATE.
  4110         16  AM-INA-MO                     PIC 99.
  4111         16  AM-INA-DA                     PIC 99.
  4112         16  AM-INA-YR                     PIC 99.
  4113     12  AM-AR-HI-CERT-DATE                PIC XX.
  4114
  4115     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4116     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4117
  4118     12  AM-OB-PAYMENT-MODE                PIC X.
  4119         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4120         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4121         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4122         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4123
  4124     12  AM-AH-ONLY-INDICATOR              PIC X.
  4125         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4126         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4127
  4128     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4129
  4130     12  AM-OVER-SHORT.
  4131         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4132         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4133
  4134     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4135     12  AM-DCC-CLP-STATE                  PIC XX.
  4136
  4137     12  AM-RECALC-COMM                    PIC X.
  4138     12  AM-RECALC-REIN                    PIC X.
  4139
  4140     12  AM-REI-TABLE                      PIC XXX.
  4141     12  AM-REI-ET-LF                      PIC X.
  4142     12  AM-REI-ET-AH                      PIC X.
  4143     12  AM-REI-PE-LF                      PIC X.
  4144     12  AM-REI-PE-AH                      PIC X.
  4145     12  AM-REI-PRT-ST                     PIC X.
  4146     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4147     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4148     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4149     12  AM-REI-GROUP-A                    PIC X(6).
  4150     12  AM-REI-MORT                       PIC X(4).
  4151     12  AM-REI-PRT-OW                     PIC X.
  4152     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4153     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4154     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4155     12  AM-REI-GROUP-B                    PIC X(6).
  4156
  4157     12  AM-TRUST-TYPE                     PIC X(2).
  4158
  4159     12  AM-EMPLOYER-STMT-USED             PIC X.
  4160     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4161
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  82
* EL689.cbl
  4162     12  AM-STD-AH-TYPE                    PIC XX.
  4163     12  AM-EARN-METHODS.
  4164         16  AM-EARN-METHOD-R              PIC X.
  4165             88 AM-REF-RL-R78                 VALUE 'R'.
  4166             88 AM-REF-RL-PR                  VALUE 'P'.
  4167             88 AM-REF-RL-MEAN                VALUE 'M'.
  4168             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4169         16  AM-EARN-METHOD-L              PIC X.
  4170             88 AM-REF-LL-R78                 VALUE 'R'.
  4171             88 AM-REF-LL-PR                  VALUE 'P'.
  4172             88 AM-REF-LL-MEAN                VALUE 'M'.
  4173             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4174         16  AM-EARN-METHOD-A              PIC X.
  4175             88 AM-REF-AH-R78                 VALUE 'R'.
  4176             88 AM-REF-AH-PR                  VALUE 'P'.
  4177             88 AM-REF-AH-MEAN                VALUE 'M'.
  4178             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4179             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4180             88 AM-REF-AH-NET                 VALUE 'N'.
  4181
  4182     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4183     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4184     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4185
  4186     12  AM-RET-Y-N                        PIC X.
  4187     12  AM-RET-P-E                        PIC X.
  4188     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4189     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4190     12  AM-RET-GRP                        PIC X(6).
  4191     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4192         16  AM-POOL-PRIME                 PIC XXX.
  4193         16  AM-POOL-SUB                   PIC XXX.
  4194     12  AM-RETRO-EARNINGS.
  4195         16  AM-RET-EARN-R                 PIC X.
  4196         16  AM-RET-EARN-L                 PIC X.
  4197         16  AM-RET-EARN-A                 PIC X.
  4198     12  AM-RET-ST-TAX-USE                 PIC X.
  4199         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4200         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4201     12  AM-RETRO-BEG-EARNINGS.
  4202         16  AM-RET-BEG-EARN-R             PIC X.
  4203         16  AM-RET-BEG-EARN-L             PIC X.
  4204         16  AM-RET-BEG-EARN-A             PIC X.
  4205     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4206     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4207
  4208     12  AM-USER-SELECT-OPTIONS.
  4209         16  AM-USER-SELECT-1              PIC X(10).
  4210         16  AM-USER-SELECT-2              PIC X(10).
  4211         16  AM-USER-SELECT-3              PIC X(10).
  4212         16  AM-USER-SELECT-4              PIC X(10).
  4213         16  AM-USER-SELECT-5              PIC X(10).
  4214
  4215     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4216
  4217     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4218
  4219     12  AM-RPT045A-SWITCH                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  83
* EL689.cbl
  4220         88  RPT045A-OFF                   VALUE 'N'.
  4221
  4222     12  AM-INSURANCE-LIMITS.
  4223         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4224         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4225
  4226     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4227         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4228
  4229     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4230         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4231         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4232
  4233     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4234
  4235     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4236     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4237     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4238     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4239     12  AM-DCC-UEF-STATE                  PIC XX.
  4240     12  FILLER                            PIC XXX.
  4241     12  AM-REPORT-CODE-3                  PIC X(10).
  4242*    12  FILLER                            PIC X(22).
  4243
  4244     12  AM-RESERVE-DATE.
  4245         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4246         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4247         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4248
  4249     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4250     12  AM-NOTIFICATION-TYPES.
  4251         16  AM-NOTIF-OF-LETTERS           PIC X.
  4252         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4253         16  AM-NOTIF-OF-REPORTS           PIC X.
  4254         16  AM-NOTIF-OF-STATUS            PIC X.
  4255
  4256     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4257         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4258         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4259         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4260         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4261
  4262     12  AM-BENEFIT-CONTROLS.
  4263         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4264             20  AM-BENEFIT-CODE           PIC XX.
  4265             20  AM-BENEFIT-TYPE           PIC X.
  4266             20  AM-BENEFIT-REVISION       PIC XXX.
  4267             20  AM-BENEFIT-REM-TERM       PIC X.
  4268             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4269             20  FILLER                    PIC XX.
  4270         16  FILLER                        PIC X(80).
  4271
  4272     12  AM-TRANSFER-DATA.
  4273         16  AM-TRANSFERRED-FROM.
  4274             20  AM-TRNFROM-CARRIER        PIC X.
  4275             20  AM-TRNFROM-GROUPING.
  4276                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4277                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  84
* EL689.cbl
  4278             20  AM-TRNFROM-STATE          PIC XX.
  4279             20  AM-TRNFROM-ACCOUNT.
  4280                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4281                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4282             20  AM-TRNFROM-DTE            PIC XX.
  4283         16  AM-TRANSFERRED-TO.
  4284             20  AM-TRNTO-CARRIER          PIC X.
  4285             20  AM-TRNTO-GROUPING.
  4286                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4287                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4288             20  AM-TRNTO-STATE            PIC XX.
  4289             20  AM-TRNTO-ACCOUNT.
  4290                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4291                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4292             20  AM-TRNTO-DTE              PIC XX.
  4293         16  FILLER                        PIC X(10).
  4294
  4295     12  AM-SAVED-REMIT-TO                 PIC 99.
  4296
  4297     12  AM-COMM-STRUCTURE-SAVED.
  4298         16  AM-DEFN-1-SAVED.
  4299             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4300                 24  AM-AGT-SV             PIC X(10).
  4301                 24  AM-COM-TYP-SV         PIC X.
  4302                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4303                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4304                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4305                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4306                 24  FILLER                PIC X.
  4307                 24  AM-GL-CODES-SV        PIC X.
  4308                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4309                 24  FILLER                PIC X.
  4310         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4311             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4312                 24  FILLER                PIC X(11).
  4313                 24  AM-L-COMA-SV          PIC XXX.
  4314                 24  AM-J-COMA-SV          PIC XXX.
  4315                 24  AM-A-COMA-SV          PIC XXX.
  4316                 24  FILLER                PIC X(6).
  4317
  4318     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4319         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4320            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4321            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4322            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4323
  4324     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4325     12  FILLER                            PIC X(120).
  4326
  4327     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4328         16  AM-CONTROL-NAME               PIC X(30).
  4329         16  AM-EXECUTIVE-ONE.
  4330             20  AM-EXEC1-NAME             PIC X(15).
  4331             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4332                                                          COMP-3.
  4333             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4334                                                          COMP-3.
  4335         16  AM-EXECUTIVE-TWO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  85
* EL689.cbl
  4336             20  AM-EXEC2-NAME             PIC X(15).
  4337             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4338                                                          COMP-3.
  4339             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4340                                                          COMP-3.
  4341
  4342     12  AM-RETRO-ADDITIONAL-DATA.
  4343         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4344         16  AM-RETRO-PREM-P-E             PIC X.
  4345         16  AM-RETRO-CLMS-P-I             PIC X.
  4346         16  AM-RETRO-RET-BRACKET-LF.
  4347             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4348                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4349                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4350             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4351                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4352                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4353             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4354                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4355                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4356         16  AM-RETRO-RET-BRACKET-AH.
  4357             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4358                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4359                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4360                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4361             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4362                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4363                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4364             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4365                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4366                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4367
  4368     12  AM-COMMENTS.
  4369         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4370
  4371     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4372         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4373         16  AM-FLI-BILLING-CODE           PIC X.
  4374         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4375         16  AM-FLI-UNITED-IDENT           PIC X.
  4376         16  AM-FLI-INTEREST-LOST-DATA.
  4377             20  AM-FLI-BANK-NO            PIC X(5).
  4378             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4379             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4380             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4381         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4382             20  AM-FLI-AGT                PIC X(9).
  4383             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4384             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4385         16  FILLER                        PIC X(102).
  4386
  4387     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4388         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4389             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4390             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4391             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4392             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4393             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  86
* EL689.cbl
  4394         16  FILLER                          PIC X(10).
  4395******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  87
* EL689.cbl
  4397*    COPY ERCARCH.
  4398******************************************************************
  4399*                                                                *
  4400*                            ERCARCH.                            *
  4401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4402*                            VMOD=2.002                          *
  4403*                                                                *
  4404*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4405*                                                                *
  4406*   FILE TYPE = VSAM,KSDS                                        *
  4407*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4408*                                                                *
  4409*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4410*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4411*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4412*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4413*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4414*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4415*                                                                *
  4416*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4417******************************************************************
  4418*                   C H A N G E   L O G
  4419*
  4420* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4421*-----------------------------------------------------------------
  4422*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4423* EFFECTIVE    NUMBER
  4424*-----------------------------------------------------------------
  4425* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4426* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4427* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4428******************************************************************
  4429 01  LETTER-ARCHIVE.
  4430     12  LA-RECORD-ID                PIC  X(02).
  4431         88  LA-VALID-ID                VALUE 'LA'.
  4432
  4433     12  LA-CONTROL-PRIMARY.
  4434         16  LA-COMPANY-CD           PIC  X(01).
  4435         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4436
  4437     12  LA-CONTROL-BY-CERT-RESP.
  4438         16  LA-COMPANY-CD-A2        PIC  X(01).
  4439         16  LA-CERT-NO-A2.
  4440             20  LA-CERT-PRIME-A2    PIC  X(10).
  4441             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4442         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4443             20  LA-RESP-PERSON-A2   PIC  X(10).
  4444             20  LA-TYPE-A2          PIC  X(01).
  4445         16  LA-CARRIER-A2           PIC  X(01).
  4446         16  LA-GROUPING-A2          PIC  X(06).
  4447         16  LA-STATE-A2             PIC  X(02).
  4448         16  LA-ACCOUNT-A2           PIC  X(10).
  4449         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4450         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4451
  4452     12  LA-CONTROL-BY-FORM.
  4453         16  LA-COMPANY-CD-A3        PIC  X(01).
  4454         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  88
* EL689.cbl
  4455         16  LA-CARRIER-A3           PIC  X(01).
  4456         16  LA-GROUPING-A3          PIC  X(06).
  4457         16  LA-STATE-A3             PIC  X(02).
  4458         16  LA-ACCOUNT-A3           PIC  X(10).
  4459         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4460
  4461     12  LA-CONTROL-BY-PROCESSOR.
  4462         16  LA-COMPANY-CD-A4        PIC  X(01).
  4463         16  LA-PROCESSOR-CD         PIC  X(04).
  4464         16  LA-CARRIER-A4           PIC  X(01).
  4465         16  LA-GROUPING-A4          PIC  X(06).
  4466         16  LA-STATE-A4             PIC  X(02).
  4467         16  LA-ACCOUNT-A4           PIC  X(10).
  4468         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4469
  4470     12  LA-CONTROL-BY-KEY-FIELDS.
  4471         16  LA-COMPANY-CD-A5        PIC  X(01).
  4472         16  LA-CARRIER-A5           PIC  X(01).
  4473         16  LA-GROUPING-A5          PIC  X(06).
  4474         16  LA-STATE-A5             PIC  X(02).
  4475         16  LA-ACCOUNT-A5           PIC  X(10).
  4476         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4477
  4478     12  LA-CONTROL-BY-GROUP-CODE.
  4479         16  LA-COMPANY-CD-A6        PIC  X(01).
  4480         16  LA-ENTRY-A6.
  4481             20  LA-FILLER           PIC  X(02).
  4482             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4483         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4484
  4485     12  FILLER                      PIC  X(09).
  4486
  4487     12  LA-HEADER-RECORD.
  4488         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4489         16  LA-CREATION-DATE        PIC  X(02).
  4490         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4491         16  LA-FINAL-ACT-DATE       REDEFINES
  4492               LA-FOLLOW-UP-DATE     PIC  X(02).
  4493         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4494         16  LA-NO-OF-COPIES         PIC S9(01).
  4495         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4496         16  LA-REPLY-DATE           PIC  X(02).
  4497         16  LA-RESEND-DATES.
  4498             20  LA-RESEND-DATE      PIC  X(02).
  4499             20  LA-SENT-DATE        PIC  X(02).
  4500             20  FILLER              PIC  X(08).
  4501         16  LA-SOURCE-INFORMATION.
  4502             20  LA-DATA-SOURCE      PIC  X(01).
  4503             20  LA-ADDR-SOURCE      PIC  X(01).
  4504         16  LA-STATUS               PIC  X(01).
  4505             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4506             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4507             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4508             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4509             88  LA-STATUS-PURGED         VALUE 'P'.
  4510             88  LA-STATUS-VOIDED         VALUE 'V'.
  4511         16  LA-LAST-RESENT-PRINT-DATE
  4512                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  89
* EL689.cbl
  4513         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4514             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4515                                          VALUE 'C'.
  4516             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4517                                          VALUE 'F'.
  4518             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4519                                          VALUE 'P'.
  4520         16  LA-PURGED-DATE          PIC  X(02).
  4521         16  LA-VOIDED-DATE          PIC  X(02).
  4522         16  LA-RESEND-LETR          PIC  X(4).
  4523         16  FILLER                  PIC  X(08).
  4524*        16  LA-RESEND-LETR-2        PIC  X(4).
  4525*        16  LA-RESEND-LETR-3        PIC  X(4).
  4526*        16  FILLER                  PIC  X(59).
  4527         16  LA-ARCHIVE-STATUS       PIC  X.
  4528             88  LA-TEMP                VALUE 'T'.
  4529             88  LA-QWS                 VALUE 'Q'.
  4530             88  LA-BATCH               VALUE 'B'.
  4531         16  LA-FINAL-ACT-IND        PIC  X(1).
  4532         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4533         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4534         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4535                                     PIC X(4).
  4536         16  FILLER                  PIC  X(42).
  4537*        16  FILLER                  PIC  X(71).
  4538         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4539         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4540         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4541                                     PIC  X(4).
  4542         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4543
  4544******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  90
* EL689.cbl
  4546*    COPY ERCARCT.
  4547******************************************************************
  4548*                                                                *
  4549*                            ERCARCT.                            *
  4550*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4551*                            VMOD=2.002                          *
  4552*                                                                *
  4553*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4554*                                                                *
  4555*   FILE TYPE = VSAM,KSDS                                        *
  4556*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4557*                                                                *
  4558*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4559*                                                                *
  4560*   LOG = NO                                                     *
  4561*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4562******************************************************************
  4563*                   C H A N G E   L O G
  4564*
  4565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4566*-----------------------------------------------------------------
  4567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4568* EFFECTIVE    NUMBER
  4569*-----------------------------------------------------------------
  4570* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4571******************************************************************
  4572 01  LETTER-ARCHIVE-TEXT.
  4573     12  LT-RECORD-ID                PIC  X(02).
  4574         88  LT-VALID-ID                VALUE 'LT'.
  4575
  4576     12  LT-CONTROL-PRIMARY.
  4577         16  LT-COMPANY-CD           PIC  X(01).
  4578         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4579         16  LT-RECORD-TYPE          PIC  X(01).
  4580             88  LT-ADDRESS-DATA        VALUE '1'.
  4581             88  LT-TEXT-DATA           VALUE '2'.
  4582             88  LT-COMMENT-DATA        VALUE '3'.
  4583         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4584
  4585     12  FILLER                      PIC  X(28).
  4586     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4587
  4588     12  LT-TEXT-RECORD.
  4589         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4590                            INDEXED BY LT-NDX.
  4591             20  LT-TEXT-LINE        PIC  X(70).
  4592             20  LT-SKIP-CONTROL     PIC  X(02).
  4593                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4594                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4595             20  FILLER              PIC  X(08).
  4596
  4597     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4598         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4599             20  LT-COMMENT-LINE     PIC X(69).
  4600             20  LT-COMMENT-CHG-DT   PIC X(02).
  4601             20  LT-COMMENT-CHG-BY   PIC X(04).
  4602             20  FILLER              PIC X(05).
  4603
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  91
* EL689.cbl
  4605*    COPY ELCCERT.
  4606******************************************************************
  4607*                                                                *
  4608*                            ELCCERT.                            *
  4609*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4610*                            VMOD=2.013                          *
  4611*                                                                *
  4612*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4613*                                                                *
  4614*   FILE TYPE = VSAM,KSDS                                        *
  4615*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4616*                                                                *
  4617*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4618*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4619*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4620*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4621*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4622*                                                                *
  4623*   LOG = YES                                                    *
  4624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4625******************************************************************
  4626*                   C H A N G E   L O G
  4627*
  4628* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4629*-----------------------------------------------------------------
  4630*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4631* EFFECTIVE    NUMBER
  4632*-----------------------------------------------------------------
  4633* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4634* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4635* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4636* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4637* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4638* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4639* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4640* 032612  CR2011110200001  PEMA  AHL CHANGES
  4641******************************************************************
  4642
  4643 01  CERTIFICATE-MASTER.
  4644     12  CM-RECORD-ID                      PIC XX.
  4645         88  VALID-CM-ID                      VALUE 'CM'.
  4646
  4647     12  CM-CONTROL-PRIMARY.
  4648         16  CM-COMPANY-CD                 PIC X.
  4649         16  CM-CARRIER                    PIC X.
  4650         16  CM-GROUPING.
  4651             20  CM-GROUPING-PREFIX        PIC X(3).
  4652             20  CM-GROUPING-PRIME         PIC X(3).
  4653         16  CM-STATE                      PIC XX.
  4654         16  CM-ACCOUNT.
  4655             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4656             20  CM-ACCOUNT-PRIME          PIC X(6).
  4657         16  CM-CERT-EFF-DT                PIC XX.
  4658         16  CM-CERT-NO.
  4659             20  CM-CERT-PRIME             PIC X(10).
  4660             20  CM-CERT-SFX               PIC X.
  4661
  4662     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  92
* EL689.cbl
  4663         16  CM-COMPANY-CD-A1              PIC X.
  4664         16  CM-INSURED-LAST-NAME          PIC X(15).
  4665         16  CM-INSURED-INITIALS.
  4666             20  CM-INSURED-INITIAL1       PIC X.
  4667             20  CM-INSURED-INITIAL2       PIC X.
  4668
  4669     12  CM-CONTROL-BY-SSN.
  4670         16  CM-COMPANY-CD-A2              PIC X.
  4671         16  CM-SOC-SEC-NO.
  4672             20  CM-SSN-STATE              PIC XX.
  4673             20  CM-SSN-ACCOUNT            PIC X(6).
  4674             20  CM-SSN-LN3.
  4675                 25  CM-INSURED-INITIALS-A2.
  4676                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4677                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4678                 25 CM-PART-LAST-NAME-A2         PIC X.
  4679
  4680     12  CM-CONTROL-BY-CERT-NO.
  4681         16  CM-COMPANY-CD-A4              PIC X.
  4682         16  CM-CERT-NO-A4                 PIC X(11).
  4683
  4684     12  CM-CONTROL-BY-MEMB.
  4685         16  CM-COMPANY-CD-A5              PIC X.
  4686         16  CM-MEMBER-NO.
  4687             20  CM-MEMB-STATE             PIC XX.
  4688             20  CM-MEMB-ACCOUNT           PIC X(6).
  4689             20  CM-MEMB-LN4.
  4690                 25  CM-INSURED-INITIALS-A5.
  4691                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4692                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4693                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4694
  4695     12  CM-INSURED-PROFILE-DATA.
  4696         16  CM-INSURED-FIRST-NAME.
  4697             20  CM-INSURED-1ST-INIT       PIC X.
  4698             20  FILLER                    PIC X(9).
  4699         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4700         16  CM-INSURED-SEX                PIC X.
  4701             88  CM-SEX-MALE                  VALUE 'M'.
  4702             88  CM-SEX-FEMAL                 VALUE 'F'.
  4703         16  CM-INSURED-JOINT-AGE          PIC 99.
  4704         16  CM-JOINT-INSURED-NAME.
  4705             20  CM-JT-LAST-NAME           PIC X(15).
  4706             20  CM-JT-FIRST-NAME.
  4707                 24  CM-JT-1ST-INIT        PIC X.
  4708                 24  FILLER                PIC X(9).
  4709             20  CM-JT-INITIAL             PIC X.
  4710
  4711     12  CM-LIFE-DATA.
  4712         16  CM-LF-BENEFIT-CD              PIC XX.
  4713         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4714         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4715         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4716         16  CM-LF-DEV-CODE                PIC XXX.
  4717         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4718         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4719         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4720         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  93
* EL689.cbl
  4721         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4722         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4723         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4724         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4725         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4726         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4727         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4728         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4729         16  FILLER                        PIC XX.
  4730
  4731     12  CM-AH-DATA.
  4732         16  CM-AH-BENEFIT-CD              PIC XX.
  4733         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4734         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4735         16  CM-AH-DEV-CODE                PIC XXX.
  4736         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4737         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4738         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4739         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4740         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4741         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4742         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4743         16  CM-AH-PAID-THRU-DT            PIC XX.
  4744             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4745         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4746         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4747         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4748         16  FILLER                        PIC X.
  4749
  4750     12  CM-LOAN-INFORMATION.
  4751         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4752         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4753                                           PIC S9(5)V99  COMP-3.
  4754         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4755         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4756         16  CM-PAY-FREQUENCY              PIC S99.
  4757         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4758         16  CM-RATE-CLASS                 PIC XX.
  4759         16  CM-BENEFICIARY                PIC X(25).
  4760         16  CM-POLICY-FORM-NO             PIC X(12).
  4761         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4762         16  CM-LAST-ADD-ON-DT             PIC XX.
  4763         16  CM-DEDUCTIBLE-AMOUNTS.
  4764             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4765             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4766         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4767             20  CM-RESIDENT-STATE         PIC XX.
  4768             20  CM-RATE-CODE              PIC X(4).
  4769             20  FILLER                    PIC XX.
  4770         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4771             20  CM-LOAN-OFFICER           PIC X(5).
  4772             20  FILLER                    PIC XXX.
  4773         16  CM-CSR-CODE                   PIC XXX.
  4774         16  CM-UNDERWRITING-CODE          PIC X.
  4775             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4776         16  CM-POST-CARD-IND              PIC X.
  4777         16  CM-NH-INTERFACE-SW            PIC X.
  4778         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  94
* EL689.cbl
  4779             88  CM-SING-PRM                  VALUE '1'.
  4780             88  CM-O-B-COVERAGE              VALUE '2'.
  4781             88  CM-OPEN-END                  VALUE '3'.
  4782         16  CM-IND-GRP-TYPE               PIC X.
  4783             88  CM-INDIVIDUAL                VALUE 'I'.
  4784             88  CM-GROUP                     VALUE 'G'.
  4785         16  CM-SKIP-CODE                  PIC X.
  4786             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4787             88  SKIP-JULY                    VALUE '1'.
  4788             88  SKIP-AUGUST                  VALUE '2'.
  4789             88  SKIP-SEPTEMBER               VALUE '3'.
  4790             88  SKIP-JULY-AUG                VALUE '4'.
  4791             88  SKIP-AUG-SEPT                VALUE '5'.
  4792             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4793             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4794             88  SKIP-JUNE                    VALUE '8'.
  4795             88  SKIP-JUNE-JULY               VALUE '9'.
  4796             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4797             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4798         16  CM-PAYMENT-MODE               PIC X.
  4799             88  PAY-MONTHLY                  VALUE SPACE.
  4800             88  PAY-WEEKLY                   VALUE '1'.
  4801             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4802             88  PAY-BI-WEEKLY                VALUE '3'.
  4803             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4804         16  CM-LOAN-NUMBER                PIC X(8).
  4805         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4806         16  CM-OLD-LOF                    PIC XXX.
  4807*        16  CM-LOAN-OFFICER               PIC XXX.
  4808         16  CM-REIN-TABLE                 PIC XXX.
  4809         16  CM-SPECIAL-REIN-CODE          PIC X.
  4810         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4811         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4812         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4813
  4814     12  CM-STATUS-DATA.
  4815         16  CM-ENTRY-STATUS               PIC X.
  4816         16  CM-ENTRY-DT                   PIC XX.
  4817
  4818         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4819         16  CM-LF-CANCEL-DT               PIC XX.
  4820         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4821
  4822         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4823         16  CM-LF-DEATH-DT                PIC XX.
  4824         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4825
  4826         16  CM-LF-CURRENT-STATUS          PIC X.
  4827             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4828                                                'M' '4' '5' '9'.
  4829             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4830             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4831             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4832             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4833             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4834             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4835             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4836             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  95
* EL689.cbl
  4837             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4838             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4839             88  CM-LF-DECLINED               VALUE 'D'.
  4840             88  CM-LF-VOIDED                 VALUE 'V'.
  4841
  4842         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4843         16  CM-AH-CANCEL-DT               PIC XX.
  4844         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4845
  4846         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4847         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4848         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4849
  4850         16  CM-AH-CURRENT-STATUS          PIC X.
  4851             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4852                                                'M' '4' '5' '9'.
  4853             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4854             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4855             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4856             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4857             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4858             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4859             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4860             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4861             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4862             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4863             88  CM-AH-DECLINED               VALUE 'D'.
  4864             88  CM-AH-VOIDED                 VALUE 'V'.
  4865
  4866         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4867             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4868             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4869             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4870         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4871
  4872         16  CM-ENTRY-BATCH                PIC X(6).
  4873         16  CM-LF-EXIT-BATCH              PIC X(6).
  4874         16  CM-AH-EXIT-BATCH              PIC X(6).
  4875         16  CM-LAST-MONTH-END             PIC XX.
  4876
  4877     12  CM-NOTE-SW                        PIC X.
  4878         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4879         88  CERT-NOTES-PRESENT               VALUE '1'.
  4880         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4881         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4882         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4883         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4884         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4885         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4886     12  CM-COMP-EXCP-SW                   PIC X.
  4887         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4888         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4889     12  CM-INSURED-ADDRESS-SW             PIC X.
  4890         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4891         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4892
  4893*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4894     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  96
* EL689.cbl
  4895     12  FILLER                            PIC X.
  4896
  4897*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4898     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4899     12  FILLER                            PIC X.
  4900*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4901     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4902
  4903     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4904         88  CERT-ADDED-BATCH                 VALUE ' '.
  4905         88  CERT-ADDED-ONLINE                VALUE '1'.
  4906         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4907         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4908         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4909     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4910         88  CERT-AS-LOADED                   VALUE ' '.
  4911         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4912         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4913         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4914         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4915         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4916         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4917         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4918
  4919     12  CM-ACCOUNT-COMM-PCTS.
  4920         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4921         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4922
  4923     12  CM-USER-FIELD                     PIC X.
  4924     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4925     12  CM-CLP-STATE                      PIC XX.
  4926     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4927     12  CM-USER-RESERVED                  PIC XXX.
  4928     12  FILLER REDEFINES CM-USER-RESERVED.
  4929         16  CM-AH-CLASS-CD                PIC XX.
  4930         16  F                             PIC X.
  4931******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  97
* EL689.cbl
  4933*    COPY ERCCHEK.
  4934******************************************************************
  4935*                                                                *
  4936*                                                                *
  4937*                            ERCCHEK                             *
  4938*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4939*                            VMOD=2.008                          *
  4940*                                                                *
  4941*   FILE DESCRIPTION = CHECK RECORDS                             *
  4942*                                                                *
  4943*   FILE TYPE = VSAM,KSDS                                        *
  4944*   RECORD SIZE = 600    RECFORM = FIXED                         *
  4945*                                                                *
  4946*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  4947*       ALTERNATE INDEX = NONE                                   *
  4948*                                                                *
  4949*   LOG = YES                                                    *
  4950*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4951******************************************************************
  4952 01  CHECK-RECORDS.
  4953     12  CH-RECORD-ID                      PIC XX.
  4954         88  VALID-CH-ID                      VALUE 'CH'.
  4955
  4956     12  CH-CONTROL-PRIMARY.
  4957         16  CH-COMPANY-CD                 PIC X.
  4958         16  CH-CARRIER                    PIC X.
  4959         16  CH-GROUPING                   PIC X(6).
  4960         16  CH-STATE                      PIC XX.
  4961         16  CH-ACCOUNT                    PIC X(10).
  4962         16  CH-CERT-EFF-DT                PIC XX.
  4963         16  CH-CERT-NO.
  4964             20  CH-CERT-PRIME             PIC X(10).
  4965             20  CH-CERT-SFX               PIC X.
  4966         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  4967
  4968     12  CH-RECORDED-DT                    PIC XX.
  4969     12  CH-RECORDED-BY                    PIC X(4).
  4970     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  4971
  4972     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  4973     12  CH-CHECK-NO                       PIC X(7).
  4974     12  CH-REASON-FOR-CHECK               PIC X(25).
  4975     12  CH-CHECK-WRITTEN-DT               PIC XX.
  4976     12  CH-OFFLINE-CHECK-IND              PIC X.
  4977         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  4978
  4979     12  CH-PAYEE-INFO.
  4980         16  CH-PAYEE-NAME-1               PIC X(30).
  4981         16  CH-PAYEE-NAME-2               PIC X(30).
  4982         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  4983         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  4984         16  CH-PAYEE-CITY-ST              PIC X(30).
  4985         16  CH-PAYEE-ZIP-CODE.
  4986             20  CH-PAYEE-ZIP.
  4987                 24  CH-ZIP-PRI-1ST        PIC X.
  4988                     88  CH-CANADIAN-POST-CODE
  4989                                           VALUES 'A' THRU 'Z'.
  4990                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  98
* EL689.cbl
  4991             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  4992         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  4993             20  CH-CAN-POSTAL-1           PIC XXX.
  4994             20  CH-CAN-POSTAL-2           PIC XXX.
  4995             20  FILLER                    PIC XXX.
  4996
  4997     12  CH-CHECK-STUB-TEXT.
  4998         16  CH-STUB-LINE-1                PIC X(50).
  4999         16  CH-STUB-LINE-2                PIC X(50).
  5000         16  CH-STUB-LINE-3                PIC X(50).
  5001         16  FILLER.
  5002           18  CH-STUB-LINE-4              PIC X(20).
  5003           18  CH-LIENHOLDER-NAME          PIC X(30).
  5004
  5005     12  CH-COMPENSATION-CONTROL.
  5006         16  CH-COMP-CARRIER               PIC X.
  5007         16  CH-COMP-GROUPING              PIC X(6).
  5008         16  CH-COMP-FIN-RESP              PIC X(10).
  5009         16  CH-COMP-ACCOUNT               PIC X(10).
  5010
  5011     12  CH-CREDIT-SELECT-DT               PIC XX.
  5012     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5013     12  CH-PAYEE-CODE                     PIC X(6).
  5014
  5015     12  CH-VOID-DATA.
  5016         20  CH-VOID-DT                    PIC XX.
  5017         20  CH-VOID-BY                    PIC X(4).
  5018         20  CH-VOID-REASON                PIC X(25).
  5019
  5020     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5021             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5022     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5023
  5024     12  CH-CHECK-REFERENCE                PIC X(12).
  5025     12  CH-CHECK-ORIGIN-SW                PIC X.
  5026             88  CH-REFUND-CHECK              VALUE 'R'.
  5027             88  CH-MAINT-CHECK               VALUE 'M'.
  5028
  5029     12  CH-CANC-DT                        PIC XX.
  5030     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5031     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5032
  5033     12  CH-INSURED-NAME                   PIC X(28).
  5034
  5035     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  5036     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  5037
  5038     12  CH-LETTER-TABLE.
  5039         16  CH-LETTERS OCCURS 3 TIMES
  5040                        INDEXED BY CH-LT-NDX
  5041                                           PIC X(04).
  5042
  5043     12  FILLER                            PIC X(07).
  5044
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  99
* EL689.cbl
  5046*    COPY ELCCNTL.
  5047******************************************************************
  5048*                                                                *
  5049*                                                                *
  5050*                            ELCCNTL.                            *
  5051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5052*                            VMOD=2.059                          *
  5053*                                                                *
  5054*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5055*                                                                *
  5056*   FILE TYPE = VSAM,KSDS                                        *
  5057*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5058*                                                                *
  5059*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5060*       ALTERNATE INDEX = NONE                                   *
  5061*                                                                *
  5062*   LOG = YES                                                    *
  5063*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5064******************************************************************
  5065*                   C H A N G E   L O G
  5066*
  5067* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5068*-----------------------------------------------------------------
  5069*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5070* EFFECTIVE    NUMBER
  5071*-----------------------------------------------------------------
  5072* 082503                   PEMA  ADD BENEFIT GROUP
  5073* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5074* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5075* 092705    2005050300006  PEMA  ADD SPP LEASES
  5076* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5077* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5078* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5079* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5080* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5081* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5082******************************************************************
  5083*
  5084 01  CONTROL-FILE.
  5085     12  CF-RECORD-ID                       PIC XX.
  5086         88  VALID-CF-ID                        VALUE 'CF'.
  5087
  5088     12  CF-CONTROL-PRIMARY.
  5089         16  CF-COMPANY-ID                  PIC XXX.
  5090         16  CF-RECORD-TYPE                 PIC X.
  5091             88  CF-COMPANY-MASTER              VALUE '1'.
  5092             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5093             88  CF-STATE-MASTER                VALUE '3'.
  5094             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5095             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5096             88  CF-CARRIER-MASTER              VALUE '6'.
  5097             88  CF-MORTALITY-MASTER            VALUE '7'.
  5098             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5099             88  CF-TERMINAL-MASTER             VALUE '9'.
  5100             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5101             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5102             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5103             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 100
* EL689.cbl
  5104             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5105             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5106             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5107             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5108             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5109         16  CF-ACCESS-CD-GENL              PIC X(4).
  5110         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5111             20  CF-PROCESSOR               PIC X(4).
  5112         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5113             20  CF-STATE-CODE              PIC XX.
  5114             20  FILLER                     PIC XX.
  5115         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5116             20  FILLER                     PIC XX.
  5117             20  CF-HI-BEN-IN-REC           PIC XX.
  5118         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5119             20  FILLER                     PIC XXX.
  5120             20  CF-CARRIER-CNTL            PIC X.
  5121         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5122             20  FILLER                     PIC XX.
  5123             20  CF-HI-TYPE-IN-REC          PIC 99.
  5124         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5125             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5126                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5127             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5128             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5129         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5130             20  FILLER                     PIC X.
  5131             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5132         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5133             20  FILLER                     PIC XX.
  5134             20  CF-MORTGAGE-PLAN           PIC XX.
  5135         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5136
  5137     12  CF-LAST-MAINT-DT                   PIC XX.
  5138     12  CF-LAST-MAINT-BY                   PIC X(4).
  5139     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5140
  5141     12  CF-RECORD-BODY                     PIC X(728).
  5142
  5143
  5144****************************************************************
  5145*             COMPANY MASTER RECORD                            *
  5146****************************************************************
  5147
  5148     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5149         16  CF-COMPANY-ADDRESS.
  5150             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5151             20  CF-CL-IN-CARE-OF           PIC X(30).
  5152             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5153             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5154             20  CF-CL-CITY-STATE           PIC X(30).
  5155             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5156             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5157         16  CF-COMPANY-CD                  PIC X.
  5158         16  CF-COMPANY-PASSWORD            PIC X(8).
  5159         16  CF-SECURITY-OPTION             PIC X.
  5160             88  ALL-SECURITY                   VALUE '1'.
  5161             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 101
* EL689.cbl
  5162             88  PROCESSOR-VERIFY               VALUE '3'.
  5163             88  NO-SECURITY                    VALUE '4'.
  5164             88  ALL-BUT-TERM                   VALUE '5'.
  5165         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5166             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5167         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5168             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5169         16  CF-INFORCE-LOCATION            PIC X.
  5170             88  CERTS-ARE-ONLINE               VALUE '1'.
  5171             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5172             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5173         16  CF-LOWER-CASE-LETTERS          PIC X.
  5174         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5175             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5176             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5177             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5178             88  CF-ACCNT-CNTL                  VALUE '3'.
  5179             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5180
  5181         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5182         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5183
  5184         16  CF-LGX-CREDIT-USER             PIC X.
  5185             88  CO-IS-NOT-USER                 VALUE 'N'.
  5186             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5187
  5188         16 CF-CREDIT-CALC-CODES.
  5189             20  CF-CR-REM-TERM-CALC PIC X.
  5190               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5191               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5192               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5193               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5194               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5195               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5196               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5197             20  CF-CR-R78-METHOD           PIC X.
  5198               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5199               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5200
  5201         16  CF-CLAIM-CONTROL-COUNTS.
  5202             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5203                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5204
  5205             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5206                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5207
  5208             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5209                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5210
  5211             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5212                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5213
  5214         16  CF-CURRENT-MONTH-END           PIC XX.
  5215
  5216         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5217             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5218             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5219             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 102
* EL689.cbl
  5220             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5221                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5222                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5223             20  CF-CO-PREM-REJECT-SW       PIC X.
  5224                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5225                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5226             20  CF-CO-REF-REJECT-SW        PIC X.
  5227                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5228                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5229
  5230         16  CF-CO-REPORTING-DT             PIC XX.
  5231         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5232         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5233           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5234           88  CF-CO-MONTH-END                  VALUE '1'.
  5235
  5236         16  CF-LGX-CLAIM-USER              PIC X.
  5237             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5238             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5239
  5240         16  CF-CREDIT-EDIT-CONTROLS.
  5241             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5242             20  CF-MIN-AGE                 PIC 99.
  5243             20  CF-DEFAULT-AGE             PIC 99.
  5244             20  CF-MIN-TERM                PIC S999      COMP-3.
  5245             20  CF-MAX-TERM                PIC S999      COMP-3.
  5246             20  CF-DEFAULT-SEX             PIC X.
  5247             20  CF-JOINT-AGE-INPUT         PIC X.
  5248                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5249             20  CF-BIRTH-DATE-INPUT        PIC X.
  5250                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5251             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5252                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5253                 88  CF-ZERO-CARRIER            VALUE '1'.
  5254                 88  CF-ZERO-GROUPING           VALUE '2'.
  5255                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5256             20  CF-EDIT-SW                 PIC X.
  5257                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5258             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5259             20  CF-CR-PR-METHOD            PIC X.
  5260               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5261               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5262             20  FILLER                     PIC X.
  5263
  5264         16  CF-CREDIT-MISC-CONTROLS.
  5265             20  CF-REIN-TABLE-SW           PIC X.
  5266                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5267             20  CF-COMP-TABLE-SW           PIC X.
  5268                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5269             20  CF-EXPERIENCE-RETENTION-AGE
  5270                                            PIC S9        COMP-3.
  5271             20  CF-CONVERSION-DT           PIC XX.
  5272             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5273             20  CF-RUN-FREQUENCY-SW        PIC X.
  5274                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5275                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5276
  5277             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 103
* EL689.cbl
  5278                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5279                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5280                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5281                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5282                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5283                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5284
  5285                 24  CF-CR-CHECK-COUNT       REDEFINES
  5286                     CF-CR-CHECK-COUNTER      PIC X(4).
  5287
  5288                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5289                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5290
  5291                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5292                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5293                 24  CF-MAIL-PROCESSING       PIC X.
  5294                     88  MAIL-PROCESSING          VALUE 'Y'.
  5295
  5296         16  CF-MISC-SYSTEM-CONTROL.
  5297             20  CF-SYSTEM-C                 PIC X.
  5298                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5299             20  CF-SYSTEM-D                 PIC X.
  5300                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5301             20  CF-SOC-SEC-NO-SW            PIC X.
  5302                 88  SOC-SEC-NO-USED             VALUE '1'.
  5303             20  CF-MEMBER-NO-SW             PIC X.
  5304                 88  MEMBER-NO-USED              VALUE '1'.
  5305             20  CF-TAX-ID-NUMBER            PIC X(11).
  5306             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5307             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5308                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5309                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5310                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5311                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5312             20  CF-SYSTEM-E                 PIC X.
  5313                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5314
  5315         16  CF-LGX-LIFE-USER               PIC X.
  5316             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5317             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5318
  5319         16  CF-CR-MONTH-END-DT             PIC XX.
  5320
  5321         16  CF-FILE-MAINT-DATES.
  5322             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5323                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5324             20  CF-LAST-BATCH       REDEFINES
  5325                 CF-LAST-BATCH-NO               PIC X(4).
  5326             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5327             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5328             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5329             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5330             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5331             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5332             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5333             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5334             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5335             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 104
* EL689.cbl
  5336
  5337         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5338         16  FILLER                         PIC X.
  5339
  5340         16  CF-ALT-MORT-CODE               PIC X(4).
  5341         16  CF-MEMBER-CAPTION              PIC X(10).
  5342
  5343         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5344             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5345             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5346             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5347             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5348             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5349
  5350         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5351
  5352         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5353         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5354         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5355         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5356
  5357         16  CF-AH-OVERRIDE-L1              PIC X.
  5358         16  CF-AH-OVERRIDE-L2              PIC XX.
  5359         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5360         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5361
  5362         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5363         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5364
  5365         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5366         16  CF-AR-LAST-EL860-DT            PIC XX.
  5367         16  CF-MP-MONTH-END-DT             PIC XX.
  5368
  5369         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5370         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5371             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5372
  5373         16  CF-AR-MONTH-END-DT             PIC XX.
  5374
  5375         16  CF-CRDTCRD-USER                PIC X.
  5376             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5377             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5378
  5379         16  CF-CC-MONTH-END-DT             PIC XX.
  5380
  5381         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5382
  5383         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5384             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5385             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5386             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5387         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5388         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5389         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5390         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5391             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5392             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5393         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 105
* EL689.cbl
  5394         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5395         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5396             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5397         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5398
  5399         16  CF-CL-ZIP-CODE.
  5400             20  CF-CL-ZIP-PRIME.
  5401                 24  CF-CL-ZIP-1ST          PIC X.
  5402                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5403                 24  FILLER                 PIC X(4).
  5404             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5405         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5406             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5407             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5408             20  FILLER                     PIC XXX.
  5409
  5410         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5411         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5412         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5413         16  CF-CO-OPTION-START-DATE        PIC XX.
  5414         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5415           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5416                                                      '3' '4'.
  5417           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5418           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5419           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5420           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5421           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5422           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5423
  5424         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5425
  5426         16  CF-PAYMENT-APPROVAL-LEVELS.
  5427             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5428             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5429             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5430             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5431             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5432             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5433
  5434         16  CF-END-USER-REPORTING-USER     PIC X.
  5435             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5436             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5437
  5438         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5439             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5440             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5441
  5442         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5443
  5444         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5445         16  FILLER                         PIC X.
  5446
  5447         16  CF-CREDIT-ARCHIVE-CNTL.
  5448             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5449             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5450             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5451
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 106
* EL689.cbl
  5452         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5453
  5454         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5455             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5456             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5457
  5458         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5459             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5460             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5461
  5462         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5463
  5464         16  CF-CO-ACH-ID-CODE              PIC  X.
  5465             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5466             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5467             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5468         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5469         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5470         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5471         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5472         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5473         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5474         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5475         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5476         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5477                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5478         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5479                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5480
  5481         16  CF-CO-OVER-SHORT.
  5482             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5483             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5484
  5485*         16  FILLER                         PIC X(102).
  5486         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5487             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5488             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5489
  5490         16  CF-AH-APPROVAL-DAYS.
  5491             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5492             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5493             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5494             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5495
  5496         16  FILLER                         PIC X(82).
  5497****************************************************************
  5498*             PROCESSOR/USER RECORD                            *
  5499****************************************************************
  5500
  5501     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5502         16  CF-PROCESSOR-NAME              PIC X(30).
  5503         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5504         16  CF-PROCESSOR-TITLE             PIC X(26).
  5505         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5506                 88  MESSAGE-YES                VALUE 'Y'.
  5507                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5508
  5509*****************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 107
* EL689.cbl
  5510****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5511****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5512****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5513****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5514*****************************************************
  5515
  5516         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5517             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5518             20  CF-APPLICATION-FORCE       PIC X.
  5519             20  CF-INDIVIDUAL-APP.
  5520                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5521                     28  CF-BROWSE-APP      PIC X.
  5522                     28  CF-UPDATE-APP      PIC X.
  5523
  5524         16  CF-CURRENT-TERM-ON             PIC X(4).
  5525         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5526             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5527             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5528             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5529             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5530             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5531             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5532             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5533         16  CF-PROCESSOR-CARRIER           PIC X.
  5534             88  NO-CARRIER-SECURITY            VALUE ' '.
  5535         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5536             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5537         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5538             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5539         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5540             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5541
  5542         16  CF-PROC-SYS-ACCESS-SW.
  5543             20  CF-PROC-CREDIT-CLAIMS-SW.
  5544                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5545                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5546                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5547                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5548             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5549                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5550                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5551             20  CF-PROC-LIFE-GNRLDGR-SW.
  5552                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5553                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5554                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5555                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5556             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5557                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5558                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5559         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5560             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5561             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5562         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5563
  5564         16  CF-APPROVAL-LEVEL                  PIC X.
  5565             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5566             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5567             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 108
* EL689.cbl
  5568             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5569
  5570         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5571
  5572         16  CF-LANGUAGE-TYPE                   PIC X.
  5573             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5574             88  CF-LANG-IS-FR                      VALUE 'F'.
  5575
  5576         16  CF-CSR-IND                         PIC X.
  5577         16  FILLER                             PIC X(239).
  5578
  5579****************************************************************
  5580*             PROCESSOR/REMINDERS RECORD                       *
  5581****************************************************************
  5582
  5583     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5584         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5585             20  CF-START-REMIND-DT         PIC XX.
  5586             20  CF-END-REMIND-DT           PIC XX.
  5587             20  CF-REMINDER-TEXT           PIC X(50).
  5588         16  FILLER                         PIC X(296).
  5589
  5590
  5591****************************************************************
  5592*             STATE MASTER RECORD                              *
  5593****************************************************************
  5594
  5595     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5596         16  CF-STATE-ABBREVIATION          PIC XX.
  5597         16  CF-STATE-NAME                  PIC X(25).
  5598         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5599         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5600             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5601             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5602             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5603             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5604                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5605                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5606             20  CF-ST-PREM-REJECT-SW       PIC X.
  5607                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5608                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5609             20  CF-ST-REF-REJECT-SW        PIC X.
  5610                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5611                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5612         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5613         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5614         16  CF-ST-REFUND-RULES.
  5615             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5616             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5617             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5618         16  CF-ST-FST-PMT-EXTENSION.
  5619             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5620             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5621                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5622                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5623                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5624                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5625         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 109
* EL689.cbl
  5626             20  CF-ST-CALL-UNEARNED        PIC X.
  5627             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5628             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5629         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5630             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5631             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5632         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5633         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5634         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5635         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5636         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5637         16  FILLER                         PIC X.
  5638         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5639             20  CF-ST-BENEFIT-CD           PIC XX.
  5640             20  CF-ST-BENEFIT-KIND         PIC X.
  5641                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5642                 88  CF-ST-AH-KIND              VALUE 'A'.
  5643             20  CF-ST-REM-TERM-CALC        PIC X.
  5644                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5645                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5646                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5647                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5648                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5649                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5650                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5651                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5652
  5653             20  CF-ST-REFUND-CALC          PIC X.
  5654                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5655                 88  ST-REFD-BY-R78             VALUE '1'.
  5656                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5657                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5658                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5659                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5660                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5661                 88  ST-REFD-UTAH               VALUE '7'.
  5662                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5663                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5664                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5665
  5666             20  CF-ST-EARNING-CALC         PIC X.
  5667                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5668                 88  ST-EARN-BY-R78             VALUE '1'.
  5669                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5670                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5671                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5672                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5673                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5674                 88  ST-EARN-MEAN               VALUE '8'.
  5675                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5676
  5677             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5678                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5679                 88  ST-OVRD-BY-R78             VALUE '1'.
  5680                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5681                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5682                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5683                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 110
* EL689.cbl
  5684                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5685                 88  ST-OVRD-MEAN               VALUE '8'.
  5686                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5687             20  FILLER                     PIC X.
  5688
  5689         16  CF-ST-COMMISSION-CAPS.
  5690             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5691             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5692             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5693             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5694         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5695                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5696
  5697         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5698
  5699         16  CF-ST-STATUTORY-INTEREST.
  5700             20  CF-ST-STAT-DATE-FROM       PIC X.
  5701                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5702                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5703             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5704             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5705             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5706             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5707             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5708
  5709         16  CF-ST-OVER-SHORT.
  5710             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5711             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5712
  5713         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5714
  5715         16  CF-ST-RT-CALC                  PIC X.
  5716
  5717         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5718         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5719         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5720         16  CF-ST-RF-LR-CALC               PIC X.
  5721         16  CF-ST-RF-LL-CALC               PIC X.
  5722         16  CF-ST-RF-LN-CALC               PIC X.
  5723         16  CF-ST-RF-AH-CALC               PIC X.
  5724         16  CF-ST-RF-CP-CALC               PIC X.
  5725*        16  FILLER                         PIC X(206).
  5726*CIDMOD         16  FILLER                         PIC X(192).
  5727         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5728             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5729         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5730         16  CF-ST-VFY-2ND-BENE             PIC X.
  5731         16  FILLER                         PIC X(186).
  5732
  5733****************************************************************
  5734*             BENEFIT MASTER RECORD                            *
  5735****************************************************************
  5736
  5737     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5738         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5739             20  CF-BENEFIT-CODE            PIC XX.
  5740             20  CF-BENEFIT-NUMERIC  REDEFINES
  5741                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 111
* EL689.cbl
  5742             20  CF-BENEFIT-ALPHA           PIC XXX.
  5743             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5744             20  CF-BENEFIT-COMMENT         PIC X(10).
  5745
  5746             20  CF-LF-COVERAGE-TYPE        PIC X.
  5747                 88  CF-REDUCING                VALUE 'R'.
  5748                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5749
  5750             20  CF-SPECIAL-CALC-CD         PIC X.
  5751                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5752                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5753                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5754                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5755                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5756                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5757                 88  CF-FARM-PLAN               VALUE 'F'.
  5758                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5759                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5760                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5761                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5762                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5763                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5764                 88  CF-PRUDENTIAL              VALUE 'P'.
  5765                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5766                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5767                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5768                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5769                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5770                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5771
  5772             20  CF-JOINT-INDICATOR         PIC X.
  5773                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5774
  5775*            20  FILLER                     PIC X(12).
  5776             20  FILLER                     PIC X(11).
  5777             20  CF-BENEFIT-CATEGORY        PIC X.
  5778             20  CF-LOAN-TYPE               PIC X(8).
  5779
  5780             20  CF-CO-REM-TERM-CALC        PIC X.
  5781                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5782                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5783                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5784                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5785                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5786
  5787             20  CF-CO-EARNINGS-CALC        PIC X.
  5788                 88  CO-EARN-BY-R78             VALUE '1'.
  5789                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5790                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5791                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5792                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5793                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5794                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5795                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5796
  5797             20  CF-CO-REFUND-CALC          PIC X.
  5798                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5799                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 112
* EL689.cbl
  5800                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5801                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5802                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5803                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5804                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5805                 88  CO-REFD-MEAN               VALUE '8'.
  5806                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5807                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5808                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5809
  5810             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5811                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5812                 88  CO-OVRD-BY-R78             VALUE '1'.
  5813                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5814                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5815                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5816                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5817                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5818                 88  CO-OVRD-MEAN               VALUE '8'.
  5819                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5820
  5821             20  CF-CO-BEN-I-G-CD           PIC X.
  5822                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5823                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5824                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5825
  5826         16  FILLER                         PIC X(304).
  5827
  5828
  5829****************************************************************
  5830*             CARRIER MASTER RECORD                            *
  5831****************************************************************
  5832
  5833     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5834         16  CF-ADDRESS-DATA.
  5835             20  CF-MAIL-TO-NAME            PIC X(30).
  5836             20  CF-IN-CARE-OF              PIC X(30).
  5837             20  CF-ADDRESS-LINE-1          PIC X(30).
  5838             20  CF-ADDRESS-LINE-2          PIC X(30).
  5839             20  CF-CITY-STATE              PIC X(30).
  5840             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5841             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5842
  5843         16  CF-CLAIM-NO-CONTROL.
  5844             20  CF-CLAIM-NO-METHOD         PIC X.
  5845                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5846                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5847                 88  CLAIM-NO-SEQ               VALUE '3'.
  5848                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5849             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5850                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5851                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5852                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5853
  5854         16  CF-CHECK-NO-CONTROL.
  5855             20  CF-CHECK-NO-METHOD         PIC X.
  5856                 88  CHECK-NO-MANUAL            VALUE '1'.
  5857                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 113
* EL689.cbl
  5858                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5859                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5860             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5861                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5862
  5863         16  CF-DOMICILE-STATE              PIC XX.
  5864
  5865         16  CF-EXPENSE-CONTROLS.
  5866             20  CF-EXPENSE-METHOD          PIC X.
  5867                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5868                 88  DOLLARS-PER-PMT            VALUE '2'.
  5869                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5870                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5871             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5872             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5873
  5874         16  CF-CORRESPONDENCE-CONTROL.
  5875             20  CF-LETTER-RESEND-OPT       PIC X.
  5876                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5877                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5878             20  FILLER                     PIC X(4).
  5879
  5880         16  CF-RESERVE-CONTROLS.
  5881             20  CF-MANUAL-SW               PIC X.
  5882                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5883             20  CF-FUTURE-SW               PIC X.
  5884                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5885             20  CF-PTC-SW                  PIC X.
  5886                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5887             20  CF-IBNR-SW                 PIC X.
  5888                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5889             20  CF-PTC-LF-SW               PIC X.
  5890                 88  CF-LF-PTC-USED             VALUE '1'.
  5891             20  CF-CDT-ACCESS-METHOD       PIC X.
  5892                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5893                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5894                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5895             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5896
  5897         16  CF-CLAIM-CALC-METHOD           PIC X.
  5898             88  360-PLUS-MONTHS                VALUE '1'.
  5899             88  365-PLUS-MONTHS                VALUE '2'.
  5900             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5901             88  360-DAILY                      VALUE '4'.
  5902             88  365-DAILY                      VALUE '5'.
  5903
  5904         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5905         16  FILLER                         PIC X(11).
  5906
  5907         16  CF-LIMIT-AMOUNTS.
  5908             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5909             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5910             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5911             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5912             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5913             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5914             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5915             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 114
* EL689.cbl
  5916             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5917             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5918
  5919         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5920         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5921         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5922
  5923         16  CF-ZIP-CODE.
  5924             20  CF-ZIP-PRIME.
  5925                 24  CF-ZIP-1ST             PIC X.
  5926                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5927                 24  FILLER                 PIC X(4).
  5928             20  CF-ZIP-PLUS4               PIC X(4).
  5929         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5930             20  CF-CAN-POSTAL-1            PIC XXX.
  5931             20  CF-CAN-POSTAL-2            PIC XXX.
  5932             20  FILLER                     PIC XXX.
  5933
  5934         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5935         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5936         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5937
  5938         16  CF-RATING-SWITCH               PIC X.
  5939             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5940             88  CF-NO-RATING                   VALUE 'N'.
  5941
  5942         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5943
  5944         16  CF-CARRIER-OVER-SHORT.
  5945             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5946             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5947
  5948         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5949         16  CF-SECPAY-SWITCH               PIC X.
  5950             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5951             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5952         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5953         16  FILLER                         PIC X(448).
  5954*        16  FILLER                         PIC X(452).
  5955
  5956
  5957****************************************************************
  5958*             MORTALITY MASTER RECORD                          *
  5959****************************************************************
  5960
  5961     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5962         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5963                                INDEXED BY CF-MORT-NDX.
  5964             20  CF-MORT-TABLE              PIC X(5).
  5965             20  CF-MORT-TABLE-TYPE         PIC X.
  5966                 88  CF-MORT-JOINT              VALUE 'J'.
  5967                 88  CF-MORT-SINGLE             VALUE 'S'.
  5968                 88  CF-MORT-COMBINED           VALUE 'C'.
  5969                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5970                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5971             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5972             20  CF-MORT-AGE-METHOD         PIC XX.
  5973                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 115
* EL689.cbl
  5974                 88  CF-AGE-NEAR                VALUE 'AN'.
  5975             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5976             20  CF-MORT-ADJUSTMENT-DIRECTION
  5977                                            PIC X.
  5978                 88  CF-MINUS                   VALUE '-'.
  5979                 88  CF-PLUS                    VALUE '+'.
  5980             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5981             20  CF-MORT-JOINT-CODE         PIC X.
  5982                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5983             20  CF-MORT-PC-Q               PIC X.
  5984                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5985             20  CF-MORT-TABLE-CODE         PIC X(4).
  5986             20  CF-MORT-COMMENTS           PIC X(15).
  5987             20  FILLER                     PIC X(14).
  5988
  5989         16  FILLER                         PIC X(251).
  5990
  5991
  5992****************************************************************
  5993*             BUSSINESS TYPE MASTER RECORD                     *
  5994****************************************************************
  5995
  5996     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5997* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5998* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5999* AND RECORD 05 IS TYPES 81-99
  6000         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6001             20  CF-BUSINESS-TITLE          PIC  X(19).
  6002             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6003                                            PIC S9V9(4) COMP-3.
  6004             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6005             20  FILLER                     PIC  X.
  6006         16  FILLER                         PIC  X(248).
  6007
  6008
  6009****************************************************************
  6010*             TERMINAL MASTER RECORD                           *
  6011****************************************************************
  6012
  6013     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6014
  6015         16  CF-COMPANY-TERMINALS.
  6016             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6017                                  PIC X(4).
  6018         16  FILLER               PIC X(248).
  6019
  6020
  6021****************************************************************
  6022*             LIFE EDIT MASTER RECORD                          *
  6023****************************************************************
  6024
  6025     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6026         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6027             20  CF-LIFE-CODE-IN            PIC XX.
  6028             20  CF-LIFE-CODE-OUT           PIC XX.
  6029         16  FILLER                         PIC X(248).
  6030
  6031
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 116
* EL689.cbl
  6032****************************************************************
  6033*             AH EDIT MASTER RECORD                            *
  6034****************************************************************
  6035
  6036     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6037         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6038             20  CF-AH-CODE-IN              PIC XXX.
  6039             20  CF-AH-CODE-OUT             PIC XX.
  6040         16  FILLER                         PIC X(248).
  6041
  6042
  6043****************************************************************
  6044*             CREDIBILITY TABLES                               *
  6045****************************************************************
  6046
  6047     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6048         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6049                             INDEXED BY CF-CRDB-NDX.
  6050             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6051             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6052             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6053         16  FILLER                         PIC  X(332).
  6054
  6055
  6056****************************************************************
  6057*             REPORT CUSTOMIZATION RECORD                      *
  6058****************************************************************
  6059
  6060     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6061         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6062             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6063             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6064             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6065**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6066****       A T-TRANSFER.                                   ****
  6067             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6068
  6069         16  FILLER                         PIC XX.
  6070
  6071         16  CF-CARRIER-CNTL-OPT.
  6072             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6073                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6074                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6075             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6076                                            PIC X.
  6077         16  CF-GROUP-CNTL-OPT.
  6078             20  CF-GROUP-OPT-SEQ           PIC 9.
  6079                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6080                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6081             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6082                                            PIC X(6).
  6083         16  CF-STATE-CNTL-OPT.
  6084             20  CF-STATE-OPT-SEQ           PIC 9.
  6085                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6086                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6087             20  CF-STATE-SELECT OCCURS 3 TIMES
  6088                                            PIC XX.
  6089         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 117
* EL689.cbl
  6090             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6091                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6092                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6093             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6094                                            PIC X(10).
  6095         16  CF-BUS-TYP-CNTL-OPT.
  6096             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6097                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6098                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6099             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6100                                            PIC XX.
  6101         16  CF-LF-TYP-CNTL-OPT.
  6102             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6103                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6104                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6105             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6106                                            PIC XX.
  6107         16  CF-AH-TYP-CNTL-OPT.
  6108             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6109                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6110                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6111             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6112                                            PIC XX.
  6113         16  CF-REPTCD1-CNTL-OPT.
  6114             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6115                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6116                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6117             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6118                                            PIC X(10).
  6119         16  CF-REPTCD2-CNTL-OPT.
  6120             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6121                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6122                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6123             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-USER1-CNTL-OPT.
  6126             20  CF-USER1-OPT-SEQ           PIC 9.
  6127                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6128                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6129             20  CF-USER1-SELECT OCCURS 3 TIMES
  6130                                            PIC X(10).
  6131         16  CF-USER2-CNTL-OPT.
  6132             20  CF-USER2-OPT-SEQ           PIC 9.
  6133                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6134                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6135             20  CF-USER2-SELECT OCCURS 3 TIMES
  6136                                            PIC X(10).
  6137         16  CF-USER3-CNTL-OPT.
  6138             20  CF-USER3-OPT-SEQ           PIC 9.
  6139                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6140                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6141             20  CF-USER3-SELECT OCCURS 3 TIMES
  6142                                            PIC X(10).
  6143         16  CF-USER4-CNTL-OPT.
  6144             20  CF-USER4-OPT-SEQ           PIC 9.
  6145                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6146                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6147             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 118
* EL689.cbl
  6148                                            PIC X(10).
  6149         16  CF-USER5-CNTL-OPT.
  6150             20  CF-USER5-OPT-SEQ           PIC 9.
  6151                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6152                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6153             20  CF-USER5-SELECT OCCURS 3 TIMES
  6154                                            PIC X(10).
  6155         16  CF-REINS-CNTL-OPT.
  6156             20  CF-REINS-OPT-SEQ           PIC 9.
  6157                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6158                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6159             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6160                 24  CF-REINS-PRIME         PIC XXX.
  6161                 24  CF-REINS-SUB           PIC XXX.
  6162
  6163         16  CF-AGENT-CNTL-OPT.
  6164             20  CF-AGENT-OPT-SEQ           PIC 9.
  6165                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6166                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6167             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6168                                            PIC X(10).
  6169
  6170         16  FILLER                         PIC X(43).
  6171
  6172         16  CF-LOSS-RATIO-SELECT.
  6173             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6174             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6175         16  CF-ENTRY-DATE-SELECT.
  6176             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6177             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6178         16  CF-EFFECTIVE-DATE-SELECT.
  6179             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6180             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6181
  6182         16  CF-EXCEPTION-LIST-IND          PIC X.
  6183             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6184
  6185         16  FILLER                         PIC X(318).
  6186
  6187****************************************************************
  6188*                  EXCEPTION REPORTING RECORD                  *
  6189****************************************************************
  6190
  6191     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6192         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6193             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6194
  6195         16  CF-COMBINED-LIFE-AH-OPT.
  6196             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6197             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6198             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6199             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6200
  6201         16  CF-LIFE-OPT.
  6202             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6203             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6204             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6205             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 119
* EL689.cbl
  6206             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6207             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6208             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6209             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6210             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6211             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6212
  6213         16  CF-AH-OPT.
  6214             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6215             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6216             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6217             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6218             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6219             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6220             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6221             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6222             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6223             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6224
  6225         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6226             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6227             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6228             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6229
  6230         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6231
  6232         16  FILLER                         PIC X(673).
  6233
  6234
  6235****************************************************************
  6236*             MORTGAGE SYSTEM PLAN RECORD                      *
  6237****************************************************************
  6238
  6239     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6240         16  CF-PLAN-TYPE                   PIC X.
  6241             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6242             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6243             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6244         16  CF-PLAN-ABBREV                 PIC XXX.
  6245         16  CF-PLAN-DESCRIPT               PIC X(10).
  6246         16  CF-PLAN-NOTES                  PIC X(20).
  6247         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6248         16  CF-PLAN-UNDERWRITING.
  6249             20  CF-PLAN-TERM-DATA.
  6250                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6251                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6252             20  CF-PLAN-AGE-DATA.
  6253                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6254                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6255                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6256             20  CF-PLAN-BENEFIT-DATA.
  6257                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6258                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6259                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6260                                            PIC S9(7)V99  COMP-3.
  6261         16  CF-PLAN-POLICY-FORMS.
  6262             20  CF-POLICY-FORM             PIC X(12).
  6263             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 120
* EL689.cbl
  6264             20  CF-MASTER-POLICY           PIC X(12).
  6265         16  CF-PLAN-RATING.
  6266             20  CF-RATE-CODE               PIC X(5).
  6267             20  CF-SEX-RATING              PIC X.
  6268                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6269                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6270             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6271             20  CF-SUB-STD-TYPE            PIC X.
  6272                 88  CF-PCT-OF-PREM            VALUE '1'.
  6273                 88  CF-PCT-OF-BENE            VALUE '2'.
  6274         16  CF-PLAN-PREM-TOLERANCES.
  6275             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6276             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6277         16  CF-PLAN-PYMT-TOLERANCES.
  6278             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6279             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6280         16  CF-PLAN-MISC-DATA.
  6281             20  FILLER                     PIC X.
  6282             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6283             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6284         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6285         16  CF-PLAN-IND-GRP                PIC X.
  6286             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6287                                                     '1'.
  6288             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6289                                                     '2'.
  6290         16  CF-MIB-SEARCH-SW               PIC X.
  6291             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6292             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6293             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6294             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6295         16  CF-ALPHA-SEARCH-SW             PIC X.
  6296             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6297             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6298             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6299             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6300             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6301             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6302             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6303             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6304             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6305             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6306                                                     'A' 'B' 'C'
  6307                                                     'X' 'Y' 'Z'.
  6308         16  CF-EFF-DT-RULE-SW              PIC X.
  6309             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6310             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6311             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6312             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6313             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6314         16  FILLER                         PIC X(4).
  6315         16  CF-HEALTH-QUESTIONS            PIC X.
  6316             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6317         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6318         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6319         16  CF-PLAN-SNGL-JNT               PIC X.
  6320             88  CF-COMBINED-PLAN              VALUE 'C'.
  6321             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 121
* EL689.cbl
  6322             88  CF-SNGL-PLAN                  VALUE 'S'.
  6323         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6324         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6325         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6326         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6327         16  CF-RERATE-CNTL                 PIC  X.
  6328             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6329             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6330             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6331             88  CF-AUTO-RECALC                 VALUE '4'.
  6332         16  CF-BENEFIT-TYPE                PIC  X.
  6333             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6334             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6335         16  CF-POLICY-FEE                  PIC S999V99
  6336                                                    COMP-3.
  6337         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6338         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6339         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6340         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6341         16  FILLER                         PIC  X(32).
  6342         16  CF-TERMINATION-FORM            PIC  X(04).
  6343         16  FILLER                         PIC  X(08).
  6344         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6345                                                       COMP-3.
  6346         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6347         16  CF-ISSUE-LETTER                PIC  X(4).
  6348         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6349         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6350             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6351             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6352         16  CF-MP-REFUND-CALC              PIC X.
  6353             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6354             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6355             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6356             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6357             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6358             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6359             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6360             88  CF-MP-REFD-MEAN                VALUE '8'.
  6361         16  CF-ALT-RATE-CODE               PIC  X(5).
  6362
  6363
  6364         16  FILLER                         PIC X(498).
  6365****************************************************************
  6366*             MORTGAGE COMPANY MASTER RECORD                   *
  6367****************************************************************
  6368
  6369     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6370         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6371         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6372             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6373             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6374             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6375             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6376             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6377
  6378         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6379         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 122
* EL689.cbl
  6380         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6381         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6382         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6383
  6384         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6385             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6386         16  CF-MP-RECON-USE-IND            PIC X(1).
  6387             88  CF-MP-USE-RECON             VALUE 'Y'.
  6388         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6389             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6390         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6391             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6392             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6393         16  FILLER                         PIC X(1).
  6394         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6395             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6396         16  CF-MORTG-MIB-VERSION           PIC X.
  6397             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6398             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6399             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6400         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6401             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6402                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6403             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6404                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6405             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6406                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6407             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6408                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6409             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6410                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6411             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6412                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6413         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6414         16  FILLER                         PIC X(7).
  6415         16  CF-MORTG-DESTINATION-SYMBOL.
  6416             20  CF-MORTG-MIB-COMM          PIC X(5).
  6417             20  CF-MORTG-MIB-TERM          PIC X(5).
  6418         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6419             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6420         16  FILLER                         PIC X(03).
  6421         16  CF-MP-CHECK-NO-CONTROL.
  6422             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6423                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6424                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6425                                                ' ' LOW-VALUES.
  6426                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6427                                               VALUE '3'.
  6428         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6429         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6430         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6431             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6432                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6433             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6434                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6435             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6436                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6437             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 123
* EL689.cbl
  6438                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6439             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6440                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6441             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6442                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6443         16  CF-MORTG-BILLING-AREA.
  6444             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6445                                            PIC X.
  6446         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6447         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6448         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6449         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6450             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6451             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6452         16  FILLER                         PIC X.
  6453         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6454             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6455             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6456         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6457         16  FILLER                         PIC X(8).
  6458         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6459         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6460         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6461         16  CF-ACH-COMPANY-ID.
  6462             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6463                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6464                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6465                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6466             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6467         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6468             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6469         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6470             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6471             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6472         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6473         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6474         16  FILLER                         PIC X(536).
  6475
  6476****************************************************************
  6477*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6478****************************************************************
  6479
  6480     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6481         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6482             20  CF-FEMALE-HEIGHT.
  6483                 24  CF-FEMALE-FT           PIC 99.
  6484                 24  CF-FEMALE-IN           PIC 99.
  6485             20  CF-FEMALE-MIN-WT           PIC 999.
  6486             20  CF-FEMALE-MAX-WT           PIC 999.
  6487         16  FILLER                         PIC X(428).
  6488
  6489     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6490         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6491             20  CF-MALE-HEIGHT.
  6492                 24  CF-MALE-FT             PIC 99.
  6493                 24  CF-MALE-IN             PIC 99.
  6494             20  CF-MALE-MIN-WT             PIC 999.
  6495             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 124
* EL689.cbl
  6496         16  FILLER                         PIC X(428).
  6497******************************************************************
  6498*             AUTOMATIC ACTIVITY RECORD                          *
  6499******************************************************************
  6500     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6501         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6502             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6503             20  CF-SYS-LETTER-ID           PIC X(04).
  6504             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6505             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6506             20  CF-SYS-RESET-SW            PIC X(01).
  6507             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6508             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6509
  6510         16  FILLER                         PIC X(50).
  6511
  6512         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6513             20  CF-USER-ACTIVE-SW          PIC X(01).
  6514             20  CF-USER-LETTER-ID          PIC X(04).
  6515             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6516             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6517             20  CF-USER-RESET-SW           PIC X(01).
  6518             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6519             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6520             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6521
  6522         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 125
* EL689.cbl
  6524*    COPY ERCCOMP.
  6525******************************************************************
  6526*                                                                *
  6527*                                                                *
  6528*                            ERCCOMP                             *
  6529*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6530*                            VMOD=2.019                          *
  6531*                                                                *
  6532*   ONLINE CREDIT SYSTEM                                         *
  6533*                                                                *
  6534*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6535*                                                                *
  6536*   FILE TYPE = VSAM,KSDS                                        *
  6537*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6538*                                                                *
  6539*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6540*       ALTERNATE PATH = NONE                                    *
  6541*                                                                *
  6542*   LOG = NO                                                     *
  6543*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6544*                                                                *
  6545******************************************************************
  6546*                   C H A N G E   L O G
  6547*
  6548* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6549*-----------------------------------------------------------------
  6550*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6551* EFFECTIVE    NUMBER
  6552*-----------------------------------------------------------------
  6553* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6554* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6555* 092205    2005050300006  PEMA  ADD LEASE FEE
  6556* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6557* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6558* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6559* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6560* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6561* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6562******************************************************************
  6563
  6564 01  COMPENSATION-MASTER.
  6565     12  CO-RECORD-ID                          PIC XX.
  6566         88  VALID-CO-ID                          VALUE 'CO'.
  6567
  6568     12  CO-CONTROL-PRIMARY.
  6569         16  CO-COMPANY-CD                     PIC X.
  6570         16  CO-CONTROL.
  6571             20  CO-CTL-1.
  6572                 24  CO-CARR-GROUP.
  6573                     28  CO-CARRIER            PIC X.
  6574                     28  CO-GROUPING.
  6575                         32  CO-GROUP-PREFIX   PIC XXX.
  6576                         32  CO-GROUP-PRIME    PIC XXX.
  6577                 24  CO-RESP-NO.
  6578                     28  CO-RESP-PREFIX        PIC X(4).
  6579                     28  CO-RESP-PRIME         PIC X(6).
  6580             20  CO-CTL-2.
  6581                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 126
* EL689.cbl
  6582                     28  CO-ACCT-PREFIX        PIC X(4).
  6583                     28  CO-ACCT-PRIME         PIC X(6).
  6584         16  CO-TYPE                           PIC X.
  6585             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6586             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6587             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6588
  6589     12  CO-MAINT-INFORMATION.
  6590         16  CO-LAST-MAINT-DT                  PIC XX.
  6591         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6592         16  CO-LAST-MAINT-USER                PIC X(4).
  6593     12  FILLER                                PIC XX.
  6594     12  CO-STMT-TYPE                          PIC XXX.
  6595     12  CO-COMP-TYPE                          PIC X.
  6596         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6597     12  CO-STMT-OWNER                         PIC X(4).
  6598     12  CO-BALANCE-CONTROL                    PIC X.
  6599         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6600         88  CO-NO-BALANCE                        VALUE 'N'.
  6601
  6602     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6603         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6604         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6605         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6606
  6607     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6608         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6609         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6610
  6611     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6612     12  CO-GA-DIRECT-DEP                      PIC X.
  6613     12  CO-FUTURE-SPACE                       PIC X.
  6614         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6615
  6616     12  CO-ACCT-NAME                          PIC X(30).
  6617     12  CO-MAIL-NAME                          PIC X(30).
  6618     12  CO-ADDR-1                             PIC X(30).
  6619     12  CO-ADDR-2                             PIC X(30).
  6620     12  CO-ADDR-3.
  6621         16  CO-ADDR-CITY                      PIC X(27).
  6622         16  CO-ADDR-STATE                     PIC XX.
  6623     12  CO-CSO-1099                           PIC X.
  6624     12  CO-ZIP.
  6625         16  CO-ZIP-PRIME.
  6626             20  CO-ZIP-PRI-1ST                PIC X.
  6627                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6628             20  FILLER                        PIC X(4).
  6629         16  CO-ZIP-PLUS4                      PIC X(4).
  6630     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6631         16  CO-CAN-POSTAL-1                   PIC XXX.
  6632         16  CO-CAN-POSTAL-2                   PIC XXX.
  6633         16  FILLER                            PIC XXX.
  6634     12  CO-SOC-SEC                            PIC X(13).
  6635     12  CO-TELEPHONE.
  6636         16  CO-AREA-CODE                      PIC XXX.
  6637         16  CO-PREFIX                         PIC XXX.
  6638         16  CO-PHONE                          PIC X(4).
  6639
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 127
* EL689.cbl
  6640     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6641
  6642     12  CO-AR-BAL-LEVEL                       PIC X.
  6643         88  CO-AR-REF-LVL                        VALUE '1'.
  6644         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6645         88  CO-AR-BILL-LVL                       VALUE '2'.
  6646         88  CO-AR-AGT-LVL                        VALUE '3'.
  6647         88  CO-AR-FR-LVL                         VALUE '4'.
  6648
  6649     12  CO-AR-NORMAL-PRINT                    PIC X.
  6650         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6651         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6652
  6653     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6654
  6655     12  CO-AR-REPORTING                       PIC X.
  6656         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6657         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6658
  6659     12  CO-AR-PULL-CHECK                      PIC X.
  6660         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6661         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6662
  6663     12  CO-AR-BALANCE-PRINT                   PIC X.
  6664         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6665
  6666     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6667         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6668         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6669         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6670
  6671     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6672
  6673     12  CO-USER-CODE                          PIC X.
  6674     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6675
  6676******************************************************************
  6677*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6678*    THE LAST MONTH END RUN.
  6679******************************************************************
  6680
  6681     12  CO-LAST-ACTIVITY-DATE.
  6682         16  CO-ACT-YEAR                       PIC 99.
  6683         16  CO-ACT-MONTH                      PIC 99.
  6684         16  CO-ACT-DAY                        PIC 99.
  6685
  6686     12  CO-LAST-STMT-DT.
  6687         16  CO-LAST-STMT-YEAR                 PIC 99.
  6688         16  CO-LAST-STMT-MONTH                PIC 99.
  6689         16  CO-LAST-STMT-DAY                  PIC 99.
  6690
  6691     12  CO-MO-END-TOTALS.
  6692         16  CO-MONTHLY-TOTALS.
  6693             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6694             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6695             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6696             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6697             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 128
* EL689.cbl
  6698
  6699         16  CO-AGING-TOTALS.
  6700             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6701             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6702             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6703             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6704
  6705         16  CO-YTD-TOTALS.
  6706             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6707             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6708
  6709         16  CO-OVER-UNDER-TOTALS.
  6710             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6711             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6712
  6713     12  CO-MISCELLANEOUS-TOTALS.
  6714         16  CO-FICA-TOTALS.
  6715             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6716             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6717
  6718         16  CO-CLAIM-TOTALS.
  6719             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6720             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6721
  6722******************************************************************
  6723*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6724*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6725******************************************************************
  6726
  6727     12  CO-CURRENT-TOTALS.
  6728         16  CO-CURRENT-LAST-STMT-DT.
  6729             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6730             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6731             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6732
  6733         16  CO-CURRENT-MONTHLY-TOTALS.
  6734             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6735             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6736             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6737             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6738             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6739
  6740         16  CO-CURRENT-AGING-TOTALS.
  6741             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6742             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6743             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6744             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6745
  6746         16  CO-CURRENT-YTD-TOTALS.
  6747             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6748             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6749
  6750     12  CO-PAID-COMM-TOTALS.
  6751         16  CO-YTD-PAID-COMMS.
  6752             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6753             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6754
  6755     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 129
* EL689.cbl
  6756         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6757         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6758
  6759     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6760         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6761         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6762         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6763         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6764         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6765         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6766         88  CO-FINAL-LETTER                  VALUE 'F'.
  6767         88  CO-RECONCILING                   VALUE 'R'.
  6768         88  CO-PHONE-CALL                    VALUE 'P'.
  6769         88  CO-LEGAL                         VALUE 'L'.
  6770         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6771         88  CO-WRITE-OFF                     VALUE 'W'.
  6772         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6773
  6774     12  CO-CSR-CODE                       PIC X(4).
  6775
  6776     12  CO-GA-STATUS-INFO.
  6777         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6778         16  CO-GA-TERMINATION-DT          PIC XX.
  6779         16  CO-GA-STATUS-CODE             PIC X.
  6780             88  CO-GA-ACTIVE                 VALUE 'A'.
  6781             88  CO-GA-INACTIVE               VALUE 'I'.
  6782             88  CO-GA-PENDING                VALUE 'P'.
  6783         16  CO-GA-COMMENTS.
  6784             20  CO-GA-COMMENT-1           PIC X(40).
  6785             20  CO-GA-COMMENT-2           PIC X(40).
  6786             20  CO-GA-COMMENT-3           PIC X(40).
  6787             20  CO-GA-COMMENT-4           PIC X(40).
  6788
  6789     12  CO-RPTCD2                         PIC X(10).
  6790     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6791         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6792         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6793
  6794     12  CO-TYPE-AGENT                     PIC X(01).
  6795         88  CO-CORPORATION                   VALUE 'C'.
  6796         88  CO-PARTNERSHIP                   VALUE 'P'.
  6797         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6798         88  CO-TRUST                         VALUE 'T'.
  6799         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6800
  6801     12  CO-FAXNO.
  6802         16  CO-FAX-AREA-CODE                  PIC XXX.
  6803         16  CO-FAX-PREFIX                     PIC XXX.
  6804         16  CO-FAX-PHONE                      PIC X(4).
  6805
  6806     12  CO-BANK-INFORMATION.
  6807         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6808         16  CO-BANK-TRANSIT-NON REDEFINES
  6809             CO-BANK-TRANSIT-NO                PIC 9(8).
  6810
  6811         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6812     12  CO-MISC-DEDUCT-INFO REDEFINES
  6813                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 130
* EL689.cbl
  6814         16  CO-MD-GL-ACCT                     PIC X(10).
  6815         16  CO-MD-DIV                         PIC XX.
  6816         16  CO-MD-CENTER                      PIC X(4).
  6817         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  6818         16  CO-CREATE-AP-CHECK                PIC X.
  6819         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6820         16  FILLER                            PIC XXX.
  6821     12  CO-ACH-STATUS                         PIC X.
  6822         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6823         88  CO-ACH-PENDING                        VALUE 'P'.
  6824
  6825     12  CO-BILL-SW                            PIC X.
  6826     12  CO-CONTROL-NAME                       PIC X(30).
  6827     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6828     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6829     12  CO-CLP-STATE                          PIC XX.
  6830     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6831     12  CO-SPP-REFUND-EDIT                    PIC X.
  6832
  6833******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 131
* EL689.cbl
  6835*    COPY ERCMAIL.
  6836******************************************************************
  6837*                                                                *
  6838*                                                                *
  6839*                            ERCMAIL                             *
  6840*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6841*                            VMOD=2.003                          *
  6842*                                                                *
  6843*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6844*                                                                *
  6845*   FILE TYPE = VSAM,KSDS                                        *
  6846*   RECORD SIZE = 374   RECFORM = FIX                            *
  6847*                                                                *
  6848*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6849*   ALTERNATE PATH    = NOT USED                                 *
  6850*                                                                *
  6851*   LOG = YES                                                    *
  6852*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6853******************************************************************
  6854*                   C H A N G E   L O G
  6855*
  6856* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6857*-----------------------------------------------------------------
  6858*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6859* EFFECTIVE    NUMBER
  6860*-----------------------------------------------------------------
  6861* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6862* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6863* 111108                   PEMA  ADD CRED BENE ADDR2
  6864******************************************************************
  6865
  6866 01  MAILING-DATA.
  6867     12  MA-RECORD-ID                      PIC XX.
  6868         88  VALID-MA-ID                       VALUE 'MA'.
  6869
  6870     12  MA-CONTROL-PRIMARY.
  6871         16  MA-COMPANY-CD                 PIC X.
  6872         16  MA-CARRIER                    PIC X.
  6873         16  MA-GROUPING.
  6874             20  MA-GROUPING-PREFIX        PIC XXX.
  6875             20  MA-GROUPING-PRIME         PIC XXX.
  6876         16  MA-STATE                      PIC XX.
  6877         16  MA-ACCOUNT.
  6878             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6879             20  MA-ACCOUNT-PRIME          PIC X(6).
  6880         16  MA-CERT-EFF-DT                PIC XX.
  6881         16  MA-CERT-NO.
  6882             20  MA-CERT-PRIME             PIC X(10).
  6883             20  MA-CERT-SFX               PIC X.
  6884
  6885     12  FILLER                            PIC XX.
  6886
  6887     12  MA-ACCESS-CONTROL.
  6888         16  MA-SOURCE-SYSTEM              PIC XX.
  6889             88  MA-FROM-CREDIT                VALUE 'CR'.
  6890             88  MA-FROM-VSI                   VALUE 'VS'.
  6891             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6892             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 132
* EL689.cbl
  6893         16  MA-RECORD-ADD-DT              PIC XX.
  6894         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6895         16  MA-LAST-MAINT-DT              PIC XX.
  6896         16  MA-LAST-MAINT-BY              PIC XXXX.
  6897         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6898
  6899     12  MA-PROFILE-INFO.
  6900         16  MA-QUALIFY-CODE-1             PIC XX.
  6901         16  MA-QUALIFY-CODE-2             PIC XX.
  6902         16  MA-QUALIFY-CODE-3             PIC XX.
  6903         16  MA-QUALIFY-CODE-4             PIC XX.
  6904         16  MA-QUALIFY-CODE-5             PIC XX.
  6905
  6906         16  MA-INSURED-LAST-NAME          PIC X(15).
  6907         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6908         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6909         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6910         16  MA-INSURED-BIRTH-DT           PIC XX.
  6911         16  MA-INSURED-SEX                PIC X.
  6912             88  MA-SEX-MALE                   VALUE 'M'.
  6913             88  MA-SEX-FEMALE                 VALUE 'F'.
  6914         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6915
  6916         16  MA-ADDRESS-CORRECTED          PIC X.
  6917         16  MA-JOINT-BIRTH-DT             PIC XX.
  6918*        16  FILLER                        PIC X(12).
  6919
  6920         16  MA-ADDRESS-LINE-1             PIC X(30).
  6921         16  MA-ADDRESS-LINE-2             PIC X(30).
  6922         16  MA-CITY-STATE.
  6923             20  MA-CITY                   PIC X(28).
  6924             20  MA-ADDR-STATE             PIC XX.
  6925         16  MA-ZIP.
  6926             20  MA-ZIP-CODE.
  6927                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6928                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6929                 24  FILLER                PIC X(4).
  6930             20  MA-ZIP-PLUS4              PIC X(4).
  6931         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6932             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6933             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6934             20  FILLER                    PIC X(3).
  6935
  6936         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6937
  6938         16  FILLER                        PIC XXX.
  6939*        16  FILLER                        PIC X(10).
  6940
  6941     12  MA-CRED-BENE-INFO.
  6942         16  MA-CRED-BENE-NAME                 PIC X(25).
  6943         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6944         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6945         16  MA-CRED-BENE-CTYST.
  6946             20  MA-CRED-BENE-CITY             PIC X(28).
  6947             20  MA-CRED-BENE-STATE            PIC XX.
  6948         16  MA-CRED-BENE-ZIP.
  6949             20  MA-CB-ZIP-CODE.
  6950                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 133
* EL689.cbl
  6951                     88  MA-CB-CANADIAN-POST-CODE
  6952                                           VALUE 'A' THRU 'Z'.
  6953                 24  FILLER                    PIC X(4).
  6954             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6955         16  MA-CB-CANADIAN-POSTAL-CODE
  6956                            REDEFINES MA-CRED-BENE-ZIP.
  6957             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6958             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6959             20  FILLER                        PIC X(3).
  6960     12  MA-POST-CARD-MAIL-DATA.
  6961         16  MA-MAIL-DATA OCCURS 7.
  6962             20  MA-MAIL-TYPE              PIC X.
  6963                 88  MA-12MO-MAILING           VALUE '1'.
  6964                 88  MA-EXP-MAILING            VALUE '2'.
  6965             20  MA-MAIL-STATUS            PIC X.
  6966                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6967                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6968                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6969             20  MA-MAIL-DATE              PIC XX.
  6970     12  FILLER                            PIC XX.
  6971     12  FILLER                            PIC XX.
  6972*    12  FILLER                            PIC X(30).
  6973******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 134
* EL689.cbl
  6975*    COPY ERCPNDB.
  6976******************************************************************
  6977*                                                                *
  6978*                                                                *
  6979*                            ERCPNDB.                            *
  6980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6981*                            VMOD=2.025                          *
  6982*                                                                *
  6983*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  6984*                                                                *
  6985******************************************************************
  6986*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6987*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6988******************************************************************
  6989*                                                                *
  6990*                                                                *
  6991*   FILE TYPE = VSAM,KSDS                                        *
  6992*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6993*                                                                *
  6994*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6995*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6996*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6997*                                                 RKP=13,LEN=36  *
  6998*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6999*                                      AND CHG-SEQ.)             *
  7000*                                                RKP=49,LEN=11   *
  7001*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  7002*                                      AND CHG-SEQ.)             *
  7003*                                                RKP=60,LEN=15   *
  7004*                                                                *
  7005*   LOG = NO                                                     *
  7006*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7007******************************************************************
  7008******************************************************************
  7009*                   C H A N G E   L O G
  7010*
  7011* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7012*-----------------------------------------------------------------
  7013*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7014* EFFECTIVE    NUMBER
  7015*-----------------------------------------------------------------
  7016* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7017* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7018* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7019* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7020* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7021* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7022* 032306                   PEMA  ADD BOW LOAN NUMBER
  7023* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7024* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7025* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7026* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7027* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7028* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7029* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7030* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7031******************************************************************
  7032
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 135
* EL689.cbl
  7033 01  PENDING-BUSINESS.
  7034     12  PB-RECORD-ID                     PIC XX.
  7035         88  VALID-PB-ID                        VALUE 'PB'.
  7036
  7037     12  PB-CONTROL-PRIMARY.
  7038         16  PB-COMPANY-CD                PIC X.
  7039         16  PB-ENTRY-BATCH               PIC X(6).
  7040         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7041         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7042
  7043     12  PB-CONTROL-BY-ACCOUNT.
  7044         16  PB-COMPANY-CD-A1             PIC X.
  7045         16  PB-CARRIER                   PIC X.
  7046         16  PB-GROUPING.
  7047             20  PB-GROUPING-PREFIX       PIC XXX.
  7048             20  PB-GROUPING-PRIME        PIC XXX.
  7049         16  PB-STATE                     PIC XX.
  7050         16  PB-ACCOUNT.
  7051             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7052             20  PB-ACCOUNT-PRIME         PIC X(6).
  7053         16  PB-CERT-EFF-DT               PIC XX.
  7054         16  PB-CERT-NO.
  7055             20  PB-CERT-PRIME            PIC X(10).
  7056             20  PB-CERT-SFX              PIC X.
  7057         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7058
  7059         16  PB-RECORD-TYPE               PIC X.
  7060             88  PB-MAILING-DATA                VALUE '0'.
  7061             88  PB-ISSUE                       VALUE '1'.
  7062             88  PB-CANCELLATION                VALUE '2'.
  7063             88  PB-BATCH-TRAILER               VALUE '9'.
  7064
  7065     12  PB-CONTROL-BY-ORIG-BATCH.
  7066         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7067         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7068         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7069         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7070
  7071     12  PB-CONTROL-BY-CSR.
  7072         16  PB-CSR-COMPANY-CD            PIC X.
  7073         16  PB-CSR-ID                    PIC X(4).
  7074         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7075         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7076         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7077******************************************************************
  7078*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7079******************************************************************
  7080
  7081     12  PB-LAST-MAINT-DT                 PIC XX.
  7082     12  PB-LAST-MAINT-BY                 PIC X(4).
  7083     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7084
  7085     12  PB-RECORD-BODY                   PIC X(375).
  7086
  7087     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7088         16  PB-CERT-ORIGIN               PIC X.
  7089             88  CLASIC-CREATED-CERT         VALUE '1'.
  7090         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 136
* EL689.cbl
  7091             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7092             20  PB-I-INSURED-FIRST-NAME.
  7093                 24  PB-I-INSURED-1ST-INIT PIC X.
  7094                 24  FILLER                PIC X(9).
  7095             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7096         16  PB-I-AGE                     PIC S99   COMP-3.
  7097         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7098         16  PB-I-BIRTHDAY                PIC XX.
  7099         16  PB-I-INSURED-SEX             PIC X.
  7100             88  PB-SEX-MALE     VALUE 'M'.
  7101             88  PB-SEX-FEMALE   VALUE 'F'.
  7102
  7103         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7104         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7105         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7106         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7107         16  PB-I-SKIP-CODE               PIC X.
  7108             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7109             88  PB-SKIP-JULY              VALUE '1'.
  7110             88  PB-SKIP-AUGUST            VALUE '2'.
  7111             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7112             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7113             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7114             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7115             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7116             88  PB-SKIP-JUNE              VALUE '8'.
  7117             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7118             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7119             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7120         16  PB-I-TERM-TYPE               PIC X.
  7121             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7122             88  PB-PAID-WEEKLY            VALUE 'W'.
  7123             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7124             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7125             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7126         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7127         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7128         16  PB-I-DATA-ENTRY-SW           PIC X.
  7129             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7130             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7131             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7132             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7133         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7134         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7135*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7136         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7137         16  FILLER                       PIC X.
  7138
  7139         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7140             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7141             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7142                                                   '90' THRU '99'.
  7143         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7144                                          PIC XX.
  7145         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7146         16  PB-I-AMOUNT-FINANCED REDEFINES
  7147                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7148         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 137
* EL689.cbl
  7149         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7150                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7151         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7152         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7153         16  PB-I-CLP-AMOUNT REDEFINES
  7154                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7155         16  PB-I-LF-CALC-FLAG            PIC X.
  7156             88 PB-COMP-LF-PREM               VALUE '?'.
  7157         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7158         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7159         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7160         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7161         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7162         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7163         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7164         16  PB-I-LF-ABBR                 PIC XXX.
  7165         16  PB-I-LF-INPUT-CD             PIC XX.
  7166
  7167         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7168             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7169             88  PB-INVALID-AH               VALUE '  ' '00'
  7170                                                   '90' THRU '99'.
  7171         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7172         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7173         16  PB-I-AH-CALC-FLAG            PIC X.
  7174             88 PB-COMP-AH-PREM                  VALUE '?'.
  7175         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7176         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7177         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7178         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7179         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7180         16  PB-I-AH-ABBR                 PIC XXX.
  7181         16  PB-I-AH-INPUT-CD             PIC XXX.
  7182
  7183         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7184         16  PB-I-REIN-TABLE              PIC XXX.
  7185         16  PB-I-BUSINESS-TYPE           PIC 99.
  7186         16  PB-I-INDV-GRP-CD             PIC X.
  7187         16  PB-I-MORT-CODE.
  7188             20  PB-I-TABLE               PIC X.
  7189             20  PB-I-INTEREST            PIC XX.
  7190             20  PB-I-MORT-TYP            PIC X.
  7191         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7192         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7193         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7194         16  PB-I-INDV-GRP-OVRD           PIC X.
  7195         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7196         16  PB-I-SIG-SW                  PIC X.
  7197             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7198         16  PB-I-RATE-CLASS              PIC XX.
  7199         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7200         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7201         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7202         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7203         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7204         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7205         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7206         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 138
* EL689.cbl
  7207         16  PB-I-OB-FLAG                 PIC X.
  7208             88  PB-I-OB                      VALUE 'B'.
  7209             88  PB-I-SUMMARY                 VALUE 'Z'.
  7210         16  PB-I-ENTRY-STATUS            PIC X.
  7211             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7212                                              'M' '5' '9' '2'.
  7213             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7214             88  PB-I-POLICY-PENDING          VALUE '2'.
  7215             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7216             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7217             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7218             88  PB-I-REIN-ONLY               VALUE '9'.
  7219             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7220             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7221             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7222             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7223         16  PB-I-INT-CODE                PIC X.
  7224             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7225             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7226         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7227         16  PB-I-SOC-SEC-NO              PIC X(11).
  7228         16  PB-I-MEMBER-NO               PIC X(12).
  7229         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7230*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7231         16  PB-I-OLD-LOF                 PIC XXX.
  7232         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7233         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7234         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7235         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7236         16  PB-I-LIFE-INDICATOR          PIC X.
  7237             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7238         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7239         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7240                                          PIC S9(5)V99    COMP-3.
  7241         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7242             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7243             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7244         16  PB-I-1ST-PMT-DT              PIC XX.
  7245         16  PB-I-JOINT-INSURED.
  7246             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7247             20 PB-I-JOINT-FIRST-NAME.
  7248                24  PB-I-JOINT-FIRST-INIT PIC X.
  7249                24  FILLER                PIC X(9).
  7250             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7251*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7252         16  PB-I-BENEFICIARY-NAME.
  7253             20  PB-I-BANK-NUMBER         PIC X(10).
  7254             20  FILLER                   PIC X(15).
  7255         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7256         16  PB-I-REFERENCE               PIC X(12).
  7257         16  FILLER REDEFINES PB-I-REFERENCE.
  7258             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7259             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7260             20  PB-I-CLP-STATE           PIC XX.
  7261         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7262             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7263             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7264             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 139
* EL689.cbl
  7265         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7266         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7267         16  PB-I-RESIDENT-STATE          PIC XX.
  7268         16  PB-I-RATE-CODE               PIC X(4).
  7269         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7270         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7271         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7272         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7273         16  PB-I-BANK-NOCHRGB            PIC 99.
  7274         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7275         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7276
  7277     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7278         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7279             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7280         16  PB-C-CANCEL-ORIGIN           PIC X.
  7281             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7282         16  PB-C-LF-CANCEL-DT            PIC XX.
  7283         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7284         16  PB-C-LF-CALC-REQ             PIC X.
  7285             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7286         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7287         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7288         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7289             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7290         16  PB-C-AH-CANCEL-DT            PIC XX.
  7291         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7292         16  PB-C-AH-CALC-REQ             PIC X.
  7293             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7294         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7295         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7296         16  PB-C-LAST-NAME               PIC X(15).
  7297         16  PB-C-REFUND-SW               PIC X.
  7298             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7299             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7300         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7301         16  PB-C-PAYEE-CODE              PIC X(6).
  7302         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7303         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7304         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7305         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7306         16  PB-C-REFERENCE               PIC X(12).
  7307         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7308         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7309         16  PB-C-POST-CARD-IND           PIC X.
  7310         16  PB-C-CANCEL-REASON           PIC X.
  7311         16  PB-C-REF-INTERFACE-SW        PIC X.
  7312         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7313         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7314         16  FILLER                       PIC X(01).
  7315*        16  FILLER                       PIC X(18).
  7316         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7317*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7318         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7319         16  PB-CANCELED-CERT-DATA.
  7320             20  PB-CI-INSURED-NAME.
  7321                 24  PB-CI-LAST-NAME      PIC X(15).
  7322                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 140
* EL689.cbl
  7323             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7324             20  PB-CI-INSURED-SEX        PIC X.
  7325             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7326             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7327             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7328             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7329             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7330             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7331             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7332             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7333             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7334             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7335             20  PB-CI-RATE-CLASS         PIC XX.
  7336             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7337             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7338             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7339             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7340             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7341             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7342             20  PB-CI-LF-ABBR            PIC X(3).
  7343             20  PB-CI-AH-ABBR            PIC X(3).
  7344             20  PB-CI-OB-FLAG            PIC X.
  7345                 88  PB-CI-OB                VALUE 'B'.
  7346             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7347                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7348                                           'M' '4' '5' '9' '2'.
  7349                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7350                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7351                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7352                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7353                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7354                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7355                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7356                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7357                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7358                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7359                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7360                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7361             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7362                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7363                                           'M' '4' '5' '9' '2'.
  7364                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7365                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7366                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7367                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7368                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7369                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7370                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7371                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7372                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7373                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7374                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7375                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7376             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7377             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7378             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7379             20  PB-CI-MEMBER-NO          PIC X(12).
  7380             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 141
* EL689.cbl
  7381                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7382                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7383             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7384             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7385             20  PB-CI-COMP-EXCP-SW       PIC X.
  7386                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7387                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7388             20  PB-CI-ENTRY-STATUS       PIC X.
  7389             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7390             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7391             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7392             20  PB-CI-DEATH-DT           PIC XX.
  7393             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7394             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7395             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7396             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7397             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7398             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7399             20  PB-CI-ENTRY-DT              PIC XX.
  7400             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7401             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7402             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7403             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7404             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7405             20  PB-CI-OLD-LOF               PIC XXX.
  7406*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7407             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7408             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7409             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7410             20  PB-CI-INDV-GRP-CD           PIC X.
  7411             20  PB-CI-BENEFICIARY-NAME.
  7412                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7413                 24  FILLER                  PIC X(15).
  7414             20  PB-CI-NOTE-SW               PIC X.
  7415             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7416             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7417             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7418             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7419             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7420             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7421             20  PB-CI-FIRST-NAME            PIC X(10).
  7422             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7423
  7424         16  FILLER                       PIC X(13).
  7425*032306  16  FILLER                       PIC X(27).
  7426*        16  FILLER                       PIC X(46).
  7427
  7428     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7429         16  FILLER                       PIC X(10).
  7430         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7431         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7432         16  PB-M-INSURED-MID-INIT        PIC X.
  7433         16  PB-M-INSURED-AGE             PIC 99.
  7434         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7435         16  PB-M-INSURED-SEX             PIC X.
  7436         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7437         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7438         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 142
* EL689.cbl
  7439         16  PB-M-INSURED-CITY-STATE.
  7440             20  PB-M-INSURED-CITY        PIC X(28).
  7441             20  PB-M-INSURED-STATE       PIC XX.
  7442         16  PB-M-INSURED-ZIP-CODE.
  7443             20  PB-M-INSURED-ZIP-PRIME.
  7444                 24  PB-M-INSURED-ZIP-1   PIC X.
  7445                     88  PB-M-CANADIAN-POST-CODE
  7446                                             VALUE 'A' THRU 'Z'.
  7447                 24  FILLER               PIC X(4).
  7448             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7449         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7450                                        PB-M-INSURED-ZIP-CODE.
  7451             20  PM-M-INS-CAN-POST1       PIC XXX.
  7452             20  PM-M-INS-CAN-POST2       PIC XXX.
  7453             20  FILLER                   PIC XXX.
  7454         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7455         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7456         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7457         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7458         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7459         16  PB-M-CRED-BENE-CITYST.
  7460             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7461             20  PB-M-CRED-BENE-STATE     PIC XX.
  7462         16  FILLER                       PIC X(92).
  7463
  7464     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7465         16  FILLER                       PIC X(10).
  7466         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7467         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7468         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7469         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7470         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7471         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7472         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7473         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7474         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7475         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7476         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7477         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7478         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7479         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7480         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7481         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7482         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7483         16  PB-ACCOUNT-NAME              PIC X(30).
  7484         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7485         16  PB-REFERENCE                 PIC X(12).
  7486         16  PB-B-RECEIVED-DT             PIC XX.
  7487         16  FILLER                       PIC X(234).
  7488
  7489     12  PB-RECORD-STATUS.
  7490         16  PB-CREDIT-SELECT-DT          PIC XX.
  7491         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7492         16  PB-BILLED-DT                 PIC XX.
  7493         16  PB-BILLING-STATUS            PIC X.
  7494             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7495             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7496             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 143
* EL689.cbl
  7497         16  PB-RECORD-BILL               PIC X.
  7498             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7499             88  PB-RECORD-RETURNED           VALUE 'R'.
  7500             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7501             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7502             88  PB-OVERRIDE-AH               VALUE 'A'.
  7503             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7504         16  PB-BATCH-ENTRY               PIC X.
  7505             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7506             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7507             88  PB-REISSUED-CERT             VALUE 'E'.
  7508             88  PB-MONTHLY-CERT              VALUE 'M'.
  7509             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7510             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7511             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7512         16  PB-FORCE-CODE                PIC X.
  7513             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7514             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7515             88  PB-CANCEL-FORCE              VALUE '8'.
  7516             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7517             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7518             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7519             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7520             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7521             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7522             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7523         16  PB-FATAL-FLAG                PIC X.
  7524             88  PB-FATAL-ERRORS              VALUE 'X'.
  7525         16  PB-FORCE-ER-CD               PIC X.
  7526             88  PB-FORCE-ERRORS              VALUE 'F'.
  7527             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7528         16  PB-WARN-ER-CD                PIC X.
  7529             88  PB-WARNING-ERRORS            VALUE 'W'.
  7530         16  FILLER                       PIC X.
  7531         16  PB-OUT-BAL-CD                PIC X.
  7532             88  PB-OUT-OF-BAL                VALUE 'O'.
  7533         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7534         16  PB-AH-OVERRIDE-L1            PIC X.
  7535         16  PB-INPUT-DT                  PIC XX.
  7536         16  PB-INPUT-BY                  PIC X(4).
  7537         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7538         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7539         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7540         16  PB-LF-EARNING-METHOD         PIC X.
  7541         16  PB-AH-EARNING-METHOD         PIC X.
  7542         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7543         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7544         16  PB-REIN-CD                   PIC XXX.
  7545         16  PB-LF-REFUND-TYPE            PIC X.
  7546         16  PB-AH-REFUND-TYPE            PIC X.
  7547         16  PB-ACCT-EFF-DT               PIC XX.
  7548         16  PB-ACCT-EXP-DT               PIC XX.
  7549         16  PB-COMPANY-ID                PIC X(3).
  7550         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7551         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7552         16  PB-SV-CARRIER                PIC X.
  7553         16  PB-SV-GROUPING               PIC X(6).
  7554         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 144
* EL689.cbl
  7555         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7556         16  PB-GA-BILLING-INFO.
  7557             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7558                                          PIC XX.
  7559         16  PB-SV-REMIT-TO  REDEFINES
  7560             PB-GA-BILLING-INFO           PIC X(10).
  7561         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7562         16  PB-I-LOAN-OFFICER            PIC X(5).
  7563         16  PB-I-VIN                     PIC X(17).
  7564
  7565         16  FILLER                       PIC X(04).
  7566         16  IMNET-BYPASS-SW              PIC X.
  7567
  7568******************************************************************
  7569*                COMMON EDIT ERRORS                              *
  7570******************************************************************
  7571
  7572     12  PB-COMMON-ERRORS.
  7573         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7574                                           PIC S9(4)     COMP.
  7575
  7576******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 145
* EL689.cbl
  7578*    COPY ERCPYAJ.
  7579******************************************************************
  7580*                                                                *
  7581*                            ERCPYAJ                             *
  7582*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7583*                            VMOD=2.015                          *
  7584*                                                                *
  7585*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7586*                                                                *
  7587*                                                                *
  7588*   FILE TYPE = VSAM,KSDS                                        *
  7589*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7590*                                                                *
  7591*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7592*       ALTERNATE PATHS = NONE                                   *
  7593*                                                                *
  7594*   LOG = YES                                                    *
  7595*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7596******************************************************************
  7597******************************************************************
  7598*                   C H A N G E   L O G
  7599*
  7600* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7601*-----------------------------------------------------------------
  7602*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7603* EFFECTIVE    NUMBER
  7604*-----------------------------------------------------------------
  7605* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7606* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7607******************************************************************
  7608
  7609 01  PENDING-PAY-ADJ.
  7610     12  PY-RECORD-ID                     PIC XX.
  7611         88  VALID-PY-ID                        VALUE 'PY'.
  7612
  7613     12  PY-CONTROL-PRIMARY.
  7614         16  PY-COMPANY-CD                PIC X.
  7615         16  PY-CARRIER                   PIC X.
  7616         16  PY-GROUPING                  PIC X(6).
  7617         16  PY-FIN-RESP                  PIC X(10).
  7618         16  PY-ACCOUNT                   PIC X(10).
  7619         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7620                                          PIC X(10).
  7621         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7622         16  PY-RECORD-TYPE               PIC X.
  7623             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7624             88  PY-DEPOSIT                   VALUE 'D'.
  7625             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7626             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7627             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7628             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7629             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7630             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7631             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7632             88  PY-FICA-ENTRY                VALUE 'F'.
  7633             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7634             88  PY-POLICY-FEE                VALUE 'W'.
  7635             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 146
* EL689.cbl
  7636
  7637     12  PY-PYMT-TYPE                     PIC X.
  7638             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7639             88  PY-REINS-PYMT                VALUE 'R'.
  7640             88  PY-EXP-PYMT                  VALUE 'E'.
  7641
  7642     12  PY-BIL-INV                       PIC X(6).
  7643     12  PY-REF-NO                        PIC X(12).
  7644
  7645     12  PY-LAST-MAINT-DT                 PIC XX.
  7646     12  PY-LAST-MAINT-BY                 PIC X(4).
  7647     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7648
  7649     12  PY-PYADJ-RECORD.
  7650         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7651         16  PY-ENTRY-COMMENT             PIC X(30).
  7652         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7653             20  PY-GL-ACCOUNT            PIC X(10).
  7654             20  PY-GL-STATE              PIC X(02).
  7655             20  PY-GL-CANC-SW            PIC X(01).
  7656                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7657                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7658             20  PY-GL-COMMENT            PIC X(10).
  7659             20  FILLER      REDEFINES PY-GL-COMMENT.
  7660                 24  PY-GL-CHECK-NO       PIC 9(06).
  7661                 24  FILLER               PIC X(04).
  7662             20  FILLER                   PIC X(07).
  7663         16  PY-SAVE-ACCOUNT              PIC X(10).
  7664         16  PY-SAVE-TYPE                 PIC X(01).
  7665
  7666         16  PY-LETTERS.
  7667             20  PY-LETTER OCCURS 3 TIMES
  7668                           INDEXED BY PY-LET-NDX
  7669                                          PIC X(04).
  7670
  7671         16  PY-ERCOMP-TYPE               PIC X.
  7672             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7673             88  PY-GA-TYPE                   VALUE 'G'.
  7674             88  PY-BANK-TYPE                 VALUE 'B'.
  7675         16  FILLER                       PIC X(05).
  7676
  7677     12  PY-RECORD-STATUS.
  7678         16  PY-CREDIT-SELECT-DT          PIC XX.
  7679         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7680         16  PY-BILLED-DATE               PIC XX.
  7681         16  PY-REPORTED-DT               PIC XX.
  7682         16  PY-PMT-APPLIED               PIC X.
  7683             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7684             88  PY-GA-PMT                    VALUE 'G'.
  7685             88  PY-OVWRITE-PMT               VALUE 'O'.
  7686             88  PY-NON-AR-PMT                VALUE 'N'.
  7687         16  FILLER                       PIC X(5).
  7688         16  PY-INPUT-DT                  PIC XX.
  7689         16  PY-CHECK-NUMBER              PIC X(6).
  7690         16  PY-VOID-SW                   PIC X.
  7691             88  PY-CHECK-VOIDED              VALUE 'V'.
  7692         16  PY-CHECK-ORIGIN-SW           PIC X.
  7693             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 147
* EL689.cbl
  7694             88  PY-REFUND-CHECK              VALUE 'R'.
  7695             88  PY-GA-CHECK                  VALUE 'G'.
  7696             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7697             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7698         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7699         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7700         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7701         16  PY-BILL-FLAG                 PIC X.
  7702             88  PY-BILLED                    VALUE 'B'.
  7703         16  PY-AR-FLAG                   PIC X.
  7704             88  PY-AR-CYCLE                  VALUE 'C'.
  7705             88  PY-AR-MONTH-END              VALUE 'M'.
  7706         16  PY-AR-DATE                   PIC XX.
  7707
  7708     12  PY-GL-CODES.
  7709         16  PY-GL-DB                     PIC X(14).
  7710         16  PY-GL-CR                     PIC X(14).
  7711         16  PY-GL-FLAG                   PIC X.
  7712         16  PY-GL-DATE                   PIC XX.
  7713
  7714     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7715     12  FILLER                           PIC X(3).
  7716******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 148
* EL689.cbl
  7718*    COPY ELCTEXT.
  7719******************************************************************
  7720*                                                                *
  7721*                                                                *
  7722*                            ELCTEXT.                            *
  7723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7724*                            VMOD=2.008                          *
  7725*                                                                *
  7726*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7727*                                     FORM LETTERS,              *
  7728*                                     CERT FORM DISPLAY.
  7729*                                                                *
  7730*   FILE TYPE = VSAM,KSDS                                        *
  7731*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7732*                                                                *
  7733*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7734*       ALTERNATE INDEX = NONE                                   *
  7735*                                                                *
  7736*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7737*       ALTERNATE INDEX = NONE                                   *
  7738*                                                                *
  7739*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7740*       ALTERNATE INDEX = NONE                                   *
  7741*                                                                *
  7742*   LOG = NO                                                     *
  7743*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7744******************************************************************
  7745 01  TEXT-FILES.
  7746     12  TEXT-FILE-ID                PIC XX.
  7747         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7748         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7749         88  HELP-FILE-TEXT             VALUE 'TH'.
  7750
  7751     12  TX-CONTROL-PRIMARY.
  7752         16  TX-COMPANY-CD           PIC X.
  7753             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7754         16  TX-ACCESS-CD-GENL       PIC X(12).
  7755
  7756         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7757             20  TX-LETTER-NO        PIC X(4).
  7758             20  FILLER              PIC X(8).
  7759
  7760         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7761             20  TX-FORM-NO          PIC X(12).
  7762
  7763         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7764             20  TX-HELP-TYPE        PIC X.
  7765                 88  HELP-FOR-GENERAL   VALUE ' '.
  7766                 88  HELP-BY-SCREEN     VALUE 'S'.
  7767                 88  HELP-BY-ERROR      VALUE 'E'.
  7768             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7769                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7770             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7771                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7772             20  FILLER              PIC X(4).
  7773
  7774         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7775
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 149
* EL689.cbl
  7776     12  TX-PROCESS-CONTROL          PIC XX.
  7777         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7778
  7779     12  TX-TEXT-LINE                PIC X(70).
  7780
  7781     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7782         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7783         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7784         88  TX-VALID-FORM-SQUEEZE-VALUE
  7785                                        VALUE 'Y' ' '.
  7786
  7787     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7788         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7789         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7790         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7791         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7792         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7793         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7794         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7795                                              'K' 'N' ' '
  7796                                              'Z'.
  7797
  7798     12  TX-ARCHIVE-SW               PIC X.
  7799         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  7800         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  7801         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  7802
  7803     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  7804     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  7805
  7806     12  TX-BSR-CODE                 PIC X.
  7807         88  TX-BSR-LETTER              VALUE 'B'.
  7808         88  TX-NON-BSR-LETTER          VALUE ' '.
  7809
  7810     12  FILLER                      PIC X.
  7811*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 150
* EL689.cbl
  7813*    COPY ERCENDT.
  7814******************************************************************
  7815*                                                                *
  7816*                                                                *
  7817*                            ERCENDT.                            *
  7818*                            VMOD=2.001                          *
  7819*                                                                *
  7820*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7821*                                                                *
  7822*   FILE TYPE = VSAM,KSDS                                        *
  7823*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7824*                                                                *
  7825*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7826*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7827*                                                                *
  7828*   LOG = NO                                                     *
  7829*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7830******************************************************************
  7831*-----------------------------------------------------------------
  7832*                   C H A N G E   L O G
  7833*
  7834* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7835*-----------------------------------------------------------------
  7836*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7837* EFFECTIVE    NUMBER
  7838*-----------------------------------------------------------------
  7839* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7840*                                WITH OPEN CLAIMS
  7841* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7842* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7843* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7844*-----------------------------------------------------------------
  7845 01  ENDORSEMENT-RECORD.
  7846     12  EN-RECORD-ID                PIC XX.
  7847         88  VALID-EN-ID                VALUE 'EN'.
  7848     12  EN-CONTROL-PRIMARY.
  7849         16  EN-COMPANY-CD           PIC X.
  7850         16  EN-CARRIER              PIC X.
  7851         16  EN-GROUPING             PIC X(6).
  7852         16  EN-STATE                PIC XX.
  7853         16  EN-ACCOUNT              PIC X(10).
  7854         16  EN-CERT-EFF-DT          PIC XX.
  7855         16  EN-CERT-NO.
  7856             20  EN-CERT-PRIME       PIC X(10).
  7857             20  EN-CERT-SFX         PIC X.
  7858         16  EN-REC-TYPE             PIC X.
  7859             88  EN-ISSUE               VALUE 'I'.
  7860             88  EN-CANCELLATION        VALUE 'C'.
  7861         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7862     12  EN-CONTROL-BY-ARCH-NO.
  7863         16  EN-COMPANY-CD-A1              PIC X.
  7864         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7865     12  EN-LAST-MAINT-DT            PIC XX.
  7866     12  EN-LAST-MAINT-BY            PIC X(4).
  7867     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7868     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7869     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7870         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 151
* EL689.cbl
  7871         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7872         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7873         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7874         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7875         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7876         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7877         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7878         16  EN-LF-ORIG-BENCD        PIC XX.
  7879         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7880         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7881         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7882         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7883         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7884         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7885*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7886         16  EN-ORIG-CRED-BENE       PIC X(25).
  7887         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7888         16  FILLER                  PIC X.
  7889         16  EN-AH-ORIG-BENCD        PIC XX.
  7890         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7891         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7892         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7893         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7894*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7895*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7896         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7897         16  F                       PIC X(09).
  7898         16  EN-AH-ORIG-CP           PIC 99.
  7899         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7900         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7901         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7902         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7903         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7904         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7905         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7906         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7907         16  EN-LF-NEW-BENCD         PIC XX.
  7908         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7909         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7910         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7911         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7912         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7913         16  EN-LF-NEW-EXP-DT        PIC XX.
  7914         16  EN-NEW-CRED-BENE        PIC X(25).
  7915         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7916         16  FILLER                  PIC X.
  7917         16  EN-AH-NEW-BENCD         PIC XX.
  7918         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7919         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7920         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7921         16  EN-AH-NEW-EXP-DT        PIC XX.
  7922*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7923*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7924*        16  F                       PIC X(12).
  7925         16  EN-AH-NEW-CP            PIC 99.
  7926         16  EN-SIG-SW               PIC X.
  7927         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7928         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 152
* EL689.cbl
  7929         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7930         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7931         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7932         16  FILLER                  PIC X(33).
  7933     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7934         16  EN-LF-ORIG-REF-DT       PIC XX.
  7935         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7936         16  EN-AH-ORIG-REF-DT       PIC XX.
  7937         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7938         16  EN-LF-NEW-REF-DT        PIC XX.
  7939         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7940         16  EN-AH-NEW-REF-DT        PIC XX.
  7941         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7942         16  EN-FLAG-CERT            PIC X.
  7943         16  EN-INS-LAST-NAME        PIC X(15).
  7944         16  EN-INS-FIRST-NAME       PIC X(10).
  7945         16  EN-INS-MIDDLE-INIT      PIC X.
  7946         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7947         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7948         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7949         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7950         16  FILLER                  PIC X(262).
  7951     12  EN-MONEY-SW             PIC X.
  7952     12  EN-HEALTH-APP           PIC X.
  7953     12  EN-VOUCHER-SW           PIC X.
  7954     12  EN-PAYEE                PIC X(14).
  7955     12  EN-INPUT-DT             PIC XX.
  7956     12  EN-PROCESS-DT           PIC XX.
  7957     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7958     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7959     12  EN-REASON-CODES.
  7960         16  F OCCURS 12.
  7961             20  EN-REASON-CODE  PIC X(4).
  7962     12  EN-TEMPLATE-USED        PIC X(8).
  7963     12  EN-DOCU-TYPE            PIC X.
  7964         88  EN-VERI-DOCU          VALUE 'V'.
  7965         88  EN-GCE-DOCU           VALUE 'G'.
  7966         88  EN-CANC-DOCU          VALUE 'C'.
  7967     12  EN-COMMENTS1            PIC X(13).
  7968     12  EN-COMMENTS2            PIC X(70).
  7969     12  EN-COMM-CHGBK           PIC X.
  7970         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7971         88  EN-CHG-ACCT           VALUE 'Y'.
  7972     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7973     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7974     12  EN-BATCH-NUMBER         PIC X(6).
  7975     12  EN-ACCT-SUMM            PIC X.
  7976     12  EN-CSO-SUMM             PIC X.
  7977     12  FILLER                  PIC X(13).
  7978******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 153
* EL689.cbl
  7980 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  7981                          ACCOUNT-MASTER LETTER-ARCHIVE
  7982                          LETTER-ARCHIVE-TEXT
  7983                          CERTIFICATE-MASTER CHECK-RECORDS
  7984                          CONTROL-FILE COMPENSATION-MASTER
  7985                          MAILING-DATA PENDING-BUSINESS
  7986                          PENDING-PAY-ADJ TEXT-FILES
  7987                          ENDORSEMENT-RECORD.
  7988 0000-DFHEXIT SECTION.
  7989     MOVE '9#                    $   ' TO DFHEIV0.
  7990     MOVE 'EL689' TO DFHEIV1.
  7991     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7992     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7993
  7994     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7995     MOVE '5'                    TO DC-OPTION-CODE.
  7996     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  7997     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  7998     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  7999                                    W-CURRENT-SAVE.
  8000
  8001     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8002     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  8003                                 TO EMI-SAVE-AREA.
  8004
  8005     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8006                                    W-TS-TERM-SCREEN.
  8007
  8008     IF  EIBCALEN EQUAL 0
  8009         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  8010         GO TO 8300-SEND-TEXT
  8011     END-IF.
  8012     set P to address of KIXSYS
  8013     CALL "getenv" using by value P returning var-ptr
  8014     if var-ptr = null then
  8015        display ' kixsys not set '
  8016     else
  8017        set address of var to var-ptr
  8018        move 0 to env-var-len
  8019        inspect var tallying env-var-len
  8020          for characters before X'00'
  8021*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8022        unstring var (1:env-var-len) delimited by '/'
  8023           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8024              WS-KIX-SYS
  8025        end-unstring
  8026*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8027*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8028     end-if
  8029     set P to address of KIXHOST
  8030     CALL "getenv" using by value P returning var-ptr
  8031     if var-ptr = null then
  8032        display ' kixhost not set '
  8033     else
  8034        set address of var to var-ptr
  8035        move 0 to env-var-len
  8036        inspect var tallying env-var-len
  8037          for characters before X'00'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 154
* EL689.cbl
  8038*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8039        MOVE var(1:env-var-len)  to ws-kixhost
  8040*       unstring var (1:env-var-len) delimited by '/'
  8041*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8042*             WS-KIX-SYS
  8043*       end-unstring
  8044        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8045*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8046     end-if
  8047     IF  PI-689-CREATE-NO-SCREENS
  8048         GO TO 0600-BYPASS-SCREEN-CNTL
  8049     END-IF.
  8050
  8051     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8052         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8053             MOVE PI-SAVED-PROGRAM-5
  8054                                 TO PI-SAVED-PROGRAM-6
  8055             MOVE PI-SAVED-PROGRAM-4
  8056                                 TO PI-SAVED-PROGRAM-5
  8057             MOVE PI-SAVED-PROGRAM-3
  8058                                 TO PI-SAVED-PROGRAM-4
  8059             MOVE PI-SAVED-PROGRAM-2
  8060                                 TO PI-SAVED-PROGRAM-3
  8061             MOVE PI-SAVED-PROGRAM-1
  8062                                 TO PI-SAVED-PROGRAM-2
  8063             MOVE PI-RETURN-TO-PROGRAM
  8064                                 TO PI-SAVED-PROGRAM-1
  8065             MOVE PI-CALLING-PROGRAM
  8066                                 TO PI-RETURN-TO-PROGRAM
  8067             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8068             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8069             MOVE LOW-VALUES     TO EL689AO
  8070             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8071             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8072                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8073             END-IF
  8074             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8075                     AND
  8076                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  8077                 GO TO 0400-EL6311-INCOMING
  8078             ELSE
  8079                 MOVE PI-689-ARCHIVE-NUMBER
  8080                                 TO W-INCOMING-ARCHIVE
  8081                 MOVE LOW-VALUES TO PI-1042-WA
  8082                                    PI-689-WORK-AREA
  8083                 MOVE ZEROS      TO PI-CURRENT-LINE
  8084                                    PI-TEMP-STOR-ITEMS
  8085                                    PI-TOTAL-LINES
  8086                                    PI-UPDATE-SW
  8087                                    PI-689-NUMBER-LABEL-LINES
  8088                                    PI-689-NUMBER-TEXT-RECORDS
  8089                                    PI-689-ERROR
  8090                 MOVE SPACES     TO PI-689-PRINT-SW
  8091                                    PI-689-ALT-PRINTER-ID
  8092                                    PI-689-LBL-OVERRIDE
  8093                                    PI-COMM-CONTROL
  8094                                    PI-689-FORM-NUMBER
  8095                                    PI-689-TEMP-STOR-ID
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 155
* EL689.cbl
  8096                                    PI-689-LABEL-SOURCE
  8097                                    PI-689-USE-SCREEN-IND
  8098                 MOVE '2'        TO PI-ACTION
  8099                 MOVE -1         TO MAINTL
  8100                 MOVE PI-LOWER-CASE-LETTERS
  8101                                 TO W-LC-CASE-IND
  8102                 IF  W-INCOMING-ARCHIVE NUMERIC
  8103                         AND
  8104                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8105                     MOVE 'S'    TO MAINTI
  8106                     MOVE +1     TO MAINTL
  8107                     MOVE AL-UANON
  8108                                 TO MAINTA
  8109                     MOVE W-INCOMING-ARCH-NO
  8110                                 TO ARCHNUMI
  8111                     MOVE +8     TO ARCHNUML
  8112                     MOVE AL-UNNON
  8113                                 TO ARCHNUMA
  8114                     GO TO 1000-SHOW
  8115                 ELSE
  8116                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8117                 END-IF
  8118             END-IF
  8119         ELSE
  8120             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8121             MOVE PI-RETURN-TO-PROGRAM
  8122                                     TO PI-CALLING-PROGRAM
  8123             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8124             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8125             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8126             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8127             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8128             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8129             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8130             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8131             MOVE LOW-VALUES         TO EL689AO
  8132             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8133             SET W-RG-NDX            TO PI-CURRENT-LINE
  8134             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8135                 VARYING
  8136                     W-SC-NDX FROM 1 BY 1
  8137                 UNTIL
  8138                     W-SC-NDX GREATER THAN
  8139                     W-NUM-LINES-PER-SCREEN
  8140             MOVE PI-689-ALT-PRINTER-ID
  8141                                     TO PRINTERO
  8142             MOVE AL-UANON           TO PRINTERA
  8143             MOVE -1                 TO PRINTERL
  8144             GO TO 8100-SEND-INITIAL-MAP
  8145         END-IF
  8146     END-IF.
  8147
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 156
* EL689.cbl
  8149 0200-RECEIVE.
  8150
  8151     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8152     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8153     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8154             OR
  8155         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8156         MOVE 'Y'                TO W-HOLD-IND.
  8157
  8158     MOVE W-TRANSACTION          TO EIBTRNID.
  8159     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8160     MOVE ZEROS                  TO W-LAST-ERROR.
  8161     MOVE LOW-VALUES             TO EL689AI.
  8162     MOVE '104A'                 TO W-TS-ID-TEXT.
  8163     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8164                                    W-TS-TERM-SCREEN.
  8165
  8166
  8167* EXEC CICS HANDLE AID
  8168*        CLEAR    (9300-DFHCLEAR)
  8169*        PA1      (9200-PA)
  8170*        PA2      (9200-PA)
  8171*        PA3      (9200-PA)
  8172*    END-EXEC.
  8173*    MOVE '"&=!"#               V! " #00008162' TO DFHEIV0
  8174     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8175     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8176     MOVE X'2220233030303038313632' TO DFHEIV0(25:11)
  8177     CALL 'kxdfhei1' USING DFHEIV0
  8178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8179
  8180
  8181
  8182* EXEC CICS HANDLE CONDITION
  8183*        PGMIDERR (9700-PGMID-ERROR)
  8184*        ERROR    (9800-ABEND)
  8185*        MAPFAIL  (0325-MAPFAIL)
  8186*    END-EXEC.
  8187*    MOVE '"$L.?                 ! # #00008169' TO DFHEIV0
  8188     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8190     MOVE X'2320233030303038313639' TO DFHEIV0(25:11)
  8191     CALL 'kxdfhei1' USING DFHEIV0
  8192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8193
  8194
  8195
  8196* EXEC CICS SYNCPOINT
  8197*    END-EXEC.
  8198*    MOVE '6"                    !   #00008175' TO DFHEIV0
  8199     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8201     MOVE X'2020233030303038313735' TO DFHEIV0(25:11)
  8202     CALL 'kxdfhei1' USING DFHEIV0
  8203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8204
  8205
  8206     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 157
* EL689.cbl
  8207*    IF  W-LC-USE-BOTH-CASES
  8208
  8209* EXEC CICS RECEIVE
  8210*            MAP      (W-MAP)
  8211*            MAPSET   (W-MAPSET)
  8212*            INTO     (EL689AI)
  8213*            ASIS
  8214*        END-EXEC
  8215     MOVE LENGTH OF
  8216      EL689AI
  8217       TO DFHEIV11
  8218*    MOVE '8"TAI  L              ''   #00008180' TO DFHEIV0
  8219     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8220     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8221     MOVE X'2020233030303038313830' TO DFHEIV0(25:11)
  8222     CALL 'kxdfhei1' USING DFHEIV0,
  8223           W-MAP,
  8224           EL689AI,
  8225           DFHEIV11,
  8226           W-MAPSET,
  8227           DFHEIV99,
  8228           DFHEIV99
  8229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8230     ELSE
  8231
  8232* EXEC CICS RECEIVE
  8233*            MAP      (W-MAP)
  8234*            MAPSET   (W-MAPSET)
  8235*            INTO     (EL689AI)
  8236*        END-EXEC.
  8237     MOVE LENGTH OF
  8238      EL689AI
  8239       TO DFHEIV11
  8240*    MOVE '8"T I  L              ''   #00008187' TO DFHEIV0
  8241     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8242     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8243     MOVE X'2020233030303038313837' TO DFHEIV0(25:11)
  8244     CALL 'kxdfhei1' USING DFHEIV0,
  8245           W-MAP,
  8246           EL689AI,
  8247           DFHEIV11,
  8248           W-MAPSET,
  8249           DFHEIV99,
  8250           DFHEIV99
  8251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8252
  8253
  8254     IF  NOT DISPLAY-CAP
  8255         MOVE 'READ'             TO SM-READ
  8256         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8257         MOVE ER-9097            TO EMI-ERROR
  8258         MOVE -1                 TO MAINTL
  8259         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8260         GO TO 8100-SEND-INITIAL-MAP.
  8261
  8262     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8263
  8264     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 158
* EL689.cbl
  8265         GO TO 0300-CHECK-PFKEYS.
  8266
  8267     IF  EIBAID NOT EQUAL DFHENTER
  8268         MOVE ER-0004            TO EMI-ERROR
  8269         GO TO 0320-INPUT-ERROR.
  8270
  8271     IF  ENTERPFI NUMERIC
  8272             AND
  8273         ENTERPFI GREATER THAN 0
  8274             AND
  8275         ENTERPFI LESS THAN 25
  8276         MOVE PF-VALUES (ENTERPFI)
  8277                                 TO EIBAID
  8278     ELSE
  8279         MOVE ER-0029            TO EMI-ERROR
  8280         GO TO 0320-INPUT-ERROR.
  8281
  8282 0300-CHECK-PFKEYS.
  8283
  8284     IF  EIBAID EQUAL DFHPF23
  8285         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8286         MOVE ZEROS              TO PI-TOTAL-LINES
  8287                                    PI-CURRENT-LINE
  8288         MOVE EIBAID             TO PI-ENTRY-CD-1
  8289         MOVE W-XCTL-005         TO W-CALL-PGM
  8290         GO TO 9400-XCTL.
  8291
  8292     IF  EIBAID EQUAL DFHPF24
  8293         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8294         MOVE ZEROS              TO PI-TOTAL-LINES
  8295                                    PI-CURRENT-LINE
  8296         MOVE W-XCTL-626         TO W-CALL-PGM
  8297         GO TO 9400-XCTL.
  8298
  8299     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8300                                    W-FORM-CHANGED-IND.
  8301
  8302     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8303             OR
  8304         PI-SHOW-MODE
  8305         NEXT SENTENCE
  8306     ELSE
  8307         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8308                 AND
  8309             FORML NOT EQUAL ZEROS
  8310                 AND
  8311             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8312             MOVE FORMI          TO PI-689-FORM-NUMBER
  8313             MOVE LOW-VALUES     TO EL689AI
  8314                                    PI-1042-WA
  8315                                    PI-689-FOLLOW-UP-DATE
  8316                                    PI-689-PRINT-RESTRICTION
  8317                                    PI-689-RESEND-DATE-1
  8318                                    PI-689-RESEND1-EDIT
  8319                                    PI-689-FOLLOW-UP-DATE
  8320                                    PI-689-FOLLOW-UP-EDIT
  8321                                    PI-689-ERROR-IND
  8322             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 159
* EL689.cbl
  8323                                    PI-689-NUMBER-COPIES
  8324                                    PI-689-NUMBER-LABEL-LINES
  8325                                    PI-689-NUMBER-TEXT-RECORDS
  8326                                    PI-CURRENT-LINE
  8327                                    PI-TEMP-STOR-ITEMS
  8328                                    PI-TOTAL-LINES
  8329                                    PI-UPDATE-SW
  8330             MOVE SPACES         TO PI-689-PRINT-SW
  8331                                    PI-689-ALT-PRINTER-ID
  8332                                    PI-COMM-CONTROL
  8333                                    PI-689-TEMP-STOR-ID
  8334                                    PI-689-USE-SCREEN-IND
  8335                                    PI-689-RESEND-LETR-1
  8336                                    PI-CERT-FORM-ID
  8337                                    PI-CERT-REQ-IND
  8338                                    PI-REASON-REQ-IND
  8339             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8340             MOVE DFHENTER       TO EIBAID
  8341             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8342             GO TO 0330-FUNCTION-CHECK
  8343         ELSE
  8344             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8345                     OR
  8346                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8347                         AND
  8348                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8349                             OR
  8350                         ADDRSI NOT EQUAL LOW-VALUES))
  8351                     OR
  8352                 PI-689-CARRIER NOT EQUAL CARRIERI
  8353                     OR
  8354                 PI-689-GROUPING NOT EQUAL GROUPI
  8355                     OR
  8356                 PI-689-STATE NOT EQUAL STATEI
  8357                     OR
  8358                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8359                     OR
  8360                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8361                     OR
  8362                 PI-689-CERT-SFX NOT EQUAL SFXI
  8363                     OR
  8364                 PI-689-TYPE NOT EQUAL TYPEI
  8365                     OR
  8366                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8367                     OR
  8368                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8369                     OR
  8370                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8371                     OR
  8372                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8373                     OR
  8374                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8375                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8376                 MOVE DFHENTER   TO EIBAID
  8377                 GO TO 0330-FUNCTION-CHECK.
  8378
  8379*    IF  EIBAID EQUAL DFHPF1
  8380*        MOVE +7                 TO W-ROLL-COUNTER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 160
* EL689.cbl
  8381*        GO TO 4000-ROLL-PAGE.
  8382
  8383*    IF  EIBAID EQUAL DFHPF2
  8384*        MOVE -7                 TO W-ROLL-COUNTER
  8385*        GO TO 4000-ROLL-PAGE.
  8386
  8387*    IF  EIBAID EQUAL DFHPF3
  8388*        IF  W-HOLD-ON
  8389*            MOVE ER-7245        TO EMI-ERROR
  8390*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8391*            MOVE -1             TO MAINTL
  8392*            MOVE AL-UABON       TO MAINTA
  8393*            GO TO 8200-SEND-DATAONLY
  8394*        ELSE
  8395*            GO TO 0330-FUNCTION-CHECK.
  8396*    IF (EIBAID = DFHPF8)
  8397*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8398*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8399*       MOVE ER-0029             TO EMI-ERROR
  8400*       GO TO 0320-INPUT-ERROR
  8401*    END-IF
  8402*    IF EIBAID = DFHPF4 OR DFHPF8
  8403*        IF  W-HOLD-ON
  8404*            MOVE ER-7245        TO EMI-ERROR
  8405*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8406*            MOVE -1             TO MAINTL
  8407*            MOVE AL-UABON       TO MAINTA
  8408*            GO TO 8200-SEND-DATAONLY
  8409*        ELSE
  8410*            GO TO 0330-FUNCTION-CHECK.
  8411
  8412*    IF  EIBAID = DFHPF5
  8413*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8414*        GO TO 4000-ROLL-PAGE.
  8415
  8416*    IF  EIBAID = DFHPF6
  8417*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8418*        GO TO 4000-ROLL-PAGE.
  8419
  8420     IF  EIBAID EQUAL DFHPF7
  8421         IF PI-PROMPT-IND EQUAL 'Y'
  8422             MOVE ER-0894        TO EMI-ERROR
  8423             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8424             MOVE -1             TO MAINTL
  8425             MOVE AL-UABON       TO MAINTA
  8426             GO TO 8200-SEND-DATAONLY
  8427         END-IF
  8428     END-IF.
  8429
  8430     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8431         IF  W-HOLD-ON
  8432             MOVE ER-7245        TO EMI-ERROR
  8433             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8434             MOVE -1             TO MAINTL
  8435             MOVE AL-UABON       TO MAINTA
  8436             GO TO 8200-SEND-DATAONLY
  8437         ELSE
  8438             GO TO 0330-FUNCTION-CHECK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 161
* EL689.cbl
  8439
  8440     IF  EIBAID EQUAL DFHENTER
  8441         GO TO 0330-FUNCTION-CHECK.
  8442
  8443     MOVE ER-0029                TO EMI-ERROR.
  8444
  8445 0320-INPUT-ERROR.
  8446
  8447     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8448
  8449     IF  ENTERPFL EQUAL 0
  8450         MOVE -1                 TO MAINTL
  8451         MOVE AL-UABON           TO MAINTA
  8452     ELSE
  8453         MOVE AL-UNBON           TO ENTERPFA
  8454         MOVE -1                 TO ENTERPFL.
  8455
  8456     GO TO 8200-SEND-DATAONLY.
  8457
  8458 0325-MAPFAIL.
  8459***********************************************************
  8460*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  8461*      LETTERS ON A 3275 PRINTER.                         *
  8462***********************************************************
  8463
  8464     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8465
  8466     SET W-RG-NDX                TO PI-CURRENT-LINE.
  8467     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8468             VARYING
  8469         W-SC-NDX FROM 1 BY 1
  8470             UNTIL
  8471         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  8472
  8473     MOVE -1                     TO MAINTL.
  8474     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 162
* EL689.cbl
  8476 0330-FUNCTION-CHECK.
  8477
  8478     IF  MAINTI EQUAL 'S'
  8479*        IF EIBAID = DFHPF4 OR DFHPF8
  8480*            GO TO 7900-PRINT-LETTER-NOW
  8481*        ELSE
  8482             GO TO 1000-SHOW.
  8483
  8484     IF  NOT MODIFY-CAP
  8485         MOVE 'UPDATE'           TO SM-READ
  8486         PERFORM 9995-SECURITY-VIOLATION
  8487         MOVE ER-0070            TO EMI-ERROR
  8488         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8489         MOVE -1                 TO MAINTL
  8490         GO TO 8100-SEND-INITIAL-MAP.
  8491
  8492     IF  W-FORM-CHANGED
  8493             OR
  8494         W-KEY-FIELDS-CHANGED
  8495         GO TO 0330-EDIT.
  8496
  8497     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8498
  8499
  8500*    IF  EIBAID EQUAL DFHPF3
  8501*        IF  PI-NO-CARRIER-SECURITY
  8502*                AND
  8503*            PI-NO-ACCOUNT-SECURITY
  8504*            GO TO 5000-EDIT-MODE.
  8505
  8506     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8507         IF  PI-NO-CARRIER-SECURITY
  8508                 AND
  8509             PI-NO-ACCOUNT-SECURITY
  8510             GO TO 5400-LETTER-RELEASE
  8511         ELSE
  8512             IF  PI-689-PRINT-PERFORMED
  8513                 GO TO 5400-LETTER-RELEASE
  8514             ELSE
  8515                 MOVE AL-UNBON TO ENTERPFA
  8516                 MOVE -1       TO ENTERPFL
  8517                 MOVE ER-2398  TO EMI-ERROR
  8518                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8519                 GO TO 8200-SEND-DATAONLY.
  8520
  8521*    IF  EIBAID = DFHPF4 OR DFHPF8
  8522*        GO TO 7900-PRINT-LETTER-NOW.
  8523
  8524 0330-EDIT.
  8525
  8526     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8527             OR
  8528         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8529             OR
  8530         W-SC-TEXTL (3) NOT EQUAL ZEROS
  8531             OR
  8532         W-SC-TEXTL (4) NOT EQUAL ZEROS
  8533             OR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 163
* EL689.cbl
  8534         W-SC-TEXTL (5) NOT EQUAL ZEROS
  8535             OR
  8536         W-SC-TEXTL (6) NOT EQUAL ZEROS
  8537             OR
  8538         W-SC-TEXTL (7) NOT EQUAL ZEROS
  8539             OR
  8540         W-SC-TEXTL (8) NOT EQUAL ZEROS
  8541             OR
  8542         W-SC-TEXTL (9) NOT EQUAL ZEROS
  8543             OR
  8544         W-SC-TEXTL (10) NOT EQUAL ZEROS
  8545             OR
  8546         W-SC-TEXTL (11) NOT EQUAL ZEROS
  8547         IF  W-KEY-FIELDS-CHANGED
  8548                 OR
  8549             W-FORM-CHANGED
  8550             MOVE ER-7250        TO EMI-ERROR
  8551             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8552             MOVE -1             TO MAINTL
  8553             MOVE AL-UABON       TO MAINTA
  8554         ELSE
  8555             PERFORM 4100-SET-NDX THRU 4100-EXIT
  8556             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  8557                     VARYING
  8558                 W-SC-NDX FROM 1 BY 1
  8559                     UNTIL
  8560                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  8561             MOVE ER-7398        TO EMI-ERROR
  8562             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8563             MOVE -1             TO MAINTL
  8564             MOVE AL-UABON       TO MAINTA
  8565             GO TO 8200-SEND-DATAONLY.
  8566
  8567     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8568
  8569     IF  W-KEY-FIELDS-CHANGED
  8570             OR
  8571         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8572         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8573         IF  MAINTI EQUAL 'C'
  8574             GO TO 2000-CREATE
  8575         ELSE
  8576             NEXT SENTENCE
  8577     ELSE
  8578         IF  W-FORM-CHANGED
  8579             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8580             IF  MAINTI EQUAL 'C'
  8581                 GO TO 2000-CREATE
  8582             ELSE
  8583                 NEXT SENTENCE
  8584         ELSE
  8585             MOVE -1             TO MAINTL
  8586             GO TO 8200-SEND-DATAONLY.
  8587
  8588     MOVE ER-0023                TO EMI-ERROR.
  8589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8590     MOVE -1                     TO MAINTL.
  8591     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 164
* EL689.cbl
  8592     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 165
* EL689.cbl
  8594 0350-EDIT-ROUTINE.
  8595
  8596     IF  MAINTI EQUAL 'C'
  8597             AND
  8598         FORML EQUAL ZEROS
  8599         MOVE -1                 TO FORML
  8600         MOVE ER-0177            TO EMI-ERROR
  8601         MOVE AL-UABON           TO FORMA
  8602         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8603
  8604     IF PRTNOWL > ZEROS
  8605        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  8606           MOVE PRTNOWI          TO PI-PRINT-NOW
  8607           MOVE AL-UANON         TO PRTNOWA
  8608        END-IF
  8609     END-IF
  8610     IF ENDARCHL > ZEROS
  8611        IF ENDARCHI NUMERIC
  8612            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  8613            MOVE AL-UNNON       TO ENDARCHA
  8614            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  8615            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  8616            MOVE 'N'            TO W-VALID-ENDT-SW
  8617            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  8618            IF NOT W-VALID-ENDT
  8619                MOVE -1         TO ENDARCHL
  8620                MOVE ER-1565    TO EMI-ERROR
  8621                MOVE AL-UNBON   TO ENDARCHA
  8622                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8623            END-IF
  8624        END-IF
  8625     ELSE
  8626        MOVE ZEROS              TO PI-ENDT-ARCH-NO
  8627     END-IF
  8628     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  8629*    IF  PRTRESTL NOT EQUAL ZEROS
  8630*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  8631
  8632     IF  FOLLOWL NOT EQUAL ZEROS
  8633         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  8634         PERFORM 8600-DEEDIT
  8635         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8636         MOVE '4'                TO DC-OPTION-CODE
  8637         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8638         IF  DATE-CONVERSION-ERROR
  8639             MOVE ER-0182        TO EMI-ERROR
  8640             MOVE -1             TO FOLLOWL
  8641             MOVE AL-UABON       TO FOLLOWA
  8642             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8643         ELSE
  8644             MOVE DC-GREG-DATE-1-EDIT
  8645                                 TO FOLLOWO
  8646                                    PI-689-FOLLOW-UP-EDIT
  8647             MOVE AL-UANON       TO FOLLOWA
  8648             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  8649     ELSE
  8650         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  8651
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 166
* EL689.cbl
  8652     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  8653         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  8654                 W-SAVE-BIN-DATE
  8655             MOVE ER-0533        TO EMI-ERROR
  8656             MOVE AL-UABON       TO FOLLOWA
  8657             MOVE -1             TO FOLLOWL
  8658             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8659
  8660     IF  RESEND1L NOT EQUAL ZEROS
  8661         MOVE RESEND1I           TO W-DEEDIT-FIELD
  8662         PERFORM 8600-DEEDIT
  8663         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8664         MOVE '4'                TO DC-OPTION-CODE
  8665         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8666         IF  DATE-CONVERSION-ERROR
  8667             MOVE ER-0185        TO EMI-ERROR
  8668             MOVE -1             TO RESEND1L
  8669             MOVE AL-UABON       TO RESEND1A
  8670             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8671         ELSE
  8672             MOVE DC-GREG-DATE-1-EDIT
  8673                                 TO RESEND1O
  8674                                    PI-689-RESEND1-EDIT
  8675             MOVE AL-UANON       TO RESEND1A
  8676             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  8677     ELSE
  8678         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  8679
  8680     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  8681         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  8682                 W-SAVE-BIN-DATE
  8683             MOVE ER-0537        TO EMI-ERROR
  8684             MOVE AL-UABON       TO RESEND1A
  8685             MOVE -1             TO RESEND1L
  8686             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8687
  8688     IF ENCL > ZEROS
  8689        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  8690                                          PI-ENCLOSURE-CD
  8691        IF ENCI  = 'A'   OR
  8692                   'C'   OR
  8693                   'CLM' OR
  8694                   'E'   OR
  8695                   'ENV' OR
  8696                   '0'
  8697              OR 'RE'
  8698              OR '1' OR '2' OR '3' OR 'B' OR 'D'
  8699           MOVE ENCI             TO PI-ENCLOSURE-CD
  8700                                    W-ENCLOSURE-CD
  8701           MOVE AL-UANON         TO ENCA
  8702        ELSE
  8703           MOVE ER-1560          TO EMI-ERROR
  8704           MOVE -1               TO ENCL
  8705           MOVE AL-UABON         TO ENCA
  8706           PERFORM 9900-ERROR-FORMAT
  8707                                 THRU 9900-EXIT
  8708        END-IF
  8709     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 167
* EL689.cbl
  8710
  8711
  8712     IF NOT PI-CREATE-LABELS
  8713         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  8714         MOVE AL-PANON           TO ADDRLBLA
  8715         GO TO 0350-BYPASS-OVERRIDE.
  8716
  8717     IF  ADDRLBLL GREATER THAN ZEROS
  8718          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8719          IF ADDRLBLI = 'N' OR 'Y'
  8720              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  8721              MOVE AL-UANON      TO ADDRLBLA
  8722          ELSE
  8723             MOVE ER-3783        TO EMI-ERROR
  8724             MOVE -1             TO ADDRLBLL
  8725             MOVE AL-UABON       TO ADDRLBLA
  8726             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8727
  8728 0350-BYPASS-OVERRIDE.
  8729
  8730     IF  PI-BYPASS-LABELS
  8731             OR
  8732         FORMI EQUAL '9999'
  8733             OR
  8734         PI-689-LABELS-OVERRIDEN
  8735         MOVE SPACES             TO PI-689-LABEL-SOURCE
  8736         MOVE LOW-VALUES         TO ADDRSI
  8737         MOVE AL-UANOF           TO ADDRSA
  8738         MOVE ZEROS              TO ADDRSL
  8739     ELSE
  8740         IF  ADDRSL GREATER THAN ZEROS
  8741             MOVE ADDRSI         TO W-LABEL-SOURCE
  8742             IF  W-LABEL-SOURCE-VALID
  8743                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  8744             ELSE
  8745                 MOVE -1         TO ADDRSL
  8746                 MOVE ER-0176    TO EMI-ERROR
  8747                 MOVE AL-UABON   TO ADDRSA
  8748                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8749         ELSE
  8750             IF  MAINTI EQUAL 'C'
  8751                 MOVE -1         TO ADDRSL
  8752                 MOVE ER-0176    TO EMI-ERROR
  8753                 MOVE AL-UABON   TO ADDRSA
  8754                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8755
  8756     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  8757     IF  PRINTERL GREATER ZERO
  8758         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8759         MOVE AL-UANON           TO PRINTERA
  8760         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  8761                                    PI-ALT-DMD-PRT-ID
  8762     ELSE
  8763         IF  PI-NO-CARRIER-SECURITY
  8764                 AND
  8765             PI-NO-ACCOUNT-SECURITY
  8766             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  8767                 MOVE PI-PROCESSOR-PRINTER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 168
* EL689.cbl
  8768                                 TO PI-689-ALT-PRINTER-ID
  8769                                    PRINTERI
  8770                 MOVE AL-UABON   TO PRINTERA
  8771             ELSE
  8772                 MOVE PI-COMPANY-ID
  8773                                 TO W-CNTL-COMPANY-ID
  8774                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  8775                 MOVE SPACES     TO W-CNTL-GENL
  8776                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  8777
  8778* EXEC CICS HANDLE CONDITION
  8779*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  8780*                     NOTFND     (7945-NOT-FOUND)
  8781*                END-EXEC
  8782*    MOVE '"$JI                  ! $ #00008716' TO DFHEIV0
  8783     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8785     MOVE X'2420233030303038373136' TO DFHEIV0(25:11)
  8786     CALL 'kxdfhei1' USING DFHEIV0
  8787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8788
  8789* EXEC CICS READ
  8790*                     DATASET    (W-CNTL-FILE-ID)
  8791*                     SET        (ADDRESS OF CONTROL-FILE)
  8792*                     RIDFLD     (W-CNTL-KEY)
  8793*                END-EXEC
  8794*    MOVE '&"S        E          (   #00008720' TO DFHEIV0
  8795     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8797     MOVE X'2020233030303038373230' TO DFHEIV0(25:11)
  8798     CALL 'kxdfhei1' USING DFHEIV0,
  8799           W-CNTL-FILE-ID,
  8800           DFHEIV20,
  8801           DFHEIV99,
  8802           W-CNTL-KEY,
  8803           DFHEIV99,
  8804           DFHEIV99,
  8805           DFHEIV99
  8806     SET ADDRESS OF CONTROL-FILE TO
  8807         DFHEIV20
  8808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8809                 MOVE CF-FORMS-PRINTER-ID
  8810                                 TO PI-689-ALT-PRINTER-ID
  8811                                    PRINTERI
  8812                                    W-TS-TERM-TEXT
  8813                 MOVE AL-UABON   TO PRINTERA
  8814         ELSE
  8815             MOVE AL-UABON       TO PRINTERA
  8816             MOVE -1             TO PRINTERL
  8817             MOVE ER-9283        TO EMI-ERROR
  8818             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8819
  8820     IF  COPIESL NOT EQUAL ZEROS
  8821         IF  COPIESI NOT NUMERIC
  8822                 OR
  8823             COPIESI EQUAL '0'
  8824             MOVE ER-0184        TO EMI-ERROR
  8825             MOVE -1             TO COPIESL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 169
* EL689.cbl
  8826             MOVE AL-UABON       TO COPIESA
  8827             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8828         ELSE
  8829             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  8830             MOVE AL-UANON       TO COPIESA
  8831     ELSE
  8832         IF FORMI EQUAL '9999'
  8833             MOVE 1              TO PI-689-NUMBER-COPIES
  8834                                    COPIESL
  8835                                    COPIESO.
  8836
  8837     IF  FORML NOT EQUAL ZEROS
  8838         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8839         MOVE FORMI              TO PI-689-FORM-NUMBER.
  8840
  8841     MOVE SPACES                 TO W-HOLD-IND.
  8842
  8843     IF PI-CERT-REQ-IND = 'Y'
  8844       IF  CERTIDL NOT EQUAL ZEROS
  8845         IF CERTIDI NUMERIC
  8846             MOVE AL-UANON      TO CERTIDA
  8847             MOVE CERTIDI       TO PI-CERT-FORM-ID
  8848         ELSE
  8849             MOVE ER-1778       TO EMI-ERROR
  8850             MOVE -1            TO CERTIDL
  8851             MOVE AL-UABON      TO CERTIDA
  8852             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8853         END-IF
  8854       ELSE
  8855          MOVE ER-0715       TO EMI-ERROR
  8856          MOVE -1            TO CERTIDL
  8857          MOVE AL-UABON      TO CERTIDA
  8858          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8859       END-IF
  8860     END-IF.
  8861
  8862     IF PI-REASON-REQ-IND = 'Y'
  8863        IF PI-ENDT-ARCH-NO NOT > ZERO
  8864          MOVE ER-9840       TO EMI-ERROR
  8865          MOVE -1            TO FORML
  8866          MOVE AL-UABON      TO FORMA
  8867          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8868        END-IF
  8869     END-IF.
  8870
  8871     IF  NOT EMI-NO-ERRORS
  8872         IF  EMI-ERROR EQUAL ER-7250
  8873             GO TO 0350-EXIT
  8874         ELSE
  8875            MOVE -1             TO MAINTL
  8876            GO TO 8200-SEND-DATAONLY.
  8877
  8878 0350-EXIT.
  8879      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 170
* EL689.cbl
  8881 0355-CHECK-ERENDT.
  8882
  8883*     EXEC CICS GETMAIN
  8884*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  8885*          LENGTH   (W-ENDT-LENGTH)
  8886*     END-EXEC
  8887
  8888
  8889* EXEC CICS READ
  8890*         DATASET    ('ERENDT2')
  8891*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  8892*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  8893*         RESP       (W-RESPONSE)
  8894*    END-EXEC
  8895     MOVE 'ERENDT2' TO DFHEIV1
  8896*    MOVE '&"S        E          (  N#00008804' TO DFHEIV0
  8897     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8899     MOVE X'204E233030303038383034' TO DFHEIV0(25:11)
  8900     CALL 'kxdfhei1' USING DFHEIV0,
  8901           DFHEIV1,
  8902           DFHEIV20,
  8903           DFHEIV99,
  8904           W-ERENDT-KEY-BY-ARCH,
  8905           DFHEIV99,
  8906           DFHEIV99,
  8907           DFHEIV99
  8908     SET ADDRESS OF ENDORSEMENT-RECORD TO
  8909         DFHEIV20
  8910     MOVE EIBRESP  TO W-RESPONSE
  8911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8912
  8913     IF (RESP-NORMAL)
  8914         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  8915            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  8916            EN-CARRIER     =  PI-689-CARRIER     AND
  8917            EN-GROUPING    =  PI-689-GROUPING    AND
  8918            EN-STATE       =  PI-689-STATE       AND
  8919            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  8920            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  8921            EN-CERT-NO     =  PI-689-CERT-NO
  8922               SET W-VALID-ENDT TO TRUE
  8923         END-IF
  8924         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  8925            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  8926            EN-CARRIER     =  PI-CARRIER         AND
  8927            EN-GROUPING    =  PI-GROUPING        AND
  8928            EN-STATE       =  PI-STATE           AND
  8929            EN-ACCOUNT     =  PI-ACCOUNT         AND
  8930            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  8931            EN-CERT-NO     =  PI-CERT-NO
  8932               SET W-VALID-ENDT TO TRUE
  8933         END-IF
  8934     END-IF
  8935      .
  8936
  8937 0355-EXIT.
  8938      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 171
* EL689.cbl
  8940 0360-EDIT-PRINT-RESTRICTIONS.
  8941
  8942*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  8943*                                TO W-UPPER-CASE.
  8944*
  8945*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  8946*                                     OR 'P' OR LOW-VALUES)
  8947*            AND
  8948*        PRTRESTI EQUAL 'C'
  8949*            AND
  8950*        PI-689-CONTROL NOT GREATER THAN ZEROS
  8951*        MOVE ER-7243            TO EMI-ERROR
  8952*        MOVE -1                 TO PRTRESTL
  8953*        MOVE AL-UABON           TO PRTRESTA
  8954*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8955*        GO TO 0360-EXIT.
  8956*
  8957*    IF  PRTRESTL NOT EQUAL ZEROS
  8958*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  8959*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  8960*            MOVE AL-UANON       TO PRTRESTA
  8961*        ELSE
  8962*            IF  PRTRESTI EQUAL ' '
  8963*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  8964*                MOVE AL-UANON   TO PRTRESTA
  8965*            ELSE
  8966*                MOVE ER-7393    TO EMI-ERROR
  8967*                MOVE -1         TO PRTRESTL
  8968*                MOVE AL-UABON   TO PRTRESTA
  8969*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8970*
  8971*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  8972*            AND
  8973*        W-HOLD-ON
  8974*            AND
  8975*        PI-689-CONTROL NOT GREATER THAN ZEROS
  8976*        MOVE ER-7243            TO EMI-ERROR
  8977*        MOVE -1                 TO PRTRESTL
  8978*        MOVE AL-UABON           TO PRTRESTA
  8979*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8980     .
  8981 0360-EXIT.
  8982      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 172
* EL689.cbl
  8984 0400-EL6311-INCOMING.
  8985
  8986     MOVE ZEROS                  TO PI-CURRENT-LINE
  8987                                    PI-TEMP-STOR-ITEMS
  8988                                    PI-TOTAL-LINES
  8989                                    PI-UPDATE-SW
  8990                                    PI-689-NUMBER-LABEL-LINES
  8991                                    PI-689-ERROR
  8992                                    PI-689-NUMBER-TEXT-RECORDS.
  8993     MOVE SPACES                 TO PI-689-PRINT-SW
  8994                                    PI-689-ALT-PRINTER-ID
  8995                                    PI-COMM-CONTROL
  8996                                    PI-689-FORM-NUMBER
  8997                                    PI-689-TEMP-STOR-ID
  8998                                    PI-689-LABEL-SOURCE
  8999                                    PI-689-USE-SCREEN-IND.
  9000
  9001     IF PI-CREATE-LABELS
  9002         MOVE  AL-UANON          TO ADDRLBLA
  9003         MOVE  +1                TO ADDRLBLL.
  9004
  9005     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9006                                    PI-689-LBL-OVERRIDE.
  9007
  9008     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9009     MOVE '2'                    TO PI-ACTION.
  9010     MOVE -1                     TO MAINTL.
  9011
  9012     MOVE AL-UANON               TO PRTNOWA.
  9013     MOVE +1                     TO PRTNOWL.
  9014     MOVE 'N'                    TO PRTNOWI
  9015                                    PI-PRINT-NOW.
  9016
  9017     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  9018         MOVE AL-UANON           TO CARRIERA
  9019         MOVE +1                 TO CARRIERL
  9020         MOVE PI-689-CARRIER     TO CARRIERI.
  9021
  9022     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  9023         MOVE +6                 TO GROUPL
  9024         MOVE AL-UANON           TO GROUPA
  9025         MOVE PI-689-GROUPING    TO GROUPI.
  9026
  9027     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9028         MOVE +2                 TO STATEL
  9029         MOVE AL-UANON           TO STATEA
  9030         MOVE PI-689-STATE       TO STATEI.
  9031
  9032     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9033         MOVE +10                TO ACCTL
  9034         MOVE AL-UANON           TO ACCTA
  9035         MOVE PI-689-ACCOUNT     TO ACCTI.
  9036
  9037     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9038         MOVE +10                TO CERTL
  9039         MOVE AL-UANON           TO CERTA
  9040         MOVE PI-689-CERT-PRIME  TO CERTI.
  9041
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 173
* EL689.cbl
  9042     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9043         MOVE +1                 TO SFXL
  9044         MOVE AL-UANON           TO SFXA
  9045         MOVE PI-689-CERT-SFX    TO SFXI.
  9046
  9047     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9048         MOVE +6                 TO BENTRYL
  9049         MOVE AL-UANON           TO BENTRYA
  9050         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9051
  9052     MOVE +4                     TO BCSEQL.
  9053     MOVE AL-UANON               TO BCSEQA.
  9054     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9055
  9056     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9057         MOVE +8                 TO SEQL
  9058         MOVE AL-UANON           TO SEQA
  9059         MOVE PI-689-SEQ-NO      TO SEQI.
  9060
  9061     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9062         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9063         MOVE ' '                TO DC-OPTION-CODE
  9064         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9065         MOVE +8                 TO DATEL
  9066         MOVE DC-GREG-DATE-1-EDIT
  9067                                 TO DATEI
  9068         MOVE AL-UANON           TO DATEA.
  9069
  9070     MOVE -1                     TO MAINTL.
  9071     MOVE '4'                    TO DATASORI
  9072                                    PI-689-DATA-SOURCE.
  9073     MOVE +1                     TO DATASORL.
  9074     MOVE AL-UANON               TO DATASORA.
  9075
  9076     GO TO 8100-SEND-INITIAL-MAP.
  9077
  9078 0400-EXIT.
  9079      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 174
* EL689.cbl
  9081 0450-SPECIAL-INPUT-PROCESS.
  9082
  9083     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9084             AND
  9085         PI-CARRIER GREATER THAN LOW-VALUES
  9086         MOVE '1'                TO DATASORI
  9087                                    PI-689-DATA-SOURCE
  9088         MOVE PI-CARRIER         TO CARRIERI
  9089         MOVE PI-GROUPING        TO GROUPI
  9090         MOVE PI-STATE           TO STATEI
  9091         MOVE PI-ACCOUNT         TO ACCTI
  9092         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9093         MOVE ' '                TO DC-OPTION-CODE
  9094         PERFORM 9500-LINK-DATE-CONVERT
  9095             THRU 9500-EXIT
  9096         MOVE DC-GREG-DATE-1-EDIT
  9097                                 TO DATEI
  9098         MOVE 'N'                TO PRTNOWI
  9099                                    PI-PRINT-NOW
  9100         MOVE AL-UANON           TO ACCTA
  9101                                    CARRIERA
  9102                                    DATEA
  9103                                    DATASORA
  9104                                    GROUPA
  9105                                    STATEA
  9106                                    PRTNOWA
  9107         MOVE +1                 TO CARRIERL
  9108                                    DATASORL
  9109                                    PRTNOWL
  9110         MOVE -1                 TO MAINTL
  9111         MOVE +6                 TO GROUPL
  9112         MOVE +2                 TO STATEL
  9113         MOVE +8                 TO DATEL
  9114         MOVE +10                TO ACCTL
  9115     ELSE
  9116         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9117                 AND
  9118             PI-CARRIER GREATER THAN LOW-VALUES
  9119             MOVE '3'            TO DATASORI
  9120                                    PI-689-DATA-SOURCE
  9121             MOVE PI-CR-CARRIER  TO CARRIERI
  9122             MOVE PI-CR-GROUPING TO GROUPI
  9123             MOVE PI-CR-ACCOUNT  TO ACCTI
  9124             MOVE PI-CR-FIN-RESP TO RPERSONI
  9125             MOVE PI-CR-TYPE     TO TYPEI
  9126             MOVE 'N'            TO PRTNOWI
  9127                                    PI-PRINT-NOW
  9128             MOVE AL-UANON       TO CARRIERA
  9129                                    GROUPA
  9130                                    ACCTA
  9131                                    DATASORA
  9132                                    RPERSONA
  9133                                    TYPEA
  9134                                    PRTNOWA
  9135             MOVE +1             TO CARRIERL
  9136                                    DATASORL
  9137                                    TYPEL
  9138                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 175
* EL689.cbl
  9139             MOVE -1             TO MAINTL
  9140             MOVE +6             TO GROUPL
  9141             MOVE +10            TO ACCTL
  9142                                    RPERSONL
  9143         ELSE
  9144             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9145                     AND
  9146                 PI-CARRIER GREATER THAN LOW-VALUES
  9147                 MOVE '2'        TO DATASORI
  9148                                    PI-689-DATA-SOURCE
  9149                 MOVE PI-CARRIER TO CARRIERI
  9150                 MOVE PI-GROUPING
  9151                                 TO GROUPI
  9152                 MOVE PI-STATE   TO STATEI
  9153                 MOVE PI-ACCOUNT TO ACCTI
  9154                 MOVE PI-CERT-PRIME
  9155                                 TO CERTI
  9156                 MOVE PI-CERT-SFX
  9157                                 TO SFXI
  9158                 MOVE PI-CERT-EFF-DT
  9159                                 TO DC-BIN-DATE-1
  9160                 MOVE ' '        TO DC-OPTION-CODE
  9161                 PERFORM 9500-LINK-DATE-CONVERT
  9162                     THRU 9500-EXIT
  9163                 MOVE DC-GREG-DATE-1-EDIT
  9164                                 TO DATEI
  9165                 MOVE 'N'        TO PRTNOWI
  9166                                    PI-PRINT-NOW
  9167                 MOVE AL-UANON   TO CARRIERA
  9168                                    GROUPA
  9169                                    STATEA
  9170                                    ACCTA
  9171                                    CERTA
  9172                                    SFXA
  9173                                    DATEA
  9174                                    ADDRSA
  9175                                    DATASORA
  9176                                    PRTNOWA
  9177                 MOVE +1         TO CARRIERL
  9178                                    SFXL
  9179                                    DATASORL
  9180                                    ADDRSL
  9181                                    PRTNOWL
  9182                 MOVE -1         TO MAINTL
  9183                 MOVE +6         TO GROUPL
  9184                 MOVE +2         TO STATEL
  9185                 MOVE +8         TO DATEL
  9186                 MOVE +10        TO ACCTL
  9187                                    CERTL.
  9188
  9189     IF PI-CREATE-LABELS
  9190         MOVE  AL-UANON          TO ADDRLBLA
  9191         MOVE  +1                TO ADDRLBLL.
  9192
  9193     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9194                                    PI-689-LBL-OVERRIDE.
  9195
  9196     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 176
* EL689.cbl
  9197     GO TO 8100-SEND-INITIAL-MAP.
  9198
  9199 0450-EXIT.
  9200      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 177
* EL689.cbl
  9202 0600-BYPASS-SCREEN-CNTL.
  9203***************************************************************
  9204*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9205*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9206*     PERFORMING ANY SCREEN IO.                               *
  9207***************************************************************
  9208
  9209
  9210* EXEC CICS HANDLE CONDITION
  9211*        PGMIDERR (9700-PGMID-ERROR)
  9212*        MAPFAIL  (0325-MAPFAIL)
  9213*        ERROR    (9800-ABEND)
  9214*    END-EXEC.
  9215*    MOVE '"$L?.                 ! % #00009107' TO DFHEIV0
  9216     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9218     MOVE X'2520233030303039313037' TO DFHEIV0(25:11)
  9219     CALL 'kxdfhei1' USING DFHEIV0
  9220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9221
  9222
  9223     MOVE LOW-VALUES             TO EL689AI.
  9224
  9225     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9226
  9227     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9228     MOVE +4                     TO FORML.
  9229
  9230     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9231         MOVE PI-689-NUMBER-COPIES
  9232                                 TO COPIESI
  9233         MOVE +1                 TO COPIESL.
  9234
  9235     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9236     MOVE +1                     TO ADDRSL.
  9237     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9238     MOVE +1                     TO DATASORL.
  9239
  9240*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9241*        MOVE PI-689-PRINT-RESTRICTION
  9242*                                TO PRTRESTI
  9243*        MOVE +1                 TO PRTRESTL.
  9244
  9245     MOVE SPACES                 TO PI-689-PRINT-SW
  9246                                    PI-689-LBL-OVERRIDE.
  9247     MOVE ZEROS                  TO PI-TOTAL-LINES
  9248                                    PI-CURRENT-LINE
  9249                                    PI-TEMP-STOR-ITEMS
  9250                                    PI-UPDATE-SW
  9251                                    PI-689-ERROR
  9252                                    PI-689-NUMBER-LABEL-LINES
  9253                                    PI-689-NUMBER-TEXT-RECORDS.
  9254
  9255     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9256         MOVE +4                 TO PRINTERL
  9257         MOVE PI-689-ALT-PRINTER-ID
  9258                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9259
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 178
* EL689.cbl
  9260     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9261
  9262     IF  PI-689-SOURCE-VARIABLE
  9263         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9264
  9265     MOVE SPACES                 TO W-CNTL-KEY
  9266     MOVE LOW-VALUES             TO W-ACCT-KEY
  9267                                    W-CERT-KEY
  9268                                    W-CHEK-KEY
  9269                                    W-COMP-KEY
  9270                                    W-MAIL-KEY
  9271                                    W-PNDB-KEY
  9272                                    W-PNDB2-KEY
  9273                                    W-PYAJ-KEY.
  9274
  9275     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9276     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9277                                    W-CERT-COMPANY-CD
  9278                                    W-CHEK-COMPANY-CD
  9279                                    W-COMP-COMPANY-CD
  9280                                    W-MAIL-COMPANY-CD
  9281                                    W-PNDB-COMPANY-CD
  9282                                    W-PNDB2-COMPANY-CD
  9283                                    W-PYAJ-COMPANY-CD.
  9284
  9285     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9286         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9287                                    W-CERT-CARRIER
  9288                                    W-MAIL-CARRIER
  9289                                    W-CERT-CARRIER
  9290                                    W-COMP-CARRIER
  9291                                    W-CHEK-CARRIER
  9292                                    W-PNDB2-CARRIER
  9293                                    W-PYAJ-CARRIER.
  9294
  9295     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9296         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9297                                    W-CERT-GROUPING
  9298                                    W-CHEK-GROUPING
  9299                                    W-COMP-GROUPING
  9300                                    W-MAIL-GROUPING
  9301                                    W-PNDB2-GROUPING
  9302                                    W-PYAJ-GROUPING.
  9303
  9304     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9305         MOVE PI-689-STATE       TO W-ACCT-STATE
  9306                                    W-CERT-STATE
  9307                                    W-CHEK-STATE
  9308                                    W-MAIL-STATE
  9309                                    W-PNDB2-STATE.
  9310
  9311     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9312         IF PI-689-DATA-SOURCE = '3' OR '6'
  9313             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9314                                    W-PYAJ-ACCOUNT
  9315         ELSE
  9316             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9317                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 179
* EL689.cbl
  9318                                    W-CHEK-ACCOUNT
  9319                                    W-MAIL-ACCOUNT
  9320                                    W-PNDB2-ACCOUNT.
  9321
  9322     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9323         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9324                                    W-CHEK-EFF-DT
  9325                                    W-MAIL-EFF-DT
  9326                                    W-PNDB2-EFF-DT.
  9327
  9328     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9329         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9330                                    W-CHEK-CERT-PRIME
  9331                                    W-MAIL-CERT-PRIME
  9332                                    W-PNDB2-CERT-PRIME
  9333
  9334         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9335             MOVE PI-689-CERT-SFX
  9336                                 TO W-CERT-CERT-SFX
  9337                                    W-CHEK-CERT-SFX
  9338                                    W-MAIL-CERT-SFX
  9339                                    W-PNDB2-CERT-SFX
  9340         ELSE
  9341             MOVE SPACES         TO W-CERT-CERT-SFX
  9342                                    W-CHEK-CERT-SFX
  9343                                    W-MAIL-CERT-SFX
  9344                                    W-PNDB2-CERT-SFX.
  9345
  9346     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9347         IF PI-689-DATA-SOURCE = '3' OR '6'
  9348             MOVE PI-689-RESP-PERSON
  9349                                 TO W-COMP-RESP-PERSON
  9350                                    W-PYAJ-FIN-RESP.
  9351
  9352     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9353         IF PI-689-DATA-SOURCE = '3' OR '6'
  9354             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9355                                    W-PYAJ-RECORD-TYPE
  9356         ELSE
  9357             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9358
  9359     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9360         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9361                                    W-PYAJ-FILE-SEQ-NO
  9362                                    W-CHEK-SEQ-NO.
  9363
  9364     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9365         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9366                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9367
  9368     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9369         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9370
  9371     IF  PI-689-NO-ERRORS-DETECTED
  9372         PERFORM 2000-CREATE THRU 2000-EXIT
  9373         IF  NOT PI-689-FATAL-ERROR
  9374                 AND
  9375             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 180
* EL689.cbl
  9376             IF  PI-689-PRINT-ONLY
  9377                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9378             ELSE
  9379                 IF  PI-689-PRINT-FIRST
  9380                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9381                     IF  NOT PI-689-FATAL-ERROR
  9382                         IF  PI-689-ARCHIVE-LETTER
  9383                             PERFORM 5400-LETTER-RELEASE
  9384                                 THRU 5400-EXIT
  9385                         ELSE
  9386                             MOVE ER-7390
  9387                                 TO PI-689-ERROR
  9388                     ELSE
  9389                         NEXT SENTENCE
  9390                 ELSE
  9391                     IF  NOT PI-689-ARCHIVE-LETTER
  9392                         MOVE ER-7390
  9393                                 TO PI-689-ERROR
  9394                     ELSE
  9395                         PERFORM 5400-LETTER-RELEASE
  9396                             THRU 5400-EXIT
  9397                         IF  NOT PI-689-FATAL-ERROR
  9398                             IF  PI-689-PRINT-SECOND
  9399                                 PERFORM 7900-PRINT-LETTER-NOW
  9400                                     THRU 7900-EXIT.
  9401
  9402 0600-EXIT.
  9403     EXIT.
  9404
  9405 0620-RETURN-TO-CALLER.
  9406
  9407     MOVE PROGRAM-INTERFACE-BLOCK
  9408                                 TO DFHCOMMAREA.
  9409
  9410* EXEC CICS RETURN
  9411*    END-EXEC.
  9412*    MOVE '.(                    ''   #00009299' TO DFHEIV0
  9413     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9414     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9415     MOVE X'2020233030303039323939' TO DFHEIV0(25:11)
  9416     CALL 'kxdfhei1' USING DFHEIV0,
  9417           DFHEIV99,
  9418           DFHEIV99,
  9419           DFHEIV99,
  9420           DFHEIV99,
  9421           DFHEIV99,
  9422           DFHEIV99
  9423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9424
  9425
  9426 0700-GET-VARIABLE-LABEL.
  9427
  9428     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  9429         MOVE '(VARIABLE NOT PROVIDED)'
  9430                                 TO W-RC-TEXT (1)
  9431                                    W-VG-TEXT (48)
  9432         GO TO 0700-EXIT.
  9433
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 181
* EL689.cbl
  9434     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
  9435                                    W-VG-TEXT (48).
  9436     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  9437                                    W-VG-TEXT (49).
  9438     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  9439                                    W-VG-TEXT (50).
  9440     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  9441                                    W-VG-TEXT (51).
  9442     SET W-RG-NDX                TO +5.
  9443
  9444 0700-EXIT.
  9445     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 182
* EL689.cbl
  9447 0800-EDIT-KEY-FIELDS.
  9448***************************************************************
  9449*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  9450*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  9451*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  9452*     PROCESSING.                                             *
  9453***************************************************************
  9454     MOVE SPACES                 TO W-CNTL-KEY
  9455     MOVE LOW-VALUES             TO W-ACCT-KEY
  9456                                    W-CERT-KEY
  9457                                    W-CHEK-KEY
  9458                                    W-COMP-KEY
  9459                                    W-MAIL-KEY
  9460                                    W-PNDB-KEY
  9461                                    W-PNDB2-KEY
  9462                                    W-PYAJ-KEY.
  9463
  9464     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9465     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9466                                    W-CERT-COMPANY-CD
  9467                                    W-CHEK-COMPANY-CD
  9468                                    W-COMP-COMPANY-CD
  9469                                    W-MAIL-COMPANY-CD
  9470                                    W-PNDB-COMPANY-CD
  9471                                    W-PNDB2-COMPANY-CD
  9472                                    W-PYAJ-COMPANY-CD.
  9473
  9474     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  9475     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  9476     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  9477     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  9478     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  9479     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  9480     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  9481     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  9482     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  9483     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  9484     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  9485     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  9486     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  9487     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  9488     PERFORM 0970-EDIT-CSO THRU 0970-EXIT.
  9489
  9490     IF  DATASORI NUMERIC
  9491         MOVE DATASORI           TO W-DATA-SOURCE
  9492                                    PI-689-DATA-SOURCE
  9493         GO TO 0800-SOURCE-ACCOUNT
  9494               0800-SOURCE-CERTIFICATE
  9495               0800-SOURCE-COMPENSATION
  9496               0800-SOURCE-PENDING
  9497               0800-SOURCE-CHEK
  9498               0800-SOURCE-PAYMENTS-ADJS
  9499                                 DEPENDING ON W-DATA-SOURCE.
  9500
  9501     IF  FORMI NOT EQUAL '9999'
  9502         MOVE ER-7365            TO EMI-ERROR
  9503         MOVE -1                 TO MAINTL
  9504         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 183
* EL689.cbl
  9505         GO TO 8200-SEND-DATAONLY
  9506
  9507     ELSE
  9508         GO TO 0800-EXIT.
  9509
  9510 0800-SOURCE-ACCOUNT.
  9511
  9512     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
  9513             OR
  9514         W-ACCT-CARRIER EQUAL LOW-VALUES
  9515             OR
  9516         W-ACCT-GROUPING EQUAL LOW-VALUES
  9517             OR
  9518         W-ACCT-STATE EQUAL LOW-VALUES
  9519             OR
  9520         W-ACCT-ACCOUNT EQUAL LOW-VALUES
  9521             OR
  9522         W-ACCT-EXP-DT EQUAL LOW-VALUES
  9523         MOVE ER-7376            TO EMI-ERROR
  9524         MOVE -1                 TO MAINTL
  9525         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9526
  9527     GO TO 0800-ERROR-TEST.
  9528
  9529 0800-SOURCE-CERTIFICATE.
  9530
  9531     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
  9532             OR
  9533         W-CERT-CARRIER EQUAL LOW-VALUES
  9534             OR
  9535         W-CERT-GROUPING EQUAL LOW-VALUES
  9536             OR
  9537         W-CERT-STATE EQUAL LOW-VALUES
  9538             OR
  9539         W-CERT-ACCOUNT EQUAL LOW-VALUES
  9540             OR
  9541         W-CERT-EFF-DT EQUAL LOW-VALUES
  9542             OR
  9543         W-CERT-CERT-NO EQUAL LOW-VALUES
  9544         MOVE ER-7377            TO EMI-ERROR
  9545         MOVE -1                 TO MAINTL
  9546         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9547
  9548     GO TO 0800-ERROR-TEST.
  9549
  9550 0800-SOURCE-COMPENSATION.
  9551
  9552     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
  9553             OR
  9554         W-COMP-CARRIER EQUAL LOW-VALUES
  9555             OR
  9556         W-COMP-GROUPING EQUAL LOW-VALUES
  9557             OR
  9558         W-COMP-RESP-PERSON EQUAL LOW-VALUES
  9559             OR
  9560         W-COMP-TYPE EQUAL LOW-VALUES
  9561             OR
  9562         (W-COMP-TYPE EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 184
* EL689.cbl
  9563                 AND
  9564             W-COMP-ACCOUNT EQUAL LOW-VALUES)
  9565         MOVE ER-7378            TO EMI-ERROR
  9566         MOVE -1                 TO MAINTL
  9567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9568
  9569     GO TO 0800-ERROR-TEST.
  9570
  9571 0800-SOURCE-PENDING.
  9572
  9573     IF  BENTRYL EQUAL ZEROS
  9574         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
  9575                 OR
  9576             W-PNDB2-CARRIER EQUAL LOW-VALUES
  9577                 OR
  9578             W-PNDB2-GROUPING EQUAL LOW-VALUES
  9579                 OR
  9580             W-PNDB2-STATE EQUAL LOW-VALUES
  9581                 OR
  9582             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
  9583                 OR
  9584             W-PNDB2-EFF-DT EQUAL LOW-VALUES
  9585                 OR
  9586             W-PNDB2-CERT-NO EQUAL LOW-VALUES
  9587                 OR
  9588             W-PNDB2-TYPE EQUAL LOW-VALUES
  9589                 OR
  9590             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
  9591             MOVE ER-7379        TO EMI-ERROR
  9592             MOVE -1             TO MAINTL
  9593             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9594         ELSE
  9595             NEXT SENTENCE
  9596     ELSE
  9597         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
  9598                 OR
  9599             W-PNDB-ENTRY EQUAL LOW-VALUES
  9600                 OR
  9601             W-PNDB-SEQ-NO EQUAL ZEROS
  9602             MOVE ER-7379        TO EMI-ERROR
  9603             MOVE -1             TO MAINTL
  9604             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9605
  9606     GO TO 0800-ERROR-TEST.
  9607
  9608 0800-SOURCE-CHEK.
  9609
  9610     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
  9611             OR
  9612         W-CHEK-CARRIER EQUAL LOW-VALUES
  9613             OR
  9614         W-CHEK-GROUPING EQUAL LOW-VALUES
  9615             OR
  9616         W-CHEK-STATE EQUAL LOW-VALUES
  9617             OR
  9618         W-CHEK-ACCOUNT EQUAL LOW-VALUES
  9619             OR
  9620         W-CHEK-EFF-DT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 185
* EL689.cbl
  9621             OR
  9622         W-CHEK-CERT-NO EQUAL LOW-VALUES
  9623         MOVE ER-7381            TO EMI-ERROR
  9624         MOVE -1                 TO MAINTL
  9625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9626
  9627     GO TO 0800-ERROR-TEST.
  9628
  9629 0800-SOURCE-PAYMENTS-ADJS.
  9630
  9631     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
  9632             OR
  9633         W-PYAJ-CARRIER EQUAL LOW-VALUES
  9634             OR
  9635         W-PYAJ-GROUPING EQUAL LOW-VALUES
  9636             OR
  9637         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
  9638             OR
  9639         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
  9640             OR
  9641         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
  9642         MOVE ER-7396            TO EMI-ERROR
  9643         MOVE -1                 TO MAINTL
  9644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9645
  9646     GO TO 0800-ERROR-TEST.
  9647
  9648 0800-ERROR-TEST.
  9649
  9650     IF  NOT EMI-NO-ERRORS
  9651         IF  EMI-ERROR EQUAL ER-7250
  9652             GO TO 0800-EXIT
  9653         ELSE
  9654             GO TO 8200-SEND-DATAONLY.
  9655
  9656 0800-EXIT.
  9657     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 186
* EL689.cbl
  9659 0900-EDIT-CARRIER.
  9660
  9661     IF  CARRIERL EQUAL ZEROES
  9662         MOVE LOW-VALUES         TO PI-689-CARRIER
  9663                                    W-ACCT-CARRIER
  9664                                    W-CERT-CARRIER
  9665                                    W-COMP-CARRIER
  9666                                    W-CHEK-CARRIER
  9667                                    W-MAIL-CARRIER
  9668                                    W-PNDB2-CARRIER
  9669                                    W-PYAJ-CARRIER
  9670     ELSE
  9671         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
  9672
  9673 0900-EXIT.
  9674     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 187
* EL689.cbl
  9676 0905-EDIT-GROUPING.
  9677
  9678     IF  GROUPL EQUAL ZEROES
  9679         MOVE LOW-VALUES         TO PI-689-GROUPING
  9680                                    W-ACCT-GROUPING
  9681                                    W-CERT-GROUPING
  9682                                    W-CHEK-GROUPING
  9683                                    W-COMP-GROUPING
  9684                                    W-MAIL-GROUPING
  9685                                    W-PNDB2-GROUPING
  9686                                    W-PYAJ-GROUPING
  9687     ELSE
  9688         MOVE AL-UANON           TO GROUPA
  9689         MOVE GROUPI             TO PI-689-GROUPING
  9690                                    W-ACCT-GROUPING
  9691                                    W-CERT-GROUPING
  9692                                    W-CHEK-GROUPING
  9693                                    W-COMP-GROUPING
  9694                                    W-MAIL-GROUPING
  9695                                    W-PNDB2-GROUPING
  9696                                    W-PYAJ-GROUPING.
  9697
  9698 0905-EXIT.
  9699     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 188
* EL689.cbl
  9701 0910-EDIT-STATE.
  9702
  9703     IF  STATEL EQUAL ZEROES
  9704         MOVE LOW-VALUES         TO PI-689-STATE
  9705                                    W-ACCT-STATE
  9706                                    W-CERT-STATE
  9707                                    W-CHEK-STATE
  9708                                    W-MAIL-STATE
  9709                                    W-PNDB2-STATE
  9710     ELSE
  9711         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
  9712
  9713 0910-EXIT.
  9714     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 189
* EL689.cbl
  9716 0915-EDIT-ACCOUNT.
  9717
  9718     IF  ACCTL EQUAL ZEROES
  9719         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9720                                    W-ACCT-ACCOUNT
  9721                                    W-CERT-ACCOUNT
  9722                                    W-CHEK-ACCOUNT
  9723                                    W-COMP-ACCOUNT
  9724                                    W-MAIL-ACCOUNT
  9725                                    W-PNDB2-ACCOUNT
  9726                                    W-PYAJ-ACCOUNT
  9727     ELSE
  9728         MOVE AL-UANON           TO ACCTA
  9729         MOVE ACCTI              TO PI-689-ACCOUNT
  9730                                    W-ACCT-ACCOUNT
  9731                                    W-CERT-ACCOUNT
  9732                                    W-CHEK-ACCOUNT
  9733                                    W-COMP-ACCOUNT
  9734                                    W-MAIL-ACCOUNT
  9735                                    W-PYAJ-ACCOUNT
  9736                                    W-PNDB2-ACCOUNT.
  9737
  9738 0915-EXIT.
  9739     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 190
* EL689.cbl
  9741 0920-EDIT-EXP-DATE.
  9742
  9743     IF  DATEL NOT EQUAL ZEROS
  9744         IF  DATEI EQUAL '99/99/99' OR '999999'
  9745             MOVE '99/99/99'     TO DATEO
  9746                                    PI-689-DATE-EDIT
  9747             MOVE AL-UANON       TO DATEA
  9748             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
  9749                                    W-ACCT-EXP-DT
  9750         ELSE
  9751             MOVE DATEI          TO W-DEEDIT-FIELD
  9752             PERFORM 8600-DEEDIT
  9753             MOVE W-DEEDIT-FIELD-V0
  9754                                 TO DC-GREG-DATE-1-MDY
  9755             MOVE '4'            TO DC-OPTION-CODE
  9756             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9757             IF  DATE-CONVERSION-ERROR
  9758                 MOVE ER-0454    TO EMI-ERROR
  9759                 MOVE -1         TO DATEL
  9760                 MOVE AL-UABON   TO DATEA
  9761                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9762             ELSE
  9763                 MOVE DC-GREG-DATE-1-EDIT
  9764                                 TO DATEO
  9765                                    PI-689-DATE-EDIT
  9766                 MOVE AL-UANON   TO DATEA
  9767                 MOVE DC-BIN-DATE-1
  9768                                 TO PI-689-EXP-DATE
  9769                                    W-ACCT-EXP-DT
  9770     ELSE
  9771         MOVE LOW-VALUES         TO PI-689-EXP-DATE
  9772                                    W-ACCT-EXP-DT
  9773                                    PI-689-DATE-EDIT.
  9774
  9775 0920-EXIT.
  9776     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 191
* EL689.cbl
  9778 0925-EDIT-EFF-DATE.
  9779
  9780     IF  CERTL EQUAL ZERO
  9781             AND
  9782         DATASORI NOT EQUAL '2'
  9783         GO TO 0925-EXIT.
  9784
  9785     IF  DATEL NOT EQUAL ZEROS
  9786         MOVE DATEI              TO W-DEEDIT-FIELD
  9787         PERFORM 8600-DEEDIT
  9788         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9789         MOVE '4'                TO DC-OPTION-CODE
  9790         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9791
  9792         IF  DATE-CONVERSION-ERROR
  9793             MOVE ER-0215        TO EMI-ERROR
  9794             MOVE -1             TO DATEL
  9795             MOVE AL-UABON       TO DATEA
  9796             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9797         ELSE
  9798             MOVE DC-GREG-DATE-1-EDIT
  9799                                 TO DATEO
  9800                                    PI-689-DATE-EDIT
  9801             MOVE AL-UANON       TO DATEA
  9802             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
  9803                                    W-CERT-EFF-DT
  9804                                    W-CHEK-EFF-DT
  9805                                    W-MAIL-EFF-DT
  9806                                    W-PNDB2-EFF-DT
  9807     ELSE
  9808         MOVE LOW-VALUES         TO PI-689-EFF-DATE
  9809                                    W-PNDB2-EFF-DT
  9810                                    W-CHEK-EFF-DT
  9811                                    W-MAIL-EFF-DT
  9812                                    W-CERT-EFF-DT
  9813                                    PI-689-DATE-EDIT.
  9814
  9815 0925-EXIT.
  9816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 192
* EL689.cbl
  9818 0930-EDIT-CERTIFICATE.
  9819
  9820     IF  CERTL EQUAL ZEROES
  9821         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
  9822                                    W-CERT-CERT-PRIME
  9823                                    W-CHEK-CERT-PRIME
  9824                                    W-MAIL-CERT-PRIME
  9825                                    W-PNDB2-CERT-PRIME
  9826                                    PI-689-CERT-SFX
  9827                                    W-CERT-CERT-SFX
  9828                                    W-CHEK-CERT-SFX
  9829                                    W-MAIL-CERT-SFX
  9830                                    W-PNDB2-CERT-SFX
  9831     ELSE
  9832         MOVE AL-UANON           TO CERTA
  9833         MOVE CERTI              TO PI-689-CERT-PRIME
  9834                                    W-CERT-CERT-PRIME
  9835                                    W-CHEK-CERT-PRIME
  9836                                    W-MAIL-CERT-PRIME
  9837                                    W-PNDB2-CERT-PRIME
  9838         IF  SFXL EQUAL ZEROES
  9839                 OR
  9840             SFXI EQUAL LOW-VALUES
  9841             MOVE SPACES         TO PI-689-CERT-SFX
  9842                                    W-CERT-CERT-SFX
  9843                                    W-CHEK-CERT-SFX
  9844                                    W-MAIL-CERT-SFX
  9845                                    W-PNDB2-CERT-SFX
  9846         ELSE
  9847             MOVE AL-UANON       TO SFXA
  9848             MOVE SFXI           TO PI-689-CERT-SFX
  9849                                    W-CERT-CERT-SFX
  9850                                    W-CHEK-CERT-SFX
  9851                                    W-MAIL-CERT-SFX
  9852                                    W-PNDB2-CERT-SFX.
  9853
  9854 0930-EXIT.
  9855     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 193
* EL689.cbl
  9857 0935-EDIT-RESP-PERSON.
  9858
  9859     IF  RPERSONL EQUAL ZEROES
  9860         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
  9861                                    W-COMP-RESP-PERSON
  9862                                    W-PYAJ-FIN-RESP
  9863     ELSE
  9864         MOVE AL-UANON           TO RPERSONA
  9865         MOVE RPERSONI           TO PI-689-RESP-PERSON
  9866                                    W-PYAJ-FIN-RESP
  9867                                    W-COMP-RESP-PERSON.
  9868
  9869 0935-EXIT.
  9870     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 194
* EL689.cbl
  9872 0940-EDIT-ACCOUNT.
  9873
  9874     IF  ACCTL EQUAL ZEROES
  9875         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9876                                    W-COMP-ACCOUNT
  9877                                    W-PYAJ-ACCOUNT
  9878     ELSE
  9879         MOVE AL-UANON           TO ACCTA
  9880         MOVE ACCTI              TO PI-689-ACCOUNT
  9881                                    W-PYAJ-ACCOUNT
  9882                                    W-COMP-ACCOUNT.
  9883
  9884 0940-EXIT.
  9885     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 195
* EL689.cbl
  9887 0945-EDIT-TYPE.
  9888
  9889     IF  TYPEL EQUAL ZEROES
  9890         MOVE LOW-VALUES         TO PI-689-TYPE
  9891                                    W-COMP-TYPE
  9892                                    W-PYAJ-RECORD-TYPE
  9893     ELSE
  9894         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9895         IF TYPEI = 'C' OR 'G' OR 'A'
  9896             MOVE AL-UANON       TO TYPEA
  9897             MOVE TYPEI          TO PI-689-TYPE
  9898                                    W-COMP-TYPE
  9899                                    W-PYAJ-RECORD-TYPE
  9900         ELSE
  9901             MOVE ER-7368        TO EMI-ERROR
  9902             MOVE -1             TO TYPEL
  9903             MOVE AL-UABON       TO TYPEA
  9904             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9905
  9906 0945-EXIT.
  9907     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 196
* EL689.cbl
  9909 0950-EDIT-ENTRY.
  9910
  9911     IF  BENTRYL EQUAL ZEROES
  9912         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
  9913                                    W-PNDB-ENTRY
  9914     ELSE
  9915         MOVE AL-UANON           TO BENTRYA
  9916         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
  9917                                    W-PNDB-ENTRY.
  9918
  9919 0950-EXIT.
  9920     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 197
* EL689.cbl
  9922 0955-EDIT-SEQUENCE.
  9923
  9924     IF  SEQL NOT EQUAL ZEROS
  9925         IF  SEQI NOT NUMERIC
  9926                 OR
  9927             SEQI EQUAL '0'
  9928             MOVE ER-7367        TO EMI-ERROR
  9929             MOVE -1             TO SEQL
  9930             MOVE AL-UABON       TO SEQA
  9931             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9932         ELSE
  9933             MOVE AL-UANON       TO SEQA
  9934             MOVE SEQI           TO PI-689-SEQ-NO
  9935                                    W-CHEK-SEQ-NO
  9936                                    W-PYAJ-FILE-SEQ-NO
  9937                                    W-PNDB-SEQ-NO
  9938                                    PI-689-SEQ-EDIT
  9939     ELSE
  9940         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
  9941
  9942 0955-EXIT.
  9943     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 198
* EL689.cbl
  9945 0960-EDIT-BATCH-SEQ.
  9946
  9947     IF  BCSEQL NOT EQUAL ZEROS
  9948         IF  BCSEQI NOT NUMERIC
  9949             MOVE ER-7368        TO EMI-ERROR
  9950             MOVE -1             TO BCSEQL
  9951             MOVE AL-UABON       TO BCSEQA
  9952             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9953         ELSE
  9954             MOVE AL-UANON       TO BCSEQA
  9955             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
  9956                                    W-PNDB-CHG-SEQ-NO
  9957                                    W-PNDB2-ALT-CHG-SEQ-NO
  9958                                    PI-689-BCSEQ-EDIT
  9959     ELSE
  9960         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
  9961
  9962 0960-EXIT.
  9963     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 199
* EL689.cbl
  9965 0965-EDIT-TYPE.
  9966
  9967     IF  TYPEL EQUAL ZEROES
  9968         MOVE LOW-VALUES         TO PI-689-TYPE
  9969                                    W-PNDB2-TYPE
  9970     ELSE
  9971         IF  DATASORI NOT EQUAL '4'
  9972             GO TO 0965-EXIT
  9973         ELSE
  9974             IF TYPEI = '0' OR '1' OR '2' OR '3'
  9975                 MOVE AL-UANON   TO TYPEA
  9976                 MOVE TYPEI      TO PI-689-TYPE
  9977                                    W-PNDB2-TYPE
  9978             ELSE
  9979                 MOVE ER-7370    TO EMI-ERROR
  9980                 MOVE -1         TO TYPEL
  9981                 MOVE AL-UABON   TO TYPEA
  9982                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9983
  9984 0965-EXIT.
  9985     EXIT.
  9986
  9987 0970-EDIT-CSO.
  9988
  9989     IF ENDARCHL > ZEROS
  9990        IF ENDARCHI NUMERIC
  9991            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  9992            MOVE AL-UNNON       TO ENDARCHA
  9993            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  9994            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  9995            MOVE 'N'            TO W-VALID-ENDT-SW
  9996            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  9997            IF NOT W-VALID-ENDT
  9998                MOVE -1         TO ENDARCHL
  9999                MOVE ER-1565    TO EMI-ERROR
 10000                MOVE AL-UNBON   TO ENDARCHA
 10001                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10002            END-IF
 10003        END-IF
 10004     ELSE
 10005        MOVE ZEROS              TO PI-ENDT-ARCH-NO
 10006     END-IF
 10007
 10008     IF PI-CERT-REQ-IND = 'Y'
 10009       IF  CERTIDL NOT EQUAL ZEROS
 10010         IF CERTIDI NUMERIC
 10011             MOVE AL-UANON      TO CERTIDA
 10012             MOVE CERTIDI       TO PI-CERT-FORM-ID
 10013         ELSE
 10014             MOVE ER-1778       TO EMI-ERROR
 10015             MOVE -1            TO CERTIDL
 10016             MOVE AL-UABON      TO CERTIDA
 10017             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10018         END-IF
 10019       ELSE
 10020          MOVE ER-0715       TO EMI-ERROR
 10021          MOVE -1            TO CERTIDL
 10022          MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 200
* EL689.cbl
 10023          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10024       END-IF
 10025     END-IF.
 10026
 10027 0970-EXIT.
 10028      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 201
* EL689.cbl
 10030 0990-CARRIER-VALIDITY-CHECK.
 10031
 10032     IF  CARRIERI EQUAL SPACES
 10033         GO TO 0990-EXIT.
 10034
 10035     MOVE SPACES                 TO W-CNTL-KEY.
 10036     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10037     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
 10038     MOVE CARRIERI               TO W-CNTL-GEN4.
 10039     MOVE +0                     TO W-CNTL-SEQ-NO.
 10040
 10041
 10042* EXEC CICS HANDLE CONDITION
 10043*        NOTFND  (0990-CARRIER-NOT-FOUND)
 10044*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10045*    END-EXEC.
 10046*    MOVE '"$IJ                  ! & #00009917' TO DFHEIV0
 10047     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10049     MOVE X'2620233030303039393137' TO DFHEIV0(25:11)
 10050     CALL 'kxdfhei1' USING DFHEIV0
 10051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10052
 10053
 10054
 10055* EXEC CICS READ
 10056*        DATASET (W-CNTL-FILE-ID)
 10057*        SET     (ADDRESS OF CONTROL-FILE)
 10058*        RIDFLD  (W-CNTL-KEY)
 10059*    END-EXEC.
 10060*    MOVE '&"S        E          (   #00009922' TO DFHEIV0
 10061     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10062     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10063     MOVE X'2020233030303039393232' TO DFHEIV0(25:11)
 10064     CALL 'kxdfhei1' USING DFHEIV0,
 10065           W-CNTL-FILE-ID,
 10066           DFHEIV20,
 10067           DFHEIV99,
 10068           W-CNTL-KEY,
 10069           DFHEIV99,
 10070           DFHEIV99,
 10071           DFHEIV99
 10072     SET ADDRESS OF CONTROL-FILE TO
 10073         DFHEIV20
 10074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10075
 10076
 10077     IF  PI-NO-CARRIER-SECURITY
 10078             OR
 10079         PI-CARRIER-SECURITY EQUAL CARRIERI
 10080         MOVE AL-UANON           TO CARRIERA
 10081         MOVE CARRIERI           TO PI-689-CARRIER
 10082                                    W-ACCT-CARRIER
 10083                                    W-CERT-CARRIER
 10084                                    W-CHEK-CARRIER
 10085                                    W-COMP-CARRIER
 10086                                    W-MAIL-CARRIER
 10087                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 202
* EL689.cbl
 10088                                    W-PYAJ-CARRIER
 10089     ELSE
 10090         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10091         MOVE ER-9095            TO EMI-ERROR
 10092         MOVE -1                 TO MAINTL
 10093         MOVE AL-UANON           TO MAINTA
 10094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10095
 10096     GO TO 0990-EXIT.
 10097
 10098 0990-CARRIER-NOT-FOUND.
 10099
 10100     MOVE -1                     TO CARRIERL.
 10101     MOVE AL-UABON               TO CARRIERA.
 10102     MOVE ER-2208                TO EMI-ERROR.
 10103     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10104
 10105 0990-EXIT.
 10106     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 203
* EL689.cbl
 10108 0994-STATE-VALIDITY-CHECK.
 10109
 10110     IF  STATEI EQUAL SPACES
 10111         GO TO 0994-EXIT.
 10112
 10113     MOVE SPACES                 TO W-CNTL-KEY.
 10114     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10115     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10116     MOVE STATEI                 TO W-CNTL-GEN1.
 10117     MOVE +0                     TO W-CNTL-SEQ-NO.
 10118
 10119
 10120* EXEC CICS HANDLE CONDITION
 10121*        NOTFND  (0994-STATE-NOT-FOUND)
 10122*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10123*    END-EXEC.
 10124*    MOVE '"$IJ                  ! '' #00009970' TO DFHEIV0
 10125     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10127     MOVE X'2720233030303039393730' TO DFHEIV0(25:11)
 10128     CALL 'kxdfhei1' USING DFHEIV0
 10129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10130
 10131
 10132
 10133* EXEC CICS READ
 10134*        DATASET (W-CNTL-FILE-ID)
 10135*        SET     (ADDRESS OF CONTROL-FILE)
 10136*        RIDFLD  (W-CNTL-KEY)
 10137*    END-EXEC.
 10138*    MOVE '&"S        E          (   #00009975' TO DFHEIV0
 10139     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10140     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10141     MOVE X'2020233030303039393735' TO DFHEIV0(25:11)
 10142     CALL 'kxdfhei1' USING DFHEIV0,
 10143           W-CNTL-FILE-ID,
 10144           DFHEIV20,
 10145           DFHEIV99,
 10146           W-CNTL-KEY,
 10147           DFHEIV99,
 10148           DFHEIV99,
 10149           DFHEIV99
 10150     SET ADDRESS OF CONTROL-FILE TO
 10151         DFHEIV20
 10152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10153
 10154
 10155     MOVE AL-UANON               TO STATEA.
 10156     MOVE STATEI                 TO PI-689-STATE
 10157                                    W-ACCT-STATE
 10158                                    W-CERT-STATE
 10159                                    W-CHEK-STATE
 10160                                    W-MAIL-STATE
 10161                                    W-PNDB2-STATE.
 10162
 10163     GO TO 0994-EXIT.
 10164
 10165 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 204
* EL689.cbl
 10166
 10167     MOVE -1                     TO STATEL.
 10168     MOVE AL-UABON               TO STATEA.
 10169     MOVE ER-2209                TO EMI-ERROR.
 10170     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10171
 10172 0994-EXIT.
 10173     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 205
* EL689.cbl
 10175 1000-SHOW.
 10176***************************************************************
 10177*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10178*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10179*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10180*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10181***************************************************************
 10182
 10183     MOVE SPACES                 TO W-RECORD-TABLE.
 10184
 10185     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10186          MOVE PI-689-LBL-OVERRIDE
 10187                                 TO ADDRLBLI
 10188          MOVE +1                TO ADDRLBLL
 10189          MOVE AL-UANON          TO ADDRLBLA
 10190     ELSE
 10191          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10192          MOVE +1                TO ADDRLBLL
 10193          MOVE AL-UANON          TO ADDRLBLA.
 10194
 10195     IF  ARCHNUML EQUAL ZEROS
 10196         MOVE -1                 TO ARCHNUML
 10197         MOVE AL-UNBON           TO ARCHNUMA
 10198         MOVE ER-0174            TO EMI-ERROR
 10199         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10200         GO TO 8200-SEND-DATAONLY.
 10201
 10202     IF  ARCHNUMI NOT NUMERIC
 10203         MOVE -1                 TO ARCHNUML
 10204         MOVE AL-UNBON           TO ARCHNUMA
 10205         MOVE ER-0175            TO EMI-ERROR
 10206         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10207         GO TO 8200-SEND-DATAONLY.
 10208
 10209     IF  PI-SHOW-MODE
 10210
 10211         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10212             MOVE -1             TO MAINTL
 10213             GO TO 8200-SEND-DATAONLY
 10214         ELSE
 10215             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10216
 10217     MOVE +0                     TO W-ARCH-SEQ-NO
 10218                                    W-ARCT-SEQ-NO.
 10219     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10220                                    W-ARCT-COMPANY-CD.
 10221     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10222                                    W-ARCT-NUMBER
 10223                                    PI-689-ARCHIVE-NUMBER.
 10224     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10225     MOVE '1'                    TO PI-ACTION.
 10226     MOVE SPACES                 TO PI-689-PRINT-SW
 10227                                    PI-689-FORM-NUMBER
 10228                                    W-DELETE-KEY.
 10229     SET W-RG-NDX                TO W-ZEROS.
 10230
 10231
 10232* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 206
* EL689.cbl
 10233*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10234*         NOTFND     (1070-ARCH-NOT-FOUND)
 10235*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10236*    END-EXEC.
 10237*    MOVE '"$JI''                 ! ( #00010057' TO DFHEIV0
 10238     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10239     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10240     MOVE X'2820233030303130303537' TO DFHEIV0(25:11)
 10241     CALL 'kxdfhei1' USING DFHEIV0
 10242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10243
 10244
 10245
 10246* EXEC CICS READ
 10247*        DATASET (W-ARCH-FILE-ID)
 10248*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10249*        RIDFLD  (W-ARCH-KEY)
 10250*    END-EXEC.
 10251*    MOVE '&"S        E          (   #00010063' TO DFHEIV0
 10252     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10254     MOVE X'2020233030303130303633' TO DFHEIV0(25:11)
 10255     CALL 'kxdfhei1' USING DFHEIV0,
 10256           W-ARCH-FILE-ID,
 10257           DFHEIV20,
 10258           DFHEIV99,
 10259           W-ARCH-KEY,
 10260           DFHEIV99,
 10261           DFHEIV99,
 10262           DFHEIV99
 10263     SET ADDRESS OF LETTER-ARCHIVE TO
 10264         DFHEIV20
 10265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10266
 10267
 10268     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10269
 10270*    EXEC CICS HANDLE CONDITION
 10271*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10272*         NOTFND     (1020-ARCT-ENDBR)
 10273*         ENDFILE    (1020-ARCT-ENDBR)
 10274*    END-EXEC.
 10275*
 10276*1005-START-BROWSE.
 10277*
 10278*    EXEC CICS STARTBR
 10279*         DATASET    (W-ARCT-FILE-ID)
 10280*         RIDFLD     (W-ARCT-KEY)
 10281*         GTEQ
 10282*    END-EXEC.
 10283*
 10284*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10285*
 10286*1010-READ-NEXT.
 10287*
 10288*    EXEC CICS READNEXT
 10289*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10290*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 207
* EL689.cbl
 10291*         RIDFLD    (W-ARCT-KEY)
 10292*    END-EXEC.
 10293*
 10294*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10295*        IF  LT-ADDRESS-DATA
 10296*            IF  PI-CREATE-LABELS  AND
 10297*                NOT PI-689-LABELS-OVERRIDEN
 10298*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10299*                        VARYING
 10300*                    LT-NDX FROM 1 BY 1
 10301*                        UNTIL
 10302*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10303*                GO TO 1010-READ-NEXT
 10304*            ELSE
 10305*                MOVE LT-CONTROL-PRIMARY
 10306*                                TO W-DELETE-KEY
 10307*                GO TO 1010-READ-NEXT
 10308*        ELSE
 10309*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10310*                    VARYING
 10311*                LT-NDX FROM 1 BY 1
 10312*                    UNTIL
 10313*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10314*                    OR
 10315*                LT-NDX GREATER THAN +20
 10316*            GO TO 1010-READ-NEXT.
 10317*
 10318*1020-ARCT-ENDBR.
 10319*
 10320*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10321*        EXEC CICS ENDBR
 10322*             DATASET   (W-ARCT-FILE-ID)
 10323*        END-EXEC.
 10324*
 10325*    IF  W-RG-NDX EQUAL ZEROS
 10326*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10327*
 10328*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10329*            AND
 10330*        PI-BYPASS-LABELS
 10331*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10332*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10333*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10334*
 10335*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10336*    MOVE 1                      TO PI-CURRENT-LINE.
 10337*    SET W-RG-NDX                TO +1.
 10338*
 10339*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10340*            VARYING
 10341*        W-SC-NDX FROM 1 BY 1
 10342*            UNTIL
 10343*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10344
 10345     MOVE -1                     TO MAINTL.
 10346     GO TO 8100-SEND-INITIAL-MAP.
 10347
 10348 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 208
* EL689.cbl
 10349     EXIT.
 10350
 10351 1030-TEXT-BUILD.
 10352
 10353     SET W-RG-NDX UP BY 1.
 10354     MOVE LT-SKIP-CONTROL (LT-NDX)
 10355                                 TO W-PRINT-CONTROL.
 10356
 10357     IF  W-PRINT-CONTROL EQUAL 99
 10358         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10359         SET W-RG-NDX UP BY 1
 10360     ELSE
 10361         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10362
 10363     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10364     MOVE LT-SKIP-CONTROL (LT-NDX)
 10365                                 TO W-RC-PC (W-RG-NDX).
 10366     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10367
 10368 1030-EXIT.
 10369     EXIT.
 10370
 10371 1040-FORMAT-HEADER-DATA.
 10372
 10373     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10374     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10375     MOVE LA-CARRIER-A2          TO CARRIERO.
 10376     MOVE LA-CERT-NO-A2          TO CERTO.
 10377     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10378     MOVE LA-DATA-SOURCE         TO DATASORO.
 10379
 10380     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10381         MOVE ZEROES             TO DATEO
 10382
 10383     ELSE
 10384         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10385         MOVE ' '                TO DC-OPTION-CODE
 10386         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10387         MOVE DC-GREG-DATE-1-EDIT
 10388                                 TO DATEO.
 10389
 10390     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10391         MOVE ZEROES             TO FOLLOWO
 10392     ELSE
 10393         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10394         MOVE ' '                TO DC-OPTION-CODE
 10395         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10396         MOVE DC-GREG-DATE-1-EDIT
 10397                                 TO FOLLOWO.
 10398
 10399     MOVE LA-FORM-A3             TO FORMO.
 10400     MOVE LA-GROUPING-A2         TO GROUPO.
 10401     MOVE LA-NO-OF-COPIES        TO COPIESO
 10402                                    PI-689-NUMBER-COPIES.
 10403
 10404*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10405*        MOVE LA-PRINT-RESTRICTION
 10406*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 209
* EL689.cbl
 10407*    ELSE
 10408*        MOVE SPACES             TO PRTRESTO.
 10409
 10410     IF  LA-RESEND-DATE = LOW-VALUES
 10411         MOVE ZEROES             TO RESEND1O
 10412     ELSE
 10413         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10414         MOVE ' '                TO DC-OPTION-CODE
 10415         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10416         MOVE DC-GREG-DATE-1-EDIT
 10417                                 TO RESEND1O.
 10418
 10419     MOVE LA-STATE-A2            TO STATEO.
 10420
 10421     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10422
 10423 1040-EXIT.
 10424     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 210
* EL689.cbl
 10426 1050-MOVE-LABELS.
 10427
 10428     SET W-RG-NDX                TO LT-NDX.
 10429     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 10430     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10431     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10432
 10433 1050-EXIT.
 10434     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 211
* EL689.cbl
 10436 1060-DELETE-ADDRESS-RECORD.
 10437
 10438
 10439* EXEC CICS DELETE
 10440*        DATASET (W-ARCT-FILE-ID)
 10441*        RIDFLD  (W-DELETE-KEY)
 10442*    END-EXEC.
 10443*    MOVE '&(  R                 &   #00010239' TO DFHEIV0
 10444     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 10445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10446     MOVE X'2020233030303130323339' TO DFHEIV0(25:11)
 10447     CALL 'kxdfhei1' USING DFHEIV0,
 10448           W-ARCT-FILE-ID,
 10449           W-DELETE-KEY,
 10450           DFHEIV99,
 10451           DFHEIV99,
 10452           DFHEIV99
 10453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10454
 10455
 10456
 10457* EXEC CICS READ
 10458*        DATASET (W-ARCH-FILE-ID)
 10459*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10460*        RIDFLD  (W-ARCH-KEY)
 10461*        UPDATE
 10462*    END-EXEC.
 10463*    MOVE '&"S        EU         (   #00010244' TO DFHEIV0
 10464     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10465     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10466     MOVE X'2020233030303130323434' TO DFHEIV0(25:11)
 10467     CALL 'kxdfhei1' USING DFHEIV0,
 10468           W-ARCH-FILE-ID,
 10469           DFHEIV20,
 10470           DFHEIV99,
 10471           W-ARCH-KEY,
 10472           DFHEIV99,
 10473           DFHEIV99,
 10474           DFHEIV99
 10475     SET ADDRESS OF LETTER-ARCHIVE TO
 10476         DFHEIV20
 10477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10478
 10479
 10480     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 10481
 10482
 10483* EXEC CICS REWRITE
 10484*         FROM      (LETTER-ARCHIVE)
 10485*         DATASET   (W-ARCH-FILE-ID)
 10486*    END-EXEC.
 10487     MOVE LENGTH OF
 10488      LETTER-ARCHIVE
 10489       TO DFHEIV11
 10490*    MOVE '&& L                  %   #00010253' TO DFHEIV0
 10491     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10492     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10493     MOVE X'2020233030303130323533' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 212
* EL689.cbl
 10494     CALL 'kxdfhei1' USING DFHEIV0,
 10495           W-ARCH-FILE-ID,
 10496           LETTER-ARCHIVE,
 10497           DFHEIV11,
 10498           DFHEIV99
 10499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10500
 10501
 10502 1060-EXIT.
 10503     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 213
* EL689.cbl
 10505 1070-ARCH-NOT-FOUND.
 10506
 10507     MOVE ER-7371                TO EMI-ERROR.
 10508     MOVE -1                     TO ARCHNUML.
 10509     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10510     GO TO 8100-SEND-INITIAL-MAP.
 10511
 10512 1080-ARCHIVE-TEXT-NOT-FOUND.
 10513
 10514     MOVE ER-7372                TO EMI-ERROR.
 10515     MOVE -1                     TO ARCHNUML.
 10516     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10517     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 214
* EL689.cbl
 10519 2000-CREATE.
 10520***************************************************************
 10521*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 10522*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 10523*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 10524*    WILL BE DISPLAYED ON THE SCREEN.                         *
 10525*                                                             *
 10526***************************************************************
 10527
 10528***************************************************************
 10529*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 10530*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 10531*    THEN FORCE AN ERROR.                                     *
 10532***************************************************************
 10533
 10534     IF  PI-689-CREATE-NO-SCREENS
 10535         GO TO 2000-GET-TEXT.
 10536
 10537     IF  PI-CREATE-MODE
 10538         IF  PI-689-PRINT-PERFORMED
 10539                 AND
 10540             FORMI NOT EQUAL 9999
 10541             MOVE ER-0279    TO EMI-ERROR
 10542             MOVE -1         TO MAINTL
 10543             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10544             GO TO 8200-SEND-DATAONLY.
 10545
 10546     IF  ARCHNUML GREATER THAN ZEROS
 10547         MOVE ER-9320            TO EMI-ERROR
 10548         MOVE -1                 TO ARCHNUML
 10549         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10550         GO TO 8200-SEND-DATAONLY.
 10551
 10552***************************************************************
 10553*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 10554*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 10555***************************************************************
 10556
 10557     IF  FORMI EQUAL '9999'
 10558         MOVE 16                 TO PI-TOTAL-LINES
 10559         MOVE 1                  TO PI-CURRENT-LINE
 10560         MOVE SPACES             TO W-FILE-TABLE
 10561                                    W-LINE-CONTROL-RECORD
 10562                                    W-RECORD-TABLE
 10563                                    W-SINGLE-LINE
 10564                                    W-SQUEEZED-LINE
 10565                                    W-TS-WORK-AREA
 10566                                    W-TX-TABLE
 10567         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 10568         MOVE '3'                TO PI-ACTION
 10569         MOVE FORMI              TO PI-689-FORM-NUMBER
 10570                                    PI-COMM-CONTROL
 10571         MOVE ZEROS              TO PI-UPDATE-SW
 10572         MOVE W-PGM-EL1042       TO W-CALL-PGM
 10573         GO TO 9400-XCTL.
 10574
 10575 2000-GET-TEXT.
 10576
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 215
* EL689.cbl
 10577     MOVE SPACES                 TO W-FILE-TABLE
 10578                                    W-LINE-CONTROL-RECORD
 10579                                    W-RECORD-TABLE
 10580                                    W-SINGLE-LINE
 10581                                    W-SQUEEZED-LINE
 10582                                    W-TS-WORK-AREA
 10583                                    W-TX-TABLE.
 10584     SET W-TG-NDX                TO +1
 10585     MOVE ZEROS                  TO W-INITIAL-COLUMN
 10586                                    W-LINE-COUNT
 10587                                    W-LINE-INDENT-1
 10588                                    W-LINE-INDENT-2
 10589                                    W-LINE-INDENT-3
 10590                                    W-LINE-INDENT-4
 10591                                    W-LINE-INDENT-5
 10592                                    W-PAGE
 10593                                    W-PARAGRAPH-INDENT
 10594                                    W-TOP-MARGIN
 10595                                    W-WORK-INDENT.
 10596     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 10597     MOVE +70                    TO W-LAST-COLUMN.
 10598     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 10599     MOVE +1                     TO W-START-COLUMN.
 10600     MOVE +71                    TO W-TOO-FAR.
 10601
 10602     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 10603     MOVE FORMI                  TO W-TEXT-LETTER.
 10604     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 10605     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 10606
 10607
 10608* EXEC CICS HANDLE CONDITION
 10609*         NOTFND     (2001-NOT-FOUND)
 10610*         ENDFILE    (2001-NOT-FOUND)
 10611*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 10612*    END-EXEC.
 10613*    MOVE '"$I''J                 ! ) #00010363' TO DFHEIV0
 10614     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10616     MOVE X'2920233030303130333633' TO DFHEIV0(25:11)
 10617     CALL 'kxdfhei1' USING DFHEIV0
 10618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10619
 10620
 10621
 10622* EXEC CICS STARTBR
 10623*         DATASET    (W-TEXT-FILE-ID)
 10624*         RIDFLD     (W-TEXT-KEY)
 10625*         GTEQ
 10626*    END-EXEC.
 10627     MOVE 0
 10628       TO DFHEIV11
 10629*    MOVE '&,         G          &   #00010369' TO DFHEIV0
 10630     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10632     MOVE X'2020233030303130333639' TO DFHEIV0(25:11)
 10633     CALL 'kxdfhei1' USING DFHEIV0,
 10634           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 216
* EL689.cbl
 10635           W-TEXT-KEY,
 10636           DFHEIV99,
 10637           DFHEIV11,
 10638           DFHEIV99
 10639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10640
 10641
 10642
 10643* EXEC CICS HANDLE CONDITION
 10644*         ENDFILE    (2000-ENDBR)
 10645*    END-EXEC.
 10646*    MOVE '"$''                   ! * #00010375' TO DFHEIV0
 10647     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 10648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10649     MOVE X'2A20233030303130333735' TO DFHEIV0(25:11)
 10650     CALL 'kxdfhei1' USING DFHEIV0
 10651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10652
 10653
 10654 2000-READ-NEXT.
 10655
 10656     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 10657         MOVE ER-0051            TO EMI-ERROR
 10658         MOVE -1                 TO MAINTL
 10659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10660         GO TO 2000-ENDBR.
 10661
 10662
 10663* EXEC CICS READNEXT
 10664*         DATASET    (W-TEXT-FILE-ID)
 10665*         SET        (ADDRESS OF TEXT-FILES)
 10666*         RIDFLD     (W-TEXT-KEY)
 10667*    END-EXEC.
 10668     MOVE 0
 10669       TO DFHEIV11
 10670*    MOVE '&.S                   )   #00010387' TO DFHEIV0
 10671     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10672     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10673     MOVE X'2020233030303130333837' TO DFHEIV0(25:11)
 10674     CALL 'kxdfhei1' USING DFHEIV0,
 10675           W-TEXT-FILE-ID,
 10676           DFHEIV20,
 10677           DFHEIV99,
 10678           W-TEXT-KEY,
 10679           DFHEIV99,
 10680           DFHEIV11,
 10681           DFHEIV99,
 10682           DFHEIV99
 10683     SET ADDRESS OF TEXT-FILES TO
 10684         DFHEIV20
 10685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10686
 10687
 10688     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 10689         GO TO 2000-ENDBR.
 10690
 10691     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 10692
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 217
* EL689.cbl
 10693     MOVE TX-FORM-SQUEEZE-CONTROL
 10694                                 TO W-FORM-SQUEEZE-IND.
 10695
 10696     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 10697         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 10698
 10699     IF  TX-FORM-CONTROL-LINE
 10700         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 10701         GO TO 2000-READ-NEXT.
 10702
 10703     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 10704         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 10705         GO TO 2000-READ-NEXT.
 10706
 10707     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 10708     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 10709     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 10710     MOVE TX-LINE-SQUEEZE-CONTROL
 10711                                 TO W-TX-SC (W-TG-NDX).
 10712
 10713     SET W-TG-NDX UP BY 1.
 10714     GO TO 2000-READ-NEXT.
 10715
 10716 2000-ENDBR.
 10717
 10718
 10719* EXEC CICS ENDBR
 10720*        DATASET     (W-TEXT-FILE-ID)
 10721*    END-EXEC.
 10722     MOVE 0
 10723       TO DFHEIV11
 10724*    MOVE '&2                    $   #00010423' TO DFHEIV0
 10725     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10726     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10727     MOVE X'2020233030303130343233' TO DFHEIV0(25:11)
 10728     CALL 'kxdfhei1' USING DFHEIV0,
 10729           W-TEXT-FILE-ID,
 10730           DFHEIV11,
 10731           DFHEIV99
 10732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10733
 10734
 10735     IF  W-TEXT-BROWSE-NOT-STARTED
 10736         MOVE ER-0006            TO EMI-ERROR
 10737         MOVE -1                 TO FORML
 10738         MOVE AL-UABON           TO FORMA
 10739         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10740         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10741
 10742     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 10743     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 10744     MOVE 1                      TO PI-CURRENT-LINE.
 10745
 10746     IF  COPIESL NOT GREATER THAN ZEROS
 10747         MOVE +1                 TO COPIESI
 10748                                    PI-689-NUMBER-COPIES
 10749         MOVE +1                 TO COPIESL
 10750         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 218
* EL689.cbl
 10751
 10752***************************************************************
 10753*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 10754*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 10755***************************************************************
 10756
 10757     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 10758
 10759*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 10760*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 10761*            MOVE ER-7243        TO EMI-ERROR
 10762*            MOVE -1             TO PRTRESTL
 10763*            MOVE AL-UABON       TO PRTRESTA
 10764*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10765
 10766     IF  PI-CREATE-LABELS AND
 10767         NOT  PI-689-LABELS-OVERRIDEN
 10768         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 10769         SET W-RG-NDX UP BY +1
 10770     ELSE
 10771         SET W-RG-NDX            TO +1.
 10772
 10773     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 10774     SET W-RG-NDX UP BY W-TOP-MARGIN.
 10775
 10776     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 10777
 10778     SET PI-TOTAL-LINES          TO W-RG-NDX.
 10779
 10780     IF  W-FIRST-BAD-VARIABLE-FOUND
 10781         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 10782         MOVE W-FIRST-BAD-VARIABLE
 10783                                 TO PI-CURRENT-LINE
 10784     ELSE
 10785         SET W-RG-NDX            TO 1.
 10786
 10787     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10788             VARYING
 10789         W-SC-NDX FROM 1 BY 1
 10790             UNTIL
 10791         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10792     IF  PI-689-CREATE-NO-SCREENS
 10793         GO TO 2000-EXIT
 10794     ELSE
 10795         IF  W-FORM-CHANGED
 10796             MOVE '3'            TO PI-ACTION
 10797             MOVE -1             TO MAINTL
 10798             GO TO 8100-SEND-INITIAL-MAP
 10799         ELSE
 10800             MOVE '3'            TO PI-ACTION
 10801             MOVE -1             TO MAINTL
 10802             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10803
 10804 2000-EXIT.
 10805     EXIT.
 10806
 10807 2001-NOT-FOUND.
 10808
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 219
* EL689.cbl
 10809     MOVE ER-0006                TO EMI-ERROR.
 10810     MOVE -1                     TO FORML.
 10811     MOVE AL-UABON               TO FORMA.
 10812     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10813     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 220
* EL689.cbl
 10815 2100-PROCESS-FORM-CONTROL-LINE.
 10816
 10817     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 10818
 10819     IF  W-LC-LINE-WIDTH NUMERIC
 10820             AND
 10821         W-LC-LINE-WIDTH GREATER THAN ZEROS
 10822         COMPUTE W-INITIAL-COLUMN
 10823             = (70 - W-LC-LINE-WIDTH) / 2
 10824         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 10825         COMPUTE W-LAST-COLUMN ROUNDED
 10826             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 10827         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 10828     ELSE
 10829         MOVE 70                 TO W-LC-LINE-WIDTH.
 10830
 10831     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 10832             AND
 10833         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 10834         MOVE W-LC-PARAGRAPH-INDENT
 10835                                 TO W-PARAGRAPH-INDENT.
 10836
 10837     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 10838             AND
 10839         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 10840         MOVE W-LC-MAX-LINES-PER-PAGE
 10841                                 TO W-MAX-LINES-PER-PAGE.
 10842
 10843     IF  W-LC-LINE-ADJUST NUMERIC
 10844             AND
 10845         W-LC-LINE-ADJUST GREATER THAN ZEROS
 10846         COMPUTE W-TOTAL-LINE-LENGTH
 10847             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 10848         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 10849             ADD W-LC-LINE-ADJUST
 10850                                 TO W-INITIAL-COLUMN
 10851                                    W-LAST-COLUMN
 10852                                    W-START-COLUMN
 10853                                    W-TOO-FAR.
 10854
 10855     IF  W-LC-LINE-INDENT-1 NUMERIC
 10856             AND
 10857         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 10858         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 10859     ELSE
 10860         MOVE +0                 TO W-LINE-INDENT-1.
 10861
 10862     IF  W-LC-LINE-INDENT-2 NUMERIC
 10863             AND
 10864         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 10865         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 10866     ELSE
 10867         MOVE +0                 TO W-LINE-INDENT-2.
 10868
 10869     IF  W-LC-LINE-INDENT-3 NUMERIC
 10870             AND
 10871         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 10872         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 221
* EL689.cbl
 10873     ELSE
 10874         MOVE +0                 TO W-LINE-INDENT-3.
 10875
 10876     IF  W-LC-LINE-INDENT-4 NUMERIC
 10877             AND
 10878         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 10879         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 10880     ELSE
 10881         MOVE +0                 TO W-LINE-INDENT-4.
 10882
 10883     IF  W-LC-LINE-INDENT-5 NUMERIC
 10884             AND
 10885         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 10886         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 10887
 10888     ELSE
 10889         MOVE +0                 TO W-LINE-INDENT-5.
 10890
 10891     IF  W-LC-TOP-MARGIN NUMERIC
 10892         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 10893     ELSE
 10894         MOVE +0                 TO W-TOP-MARGIN.
 10895
 10896     IF W-LC-CASE-IND = 'Y' OR 'N'
 10897         NEXT SENTENCE
 10898     ELSE
 10899         MOVE PI-LOWER-CASE-LETTERS
 10900                                 TO W-LC-CASE-IND.
 10901
 10902 2100-EXIT.
 10903     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 222
* EL689.cbl
 10905 2150-PROCESS-Z-CONTROLS.
 10906
 10907     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 10908
 10909     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 10910        IF W-DAYS-TO-RESEND NUMERIC
 10911           IF W-DAYS-TO-RESEND > ZEROS
 10912              MOVE '6'           TO DC-OPTION-CODE
 10913              MOVE W-SAVE-BIN-DATE
 10914                                 TO DC-BIN-DATE-1
 10915              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 10916              MOVE W-DAYS-TO-RESEND
 10917                                 TO DC-ELAPSED-DAYS
 10918              PERFORM 9500-LINK-DATE-CONVERT
 10919                                 THRU 9500-EXIT
 10920              IF NO-CONVERSION-ERROR
 10921                 MOVE DC-BIN-DATE-2
 10922                                 TO PI-689-RESEND-DATE-1
 10923                 MOVE DC-GREG-DATE-1-EDIT
 10924                                 TO RESEND1O
 10925                                    PI-689-RESEND1-EDIT
 10926                 MOVE AL-UANON
 10927                                 TO RESEND1A
 10928                 MOVE +8         TO RESEND1L
 10929              ELSE
 10930                 MOVE ER-3770
 10931                                 TO EMI-ERROR
 10932                 MOVE -1         TO MAINTL
 10933                 PERFORM 9900-ERROR-FORMAT
 10934                                 THRU 9900-EXIT
 10935                 GO TO 8200-SEND-DATAONLY
 10936              END-IF
 10937           END-IF
 10938        END-IF
 10939     END-IF
 10940     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 10941        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 10942     END-IF
 10943     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10944         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 10945            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 10946                 MOVE '6'        TO DC-OPTION-CODE
 10947                 MOVE W-SAVE-BIN-DATE
 10948                                 TO DC-BIN-DATE-1
 10949                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 10950                 MOVE W-DAYS-TO-FOLLOW-UP
 10951                                 TO DC-ELAPSED-DAYS
 10952                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10953                 IF  NO-CONVERSION-ERROR
 10954                     MOVE DC-BIN-DATE-2
 10955                                 TO PI-689-FOLLOW-UP-DATE
 10956                     MOVE DC-GREG-DATE-1-EDIT
 10957                                 TO FOLLOWO
 10958                     MOVE AL-UANON
 10959                                 TO FOLLOWA
 10960                     MOVE +8     TO FOLLOWL
 10961                 ELSE
 10962                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 223
* EL689.cbl
 10963                                 TO EMI-ERROR
 10964                     MOVE -1     TO MAINTL
 10965                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10966                     GO TO 8200-SEND-DATAONLY.
 10967
 10968     IF  COPIESI NOT NUMERIC
 10969             OR
 10970         COPIESI NOT GREATER THAN ZEROS
 10971         IF  W-NUMBER-OF-COPIES NUMERIC
 10972             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 10973                 MOVE W-NUMBER-OF-COPIES
 10974                                 TO COPIESI
 10975                                    PI-689-NUMBER-COPIES
 10976                 MOVE AL-UNNON   TO COPIESA
 10977                 MOVE +1         TO COPIESL
 10978             ELSE
 10979                 MOVE +1         TO COPIESI
 10980                                    PI-689-NUMBER-COPIES
 10981                 MOVE AL-UNNON   TO COPIESA
 10982                 MOVE +1         TO COPIESL
 10983         ELSE
 10984             MOVE +1             TO COPIESI
 10985                                    PI-689-NUMBER-COPIES
 10986             MOVE AL-UNNON       TO COPIESA
 10987             MOVE +1             TO COPIESL.
 10988
 10989     IF W-PROMPT-LETTER EQUAL 'Y'
 10990         MOVE 'Y'                TO PI-PROMPT-IND
 10991         MOVE ER-0894            TO EMI-ERROR
 10992         MOVE -1                 TO MAINTL
 10993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10994     END-IF.
 10995
 10996     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 10997                                           ENCO
 10998     MOVE AL-UANON                      TO ENCA
 10999     MOVE +3                            TO ENCL
 11000
 11001     IF W-PRINT-CERTIFICATE = 'Y'
 11002        MOVE 'Y' TO PI-CERT-REQ-IND
 11003        IF CERTIDL > ZEROS
 11004            IF CERTIDI NUMERIC
 11005              MOVE AL-UANON      TO CERTIDA
 11006              MOVE CERTIDI       TO PI-CERT-FORM-ID
 11007            ELSE
 11008              MOVE ER-1778       TO EMI-ERROR
 11009              MOVE -1            TO CERTIDL
 11010              MOVE AL-UABON      TO CERTIDA
 11011              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11012           END-IF
 11013        ELSE
 11014              MOVE ER-0715       TO EMI-ERROR
 11015              MOVE -1            TO CERTIDL
 11016              MOVE AL-UABON      TO CERTIDA
 11017              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11018        END-IF
 11019     END-IF.
 11020
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 224
* EL689.cbl
 11021     IF W-REASONS-REQUIRED = 'Y'
 11022        MOVE 'Y' TO PI-REASON-REQ-IND
 11023        IF PI-ENDT-ARCH-NO NOT > ZERO
 11024          MOVE ER-9840       TO EMI-ERROR
 11025          MOVE -1            TO FORML
 11026          MOVE AL-UABON      TO FORMA
 11027          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11028        END-IF
 11029     END-IF.
 11030
 11031*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 11032*                                       SPACES
 11033*        IF  W-PRINT-RESTRICTED
 11034*            MOVE W-PRINT-RESTRICTED-IND
 11035*                                TO PRTRESTI
 11036*                                   PI-689-PRINT-RESTRICTION
 11037*            MOVE AL-UANON       TO PRTRESTA
 11038*            MOVE +1             TO PRTRESTL.
 11039     .
 11040 2150-EXIT.
 11041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 225
* EL689.cbl
 11043 2200-CHECK-FOR-VARIABLE.
 11044
 11045     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 11046         GO TO 2200-EXIT.
 11047
 11048     SET W-TX-NDX                TO +1.
 11049
 11050 2200-CONTINUE.
 11051
 11052     SEARCH W-TX-CHAR
 11053         VARYING
 11054             W-TX-NDX
 11055         AT END
 11056             GO TO 2200-EXIT
 11057         WHEN
 11058             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11059             NEXT SENTENCE.
 11060
 11061     SET W-TX-NDX UP BY +1.
 11062
 11063     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11064         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 11065         GO TO 2200-CONTINUE.
 11066
 11067 2200-EXIT.
 11068     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 226
* EL689.cbl
 11070 2220-BUILD-VARIABLE-NUMBER.
 11071
 11072     SET W-TX-NDX UP BY +1.
 11073     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 11074     SET W-TX-NDX UP BY +1.
 11075     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 11076     SET W-TX-NDX UP BY +1.
 11077     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11078
 11079     IF  W-VAR-RELATIVE-NUM NUMERIC
 11080         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11081         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11082
 11083 2220-EXIT.
 11084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 227
* EL689.cbl
 11086 4000-ROLL-PAGE.
 11087
 11088     IF  ENTERPFL NOT EQUAL ZEROS
 11089         MOVE -1                 TO ENTERPFL
 11090     ELSE
 11091         MOVE -1                 TO MAINTL.
 11092
 11093     IF  PI-TOTAL-LINES EQUAL 0
 11094         MOVE ER-0047            TO EMI-ERROR
 11095         MOVE -1                 TO MAINTL
 11096         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11097         GO TO 8200-SEND-DATAONLY.
 11098
 11099     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11100         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11101
 11102     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11103             OR
 11104         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11105         MOVE ER-0067            TO EMI-ERROR
 11106         MOVE -1                 TO MAINTL
 11107         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11108         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11109
 11110*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11111*            AND
 11112*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11113*        MOVE ER-0066            TO EMI-ERROR
 11114*        MOVE -1                 TO MAINTL
 11115*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11116*        COMPUTE W-TEMP-CURRENT-LINE
 11117*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11118*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11119*                OR
 11120*            W-TEMP-CURRENT-LINE = ZEROS
 11121*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11122
 11123     IF  EMI-ERROR NOT EQUAL ER-0191
 11124             AND
 11125         MAINTI NOT EQUAL 'S'
 11126         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11127         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11128         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11129                 VARYING
 11130             W-SC-NDX FROM 1 BY 1
 11131                 UNTIL
 11132             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11133
 11134     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11135                         ER-0191
 11136         NEXT SENTENCE
 11137     ELSE
 11138         GO TO 8200-SEND-DATAONLY.
 11139
 11140     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11141     SET W-RG-NDX                TO PI-CURRENT-LINE
 11142     MOVE LOW-VALUES             TO EL689RI
 11143*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 228
* EL689.cbl
 11144     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11145     SET W-RG-NDX                TO PI-CURRENT-LINE
 11146     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11147             VARYING
 11148         W-SC-NDX FROM 1 BY 1
 11149             UNTIL
 11150         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11151
 11152     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 229
* EL689.cbl
 11154 4100-SET-NDX.
 11155
 11156     IF  PI-CURRENT-LINE EQUAL 0
 11157         SET W-RG-NDX            TO 1
 11158     ELSE
 11159         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11160
 11161 4100-EXIT.
 11162      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 230
* EL689.cbl
 11164 4200-UPDATE-TABLE-FROM-SCREEN.
 11165
 11166     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11167         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11168         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11169             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11170                 MOVE ER-0051    TO EMI-ERROR
 11171                 MOVE -1         TO MAINTL
 11172                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11173                 GO TO 8200-SEND-DATAONLY
 11174             ELSE
 11175                 MOVE W-SC-TEXT (W-SC-NDX)
 11176                                 TO W-RC-TEXT (W-RG-NDX)
 11177                 ADD 1           TO PI-TOTAL-LINES
 11178         ELSE
 11179             MOVE W-SC-TEXT (W-SC-NDX)
 11180                                 TO W-RC-TEXT (W-RG-NDX).
 11181
 11182     SET W-RG-NDX UP BY 1.
 11183
 11184 4200-EXIT.
 11185      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 231
* EL689.cbl
 11187 5000-EDIT-MODE.
 11188***************************************************************
 11189*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11190*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11191*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11192***************************************************************
 11193
 11194     IF  PI-SHOW-MODE
 11195         MOVE ER-0188            TO EMI-ERROR
 11196         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11197         MOVE -1                 TO MAINTL
 11198         MOVE AL-UABON           TO MAINTA
 11199         GO TO 8200-SEND-DATAONLY.
 11200
 11201     IF  PI-CURRENT-LINE EQUAL ZEROS
 11202         MOVE ER-0187            TO EMI-ERROR
 11203         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11204         MOVE -1                 TO MAINTL
 11205         GO TO 8200-SEND-DATAONLY.
 11206
 11207     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11208     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11209     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11210             VARYING
 11211         W-SC-NDX FROM 1 BY 1
 11212             UNTIL
 11213         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11214
 11215     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11216
 11217     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11218     MOVE ZEROS                  TO PI-UPDATE-SW.
 11219     MOVE '1'                    TO PI-ENTRY-CD-1.
 11220     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11221     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 232
* EL689.cbl
 11223 5400-LETTER-RELEASE.
 11224***************************************************************
 11225*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11226*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11227*    THE ARCHIVE FILE.                                        *
 11228*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11229*        1. CHECK SECURITY.                                   *
 11230*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11231*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11232*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11233*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11234*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11235***************************************************************
 11236
 11237     IF  NOT MODIFY-CAP
 11238         MOVE ER-0070            TO EMI-ERROR
 11239         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11240         MOVE -1                 TO MAINTL
 11241         GO TO 8200-SEND-DATAONLY.
 11242
 11243     IF  PI-SHOW-MODE
 11244         MOVE ER-0188            TO EMI-ERROR
 11245         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11246         MOVE -1                 TO MAINTL
 11247         MOVE AL-UABON           TO MAINTA
 11248         GO TO 8200-SEND-DATAONLY.
 11249
 11250      IF  ARCHNUML GREATER THAN ZEROS
 11251          MOVE ER-9320            TO EMI-ERROR
 11252          MOVE -1                 TO ARCHNUML
 11253          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11254          GO TO 8200-SEND-DATAONLY.
 11255
 11256*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11257*        MOVE ER-0187            TO EMI-ERROR
 11258*        MOVE -1                 TO MAINTL
 11259*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11260*        GO TO 8200-SEND-DATAONLY.
 11261
 11262*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11263*
 11264*    IF  NOT PI-689-CREATE-NO-SCREENS
 11265*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11266*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11267*                VARYING
 11268*            W-SC-NDX FROM 1 BY 1
 11269*                UNTIL
 11270*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11271*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11272*                OR
 11273*            PI-689-FATAL-ERROR
 11274*            GO TO 8200-SEND-DATAONLY.
 11275*
 11276*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11277*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11278*            VARYING
 11279*        W-RVS-NDX FROM +1 BY +1
 11280*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 233
* EL689.cbl
 11281*        W-RVS-NDX > +36500
 11282*            OR
 11283*        W-REMAINING-VAR-FOUND.
 11284*
 11285*    IF  NOT PI-689-CREATE-NO-SCREENS
 11286*        IF  W-REMAINING-VAR-FOUND
 11287*            GO TO 4000-ROLL-PAGE.
 11288
 11289*    MOVE SPACES                 TO W-CNTL-KEY.
 11290*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11291*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11292*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11293*
 11294*    EXEC CICS HANDLE CONDITION
 11295*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11296*         NOTFND     (5470-CNTL-NOT-FOUND)
 11297*    END-EXEC.
 11298*
 11299*    EXEC CICS READ
 11300*         DATASET    (W-CNTL-FILE-ID)
 11301*         SET        (ADDRESS OF CONTROL-FILE)
 11302*         RIDFLD     (W-CNTL-KEY)
 11303*         UPDATE
 11304*    END-EXEC.
 11305*
 11306*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11307*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11308*                                   CF-CREDIT-START-ARCH-NUM.
 11309*
 11310*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11311*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11312*                                TO W-ARCH-NUMBER
 11313*                                   W-ARCT-NUMBER.
 11314*
 11315*    EXEC CICS REWRITE
 11316*         FROM      (CONTROL-FILE)
 11317*         DATASET   (W-CNTL-FILE-ID)
 11318*    END-EXEC
 11319
 11320*    EXEC CICS HANDLE CONDITION
 11321*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11322*    END-EXEC.
 11323*
 11324*    EXEC CICS GETMAIN
 11325*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11326*       LENGTH   (W-ARCH-LENGTH)
 11327*    END-EXEC
 11328*
 11329*    MOVE SPACES                 TO LETTER-ARCHIVE
 11330*    MOVE 'LA'                   TO LA-RECORD-ID.
 11331*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11332*                                   LA-ARCHIVE-NO-A2
 11333*                                   LA-ARCHIVE-NO-A3
 11334*                                   LA-ARCHIVE-NO-A4
 11335*                                   LA-ARCHIVE-NO-A5
 11336*                                   LA-ARCHIVE-NO-A6
 11337*                                   PI-689-ARCHIVE-NUMBER.
 11338*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 234
* EL689.cbl
 11339*                                   LA-COMPANY-CD-A2
 11340*                                   LA-COMPANY-CD-A3
 11341*                                   LA-COMPANY-CD-A4
 11342*                                   LA-COMPANY-CD-A5
 11343*                                   LA-COMPANY-CD-A6.
 11344*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 11345*                                   LA-CARRIER-A3
 11346*                                   LA-CARRIER-A4
 11347*                                   LA-CARRIER-A5.
 11348*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11349*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11350*                                   LA-GROUPING-A3
 11351*                                   LA-GROUPING-A4
 11352*                                   LA-GROUPING-A5.
 11353*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11354*                                   LA-ACCOUNT-A3
 11355*                                   LA-ACCOUNT-A4
 11356*                                   LA-ACCOUNT-A5.
 11357*    MOVE PI-689-STATE           TO LA-STATE-A2
 11358*                                   LA-STATE-A3
 11359*                                   LA-STATE-A4
 11360*                                   LA-STATE-A5.
 11361*
 11362*    IF  PI-689-DATA-SOURCE EQUAL '3'
 11363*            AND
 11364*        PI-689-RESP-PERSON GREATER THAN SPACES
 11365*        MOVE PI-689-RESP-PERSON
 11366*                                TO LA-RESP-PERSON-A2
 11367*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 11368*    ELSE
 11369*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 11370*            MOVE PI-689-CERT-PRIME
 11371*                                TO LA-CERT-PRIME-A2
 11372*            MOVE PI-689-CERT-SFX
 11373*                                TO LA-CERT-SUFFIX-A2
 11374*        ELSE
 11375*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 11376*                                   LA-TYPE-A2.
 11377*
 11378*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 11379*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 11380*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11381*                AND
 11382*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 11383*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11384*            MOVE 'CK'           TO LA-FILLER
 11385*        ELSE
 11386*            NEXT SENTENCE
 11387*    ELSE
 11388*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11389*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11390*            MOVE 'CK'           TO LA-FILLER
 11391*        ELSE
 11392*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 11393*
 11394*    MOVE ZEROS                  TO W-SEQ-CTR.
 11395*
 11396*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 235
* EL689.cbl
 11397*
 11398*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 11399*                                   LA-INITIAL-PRINT-DATE
 11400*                                   LA-SENT-DATE
 11401*                                   LA-REPLY-DATE.
 11402*    MOVE 'A'                    TO LA-STATUS.
 11403*
 11404*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 11405*            OR
 11406*        PI-689-NUMBER-COPIES EQUAL ZEROS
 11407*        MOVE  1                 TO LA-NO-OF-COPIES
 11408*    ELSE
 11409*        MOVE PI-689-NUMBER-COPIES
 11410*                                TO LA-NO-OF-COPIES.
 11411*
 11412*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 11413*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 11414*    MOVE PI-689-PRINT-RESTRICTION
 11415*                                TO LA-PRINT-RESTRICTION
 11416*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 11417*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 11418*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 11419*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 11420*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 11421*
 11422*    IF  PI-689-PRINT-PERFORMED
 11423*        MOVE SPACES             TO PI-689-PRINT-SW
 11424*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 11425*        IF  LA-RESEND-DATE = LOW-VALUES
 11426*            MOVE 'C'            TO LA-STATUS.
 11427*
 11428*    MOVE PI-689-NUMBER-LABEL-LINES
 11429*                                TO LA-NUMBER-LABEL-LINES.
 11430*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 11431*
 11432*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 11433*
 11434*    MOVE PI-689-NUMBER-TEXT-RECORDS
 11435*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 11436*
 11437*    EXEC CICS HANDLE CONDITION
 11438*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 11439*    END-EXEC.
 11440*
 11441*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 11442*    MOVE ER-0280                TO EMI-ERROR.
 11443*    MOVE -1                     TO MAINTL.
 11444*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11445*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11446*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 11447     .
 11448 5400-END.
 11449     DISPLAY ' MADE IT TO 5400 '
 11450     MOVE SPACES                 TO BL-INPUT
 11451     MOVE ZEROS                  TO BL-ARCHIVE-NO
 11452     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 11453     MOVE PI-689-CARRIER         TO BL-CARRIER
 11454     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 236
* EL689.cbl
 11455     MOVE PI-689-STATE           TO BL-STATE
 11456     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 11457     IF PI-689-EFF-DATE NOT = LOW-VALUES
 11458        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 11459        MOVE ' '                 TO DC-OPTION-CODE
 11460        PERFORM 9500-LINK-DATE-CONVERT
 11461                                 THRU 9500-EXIT
 11462        IF NO-CONVERSION-ERROR
 11463           MOVE DC-GREG-DATE-1-EDIT
 11464                                 TO BL-EFF-DT
 11465        END-IF
 11466     END-IF
 11467     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 11468     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 11469     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 11470     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 11471     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 11472     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 11473     IF PI-ENDT-ARCH-NO > ZERO
 11474         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 11475     END-IF
 11476     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 11477     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 11478*    MOVE 'ALWA'                 TO BL-PROC-ID
 11479     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 11480*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 11481     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 11482     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 11483        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 11484        MOVE ' '                 TO DC-OPTION-CODE
 11485        PERFORM 9500-LINK-DATE-CONVERT
 11486                                 THRU 9500-EXIT
 11487        IF NO-CONVERSION-ERROR
 11488           MOVE DC-GREG-DATE-B-EDIT
 11489                                 TO BL-RESEND-DT
 11490        END-IF
 11491     END-IF
 11492     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 11493        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 11494        MOVE ' '                 TO DC-OPTION-CODE
 11495        PERFORM 9500-LINK-DATE-CONVERT
 11496                                 THRU 9500-EXIT
 11497        IF NO-CONVERSION-ERROR
 11498           MOVE DC-GREG-DATE-B-EDIT
 11499                                 TO BL-FOLLOW-UP-DT
 11500        END-IF
 11501     END-IF
 11502*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 11503*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 11504     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 11505     if eibaid = dfhpf7
 11506        move 'B'                 TO BL-WRITE-ERARCH
 11507     else
 11508        move 'T'                 to bl-write-erarch
 11509     end-if
 11510    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 11511*****************************************
 11512* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 237
* EL689.cbl
 11513*****************************************
 11514
 11515* exec cics link
 11516*       program('NSRASBL')
 11517*       commarea(srch-commarea)
 11518*    end-exec.
 11519     MOVE LENGTH OF
 11520      srch-commarea
 11521       TO DFHEIV11
 11522     MOVE 'NSRASBL' TO DFHEIV1
 11523*    MOVE '."C                   (   #00011206' TO DFHEIV0
 11524     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11526     MOVE X'2020233030303131323036' TO DFHEIV0(25:11)
 11527     CALL 'kxdfhei1' USING DFHEIV0,
 11528           DFHEIV1,
 11529           srch-commarea,
 11530           DFHEIV11,
 11531           DFHEIV99,
 11532           DFHEIV99,
 11533           DFHEIV99,
 11534           DFHEIV99
 11535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11536
 11537     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 11538        bl-message ' ' bl-archive-no
 11539     move bl-archive-no to w-arch-number
 11540
 11541     if eibaid = dfhpf7
 11542        MOVE ER-0280                TO EMI-ERROR
 11543        MOVE -1                     TO MAINTL
 11544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11545        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11546        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 11547        MOVE '2'                    TO PI-ACTION
 11548        MOVE ZEROS                  TO PI-TOTAL-LINES
 11549                                       PI-CURRENT-LINE
 11550        MOVE SPACES                 TO PI-689-PRINT-SW
 11551                                       PI-689-FORM-NUMBER
 11552        GO TO 9300-DFHCLEAR
 11553     else
 11554        move w-arch-number          to archnumo
 11555        MOVE ER-1818                TO EMI-ERROR
 11556        MOVE -1                     TO MAINTL
 11557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11558     end-if
 11559     MOVE -1                     TO MAINTL
 11560     GO TO 8200-SEND-DATAONLY
 11561     .
 11562 5400-EXIT.
 11563     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 238
* EL689.cbl
 11565 5410-CREATE-TEXT-RECORDS.
 11566
 11567*    EXEC CICS HANDLE CONDITION
 11568*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 11569*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 11570*    END-EXEC.
 11571*
 11572*    IF  PI-689-CREATE-NO-SCREENS
 11573*        IF  PI-689-GET-ARCT-MAIN
 11574*            EXEC CICS GETMAIN
 11575*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11576*                 LENGTH   (W-ARCT-LENGTH)
 11577*            END-EXEC
 11578*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 11579*                                    LETTER-ARCHIVE-TEXT
 11580*            MOVE LCP-WS-ADDR-COMP
 11581*                                TO PI-689-ARCT-POINTER
 11582*        ELSE
 11583*            MOVE PI-689-ARCT-POINTER
 11584*                                TO LCP-WS-ADDR-COMP
 11585*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 11586*                                TO LCP-WS-ADDR-PNTR
 11587*    ELSE
 11588*        EXEC CICS GETMAIN
 11589*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11590*             LENGTH   (W-ARCT-LENGTH)
 11591*        END-EXEC.
 11592*
 11593*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11594*
 11595*    MOVE ZEROS                  TO W-SEQ-CTR
 11596*
 11597*    IF  PI-CREATE-LABELS AND
 11598*        NOT PI-689-LABELS-OVERRIDEN
 11599*        MOVE '1'                TO LT-RECORD-TYPE
 11600*        MOVE +0                 TO LT-LINE-SEQ-NO
 11601*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 11602*                VARYING
 11603*            W-RG-NDX FROM 1 BY 1
 11604*                UNTIL
 11605*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 11606*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11607*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 11608*    ELSE
 11609*        SET W-RG-NDX            TO +1.
 11610*
 11611*    SET LT-NDX                  TO W-ZEROS.
 11612*
 11613*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 11614*            VARYING
 11615*        W-RG-NDX FROM W-RG-NDX BY +1
 11616*            UNTIL
 11617*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 11618
 11619 5410-EXIT.
 11620     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 239
* EL689.cbl
 11622 5415-INITIALIZE-TEXT.
 11623
 11624     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 11625     MOVE 'LT'                   TO LT-RECORD-ID.
 11626
 11627     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 11628     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 11629
 11630     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 11631                                    LT-NUM-LINES-ON-RECORD.
 11632
 11633 5415-EXIT.
 11634     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 240
* EL689.cbl
 11636 5460-DUPLICATE-ARCHIVE-RCD.
 11637
 11638     IF  NOT PI-689-CREATE-NO-SCREENS
 11639
 11640* EXEC CICS SYNCPOINT ROLLBACK
 11641*        END-EXEC.
 11642*    MOVE '6"R                   !   #00011312' TO DFHEIV0
 11643     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11645     MOVE X'2020233030303131333132' TO DFHEIV0(25:11)
 11646     CALL 'kxdfhei1' USING DFHEIV0
 11647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11648
 11649
 11650     MOVE ER-9426                TO EMI-ERROR.
 11651     MOVE -1                     TO MAINTL.
 11652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11653     GO TO 8200-SEND-DATAONLY.
 11654
 11655 5465-DUPLICATE-ARCH-TEXT.
 11656
 11657     IF  NOT PI-689-CREATE-NO-SCREENS
 11658
 11659* EXEC CICS SYNCPOINT ROLLBACK
 11660*        END-EXEC.
 11661*    MOVE '6"R                   !   #00011323' TO DFHEIV0
 11662     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11664     MOVE X'2020233030303131333233' TO DFHEIV0(25:11)
 11665     CALL 'kxdfhei1' USING DFHEIV0
 11666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11667
 11668
 11669     MOVE ER-7369                TO EMI-ERROR.
 11670     MOVE -1                     TO MAINTL.
 11671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11672     GO TO 8200-SEND-DATAONLY.
 11673
 11674 5470-CNTL-NOT-FOUND.
 11675
 11676     MOVE ER-9299                TO EMI-ERROR.
 11677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11678     MOVE -1                     TO MAINTL.
 11679     MOVE AL-UANON               TO MAINTA.
 11680     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 241
* EL689.cbl
 11682 5500-FORMAT-TEXT.
 11683
 11684     SET LT-NDX UP BY +1.
 11685
 11686     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 11687         SET W-RG-NDX UP BY 1
 11688         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 11689         MOVE W-RC-TEXT (W-RG-NDX)
 11690                                 TO LT-TEXT-LINE (LT-NDX)
 11691     ELSE
 11692         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 11693             MOVE ZEROS          TO W-PRINT-CONTROL
 11694             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 11695                     VARYING
 11696                 W-RG-NDX FROM W-RG-NDX BY 1
 11697                     UNTIL
 11698                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11699                     OR
 11700                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 11701             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11702                 GO TO 5500-WRITE-TEST
 11703             ELSE
 11704                 MOVE W-PRINT-CONTROL
 11705                                 TO LT-SKIP-CONTROL (LT-NDX)
 11706                 MOVE W-RC-TEXT (W-RG-NDX)
 11707                                 TO LT-TEXT-LINE (LT-NDX)
 11708         ELSE
 11709             MOVE W-RC-TEXT (W-RG-NDX)
 11710                                 TO LT-TEXT-LINE (LT-NDX)
 11711             MOVE ZEROS          TO W-PRINT-CONTROL.
 11712
 11713     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 11714
 11715 5500-WRITE-TEST.
 11716
 11717     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 11718         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 11719             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11720             MOVE '2'            TO LT-RECORD-TYPE
 11721             ADD +1              TO W-SEQ-CTR
 11722             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11723             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11724         ELSE
 11725             NEXT SENTENCE
 11726     ELSE
 11727         IF  LT-NDX EQUAL +20
 11728             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11729             MOVE '2'            TO LT-RECORD-TYPE
 11730             ADD +1              TO W-SEQ-CTR
 11731             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11732             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11733             SET LT-NDX          TO W-ZEROS
 11734             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11735
 11736 5500-EXIT.
 11737      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 242
* EL689.cbl
 11739 5505-FIND-USED-LINE.
 11740
 11741     ADD +1                      TO W-PRINT-CONTROL.
 11742
 11743 5505-EXIT.
 11744      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 243
* EL689.cbl
 11746 5600-FORMAT-ADDRESS-LINE.
 11747
 11748     SET LT-NDX                  TO W-RG-NDX.
 11749     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 11750
 11751 5600-EXIT.
 11752     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 244
* EL689.cbl
 11754 5650-WRITE-ARCHIVE.
 11755
 11756
 11757* EXEC CICS WRITE
 11758*         DATASET   (W-ARCH-FILE-ID)
 11759*         FROM      (LETTER-ARCHIVE)
 11760*         RIDFLD    (LA-CONTROL-PRIMARY)
 11761*    END-EXEC.
 11762     MOVE LENGTH OF
 11763      LETTER-ARCHIVE
 11764       TO DFHEIV11
 11765*    MOVE '&$ L                  ''   #00011413' TO DFHEIV0
 11766     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11767     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11768     MOVE X'2020233030303131343133' TO DFHEIV0(25:11)
 11769     CALL 'kxdfhei1' USING DFHEIV0,
 11770           W-ARCH-FILE-ID,
 11771           LETTER-ARCHIVE,
 11772           DFHEIV11,
 11773           LA-CONTROL-PRIMARY,
 11774           DFHEIV99,
 11775           DFHEIV99
 11776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11777
 11778
 11779 5650-EXIT.
 11780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 245
* EL689.cbl
 11782 5655-WRITE-ARCHIVE-TEXT.
 11783
 11784
 11785* EXEC CICS WRITE
 11786*         DATASET   (W-ARCT-FILE-ID)
 11787*         FROM      (LETTER-ARCHIVE-TEXT)
 11788*         RIDFLD    (LT-CONTROL-PRIMARY)
 11789*    END-EXEC.
 11790     MOVE LENGTH OF
 11791      LETTER-ARCHIVE-TEXT
 11792       TO DFHEIV11
 11793*    MOVE '&$ L                  ''   #00011424' TO DFHEIV0
 11794     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11795     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11796     MOVE X'2020233030303131343234' TO DFHEIV0(25:11)
 11797     CALL 'kxdfhei1' USING DFHEIV0,
 11798           W-ARCT-FILE-ID,
 11799           LETTER-ARCHIVE-TEXT,
 11800           DFHEIV11,
 11801           LT-CONTROL-PRIMARY,
 11802           DFHEIV99,
 11803           DFHEIV99
 11804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11805
 11806
 11807 5655-EXIT.
 11808     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 246
* EL689.cbl
 11810 6000-RESOLVE-VARIABLES.
 11811***************************************************************
 11812*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 11813*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 11814*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 11815*    RESOLVE ALL OF THE SYMBOLS.                              *
 11816*                                                             *
 11817***************************************************************
 11818
 11819     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 11820     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 11821     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 11822     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 11823     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 11824*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 11825     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 11826     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 11827     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 11828     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 11829     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 11830     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 11831     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 11832     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 11833
 11834     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 11835
 11836 6000-EXIT.
 11837     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 247
* EL689.cbl
 11839 6200-GET-COMPANY-DATA.
 11840
 11841     IF  ADDRSI EQUAL '3'
 11842             AND
 11843         PI-CREATE-LABELS
 11844             AND
 11845         NOT PI-689-LABELS-OVERRIDEN
 11846         NEXT SENTENCE
 11847     ELSE
 11848         IF  W-FILE-NOT-USED (1)
 11849             GO TO 6200-EXIT.
 11850
 11851     MOVE SPACES                 TO W-CNTL-KEY.
 11852     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11853     MOVE +0                     TO W-CNTL-SEQ-NO.
 11854     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11855
 11856
 11857* EXEC CICS HANDLE CONDITION
 11858*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 11859*         NOTFND    (6200-CNTL1-NOT-FOUND)
 11860*    END-EXEC.
 11861*    MOVE '"$JI                  ! + #00011479' TO DFHEIV0
 11862     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11864     MOVE X'2B20233030303131343739' TO DFHEIV0(25:11)
 11865     CALL 'kxdfhei1' USING DFHEIV0
 11866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11867
 11868
 11869
 11870* EXEC CICS READ
 11871*         DATASET   (W-CNTL-FILE-ID)
 11872*         SET       (ADDRESS OF CONTROL-FILE)
 11873*         RIDFLD    (W-CNTL-KEY)
 11874*    END-EXEC.
 11875*    MOVE '&"S        E          (   #00011484' TO DFHEIV0
 11876     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11878     MOVE X'2020233030303131343834' TO DFHEIV0(25:11)
 11879     CALL 'kxdfhei1' USING DFHEIV0,
 11880           W-CNTL-FILE-ID,
 11881           DFHEIV20,
 11882           DFHEIV99,
 11883           W-CNTL-KEY,
 11884           DFHEIV99,
 11885           DFHEIV99,
 11886           DFHEIV99
 11887     SET ADDRESS OF CONTROL-FILE TO
 11888         DFHEIV20
 11889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11890
 11891
 11892     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11893     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 11894                                    W-VG-TEXT (25).
 11895     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 11896     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 248
* EL689.cbl
 11897     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 11898     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 11899
 11900     IF  CF-CL-CAN-POST-CODE
 11901         MOVE CF-CL-CANADIAN-POSTAL-CODE
 11902                                 TO W-CANADIAN-POSTAL-CODES
 11903         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11904         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11905         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11906                                    W-LAB-CAN-FILLER (6)
 11907         GO TO 6200-CONTINUE.
 11908
 11909     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11910         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 11911         MOVE SPACES             TO W-LABEL-ZIP (6)
 11912         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11913
 11914         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11915             MOVE '-'            TO W-LABEL-DASH (6)
 11916             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 11917             GO TO 6200-CONTINUE
 11918         ELSE
 11919             MOVE SPACES         TO W-LABEL-DASH (6)
 11920                                    W-LABEL-2ND-ZIP (6)
 11921             GO TO 6200-CONTINUE.
 11922
 11923     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11924         GO TO 6200-CONTINUE.
 11925
 11926     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 11927
 11928     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11929         COMPUTE W-WORK-ZIP-NUMERIC
 11930             = W-WORK-ZIP-NUMERIC * 10000.
 11931
 11932     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11933     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11934
 11935     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11936         MOVE '-'                TO W-LABEL-DASH (6)
 11937         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11938         GO TO 6200-CONTINUE
 11939     ELSE
 11940         MOVE SPACES             TO W-LABEL-DASH (6)
 11941                                    W-LABEL-2ND-ZIP (6)
 11942         GO TO 6200-CONTINUE.
 11943
 11944 6200-CONTINUE.
 11945
 11946     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11947
 11948     IF  ADDRSI EQUAL '3'
 11949             AND
 11950         PI-CREATE-LABELS
 11951             AND
 11952         NOT PI-689-LABELS-OVERRIDEN
 11953         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 11954         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 249
* EL689.cbl
 11955         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 11956         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 11957         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 11958         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 11959         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11960         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11961         SET W-RG-NDX UP BY +1
 11962     ELSE
 11963         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 11964         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 11965         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 11966         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 11967         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 11968         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 11969
 11970     GO TO 6200-EXIT.
 11971
 11972 6200-CNTL1-NOT-FOUND.
 11973
 11974     MOVE ER-9299                TO EMI-ERROR.
 11975     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11976     MOVE -1                     TO ADDRSL.
 11977     MOVE AL-UANON               TO ADDRSA.
 11978     GO TO 8200-SEND-DATAONLY.
 11979
 11980 6200-EXIT.
 11981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 250
* EL689.cbl
 11983 6250-GET-CNTL2-DATA.
 11984
 11985     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 11986         GO TO 6250-EXIT.
 11987
 11988     IF  W-FILE-NOT-USED (11)
 11989         GO TO 6250-EXIT.
 11990
 11991     MOVE SPACES                 TO W-CNTL-KEY.
 11992     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11993     MOVE +0                     TO W-CNTL-SEQ-NO.
 11994     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 11995     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 11996
 11997
 11998* EXEC CICS HANDLE CONDITION
 11999*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12000*         NOTFND     (6250-CNTL2-NOT-FOUND)
 12001*    END-EXEC.
 12002*    MOVE '"$JI                  ! , #00011595' TO DFHEIV0
 12003     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12005     MOVE X'2C20233030303131353935' TO DFHEIV0(25:11)
 12006     CALL 'kxdfhei1' USING DFHEIV0
 12007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12008
 12009
 12010
 12011* EXEC CICS READ
 12012*         DATASET    (W-CNTL-FILE-ID)
 12013*         SET        (ADDRESS OF CONTROL-FILE)
 12014*         RIDFLD     (W-CNTL-KEY)
 12015*    END-EXEC.
 12016*    MOVE '&"S        E          (   #00011600' TO DFHEIV0
 12017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12018     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12019     MOVE X'2020233030303131363030' TO DFHEIV0(25:11)
 12020     CALL 'kxdfhei1' USING DFHEIV0,
 12021           W-CNTL-FILE-ID,
 12022           DFHEIV20,
 12023           DFHEIV99,
 12024           W-CNTL-KEY,
 12025           DFHEIV99,
 12026           DFHEIV99,
 12027           DFHEIV99
 12028     SET ADDRESS OF CONTROL-FILE TO
 12029         DFHEIV20
 12030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12031
 12032
 12033     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 12034     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 12035     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 12036     GO TO 6250-EXIT.
 12037
 12038 6250-CNTL2-NOT-FOUND.
 12039
 12040     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 251
* EL689.cbl
 12041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12042     MOVE -1                     TO MAINTL.
 12043     MOVE AL-UANON               TO MAINTA.
 12044     GO TO 8200-SEND-DATAONLY.
 12045
 12046 6250-EXIT.
 12047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 252
* EL689.cbl
 12049 6300-GET-CARRIER-DATA.
 12050
 12051     IF  ADDRSI EQUAL '2'
 12052             AND
 12053         PI-CREATE-LABELS
 12054             AND
 12055         NOT PI-689-LABELS-OVERRIDEN
 12056         NEXT SENTENCE
 12057     ELSE
 12058         IF  W-FILE-NOT-USED (4)
 12059             GO TO 6300-EXIT.
 12060
 12061     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 12062         MOVE SPACES             TO W-CNTL-KEY
 12063         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 12064         MOVE +0                 TO W-CNTL-SEQ-NO
 12065         MOVE '6'                TO W-CNTL-RECORD-TYPE
 12066         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 12067     ELSE
 12068         MOVE ER-9327            TO EMI-ERROR
 12069         MOVE -1                 TO CARRIERL
 12070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12071         GO TO 6300-EXIT.
 12072
 12073
 12074* EXEC CICS HANDLE CONDITION
 12075*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12076*         NOTFND     (6300-CNTL6-NOT-FOUND)
 12077*    END-EXEC.
 12078*    MOVE '"$JI                  ! - #00011646' TO DFHEIV0
 12079     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12081     MOVE X'2D20233030303131363436' TO DFHEIV0(25:11)
 12082     CALL 'kxdfhei1' USING DFHEIV0
 12083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12084
 12085
 12086
 12087* EXEC CICS READ
 12088*         DATASET    (W-CNTL-FILE-ID)
 12089*         SET        (ADDRESS OF CONTROL-FILE)
 12090*         RIDFLD     (W-CNTL-KEY)
 12091*    END-EXEC.
 12092*    MOVE '&"S        E          (   #00011651' TO DFHEIV0
 12093     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12095     MOVE X'2020233030303131363531' TO DFHEIV0(25:11)
 12096     CALL 'kxdfhei1' USING DFHEIV0,
 12097           W-CNTL-FILE-ID,
 12098           DFHEIV20,
 12099           DFHEIV99,
 12100           W-CNTL-KEY,
 12101           DFHEIV99,
 12102           DFHEIV99,
 12103           DFHEIV99
 12104     SET ADDRESS OF CONTROL-FILE TO
 12105         DFHEIV20
 12106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 253
* EL689.cbl
 12107
 12108
 12109     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12110     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 12111     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 12112     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 12113     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 12114     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 12115
 12116     IF  CF-CANADIAN-POST-CODE
 12117         MOVE CF-CANADIAN-POSTAL-CODE
 12118                                 TO W-CANADIAN-POSTAL-CODES
 12119         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12120         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12121         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12122                                    W-LAB-CAN-FILLER (6)
 12123         GO TO 6300-CONTINUE.
 12124
 12125     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12126         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 12127         MOVE SPACES             TO W-LABEL-ZIP (6)
 12128         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12129         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12130             MOVE '-'            TO W-LABEL-DASH (6)
 12131             MOVE W-WORK-ZIP4
 12132                                 TO W-LABEL-2ND-ZIP (6)
 12133             GO TO 6300-CONTINUE
 12134         ELSE
 12135             MOVE SPACES         TO W-LABEL-DASH (6)
 12136                                    W-LABEL-2ND-ZIP (6)
 12137             GO TO 6300-CONTINUE.
 12138
 12139     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 12140         GO TO 6300-CONTINUE.
 12141
 12142     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 12143
 12144     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12145         COMPUTE W-WORK-ZIP-NUMERIC
 12146             = W-WORK-ZIP-NUMERIC * 10000.
 12147
 12148     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12149     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12150
 12151     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12152         MOVE '-'                TO W-LABEL-DASH (6)
 12153         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12154         GO TO 6300-CONTINUE
 12155     ELSE
 12156         MOVE SPACES             TO W-LABEL-DASH (6)
 12157                                    W-LABEL-2ND-ZIP (6)
 12158         GO TO 6300-CONTINUE.
 12159
 12160 6300-CONTINUE.
 12161
 12162     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12163
 12164     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 254
* EL689.cbl
 12165             AND
 12166         PI-CREATE-LABELS
 12167             AND
 12168         NOT PI-689-LABELS-OVERRIDEN
 12169         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 12170         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 12171         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 12172         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 12173         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 12174         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 12175         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12176         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12177         SET W-RG-NDX UP BY +1
 12178     ELSE
 12179         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 12180         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 12181         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 12182         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 12183         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 12184         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 12185
 12186     IF  W-FULL-DATA
 12187         MOVE ZEROS              TO W-PHONE-IN
 12188         MOVE CF-PHONE-NO        TO W-PHONE-IN
 12189         MOVE W-PHI-AREA         TO W-PO-AREA
 12190         MOVE W-PHI-PFX          TO W-PO-PFX
 12191         MOVE W-PHI-SFX          TO W-PO-SFX
 12192         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 12193
 12194     GO TO 6300-EXIT.
 12195
 12196 6300-CNTL6-NOT-FOUND.
 12197
 12198     MOVE ER-9298                TO EMI-ERROR.
 12199     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12200     MOVE -1                     TO ADDRSL.
 12201     MOVE AL-UANON               TO ADDRSA.
 12202     GO TO 8200-SEND-DATAONLY.
 12203
 12204 6300-EXIT.
 12205     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 255
* EL689.cbl
 12207 6350-GET-CSR-DATA.
 12208     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 12209        GO TO 6350-EXIT
 12210     END-IF
 12211*    IF W-FILE-NOT-USED (11)
 12212*       GO TO 6350-EXIT
 12213*    END-IF
 12214     MOVE SPACES                 TO W-CNTL-KEY
 12215     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 12216     MOVE +0                     TO W-CNTL-SEQ-NO
 12217     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 12218     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 12219
 12220* EXEC CICS HANDLE CONDITION
 12221*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12222*         NOTFND     (6350-CNTL2-NOT-FOUND)
 12223*    END-EXEC
 12224*    MOVE '"$JI                  ! . #00011767' TO DFHEIV0
 12225     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12227     MOVE X'2E20233030303131373637' TO DFHEIV0(25:11)
 12228     CALL 'kxdfhei1' USING DFHEIV0
 12229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12230
 12231* EXEC CICS READ
 12232*         DATASET    (W-CNTL-FILE-ID)
 12233*         SET        (ADDRESS OF CONTROL-FILE)
 12234*         RIDFLD     (W-CNTL-KEY)
 12235*    END-EXEC
 12236*    MOVE '&"S        E          (   #00011771' TO DFHEIV0
 12237     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12239     MOVE X'2020233030303131373731' TO DFHEIV0(25:11)
 12240     CALL 'kxdfhei1' USING DFHEIV0,
 12241           W-CNTL-FILE-ID,
 12242           DFHEIV20,
 12243           DFHEIV99,
 12244           W-CNTL-KEY,
 12245           DFHEIV99,
 12246           DFHEIV99,
 12247           DFHEIV99
 12248     SET ADDRESS OF CONTROL-FILE TO
 12249         DFHEIV20
 12250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12251     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 12252     GO TO 6350-EXIT
 12253     .
 12254 6350-CNTL2-NOT-FOUND.
 12255     MOVE ER-9299                TO EMI-ERROR.
 12256     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12257     MOVE -1                     TO MAINTL.
 12258     MOVE AL-UANON               TO MAINTA.
 12259     GO TO 8200-SEND-DATAONLY.
 12260 6350-EXIT.
 12261     EXIT.
 12262 6400-GET-PENDING-DATA.
 12263
 12264     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 256
* EL689.cbl
 12265        AND (PI-CREATE-LABELS)
 12266        AND (NOT PI-689-LABELS-OVERRIDEN)
 12267        CONTINUE
 12268     ELSE
 12269        IF PI-689-DATA-SOURCE = '4'
 12270           CONTINUE
 12271        ELSE
 12272           IF W-FILE-NOT-USED (9)
 12273              GO TO 6400-EXIT
 12274           END-IF
 12275        END-IF
 12276     END-IF
 12277     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 12278         MOVE ER-9327            TO EMI-ERROR
 12279         MOVE -1                 TO MAINTL
 12280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12281         GO TO 6400-EXIT.
 12282
 12283 6400-READ-PNDB-ONLY.
 12284
 12285
 12286* EXEC CICS HANDLE CONDITION
 12287*         NOTOPEN (8060-PNDB-NOT-OPEN)
 12288*         NOTFND  (8070-PNDB-NOT-FOUND)
 12289*    END-EXEC.
 12290*    MOVE '"$JI                  ! / #00011810' TO DFHEIV0
 12291     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12293     MOVE X'2F20233030303131383130' TO DFHEIV0(25:11)
 12294     CALL 'kxdfhei1' USING DFHEIV0
 12295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12296
 12297
 12298
 12299* EXEC CICS READ
 12300*         DATASET (W-PNDB-FILE-ID)
 12301*         SET     (ADDRESS OF PENDING-BUSINESS)
 12302*         RIDFLD  (W-PNDB-KEY)
 12303*    END-EXEC.
 12304*    MOVE '&"S        E          (   #00011815' TO DFHEIV0
 12305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12307     MOVE X'2020233030303131383135' TO DFHEIV0(25:11)
 12308     CALL 'kxdfhei1' USING DFHEIV0,
 12309           W-PNDB-FILE-ID,
 12310           DFHEIV20,
 12311           DFHEIV99,
 12312           W-PNDB-KEY,
 12313           DFHEIV99,
 12314           DFHEIV99,
 12315           DFHEIV99
 12316     SET ADDRESS OF PENDING-BUSINESS TO
 12317         DFHEIV20
 12318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12319
 12320
 12321     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 12322
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 257
* EL689.cbl
 12323     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 12324         MOVE PB-SV-CARRIER      TO PB-CARRIER
 12325                                    PI-689-CARRIER
 12326         MOVE PB-SV-GROUPING     TO PB-GROUPING
 12327                                    PI-689-GROUPING
 12328         MOVE PB-SV-STATE        TO PB-STATE
 12329                                    PI-689-STATE
 12330         MOVE PB-CONTROL-BY-ACCOUNT
 12331                                 TO W-CERT-KEY
 12332                                    W-MAIL-KEY
 12333                                    W-ACCT-KEY
 12334         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 12335         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 12336         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 12337
 12338 6400-ONLY-STOP.
 12339
 12340     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 12341
 12342     IF  NOT PB-ISSUE
 12343         GO TO 6400-CANCEL.
 12344
 12345     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 12346     MOVE SPACES                 TO DC-OPTION-CODE.
 12347     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12348
 12349     IF  NO-CONVERSION-ERROR
 12350         MOVE DC-GREG-DATE-1-EDIT
 12351                                 TO W-VG-TEXT (110).
 12352
 12353     MOVE PB-I-AGE               TO W-EDIT-3-0.
 12354     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 12355     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 12356     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 12357     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 12358     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 12359     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 12360     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 12361     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 12362     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 12363     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 12364     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 12365     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 12366     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 12367     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 12368     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 12369     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 12370     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 12371     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 12372     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 12373
 12374     COMPUTE W-DIFFERENCE
 12375         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 12376
 12377     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12378     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 12379
 12380     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 258
* EL689.cbl
 12381         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 12382
 12383     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12384     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 12385
 12386 6400-CANCEL.
 12387
 12388     IF  NOT PB-CANCELLATION
 12389         GO TO 6400-EXIT.
 12390
 12391     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 12392                                 TO DC-BIN-DATE-1.
 12393     MOVE SPACES                 TO DC-OPTION-CODE.
 12394     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12395
 12396     IF  NO-CONVERSION-ERROR
 12397         MOVE DC-GREG-DATE-1-EDIT
 12398                                 TO W-VG-TEXT (117).
 12399
 12400     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 12401     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 12402     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 12403     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 12404     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 12405     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 12406     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 12407     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 12408     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 12409     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 12410
 12411     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 12412        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 12413     END-IF
 12414     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 12415     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 12416     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 12417     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 12418        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 12419     END-IF
 12420     MOVE SPACES                 TO DC-OPTION-CODE
 12421     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 12422
 12423     IF NO-CONVERSION-ERROR
 12424        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 12425     END-IF
 12426
 12427     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 12428                           - PB-C-LF-CANCEL-AMT.
 12429
 12430     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12431     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 12432
 12433     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 12434                           - PB-C-AH-CANCEL-AMT.
 12435
 12436     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12437     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 12438
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 259
* EL689.cbl
 12439 6400-EXIT.
 12440     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 260
* EL689.cbl
 12442 6450-GET-CERT-DATA.
 12443     IF  W-FILE-NOT-USED (8)
 12444         GO TO 6450-EXIT.
 12445
 12446     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 12447         MOVE ER-9327            TO EMI-ERROR
 12448         MOVE -1                 TO MAINTL
 12449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12450         GO TO 6450-EXIT.
 12451
 12452 6450-READ-CERT-ONLY.
 12453
 12454
 12455* EXEC CICS HANDLE CONDITION
 12456*         NOTOPEN (8030-CERT-NOT-OPEN)
 12457*         NOTFND  (8035-CERT-NOT-FOUND)
 12458*    END-EXEC.
 12459*    MOVE '"$JI                  ! 0 #00011954' TO DFHEIV0
 12460     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12462     MOVE X'3020233030303131393534' TO DFHEIV0(25:11)
 12463     CALL 'kxdfhei1' USING DFHEIV0
 12464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12465
 12466
 12467
 12468* EXEC CICS READ
 12469*         DATASET (W-CERT-FILE-ID)
 12470*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 12471*         RIDFLD  (W-CERT-KEY)
 12472*    END-EXEC.
 12473*    MOVE '&"S        E          (   #00011959' TO DFHEIV0
 12474     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12476     MOVE X'2020233030303131393539' TO DFHEIV0(25:11)
 12477     CALL 'kxdfhei1' USING DFHEIV0,
 12478           W-CERT-FILE-ID,
 12479           DFHEIV20,
 12480           DFHEIV99,
 12481           W-CERT-KEY,
 12482           DFHEIV99,
 12483           DFHEIV99,
 12484           DFHEIV99
 12485     SET ADDRESS OF CERTIFICATE-MASTER TO
 12486         DFHEIV20
 12487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12488
 12489
 12490     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 12491
 12492 6450-ONLY-STOP.
 12493
 12494     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 12495
 12496     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 12497
 12498     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12499     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 261
* EL689.cbl
 12500     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 12501     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12502     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 12503
 12504     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12505     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12506     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 12507     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 12508     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 12509
 12510     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12511     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12512     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 12513     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 12514     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12515     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 12516
 12517     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12518     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12519     MOVE SPACES                 TO W-NAME-MIDDLE.
 12520     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12521     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 12522
 12523     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 12524     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 12525
 12526     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12527     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12528     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 12529     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12530     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 12531                                    W-LABEL-JOINT-NAME.
 12532
 12533     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12534     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12535     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 12536     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 12537     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 12538
 12539     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12540     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12541     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 12542     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 12543     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12544     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 12545
 12546     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12547     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12548     MOVE SPACES                 TO W-NAME-MIDDLE.
 12549     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12550     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 12551
 12552     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 12553     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 12554
 12555     COMPUTE W-WORK-AMOUNT
 12556         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 12557     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 262
* EL689.cbl
 12558     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 12559     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 12560     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 12561
 12562     IF  CM-SEX-FEMAL
 12563         MOVE 'MS.'              TO W-VG-TEXT (96)
 12564
 12565     ELSE
 12566         MOVE 'MR.'              TO W-VG-TEXT (96).
 12567
 12568     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 12569                                 TO W-VG-TEXT (70).
 12570     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 12571     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 12572     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 12573     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 12574     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 12575     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 12576     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 12577     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 12578     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 12579     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 12580     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 12581     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 12582     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 12583     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 12584     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 12585     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 12586     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 12587     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 12588     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 12589     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 12590     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 12591     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 12592     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 12593     IF PI-689-DATA-SOURCE NOT = '4'
 12594     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 12595        + CM-AH-ITD-CANCEL-AMT
 12596     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 12597     IF CM-NH-INT-ON-REFS NOT NUMERIC
 12598        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 12599     END-IF
 12600     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 12601     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 12602     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 12603     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 12604        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 12605     END-IF
 12606     MOVE SPACES                 TO DC-OPTION-CODE
 12607     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 12608
 12609     IF NO-CONVERSION-ERROR
 12610        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 12611     END-IF
 12612     END-IF
 12613     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 12614     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 12615     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 263
* EL689.cbl
 12616
 12617     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 12618     MOVE SPACES                 TO DC-OPTION-CODE.
 12619     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12620
 12621     IF  NO-CONVERSION-ERROR
 12622         MOVE DC-GREG-DATE-1-EDIT
 12623                                 TO W-VG-TEXT (81).
 12624
 12625     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 12626     MOVE SPACES                 TO DC-OPTION-CODE.
 12627     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12628
 12629     IF  NO-CONVERSION-ERROR
 12630         MOVE DC-GREG-DATE-1-EDIT
 12631                                 TO W-VG-TEXT (82).
 12632
 12633     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12634     MOVE SPACES                 TO DC-OPTION-CODE.
 12635     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12636
 12637     IF  NO-CONVERSION-ERROR
 12638         MOVE DC-GREG-DATE-1-EDIT
 12639                                 TO W-VG-TEXT (74).
 12640
 12641     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12642
 12643     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 12644         MOVE CM-PMT-EXTENSION-DAYS
 12645                                 TO DC-ELAPSED-DAYS
 12646     ELSE
 12647         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 12648
 12649     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12650     MOVE '6'                    TO DC-OPTION-CODE.
 12651     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12652
 12653     IF  NO-CONVERSION-ERROR
 12654         MOVE DC-GREG-DATE-1-EDIT
 12655                                 TO W-VG-TEXT (75).
 12656
 12657     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12658     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12659     MOVE '6'                    TO DC-OPTION-CODE.
 12660     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12661
 12662     IF  NO-CONVERSION-ERROR
 12663         MOVE DC-GREG-DATE-1-EDIT
 12664                                 TO W-VG-TEXT (76).
 12665
 12666 6450-EXIT.
 12667     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 264
* EL689.cbl
 12669 6500-GET-ACCOUNT-DATA.
 12670
 12671     IF  ADDRSI EQUAL '1'
 12672             AND
 12673         PI-CREATE-LABELS
 12674             AND
 12675         NOT PI-689-LABELS-OVERRIDEN
 12676         NEXT SENTENCE
 12677     ELSE
 12678         IF  W-FILE-NOT-USED (6)
 12679             GO TO 6500-EXIT
 12680         END-IF
 12681     END-IF.
 12682
 12683 6500-READ-ACCT-ONLY.
 12684
 12685     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 12686         MOVE ER-9327            TO EMI-ERROR
 12687         MOVE -1                 TO MAINTL
 12688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12689         GO TO 6500-EXIT.
 12690
 12691
 12692* EXEC CICS HANDLE CONDITION
 12693*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 12694*         NOTFND     (6500-ACCT-NOT-FOUND)
 12695*         ENDFILE    (6500-ONLY-STOP)
 12696*    END-EXEC.
 12697*    MOVE '"$JI''                 ! 1 #00012166' TO DFHEIV0
 12698     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 12699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12700     MOVE X'3120233030303132313636' TO DFHEIV0(25:11)
 12701     CALL 'kxdfhei1' USING DFHEIV0
 12702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12703
 12704
 12705
 12706* EXEC CICS STARTBR
 12707*         RIDFLD     (W-ACCT-KEY)
 12708*         DATASET    (W-ACCT-FILE-ID)
 12709*         KEYLENGTH  (20)
 12710*         GENERIC
 12711*    END-EXEC.
 12712     MOVE 20
 12713       TO DFHEIV11
 12714     MOVE 0
 12715       TO DFHEIV12
 12716*    MOVE '&,   KG    G          &   #00012172' TO DFHEIV0
 12717     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12718     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12719     MOVE X'2020233030303132313732' TO DFHEIV0(25:11)
 12720     CALL 'kxdfhei1' USING DFHEIV0,
 12721           W-ACCT-FILE-ID,
 12722           W-ACCT-KEY,
 12723           DFHEIV11,
 12724           DFHEIV12,
 12725           DFHEIV99
 12726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 265
* EL689.cbl
 12727
 12728
 12729     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 12730     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 12731
 12732 6500-READNEXT.
 12733
 12734
 12735* EXEC CICS READNEXT
 12736*         DATASET    (W-ACCT-FILE-ID)
 12737*         SET        (ADDRESS OF ACCOUNT-MASTER)
 12738*         RIDFLD     (W-ACCT-KEY)
 12739*    END-EXEC.
 12740     MOVE 0
 12741       TO DFHEIV11
 12742*    MOVE '&.S                   )   #00012184' TO DFHEIV0
 12743     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12744     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12745     MOVE X'2020233030303132313834' TO DFHEIV0(25:11)
 12746     CALL 'kxdfhei1' USING DFHEIV0,
 12747           W-ACCT-FILE-ID,
 12748           DFHEIV20,
 12749           DFHEIV99,
 12750           W-ACCT-KEY,
 12751           DFHEIV99,
 12752           DFHEIV11,
 12753           DFHEIV99,
 12754           DFHEIV99
 12755     SET ADDRESS OF ACCOUNT-MASTER TO
 12756         DFHEIV20
 12757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12758
 12759
 12760     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 12761         IF  PRIOR-MATCH-ACCT-PKEY
 12762             CONTINUE
 12763*            GO TO 6500-ONLY-STOP
 12764         ELSE
 12765             IF  W-FILE-NOT-USED (6)
 12766                 PERFORM 6500-ENDBR
 12767                 GO TO 6500-EXIT
 12768             ELSE
 12769                 GO TO 6500-ACCT-NOT-FOUND
 12770             END-IF
 12771         END-IF
 12772     ELSE
 12773         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 12774         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 12775         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 12776         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 12777         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 12778         MOVE AM-NAME              TO WS-SAV-AM-NAME
 12779         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 12780         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 12781         MOVE SPACES               TO WS-SAV-AM-CITY
 12782*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 12783         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 12784            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 266
* EL689.cbl
 12785         END-STRING
 12786         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 12787         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 12788         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 12789         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 12790         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 12791         GO TO 6500-READNEXT
 12792     END-IF
 12793     .
 12794 6500-ONLY-STOP.
 12795
 12796     IF  NOT PI-NO-CARRIER-SECURITY
 12797             AND
 12798         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 12799         MOVE -1                 TO CARRIERL
 12800         MOVE AL-UANON           TO CARRIERA
 12801         MOVE ER-9095            TO EMI-ERROR
 12802         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12803         PERFORM 6500-ENDBR
 12804         GO TO 8200-SEND-DATAONLY.
 12805
 12806     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12807     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 12808     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 12809     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 12810     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 12811
 12812     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 12813     MOVE SPACES                 TO W-LABEL-ZIP (5).
 12814
 12815     IF  SAVE-AM-CANADIAN-POST-CODE
 12816         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 12817                                 TO W-CANADIAN-POSTAL-CODES
 12818         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 12819         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 12820         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 12821                                    W-LAB-CAN-FILLER (5)
 12822     ELSE
 12823         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 12824
 12825         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12826             MOVE '-'            TO W-LABEL-DASH (5)
 12827             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 12828         ELSE
 12829             MOVE SPACES         TO W-LABEL-DASH (5)
 12830                                    W-LABEL-2ND-ZIP (5).
 12831
 12832     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12833
 12834     IF  ADDRSI EQUAL '1'
 12835             AND
 12836         PI-CREATE-LABELS
 12837             AND
 12838         NOT PI-689-LABELS-OVERRIDEN
 12839         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12840                                    W-VG-TEXT (40)
 12841         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12842                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 267
* EL689.cbl
 12843         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12844                                    W-VG-TEXT (42)
 12845         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12846                                    W-VG-TEXT (43)
 12847         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12848                                    W-VG-TEXT (44)
 12849         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12850                                    W-VG-TEXT (45)
 12851         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12852         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12853         SET W-RG-NDX UP BY +1
 12854     ELSE
 12855         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 12856         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 12857         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 12858         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 12859         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 12860         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 12861
 12862     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 12863             OR
 12864         WS-SAV-AM-TEL-NO EQUAL ZEROS
 12865         MOVE SPACES             TO W-VG-TEXT (46)
 12866     ELSE
 12867         MOVE ZEROS                  TO W-PHONE-IN
 12868         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 12869         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 12870         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 12871         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 12872
 12873     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 12874        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 12875     ELSE
 12876        MOVE SPACES                   TO W-VG-TEXT (47)
 12877     END-IF.
 12878     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 12879     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 12880                                 TO W-VG-TEXT (49)
 12881
 12882     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 12883     PERFORM 6500-ENDBR.
 12884
 12885     GO TO 6500-EXIT.
 12886
 12887 6500-ENDBR.
 12888
 12889     IF  W-ACCT-BROWSE-STARTED
 12890         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 12891
 12892* EXEC CICS ENDBR
 12893*            DATASET (W-ACCT-FILE-ID)
 12894*        END-EXEC
 12895     MOVE 0
 12896       TO DFHEIV11
 12897*    MOVE '&2                    $   #00012321' TO DFHEIV0
 12898     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12899     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12900     MOVE X'2020233030303132333231' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 268
* EL689.cbl
 12901     CALL 'kxdfhei1' USING DFHEIV0,
 12902           W-ACCT-FILE-ID,
 12903           DFHEIV11,
 12904           DFHEIV99
 12905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12906     END-IF.
 12907
 12908 6500-ACCT-NOT-FOUND.
 12909
 12910     PERFORM 6500-ENDBR.
 12911
 12912     IF  DATASORI NOT EQUAL '1'
 12913         MOVE ER-0179            TO EMI-ERROR
 12914         GO TO 6500-EXIT.
 12915
 12916     MOVE ER-0179                TO EMI-ERROR.
 12917     MOVE -1                     TO MAINTL.
 12918     MOVE AL-UNBON               TO MAINTA.
 12919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12920     GO TO 8200-SEND-DATAONLY.
 12921
 12922 6500-EXIT.
 12923     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 269
* EL689.cbl
 12925 6600-GET-COMPENSATION-DATA.
 12926
 12927     IF  ADDRSI EQUAL '4'
 12928             AND
 12929         PI-CREATE-LABELS
 12930             AND
 12931         NOT PI-689-LABELS-OVERRIDEN
 12932         NEXT SENTENCE
 12933     ELSE
 12934         IF  W-FILE-NOT-USED (10)
 12935             GO TO 6600-EXIT.
 12936
 12937     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 12938         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 12939         GO TO 6600-START.
 12940
 12941     IF  PI-ZERO-CARRIER
 12942             OR
 12943         PI-ZERO-CAR-GROUP
 12944         MOVE ZEROS              TO W-COMP-CARRIER.
 12945
 12946     IF  PI-ZERO-GROUPING
 12947             OR
 12948         PI-ZERO-CAR-GROUP
 12949         MOVE ZEROS              TO W-COMP-GROUPING.
 12950
 12951     IF  W-FILE-NOT-USED (6)
 12952         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 12953         IF  EMI-ERROR EQUAL ER-0179
 12954             MOVE ER-9327        TO EMI-ERROR
 12955             MOVE -1             TO MAINTL
 12956             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12957             GO TO 6600-EXIT.
 12958
 12959     MOVE  'A'                   TO W-COMP-TYPE.
 12960
 12961     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 12962         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 12963                                 TO W-COMP-RESP-PERSON
 12964     ELSE
 12965         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12966
 12967     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 12968        (W-NDX > +10)
 12969            OR
 12970         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 12971     END-PERFORM
 12972
 12973     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 12974         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 12975     ELSE
 12976         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12977
 12978     PERFORM 6500-ENDBR.
 12979     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12980
 12981     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 12982         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 270
* EL689.cbl
 12983         MOVE -1                 TO MAINTL
 12984         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12985         GO TO 6600-EXIT.
 12986
 12987 6600-START.
 12988
 12989
 12990* EXEC CICS HANDLE CONDITION
 12991*         NOTOPEN (8080-COMP-NOT-OPEN)
 12992*         NOTFND  (6600-COMP-NOT-FOUND)
 12993*    END-EXEC.
 12994*    MOVE '"$JI                  ! 2 #00012407' TO DFHEIV0
 12995     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12996     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12997     MOVE X'3220233030303132343037' TO DFHEIV0(25:11)
 12998     CALL 'kxdfhei1' USING DFHEIV0
 12999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13000
 13001
 13002
 13003* EXEC CICS STARTBR
 13004*         RIDFLD  (W-COMP-KEY)
 13005*         DATASET (W-COMP-FILE-ID)
 13006*    END-EXEC.
 13007     MOVE 0
 13008       TO DFHEIV11
 13009*    MOVE '&,         G          &   #00012412' TO DFHEIV0
 13010     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13011     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13012     MOVE X'2020233030303132343132' TO DFHEIV0(25:11)
 13013     CALL 'kxdfhei1' USING DFHEIV0,
 13014           W-COMP-FILE-ID,
 13015           W-COMP-KEY,
 13016           DFHEIV99,
 13017           DFHEIV11,
 13018           DFHEIV99
 13019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13020
 13021
 13022     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 13023
 13024 6600-READNEXT.
 13025
 13026
 13027* EXEC CICS READNEXT
 13028*         DATASET (W-COMP-FILE-ID)
 13029*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13030*         RIDFLD  (W-COMP-KEY)
 13031*    END-EXEC.
 13032     MOVE 0
 13033       TO DFHEIV11
 13034*    MOVE '&.S                   )   #00012421' TO DFHEIV0
 13035     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13036     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13037     MOVE X'2020233030303132343231' TO DFHEIV0(25:11)
 13038     CALL 'kxdfhei1' USING DFHEIV0,
 13039           W-COMP-FILE-ID,
 13040           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 271
* EL689.cbl
 13041           DFHEIV99,
 13042           W-COMP-KEY,
 13043           DFHEIV99,
 13044           DFHEIV11,
 13045           DFHEIV99,
 13046           DFHEIV99
 13047     SET ADDRESS OF COMPENSATION-MASTER TO
 13048         DFHEIV20
 13049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13050
 13051
 13052     IF CO-CONTROL-PRIMARY
 13053           NOT = W-COMP-SAVE-KEY
 13054        GO TO 6600-COMP-NOT-FOUND.
 13055
 13056     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13057     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 13058                                    W-VG-TEXT (140).
 13059     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13060     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13061     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13062*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13063     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13064        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13065     END-STRING
 13066
 13067     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13068
 13069     IF  CO-CANADIAN-POST-CODE
 13070         MOVE CO-CANADIAN-POSTAL-CODE
 13071                                 TO W-CANADIAN-POSTAL-CODES
 13072         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13073         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13074         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13075                                    W-LAB-CAN-FILLER (6)
 13076     ELSE
 13077         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13078
 13079         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13080             MOVE '-'            TO W-LABEL-DASH (6)
 13081             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13082         ELSE
 13083             MOVE SPACES         TO W-LABEL-DASH (6)
 13084                                    W-LABEL-2ND-ZIP (6).
 13085
 13086     IF  CO-TELEPHONE NOT NUMERIC
 13087             OR
 13088         CO-TELEPHONE = ZEROS
 13089         MOVE SPACES             TO W-VG-TEXT (147)
 13090     ELSE
 13091         MOVE ZEROS              TO W-PHONE-IN
 13092         MOVE CO-AREA-CODE       TO W-PO-AREA
 13093         MOVE CO-PREFIX          TO W-PO-PFX
 13094         MOVE CO-PHONE           TO W-PO-SFX
 13095         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 13096
 13097     IF (CO-FAXNO NOT NUMERIC)
 13098        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 272
* EL689.cbl
 13099        MOVE SPACES              TO W-VG-TEXT (182)
 13100     ELSE
 13101        MOVE ZEROS               TO W-PHONE-IN
 13102        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 13103        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 13104        MOVE CO-FAX-PHONE        TO W-PO-SFX
 13105        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 13106     END-IF
 13107     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 13108        MOVE SPACES              TO W-VG-TEXT (183)
 13109     ELSE
 13110        EVALUATE CO-GA-STATUS-CODE
 13111           WHEN 'A'
 13112              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 13113           WHEN 'I'
 13114              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 13115           WHEN 'P'
 13116              MOVE 'PENDING'     TO W-VG-TEXT (183)
 13117        END-EVALUATE
 13118     END-IF
 13119     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 13120        MOVE SPACES              TO W-VG-TEXT (181)
 13121     ELSE
 13122        EVALUATE CO-BILL-SW
 13123           WHEN 'B'
 13124              MOVE 'BILLED'      TO W-VG-TEXT (181)
 13125           WHEN 'R'
 13126              MOVE 'REMIT'       TO W-VG-TEXT (181)
 13127           WHEN 'T'
 13128              MOVE 'T'           TO W-VG-TEXT (181)
 13129           WHEN 'S'
 13130              MOVE 'S'           TO W-VG-TEXT (181)
 13131        END-EVALUATE
 13132     END-IF
 13133     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13134
 13135     IF  ADDRSI EQUAL '4'
 13136             AND
 13137         PI-CREATE-LABELS
 13138             AND
 13139         NOT PI-689-LABELS-OVERRIDEN
 13140         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13141                                    W-VG-TEXT (141)
 13142         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13143                                    W-VG-TEXT (142)
 13144         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13145                                    W-VG-TEXT (143)
 13146         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13147                                    W-VG-TEXT (144)
 13148         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13149                                    W-VG-TEXT (145)
 13150         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13151                                    W-VG-TEXT (146)
 13152         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13153         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13154         SET W-RG-NDX UP BY +1
 13155     ELSE
 13156         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 273
* EL689.cbl
 13157         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 13158         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 13159         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 13160         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 13161         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 13162
 13163     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 13164
 13165     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 13166     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 13167     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 13168
 13169     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 13170     MOVE '3'                    TO DC-OPTION-CODE.
 13171     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13172
 13173     IF  NO-CONVERSION-ERROR
 13174         MOVE DC-GREG-DATE-1-ALPHA
 13175                                 TO W-VG-TEXT (149).
 13176
 13177     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 13178     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 13179
 13180     PERFORM 6600-ENDBR.
 13181     GO TO 6600-EXIT.
 13182
 13183 6600-ENDBR.
 13184
 13185     IF  W-COMP-BROWSE-STARTED
 13186         MOVE 'N'                      TO W-COMP-BROWSE-SW
 13187
 13188* EXEC CICS ENDBR
 13189*             DATASET(W-COMP-FILE-ID)
 13190*        END-EXEC.
 13191     MOVE 0
 13192       TO DFHEIV11
 13193*    MOVE '&2                    $   #00012562' TO DFHEIV0
 13194     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13195     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13196     MOVE X'2020233030303132353632' TO DFHEIV0(25:11)
 13197     CALL 'kxdfhei1' USING DFHEIV0,
 13198           W-COMP-FILE-ID,
 13199           DFHEIV11,
 13200           DFHEIV99
 13201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13202
 13203
 13204 6600-COMP-NOT-FOUND.
 13205
 13206     PERFORM 6600-ENDBR.
 13207
 13208     IF ADDRSL GREATER ZERO
 13209         IF ADDRSI = '4'
 13210            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 13211                MOVE ER-7378                TO EMI-ERROR
 13212                MOVE -1                     TO TYPEL
 13213                MOVE AL-UNBON               TO TYPEA
 13214                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 274
* EL689.cbl
 13215                GO TO 8200-SEND-DATAONLY
 13216            ELSE
 13217                MOVE ER-2114                TO EMI-ERROR
 13218                MOVE -1                     TO ADDRSL
 13219                MOVE AL-UNBON               TO ADDRSA
 13220                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13221                GO TO 8200-SEND-DATAONLY.
 13222
 13223 6600-EXIT.
 13224     EXIT.
 13225 6620-GET-G-DATA.
 13226
 13227     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 13228
 13229     IF  CO-RPTCD2 GREATER THAN SPACES
 13230         MOVE SPACES             TO W-COMP-RESP-PERSON
 13231         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 13232         MOVE +10                TO W-CWA-NDX
 13233         PERFORM 6622-FIND-LAST-NON-SPACE
 13234         SET W-COMP-NDX          TO +10
 13235         PERFORM 6625-FILL-IN-RESP-PERSON.
 13236         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 13237
 13238     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 13239     MOVE 'G'                    TO W-COMP-TYPE.
 13240     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13241
 13242
 13243* EXEC CICS RESETBR
 13244*         RIDFLD  (W-COMP-KEY)
 13245*         DATASET (W-COMP-FILE-ID)
 13246*    END-EXEC.
 13247     MOVE 0
 13248       TO DFHEIV11
 13249*    MOVE '&4         G          &   #00012604' TO DFHEIV0
 13250     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 13251     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13252     MOVE X'2020233030303132363034' TO DFHEIV0(25:11)
 13253     CALL 'kxdfhei1' USING DFHEIV0,
 13254           W-COMP-FILE-ID,
 13255           W-COMP-KEY,
 13256           DFHEIV99,
 13257           DFHEIV11,
 13258           DFHEIV99
 13259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13260
 13261
 13262
 13263* EXEC CICS READNEXT
 13264*         DATASET (W-COMP-FILE-ID)
 13265*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13266*         RIDFLD  (W-COMP-KEY)
 13267*    END-EXEC.
 13268     MOVE 0
 13269       TO DFHEIV11
 13270*    MOVE '&.S                   )   #00012609' TO DFHEIV0
 13271     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13272     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 275
* EL689.cbl
 13273     MOVE X'2020233030303132363039' TO DFHEIV0(25:11)
 13274     CALL 'kxdfhei1' USING DFHEIV0,
 13275           W-COMP-FILE-ID,
 13276           DFHEIV20,
 13277           DFHEIV99,
 13278           W-COMP-KEY,
 13279           DFHEIV99,
 13280           DFHEIV11,
 13281           DFHEIV99,
 13282           DFHEIV99
 13283     SET ADDRESS OF COMPENSATION-MASTER TO
 13284         DFHEIV20
 13285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13286
 13287
 13288     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 13289         GO TO 6620-EXIT.
 13290
 13291     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13292     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 13293     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13294     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13295     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13296*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13297     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13298        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13299     END-STRING
 13300
 13301     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13302
 13303     IF  CO-CANADIAN-POST-CODE
 13304         MOVE CO-CANADIAN-POSTAL-CODE
 13305                                 TO W-CANADIAN-POSTAL-CODES
 13306         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13307         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13308         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13309                                    W-LAB-CAN-FILLER (6)
 13310     ELSE
 13311         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13312         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13313             MOVE '-'            TO W-LABEL-DASH (6)
 13314             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13315         ELSE
 13316             MOVE SPACES         TO W-LABEL-DASH (6)
 13317                                    W-LABEL-2ND-ZIP (6).
 13318
 13319     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13320
 13321     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 13322     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 13323     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 13324     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 13325     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 13326     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 13327
 13328 6620-EXIT.
 13329     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 276
* EL689.cbl
 13331 6622-FIND-LAST-NON-SPACE.
 13332
 13333     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 13334         SUBTRACT +1 FROM W-CWA-NDX
 13335         GO TO 6622-FIND-LAST-NON-SPACE.
 13336
 13337 6622-EXIT.
 13338     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 277
* EL689.cbl
 13340 6625-FILL-IN-RESP-PERSON.
 13341
 13342     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 13343     SET W-COMP-NDX DOWN BY +1.
 13344     SUBTRACT +1 FROM W-CWA-NDX.
 13345
 13346     IF  W-CWA-NDX GREATER THAN ZEROS
 13347         GO TO 6625-FILL-IN-RESP-PERSON.
 13348
 13349 6625-EXIT.
 13350     EXIT.
 13351 6626-GET-B-DATA.
 13352     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 13353     IF W-FILE-USED (8)
 13354        PERFORM 6450-READ-CERT-ONLY
 13355        IF W-CERT-FOUND
 13356           MOVE CM-BENEFICIARY (1:10)
 13357                                 TO W-COMP-RESP-PERSON
 13358        ELSE
 13359           MOVE SPACES           TO W-COMP-RESP-PERSON
 13360           GO TO 6626-EXIT
 13361        END-IF
 13362     ELSE
 13363        MOVE CM-BENEFICIARY (1:10)
 13364                                 TO W-COMP-RESP-PERSON
 13365     END-IF
 13366     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 13367     MOVE 'B'                    TO W-COMP-TYPE
 13368     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 13369
 13370
 13371* EXEC CICS RESETBR
 13372*         RIDFLD  (W-COMP-KEY)
 13373*         DATASET (W-COMP-FILE-ID)
 13374*    END-EXEC.
 13375     MOVE 0
 13376       TO DFHEIV11
 13377*    MOVE '&4         G          &   #00012697' TO DFHEIV0
 13378     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 13379     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13380     MOVE X'2020233030303132363937' TO DFHEIV0(25:11)
 13381     CALL 'kxdfhei1' USING DFHEIV0,
 13382           W-COMP-FILE-ID,
 13383           W-COMP-KEY,
 13384           DFHEIV99,
 13385           DFHEIV11,
 13386           DFHEIV99
 13387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13388
 13389
 13390
 13391* EXEC CICS READNEXT
 13392*         DATASET (W-COMP-FILE-ID)
 13393*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13394*         RIDFLD  (W-COMP-KEY)
 13395*    END-EXEC.
 13396     MOVE 0
 13397       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 278
* EL689.cbl
 13398*    MOVE '&.S                   )   #00012702' TO DFHEIV0
 13399     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13400     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13401     MOVE X'2020233030303132373032' TO DFHEIV0(25:11)
 13402     CALL 'kxdfhei1' USING DFHEIV0,
 13403           W-COMP-FILE-ID,
 13404           DFHEIV20,
 13405           DFHEIV99,
 13406           W-COMP-KEY,
 13407           DFHEIV99,
 13408           DFHEIV11,
 13409           DFHEIV99,
 13410           DFHEIV99
 13411     SET ADDRESS OF COMPENSATION-MASTER TO
 13412         DFHEIV20
 13413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13414
 13415
 13416     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 13417         GO TO 6626-EXIT.
 13418
 13419     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13420     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 13421     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13422     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13423     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13424*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13425     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13426        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13427     END-STRING
 13428
 13429     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13430
 13431     IF  CO-CANADIAN-POST-CODE
 13432         MOVE CO-CANADIAN-POSTAL-CODE
 13433                                 TO W-CANADIAN-POSTAL-CODES
 13434         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13435         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13436         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13437                                    W-LAB-CAN-FILLER (6)
 13438     ELSE
 13439         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13440         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13441             MOVE '-'            TO W-LABEL-DASH (6)
 13442             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13443         ELSE
 13444             MOVE SPACES         TO W-LABEL-DASH (6)
 13445                                    W-LABEL-2ND-ZIP (6).
 13446
 13447     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13448
 13449     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 13450     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 13451     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 13452     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 13453     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 13454     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 13455
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 279
* EL689.cbl
 13456 6626-EXIT.
 13457     EXIT.
 13458 6630-GET-CSR-NAME.
 13459
 13460     MOVE SPACES                 TO W-CNTL-KEY.
 13461     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 13462     MOVE +0                     TO W-CNTL-SEQ-NO.
 13463     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 13464     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 13465
 13466
 13467* EXEC CICS HANDLE CONDITION
 13468*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13469*         NOTFND     (6630-CNTL2-NOT-FOUND)
 13470*    END-EXEC.
 13471*    MOVE '"$JI                  ! 3 #00012758' TO DFHEIV0
 13472     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13474     MOVE X'3320233030303132373538' TO DFHEIV0(25:11)
 13475     CALL 'kxdfhei1' USING DFHEIV0
 13476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13477
 13478
 13479
 13480* EXEC CICS READ
 13481*         DATASET    (W-CNTL-FILE-ID)
 13482*         SET        (ADDRESS OF CONTROL-FILE)
 13483*         RIDFLD     (W-CNTL-KEY)
 13484*    END-EXEC.
 13485*    MOVE '&"S        E          (   #00012763' TO DFHEIV0
 13486     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13487     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13488     MOVE X'2020233030303132373633' TO DFHEIV0(25:11)
 13489     CALL 'kxdfhei1' USING DFHEIV0,
 13490           W-CNTL-FILE-ID,
 13491           DFHEIV20,
 13492           DFHEIV99,
 13493           W-CNTL-KEY,
 13494           DFHEIV99,
 13495           DFHEIV99,
 13496           DFHEIV99
 13497     SET ADDRESS OF CONTROL-FILE TO
 13498         DFHEIV20
 13499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13500
 13501
 13502     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 13503     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 13504     GO TO 6630-EXIT.
 13505
 13506 6630-CNTL2-NOT-FOUND.
 13507
 13508*    MOVE ER-8965                TO EMI-ERROR.
 13509*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13510*    MOVE -1                     TO MAINTL.
 13511*    MOVE AL-UANON               TO MAINTA.
 13512*    GO TO 8200-SEND-DATAONLY
 13513     .
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 280
* EL689.cbl
 13514 6630-EXIT.
 13515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 281
* EL689.cbl
 13517 6700-GET-MAIL-DATA.
 13518
 13519     IF  ADDRSI EQUAL '5'
 13520             AND
 13521         PI-CREATE-LABELS
 13522             AND
 13523         NOT PI-689-LABELS-OVERRIDEN
 13524         NEXT SENTENCE
 13525     ELSE
 13526         IF  W-FILE-NOT-USED (5)
 13527             GO TO 6700-EXIT.
 13528
 13529     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 13530         MOVE ER-9327            TO EMI-ERROR
 13531         MOVE -1                 TO MAINTL
 13532         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13533         GO TO 6700-EXIT.
 13534
 13535
 13536* EXEC CICS HANDLE CONDITION
 13537*         NOTOPEN (8090-MAIL-NOT-OPEN)
 13538*         NOTFND  (6700-MAIL-NOT-FOUND)
 13539*    END-EXEC.
 13540*    MOVE '"$JI                  ! 4 #00012802' TO DFHEIV0
 13541     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13543     MOVE X'3420233030303132383032' TO DFHEIV0(25:11)
 13544     CALL 'kxdfhei1' USING DFHEIV0
 13545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13546
 13547
 13548
 13549* EXEC CICS READ
 13550*         DATASET(W-MAIL-FILE-ID)
 13551*         SET    (ADDRESS OF MAILING-DATA)
 13552*         RIDFLD (W-MAIL-KEY)
 13553*    END-EXEC.
 13554*    MOVE '&"S        E          (   #00012807' TO DFHEIV0
 13555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13557     MOVE X'2020233030303132383037' TO DFHEIV0(25:11)
 13558     CALL 'kxdfhei1' USING DFHEIV0,
 13559           W-MAIL-FILE-ID,
 13560           DFHEIV20,
 13561           DFHEIV99,
 13562           W-MAIL-KEY,
 13563           DFHEIV99,
 13564           DFHEIV99,
 13565           DFHEIV99
 13566     SET ADDRESS OF MAILING-DATA TO
 13567         DFHEIV20
 13568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13569
 13570
 13571     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 13572     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13573     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 13574     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 282
* EL689.cbl
 13575
 13576     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13577     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 13578     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 13579     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 13580     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 13581*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 13582     STRING MA-CITY ' ' MA-ADDR-STATE
 13583        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13584     END-STRING
 13585
 13586     MOVE MA-ZIP                 TO W-WORK-ZIP.
 13587     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13588
 13589     IF  MA-CANADIAN-POST-CODE
 13590         MOVE MA-CANADIAN-POSTAL-CODE
 13591                                 TO W-CANADIAN-POSTAL-CODES
 13592         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13593         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13594         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13595                                    W-LAB-CAN-FILLER (6)
 13596     ELSE
 13597         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13598         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13599             MOVE '-'            TO W-LABEL-DASH (6)
 13600             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13601         ELSE
 13602             MOVE SPACES         TO W-LABEL-DASH (6)
 13603                                    W-LABEL-2ND-ZIP (6).
 13604
 13605     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13606
 13607     IF  ADDRSI EQUAL '5'
 13608             AND
 13609         PI-CREATE-LABELS
 13610             AND
 13611         NOT PI-689-LABELS-OVERRIDEN
 13612         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13613                                    W-VG-TEXT (31)
 13614         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13615                                    W-VG-TEXT (32)
 13616         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13617                                    W-VG-TEXT (33)
 13618         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13619                                    W-VG-TEXT (34)
 13620         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13621                                    W-VG-TEXT (35)
 13622         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13623                                    W-VG-TEXT (36)
 13624         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13625         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13626         SET W-RG-NDX UP BY +1
 13627     ELSE
 13628         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 13629         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 13630         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 13631         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 13632         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 283
* EL689.cbl
 13633         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 13634     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13635     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 13636     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 13637     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 13638     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 13639        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 13640     END-STRING
 13641
 13642     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 13643     MOVE SPACES                 TO W-LABEL-ZIP (5)
 13644
 13645     IF  MA-CB-CANADIAN-POST-CODE
 13646         MOVE MA-CB-CANADIAN-POSTAL-CODE
 13647                                 TO W-CANADIAN-POSTAL-CODES
 13648         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13649         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13650         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13651                                    W-LAB-CAN-FILLER (5)
 13652     ELSE
 13653         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13654         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13655             MOVE '-'            TO W-LABEL-DASH (5)
 13656             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13657         ELSE
 13658             MOVE SPACES         TO W-LABEL-DASH (5)
 13659                                    W-LABEL-2ND-ZIP (5)
 13660         END-IF
 13661     END-IF
 13662     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 13663     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 13664     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 13665     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 13666     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 13667     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 13668     GO TO 6700-EXIT.
 13669
 13670 6700-MAIL-NOT-FOUND.
 13671
 13672     IF  ADDRSL GREATER ZERO
 13673         IF ADDRSI = '5'
 13674            MOVE ER-3000         TO EMI-ERROR
 13675            MOVE -1              TO ADDRSL
 13676            MOVE AL-UNBON        TO ADDRSA
 13677            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13678            GO TO 8200-SEND-DATAONLY.
 13679
 13680 6700-EXIT.
 13681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 284
* EL689.cbl
 13683 6750-GET-LIFE-BENEFIT-DATA.
 13684
 13685     IF  W-FILE-NOT-USED (2)
 13686         GO TO 6750-EXIT.
 13687
 13688     MOVE SPACES                 TO W-CNTL-GEN2.
 13689
 13690     IF  DATASORI EQUAL '2'
 13691         IF  W-FILE-NOT-USED (8)
 13692             PERFORM 6450-READ-CERT-ONLY
 13693             IF  W-CERT-FOUND
 13694                 MOVE CM-LF-BENEFIT-CD
 13695                                 TO W-BEN-HOLD
 13696                                    W-CNTL-GEN2
 13697             ELSE
 13698                 NEXT SENTENCE
 13699         ELSE
 13700             MOVE CM-LF-BENEFIT-CD
 13701                                 TO W-BEN-HOLD
 13702                                    W-CNTL-GEN2
 13703     ELSE
 13704         IF  DATASORI EQUAL '4'
 13705             IF  W-FILE-NOT-USED (9)
 13706                 PERFORM 6400-READ-PNDB-ONLY
 13707                 IF  W-PNDB-FOUND
 13708                     IF  PI-689-TYPE = '1'
 13709                         MOVE PB-I-LF-BENEFIT-CD
 13710                                 TO W-BEN-HOLD
 13711                                    W-CNTL-GEN2
 13712                     ELSE
 13713                         MOVE PB-CI-LF-BENEFIT-CD
 13714                                 TO W-BEN-HOLD
 13715                                    W-CNTL-GEN2
 13716             ELSE
 13717                 NEXT SENTENCE
 13718         ELSE
 13719             IF  W-FILE-USED (8)
 13720                 MOVE CM-LF-BENEFIT-CD
 13721                                 TO W-BEN-HOLD
 13722                                    W-CNTL-GEN2
 13723             ELSE
 13724                 IF  W-FILE-USED (9)
 13725                     IF  PI-689-TYPE = '1'
 13726                         MOVE PB-I-LF-BENEFIT-CD
 13727                                 TO W-BEN-HOLD
 13728                                    W-CNTL-GEN2
 13729                     ELSE
 13730                         MOVE PB-CI-LF-BENEFIT-CD
 13731                                 TO W-BEN-HOLD
 13732                                    W-CNTL-GEN2.
 13733
 13734     IF  W-CNTL-GEN2 EQUAL SPACES
 13735         MOVE ER-9327            TO EMI-ERROR
 13736         MOVE -1                 TO MAINTL
 13737         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13738         GO TO 6750-EXIT.
 13739
 13740     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 285
* EL689.cbl
 13741     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 13742     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13743
 13744
 13745* EXEC CICS HANDLE CONDITION
 13746*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13747*         NOTFND  (6750-EXIT)
 13748*    END-EXEC.
 13749*    MOVE '"$JI                  ! 5 #00012986' TO DFHEIV0
 13750     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13752     MOVE X'3520233030303132393836' TO DFHEIV0(25:11)
 13753     CALL 'kxdfhei1' USING DFHEIV0
 13754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13755
 13756
 13757
 13758* EXEC CICS READ
 13759*         DATASET (W-CNTL-FILE-ID)
 13760*         SET     (ADDRESS OF CONTROL-FILE)
 13761*         GTEQ
 13762*         RIDFLD  (W-CNTL-KEY)
 13763*    END-EXEC.
 13764*    MOVE '&"S        G          (   #00012991' TO DFHEIV0
 13765     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13766     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13767     MOVE X'2020233030303132393931' TO DFHEIV0(25:11)
 13768     CALL 'kxdfhei1' USING DFHEIV0,
 13769           W-CNTL-FILE-ID,
 13770           DFHEIV20,
 13771           DFHEIV99,
 13772           W-CNTL-KEY,
 13773           DFHEIV99,
 13774           DFHEIV99,
 13775           DFHEIV99
 13776     SET ADDRESS OF CONTROL-FILE TO
 13777         DFHEIV20
 13778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13779
 13780
 13781     MOVE 1                      TO W-NDX.
 13782
 13783 6750-LOOP.
 13784
 13785     IF  W-NDX = 9
 13786         GO TO 6750-EXIT.
 13787
 13788     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13789         ADD 1                   TO W-NDX
 13790         GO TO 6750-LOOP.
 13791
 13792     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13793         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13794                                 TO W-VG-TEXT (11).
 13795
 13796 6750-EXIT.
 13797     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 286
* EL689.cbl
 13799 6800-GET-A-H-BENEFIT-DATA.
 13800
 13801     IF  W-FILE-NOT-USED (3)
 13802         GO TO 6800-EXIT.
 13803
 13804     MOVE SPACES                 TO W-CNTL-GEN2.
 13805
 13806     IF  DATASORI EQUAL '2'
 13807         IF  W-FILE-NOT-USED (8)
 13808             PERFORM 6450-READ-CERT-ONLY
 13809             IF  W-CERT-FOUND
 13810                 MOVE CM-AH-BENEFIT-CD
 13811                                 TO W-BEN-HOLD
 13812                                    W-CNTL-GEN2
 13813             ELSE
 13814                 NEXT SENTENCE
 13815         ELSE
 13816             MOVE CM-AH-BENEFIT-CD
 13817                                 TO W-BEN-HOLD
 13818                                    W-CNTL-GEN2
 13819     ELSE
 13820         IF  DATASORI EQUAL '4'
 13821             IF  W-FILE-NOT-USED (9)
 13822                 PERFORM 6400-READ-PNDB-ONLY
 13823                 IF  W-PNDB-FOUND
 13824                     IF  PI-689-TYPE = '1'
 13825                         MOVE PB-I-AH-BENEFIT-CD
 13826                                 TO W-BEN-HOLD
 13827                                    W-CNTL-GEN2
 13828                     ELSE
 13829                         MOVE PB-CI-AH-BENEFIT-CD
 13830                                 TO W-BEN-HOLD
 13831                                    W-CNTL-GEN2
 13832             ELSE
 13833                 NEXT SENTENCE
 13834         ELSE
 13835             IF  W-FILE-USED (8)
 13836                 MOVE CM-AH-BENEFIT-CD
 13837                                 TO W-BEN-HOLD
 13838                                    W-CNTL-GEN2
 13839             ELSE
 13840                 IF  W-FILE-USED (9)
 13841                     IF  PI-689-TYPE = '1'
 13842                         MOVE PB-I-AH-BENEFIT-CD
 13843                                 TO W-BEN-HOLD
 13844                                    W-CNTL-GEN2
 13845                     ELSE
 13846                         MOVE PB-CI-AH-BENEFIT-CD
 13847                                 TO W-BEN-HOLD
 13848                                    W-CNTL-GEN2.
 13849
 13850     IF  W-CNTL-GEN2 EQUAL SPACES
 13851         MOVE ER-9327            TO EMI-ERROR
 13852         MOVE -1                 TO MAINTL
 13853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13854         GO TO 6800-EXIT.
 13855
 13856     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 287
* EL689.cbl
 13857     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 13858     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13859
 13860
 13861* EXEC CICS HANDLE CONDITION
 13862*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13863*         NOTFND  (6800-EXIT)
 13864*    END-EXEC.
 13865*    MOVE '"$JI                  ! 6 #00013077' TO DFHEIV0
 13866     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13868     MOVE X'3620233030303133303737' TO DFHEIV0(25:11)
 13869     CALL 'kxdfhei1' USING DFHEIV0
 13870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13871
 13872
 13873
 13874* EXEC CICS READ
 13875*         DATASET (W-CNTL-FILE-ID)
 13876*         SET     (ADDRESS OF CONTROL-FILE)
 13877*         RIDFLD  (W-CNTL-KEY)
 13878*         GTEQ
 13879*    END-EXEC.
 13880*    MOVE '&"S        G          (   #00013082' TO DFHEIV0
 13881     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13883     MOVE X'2020233030303133303832' TO DFHEIV0(25:11)
 13884     CALL 'kxdfhei1' USING DFHEIV0,
 13885           W-CNTL-FILE-ID,
 13886           DFHEIV20,
 13887           DFHEIV99,
 13888           W-CNTL-KEY,
 13889           DFHEIV99,
 13890           DFHEIV99,
 13891           DFHEIV99
 13892     SET ADDRESS OF CONTROL-FILE TO
 13893         DFHEIV20
 13894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13895
 13896
 13897     MOVE 1                      TO W-NDX.
 13898
 13899 6800-LOOP-AH.
 13900
 13901     IF  W-NDX = 9
 13902         GO TO 6800-EXIT.
 13903
 13904     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13905         ADD 1                   TO W-NDX
 13906         GO TO 6800-LOOP-AH.
 13907
 13908     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13909         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13910                                 TO W-VG-TEXT (15)
 13911         MOVE CF-BENEFIT-ALPHA (W-NDX)
 13912                                 TO W-BENEFIT-WORK
 13913         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 13914
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 288
* EL689.cbl
 13915 6800-EXIT.
 13916     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 289
* EL689.cbl
 13918 6850-GET-CHECK-DATA.
 13919
 13920     IF  ADDRSI EQUAL '6'
 13921             AND
 13922         PI-CREATE-LABELS
 13923             AND
 13924         NOT PI-689-LABELS-OVERRIDEN
 13925         NEXT SENTENCE
 13926     ELSE
 13927         IF  W-FILE-NOT-USED (12)
 13928             GO TO 6850-EXIT.
 13929
 13930     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 13931         MOVE ER-9327            TO EMI-ERROR
 13932         MOVE -1                 TO MAINTL
 13933         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13934         GO TO 6850-EXIT.
 13935
 13936
 13937* EXEC CICS HANDLE CONDITION
 13938*         NOTOPEN (8045-CHEK-NOT-OPEN)
 13939*         NOTFND  (6850-CHEK-NOT-FOUND)
 13940*    END-EXEC.
 13941*    MOVE '"$JI                  ! 7 #00013128' TO DFHEIV0
 13942     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13944     MOVE X'3720233030303133313238' TO DFHEIV0(25:11)
 13945     CALL 'kxdfhei1' USING DFHEIV0
 13946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13947
 13948
 13949
 13950* EXEC CICS READ
 13951*         DATASET (W-CHEK-FILE-ID)
 13952*         SET     (ADDRESS OF CHECK-RECORDS)
 13953*         RIDFLD  (W-CHEK-KEY)
 13954*    END-EXEC.
 13955*    MOVE '&"S        E          (   #00013133' TO DFHEIV0
 13956     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13958     MOVE X'2020233030303133313333' TO DFHEIV0(25:11)
 13959     CALL 'kxdfhei1' USING DFHEIV0,
 13960           W-CHEK-FILE-ID,
 13961           DFHEIV20,
 13962           DFHEIV99,
 13963           W-CHEK-KEY,
 13964           DFHEIV99,
 13965           DFHEIV99,
 13966           DFHEIV99
 13967     SET ADDRESS OF CHECK-RECORDS TO
 13968         DFHEIV20
 13969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13970
 13971
 13972     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 13973     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 13974     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 13975     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 290
* EL689.cbl
 13976                                    PI-689-CONTROL.
 13977     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 13978     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 13979
 13980     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13981     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 13982     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 13983     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 13984     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 13985     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 13986
 13987     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 13988     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13989
 13990     IF  CH-CANADIAN-POST-CODE
 13991         MOVE CH-CANADIAN-POSTAL-CODE
 13992                                 TO W-CANADIAN-POSTAL-CODES
 13993         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13994         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13995         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13996                                    W-LAB-CAN-FILLER (6)
 13997     ELSE
 13998         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13999         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14000             MOVE '-'            TO W-LABEL-DASH (6)
 14001             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14002         ELSE
 14003             MOVE SPACES         TO W-LABEL-DASH (6)
 14004                                    W-LABEL-2ND-ZIP (6).
 14005
 14006     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14007
 14008     IF  ADDRSI EQUAL '6'
 14009             AND
 14010         PI-CREATE-LABELS
 14011             AND
 14012         NOT PI-689-LABELS-OVERRIDEN
 14013         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14014                                    W-VG-TEXT (159)
 14015         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14016                                    W-VG-TEXT (160)
 14017         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14018                                    W-VG-TEXT (161)
 14019         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14020                                    W-VG-TEXT (162)
 14021         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14022                                    W-VG-TEXT (163)
 14023         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14024                                    W-VG-TEXT (164)
 14025         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14026         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14027         SET W-RG-NDX UP BY +1
 14028     ELSE
 14029         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 14030         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 14031         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 14032         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 14033         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 291
* EL689.cbl
 14034         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 14035
 14036     GO TO 6850-EXIT.
 14037
 14038 6850-CHEK-NOT-FOUND.
 14039
 14040     IF  ADDRSL GREATER ZERO
 14041         IF ADDRSI = '6'
 14042            MOVE ER-2908         TO EMI-ERROR
 14043            MOVE -1              TO ADDRSL
 14044            MOVE AL-UNBON        TO ADDRSA
 14045            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14046            GO TO 8200-SEND-DATAONLY.
 14047
 14048 6850-EXIT.
 14049     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 292
* EL689.cbl
 14051 6900-GET-PYAJ-DATA.
 14052
 14053     IF  W-FILE-NOT-USED (13)
 14054         GO TO 6900-EXIT.
 14055
 14056     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 14057         MOVE ER-9327            TO EMI-ERROR
 14058         MOVE -1                 TO MAINTL
 14059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14060         GO TO 6900-EXIT.
 14061
 14062
 14063* EXEC CICS HANDLE CONDITION
 14064*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 14065*         NOTFND  (6900-PYAJ-NOT-FOUND)
 14066*    END-EXEC.
 14067*    MOVE '"$JI                  ! 8 #00013229' TO DFHEIV0
 14068     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14070     MOVE X'3820233030303133323239' TO DFHEIV0(25:11)
 14071     CALL 'kxdfhei1' USING DFHEIV0
 14072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14073
 14074
 14075 6900-READ-NEXT.
 14076
 14077
 14078* EXEC CICS READ
 14079*         DATASET (W-PYAJ-FILE-ID)
 14080*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 14081*         RIDFLD  (W-PYAJ-KEY)
 14082*         GTEQ
 14083*    END-EXEC.
 14084*    MOVE '&"S        G          (   #00013236' TO DFHEIV0
 14085     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14087     MOVE X'2020233030303133323336' TO DFHEIV0(25:11)
 14088     CALL 'kxdfhei1' USING DFHEIV0,
 14089           W-PYAJ-FILE-ID,
 14090           DFHEIV20,
 14091           DFHEIV99,
 14092           W-PYAJ-KEY,
 14093           DFHEIV99,
 14094           DFHEIV99,
 14095           DFHEIV99
 14096     SET ADDRESS OF PENDING-PAY-ADJ TO
 14097         DFHEIV20
 14098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14099
 14100
 14101     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 14102             OR
 14103         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 14104             OR
 14105         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 14106             OR
 14107         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 14108             OR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 293
* EL689.cbl
 14109         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 14110         GO TO 6900-PYAJ-NOT-FOUND.
 14111
 14112     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 14113             AND
 14114         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 14115         GO TO 6900-PYAJ-NOT-FOUND.
 14116
 14117     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 14118         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 14119         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 14120         GO TO 6900-READ-NEXT.
 14121
 14122     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 14123     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 14124
 14125     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 14126     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 14127
 14128     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 14129                                    PI-689-CONTROL.
 14130     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 14131     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 14132
 14133     GO TO 6900-EXIT.
 14134
 14135 6900-PYAJ-NOT-FOUND.
 14136
 14137     MOVE ER-7395                TO EMI-ERROR
 14138     MOVE -1                     TO DATASORL
 14139     MOVE AL-UNBON               TO DATASORA
 14140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14141     GO TO 8200-SEND-DATAONLY.
 14142
 14143 6900-EXIT.
 14144     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 294
* EL689.cbl
 14146 6950-MOVE-SYSTEM-DATA.
 14147
 14148     IF  W-FILE-NOT-USED (7)
 14149         GO TO 6950-EXIT.
 14150
 14151     MOVE EIBDATE                TO W-DATE-WORK.
 14152     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 14153     MOVE '5'                    TO DC-OPTION-CODE.
 14154     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14155     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 14156     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 14157
 14158     MOVE FORMI                  TO W-VG-TEXT (62).
 14159
 14160     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 14161         MOVE PI-689-VARIABLE-DATA-1
 14162                                 TO W-VG-TEXT (63)
 14163         MOVE PI-689-VARIABLE-DATA-2
 14164                                 TO W-VG-TEXT (64)
 14165         MOVE PI-689-VARIABLE-DATA-3
 14166                                 TO W-VG-TEXT (65)
 14167         MOVE PI-689-VARIABLE-DATA-4
 14168                                 TO W-VG-TEXT (66)
 14169     ELSE
 14170         MOVE '(VARIABLE NOT PROVIDED)'
 14171                                 TO W-VG-TEXT (63).
 14172
 14173 6950-EXIT.
 14174     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 295
* EL689.cbl
 14176 7000-FORMAT-SCREEN.
 14177
 14178     IF  MAINTI EQUAL 'S'
 14179             OR
 14180         PI-SHOW-MODE
 14181         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 14182     ELSE
 14183         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 14184
 14185     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 14186         SET W-LINE23            TO W-RG-NDX
 14187         MOVE 'A'                TO W-LINE1
 14188     ELSE
 14189         SET W-LIN-NUM           TO W-RG-NDX
 14190         COMPUTE W-LIN-NUM
 14191             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 14192
 14193     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 14194     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 14195     SET W-RG-NDX UP BY 1.
 14196
 14197 7000-EXIT.
 14198      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 296
* EL689.cbl
 14200 7100-FORMAT-LAST-NAME-1ST.
 14201*****************************************************************
 14202*             M O V E   N A M E   R O U T I N E                 *
 14203*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14204*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14205*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14206*                  FIELD                   VALUE                *
 14207*           W-NAME-LAST    (CL15)      SMITH                    *
 14208*           W-NAME-FIRST   (CL15)      JOHN                     *
 14209*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14210*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14211*     CONTAIN                                                   *
 14212*                SMITH, JOHN ALLEN                              *
 14213*     OR                                                        *
 14214*                SMITH, JOHN A.                                 *
 14215*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14216*     COPYBOOK, ELCNWA.                                         *
 14217*****************************************************************.
 14218
 14219     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14220     MOVE ZERO                   TO WS-NAME-SW.
 14221     SET NWA-INDEX               TO +1.
 14222
 14223     IF  W-NAME-LAST EQUAL SPACES
 14224             AND
 14225         W-NAME-MIDDLE EQUAL SPACES
 14226         MOVE +1                 TO WS-NAME-SW.
 14227
 14228     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14229     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14230
 14231     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14232     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14233
 14234     SET NWA-INDEX UP BY +1.
 14235
 14236     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 14237         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 14238             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14239             SET NWA-INDEX UP BY +1
 14240             MOVE '.'            TO WS-NW (NWA-INDEX)
 14241             SET NWA-INDEX UP BY +2
 14242         ELSE
 14243             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14244             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14245
 14246 7100-EXIT.
 14247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 297
* EL689.cbl
 14249 7110-MOVE-NAME.
 14250
 14251     IF  WS-NAME-SW GREATER THAN +1
 14252         GO TO 7110-EXIT.
 14253
 14254     IF  WS-NAME-WORK2 = SPACES
 14255         GO TO 7110-EXIT.
 14256
 14257     SET NWA-INDEX2            TO +1.
 14258     SET NWA-INDEX3            TO +2.
 14259
 14260 7110-MOVE-NAME-CYCLE.
 14261
 14262     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14263
 14264     IF  NWA-INDEX LESS THAN +30
 14265         SET NWA-INDEX UP BY +1
 14266     ELSE
 14267         ADD +2                TO WS-NAME-SW
 14268         GO TO 7110-EXIT.
 14269
 14270     IF  NWA-INDEX2 LESS THAN +20
 14271         SET NWA-INDEX3 UP BY +1
 14272         SET NWA-INDEX2 UP BY +1.
 14273
 14274     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 14275             AND
 14276         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 14277         IF  WS-NAME-SW EQUAL ZERO
 14278             MOVE ','            TO WS-NW (NWA-INDEX)
 14279             SET NWA-INDEX UP BY +2
 14280             MOVE +1             TO WS-NAME-SW
 14281             GO TO 7110-EXIT
 14282         ELSE
 14283             GO TO 7110-EXIT.
 14284
 14285     GO TO 7110-MOVE-NAME-CYCLE.
 14286
 14287 7110-EXIT.
 14288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 298
* EL689.cbl
 14290 7200-FORMAT-NAME-STRAIGHT.
 14291*****************************************************************
 14292*           M O V E   N A M E   R O U T I N E                   *
 14293*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14294*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14295*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14296*                  FIELD                   VALUE                *
 14297*           W-NAME-LAST    (CL15)      SMITH                    *
 14298*           W-NAME-FIRST   (CL15)      JOHN                     *
 14299*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14300*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14301*     CONTAIN                                                   *
 14302*              JOHN A. SMITH                                    *
 14303*     OR                                                        *
 14304*              JOHN ALLEN SMITH                                 *
 14305*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14306*     COPYBOOK, ELCNWA.                                         *
 14307*****************************************************************
 14308
 14309     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14310     MOVE ZERO                   TO WS-NAME-SW.
 14311     SET NWA-INDEX               TO +1.
 14312
 14313     IF  W-NAME-FIRST EQUAL SPACES
 14314             AND
 14315         W-NAME-MIDDLE EQUAL SPACES
 14316         MOVE W-NAME-LAST        TO WS-NAME-WORK
 14317         GO TO 7200-EXIT.
 14318
 14319     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14320     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14321
 14322     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 14323         SET NWA-INDEX UP BY +1
 14324
 14325         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 14326             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14327             SET NWA-INDEX UP BY +1
 14328             MOVE '.'            TO WS-NW (NWA-INDEX)
 14329             SET NWA-INDEX UP BY +1
 14330
 14331         ELSE
 14332             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14333             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14334
 14335     SET NWA-INDEX UP BY +1
 14336     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14337     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14338
 14339 7200-EXIT.
 14340     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 299
* EL689.cbl
 14342 7290-MOVE-NAME.
 14343
 14344     IF  WS-NAME-SW GREATER THAN +1
 14345         GO TO 7290-EXIT.
 14346
 14347     IF  WS-NAME-WORK2 EQUAL SPACES
 14348         GO TO 7290-EXIT.
 14349
 14350     SET NWA-INDEX2            TO +1.
 14351     SET NWA-INDEX3            TO +2.
 14352
 14353 7290-MOVE-NAME-CYCLE.
 14354
 14355     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14356
 14357     IF  NWA-INDEX LESS THAN +30
 14358         SET NWA-INDEX UP BY +1
 14359     ELSE
 14360         ADD +2                TO WS-NAME-SW
 14361         GO TO 7290-EXIT.
 14362
 14363     IF  NWA-INDEX2 LESS THAN +20
 14364         SET NWA-INDEX2 UP BY +1
 14365         SET NWA-INDEX3 UP BY +1.
 14366
 14367     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 14368             AND
 14369         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 14370         GO TO 7290-EXIT.
 14371
 14372     GO TO 7290-MOVE-NAME-CYCLE.
 14373
 14374 7290-EXIT.
 14375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 300
* EL689.cbl
 14377 7300-LABEL-MOVE.
 14378
 14379     IF  W-LABEL-HOLD-AREA = SPACES
 14380         MOVE +0                 TO W-NUMB-LABEL-LINES
 14381         GO TO 7300-EXIT.
 14382
 14383     IF  W-LABEL-LINES (1) = SPACES
 14384         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 14385         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 14386         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14387         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14388         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14389         MOVE SPACES             TO W-LABEL-LINES (6)
 14390         GO TO 7300-LABEL-MOVE.
 14391
 14392     IF  W-LABEL-LINES (2) = SPACES
 14393             AND
 14394         W-LABEL-LINES (3) = SPACES
 14395             AND
 14396         W-LABEL-LINES (4) = SPACES
 14397             AND
 14398         W-LABEL-LINES (5) = SPACES
 14399             AND
 14400         W-LABEL-LINES (6) = SPACES
 14401         MOVE 1                  TO W-NDX
 14402                                    W-NUMB-LABEL-LINES
 14403         GO TO 7300-EXIT.
 14404
 14405 7300-TRY-2.
 14406
 14407     IF  W-LABEL-LINES (2) = SPACES
 14408         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 14409         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14410         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14411         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14412         MOVE SPACES             TO W-LABEL-LINES (6)
 14413         GO TO 7300-TRY-2.
 14414
 14415     IF  W-LABEL-LINES (3) = SPACES
 14416             AND
 14417         W-LABEL-LINES (4) = SPACES
 14418             AND
 14419         W-LABEL-LINES (5) = SPACES
 14420             AND
 14421         W-LABEL-LINES (6) = SPACES
 14422         MOVE 2                  TO W-NDX
 14423         GO TO 7300-MOVE-ZIP.
 14424
 14425 7300-TRY-3.
 14426
 14427     IF  W-LABEL-LINES (3) = SPACES
 14428         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14429         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14430         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14431         MOVE SPACES             TO W-LABEL-LINES (6)
 14432         GO TO 7300-TRY-3.
 14433
 14434     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 301
* EL689.cbl
 14435             AND
 14436         W-LABEL-LINES (5) = SPACES
 14437             AND
 14438         W-LABEL-LINES (6) = SPACES
 14439         MOVE 3                   TO W-NDX
 14440         GO TO 7300-MOVE-ZIP.
 14441
 14442 7300-TRY-4.
 14443
 14444     IF  W-LABEL-LINES (4) = SPACES
 14445         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14446         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14447         MOVE SPACES             TO W-LABEL-LINES (6)
 14448         GO TO 7300-TRY-4.
 14449
 14450     IF  W-LABEL-LINES (5) = SPACES
 14451             AND
 14452         W-LABEL-LINES (6) = SPACES
 14453         MOVE 4                  TO W-NDX
 14454         GO TO 7300-MOVE-ZIP.
 14455
 14456 7300-TRY-5.
 14457
 14458     IF  W-LABEL-LINES (5) = SPACES
 14459         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14460         MOVE SPACES             TO W-LABEL-LINES (6)
 14461         GO TO 7300-TRY-5
 14462     ELSE
 14463         IF  W-LABEL-LINES (6) = SPACES
 14464             MOVE 5              TO W-NDX
 14465             GO TO 7300-MOVE-ZIP
 14466         ELSE
 14467             MOVE 6              TO W-NDX.
 14468
 14469 7300-MOVE-ZIP.
 14470
 14471     COMPUTE W-NDX2 = W-NDX - 1.
 14472
 14473     IF  W-LAST-ZIP (W-NDX2) = SPACES
 14474*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 14475
 14476         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 14477                 MOVE W-LABEL-ZIP (W-NDX)
 14478                                 TO W-LAST-ZIP (W-NDX2)
 14479                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 14480                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 14481                 GO TO 7300-EXIT.
 14482
 14483     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 14484
 14485 7300-EXIT.
 14486     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 302
* EL689.cbl
 14488 7400-CREATE-LETTER.
 14489****************************************************************
 14490*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 14491*    RECORDS.                                                  *
 14492****************************************************************
 14493
 14494     SET W-SQ-NDX                TO W-START-COLUMN.
 14495     MOVE SPACES                 TO W-SQUEEZED-LINE
 14496                                    W-WORK-LINE.
 14497     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 14498     MOVE +1                     TO W-LAST-WC-SPACE.
 14499     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 14500
 14501     SET W-TG-NDX                TO +1.
 14502
 14503     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 14504            VARYING
 14505         W-TG-NDX FROM W-TG-NDX BY +1
 14506            UNTIL
 14507         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 14508
 14509     IF  W-FORM-SQUEEZE-ON
 14510             AND
 14511         W-SQUEEZED-LINE GREATER THAN SPACES
 14512         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 14513
 14514     PERFORM 7640-PAGING THRU 7640-EXIT.
 14515
 14516 7400-EXIT.
 14517     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 303
* EL689.cbl
 14519 7410-TEXT-LINE-PROCESS.
 14520***************************************************************
 14521*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 14522*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 14523*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 14524*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 14525*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 14526*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 14527***************************************************************
 14528
 14529
 14530     SET W-WC-NDX                TO W-ZEROS.
 14531     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 14532
 14533     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 14534
 14535     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 14536             VARYING
 14537         W-TX-NDX FROM +1 BY +1
 14538             UNTIL
 14539         W-TX-NDX GREATER THAN +70.
 14540
 14541****************************************************************
 14542*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 14543*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 14544*    LINE SQUEEZE CONTROL.                                     *
 14545****************************************************************
 14546     IF  W-FORM-SQUEEZE-ON
 14547
 14548         IF  W-WORK-LINE GREATER THAN SPACES
 14549                 OR
 14550             W-AS-IS
 14551             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 14552
 14553         ELSE
 14554             NEXT SENTENCE
 14555****************************************************************
 14556*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 14557*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 14558****************************************************************
 14559     ELSE
 14560         IF  W-WORK-LINE GREATER THAN SPACES
 14561             MOVE W-TX-PC (W-TG-NDX)
 14562                                 TO W-PRINT-CONTROL
 14563             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 14564             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14565             MOVE SPACES         TO W-WORK-LINE.
 14566
 14567 7410-EXIT.
 14568     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 304
* EL689.cbl
 14570 7420-TEXT-CHAR-PROCESS.
 14571****************************************************************
 14572*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 14573*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 14574*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 14575*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 14576****************************************************************
 14577
 14578     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 14579             AND
 14580         W-LAST-CHAR EQUAL '@'
 14581         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 14582
 14583     SET W-WC-NDX UP BY +1.
 14584
 14585     IF  W-WC-NDX GREATER THAN +70
 14586         IF  W-FORM-SQUEEZE-ON
 14587                 AND
 14588             NOT W-AS-IS
 14589             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 14590                     VARYING
 14591                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 14592                     UNTIL
 14593                 W-WC-NDX EQUAL +71
 14594             SET W-TX-NDX        TO W-LAST-TX-SPACE
 14595
 14596             IF  W-WORK-LINE GREATER THAN SPACES
 14597                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 14598                 MOVE SPACES     TO W-WORK-LINE
 14599                                    W-LINE-SQUEEZE-IND
 14600                 SET W-WC-NDX    TO +1
 14601             ELSE
 14602                 SET W-WC-NDX    TO +1
 14603         ELSE
 14604             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 14605
 14606     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14607                                 TO W-CHARACTER-TYPE.
 14608
 14609     SET W-WC-NDX2               TO W-WC-NDX.
 14610     SET W-WC-NDX2 DOWN BY +1.
 14611
 14612     IF  W-PUNCTUATION
 14613             AND
 14614         W-WC-NDX2 GREATER THAN W-ZEROS
 14615             AND
 14616         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 14617         SET W-WC-NDX DOWN BY +1.
 14618
 14619     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14620                                 TO W-LAST-CHAR
 14621                                    W-WORK-CHAR (W-WC-NDX).
 14622
 14623     IF  W-LAST-CHAR EQUAL SPACES
 14624         SET W-LAST-WC-SPACE     TO W-WC-NDX
 14625         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 14626
 14627 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 305
* EL689.cbl
 14628     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 306
* EL689.cbl
 14630 7430-PROCESS-VARIABLE.
 14631******************************************************************
 14632*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 14633*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 14634*    ITS CORRESPONDING VALUES.                                   *
 14635******************************************************************
 14636
 14637     SET W-TX-NDX UP BY +1.
 14638
 14639     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14640         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14641                                 TO W-V1
 14642         SET W-TX-NDX UP BY +1
 14643
 14644         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14645             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14646                                 TO W-V2
 14647             SET W-TX-NDX UP BY +1
 14648             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14649                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14650                                 TO W-V3
 14651                 SET W-TX-NDX UP BY +1
 14652                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14653                                 TO W-FIELD-SQUEEZE-IND
 14654                 GO TO 7430-CONTINUE
 14655             ELSE
 14656                 SET W-TX-NDX DOWN BY +3
 14657                 MOVE ER-0180    TO EMI-ERROR
 14658                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14659                 MOVE -1         TO MAINTL
 14660                 MOVE HIGH-VALUES
 14661                                 TO W-LAST-CHAR
 14662         ELSE
 14663             SET W-TX-NDX DOWN BY +2
 14664             MOVE ER-0180        TO EMI-ERROR
 14665             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14666             MOVE -1             TO MAINTL
 14667             MOVE HIGH-VALUES    TO W-LAST-CHAR
 14668     ELSE
 14669         SET W-TX-NDX DOWN BY +1
 14670         MOVE ER-7246            TO EMI-ERROR
 14671         MOVE -1                 TO MAINTL
 14672         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14673         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 14674
 14675****************************************************************
 14676*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 14677*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 14678*    ACTION.                                                   *
 14679****************************************************************
 14680
 14681     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14682         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14683         GO TO 7430-EXIT
 14684     ELSE
 14685         GO TO 7430-EXIT.
 14686
 14687 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 307
* EL689.cbl
 14688
 14689     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 14690             OR
 14691         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 14692         SET W-TX-NDX DOWN BY +4
 14693         MOVE ER-0180            TO EMI-ERROR
 14694         MOVE -1                 TO MAINTL
 14695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14696         MOVE HIGH-VALUES        TO W-LAST-CHAR
 14697         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14698             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14699             GO TO 7430-EXIT
 14700         ELSE
 14701             GO TO 7430-EXIT.
 14702
 14703     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 14704
 14705     SET W-WC-NDX DOWN BY +1.
 14706
 14707     IF  (W-FORM-SQUEEZE-OFF
 14708                 AND
 14709             NOT W-SQUEEZE-FIELD)
 14710             OR
 14711         (W-FORM-SQUEEZE-ON
 14712                 AND
 14713             W-AS-IS)
 14714         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 14715                 VARYING
 14716             W-VC-NDX FROM +1 BY +1
 14717                 UNTIL
 14718             W-VC-NDX GREATER THAN
 14719                 W-VARIABLE-SIZE (W-VG-NDX)
 14720
 14721         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 14722             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14723             SET W-TX-NDX DOWN BY +5
 14724             IF  W-TX-NDX GREATER THAN +70
 14725                 SET W-TX-NDX    TO +70
 14726                 GO TO 7430-EXIT
 14727             ELSE
 14728                 GO TO 7430-EXIT
 14729         ELSE
 14730             COMPUTE W-ADJUST-SHORT
 14731                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 14732             SET W-WC-NDX UP BY W-ADJUST-SHORT
 14733             GO TO 7430-EXIT.
 14734
 14735     IF  W-SQUEEZE-FIELD
 14736         SET W-TX-NDX UP BY +1.
 14737
 14738     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 14739
 14740     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 14741             VARYING
 14742         W-VC-NDX FROM +1 BY +1
 14743             UNTIL
 14744         W-VC-NDX GREATER THAN
 14745             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 308
* EL689.cbl
 14746
 14747     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 14748
 14749     IF  W-FORM-SQUEEZE-ON
 14750         GO TO 7430-EXIT.
 14751
 14752     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 14753         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14754         SET W-TX-NDX DOWN BY +6
 14755         IF  W-TX-NDX GREATER THAN +70
 14756             SET W-TX-NDX        TO +70.
 14757
 14758     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14759         SET W-WC-NDX DOWN BY +1.
 14760
 14761 7430-EXIT.
 14762     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 309
* EL689.cbl
 14764 7435-MOVE-VARIABLE-DIRECT.
 14765
 14766     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14767             AND
 14768         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14769             AND
 14770         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14771             AND
 14772         (W-VC-NDX GREATER THAN +1
 14773                 AND
 14774             W-LAST-CHAR NOT EQUAL SPACE
 14775                 AND
 14776             NOT W-LAST-CHAR-PUNC)
 14777         IF  W-LC-USE-BOTH-CASES
 14778             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14779                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14780         ELSE
 14781             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14782                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14783
 14784     SET W-WC-NDX UP BY +1.
 14785     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14786                                 TO W-WORK-CHAR (W-WC-NDX)
 14787                                    W-LAST-CHAR.
 14788
 14789 7435-EXIT.
 14790     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 310
* EL689.cbl
 14792 7437-FIND-NEXT-CHARACTER.
 14793*DELIBERATELY LEFT BLANK.
 14794 7437-EXIT.
 14795     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 311
* EL689.cbl
 14797 7440-BACK-TO-NEAREST-WORD.
 14798
 14799     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 14800
 14801 7440-EXIT.
 14802     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 312
* EL689.cbl
 14804 7450-SQUEEZING.
 14805
 14806     IF  W-NEW-PARAGRAPH
 14807         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 14808         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 14809         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14810             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14811             MOVE W-TX-PC (W-TG-NDX)
 14812                                 TO W-PRINT-CONTROL
 14813             MOVE SPACES         TO W-SQUEEZED-LINE
 14814             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14815             SET W-SQ-NDX UP BY W-WORK-INDENT
 14816         ELSE
 14817             MOVE W-TX-PC (W-TG-NDX)
 14818                                 TO W-PRINT-CONTROL
 14819             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14820             SET W-SQ-NDX UP BY W-WORK-INDENT
 14821     ELSE
 14822         IF  W-DO-NOT-ADJUST
 14823             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 14824             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14825                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14826                 MOVE W-WORK-LINE
 14827                                 TO W-SQUEEZED-LINE
 14828                 MOVE W-TX-PC (W-TG-NDX)
 14829                                 TO W-PRINT-CONTROL
 14830                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14831                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14832                 MOVE SPACES     TO W-SQUEEZED-LINE
 14833                 GO TO 7450-EXIT
 14834             ELSE
 14835                 MOVE W-WORK-LINE
 14836                                 TO W-SQUEEZED-LINE
 14837                 MOVE W-TX-PC (W-TG-NDX)
 14838                                 TO W-PRINT-CONTROL
 14839                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14840                 MOVE SPACES     TO W-SQUEEZED-LINE
 14841                                    W-WORK-LINE
 14842                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14843                 GO TO 7450-EXIT
 14844         ELSE
 14845             IF  W-ADJUST-TO-LINE-LENGTH
 14846                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 14847
 14848                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14849                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14850                     SET W-SQ-NDX
 14851                                 TO W-INITIAL-COLUMN
 14852                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14853                             VARYING
 14854                         W-WC-NDX FROM 1 BY 1
 14855                             UNTIL
 14856                         W-SQ-NDX EQUAL W-TOO-FAR
 14857                     MOVE W-TX-PC (W-TG-NDX)
 14858                                 TO W-PRINT-CONTROL
 14859                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14860                     SET W-SQ-NDX
 14861                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 313
* EL689.cbl
 14862                     MOVE SPACES TO W-SQUEEZED-LINE
 14863                                    W-WORK-LINE
 14864                     GO TO 7450-EXIT
 14865                 ELSE
 14866                     SET W-SQ-NDX
 14867                                 TO W-INITIAL-COLUMN
 14868                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14869                             VARYING
 14870                         W-WC-NDX FROM 1 BY 1
 14871                             UNTIL
 14872                         W-SQ-NDX EQUAL W-TOO-FAR
 14873                     MOVE W-TX-PC (W-TG-NDX)
 14874                                 TO W-PRINT-CONTROL
 14875                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14876                     MOVE SPACES TO W-SQUEEZED-LINE
 14877                                    W-WORK-LINE
 14878                     SET W-SQ-NDX
 14879                                 TO W-INITIAL-COLUMN
 14880                     GO TO 7450-EXIT
 14881             ELSE
 14882                 IF  W-CONTINUE-PARAGRAPH
 14883                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14884                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14885                         PERFORM 7610-SET-CONP-INDENT
 14886                             THRU 7610-EXIT
 14887                         MOVE SPACES
 14888                                 TO W-LINE-SQUEEZE-IND
 14889                         MOVE W-TX-PC (W-TG-NDX)
 14890                                 TO W-PRINT-CONTROL
 14891                         MOVE SPACES
 14892                                 TO W-SQUEEZED-LINE
 14893                         SET W-SQ-NDX
 14894                                 TO W-INITIAL-COLUMN
 14895                         SET W-SQ-NDX UP BY W-WORK-INDENT
 14896                     ELSE
 14897                         PERFORM 7610-SET-CONP-INDENT
 14898                             THRU 7610-EXIT
 14899                         MOVE SPACES
 14900                                 TO W-LINE-SQUEEZE-IND
 14901                         MOVE W-TX-PC (W-TG-NDX)
 14902                                 TO W-PRINT-CONTROL
 14903                         MOVE SPACES
 14904                                 TO W-SQUEEZED-LINE
 14905                         SET W-SQ-NDX
 14906                                 TO W-INITIAL-COLUMN
 14907                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 14908
 14909
 14910     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 14911             VARYING
 14912         W-WC-NDX FROM +1 BY +1
 14913             UNTIL
 14914         W-WC-NDX GREATER THAN +70.
 14915
 14916 7450-EXIT.
 14917     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 314
* EL689.cbl
 14919 7460-REMAIN-CHAR-CHECK.
 14920
 14921     IF  W-TX-NDX EQUAL W-WC-NDX
 14922         MOVE W-TX-PC (W-TG-NDX)
 14923                                 TO W-PRINT-CONTROL
 14924         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 14925         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14926         MOVE SPACES             TO W-WORK-LINE
 14927         SET W-WC-NDX            TO +1
 14928     ELSE
 14929         SET W-TX-NDX1           TO W-TX-NDX
 14930         SEARCH W-TX-CHAR
 14931             VARYING W-TX-NDX1
 14932             AT END
 14933                 MOVE W-TX-PC (W-TG-NDX)
 14934                                 TO W-PRINT-CONTROL
 14935                 MOVE W-WORK-LINE
 14936                                 TO W-SQUEEZED-LINE
 14937                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14938                 MOVE SPACES     TO W-WORK-LINE
 14939                 SET W-WC-NDX    TO +1
 14940                 SET W-TX-NDX    TO +1
 14941                 SET W-TG-NDX UP BY +1
 14942             WHEN
 14943                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 14944                 MOVE ER-9427    TO EMI-ERROR
 14945                 MOVE -1         TO MAINTL
 14946                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14947                 MOVE W-TX-PC (W-TG-NDX)
 14948                                 TO W-PRINT-CONTROL
 14949                 MOVE W-WORK-LINE
 14950                                 TO W-SQUEEZED-LINE
 14951                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14952                 MOVE SPACES     TO W-WORK-LINE
 14953                 SET W-WC-NDX    TO +1.
 14954
 14955 7460-EXIT.
 14956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 315
* EL689.cbl
 14958 7470-MOVE-CHAR.
 14959
 14960     IF  W-FIRST-CHAR-NOT-FOUND
 14961             AND
 14962         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14963         MOVE SPACES             TO W-LAST-CHAR
 14964         GO TO 7470-EXIT.
 14965
 14966     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 14967
 14968     IF  W-SQUEEZE-FIELD
 14969             AND
 14970         W-LAST-CHAR EQUAL SPACES
 14971             AND
 14972         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14973         GO TO 7470-EXIT.
 14974
 14975     SET W-WC-NDX UP BY +1.
 14976
 14977     IF  W-WC-NDX GREATER THAN +70
 14978         IF  W-FORM-SQUEEZE-ON
 14979             GO TO 7470-EXIT
 14980         ELSE
 14981             MOVE ER-9427        TO EMI-ERROR
 14982             MOVE -1             TO MAINTL
 14983             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14984             GO TO 7470-EXIT.
 14985
 14986     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14987             AND
 14988         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14989             AND
 14990         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14991             AND
 14992         (W-VC-NDX GREATER THAN +1
 14993                 AND
 14994             W-LAST-CHAR NOT EQUAL SPACE
 14995                 AND
 14996             NOT W-LAST-CHAR-PUNC)
 14997         IF  W-LC-USE-BOTH-CASES
 14998             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14999                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15000         ELSE
 15001             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15002                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15003
 15004     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15005                                 TO W-WORK-CHAR (W-WC-NDX)
 15006                                    W-LAST-CHAR.
 15007
 15008     IF  W-LAST-CHAR EQUAL SPACES
 15009         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 15010
 15011 7470-EXIT.
 15012     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 316
* EL689.cbl
 15014 7480-UPDATE-SQUEEZED-LINE.
 15015****************************************************************
 15016*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 15017*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 15018*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 15019*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 15020*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 15021*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 15022****************************************************************
 15023
 15024     SET W-SQ-NDX UP BY +1.
 15025
 15026     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 15027         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 15028                                 TO W-CHARACTER-TYPE
 15029         IF  W-PUNCTUATION
 15030                 OR
 15031             W-SPACE
 15032             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 15033             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15034             MOVE SPACES         TO W-SQUEEZED-LINE
 15035             SET W-SQ-NDX        TO W-START-COLUMN
 15036             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15037             SET W-LAST-SQUEEZED-SPACE
 15038                                 TO W-SQ-NDX
 15039         ELSE
 15040             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 15041             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15042             MOVE SPACES         TO W-SQUEEZED-LINE
 15043             SET W-SQ-NDX        TO W-START-COLUMN
 15044             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15045             SET W-LAST-SQUEEZED-SPACE
 15046                                 TO W-SQ-NDX.
 15047
 15048     IF  W-WC-NDX GREATER THAN +70
 15049         GO TO 7480-EXIT.
 15050
 15051     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 15052
 15053     IF  W-END-OF-SENTENCE
 15054         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 15055         SET W-WORK-NDX          TO W-SQ-NDX
 15056         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 15057         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 15058             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 15059         ELSE
 15060             NEXT SENTENCE
 15061     ELSE
 15062         IF  W-PUNCTUATION
 15063                 AND
 15064             W-LAST-SQ-CHAR EQUAL SPACES
 15065             SET W-SQ-NDX DOWN BY +1
 15066             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 15067         ELSE
 15068             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15069                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 15070                     IF  W-END-OF-SENTENCE-WORKING
 15071                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 317
* EL689.cbl
 15072                                 TO W-END-OF-SENTENCE-IND
 15073                         SET W-LAST-SQUEEZED-SPACE
 15074                                 TO W-SQ-NDX
 15075                     ELSE
 15076                         SET W-SQ-NDX DOWN BY +1
 15077                         GO TO 7480-EXIT
 15078                 ELSE
 15079                     SET W-LAST-SQUEEZED-SPACE
 15080                                 TO W-SQ-NDX
 15081             ELSE
 15082                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 15083
 15084     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 15085                                    W-LAST-SQ-CHAR.
 15086
 15087     IF  W-WC-NDX EQUAL +70
 15088             AND
 15089         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 15090             AND
 15091         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 15092         SET W-SQ-NDX UP BY +1
 15093         SET W-LAST-SQUEEZED-SPACE
 15094                                 TO W-SQ-NDX
 15095         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 15096                                    W-LAST-SQ-CHAR.
 15097
 15098 7480-EXIT.
 15099     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 318
* EL689.cbl
 15101 7485-FIND-NEXT-CHARACTER.
 15102
 15103     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 15104
 15105     IF  W-PUNCTUATION
 15106         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 15107     ELSE
 15108         SET W-WC-NDX            TO W-WC-NDX
 15109         SEARCH W-WORK-CHAR
 15110             VARYING W-WC-NDX
 15111             AT END
 15112                 GO TO 7485-EXIT
 15113             WHEN
 15114                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 15115                 GO TO 7485-EXIT.
 15116
 15117 7485-EXIT.
 15118     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 319
* EL689.cbl
 15120 7490-REMOVE-LAST-WORD.
 15121
 15122*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 15123     IF  W-WC-NDX EQUAL +1
 15124         GO TO 7490-EXIT.
 15125
 15126     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 15127
 15128     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 15129             VARYING
 15130         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 15131             UNTIL
 15132         W-SQ-NDX EQUAL W-TOO-FAR.
 15133
 15134     SET W-WORK-NDX              TO W-WC-NDX.
 15135     COMPUTE W-LAST-WC-SPACE
 15136         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 15137     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 15138
 15139 7490-EXIT.
 15140     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 320
* EL689.cbl
 15142 7500-CLEAR-SQUEEZED-EXCESS.
 15143
 15144     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 15145
 15146 7500-EXIT.
 15147     EXIT.
 15148
 15149 7505-MOVE-STRAIGHT.
 15150
 15151     SET W-SQ-NDX UP BY +1.
 15152
 15153     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 15154
 15155 7505-EXIT.
 15156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 321
* EL689.cbl
 15158 7510-MOVE-TO-TABLE.
 15159
 15160     IF  W-PRINT-CONTROL NOT NUMERIC
 15161         MOVE 00                 TO W-PRINT-CONTROL
 15162         ADD +1                  TO W-LINE-COUNT
 15163     ELSE
 15164         IF  W-PRINT-CONTROL EQUAL 99
 15165             PERFORM 7640-PAGING THRU 7640-EXIT
 15166             MOVE 00             TO W-PRINT-CONTROL
 15167             SET W-RG-NDX UP BY +1
 15168             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 15169             MOVE +1             TO W-LINE-COUNT
 15170             SET W-RG-NDX UP BY W-TOP-MARGIN
 15171         ELSE
 15172           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 15173             COMPUTE W-LINE-COUNT
 15174                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 15175
 15176     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 15177         PERFORM 7640-PAGING THRU 7640-EXIT
 15178         MOVE 00                 TO W-PRINT-CONTROL
 15179         SET W-RG-NDX UP BY +1
 15180         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 15181         SET W-RG-NDX UP BY W-TOP-MARGIN
 15182         MOVE +1                 TO W-LINE-COUNT.
 15183
 15184     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 15185     SET W-RG-NDX UP BY +1.
 15186     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 15187     MOVE 00                     TO W-PRINT-CONTROL.
 15188
 15189     IF  W-FIRST-BAD-VARIABLE-FOUND
 15190             AND
 15191         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15192         SET W-FIRST-BAD-VARIABLE
 15193                                 TO W-RG-NDX.
 15194
 15195 7510-EXIT.
 15196     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 322
* EL689.cbl
 15198 7600-SET-PARA-INDENT.
 15199
 15200     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 15201         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 15202     ELSE
 15203     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 15204         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 15205         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15206     ELSE
 15207     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 15208         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 15209         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15210     ELSE
 15211     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 15212         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 15213         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15214     ELSE
 15215     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 15216         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 15217         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15218     ELSE
 15219     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 15220         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 15221         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 15222
 15223     SET W-TG-NDX2               TO W-TG-NDX.
 15224     SET W-TG-NDX2 UP BY +1.
 15225
 15226     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 15227         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15228     ELSE
 15229         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 15230
 15231 7600-EXIT.
 15232     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 323
* EL689.cbl
 15234 7610-SET-CONP-INDENT.
 15235
 15236     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 15237         MOVE +0                 TO W-WORK-INDENT
 15238     ELSE
 15239     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 15240         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 15241     ELSE
 15242     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 15243         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 15244     ELSE
 15245     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 15246         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 15247     ELSE
 15248     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 15249         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 15250     ELSE
 15251     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 15252         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 15253
 15254     SET W-TG-NDX2               TO W-TG-NDX.
 15255     SET W-TG-NDX2 UP BY +1.
 15256
 15257     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 15258         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15259     ELSE
 15260         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 15261
 15262 7610-EXIT.
 15263     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 324
* EL689.cbl
 15265 7630-NEXT-LINE.
 15266
 15267     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 15268         MOVE ZEROS              TO W-NEXT-INDENT
 15269     ELSE
 15270     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 15271         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 15272     ELSE
 15273     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 15274         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 15275     ELSE
 15276     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 15277         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 15278     ELSE
 15279     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 15280         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 15281     ELSE
 15282     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 15283         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 15284     ELSE
 15285         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15286         SUBTRACT W-PARAGRAPH-INDENT
 15287                                  FROM W-NEXT-INDENT.
 15288
 15289 7630-EXIT.
 15290     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 325
* EL689.cbl
 15292 7640-PAGING.
 15293
 15294     IF  NOT W-LC-CREATE-PAGES
 15295         GO TO 7640-EXIT.
 15296
 15297     IF  W-LINE-COUNT GREATER ZEROS
 15298             AND
 15299         W-RG-NDX GREATER THAN +1
 15300         ADD +1                  TO W-PAGE
 15301         MOVE W-PAGE             TO W-PAGE-NUMBER
 15302         COMPUTE W-PAGE-LINE
 15303             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 15304         IF  W-PAGE-LINE GREATER THAN +2
 15305             SET W-RG-NDX UP BY W-PAGE-LINE
 15306             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 15307         ELSE
 15308             SET W-RG-NDX UP BY +2
 15309             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 15310
 15311 7640-EXIT.
 15312     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 326
* EL689.cbl
 15314 7700-READ-TEXT-TS.
 15315**************************************************************
 15316*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 15317*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 15318*  AND EL1042.                                               *
 15319**************************************************************
 15320
 15321
 15322* EXEC CICS HANDLE CONDITION
 15323*         QIDERR     (7700-TS-ERROR)
 15324*         ITEMERR    (7700-TS-ERROR)
 15325*    END-EXEC.
 15326*    MOVE '"$N<                  ! 9 #00014463' TO DFHEIV0
 15327     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 15328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15329     MOVE X'3920233030303134343633' TO DFHEIV0(25:11)
 15330     CALL 'kxdfhei1' USING DFHEIV0
 15331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15332
 15333
 15334     SET W-TS-NDX                TO 1.
 15335     MOVE 1                      TO W-TS-ITEM.
 15336
 15337 7700-LOOP.
 15338
 15339     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 15340         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 15341             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15342             GO TO 7700-EXIT
 15343         ELSE
 15344             GO TO 7700-EXIT.
 15345
 15346
 15347* EXEC CICS READQ TS
 15348*         INTO     (W-TS-WORK-AREA)
 15349*         QUEUE    (W-TS-NAME-TEXT)
 15350*         LENGTH   (W-TS-LENGTH)
 15351*         ITEM     (W-TS-ITEM)
 15352*    END-EXEC.
 15353*    MOVE '*$II   L              ''   #00014480' TO DFHEIV0
 15354     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 15355     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15356     MOVE X'2020233030303134343830' TO DFHEIV0(25:11)
 15357     CALL 'kxdfhei1' USING DFHEIV0,
 15358           W-TS-NAME-TEXT,
 15359           W-TS-WORK-AREA,
 15360           W-TS-LENGTH,
 15361           W-TS-ITEM,
 15362           DFHEIV99,
 15363           DFHEIV99
 15364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15365
 15366
 15367     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 15368     SET W-TS-NDX UP BY 1.
 15369     ADD 1                       TO W-TS-ITEM.
 15370     GO TO 7700-LOOP.
 15371
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 327
* EL689.cbl
 15372 7700-TS-ERROR.
 15373
 15374     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 15375         MOVE ER-0033            TO EMI-ERROR
 15376         MOVE -1                 TO MAINTL
 15377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15378         GO TO 8200-SEND-DATAONLY.
 15379
 15380 7700-EXIT.
 15381      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 328
* EL689.cbl
 15383 7740-RESTORE-SCREEN.
 15384
 15385     MOVE 'C'                    TO MAINTI.
 15386     MOVE +1                     TO MAINTL.
 15387     MOVE AL-UANON               TO MAINTA.
 15388
 15389     MOVE PI-689-FORM-NUMBER     TO FORMI.
 15390     MOVE +4                     TO FORML.
 15391     MOVE AL-UANON               TO FORMA.
 15392
 15393*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 15394*        MOVE PI-689-PRINT-RESTRICTION
 15395*                                TO PRTRESTL
 15396*        MOVE +1                 TO PRTRESTL
 15397*        MOVE AL-UANON           TO PRTRESTA.
 15398
 15399     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 15400         MOVE PI-689-FOLLOW-UP-EDIT
 15401                                 TO FOLLOWI
 15402         MOVE +8                 TO FOLLOWL
 15403         MOVE AL-UANON           TO FOLLOWA.
 15404
 15405     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 15406         MOVE PI-689-RESEND1-EDIT
 15407                                 TO RESEND1I
 15408         MOVE +8                 TO RESEND1L
 15409         MOVE AL-UANON           TO RESEND1A.
 15410     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 15411         MOVE PI-689-ALT-PRINTER-ID
 15412                                 TO PRINTERI
 15413         MOVE +1                 TO PRINTERL
 15414         MOVE AL-UANON           TO PRINTERA.
 15415
 15416     IF  PI-BYPASS-LABELS
 15417          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 15418          MOVE +1                TO ADDRLBLL
 15419          MOVE AL-UANON          TO ADDRLBLA
 15420     ELSE
 15421          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 15422               MOVE PI-689-LBL-OVERRIDE
 15423                                 TO ADDRLBLI
 15424               MOVE +1           TO ADDRLBLL
 15425               MOVE AL-UANON     TO ADDRLBLA.
 15426
 15427     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 15428         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 15429         MOVE +1                     TO COPIESL
 15430         MOVE AL-UNNON               TO COPIESA.
 15431
 15432     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 15433         MOVE PI-689-LABEL-SOURCE
 15434                                 TO ADDRSI
 15435         MOVE +1                 TO ADDRSL
 15436         MOVE AL-UANON           TO ADDRSA.
 15437
 15438     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 15439     MOVE +1                     TO DATASORL.
 15440     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 329
* EL689.cbl
 15441
 15442     IF  PI-689-CARRIER GREATER THAN SPACES
 15443         MOVE PI-689-CARRIER     TO CARRIERI
 15444         MOVE +1                 TO CARRIERL
 15445         MOVE AL-UANON           TO CARRIERA.
 15446
 15447     IF  PI-689-GROUPING GREATER THAN SPACES
 15448         MOVE PI-689-GROUPING    TO GROUPI
 15449         MOVE +6                 TO GROUPL
 15450         MOVE AL-UANON           TO GROUPA.
 15451
 15452     IF  PI-689-STATE GREATER THAN SPACES
 15453         MOVE PI-689-STATE       TO STATEI
 15454         MOVE +2                 TO STATEL
 15455         MOVE AL-UANON           TO STATEA.
 15456
 15457     IF  PI-689-ACCOUNT GREATER THAN SPACES
 15458         MOVE PI-689-ACCOUNT     TO ACCTI
 15459         MOVE +10                TO ACCTL
 15460         MOVE AL-UANON           TO ACCTA.
 15461
 15462     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 15463         MOVE PI-689-CERT-PRIME  TO CERTI
 15464         MOVE +10                TO CERTL
 15465         MOVE AL-UANON           TO CERTA.
 15466
 15467     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 15468         MOVE PI-689-CERT-SFX    TO SFXI
 15469         MOVE +1                 TO SFXL
 15470         MOVE AL-UANON           TO SFXA.
 15471
 15472     IF  PI-689-TYPE GREATER THAN SPACES
 15473         MOVE PI-689-TYPE        TO TYPEI
 15474         MOVE +1                 TO TYPEL
 15475         MOVE AL-UANON           TO TYPEA.
 15476
 15477     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 15478         MOVE PI-689-RESP-PERSON TO RPERSONI
 15479         MOVE +10                TO RPERSONL
 15480         MOVE AL-UANON           TO RPERSONA.
 15481
 15482     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 15483         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 15484         MOVE +6                 TO BENTRYL
 15485         MOVE AL-UANON           TO BENTRYA.
 15486
 15487     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 15488         MOVE PI-689-SEQ-EDIT    TO SEQI
 15489         MOVE +8                 TO SEQL
 15490         MOVE AL-UNNON           TO SEQA.
 15491
 15492     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 15493         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 15494         MOVE +4                 TO BCSEQL
 15495         MOVE AL-UNNON           TO BCSEQA.
 15496
 15497     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 15498         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 330
* EL689.cbl
 15499         MOVE +8                 TO DATEL
 15500         MOVE AL-UNNON           TO DATEA.
 15501
 15502     IF PI-CERT-FORM-ID GREATER THAN SPACES
 15503        MOVE PI-CERT-FORM-ID     TO CERTIDI
 15504        MOVE +5                  TO CERTIDL
 15505        MOVE AL-UNNON            TO CERTIDA
 15506     END-IF.
 15507
 15508     IF PI-PRINT-NOW GREATER THAN SPACES
 15509        MOVE PI-PRINT-NOW        TO PRTNOWI
 15510        MOVE +1                  TO PRTNOWL
 15511        MOVE AL-UNNON            TO PRTNOWA
 15512     END-IF.
 15513     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 15514        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 15515        MOVE +8                  TO ENDARCHL
 15516        MOVE AL-UNNON            TO ENDARCHA
 15517     END-IF
 15518
 15519     MOVE PI-ENCLOSURE-CD        TO ENCI.
 15520     MOVE +3                     TO ENCL.
 15521     MOVE AL-UANON               TO ENCA.
 15522
 15523 7749-EXIT.
 15524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 331
* EL689.cbl
 15526 7760-PUT-TEMP-STORAGE.
 15527**************************************************************
 15528*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 15529*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 15530*  EL1042 AND EL6892.                                        *
 15531**************************************************************
 15532
 15533     SET W-TS-NDX                TO 1.
 15534     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 15535
 15536     MOVE -1                     TO MAINTL.
 15537     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 15538             VARYING
 15539         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 15540             UNTIL
 15541         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 15542
 15543 7760-EXIT.
 15544      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 332
* EL689.cbl
 15546 7780-DELETE-TEMP-STOR-TEXT.
 15547
 15548
 15549* EXEC CICS HANDLE CONDITION
 15550*         QIDERR      (7780-EXIT)
 15551*    END-EXEC.
 15552*    MOVE '"$N                   ! : #00014668' TO DFHEIV0
 15553     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 15554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15555     MOVE X'3A20233030303134363638' TO DFHEIV0(25:11)
 15556     CALL 'kxdfhei1' USING DFHEIV0
 15557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15558
 15559
 15560
 15561* EXEC CICS DELETEQ TS
 15562*         QUEUE       (W-TS-NAME-TEXT)
 15563*    END-EXEC.
 15564*    MOVE '*&                    #   #00014672' TO DFHEIV0
 15565     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 15566     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15567     MOVE X'2020233030303134363732' TO DFHEIV0(25:11)
 15568     CALL 'kxdfhei1' USING DFHEIV0,
 15569           W-TS-NAME-TEXT,
 15570           DFHEIV99
 15571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15572
 15573
 15574 7780-EXIT.
 15575     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 333
* EL689.cbl
 15577 7840-WRITE-TS.
 15578
 15579     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 15580     SET W-TS-NDX UP BY 1.
 15581     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 15582
 15583
 15584* EXEC CICS WRITEQ TS
 15585*         FROM    (W-TS-WORK-AREA)
 15586*         QUEUE   (W-TS-NAME-TEXT)
 15587*         LENGTH  (W-TS-LENGTH)
 15588*         ITEM    (PI-TEMP-STOR-ITEMS)
 15589*    END-EXEC.
 15590*    MOVE '*" I                  ''   #00014685' TO DFHEIV0
 15591     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 15592     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15593     MOVE X'2020233030303134363835' TO DFHEIV0(25:11)
 15594     CALL 'kxdfhei1' USING DFHEIV0,
 15595           W-TS-NAME-TEXT,
 15596           W-TS-WORK-AREA,
 15597           W-TS-LENGTH,
 15598           PI-TEMP-STOR-ITEMS,
 15599           DFHEIV99,
 15600           DFHEIV99
 15601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15602
 15603
 15604 7840-EXIT.
 15605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 334
* EL689.cbl
 15607 7900-PRINT-LETTER-NOW.
 15608***************************************************************
 15609*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 15610*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 15611*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 15612*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 15613*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 15614*     ISSUED FOR THE PRINT TRANSACTION.                       *
 15615***************************************************************
 15616
 15617*    IF (EIBAID = DFHPF4 OR DFHPF8)
 15618*            AND
 15619*        PI-SHOW-MODE
 15620*        IF  PRINTERL GREATER ZERO
 15621*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 15622*                                                    W-UPPER-CASE
 15623*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 15624*                                   PI-ALT-DMD-PRT-ID.
 15625*
 15626*    IF  EIBAID EQUAL DFHPF8
 15627*            AND
 15628*        PI-SHOW-MODE
 15629*            AND
 15630*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 15631*        MOVE ER-7247            TO EMI-ERROR
 15632*        MOVE -1                 TO MAINTL
 15633*        MOVE AL-UABON           TO MAINTA
 15634*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15635*        GO TO 8200-SEND-DATAONLY.
 15636
 15637     IF  PI-TOTAL-LINES EQUAL 0
 15638         MOVE ER-0187            TO EMI-ERROR
 15639         MOVE -1                 TO MAINTL
 15640         MOVE AL-UABON           TO MAINTA
 15641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15642         GO TO 8200-SEND-DATAONLY.
 15643
 15644     IF  EMI-ERROR NOT EQUAL ER-0191
 15645         IF  PI-689-CREATE-NO-SCREENS
 15646*                OR
 15647*            (EIBAID = DFHPF4 OR DFHPF8)
 15648             SET W-RG-NDX        TO +1
 15649         ELSE
 15650             PERFORM 4100-SET-NDX THRU 4100-EXIT
 15651             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 15652                     VARYING
 15653                 W-SC-NDX FROM 1 BY 1
 15654                     UNTIL
 15655                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 15656
 15657     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 15658
 15659     IF EIBAID NOT = DFHPF4 AND DFHPF8
 15660         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 15661                 VARYING
 15662             W-RVS-NDX FROM +1 BY +1
 15663                 UNTIL
 15664             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 335
* EL689.cbl
 15665                 OR
 15666             W-REMAINING-VAR-FOUND
 15667         IF  W-REMAINING-VAR-FOUND
 15668             GO TO 4000-ROLL-PAGE.
 15669
 15670*    IF EIBAID = DFHPF4 OR DFHPF8
 15671*       PERFORM 7700-READ-TEXT-TS
 15672*                                THRU 7700-EXIT
 15673*
 15674*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 15675*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 15676*                VARYING
 15677*            W-SC-NDX FROM 1 BY 1
 15678*                UNTIL
 15679*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 15680*
 15681*       PERFORM 7760-PUT-TEMP-STORAGE
 15682*                                THRU 7760-EXIT
 15683*    END-IF
 15684     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 15685         MOVE PI-689-ALT-PRINTER-ID
 15686                                 TO W-TS-TERM-TEXT
 15687     ELSE
 15688         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 15689             MOVE PI-PROCESSOR-PRINTER
 15690                                 TO W-TS-TERM-TEXT
 15691         ELSE
 15692             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 15693             MOVE '1'            TO W-CNTL-RECORD-TYPE
 15694             MOVE SPACES         TO W-CNTL-GENL
 15695             MOVE ZEROS          TO W-CNTL-SEQ-NO
 15696
 15697* EXEC CICS HANDLE CONDITION
 15698*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 15699*                 NOTFND     (7945-NOT-FOUND)
 15700*            END-EXEC
 15701*    MOVE '"$JI                  ! ; #00014784' TO DFHEIV0
 15702     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15704     MOVE X'3B20233030303134373834' TO DFHEIV0(25:11)
 15705     CALL 'kxdfhei1' USING DFHEIV0
 15706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15707
 15708* EXEC CICS READ
 15709*                 DATASET    (W-CNTL-FILE-ID)
 15710*                 SET        (ADDRESS OF CONTROL-FILE)
 15711*                 RIDFLD     (W-CNTL-KEY)
 15712*            END-EXEC
 15713*    MOVE '&"S        E          (   #00014788' TO DFHEIV0
 15714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15716     MOVE X'2020233030303134373838' TO DFHEIV0(25:11)
 15717     CALL 'kxdfhei1' USING DFHEIV0,
 15718           W-CNTL-FILE-ID,
 15719           DFHEIV20,
 15720           DFHEIV99,
 15721           W-CNTL-KEY,
 15722           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 336
* EL689.cbl
 15723           DFHEIV99,
 15724           DFHEIV99
 15725     SET ADDRESS OF CONTROL-FILE TO
 15726         DFHEIV20
 15727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15728             MOVE CF-FORMS-PRINTER-ID
 15729                                 TO W-TS-TERM-TEXT.
 15730
 15731***********************************************************
 15732*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 15733*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 15734***********************************************************
 15735
 15736     SET W-TS-NDX                TO 1.
 15737     MOVE EIBTIME                TO W-TS-ID-TIME.
 15738     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 15739     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 15740
 15741     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 15742             VARYING
 15743         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 15744             UNTIL
 15745         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 15746
 15747*    IF  EIBAID EQUAL DFHPF8
 15748*        MOVE '1'                TO PI-689-PRINT-SW
 15749*    ELSE
 15750         MOVE SPACES             TO PI-689-PRINT-SW.
 15751
 15752
 15753* EXEC CICS HANDLE CONDITION
 15754*         TERMIDERR  (7935-TERM-ERROR)
 15755*         TRANSIDERR (7940-TRAN-ERROR)
 15756*    END-EXEC.
 15757*    MOVE '"$[\                  ! < #00014817' TO DFHEIV0
 15758     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 15759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15760     MOVE X'3C20233030303134383137' TO DFHEIV0(25:11)
 15761     CALL 'kxdfhei1' USING DFHEIV0
 15762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15763
 15764
 15765
 15766* EXEC CICS START
 15767*             INTERVAL    (0)
 15768*             TRANSID     (W-PRINT-TRANS)
 15769*             FROM        (PROGRAM-INTERFACE-BLOCK)
 15770*             LENGTH      (PI-COMM-LENGTH)
 15771*             TERMID      (W-TS-TERM-TEXT)
 15772*    END-EXEC.
 15773     MOVE 0 TO DFHEIV10
 15774*    MOVE '0(ILFT                1   #00014822' TO DFHEIV0
 15775     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 15776     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 15777     MOVE X'2020233030303134383232' TO DFHEIV0(25:11)
 15778     CALL 'kxdfhei1' USING DFHEIV0,
 15779           DFHEIV10,
 15780           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 337
* EL689.cbl
 15781           DFHEIV99,
 15782           PROGRAM-INTERFACE-BLOCK,
 15783           PI-COMM-LENGTH,
 15784           W-TS-TERM-TEXT,
 15785           DFHEIV99,
 15786           DFHEIV99,
 15787           DFHEIV99,
 15788           DFHEIV99,
 15789           DFHEIV99,
 15790           DFHEIV99,
 15791           DFHEIV99,
 15792           DFHEIV99,
 15793           DFHEIV99,
 15794           DFHEIV99
 15795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15796
 15797
 15798
 15799* EXEC CICS SYNCPOINT
 15800*    END-EXEC.
 15801*    MOVE '6"                    !   #00014830' TO DFHEIV0
 15802     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 15803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15804     MOVE X'2020233030303134383330' TO DFHEIV0(25:11)
 15805     CALL 'kxdfhei1' USING DFHEIV0
 15806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15807
 15808
 15809     IF  PI-689-CREATE-NO-SCREENS
 15810         GO TO 7900-EXIT.
 15811
 15812*    IF  EIBAID EQUAL DFHPF8
 15813*            AND
 15814*        PI-SHOW-MODE
 15815*            AND
 15816*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 15817*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 15818
 15819     MOVE ER-0189                TO EMI-ERROR.
 15820     MOVE -1                     TO MAINTL.
 15821
 15822     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 15823     MOVE -1                     TO MAINTL
 15824     MOVE AL-UABON               TO MAINTA
 15825     MOVE '104A'                 TO W-TS-ID-TEXT
 15826     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15827                                    W-TS-TERM-SCREEN
 15828     GO TO 8200-SEND-DATAONLY.
 15829
 15830 7900-EXIT.
 15831     EXIT.
 15832
 15833 7915-SEARCH-REMAINING-VARS.
 15834
 15835     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 15836         SET W-RVS-NDX2          TO W-RVS-NDX
 15837         SET W-RVS-NDX2 UP BY +1
 15838         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 338
* EL689.cbl
 15839             SET W-RVS-NDX2 UP BY +1
 15840             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 15841                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 15842                 COMPUTE PI-CURRENT-LINE
 15843                     = PI-CURRENT-LINE / 73
 15844                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 15845                 MOVE +0         TO W-ROLL-COUNTER
 15846                 MOVE ER-0191    TO EMI-ERROR
 15847                 MOVE -1         TO MAINTL
 15848                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15849
 15850 7915-EXIT.
 15851     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 339
* EL689.cbl
 15853 7920-UPDATE-INITIAL-PRINT.
 15854
 15855
 15856* EXEC CICS HANDLE CONDITION
 15857*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 15858*         NOTFND     (1070-ARCH-NOT-FOUND)
 15859*         ENDFILE    (1070-ARCH-NOT-FOUND)
 15860*    END-EXEC.
 15861*    MOVE '"$JI''                 ! = #00014879' TO DFHEIV0
 15862     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 15863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15864     MOVE X'3D20233030303134383739' TO DFHEIV0(25:11)
 15865     CALL 'kxdfhei1' USING DFHEIV0
 15866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15867
 15868     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 15869     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 15870
 15871* EXEC CICS READ
 15872*        DATASET (W-ARCH-FILE-ID)
 15873*        SET     (ADDRESS OF LETTER-ARCHIVE)
 15874*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 15875*        UPDATE
 15876*    END-EXEC.
 15877*    MOVE '&"S        EU         (   #00014886' TO DFHEIV0
 15878     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15879     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15880     MOVE X'2020233030303134383836' TO DFHEIV0(25:11)
 15881     CALL 'kxdfhei1' USING DFHEIV0,
 15882           W-ARCH-FILE-ID,
 15883           DFHEIV20,
 15884           DFHEIV99,
 15885           W-ARCH-PARTIAL-KEY,
 15886           DFHEIV99,
 15887           DFHEIV99,
 15888           DFHEIV99
 15889     SET ADDRESS OF LETTER-ARCHIVE TO
 15890         DFHEIV20
 15891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15892
 15893
 15894     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 15895
 15896     IF  LA-RESEND-DATE = LOW-VALUES
 15897         MOVE 'C'                TO LA-STATUS.
 15898
 15899
 15900* EXEC CICS REWRITE
 15901*         FROM      (LETTER-ARCHIVE)
 15902*         DATASET   (W-ARCH-FILE-ID)
 15903*    END-EXEC.
 15904     MOVE LENGTH OF
 15905      LETTER-ARCHIVE
 15906       TO DFHEIV11
 15907*    MOVE '&& L                  %   #00014898' TO DFHEIV0
 15908     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15909     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15910     MOVE X'2020233030303134383938' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 340
* EL689.cbl
 15911     CALL 'kxdfhei1' USING DFHEIV0,
 15912           W-ARCH-FILE-ID,
 15913           LETTER-ARCHIVE,
 15914           DFHEIV11,
 15915           DFHEIV99
 15916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15917
 15918
 15919 7920-EXIT.
 15920     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 341
* EL689.cbl
 15922 7935-TERM-ERROR.
 15923
 15924     MOVE ER-0412                TO EMI-ERROR.
 15925     MOVE SPACES                 TO PI-689-PRINT-SW.
 15926     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15927     MOVE -1                     TO MAINTL.
 15928     GO TO 8200-SEND-DATAONLY.
 15929
 15930 7940-TRAN-ERROR.
 15931
 15932     MOVE ER-0413                TO EMI-ERROR.
 15933     MOVE SPACES                 TO PI-689-PRINT-SW.
 15934     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15935     MOVE -1                     TO MAINTL.
 15936     GO TO 8200-SEND-DATAONLY.
 15937
 15938 7945-NOT-FOUND.
 15939
 15940     MOVE ER-0190                TO EMI-ERROR.
 15941     MOVE -1                     TO MAINTL.
 15942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15943     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 342
* EL689.cbl
 15945 8010-ARCH-NOT-OPEN.
 15946
 15947     MOVE ER-7388                TO EMI-ERROR.
 15948     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15949     MOVE -1                     TO MAINTL.
 15950     GO TO 8200-SEND-DATAONLY.
 15951
 15952 8015-ARCT-NOT-OPEN.
 15953
 15954     MOVE ER-7373                TO EMI-ERROR.
 15955     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15956     MOVE -1                     TO MAINTL.
 15957     GO TO 8200-SEND-DATAONLY.
 15958
 15959 8020-ACCT-NOT-OPEN.
 15960
 15961     MOVE ER-0168 TO EMI-ERROR
 15962     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15963     MOVE -1                     TO MAINTL.
 15964     GO TO 8200-SEND-DATAONLY.
 15965
 15966 8030-CERT-NOT-OPEN.
 15967
 15968     MOVE ER-0169 TO EMI-ERROR.
 15969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15970     MOVE -1                     TO MAINTL.
 15971     GO TO 8200-SEND-DATAONLY.
 15972
 15973 8035-CERT-NOT-FOUND.
 15974
 15975     MOVE ER-2369 TO EMI-ERROR.
 15976     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15977     MOVE -1                     TO MAINTL.
 15978     GO TO 8200-SEND-DATAONLY.
 15979
 15980 8040-CNTL-NOT-OPEN.
 15981
 15982     MOVE ER-0042                TO EMI-ERROR.
 15983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15984     MOVE -1                     TO MAINTL.
 15985     GO TO 8200-SEND-DATAONLY.
 15986
 15987 8045-CHEK-NOT-OPEN.
 15988
 15989     MOVE ER-3775                TO EMI-ERROR.
 15990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15991     MOVE -1                     TO MAINTL.
 15992     GO TO 8200-SEND-DATAONLY.
 15993
 15994 8050-TEXT-NOT-OPEN.
 15995
 15996     MOVE ER-0013                TO EMI-ERROR.
 15997     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15998     MOVE -1                     TO MAINTL.
 15999     GO TO 8200-SEND-DATAONLY.
 16000
 16001 8060-PNDB-NOT-OPEN.
 16002
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 343
* EL689.cbl
 16003     MOVE ER-2216 TO EMI-ERROR.
 16004     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16005     MOVE -1                     TO MAINTL.
 16006     GO TO 8200-SEND-DATAONLY.
 16007
 16008 8070-PNDB-NOT-FOUND.
 16009
 16010     MOVE ER-7374 TO EMI-ERROR.
 16011     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16012     MOVE -1                     TO MAINTL.
 16013     GO TO 8200-SEND-DATAONLY.
 16014
 16015 8080-COMP-NOT-OPEN.
 16016
 16017     MOVE ER-2055 TO EMI-ERROR
 16018     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16019     MOVE -1                     TO MAINTL.
 16020     GO TO 8200-SEND-DATAONLY.
 16021
 16022 8085-PYAJ-NOT-OPEN.
 16023
 16024     MOVE ER-2232 TO EMI-ERROR
 16025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16026     MOVE -1                     TO MAINTL.
 16027     GO TO 8200-SEND-DATAONLY.
 16028
 16029 8090-MAIL-NOT-OPEN.
 16030
 16031     MOVE ER-2999                TO EMI-ERROR.
 16032     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16033     MOVE -1                     TO MAINTL.
 16034     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 344
* EL689.cbl
 16036 8100-SEND-INITIAL-MAP.
 16037
 16038     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 16039     IF  PI-689-CREATE-NO-SCREENS
 16040         MOVE '9999'             TO PI-689-ERROR
 16041         GO TO 0620-RETURN-TO-CALLER.
 16042
 16043     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16044
 16045     IF  NOT EMI-NO-ERRORS
 16046         MOVE EMI-MESSAGE-AREA (1)
 16047                                 TO ERRMSGO
 16048     ELSE
 16049         MOVE SPACES             TO ERRMSGO.
 16050     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 16051                                 TO SYSO
 16052     MOVE WS-KIXHOST             TO HOSTO
 16053     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 16054        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 16055        MOVE AL-SADOF            TO PF8HDA
 16056     END-IF
 16057     IF NOT PI-CREATE-LABELS
 16058         MOVE AL-PANON           TO ADDRLBLA.
 16059
 16060
 16061* EXEC CICS SEND
 16062*        MAP    (W-MAP)
 16063*        MAPSET (W-MAPSET)
 16064*        FROM   (EL689AO)
 16065*        ERASE
 16066*        CURSOR
 16067*    END-EXEC.
 16068     MOVE LENGTH OF
 16069      EL689AO
 16070       TO DFHEIV12
 16071     MOVE -1
 16072       TO DFHEIV11
 16073*    MOVE '8$     CT  E    H L F ,   #00015044' TO DFHEIV0
 16074     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16075     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16076     MOVE X'2020233030303135303434' TO DFHEIV0(25:11)
 16077     CALL 'kxdfhei1' USING DFHEIV0,
 16078           W-MAP,
 16079           EL689AO,
 16080           DFHEIV12,
 16081           W-MAPSET,
 16082           DFHEIV99,
 16083           DFHEIV99,
 16084           DFHEIV99,
 16085           DFHEIV11,
 16086           DFHEIV99,
 16087           DFHEIV99,
 16088           DFHEIV99
 16089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16090
 16091
 16092     GO TO 9000-RETURN-TRANS.
 16093
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 345
* EL689.cbl
 16094 8100-EXIT.
 16095     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 346
* EL689.cbl
 16097 8200-SEND-DATAONLY.
 16098
 16099     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 16100     IF  PI-689-CREATE-NO-SCREENS
 16101         MOVE '9999'             TO PI-689-ERROR
 16102         GO TO 0620-RETURN-TO-CALLER.
 16103
 16104     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16105
 16106     IF EMI-ERROR = ER-0715
 16107         DISPLAY 'ER 0715'
 16108         MOVE -1          TO CERTIDL
 16109         MOVE +0          TO MAINTL
 16110     END-IF
 16111
 16112     IF  NOT EMI-NO-ERRORS
 16113         MOVE EMI-MESSAGE-AREA (1)
 16114                                 TO ERRMSGO
 16115     ELSE
 16116         MOVE SPACES             TO ERRMSGO.
 16117
 16118
 16119* EXEC CICS SEND
 16120*        MAP    (W-MAP)
 16121*        MAPSET (W-MAPSET)
 16122*        FROM   (EL689AO)
 16123*        DATAONLY
 16124*        CURSOR
 16125*    END-EXEC.
 16126     MOVE LENGTH OF
 16127      EL689AO
 16128       TO DFHEIV12
 16129     MOVE -1
 16130       TO DFHEIV11
 16131*    MOVE '8$D    CT       H L F ,   #00015078' TO DFHEIV0
 16132     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16133     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16134     MOVE X'2020233030303135303738' TO DFHEIV0(25:11)
 16135     CALL 'kxdfhei1' USING DFHEIV0,
 16136           W-MAP,
 16137           EL689AO,
 16138           DFHEIV12,
 16139           W-MAPSET,
 16140           DFHEIV99,
 16141           DFHEIV99,
 16142           DFHEIV99,
 16143           DFHEIV11,
 16144           DFHEIV99,
 16145           DFHEIV99,
 16146           DFHEIV99
 16147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16148
 16149
 16150     GO TO 9000-RETURN-TRANS.
 16151
 16152 8200-EXIT.
 16153     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 347
* EL689.cbl
 16155 8300-SEND-TEXT.
 16156
 16157     IF  PI-689-CREATE-NO-SCREENS
 16158         MOVE '9999'             TO PI-689-ERROR
 16159         GO TO 0620-RETURN-TO-CALLER.
 16160
 16161
 16162* EXEC CICS SEND TEXT
 16163*        FROM    (LOGOFF-TEXT)
 16164*        LENGTH  (LOGOFF-LENGTH)
 16165*        ERASE
 16166*        FREEKB
 16167*    END-EXEC.
 16168*    MOVE '8&      T  E F  H   F -   #00015097' TO DFHEIV0
 16169     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16170     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16171     MOVE X'2020233030303135303937' TO DFHEIV0(25:11)
 16172     CALL 'kxdfhei1' USING DFHEIV0,
 16173           LOGOFF-TEXT,
 16174           LOGOFF-LENGTH,
 16175           DFHEIV99,
 16176           DFHEIV99,
 16177           DFHEIV99,
 16178           DFHEIV99,
 16179           DFHEIV99,
 16180           DFHEIV99,
 16181           DFHEIV99,
 16182           DFHEIV99,
 16183           DFHEIV99,
 16184           DFHEIV99
 16185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16186
 16187
 16188     GO TO 9000-RETURN-TRANS.
 16189
 16190 8300-EXIT.
 16191     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 348
* EL689.cbl
 16193 8350-SEND-DATAONLY-ERASEAUP.
 16194
 16195     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16196     PERFORM 7760-PUT-TEMP-STORAGE
 16197                                 THRU 7760-EXIT
 16198     IF  PI-689-CREATE-NO-SCREENS
 16199         MOVE '9999'             TO PI-689-ERROR
 16200         GO TO 0620-RETURN-TO-CALLER.
 16201
 16202     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16203
 16204     IF EMI-ERROR = ER-0715
 16205         DISPLAY 'ER 0715'
 16206         MOVE -1          TO CERTIDL
 16207         MOVE +0          TO MAINTL
 16208     END-IF
 16209
 16210     IF  NOT EMI-NO-ERRORS
 16211         MOVE EMI-MESSAGE-AREA (1)
 16212                                 TO ERRMSGO
 16213     ELSE
 16214         MOVE SPACES             TO ERRMSGO.
 16215
 16216
 16217* EXEC CICS SEND
 16218*        MAP      (W-MAP)
 16219*        MAPSET   (W-MAPSET)
 16220*        FROM     (EL689AO)
 16221*        DATAONLY
 16222*        ERASEAUP
 16223*        CURSOR
 16224*    END-EXEC.
 16225     MOVE LENGTH OF
 16226      EL689AO
 16227       TO DFHEIV12
 16228     MOVE -1
 16229       TO DFHEIV11
 16230*    MOVE '8$D    CT  A    H L F ,   #00015132' TO DFHEIV0
 16231     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 16232     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16233     MOVE X'2020233030303135313332' TO DFHEIV0(25:11)
 16234     CALL 'kxdfhei1' USING DFHEIV0,
 16235           W-MAP,
 16236           EL689AO,
 16237           DFHEIV12,
 16238           W-MAPSET,
 16239           DFHEIV99,
 16240           DFHEIV99,
 16241           DFHEIV99,
 16242           DFHEIV11,
 16243           DFHEIV99,
 16244           DFHEIV99,
 16245           DFHEIV99
 16246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16247
 16248
 16249     GO TO 9000-RETURN-TRANS.
 16250
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 349
* EL689.cbl
 16251 8350-EXIT.
 16252     EXIT.
 16253
 16254 8600-DEEDIT.
 16255
 16256
 16257* EXEC CICS BIF DEEDIT
 16258*         FIELD    (W-DEEDIT-FIELD)
 16259*         LENGTH   (15)
 16260*    END-EXEC.
 16261     MOVE 15
 16262       TO DFHEIV11
 16263*    MOVE '@"L                   #   #00015148' TO DFHEIV0
 16264     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 16265     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16266     MOVE X'2020233030303135313438' TO DFHEIV0(25:11)
 16267     CALL 'kxdfhei1' USING DFHEIV0,
 16268           W-DEEDIT-FIELD,
 16269           DFHEIV11
 16270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16271
 16272
 16273 8600-EXIT.
 16274     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 350
* EL689.cbl
 16276 9000-RETURN-TRANS.
 16277
 16278     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 16279     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 16280     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 16281     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 16282
 16283* EXEC CICS RETURN
 16284*        TRANSID    (W-TRANSACTION)
 16285*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 16286*        LENGTH     (PI-COMM-LENGTH)
 16287*    END-EXEC.
 16288*    MOVE '.(CT                  ''   #00015162' TO DFHEIV0
 16289     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16290     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16291     MOVE X'2020233030303135313632' TO DFHEIV0(25:11)
 16292     CALL 'kxdfhei1' USING DFHEIV0,
 16293           W-TRANSACTION,
 16294           PROGRAM-INTERFACE-BLOCK,
 16295           PI-COMM-LENGTH,
 16296           DFHEIV99,
 16297           DFHEIV99,
 16298           DFHEIV99
 16299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16300
 16301*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 16302*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16303*    GO TO 0200-RECEIVE.
 16304
 16305 9000-EXIT.
 16306     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 351
* EL689.cbl
 16308 9200-PA.
 16309
 16310     MOVE ER-0008                TO EMI-ERROR.
 16311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16312     MOVE -1                     TO MAINTL.
 16313     GO TO 8200-SEND-DATAONLY.
 16314
 16315 9200-EXIT.
 16316     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 352
* EL689.cbl
 16318 9300-DFHCLEAR.
 16319
 16320     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 16321         MOVE '2'                TO PI-ACTION.
 16322
 16323     IF  PI-CLEAR-MODE
 16324         MOVE PI-RETURN-TO-PROGRAM
 16325                                 TO W-CALL-PGM
 16326         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16327         GO TO 9400-XCTL
 16328     ELSE
 16329         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16330         MOVE LOW-VALUES         TO EL689AO
 16331                                    PI-1042-WA
 16332                                    PI-689-WORK-AREA
 16333         MOVE ZEROS              TO PI-CURRENT-LINE
 16334                                    PI-TEMP-STOR-ITEMS
 16335                                    PI-TOTAL-LINES
 16336                                    PI-UPDATE-SW
 16337                                    PI-689-NUMBER-LABEL-LINES
 16338         MOVE SPACES             TO PI-689-PRINT-SW
 16339                                    PI-689-ALT-PRINTER-ID
 16340                                    PI-COMM-CONTROL
 16341                                    PI-689-FORM-NUMBER
 16342                                    PI-689-TEMP-STOR-ID
 16343                                    PI-689-LABEL-SOURCE
 16344                                    PI-689-USE-SCREEN-IND
 16345         MOVE '2'                TO PI-ACTION
 16346         MOVE -1                 TO MAINTL
 16347         GO TO 8100-SEND-INITIAL-MAP.
 16348
 16349 9300-EXIT.
 16350     EXIT.
 16351
 16352 9400-XCTL.
 16353
 16354
 16355* EXEC CICS XCTL
 16356*        PROGRAM  (W-CALL-PGM)
 16357*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 16358*        LENGTH   (PI-COMM-LENGTH)
 16359*    END-EXEC.
 16360*    MOVE '.$C                   %   #00015220' TO DFHEIV0
 16361     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16363     MOVE X'2020233030303135323230' TO DFHEIV0(25:11)
 16364     CALL 'kxdfhei1' USING DFHEIV0,
 16365           W-CALL-PGM,
 16366           PROGRAM-INTERFACE-BLOCK,
 16367           PI-COMM-LENGTH,
 16368           DFHEIV99
 16369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16370
 16371
 16372 9400-EXIT.
 16373     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 353
* EL689.cbl
 16375 9500-LINK-DATE-CONVERT.
 16376
 16377     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 16378             AND
 16379         DC-OPTION-CODE EQUAL ' '
 16380         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 16381         GO TO 9500-EXIT.
 16382
 16383
 16384* EXEC CICS LINK
 16385*        PROGRAM    ('ELDATCV')
 16386*        COMMAREA   (DATE-CONVERSION-DATA)
 16387*        LENGTH     (DC-COMM-LENGTH)
 16388*    END-EXEC.
 16389     MOVE 'ELDATCV' TO DFHEIV1
 16390*    MOVE '."C                   (   #00015237' TO DFHEIV0
 16391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16393     MOVE X'2020233030303135323337' TO DFHEIV0(25:11)
 16394     CALL 'kxdfhei1' USING DFHEIV0,
 16395           DFHEIV1,
 16396           DATE-CONVERSION-DATA,
 16397           DC-COMM-LENGTH,
 16398           DFHEIV99,
 16399           DFHEIV99,
 16400           DFHEIV99,
 16401           DFHEIV99
 16402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16403
 16404
 16405     IF  NO-CONVERSION-ERROR
 16406             AND
 16407         PI-COMPANY-ID EQUAL 'AUK'
 16408             AND
 16409         W-REVERSE-DATE
 16410         MOVE DC-GREG-DATE-1-EDIT
 16411                                 TO W-EDIT-DATE-1
 16412         MOVE W-ED1-MM           TO W-ED2-MM
 16413         MOVE W-ED1-DD           TO W-ED2-DD
 16414         MOVE W-ED1-YY           TO W-ED2-YY
 16415         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 16416
 16417 9500-EXIT.
 16418     EXIT.
 16419
 16420 9600-FORMAT-DATE-TIME.
 16421
 16422     MOVE W-SAVE-DATE            TO RUNDTEO.
 16423     MOVE EIBTIME                TO W-TIME-IN.
 16424     MOVE W-TIME-OUT             TO RUNTIMEO.
 16425     MOVE PI-COMPANY-ID          TO COMPANYO.
 16426     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16427     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 16428
 16429 9600-EXIT.
 16430     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 354
* EL689.cbl
 16432 9700-PGMID-ERROR.
 16433
 16434     IF  PI-689-CREATE-NO-SCREENS
 16435         MOVE '9999'             TO PI-689-ERROR
 16436         GO TO 0620-RETURN-TO-CALLER.
 16437
 16438
 16439* EXEC CICS  HANDLE CONDITION
 16440*        PGMIDERR  (8300-SEND-TEXT)
 16441*    END-EXEC.
 16442*    MOVE '"$L                   ! > #00015276' TO DFHEIV0
 16443     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16445     MOVE X'3E20233030303135323736' TO DFHEIV0(25:11)
 16446     CALL 'kxdfhei1' USING DFHEIV0
 16447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16448
 16449
 16450     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 16451     MOVE ' '                    TO PI-ENTRY-CD-1.
 16452     MOVE W-XCTL-005             TO W-CALL-PGM
 16453                                    LOGOFF-PGM.
 16454     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16455
 16456     PERFORM 9400-XCTL THRU 9400-EXIT.
 16457
 16458 9700-EXIT.
 16459     EXIT.
 16460
 16461 9800-ABEND.
 16462
 16463     IF  PI-689-CREATE-NO-SCREENS
 16464         MOVE '9999'             TO PI-689-ERROR
 16465         GO TO 0620-RETURN-TO-CALLER.
 16466
 16467     MOVE W-LINK-004             TO W-CALL-PGM.
 16468     MOVE DFHEIBLK               TO EMI-LINE1
 16469
 16470
 16471* EXEC CICS  LINK
 16472*        PROGRAM   (W-CALL-PGM)
 16473*        COMMAREA  (EMI-LINE1)
 16474*        LENGTH    (72)
 16475*    END-EXEC.
 16476     MOVE 72
 16477       TO DFHEIV11
 16478*    MOVE '."C                   (   #00015300' TO DFHEIV0
 16479     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16481     MOVE X'2020233030303135333030' TO DFHEIV0(25:11)
 16482     CALL 'kxdfhei1' USING DFHEIV0,
 16483           W-CALL-PGM,
 16484           EMI-LINE1,
 16485           DFHEIV11,
 16486           DFHEIV99,
 16487           DFHEIV99,
 16488           DFHEIV99,
 16489           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 355
* EL689.cbl
 16490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16491
 16492
 16493     GO TO 8200-SEND-DATAONLY.
 16494
 16495 9800-EXIT.
 16496     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 356
* EL689.cbl
 16498 9900-ERROR-FORMAT.
 16499
 16500     IF  PI-689-CREATE-NO-SCREENS
 16501         MOVE EMI-ERROR          TO PI-689-ERROR
 16502         IF  PI-689-FATAL-ERROR
 16503             GO TO 0620-RETURN-TO-CALLER
 16504         ELSE
 16505             GO TO 9900-EXIT.
 16506
 16507     IF  EMI-ERROR EQUAL ER-9097
 16508         NEXT SENTENCE
 16509     ELSE
 16510         IF  EMI-ERRORS-COMPLETE
 16511                 OR
 16512             EMI-ERROR EQUAL W-LAST-ERROR
 16513             GO TO 9900-EXIT.
 16514
 16515     MOVE W-LINK-001             TO W-CALL-PGM.
 16516
 16517
 16518* EXEC CICS LINK
 16519*        PROGRAM    (W-CALL-PGM)
 16520*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 16521*        LENGTH     (EMI-COMM-LENGTH)
 16522*    END-EXEC.
 16523*    MOVE '."C                   (   #00015330' TO DFHEIV0
 16524     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16526     MOVE X'2020233030303135333330' TO DFHEIV0(25:11)
 16527     CALL 'kxdfhei1' USING DFHEIV0,
 16528           W-CALL-PGM,
 16529           ERROR-MESSAGE-INTERFACE-BLOCK,
 16530           EMI-COMM-LENGTH,
 16531           DFHEIV99,
 16532           DFHEIV99,
 16533           DFHEIV99,
 16534           DFHEIV99
 16535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16536
 16537
 16538     IF  EMI-SEVERITY (2) EQUAL 'X'
 16539             AND
 16540         EMI-SEVERITY (1) NOT EQUAL 'X'
 16541         MOVE EMI-MESSAGE-AREA (2)
 16542                                 TO EMI-MESSAGE-AREA (1).
 16543
 16544     MOVE EMI-ERROR              TO W-LAST-ERROR.
 16545
 16546 9900-EXIT.
 16547     EXIT.
 16548
 16549 9905-INITIALIZE-SECURITY.
 16550******************************************************************
 16551*                                                                *
 16552*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 16553*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 16554*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 16555*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 357
* EL689.cbl
 16556*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 16557*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 16558*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 16559*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 16560*                                                                *
 16561*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 16562*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 16563*                                                                *
 16564******************************************************************
 16565
 16566     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 16567         MOVE 'Y'                TO PI-DISPLAY-CAP
 16568                                    PI-MODIFY-CAP
 16569     ELSE
 16570
 16571* EXEC CICS READQ TS
 16572*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 16573*            INTO   (SECURITY-CONTROL)
 16574*            LENGTH (SC-COMM-LENGTH)
 16575*            ITEM   (1)
 16576*        END-EXEC
 16577     MOVE 1
 16578       TO DFHEIV11
 16579*    MOVE '*$II   L              ''   #00015368' TO DFHEIV0
 16580     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16581     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16582     MOVE X'2020233030303135333638' TO DFHEIV0(25:11)
 16583     CALL 'kxdfhei1' USING DFHEIV0,
 16584           PI-SECURITY-TEMP-STORE-ID,
 16585           SECURITY-CONTROL,
 16586           SC-COMM-LENGTH,
 16587           DFHEIV11,
 16588           DFHEIV99,
 16589           DFHEIV99
 16590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16591         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 16592                                 TO PI-DISPLAY-CAP
 16593         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 16594                                 TO PI-MODIFY-CAP.
 16595
 16596 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 358
* EL689.cbl
 16598 9995-SECURITY-VIOLATION.
 16599
 16600     MOVE EIBDATE                TO SM-JUL-DATE.
 16601     MOVE EIBTRMID               TO SM-TERMID.
 16602     MOVE W-THIS-PGM             TO SM-PGM.
 16603     MOVE EIBTIME                TO W-TIME-IN.
 16604     MOVE W-TIME-OUT             TO SM-TIME.
 16605     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 16606
 16607
 16608* EXEC CICS LINK
 16609*         PROGRAM  ('EL003')
 16610*         COMMAREA (SECURITY-MESSAGE)
 16611*         LENGTH   (80)
 16612*    END-EXEC.
 16613     MOVE 'EL003' TO DFHEIV1
 16614     MOVE 80
 16615       TO DFHEIV11
 16616*    MOVE '."C                   (   #00015390' TO DFHEIV0
 16617     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16618     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16619     MOVE X'2020233030303135333930' TO DFHEIV0(25:11)
 16620     CALL 'kxdfhei1' USING DFHEIV0,
 16621           DFHEIV1,
 16622           SECURITY-MESSAGE,
 16623           DFHEIV11,
 16624           DFHEIV99,
 16625           DFHEIV99,
 16626           DFHEIV99,
 16627           DFHEIV99
 16628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16629
 16630
 16631 9995-EXIT.
 16632     EXIT.
 16633
 16634 9999-GOBACK.
 16635
 16636
 16637* GOBACK.
 16638     MOVE '9%                    "   ' TO DFHEIV0
 16639     MOVE 'EL689' TO DFHEIV1
 16640     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16641     GOBACK.
 16642
 16643 9999-EXIT.
 16644     EXIT.
 16645
 16646 9999-DFHBACK SECTION.
 16647     MOVE '9%                    "   ' TO DFHEIV0
 16648     MOVE 'EL689' TO DFHEIV1
 16649     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16650     GOBACK.
 16651 9999-DFHEXIT.
 16652     IF DFHEIGDJ EQUAL 0001
 16653         NEXT SENTENCE
 16654     ELSE IF DFHEIGDJ EQUAL 2
 16655         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 359
* EL689.cbl
 16656               9200-PA,
 16657               9200-PA,
 16658               9200-PA
 16659         DEPENDING ON DFHEIGDI
 16660     ELSE IF DFHEIGDJ EQUAL 3
 16661         GO TO 9700-PGMID-ERROR,
 16662               9800-ABEND,
 16663               0325-MAPFAIL
 16664         DEPENDING ON DFHEIGDI
 16665     ELSE IF DFHEIGDJ EQUAL 4
 16666         GO TO 8040-CNTL-NOT-OPEN,
 16667               7945-NOT-FOUND
 16668         DEPENDING ON DFHEIGDI
 16669     ELSE IF DFHEIGDJ EQUAL 5
 16670         GO TO 9700-PGMID-ERROR,
 16671               0325-MAPFAIL,
 16672               9800-ABEND
 16673         DEPENDING ON DFHEIGDI
 16674     ELSE IF DFHEIGDJ EQUAL 6
 16675         GO TO 0990-CARRIER-NOT-FOUND,
 16676               8040-CNTL-NOT-OPEN
 16677         DEPENDING ON DFHEIGDI
 16678     ELSE IF DFHEIGDJ EQUAL 7
 16679         GO TO 0994-STATE-NOT-FOUND,
 16680               8040-CNTL-NOT-OPEN
 16681         DEPENDING ON DFHEIGDI
 16682     ELSE IF DFHEIGDJ EQUAL 8
 16683         GO TO 8010-ARCH-NOT-OPEN,
 16684               1070-ARCH-NOT-FOUND,
 16685               1070-ARCH-NOT-FOUND
 16686         DEPENDING ON DFHEIGDI
 16687     ELSE IF DFHEIGDJ EQUAL 9
 16688         GO TO 2001-NOT-FOUND,
 16689               2001-NOT-FOUND,
 16690               8050-TEXT-NOT-OPEN
 16691         DEPENDING ON DFHEIGDI
 16692     ELSE IF DFHEIGDJ EQUAL 10
 16693         GO TO 2000-ENDBR
 16694         DEPENDING ON DFHEIGDI
 16695     ELSE IF DFHEIGDJ EQUAL 11
 16696         GO TO 8040-CNTL-NOT-OPEN,
 16697               6200-CNTL1-NOT-FOUND
 16698         DEPENDING ON DFHEIGDI
 16699     ELSE IF DFHEIGDJ EQUAL 12
 16700         GO TO 8040-CNTL-NOT-OPEN,
 16701               6250-CNTL2-NOT-FOUND
 16702         DEPENDING ON DFHEIGDI
 16703     ELSE IF DFHEIGDJ EQUAL 13
 16704         GO TO 8040-CNTL-NOT-OPEN,
 16705               6300-CNTL6-NOT-FOUND
 16706         DEPENDING ON DFHEIGDI
 16707     ELSE IF DFHEIGDJ EQUAL 14
 16708         GO TO 8040-CNTL-NOT-OPEN,
 16709               6350-CNTL2-NOT-FOUND
 16710         DEPENDING ON DFHEIGDI
 16711     ELSE IF DFHEIGDJ EQUAL 15
 16712         GO TO 8060-PNDB-NOT-OPEN,
 16713               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 360
* EL689.cbl
 16714         DEPENDING ON DFHEIGDI
 16715     ELSE IF DFHEIGDJ EQUAL 16
 16716         GO TO 8030-CERT-NOT-OPEN,
 16717               8035-CERT-NOT-FOUND
 16718         DEPENDING ON DFHEIGDI
 16719     ELSE IF DFHEIGDJ EQUAL 17
 16720         GO TO 8020-ACCT-NOT-OPEN,
 16721               6500-ACCT-NOT-FOUND,
 16722               6500-ONLY-STOP
 16723         DEPENDING ON DFHEIGDI
 16724     ELSE IF DFHEIGDJ EQUAL 18
 16725         GO TO 8080-COMP-NOT-OPEN,
 16726               6600-COMP-NOT-FOUND
 16727         DEPENDING ON DFHEIGDI
 16728     ELSE IF DFHEIGDJ EQUAL 19
 16729         GO TO 8040-CNTL-NOT-OPEN,
 16730               6630-CNTL2-NOT-FOUND
 16731         DEPENDING ON DFHEIGDI
 16732     ELSE IF DFHEIGDJ EQUAL 20
 16733         GO TO 8090-MAIL-NOT-OPEN,
 16734               6700-MAIL-NOT-FOUND
 16735         DEPENDING ON DFHEIGDI
 16736     ELSE IF DFHEIGDJ EQUAL 21
 16737         GO TO 8040-CNTL-NOT-OPEN,
 16738               6750-EXIT
 16739         DEPENDING ON DFHEIGDI
 16740     ELSE IF DFHEIGDJ EQUAL 22
 16741         GO TO 8040-CNTL-NOT-OPEN,
 16742               6800-EXIT
 16743         DEPENDING ON DFHEIGDI
 16744     ELSE IF DFHEIGDJ EQUAL 23
 16745         GO TO 8045-CHEK-NOT-OPEN,
 16746               6850-CHEK-NOT-FOUND
 16747         DEPENDING ON DFHEIGDI
 16748     ELSE IF DFHEIGDJ EQUAL 24
 16749         GO TO 8085-PYAJ-NOT-OPEN,
 16750               6900-PYAJ-NOT-FOUND
 16751         DEPENDING ON DFHEIGDI
 16752     ELSE IF DFHEIGDJ EQUAL 25
 16753         GO TO 7700-TS-ERROR,
 16754               7700-TS-ERROR
 16755         DEPENDING ON DFHEIGDI
 16756     ELSE IF DFHEIGDJ EQUAL 26
 16757         GO TO 7780-EXIT
 16758         DEPENDING ON DFHEIGDI
 16759     ELSE IF DFHEIGDJ EQUAL 27
 16760         GO TO 8040-CNTL-NOT-OPEN,
 16761               7945-NOT-FOUND
 16762         DEPENDING ON DFHEIGDI
 16763     ELSE IF DFHEIGDJ EQUAL 28
 16764         GO TO 7935-TERM-ERROR,
 16765               7940-TRAN-ERROR
 16766         DEPENDING ON DFHEIGDI
 16767     ELSE IF DFHEIGDJ EQUAL 29
 16768         GO TO 8010-ARCH-NOT-OPEN,
 16769               1070-ARCH-NOT-FOUND,
 16770               1070-ARCH-NOT-FOUND
 16771         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 361
* EL689.cbl
 16772     ELSE IF DFHEIGDJ EQUAL 30
 16773         GO TO 8300-SEND-TEXT
 16774         DEPENDING ON DFHEIGDI.
 16775     MOVE '9%                    "   ' TO DFHEIV0
 16776     MOVE 'EL689' TO DFHEIV1
 16777     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16778     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       98740     Code:       55085
