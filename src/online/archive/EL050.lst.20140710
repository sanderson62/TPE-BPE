* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50******************************************************************
    51 ENVIRONMENT DIVISION.
    52
    53 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page   3
* EL050.cbl
    55 WORKING-STORAGE SECTION.
    56 01  DFH-START PIC X(04).
    57
    58 77  FILLER   PIC X(32) VALUE '********************************'.
    59 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    60 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    61
    62 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    63 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    64                                   USAGE POINTER.
    65 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    66 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    67 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    68                                   USAGE IS POINTER.
    69 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    71                                   USAGE IS POINTER.
    72 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    74                                   USAGE IS POINTER.
    75
    76 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    78                                   USAGE IS POINTER.
    79
    80*    COPY ELC50WS.
    81*****************************************************************
    82*                                                               *
    83*                            ELC50WS.                           *
    84*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    85*                            VMOD=2.061.                        *
    86*                                                               *
    87*   THIS IS THE WORKING STORAGE FOR EL050                       *
    88*                                   EL517                       *
    89*****************************************************************
    90******************************************************************
    91*                   C H A N G E   L O G
    92*
    93* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    94*-----------------------------------------------------------------
    95*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    96* EFFECTIVE    NUMBER
    97*-----------------------------------------------------------------
    98* 123102                   PEMA  ADD DCC PROCESSING
    99* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   100* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   101* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   102* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   103* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   104* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   105* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   106* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   107* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   108* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   109* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   110* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   111* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   112* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page   4
* EL050.cbl
   113* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   114* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   115* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   116* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   117* 030309  CR2009021700001  PEMA  ADD ER-2883
   118* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   119* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   120* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   121* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   122* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   123* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   124* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   125* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   126* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   127* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   128* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   129* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   130* 061412  CR2011022800001  AJRA  NAPERSOFT
   131* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   132* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   133* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   134* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   135* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   136* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   137* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   138* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   139*-----------------------------------------------------------------
   140
   141 01  WORK-AREAS.
   142
   143*****************************************************************
   144*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   145*****************************************************************
   146
   147     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   148     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   149     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   150     12  WS-NAME-EDIT-WORK-AREA.
   151         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   152         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   153             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   154         16  WS-WORK-NAME.
   155             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   156             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   157             20  FILLER           PIC X(10)     VALUE SPACES.
   158         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   159             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   160
   161*****************************************************************
   162*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   163*****************************************************************
   164
   165     12  WS-ERRESC-KEY.
   166         16 WS-ERRESC-SEARCH-KEY.
   167             20  WS-ERRESC-COMPANY-CD PIC  X.
   168             20  WS-ERRESC-CARRIER    PIC  X.
   169             20  WS-ERRESC-GROUP      PIC X(6).
   170             20  WS-ERRESC-STATE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page   5
* EL050.cbl
   171             20  WS-ERRESC-ACCOUNT    PIC X(10).
   172         16 WS-ERRESC-RESIDUAL-KEY.
   173             20  WS-ERRESC-AGENT      PIC X(10).
   174             20  WS-ERRESC-RES-STATE  PIC XX.
   175             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   176*                                          YYYYMMDD
   177     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   178     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   179
   180*RESIDENT STATE TAX MASTER(ERRESS)
   181*
   182     12  WS-ERRESS-KEY.
   183         16  WS-ERRESS-COMPANY-CD      PIC  X.
   184         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   185         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   186         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   187*                                          YYYYMMDD
   188
   189     12  WS-CONTRACT-DATE              PIC 9(8).
   190*                                          YYYYMMDD
   191     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   192     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   193         16 WS-YEAR-YY                 PIC   9999.
   194         16 FILLER                     PIC 9(4).
   195*                                          YYYYMMDD
   196     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   197     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   198     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   199     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   200
   201     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   202         88  DPRB-1ST-TIME                      VALUE ' '.
   203
   204*****************************************************************
   205*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   206*****************************************************************
   207
   208     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   209     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   210     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   211     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   212     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   213     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   214     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   215     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   216     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   217     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   218     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   219         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   220         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   221     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   222         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   223         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   224     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   225
   226     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   227     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   228
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page   6
* EL050.cbl
   229     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   230     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   235     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   236     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   243     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   244     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   260     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   261     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   262     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   263     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   265     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   266     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   267     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   268     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   269     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   270     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   271     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   272     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   273     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   274     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   275     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   277     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   278     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   279     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   280     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   281     12  WS-2671-SW               PIC X         VALUE SPACE.
   282     12  WS-2672-SW               PIC X         VALUE SPACE.
   283     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   284         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   285     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   286         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page   7
* EL050.cbl
   287     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   288
   289     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   290         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   291         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   292         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   293         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   294
   295     12  WS-CREDIT-EDIT-CONTROLS.
   296         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   297         16  WS-MIN-AGE           PIC 99                VALUE  0.
   298         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   299         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   300         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   301         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   302
   303     12  WS-AGE-FIELDS.
   304         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   305         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   306         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   307         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   308
   309     12  WS-SAVE-ALLOWABLE-BENEFIT.
   310         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   311         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   312         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   313         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   314         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   315         16  FILLER                      PIC XX.
   316
   317     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   318     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   319     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   320     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   321     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   322     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   323     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   324     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   325     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   326     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   327
   328     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   329     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   330     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   331     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   332     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   333     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   334     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   335     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   336         88  WS-REDUCING              VALUE 'R'.
   337         88  WS-LEVEL                 VALUE 'L' 'P'.
   338     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   339
   340     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   341     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   342     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   343     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   344     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page   8
* EL050.cbl
   345     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   346     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   347     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   348     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   349
   350     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   351     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   352     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   353     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   354     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   355     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   356     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   357     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   358     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   359     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   360     12  WS-ACCT-SIG-SW.
   361         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   362         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   363     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   364     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   365     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   366     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   367     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   368     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   369     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   370     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   371     12  WS-INITIALS.
   372         16  WS-INIT-1            PIC X         VALUE SPACES.
   373         16  WS-INIT-2            PIC X         VALUE SPACES.
   374
   375     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   376     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   377     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   378     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   379     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   380*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   381     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   382     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   383     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   384     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   385     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   386     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   387     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   388     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   389     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   390     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   391     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   392     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   393     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   394     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   395     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   396     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   397     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   398     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   399     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   400     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   401     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   402     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page   9
* EL050.cbl
   403******** FLA
   404     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   405     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   406     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   407     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   408     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   409********
   410     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   411     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   412     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   413     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   414     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   415     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   416     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   417     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   418     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   419     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   420
   421     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   422         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   423                                         '0' THRU '9'.
   424
   425     12  NUMBER-OF-MONTHS.
   426         16  SK-MO OCCURS 12 TIMES PIC X.
   427
   428     12  WS-WORK-DATE.
   429         16  WS-YEAR            PIC 99    VALUE 00.
   430         16  WS-MONTH           PIC 99    VALUE 00.
   431         16  WS-DAY             PIC 99    VALUE 00.
   432
   433     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   434     12  WS-WORK-CRIT-DEV       REDEFINES
   435         WS-WORK-LF-CRIT-PER    PIC X(03).
   436
   437     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   438     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   439
   440     12  WS-WORK-DATE-FROM.
   441         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   442         16  FILLER             PIC X  VALUE SPACE.
   443         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   444         16  FILLER             PIC X         VALUE SPACE.
   445         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   446
   447     12  WS-WORK-DATE-THRU.
   448         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   449         16  FILLER             PIC X         VALUE SPACE.
   450         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   451         16  FILLER             PIC X         VALUE SPACE.
   452         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   453
   454     12  WS-LF-INPUT-CD.
   455         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   456         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   457
   458     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   459     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   460         16  WS-AH-INPUT-CD-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  10
* EL050.cbl
   461         16  WS-AH-INPUT-CD-2-3 PIC XX.
   462
   463     12  WS-SWITCHES.
   464         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   465         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   466             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   467         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   468             88  BANK-ACCT-FOUND          VALUE 'Y'.
   469         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   470             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   471         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   472             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   473         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   474             88  COMP-MASTER-FOUND        VALUE 'Y'.
   475         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   476             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   477         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   478             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   479         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   480             88  STAT-MASTER-FOUND        VALUE 'Y'.
   481         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   482             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   483         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   484             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   485         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   486             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   487         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   488             88  FORM-MASTER-FOUND        VALUE 'Y'.
   489         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   490             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   491         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   492             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   493         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   494             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   495         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   496             88  NO-BENEFIT-FOUND         VALUE 'N'.
   497         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   498             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   499         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   500             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   501         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   502             88  AH-BENEFIT-FOUND         VALUE ' '.
   503             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   504         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   505             88  LF-BENEFIT-FOUND         VALUE ' '.
   506             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   507         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   508             88  NO-STATE-RECORD          VALUE '1'.
   509         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   510             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   511         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   512             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   513         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   514             88  CERT-WAS-FOUND           VALUE ' '.
   515             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   516         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   517             88  BROWSE-STARTED           VALUE 'Y'.
   518         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  11
* EL050.cbl
   519             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   520         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   521             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   522         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   523             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   524         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   525             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   526         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   527             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   528         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   529             88  APP-CERT-USED            VALUE 'Y' 'A'.
   530         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   531             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   532             88  FIRST-TIME-THROUGH       VALUE '1'.
   533             88  CTBL-NOT-FOUND           VALUE '2'.
   534
   535         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   536             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   537
   538         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   539             88  DLO-ERROR-FOUND          VALUE 'Y'.
   540
   541********FLA
   542     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   543     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   544********
   545     12  RC-SW-1                  PIC X           VALUE '0'.
   546     12  RC-SW-2                  PIC X           VALUE '0'.
   547     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   548     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   549     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   550     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   551     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   552     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   553     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   554     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   555     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   556     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   557     12  LIT-SPACES               PIC X           VALUE SPACES.
   558     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   559     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   560     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   561     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   562     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   563     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   564     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   565         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   566         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   567     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   568         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   569
   570 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   571     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   572     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   573 01  WS-CRI-SSN-WORK-AREA.
   574     05  WS-CRI-SOC-SEC-NO.
   575         10  WS-SS-REPT-CD       PIC X(5).
   576         10  WS-SS-LAST-NAME     PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  12
* EL050.cbl
   577         10  WS-SS-INITIAL       PIC X.
   578
   579     05  WS-CRI-REPORT-CODE.
   580         10  FILLER              PIC X(5).
   581         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   582
   583     05  WS-CRI-LAST-NAME.
   584         10  WS-CRI-NAME-MOVE    PIC X(5).
   585         10  FILLER              PIC X(10).
   586
   587 01  WS-NUM-TABLE                PIC X(26)  VALUE
   588     '12345678012345070923456789'.
   589 01  FILLER REDEFINES WS-NUM-TABLE.
   590     05  WS-NUM OCCURS 26        PIC 9.
   591 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   592 01  V1                          PIC S999 COMP-3.
   593 01  V2                          PIC S999 COMP-3.
   594 01  V3                          PIC S999 COMP-3.
   595 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   596 01  FILLER REDEFINES WS-WORK-VIN.
   597     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   598 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   599 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   600 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   601 01  WS-HEX-WORK.
   602     05  FILLER                  PIC X  VALUE LOW-VALUES.
   603     05  WS-HEX-BYTE             PIC X.
   604 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   605 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   606 01  WS-WORK-HIN-ROW-B.
   607     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   608
   609 01  ws-benefit-cd-chg-sw      pic x value spaces.
   610     88  benefit-code-chg           value 'Y'.
   611 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   612 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   613     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   614 01  WS-ROW-D-TABLE.
   615     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   616
   617 01  WS-HIN-TABLE-B.
   618     05  F                       PIC XX VALUE 'A2'.
   619     05  F                       PIC XX VALUE 'B3'.
   620     05  F                       PIC XX VALUE 'C4'.
   621     05  F                       PIC XX VALUE 'D5'.
   622     05  F                       PIC XX VALUE 'E6'.
   623     05  F                       PIC XX VALUE 'F7'.
   624     05  F                       PIC XX VALUE 'G8'.
   625     05  F                       PIC XX VALUE 'H9'.
   626     05  F                       PIC XX VALUE 'I1'.
   627     05  F                       PIC XX VALUE 'J2'.
   628     05  F                       PIC XX VALUE 'K3'.
   629     05  F                       PIC XX VALUE 'L4'.
   630     05  F                       PIC XX VALUE 'M5'.
   631     05  F                       PIC XX VALUE 'N6'.
   632     05  F                       PIC XX VALUE 'O0'.
   633     05  F                       PIC XX VALUE 'P7'.
   634     05  F                       PIC XX VALUE 'Q0'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  13
* EL050.cbl
   635     05  F                       PIC XX VALUE 'R8'.
   636     05  F                       PIC XX VALUE 'S9'.
   637     05  F                       PIC XX VALUE 'T2'.
   638     05  F                       PIC XX VALUE 'U3'.
   639     05  F                       PIC XX VALUE 'V4'.
   640     05  F                       PIC XX VALUE 'W5'.
   641     05  F                       PIC XX VALUE 'X6'.
   642     05  F                       PIC XX VALUE 'Y7'.
   643     05  F                       PIC XX VALUE 'Z8'.
   644 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   645     05  WS-VAL-IN               PIC X.
   646     05  WS-VAL-OUT              PIC 9.
   647 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   648 01  WS-COMPARE-BINARY-DATES.
   649     05  WS-971231                PIC XX VALUE X'92FF'.
   650     05  WS-931231                PIC XX VALUE X'8CFF'.
   651     05  WS-791231                PIC XX VALUE X'77FF'.
   652     05  WS-771001                PIC XX VALUE X'74A1'.
   653     05  WS-820301                PIC XX VALUE X'7B41'.
   654     05  WS-831031                PIC XX VALUE X'7DBF'.
   655     05  WS-831231                PIC XX VALUE X'7DFF'.
   656     05  WS-810831                PIC XX VALUE X'7A7F'.
   657     05  WS-830901                PIC XX VALUE X'7D81'.
   658
   659 01  FILE-ACCESS-IDS.
   660     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   661     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   662     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   663     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   664     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   665     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   666     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   667     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   668     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   669     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   670     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   671     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   672     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   673     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   674     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   675     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   676     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   677 01  DD-IU-SW                    PIC X   VALUE ' '.
   678     88  DD-IU-PRESENT                 VALUE 'Y'.
   679
   680 01  ACCESS-KEYS.
   681     12  ELMSTR-KEY.
   682         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   683         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   684     12  W-CLAIM-KEY.
   685         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   686         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   687
   688     12  ELCNTL-KEY.
   689         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   690         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   691         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   692         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  14
* EL050.cbl
   693
   694     12  ELCERT-KEY.
   695         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   696         16  CERT-CARRIER         PIC X       VALUE SPACE.
   697         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   698         16  CERT-STATE           PIC XX      VALUE SPACES.
   699         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   700         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   701         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   702
   703     12  ELCERT2-KEY.
   704         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   705         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   706
   707     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   708
   709     12  ELCERT-SAVE.
   710         16  FILLER                      PIC XX    VALUE SPACES.
   711
   712         16  WCS-CONTROL-PRIMARY.
   713             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   714             20  WCS-CARRIER             PIC X     VALUE SPACE.
   715             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   716             20  WCS-STATE               PIC XX    VALUE SPACES.
   717             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   718             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   719             20  WCS-CERT-NO.
   720                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   721                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   722
   723         16  CS-CONTROL-BY-NAME.
   724             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   725             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   726             20  CS-INSURED-INITIALS.
   727                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   728                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   729
   730         16  CS-CONTROL-BY-SSN.
   731             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   732             20  CS-SOC-SEC-NO.
   733                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   734                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   735                 24  CS-SSN-LN3.
   736                     28 CS-INSURED-INITIALS-A2   PIC XX
   737                                     VALUE SPACES.
   738                     28 CS-PART-LAST-NAME-A2     PIC X
   739                                     VALUE SPACE.
   740
   741         16  CS-CONTROL-BY-CERT-NO.
   742             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   743             20  CS-CERT-NO-A4           PIC X(11)
   744                                     VALUE SPACES.
   745
   746         16  CS-CONTROL-BY-MEMB.
   747             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   748             20  CS-MEMBER-NO.
   749                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   750                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  15
* EL050.cbl
   751                 24  CS-MEMB-LN4.
   752                     28 CS-INSURED-INITIALS-A5   PIC XX
   753                                      VALUE SPACES.
   754                     28 CS-PART-LAST-NAME-A5     PIC XX
   755                                      VALUE SPACES.
   756
   757         16  FILLER              PIC X(360) VALUE SPACES.
   758
   759     12  ERACCT-KEY.
   760         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   761         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   762         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   763         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   764         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   765         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   766
   767     12  ERCOMP-KEY.
   768         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   769         16  COMP-CARRIER         PIC X     VALUE SPACES.
   770         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   771         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   772         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   773         16  COMP-TYPE            PIC X     VALUE SPACES.
   774
   775     12  ERLOFC-KEY.
   776         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   777         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   778         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   779         16  LOFC-STATE           PIC XX    VALUE SPACES.
   780         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   781         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   782
   783     12  WS-ELCRTT-KEY.
   784         16  WS-ELCRTT-PRIMARY       PIC X(33).
   785         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   786
   787     12  ERBXRF-KEY.
   788         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   789         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   790         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   791         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   792
   793     12  ERAGTC-KEY.
   794         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   795         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   796         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   797         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   798         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   799         16  AGTC-TYPE            PIC X     VALUE SPACES.
   800
   801     12  ERPLAN-KEY.
   802         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   803         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   804         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   805         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   806         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   807         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   808         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  16
* EL050.cbl
   809         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   810
   811     12  ERFORM-KEY.
   812         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   813         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   814         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   815         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   816
   817     12  ERREIN-KEY.
   818         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   819         16  REIN-TYPE            PIC X     VALUE SPACES.
   820         16  REIN-TABLE-CO.
   821             20  REIN-CODE-1      PIC X     VALUE SPACE.
   822             20  REIN-CODE-2      PIC X     VALUE SPACE.
   823             20  REIN-CODE-3      PIC X     VALUE SPACE.
   824         16  FILLER               PIC X(3)  VALUE SPACES.
   825
   826     12  ERCTBL-KEY.
   827         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   828         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   829         16  CTBL-CNTRL-2.
   830             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   831             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   832
   833     12  ELCRTO-KEY.
   834         16  ELCRTO-COMPANY-CD       PIC X.
   835         16  ELCRTO-CARRIER          PIC X.
   836         16  ELCRTO-GROUPING         PIC X(6).
   837         16  ELCRTO-STATE            PIC XX.
   838         16  ELCRTO-ACCOUNT          PIC X(10).
   839         16  ELCRTO-CERT-EFF-DT      PIC XX.
   840         16  ELCRTO-CERT-NO.
   841             20  ELCRTO-CERT-PRIME   PIC X(10).
   842             20  ELCRTO-CERT-SFX     PIC X.
   843         16  ELCRTO-RECORD-TYPE      PIC X.
   844         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   845
   846
   847     12  WS-ACCESS.
   848         16  FILLER               PIC XX    VALUE SPACES.
   849         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   850
   851     12  WS-CARR-ACCESS.
   852         16  FILLER               PIC X(3)  VALUE SPACES.
   853         16  WS-CARR              PIC X     VALUE SPACE.
   854*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   855*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   856     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   857         88  WS-DMD-LF-RATING   VALUE 'Y'.
   858         88  WS-DMD-AH-RATING   VALUE 'Y'.
   859         88  WS-DMD-NO-RATING   VALUE 'N'.
   860
   861     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   862         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   863                                         'NJ' 'NL'
   864                                         'PJ' 'PL'
   865                                         'SJ' 'SL'.
   866     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  17
* EL050.cbl
   867         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   868                                         'NI' 'NJ' 'NL' 'NU'
   869                                         'PJ' 'PL' 'PI' 'PU'
   870                                         'SI' 'SJ' 'SL' 'SU'
   871                                         'MX' 'MY' 'MZ'.
   872 01  ERPDEF-KEY-SAVE             PIC X(18).
   873 01  ERPDEF-KEY.
   874     12  ERPDEF-COMPANY-CD       PIC X.
   875     12  ERPDEF-STATE            PIC XX.
   876     12  ERPDEF-PROD-CD          PIC XXX.
   877     12  F                       PIC X(7).
   878     12  ERPDEF-BEN-TYPE         PIC X.
   879     12  ERPDEF-BEN-CODE         PIC XX.
   880     12  ERPDEF-EXP-DT           PIC XX.
   881
   882 01  ELSTAT-KEY-SAVE             PIC X(20).
   883 01  ELSTAT-KEY.
   884     12  ELSTAT-COMPANY-ID       PIC XXX.
   885     12  ELSTAT-CARRIER          PIC X.
   886     12  ELSTAT-GROUP            PIC X(6).
   887     12  ELSTAT-STATE            PIC XX.
   888     12  ELSTAT-EXP-DT           PIC 9(8).
   889 01  WS-ERROR-VALUES.
   890     12  ER-1570                     PIC S9(4)   VALUE +1570.
   891     12  ER-1571                     PIC S9(4)   VALUE +1571.
   892     12  er-1572                     pic s9(4)   value +1572.
   893     12  er-1573                     pic s9(4)   value +1573.
   894     12  er-1574                     pic s9(4)   value +1574.
   895     12  ER-1575                     PIC S9(4)   VALUE +1575.
   896     12  ER-1891                     PIC S9(4)   VALUE +1891.
   897     12  ER-1892                     PIC S9(4)   VALUE +1892.
   898     12  ER-1893                     PIC S9(4)   VALUE +1893.
   899     12  ER-1894                     PIC S9(4)   VALUE +1894.
   900     12  ER-1895                     PIC S9(4)   VALUE +1895.
   901     12  ER-1896                     PIC S9(4)   VALUE +1896.
   902     12  ER-1897                     PIC S9(4)   VALUE +1897.
   903     12  ER-1898                     PIC S9(4)   VALUE +1898.
   904     12  ER-1899                     PIC S9(4)   VALUE +1899.
   905     12  ER-1900                     PIC S9(4)   VALUE +1900.
   906     12  ER-1901                     PIC S9(4)   VALUE +1901.
   907     12  ER-1902                     PIC S9(4)   VALUE +1902.
   908     12  ER-1903                     PIC S9(4)   VALUE +1903.
   909     12  ER-1904                     PIC S9(4)   VALUE +1904.
   910     12  ER-1905                     PIC S9(4)   VALUE +1905.
   911     12  ER-1906                     PIC S9(4)   VALUE +1906.
   912     12  ER-1907                     PIC S9(4)   VALUE +1907.
   913     12  ER-1909                     PIC S9(4)   VALUE +1909.
   914     12  ER-1910                     PIC S9(4)   VALUE +1910.
   915     12  ER-1911                     PIC S9(4)   VALUE +1911.
   916     12  ER-1912                     PIC S9(4)   VALUE +1912.
   917     12  ER-1913                     PIC S9(4)   VALUE +1913.
   918     12  ER-1914                     PIC S9(4)   VALUE +1914.
   919     12  ER-1915                     PIC S9(4)   VALUE +1915.
   920     12  ER-1916                     PIC S9(4)   VALUE +1916.
   921     12  ER-1917                     PIC S9(4)   VALUE +1917.
   922     12  ER-1918                     PIC S9(4)   VALUE +1918.
   923     12  ER-1919                     PIC S9(4)   VALUE +1919.
   924     12  ER-1920                     PIC S9(4)   VALUE +1920.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  18
* EL050.cbl
   925     12  ER-1921                     PIC S9(4)   VALUE +1921.
   926     12  ER-1922                     PIC S9(4)   VALUE +1922.
   927     12  ER-1923                     PIC S9(4)   VALUE +1923.
   928     12  ER-1924                     PIC S9(4)   VALUE +1924.
   929     12  ER-1925                     PIC S9(4)   VALUE +1925.
   930     12  ER-1926                     PIC S9(4)   VALUE +1926.
   931     12  ER-1927                     PIC S9(4)   VALUE +1927.
   932     12  ER-2393                     PIC S9(4)   VALUE +2393.
   933     12  ER-2600                     PIC S9(4)   VALUE +2600.
   934     12  ER-2601                     PIC S9(4)   VALUE +2601.
   935     12  ER-2602                     PIC S9(4)   VALUE +2602.
   936     12  ER-2603                     PIC S9(4)   VALUE +2603.
   937     12  ER-2604                     PIC S9(4)   VALUE +2604.
   938     12  ER-2605                     PIC S9(4)   VALUE +2605.
   939     12  ER-2606                     PIC S9(4)   VALUE +2606.
   940     12  ER-2607                     PIC S9(4)   VALUE +2607.
   941     12  ER-2608                     PIC S9(4)   VALUE +2608.
   942     12  ER-2609                     PIC S9(4)   VALUE +2609.
   943     12  ER-2610                     PIC S9(4)   VALUE +2610.
   944     12  ER-2611                     PIC S9(4)   VALUE +2611.
   945     12  ER-2612                     PIC S9(4)   VALUE +2612.
   946     12  ER-2613                     PIC S9(4)   VALUE +2613.
   947     12  ER-2614                     PIC S9(4)   VALUE +2614.
   948     12  ER-2615                     PIC S9(4)   VALUE +2615.
   949     12  ER-2616                     PIC S9(4)   VALUE +2616.
   950     12  ER-2617                     PIC S9(4)   VALUE +2617.
   951     12  ER-2618                     PIC S9(4)   VALUE +2618.
   952     12  ER-2619                     PIC S9(4)   VALUE +2619.
   953     12  ER-2620                     PIC S9(4)   VALUE +2620.
   954     12  ER-2621                     PIC S9(4)   VALUE +2621.
   955     12  ER-2622                     PIC S9(4)   VALUE +2622.
   956     12  ER-2623                     PIC S9(4)   VALUE +2623.
   957     12  ER-2624                     PIC S9(4)   VALUE +2624.
   958     12  ER-2625                     PIC S9(4)   VALUE +2625.
   959     12  ER-2626                     PIC S9(4)   VALUE +2626.
   960     12  ER-2627                     PIC S9(4)   VALUE +2627.
   961     12  ER-2628                     PIC S9(4)   VALUE +2628.
   962     12  ER-2629                     PIC S9(4)   VALUE +2629.
   963     12  ER-2630                     PIC S9(4)   VALUE +2630.
   964     12  ER-2631                     PIC S9(4)   VALUE +2631.
   965     12  ER-2632                     PIC S9(4)   VALUE +2632.
   966     12  ER-2633                     PIC S9(4)   VALUE +2633.
   967     12  ER-2634                     PIC S9(4)   VALUE +2634.
   968     12  ER-2635                     PIC S9(4)   VALUE +2635.
   969     12  ER-2636                     PIC S9(4)   VALUE +2636.
   970     12  ER-2637                     PIC S9(4)   VALUE +2637.
   971     12  ER-2638                     PIC S9(4)   VALUE +2638.
   972     12  ER-2639                     PIC S9(4)   VALUE +2639.
   973     12  ER-2640                     PIC S9(4)   VALUE +2640.
   974     12  ER-2641                     PIC S9(4)   VALUE +2641.
   975     12  ER-2642                     PIC S9(4)   VALUE +2642.
   976     12  ER-2643                     PIC S9(4)   VALUE +2643.
   977     12  ER-2644                     PIC S9(4)   VALUE +2644.
   978     12  ER-2645                     PIC S9(4)   VALUE +2645.
   979     12  ER-2646                     PIC S9(4)   VALUE +2646.
   980     12  ER-2647                     PIC S9(4)   VALUE +2647.
   981     12  ER-2648                     PIC S9(4)   VALUE +2648.
   982     12  ER-2649                     PIC S9(4)   VALUE +2649.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  19
* EL050.cbl
   983     12  ER-2650                     PIC S9(4)   VALUE +2650.
   984     12  ER-2651                     PIC S9(4)   VALUE +2651.
   985     12  ER-2652                     PIC S9(4)   VALUE +2652.
   986     12  ER-2653                     PIC S9(4)   VALUE +2653.
   987     12  ER-2654                     PIC S9(4)   VALUE +2654.
   988     12  ER-2655                     PIC S9(4)   VALUE +2655.
   989     12  ER-2656                     PIC S9(4)   VALUE +2656.
   990     12  ER-2657                     PIC S9(4)   VALUE +2657.
   991     12  ER-2658                     PIC S9(4)   VALUE +2658.
   992     12  ER-2659                     PIC S9(4)   VALUE +2659.
   993     12  ER-2660                     PIC S9(4)   VALUE +2660.
   994     12  ER-2661                     PIC S9(4)   VALUE +2661.
   995     12  ER-2662                     PIC S9(4)   VALUE +2662.
   996     12  ER-2663                     PIC S9(4)   VALUE +2663.
   997     12  ER-2664                     PIC S9(4)   VALUE +2664.
   998     12  ER-2665                     PIC S9(4)   VALUE +2665.
   999     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1000     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1001     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1002     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1003     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1004     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1005     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1006     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1007     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1008     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1009     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1010     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1011     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1012     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1013     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1014     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1015     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1016     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1017     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1018     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1019     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1020     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1021     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1022     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1023     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1024     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1025     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1026     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1027     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1028     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1029     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1030     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1031     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1032     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1033     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1034     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1035     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1036     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1037     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1038     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1039     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1040     12  ER-2709                     PIC S9(4)   VALUE +2709.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  20
* EL050.cbl
  1041     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1042     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1043     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1044     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1045     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1046     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1047     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1048     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1049     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1050     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1051     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1052     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1053     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1054     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1055     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1056     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1057     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1058     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1059     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1060     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1061     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1062     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1063     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1064     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1065     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1066     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1067     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1068     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1069     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1070     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1071     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1072     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1073     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1074     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1075     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1076     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1077     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1078     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1079     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1080     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1081     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1082     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1083     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1084     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1085     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1086     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1087     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1088     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1089     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1090     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1091     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1092     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1093     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1094     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1095     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1096     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1097     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1098     12  ER-2775                     PIC S9(4)   VALUE +2775.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  21
* EL050.cbl
  1099     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1100     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1101     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1102     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1103     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1104     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1105     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1106     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1107     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1108     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1109     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1110     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1111     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1112     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1113     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1114     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1115     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1116     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1117     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1118     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1119     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1120     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1121     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1122     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1123     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1124     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1125     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1126     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1127     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1128     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1129     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1130     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1131     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1132     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1133     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1134     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1135     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1136     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1137     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1138     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1139     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1140     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1141     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1142     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1143     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1144     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1145     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1146     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1147     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1148     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1149     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1150     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1151     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1152     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1153     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1154     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1155     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1156     12  ER-7815                     PIC S9(4)   VALUE +7815.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  22
* EL050.cbl
  1157     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1158     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1159     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1160     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1161     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1162     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1163     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1164     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1165     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1166     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1167     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1168     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1169     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1170     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1171     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1172     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1173     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1174     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1175     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1176     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1177     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1178     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1179     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1180     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1181     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1182     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1183     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1184     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1185     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1186     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1187     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1188     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1189     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1190     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1191     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1192     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1193     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1194     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1195     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1196     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1197     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1198     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1199     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1200     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1201     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1202     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1203     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1204     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1205     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1206     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1207     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1208     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1209     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1210     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1211     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1212     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1213     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1214     12  ER-8113                     PIC S9(4)   VALUE +8113.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  23
* EL050.cbl
  1215     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1216     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1217     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1218     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1219     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1220     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1221     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1222     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1223     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1224     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1225     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1226     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1227     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1228     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1229     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1230     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1231     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1232     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1233     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1234     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1235     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1236     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1237******************************************************************
  1238***************   END OF ELC50WS     ****************************
  1239******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  24
* EL050.cbl
  1242 01  WORKING-STORAGE-WORK-AREAS.
  1243     12  WS-RESPONSE             PIC S9(8)  COMP.
  1244         88  WS-RESP-NORMAL           VALUE +00.
  1245         88  WS-RESP-ERROR            VALUE +01.
  1246         88  WS-RESP-NOTFND           VALUE +13.
  1247         88  WS-RESP-DUPREC           VALUE +14.
  1248         88  WS-RESP-ENDFILE          VALUE +20.
  1249     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1250     12  WORK-AREAS.
  1251         16  WK-CONV-GREG.
  1252             24  WCG-CENT             PIC XX.
  1253             24  WCG-REST             PIC X(4).
  1254         16  WORK-GREGORIAN-DATE.
  1255             24  WK-GREG-CENT         PIC XX.
  1256             24  WK-GREG-DATE-YYMMDD.
  1257                 28  WK-GREG-YYMM     PIC X(4).
  1258                 28  WK-GREG-DD       PIC XX.
  1259
  1260         16  WORK-SELECT-DATE.
  1261             24  WK-SELECT-CENT            PIC XX.
  1262             24  WK-SELECT-DATE-YYMMDD.
  1263                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1264                 28  FILLER                PIC XX.
  1265
  1266         16  WK-FORM-NO.
  1267             24  WK-FORM-BANK-ID       PIC X(5).
  1268             24  WK-FORM-UNDRWRTR      PIC X(1).
  1269             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1270
  1271         16  WK-MEMBER-NO.
  1272             24  WK-MEMBER-1-6        PIC X(6).
  1273             24  WK-MEMBER-7-12       PIC X(6).
  1274
  1275         16  WK-FULL-CERT-NO.
  1276             24  WK-CERT-POS-1-2      PIC X(2).
  1277             24  WK-CERT-POS-3        PIC X(1).
  1278             24  WK-CERT-POS-4        PIC X(1).
  1279             24  WK-CERT-POS-5-6      PIC X(2).
  1280             24  WK-CERT-POS-7        PIC X(1).
  1281             24  WK-CERT-POS-8-11     PIC X(4).
  1282
  1283         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1284             88  VALID-RATE-CODE        VALUE 'Y'.
  1285             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1286
  1287         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1288         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1289         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1290         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1291         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1292         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1293         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1294         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1295         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1296         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1297
  1298* DLO001
  1299 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  25
* EL050.cbl
  1300     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1301     12  DMPF-RETURN-CODE          PIC XX.
  1302         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1303         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1304         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1305         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1306         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1307         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1308
  1309* DLO002
  1310 01  WS-DLO-INTERNAL-POLICY-FORM.
  1311     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1312     12  DIPF-RETURN-CODE          PIC XX.
  1313         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1314         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1315         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1316         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1317         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1318         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1319
  1320* DLO003
  1321 01  WS-DLO-VALID-BANK-ID.
  1322     12  DVBI-BANK-ID              PIC X(5).
  1323     12  DVBI-BANK-ID-TYPE         PIC X.
  1324         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1325         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1326         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1327         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1328         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1329     12  DVBI-RETURN-CODE          PIC XX.
  1330         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1331         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1332         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1333         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1334         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1335         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1336         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1337         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1338         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1339
  1340* DLO007
  1341 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1342     12  DCUA-RES-STATE            PIC XX.
  1343     12  DCUA-BEN-TYPE             PIC XX.
  1344     12  DCUA-SYS-IDENT            PIC X.
  1345         88  DCUA-CLAIM                        VALUE 'C'.
  1346         88  DCUA-PREMIUM                      VALUE 'P'.
  1347     12  DCUA-COVERAGE-RULE        PIC X.
  1348     12  DCUA-CLIENT-ID            PIC X(10).
  1349     12  DCUA-EFF-DATE             PIC X(8).
  1350     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1351     12  DCUA-RETURN-CODE          PIC XX.
  1352         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1353     12  DCUA-CERT-NUMBER          PIC X(11).
  1354     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1355     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1356
  1357* DLO011
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  26
* EL050.cbl
  1358 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1359     12  DPRB-RATE-CODE            PIC X(4).
  1360     12  DPRB-COVERAGE-CATEG       PIC X.
  1361     12  DPRB-RETURN-CODE          PIC XX.
  1362         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1363         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1364         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1365         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1366         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1367         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1368         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1369         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1370         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1371     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1372     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1373     12  DPRB-BEN-TYPE             PIC XX.
  1374
  1375* DLO017
  1376 01  WS-DLO-VALID-RATE-CODE.
  1377     12  DVRC-RATE-CODE            PIC X(4).
  1378     12  DVRC-RETURN-CODE          PIC XX.
  1379         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1380         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1381         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1382         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1383         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1384         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1385
  1386* DLO019
  1387 01  WS-DLO-ORIG-COV-CAT.
  1388     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1389     12  DOCC-RETURN-CODE          PIC XX.
  1390     12  DOCC-ORIG-COV-CAT         PIC X.
  1391     12  DOCC-UNDERWITER           PIC XX.
  1392     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1393     12  DOCC-FILLER               PIC X(6).
  1394
  1395* DLO021
  1396 01  WS-DLO-VALID-LOAN-OFFICER.
  1397     12  DVLO-LOAN-OFFICER.
  1398         16  DVLO-BILL-TYPE        PIC X.
  1399         16  DVLO-BILL-SOURCE      PIC X.
  1400         16  DVLO-BATCH-TYPE       PIC X.
  1401     12  DVLO-RETURN-CODE          PIC XX.
  1402         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1403         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1404         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1405         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1406         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1407         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1408
  1409* DLO022
  1410 01  WS-DLO-VALID-STATE-CODE.
  1411     12  DVSC-STATE-CODE           PIC XX.
  1412     12  DVSC-RETURN-CODE          PIC XX.
  1413         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1414
  1415* DLO023
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  27
* EL050.cbl
  1416 01  WS-DLO-VALID-CODE-VALUES.
  1417     12  DVCV-SYSTEM-ID            PIC XX.
  1418         88  DVCV-CLAIMS                       VALUE 'CL'.
  1419         88  DVCV-CREDIT                       VALUE 'CR'.
  1420     12  DVCV-RECORD-TYPE          PIC XX.
  1421         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1422         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1423         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1424         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1425         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1426         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1427         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1428         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1429     12  DVCV-RECORD-KEY           PIC X(6).
  1430     12  DVCV-RETURN-CODE          PIC XX.
  1431         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1432         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1433         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1434         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1435         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1436         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1437         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1438     12  DVCV-CODE-DESC            PIC X(60).
  1439     12  DVCV-GEN-DESC-1           PIC X(20).
  1440     12  DVCV-GEN-DESC-2           PIC X(20).
  1441     12  DVCV-GEN-DESC-3           PIC X(20).
  1442
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  28
* EL050.cbl
  1444*    COPY ERCBXRF.
  1445******************************************************************
  1446*                                                                *
  1447*                                                                *
  1448*                            ERCBXRF                             *
  1449*                                                                *
  1450*   ONLINE CREDIT SYSTEM                                         *
  1451*                                                                *
  1452*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1453*                                                                *
  1454*   FILE TYPE = VSAM,KSDS                                        *
  1455*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1456*                                                                *
  1457*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1458*       ALTERNATE PATH = NONE                                    *
  1459*                                                                *
  1460*   LOG = NO                                                     *
  1461*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1462*                                                                *
  1463******************************************************************
  1464
  1465 01  BANK-CROSS-REFERENCE.
  1466     12  BK-RECORD-ID                PIC XX.
  1467         88  VALID-BK-ID             VALUE 'BK'.
  1468
  1469     12  BK-CONTROL-PRIMARY.
  1470         16  BK-COMPANY-CD           PIC X.
  1471         16  BK-CARRIER              PIC X.
  1472         16  BK-GROUPING             PIC X(6).
  1473         16  BK-BANK-NO              PIC X(10).
  1474
  1475     12  BK-MAINT-INFORMATION.
  1476         16  BK-LAST-MAINT-DT        PIC XX.
  1477         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1478         16  BK-LAST-MAINT-USER      PIC X(4).
  1479         16  FILLER                  PIC X(9).
  1480
  1481     12  FILLER                      PIC X(37).
  1482
  1483     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1484
  1485     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1486                            DEPENDING ON BK-BANK-POINTER-CNT.
  1487         16  BK-AM-ACCOUNT           PIC X(10).
  1488         16  BK-AM-EXP-DT            PIC XX.
  1489         16  BK-AM-EFF-DT            PIC XX.
  1490         16  BK-AM-STATE             PIC XX.
  1491         16  FILLER                  PIC X(20).
  1492
  1493******************************************************************
  1494
  1495*    COPY ERCCOMP.
  1496******************************************************************
  1497*                                                                *
  1498*                                                                *
  1499*                            ERCCOMP                             *
  1500*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1501*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  29
* EL050.cbl
  1502*                                                                *
  1503*   ONLINE CREDIT SYSTEM                                         *
  1504*                                                                *
  1505*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1506*                                                                *
  1507*   FILE TYPE = VSAM,KSDS                                        *
  1508*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1509*                                                                *
  1510*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1511*       ALTERNATE PATH = NONE                                    *
  1512*                                                                *
  1513*   LOG = NO                                                     *
  1514*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1515*                                                                *
  1516******************************************************************
  1517*                   C H A N G E   L O G
  1518*
  1519* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1520*-----------------------------------------------------------------
  1521*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1522* EFFECTIVE    NUMBER
  1523*-----------------------------------------------------------------
  1524* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1525* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1526* 092205    2005050300006  PEMA  ADD LEASE FEE
  1527* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1528* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1529* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1530* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1531* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1532* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1533******************************************************************
  1534
  1535 01  COMPENSATION-MASTER.
  1536     12  CO-RECORD-ID                          PIC XX.
  1537         88  VALID-CO-ID                          VALUE 'CO'.
  1538
  1539     12  CO-CONTROL-PRIMARY.
  1540         16  CO-COMPANY-CD                     PIC X.
  1541         16  CO-CONTROL.
  1542             20  CO-CTL-1.
  1543                 24  CO-CARR-GROUP.
  1544                     28  CO-CARRIER            PIC X.
  1545                     28  CO-GROUPING.
  1546                         32  CO-GROUP-PREFIX   PIC XXX.
  1547                         32  CO-GROUP-PRIME    PIC XXX.
  1548                 24  CO-RESP-NO.
  1549                     28  CO-RESP-PREFIX        PIC X(4).
  1550                     28  CO-RESP-PRIME         PIC X(6).
  1551             20  CO-CTL-2.
  1552                 24  CO-ACCOUNT.
  1553                     28  CO-ACCT-PREFIX        PIC X(4).
  1554                     28  CO-ACCT-PRIME         PIC X(6).
  1555         16  CO-TYPE                           PIC X.
  1556             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1557             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1558             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1559
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  30
* EL050.cbl
  1560     12  CO-MAINT-INFORMATION.
  1561         16  CO-LAST-MAINT-DT                  PIC XX.
  1562         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1563         16  CO-LAST-MAINT-USER                PIC X(4).
  1564     12  FILLER                                PIC XX.
  1565     12  CO-STMT-TYPE                          PIC XXX.
  1566     12  CO-COMP-TYPE                          PIC X.
  1567         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1568     12  CO-STMT-OWNER                         PIC X(4).
  1569     12  CO-BALANCE-CONTROL                    PIC X.
  1570         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1571         88  CO-NO-BALANCE                        VALUE 'N'.
  1572
  1573     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1574         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1575         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1576         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1577
  1578     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1579         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1580         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1581
  1582     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1583     12  CO-GA-DIRECT-DEP                      PIC X.
  1584     12  CO-FUTURE-SPACE                       PIC X.
  1585         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1586
  1587     12  CO-ACCT-NAME                          PIC X(30).
  1588     12  CO-MAIL-NAME                          PIC X(30).
  1589     12  CO-ADDR-1                             PIC X(30).
  1590     12  CO-ADDR-2                             PIC X(30).
  1591     12  CO-ADDR-3.
  1592         16  CO-ADDR-CITY                      PIC X(27).
  1593         16  CO-ADDR-STATE                     PIC XX.
  1594     12  CO-CSO-1099                           PIC X.
  1595     12  CO-ZIP.
  1596         16  CO-ZIP-PRIME.
  1597             20  CO-ZIP-PRI-1ST                PIC X.
  1598                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1599             20  FILLER                        PIC X(4).
  1600         16  CO-ZIP-PLUS4                      PIC X(4).
  1601     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1602         16  CO-CAN-POSTAL-1                   PIC XXX.
  1603         16  CO-CAN-POSTAL-2                   PIC XXX.
  1604         16  FILLER                            PIC XXX.
  1605     12  CO-SOC-SEC                            PIC X(13).
  1606     12  CO-TELEPHONE.
  1607         16  CO-AREA-CODE                      PIC XXX.
  1608         16  CO-PREFIX                         PIC XXX.
  1609         16  CO-PHONE                          PIC X(4).
  1610
  1611     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1612
  1613     12  CO-AR-BAL-LEVEL                       PIC X.
  1614         88  CO-AR-REF-LVL                        VALUE '1'.
  1615         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1616         88  CO-AR-BILL-LVL                       VALUE '2'.
  1617         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  31
* EL050.cbl
  1618         88  CO-AR-FR-LVL                         VALUE '4'.
  1619
  1620     12  CO-AR-NORMAL-PRINT                    PIC X.
  1621         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1622         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1623
  1624     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1625
  1626     12  CO-AR-REPORTING                       PIC X.
  1627         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1628         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1629
  1630     12  CO-AR-PULL-CHECK                      PIC X.
  1631         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1632         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1633
  1634     12  CO-AR-BALANCE-PRINT                   PIC X.
  1635         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1636
  1637     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1638         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1639         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1640         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1641
  1642     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1643
  1644     12  CO-USER-CODE                          PIC X.
  1645     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1646
  1647******************************************************************
  1648*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1649*    THE LAST MONTH END RUN.
  1650******************************************************************
  1651
  1652     12  CO-LAST-ACTIVITY-DATE.
  1653         16  CO-ACT-YEAR                       PIC 99.
  1654         16  CO-ACT-MONTH                      PIC 99.
  1655         16  CO-ACT-DAY                        PIC 99.
  1656
  1657     12  CO-LAST-STMT-DT.
  1658         16  CO-LAST-STMT-YEAR                 PIC 99.
  1659         16  CO-LAST-STMT-MONTH                PIC 99.
  1660         16  CO-LAST-STMT-DAY                  PIC 99.
  1661
  1662     12  CO-MO-END-TOTALS.
  1663         16  CO-MONTHLY-TOTALS.
  1664             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1665             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1666             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1667             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1668             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1669
  1670         16  CO-AGING-TOTALS.
  1671             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1672             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1673             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1674             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1675
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  32
* EL050.cbl
  1676         16  CO-YTD-TOTALS.
  1677             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1678             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1679
  1680         16  CO-OVER-UNDER-TOTALS.
  1681             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1682             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1683
  1684     12  CO-MISCELLANEOUS-TOTALS.
  1685         16  CO-FICA-TOTALS.
  1686             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1687             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1688
  1689         16  CO-CLAIM-TOTALS.
  1690             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1691             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1692
  1693******************************************************************
  1694*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1695*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1696******************************************************************
  1697
  1698     12  CO-CURRENT-TOTALS.
  1699         16  CO-CURRENT-LAST-STMT-DT.
  1700             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1701             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1702             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1703
  1704         16  CO-CURRENT-MONTHLY-TOTALS.
  1705             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1706             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1707             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1708             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1709             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1710
  1711         16  CO-CURRENT-AGING-TOTALS.
  1712             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1713             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1714             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1715             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1716
  1717         16  CO-CURRENT-YTD-TOTALS.
  1718             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1719             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1720
  1721     12  CO-PAID-COMM-TOTALS.
  1722         16  CO-YTD-PAID-COMMS.
  1723             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1724             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1725
  1726     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1727         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1728         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1729
  1730     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1731         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1732         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1733         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  33
* EL050.cbl
  1734         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1735         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1736         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1737         88  CO-FINAL-LETTER                  VALUE 'F'.
  1738         88  CO-RECONCILING                   VALUE 'R'.
  1739         88  CO-PHONE-CALL                    VALUE 'P'.
  1740         88  CO-LEGAL                         VALUE 'L'.
  1741         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1742         88  CO-WRITE-OFF                     VALUE 'W'.
  1743         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1744
  1745     12  CO-CSR-CODE                       PIC X(4).
  1746
  1747     12  CO-GA-STATUS-INFO.
  1748         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1749         16  CO-GA-TERMINATION-DT          PIC XX.
  1750         16  CO-GA-STATUS-CODE             PIC X.
  1751             88  CO-GA-ACTIVE                 VALUE 'A'.
  1752             88  CO-GA-INACTIVE               VALUE 'I'.
  1753             88  CO-GA-PENDING                VALUE 'P'.
  1754         16  CO-GA-COMMENTS.
  1755             20  CO-GA-COMMENT-1           PIC X(40).
  1756             20  CO-GA-COMMENT-2           PIC X(40).
  1757             20  CO-GA-COMMENT-3           PIC X(40).
  1758             20  CO-GA-COMMENT-4           PIC X(40).
  1759
  1760     12  CO-RPTCD2                         PIC X(10).
  1761     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1762         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1763         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1764
  1765     12  CO-TYPE-AGENT                     PIC X(01).
  1766         88  CO-CORPORATION                   VALUE 'C'.
  1767         88  CO-PARTNERSHIP                   VALUE 'P'.
  1768         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1769         88  CO-TRUST                         VALUE 'T'.
  1770         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1771
  1772     12  CO-FAXNO.
  1773         16  CO-FAX-AREA-CODE                  PIC XXX.
  1774         16  CO-FAX-PREFIX                     PIC XXX.
  1775         16  CO-FAX-PHONE                      PIC X(4).
  1776
  1777     12  CO-BANK-INFORMATION.
  1778         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1779         16  CO-BANK-TRANSIT-NON REDEFINES
  1780             CO-BANK-TRANSIT-NO                PIC 9(8).
  1781
  1782         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1783     12  CO-MISC-DEDUCT-INFO REDEFINES
  1784                  CO-BANK-INFORMATION.
  1785         16  CO-MD-GL-ACCT                     PIC X(10).
  1786         16  CO-MD-DIV                         PIC XX.
  1787         16  CO-MD-CENTER                      PIC X(4).
  1788         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1789         16  CO-CREATE-AP-CHECK                PIC X.
  1790         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1791         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  34
* EL050.cbl
  1792     12  CO-ACH-STATUS                         PIC X.
  1793         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1794         88  CO-ACH-PENDING                        VALUE 'P'.
  1795
  1796     12  CO-BILL-SW                            PIC X.
  1797     12  CO-CONTROL-NAME                       PIC X(30).
  1798     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1799     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1800     12  CO-CLP-STATE                          PIC XX.
  1801     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1802     12  CO-SPP-REFUND-EDIT                    PIC X.
  1803
  1804******************************************************************
  1805
  1806*    COPY ERCAGTC.
  1807******************************************************************
  1808*                                                                *
  1809*                                                                *
  1810*                            ERCAGTC                             *
  1811*                            VMOD=2.001                          *
  1812*                                                                *
  1813*   ONLINE CREDIT SYSTEM                                         *
  1814*                                                                *
  1815*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1816*                                                                *
  1817*   FILE TYPE = VSAM,KSDS                                        *
  1818*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1819*                                                                *
  1820*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1821*       ALTERNATE PATH = NONE                                    *
  1822*                                                                *
  1823*   LOG = NO                                                     *
  1824*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1825*                                                                *
  1826******************************************************************
  1827*                   C H A N G E   L O G
  1828*
  1829* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1830*-----------------------------------------------------------------
  1831*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1832* EFFECTIVE    NUMBER
  1833*-----------------------------------------------------------------
  1834* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1835* 111004                         NEW FILE AND COPYBOOK
  1836* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1837******************************************************************
  1838 01  AGENT-COMMISSIONS.
  1839     12  AG-RECORD-ID                          PIC XX.
  1840         88  VALID-CO-ID                          VALUE 'AG'.
  1841     12  AG-CONTROL-PRIMARY.
  1842         16  AG-COMPANY-CD                     PIC X.
  1843         16  AG-CONTROL.
  1844             20  AG-CTL-1.
  1845                 24  AG-CARR-GROUP.
  1846                     28  AG-CARRIER            PIC X.
  1847                     28  AG-GROUPING           PIC X(6).
  1848                 24  AG-BANK                   PIC X(10).
  1849             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  35
* EL050.cbl
  1850                 24  AG-EXP-DT                 PIC XX.
  1851         16  AG-TYPE                           PIC X.
  1852             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1853             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1854     12  AG-MAINT-INFORMATION.
  1855         16  AG-LAST-MAINT-DT                  PIC XX.
  1856         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1857         16  AG-LAST-MAINT-USER                PIC X(4).
  1858         16  FILLER                            PIC X(10).
  1859     12  AG-EFF-DT                             PIC XX.
  1860     12  AG-COMM-STRUCTURE.
  1861         16  AG-AGT-COMMS OCCURS 10.
  1862             20  AG-AGT                PIC X(10).
  1863             20  AG-COM-TYP            PIC X.
  1864             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1865             20  AG-RECALC-LV-INDIC    PIC X.
  1866             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1867             20  AG-LRCALC-LV-INDIC    PIC X.
  1868             20  FILLER                PIC X(05).
  1869     12  FILLER                  PIC X(145).
  1870******************************************************************
  1871*    COPY ERCRESS.
  1872******************************************************************
  1873*                                                                *
  1874*                            ERCRESS                             *
  1875*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1876*                            VMOD=2.002                          *
  1877*                                                                *
  1878*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1879*                                                                *
  1880*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1881*   VSAM RESIDENT STATE TAX MASTER                              *
  1882*                                                                *
  1883*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1884*                                                                *
  1885*   FILE TYPE = VSAM,KSDS                                        *
  1886*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1887*                                                                *
  1888*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1889*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1890*                                                                *
  1891*   LOG = NO                                                     *
  1892*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1893*                                                                *
  1894*                                                                *
  1895******************************************************************
  1896
  1897 01  RESIDENT-STATE-TAX-MASTER.
  1898
  1899     10  ERRESS-PRIMARY-KEY.
  1900         15  RES-COMPANY-CD        PIC X.
  1901         15  RES-RESIDENT-STATE    PIC XX.
  1902         15  RES-COVERAGE-CATEGORY PIC X.
  1903         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1904*                                      YYYYMMDD
  1905*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1906
  1907     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  36
* EL050.cbl
  1908
  1909         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1910         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1911         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1912         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1913
  1914     10 RES-RECALC-SW              PIC   X.
  1915         88 RECALC                VALUE 'Y'.
  1916         88 NO-RECALC             VALUE 'N'.
  1917     10  RES-MAINT-BY              PIC X(4).
  1918     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1919     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1920*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  37
* EL050.cbl
  1922*    COPY ERCRESC.
  1923******************************************************************
  1924*                                                                *
  1925*                            ERCRESC                             *
  1926*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1927*                            VMOD=2.003                          *
  1928*                                                                *
  1929*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1930*                                                                *
  1931*   FILE TYPE = VSAM,KSDS                                        *
  1932*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1933*                                                                *
  1934*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1935*       ALTERNATE PATH1 = NONE                                   *
  1936*                                                                *
  1937*   LOG = NO                                                     *
  1938*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1939*                                                                *
  1940******************************************************************
  1941
  1942 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1943
  1944     10  ERRESC-RECORD-KEY.
  1945         15  RESC-COMPANY-CD           PIC   X.
  1946         15  RESC-CARRIER              PIC   X.
  1947         15  RESC-GROUP                PIC   X(6).
  1948         15  RESC-STATE                PIC   XX.
  1949         15  RESC-ACCOUNT              PIC   X(10).
  1950         15  RESC-AGENT                PIC   X(10).
  1951         15  RESC-RESIDENT-STATE       PIC   XX.
  1952         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1953*                                           YYYYMMDD
  1954     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1955
  1956     10  RESC-COMM-RECORD-DATA.
  1957         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1958             20 RESC-COVERAGE-CAT      PIC    X.
  1959             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1960             20 RESC-COMMISSION-TAB REDEFINES
  1961                RESC-COMMISSION-PER    PIC  XXX.
  1962
  1963     10  RESC-MAINT-BY                 PIC X(4).
  1964     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1965     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1966*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  38
* EL050.cbl
  1968*    COPY ERCPLAN.
  1969******************************************************************
  1970*                                                                *
  1971*                                                                *
  1972*                            ERCPLAN                             *
  1973*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1974*                            VMOD=2.003                          *
  1975*                                                                *
  1976*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1977*                                                                *
  1978*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1979*   PLAN MASTER                                                  *
  1980*                                                                *
  1981*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1982*                                                                *
  1983*   FILE TYPE = VSAM,KSDS                                        *
  1984*   RECORD SIZE = 420   RECFORM = FIX                            *
  1985*                                                                *
  1986*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1987*       ALTERNATE PATH1 = N/A                                    *
  1988*                                                                *
  1989*   LOG = NO                                                     *
  1990*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1991*                                                                *
  1992*                                                                *
  1993******************************************************************
  1994
  1995 01  PLAN-MASTER.
  1996     12  PL-RECORD-ID                      PIC XX.
  1997         88  VALID-PL-ID                      VALUE 'PL'.
  1998
  1999     12  PL-CONTROL-PRIMARY.
  2000         16  PL-COMPANY-CD                 PIC X.
  2001         16  PL-MSTR-CNTRL.
  2002             20  PL-CONTROL-A.
  2003                 24  PL-CARRIER            PIC X.
  2004                 24  PL-GROUPING           PIC X(6).
  2005                 24  PL-STATE              PIC XX.
  2006                 24  PL-ACCOUNT            PIC X(10).
  2007             20  PL-BENEFIT-TYPE           PIC X.
  2008             20  PL-BENEFIT-CODE           PIC XX.
  2009             20  PL-REVISION-NO            PIC X(3).
  2010
  2011     12  PL-CONTROL-BY-VAR-GRP.
  2012         16  PL-COMPANY-CD-A1              PIC X.
  2013         16  PL-VG-CARRIER                 PIC X.
  2014         16  PL-VG-GROUPING                PIC X(6).
  2015         16  PL-VG-STATE                   PIC XX.
  2016         16  PL-VG-ACCOUNT                 PIC X(10).
  2017         16  PL-BENEFIT-TYPE-A1            PIC X.
  2018         16  PL-BENEFIT-CODE-A1            PIC XX.
  2019         16  PL-REVISION-NO-A1             PIC 999.
  2020
  2021     12  PL-MAINT-INFORMATION.
  2022         16  PL-LAST-MAINT-DT              PIC XX.
  2023         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2024         16  PL-LAST-MAINT-USER            PIC X(4).
  2025         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  39
* EL050.cbl
  2026
  2027     12  PL-LIABILITY-LIMITS.
  2028         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2029         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2030             20  PL-LM-AGE                 PIC S99        COMP-3.
  2031             20  PL-LM-DUR                 PIC S999       COMP-3.
  2032             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2033             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2034
  2035     12  FILLER                            PIC X(30).
  2036
  2037     12  PL-GL-ACCOUNT-NOS.
  2038         16  PL-PREMIUM-GL                 PIC X(8).
  2039         16  PL-COMM-GL                    PIC X(8).
  2040         16  PL-CLAIM-GL                   PIC X(8).
  2041     12  FILLER                            PIC X(24).
  2042     12  PL-TOLERANCES.
  2043         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2044         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2045         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2046         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2047         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2048         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2049     12  PL-OVER-SHORT.
  2050         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2051         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2052     12  FILLER                            PIC X(24).
  2053     12  PLAN-MISC.
  2054         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2055         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2056         16  PL-IG                         PIC X.
  2057         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2058         16  PL-POLICY-FORM                PIC X(12).
  2059         16  PL-EDIT-FOR-FORM              PIC X(01).
  2060         16  PL-DEV-CODE                   PIC XXX.
  2061         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2062         16  PL-CALC-METHOD                PIC X.
  2063         16  PL-BENEFIT-GROUP              PIC X(05).
  2064         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2065
  2066         16  FILLER                        PIC X(99).
  2067******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  40
* EL050.cbl
  2069*    COPY ELCCERT.
  2070******************************************************************
  2071*                                                                *
  2072*                            ELCCERT.                            *
  2073*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2074*                            VMOD=2.013                          *
  2075*                                                                *
  2076*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2077*                                                                *
  2078*   FILE TYPE = VSAM,KSDS                                        *
  2079*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2080*                                                                *
  2081*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2082*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2083*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2084*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2085*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2086*                                                                *
  2087*   LOG = YES                                                    *
  2088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2089******************************************************************
  2090*                   C H A N G E   L O G
  2091*
  2092* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2093*-----------------------------------------------------------------
  2094*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2095* EFFECTIVE    NUMBER
  2096*-----------------------------------------------------------------
  2097* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2098* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2099* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2100* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2101* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2102* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2103* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2104* 032612  CR2011110200001  PEMA  AHL CHANGES
  2105******************************************************************
  2106
  2107 01  CERTIFICATE-MASTER.
  2108     12  CM-RECORD-ID                      PIC XX.
  2109         88  VALID-CM-ID                      VALUE 'CM'.
  2110
  2111     12  CM-CONTROL-PRIMARY.
  2112         16  CM-COMPANY-CD                 PIC X.
  2113         16  CM-CARRIER                    PIC X.
  2114         16  CM-GROUPING.
  2115             20  CM-GROUPING-PREFIX        PIC X(3).
  2116             20  CM-GROUPING-PRIME         PIC X(3).
  2117         16  CM-STATE                      PIC XX.
  2118         16  CM-ACCOUNT.
  2119             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2120             20  CM-ACCOUNT-PRIME          PIC X(6).
  2121         16  CM-CERT-EFF-DT                PIC XX.
  2122         16  CM-CERT-NO.
  2123             20  CM-CERT-PRIME             PIC X(10).
  2124             20  CM-CERT-SFX               PIC X.
  2125
  2126     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  41
* EL050.cbl
  2127         16  CM-COMPANY-CD-A1              PIC X.
  2128         16  CM-INSURED-LAST-NAME          PIC X(15).
  2129         16  CM-INSURED-INITIALS.
  2130             20  CM-INSURED-INITIAL1       PIC X.
  2131             20  CM-INSURED-INITIAL2       PIC X.
  2132
  2133     12  CM-CONTROL-BY-SSN.
  2134         16  CM-COMPANY-CD-A2              PIC X.
  2135         16  CM-SOC-SEC-NO.
  2136             20  CM-SSN-STATE              PIC XX.
  2137             20  CM-SSN-ACCOUNT            PIC X(6).
  2138             20  CM-SSN-LN3.
  2139                 25  CM-INSURED-INITIALS-A2.
  2140                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2141                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2142                 25 CM-PART-LAST-NAME-A2         PIC X.
  2143
  2144     12  CM-CONTROL-BY-CERT-NO.
  2145         16  CM-COMPANY-CD-A4              PIC X.
  2146         16  CM-CERT-NO-A4                 PIC X(11).
  2147
  2148     12  CM-CONTROL-BY-MEMB.
  2149         16  CM-COMPANY-CD-A5              PIC X.
  2150         16  CM-MEMBER-NO.
  2151             20  CM-MEMB-STATE             PIC XX.
  2152             20  CM-MEMB-ACCOUNT           PIC X(6).
  2153             20  CM-MEMB-LN4.
  2154                 25  CM-INSURED-INITIALS-A5.
  2155                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2156                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2157                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2158
  2159     12  CM-INSURED-PROFILE-DATA.
  2160         16  CM-INSURED-FIRST-NAME.
  2161             20  CM-INSURED-1ST-INIT       PIC X.
  2162             20  FILLER                    PIC X(9).
  2163         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2164         16  CM-INSURED-SEX                PIC X.
  2165             88  CM-SEX-MALE                  VALUE 'M'.
  2166             88  CM-SEX-FEMAL                 VALUE 'F'.
  2167         16  CM-INSURED-JOINT-AGE          PIC 99.
  2168         16  CM-JOINT-INSURED-NAME.
  2169             20  CM-JT-LAST-NAME           PIC X(15).
  2170             20  CM-JT-FIRST-NAME.
  2171                 24  CM-JT-1ST-INIT        PIC X.
  2172                 24  FILLER                PIC X(9).
  2173             20  CM-JT-INITIAL             PIC X.
  2174
  2175     12  CM-LIFE-DATA.
  2176         16  CM-LF-BENEFIT-CD              PIC XX.
  2177         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2178         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2179         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2180         16  CM-LF-DEV-CODE                PIC XXX.
  2181         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2182         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2183         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2184         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  42
* EL050.cbl
  2185         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2186         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2187         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2188         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2189         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2190         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2191         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2192         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2193         16  FILLER                        PIC XX.
  2194
  2195     12  CM-AH-DATA.
  2196         16  CM-AH-BENEFIT-CD              PIC XX.
  2197         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2198         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2199         16  CM-AH-DEV-CODE                PIC XXX.
  2200         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2201         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2202         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2203         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2204         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2205         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2206         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2207         16  CM-AH-PAID-THRU-DT            PIC XX.
  2208             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2209         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2210         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2211         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2212         16  FILLER                        PIC X.
  2213
  2214     12  CM-LOAN-INFORMATION.
  2215         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2216         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2217                                           PIC S9(5)V99  COMP-3.
  2218         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2219         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2220         16  CM-PAY-FREQUENCY              PIC S99.
  2221         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2222         16  CM-RATE-CLASS                 PIC XX.
  2223         16  CM-BENEFICIARY                PIC X(25).
  2224         16  CM-POLICY-FORM-NO             PIC X(12).
  2225         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2226         16  CM-LAST-ADD-ON-DT             PIC XX.
  2227         16  CM-DEDUCTIBLE-AMOUNTS.
  2228             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2229             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2230         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2231             20  CM-RESIDENT-STATE         PIC XX.
  2232             20  CM-RATE-CODE              PIC X(4).
  2233             20  FILLER                    PIC XX.
  2234         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2235             20  CM-LOAN-OFFICER           PIC X(5).
  2236             20  FILLER                    PIC XXX.
  2237         16  CM-CSR-CODE                   PIC XXX.
  2238         16  CM-UNDERWRITING-CODE          PIC X.
  2239             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2240         16  CM-POST-CARD-IND              PIC X.
  2241         16  CM-NH-INTERFACE-SW            PIC X.
  2242         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  43
* EL050.cbl
  2243             88  CM-SING-PRM                  VALUE '1'.
  2244             88  CM-O-B-COVERAGE              VALUE '2'.
  2245             88  CM-OPEN-END                  VALUE '3'.
  2246         16  CM-IND-GRP-TYPE               PIC X.
  2247             88  CM-INDIVIDUAL                VALUE 'I'.
  2248             88  CM-GROUP                     VALUE 'G'.
  2249         16  CM-SKIP-CODE                  PIC X.
  2250             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2251             88  SKIP-JULY                    VALUE '1'.
  2252             88  SKIP-AUGUST                  VALUE '2'.
  2253             88  SKIP-SEPTEMBER               VALUE '3'.
  2254             88  SKIP-JULY-AUG                VALUE '4'.
  2255             88  SKIP-AUG-SEPT                VALUE '5'.
  2256             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2257             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2258             88  SKIP-JUNE                    VALUE '8'.
  2259             88  SKIP-JUNE-JULY               VALUE '9'.
  2260             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2261             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2262         16  CM-PAYMENT-MODE               PIC X.
  2263             88  PAY-MONTHLY                  VALUE SPACE.
  2264             88  PAY-WEEKLY                   VALUE '1'.
  2265             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2266             88  PAY-BI-WEEKLY                VALUE '3'.
  2267             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2268         16  CM-LOAN-NUMBER                PIC X(8).
  2269         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2270         16  CM-OLD-LOF                    PIC XXX.
  2271*        16  CM-LOAN-OFFICER               PIC XXX.
  2272         16  CM-REIN-TABLE                 PIC XXX.
  2273         16  CM-SPECIAL-REIN-CODE          PIC X.
  2274         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2275         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2276         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2277
  2278     12  CM-STATUS-DATA.
  2279         16  CM-ENTRY-STATUS               PIC X.
  2280         16  CM-ENTRY-DT                   PIC XX.
  2281
  2282         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2283         16  CM-LF-CANCEL-DT               PIC XX.
  2284         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2285
  2286         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2287         16  CM-LF-DEATH-DT                PIC XX.
  2288         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2289
  2290         16  CM-LF-CURRENT-STATUS          PIC X.
  2291             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2292                                                'M' '4' '5' '9'.
  2293             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2294             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2295             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2296             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2297             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2298             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2299             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2300             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  44
* EL050.cbl
  2301             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2302             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2303             88  CM-LF-DECLINED               VALUE 'D'.
  2304             88  CM-LF-VOIDED                 VALUE 'V'.
  2305
  2306         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2307         16  CM-AH-CANCEL-DT               PIC XX.
  2308         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2309
  2310         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2311         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2312         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2313
  2314         16  CM-AH-CURRENT-STATUS          PIC X.
  2315             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2316                                                'M' '4' '5' '9'.
  2317             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2318             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2319             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2320             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2321             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2322             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2323             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2324             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2325             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2326             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2327             88  CM-AH-DECLINED               VALUE 'D'.
  2328             88  CM-AH-VOIDED                 VALUE 'V'.
  2329
  2330         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2331             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2332             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2333             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2334         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2335
  2336         16  CM-ENTRY-BATCH                PIC X(6).
  2337         16  CM-LF-EXIT-BATCH              PIC X(6).
  2338         16  CM-AH-EXIT-BATCH              PIC X(6).
  2339         16  CM-LAST-MONTH-END             PIC XX.
  2340
  2341     12  CM-NOTE-SW                        PIC X.
  2342         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2343         88  CERT-NOTES-PRESENT               VALUE '1'.
  2344         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2345         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2346         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2347         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2348         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2349         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2350     12  CM-COMP-EXCP-SW                   PIC X.
  2351         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2352         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2353     12  CM-INSURED-ADDRESS-SW             PIC X.
  2354         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2355         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2356
  2357*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2358     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  45
* EL050.cbl
  2359     12  FILLER                            PIC X.
  2360
  2361*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2362     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2363     12  FILLER                            PIC X.
  2364*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2365     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2366
  2367     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2368         88  CERT-ADDED-BATCH                 VALUE ' '.
  2369         88  CERT-ADDED-ONLINE                VALUE '1'.
  2370         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2371         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2372         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2373     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2374         88  CERT-AS-LOADED                   VALUE ' '.
  2375         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2376         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2377         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2378         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2379         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2380         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2381         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2382
  2383     12  CM-ACCOUNT-COMM-PCTS.
  2384         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2385         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2386
  2387     12  CM-USER-FIELD                     PIC X.
  2388     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2389     12  CM-CLP-STATE                      PIC XX.
  2390     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2391     12  CM-USER-RESERVED                  PIC XXX.
  2392     12  FILLER REDEFINES CM-USER-RESERVED.
  2393         16  CM-AH-CLASS-CD                PIC XX.
  2394         16  F                             PIC X.
  2395******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  46
* EL050.cbl
  2397*    COPY ERCMAIL.
  2398******************************************************************
  2399*                                                                *
  2400*                                                                *
  2401*                            ERCMAIL                             *
  2402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2403*                            VMOD=2.003                          *
  2404*                                                                *
  2405*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2406*                                                                *
  2407*   FILE TYPE = VSAM,KSDS                                        *
  2408*   RECORD SIZE = 374   RECFORM = FIX                            *
  2409*                                                                *
  2410*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2411*   ALTERNATE PATH    = NOT USED                                 *
  2412*                                                                *
  2413*   LOG = YES                                                    *
  2414*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2415******************************************************************
  2416*                   C H A N G E   L O G
  2417*
  2418* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2419*-----------------------------------------------------------------
  2420*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2421* EFFECTIVE    NUMBER
  2422*-----------------------------------------------------------------
  2423* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2424* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2425* 111108                   PEMA  ADD CRED BENE ADDR2
  2426******************************************************************
  2427
  2428 01  MAILING-DATA.
  2429     12  MA-RECORD-ID                      PIC XX.
  2430         88  VALID-MA-ID                       VALUE 'MA'.
  2431
  2432     12  MA-CONTROL-PRIMARY.
  2433         16  MA-COMPANY-CD                 PIC X.
  2434         16  MA-CARRIER                    PIC X.
  2435         16  MA-GROUPING.
  2436             20  MA-GROUPING-PREFIX        PIC XXX.
  2437             20  MA-GROUPING-PRIME         PIC XXX.
  2438         16  MA-STATE                      PIC XX.
  2439         16  MA-ACCOUNT.
  2440             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2441             20  MA-ACCOUNT-PRIME          PIC X(6).
  2442         16  MA-CERT-EFF-DT                PIC XX.
  2443         16  MA-CERT-NO.
  2444             20  MA-CERT-PRIME             PIC X(10).
  2445             20  MA-CERT-SFX               PIC X.
  2446
  2447     12  FILLER                            PIC XX.
  2448
  2449     12  MA-ACCESS-CONTROL.
  2450         16  MA-SOURCE-SYSTEM              PIC XX.
  2451             88  MA-FROM-CREDIT                VALUE 'CR'.
  2452             88  MA-FROM-VSI                   VALUE 'VS'.
  2453             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2454             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  47
* EL050.cbl
  2455         16  MA-RECORD-ADD-DT              PIC XX.
  2456         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2457         16  MA-LAST-MAINT-DT              PIC XX.
  2458         16  MA-LAST-MAINT-BY              PIC XXXX.
  2459         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2460
  2461     12  MA-PROFILE-INFO.
  2462         16  MA-QUALIFY-CODE-1             PIC XX.
  2463         16  MA-QUALIFY-CODE-2             PIC XX.
  2464         16  MA-QUALIFY-CODE-3             PIC XX.
  2465         16  MA-QUALIFY-CODE-4             PIC XX.
  2466         16  MA-QUALIFY-CODE-5             PIC XX.
  2467
  2468         16  MA-INSURED-LAST-NAME          PIC X(15).
  2469         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2470         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2471         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2472         16  MA-INSURED-BIRTH-DT           PIC XX.
  2473         16  MA-INSURED-SEX                PIC X.
  2474             88  MA-SEX-MALE                   VALUE 'M'.
  2475             88  MA-SEX-FEMALE                 VALUE 'F'.
  2476         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2477
  2478         16  MA-ADDRESS-CORRECTED          PIC X.
  2479         16  MA-JOINT-BIRTH-DT             PIC XX.
  2480*        16  FILLER                        PIC X(12).
  2481
  2482         16  MA-ADDRESS-LINE-1             PIC X(30).
  2483         16  MA-ADDRESS-LINE-2             PIC X(30).
  2484         16  MA-CITY-STATE.
  2485             20  MA-CITY                   PIC X(28).
  2486             20  MA-ADDR-STATE             PIC XX.
  2487         16  MA-ZIP.
  2488             20  MA-ZIP-CODE.
  2489                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2490                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2491                 24  FILLER                PIC X(4).
  2492             20  MA-ZIP-PLUS4              PIC X(4).
  2493         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2494             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2495             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2496             20  FILLER                    PIC X(3).
  2497
  2498         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2499
  2500         16  FILLER                        PIC XXX.
  2501*        16  FILLER                        PIC X(10).
  2502
  2503     12  MA-CRED-BENE-INFO.
  2504         16  MA-CRED-BENE-NAME                 PIC X(25).
  2505         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2506         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2507         16  MA-CRED-BENE-CTYST.
  2508             20  MA-CRED-BENE-CITY             PIC X(28).
  2509             20  MA-CRED-BENE-STATE            PIC XX.
  2510         16  MA-CRED-BENE-ZIP.
  2511             20  MA-CB-ZIP-CODE.
  2512                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  48
* EL050.cbl
  2513                     88  MA-CB-CANADIAN-POST-CODE
  2514                                           VALUE 'A' THRU 'Z'.
  2515                 24  FILLER                    PIC X(4).
  2516             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2517         16  MA-CB-CANADIAN-POSTAL-CODE
  2518                            REDEFINES MA-CRED-BENE-ZIP.
  2519             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2520             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2521             20  FILLER                        PIC X(3).
  2522     12  MA-POST-CARD-MAIL-DATA.
  2523         16  MA-MAIL-DATA OCCURS 7.
  2524             20  MA-MAIL-TYPE              PIC X.
  2525                 88  MA-12MO-MAILING           VALUE '1'.
  2526                 88  MA-EXP-MAILING            VALUE '2'.
  2527             20  MA-MAIL-STATUS            PIC X.
  2528                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2529                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2530                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2531             20  MA-MAIL-DATE              PIC XX.
  2532     12  FILLER                            PIC XX.
  2533     12  FILLER                            PIC XX.
  2534*    12  FILLER                            PIC X(30).
  2535******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  49
* EL050.cbl
  2537*    COPY ERCPNDM.
  2538******************************************************************
  2539*                                                                *
  2540*                                                                *
  2541*                            ERCPNDM                             *
  2542*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2543*                            VMOD=2.003                          *
  2544*                                                                *
  2545*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2546*                                                                *
  2547*   FILE TYPE = VSAM,KSDS                                        *
  2548*   RECORD SIZE = 374   RECFORM = FIX                            *
  2549*                                                                *
  2550*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2551*   ALTERNATE PATH    = NOT USED                                 *
  2552*                                                                *
  2553*   LOG = YES                                                    *
  2554*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2555******************************************************************
  2556*                   C H A N G E   L O G
  2557*
  2558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2559*-----------------------------------------------------------------
  2560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2561* EFFECTIVE    NUMBER
  2562*-----------------------------------------------------------------
  2563* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2564* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2565* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2566******************************************************************
  2567
  2568 01  PENDING-MAILING-DATA.
  2569     12  PM-RECORD-ID                      PIC XX.
  2570         88  VALID-MA-ID                       VALUE 'PM'.
  2571
  2572     12  PM-CONTROL-PRIMARY.
  2573         16  PM-COMPANY-CD                 PIC X.
  2574         16  PM-ENTRY-BATCH                PIC X(6).
  2575         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2576         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2577
  2578     12  FILLER                            PIC X(14).
  2579
  2580     12  PM-ACCESS-CONTROL.
  2581         16  PM-SOURCE-SYSTEM              PIC XX.
  2582             88  PM-FROM-CREDIT                VALUE 'CR'.
  2583             88  PM-FROM-VSI                   VALUE 'VS'.
  2584             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2585             88  PM-FROM-OTHER                 VALUE 'OT'.
  2586         16  PM-RECORD-ADD-DT              PIC XX.
  2587         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2588         16  PM-LAST-MAINT-DT              PIC XX.
  2589         16  PM-LAST-MAINT-BY              PIC XXXX.
  2590         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2591
  2592     12  PM-PROFILE-INFO.
  2593         16  PM-QUALIFY-CODE-1             PIC XX.
  2594         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  50
* EL050.cbl
  2595         16  PM-QUALIFY-CODE-3             PIC XX.
  2596         16  PM-QUALIFY-CODE-4             PIC XX.
  2597         16  PM-QUALIFY-CODE-5             PIC XX.
  2598
  2599         16  PM-INSURED-LAST-NAME          PIC X(15).
  2600         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2601         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2602         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2603         16  PM-INSURED-BIRTH-DT           PIC XX.
  2604         16  PM-INSURED-SEX                PIC X.
  2605             88  PM-SEX-MALE                   VALUE 'M'.
  2606             88  PM-SEX-FEMALE                 VALUE 'F'.
  2607         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2608
  2609         16  PM-ADDRESS-CORRECTED          PIC X.
  2610         16  PM-JOINT-BIRTH-DT             PIC XX.
  2611*        16  FILLER                        PIC X(12).
  2612
  2613         16  PM-ADDRESS-LINE-1             PIC X(30).
  2614         16  PM-ADDRESS-LINE-2             PIC X(30).
  2615         16  PM-CITY-STATE.
  2616             20  PM-CITY                   PIC X(28).
  2617             20  PM-STATE                  PIC XX.
  2618         16  PM-ZIP.
  2619             20  PM-ZIP-CODE.
  2620                 24  PM-ZIP-1              PIC X.
  2621                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2622                 24  FILLER                PIC X(4).
  2623             20  PM-ZIP-PLUS4              PIC X(4).
  2624         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2625             20  PM-CAN-POST1              PIC XXX.
  2626             20  PM-CAN-POST2              PIC XXX.
  2627             20  FILLER                    PIC XXX.
  2628
  2629         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2630
  2631         16  FILLER                        PIC X(03).
  2632
  2633     12  PM-CRED-BENE-INFO.
  2634         16  PM-CRED-BENE-NAME             PIC X(25).
  2635         16  PM-CRED-BENE-ADDR             PIC X(30).
  2636         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2637         16  PM-CRED-BENE-CTYST.
  2638             20  PM-CRED-BENE-CITY         PIC X(28).
  2639             20  PM-CRED-BENE-STATE        PIC XX.
  2640         16  PM-CRED-BENE-ZIP.
  2641             20  PM-CB-ZIP-CODE.
  2642                 24  PM-CB-ZIP-1           PIC X.
  2643                     88  PM-CB-CANADIAN-POST-CODE
  2644                                  VALUE 'A' THRU 'Z'.
  2645                 24  FILLER                PIC X(4).
  2646             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2647         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2648             20  PM-CB-CAN-POST1           PIC XXX.
  2649             20  PM-CB-CAN-POST2           PIC XXX.
  2650             20  FILLER                    PIC XXX.
  2651     12  PM-POST-CARD-MAIL-DATA.
  2652         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  51
* EL050.cbl
  2653             20  PM-MAIL-TYPE              PIC X.
  2654                 88  PM-12MO-MAILING           VALUE '1'.
  2655                 88  PM-EXP-MAILING            VALUE '2'.
  2656             20  PM-MAIL-STATUS            PIC X.
  2657                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2658                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2659                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2660             20  PM-MAIL-DATE              PIC XX.
  2661     12  FILLER                            PIC XX.
  2662     12  FILLER                            PIC X(12).
  2663*    12  FILLER                            PIC X(30).
  2664
  2665******************************************************************
  2666*                                COPY ERCLOFC.
  2667******************************************************************
  2668*                                                                *
  2669*                                                                *
  2670*                            ERCLOFC                             *
  2671*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2672*                            VMOD=2.003                          *
  2673*                                                                *
  2674*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2675*                                                                *
  2676*   FILE TYPE = VSAM,KSDS                                        *
  2677*   RECORD SIZE = 670   RECFORM = FIX                            *
  2678*                                                                *
  2679*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2680*                                                                *
  2681*   LOG = YES                                                    *
  2682*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2683*                                                                *
  2684******************************************************************
  2685
  2686 01  LOAN-OFFICER-MASTER.
  2687     12  LO-RECORD-ID                PIC XX.
  2688         88  VALID-LO-ID                VALUE 'LO'.
  2689
  2690     12  LO-CONTROL-PRIMARY.
  2691         16  LO-COMPANY-CD           PIC X.
  2692         16  LO-CARRIER              PIC X.
  2693         16  LO-GROUPING.
  2694             20  LO-GROUPING-PREFIX  PIC XXX.
  2695             20  LO-GROUPING-PRIME   PIC XXX.
  2696         16  LO-STATE                PIC XX.
  2697         16  LO-ACCOUNT.
  2698             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2699             20  LO-ACCOUNT-PRIME    PIC X(6).
  2700         16  LO-OFFICER-CODE         PIC X(5).
  2701
  2702     12  LO-OFFICER-NAME             PIC X(30).
  2703
  2704     12  LO-LAST-MAINT-DT            PIC XX.
  2705     12  LO-LAST-USER                PIC X(4).
  2706     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2707
  2708     12  LO-COMP-CONTROL             PIC X.
  2709             88  LO-SHOW-COMP           VALUE 'Y'.
  2710             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  52
* EL050.cbl
  2711     12  LO-DETAIL-CONTROL           PIC X.
  2712             88  LO-PRINT-DETAIL        VALUE 'D'.
  2713             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2714
  2715     12  LO-SV-CARRIER               PIC X.
  2716     12  LO-SV-GROUPING              PIC X(6).
  2717     12  LO-SV-STATE                 PIC XX.
  2718
  2719     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2720     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2721
  2722     12  LO-OFFICER-INFO.
  2723         16  FILLER OCCURS 12 TIMES.
  2724             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2725             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2726             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2727             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2728             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2729             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2730             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2731             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2732     12  FILLER                      PIC X(198).
  2733******************************************************************
  2734*                                COPY ERCPDEF.
  2735******************************************************************
  2736*                                                                *
  2737*                                                                *
  2738*                            ERCPDEF.                            *
  2739*                                                                *
  2740*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2741*                                                                *
  2742*    FILE TYPE = VSAM,KSDS                                       *
  2743*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2744*                                                                *
  2745*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2746*                                                                *
  2747*    LOG = YES                                                   *
  2748*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2749******************************************************************
  2750*                   C H A N G E   L O G
  2751*
  2752* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2753*-----------------------------------------------------------------
  2754*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2755* EFFECTIVE    NUMBER
  2756*-----------------------------------------------------------------
  2757* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2758******************************************************************
  2759 01  PRODUCT-MASTER.
  2760    12  PD-RECORD-ID                 PIC X(02).
  2761        88  VALID-PD-ID                  VALUE 'PD'.
  2762    12  PD-CONTROL-PRIMARY.
  2763        16  PD-COMPANY-CD            PIC X.
  2764        16  PD-STATE                 PIC XX.
  2765        16  PD-PRODUCT-CD            PIC XXX.
  2766        16  PD-FILLER                PIC X(7).
  2767        16  PD-BEN-TYPE              PIC X.
  2768        16  PD-BEN-CODE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  53
* EL050.cbl
  2769        16  PD-PROD-EXP-DT           PIC XX.
  2770    12  FILLER                       PIC X(50).
  2771    12  PD-PRODUCT-DATA OCCURS 8.
  2772        16  PD-PROD-CODE             PIC X.
  2773            88  PD-PROD-LIFE           VALUE 'L'.
  2774            88  PD-PROD-PROP           VALUE 'P'.
  2775            88  PD-PROD-AH             VALUE 'A'.
  2776            88  PD-PROD-IU             VALUE 'I'.
  2777            88  PD-PROD-GAP            VALUE 'G'.
  2778            88  PD-PROD-FMLA           VALUE 'F'.
  2779        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2780        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2781        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2782        16  PD-MAX-TERM              PIC S999        COMP-3.
  2783        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2784        16  FILLER                   PIC X.
  2785        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2786        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2787        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2788        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2789        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2790        16  PD-REC-CRIT-PERIOD       PIC 99.
  2791        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2792            20  PD-RECURRING-YN      PIC X.
  2793            20  FILLER               PIC X.
  2794        16  PD-RTW-MOS               PIC 99.
  2795        16  PD-MAX-EXTENSION         PIC 99.
  2796        16  FILLER                   PIC XX.
  2797    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2798    12  PD-TERM-LIMITS OCCURS 15.
  2799        16  PD-LOW-TERM              PIC S999        COMP-3.
  2800        16  PD-HI-TERM               PIC S999        COMP-3.
  2801*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2802    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2803        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2804        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2805    12  PD-EARN-FACTORS.
  2806        16  FILLER OCCURS 15.
  2807            20  FILLER OCCURS 15.
  2808                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2809    12  PD-PRODUCT-DESC              PIC X(80).
  2810    12  PD-TRUNCATED                 PIC X.
  2811    12  FILLER                       PIC X(59).
  2812    12  PD-MAINT-INFORMATION.
  2813        16  PD-LAST-MAINT-DT         PIC X(02).
  2814        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2815        16  PD-LAST-MAINT-BY         PIC X(04).
  2816*                                COPY ELCSTATE.
  2817******************************************************************
  2818*                                                                *
  2819*                                                                *
  2820*                            ELCSTATE.                           *
  2821*                                                                *
  2822*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2823*                                                                *
  2824*   FILE TYPE = VSAM,KSDS                                        *
  2825*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2826*                                                                *
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  54
* EL050.cbl
  2827*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2828*       ALTERNATE INDEX = NONE                                   *
  2829*                                                                *
  2830*   LOG = YES                                                    *
  2831*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2832******************************************************************
  2833*                   C H A N G E   L O G
  2834*
  2835* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2836*-----------------------------------------------------------------
  2837*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2838* EFFECTIVE    NUMBER
  2839*-----------------------------------------------------------------
  2840* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2841******************************************************************
  2842*
  2843 01  STATE-FILE.
  2844     12  SF-RECORD-ID                       PIC XX.
  2845         88  VALID-CF-ID                        VALUE 'SF'.
  2846     12  SF-CONTROL-PRIMARY.
  2847         16  SF-COMPANY-ID                  PIC XXX.
  2848         16  SF-CARRIER-CODE                PIC X.
  2849         16  SF-GROUPING                    PIC X(6).
  2850         16  SF-STATE-CODE                  PIC XX.
  2851         16  SF-EXPIRE-DATE                 PIC 9(8).
  2852****************************************************************
  2853*             STATE CONTROLS
  2854****************************************************************
  2855     12  SF-LAST-MAINT-DT                   PIC XX.
  2856     12  SF-LAST-MAINT-BY                   PIC X(4).
  2857     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2858     12  SF-STATE-RT-CONTROLS.
  2859         16  SF-ST-RT-CALC                  PIC X.
  2860     12  SF-ST-TAX-CONTROLS.
  2861         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2862         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2863         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2864     12  SF-ST-REFUND-OPTIONS.
  2865         16  SF-ST-RF-LR-CALC               PIC X.
  2866         16  SF-ST-RF-LL-CALC               PIC X.
  2867         16  SF-ST-RF-LN-CALC               PIC X.
  2868         16  SF-ST-RF-AH-CALC               PIC X.
  2869         16  SF-ST-RF-CP-CALC               PIC X.
  2870     12  SF-ST-UNEARN-PREM-OPTIONS.
  2871         16  SF-ST-LUEP-R78                 PIC X.
  2872         16  SF-ST-LUEP-PRO                 PIC X.
  2873         16  SF-ST-LUEP-ST                  PIC X.
  2874         16  SF-ST-LUEP-DOM                 PIC X.
  2875         16  SF-ST-AUEP-R78                 PIC X.
  2876         16  SF-ST-AUEP-PRO                 PIC X.
  2877         16  SF-ST-AUEP-ST                  PIC X.
  2878         16  SF-ST-AUEP-DOM                 PIC X.
  2879         16  SF-ST-CUEP-R78                 PIC X.
  2880         16  SF-ST-CUEP-PRO                 PIC X.
  2881         16  SF-ST-CUEP-ST                  PIC X.
  2882         16  SF-ST-CUEP-DOM                 PIC X.
  2883     12  SF-ST-EARN-PREM-OPTIONS.
  2884         16  SF-ST-LEP-R78                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  55
* EL050.cbl
  2885         16  SF-ST-LEP-PRO                  PIC X.
  2886         16  SF-ST-LEP-ST                   PIC X.
  2887         16  SF-ST-LEP-DOM                  PIC X.
  2888         16  SF-ST-AEP-R78                  PIC X.
  2889         16  SF-ST-AEP-PRO                  PIC X.
  2890         16  SF-ST-AEP-ST                   PIC X.
  2891         16  SF-ST-AEP-DOM                  PIC X.
  2892         16  SF-ST-CEP-R78                  PIC X.
  2893         16  SF-ST-CEP-PRO                  PIC X.
  2894         16  SF-ST-CEP-ST                   PIC X.
  2895         16  SF-ST-CEP-DOM                  PIC X.
  2896     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  56
* EL050.cbl
  2898*    COPY ELCCRTT.
  2899******************************************************************
  2900*                                                                *
  2901*                            ELCCRTT.                            *
  2902*                                                                *
  2903*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2904*                                                                *
  2905*   FILE TYPE = VSAM,KSDS                                        *
  2906*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2907*                                                                *
  2908*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2909*                                                                *
  2910*   LOG = YES                                                    *
  2911*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2912******************************************************************
  2913*                   C H A N G E   L O G
  2914*
  2915* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2916*-----------------------------------------------------------------
  2917*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2918* EFFECTIVE    NUMBER
  2919*-----------------------------------------------------------------
  2920* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2921* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2922* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2923* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2924* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2925* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2926******************************************************************
  2927
  2928 01  CERTIFICATE-TRAILERS.
  2929     12  CS-RECORD-ID                      PIC XX.
  2930         88  VALID-CS-ID                      VALUE 'CS'.
  2931
  2932     12  CS-CONTROL-PRIMARY.
  2933         16  CS-COMPANY-CD                 PIC X.
  2934         16  CS-CARRIER                    PIC X.
  2935         16  CS-GROUPING                   PIC X(6).
  2936         16  CS-STATE                      PIC XX.
  2937         16  CS-ACCOUNT                    PIC X(10).
  2938         16  CS-CERT-EFF-DT                PIC XX.
  2939         16  CS-CERT-NO.
  2940             20  CS-CERT-PRIME             PIC X(10).
  2941             20  CS-CERT-SFX               PIC X.
  2942         16  CS-TRAILER-TYPE               PIC X.
  2943             88  COMM-TRLR           VALUE 'A'.
  2944             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2945             88  CERT-DATA-TRLR      VALUE 'C'.
  2946
  2947     12  CS-DATA-AREA                      PIC X(516).
  2948
  2949     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2950         16  CS-BANK-COMMISSION-AREA.
  2951             20  CS-BANK-COMMS       OCCURS 10.
  2952                 24  CS-AGT                PIC X(10).
  2953                 24  CS-COM-TYP            PIC X.
  2954                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2955                 24  CS-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  57
* EL050.cbl
  2956                 24  FILLER                PIC X(10).
  2957         16  FILLER                        PIC X(256).
  2958
  2959     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2960****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2961         16  CS-MB-CLAIM-DATA OCCURS 24.
  2962             20  CS-CLAIM-NO               PIC X(7).
  2963             20  CS-CLAIM-TYPE             PIC X.
  2964                 88  CS-AH-CLM               VALUE 'A'.
  2965                 88  CS-IU-CLM               VALUE 'I'.
  2966                 88  CS-GP-CLM               VALUE 'G'.
  2967                 88  CS-LF-CLM               VALUE 'L'.
  2968                 88  CS-PR-CLM               VALUE 'P'.
  2969             20  CS-INSURED-TYPE           PIC X.
  2970                 88  CS-PRIM-INSURED          VALUE 'P'.
  2971                 88  CS-CO-BORROWER           VALUE 'C'.
  2972             20  CS-BENEFIT-PERIOD         PIC 99.
  2973             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2974             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2975             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2976         16  FILLER                        PIC X(12).
  2977     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2978         16  CS-VIN-NUMBER                 PIC X(17).
  2979         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2980         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2981         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2982         16  FILLER                        PIC X(496).
  2983*    COPY ELCCRTO.
  2984******************************************************************
  2985*                                                                *
  2986*                            ELCCRTO.                            *
  2987*                                                                *
  2988*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2989*                                                                *
  2990*   FILE TYPE = VSAM,KSDS                                        *
  2991*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2992*                                                                *
  2993*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2994*                                                                *
  2995*   LOG = YES                                                    *
  2996*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2997******************************************************************
  2998*                   C H A N G E   L O G
  2999*
  3000* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3001*-----------------------------------------------------------------
  3002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3003* EFFECTIVE    NUMBER
  3004*-----------------------------------------------------------------
  3005* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3006* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3007* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3008* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3009* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3010******************************************************************
  3011 01  ORIGINAL-CERTIFICATE.
  3012     12  OC-RECORD-ID                      PIC XX.
  3013         88  VALID-OC-ID                      VALUE 'OC'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  58
* EL050.cbl
  3014     12  OC-CONTROL-PRIMARY.
  3015         16  OC-COMPANY-CD                 PIC X.
  3016         16  OC-CARRIER                    PIC X.
  3017         16  OC-GROUPING                   PIC X(6).
  3018         16  OC-STATE                      PIC XX.
  3019         16  OC-ACCOUNT                    PIC X(10).
  3020         16  OC-CERT-EFF-DT                PIC XX.
  3021         16  OC-CERT-NO.
  3022             20  OC-CERT-PRIME             PIC X(10).
  3023             20  OC-CERT-SFX               PIC X.
  3024         16  OC-RECORD-TYPE                PIC X.
  3025         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3026     12  OC-LAST-MAINT-DT                  PIC XX.
  3027     12  OC-LAST-MAINT-BY                  PIC X(4).
  3028     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3029     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3030     12  FILLER                            PIC X(49).
  3031     12  OC-ORIG-REC.
  3032         16  OC-INS-LAST-NAME              PIC X(15).
  3033         16  OC-INS-FIRST-NAME             PIC X(10).
  3034         16  OC-INS-MIDDLE-INIT            PIC X.
  3035         16  OC-INS-AGE                    PIC S999     COMP-3.
  3036         16  OC-JNT-LAST-NAME              PIC X(15).
  3037         16  OC-JNT-FIRST-NAME             PIC X(10).
  3038         16  OC-JNT-MIDDLE-INIT            PIC X.
  3039         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3040         16  OC-LF-BENCD                   PIC XX.
  3041         16  OC-LF-TERM                    PIC S999      COMP-3.
  3042         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3043         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3044         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3045         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3046         16  OC-LF-EXP-DT                  PIC XX.
  3047         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3048         16  OC-LF-CANCEL-DT               PIC XX.
  3049         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3050         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3051         16  OC-AH-BENCD                   PIC XX.
  3052         16  OC-AH-TERM                    PIC S999      COMP-3.
  3053         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3054         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3055         16  OC-AH-EXP-DT                  PIC XX.
  3056         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3057         16  OC-AH-CP                      PIC 99.
  3058         16  OC-AH-CANCEL-DT               PIC XX.
  3059         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3060         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3061         16  OC-CRED-BENE-NAME             PIC X(25).
  3062         16  OC-1ST-PMT-DT                 PIC XX.
  3063         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3064         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3065         16  OC-ISSUE-TRAN-IND             PIC X.
  3066         16  OC-CANCEL-TRAN-IND            PIC X.
  3067         16  FILLER                        PIC X(211).
  3068
  3069     12  FILLER                            PIC X(50).
  3070******************************************************************
  3071
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  59
* EL050.cbl
  3072*    COPY ELCDATE.
  3073******************************************************************
  3074*                                                                *
  3075*                                                                *
  3076*                            ELCDATE.                            *
  3077*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3078*                            VMOD=2.003
  3079*                                                                *
  3080*                                                                *
  3081*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3082*                 LENGTH = 200                                   *
  3083******************************************************************
  3084
  3085 01  DATE-CONVERSION-DATA.
  3086     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3087     12  DC-OPTION-CODE                PIC X.
  3088         88  BIN-TO-GREG                VALUE ' '.
  3089         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3090         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3091         88  YMD-GREG-TO-BIN            VALUE '3'.
  3092         88  MDY-GREG-TO-BIN            VALUE '4'.
  3093         88  JULIAN-TO-BIN              VALUE '5'.
  3094         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3095         88  FIND-CENTURY               VALUE '7'.
  3096         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3097         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3098         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3099         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3100         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3101         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3102         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3103         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3104         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3105         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3106         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3107         88  BIN-3-TO-GREG              VALUE 'I'.
  3108         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3109         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3110         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3111         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3112         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3113         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3114         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3115         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3116         88  THREE-CHARACTER-BIN
  3117                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3118         88  GREGORIAN-TO-BIN
  3119                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3120         88  BIN-TO-GREGORIAN
  3121                  VALUES ' ' '1' 'I' '8' 'G'.
  3122         88  JULIAN-TO-BINARY
  3123                  VALUES '5' 'C' 'E' 'F'.
  3124     12  DC-ERROR-CODE                 PIC X.
  3125         88  NO-CONVERSION-ERROR        VALUE ' '.
  3126         88  DATE-CONVERSION-ERROR
  3127                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3128         88  DATE-IS-ZERO               VALUE '1'.
  3129         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  60
* EL050.cbl
  3130         88  DATE-IS-INVALID            VALUE '3'.
  3131         88  DATE1-GREATER-DATE2        VALUE '4'.
  3132         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3133         88  DATE-INVALID-OPTION        VALUE '9'.
  3134         88  INVALID-CENTURY            VALUE 'A'.
  3135         88  ONLY-CENTURY               VALUE 'B'.
  3136         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3137         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3138     12  DC-END-OF-MONTH               PIC X.
  3139         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3140     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3141         88  USE-NORMAL-PROCESS         VALUE ' '.
  3142         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3143         88  ADJUST-UP-100-YRS          VALUE '2'.
  3144     12  FILLER                        PIC X.
  3145     12  DC-CONVERSION-DATES.
  3146         16  DC-BIN-DATE-1             PIC XX.
  3147         16  DC-BIN-DATE-2             PIC XX.
  3148         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3149         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3150                       DC-GREG-DATE-1-EDIT.
  3151             20  DC-EDIT1-MONTH        PIC 99.
  3152             20  SLASH1-1              PIC X.
  3153             20  DC-EDIT1-DAY          PIC 99.
  3154             20  SLASH1-2              PIC X.
  3155             20  DC-EDIT1-YEAR         PIC 99.
  3156         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3157         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3158                     DC-GREG-DATE-2-EDIT.
  3159             20  DC-EDIT2-MONTH        PIC 99.
  3160             20  SLASH2-1              PIC X.
  3161             20  DC-EDIT2-DAY          PIC 99.
  3162             20  SLASH2-2              PIC X.
  3163             20  DC-EDIT2-YEAR         PIC 99.
  3164         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3165         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3166                     DC-GREG-DATE-1-YMD.
  3167             20  DC-YMD-YEAR           PIC 99.
  3168             20  DC-YMD-MONTH          PIC 99.
  3169             20  DC-YMD-DAY            PIC 99.
  3170         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3171         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3172                      DC-GREG-DATE-1-MDY.
  3173             20  DC-MDY-MONTH          PIC 99.
  3174             20  DC-MDY-DAY            PIC 99.
  3175             20  DC-MDY-YEAR           PIC 99.
  3176         16  DC-GREG-DATE-1-ALPHA.
  3177             20  DC-ALPHA-MONTH        PIC X(10).
  3178             20  DC-ALPHA-DAY          PIC 99.
  3179             20  FILLER                PIC XX.
  3180             20  DC-ALPHA-CENTURY.
  3181                 24 DC-ALPHA-CEN-N     PIC 99.
  3182             20  DC-ALPHA-YEAR         PIC 99.
  3183         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3184         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3185         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3186         16  DC-JULIAN-DATE            PIC 9(05).
  3187         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  61
* EL050.cbl
  3188                                       PIC 9(05).
  3189         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3190             20  DC-JULIAN-YEAR        PIC 99.
  3191             20  DC-JULIAN-DAYS        PIC 999.
  3192         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3193         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3194         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3195     12  DATE-CONVERSION-VARIBLES.
  3196         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3197         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3198             20  FILLER                PIC 9(3).
  3199             20  HOLD-CEN-1-CCYY.
  3200                 24  HOLD-CEN-1-CC     PIC 99.
  3201                 24  HOLD-CEN-1-YY     PIC 99.
  3202             20  HOLD-CEN-1-MO         PIC 99.
  3203             20  HOLD-CEN-1-DA         PIC 99.
  3204         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3205             20  HOLD-CEN-1-R-MO       PIC 99.
  3206             20  HOLD-CEN-1-R-DA       PIC 99.
  3207             20  HOLD-CEN-1-R-CCYY.
  3208                 24  HOLD-CEN-1-R-CC   PIC 99.
  3209                 24  HOLD-CEN-1-R-YY   PIC 99.
  3210             20  FILLER                PIC 9(3).
  3211         16  HOLD-CENTURY-1-X.
  3212             20  FILLER                PIC X(3)  VALUE SPACES.
  3213             20  HOLD-CEN-1-X-CCYY.
  3214                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3215                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3216             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3217             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3218         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3219             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3220             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3221             20  HOLD-CEN-1-R-X-CCYY.
  3222                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3223                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3224             20  FILLER                PIC XXX.
  3225         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3226         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3227         16  DC-JULIAN-DATE-1          PIC 9(07).
  3228         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3229             20  DC-JULIAN-1-CCYY.
  3230                 24  DC-JULIAN-1-CC    PIC 99.
  3231                 24  DC-JULIAN-1-YR    PIC 99.
  3232             20  DC-JULIAN-DA-1        PIC 999.
  3233         16  DC-JULIAN-DATE-2          PIC 9(07).
  3234         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3235             20  DC-JULIAN-2-CCYY.
  3236                 24  DC-JULIAN-2-CC    PIC 99.
  3237                 24  DC-JULIAN-2-YR    PIC 99.
  3238             20  DC-JULIAN-DA-2        PIC 999.
  3239         16  DC-GREG-DATE-A-EDIT.
  3240             20  DC-EDITA-MONTH        PIC 99.
  3241             20  SLASHA-1              PIC X VALUE '/'.
  3242             20  DC-EDITA-DAY          PIC 99.
  3243             20  SLASHA-2              PIC X VALUE '/'.
  3244             20  DC-EDITA-CCYY.
  3245                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  62
* EL050.cbl
  3246                 24  DC-EDITA-YEAR     PIC 99.
  3247         16  DC-GREG-DATE-B-EDIT.
  3248             20  DC-EDITB-MONTH        PIC 99.
  3249             20  SLASHB-1              PIC X VALUE '/'.
  3250             20  DC-EDITB-DAY          PIC 99.
  3251             20  SLASHB-2              PIC X VALUE '/'.
  3252             20  DC-EDITB-CCYY.
  3253                 24  DC-EDITB-CENT     PIC 99.
  3254                 24  DC-EDITB-YEAR     PIC 99.
  3255         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3256         16  DC-GREG-DATE-CYMD-R REDEFINES
  3257                              DC-GREG-DATE-CYMD.
  3258             20  DC-CYMD-CEN           PIC 99.
  3259             20  DC-CYMD-YEAR          PIC 99.
  3260             20  DC-CYMD-MONTH         PIC 99.
  3261             20  DC-CYMD-DAY           PIC 99.
  3262         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3263         16  DC-GREG-DATE-MDCY-R REDEFINES
  3264                              DC-GREG-DATE-MDCY.
  3265             20  DC-MDCY-MONTH         PIC 99.
  3266             20  DC-MDCY-DAY           PIC 99.
  3267             20  DC-MDCY-CEN           PIC 99.
  3268             20  DC-MDCY-YEAR          PIC 99.
  3269    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3270        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3271    12  DC-EL310-DATE                  PIC X(21).
  3272    12  FILLER                         PIC X(28).
  3273
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  63
* EL050.cbl
  3275*    COPY ELCCALC.
  3276******************************************************************
  3277*                                                                *
  3278*                           ELCCALC.                            *
  3279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3280*                            VMOD=2.025                          *
  3281*                                                                *
  3282*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3283*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3284*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3285*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3286*                                                                *
  3287*  PASSED TO ELRTRM                                              *
  3288*  -----------------                                             *
  3289*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3290*  ORIGINAL TERM                                                 *
  3291*  BEGINNING DATE                                                *
  3292*  ENDING DATE                                                   *
  3293*  COMPANY I.D.                                                  *
  3294*  ACCOUNT MASTER USER FIELD                                     *
  3295*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3296*  FREE LOOK DAYS                                                *
  3297*                                                                *
  3298*  RETURNED FROM ELRTRM                                          *
  3299*  ---------------------                                         *
  3300*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3301*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3302*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3303*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3304*----------------------------------------------------------------*
  3305*  PASSED TO ELRAMT                                              *
  3306*  ----------------                                              *
  3307*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3308*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3309*  ORIGINAL AMOUNT                                               *
  3310*  ALTERNATE BENEFIT (BALLON)                                    *
  3311*  A.P.R. - NET PAY ONLY                                         *
  3312*  METHOD
  3313*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3314*  COMPANY I.D.                                                  *
  3315*  BENEFIT TYPE                                                  *
  3316*                                                                *
  3317*  RETURNED FROM ELRAMT                                          *
  3318*  --------------------                                          *
  3319*  REMAINING AMOUNT 1 - CURRENT                                  *
  3320*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3321*  REMAINING AMOUNT FACTOR
  3322*----------------------------------------------------------------*
  3323*  PASSED TO ELRESV                                              *
  3324*  -----------------                                             *
  3325*  CERTIFICATE EFFECTIVE DATE                                    *
  3326*  VALUATION DATE                                                *
  3327*  PAID THRU DATE                                                *
  3328*  BENEFIT                                                       *
  3329*  INCURRED DATE                                                 *
  3330*  REPORTED DATE                                                 *
  3331*  ISSUE AGE                                                     *
  3332*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  64
* EL050.cbl
  3333*  CDT PERCENT                                                   *
  3334*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3335* *CLAIM TYPE (LIFE, A/H)                                        *
  3336* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3337* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3338*                                                                *
  3339*  RETURNED FROM ELRESV                                          *
  3340*  --------------------                                          *
  3341*  CDT TABLE USED                                                *
  3342*  CDT FACTOR USED                                               *
  3343*  PAY TO CURRENT RESERVE                                        *
  3344*  I.B.N.R. - A/H ONLY                                           *
  3345*  FUTURE (ACCRUED) AH ONLY                                      *
  3346*----------------------------------------------------------------*
  3347*  PASSED TO ELRATE                                              *
  3348*  ----------------                                              *
  3349*  CERT ISSUE DATE                                               *
  3350*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3351*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3352*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3353*  STATE CODE (CLIENT DEFINED)                                   *
  3354*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3355*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3356*  DEVIATION CODE                                                *
  3357*  ISSUE AGE                                                     *
  3358*  ORIGINAL BENEFIT AMOUNT                                       *
  3359*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3360*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3361*  BENEFIT KIND (LIFE OR A/H)                                    *
  3362*  A.P.R.                                                        *
  3363*  METHOD
  3364*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3365*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3366*  COMPANY I.D. (3 CHARACTER)                                    *
  3367*  BENEFIT CODE                                                  *
  3368*  BENEFIT OVERRIDE CODE                                         *
  3369*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3370*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3371*  JOINT INDICATOR (CSL ONLY)                                    *
  3372*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3373*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3374*                                                                *
  3375*  RETURNED FROM ELRATE                                          *
  3376*  --------------------                                          *
  3377*  CALCULATED PREMIUM                                            *
  3378*  PREMIUM RATE                                                  *
  3379*  MORTALITY CODE                                                *
  3380*  MAX ATTAINED AGE                                              *
  3381*  MAX AGE                                                       *
  3382*  MAX TERM                                                      *
  3383*  MAX MONTHLY BENEFIT                                           *
  3384*  MAX TOTAL BENIFIT                                             *
  3385*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3386*----------------------------------------------------------------*
  3387*  PASSED TO ELRFND                                              *
  3388*  ----------------                                              *
  3389*  CERT ISSUE DATE                                               *
  3390*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  65
* EL050.cbl
  3391*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3392*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3393*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3394*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3395*  STATE CODE (CLIENT DEFINED)                                   *
  3396*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3397*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3398*  DEVIATION CODE                                                *
  3399*  ISSUE AGE                                                     *
  3400*  ORIGINAL BENEFIT AMOUNT                                       *
  3401*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3402*  PROCESS TYPE (CANCEL)                                         *
  3403*  BENEFIT KIND (LIFE OR A/H)                                    *
  3404*  A.P.R.                                                        *
  3405*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3406*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3407*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3408*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3409*  COMPANY I.D. (3 CHARACTER)                                    *
  3410*  BENEFIT CODE                                                  *
  3411*  BENEFIT OVERRIDE CODE                                         *
  3412*                                                                *
  3413*  RETURNED FROM ELRFND                                          *
  3414*  --------------------                                          *
  3415*  CALCULATED REFUND                                             *
  3416*----------------------------------------------------------------*
  3417*  PASSED TO ELEARN                                              *
  3418*  ----------------                                              *
  3419*  CERT ISSUE DATE                                               *
  3420*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3421*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3422*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3423*  STATE CODE (CLIENT DEFINED)                                   *
  3424*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3425*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3426*  DEVIATION CODE                                                *
  3427*  ISSUE AGE                                                     *
  3428*  ORIGINAL BENEFIT AMOUNT                                       *
  3429*  BENEFIT KIND (LIFE OR A/H)                                    *
  3430*  A.P.R.                                                        *
  3431*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3432*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3433*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3434*  COMPANY I.D. (3 CHARACTER)                                    *
  3435*  BENEFIT CODE                                                  *
  3436*  BENEFIT OVERRIDE CODE                                         *
  3437*                                                                *
  3438*  RETURNED FROM ELEARN                                          *
  3439*  --------------------                                          *
  3440*  INDICATED  EARNINGS                                           *
  3441*----------------------------------------------------------------*
  3442*                 LENGTH = 450                                   *
  3443*                                                                *
  3444******************************************************************
  3445******************************************************************
  3446*                   C H A N G E   L O G
  3447*
  3448* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  66
* EL050.cbl
  3449*-----------------------------------------------------------------
  3450*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3451* EFFECTIVE    NUMBER
  3452*-----------------------------------------------------------------
  3453* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3454* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3455* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3456* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3457* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3458* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3459* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3460* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3461* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3462******************************************************************
  3463
  3464 01  CALCULATION-PASS-AREA.
  3465     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3466                                     COMP.
  3467
  3468     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3469       88  NO-CP-ERROR                             VALUE ZERO.
  3470       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3471                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3472       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3473       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3474       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3475       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3476       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3477       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3478       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3479       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3480       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3481       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3482       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3483       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3484       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3485       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3486       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3487       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3488       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3489
  3490     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3491       88  NO-CP-ERROR-2                           VALUE ZERO.
  3492***********************  INPUT AREAS ****************************
  3493
  3494     12  CP-CALCULATION-AREA.
  3495         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3496         16  CP-CERT-EFF-DT        PIC XX.
  3497         16  CP-VALUATION-DT       PIC XX.
  3498         16  CP-PAID-THRU-DT       PIC XX.
  3499         16  CP-BENEFIT-TYPE       PIC X.
  3500           88  CP-AH                               VALUE 'A' 'D'
  3501                                                   'I' 'U'.
  3502           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3503           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3504         16  CP-INCURRED-DT        PIC XX.
  3505         16  CP-REPORTED-DT        PIC XX.
  3506         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  67
* EL050.cbl
  3507         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3508         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3509                                     COMP-3.
  3510         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3511                                     COMP-3.
  3512         16  CP-CDT-METHOD         PIC X.
  3513           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3514           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3515           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3516         16  CP-CLAIM-TYPE         PIC X.
  3517           88  CP-AH-CLAIM                         VALUE 'A'.
  3518           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3519         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3520                                     COMP-3.
  3521         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3522                                     COMP-3.
  3523         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3524                                     COMP-3.
  3525         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3526                                     COMP-3.
  3527         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3530                                     COMP-3.
  3531         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3532                                     COMP-3.
  3533         16  CP-REM-TERM-METHOD    PIC X.
  3534           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3535           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3536           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3537           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3538           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3539           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3540           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3541         16  CP-EARNING-METHOD     PIC X.
  3542           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3543           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3544           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3545           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3546           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3547           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3548           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3549           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3550           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3551           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3552           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3553           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3554           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3555           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3556         16  CP-PROCESS-TYPE       PIC X.
  3557           88  CP-CLAIM                            VALUE '1'.
  3558           88  CP-CANCEL                           VALUE '2'.
  3559           88  CP-ISSUE                            VALUE '3'.
  3560         16  CP-SPECIAL-CALC-CD    PIC X.
  3561           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3562           88  CP-1-MTH-INTEREST               VALUE ' '.
  3563           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3564           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  68
* EL050.cbl
  3565           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3566           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3567           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3568           88  CP-FARM-PLAN                    VALUE 'F'.
  3569           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3570           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3571           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3572           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3573           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3574           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3575           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3576           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3577           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3578           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3579                                                     'W' 'X'.
  3580           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3581           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3582           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3583           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3584           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3585           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3586           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3587           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3588           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3589           88  CP-CSL-METH-1                   VALUE '5'.
  3590           88  CP-CSL-METH-2                   VALUE '6'.
  3591           88  CP-CSL-METH-3                   VALUE '7'.
  3592           88  CP-CSL-METH-4                   VALUE '8'.
  3593
  3594         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3595                                     COMP-3.
  3596         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3597         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3598         16  CP-STATE              PIC XX          VALUE SPACE.
  3599         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3600         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3601           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3602               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3603         16  CP-R78-OPTION         PIC X.
  3604           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3605           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3606
  3607         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3608         16  CP-IBNR-RESERVE-SW    PIC X.
  3609         16  CP-CLAIM-STATUS       PIC X.
  3610         16  CP-RATE-FILE          PIC X.
  3611         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3612                                     COMP-3.
  3613
  3614         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3615         16  CP-AH-OVERRIDE-CODE   PIC X.
  3616
  3617         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3618                                     COMP-3.
  3619         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3620                                   PIC S9(5)V99 COMP-3.
  3621         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3622                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  69
* EL050.cbl
  3623         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3624                                     COMP-3.
  3625         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3626                                     COMP-3.
  3627         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3628                                  PIC S9(7)V99 COMP-3.
  3629
  3630         16  CP-PAID-FROM-DATE     PIC X(02).
  3631         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3632         16  CP-EXT-DAYS-CALC      PIC X.
  3633           88  CP-EXT-NO-CHG                   VALUE ' '.
  3634           88  CP-EXT-CHG-LF                   VALUE '1'.
  3635           88  CP-EXT-CHG-AH                   VALUE '2'.
  3636           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3637         16  CP-DOMICILE-STATE     PIC XX.
  3638         16  CP-CARRIER            PIC X.
  3639         16  CP-REIN-FLAG          PIC X.
  3640         16  CP-REM-TRM-CALC-OPTION PIC X.
  3641           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3642                      '2' '3' '4' '5'.
  3643           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3644           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3645           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3646           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3647           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3648           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3649           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3650           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3651         16  CP-SIG-SWITCH         PIC X.
  3652         16  CP-RATING-METHOD      PIC X.
  3653           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3654           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3655           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3656           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3657           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3658           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3659           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3660           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3661           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3662         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3663                                     COMP-3.
  3664         16  CP-BEN-CATEGORY       PIC X.
  3665         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3666         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3667                                   PIC S99V9(5) COMP-3.
  3668         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3669         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3670                                   PIC S99V9(5) COMP-3.
  3671         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3672         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3673         16  CP-EXPIRE-DT          PIC XX.
  3674         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3675         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3676         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3677         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3678         16  CP-DDF-SPEC-CALC      PIC X.
  3679             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3680             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  70
* EL050.cbl
  3681         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3682         16  CP-CANCEL-REASON      PIC X.
  3683         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3684         16  CP-PMT-MODE           PIC X.
  3685         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3686         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3687         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3688         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3689         16  FILLER                PIC X.
  3690
  3691***************    OUTPUT FROM ELRESV   ************************
  3692
  3693         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3694
  3695         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3698                                     COMP-3.
  3699         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3702                                     COMP-3.
  3703         16  FILLER                PIC X(09).
  3704***************    OUTPUT FROM ELRTRM   *************************
  3705
  3706         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3709                                     COMP-3.
  3710         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3711                                     COMP-3.
  3712         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3713                                     COMP-3.
  3714         16  FILLER                PIC X(12).
  3715
  3716***************    OUTPUT FROM ELRAMT   *************************
  3717
  3718         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3719                                     COMP-3.
  3720         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3721                                     COMP-3.
  3722         16  FILLER                PIC X(12).
  3723
  3724***************    OUTPUT FROM ELRATE   *************************
  3725
  3726         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3727                                     COMP-3.
  3728         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3729                                     COMP-3.
  3730         16  CP-MORTALITY-CODE     PIC X(4).
  3731         16  CP-RATE-EDIT-FLAG     PIC X.
  3732             88  CP-RATES-NEED-APR                  VALUE '1'.
  3733         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3734                                     COMP-3.
  3735         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3736         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3737         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3738                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  71
* EL050.cbl
  3739         16  FILLER                PIC X(07).
  3740
  3741***************    OUTPUT FROM ELRFND   *************************
  3742
  3743         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-REFUND-TYPE-USED   PIC X.
  3746           88  CP-R-AS-R78                         VALUE '1'.
  3747           88  CP-R-AS-PRORATA                     VALUE '2'.
  3748           88  CP-R-AS-CALIF                       VALUE '3'.
  3749           88  CP-R-AS-TEXAS                       VALUE '4'.
  3750           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3751           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3752           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3753           88  CP-R-AS-MEAN                        VALUE '8'.
  3754           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3755           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3756           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3757           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3758           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3759           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3760         16  FILLER                PIC X(12).
  3761
  3762***************    OUTPUT FROM ELEARN   *************************
  3763
  3764         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3765                                     COMP-3.
  3766         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3771                                     COMP-3.
  3772         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3773                                     COMP-3.
  3774         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3775                                     COMP-3.
  3776         16  CP-EARNING-TYPE-USED  PIC X.
  3777           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3778           88  CP-E-AS-R78                         VALUE '1'.
  3779           88  CP-E-AS-PRORATA                     VALUE '2'.
  3780           88  CP-E-AS-TEXAS                       VALUE '4'.
  3781           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3782           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3783           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3784           88  CP-E-AS-MEAN                        VALUE '8'.
  3785           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3786         16  FILLER                PIC X(12).
  3787
  3788***************    OUTPUT FROM ELPMNT   *************************
  3789
  3790         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3791                                     COMP-3.
  3792         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3793                                     COMP-3.
  3794         16  FILLER                PIC X(12).
  3795
  3796***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  72
* EL050.cbl
  3797         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3798                                     COMP-3.
  3799         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3804                                     COMP-3.
  3805         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3806                                     COMP-3.
  3807         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3808                                     COMP-3.
  3809         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3810             88  OPEN-RATE-FILE                   VALUE 'O'.
  3811             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3812             88  IO-ERROR                         VALUE 'E'.
  3813
  3814         16  CP-FIRST-PAY-DATE     PIC XX.
  3815
  3816         16  CP-JOINT-INDICATOR    PIC X.
  3817
  3818         16  CP-RESERVE-REMAINING-TERM
  3819                                   PIC S9(4)V9    VALUE ZERO
  3820                                     COMP-3.
  3821
  3822         16  CP-INSURED-BIRTH-DT   PIC XX.
  3823
  3824         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3825                                     COMP-3.
  3826
  3827         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3828                                     COMP-3.
  3829
  3830         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3831                                     COMP-3.
  3832
  3833         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3834                                     COMP-3.
  3835
  3836         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3837                                     COMP-3.
  3838
  3839         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3840                                     COMP-3.
  3841
  3842         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3843                                     COMP-3.
  3844
  3845         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3846             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3847
  3848         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3849                                     COMP-3.
  3850         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3851                                     COMP-3.
  3852         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3853         16  FILLER                PIC X(15).
  3854******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  73
* EL050.cbl
  3856******************************************************************
  3857*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3858*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3859*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3860*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3861*** MODIFICATION.                                              ***
  3862*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3863*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3864******************************************************************
  3865*    COPY ERCPNDB.
  3866******************************************************************
  3867*                                                                *
  3868*                                                                *
  3869*                            ERCPNDB.                            *
  3870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3871*                            VMOD=2.025                          *
  3872*                                                                *
  3873*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3874*                                                                *
  3875******************************************************************
  3876*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3877*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3878******************************************************************
  3879*                                                                *
  3880*                                                                *
  3881*   FILE TYPE = VSAM,KSDS                                        *
  3882*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3883*                                                                *
  3884*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3885*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3886*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3887*                                                 RKP=13,LEN=36  *
  3888*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3889*                                      AND CHG-SEQ.)             *
  3890*                                                RKP=49,LEN=11   *
  3891*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3892*                                      AND CHG-SEQ.)             *
  3893*                                                RKP=60,LEN=15   *
  3894*                                                                *
  3895*   LOG = NO                                                     *
  3896*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3897******************************************************************
  3898******************************************************************
  3899*                   C H A N G E   L O G
  3900*
  3901* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3902*-----------------------------------------------------------------
  3903*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3904* EFFECTIVE    NUMBER
  3905*-----------------------------------------------------------------
  3906* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3907* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3908* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3909* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3910* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3911* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3912* 032306                   PEMA  ADD BOW LOAN NUMBER
  3913* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  74
* EL050.cbl
  3914* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3915* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3916* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3917* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3918* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3919* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3920* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3921******************************************************************
  3922
  3923 01  PENDING-BUSINESS.
  3924     12  PB-RECORD-ID                     PIC XX.
  3925         88  VALID-PB-ID                        VALUE 'PB'.
  3926
  3927     12  PB-CONTROL-PRIMARY.
  3928         16  PB-COMPANY-CD                PIC X.
  3929         16  PB-ENTRY-BATCH               PIC X(6).
  3930         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3931         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3932
  3933     12  PB-CONTROL-BY-ACCOUNT.
  3934         16  PB-COMPANY-CD-A1             PIC X.
  3935         16  PB-CARRIER                   PIC X.
  3936         16  PB-GROUPING.
  3937             20  PB-GROUPING-PREFIX       PIC XXX.
  3938             20  PB-GROUPING-PRIME        PIC XXX.
  3939         16  PB-STATE                     PIC XX.
  3940         16  PB-ACCOUNT.
  3941             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3942             20  PB-ACCOUNT-PRIME         PIC X(6).
  3943         16  PB-CERT-EFF-DT               PIC XX.
  3944         16  PB-CERT-NO.
  3945             20  PB-CERT-PRIME            PIC X(10).
  3946             20  PB-CERT-SFX              PIC X.
  3947         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3948
  3949         16  PB-RECORD-TYPE               PIC X.
  3950             88  PB-MAILING-DATA                VALUE '0'.
  3951             88  PB-ISSUE                       VALUE '1'.
  3952             88  PB-CANCELLATION                VALUE '2'.
  3953             88  PB-BATCH-TRAILER               VALUE '9'.
  3954
  3955     12  PB-CONTROL-BY-ORIG-BATCH.
  3956         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3957         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3958         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3959         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3960
  3961     12  PB-CONTROL-BY-CSR.
  3962         16  PB-CSR-COMPANY-CD            PIC X.
  3963         16  PB-CSR-ID                    PIC X(4).
  3964         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3965         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3966         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3967******************************************************************
  3968*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3969******************************************************************
  3970
  3971     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  75
* EL050.cbl
  3972     12  PB-LAST-MAINT-BY                 PIC X(4).
  3973     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3974
  3975     12  PB-RECORD-BODY                   PIC X(375).
  3976
  3977     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3978         16  PB-CERT-ORIGIN               PIC X.
  3979             88  CLASIC-CREATED-CERT         VALUE '1'.
  3980         16  PB-I-NAME.
  3981             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3982             20  PB-I-INSURED-FIRST-NAME.
  3983                 24  PB-I-INSURED-1ST-INIT PIC X.
  3984                 24  FILLER                PIC X(9).
  3985             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3986         16  PB-I-AGE                     PIC S99   COMP-3.
  3987         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3988         16  PB-I-BIRTHDAY                PIC XX.
  3989         16  PB-I-INSURED-SEX             PIC X.
  3990             88  PB-SEX-MALE     VALUE 'M'.
  3991             88  PB-SEX-FEMALE   VALUE 'F'.
  3992
  3993         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3994         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3995         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3996         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3997         16  PB-I-SKIP-CODE               PIC X.
  3998             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3999             88  PB-SKIP-JULY              VALUE '1'.
  4000             88  PB-SKIP-AUGUST            VALUE '2'.
  4001             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4002             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4003             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4004             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4005             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4006             88  PB-SKIP-JUNE              VALUE '8'.
  4007             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4008             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4009             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4010         16  PB-I-TERM-TYPE               PIC X.
  4011             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4012             88  PB-PAID-WEEKLY            VALUE 'W'.
  4013             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4014             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4015             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4016         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4017         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4018         16  PB-I-DATA-ENTRY-SW           PIC X.
  4019             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4020             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4021             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4022             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4023         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4024         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4025*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4026         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4027         16  FILLER                       PIC X.
  4028
  4029         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  76
* EL050.cbl
  4030             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4031             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4032                                                   '90' THRU '99'.
  4033         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4034                                          PIC XX.
  4035         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4036         16  PB-I-AMOUNT-FINANCED REDEFINES
  4037                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4038         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4039         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4040                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4041         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4042         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4043         16  PB-I-CLP-AMOUNT REDEFINES
  4044                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4045         16  PB-I-LF-CALC-FLAG            PIC X.
  4046             88 PB-COMP-LF-PREM               VALUE '?'.
  4047         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4048         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4049         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4050         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4051         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4052         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4053         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4054         16  PB-I-LF-ABBR                 PIC XXX.
  4055         16  PB-I-LF-INPUT-CD             PIC XX.
  4056
  4057         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4058             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4059             88  PB-INVALID-AH               VALUE '  ' '00'
  4060                                                   '90' THRU '99'.
  4061         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4062         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4063         16  PB-I-AH-CALC-FLAG            PIC X.
  4064             88 PB-COMP-AH-PREM                  VALUE '?'.
  4065         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4066         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4067         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4068         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4069         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4070         16  PB-I-AH-ABBR                 PIC XXX.
  4071         16  PB-I-AH-INPUT-CD             PIC XXX.
  4072
  4073         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4074         16  PB-I-REIN-TABLE              PIC XXX.
  4075         16  PB-I-BUSINESS-TYPE           PIC 99.
  4076         16  PB-I-INDV-GRP-CD             PIC X.
  4077         16  PB-I-MORT-CODE.
  4078             20  PB-I-TABLE               PIC X.
  4079             20  PB-I-INTEREST            PIC XX.
  4080             20  PB-I-MORT-TYP            PIC X.
  4081         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4082         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4083         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4084         16  PB-I-INDV-GRP-OVRD           PIC X.
  4085         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4086         16  PB-I-SIG-SW                  PIC X.
  4087             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  77
* EL050.cbl
  4088         16  PB-I-RATE-CLASS              PIC XX.
  4089         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4090         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4091         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4092         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4093         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4094         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4095         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4096         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4097         16  PB-I-OB-FLAG                 PIC X.
  4098             88  PB-I-OB                      VALUE 'B'.
  4099             88  PB-I-SUMMARY                 VALUE 'Z'.
  4100         16  PB-I-ENTRY-STATUS            PIC X.
  4101             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4102                                              'M' '5' '9' '2'.
  4103             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4104             88  PB-I-POLICY-PENDING          VALUE '2'.
  4105             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4106             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4107             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4108             88  PB-I-REIN-ONLY               VALUE '9'.
  4109             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4110             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4111             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4112             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4113         16  PB-I-INT-CODE                PIC X.
  4114             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4115             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4116         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4117         16  PB-I-SOC-SEC-NO              PIC X(11).
  4118         16  PB-I-MEMBER-NO               PIC X(12).
  4119         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4120*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4121         16  PB-I-OLD-LOF                 PIC XXX.
  4122         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4123         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4124         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4125         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4126         16  PB-I-LIFE-INDICATOR          PIC X.
  4127             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4128         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4129         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4130                                          PIC S9(5)V99    COMP-3.
  4131         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4132             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4133             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4134         16  PB-I-1ST-PMT-DT              PIC XX.
  4135         16  PB-I-JOINT-INSURED.
  4136             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4137             20 PB-I-JOINT-FIRST-NAME.
  4138                24  PB-I-JOINT-FIRST-INIT PIC X.
  4139                24  FILLER                PIC X(9).
  4140             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4141*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4142         16  PB-I-BENEFICIARY-NAME.
  4143             20  PB-I-BANK-NUMBER         PIC X(10).
  4144             20  FILLER                   PIC X(15).
  4145         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  78
* EL050.cbl
  4146         16  PB-I-REFERENCE               PIC X(12).
  4147         16  FILLER REDEFINES PB-I-REFERENCE.
  4148             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4149             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4150             20  PB-I-CLP-STATE           PIC XX.
  4151         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4152             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4153             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4154             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4155         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4156         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4157         16  PB-I-RESIDENT-STATE          PIC XX.
  4158         16  PB-I-RATE-CODE               PIC X(4).
  4159         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4160         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4161         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4162         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4163         16  PB-I-BANK-NOCHRGB            PIC 99.
  4164         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4165         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4166
  4167     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4168         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4169             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4170         16  PB-C-CANCEL-ORIGIN           PIC X.
  4171             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4172         16  PB-C-LF-CANCEL-DT            PIC XX.
  4173         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4174         16  PB-C-LF-CALC-REQ             PIC X.
  4175             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4176         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4177         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4178         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4179             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4180         16  PB-C-AH-CANCEL-DT            PIC XX.
  4181         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4182         16  PB-C-AH-CALC-REQ             PIC X.
  4183             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4184         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4185         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4186         16  PB-C-LAST-NAME               PIC X(15).
  4187         16  PB-C-REFUND-SW               PIC X.
  4188             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4189             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4190         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4191         16  PB-C-PAYEE-CODE              PIC X(6).
  4192         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4193         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4194         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4195         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4196         16  PB-C-REFERENCE               PIC X(12).
  4197         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4198         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4199         16  PB-C-POST-CARD-IND           PIC X.
  4200         16  PB-C-CANCEL-REASON           PIC X.
  4201         16  PB-C-REF-INTERFACE-SW        PIC X.
  4202         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4203         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  79
* EL050.cbl
  4204         16  FILLER                       PIC X(01).
  4205*        16  FILLER                       PIC X(18).
  4206         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4207*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4208         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4209         16  PB-CANCELED-CERT-DATA.
  4210             20  PB-CI-INSURED-NAME.
  4211                 24  PB-CI-LAST-NAME      PIC X(15).
  4212                 24  PB-CI-INITIALS       PIC XX.
  4213             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4214             20  PB-CI-INSURED-SEX        PIC X.
  4215             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4216             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4217             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4218             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4219             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4220             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4221             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4222             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4223             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4224             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4225             20  PB-CI-RATE-CLASS         PIC XX.
  4226             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4227             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4228             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4229             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4230             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4231             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4232             20  PB-CI-LF-ABBR            PIC X(3).
  4233             20  PB-CI-AH-ABBR            PIC X(3).
  4234             20  PB-CI-OB-FLAG            PIC X.
  4235                 88  PB-CI-OB                VALUE 'B'.
  4236             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4237                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4238                                           'M' '4' '5' '9' '2'.
  4239                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4240                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4241                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4242                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4243                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4244                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4245                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4246                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4247                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4248                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4249                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4250                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4251             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4252                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4253                                           'M' '4' '5' '9' '2'.
  4254                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4255                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4256                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4257                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4258                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4259                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4260                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4261                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  80
* EL050.cbl
  4262                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4263                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4264                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4265                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4266             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4267             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4268             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4269             20  PB-CI-MEMBER-NO          PIC X(12).
  4270             20  PB-CI-INT-CODE           PIC X.
  4271                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4272                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4273             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4274             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4275             20  PB-CI-COMP-EXCP-SW       PIC X.
  4276                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4277                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4278             20  PB-CI-ENTRY-STATUS       PIC X.
  4279             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4280             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4281             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4282             20  PB-CI-DEATH-DT           PIC XX.
  4283             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4284             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4285             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4286             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4287             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4288             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4289             20  PB-CI-ENTRY-DT              PIC XX.
  4290             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4291             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4292             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4293             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4294             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4295             20  PB-CI-OLD-LOF               PIC XXX.
  4296*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4297             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4298             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4299             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4300             20  PB-CI-INDV-GRP-CD           PIC X.
  4301             20  PB-CI-BENEFICIARY-NAME.
  4302                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4303                 24  FILLER                  PIC X(15).
  4304             20  PB-CI-NOTE-SW               PIC X.
  4305             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4306             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4307             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4308             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4309             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4310             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4311             20  PB-CI-FIRST-NAME            PIC X(10).
  4312             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4313
  4314         16  FILLER                       PIC X(13).
  4315*032306  16  FILLER                       PIC X(27).
  4316*        16  FILLER                       PIC X(46).
  4317
  4318     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4319         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  81
* EL050.cbl
  4320         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4321         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4322         16  PB-M-INSURED-MID-INIT        PIC X.
  4323         16  PB-M-INSURED-AGE             PIC 99.
  4324         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4325         16  PB-M-INSURED-SEX             PIC X.
  4326         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4327         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4328         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4329         16  PB-M-INSURED-CITY-STATE.
  4330             20  PB-M-INSURED-CITY        PIC X(28).
  4331             20  PB-M-INSURED-STATE       PIC XX.
  4332         16  PB-M-INSURED-ZIP-CODE.
  4333             20  PB-M-INSURED-ZIP-PRIME.
  4334                 24  PB-M-INSURED-ZIP-1   PIC X.
  4335                     88  PB-M-CANADIAN-POST-CODE
  4336                                             VALUE 'A' THRU 'Z'.
  4337                 24  FILLER               PIC X(4).
  4338             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4339         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4340                                        PB-M-INSURED-ZIP-CODE.
  4341             20  PM-M-INS-CAN-POST1       PIC XXX.
  4342             20  PM-M-INS-CAN-POST2       PIC XXX.
  4343             20  FILLER                   PIC XXX.
  4344         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4345         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4346         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4347         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4348         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4349         16  PB-M-CRED-BENE-CITYST.
  4350             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4351             20  PB-M-CRED-BENE-STATE     PIC XX.
  4352         16  FILLER                       PIC X(92).
  4353
  4354     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4355         16  FILLER                       PIC X(10).
  4356         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4357         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4358         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4359         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4360         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4361         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4362         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4363         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4364         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4365         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4366         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4367         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4368         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4369         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4370         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4371         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4372         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4373         16  PB-ACCOUNT-NAME              PIC X(30).
  4374         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4375         16  PB-REFERENCE                 PIC X(12).
  4376         16  PB-B-RECEIVED-DT             PIC XX.
  4377         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  82
* EL050.cbl
  4378
  4379     12  PB-RECORD-STATUS.
  4380         16  PB-CREDIT-SELECT-DT          PIC XX.
  4381         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4382         16  PB-BILLED-DT                 PIC XX.
  4383         16  PB-BILLING-STATUS            PIC X.
  4384             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4385             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4386             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4387         16  PB-RECORD-BILL               PIC X.
  4388             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4389             88  PB-RECORD-RETURNED           VALUE 'R'.
  4390             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4391             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4392             88  PB-OVERRIDE-AH               VALUE 'A'.
  4393             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4394         16  PB-BATCH-ENTRY               PIC X.
  4395             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4396             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4397             88  PB-REISSUED-CERT             VALUE 'E'.
  4398             88  PB-MONTHLY-CERT              VALUE 'M'.
  4399             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4400             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4401             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4402         16  PB-FORCE-CODE                PIC X.
  4403             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4404             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4405             88  PB-CANCEL-FORCE              VALUE '8'.
  4406             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4407             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4408             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4409             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4410             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4411             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4412             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4413         16  PB-FATAL-FLAG                PIC X.
  4414             88  PB-FATAL-ERRORS              VALUE 'X'.
  4415         16  PB-FORCE-ER-CD               PIC X.
  4416             88  PB-FORCE-ERRORS              VALUE 'F'.
  4417             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4418         16  PB-WARN-ER-CD                PIC X.
  4419             88  PB-WARNING-ERRORS            VALUE 'W'.
  4420         16  FILLER                       PIC X.
  4421         16  PB-OUT-BAL-CD                PIC X.
  4422             88  PB-OUT-OF-BAL                VALUE 'O'.
  4423         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4424         16  PB-AH-OVERRIDE-L1            PIC X.
  4425         16  PB-INPUT-DT                  PIC XX.
  4426         16  PB-INPUT-BY                  PIC X(4).
  4427         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4428         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4429         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4430         16  PB-LF-EARNING-METHOD         PIC X.
  4431         16  PB-AH-EARNING-METHOD         PIC X.
  4432         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4433         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4434         16  PB-REIN-CD                   PIC XXX.
  4435         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  83
* EL050.cbl
  4436         16  PB-AH-REFUND-TYPE            PIC X.
  4437         16  PB-ACCT-EFF-DT               PIC XX.
  4438         16  PB-ACCT-EXP-DT               PIC XX.
  4439         16  PB-COMPANY-ID                PIC X(3).
  4440         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4441         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4442         16  PB-SV-CARRIER                PIC X.
  4443         16  PB-SV-GROUPING               PIC X(6).
  4444         16  PB-SV-STATE                  PIC XX.
  4445         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4446         16  PB-GA-BILLING-INFO.
  4447             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4448                                          PIC XX.
  4449         16  PB-SV-REMIT-TO  REDEFINES
  4450             PB-GA-BILLING-INFO           PIC X(10).
  4451         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4452         16  PB-I-LOAN-OFFICER            PIC X(5).
  4453         16  PB-I-VIN                     PIC X(17).
  4454
  4455         16  FILLER                       PIC X(04).
  4456         16  IMNET-BYPASS-SW              PIC X.
  4457
  4458******************************************************************
  4459*                COMMON EDIT ERRORS                              *
  4460******************************************************************
  4461
  4462     12  PB-COMMON-ERRORS.
  4463         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4464                                           PIC S9(4)     COMP.
  4465
  4466******************************************************************
  4467
  4468* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4469*    COPY ELC50W1.
  4470******************************************************************
  4471*                                                                *
  4472*                                                                *
  4473*                             ELC50W1                            *
  4474*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4475*                            VMOD=2.004                          *
  4476*                                                                *
  4477*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4478*                                                                *
  4479*                                                                *
  4480******************************************************************
  4481
  4482     12  WK-WORK-AREA.
  4483         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4484         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4485         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4486         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4487         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4488         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4489         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4490         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4491         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4492         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4493         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  84
* EL050.cbl
  4494         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4495         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4496         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4497         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4498         16  WK-CREDIT-EDIT-CONTROLS.
  4499             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4500             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4501             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4502             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4503             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4504             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4505         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4506         16  WK-SAVE-REIN-DATA.
  4507             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4508             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4509             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4510         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4511             88  ENTRY-FROM-EL6311       VALUE '6'.
  4512         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4513         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4514     12  WK-RECORD-ADDRESSES.
  4515         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4516         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4517         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4518         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4519         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4520         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4521         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4522         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4523     12  WK-OVER-SHORT-AREA.
  4524         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4525         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4526         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4527             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4528         16  FILLER                   PIC X(5) VALUE SPACES.
  4529
  4530*    COPY ELCEDITC.
  4531******************************************************************
  4532*                                                                *
  4533*                                                                *
  4534*                            ELCEDITC                            *
  4535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4536*                            VMOD=2.012                          *
  4537*                                                                *
  4538*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4539*                     EL6313, EL050 AND EL517.                   *
  4540*                                                                *
  4541******************************************************************
  4542******************************************************************
  4543*                   C H A N G E   L O G
  4544*
  4545* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4546*-----------------------------------------------------------------
  4547*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4548* EFFECTIVE    NUMBER
  4549*-----------------------------------------------------------------
  4550* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4551******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  85
* EL050.cbl
  4552
  4553     12  EDIT-CRITERIA-DATA.
  4554         16  EC-CO-MONTH-END-DT       PIC XX.
  4555         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4556         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4557         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4558         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4559         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4560         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4561         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4562         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4563         16  EC-CO-REM-TERM-CALC      PIC X.
  4564               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4565               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4566               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4567               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4568
  4569         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4570               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4571               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4572               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4573               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4574               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4575               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4576               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4577               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4578               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4579               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4580
  4581         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4582               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4583               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4584               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4585               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4586               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4587               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4588               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4589               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4590
  4591         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4592                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4593                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4594
  4595         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4596                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4597                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4598                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4599                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4600                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4601                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4602                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4603                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4604
  4605         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4606               88  EC-BR-REDUCING                   VALUE 'R'.
  4607               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4608
  4609         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  86
* EL050.cbl
  4610         16  EC-BR-LF-DESC             PIC X(10).
  4611         16  EC-BR-AH-DESC             PIC X(10).
  4612         16  EC-BR-LF-COMMENT          PIC X(10).
  4613         16  EC-BR-AH-COMMENT          PIC X(10).
  4614
  4615         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4616               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4617               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4618               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4619               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4620
  4621         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4622               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4623               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4624               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4625               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4626
  4627         16  EC-BR-LF-REFUND-CALC      PIC X.
  4628                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4629                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4630                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4631                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4632                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4633                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4634                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4635
  4636         16  EC-BR-AH-REFUND-CALC      PIC X.
  4637                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4638                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4639                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4640                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4641                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4642                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4643                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4644                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4645
  4646         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4647                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4648                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4649                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4650
  4651         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4652                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4653                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4654                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4655
  4656         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4657         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4658         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4659         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4660
  4661         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4662         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4663                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4664                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4665                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4666                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4667
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  87
* EL050.cbl
  4668         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4669               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4670               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4671               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4672               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4673               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4674
  4675         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4676               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4677               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4678               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4679               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4680               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4681
  4682         16  EC-ST-LF-REFUND-CALC      PIC X.
  4683                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4684                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4685                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4686                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4687                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4688                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4689                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4690                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4691
  4692         16  EC-ST-AH-REFUND-CALC      PIC X.
  4693                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4694                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4695                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4696                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4697                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4698                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4699                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4700                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4701
  4702         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4703         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4704         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4705         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4706         16  EC-AM-EXPIRATION-DT       PIC XX.
  4707         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4708         16  EC-AM-CLASS-CD            PIC XX.
  4709         16  EC-AM-LF-DEVIATION        PIC XXX.
  4710         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4711         16  EC-AM-AH-DEVIATION        PIC XXX.
  4712         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4713         16  EC-AM-PHONE-NO            PIC X(10).
  4714
  4715         16  EC-AM-LF-REFUND-CALC      PIC X.
  4716                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4717                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4718                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4719                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4720                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4721                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4722                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4723
  4724         16  EC-AM-AH-REFUND-CALC      PIC X.
  4725                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  88
* EL050.cbl
  4726                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4727                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4728                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4729                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4730                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4731                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4732
  4733         16  EC-AM-BEN-I-G-CD          PIC X.
  4734                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4735                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4736                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4737
  4738         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4739         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4740         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4741         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4742         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4743         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4744         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4745         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4746         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4747
  4748         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4749         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4750         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4751         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4752         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4753         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4754         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4755         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4756         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4757         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4758         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4759         16  EC-RT-LF-NSP-ST           PIC XX.
  4760         16  EC-RT-AH-NSP-ST           PIC XX.
  4761         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4762         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4763
  4764         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4765             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4766                                             'M' '5' '9' '2'.
  4767             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4768             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4769             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4770             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4771             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4772             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4773             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4774             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4775             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4776             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4777
  4778         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4779             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4780                                             'M' '5' '9' '2'.
  4781             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4782             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4783             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  89
* EL050.cbl
  4784             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4785             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4786             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4787             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4788             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4789             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4790             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4791
  4792         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4793         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4794         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4795         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4796         16  EC-CM-DEATH-DT            PIC XX.
  4797
  4798*DMD CUSTOM CODING FIELDS BELOW
  4799*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4800         16  EC-BR-DMD-RATING-SW       PIC X.
  4801                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4802                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4803                 88  NO-DMD-RATING               VALUE 'N'.
  4804
  4805         16  EC-NEW-CERT               PIC X(11).
  4806         16  EC-NEW-STATE              PIC XX.
  4807         16  FILLER                    PIC X.
  4808*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4809         16  OVER-SHORT-EDIT-FIELDS.
  4810             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4811             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4812             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4813             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4814             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4815             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4816             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4817             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4818             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4819         16  FILLER                    PIC X(71).
  4820******************************************************************
  4821
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  90
* EL050.cbl
  4823*    COPY ELCDIFRD.
  4824******************************************************************
  4825*                                                                *
  4826*                                                                *
  4827*                            ELCDIFRD.                           *
  4828*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4829*                            VMOD=2.004                          *
  4830*                                                                *
  4831*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4832*                                                                *
  4833******************************************************************
  4834*
  4835  01  WS-DIFFERENCE-CALCULATION.
  4836        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4837        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4838        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4839        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4840        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4841        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4842        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4843        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4844        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4845        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4846        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4847
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  91
* EL050.cbl
  4849****************************************************************
  4850*
  4851* Copyright (c) 2007 by Clerity Solutions, Inc.
  4852* All rights reserved.
  4853*
  4854****************************************************************
  4855 01  DFHEIV.
  4856   02  DFHEIV0               PIC X(35).
  4857   02  DFHEIV1               PIC X(08).
  4858   02  DFHEIV2               PIC X(08).
  4859   02  DFHEIV3               PIC X(08).
  4860   02  DFHEIV4               PIC X(06).
  4861   02  DFHEIV5               PIC X(04).
  4862   02  DFHEIV6               PIC X(04).
  4863   02  DFHEIV7               PIC X(02).
  4864   02  DFHEIV8               PIC X(02).
  4865   02  DFHEIV9               PIC X(01).
  4866   02  DFHEIV10              PIC S9(7) COMP-3.
  4867   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4868   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4869   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4870   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4871   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4872   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4873   02  DFHEIV17              PIC X(04).
  4874   02  DFHEIV18              PIC X(04).
  4875   02  DFHEIV19              PIC X(04).
  4876   02  DFHEIV20              USAGE IS POINTER.
  4877   02  DFHEIV21              USAGE IS POINTER.
  4878   02  DFHEIV22              USAGE IS POINTER.
  4879   02  DFHEIV23              USAGE IS POINTER.
  4880   02  DFHEIV24              USAGE IS POINTER.
  4881   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4882   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4883   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4884   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4885   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4886   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4887   02  FILLER                PIC X(02).
  4888   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4889   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4890   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4891   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4892   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4893 LINKAGE  SECTION.
  4894*****************************************************************
  4895*                                                               *
  4896* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4897* All rights reserved.                                          *
  4898*                                                               *
  4899*****************************************************************
  4900 01  dfheiblk.
  4901     02  eibtime          pic s9(7) comp-3.
  4902     02  eibdate          pic s9(7) comp-3.
  4903     02  eibtrnid         pic x(4).
  4904     02  eibtaskn         pic s9(7) comp-3.
  4905     02  eibtrmid         pic x(4).
  4906     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  92
* EL050.cbl
  4907     02  eibcposn         pic s9(4) comp.
  4908     02  eibcalen         pic s9(4) comp.
  4909     02  eibaid           pic x(1).
  4910     02  eibfiller1       pic x(1).
  4911     02  eibfn            pic x(2).
  4912     02  eibfiller2       pic x(2).
  4913     02  eibrcode         pic x(6).
  4914     02  eibfiller3       pic x(2).
  4915     02  eibds            pic x(8).
  4916     02  eibreqid         pic x(8).
  4917     02  eibrsrce         pic x(8).
  4918     02  eibsync          pic x(1).
  4919     02  eibfree          pic x(1).
  4920     02  eibrecv          pic x(1).
  4921     02  eibsend          pic x(1).
  4922     02  eibatt           pic x(1).
  4923     02  eibeoc           pic x(1).
  4924     02  eibfmh           pic x(1).
  4925     02  eibcompl         pic x(1).
  4926     02  eibsig           pic x(1).
  4927     02  eibconf          pic x(1).
  4928     02  eiberr           pic x(1).
  4929     02  eibrldbk         pic x(1).
  4930     02  eiberrcd         pic x(4).
  4931     02  eibsynrb         pic x(1).
  4932     02  eibnodat         pic x(1).
  4933     02  eibfiller5       pic x(2).
  4934     02  eibresp          pic 9(09) comp.
  4935     02  eibresp2         pic 9(09) comp.
  4936     02  dfheigdj         pic s9(4) comp.
  4937     02  dfheigdk         pic s9(4) comp.
  4938
  4939 01  DFHCOMMAREA                   PIC X(1036).
  4940
  4941*01 PARMLIST .
  4942*    02  FILLER                    PIC S9(8)   COMP.
  4943*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4944*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4945*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4946*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4947*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4948*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4949*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4950
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  93
* EL050.cbl
  4952*    COPY ELCCNTL.
  4953******************************************************************
  4954*                                                                *
  4955*                                                                *
  4956*                            ELCCNTL.                            *
  4957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4958*                            VMOD=2.059                          *
  4959*                                                                *
  4960*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4961*                                                                *
  4962*   FILE TYPE = VSAM,KSDS                                        *
  4963*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4964*                                                                *
  4965*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4966*       ALTERNATE INDEX = NONE                                   *
  4967*                                                                *
  4968*   LOG = YES                                                    *
  4969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4970******************************************************************
  4971*                   C H A N G E   L O G
  4972*
  4973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4974*-----------------------------------------------------------------
  4975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4976* EFFECTIVE    NUMBER
  4977*-----------------------------------------------------------------
  4978* 082503                   PEMA  ADD BENEFIT GROUP
  4979* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4980* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4981* 092705    2005050300006  PEMA  ADD SPP LEASES
  4982* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4983* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4984* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4985* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4986* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4987* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4988* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4989* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4990* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4991* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4992******************************************************************
  4993*
  4994 01  CONTROL-FILE.
  4995     12  CF-RECORD-ID                       PIC XX.
  4996         88  VALID-CF-ID                        VALUE 'CF'.
  4997
  4998     12  CF-CONTROL-PRIMARY.
  4999         16  CF-COMPANY-ID                  PIC XXX.
  5000         16  CF-RECORD-TYPE                 PIC X.
  5001             88  CF-COMPANY-MASTER              VALUE '1'.
  5002             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5003             88  CF-STATE-MASTER                VALUE '3'.
  5004             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5005             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5006             88  CF-CARRIER-MASTER              VALUE '6'.
  5007             88  CF-MORTALITY-MASTER            VALUE '7'.
  5008             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5009             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  94
* EL050.cbl
  5010             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5011             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5012             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5013             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5014             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5015             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5016             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5017             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5018             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5019         16  CF-ACCESS-CD-GENL              PIC X(4).
  5020         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5021             20  CF-PROCESSOR               PIC X(4).
  5022         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5023             20  CF-STATE-CODE              PIC XX.
  5024             20  FILLER                     PIC XX.
  5025         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5026             20  FILLER                     PIC XX.
  5027             20  CF-HI-BEN-IN-REC           PIC XX.
  5028         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5029             20  FILLER                     PIC XXX.
  5030             20  CF-CARRIER-CNTL            PIC X.
  5031         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5032             20  FILLER                     PIC XX.
  5033             20  CF-HI-TYPE-IN-REC          PIC 99.
  5034         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5035             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5036                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5037             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5038             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5039         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5040             20  FILLER                     PIC X.
  5041             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5042         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5043             20  FILLER                     PIC XX.
  5044             20  CF-MORTGAGE-PLAN           PIC XX.
  5045         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5046
  5047     12  CF-LAST-MAINT-DT                   PIC XX.
  5048     12  CF-LAST-MAINT-BY                   PIC X(4).
  5049     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5050
  5051     12  CF-RECORD-BODY                     PIC X(728).
  5052
  5053
  5054****************************************************************
  5055*             COMPANY MASTER RECORD                            *
  5056****************************************************************
  5057
  5058     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5059         16  CF-COMPANY-ADDRESS.
  5060             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5061             20  CF-CL-IN-CARE-OF           PIC X(30).
  5062             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5063             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5064             20  CF-CL-CITY-STATE           PIC X(30).
  5065             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5066             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5067         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  95
* EL050.cbl
  5068         16  CF-COMPANY-PASSWORD            PIC X(8).
  5069         16  CF-SECURITY-OPTION             PIC X.
  5070             88  ALL-SECURITY                   VALUE '1'.
  5071             88  COMPANY-VERIFY                 VALUE '2'.
  5072             88  PROCESSOR-VERIFY               VALUE '3'.
  5073             88  NO-SECURITY                    VALUE '4'.
  5074             88  ALL-BUT-TERM                   VALUE '5'.
  5075         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5076             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5077         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5078             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5079         16  CF-INFORCE-LOCATION            PIC X.
  5080             88  CERTS-ARE-ONLINE               VALUE '1'.
  5081             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5082             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5083         16  CF-LOWER-CASE-LETTERS          PIC X.
  5084         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5085             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5086             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5087             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5088             88  CF-ACCNT-CNTL                  VALUE '3'.
  5089             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5090
  5091         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5092         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5093
  5094         16  CF-LGX-CREDIT-USER             PIC X.
  5095             88  CO-IS-NOT-USER                 VALUE 'N'.
  5096             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5097
  5098         16 CF-CREDIT-CALC-CODES.
  5099             20  CF-CR-REM-TERM-CALC PIC X.
  5100               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5101               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5102               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5103               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5104               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5105               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5106               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5107             20  CF-CR-R78-METHOD           PIC X.
  5108               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5109               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5110
  5111         16  CF-CLAIM-CONTROL-COUNTS.
  5112             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5113                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5114
  5115             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5116                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5117
  5118             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5119                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5120
  5121             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5122                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5123
  5124         16  CF-CURRENT-MONTH-END           PIC XX.
  5125
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  96
* EL050.cbl
  5126         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5127             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5128             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5129             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5130             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5131                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5132                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5133             20  CF-CO-PREM-REJECT-SW       PIC X.
  5134                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5135                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5136             20  CF-CO-REF-REJECT-SW        PIC X.
  5137                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5138                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5139
  5140         16  CF-CO-REPORTING-DT             PIC XX.
  5141         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5142         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5143           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5144           88  CF-CO-MONTH-END                  VALUE '1'.
  5145
  5146         16  CF-LGX-CLAIM-USER              PIC X.
  5147             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5148             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5149
  5150         16  CF-CREDIT-EDIT-CONTROLS.
  5151             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5152             20  CF-MIN-AGE                 PIC 99.
  5153             20  CF-DEFAULT-AGE             PIC 99.
  5154             20  CF-MIN-TERM                PIC S999      COMP-3.
  5155             20  CF-MAX-TERM                PIC S999      COMP-3.
  5156             20  CF-DEFAULT-SEX             PIC X.
  5157             20  CF-JOINT-AGE-INPUT         PIC X.
  5158                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5159             20  CF-BIRTH-DATE-INPUT        PIC X.
  5160                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5161             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5162                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5163                 88  CF-ZERO-CARRIER            VALUE '1'.
  5164                 88  CF-ZERO-GROUPING           VALUE '2'.
  5165                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5166             20  CF-EDIT-SW                 PIC X.
  5167                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5168             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5169             20  CF-CR-PR-METHOD            PIC X.
  5170               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5171               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5172             20  FILLER                     PIC X.
  5173
  5174         16  CF-CREDIT-MISC-CONTROLS.
  5175             20  CF-REIN-TABLE-SW           PIC X.
  5176                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5177             20  CF-COMP-TABLE-SW           PIC X.
  5178                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5179             20  CF-EXPERIENCE-RETENTION-AGE
  5180                                            PIC S9        COMP-3.
  5181             20  CF-CONVERSION-DT           PIC XX.
  5182             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5183             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  97
* EL050.cbl
  5184                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5185                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5186
  5187             20  CF-CR-CHECK-NO-CONTROL.
  5188                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5189                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5190                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5191                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5192                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5193                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5194
  5195                 24  CF-CR-CHECK-COUNT       REDEFINES
  5196                     CF-CR-CHECK-COUNTER      PIC X(4).
  5197
  5198                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5199                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5200
  5201                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5202                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5203                 24  CF-MAIL-PROCESSING       PIC X.
  5204                     88  MAIL-PROCESSING          VALUE 'Y'.
  5205
  5206         16  CF-MISC-SYSTEM-CONTROL.
  5207             20  CF-SYSTEM-C                 PIC X.
  5208                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5209             20  CF-SYSTEM-D                 PIC X.
  5210                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5211             20  CF-SOC-SEC-NO-SW            PIC X.
  5212                 88  SOC-SEC-NO-USED             VALUE '1'.
  5213             20  CF-MEMBER-NO-SW             PIC X.
  5214                 88  MEMBER-NO-USED              VALUE '1'.
  5215             20  CF-TAX-ID-NUMBER            PIC X(11).
  5216             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5217             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5218                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5219                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5220                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5221                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5222             20  CF-SYSTEM-E                 PIC X.
  5223                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5224
  5225         16  CF-LGX-LIFE-USER               PIC X.
  5226             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5227             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5228
  5229         16  CF-CR-MONTH-END-DT             PIC XX.
  5230
  5231         16  CF-FILE-MAINT-DATES.
  5232             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5233                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5234             20  CF-LAST-BATCH       REDEFINES
  5235                 CF-LAST-BATCH-NO               PIC X(4).
  5236             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5237             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5238             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5239             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5240             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5241             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  98
* EL050.cbl
  5242             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5243             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5244             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5245             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5246
  5247         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5248         16  FILLER                         PIC X.
  5249
  5250         16  CF-ALT-MORT-CODE               PIC X(4).
  5251         16  CF-MEMBER-CAPTION              PIC X(10).
  5252
  5253         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5254             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5255             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5256             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5257             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5258             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5259
  5260         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5261
  5262         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5263         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5264         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5265         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5266
  5267         16  CF-AH-OVERRIDE-L1              PIC X.
  5268         16  CF-AH-OVERRIDE-L2              PIC XX.
  5269         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5270         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5271
  5272         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5273         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5274
  5275         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5276         16  CF-AR-LAST-EL860-DT            PIC XX.
  5277         16  CF-MP-MONTH-END-DT             PIC XX.
  5278
  5279         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5280         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5281             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5282
  5283         16  CF-AR-MONTH-END-DT             PIC XX.
  5284
  5285         16  CF-CRDTCRD-USER                PIC X.
  5286             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5287             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5288
  5289         16  CF-CC-MONTH-END-DT             PIC XX.
  5290
  5291         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5292
  5293         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5294             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5295             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5296             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5297         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5298         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5299         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page  99
* EL050.cbl
  5300         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5301             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5302             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5303         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5304         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5305         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5306             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5307         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5308
  5309         16  CF-CL-ZIP-CODE.
  5310             20  CF-CL-ZIP-PRIME.
  5311                 24  CF-CL-ZIP-1ST          PIC X.
  5312                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5313                 24  FILLER                 PIC X(4).
  5314             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5315         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5316             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5317             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5318             20  FILLER                     PIC XXX.
  5319
  5320         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5321         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5322         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5323         16  CF-CO-OPTION-START-DATE        PIC XX.
  5324         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5325           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5326                                                      '3' '4'.
  5327           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5328           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5329           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5330           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5331           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5332           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5333
  5334         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5335
  5336         16  CF-PAYMENT-APPROVAL-LEVELS.
  5337             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5338             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5339             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5340             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5341             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5342             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5343
  5344         16  CF-END-USER-REPORTING-USER     PIC X.
  5345             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5346             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5347
  5348         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5349             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5350             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5351
  5352         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5353
  5354         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5355         16  FILLER                         PIC X.
  5356
  5357         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 100
* EL050.cbl
  5358             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5359             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5360             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5361
  5362         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5363
  5364         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5365             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5366             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5367
  5368         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5369             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5370             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5371
  5372         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5373
  5374         16  CF-CO-ACH-ID-CODE              PIC  X.
  5375             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5376             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5377             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5378         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5379         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5380         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5381         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5382         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5383         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5384         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5385         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5386         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5387                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5388         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5389                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5390
  5391         16  CF-CO-OVER-SHORT.
  5392             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5393             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5394
  5395*         16  FILLER                         PIC X(102).
  5396         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5397             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5398             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5399
  5400         16  CF-AH-APPROVAL-DAYS.
  5401             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5402             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5403             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5404             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5405
  5406         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5407
  5408         16  CF-APPROV-LEV-5.
  5409             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5410             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5411             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5412
  5413         16  FILLER                         PIC X(68).
  5414****************************************************************
  5415*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 101
* EL050.cbl
  5416****************************************************************
  5417
  5418     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5419         16  CF-PROCESSOR-NAME              PIC X(30).
  5420         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5421         16  CF-PROCESSOR-TITLE             PIC X(26).
  5422         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5423                 88  MESSAGE-YES                VALUE 'Y'.
  5424                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5425
  5426*****************************************************
  5427****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5428****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5429****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5430****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5431*****************************************************
  5432
  5433         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5434             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5435             20  CF-APPLICATION-FORCE       PIC X.
  5436             20  CF-INDIVIDUAL-APP.
  5437                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5438                     28  CF-BROWSE-APP      PIC X.
  5439                     28  CF-UPDATE-APP      PIC X.
  5440
  5441         16  CF-CURRENT-TERM-ON             PIC X(4).
  5442         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5443             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5444             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5445             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5446             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5447             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5448             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5449             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5450         16  CF-PROCESSOR-CARRIER           PIC X.
  5451             88  NO-CARRIER-SECURITY            VALUE ' '.
  5452         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5453             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5454         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5455             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5456         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5457             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5458
  5459         16  CF-PROC-SYS-ACCESS-SW.
  5460             20  CF-PROC-CREDIT-CLAIMS-SW.
  5461                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5462                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5463                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5464                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5465             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5466                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5467                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5468             20  CF-PROC-LIFE-GNRLDGR-SW.
  5469                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5470                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5471                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5472                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5473             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 102
* EL050.cbl
  5474                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5475                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5476         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5477             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5478             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5479         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5480
  5481         16  CF-APPROVAL-LEVEL                  PIC X.
  5482             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5483             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5484             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5485             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5486             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5487
  5488         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5489
  5490         16  CF-LANGUAGE-TYPE                   PIC X.
  5491             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5492             88  CF-LANG-IS-FR                      VALUE 'F'.
  5493
  5494         16  CF-CSR-IND                         PIC X.
  5495         16  FILLER                             PIC X(239).
  5496
  5497****************************************************************
  5498*             PROCESSOR/REMINDERS RECORD                       *
  5499****************************************************************
  5500
  5501     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5502         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5503             20  CF-START-REMIND-DT         PIC XX.
  5504             20  CF-END-REMIND-DT           PIC XX.
  5505             20  CF-REMINDER-TEXT           PIC X(50).
  5506         16  FILLER                         PIC X(296).
  5507
  5508
  5509****************************************************************
  5510*             STATE MASTER RECORD                              *
  5511****************************************************************
  5512
  5513     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5514         16  CF-STATE-ABBREVIATION          PIC XX.
  5515         16  CF-STATE-NAME                  PIC X(25).
  5516         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5517         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5518             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5519             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5520             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5521             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5522                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5523                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5524             20  CF-ST-PREM-REJECT-SW       PIC X.
  5525                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5526                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5527             20  CF-ST-REF-REJECT-SW        PIC X.
  5528                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5529                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5530         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5531         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 103
* EL050.cbl
  5532         16  CF-ST-REFUND-RULES.
  5533             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5534             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5535             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5536         16  CF-ST-FST-PMT-EXTENSION.
  5537             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5538             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5539                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5540                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5541                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5542                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5543         16  CF-ST-STATE-CALL.
  5544             20  CF-ST-CALL-UNEARNED        PIC X.
  5545             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5546             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5547         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5548             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5549             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5550         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5551         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5552         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5553         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5554         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5555         16  FILLER                         PIC X.
  5556         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5557             20  CF-ST-BENEFIT-CD           PIC XX.
  5558             20  CF-ST-BENEFIT-KIND         PIC X.
  5559                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5560                 88  CF-ST-AH-KIND              VALUE 'A'.
  5561             20  CF-ST-REM-TERM-CALC        PIC X.
  5562                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5563                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5564                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5565                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5566                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5567                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5568                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5569                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5570
  5571             20  CF-ST-REFUND-CALC          PIC X.
  5572                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5573                 88  ST-REFD-BY-R78             VALUE '1'.
  5574                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5575                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5576                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5577                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5578                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5579                 88  ST-REFD-UTAH               VALUE '7'.
  5580                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5581                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5582                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5583
  5584             20  CF-ST-EARNING-CALC         PIC X.
  5585                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5586                 88  ST-EARN-BY-R78             VALUE '1'.
  5587                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5588                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5589                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 104
* EL050.cbl
  5590                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5591                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5592                 88  ST-EARN-MEAN               VALUE '8'.
  5593                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5594
  5595             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5596                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5597                 88  ST-OVRD-BY-R78             VALUE '1'.
  5598                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5599                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5600                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5601                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5602                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5603                 88  ST-OVRD-MEAN               VALUE '8'.
  5604                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5605             20  FILLER                     PIC X.
  5606
  5607         16  CF-ST-COMMISSION-CAPS.
  5608             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5609             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5610             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5611             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5612         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5613                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5614
  5615         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5616
  5617         16  CF-ST-STATUTORY-INTEREST.
  5618             20  CF-ST-STAT-DATE-FROM       PIC X.
  5619                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5620                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5621             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5622             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5623             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5624             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5625             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5626
  5627         16  CF-ST-OVER-SHORT.
  5628             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5629             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5630
  5631         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5632
  5633         16  CF-ST-RT-CALC                  PIC X.
  5634
  5635         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5636         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5637         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5638         16  CF-ST-RF-LR-CALC               PIC X.
  5639         16  CF-ST-RF-LL-CALC               PIC X.
  5640         16  CF-ST-RF-LN-CALC               PIC X.
  5641         16  CF-ST-RF-AH-CALC               PIC X.
  5642         16  CF-ST-RF-CP-CALC               PIC X.
  5643*        16  FILLER                         PIC X(206).
  5644*CIDMOD         16  FILLER                         PIC X(192).
  5645         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5646             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5647         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 105
* EL050.cbl
  5648         16  CF-ST-VFY-2ND-BENE             PIC X.
  5649         16  CF-ST-CAUSAL-STATE             PIC X.
  5650         16  FILLER                         PIC X(185).
  5651
  5652****************************************************************
  5653*             BENEFIT MASTER RECORD                            *
  5654****************************************************************
  5655
  5656     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5657         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5658             20  CF-BENEFIT-CODE            PIC XX.
  5659             20  CF-BENEFIT-NUMERIC  REDEFINES
  5660                 CF-BENEFIT-CODE            PIC XX.
  5661             20  CF-BENEFIT-ALPHA           PIC XXX.
  5662             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5663             20  CF-BENEFIT-COMMENT         PIC X(10).
  5664
  5665             20  CF-LF-COVERAGE-TYPE        PIC X.
  5666                 88  CF-REDUCING                VALUE 'R'.
  5667                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5668
  5669             20  CF-SPECIAL-CALC-CD         PIC X.
  5670                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5671                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5672                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5673                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5674                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5675                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5676                 88  CF-FARM-PLAN               VALUE 'F'.
  5677                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5678                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5679                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5680                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5681                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5682                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5683                 88  CF-PRUDENTIAL              VALUE 'P'.
  5684                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5685                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5686                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5687                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5688                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5689                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5690
  5691             20  CF-JOINT-INDICATOR         PIC X.
  5692                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5693
  5694*            20  FILLER                     PIC X(12).
  5695             20  cf-maximum-benefits        pic s999 comp-3.
  5696             20  FILLER                     PIC X(09).
  5697             20  CF-BENEFIT-CATEGORY        PIC X.
  5698             20  CF-LOAN-TYPE               PIC X(8).
  5699
  5700             20  CF-CO-REM-TERM-CALC        PIC X.
  5701                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5702                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5703                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5704                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5705                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 106
* EL050.cbl
  5706
  5707             20  CF-CO-EARNINGS-CALC        PIC X.
  5708                 88  CO-EARN-BY-R78             VALUE '1'.
  5709                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5710                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5711                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5712                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5713                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5714                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5715                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5716
  5717             20  CF-CO-REFUND-CALC          PIC X.
  5718                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5719                 88  CO-REFD-BY-R78             VALUE '1'.
  5720                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5721                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5722                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5723                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5724                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5725                 88  CO-REFD-MEAN               VALUE '8'.
  5726                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5727                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5728                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5729
  5730             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5731                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5732                 88  CO-OVRD-BY-R78             VALUE '1'.
  5733                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5734                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5735                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5736                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5737                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5738                 88  CO-OVRD-MEAN               VALUE '8'.
  5739                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5740
  5741             20  CF-CO-BEN-I-G-CD           PIC X.
  5742                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5743                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5744                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5745
  5746         16  FILLER                         PIC X(304).
  5747
  5748
  5749****************************************************************
  5750*             CARRIER MASTER RECORD                            *
  5751****************************************************************
  5752
  5753     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5754         16  CF-ADDRESS-DATA.
  5755             20  CF-MAIL-TO-NAME            PIC X(30).
  5756             20  CF-IN-CARE-OF              PIC X(30).
  5757             20  CF-ADDRESS-LINE-1          PIC X(30).
  5758             20  CF-ADDRESS-LINE-2          PIC X(30).
  5759             20  CF-CITY-STATE              PIC X(30).
  5760             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5761             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5762
  5763         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 107
* EL050.cbl
  5764             20  CF-CLAIM-NO-METHOD         PIC X.
  5765                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5766                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5767                 88  CLAIM-NO-SEQ               VALUE '3'.
  5768                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5769             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5770                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5771                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5772                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5773
  5774         16  CF-CHECK-NO-CONTROL.
  5775             20  CF-CHECK-NO-METHOD         PIC X.
  5776                 88  CHECK-NO-MANUAL            VALUE '1'.
  5777                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5778                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5779                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5780             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5781                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5782
  5783         16  CF-DOMICILE-STATE              PIC XX.
  5784
  5785         16  CF-EXPENSE-CONTROLS.
  5786             20  CF-EXPENSE-METHOD          PIC X.
  5787                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5788                 88  DOLLARS-PER-PMT            VALUE '2'.
  5789                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5790                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5791             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5792             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5793
  5794         16  CF-CORRESPONDENCE-CONTROL.
  5795             20  CF-LETTER-RESEND-OPT       PIC X.
  5796                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5797                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5798             20  FILLER                     PIC X(4).
  5799
  5800         16  CF-RESERVE-CONTROLS.
  5801             20  CF-MANUAL-SW               PIC X.
  5802                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5803             20  CF-FUTURE-SW               PIC X.
  5804                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5805             20  CF-PTC-SW                  PIC X.
  5806                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5807             20  CF-IBNR-SW                 PIC X.
  5808                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5809             20  CF-PTC-LF-SW               PIC X.
  5810                 88  CF-LF-PTC-USED             VALUE '1'.
  5811             20  CF-CDT-ACCESS-METHOD       PIC X.
  5812                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5813                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5814                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5815             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5816
  5817         16  CF-CLAIM-CALC-METHOD           PIC X.
  5818             88  360-PLUS-MONTHS                VALUE '1'.
  5819             88  365-PLUS-MONTHS                VALUE '2'.
  5820             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5821             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 108
* EL050.cbl
  5822             88  365-DAILY                      VALUE '5'.
  5823
  5824         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5825         16  FILLER                         PIC X(11).
  5826
  5827         16  CF-LIMIT-AMOUNTS.
  5828             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5829             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5830             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5831             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5832             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5833             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5834             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5835             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5836             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5837             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5838
  5839         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5840         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5841         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5842
  5843         16  CF-ZIP-CODE.
  5844             20  CF-ZIP-PRIME.
  5845                 24  CF-ZIP-1ST             PIC X.
  5846                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5847                 24  FILLER                 PIC X(4).
  5848             20  CF-ZIP-PLUS4               PIC X(4).
  5849         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5850             20  CF-CAN-POSTAL-1            PIC XXX.
  5851             20  CF-CAN-POSTAL-2            PIC XXX.
  5852             20  FILLER                     PIC XXX.
  5853
  5854         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5855         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5856         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5857
  5858         16  CF-RATING-SWITCH               PIC X.
  5859             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5860             88  CF-NO-RATING                   VALUE 'N'.
  5861
  5862         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5863
  5864         16  CF-CARRIER-OVER-SHORT.
  5865             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5866             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5867
  5868         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5869         16  CF-SECPAY-SWITCH               PIC X.
  5870             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5871             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5872         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5873         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5874         16  FILLER                         PIC X(444).
  5875*        16  FILLER                         PIC X(452).
  5876
  5877
  5878****************************************************************
  5879*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 109
* EL050.cbl
  5880****************************************************************
  5881
  5882     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5883         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5884                                INDEXED BY CF-MORT-NDX.
  5885             20  CF-MORT-TABLE              PIC X(5).
  5886             20  CF-MORT-TABLE-TYPE         PIC X.
  5887                 88  CF-MORT-JOINT              VALUE 'J'.
  5888                 88  CF-MORT-SINGLE             VALUE 'S'.
  5889                 88  CF-MORT-COMBINED           VALUE 'C'.
  5890                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5891                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5892             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5893             20  CF-MORT-AGE-METHOD         PIC XX.
  5894                 88  CF-AGE-LAST                VALUE 'AL'.
  5895                 88  CF-AGE-NEAR                VALUE 'AN'.
  5896             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5897             20  CF-MORT-ADJUSTMENT-DIRECTION
  5898                                            PIC X.
  5899                 88  CF-MINUS                   VALUE '-'.
  5900                 88  CF-PLUS                    VALUE '+'.
  5901             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5902             20  CF-MORT-JOINT-CODE         PIC X.
  5903                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5904             20  CF-MORT-PC-Q               PIC X.
  5905                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5906             20  CF-MORT-TABLE-CODE         PIC X(4).
  5907             20  CF-MORT-COMMENTS           PIC X(15).
  5908             20  FILLER                     PIC X(14).
  5909
  5910         16  FILLER                         PIC X(251).
  5911
  5912
  5913****************************************************************
  5914*             BUSSINESS TYPE MASTER RECORD                     *
  5915****************************************************************
  5916
  5917     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5918* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5919* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5920* AND RECORD 05 IS TYPES 81-99
  5921         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5922             20  CF-BUSINESS-TITLE          PIC  X(19).
  5923             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5924                                            PIC S9V9(4) COMP-3.
  5925             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5926             20  FILLER                     PIC  X.
  5927         16  FILLER                         PIC  X(248).
  5928
  5929
  5930****************************************************************
  5931*             TERMINAL MASTER RECORD                           *
  5932****************************************************************
  5933
  5934     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5935
  5936         16  CF-COMPANY-TERMINALS.
  5937             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 110
* EL050.cbl
  5938                                  PIC X(4).
  5939         16  FILLER               PIC X(248).
  5940
  5941
  5942****************************************************************
  5943*             LIFE EDIT MASTER RECORD                          *
  5944****************************************************************
  5945
  5946     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5947         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5948             20  CF-LIFE-CODE-IN            PIC XX.
  5949             20  CF-LIFE-CODE-OUT           PIC XX.
  5950         16  FILLER                         PIC X(248).
  5951
  5952
  5953****************************************************************
  5954*             AH EDIT MASTER RECORD                            *
  5955****************************************************************
  5956
  5957     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5958         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5959             20  CF-AH-CODE-IN              PIC XXX.
  5960             20  CF-AH-CODE-OUT             PIC XX.
  5961         16  FILLER                         PIC X(248).
  5962
  5963
  5964****************************************************************
  5965*             CREDIBILITY TABLES                               *
  5966****************************************************************
  5967
  5968     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5969         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5970                             INDEXED BY CF-CRDB-NDX.
  5971             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5972             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5973             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5974         16  FILLER                         PIC  X(332).
  5975
  5976
  5977****************************************************************
  5978*             REPORT CUSTOMIZATION RECORD                      *
  5979****************************************************************
  5980
  5981     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5982         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5983             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5984             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5985             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5986**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5987****       A T-TRANSFER.                                   ****
  5988             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5989
  5990         16  FILLER                         PIC XX.
  5991
  5992         16  CF-CARRIER-CNTL-OPT.
  5993             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5994                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5995                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 111
* EL050.cbl
  5996             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5997                                            PIC X.
  5998         16  CF-GROUP-CNTL-OPT.
  5999             20  CF-GROUP-OPT-SEQ           PIC 9.
  6000                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6001                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6002             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6003                                            PIC X(6).
  6004         16  CF-STATE-CNTL-OPT.
  6005             20  CF-STATE-OPT-SEQ           PIC 9.
  6006                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6007                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6008             20  CF-STATE-SELECT OCCURS 3 TIMES
  6009                                            PIC XX.
  6010         16  CF-ACCOUNT-CNTL-OPT.
  6011             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6012                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6013                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6014             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6015                                            PIC X(10).
  6016         16  CF-BUS-TYP-CNTL-OPT.
  6017             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6018                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6019                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6020             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6021                                            PIC XX.
  6022         16  CF-LF-TYP-CNTL-OPT.
  6023             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6024                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6025                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6026             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6027                                            PIC XX.
  6028         16  CF-AH-TYP-CNTL-OPT.
  6029             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6030                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6031                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6032             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6033                                            PIC XX.
  6034         16  CF-REPTCD1-CNTL-OPT.
  6035             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6036                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6037                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6038             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6039                                            PIC X(10).
  6040         16  CF-REPTCD2-CNTL-OPT.
  6041             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6042                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6043                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6044             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6045                                            PIC X(10).
  6046         16  CF-USER1-CNTL-OPT.
  6047             20  CF-USER1-OPT-SEQ           PIC 9.
  6048                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6049                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6050             20  CF-USER1-SELECT OCCURS 3 TIMES
  6051                                            PIC X(10).
  6052         16  CF-USER2-CNTL-OPT.
  6053             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 112
* EL050.cbl
  6054                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6055                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6056             20  CF-USER2-SELECT OCCURS 3 TIMES
  6057                                            PIC X(10).
  6058         16  CF-USER3-CNTL-OPT.
  6059             20  CF-USER3-OPT-SEQ           PIC 9.
  6060                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6061                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6062             20  CF-USER3-SELECT OCCURS 3 TIMES
  6063                                            PIC X(10).
  6064         16  CF-USER4-CNTL-OPT.
  6065             20  CF-USER4-OPT-SEQ           PIC 9.
  6066                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6067                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6068             20  CF-USER4-SELECT OCCURS 3 TIMES
  6069                                            PIC X(10).
  6070         16  CF-USER5-CNTL-OPT.
  6071             20  CF-USER5-OPT-SEQ           PIC 9.
  6072                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6073                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6074             20  CF-USER5-SELECT OCCURS 3 TIMES
  6075                                            PIC X(10).
  6076         16  CF-REINS-CNTL-OPT.
  6077             20  CF-REINS-OPT-SEQ           PIC 9.
  6078                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6079                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6080             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6081                 24  CF-REINS-PRIME         PIC XXX.
  6082                 24  CF-REINS-SUB           PIC XXX.
  6083
  6084         16  CF-AGENT-CNTL-OPT.
  6085             20  CF-AGENT-OPT-SEQ           PIC 9.
  6086                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6087                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6088             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6089                                            PIC X(10).
  6090
  6091         16  FILLER                         PIC X(43).
  6092
  6093         16  CF-LOSS-RATIO-SELECT.
  6094             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6095             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6096         16  CF-ENTRY-DATE-SELECT.
  6097             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6098             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6099         16  CF-EFFECTIVE-DATE-SELECT.
  6100             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6101             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6102
  6103         16  CF-EXCEPTION-LIST-IND          PIC X.
  6104             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6105
  6106         16  FILLER                         PIC X(318).
  6107
  6108****************************************************************
  6109*                  EXCEPTION REPORTING RECORD                  *
  6110****************************************************************
  6111
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 113
* EL050.cbl
  6112     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6113         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6114             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6115
  6116         16  CF-COMBINED-LIFE-AH-OPT.
  6117             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6118             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6119             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6120             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6121
  6122         16  CF-LIFE-OPT.
  6123             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6124             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6125             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6126             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6127             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6128             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6129             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6130             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6131             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6132             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6133
  6134         16  CF-AH-OPT.
  6135             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6136             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6137             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6138             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6139             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6140             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6141             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6142             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6143             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6144             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6145
  6146         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6147             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6148             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6149             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6150
  6151         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6152
  6153         16  FILLER                         PIC X(673).
  6154
  6155
  6156****************************************************************
  6157*             MORTGAGE SYSTEM PLAN RECORD                      *
  6158****************************************************************
  6159
  6160     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6161         16  CF-PLAN-TYPE                   PIC X.
  6162             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6163             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6164             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6165         16  CF-PLAN-ABBREV                 PIC XXX.
  6166         16  CF-PLAN-DESCRIPT               PIC X(10).
  6167         16  CF-PLAN-NOTES                  PIC X(20).
  6168         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6169         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 114
* EL050.cbl
  6170             20  CF-PLAN-TERM-DATA.
  6171                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6172                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6173             20  CF-PLAN-AGE-DATA.
  6174                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6175                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6176                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6177             20  CF-PLAN-BENEFIT-DATA.
  6178                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6179                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6180                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6181                                            PIC S9(7)V99  COMP-3.
  6182         16  CF-PLAN-POLICY-FORMS.
  6183             20  CF-POLICY-FORM             PIC X(12).
  6184             20  CF-MASTER-APPLICATION      PIC X(12).
  6185             20  CF-MASTER-POLICY           PIC X(12).
  6186         16  CF-PLAN-RATING.
  6187             20  CF-RATE-CODE               PIC X(5).
  6188             20  CF-SEX-RATING              PIC X.
  6189                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6190                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6191             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6192             20  CF-SUB-STD-TYPE            PIC X.
  6193                 88  CF-PCT-OF-PREM            VALUE '1'.
  6194                 88  CF-PCT-OF-BENE            VALUE '2'.
  6195         16  CF-PLAN-PREM-TOLERANCES.
  6196             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6197             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6198         16  CF-PLAN-PYMT-TOLERANCES.
  6199             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6200             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6201         16  CF-PLAN-MISC-DATA.
  6202             20  FILLER                     PIC X.
  6203             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6204             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6205         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6206         16  CF-PLAN-IND-GRP                PIC X.
  6207             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6208                                                     '1'.
  6209             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6210                                                     '2'.
  6211         16  CF-MIB-SEARCH-SW               PIC X.
  6212             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6213             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6214             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6215             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6216         16  CF-ALPHA-SEARCH-SW             PIC X.
  6217             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6218             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6219             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6220             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6221             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6222             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6223             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6224             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6225             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6226             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6227                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 115
* EL050.cbl
  6228                                                     'X' 'Y' 'Z'.
  6229         16  CF-EFF-DT-RULE-SW              PIC X.
  6230             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6231             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6232             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6233             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6234             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6235         16  FILLER                         PIC X(4).
  6236         16  CF-HEALTH-QUESTIONS            PIC X.
  6237             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6238         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6239         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6240         16  CF-PLAN-SNGL-JNT               PIC X.
  6241             88  CF-COMBINED-PLAN              VALUE 'C'.
  6242             88  CF-JNT-PLAN                   VALUE 'J'.
  6243             88  CF-SNGL-PLAN                  VALUE 'S'.
  6244         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6245         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6246         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6247         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6248         16  CF-RERATE-CNTL                 PIC  X.
  6249             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6250             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6251             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6252             88  CF-AUTO-RECALC                 VALUE '4'.
  6253         16  CF-BENEFIT-TYPE                PIC  X.
  6254             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6255             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6256         16  CF-POLICY-FEE                  PIC S999V99
  6257                                                    COMP-3.
  6258         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6259         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6260         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6261         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6262         16  FILLER                         PIC  X(32).
  6263         16  CF-TERMINATION-FORM            PIC  X(04).
  6264         16  FILLER                         PIC  X(08).
  6265         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6266                                                       COMP-3.
  6267         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6268         16  CF-ISSUE-LETTER                PIC  X(4).
  6269         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6270         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6271             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6272             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6273         16  CF-MP-REFUND-CALC              PIC X.
  6274             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6275             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6276             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6277             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6278             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6279             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6280             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6281             88  CF-MP-REFD-MEAN                VALUE '8'.
  6282         16  CF-ALT-RATE-CODE               PIC  X(5).
  6283
  6284
  6285         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 116
* EL050.cbl
  6286****************************************************************
  6287*             MORTGAGE COMPANY MASTER RECORD                   *
  6288****************************************************************
  6289
  6290     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6291         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6292         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6293             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6294             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6295             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6296             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6297             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6298
  6299         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6300         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6301         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6302         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6303         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6304
  6305         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6306             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6307         16  CF-MP-RECON-USE-IND            PIC X(1).
  6308             88  CF-MP-USE-RECON             VALUE 'Y'.
  6309         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6310             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6311         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6312             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6313             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6314         16  FILLER                         PIC X(1).
  6315         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6316             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6317         16  CF-MORTG-MIB-VERSION           PIC X.
  6318             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6319             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6320             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6321         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6322             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6323                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6324             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6325                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6326             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6327                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6328             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6329                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6330             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6331                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6332             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6333                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6334         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6335         16  FILLER                         PIC X(7).
  6336         16  CF-MORTG-DESTINATION-SYMBOL.
  6337             20  CF-MORTG-MIB-COMM          PIC X(5).
  6338             20  CF-MORTG-MIB-TERM          PIC X(5).
  6339         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6340             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6341         16  FILLER                         PIC X(03).
  6342         16  CF-MP-CHECK-NO-CONTROL.
  6343             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 117
* EL050.cbl
  6344                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6345                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6346                                                ' ' LOW-VALUES.
  6347                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6348                                               VALUE '3'.
  6349         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6350         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6351         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6352             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6353                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6354             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6355                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6356             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6357                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6358             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6359                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6360             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6361                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6362             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6363                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6364         16  CF-MORTG-BILLING-AREA.
  6365             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6366                                            PIC X.
  6367         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6368         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6369         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6370         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6371             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6372             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6373         16  FILLER                         PIC X.
  6374         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6375             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6376             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6377         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6378         16  FILLER                         PIC X(8).
  6379         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6380         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6381         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6382         16  CF-ACH-COMPANY-ID.
  6383             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6384                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6385                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6386                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6387             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6388         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6389             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6390         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6391             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6392             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6393         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6394         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6395         16  FILLER                         PIC X(536).
  6396
  6397****************************************************************
  6398*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6399****************************************************************
  6400
  6401     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 118
* EL050.cbl
  6402         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6403             20  CF-FEMALE-HEIGHT.
  6404                 24  CF-FEMALE-FT           PIC 99.
  6405                 24  CF-FEMALE-IN           PIC 99.
  6406             20  CF-FEMALE-MIN-WT           PIC 999.
  6407             20  CF-FEMALE-MAX-WT           PIC 999.
  6408         16  FILLER                         PIC X(428).
  6409
  6410     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6411         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6412             20  CF-MALE-HEIGHT.
  6413                 24  CF-MALE-FT             PIC 99.
  6414                 24  CF-MALE-IN             PIC 99.
  6415             20  CF-MALE-MIN-WT             PIC 999.
  6416             20  CF-MALE-MAX-WT             PIC 999.
  6417         16  FILLER                         PIC X(428).
  6418******************************************************************
  6419*             AUTOMATIC ACTIVITY RECORD                          *
  6420******************************************************************
  6421     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6422         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6423             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6424             20  CF-SYS-LETTER-ID           PIC X(04).
  6425             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6426             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6427             20  CF-SYS-RESET-SW            PIC X(01).
  6428             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6429             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6430
  6431         16  FILLER                         PIC X(50).
  6432
  6433         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6434             20  CF-USER-ACTIVE-SW          PIC X(01).
  6435             20  CF-USER-LETTER-ID          PIC X(04).
  6436             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6437             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6438             20  CF-USER-RESET-SW           PIC X(01).
  6439             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6440             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6441             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6442
  6443         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 119
* EL050.cbl
  6445*    COPY ERCACCT.
  6446******************************************************************
  6447*                                                                *
  6448*                                                                *
  6449*                            ERCACCT                             *
  6450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6451*                            VMOD=2.031                          *
  6452*                                                                *
  6453*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6454*                                                                *
  6455*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6456*   VSAM ACCOUNT MASTER FILES.                                   *
  6457*                                                                *
  6458*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6459*                                                                *
  6460*   FILE TYPE = VSAM,KSDS                                        *
  6461*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6462*                                                                *
  6463*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6464*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6465*                                                                *
  6466*   LOG = NO                                                     *
  6467*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6468*                                                                *
  6469*                                                                *
  6470******************************************************************
  6471*                   C H A N G E   L O G
  6472*
  6473* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6474*-----------------------------------------------------------------
  6475*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6476* EFFECTIVE    NUMBER
  6477*-----------------------------------------------------------------
  6478* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6479* 092705    2005050300006  PEMA  ADD SPP LEASES
  6480* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6481* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6482* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6483* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6484* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6485******************************************************************
  6486
  6487 01  ACCOUNT-MASTER.
  6488     12  AM-RECORD-ID                      PIC XX.
  6489         88  VALID-AM-ID                      VALUE 'AM'.
  6490
  6491     12  AM-CONTROL-PRIMARY.
  6492         16  AM-COMPANY-CD                 PIC X.
  6493         16  AM-MSTR-CNTRL.
  6494             20  AM-CONTROL-A.
  6495                 24  AM-CARRIER            PIC X.
  6496                 24  AM-GROUPING.
  6497                     28 AM-GROUPING-PREFIX PIC XXX.
  6498                     28 AM-GROUPING-PRIME  PIC XXX.
  6499                 24  AM-STATE              PIC XX.
  6500                 24  AM-ACCOUNT.
  6501                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6502                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 120
* EL050.cbl
  6503             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6504                                           PIC X(19).
  6505             20  AM-CNTRL-B.
  6506                 24  AM-EXPIRATION-DT      PIC XX.
  6507                 24  FILLER                PIC X(4).
  6508             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6509                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6510
  6511     12  AM-CONTROL-BY-VAR-GRP.
  6512         16  AM-COMPANY-CD-A1              PIC X.
  6513         16  AM-VG-CARRIER                 PIC X.
  6514         16  AM-VG-GROUPING                PIC X(6).
  6515         16  AM-VG-STATE                   PIC XX.
  6516         16  AM-VG-ACCOUNT                 PIC X(10).
  6517         16  AM-VG-DATE.
  6518             20  AM-VG-EXPIRATION-DT       PIC XX.
  6519             20  FILLER                    PIC X(4).
  6520         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6521                                           PIC 9(11)      COMP-3.
  6522     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6523         16  FILLER                        PIC X(10).
  6524         16  AM-VG-KEY3.
  6525             20  AM-VG3-ACCOUNT            PIC X(10).
  6526             20  AM-VG3-EXP-DT             PIC XX.
  6527         16  FILLER                        PIC X(4).
  6528     12  AM-MAINT-INFORMATION.
  6529         16  AM-LAST-MAINT-DT              PIC XX.
  6530         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6531         16  AM-LAST-MAINT-USER            PIC X(4).
  6532         16  FILLER                        PIC XX.
  6533
  6534     12  AM-EFFECTIVE-DT                   PIC XX.
  6535     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6536
  6537     12  AM-PREV-DATES  COMP-3.
  6538         16  AM-PREV-EXP-DT                PIC 9(11).
  6539         16  AM-PREV-EFF-DT                PIC 9(11).
  6540
  6541     12  AM-REPORT-CODE-1                  PIC X(10).
  6542     12  AM-REPORT-CODE-2                  PIC X(10).
  6543
  6544     12  AM-CITY-CODE                      PIC X(4).
  6545     12  AM-COUNTY-PARISH                  PIC X(6).
  6546
  6547     12  AM-NAME                           PIC X(30).
  6548     12  AM-PERSON                         PIC X(30).
  6549     12  AM-ADDRS                          PIC X(30).
  6550     12  AM-CITY.
  6551         16  AM-ADDR-CITY                  PIC X(28).
  6552         16  AM-ADDR-STATE                 PIC XX.
  6553     12  AM-ZIP.
  6554         16  AM-ZIP-PRIME.
  6555             20  AM-ZIP-PRI-1ST            PIC X.
  6556                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6557             20  FILLER                    PIC X(4).
  6558         16  AM-ZIP-PLUS4                  PIC X(4).
  6559     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6560         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 121
* EL050.cbl
  6561         16  AM-CAN-POSTAL-2               PIC XXX.
  6562         16  FILLER                        PIC XXX.
  6563     12  AM-TEL-NO.
  6564         16  AM-AREA-CODE                  PIC 999.
  6565         16  AM-TEL-PRE                    PIC 999.
  6566         16  AM-TEL-NBR                    PIC 9(4).
  6567     12  AM-TEL-LOC                        PIC X.
  6568         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6569         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6570
  6571     12  AM-COMM-STRUCTURE.
  6572         16  AM-DEFN-1.
  6573             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6574                 24  AM-AGT.
  6575                     28  AM-AGT-PREFIX     PIC X(4).
  6576                     28  AM-AGT-PRIME      PIC X(6).
  6577                 24  AM-COM-TYP            PIC X.
  6578                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6579                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6580                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6581                 24  AM-RECALC-LV-INDIC    PIC X.
  6582                 24  AM-RETRO-LV-INDIC     PIC X.
  6583                 24  AM-GL-CODES           PIC X.
  6584                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6585                 24  FILLER                PIC X(01).
  6586         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6587             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6588                 24  FILLER                PIC X(11).
  6589                 24  AM-L-COMA             PIC XXX.
  6590                 24  AM-J-COMA             PIC XXX.
  6591                 24  AM-A-COMA             PIC XXX.
  6592                 24  FILLER                PIC X(6).
  6593
  6594     12  AM-COMM-CHANGE-STATUS             PIC X.
  6595         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6596
  6597     12  AM-CSR-CODE                       PIC X(4).
  6598
  6599     12  AM-BILLING-STATUS                 PIC X.
  6600         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6601         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6602     12  AM-AUTO-REFUND-SW                 PIC X.
  6603         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6604         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6605     12  AM-GPCD                           PIC 99.
  6606     12  AM-IG                             PIC X.
  6607         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6608         88  AM-HAS-GROUP                     VALUE '2'.
  6609     12  AM-STATUS                         PIC X.
  6610         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6611         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6612         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6613         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6614         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6615         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6616     12  AM-REMIT-TO                       PIC 99.
  6617     12  AM-ID-NO                          PIC X(11).
  6618
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 122
* EL050.cbl
  6619     12  AM-CAL-TABLE                      PIC XX.
  6620     12  AM-LF-DEVIATION                   PIC XXX.
  6621     12  AM-AH-DEVIATION                   PIC XXX.
  6622     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6623     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6624     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6625     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6626     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6627     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6628
  6629     12  AM-USER-FIELDS.
  6630         16  AM-FLD-1                      PIC XX.
  6631         16  AM-FLD-2                      PIC XX.
  6632         16  AM-FLD-3                      PIC XX.
  6633         16  AM-FLD-4                      PIC XX.
  6634         16  AM-FLD-5                      PIC XX.
  6635
  6636     12  AM-1ST-PROD-DATE.
  6637         16  AM-1ST-PROD-YR                PIC XX.
  6638         16  AM-1ST-PROD-MO                PIC XX.
  6639         16  AM-1ST-PROD-DA                PIC XX.
  6640     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6641     12  AM-CERTS-PURGED-DATE.
  6642         16  AM-PUR-YR                     PIC XX.
  6643         16  AM-PUR-MO                     PIC XX.
  6644         16  AM-PUR-DA                     PIC XX.
  6645     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6646     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6647     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6648     12  AM-INACTIVE-DATE.
  6649         16  AM-INA-MO                     PIC 99.
  6650         16  AM-INA-DA                     PIC 99.
  6651         16  AM-INA-YR                     PIC 99.
  6652     12  AM-AR-HI-CERT-DATE                PIC XX.
  6653
  6654     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6655     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6656
  6657     12  AM-OB-PAYMENT-MODE                PIC X.
  6658         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6659         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6660         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6661         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6662
  6663     12  AM-AH-ONLY-INDICATOR              PIC X.
  6664         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6665         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6666
  6667     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6668
  6669     12  AM-OVER-SHORT.
  6670         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6671         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6672
  6673     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6674     12  AM-DCC-CLP-STATE                  PIC XX.
  6675
  6676     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 123
* EL050.cbl
  6677     12  AM-RECALC-REIN                    PIC X.
  6678
  6679     12  AM-REI-TABLE                      PIC XXX.
  6680     12  AM-REI-ET-LF                      PIC X.
  6681     12  AM-REI-ET-AH                      PIC X.
  6682     12  AM-REI-PE-LF                      PIC X.
  6683     12  AM-REI-PE-AH                      PIC X.
  6684     12  AM-REI-PRT-ST                     PIC X.
  6685     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6686     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6687     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6688     12  AM-REI-GROUP-A                    PIC X(6).
  6689     12  AM-REI-MORT                       PIC X(4).
  6690     12  AM-REI-PRT-OW                     PIC X.
  6691     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6692     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6693     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6694     12  AM-REI-GROUP-B                    PIC X(6).
  6695
  6696     12  AM-TRUST-TYPE                     PIC X(2).
  6697
  6698     12  AM-EMPLOYER-STMT-USED             PIC X.
  6699     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6700
  6701     12  AM-STD-AH-TYPE                    PIC XX.
  6702     12  AM-EARN-METHODS.
  6703         16  AM-EARN-METHOD-R              PIC X.
  6704             88 AM-REF-RL-R78                 VALUE 'R'.
  6705             88 AM-REF-RL-PR                  VALUE 'P'.
  6706             88 AM-REF-RL-MEAN                VALUE 'M'.
  6707             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6708         16  AM-EARN-METHOD-L              PIC X.
  6709             88 AM-REF-LL-R78                 VALUE 'R'.
  6710             88 AM-REF-LL-PR                  VALUE 'P'.
  6711             88 AM-REF-LL-MEAN                VALUE 'M'.
  6712             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6713         16  AM-EARN-METHOD-A              PIC X.
  6714             88 AM-REF-AH-R78                 VALUE 'R'.
  6715             88 AM-REF-AH-PR                  VALUE 'P'.
  6716             88 AM-REF-AH-MEAN                VALUE 'M'.
  6717             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6718             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6719             88 AM-REF-AH-NET                 VALUE 'N'.
  6720
  6721     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6722     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6723     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6724
  6725     12  AM-RET-Y-N                        PIC X.
  6726     12  AM-RET-P-E                        PIC X.
  6727     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6728     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6729     12  AM-RET-GRP                        PIC X(6).
  6730     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6731         16  AM-POOL-PRIME                 PIC XXX.
  6732         16  AM-POOL-SUB                   PIC XXX.
  6733     12  AM-RETRO-EARNINGS.
  6734         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 124
* EL050.cbl
  6735         16  AM-RET-EARN-L                 PIC X.
  6736         16  AM-RET-EARN-A                 PIC X.
  6737     12  AM-RET-ST-TAX-USE                 PIC X.
  6738         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6739         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6740     12  AM-RETRO-BEG-EARNINGS.
  6741         16  AM-RET-BEG-EARN-R             PIC X.
  6742         16  AM-RET-BEG-EARN-L             PIC X.
  6743         16  AM-RET-BEG-EARN-A             PIC X.
  6744     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6745     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6746
  6747     12  AM-USER-SELECT-OPTIONS.
  6748         16  AM-USER-SELECT-1              PIC X(10).
  6749         16  AM-USER-SELECT-2              PIC X(10).
  6750         16  AM-USER-SELECT-3              PIC X(10).
  6751         16  AM-USER-SELECT-4              PIC X(10).
  6752         16  AM-USER-SELECT-5              PIC X(10).
  6753
  6754     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6755
  6756     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6757
  6758     12  AM-RPT045A-SWITCH                 PIC X.
  6759         88  RPT045A-OFF                   VALUE 'N'.
  6760
  6761     12  AM-INSURANCE-LIMITS.
  6762         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6763         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6764
  6765     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6766         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6767
  6768     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6769         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6770         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6771
  6772     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6773
  6774     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6775     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6776     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6777     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6778     12  AM-DCC-UEF-STATE                  PIC XX.
  6779     12  FILLER                            PIC XXX.
  6780     12  AM-REPORT-CODE-3                  PIC X(10).
  6781*    12  FILLER                            PIC X(22).
  6782
  6783     12  AM-RESERVE-DATE.
  6784         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6785         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6786         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6787
  6788     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6789     12  AM-NOTIFICATION-TYPES.
  6790         16  AM-NOTIF-OF-LETTERS           PIC X.
  6791         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6792         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 125
* EL050.cbl
  6793         16  AM-NOTIF-OF-STATUS            PIC X.
  6794
  6795     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6796         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6797         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6798         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6799         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6800
  6801     12  AM-BENEFIT-CONTROLS.
  6802         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6803             20  AM-BENEFIT-CODE           PIC XX.
  6804             20  AM-BENEFIT-TYPE           PIC X.
  6805             20  AM-BENEFIT-REVISION       PIC XXX.
  6806             20  AM-BENEFIT-REM-TERM       PIC X.
  6807             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6808             20  FILLER                    PIC XX.
  6809         16  FILLER                        PIC X(80).
  6810
  6811     12  AM-TRANSFER-DATA.
  6812         16  AM-TRANSFERRED-FROM.
  6813             20  AM-TRNFROM-CARRIER        PIC X.
  6814             20  AM-TRNFROM-GROUPING.
  6815                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6816                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6817             20  AM-TRNFROM-STATE          PIC XX.
  6818             20  AM-TRNFROM-ACCOUNT.
  6819                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6820                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6821             20  AM-TRNFROM-DTE            PIC XX.
  6822         16  AM-TRANSFERRED-TO.
  6823             20  AM-TRNTO-CARRIER          PIC X.
  6824             20  AM-TRNTO-GROUPING.
  6825                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6826                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6827             20  AM-TRNTO-STATE            PIC XX.
  6828             20  AM-TRNTO-ACCOUNT.
  6829                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6830                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6831             20  AM-TRNTO-DTE              PIC XX.
  6832         16  FILLER                        PIC X(10).
  6833
  6834     12  AM-SAVED-REMIT-TO                 PIC 99.
  6835
  6836     12  AM-COMM-STRUCTURE-SAVED.
  6837         16  AM-DEFN-1-SAVED.
  6838             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6839                 24  AM-AGT-SV             PIC X(10).
  6840                 24  AM-COM-TYP-SV         PIC X.
  6841                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6842                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6843                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6844                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6845                 24  FILLER                PIC X.
  6846                 24  AM-GL-CODES-SV        PIC X.
  6847                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6848                 24  FILLER                PIC X.
  6849         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6850             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 126
* EL050.cbl
  6851                 24  FILLER                PIC X(11).
  6852                 24  AM-L-COMA-SV          PIC XXX.
  6853                 24  AM-J-COMA-SV          PIC XXX.
  6854                 24  AM-A-COMA-SV          PIC XXX.
  6855                 24  FILLER                PIC X(6).
  6856
  6857     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6858         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6859            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6860            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6861            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6862
  6863     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6864     12  FILLER                            PIC X(120).
  6865
  6866     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6867         16  AM-CONTROL-NAME               PIC X(30).
  6868         16  AM-EXECUTIVE-ONE.
  6869             20  AM-EXEC1-NAME             PIC X(15).
  6870             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6871                                                          COMP-3.
  6872             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6873                                                          COMP-3.
  6874         16  AM-EXECUTIVE-TWO.
  6875             20  AM-EXEC2-NAME             PIC X(15).
  6876             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6877                                                          COMP-3.
  6878             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6879                                                          COMP-3.
  6880
  6881     12  AM-RETRO-ADDITIONAL-DATA.
  6882         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6883         16  AM-RETRO-PREM-P-E             PIC X.
  6884         16  AM-RETRO-CLMS-P-I             PIC X.
  6885         16  AM-RETRO-RET-BRACKET-LF.
  6886             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6887                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6888                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6889             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6890                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6891                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6892             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6893                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6894                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6895         16  AM-RETRO-RET-BRACKET-AH.
  6896             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6897                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6898                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6899                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6900             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6901                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6902                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6903             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6904                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6905                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6906
  6907     12  AM-COMMENTS.
  6908         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 127
* EL050.cbl
  6909
  6910     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6911         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6912         16  AM-FLI-BILLING-CODE           PIC X.
  6913         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6914         16  AM-FLI-UNITED-IDENT           PIC X.
  6915         16  AM-FLI-INTEREST-LOST-DATA.
  6916             20  AM-FLI-BANK-NO            PIC X(5).
  6917             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6918             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6919             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6920         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6921             20  AM-FLI-AGT                PIC X(9).
  6922             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6923             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6924         16  FILLER                        PIC X(102).
  6925
  6926     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6927         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6928             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6929             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6930             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6931             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6932             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6933         16  FILLER                          PIC X(10).
  6934******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 128
* EL050.cbl
  6936*    COPY ERCREIN.
  6937******************************************************************
  6938*                                                                *
  6939*                            ERCREIN                             *
  6940*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6941*                            VMOD=2.010                          *
  6942*                                                                *
  6943*   ONLINE CREDIT SYSTEM                                         *
  6944*                                                                *
  6945*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6946*                                                                *
  6947*   FILE TYPE = VSAM,KSDS                                        *
  6948*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6949*                                                                *
  6950*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6951*       ALTERNATE PATH = NONE                                    *
  6952*                                                                *
  6953*   LOG = NO                                                     *
  6954*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6955*                                                                *
  6956******************************************************************
  6957*                   C H A N G E   L O G
  6958*
  6959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6960*-----------------------------------------------------------------
  6961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6962* EFFECTIVE    NUMBER
  6963*-----------------------------------------------------------------
  6964* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6965* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6966******************************************************************
  6967 01  REINSURANCE-RECORD.
  6968     12  RE-RECORD-ID                      PIC XX.
  6969         88  VALID-RE-ID                      VALUE 'RE'.
  6970
  6971     12  RE-CONTROL-PRIMARY.
  6972         16  RE-COMPANY-CD                 PIC X.
  6973         16  RE-KEY.
  6974             20  RE-CODE                   PIC X.
  6975                 88  RE-TABLE-RECORD          VALUE 'A'.
  6976                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6977             20  RE-TABLE                  PIC XXX.
  6978             20  FILLER                    PIC XXX.
  6979         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6980             20  FILLER                    PIC X.
  6981             20  RE-COMPANY.
  6982                 24  RE-COMP-PRIME         PIC XXX.
  6983                 24  RE-COMP-SUB           PIC XXX.
  6984
  6985     12  RE-MAINT-INFORMATION.
  6986         16  RE-LAST-MAINT-DT              PIC XX.
  6987         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6988         16  RE-LAST-MAINT-USER            PIC X(4).
  6989         16  FILLER                        PIC X(10).
  6990
  6991     12  RE-TABLE-DATA.
  6992         16  RE-100-COMP                   PIC 99.
  6993
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 129
* EL050.cbl
  6994         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6995             20  RE-REI-COMP-NO.
  6996                 24  RE-REI-COMP           PIC XXX.
  6997                 24  RE-REI-COMP-SUB       PIC XXX.
  6998             20  RE-LF-QC                  PIC X.
  6999             20  RE-AH-QC                  PIC X.
  7000             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7001             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7002             20  RE-LFAGE-LO               PIC 99.
  7003             20  RE-LFAGE-HI               PIC 99.
  7004             20  RE-AHAGE-LO               PIC 99.
  7005             20  RE-AHAGE-HI               PIC 99.
  7006             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7007             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7008             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7009             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7010             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7011             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7012             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7013             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7014             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7015             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7016             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7017             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7018             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7019             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7020             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7021             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7022             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7023             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7024             20  RE-LF-BEN-CODE            PIC X.
  7025             20  RE-AH-BEN-CODE            PIC X.
  7026             20  RE-INTERACTIVE            PIC X.
  7027             20  RE-REMAINING              PIC X.
  7028             20  RE-LF-RUNOFF-SW           PIC X.
  7029             20  RE-AH-RUNOFF-SW           PIC X.
  7030             20  FILLER                    PIC X(19).
  7031
  7032         16  RE-COMP-INFO-END              PIC X(6).
  7033         16  RE-NSP-ST-CD-LF               PIC XX.
  7034         16  RE-NSP-ST-CD-AH               PIC XX.
  7035         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7036             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7037
  7038         16  FILLER                        PIC X(27).
  7039
  7040     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7041         16  RE-NAME                       PIC X(30).
  7042         16  RE-LF-PE                      PIC X.
  7043         16  RE-AH-PE                      PIC X.
  7044         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7045         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7046         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7047         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7048         16  RE-PRT-ST                     PIC X.
  7049         16  RE-PRT-OW                     PIC X.
  7050         16  RE-MORT-CODE                  PIC X(4).
  7051         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 130
* EL050.cbl
  7052         16  RE-ZERO-LF-FEE                PIC X.
  7053         16  RE-ZERO-AH-FEE                PIC X.
  7054         16  RE-CEDE-NAME                  PIC X(30).
  7055         16  RE-LF-COMM                    PIC X.
  7056         16  RE-AH-COMM                    PIC X.
  7057         16  RE-LF-TAX                     PIC X.
  7058         16  RE-AH-TAX                     PIC X.
  7059         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7060         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7061         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7062
  7063         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7064             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7065
  7066         16  RE-LF-CEDING-FEE-BRACKETS.
  7067             20  RE-LF-FEE-METHOD          PIC X.
  7068                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7069                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7070                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7071                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7072             20  RE-LF-FEE-BASIS           PIC X.
  7073                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7074                 88  RE-LF-NET-CEDED               VALUE '2'.
  7075                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7076                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7077                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7078                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7079                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7080                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7081             20  FILLER                    PIC XXX.
  7082             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7083                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7084                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7085
  7086         16  RE-AH-CEDING-FEE-BRACKETS.
  7087             20  RE-AH-FEE-METHOD          PIC X.
  7088                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7089                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7090                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7091                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7092             20  RE-AH-FEE-BASIS           PIC X.
  7093                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7094                 88  RE-AH-NET-CEDED               VALUE '2'.
  7095                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7096                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7097                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7098                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7099                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7100                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7101             20  FILLER                    PIC XXX.
  7102             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7103                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7104                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7105
  7106         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7107
  7108         16  RE-OLD-CEDING-STMT            PIC X.
  7109
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 131
* EL050.cbl
  7110         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7111         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7112         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7113         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7114         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7115         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7116         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7117         16  RE-MORT-SW                    PIC X.
  7118         16  RE-CEDING-TYPE-FLAG           PIC X.
  7119             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7120             88  RE-CEDED                          VALUE 'C'.
  7121             88  RE-ASSUMED                        VALUE 'A'.
  7122             88  RE-PHANTOM                        VALUE 'P'.
  7123
  7124         16  RE-CEDING-STMT-OPT-A          PIC X.
  7125             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7126         16  RE-CEDING-STMT-OPT-B          PIC X.
  7127             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7128         16  RE-CEDING-STMT-OPT-C          PIC X.
  7129             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7130         16  RE-CEDING-STMT-OPT-D          PIC X.
  7131             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7132         16  RE-CEDING-STMT-OPT-E          PIC X.
  7133             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7134
  7135         16  RE-PRT-CRSV                   PIC X.
  7136
  7137         16  RE-GL-CENTER                  PIC X(4).
  7138
  7139         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7140
  7141         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7142
  7143         16  RE-EARN-STOP-CODE             PIC X.
  7144             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7145             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7146
  7147         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7148             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7149
  7150         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7151         16  FILLER                        PIC X(2281).
  7152
  7153         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7154
  7155******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 132
* EL050.cbl
  7157*    COPY ERCCTBL.
  7158******************************************************************
  7159*                                                                *
  7160*                                                                *
  7161*                            ERCCTBL                             *
  7162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7163*                            VMOD=2.003
  7164*                                                                *
  7165*   ONLINE CREDIT SYSTEM                                         *
  7166*                                                                *
  7167*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7168*                                                                *
  7169*   FILE TYPE = VSAM,KSDS                                        *
  7170*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7171*                                                                *
  7172*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7173*       ALTERNATE PATH = NONE                                    *
  7174*                                                                *
  7175*   LOG = NO                                                     *
  7176*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7177*                                                                *
  7178*                                                                *
  7179******************************************************************
  7180
  7181 01  COMM-TABLE-RECORD.
  7182     12  CT-RECORD-ID                      PIC XX.
  7183         88  VALID-CT-ID                      VALUE 'CT'.
  7184
  7185     12  CT-CONTROL-PRIMARY.
  7186         16  CT-COMPANY-CD                 PIC X.
  7187         16  CT-TABLE                      PIC XXX.
  7188         16  CT-CNTRL-2.
  7189             20  CT-BEN-TYPE               PIC X.
  7190             20  CT-BEN-CODE               PIC XX.
  7191
  7192     12  CT-MAINT-INFORMATION.
  7193         16  CT-LAST-MAINT-DT              PIC XX.
  7194         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7195         16  CT-LAST-MAINT-USER            PIC X(4).
  7196         16  FILLER                        PIC X(31).
  7197
  7198     12  CT-LIMITS.
  7199         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7200
  7201         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7202
  7203         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7204
  7205     12  CT-RATES.
  7206         16  CT-RTX          OCCURS 27 TIMES.
  7207             20  CT-RT                     PIC SV9(5)     COMP-3.
  7208             20  CT-RT-R   REDEFINES
  7209                 CT-RT                     PIC XXX.
  7210
  7211     12  FILLER                            PIC  X(42).
  7212
  7213******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 133
* EL050.cbl
  7215*    COPY ERCFORM.
  7216******************************************************************
  7217*                                                                *
  7218*                                                                *
  7219*                            ERCFORM.                            *
  7220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7221*                            VMOD=2.003                          *
  7222*                                                                *
  7223*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7224*                                                                *
  7225*    FILE TYPE = VSAM,KSDS                                       *
  7226*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7227*                                                                *
  7228*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7229*                                                                *
  7230*    LOG = YES                                                   *
  7231*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7232******************************************************************
  7233 01  FORM-MASTER.
  7234    12  FO-RECORD-ID                 PIC X(02).
  7235        88  VALID-FO-ID                  VALUE 'FO'.
  7236
  7237    12  FO-CONTROL-PRIMARY.
  7238        16  FO-COMPANY-CD            PIC X(01).
  7239        16  FO-STATE                 PIC X(02).
  7240        16  FO-FORM-ID               PIC X(12).
  7241        16  FO-FORM-EXP-DT           PIC X(02).
  7242
  7243    12  FO-POLICY-FORM-DATA.
  7244        16  FO-IND-GRP-CD            PIC X(01).
  7245        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7246        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7247        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7248        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7249        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7250        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7251        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7252        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7253        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7254        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7255        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7256        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7257        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7258        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7259        16  FO-APP-CERT-USE-CD       PIC X(01).
  7260
  7261    12  FILLER                       PIC X(29).
  7262
  7263    12  FO-FORM-PLAN-TABLE.
  7264        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7265            20  FO-PLAN-TYPE         PIC X(01).
  7266            20  FO-PLAN-ID           PIC X(02).
  7267            20  FO-PLAN-TERM         PIC 9(03).
  7268            20  FO-PLAN-REFUND-METHOD
  7269                                     PIC X.
  7270
  7271    12  FILLER                       PIC X(30).
  7272
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 134
* EL050.cbl
  7273    12  FO-COMMENTS-AREA.
  7274        16  FO-COMMENT-LINE-1        PIC X(78).
  7275
  7276    12  FILLER                       PIC X(20).
  7277
  7278    12  FO-MAINT-INFORMATION.
  7279        16  FO-LAST-MAINT-DT         PIC X(02).
  7280        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7281        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 135
* EL050.cbl
  7283*    COPY ELCMSTR.
  7284******************************************************************
  7285*                                                                *
  7286*                            ELCMSTR.                            *
  7287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7288*                            VMOD=2.012                          *
  7289*                                                                *
  7290*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7291*                                                                *
  7292*   FILE TYPE = VSAM,KSDS                                        *
  7293*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7294*                                                                *
  7295*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7296*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7297*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7298*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7299*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7300*                                                 RKP=75,LEN=21  *
  7301*                                                                *
  7302*   **** NOTE ****                                               *
  7303*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7304*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7305*                                                                *
  7306*   LOG = YES                                                    *
  7307*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7308******************************************************************
  7309*                   C H A N G E   L O G
  7310*
  7311* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7312*-----------------------------------------------------------------
  7313*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7314* EFFECTIVE    NUMBER
  7315*-----------------------------------------------------------------
  7316* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7317* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7318* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7319* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7320******************************************************************
  7321 01  CLAIM-MASTER.
  7322     12  CL-RECORD-ID                PIC XX.
  7323         88  VALID-CL-ID         VALUE 'CL'.
  7324
  7325     12  CL-CONTROL-PRIMARY.
  7326         16  CL-COMPANY-CD           PIC X.
  7327         16  CL-CARRIER              PIC X.
  7328         16  CL-CLAIM-NO             PIC X(7).
  7329         16  CL-CERT-NO.
  7330             20  CL-CERT-PRIME       PIC X(10).
  7331             20  CL-CERT-SFX         PIC X.
  7332
  7333     12  CL-CONTROL-BY-NAME.
  7334         16  CL-COMPANY-CD-A1        PIC X.
  7335         16  CL-INSURED-LAST-NAME    PIC X(15).
  7336         16  CL-INSURED-NAME.
  7337             20  CL-INSURED-1ST-NAME PIC X(12).
  7338             20  CL-INSURED-MID-INIT PIC X.
  7339
  7340     12  CL-CONTROL-BY-SSN.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 136
* EL050.cbl
  7341         16  CL-COMPANY-CD-A2        PIC X.
  7342         16  CL-SOC-SEC-NO.
  7343             20  CL-SSN-STATE        PIC XX.
  7344             20  CL-SSN-ACCOUNT      PIC X(6).
  7345             20  CL-SSN-LN3          PIC X(3).
  7346
  7347     12  CL-CONTROL-BY-CERT-NO.
  7348         16  CL-COMPANY-CD-A4        PIC X.
  7349         16  CL-CERT-NO-A4.
  7350             20  CL-CERT-A4-PRIME    PIC X(10).
  7351             20  CL-CERT-A4-SFX      PIC X.
  7352
  7353     12  CL-CONTROL-BY-CCN.
  7354         16  CL-COMPANY-CD-A5        PIC X.
  7355         16  CL-CCN-A5.
  7356             20  CL-CCN.
  7357                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7358                 24  CL-CCN-PRIME-A5 PIC X(12).
  7359             20  CL-CCN-FILLER-A5    PIC X(4).
  7360
  7361     12  CL-INSURED-PROFILE-DATA.
  7362         16  CL-INSURED-BIRTH-DT     PIC XX.
  7363         16  CL-INSURED-SEX-CD       PIC X.
  7364             88  INSURED-IS-MALE        VALUE 'M'.
  7365             88  INSURED-IS-FEMALE      VALUE 'F'.
  7366             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7367         16  CL-INSURED-OCC-CD       PIC X(6).
  7368         16  FILLER                  PIC X(5).
  7369
  7370     12  CL-PROCESSING-INFO.
  7371         16  CL-PROCESSOR-ID         PIC X(4).
  7372         16  CL-CLAIM-STATUS         PIC X.
  7373             88  CLAIM-IS-OPEN          VALUE 'O'.
  7374             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7375         16  CL-CLAIM-TYPE           PIC X.
  7376*            88  AH-CLAIM               VALUE 'A'.
  7377*            88  LIFE-CLAIM             VALUE 'L'.
  7378*            88  PROPERTY-CLAIM         VALUE 'P'.
  7379*            88  IUI-CLAIM              VALUE 'I'.
  7380*            88  GAP-CLAIM              VALUE 'G'.
  7381         16  CL-CLAIM-PREM-TYPE      PIC X.
  7382             88  SINGLE-PREMIUM         VALUE '1'.
  7383             88  O-B-COVERAGE           VALUE '2'.
  7384             88  OPEN-END-COVERAGE      VALUE '3'.
  7385         16  CL-INCURRED-DT          PIC XX.
  7386         16  CL-REPORTED-DT          PIC XX.
  7387         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7388         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7389         16  CL-LAST-PMT-DT          PIC XX.
  7390         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7391         16  CL-PAID-THRU-DT         PIC XX.
  7392         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7393         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7394         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7395         16  CL-PMT-CALC-METHOD      PIC X.
  7396             88  CL-360-DAY-YR          VALUE '1'.
  7397             88  CL-365-DAY-YR          VALUE '2'.
  7398             88  CL-FULL-MONTHS         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 137
* EL050.cbl
  7399         16  CL-CAUSE-CD             PIC X(6).
  7400
  7401         16  CL-PRIME-CERT-NO.
  7402             20  CL-PRIME-CERT-PRIME PIC X(10).
  7403             20  CL-PRIME-CERT-SFX   PIC X.
  7404
  7405         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7406             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7407             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7408
  7409         16  CL-MICROFILM-NO         PIC X(10).
  7410         16  FILLER REDEFINES CL-MICROFILM-NO.
  7411             20  CL-BENEFIT-PERIOD   PIC 99.
  7412             20  FILLER              PIC X(8).
  7413         16  CL-PROG-FORM-TYPE       PIC X.
  7414         16  CL-LAST-ADD-ON-DT       PIC XX.
  7415
  7416         16  CL-LAST-REOPEN-DT       PIC XX.
  7417         16  CL-LAST-CLOSE-DT        PIC XX.
  7418         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7419             88  FINAL-PAID             VALUE '1'.
  7420             88  CLAIM-DENIED           VALUE '2'.
  7421             88  AUTO-CLOSE             VALUE '3'.
  7422             88  MANUAL-CLOSE           VALUE '4'.
  7423             88  BENEFITS-CHANGED       VALUE 'C'.
  7424             88  SETUP-ERRORS           VALUE 'E'.
  7425         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7426         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7427         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7428             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7429         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7430         16  FILLER                  PIC X.
  7431
  7432     12  CL-CERTIFICATE-DATA.
  7433         16  CL-CERT-ORIGIN          PIC X.
  7434             88  CERT-WAS-ONLINE        VALUE '1'.
  7435             88  CERT-WAS-CREATED       VALUE '2'.
  7436             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7437         16  CL-CERT-KEY-DATA.
  7438             20  CL-CERT-CARRIER     PIC X.
  7439             20  CL-CERT-GROUPING    PIC X(6).
  7440             20  CL-CERT-STATE       PIC XX.
  7441             20  CL-CERT-ACCOUNT.
  7442                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7443                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7444             20  CL-CERT-EFF-DT      PIC XX.
  7445
  7446     12  CL-STATUS-CONTROLS.
  7447         16  CL-PRIORITY-CD          PIC X.
  7448             88  CONFIDENTIAL-DATA      VALUE '8'.
  7449             88  HIGHEST-PRIORITY       VALUE '9'.
  7450         16  CL-SUPV-ATTN-CD         PIC X.
  7451             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7452             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7453         16  CL-PURGED-DT            PIC XX.
  7454         16  CL-RESTORED-DT          PIC XX.
  7455         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7456         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 138
* EL050.cbl
  7457         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7458         16  CL-CRITICAL-PERIOD      PIC 99.
  7459*        16  FILLER                  PIC XX.
  7460         16  CL-LAST-MAINT-DT        PIC XX.
  7461         16  CL-LAST-MAINT-USER      PIC X(4).
  7462         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7463         16  CL-LAST-MAINT-TYPE      PIC X.
  7464             88  CLAIM-SET-UP           VALUE ' '.
  7465             88  PAYMENT-MADE           VALUE '1'.
  7466             88  LETTER-SENT            VALUE '2'.
  7467             88  MASTER-WAS-ALTERED     VALUE '3'.
  7468             88  MASTER-WAS-RESTORED    VALUE '4'.
  7469             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7470             88  FILE-CONVERTED         VALUE '6'.
  7471             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7472             88  ERROR-CORRECTION       VALUE 'E'.
  7473         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7474         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7475         16  CL-BENEFICIARY          PIC X(10).
  7476         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7477         16  CL-DENIAL-TYPE          PIC X.
  7478             88  CL-TYPE-DENIAL          VALUE '1'.
  7479             88  CL-TYPE-RESCISSION      VALUE '2'.
  7480             88  CL-TYPE-REFORMATION     VALUE '3'.
  7481             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7482             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7483         16  filler                  pic x(5).
  7484*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7485*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7486*        16  CL-RTW-DT               PIC XX.
  7487
  7488     12  CL-TRAILER-CONTROLS.
  7489         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7490             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7491             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7492             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7493         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7494         16  FILLER                  PIC XX.
  7495         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7496         16  CL-ADDRESS-TRAILER-CNT.
  7497             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7498                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7499             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7500                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7501             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7502                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7503             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7504                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7505             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7506                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7507             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7508                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7509             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7510                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7511
  7512     12  CL-CV-REFERENCE-NO.
  7513         16  CL-CV-REFNO-PRIME       PIC X(18).
  7514         16  CL-CV-REFNO-SFX         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 139
* EL050.cbl
  7515
  7516     12  CL-FILE-LOCATION            PIC X(4).
  7517
  7518     12  CL-PROCESS-ERRORS.
  7519         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7520             88  NO-FATAL-ERRORS        VALUE ZERO.
  7521         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7522             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7523
  7524     12  CL-PRODUCT-CD               PIC X.
  7525
  7526     12  CL-CURRENT-KEY-DATA.
  7527         16  CL-CURRENT-CARRIER      PIC X.
  7528         16  CL-CURRENT-GROUPING     PIC X(6).
  7529         16  CL-CURRENT-STATE        PIC XX.
  7530         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7531
  7532     12  CL-ASSOCIATES               PIC X.
  7533         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7534         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7535         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7536         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7537
  7538     12  CL-ACTIVITY-CODE            PIC 99.
  7539     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7540     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7541
  7542     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7543     12  CL-LAG-REPORT-CODE          PIC 9.
  7544     12  CL-LOAN-TYPE                PIC XX.
  7545     12  CL-LEGAL-STATE              PIC XX.
  7546
  7547     12  CL-YESNOSW                  PIC X.
  7548     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7549         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7550         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7551         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7552     12  cl-insured-type             pic x.
  7553         88  cl-claim-on-primary         value 'P'.
  7554         88  cl-claim-on-co-borrower     value 'C'.
  7555     12  cl-benefit-expiration-dt    PIC XX.
  7556
  7557 01  PLAN-RECORDS.
  7558     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7559     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7560
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 140
* EL050.cbl
  7562 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7563                          ACCOUNT-MASTER REINSURANCE-RECORD
  7564                          COMM-TABLE-RECORD FORM-MASTER
  7565                          CLAIM-MASTER PLAN-RECORDS.
  7566 0000-DFHEXIT SECTION.
  7567     MOVE '9#                    $   ' TO DFHEIV0.
  7568     MOVE 'EL050' TO DFHEIV1.
  7569     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7570
  7571     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7572
  7573
  7574* EXEC CICS  HANDLE CONDITION
  7575*           ERROR    (9300-ABEND)
  7576*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7577*    END-EXEC.
  7578*    MOVE '"$.J                  ! " #00007569' TO DFHEIV0
  7579     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7581     MOVE X'2220233030303037353639' TO DFHEIV0(25:11)
  7582     CALL 'kxdfhei1' USING DFHEIV0
  7583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7584
  7585
  7586 0000-COPY-PROCEDURE-DIV.
  7587*                          COPY ELC50PD.
  7588******************************************************************
  7589*                                                                *
  7590*                            ELC50PD                             *
  7591*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7592*                            VMOD=2.188                          *
  7593*                                                                *
  7594******************************************************************
  7595*                   C H A N G E   L O G
  7596*
  7597* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7598*-----------------------------------------------------------------
  7599*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7600* EFFECTIVE    NUMBER
  7601*-----------------------------------------------------------------
  7602* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7603* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7604* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7605*                             2709 AND 2718
  7606* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7607* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7608* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7609* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7610* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7611*                                IS OPEN OR CNC DT < PD THRU
  7612* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7613* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7614* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7615* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7616* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7617* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7618* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7619* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 141
* EL050.cbl
  7620* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7621* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7622* 020906                   PEMA  EXPAND LOAN OFFICER
  7623* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7624* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7625* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7626* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7627* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7628* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7629* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7630* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7631* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7632* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7633* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7634* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7635* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7636* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7637* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7638* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7639* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7640* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7641* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7642* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7643* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7644* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7645* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7646* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7647* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7648*                                UPDATE VIN ON CERT TRAILER
  7649* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7650* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7651* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7652* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7653* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7654* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7655* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7656* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7657* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7658* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7659* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7660* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7661* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7662* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7663* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7664* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7665* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7666* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7667* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7668* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7669* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7670* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7671* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7672* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7673* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7674* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7675* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7676* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7677* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 142
* EL050.cbl
  7678* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7679* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7680* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7681* 032912  CR2011110200001  PEMA  AHL CHANGES
  7682* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7683* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7684* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7685* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7686* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7687* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7688* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7689* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7690* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7691* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7692* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7693* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7694* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7695* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7696* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7697* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7698* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7699* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7700* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7701* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7702* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7703* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7704* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7705******************************************************************
  7706************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7707******************************************************************
  7708
  7709     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7710
  7711     MOVE SPACES                 TO PB-FATAL-FLAG
  7712                                    PB-FORCE-ER-CD
  7713                                    PB-WARN-ER-CD
  7714                                    PB-OUT-BAL-CD.
  7715
  7716     MOVE SPACE                  TO WS-IG-OVRD-AH
  7717                                    WS-IG-OVRD-LF
  7718                                    WS-IG-OVRD-AM
  7719                                    WS-IG-OVRD
  7720                                    WS-IG-OVRD-AH-PL
  7721                                    WS-IG-OVRD-LF-PL
  7722                                    WS-IG-OVRD-AH-BEN
  7723                                    WS-IG-OVRD-LF-BEN.
  7724
  7725******************************************************************
  7726*************       INITIALIZE COMMON ERRORS       ***************
  7727******************************************************************
  7728
  7729     MOVE +0                     TO PB-NO-OF-ERRORS.
  7730     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7731
  7732******************************************************************
  7733
  7734     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7735     SET JULIAN-TO-BIN           TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 143
* EL050.cbl
  7736*    MOVE 5                      TO DC-OPTION-CODE.
  7737     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7738     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7739
  7740     MOVE ZERO                   TO  SUB4.
  7741
  7742 0040-INITIALIZE-GA-BILL-DT.
  7743
  7744     ADD +1                      TO  SUB4.
  7745
  7746     IF  SUB4 GREATER THAN +5
  7747         GO TO 0050-CHECK-CNTL-FOUND.
  7748
  7749     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7750         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7751
  7752     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7753
  7754 0050-CHECK-CNTL-FOUND.
  7755
  7756     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7757        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7758                                         WS-AH-REM-TERM-CALC
  7759                                         EC-CO-REM-TERM-CALC
  7760        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7761        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7762        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7763                                         WS-TOL-AH-CLAIM
  7764        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7765                                         WS-TOL-AH-PREM
  7766                                         EC-CO-TOL-PREM
  7767        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7768                                         WS-TOL-AH-REFUND
  7769                                         EC-CO-TOL-REFUND
  7770        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7771                                         WS-AH-REFUND-OVS-AMT
  7772                                         EC-CO-OVR-SHT-AMT
  7773        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7774                                         WS-TOL-AH-PREM-PCT
  7775                                         EC-CO-TOL-PREM-PCT
  7776        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7777                                         WS-TOL-AH-REFUND-PCT
  7778                                         EC-CO-TOL-REFUND-PCT
  7779        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7780                                         WS-AH-REFUND-OVS-PCT
  7781                                         EC-CO-OVR-SHT-PCT
  7782        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7783        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7784        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7785        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7786        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7787        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7788        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7789        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7790        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7791        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7792        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7793        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 144
* EL050.cbl
  7794                                         EC-CO-MONTH-END-DT
  7795        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7796          GO TO 0100-READ-ACCT.
  7797
  7798     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7799     MOVE SPACES                 TO CNTL-ACCESS.
  7800     MOVE '1'                    TO CNTL-REC-TYPE.
  7801     MOVE +0                     TO CNTL-SEQ-NO.
  7802
  7803     MOVE '1' TO RC-SW-1.
  7804     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7805     IF NOT CF-COMPANY-MASTER
  7806         MOVE ZEROS             TO WK-CO-TOL-PREM
  7807                                   WK-CO-TOL-CLAIM
  7808                                   WK-CO-TOL-REFUND
  7809                                   WK-REFUND-OVS-AMT
  7810                                   WK-REFUND-OVS-PCT
  7811                                   WK-CO-TOL-PREM-PCT
  7812                                   WK-CO-TOL-REFUND-PCT
  7813                                   WK-DEFAULT-APR
  7814                                   WK-CO-MAX-CAP
  7815        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7816                                   WK-CR-R78-METHOD
  7817                                   WK-CO-REF-REJECT-SW
  7818                                   WK-CO-PREM-REJECT-SW
  7819                                   WK-REM-TRM-CALC-OPTION
  7820                                   WK-BIRTH-DATE-INPUT
  7821                                   WK-JOINT-AGE-INPUT
  7822        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7823        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7824        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7825        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7826          GO TO 0099-COMPANY-NOT-FOUND.
  7827
  7828     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7829        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7830     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7831        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7832     IF CF-CO-TOL-CAP NOT NUMERIC
  7833        MOVE +0                    TO CF-CO-TOL-CAP.
  7834     IF CF-DEFAULT-APR NOT NUMERIC
  7835        MOVE +0                    TO CF-DEFAULT-APR.
  7836
  7837     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7838     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7839     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7840     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7841     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7842     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7843     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7844     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7845     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7846     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7847     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7848     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7849
  7850     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7851          CF-CO-OVR-SHT-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 145
* EL050.cbl
  7852        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7853
  7854     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7855          CF-CO-OVR-SHT-PCT > +0
  7856        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7857
  7858     IF CF-VALID-REM-TRM-OPTION
  7859         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7860     ELSE
  7861         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7862
  7863     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7864     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7865     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7866     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7867
  7868     GO TO 0050-CHECK-CNTL-FOUND.
  7869
  7870 0099-COMPANY-NOT-FOUND.
  7871
  7872     MOVE ER-2616                TO WS-ERROR.
  7873     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7874
  7875 0100-READ-ACCT.
  7876
  7877     MOVE SPACES                 TO DATE-RANGE-SW.
  7878
  7879     IF WK-ACCT-ADDR = ZEROS
  7880        GO TO 0102-ACCT-GETMAIN.
  7881
  7882     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7883     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7884     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7885
  7886     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7887        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7888        GO TO 0105-READ-ACCT
  7889     END-IF
  7890
  7891     IF PB-CARRIER NOT = SPACES
  7892        IF PB-CARRIER NOT = AM-VG-CARRIER
  7893           GO TO 0105-READ-ACCT.
  7894
  7895     IF PB-STATE NOT = SPACES
  7896        IF PB-STATE NOT = AM-VG-STATE
  7897           GO TO 0105-READ-ACCT.
  7898
  7899     IF PB-GROUPING NOT = SPACES
  7900        IF PB-GROUPING NOT = AM-VG-GROUPING
  7901           GO TO 0105-READ-ACCT.
  7902
  7903     MOVE 'X'                 TO DATE-RANGE-SW.
  7904
  7905     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7906        MOVE 'X'                 TO DATE-RANGE-SW
  7907        GO TO 0105-READ-ACCT.
  7908
  7909     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 146
* EL050.cbl
  7910        GO TO 0105-READ-ACCT.
  7911
  7912     GO TO 0180-ACCOUNT-FOUND.
  7913
  7914 0102-ACCT-GETMAIN.
  7915     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7916     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7917
  7918 0105-READ-ACCT.
  7919     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7920     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7921     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7922     MOVE PB-STATE               TO ACCT-STATE.
  7923     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7924     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7925
  7926     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7927
  7928     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7929
  7930 0110-FIND-ACCT-TOLERANCES-LOOP.
  7931     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7932
  7933     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7934        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7935        GO TO 0199-ACCT-NOT-FOUND
  7936     END-IF
  7937     IF PB-CARRIER NOT = SPACES
  7938        IF PB-CARRIER NOT = AM-VG-CARRIER
  7939           GO TO 0199-ACCT-NOT-FOUND.
  7940
  7941     IF PB-STATE NOT = SPACES
  7942        IF PB-STATE NOT = AM-VG-STATE
  7943           GO TO 0199-ACCT-NOT-FOUND.
  7944
  7945     IF PB-GROUPING NOT = SPACES
  7946        IF PB-GROUPING NOT = AM-VG-GROUPING
  7947           GO TO 0199-ACCT-NOT-FOUND.
  7948
  7949     MOVE 'X'                    TO DATE-RANGE-SW.
  7950
  7951     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7952        MOVE 'X'                 TO DATE-RANGE-SW
  7953        GO TO 0199-ACCT-NOT-FOUND.
  7954
  7955     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7956        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7957
  7958 0180-ACCOUNT-FOUND.
  7959     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7960     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7961     MOVE AM-STATE               TO PB-SV-STATE.
  7962     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7963
  7964     IF AM-CANCEL-FEE  NOT NUMERIC
  7965        MOVE ZEROS TO AM-CANCEL-FEE.
  7966
  7967     IF AM-MAX-MON-BEN NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 147
* EL050.cbl
  7968        MOVE ZEROS TO AM-MAX-MON-BEN.
  7969
  7970     IF AM-MAX-TOT-BEN NOT NUMERIC
  7971        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7972
  7973     IF AM-CLP-TOL-PCT NOT NUMERIC
  7974        MOVE +0                  TO AM-CLP-TOL-PCT
  7975     END-IF
  7976     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7977        MOVE +0                  TO AM-SPP-LEASE-COMM
  7978     END-IF
  7979     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7980        MOVE ER-2611             TO   WS-ERROR
  7981        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7982
  7983     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7984        MOVE ER-2621             TO   WS-ERROR
  7985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7986
  7987     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7988        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7989        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7990        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7991         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7992
  7993     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7994     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7995     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7996     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7997     IF AM-CLP-TOL-PCT NOT = ZEROS
  7998        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7999     END-IF
  8000     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8001        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8002     END-IF
  8003*    IF PB-COMPANY-ID = 'DCC'
  8004*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8005*                                   WS-ADMIN-FEES
  8006*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8007*          (SUB5 > +10)
  8008*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8009*             AND (AM-A-COM (SUB5) NUMERIC)
  8010*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8011*                + (AM-A-COM (SUB5) * 1000)
  8012*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8013*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8014*                + (AM-A-COM (SUB5) * 1000)
  8015*             END-IF
  8016*             IF AM-COM-TYP (SUB5) = 'N'
  8017*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8018*                + (AM-A-COM (SUB5) * 1000)
  8019*             END-IF
  8020*          END-IF
  8021*       END-PERFORM
  8022*    END-IF
  8023     IF (PB-COMPANY-ID = 'DCC')
  8024        AND (PB-ISSUE)
  8025        MOVE +0                  TO WS-ACCT-ADDL-CLP
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 148
* EL050.cbl
  8026        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8027           (SUB5 > +10)
  8028           MOVE +0 TO WS-WK-RATE
  8029           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8030              IF (AM-A-COM (SUB5) NUMERIC)
  8031                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8032                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8033              ELSE
  8034                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8035                 IF PB-ISSUE
  8036                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8037                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8038                 ELSE
  8039                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8040                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8041                 END-IF
  8042                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8043                 MOVE ZEROS             TO WS-SUB1
  8044                                           WS-COMMISSION
  8045                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8046                 MOVE '0530'               TO CTBL-SW
  8047                 MOVE ' '                  TO WS-CTBL-READ-SW
  8048                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8049                 IF FIRST-TIME-THROUGH
  8050                    MOVE 'AA'              TO CTBL-BEN-CODE
  8051                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8052                 END-IF
  8053                 IF CTBL-TABLE-FOUND
  8054                    IF PB-ISSUE
  8055                       COMPUTE WS-COMM-CK-AMT =
  8056                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8057                    ELSE
  8058                       COMPUTE WS-COMM-CK-AMT =
  8059                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8060                    END-IF
  8061                    PERFORM 8800-GET-COMP-RATE
  8062                              THRU 8800-EXIT
  8063                 END-IF
  8064              END-IF
  8065              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8066                + (WS-WK-RATE * 1000)
  8067           END-IF
  8068        END-PERFORM
  8069     END-IF
  8070     IF PB-COMPANY-ID EQUAL 'CRI'
  8071         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8072
  8073     IF PB-COMPANY-ID EQUAL 'NCL'
  8074         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8075     END-IF
  8076
  8077     GO TO 0200-READ-CERT.
  8078
  8079 0199-ACCT-NOT-FOUND.
  8080
  8081     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8082
  8083     IF DATE-RANGE-SW NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 149
* EL050.cbl
  8084        MOVE ER-2601             TO WS-ERROR
  8085        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8086     ELSE
  8087        MOVE ER-2619             TO WS-ERROR
  8088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8089
  8090     GO TO 9990-RETURN.
  8091
  8092 0200-READ-CERT.
  8093
  8094     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8095     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8096     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8097     MOVE PB-SV-STATE            TO CERT-STATE.
  8098     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8099     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8100     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8101
  8102     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8103
  8104     IF CERT-WAS-NOT-FOUND
  8105        GO TO 0299-CERT-NOT-FOUND.
  8106
  8107     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8108        MOVE ER-2759             TO WS-ERROR
  8109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8110        GO TO 0298-UNLOCK-RETURN.
  8111
  8112     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8113         MOVE ER-2758            TO WS-ERROR
  8114         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8115         GO TO 0298-UNLOCK-RETURN.
  8116
  8117     IF PB-ISSUE
  8118        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8119           IF CERT-WAS-CREATED-FOR-CLAIM
  8120              NEXT SENTENCE
  8121            ELSE
  8122              MOVE ER-2626       TO WS-ERROR
  8123              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8124              GO TO 0298-UNLOCK-RETURN.
  8125
  8126     IF NOT PB-CANCELLATION
  8127        GO TO 0300-CONTINUE-EDIT.
  8128
  8129     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8130     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8131     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8132     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8133     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8134     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8135
  8136     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8137     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8138     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8139     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8140     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8141     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 150
* EL050.cbl
  8142     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8143     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8144     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8145
  8146     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8147     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8148     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8149     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8150     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8151     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8152     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8153
  8154     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8155     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8156
  8157     MOVE CM-CREDIT-INTERFACE-SW-1
  8158                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8159     MOVE CM-CREDIT-INTERFACE-SW-2
  8160                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8161
  8162     IF CM-O-B-COVERAGE
  8163         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8164
  8165     IF CM-LIVES NOT NUMERIC
  8166         MOVE ZERO                TO CM-LIVES.
  8167
  8168     IF CM-BILLED NOT NUMERIC
  8169         MOVE ZERO                TO CM-BILLED.
  8170
  8171     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8172         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8173         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8174         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8175         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8176         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8177         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8178         MOVE CM-LIVES             TO PB-CI-LIVES
  8179*The next line causes a problem with my change  I dont think it is
  8180*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8181
  8182     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8183     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8184     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8185     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8186     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8187     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8188
  8189     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8190     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8191     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8192     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8193
  8194     IF CM-LIFE-COMM-PCT NUMERIC
  8195         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8196     ELSE
  8197         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8198
  8199     IF CM-AH-COMM-PCT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 151
* EL050.cbl
  8200         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8201     ELSE
  8202         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8203
  8204     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8205
  8206     IF CM-LOAN-APR       NOT NUMERIC
  8207           MOVE ZERO               TO CM-LOAN-APR.
  8208
  8209     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8210           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8211
  8212     IF CM-LOAN-TERM      NOT NUMERIC
  8213           MOVE ZERO               TO CM-LOAN-TERM.
  8214
  8215     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8216           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8217
  8218     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8219           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8220
  8221     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8222     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8223     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8224     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8225     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8226     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8227     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8228     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8229     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8230     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8231     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8232     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8233
  8234     IF CM-STATE = CM-SSN-STATE
  8235         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8236
  8237     IF CM-STATE NOT = CM-MEMB-STATE
  8238         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8239
  8240     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8241
  8242     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8243        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8244        IF CM-ADDL-CLP NOT NUMERIC
  8245           MOVE +0               TO CM-ADDL-CLP
  8246        END-IF
  8247        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8248        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8249           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8250        END-IF
  8251     END-IF
  8252     IF PB-COMPANY-ID = 'DCC'
  8253        MOVE +0                  TO WS-ADMIN-FEES
  8254                                    WS-CSO-ADMIN-FEE
  8255                                    WS-COMM-AND-MFEE
  8256                                    WS-1ST-YR-ALLOW
  8257        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 152
* EL050.cbl
  8258           (SUB5 > +10)
  8259           MOVE +0 TO WS-WK-RATE
  8260           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8261              IF (AM-A-COM (SUB5) NUMERIC)
  8262                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8263                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8264              ELSE
  8265                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8266                 IF PB-ISSUE
  8267                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8268                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8269                 ELSE
  8270                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8271                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8272                 END-IF
  8273                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8274                 MOVE ZEROS             TO WS-SUB1
  8275                                           WS-COMMISSION
  8276                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8277                 MOVE '0530'               TO CTBL-SW
  8278                 MOVE ' '                  TO WS-CTBL-READ-SW
  8279                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8280                 IF FIRST-TIME-THROUGH
  8281                    MOVE 'AA'              TO CTBL-BEN-CODE
  8282                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8283                 END-IF
  8284                 IF CTBL-TABLE-FOUND
  8285                    IF PB-ISSUE
  8286                       COMPUTE WS-COMM-CK-AMT =
  8287                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8288                    ELSE
  8289                       COMPUTE WS-COMM-CK-AMT =
  8290                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8291                    END-IF
  8292                    PERFORM 8800-GET-COMP-RATE
  8293                              THRU 8800-EXIT
  8294                 END-IF
  8295              END-IF
  8296              IF AM-COM-TYP (SUB5) = 'I'
  8297                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8298                   + (WS-WK-RATE * 1000)
  8299              END-IF
  8300              IF AM-COM-TYP (SUB5) = 'N'
  8301                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8302                   + (WS-WK-RATE * 1000)
  8303              END-IF
  8304              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8305                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8306                   + (WS-WK-RATE * 1000)
  8307              END-IF
  8308              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8309                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8310                   + (WS-WK-RATE * 1000)
  8311              END-IF
  8312           END-IF
  8313        END-PERFORM
  8314     END-IF
  8315     GO TO 0300-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 153
* EL050.cbl
  8316
  8317 0298-UNLOCK-RETURN.
  8318      PERFORM 9250-UNLOCK-RETURN
  8319      GO TO 9990-RETURN.
  8320
  8321 0299-CERT-NOT-FOUND.
  8322
  8323     MOVE '1'                     TO CERT-STATUS-SW.
  8324
  8325     IF PB-COMPANY-ID = 'UCL'
  8326         IF WS-ERROR = ER-2799
  8327             GO TO 3000-CONTINUE-EDIT.
  8328
  8329     IF NOT PB-CANCELLATION
  8330         GO TO 0300-CONTINUE-EDIT.
  8331
  8332     MOVE ER-2726                  TO  WS-ERROR.
  8333     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8334     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8335     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8336                                    PB-CI-LF-TERM
  8337                                    PB-C-LF-REM-TERM
  8338                                    PB-CI-AH-TERM
  8339                                    PB-C-AH-REM-TERM
  8340                                    PB-CI-LF-BENEFIT-CD
  8341                                    PB-CI-LF-BENEFIT-AMT
  8342                                    PB-CI-LF-ALT-BENEFIT-AMT
  8343                                    PB-CI-LF-PREMIUM-AMT
  8344                                    PB-CI-LF-ALT-PREMIUM-AMT
  8345                                    PB-CI-AH-BENEFIT-CD
  8346                                    PB-CI-AH-BENEFIT-AMT
  8347                                    PB-CI-AH-PREMIUM-AMT
  8348                                    PB-CI-PAY-FREQUENCY
  8349                                    PB-CI-LOAN-APR
  8350                                    PB-CI-LOAN-TERM
  8351                                    PB-CI-LIFE-COMMISSION
  8352                                    PB-CI-AH-COMMISSION
  8353                                    PB-CI-CURR-SEQ
  8354                                    PB-CI-AH-CANCEL-AMT
  8355                                    PB-CI-LF-CANCEL-AMT
  8356                                    PB-CI-RATE-DEV-PCT-LF
  8357                                    PB-CI-RATE-DEV-PCT-AH
  8358                                    PB-CI-EXTENTION-DAYS
  8359                                    PB-CI-TERM-IN-DAYS
  8360                                    PB-CI-LIVES
  8361                                    PB-CI-LF-CRIT-PER
  8362                                    PB-CI-AH-CRIT-PER
  8363                                    PB-CI-ADDL-CLP
  8364                                    PB-CI-DDF-IU-RATE-UP.
  8365
  8366     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8367                                    PB-CI-AH-SETTLEMENT-DT
  8368                                    PB-CI-DEATH-DT
  8369                                    PB-CI-LF-PRIOR-CANCEL-DT
  8370                                    PB-CI-AH-PRIOR-CANCEL-DT
  8371                                    PB-CI-ENTRY-DT
  8372                                    PB-CI-LF-EXPIRE-DT
  8373                                    PB-CI-AH-EXPIRE-DT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 154
* EL050.cbl
  8374                                    PB-CI-LOAN-1ST-PMT-DT.
  8375
  8376     IF ACCOUNT-MAST-FOUND
  8377        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8378        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8379
  8380
  8381 0300-CONTINUE-EDIT.
  8382
  8383     IF PB-ISSUE
  8384        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8385            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8386
  8387     IF PB-ISSUE
  8388        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8389            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8390
  8391     IF PB-ISSUE
  8392       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8393          (AM-NO-AH-ONLY)
  8394           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8395               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8396                   MOVE ER-2679 TO WS-ERROR
  8397                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8398
  8399     IF PB-ISSUE
  8400        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8401        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8402        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8403     ELSE
  8404        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8405        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8406        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8407
  8408     MOVE 'N'                    TO PLAN-MASTER-SW
  8409                                    PLAN-MASTER-LIFE-SW
  8410                                    FORM-MASTER-SW
  8411                                    WS-APP-CERT-SW.
  8412
  8413     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8414                                    WS-PL-TOL-LF-REFUND
  8415                                    WS-PL-REF-OVS-AMT
  8416                                    WS-PL-TOL-LF-PREM-PCT
  8417                                    WS-PL-TOL-LF-REFUND-PCT
  8418                                    WS-PL-REF-OVS-PCT
  8419                                    WS-PL-TOL-LF-CLAIM.
  8420
  8421     IF PB-COMPANY-ID = 'NCL'
  8422       IF PB-ISSUE
  8423         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8424             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8425             IF FORM-MASTER-FOUND
  8426                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8427
  8428     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8429        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8430
  8431********************** MON CODE **********************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 155
* EL050.cbl
  8432     IF PB-COMPANY-ID = 'MON'
  8433     IF PB-ISSUE
  8434     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8435        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8436             PB-I-LOAN-APR = ZERO)
  8437               MOVE 14.0         TO PB-I-LOAN-APR.
  8438******************************************************
  8439
  8440     IF PB-COMPANY-ID = 'NCL'
  8441       IF PB-ISSUE
  8442           IF FORM-MASTER-FOUND
  8443             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8444                AM-DISMBR-COVERAGE
  8445                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8446                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8447                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8448                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8449                                           PB-I-LIFE-BENEFIT-CD.
  8450
  8451     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8452
  8453     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8454         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8455         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8456         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8457         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8458         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8459           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8460             GO TO 0301-LIFE-BENEFIT-SEARCH
  8461         ELSE
  8462             NEXT SENTENCE
  8463     ELSE
  8464         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8465
  8466     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8467     MOVE '4'                    TO CNTL-REC-TYPE.
  8468     MOVE +0                     TO CNTL-SEQ-NO.
  8469     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8470
  8471     MOVE '1' TO RC-SW-2.
  8472     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8473
  8474     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8475        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8476         GO TO 0305-BENEFIT-NOT-FOUND.
  8477
  8478     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8479
  8480 0301-LIFE-BENEFIT-SEARCH.
  8481
  8482     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8483
  8484     IF NO-BENEFIT-FOUND
  8485        GO TO 0305-BENEFIT-NOT-FOUND.
  8486
  8487     IF WS-BEN-CD = '99'
  8488        GO TO 0305-BENEFIT-NOT-FOUND.
  8489
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 156
* EL050.cbl
  8490     IF PB-COMPANY-ID = 'NCL'
  8491         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8492             GO TO 0304-LIFE-BENEFIT-FOUND.
  8493
  8494     MOVE +1                     TO SUB5.
  8495     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8496
  8497* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8498* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8499     IF PB-COMPANY-ID = 'DMD'
  8500         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8501
  8502 0302-EDIT-ACCT-LF-BENEFITS.
  8503
  8504     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8505        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8506           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8507                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8508           GO TO 03XX-GET-LIFE-ERPLAN.
  8509
  8510     IF SUB5 LESS THAN +20
  8511        ADD +1                   TO SUB5
  8512        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8513
  8514     MOVE +1                     TO SUB5.
  8515
  8516     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8517        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8518
  8519 0303-EDIT-DMD-EXTRA-BENEFITS.
  8520
  8521     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8522        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8523           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8524                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8525           GO TO 03XX-GET-LIFE-ERPLAN.
  8526
  8527     IF SUB5 LESS THAN +30
  8528        ADD +1                   TO SUB5
  8529        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8530
  8531     MOVE +1                     TO SUB5.
  8532
  8533 03XX-EDIT-FOR-NINETY-LF.
  8534
  8535***************************************************************
  8536*                                                             *
  8537*    NINETY BENEFIT PLAN TYPES:                               *
  8538*                                                             *
  8539*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8540*      92 = ALL GROUP REDUCING BENEFITS                       *
  8541*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8542*      94 = ALL GROUP LEVEL BENEFITS                          *
  8543*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8544*           BENEFIT CONTROLS.                                 *
  8545*      99 = ALL BENEFITS                                      *
  8546*                                                             *
  8547***************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 157
* EL050.cbl
  8548
  8549     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8550                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8551
  8552     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8553       AND
  8554        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8555        GO TO 03XX-GET-LIFE-ERPLAN.
  8556
  8557     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8558       AND
  8559        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8560        IF CF-REDUCING (SUB3)
  8561           IF (PB-I-INDV-GRP-OVRD = 'I')
  8562              OR
  8563           ((AM-IG = '1') AND
  8564           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8565              OR
  8566           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8567           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8568           (AM-IG NOT = '2'))
  8569              GO TO 03XX-GET-LIFE-ERPLAN.
  8570
  8571     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8572       AND
  8573        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8574        IF CF-REDUCING (SUB3)
  8575           IF (PB-I-INDV-GRP-OVRD = 'G')
  8576              OR
  8577           ((AM-IG = '2') AND
  8578           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8579              OR
  8580           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8581           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8582           (AM-IG NOT = '1'))
  8583              GO TO 03XX-GET-LIFE-ERPLAN.
  8584
  8585     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8586       AND
  8587        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8588        IF CF-LEVEL    (SUB3)
  8589           IF (PB-I-INDV-GRP-OVRD = 'I')
  8590              OR
  8591           ((AM-IG = '1') AND
  8592           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8593              OR
  8594           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8595           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8596            (AM-IG NOT = '2'))
  8597              GO TO 03XX-GET-LIFE-ERPLAN.
  8598
  8599     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8600       AND
  8601        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8602        IF CF-LEVEL    (SUB3)
  8603           IF (PB-I-INDV-GRP-OVRD = 'G')
  8604              OR
  8605           ((AM-IG = '2') AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 158
* EL050.cbl
  8606           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8607              OR
  8608           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8609           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8610           (AM-IG NOT = '1'))
  8611              GO TO 03XX-GET-LIFE-ERPLAN.
  8612
  8613     IF SUB5 LESS THAN +20
  8614        ADD +1                   TO SUB5
  8615        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8616
  8617     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8618
  8619     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8620        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8621
  8622     MOVE +1                     TO SUB5.
  8623
  8624 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8625
  8626     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8627                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8628
  8629     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8630       AND
  8631        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8632        GO TO 03XX-GET-LIFE-ERPLAN.
  8633
  8634     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8635       AND
  8636        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8637        IF CF-REDUCING (SUB3)
  8638           IF (PB-I-INDV-GRP-OVRD = 'I')
  8639              OR
  8640           ((AM-IG = '1') AND
  8641           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8642              OR
  8643           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8644           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8645           (AM-IG NOT = '2'))
  8646              GO TO 03XX-GET-LIFE-ERPLAN.
  8647
  8648     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8649       AND
  8650        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8651        IF CF-REDUCING (SUB3)
  8652           IF (PB-I-INDV-GRP-OVRD = 'G')
  8653              OR
  8654           ((AM-IG = '2') AND
  8655           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8656              OR
  8657           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8658           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8659           (AM-IG NOT = '1'))
  8660              GO TO 03XX-GET-LIFE-ERPLAN.
  8661
  8662     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8663       AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 159
* EL050.cbl
  8664        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8665        IF CF-LEVEL    (SUB3)
  8666           IF (PB-I-INDV-GRP-OVRD = 'I')
  8667              OR
  8668           ((AM-IG = '1') AND
  8669           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8670              OR
  8671           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8672           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8673            (AM-IG NOT = '2'))
  8674              GO TO 03XX-GET-LIFE-ERPLAN.
  8675
  8676     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8677       AND
  8678        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8679        IF CF-LEVEL    (SUB3)
  8680           IF (PB-I-INDV-GRP-OVRD = 'G')
  8681              OR
  8682           ((AM-IG = '2') AND
  8683           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8684              OR
  8685           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8686           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8687           (AM-IG NOT = '1'))
  8688              GO TO 03XX-GET-LIFE-ERPLAN.
  8689
  8690     IF SUB5 LESS THAN +30
  8691        ADD +1                   TO SUB5
  8692        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8693
  8694     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8695
  8696 03XX-EDIT-FOR-NINETY-LF-CONT.
  8697
  8698     MOVE +99                    TO SUB5.
  8699
  8700     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8701        IF PB-ISSUE
  8702           MOVE ER-1924          TO  WS-ERROR
  8703           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8704
  8705     GO TO 0304-LIFE-BENEFIT-FOUND.
  8706
  8707 03XX-GET-LIFE-ERPLAN.
  8708
  8709     IF WK-PLAN-ADDR EQUAL +0
  8710        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8711
  8712     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8713     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8714     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8715     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8716     MOVE 'Y'                    TO PLAN-MASTER-SW
  8717                                    PLAN-MASTER-LIFE-SW.
  8718     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8719
  8720 03XX-ERPLAN-LIFE-GETMAIN.
  8721
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 160
* EL050.cbl
  8722     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8723     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8724
  8725 03XX-ERPLAN-LIFE-READ.
  8726
  8727     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8728     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8729     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8730     MOVE PB-SV-STATE            TO PLAN-STATE.
  8731     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8732     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8733     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8734     MOVE WS-SAVE-BENEFIT-REVISION
  8735                                 TO PLAN-REVISION-NO.
  8736
  8737     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8738     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8739
  8740     IF PB-COMPANY-ID = 'NCL'
  8741       IF NOT LF-PLAN-MASTER-FOUND
  8742         IF NOT PB-POLICY-IS-DECLINED  AND
  8743            NOT PB-POLICY-IS-VOIDED
  8744             MOVE  ER-1921         TO  WS-ERROR
  8745             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8746             GO TO 0304-LIFE-BENEFIT-FOUND.
  8747
  8748     IF NOT LF-PLAN-MASTER-FOUND
  8749        GO TO 0304-LIFE-BENEFIT-FOUND.
  8750
  8751 XXXX-CHECK-LF-PLAN-KEY.
  8752
  8753     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8754        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8755        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8756        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8757        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8758        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8759        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8760        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8761        MOVE 'N'                 TO PLAN-MASTER-SW
  8762          GO TO 03XX-ERPLAN-LIFE-READ.
  8763
  8764     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8765
  8766     IF  PB-CANCELLATION
  8767         GO TO  0303-LF-ACCT-BEN-FOUND.
  8768
  8769     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8770        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8771           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8772           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8773              MOVE ER-2644             TO WS-ERROR
  8774              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8775           ELSE
  8776              NEXT SENTENCE
  8777        ELSE
  8778           IF PB-COMPANY-ID NOT = 'NCL'
  8779              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 161
* EL050.cbl
  8780                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8781
  8782 0303-LF-ACCT-BEN-FOUND.
  8783
  8784     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8785
  8786     IF PL-DEV-CODE NOT = SPACES
  8787        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8788
  8789     IF PL-DEV-PCT NUMERIC AND
  8790        PL-DEV-PCT NOT = ZEROS
  8791        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8792
  8793     IF PL-TOL-PREM-AMT GREATER THAN +0
  8794        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8795
  8796     IF PL-TOL-REF-AMT GREATER THAN +0
  8797        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8798
  8799     IF PL-TOL-PREM-PCT GREATER THAN +0
  8800        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8801
  8802     IF PL-TOL-REF-PCT GREATER THAN +0
  8803        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8804
  8805     IF PL-TOL-CLM-AMT GREATER THAN +0
  8806        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8807
  8808     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8809                          PL-OVER-SHORT-AMT > +0
  8810        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8811
  8812     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8813                          PL-OVER-SHORT-PCT > +0
  8814        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8815
  8816     IF PL-SALES-TAX NUMERIC AND
  8817                          PL-SALES-TAX > +0
  8818         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8819
  8820     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8821        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8822                                    WS-IG-OVRD-AM.
  8823
  8824 0304-LIFE-BENEFIT-FOUND.
  8825
  8826     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8827
  8828     IF PB-ISSUE
  8829        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8830     ELSE
  8831        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8832
  8833     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8834     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8835     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8836     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8837     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 162
* EL050.cbl
  8838                                         WS-LF-REFUND-CALC.
  8839     if (ws-lf-earnings-calc = '5')
  8840        and (pb-i-loan-apr = zeros)
  8841        and (benefit-code-chg)
  8842        move +99.9999 to pb-i-loan-apr
  8843     end-if
  8844
  8845     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8846        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8847
  8848     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8849        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8850     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8851
  8852     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8853     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8854     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8855     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8856     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8857     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8858
  8859     IF PB-COMPANY-ID = 'NCL'  AND
  8860        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8861         NEXT SENTENCE
  8862     ELSE
  8863         IF SUB5 NOT GREATER THAN +20
  8864            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8865               MOVE WS-SAVE-BENEFIT-REM-TERM
  8866                                      TO WS-AM-LF-BENE-REM-TERM
  8867                                         EC-BR-LF-REM-TERM-CALC.
  8868
  8869     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8870     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8871
  8872     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8873
  8874 0305-BENEFIT-NOT-FOUND.
  8875
  8876     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8877     MOVE ER-2604                TO WS-ERROR.
  8878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8879
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 163
* EL050.cbl
  8881
  8882 0310-FIND-AH-BENEFIT-RECORD.
  8883
  8884     MOVE 'N'                    TO PLAN-MASTER-SW
  8885                                    PLAN-MASTER-AH-SW.
  8886
  8887     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8888                                    WS-PL-TOL-AH-REFUND
  8889                                    WS-AH-PL-REF-OVS-AMT
  8890                                    WS-PL-TOL-AH-PREM-PCT
  8891                                    WS-PL-TOL-AH-REFUND-PCT
  8892                                    WS-AH-PL-REF-OVS-PCT
  8893                                    WS-PL-TOL-AH-CLAIM.
  8894     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8895
  8896
  8897     if pb-issue
  8898        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8899           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8900        end-if
  8901        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8902           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8903           GO TO 0399-BENEFIT-NOT-FOUND
  8904        end-if
  8905     end-if
  8906
  8907     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8908        GO TO 0400-FIND-CARRIER.
  8909
  8910     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8911
  8912     IF WK-AH-BEN-ADDR NOT = ZEROS
  8913         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8914         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8915         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8916         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8917           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8918             GO TO 0311-AH-BENEFIT-SEARCH
  8919         ELSE
  8920             NEXT SENTENCE
  8921     ELSE
  8922         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8923
  8924     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8925     MOVE '5'                    TO CNTL-REC-TYPE.
  8926     MOVE +0                     TO CNTL-SEQ-NO.
  8927     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8928
  8929     MOVE '2' TO RC-SW-2.
  8930     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8931
  8932     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8933        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8934          GO TO 0399-BENEFIT-NOT-FOUND.
  8935
  8936     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8937
  8938 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 164
* EL050.cbl
  8939
  8940     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8941
  8942     IF NO-BENEFIT-FOUND
  8943         GO TO 0399-BENEFIT-NOT-FOUND.
  8944
  8945     IF WS-BEN-CD = '99'
  8946        GO TO 0399-BENEFIT-NOT-FOUND.
  8947
  8948     IF PB-COMPANY-ID  =  'NCL'
  8949         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8950             GO TO 0314-A-H-BENEFIT-FOUND.
  8951
  8952     MOVE +1                     TO SUB5.
  8953     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8954
  8955* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8956* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8957     IF PB-COMPANY-ID = 'DMD'
  8958         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8959
  8960 0312-EDIT-ACCT-AH-BENEFITS.
  8961
  8962     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8963        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8964           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8965                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8966           GO TO 03XX-GET-AH-ERPLAN.
  8967
  8968     IF SUB5 LESS THAN +20
  8969        ADD +1                   TO SUB5
  8970        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8971
  8972     MOVE +1                     TO SUB5.
  8973
  8974     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8975        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8976
  8977 0313-EDIT-DMD-EXTRA-BENEFITS.
  8978
  8979     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8980        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8981           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8982                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8983           GO TO 03XX-GET-AH-ERPLAN.
  8984
  8985     IF SUB5 LESS THAN +30
  8986        ADD +1                   TO SUB5
  8987        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8988
  8989     MOVE +1                     TO SUB5.
  8990
  8991 03XX-EDIT-FOR-NINETY-AH.
  8992
  8993***************************************************************
  8994*                                                             *
  8995*    NINETY BENEFIT PLAN TYPES:                               *
  8996*                                                             *
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 165
* EL050.cbl
  8997*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8998*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8999*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9000*           BENEFIT CONTROLS.                                 *
  9001*      99 = ALL BENEFITS.                                     *
  9002*                                                             *
  9003***************************************************************
  9004
  9005     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9006                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9007
  9008     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9009       AND
  9010        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9011        GO TO 03XX-GET-AH-ERPLAN.
  9012
  9013     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9014       AND
  9015        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9016           IF (PB-I-INDV-GRP-OVRD = 'I')
  9017              OR
  9018           ((AM-IG = '1') AND
  9019           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9020              OR
  9021           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9022           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9023           (AM-IG NOT = '2'))
  9024              GO TO 03XX-GET-AH-ERPLAN.
  9025
  9026     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9027       AND
  9028        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9029           IF (PB-I-INDV-GRP-OVRD = 'G')
  9030              OR
  9031           ((AM-IG = '2') AND
  9032           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9033              OR
  9034           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9035           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9036           (AM-IG NOT = '1'))
  9037              GO TO 03XX-GET-AH-ERPLAN.
  9038
  9039     IF SUB5 LESS THAN +20
  9040        ADD +1                   TO SUB5
  9041        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9042
  9043     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9044        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9045
  9046     MOVE +1                    TO SUB5.
  9047
  9048 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9049
  9050     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9051                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9052
  9053     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9054       AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 166
* EL050.cbl
  9055        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9056        GO TO 03XX-GET-AH-ERPLAN.
  9057
  9058     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9059       AND
  9060        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9061           IF (PB-I-INDV-GRP-OVRD = 'I')
  9062              OR
  9063           ((AM-IG = '1') AND
  9064           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9065              OR
  9066           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9067           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9068           (AM-IG NOT = '2'))
  9069              GO TO 03XX-GET-AH-ERPLAN.
  9070
  9071     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9072       AND
  9073        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9074           IF (PB-I-INDV-GRP-OVRD = 'G')
  9075              OR
  9076           ((AM-IG = '2') AND
  9077           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9078              OR
  9079           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9080           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9081           (AM-IG NOT = '1'))
  9082              GO TO 03XX-GET-AH-ERPLAN.
  9083
  9084     IF SUB5 LESS THAN +30
  9085        ADD +1                   TO SUB5
  9086        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9087
  9088 03XX-EDIT-FOR-NINETY-AH-CONT.
  9089
  9090     MOVE +99                    TO SUB5.
  9091
  9092     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9093
  9094     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9095        IF PB-ISSUE
  9096           MOVE ER-1925          TO  WS-ERROR
  9097           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9098
  9099     GO TO 0314-A-H-BENEFIT-FOUND.
  9100
  9101 03XX-GET-AH-ERPLAN.
  9102
  9103     IF WK-PLAN-ADDR EQUAL +0
  9104         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9105
  9106     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9107     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9108     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9109     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9110     MOVE 'Y'                    TO PLAN-MASTER-SW
  9111                                    PLAN-MASTER-AH-SW.
  9112*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 167
* EL050.cbl
  9113     GO TO 03XX-ERPLAN-AH-READ.
  9114
  9115 03XX-ERPLAN-AH-GETMAIN.
  9116
  9117     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9118     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9119
  9120 03XX-ERPLAN-AH-READ.
  9121
  9122     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9123     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9124     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9125     MOVE PB-SV-STATE            TO PLAN-STATE.
  9126     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9127     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9128     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9129     MOVE WS-SAVE-BENEFIT-REVISION
  9130                                 TO PLAN-REVISION-NO.
  9131
  9132     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9133     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9134
  9135     IF PB-COMPANY-ID = 'NCL'
  9136       IF NOT AH-PLAN-MASTER-FOUND
  9137         IF NOT PB-POLICY-IS-DECLINED  AND
  9138            NOT PB-POLICY-IS-VOIDED
  9139             MOVE  ER-1922         TO  WS-ERROR
  9140             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9141             GO TO 0314-A-H-BENEFIT-FOUND.
  9142
  9143     IF NOT AH-PLAN-MASTER-FOUND
  9144        GO TO 0314-A-H-BENEFIT-FOUND.
  9145
  9146 XXXX-CHECK-AH-PLAN-KEY.
  9147
  9148     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9149        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9150        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9151        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9152        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9153        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9154        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9155        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9156        MOVE 'N'                 TO PLAN-MASTER-SW
  9157          GO TO 03XX-ERPLAN-AH-READ.
  9158
  9159     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9160
  9161     IF  PB-CANCELLATION
  9162         GO TO  0313-AH-ACCT-BEN-FOUND.
  9163
  9164     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9165       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9166          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9167          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9168             MOVE ER-2644             TO WS-ERROR
  9169             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9170          ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 168
* EL050.cbl
  9171             NEXT SENTENCE
  9172       ELSE
  9173          IF PB-COMPANY-ID NOT = 'NCL'
  9174             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9175                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9176
  9177 0313-AH-ACCT-BEN-FOUND.
  9178
  9179     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9180
  9181     IF PL-DEV-CODE NOT = SPACES
  9182        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9183
  9184     IF PL-DEV-PCT NUMERIC AND
  9185        PL-DEV-PCT NOT = ZEROS
  9186        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9187
  9188     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9189        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9190
  9191     IF PL-TOL-REF-AMT NOT EQUAL +0
  9192        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9193
  9194     IF PL-TOL-PREM-PCT GREATER THAN +0
  9195        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9196
  9197     IF PL-TOL-REF-PCT GREATER THAN +0
  9198        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9199
  9200     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9201        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9202
  9203     IF PL-OVER-SHORT-AMT NUMERIC AND
  9204                          PL-OVER-SHORT-AMT > +0
  9205        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9206
  9207     IF PL-OVER-SHORT-PCT NUMERIC AND
  9208                          PL-OVER-SHORT-PCT > +0
  9209        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9210
  9211     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9212        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9213        IF WS-IG-OVRD-AM EQUAL SPACES
  9214            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9215
  9216 0314-A-H-BENEFIT-FOUND.
  9217
  9218     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9219
  9220     IF PB-ISSUE
  9221        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9222       ELSE
  9223        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9224
  9225     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9226     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9227     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9228     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 169
* EL050.cbl
  9229                                         WS-AH-REFUND-CALC.
  9230
  9231     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9232        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9233
  9234     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9235        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9236     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9237
  9238     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9239     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9240     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9241     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9242     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9243     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9244
  9245     IF PB-COMPANY-ID = 'NCL'  AND
  9246        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9247         NEXT SENTENCE
  9248     ELSE
  9249         IF SUB5 NOT GREATER THAN +20
  9250            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9251                MOVE WS-SAVE-BENEFIT-REM-TERM
  9252                                      TO WS-AM-AH-BENE-REM-TERM
  9253                                         EC-BR-AH-REM-TERM-CALC.
  9254
  9255     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9256     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9257
  9258     GO TO 0400-FIND-CARRIER.
  9259
  9260 0399-BENEFIT-NOT-FOUND.
  9261
  9262     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9263     MOVE ER-2605                TO WS-ERROR.
  9264     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9265
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 170
* EL050.cbl
  9267
  9268 0400-FIND-CARRIER.
  9269
  9270     MOVE PB-SV-CARRIER          TO WS-CARR.
  9271
  9272     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9273     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9274     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9275     MOVE '6'                    TO CNTL-REC-TYPE.
  9276
  9277*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9278     MOVE SPACE                  TO WS-DMD-RATING-SW
  9279                                    EC-BR-DMD-RATING-SW.
  9280
  9281     MOVE '2'                    TO RC-SW-1.
  9282     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9283
  9284     IF NOT CF-CARRIER-MASTER
  9285        GO TO 0400-CARRIER-NOT-FOUND.
  9286
  9287 0400-BUILD-CARR-TOL.
  9288
  9289     IF CF-CR-TOL-PREM NUMERIC AND
  9290        CF-CR-TOL-PREM GREATER THAN +0
  9291        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9292                                    WS-TOL-AH-PREM.
  9293
  9294     IF CF-CR-TOL-REFUND NUMERIC AND
  9295        CF-CR-TOL-REFUND GREATER THAN +0
  9296        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9297                                    WS-TOL-AH-REFUND.
  9298
  9299     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9300        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9301        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9302                                    WS-AH-REFUND-OVS-AMT.
  9303
  9304     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9305        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9306        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9307                                    WS-AH-REFUND-OVS-PCT.
  9308
  9309     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9310        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9311        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9312                                    WS-TOL-AH-PREM-PCT.
  9313
  9314     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9315        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9316        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9317                                     WS-TOL-AH-REFUND-PCT.
  9318
  9319     IF CF-COMPANY-ID EQUAL 'DMD'
  9320         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9321                                    EC-BR-DMD-RATING-SW.
  9322
  9323     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9324     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 171
* EL050.cbl
  9325        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9326     END-IF
  9327     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9328        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9329     END-IF
  9330     IF WS-TOL-CLP-PCT = ZEROS
  9331        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9332     END-IF
  9333
  9334     IF WS-SPP-LEASE-COMM = ZEROS
  9335        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9336     END-IF
  9337     GO TO 0400-FIND-ERPDEF.
  9338
  9339 0400-CARRIER-NOT-FOUND.
  9340
  9341     MOVE ER-2602                TO WS-ERROR.
  9342     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9343
  9344 0400-FIND-ERPDEF.
  9345     IF PB-COMPANY-ID = 'DCC'
  9346        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9347        CONTINUE
  9348     ELSE
  9349        GO TO 0400-FIND-ERCOMP
  9350     END-IF
  9351     MOVE ' '                    TO PDEF-MASTER-SW
  9352     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9353     MOVE PB-STATE               TO ERPDEF-STATE
  9354     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9355     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9356     IF PB-ISSUE
  9357        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9358     ELSE
  9359        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9360     END-IF
  9361     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9362     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9363     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9364     IF PDEF-MASTER-FOUND
  9365        MOVE 'N'                 TO PDEF-MASTER-SW
  9366        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9367        IF PDEF-MASTER-FOUND
  9368           IF (ERPDEF-KEY-SAVE (1:16) =
  9369                        PD-CONTROL-PRIMARY (1:16))
  9370              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9371              CONTINUE
  9372           ELSE
  9373              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9374              IF (ERPDEF-KEY-SAVE (1:16) =
  9375                        PD-CONTROL-PRIMARY (1:16))
  9376                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9377                 CONTINUE
  9378              ELSE
  9379                 MOVE 'N'        TO PDEF-MASTER-SW
  9380              END-IF
  9381           END-IF
  9382        END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 172
* EL050.cbl
  9383        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9384     END-IF
  9385     IF PDEF-MASTER-FOUND
  9386        IF PD-TRUNCATED = 'Y'
  9387           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9388        END-IF
  9389     END-IF
  9390     .
  9391 0400-FIND-ERCOMP.
  9392     IF PB-COMPANY-ID = 'DCC'
  9393        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9394           (WS-SUB1 > +10)
  9395           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9396                 OR 'A' OR 'N'
  9397              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9398              MOVE PB-CARRIER    TO COMP-CARRIER
  9399              MOVE PB-GROUPING   TO COMP-GROUPING
  9400              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9401              MOVE AM-AGT (WS-SUB1)
  9402                                 TO COMP-FIN-RESP
  9403              MOVE 'G'           TO COMP-TYPE
  9404              PERFORM 8582-READ-COMPENSATION-MASTER
  9405                                 THRU 8582-EXIT
  9406              IF COMP-MASTER-FOUND
  9407                 IF CO-GA-INACTIVE
  9408                    MOVE ER-2763 TO WS-ERROR
  9409                    PERFORM 9900-ERROR-FORMAT
  9410                                 THRU 9900-EXIT
  9411                    MOVE +11     TO WS-SUB1
  9412                 END-IF
  9413                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9414                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9415                    MOVE ER-2788 TO WS-ERROR
  9416                    PERFORM 9900-ERROR-FORMAT
  9417                                 THRU 9900-EXIT
  9418                    MOVE +11     TO WS-SUB1
  9419                 END-IF
  9420              END-IF
  9421           END-IF
  9422        END-PERFORM
  9423     END-IF
  9424     IF PB-COMPANY-ID = 'DCC'
  9425        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9426           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9427                                    WS-CLP-STATE
  9428        ELSE
  9429           MOVE SPACES           TO PB-I-CLP-STATE
  9430                                    WS-CLP-STATE
  9431        END-IF
  9432     END-IF
  9433
  9434     IF (PB-COMPANY-ID = 'DCC')
  9435        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9436        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9437        CONTINUE
  9438     ELSE
  9439        GO TO 0400-FIND-STATE-RECORD
  9440     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 173
* EL050.cbl
  9441     MOVE SPACES                 TO WS-CLP-STATE
  9442     MOVE +0                     TO WS-BANK-FEE
  9443                                    WS-BANK-LFEE
  9444                                    WS-BANK-NOCHRGB
  9445
  9446     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9447     IF (PB-ISSUE)
  9448        AND (PB-I-BANK-NUMBER NOT =
  9449            SPACES AND ZEROS AND LOW-VALUES)
  9450        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9451     ELSE
  9452        IF (PB-CANCELLATION)
  9453           AND (PB-CI-BANK-NUMBER NOT =
  9454                SPACES AND ZEROS AND LOW-VALUES)
  9455           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9456        END-IF
  9457     END-IF
  9458     IF COMP-FIN-RESP NOT = LOW-VALUES
  9459        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9460        MOVE PB-CARRIER          TO COMP-CARRIER
  9461        MOVE PB-GROUPING         TO COMP-GROUPING
  9462        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9463        MOVE 'B'                 TO COMP-TYPE
  9464        PERFORM 8582-READ-COMPENSATION-MASTER
  9465                                 THRU 8582-EXIT
  9466        IF COMP-MASTER-FOUND
  9467           IF CO-MAX-BANK-FEE NOT NUMERIC
  9468              MOVE +0            TO CO-MAX-BANK-FEE
  9469           END-IF
  9470           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9471              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9472           END-IF
  9473           IF CO-GA-INACTIVE
  9474              MOVE ER-2763       TO WS-ERROR
  9475              PERFORM 9900-ERROR-FORMAT
  9476                                 THRU 9900-EXIT
  9477           END-IF
  9478           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9479              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9480              MOVE ER-2788 TO WS-ERROR
  9481              PERFORM 9900-ERROR-FORMAT
  9482                                 THRU 9900-EXIT
  9483              MOVE +11     TO WS-SUB1
  9484           END-IF
  9485           IF WS-AH-BEN-CATEGORY = 'G'
  9486              MOVE CO-MAX-BANK-FEE
  9487                                 TO WS-BANK-FEE
  9488                                    PB-I-BANK-FEE
  9489           ELSE
  9490              MOVE CO-MAX-BANK-FEE-LEASE
  9491                                 TO WS-BANK-LFEE
  9492                                    PB-I-BANK-FEE
  9493           END-IF
  9494           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9495              AND (WS-AH-REFUND-CALC = 'G'))
  9496                        OR
  9497              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9498              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 174
* EL050.cbl
  9499              CONTINUE
  9500           ELSE
  9501              MOVE ER-2789 TO WS-ERROR
  9502              PERFORM 9900-ERROR-FORMAT
  9503                                 THRU 9900-EXIT
  9504           END-IF
  9505           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9506                                    PB-I-CLP-STATE
  9507           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9508           MOVE CO-CARRIER       TO BXRF-CARRIER
  9509           MOVE CO-GROUPING      TO BXRF-GROUPING
  9510           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9511           MOVE BXRF-MAX-REC-LENGTH
  9512                                 TO BXRF-REC-LENGTH
  9513           PERFORM 8584-READ-BANK-CROSS-REF
  9514                                 THRU 8584-EXIT
  9515           IF BXRF-MASTER-FOUND
  9516              MOVE ' '           TO BANK-ACCT-SW
  9517              MOVE BK-BANK-POINTER-CNT
  9518                                 TO BK-BANK-POINTER-CNT
  9519              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9520                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9521                 OR (BANK-ACCT-FOUND)
  9522                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9523                    AND (BK-AM-EXP-DT (WS-SUB1)
  9524                                 > PB-CERT-EFF-DT)
  9525                    AND (BK-AM-EFF-DT (WS-SUB1)
  9526                                 NOT > PB-CERT-EFF-DT)
  9527                    SET BANK-ACCT-FOUND TO TRUE
  9528                 END-IF
  9529              END-PERFORM
  9530              IF NOT BANK-ACCT-FOUND
  9531                 MOVE ZEROS      TO WS-BANK-FEE
  9532                                    WS-BANK-LFEE
  9533                 MOVE ER-2869    TO WS-ERROR
  9534                 PERFORM 9900-ERROR-FORMAT
  9535                                 THRU 9900-EXIT
  9536              ELSE
  9537                 PERFORM 5000-PROCESS-REPS
  9538                                 THRU 5000-EXIT
  9539                 IF AGENT-MASTER-FOUND
  9540                    MOVE +0      TO WS-BANK-FEE
  9541                                    WS-BANK-LFEE
  9542*                   MOVE AG-SPP-FEES (1)
  9543*                                TO PB-I-BANK-FEE
  9544*                                   WS-BANK-FEE
  9545                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9546                       (WS-SUB1 > +10)
  9547                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9548                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9549                       END-IF
  9550                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9551                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9552                       END-IF
  9553                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9554                          AG-SPP-FEES (WS-SUB1)
  9555                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9556                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 175
* EL050.cbl
  9557                    END-PERFORM
  9558                    IF WS-AH-BEN-CATEGORY = 'G'
  9559                       MOVE WS-BANK-FEE
  9560                                 TO PB-I-BANK-FEE
  9561                    ELSE
  9562                       MOVE WS-BANK-LFEE
  9563                                 TO PB-I-BANK-FEE
  9564                    END-IF
  9565                 END-IF
  9566              END-IF
  9567           END-IF
  9568        ELSE
  9569           MOVE ER-2879          TO WS-ERROR
  9570           PERFORM 9900-ERROR-FORMAT
  9571                                 THRU 9900-EXIT
  9572        END-IF
  9573     ELSE
  9574        MOVE ER-2879             TO WS-ERROR
  9575        PERFORM 9900-ERROR-FORMAT
  9576                                 THRU 9900-EXIT
  9577     END-IF
  9578     IF WS-AH-BEN-CATEGORY = 'G'
  9579        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9580        + WS-BANK-FEE
  9581     ELSE
  9582        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9583        + WS-BANK-LFEE
  9584     END-IF
  9585     .
  9586 0400-FIND-STATE-RECORD.
  9587
  9588     IF WK-STATE-ADDR NOT = ZEROS
  9589         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9590         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9591         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9592         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9593         IF PB-SV-STATE = CF-STATE-CODE
  9594             GO TO 0405-CONTINUE-EDIT
  9595         ELSE
  9596             NEXT SENTENCE
  9597     ELSE
  9598         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9599
  9600     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9601     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9602     MOVE '3'                    TO CNTL-REC-TYPE.
  9603     MOVE +0                     TO CNTL-SEQ-NO.
  9604
  9605     MOVE '3'                    TO RC-SW-2.
  9606     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9607
  9608     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9609        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9610        PB-SV-STATE   NOT = CF-STATE-CODE)
  9611        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9612                                    WS-TOL-AH-CLAIM
  9613                                    WS-MINIMUM-REFUND
  9614                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 176
* EL050.cbl
  9615                                    WS-TOL-AH-PREM
  9616                                    WS-TOL-LF-REFUND
  9617                                    WS-TOL-AH-REFUND
  9618                                    EC-ST-TOL-PREM-PCT
  9619                                    WS-TOL-LF-PREM-PCT
  9620                                    WS-TOL-AH-PREM-PCT
  9621                                    EC-ST-TOL-REFUND-PCT
  9622                                    WS-TOL-LF-REFUND-PCT
  9623                                    WS-TOL-AH-REFUND-PCT
  9624                                    EC-ST-TOL-PREM
  9625                                    EC-ST-TOL-REFUND
  9626                                    EC-ST-FST-PMT-DAYS-MAX
  9627                                    WS-FREE-LOOK-PERIOD
  9628                                    WS-ST-LF-PREM-TAX
  9629                                    WS-ST-AH-PREM-TAX-I
  9630                                    WS-ST-AH-PREM-TAX-G
  9631                                    WS-BANK-FEE
  9632                                    WS-BANK-LFEE
  9633                                    WS-TOL-CLP-PCT
  9634                                    WS-SPP-LEASE-COMM
  9635        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9636                                    EC-ST-FST-PMT-DAYS-CHG
  9637                                    WS-LF-REM-TERM-CALC
  9638                                    WS-LF-REFUND-CALC
  9639                                    EC-ST-LF-REM-TERM-CALC
  9640                                    EC-ST-LF-REFUND-CALC
  9641                                    WS-AH-REM-TERM-CALC
  9642                                    WS-AH-REFUND-CALC
  9643                                    WS-LF-BEN-CATEGORY
  9644                                    WS-AH-BEN-CATEGORY
  9645                                    WS-CLP-STATE
  9646                                    WS-ST-REFUND-CLAIM-FLAG
  9647                                    WS-ST-CAUSAL-STATE
  9648                                    EC-ST-AH-REM-TERM-CALC
  9649                                    EC-ST-AH-REFUND-CALC
  9650          GO TO 0499-STATE-NOT-FOUND.
  9651
  9652     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9653
  9654 0405-CONTINUE-EDIT.
  9655
  9656     if pb-company-id = 'AHL'
  9657        continue
  9658     else
  9659        IF PB-CERT-PRIME NOT NUMERIC
  9660           MOVE ER-2722          TO WS-ERROR
  9661           PERFORM 9900-ERROR-FORMAT
  9662                                 THRU 9900-EXIT
  9663        end-if
  9664     END-IF
  9665*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9666*       MOVE +0                  TO SUB3
  9667*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9668*       IF SUB3 > +0
  9669*          MOVE ER-2722          TO WS-ERROR
  9670*          PERFORM 9900-ERROR-FORMAT
  9671*                                THRU 9900-EXIT
  9672*       END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 177
* EL050.cbl
  9673*    END-IF
  9674*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9675*       IF PB-CERT-PRIME NOT NUMERIC
  9676*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9677*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9678*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9679*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9680*
  9681*          MOVE ER-2722          TO WS-ERROR
  9682*          PERFORM 9900-ERROR-FORMAT
  9683*                                THRU 9900-EXIT
  9684*       END-IF
  9685*    END-IF
  9686
  9687     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9688
  9689     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9690        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9691                                    WS-TOL-AH-CLAIM.
  9692
  9693     IF CF-ST-REFUND-MIN NOT NUMERIC
  9694        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9695
  9696     IF CF-ST-REFUND-MIN NOT = ZEROS
  9697        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9698
  9699     IF CF-ST-TOL-PREM  NOT = ZEROS
  9700        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9701                                    WS-TOL-AH-PREM
  9702        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9703
  9704     IF CF-ST-TOL-REFUND NOT = ZEROS
  9705        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9706                                    WS-TOL-AH-REFUND
  9707        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9708
  9709     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9710        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9711        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9712                                    WS-AH-REFUND-OVS-AMT
  9713                                    EC-ST-OVR-SHT-AMT.
  9714
  9715     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9716        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9717        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9718                                    WS-TOL-LF-PREM-PCT
  9719                                    WS-TOL-AH-PREM-PCT.
  9720
  9721     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9722        CF-ST-TOL-REF-PCT GREATER THAN +0
  9723        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9724                                    WS-TOL-LF-REFUND-PCT
  9725                                    WS-TOL-AH-REFUND-PCT.
  9726
  9727     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9728        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9729        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9730                                    WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 178
* EL050.cbl
  9731                                    EC-ST-OVR-SHT-PCT.
  9732
  9733     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9734     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9735
  9736     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9737          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9738
  9739     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9740     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9741     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9742
  9743     IF CF-ST-LF-PREM-TAX NUMERIC
  9744        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9745     END-IF
  9746     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9747        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9748     END-IF
  9749     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9750        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9751     END-IF
  9752
  9753     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9754         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9755     END-IF.
  9756
  9757     IF CF-ST-CAUSAL-STATE > SPACES
  9758         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9759     END-IF.
  9760
  9761     IF WS-LF-BENEFIT-CD = ZEROS
  9762        GO TO 0410-CHECK-AH.
  9763
  9764     IF CF-ST-RT-CALC NOT = SPACES
  9765        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9766                                    EC-ST-LF-REM-TERM-CALC
  9767     END-IF
  9768
  9769     IF WS-LF-COVERAGE-TYPE = 'R'
  9770        IF WS-LF-EARNINGS-CALC = '5'
  9771           IF CF-ST-RF-LN-CALC > '0'
  9772              MOVE CF-ST-RF-LN-CALC
  9773                                 TO WS-LF-REFUND-CALC
  9774                                    EC-ST-LF-REFUND-CALC
  9775           END-IF
  9776        ELSE
  9777           IF CF-ST-RF-LR-CALC > '0'
  9778              MOVE CF-ST-RF-LR-CALC
  9779                                 TO WS-LF-REFUND-CALC
  9780                                    EC-ST-LF-REFUND-CALC
  9781           END-IF
  9782        END-IF
  9783     ELSE
  9784        IF CF-ST-RF-LL-CALC > '0'
  9785           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9786                                    EC-ST-LF-REFUND-CALC
  9787        END-IF
  9788     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 179
* EL050.cbl
  9789
  9790     IF CF-ST-RT-CALC NOT = SPACES
  9791        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9792                                    EC-ST-LF-REM-TERM-CALC
  9793     END-IF
  9794
  9795     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9796     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9797
  9798     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9799
  9800     IF NO-BENEFIT-FOUND
  9801        GO TO 0410-CHECK-AH.
  9802
  9803     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9804        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9805                                 TO EC-ST-LF-REM-TERM-CALC
  9806                                    WS-LF-REM-TERM-CALC
  9807     END-IF
  9808
  9809     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9810        MOVE CF-ST-REFUND-CALC (SUB3)
  9811                                 TO WS-LF-REFUND-CALC
  9812                                    EC-ST-LF-REFUND-CALC
  9813     END-IF
  9814*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9815
  9816     .
  9817 0410-CHECK-AH.
  9818
  9819     IF WS-AH-BENEFIT-CD = ZEROS
  9820        GO TO 0500-SET-ACCOUNT.
  9821
  9822     IF CF-ST-RT-CALC NOT = SPACES
  9823        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9824                                    EC-ST-AH-REM-TERM-CALC
  9825     END-IF
  9826
  9827     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9828        IF CF-ST-RF-CP-CALC > '0'
  9829           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9830                                    EC-ST-AH-REFUND-CALC
  9831        END-IF
  9832     ELSE
  9833        IF CF-ST-RF-AH-CALC > '0'
  9834           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9835                                    EC-ST-AH-REFUND-CALC
  9836        END-IF
  9837     END-IF
  9838     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9839     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9840
  9841     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9842
  9843     IF NO-BENEFIT-FOUND
  9844        GO TO 0500-SET-ACCOUNT.
  9845
  9846     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 180
* EL050.cbl
  9847        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9848                                 TO WS-AH-REM-TERM-CALC
  9849                                    EC-ST-AH-REM-TERM-CALC
  9850     END-IF
  9851
  9852     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9853        MOVE CF-ST-REFUND-CALC (SUB3)
  9854                                 TO WS-AH-REFUND-CALC
  9855                                    EC-ST-AH-REFUND-CALC
  9856     END-IF
  9857
  9858*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9859
  9860     GO TO 0500-SET-ACCOUNT.
  9861
  9862 0499-STATE-NOT-FOUND.
  9863
  9864     MOVE ER-2603                TO WS-ERROR.
  9865     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9866
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 181
* EL050.cbl
  9868
  9869 0500-SET-ACCOUNT.
  9870*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9871     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9872        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9873        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9874        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9875        MOVE '3'                 TO CNTL-REC-TYPE
  9876        MOVE +0                  TO CNTL-SEQ-NO
  9877
  9878        MOVE '3'                 TO RC-SW-2
  9879        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9880
  9881        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9882           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9883           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9884           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9885                                    WS-ST-AH-PREM-TAX-I
  9886                                    WS-ST-AH-PREM-TAX-G
  9887        ELSE
  9888           IF CF-ST-LF-PREM-TAX NUMERIC
  9889              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9890           END-IF
  9891           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9892              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9893           END-IF
  9894           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9895              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9896           END-IF
  9897        END-IF
  9898        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9899     END-IF
  9900*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9901*  FOR DCC ONLY
  9902     IF PB-COMPANY-ID = 'DCC'
  9903
  9904     MOVE ' '                    TO STAT-MASTER-SW
  9905     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9906     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9907     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9908     MOVE PB-STATE               TO ELSTAT-STATE
  9909     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9910        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9911     END-IF
  9912
  9913     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9914     SET BIN-TO-GREG             TO TRUE
  9915     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9916     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9917     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9918
  9919     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9920     IF STAT-MASTER-FOUND
  9921        MOVE 'N'                 TO STAT-MASTER-SW
  9922        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9923        IF STAT-MASTER-FOUND
  9924           IF (ELSTAT-KEY-SAVE (1:12) =
  9925                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 182
* EL050.cbl
  9926              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9927                 MOVE 'F'        TO STAT-MASTER-SW
  9928              ELSE
  9929                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9930                 IF (STAT-MASTER-FOUND)
  9931                    AND (ELSTAT-KEY-SAVE (1:12) =
  9932                        SF-CONTROL-PRIMARY (1:12))
  9933                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9934                    MOVE 'F'     TO STAT-MASTER-SW
  9935                 END-IF
  9936              END-IF
  9937           END-IF
  9938        END-IF
  9939     END-IF
  9940
  9941     IF STAT-MASTER-SW = 'F'
  9942        IF SF-ST-LF-PREM-TAX NUMERIC
  9943           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9944        END-IF
  9945        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9946           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9947        END-IF
  9948        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9949           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9950        END-IF
  9951     END-IF
  9952
  9953     END-IF
  9954     IF (PB-COMPANY-ID = 'DCC')
  9955        AND (PB-ISSUE)
  9956        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9957        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9958        AND (AM-GPCD = 06)
  9959        MOVE 'Y'                 TO WS-GOOD-HIN
  9960        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9961           MOVE PB-I-VIN         TO WS-WORK-VIN
  9962           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9963              (V1 > 16)
  9964              IF WS-WORK-VIN (V1:1) NUMERIC
  9965                 MOVE WS-WORK-VIN-N (V1)
  9966                                 TO WS-ROW-B-VAL (V1)
  9967              ELSE
  9968                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9969                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9970                    OR (V2 > 26)
  9971                 END-PERFORM
  9972                 IF V2 < 27
  9973                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9974                 ELSE
  9975                    MOVE 'N'     TO WS-GOOD-HIN
  9976                 END-IF
  9977              END-IF
  9978              COMPUTE WS-ROW-D-VAL (V1) =
  9979                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9980              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9981                 WS-ROW-D-VAL (V1)
  9982           END-PERFORM
  9983           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 183
* EL050.cbl
  9984           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9985             REMAINDER WS-VIN-REMAINDER
  9986           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9987              CONTINUE
  9988           ELSE
  9989              MOVE 'N'           TO WS-GOOD-HIN
  9990           END-IF
  9991        ELSE
  9992           MOVE 'N'              TO WS-GOOD-HIN
  9993        END-IF
  9994        IF WS-GOOD-HIN NOT = 'Y'
  9995           MOVE ER-3826           TO WS-ERROR
  9996           PERFORM 9900-ERROR-FORMAT
  9997                                 THRU 9900-EXIT
  9998        END-IF
  9999     END-IF
 10000     IF (PB-COMPANY-ID = 'DCC')
 10001        AND (PB-ISSUE)
 10002        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10003        AND (AM-GPCD NOT = 06)
 10004        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10005          MOVE PB-I-VIN          TO WS-WORK-VIN
 10006          MOVE +8                TO V2
 10007          MOVE ZEROS             TO WS-VIN-TOTAL
 10008          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10009           (V1 > 17)
 10010             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10011                MOVE ER-3825     TO WS-ERROR
 10012                PERFORM 9900-ERROR-FORMAT
 10013                                 THRU 9900-EXIT
 10014             ELSE
 10015                IF V1 = 8
 10016                   MOVE 10       TO V2
 10017                END-IF
 10018                IF V1 = 9
 10019                   MOVE 0        TO V2
 10020                END-IF
 10021                IF V1 = 10
 10022                   MOVE 9        TO V2
 10023                END-IF
 10024                IF WS-WORK-VIN (V1:1) NUMERIC
 10025                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10026                    + (WS-WORK-VIN-N (V1) * V2)
 10027                ELSE
 10028                   MOVE WS-WORK-VIN (V1:1)
 10029                                 TO WS-HEX-BYTE
 10030                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10031                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10032                    + (WS-NUM (V3) * V2)
 10033                END-IF
 10034                COMPUTE V2 = V2 - 1
 10035             END-IF
 10036          END-PERFORM
 10037          MOVE ZEROS TO WS-VIN-REMAINDER
 10038          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10039             REMAINDER WS-VIN-REMAINDER
 10040          IF ((WS-WORK-VIN (9:1) = 'X')
 10041             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 184
* EL050.cbl
 10042                     OR
 10043             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10044             CONTINUE
 10045          ELSE
 10046             MOVE ER-3826        TO WS-ERROR
 10047             PERFORM 9900-ERROR-FORMAT
 10048                                 THRU 9900-EXIT
 10049          END-IF
 10050        ELSE
 10051          MOVE ER-3826           TO WS-ERROR
 10052          PERFORM 9900-ERROR-FORMAT
 10053                                 THRU 9900-EXIT
 10054        END-IF
 10055     END-IF
 10056******************************************************************
 10057******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10058******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10059******* METHODS.
 10060******************************************************************
 10061     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10062        IF PB-CANCELLATION
 10063           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10064              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10065                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10066                IF FORM-MASTER-FOUND
 10067                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10068******************************************************************
 10069
 10070     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10071     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10072
 10073     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10074     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10075     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10076     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10077
 10078
 10079     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10080     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10081     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10082
 10083     IF AM-LF-OB-RATE NOT NUMERIC
 10084         MOVE ZERO               TO AM-LF-OB-RATE.
 10085
 10086     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10087         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10088
 10089     IF AM-AH-OB-RATE NOT NUMERIC
 10090         MOVE ZERO               TO AM-AH-OB-RATE.
 10091
 10092     IF WS-LF-JOINT-INDICATOR = 'J'
 10093         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10094     ELSE
 10095         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10096
 10097     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10098
 10099     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 185
* EL050.cbl
 10100         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10101
 10102     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10103         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10104                                       WS-IG-OVRD
 10105     ELSE
 10106         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10107             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10108                                       WS-IG-OVRD
 10109         ELSE
 10110             MOVE AM-IG             TO WS-IG-OVRD-AH
 10111                                       WS-IG-OVRD.
 10112
 10113     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10114         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10115                                       WS-IG-OVRD
 10116     ELSE
 10117         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10118             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10119                                       WS-IG-OVRD
 10120         ELSE
 10121             MOVE AM-IG             TO WS-IG-OVRD-LF
 10122                                       WS-IG-OVRD.
 10123
 10124     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10125     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10126     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10127     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10128     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10129
 10130     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10131     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10132     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10133     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10134
 10135     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10136     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10137     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10138     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10139     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10140     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10141     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10142
 10143     IF WS-ACCT-AH-DEV-PCT > +0
 10144        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10145     ELSE
 10146        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10147
 10148     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10149        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10150     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10151        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10152
 10153        IF AM-EARN-METHOD-L = 'S'
 10154            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10155                                        WS-LF-REFUND-CALC.
 10156
 10157        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 186
* EL050.cbl
 10158            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10159                                        WS-LF-REFUND-CALC.
 10160
 10161     IF WS-LF-COVERAGE-TYPE = 'R'
 10162         IF AM-EARN-METHOD-R = 'R'
 10163            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10164                                    WS-LF-REFUND-CALC.
 10165     IF WS-LF-COVERAGE-TYPE = 'R'
 10166         IF AM-EARN-METHOD-R = 'P'
 10167            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10168                                    WS-LF-REFUND-CALC.
 10169     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10170         IF AM-EARN-METHOD-L = 'R'
 10171            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10172                                    WS-LF-REFUND-CALC.
 10173     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10174         IF AM-EARN-METHOD-L = 'P'
 10175            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10176                                    WS-LF-REFUND-CALC.
 10177     IF WS-LF-COVERAGE-TYPE = 'R'
 10178         IF AM-EARN-METHOD-R = 'A'
 10179            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10180                                    WS-LF-REFUND-CALC.
 10181     IF WS-LF-COVERAGE-TYPE = 'R'
 10182         IF AM-EARN-METHOD-R = 'M'
 10183            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10184                                    WS-LF-REFUND-CALC.
 10185     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10186         IF AM-EARN-METHOD-L = 'A'
 10187            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10188                                    WS-LF-REFUND-CALC.
 10189     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10190         IF AM-EARN-METHOD-L = 'M'
 10191            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10192                                    WS-LF-REFUND-CALC.
 10193
 10194     IF AM-EARN-METHOD-A = 'R'
 10195        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10196                                    WS-AH-REFUND-CALC.
 10197     IF AM-EARN-METHOD-A = 'P'
 10198        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10199                                    WS-AH-REFUND-CALC.
 10200     IF AM-EARN-METHOD-A = 'C'
 10201        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10202                                    WS-AH-REFUND-CALC.
 10203     IF AM-EARN-METHOD-A = 'A'
 10204        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10205                                    WS-AH-REFUND-CALC.
 10206     IF AM-EARN-METHOD-A = 'M'
 10207        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10208                                    WS-AH-REFUND-CALC.
 10209     IF AM-EARN-METHOD-A = 'N'
 10210        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10211                                    WS-AH-REFUND-CALC.
 10212     IF AM-EARN-METHOD-A = 'S'
 10213        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10214                                    WS-AH-REFUND-CALC.
 10215
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 187
* EL050.cbl
 10216     IF AM-TOL-PREM NOT = ZEROS
 10217        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10218                                    WS-TOL-AH-PREM.
 10219
 10220     IF AM-OVR-SHT-AMT NUMERIC AND
 10221                  AM-OVR-SHT-AMT > 0
 10222        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10223                                    EC-AM-LF-OVR-SHT-AMT
 10224                                    WS-AH-REFUND-OVS-AMT
 10225                                    EC-AM-AH-OVR-SHT-AMT.
 10226
 10227     IF AM-OVR-SHT-PCT NUMERIC AND
 10228                    AM-OVR-SHT-PCT > 0
 10229        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10230                                    EC-AM-LF-OVR-SHT-PCT
 10231                                    WS-AH-REFUND-OVS-PCT
 10232                                    EC-AM-AH-OVR-SHT-PCT.
 10233
 10234     IF AM-TOL-REF-PCT NUMERIC AND
 10235                  AM-TOL-REF-PCT > 0
 10236        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10237                                    WS-TOL-AH-REFUND-PCT.
 10238
 10239     IF AM-TOL-REF  NOT = ZEROS  AND
 10240                  AM-TOL-REF NUMERIC
 10241        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10242                                    EC-AM-LF-TOL-REFUND
 10243                                    WS-TOL-AH-REFUND
 10244                                    EC-AM-AH-TOL-REFUND.
 10245
 10246     IF AM-TOL-CLM  NOT = ZEROS
 10247        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10248                                    WS-TOL-AH-CLAIM.
 10249
 10250     IF AM-CLP-TOL-PCT NOT NUMERIC
 10251        MOVE +0                  TO AM-CLP-TOL-PCT
 10252     END-IF
 10253
 10254     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10255        MOVE +0                  TO AM-SPP-LEASE-COMM
 10256     END-IF
 10257     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10258        MOVE WS-PL-TOL-LF-PREM-PCT
 10259                                 TO WS-TOL-LF-PREM-PCT.
 10260
 10261     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10262        MOVE WS-PL-TOL-AH-PREM-PCT
 10263                                 TO WS-TOL-AH-PREM-PCT.
 10264
 10265     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10266        MOVE WS-PL-TOL-LF-REFUND-PCT
 10267                                 TO WS-TOL-LF-REFUND-PCT.
 10268
 10269     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10270        MOVE WS-PL-TOL-AH-REFUND-PCT
 10271                                 TO WS-TOL-AH-REFUND-PCT.
 10272
 10273     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 188
* EL050.cbl
 10274        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10275
 10276     IF WS-PL-REF-OVS-PCT > +0
 10277        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10278
 10279     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10280        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10281     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10282        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10283     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10284        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10285     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10286        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10287     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10288        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10289     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10290        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10291
 10292     IF WS-AH-PL-REF-OVS-AMT > +0
 10293        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10294
 10295     IF WS-AH-PL-REF-OVS-PCT > +0
 10296        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10297
 10298     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10299     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10300
 10301     IF PB-CANCELLATION
 10302        GO TO 3000-CONTINUE-EDIT.
 10303
 10304     MOVE +1 TO SUB1.
 10305     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10306     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10307
 10308     IF CF-COMPANY-ID = 'DMD'
 10309       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10310         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10311        ELSE
 10312         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10313
 10314  0525-FIND-ACCT-COMM.
 10315     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10316        NEXT SENTENCE
 10317      ELSE
 10318         ADD +1 TO SUB1
 10319         IF SUB1 LESS +11
 10320            GO TO 0525-FIND-ACCT-COMM
 10321          ELSE
 10322             GO TO 0560-EDIT-CONTINUE.
 10323
 10324     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10325     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10326                                    PB-I-LIFE-COMMISSION.
 10327***  IF PB-COMPANY-ID = 'CRI'
 10328     IF PB-PREM-ACCTNG-ONLY
 10329         GO TO 0560-EDIT-CONTINUE.
 10330
 10331     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 189
* EL050.cbl
 10332     MOVE ' '    TO WS-CTBL-READ-SW.
 10333
 10334
 10335 0530-GET-AH-COMP.
 10336     IF NO-AH-COVERAGE  OR
 10337        NO-AH-BENEFIT-MATCH
 10338           GO TO 0540-NEXT-READ-STEP.
 10339
 10340     IF AM-A-COM (SUB1) NUMERIC
 10341        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10342         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10343         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10344         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10345         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10346     ELSE
 10347          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10348          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10349          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10350          MOVE ZEROS             TO WS-SUB1
 10351                                    WS-COMMISSION
 10352          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10353          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10354          IF WS-COMMISSION > ZEROS
 10355             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10356             GO TO 0540-NEXT-READ-STEP
 10357          END-IF
 10358          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10359          IF CTBL-TABLE-FOUND
 10360             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10361                                        PB-I-AH-TERM
 10362             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10363             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10364             GO TO 0540-NEXT-READ-STEP
 10365          ELSE
 10366             IF FIRST-TIME-THROUGH
 10367                 GO TO 0530-GET-AH-COMP
 10368             ELSE
 10369                 MOVE ER-2609                TO WS-ERROR
 10370                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10371
 10372 0540-NEXT-READ-STEP.
 10373     MOVE '0540' TO CTBL-SW.
 10374     MOVE ' '    TO WS-CTBL-READ-SW.
 10375
 10376 0540-GET-LF-COMP.
 10377     IF NO-LIFE-COVERAGE  OR
 10378        NO-LF-BENEFIT-MATCH
 10379           GO TO 0560-EDIT-CONTINUE.
 10380
 10381     IF WS-LF-JOINT-INDICATOR = 'J'
 10382        IF AM-J-COM (SUB1) NUMERIC
 10383           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10384           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10385           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10386           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10387           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10388        ELSE
 10389           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 190
* EL050.cbl
 10390           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10391           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10392           MOVE ZEROS                TO WS-SUB1
 10393                                        WS-COMMISSION
 10394           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10395           IF WS-COMMISSION > ZEROS
 10396              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10397              GO TO 0560-EDIT-CONTINUE
 10398           END-IF
 10399           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10400           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10401           IF CTBL-TABLE-FOUND
 10402              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10403              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10404              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10405              GO TO 0560-EDIT-CONTINUE
 10406           ELSE
 10407              IF FIRST-TIME-THROUGH
 10408                  GO TO 0540-GET-LF-COMP
 10409              ELSE
 10410                  MOVE ER-2609                TO WS-ERROR
 10411                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10412                  GO TO 0560-EDIT-CONTINUE.
 10413
 10414     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10415        IF AM-L-COM (SUB1) NUMERIC
 10416           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10417           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10418           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10419           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10420           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10421        ELSE
 10422           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10423           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10424           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10425           MOVE ZEROS                TO WS-SUB1
 10426                                        WS-COMMISSION
 10427           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10428           IF WS-COMMISSION IS GREATER THAN ZEROS
 10429              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10430              GO TO 0560-EDIT-CONTINUE
 10431           END-IF
 10432           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10433           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10434           IF CTBL-TABLE-FOUND
 10435              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10436              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10437              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10438              GO TO 0560-EDIT-CONTINUE
 10439           ELSE
 10440              IF FIRST-TIME-THROUGH
 10441                  GO TO 0540-GET-LF-COMP
 10442              ELSE
 10443                  MOVE ER-2609                TO WS-ERROR
 10444                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10445
 10446*    GO TO 0560-EDIT-CONTINUE.
 10447
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 191
* EL050.cbl
 10448 0560-EDIT-CONTINUE.
 10449     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10450                                    WS-AH-PMF-COMM
 10451*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10452*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10453     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10454        (SUB1 > +10)
 10455        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10456           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10457           MOVE '0530'           TO CTBL-SW
 10458           MOVE ' '              TO WS-CTBL-READ-SW
 10459           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10460           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10461           MOVE '0540'           TO CTBL-SW
 10462           MOVE ' '              TO WS-CTBL-READ-SW
 10463           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10464        END-IF
 10465     END-PERFORM
 10466     GO TO 0564-EDIT-CONTINUE
 10467     .
 10468 0561-CHECK-AH.
 10469     IF (NO-AH-COVERAGE)
 10470        OR (NO-AH-BENEFIT-MATCH)
 10471        CONTINUE
 10472     ELSE
 10473        IF (AM-A-COM (SUB1) NUMERIC)
 10474           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10475           IF (AM-COM-TYP (SUB1) = 'A')
 10476              AND (WS-AH-PMF-COMM = ZEROS)
 10477              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10478           END-IF
 10479           CONTINUE
 10480        ELSE
 10481           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10482           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10483           MOVE PB-AH-OVERRIDE-L1
 10484                                 TO CTBL-BEN-TYPE
 10485           MOVE ZEROS            TO WS-SUB1
 10486                                    WS-COMMISSION
 10487           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10488           PERFORM 8300-READ-CTBL-TABLE
 10489                                 THRU 8300-EXIT
 10490           IF CTBL-TABLE-FOUND
 10491              IF (AM-COM-TYP (SUB1) = 'A')
 10492                 AND (WS-AH-PMF-COMM = ZEROS)
 10493                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10494                                        PB-I-AH-TERM
 10495                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10496                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10497              END-IF
 10498              CONTINUE
 10499           ELSE
 10500              IF FIRST-TIME-THROUGH
 10501                 GO TO 0561-CHECK-AH
 10502              ELSE
 10503                 MOVE ER-2609    TO WS-ERROR
 10504                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10505              END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 192
* EL050.cbl
 10506           END-IF
 10507        END-IF
 10508     END-IF
 10509     .
 10510 0561-EXIT.
 10511     EXIT.
 10512 0563-CHECK-LF.
 10513     IF (NO-LIFE-COVERAGE)
 10514        OR (NO-LF-BENEFIT-MATCH)
 10515        CONTINUE
 10516     ELSE
 10517        IF WS-LF-JOINT-INDICATOR = 'J'
 10518           IF AM-J-COM (SUB1) NUMERIC
 10519              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10520              IF (AM-COM-TYP (SUB1) = 'A')
 10521                 AND (WS-LF-PMF-COMM = ZEROS)
 10522                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10523              END-IF
 10524              CONTINUE
 10525           ELSE
 10526              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10527              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10528              MOVE PB-LIFE-OVERRIDE-L1
 10529                                 TO CTBL-BEN-TYPE
 10530              MOVE ZEROS         TO WS-SUB1
 10531                                    WS-COMMISSION
 10532              MOVE AM-J-COMA (SUB1)
 10533                                 TO CTBL-TABLE
 10534              PERFORM 8300-READ-CTBL-TABLE
 10535                                 THRU 8300-EXIT
 10536              IF CTBL-TABLE-FOUND
 10537                 IF (AM-COM-TYP (SUB1) = 'A')
 10538                    AND (WS-LF-PMF-COMM = ZEROS)
 10539                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10540                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10541                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10542                 END-IF
 10543                 CONTINUE
 10544              ELSE
 10545                 IF FIRST-TIME-THROUGH
 10546                    GO TO 0563-CHECK-LF
 10547                 ELSE
 10548                    MOVE ER-2609 TO WS-ERROR
 10549                    PERFORM 9900-ERROR-FORMAT
 10550                                 THRU 9900-EXIT
 10551*                   GO TO 0560-EDIT-CONTINUE
 10552                 END-IF
 10553              END-IF
 10554           END-IF
 10555        ELSE
 10556           IF AM-L-COM (SUB1) NUMERIC
 10557              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10558              IF (AM-COM-TYP (SUB1) = 'A')
 10559                 AND (WS-LF-PMF-COMM = ZEROS)
 10560                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10561              END-IF
 10562              CONTINUE
 10563           ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 193
* EL050.cbl
 10564              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10565              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10566              MOVE PB-LIFE-OVERRIDE-L1
 10567                                 TO CTBL-BEN-TYPE
 10568              MOVE ZEROS         TO WS-SUB1
 10569                                    WS-COMMISSION
 10570              MOVE AM-L-COMA (SUB1)
 10571                                 TO CTBL-TABLE
 10572              PERFORM 8300-READ-CTBL-TABLE
 10573                                 THRU 8300-EXIT
 10574              IF CTBL-TABLE-FOUND
 10575                 CONTINUE
 10576              ELSE
 10577                 IF FIRST-TIME-THROUGH
 10578                    GO TO 0563-CHECK-LF
 10579                 ELSE
 10580                    MOVE ER-2609 TO WS-ERROR
 10581                    PERFORM 9900-ERROR-FORMAT
 10582                                 THRU 9900-EXIT
 10583                 END-IF
 10584              END-IF
 10585           END-IF
 10586        END-IF
 10587     END-IF
 10588     .
 10589 0563-EXIT.
 10590     EXIT.
 10591 0564-EDIT-CONTINUE.
 10592
 10593     IF  PB-COMPANY-ID EQUAL 'DMD'
 10594         IF PB-I-NUM-BILLED EQUAL ZEROS
 10595            MOVE ER-8148       TO WS-ERROR
 10596            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10597
 10598*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10599*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10600*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10601*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10602*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10603*         IF NO-CONVERSION-ERROR
 10604*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10605*         ELSE
 10606*             IF PB-COMPANY-ID EQUAL 'HAN'
 10607*                 MOVE ZEROS     TO PB-I-AGE.
 10608     IF PB-I-BIRTHDAY > LOW-VALUES
 10609        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10610        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10611        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10612        PERFORM 8500-DATE-CONVERT
 10613                                 THRU 8500-EXIT
 10614        IF NO-CONVERSION-ERROR
 10615           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10616           IF PB-I-AGE > ZEROS
 10617              IF WS-WORK-AGE NOT = PB-I-AGE
 10618                 MOVE ER-9501    TO WS-ERROR
 10619                 PERFORM 9900-ERROR-FORMAT
 10620                                 THRU 9900-EXIT
 10621              END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 194
* EL050.cbl
 10622           ELSE
 10623              MOVE WS-WORK-AGE   TO PB-I-AGE
 10624           END-IF
 10625        END-IF
 10626     END-IF
 10627     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10628                                   WS-INS-AGE-SET
 10629     IF PB-I-AGE = ZEROS
 10630        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10631           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10632                                   WS-INS-AGE-SET
 10633           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10634
 10635     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10636                                   WS-AH-EDIT-AGE.
 10637
 10638     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10639        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10640        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10641        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10642        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10643        IF NO-CONVERSION-ERROR
 10644           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10645           IF PB-I-JOINT-AGE > 0
 10646              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10647                 MOVE ER-9503    TO WS-ERROR
 10648                 PERFORM 9900-ERROR-FORMAT
 10649                                 THRU 9900-EXIT
 10650              END-IF
 10651           ELSE
 10652              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10653           END-IF
 10654        ELSE
 10655           MOVE ZEROS            TO PB-I-JOINT-AGE
 10656        END-IF
 10657     END-IF
 10658     IF PB-I-JOINT-AGE NOT NUMERIC
 10659        MOVE ZERO               TO PB-I-JOINT-AGE.
 10660
 10661     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10662                                   WS-JNT-AGE-SET
 10663     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10664        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10665           (WS-AH-JOINT-INDICATOR = 'J')
 10666           IF PB-I-JOINT-AGE = ZEROS
 10667               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10668                                          WS-JNT-AGE-SET
 10669               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10670           END-IF
 10671        END-IF
 10672     END-IF
 10673
 10674     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10675     IF WS-LF-JOINT-INDICATOR = 'J'
 10676        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10677        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10678            IF  PB-I-JOINT-AGE = ZERO
 10679                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 195
* EL050.cbl
 10680                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10681            ELSE
 10682                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10683                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10684                    IF PB-COMPANY-ID NOT = 'LBL'
 10685                        MOVE ER-2685    TO WS-ERROR
 10686                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10687
 10688     IF WS-AH-JOINT-INDICATOR = 'J'
 10689        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10690            IF  PB-I-JOINT-AGE = ZERO
 10691                MOVE ER-2686       TO WS-ERROR
 10692                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10693            ELSE
 10694                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10695                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10696                                           WS-EDIT-AGE
 10697                    IF PB-COMPANY-ID NOT = 'LBL'
 10698                        MOVE ER-2685    TO WS-ERROR
 10699                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10700
 10701******************************************************************
 10702*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10703******************************************************************
 10704
 10705     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10706        (WS-AH-SPECIAL-CALC-CD = 'O')
 10707        NEXT SENTENCE
 10708     ELSE
 10709        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10710          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10711           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10712            WS-AH-JOINT-INDICATOR = 'J')  AND
 10713           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10714            MOVE ER-2627             TO WS-ERROR
 10715            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10716
 10717     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10718        (WS-AH-SPECIAL-CALC-CD = 'O')
 10719         NEXT SENTENCE
 10720     ELSE
 10721         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10722            WS-AH-JOINT-INDICATOR = 'J'
 10723             IF PB-I-JOINT-INSURED = SPACES
 10724                 IF PB-COMPANY-ID NOT = 'JAL'
 10725                     MOVE ER-2696    TO WS-ERROR
 10726                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10727
 10728     IF PB-COMPANY-ID NOT = 'BOA'
 10729        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10730           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10731           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10732               PB-I-JOINT-INSURED NOT = SPACES)
 10733                MOVE ER-2691         TO WS-ERROR
 10734                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10735
 10736     IF PB-COMPANY-ID = 'BOA'
 10737        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 196
* EL050.cbl
 10738           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10739            IF PB-I-JOINT-AGE NOT = ZEROS
 10740                MOVE ER-2691         TO WS-ERROR
 10741                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10742
 10743     IF PB-COMPANY-ID = 'CRI'
 10744        IF PB-I-SIG-SW = 'J'
 10745           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10746              WS-AH-JOINT-INDICATOR NOT = 'J'
 10747              MOVE ER-2675       TO WS-ERROR
 10748              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10749
 10750     IF PB-COMPANY-ID = 'CRI'
 10751        IF PB-I-SIG-SW = 'S'
 10752           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10753              WS-AH-JOINT-INDICATOR = 'J'
 10754              MOVE ER-2676       TO WS-ERROR
 10755              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10756
 10757     IF PB-COMPANY-ID = 'CVL'
 10758         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10759            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10760              MOVE ER-2783           TO WS-ERROR
 10761              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10762     IF (WS-LF-JOINT-INDICATOR = 'J')
 10763        AND (WS-AH-JOINT-INDICATOR = 'J')
 10764        AND (PB-I-LF-TERM > 120)
 10765        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10766        MOVE ER-2783             TO WS-ERROR
 10767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10768     END-IF
 10769     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10770
 10771     IF PB-I-INDV-GRP-OVRD = 'I'
 10772        MOVE ER-2666             TO WS-ERROR
 10773        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10774        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10775
 10776     IF PB-I-INDV-GRP-OVRD = 'G'
 10777        MOVE ER-2666             TO WS-ERROR
 10778        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10779        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10780
 10781     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10782        NEXT SENTENCE
 10783     ELSE
 10784        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10785
 10786     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10787        IF WS-ERROR = ER-2666
 10788           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10789           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10790
 10791     IF PB-COMPANY-ID = 'CID'
 10792        IF PB-STATE = 'UT' OR 'MO'
 10793           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10794                 OR '76' OR '77')
 10795                      OR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 197
* EL050.cbl
 10796               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10797                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10798                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10799                   OR '2K' OR '2L'))
 10800              AND PB-I-INDV-GRP-CD = 'I'
 10801              MOVE ER-2721             TO WS-ERROR
 10802              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10803           END-IF
 10804        END-IF
 10805     END-IF
 10806
 10807     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10808     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10809        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10810     ELSE
 10811        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10812     END-IF
 10813
 10814*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10815*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10816     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10817                                    ACCOUNT-AH-CK-SW.
 10818
 10819     IF PB-REISSUED-CERT       OR
 10820        PB-REIN-ONLY-CERT      OR
 10821        PB-POLICY-IS-DECLINED  OR
 10822        PB-POLICY-IS-VOIDED
 10823*       OR PB-MONTHLY-CERT
 10824         GO TO 3000-CONTINUE-EDIT.
 10825
 10826     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10827        IF WS-EDIT-AGE           > +65
 10828           MOVE ER-2709          TO WS-ERROR
 10829           PERFORM 9900-ERROR-FORMAT
 10830                                 THRU 9900-EXIT
 10831        ELSE
 10832           IF WS-EDIT-AGE        > +55
 10833              MOVE ER-2718       TO WS-ERROR
 10834              PERFORM 9900-ERROR-FORMAT
 10835                                 THRU 9900-EXIT
 10836           END-IF
 10837        END-IF
 10838     IF PB-COMPANY-ID = 'DCC'
 10839        IF WS-EDIT-AGE           > +65
 10840           MOVE ER-2709          TO WS-ERROR
 10841           PERFORM 9900-ERROR-FORMAT
 10842                                 THRU 9900-EXIT
 10843        END-IF
 10844     END-IF
 10845     .
 10846
 10847 0565-LIFE-PLAN-LIMIT-EDITS.
 10848
 10849     IF NOT LF-PLAN-MASTER-FOUND
 10850        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10851                                    EC-AM-LF-MAX-TOT-BEN
 10852        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10853
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 198
* EL050.cbl
 10854     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10855
 10856     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10857         IF PL-LM-AGE (1) = ZEROS
 10858             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10859
 10860     IF NO-LF-BENEFIT-MATCH          OR
 10861        WS-LF-BENEFIT-CD = ZEROS     OR
 10862        WS-LF-SPECIAL-CALC-CD = 'M'
 10863        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10864
 10865     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10866     MOVE +1                     TO SUB2.
 10867
 10868     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10869        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10870           MOVE +5   TO SUB2
 10871           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10872              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10873              (PL-LM-AGE (SUB2) EQUAL +0)
 10874              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10875              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10876
 10877     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10878
 10879     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10880                               + PB-I-LF-ALT-BENEFIT-AMT.
 10881
 10882 0568-CHECK-LIFE-ATT-AGE.
 10883
 10884     IF PL-ATT-AGE NUMERIC AND
 10885        PL-ATT-AGE > +0
 10886        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10887     END-IF
 10888*    IF PL-ATT-AGE NUMERIC AND
 10889*       PL-ATT-AGE > +0
 10890*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10891*       IF PB-I-BIRTHDAY > LOW-VALUES
 10892*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10893*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10894*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10895*          SET BIN-PLUS-ELAPSED  TO TRUE
 10896*          PERFORM 8500-DATE-CONVERT
 10897*                                THRU 8500-EXIT
 10898*          IF NO-CONVERSION-ERROR
 10899*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10900*             MOVE ER-2669       TO WS-ERROR
 10901*             PERFORM 9900-ERROR-FORMAT
 10902*                                THRU 9900-EXIT
 10903*          END-IF
 10904*       ELSE
 10905*          IF WS-ATT-AGE >= PL-ATT-AGE
 10906*             MOVE ER-2669       TO WS-ERROR
 10907*             PERFORM 9900-ERROR-FORMAT
 10908*                                THRU 9900-EXIT
 10909*          END-IF
 10910*       END-IF
 10911*    END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 199
* EL050.cbl
 10912     .
 10913 0570-CHECK-LIFE-LIMITS.
 10914
 10915     IF PB-COMPANY-ID EQUAL 'CRI'
 10916        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10917           IF SUB2 GREATER THAN +4
 10918              MOVE ER-2637 TO WS-ERROR
 10919              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10920              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10921
 10922     IF PB-COMPANY-ID  =  'NCL'
 10923        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10924            SUB2 GREATER THAN +8
 10925             MOVE 'U'         TO PB-BATCH-ENTRY
 10926             MOVE ER-2637     TO WS-ERROR
 10927             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10928             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10929
 10930     IF SUB2 > +8
 10931        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10932           AND (PB-I-SIG-SW = 'Y')
 10933           CONTINUE
 10934        ELSE
 10935           MOVE ER-2637          TO WS-ERROR
 10936           PERFORM 9900-ERROR-FORMAT
 10937                                 THRU 9900-EXIT
 10938        END-IF
 10939        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10940     END-IF
 10941     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10942     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10943     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10944
 10945     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10946        ADD +1  TO SUB2
 10947        GO TO 0570-CHECK-LIFE-LIMITS.
 10948
 10949     IF PB-COMPANY-ID = 'NCL'
 10950         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10951
 10952     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10953        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10954        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10955           AND (PB-I-SIG-SW = 'Y')
 10956           CONTINUE
 10957        ELSE
 10958           MOVE ER-2637          TO WS-ERROR
 10959           PERFORM 9900-ERROR-FORMAT
 10960                                 THRU 9900-EXIT
 10961        END-IF
 10962     END-IF
 10963     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10964
 10965
 10966 0570-CHECK-NCL-LIFE-LIMITS.
 10967
 10968     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10969        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 200
* EL050.cbl
 10970         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10971
 10972     IF APP-CERT-USED
 10973         IF SUB2  LESS THAN  +5
 10974             MOVE +5          TO SUB2
 10975             GO TO 0570-CHECK-LIFE-LIMITS.
 10976
 10977     MOVE ER-2637             TO WS-ERROR.
 10978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10979
 10980     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10981
 10982 0575-CHECK-NCL-SIG-SWITCH.
 10983
 10984     IF NOT APP-CERT-USED
 10985         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10986
 10987     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10988        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10989        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10990        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10991         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10992
 10993     IF SUB2 GREATER THAN +4
 10994         IF PL-LM-AGE (5) = ZEROS  AND
 10995            PL-LM-AGE (6) = ZEROS  AND
 10996            PL-LM-AGE (7) = ZEROS  AND
 10997            PL-LM-AGE (8) = ZEROS
 10998             MOVE  ER-1927        TO WS-ERROR
 10999             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11000             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11001         ELSE
 11002             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11003                 MOVE  ER-1920    TO WS-ERROR
 11004                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11005
 11006     IF PB-I-SIG-SW  = 'Y'
 11007       IF NOT PB-I-POLICY-ACCEPTED  AND
 11008          NOT PB-I-POLICY-DECLINED
 11009           MOVE 'U'               TO PB-BATCH-ENTRY
 11010           MOVE  ER-1926          TO WS-ERROR
 11011           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11012
 11013
 11014 0580-AH-PLAN-LIMIT-EDITS.
 11015
 11016     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11017        IF PB-I-AH-BENEFIT-AMT > +1250
 11018           MOVE ER-2702          TO WS-ERROR
 11019           PERFORM 9900-ERROR-FORMAT
 11020                                 THRU 9900-EXIT
 11021        END-IF
 11022     END-IF
 11023
 11024     IF (PB-COMPANY-ID = 'DCC')
 11025        AND (PB-MONTHLY-CERT)
 11026        IF PB-I-AH-BENEFIT-AMT > +3000
 11027           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 201
* EL050.cbl
 11028           PERFORM 9900-ERROR-FORMAT
 11029                                 THRU 9900-EXIT
 11030        END-IF
 11031     END-IF
 11032     IF NOT AH-PLAN-MASTER-FOUND
 11033        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11034        GO TO 3000-CONTINUE-EDIT.
 11035
 11036     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11037
 11038     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11039         IF PL-LM-AGE (1) = ZEROS
 11040             GO TO 3000-CONTINUE-EDIT.
 11041
 11042     IF NO-AH-BENEFIT-MATCH          OR
 11043        WS-AH-BENEFIT-CD = ZEROS     OR
 11044        WS-AH-SPECIAL-CALC-CD = 'M'
 11045        GO TO 3000-CONTINUE-EDIT.
 11046
 11047     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11048     MOVE +1                     TO SUB2.
 11049
 11050     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11051        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11052           MOVE +5 TO SUB2
 11053           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11054              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11055              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11056              (PL-LM-AGE (SUB2) EQUAL +0)
 11057              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11058              GO TO 3000-CONTINUE-EDIT.
 11059
 11060     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11061
 11062 0590-CHECK-AH-ATT-AGE.
 11063
 11064     IF PL-ATT-AGE NUMERIC AND
 11065        PL-ATT-AGE GREATER THAN +0
 11066        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11067     END-IF
 11068*       IF WS-ATT-AGE >= PL-ATT-AGE
 11069*          MOVE ER-3054          TO WS-ERROR
 11070*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11071     .
 11072 0597-CHECK-AH-LIMITS.
 11073
 11074     IF PB-COMPANY-ID EQUAL 'CRI'
 11075        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11076           IF SUB2 GREATER THAN +4
 11077              MOVE ER-2638       TO WS-ERROR
 11078              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11079              GO TO 3000-CONTINUE-EDIT.
 11080
 11081     IF PB-COMPANY-ID  =  'NCL'
 11082        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11083            SUB2 GREATER THAN +8
 11084             MOVE 'U'            TO PB-BATCH-ENTRY
 11085             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 202
* EL050.cbl
 11086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11087             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11088
 11089     IF SUB2 > +8
 11090        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11091           AND (PB-I-SIG-SW = 'Y')
 11092           CONTINUE
 11093        ELSE
 11094           MOVE ER-2638          TO WS-ERROR
 11095           PERFORM 9900-ERROR-FORMAT
 11096                                 THRU 9900-EXIT
 11097        END-IF
 11098        GO TO 3000-CONTINUE-EDIT
 11099     END-IF
 11100
 11101     IF PB-COMPANY-ID = 'CRI'
 11102        IF WS-ERROR = ER-2638
 11103           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11104
 11105     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11106     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11107     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11108     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11109
 11110     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11111        ADD +1                   TO SUB2
 11112        GO TO 0597-CHECK-AH-LIMITS.
 11113
 11114     IF PB-COMPANY-ID = 'NCL'
 11115         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11116
 11117     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11118        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11119        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11120                                 > PL-LM-AMT (SUB2))
 11121        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11122           AND (PB-I-SIG-SW = 'Y')
 11123           CONTINUE
 11124        ELSE
 11125           MOVE ER-2638          TO WS-ERROR
 11126           PERFORM 9900-ERROR-FORMAT
 11127                                 THRU 9900-EXIT
 11128        END-IF
 11129     END-IF
 11130
 11131     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11132         IF  WS-ERROR    EQUAL    ER-2638
 11133             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11134                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11135                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11136                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11137                MOVE  ER-1910    TO  WS-ERROR
 11138                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11139
 11140     IF PB-COMPANY-ID = 'CRI'
 11141        IF WS-ERROR = ER-2638
 11142            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11143            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 203
* EL050.cbl
 11144            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11145
 11146     GO TO 3000-CONTINUE-EDIT.
 11147
 11148 0597-CHECK-NCL-AH-LIMITS.
 11149
 11150     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11151        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11152        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11153                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11154         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11155
 11156     IF APP-CERT-USED
 11157         IF SUB2  LESS THAN  +5
 11158             MOVE +5             TO SUB2
 11159             GO TO 0597-CHECK-AH-LIMITS.
 11160
 11161     MOVE ER-2638                TO WS-ERROR.
 11162     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11163
 11164     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11165
 11166 0599-CHECK-NCL-SIG-SWITCH.
 11167
 11168     IF NOT APP-CERT-USED
 11169         GO TO 3000-CONTINUE-EDIT.
 11170
 11171     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11172        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11173        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11174        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11175         GO TO 3000-CONTINUE-EDIT.
 11176
 11177     IF SUB2 GREATER THAN +4
 11178         IF PL-LM-AGE (5) = ZEROS  AND
 11179            PL-LM-AGE (6) = ZEROS  AND
 11180            PL-LM-AGE (7) = ZEROS  AND
 11181            PL-LM-AGE (8) = ZEROS
 11182             MOVE  ER-1927        TO WS-ERROR
 11183             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11184             GO TO 3000-CONTINUE-EDIT
 11185         ELSE
 11186             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11187                 MOVE  ER-1920    TO WS-ERROR
 11188                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11189
 11190     IF PB-I-SIG-SW  = 'Y'
 11191       IF NOT PB-I-POLICY-ACCEPTED  AND
 11192          NOT PB-I-POLICY-DECLINED
 11193           MOVE 'U'               TO PB-BATCH-ENTRY
 11194           MOVE  ER-1926          TO WS-ERROR
 11195           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11196
 11197******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 204
* EL050.cbl
 11199
 11200 3000-CONTINUE-EDIT.
 11201
 11202     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11203     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11204     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11205     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11206     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11207
 11208     IF BROWSE-STARTED
 11209        PERFORM 9990-RETURN THRU 9990-EXIT
 11210        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11211
 11212     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11213        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11214        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11215        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11216*       MOVE 1                   TO DC-OPTION-CODE
 11217        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11218        IF DATE-CONVERSION-ERROR
 11219           MOVE ER-2622          TO WS-ERROR
 11220           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11221        ELSE
 11222           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11223              MOVE ER-2623       TO WS-ERROR
 11224              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11225           ELSE
 11226              MOVE ER-2622       TO WS-ERROR
 11227              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11228
 11229     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11230     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11231     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11232*    MOVE 1                      TO DC-OPTION-CODE.
 11233     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11234     IF DATE-CONVERSION-ERROR
 11235        GO TO 3005-EDIT-CONTINUE
 11236     ELSE
 11237        IF DC-ELAPSED-DAYS GREATER +180
 11238           MOVE ER-2613          TO WS-ERROR
 11239           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11240        ELSE
 11241           IF DC-ELAPSED-DAYS GREATER +90
 11242              MOVE ER-2612       TO WS-ERROR
 11243              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11244           ELSE
 11245             IF DC-ELAPSED-DAYS GREATER +60
 11246                MOVE ER-2614     TO WS-ERROR
 11247                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11248
 11249 3005-EDIT-CONTINUE.
 11250
 11251     IF PB-CANCELLATION
 11252         GO TO 3700-EDIT-CANCEL.
 11253
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 205
* EL050.cbl
 11255******************************************************************
 11256*                  E D I T   I S S U E                           *
 11257******************************************************************
 11258
 11259 3020-EDIT-ISSUE.
 11260
 11261      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11262      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11263      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11264      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11265      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11266
 11267     IF PB-ISSUE-FORCE
 11268        OR PB-ISSUE-DATE-FORCED
 11269        OR PB-FORCE-OFF
 11270        OR PB-OVERCHARGE-FORCE
 11271        CONTINUE
 11272     ELSE
 11273        MOVE ER-2670             TO WS-ERROR
 11274        PERFORM 9900-ERROR-FORMAT
 11275                                 THRU 9900-EXIT
 11276     END-IF
 11277     .
 11278 3022-SET-POLICY-STATUS.
 11279
 11280     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11281
 11282     IF (PB-REISSUED-CERT)
 11283             OR
 11284        ((PB-COMPANY-ID NOT = 'DCC')
 11285         AND (PB-MONTHLY-CERT))
 11286         MOVE '5'                TO PB-I-ENTRY-STATUS
 11287         MOVE 'E'                TO PB-BATCH-ENTRY
 11288     END-IF
 11289
 11290     IF PB-COMPANY-ID = 'DCC'
 11291        IF PB-MONTHLY-CERT
 11292           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11293        END-IF
 11294     END-IF
 11295     IF PB-POLICY-IS-DECLINED
 11296         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11297     IF PB-POLICY-IS-VOIDED
 11298         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11299     IF PB-NEEDS-UNDERWRITING
 11300         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11301     IF PB-REIN-ONLY-CERT
 11302         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11303     IF PB-PREM-ACCTNG-ONLY
 11304         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11305
 11306     MOVE SPACE                  TO PB-I-OB-FLAG.
 11307
 11308     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11309         MOVE ER-2665            TO WS-ERROR
 11310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11311         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11312
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 206
* EL050.cbl
 11313     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11314        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11315           MOVE 'Z'             TO PB-I-OB-FLAG.
 11316
 11317     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11318        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11319           MOVE 'Z'             TO PB-I-OB-FLAG.
 11320
 11321     IF ACCOUNT-MAST-FOUND
 11322         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11323         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11324         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11325         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11326         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11327         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11328         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11329     END-IF
 11330
 11331     IF ACCOUNT-MAST-FOUND
 11332        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11333         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11334
 11335     IF (ACCOUNT-MAST-FOUND)
 11336        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11337        IF PB-REISSUED-CERT
 11338           CONTINUE
 11339        ELSE
 11340           MOVE ER-2608          TO WS-ERROR
 11341           PERFORM 9900-ERROR-FORMAT
 11342                                 THRU 9900-EXIT
 11343         END-IF
 11344     END-IF
 11345
 11346     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11347        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11348        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11349
 11350**********   DMD CUSTOM CODE FOLLOWS  **********
 11351 3024-EDIT-DMD-FIELDS.
 11352     IF PB-COMPANY-ID NOT = 'DMD'
 11353        GO TO 3025-EDIT-REINSURANCE.
 11354
 11355*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11356*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11357*** ERROR IF THEY ARE NOT EQUAL.
 11358
 11359     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11360     SET BIN-TO-GREG               TO TRUE.
 11361     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11362     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11363**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11364
 11365     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11366     SET BIN-TO-GREG               TO TRUE.
 11367     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11368     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11369**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11370
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 207
* EL050.cbl
 11371     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11372        MOVE ER-8116               TO WS-ERROR
 11373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11374
 11375     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11376
 11377     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11378                                      WK-FULL-CERT-NO.
 11379     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11380
 11381     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11382
 11383     IF PB-VALID-LIFE
 11384        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11385     ELSE
 11386        IF PB-VALID-AH
 11387          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11388
 11389
 11390     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11391     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11392     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11393                                      DCUA-UNDRWRTR-CODE
 11394                                      DCUA-UNDRWRTR-GROUP-CODE
 11395                                      DCUA-RETURN-CODE.
 11396
 11397****************************************************************
 11398*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11399***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11400***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11401***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11402***   TO THIS RECORD.                                        ***
 11403****************************************************************
 11404     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11405     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11406     IF DCUA-SUCCESSFUL-PROCESS
 11407        GO TO 3024-EDIT-DL7-CONT.
 11408
 11409     IF DCUA-RETURN-CODE EQUAL '01'
 11410        MOVE ER-8110               TO WS-ERROR
 11411        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11413        GO TO 3024-EDIT-DL7-CONT.
 11414
 11415     IF DCUA-RETURN-CODE EQUAL '02'
 11416        MOVE ER-8111               TO WS-ERROR
 11417        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11418        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11419        GO TO 3024-EDIT-DL7-CONT.
 11420
 11421     IF DCUA-RETURN-CODE EQUAL '03'
 11422        MOVE ER-8074               TO WS-ERROR
 11423        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11424        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11425        GO TO 3024-EDIT-DL7-CONT.
 11426
 11427     IF DCUA-RETURN-CODE EQUAL '04'
 11428        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 208
* EL050.cbl
 11429        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11430        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11431        GO TO 3024-EDIT-DL7-CONT.
 11432
 11433     IF DCUA-RETURN-CODE EQUAL '05'
 11434        MOVE ER-8076               TO WS-ERROR
 11435        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11437        GO TO 3024-EDIT-DL7-CONT.
 11438
 11439     IF DCUA-RETURN-CODE EQUAL '06'
 11440        MOVE ER-8077               TO WS-ERROR
 11441        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11442        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11443        GO TO 3024-EDIT-DL7-CONT.
 11444
 11445     IF DCUA-RETURN-CODE EQUAL '07'
 11446        MOVE ER-8078               TO WS-ERROR
 11447        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11449        GO TO 3024-EDIT-DL7-CONT.
 11450
 11451     IF DCUA-RETURN-CODE EQUAL 'E1'
 11452        MOVE ER-8079               TO WS-ERROR
 11453        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11455        GO TO 3024-EDIT-DL7-CONT.
 11456
 11457     IF DCUA-RETURN-CODE EQUAL 'E2'
 11458        MOVE ER-8080               TO WS-ERROR
 11459        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11460        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11461        GO TO 3024-EDIT-DL7-CONT.
 11462
 11463     IF DCUA-RETURN-CODE EQUAL 'E3'
 11464        MOVE ER-8098               TO WS-ERROR
 11465        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11467        GO TO 3024-EDIT-DL7-CONT.
 11468
 11469     IF DCUA-RETURN-CODE EQUAL 'C1'
 11470        MOVE ER-8099               TO WS-ERROR
 11471        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11472        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11473        GO TO 3024-EDIT-DL7-CONT.
 11474
 11475     IF DCUA-RETURN-CODE EQUAL 'U1'
 11476        MOVE ER-8109               TO WS-ERROR
 11477        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479        GO TO 3024-EDIT-DL7-CONT.
 11480
 11481     IF DCUA-RETURN-CODE EQUAL 'N1'
 11482        MOVE ER-8112               TO WS-ERROR
 11483        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11485        GO TO 3024-EDIT-DL7-CONT.
 11486
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 209
* EL050.cbl
 11487     IF DCUA-RETURN-CODE EQUAL 'N2'
 11488        MOVE ER-8113               TO WS-ERROR
 11489        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11491        GO TO 3024-EDIT-DL7-CONT.
 11492
 11493     IF DCUA-RETURN-CODE EQUAL 'N3'
 11494        MOVE ER-8114               TO WS-ERROR
 11495        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11497        GO TO 3024-EDIT-DL7-CONT.
 11498
 11499     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11500     MOVE ER-8097                  TO WS-ERROR.
 11501     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11502     GO TO 3024-EDIT-DL7-CONT.
 11503
 11504 3024-EDIT-DL7-CONT.
 11505
 11506     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11507     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11508     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11509        NEXT SENTENCE
 11510     ELSE
 11511        MOVE ER-9263               TO WS-ERROR
 11512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11513
 11514******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11515******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11516     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11517        NEXT SENTENCE
 11518     ELSE
 11519        MOVE ER-8039               TO WS-ERROR
 11520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11521
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 210
* EL050.cbl
 11523****************************************************************
 11524*** VALIDATE STATE  : DLO022                                 ***
 11525****************************************************************
 11526     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11527     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11528
 11529     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11530     IF DVSC-SUCCESSFUL-EDIT
 11531        GO TO 3024-EDIT-DL22-CONT.
 11532
 11533     IF DVSC-RETURN-CODE EQUAL '01'
 11534        MOVE ER-8300               TO WS-ERROR
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL22-CONT.
 11537
 11538     IF DVSC-RETURN-CODE EQUAL '02'
 11539        MOVE ER-8301               TO WS-ERROR
 11540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11541        GO TO 3024-EDIT-DL22-CONT.
 11542
 11543     IF DVSC-RETURN-CODE EQUAL '03'
 11544        MOVE ER-8302               TO WS-ERROR
 11545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11546        GO TO 3024-EDIT-DL22-CONT.
 11547
 11548     IF DVSC-RETURN-CODE EQUAL 'N1'
 11549        MOVE ER-8304               TO WS-ERROR
 11550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11551        GO TO 3024-EDIT-DL22-CONT.
 11552
 11553     MOVE ER-8303                  TO WS-ERROR
 11554     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11555
 11556 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 211
* EL050.cbl
 11558****************************************************************
 11559*** VALIDATE LOAN OFFICER : DLO021                           ***
 11560****************************************************************
 11561
 11562     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11563     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11564     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11565     IF DVLO-SUCCESSFUL-EDIT
 11566        GO TO 3024-EDIT-DL21-CONT.
 11567
 11568     IF DVLO-RETURN-CODE EQUAL '01'
 11569        MOVE ER-8081               TO WS-ERROR
 11570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11571        GO TO 3024-EDIT-DL21-CONT.
 11572
 11573     IF DVLO-RETURN-CODE EQUAL '02'
 11574        MOVE ER-8082               TO WS-ERROR
 11575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11576        GO TO 3024-EDIT-DL21-CONT.
 11577
 11578     IF DVLO-RETURN-CODE EQUAL '03'
 11579        MOVE ER-8083               TO WS-ERROR
 11580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11581        GO TO 3024-EDIT-DL21-CONT.
 11582
 11583     IF DVLO-RETURN-CODE EQUAL '04'
 11584        MOVE ER-8084               TO WS-ERROR
 11585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11586        GO TO 3024-EDIT-DL21-CONT.
 11587
 11588     IF DVLO-RETURN-CODE EQUAL '05'
 11589        MOVE ER-8085               TO WS-ERROR
 11590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11591        GO TO 3024-EDIT-DL21-CONT.
 11592
 11593     MOVE ER-7825                  TO WS-ERROR
 11594     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11595     GO TO 3024-EDIT-DL21-CONT.
 11596
 11597 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 212
* EL050.cbl
 11599
 11600****************************************************************
 11601*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11602****************************************************************
 11603
 11604     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11605     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11606     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11607     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11608     IF DIPF-SUCCESSFUL-EDIT
 11609        GO TO 3024-EDIT-DL02-CONT.
 11610
 11611     IF DIPF-RETURN-CODE EQUAL '01'
 11612        MOVE ER-8086               TO WS-ERROR
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL02-CONT.
 11615
 11616     IF DIPF-RETURN-CODE EQUAL '02'
 11617        MOVE ER-8087               TO WS-ERROR
 11618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11619        GO TO 3024-EDIT-DL02-CONT.
 11620
 11621     IF DIPF-RETURN-CODE EQUAL '03'
 11622        MOVE ER-8088               TO WS-ERROR
 11623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11624        GO TO 3024-EDIT-DL02-CONT.
 11625
 11626     MOVE ER-8095                  TO WS-ERROR
 11627     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11628     GO TO 3024-EDIT-DL02-CONT.
 11629
 11630 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 213
* EL050.cbl
 11632
 11633****************************************************************
 11634*** VALIDATE BANK ID : DLO003                                ***
 11635****************************************************************
 11636
 11637     MOVE WK-GREG-CENT           TO WCG-CENT.
 11638     MOVE WK-GREG-YYMM           TO WCG-REST.
 11639     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11640        MOVE ER-8040               TO WS-ERROR
 11641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11642
 11643     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11644     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11645     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11646     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11647     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11648     IF DVBI-SUCCESSFUL-EDIT
 11649        GO TO 3024-EDIT-DL03-CONT.
 11650
 11651     IF DVBI-RETURN-CODE EQUAL '01'
 11652        MOVE ER-8089               TO WS-ERROR
 11653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11654        GO TO 3024-EDIT-DL03-CONT.
 11655
 11656     IF DVBI-RETURN-CODE EQUAL '02'
 11657        MOVE ER-8090               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11659        GO TO 3024-EDIT-DL03-CONT.
 11660
 11661     IF DVBI-RETURN-CODE EQUAL '03'
 11662        MOVE ER-8091               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664        GO TO 3024-EDIT-DL03-CONT.
 11665
 11666     IF DVBI-RETURN-CODE EQUAL '04'
 11667        MOVE ER-8092               TO WS-ERROR
 11668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669        GO TO 3024-EDIT-DL03-CONT.
 11670
 11671     IF DVBI-RETURN-CODE EQUAL '05'
 11672        MOVE ER-8093               TO WS-ERROR
 11673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11674        GO TO 3024-EDIT-DL03-CONT.
 11675
 11676     IF DVBI-RETURN-CODE EQUAL '06'
 11677        MOVE ER-8094               TO WS-ERROR
 11678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11679        GO TO 3024-EDIT-DL03-CONT.
 11680
 11681     MOVE ER-8096                  TO WS-ERROR
 11682     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11683     GO TO 3024-EDIT-DL03-CONT.
 11684
 11685 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 214
* EL050.cbl
 11687
 11688     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11689        NEXT SENTENCE
 11690     ELSE
 11691        MOVE ER-8042               TO WS-ERROR
 11692        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11693
 11694     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11695     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11696     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11697
 11698     IF DMPF-RETURN-CODE = '01'
 11699        MOVE ER-8067               TO WS-ERROR
 11700        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11701        GO TO 3024-EDIT-DL01-CONT.
 11702
 11703     IF DMPF-RETURN-CODE = '02'
 11704        MOVE ER-8068               TO WS-ERROR
 11705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11706        GO TO 3024-EDIT-DL01-CONT.
 11707
 11708     IF DMPF-RETURN-CODE = '03'
 11709        MOVE ER-8069               TO WS-ERROR
 11710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11711        GO TO 3024-EDIT-DL01-CONT.
 11712
 11713     IF DMPF-RETURN-CODE = 'E1'
 11714        MOVE ER-8070               TO WS-ERROR
 11715        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11716        GO TO 3024-EDIT-DL01-CONT.
 11717
 11718     IF DMPF-RETURN-CODE = 'N1'
 11719        MOVE ER-8071               TO WS-ERROR
 11720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11721        GO TO 3024-EDIT-DL01-CONT.
 11722
 11723     IF DMPF-RETURN-CODE NOT = 'OK'
 11724        MOVE ER-8072               TO WS-ERROR
 11725        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11726
 11727 3024-EDIT-DL01-CONT.
 11728******************************************************************
 11729***  VALIDATES RATE CODES : DLO017                             ***
 11730******************************************************************
 11731
 11732      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11733      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11734      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11735      IF DVRC-SUCCESSFUL-EDIT
 11736        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11737        GO TO 3024-CHECK-VALID-RATE.
 11738
 11739      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11740
 11741      IF DVRC-RETURN-CODE EQUAL '01'
 11742         MOVE ER-7817                   TO WS-ERROR
 11743         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11744         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 215
* EL050.cbl
 11745
 11746      IF DVRC-RETURN-CODE EQUAL '02'
 11747         MOVE ER-7818                   TO WS-ERROR
 11748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11749         GO TO 3025-EDIT-REINSURANCE.
 11750
 11751      IF DVRC-RETURN-CODE EQUAL '03'
 11752         MOVE ER-7819                   TO WS-ERROR
 11753         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11754         GO TO 3025-EDIT-REINSURANCE.
 11755
 11756       MOVE ER-7820                     TO WS-ERROR.
 11757       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11758       GO TO 3025-EDIT-REINSURANCE.
 11759
 11760******************************************************************
 11761***  GET PREMIUM RATES : DLO011                                ***
 11762******************************************************************
 11763
 11764 3024-CHECK-VALID-RATE.
 11765
 11766     IF VALID-RATE-CODE
 11767        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11768        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11769        MOVE SPACES                TO DPRB-RETURN-CODE
 11770        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11771     ELSE
 11772         GO TO 3025-EDIT-REINSURANCE.
 11773
 11774      IF DPRB-SUCCESSFUL-PROCESS
 11775         IF PB-VALID-LIFE
 11776             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11777             GO TO 3025-EDIT-REINSURANCE
 11778         ELSE
 11779             IF PB-VALID-AH
 11780                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11781                 GO TO 3025-EDIT-REINSURANCE.
 11782
 11783      IF DPRB-RETURN-CODE EQUAL '01'
 11784         MOVE ER-7812                   TO WS-ERROR
 11785         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11786         GO TO 3025-EDIT-REINSURANCE.
 11787
 11788      IF DPRB-RETURN-CODE EQUAL '02'
 11789         MOVE ER-7813                   TO WS-ERROR
 11790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11791         GO TO 3025-EDIT-REINSURANCE.
 11792
 11793      IF DPRB-RETURN-CODE EQUAL '03'
 11794         MOVE ER-7814                   TO WS-ERROR
 11795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11796         GO TO 3025-EDIT-REINSURANCE.
 11797
 11798      IF DPRB-RETURN-CODE EQUAL '04'
 11799         IF NOT DPRB-1ST-TIME
 11800            MOVE ER-7815                   TO WS-ERROR
 11801            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11802            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 216
* EL050.cbl
 11803          ELSE
 11804         IF PB-VALID-LIFE
 11805            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11806          ELSE
 11807            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11808         END-IF
 11809         MOVE SPACES                TO DOCC-RETURN-CODE
 11810         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11811         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11812         IF DOCC-RETURN-CODE = 'OK'
 11813             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11814             GO TO 3024-CHECK-VALID-RATE
 11815           ELSE
 11816             MOVE ER-7823               TO WS-ERROR
 11817             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11818             GO TO 3025-EDIT-REINSURANCE.
 11819
 11820       MOVE ER-7816                     TO WS-ERROR.
 11821       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11822       GO TO 3025-EDIT-REINSURANCE.
 11823
 11824**********   DMD CUSTOM CODE ABOVE    **********
 11825
 11826 3025-EDIT-REINSURANCE.
 11827     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11828         GO TO 3027-EDIT-CONTINUE.
 11829
 11830     MOVE LOW-VALUES               TO ERREIN-KEY.
 11831     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11832     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11833                                      REIN-CODE-2
 11834                                      REIN-CODE-3.
 11835     MOVE 'A'                      TO REIN-TYPE.
 11836
 11837     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11838
 11839     MOVE '3026' TO REIN-SW.
 11840     MOVE ' '                   TO WS-REIN-READ-SW.
 11841
 11842     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11843     IF REIN-TABLE-NOT-FOUND
 11844         GO TO 3026-NO-SPEC-TABLE.
 11845
 11846     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11847     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11848                                   WS-NSP-ST-CD-LF.
 11849     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11850                                   WS-NSP-ST-CD-AH.
 11851
 11852     GO TO 3040-EDIT-CONTINUE.
 11853
 11854 3026-NO-SPEC-TABLE.
 11855
 11856     MOVE ER-2664                TO WS-ERROR.
 11857     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11858     GO TO 3040-EDIT-CONTINUE.
 11859
 11860 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 217
* EL050.cbl
 11861
 11862     IF PB-I-REIN-TABLE = SPACES
 11863       GO TO 3040-EDIT-CONTINUE.
 11864
 11865     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11866          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11867          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11868           GO TO 3040-EDIT-CONTINUE.
 11869
 11870     MOVE LOW-VALUES            TO ERREIN-KEY.
 11871     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11872     MOVE 'A'                   TO REIN-TYPE.
 11873     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11874
 11875     MOVE '3028'                TO REIN-SW.
 11876     MOVE ' '                   TO WS-REIN-READ-SW.
 11877
 11878     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11879     IF REIN-TABLE-NOT-FOUND
 11880         GO TO 3028-NO-REIN-TABLE.
 11881
 11882     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11883     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11884                                   WS-NSP-ST-CD-LF.
 11885     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11886                                   WS-NSP-ST-CD-AH.
 11887
 11888     GO TO 3040-EDIT-CONTINUE.
 11889
 11890 3028-NO-REIN-TABLE.
 11891
 11892     MOVE ER-2615                TO WS-ERROR.
 11893     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11894     GO TO 3040-EDIT-CONTINUE.
 11895
 11896 3040-EDIT-CONTINUE.
 11897
 11898     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11899         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11900
 11901     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11902         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11903
 11904     IF (NOT PB-REISSUED-CERT)
 11905        AND (NOT PB-MONTHLY-CERT)
 11906        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11907            MOVE '001'           TO PB-I-LF-TERM
 11908            MOVE 'M'             TO PB-I-INSURED-SEX.
 11909
 11910     IF (NOT PB-REISSUED-CERT)
 11911        AND (NOT PB-MONTHLY-CERT)
 11912        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11913            MOVE '001'           TO PB-I-AH-TERM
 11914            MOVE 'M'             TO PB-I-INSURED-SEX.
 11915
 11916 3040-EDIT-1ST-PMT-DT.
 11917     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11918     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 218
* EL050.cbl
 11919         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11920
 11921******************************************************************
 11922*                                                                *
 11923*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11924*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11925*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11926*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11927*                                                                *
 11928******************************************************************
 11929
 11930     IF PB-EFF-DT-PROCESSING
 11931        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11932                                    PB-I-LF-EXPIRE-DT
 11933                                    PB-I-AH-EXPIRE-DT
 11934        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11935        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11936        MOVE ZERO                TO DC-ELAPSED-DAYS
 11937        MOVE +1                  TO DC-ELAPSED-MONTHS
 11938        SET BIN-PLUS-ELAPSED     TO TRUE
 11939*       MOVE 6                   TO DC-OPTION-CODE
 11940        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11941        IF NO-CONVERSION-ERROR
 11942           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11943
 11944******************************************************************
 11945*                                                                *
 11946*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11947*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11948*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11949*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11950*                                                                *
 11951******************************************************************
 11952
 11953     IF PB-EXT-DAYS-PROCESSING
 11954          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11955                                         PB-I-LF-EXPIRE-DT
 11956                                         PB-I-AH-EXPIRE-DT
 11957          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11958          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11959          MOVE +1                     TO DC-ELAPSED-MONTHS
 11960          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11961          SET BIN-PLUS-ELAPSED        TO TRUE
 11962*         MOVE 6                      TO DC-OPTION-CODE
 11963          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11964          IF NO-CONVERSION-ERROR
 11965             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11966
 11967******************************************************************
 11968*                                                                *
 11969*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11970*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11971*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11972*        (EXPIRE DATE - (TERM -1))  *  -1.
 11973*                                                                *
 11974******************************************************************
 11975
 11976     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 219
* EL050.cbl
 11977        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11978           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11979              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11980              MOVE PB-I-AH-TERM      TO WS-TERM
 11981           ELSE
 11982              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11983              MOVE PB-I-LF-TERM      TO WS-TERM
 11984        ELSE
 11985           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11986              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11987              MOVE PB-I-LF-TERM      TO WS-TERM
 11988           ELSE
 11989              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11990              MOVE PB-I-AH-TERM      TO WS-TERM.
 11991
 11992     IF PB-EXPIRE-DT-PROCESSING
 11993        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11994        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11995        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11996        MOVE ZERO                TO DC-ELAPSED-DAYS
 11997                                    DC-ODD-DAYS-OVER
 11998          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11999          SET BIN-PLUS-ELAPSED    TO TRUE
 12000*         MOVE 6                  TO DC-OPTION-CODE
 12001          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12002          IF NO-CONVERSION-ERROR
 12003             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12004
 12005******************************************************************
 12006*                                                                *
 12007*            1ST PAYMENT DATE PROCESSING                         *
 12008*                                                                *
 12009******************************************************************
 12010
 12011     IF PB-1ST-PMT-DT-PROCESSING
 12012        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12013                                    PB-I-AH-EXPIRE-DT
 12014        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12015
 12016     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12017         NEXT SENTENCE
 12018     ELSE
 12019         MOVE ER-2680                 TO WS-ERROR
 12020         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12021         GO TO 3060-ORIG-TERM-CHECK.
 12022
 12023     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12024     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12025     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12026*    MOVE 1                      TO DC-OPTION-CODE.
 12027     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12028                                    DC-ELAPSED-DAYS
 12029                                    DC-ODD-DAYS-OVER.
 12030
 12031     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12032
 12033     IF DATE-CONVERSION-ERROR
 12034        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 220
* EL050.cbl
 12035
 12036     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12037     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12038        AND (WS-LF-COVERAGE-TYPE = 'L')
 12039        IF (DC-ELAPSED-MONTHS > 1)
 12040                      OR
 12041           ((DC-ELAPSED-MONTHS = 1)
 12042           AND (DC-ODD-DAYS-OVER > 0))
 12043           MOVE ER-2882          TO WS-ERROR
 12044           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12045        END-IF
 12046     END-IF
 12047     if dc-elapsed-months > 0
 12048        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12049        + dc-odd-days-over
 12050     end-if
 12051     IF PB-EXT-DAYS-PROCESSING
 12052        CONTINUE
 12053     ELSE
 12054        IF DC-ELAPSED-MONTHS = +0
 12055           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12056        ELSE
 12057           IF (WS-LF-EARNINGS-CALC = '4')
 12058              AND (DC-ELAPSED-MONTHS > ZERO)
 12059              AND (DC-ELAPSED-DAYS > ZERO)
 12060              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12061           ELSE
 12062              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12063                                 THRU 6499-EXIT
 12064              MOVE WS-ODD-DAYS-OVER
 12065                                 TO PB-I-EXTENTION-DAYS
 12066           END-IF
 12067        END-IF
 12068     END-IF
 12069******************************************************************
 12070*                                                                *
 12071*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12072*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12073*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12074*            AND ANY ODD DAYS.                                   *
 12075*                                                                *
 12076******************************************************************
 12077
 12078     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12079                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12080     IF WS-LF-EARNINGS-CALC NOT = '4'
 12081        IF DC-ELAPSED-DAYS > ZEROS
 12082           MOVE ER-2681          TO WS-ERROR
 12083           PERFORM 9900-ERROR-FORMAT
 12084                                 THRU 9900-EXIT
 12085        END-IF
 12086     END-IF
 12087
 12088     IF WS-LF-EARNINGS-CALC NOT = '4'
 12089        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12090           MOVE ER-2681          TO WS-ERROR
 12091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12092
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 221
* EL050.cbl
 12093     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12094        (PB-I-LF-TERM NOT = ZERO) AND
 12095         NOT NO-LIFE-COVERAGE
 12096          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12097          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12098          IF WS-LF-EARNINGS-CALC = '4'
 12099             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12100             PB-I-PAY-FREQUENCY
 12101          END-IF
 12102          MOVE ZERO              TO DC-ELAPSED-DAYS
 12103                                    DC-ODD-DAYS-OVER
 12104          MOVE 1                 TO DC-END-OF-MONTH
 12105          SET BIN-PLUS-ELAPSED        TO TRUE
 12106*         MOVE 6                 TO DC-OPTION-CODE
 12107          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12108          IF NO-CONVERSION-ERROR
 12109             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12110             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12111                (WS-LF-SPECIAL-CALC-CD = 'L')
 12112                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12113                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12114                  MOVE +1             TO DC-ELAPSED-MONTHS
 12115                  SET BIN-PLUS-ELAPSED  TO TRUE
 12116*                 MOVE 6              TO DC-OPTION-CODE
 12117                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12118                  IF NO-CONVERSION-ERROR
 12119                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12120
 12121* okay, i had to move the new att age edit down here because the
 12122* expiration date could get recalculated and i need the exp date
 12123     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12124        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12125        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12126        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12127           AND ZEROS
 12128           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12129           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12130           SET ELAPSED-BETWEEN-BIN TO TRUE
 12131           PERFORM 8500-DATE-CONVERT
 12132                                 THRU 8500-EXIT
 12133           IF NO-CONVERSION-ERROR
 12134              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12135                 MOVE ER-2669       TO WS-ERROR
 12136*                PERFORM 9900-ERROR-FORMAT
 12137*                                THRU 9900-EXIT
 12138              END-IF
 12139           END-IF
 12140        ELSE
 12141           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12142           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12143              MOVE ER-2669       TO WS-ERROR
 12144*             PERFORM 9900-ERROR-FORMAT
 12145*                                THRU 9900-EXIT
 12146           ELSE
 12147              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12148                 MOVE ER-1570    TO WS-ERROR
 12149                 PERFORM 9900-ERROR-FORMAT
 12150                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 222
* EL050.cbl
 12151              END-IF
 12152           END-IF
 12153        END-IF
 12154        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12155           AND ZEROS
 12156           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12157           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12158           SET ELAPSED-BETWEEN-BIN TO TRUE
 12159           PERFORM 8500-DATE-CONVERT
 12160                                 THRU 8500-EXIT
 12161           IF NO-CONVERSION-ERROR
 12162              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12163                 MOVE ER-2669       TO WS-ERROR
 12164*                PERFORM 9900-ERROR-FORMAT
 12165*                                THRU 9900-EXIT
 12166              END-IF
 12167           END-IF
 12168        ELSE
 12169           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12170             (PB-I-LF-TERM / 12)
 12171           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12172              MOVE ER-2669       TO WS-ERROR
 12173*             PERFORM 9900-ERROR-FORMAT
 12174*                                THRU 9900-EXIT
 12175           ELSE
 12176              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12177                 MOVE ER-1571    TO WS-ERROR
 12178                 PERFORM 9900-ERROR-FORMAT
 12179                                 THRU 9900-EXIT
 12180              END-IF
 12181           END-IF
 12182        END-IF
 12183        IF WS-ERROR = ER-2669
 12184           PERFORM 9900-ERROR-FORMAT
 12185                                 THRU 9900-EXIT
 12186        END-IF
 12187     END-IF
 12188     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12189        (PB-I-AH-TERM NOT = ZERO) AND
 12190         NOT NO-AH-COVERAGE
 12191          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12192             AND (PB-COMPANY-ID = 'DCC')
 12193             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12194             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12195          ELSE
 12196             IF WS-LF-EARNINGS-CALC = '4'
 12197                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12198                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12199                PB-I-PAY-FREQUENCY
 12200             ELSE
 12201                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12202                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12203             END-IF
 12204          END-IF
 12205          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12206                                         DC-ODD-DAYS-OVER
 12207          MOVE 1                      TO DC-END-OF-MONTH
 12208          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 223
* EL050.cbl
 12209*         MOVE 6                      TO DC-OPTION-CODE
 12210          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12211          IF NO-CONVERSION-ERROR
 12212             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12213     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12214        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12215        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12216        IF PB-I-BIRTHDAY > LOW-VALUES
 12217           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12218           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12219           SET ELAPSED-BETWEEN-BIN TO TRUE
 12220           PERFORM 8500-DATE-CONVERT
 12221                                 THRU 8500-EXIT
 12222           IF NO-CONVERSION-ERROR
 12223              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12224                 MOVE ER-3054       TO WS-ERROR
 12225*                PERFORM 9900-ERROR-FORMAT
 12226*                                THRU 9900-EXIT
 12227              END-IF
 12228           END-IF
 12229        ELSE
 12230           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12231           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12232              MOVE ER-3054       TO WS-ERROR
 12233*             PERFORM 9900-ERROR-FORMAT
 12234*                                THRU 9900-EXIT
 12235           END-IF
 12236        END-IF
 12237        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12238           AND ZEROS
 12239           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12240           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12241           SET ELAPSED-BETWEEN-BIN TO TRUE
 12242           PERFORM 8500-DATE-CONVERT
 12243                                 THRU 8500-EXIT
 12244           IF NO-CONVERSION-ERROR
 12245              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12246                 MOVE ER-3054       TO WS-ERROR
 12247*                PERFORM 9900-ERROR-FORMAT
 12248*                                THRU 9900-EXIT
 12249              END-IF
 12250           END-IF
 12251        ELSE
 12252           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12253             (PB-I-AH-TERM / 12)
 12254           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12255              MOVE ER-3054       TO WS-ERROR
 12256*             PERFORM 9900-ERROR-FORMAT
 12257*                                THRU 9900-EXIT
 12258           END-IF
 12259        END-IF
 12260        IF WS-ERROR = ER-3054
 12261           PERFORM 9900-ERROR-FORMAT
 12262                                 THRU 9900-EXIT
 12263        END-IF
 12264     END-IF
 12265     MOVE SPACE                       TO DC-END-OF-MONTH.
 12266
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 224
* EL050.cbl
 12267     IF PB-COMPANY-ID = 'NCB'
 12268        GO TO 3040-EDIT-EXTENSION-DAYS.
 12269
 12270     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12271       AND
 12272        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12273        NEXT SENTENCE
 12274     ELSE
 12275        GO TO 3040-EDIT-EXTENSION-DAYS.
 12276
 12277     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12278        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12279        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12280     ELSE
 12281        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12282        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12283
 12284     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12285*    MOVE '1'      TO DC-OPTION-CODE
 12286     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12287     IF (NO-CONVERSION-ERROR)
 12288        AND (DC-ELAPSED-MONTHS > +1)
 12289        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12290        MOVE ER-2668   TO WS-ERROR
 12291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12292
 12293 3040-EDIT-EXTENSION-DAYS.
 12294
 12295     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12296        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12297         GO TO 3050-EDIT-TERM-IN-DAYS
 12298     ELSE
 12299         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12300
 12301     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12302         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12303     ELSE
 12304        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12305           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12306           MOVE ER-2681         TO WS-ERROR
 12307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12308
 12309     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12310        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12311        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12312         GO TO 3060-ORIG-TERM-CHECK.
 12313
 12314     GO TO 3060-ORIG-TERM-CHECK.
 12315
 12316 3050-EDIT-TERM-IN-DAYS.
 12317
 12318     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12319
 12320     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12321         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12322     ELSE
 12323         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12324            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 225
* EL050.cbl
 12325            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12326
 12327     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12328                                       REMAINDER WS-WORK-TERM.
 12329     IF WS-WORK-TERM GREATER THAN ZERO
 12330         ADD +1 TO PB-I-LF-TERM.
 12331
 12332     IF NOT NO-AH-COVERAGE
 12333         MOVE ER-2684            TO WS-ERROR
 12334         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12335
 12336
 12337 3060-ORIG-TERM-CHECK.
 12338
 12339******************************************************************
 12340*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12341******************************************************************
 12342
 12343     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12344        NEXT SENTENCE
 12345     ELSE
 12346        IF NOT NO-LIFE-COVERAGE
 12347           IF PB-I-LF-TERM NUMERIC
 12348              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12349              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12350              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12351                  NEXT SENTENCE
 12352           ELSE
 12353              MOVE ER-2647       TO WS-ERROR
 12354              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12355
 12356     IF NOT NO-AH-COVERAGE
 12357         IF PB-I-AH-TERM NUMERIC
 12358            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12359            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12360            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12361             NEXT SENTENCE
 12362          ELSE
 12363              MOVE ER-2658       TO WS-ERROR
 12364              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12365
 12366     IF PB-COMPANY-ID = 'NCB'
 12367        GO TO 3070-LOAN-TERM-CHECK.
 12368
 12369     IF POLICY-HAS-AH
 12370       AND
 12371        POLICY-HAS-LIFE
 12372       AND
 12373        PB-I-LF-TERM NUMERIC
 12374       AND
 12375        PB-I-AH-TERM NUMERIC
 12376        NEXT SENTENCE
 12377     ELSE
 12378        GO TO 3070-LOAN-TERM-CHECK.
 12379
 12380     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12381     IF WS-TEX-FACT-2 LESS THAN +0
 12382        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 226
* EL050.cbl
 12383
 12384     IF WS-TEX-FACT-2 GREATER THAN +1
 12385        MOVE ER-2668             TO WS-ERROR
 12386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12387
 12388 3070-LOAN-TERM-CHECK.
 12389
 12390     IF (WS-LF-BENEFIT-CD = ZERO)
 12391         OR (NO-LF-BENEFIT-MATCH)
 12392            GO TO 3125-EDIT-PMT-FREQ.
 12393*    IF PB-COMPANY-ID NOT = 'DCC'
 12394*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12395*          AND 'V' AND 'W' AND 'X'
 12396*          GO TO 3125-EDIT-PMT-FREQ
 12397*       END-IF
 12398*    ELSE
 12399*       IF WS-AH-DCC-TRUNC = 'T'
 12400*          CONTINUE
 12401*       ELSE
 12402*          GO TO 3125-EDIT-PMT-FREQ
 12403*       END-IF
 12404*    END-IF
 12405     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12406                    OR
 12407        ((PB-COMPANY-ID = 'DCC')
 12408        AND (WS-AH-DCC-TRUNC = 'T'))
 12409        CONTINUE
 12410     ELSE
 12411        GO TO 3125-EDIT-PMT-FREQ
 12412     END-IF
 12413     IF PB-I-LOAN-TERM NOT NUMERIC
 12414         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12415
 12416     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12417        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12418*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12419        PB-I-LOAN-TERM NOT GREATER THAN +360
 12420         NEXT SENTENCE
 12421     ELSE
 12422         MOVE ER-2648            TO WS-ERROR
 12423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12424
 12425     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12426        MOVE ER-3058             TO WS-ERROR
 12427        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12428     end-if
 12429
 12430     IF WS-STATE-ABBREVIATION = 'NC'
 12431        IF PB-I-LOAN-TERM > +59
 12432           CONTINUE
 12433        ELSE
 12434           MOVE ER-2792          TO WS-ERROR
 12435           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12436        END-IF
 12437     END-IF
 12438
 12439     .
 12440 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 227
* EL050.cbl
 12441     IF (WS-LF-BENEFIT-CD = ZERO)
 12442         OR (NO-LF-BENEFIT-MATCH)
 12443            GO TO 3127-EDIT-LOAN-OFFICER.
 12444     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12445                    OR
 12446        ((PB-COMPANY-ID = 'DCC')
 12447        AND (WS-AH-DCC-TRUNC = 'T'))
 12448                    OR
 12449         (PB-COMPANY-ID = 'AHL')
 12450        CONTINUE
 12451     ELSE
 12452        IF (PB-I-LOAN-TERM > ZEROS)
 12453           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12454           MOVE ER-1575          TO WS-ERROR
 12455           PERFORM 9900-ERROR-FORMAT
 12456                                 THRU 9900-EXIT
 12457        END-IF
 12458     END-IF
 12459     IF WS-LF-EARNINGS-CALC NOT = '4'
 12460         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12461            MOVE ER-2653         TO WS-ERROR
 12462            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12463            GO TO 3127-EDIT-LOAN-OFFICER
 12464         ELSE
 12465            GO TO 3127-EDIT-LOAN-OFFICER.
 12466
 12467     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12468         MOVE ER-2655            TO WS-ERROR
 12469         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12470         GO TO 3127-EDIT-LOAN-OFFICER.
 12471
 12472     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12473         MOVE ER-2654            TO WS-ERROR
 12474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12475         GO TO 3127-EDIT-LOAN-OFFICER.
 12476
 12477     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12478         GIVING WS-TEX-FACT-2
 12479             REMAINDER WS-TEX-FACT-3.
 12480
 12481*    IF WS-TEX-FACT-3 NOT = ZERO
 12482*       MOVE ER-2654             TO WS-ERROR
 12483*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12484
 12485
 12486 3127-EDIT-LOAN-OFFICER.
 12487
 12488     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12489        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12490           MOVE ER-2690          TO WS-ERROR
 12491           PERFORM 9900-ERROR-FORMAT
 12492                                 THRU 9900-EXIT
 12493        ELSE
 12494           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12495           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12496           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12497           MOVE PB-SV-STATE      TO LOFC-STATE
 12498           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 228
* EL050.cbl
 12499           MOVE PB-I-LOAN-OFFICER
 12500                                 TO LOFC-CODE
 12501           PERFORM 8586-READ-LOAN-OFFICER
 12502                                 THRU 8586-EXIT
 12503           IF (NOT LOFC-MASTER-FOUND)
 12504              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12505              MOVE ER-3006       TO WS-ERROR
 12506              PERFORM 9900-ERROR-FORMAT
 12507                                 THRU 9900-EXIT
 12508           END-IF
 12509        END-IF
 12510     END-IF
 12511     .
 12512 3129-EDIT-APR.
 12513
 12514     IF (WS-LF-BENEFIT-CD = ZERO)
 12515        OR (NO-LF-BENEFIT-MATCH)
 12516        IF PB-COMPANY-ID NOT = 'DCC'
 12517           GO TO 3130-EDIT-AGE
 12518*       ELSE
 12519*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12520*             GO TO 3130-EDIT-AGE
 12521*          END-IF
 12522        END-IF
 12523     END-IF
 12524
 12525     IF (WS-STATE-ABBREVIATION = 'OH')
 12526         AND (PB-I-RATE-CLASS NOT = 'L ')
 12527         AND (PB-I-LF-TERM GREATER THAN 60)
 12528         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12529         GO TO 3129-APR-CONT.
 12530
 12531     IF (WS-STATE-ABBREVIATION = 'RI')
 12532         AND (PB-I-LF-TERM GREATER THAN 60)
 12533         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12534         GO TO 3129-APR-CONT.
 12535
 12536     IF (WS-STATE-ABBREVIATION = 'UT')
 12537         AND (PB-I-LF-TERM GREATER THAN 62)
 12538         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12539         AND (PB-CERT-EFF-DT LESS WS-830901)
 12540         GO TO 3129-APR-CONT.
 12541
 12542     IF PB-COMPANY-ID = 'LAP'
 12543        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12544           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12545              MOVE ER-2656         TO WS-ERROR
 12546              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12547              GO TO 3130-EDIT-AGE.
 12548
 12549     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12550        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12551        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12552        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12553        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12554        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12555         GO TO 3130-EDIT-AGE.
 12556
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 229
* EL050.cbl
 12557 3129-APR-CONT.
 12558     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12559         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12560         GO TO 3130-EDIT-AGE.
 12561
 12562     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12563         WS-AH-BENEFIT-CD (1:1) = 'S')
 12564        AND (PB-COMPANY-ID = 'DCC')
 12565        AND (PB-I-LOAN-APR = ZERO)
 12566        MOVE ER-2657             TO WS-ERROR
 12567        PERFORM 9900-ERROR-FORMAT
 12568                                 THRU 9900-EXIT
 12569        GO TO 3130-EDIT-AGE
 12570     END-IF
 12571*    IF PB-I-LOAN-APR = ZERO
 12572*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12573*    END-IF
 12574
 12575     if pb-i-loan-apr = +99.9999
 12576        move er-2656             to ws-error
 12577        PERFORM 9900-ERROR-FORMAT
 12578                                 THRU 9900-EXIT
 12579        GO TO 3130-EDIT-AGE
 12580     end-if
 12581*    IF PB-I-LOAN-APR = ZERO
 12582*       MOVE ER-2656             TO WS-ERROR
 12583*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12584*       GO TO 3130-EDIT-AGE.
 12585
 12586*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12587     if pb-i-loan-apr not = +99.9999
 12588        IF PB-I-LOAN-APR > +30.000
 12589           MOVE ER-2657          TO WS-ERROR
 12590           PERFORM 9900-ERROR-FORMAT
 12591                                 THRU 9900-EXIT
 12592        end-if
 12593     end-if
 12594     .
 12595 3130-EDIT-AGE.
 12596
 12597******************************************************************
 12598*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12599******************************************************************
 12600
 12601     IF NOT NO-LIFE-COVERAGE
 12602        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12603           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12604               MOVE ER-2628             TO WS-ERROR
 12605               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12606
 12607     IF NOT NO-AH-COVERAGE
 12608        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12609           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12610               MOVE ER-2628         TO WS-ERROR
 12611               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12612
 12613 3133-SEX-CODE.
 12614     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 230
* EL050.cbl
 12615         IF WS-DEFAULT-SEX = 'M'
 12616             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12617          ELSE
 12618             IF WS-DEFAULT-SEX = 'F'
 12619             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12620
 12621     IF PB-I-INSURED-SEX = '1'
 12622         MOVE 'M' TO PB-I-INSURED-SEX.
 12623
 12624     IF PB-I-INSURED-SEX = '2'
 12625         MOVE 'F' TO PB-I-INSURED-SEX.
 12626
 12627 3134-SIG-SW-EDIT.
 12628     IF PB-I-SIG-SW = SPACE
 12629         MOVE 'N'                TO  PB-I-SIG-SW.
 12630
 12631     IF PB-COMPANY-ID = 'NCL'
 12632         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12633             NEXT SENTENCE
 12634         ELSE
 12635             MOVE ER-1923        TO  WS-ERROR
 12636             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12637     ELSE
 12638     IF PB-COMPANY-ID = 'CRI'
 12639         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12640             NEXT SENTENCE
 12641         ELSE
 12642             MOVE ER-2606        TO  WS-ERROR
 12643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12644     ELSE
 12645     IF PB-COMPANY-ID = 'TMS'
 12646         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12647             NEXT SENTENCE
 12648         ELSE
 12649             MOVE ER-2689        TO  WS-ERROR
 12650             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12651     ELSE
 12652         IF PB-I-SIG-SW = 'Y' OR 'N'
 12653             NEXT SENTENCE
 12654         ELSE
 12655             MOVE ER-2651        TO  WS-ERROR
 12656             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12657
 12658     IF PB-COMPANY-ID = 'FLA'
 12659         IF (WS-EDIT-AGE GREATER 54  OR
 12660             WS-AH-EDIT-AGE GREATER 54)  AND
 12661            PB-I-SIG-SW = 'N'
 12662            MOVE ER-2651         TO  WS-ERROR
 12663            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12664
 12665 3135-NAME-EDIT.
 12666
 12667     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12668        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12669        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12670           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12671                                 TO PB-I-JOINT-FIRST-NAME
 12672        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 231
* EL050.cbl
 12673     END-IF
 12674     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12675        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12676        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12677           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12678                                 TO PB-I-JOINT-LAST-NAME
 12679        END-PERFORM
 12680     END-IF
 12681     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12682        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12683        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12684           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12685                                 TO PB-I-INSURED-FIRST-NAME
 12686        END-PERFORM
 12687     END-IF
 12688     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12689        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12690        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12691           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12692                                 TO PB-I-INSURED-LAST-NAME
 12693        END-PERFORM
 12694     END-IF
 12695     IF PB-I-INSURED-LAST-NAME = SPACES
 12696       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12697       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12698           MOVE ER-2660    TO WS-ERROR
 12699           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12700
 12701 3136-EDIT-SEX.
 12702
 12703******************************************************************
 12704*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12705******************************************************************
 12706
 12707     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12708        (WS-AH-SPECIAL-CALC-CD = 'O')
 12709        NEXT SENTENCE
 12710     ELSE
 12711        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12712           NEXT SENTENCE
 12713        ELSE
 12714           MOVE ER-2629            TO WS-ERROR
 12715           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12716
 12717 3137-EDIT-EFF-DATE.
 12718
 12719     IF PB-REISSUED-CERT       OR
 12720        PB-POLICY-IS-DECLINED  OR
 12721        PB-POLICY-IS-VOIDED
 12722         GO TO 3139-EDIT-COVERAGE-CODES.
 12723
 12724     MOVE SPACE                  TO WS-2671-SW
 12725                                    WS-2672-SW.
 12726
 12727     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12728         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12729             MOVE ER-2703        TO WS-ERROR
 12730             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 232
* EL050.cbl
 12731             GO TO 3139-EDIT-COVERAGE-CODES.
 12732
 12733     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12734         GO TO 3139-EDIT-COVERAGE-CODES.
 12735
 12736     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12737     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12738*    MOVE '1'                    TO DC-OPTION-CODE.
 12739     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12740     MOVE +0                     TO DC-ELAPSED-MONTHS
 12741                                    DC-ELAPSED-DAYS.
 12742     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12743
 12744     IF DATE-CONVERSION-ERROR
 12745         GO TO 3139-EDIT-COVERAGE-CODES.
 12746
 12747     IF DC-ELAPSED-DAYS GREATER +180
 12748         MOVE ER-2672            TO WS-ERROR
 12749         MOVE 'Y'                TO WS-2672-SW
 12750         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12751     END-IF
 12752
 12753     IF WS-ERROR = ER-2671  AND
 12754        PB-COMPANY-ID  = 'LBL'
 12755        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12756        MOVE SPACE               TO WS-2671-SW
 12757        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12758
 12759     IF PB-ISSUE-DATE-FORCED  AND
 12760      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12761         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12762         MOVE ER-2673            TO WS-ERROR
 12763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12764         MOVE SPACE              TO WS-2671-SW
 12765                                    WS-2672-SW.
 12766
 12767     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12768         IF PB-ISSUE-DATE-FORCED
 12769             MOVE ER-2600          TO  WS-ERROR
 12770             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12771         ELSE
 12772             MOVE ER-2692          TO  WS-ERROR
 12773             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12774
 12775
 12776 3139-EDIT-COVERAGE-CODES.
 12777
 12778     if pb-company-id not = 'AHL'
 12779        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12780           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12781           MOVE ER-2787          TO WS-ERROR
 12782           PERFORM 9900-ERROR-FORMAT
 12783                                 THRU 9900-EXIT
 12784        END-IF
 12785     end-if
 12786     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12787        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12788                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 233
* EL050.cbl
 12789           MOVE ER-2719          TO WS-ERROR
 12790           PERFORM 9900-ERROR-FORMAT
 12791                                 THRU 9900-EXIT
 12792        END-IF
 12793     END-IF
 12794
 12795     IF PB-POLICY-IS-DECLINED  OR
 12796        PB-POLICY-IS-VOIDED
 12797         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12798
 12799     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12800        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12801         MOVE ER-2630                TO WS-ERROR
 12802         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12803
 12804     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12805        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12806        PB-I-LF-PREMIUM-AMT = ZERO
 12807         GO TO 3140-CHECK-AH-FOR-ZERO.
 12808
 12809     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12810        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12811        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12812         GO TO 3140-CHECK-AH-FOR-ZERO.
 12813
 12814     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12815        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12816        MOVE ER-2631             TO WS-ERROR
 12817        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12818     END-IF
 12819
 12820
 12821******************************************************************
 12822*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12823******************************************************************
 12824
 12825     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12826        NEXT SENTENCE
 12827     ELSE
 12828        IF PB-I-LF-BENEFIT-AMT = ZERO
 12829           MOVE ER-2632             TO WS-ERROR
 12830           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12831
 12832
 12833******************************************************************
 12834*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12835******************************************************************
 12836
 12837     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12838        CONTINUE
 12839     ELSE
 12840        IF PB-I-LF-PREMIUM-AMT = ZERO
 12841           IF (NOT PB-COMP-LF-PREM)
 12842              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12843              MOVE ER-2633       TO WS-ERROR
 12844              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12845           END-IF
 12846        END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 234
* EL050.cbl
 12847     END-IF
 12848     .
 12849 3140-CHECK-AH-FOR-ZERO.
 12850
 12851     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12852        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12853        PB-I-AH-PREMIUM-AMT = ZERO
 12854         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12855
 12856     IF PB-COMPANY-ID = 'CSL'  AND
 12857        PB-I-AH-BENEFIT-CD = ZERO  AND
 12858        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12859        PB-I-AH-PREMIUM-AMT = ZERO
 12860         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12861
 12862     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12863        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12864        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12865         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12866
 12867     IF PB-I-AH-BENEFIT-CD = ZERO
 12868         MOVE ER-2634            TO WS-ERROR
 12869         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12870
 12871******************************************************************
 12872*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12873******************************************************************
 12874
 12875     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12876        NEXT SENTENCE
 12877     ELSE
 12878        IF PB-I-AH-BENEFIT-AMT = ZERO
 12879           MOVE ER-2635             TO WS-ERROR
 12880           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12881
 12882******************************************************************
 12883*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12884******************************************************************
 12885
 12886     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12887        NEXT SENTENCE
 12888     ELSE
 12889        IF PB-I-AH-PREMIUM-AMT = ZERO
 12890            IF NOT PB-COMP-AH-PREM
 12891                MOVE ER-2636    TO WS-ERROR
 12892                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12893
 12894
 12895 3140-EDIT-MAX-AMT-SIZES.
 12896* CUSTOM CODE FOR CLIENT    'DMD'
 12897     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12898                                     WS-RES-MUNI-TAX
 12899                                     PB-I-STATE-TAX
 12900                                     PB-I-MUNI-TAX.
 12901
 12902     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12903
 12904     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 235
* EL050.cbl
 12905        GO TO 3150-RATE-OUTSTAND-BAL.
 12906
 12907     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12908        GO TO 3150-RATE-OUTSTAND-BAL.
 12909
 12910     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12911        GO TO 3150-RATE-OUTSTAND-BAL.
 12912
 12913     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12914                             OR 'RIC')
 12915        GO TO 3150-RATE-OUTSTAND-BAL.
 12916
 12917     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12918        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12919            GO TO 3150-RATE-OUTSTAND-BAL
 12920        ELSE
 12921           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12922               GO TO 3150-RATE-OUTSTAND-BAL.
 12923
 12924     IF NOT PB-NO-MONTHS-SKIPPED
 12925        GO TO 3150-RATE-OUTSTAND-BAL.
 12926
 12927     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12928        GO TO 3150-RATE-OUTSTAND-BAL.
 12929
 12930     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12931        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12932           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12933             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12934           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12935           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12936              MOVE ER-2693     TO WS-ERROR
 12937              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12938              GO TO 3150-RATE-OUTSTAND-BAL
 12939           ELSE
 12940              GO TO 3150-RATE-OUTSTAND-BAL.
 12941
 12942 3150-RATE-OUTSTAND-BAL.
 12943
 12944* DMD RATING TEST
 12945     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12946         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12947         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12948         MOVE ER-2687                 TO WS-ERROR
 12949         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12950         MOVE 'B'                     TO PB-I-OB-FLAG
 12951         GO TO 3260-EDIT-CONTINUE.
 12952
 12953     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12954         IF  WS-ERROR    EQUAL    ER-2693
 12955             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12956                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12957                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12958                 MOVE  +0            TO  WS-ERROR.
 12959
 12960     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12961         IF  WS-ERROR    EQUAL    ER-2693
 12962             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 236
* EL050.cbl
 12963                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12964                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12965                 MOVE  +0            TO  WS-ERROR.
 12966
 12967     IF PLAN-MASTER-AH-SW = 'Y'
 12968        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12969            IF  WS-ERROR    EQUAL    ER-2693
 12970              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12971                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12972                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12973                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12974                 MOVE  ER-1910           TO  WS-ERROR
 12975                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12976
 12977     IF PLAN-MASTER-AH-SW = 'Y'
 12978        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12979            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12980               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12981               MOVE  ER-1910           TO  WS-ERROR
 12982               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12983
 12984     IF PLAN-MASTER-AH-SW = 'Y'
 12985        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12986            IF  WS-ERROR    EQUAL    ER-2693
 12987                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12988                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12989                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12990                 MOVE  +0       TO  WS-ERROR.
 12991
 12992     IF WS-ERROR = ER-2693
 12993        IF PB-COMPANY-ID = 'JAL' AND
 12994           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12995           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12996           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12997
 12998     IF WS-ERROR = ER-2693
 12999        IF PB-COMPANY-ID = 'NCL'  AND
 13000           PB-I-AH-BENEFIT-CD = 'OA'
 13001           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13002           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13003
 13004     IF WS-ERROR = ER-2693
 13005        IF PB-COMPANY-ID = 'CNL' AND
 13006           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13007           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13008           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13009
 13010     IF WS-ERROR = ER-2693
 13011        IF PB-COMPANY-ID = 'HER'
 13012           IF WS-LEVEL
 13013              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13014              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13015
 13016     IF ((LF-BENEFIT-FOUND) AND
 13017         (NOT NO-LIFE-COVERAGE)  AND
 13018         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13019       OR   ((AH-BENEFIT-FOUND) AND
 13020             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 237
* EL050.cbl
 13021             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13022         NEXT SENTENCE
 13023     ELSE
 13024         GO TO 3215-EDIT-RATES.
 13025
 13026     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13027        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13028           MOVE ER-2674          TO WS-ERROR
 13029           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13030           GO TO 3215-EDIT-RATES.
 13031
 13032     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13033        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13034           MOVE ER-2674          TO WS-ERROR
 13035           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13036           GO TO 3215-EDIT-RATES.
 13037
 13038     MOVE 'B'                    TO PB-I-OB-FLAG.
 13039
 13040     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13041         NEXT SENTENCE
 13042     ELSE
 13043         IF NOT NO-LIFE-COVERAGE
 13044             IF WS-ACCT-LF-OB-RT = ZERO
 13045                MOVE ER-2641    TO WS-ERROR
 13046                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13047
 13048     IF PB-COMPANY-ID = 'CRI'
 13049       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13050         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13051         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13052         IF WS-ERROR = ER-2675
 13053            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13054            MOVE ER-2687              TO WS-ERROR
 13055            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13056         ELSE
 13057            MOVE ER-2687              TO WS-ERROR
 13058            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13059
 13060
 13061     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13062         NEXT SENTENCE
 13063     ELSE
 13064       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13065            NEXT SENTENCE
 13066       ELSE
 13067         IF NOT NO-AH-COVERAGE
 13068             IF WS-ACCT-AH-OB-RT = ZERO
 13069                MOVE ER-2642    TO WS-ERROR
 13070                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13071
 13072     IF PB-COMPANY-ID = 'CRI'
 13073       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13074         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13075         IF WS-ERROR = ER-2676
 13076            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13077            MOVE ER-2687              TO WS-ERROR
 13078            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 238
* EL050.cbl
 13079         ELSE
 13080            MOVE ER-2687              TO WS-ERROR
 13081            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13082
 13083     IF PB-COMPANY-ID NOT = 'GIC'
 13084         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13085            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13086     ELSE
 13087         IF PB-I-LF-PREM-CALC = ZEROS
 13088             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13089                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13090
 13091     IF PB-COMPANY-ID NOT = 'GIC'
 13092         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13093            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13094     ELSE
 13095         IF PB-I-AH-PREM-CALC = ZEROS
 13096             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13097                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13098
 13099     MOVE ZEROS TO PB-I-MORT-CODE.
 13100
 13101     GO TO 3260-EDIT-CONTINUE.
 13102
 13103
 13104 3215-EDIT-RATES.
 13105     IF ACCOUNT-MAST-FOUND
 13106         NEXT SENTENCE
 13107     ELSE
 13108         GO TO 3999-END-EDIT.
 13109
 13110 3220-CHECK-LF-RATES.
 13111
 13112     IF PB-COMPANY-ID = 'DCC'
 13113        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13114        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13115        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13116           AND (NOT WS-LF-CASH))
 13117                           OR
 13118           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13119           AND (NOT WS-AH-CASH)))
 13120                       AND
 13121           (PB-I-ENTRY-STATUS NOT = '5')
 13122           MOVE 'M'              TO PB-BATCH-ENTRY
 13123                                    PB-I-ENTRY-STATUS
 13124        END-IF
 13125     END-IF
 13126     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13127                                    PB-I-AH-PREM-CALC
 13128                                    PB-I-LF-ALT-PREM-CALC
 13129                                    PB-I-LF-ALT-RATE
 13130                                    PB-I-LF-REI-RATE
 13131                                    PB-I-LF-ALT-REI-RATE
 13132                                    PB-I-AH-REI-RATE
 13133                                    PB-I-TOT-FEES-CALC.
 13134
 13135     IF PB-COMPANY-ID EQUAL 'DMD'
 13136        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 239
* EL050.cbl
 13137     ELSE
 13138        MOVE ZEROS               TO PB-I-LF-RATE
 13139                                    PB-I-AH-RATE.
 13140
 13141     IF PB-I-TOT-FEES NOT NUMERIC
 13142        MOVE ZEROS               TO PB-I-TOT-FEES
 13143     END-IF
 13144     IF PB-I-LIVES NOT NUMERIC
 13145         MOVE ZERO               TO PB-I-LIVES.
 13146
 13147     IF PB-I-NUM-BILLED NOT NUMERIC
 13148         MOVE ZERO               TO PB-I-NUM-BILLED.
 13149
 13150     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13151        MOVE +0                  TO PB-I-LF-PREM-TAX
 13152     END-IF
 13153
 13154     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13155        MOVE +0                  TO PB-I-AH-PREM-TAX
 13156     END-IF
 13157
 13158     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13159        PB-I-PAY-FREQUENCY = ZEROS
 13160            MOVE 12 TO CP-PAY-FREQUENCY
 13161     ELSE
 13162            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13163
 13164     IF PB-I-STATE-TAX NOT NUMERIC
 13165         MOVE ZEROS               TO PB-I-STATE-TAX.
 13166
 13167     IF PB-I-MUNI-TAX NOT NUMERIC
 13168         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13169
 13170     MOVE SPACES                 TO CP-BEN-CATEGORY
 13171     IF PB-COMPANY-ID  = 'CSL'  AND
 13172        PB-I-LF-TERM NOT = ZERO
 13173        COMPUTE WS-PAYMENT-AMT =
 13174             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13175        COMPUTE WS-CSL-AMT1 =
 13176             PB-I-LF-TERM * AM-MAX-MON-BEN
 13177        COMPUTE WS-CSL-AMT2 =
 13178             WS-PAYMENT-AMT * PB-I-LF-TERM
 13179        IF CP-PAY-FREQUENCY NOT = 12
 13180           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13181           MOVE '8' TO WS-CSL-CALC-CD
 13182        ELSE
 13183           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13184              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13185               AM-MAX-TOT-BEN
 13186               MOVE '6' TO WS-CSL-CALC-CD
 13187           ELSE
 13188              IF (WS-CSL-AMT1  GREATER THAN
 13189                 AM-MAX-TOT-BEN) AND
 13190                 (WS-CSL-AMT2  GREATER THAN
 13191                 AM-MAX-TOT-BEN)
 13192                 MOVE '7' TO WS-CSL-CALC-CD
 13193              ELSE
 13194                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 240
* EL050.cbl
 13195
 13196     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13197         NEXT SENTENCE
 13198     ELSE
 13199         GO TO 3300-CHECK-AH-RATES.
 13200
 13201*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13202
 13203     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13204        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13205              OR
 13206           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13207           MOVE ER-2618          TO WS-ERROR
 13208           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13209           GO TO 3300-CHECK-AH-RATES.
 13210
 13211     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13212           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13213                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13214
 13215     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13216         MOVE ER-2687             TO WS-ERROR
 13217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13218         MOVE 'Z000'              TO PB-I-MORT-CODE
 13219         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13220         GO TO 3300-CHECK-AH-RATES.
 13221
 13222     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13223        IF PB-I-LIVES = ZERO
 13224           MOVE ER-2688          TO WS-ERROR
 13225           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13226
 13227     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13228
 13229     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13230     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13231     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13232     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13233     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13234     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13235     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13236     MOVE '3'                    TO CP-PROCESS-TYPE.
 13237     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13238     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13239
 13240******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13241     IF PB-COMPANY-ID EQUAL 'CDL'
 13242         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13243            CP-EARN-AS-NET-PAY)
 13244             IF PB-CERT-EFF-DT GREATER  WS-931231
 13245                 MOVE '1'        TO CP-EARNING-METHOD.
 13246*******
 13247
 13248     MOVE PB-SV-STATE            TO CP-STATE.
 13249     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13250     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13251     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13252     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 241
* EL050.cbl
 13253     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13254                                    CP-RATING-BENEFIT-AMT.
 13255     IF CP-STATE-STD-ABBRV = 'OR'
 13256         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13257                                         PB-I-LF-ALT-BENEFIT-AMT.
 13258     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13259     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13260     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13261     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13262     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13263     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13264     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13265     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13266     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13267                                    CP-REMAINING-TERM
 13268                                    CP-LOAN-TERM.
 13269
 13270     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13271         NEXT SENTENCE
 13272     ELSE
 13273         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13274             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13275                                           PB-I-LF-PREMIUM-AMT.
 13276
 13277     IF PB-COMPANY-ID EQUAL 'CSL'
 13278        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13279           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13280                                         PB-I-LF-PREMIUM-AMT.
 13281
 13282     IF PB-COMPANY-ID EQUAL 'NCB'
 13283         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13284            CP-EARN-AS-NET-PAY
 13285             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13286                 PB-I-LF-PREMIUM-AMT.
 13287
 13288     IF (CP-TRUNCATED-LIFE)
 13289        or ((pb-company-id = 'AHL')
 13290           and (pb-i-loan-term > pb-i-lf-term))
 13291        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13292
 13293     IF PB-COMPANY-ID EQUAL 'CRI'
 13294        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13295
 13296     IF CP-TERM-IS-DAYS
 13297         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13298     ELSE
 13299         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13300     IF PB-COMPANY-ID = 'DCC'
 13301        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13302        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13303        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13304        IF WS-LF-BEN-CATEGORY = 'D'
 13305           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13306           MOVE PB-I-LIFE-COMMISSION
 13307                                 TO CP-DCC-ACT-COMM
 13308           MOVE WS-LF-BEN-CATEGORY
 13309                                 TO CP-BEN-CATEGORY
 13310        END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 242
* EL050.cbl
 13311        IF (CP-BENEFIT-CD (1:1) = 'P')
 13312           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13313           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13314           add pb-i-ah-premium-amt to cp-original-premium
 13315        END-IF
 13316     END-IF
 13317     IF PB-COMPANY-ID = 'CSL'
 13318         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13319         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13320         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13321
 13322     IF PB-COMPANY-ID = 'CSL'
 13323        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13324
 13325     IF (CP-SPECIAL-CALC-CD = 'H')
 13326        OR (PB-COMPANY-ID = 'DCC')
 13327         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13328                                    TO CP-ALTERNATE-BENEFIT
 13329         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13330
 13331     IF (PB-COMPANY-ID = 'CID')
 13332        AND (WS-LF-EARNINGS-CALC = 'B')
 13333        AND (CP-STATE-STD-ABBRV = 'MN')
 13334        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13335                                 TO CP-ALTERNATE-BENEFIT
 13336        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13337     END-IF
 13338     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13339     MOVE 'R'                   TO CP-RATE-FILE.
 13340     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13341
 13342     IF CP-ERROR-RATE-NOT-FOUND
 13343        MOVE ER-2641            TO WS-ERROR
 13344        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13345        GO TO 3300-CHECK-AH-RATES.
 13346
 13347     IF PB-COMPANY-ID EQUAL 'CRI'
 13348        IF CP-ERROR-NO-LIMITS-CRI
 13349           IF NOT ACCOUNT-LIFE-CHECKED
 13350              MOVE ER-2607      TO WS-ERROR
 13351              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13352
 13353******************************************************************
 13354*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13355*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13356******************************************************************
 13357
 13358* CALC LIFE AGE AT EXPIRATION.
 13359
 13360     COMPUTE WS-AGE-AT-EXPIRE =
 13361          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13362
 13363*    IF PB-STATE = 'CO' OR 'UT'
 13364*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13365*        MOVE 'F'            TO PB-FATAL-FLAG
 13366*        MOVE ER-2709        TO WS-ERROR
 13367*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13368*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 243
* EL050.cbl
 13369
 13370*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13371*        MOVE 'X'            TO PB-FATAL-FLAG
 13372*        MOVE ER-2718        TO WS-ERROR
 13373*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13374*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13375
 13376* CALC A & H AGE AT EXPIRATION.
 13377
 13378     COMPUTE WS-AGE-AT-EXPIRE =
 13379          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13380
 13381*    IF PB-STATE = 'CO' OR 'UT'
 13382*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13383*        MOVE 'F'            TO PB-FATAL-FLAG
 13384*        MOVE ER-2709        TO WS-ERROR
 13385*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13386*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13387
 13388*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13389*        MOVE 'X'            TO PB-FATAL-FLAG
 13390*        MOVE ER-2718        TO WS-ERROR
 13391*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13392*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13393
 13394     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13395        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13396
 13397     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13398        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13399     end-if
 13400
 13401     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13402        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13403
 13404     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13405         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13406         MOVE ER-2639        TO WS-ERROR
 13407         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13408
 13409
 13410******************************************************************
 13411*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13412******************************************************************
 13413
 13414 PREMIUM-EDITING-IS-BYPASSED.
 13415     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13416        AND (CP-R-MAX-ATT-AGE > +0)
 13417        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13418        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13419           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13420           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13421           MOVE '1'              TO DC-OPTION-CODE
 13422           PERFORM 8500-DATE-CONVERT
 13423                                 THRU 8500-EXIT
 13424           IF NO-CONVERSION-ERROR
 13425              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13426                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 244
* EL050.cbl
 13427*                PERFORM 9900-ERROR-FORMAT
 13428*                                THRU 9900-EXIT
 13429              END-IF
 13430           END-IF
 13431        ELSE
 13432           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13433           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13434              MOVE ER-2661       TO WS-ERROR
 13435*             PERFORM 9900-ERROR-FORMAT
 13436*                                THRU 9900-EXIT
 13437           ELSE
 13438              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13439                 MOVE ER-1570    TO WS-ERROR
 13440                 PERFORM 9900-ERROR-FORMAT
 13441                                 THRU 9900-EXIT
 13442              END-IF
 13443           END-IF
 13444        END-IF
 13445        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13446           MOVE PB-I-JOINT-BIRTHDAY
 13447                                 TO DC-BIN-DATE-1
 13448           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13449           MOVE '1'              TO DC-OPTION-CODE
 13450           PERFORM 8500-DATE-CONVERT
 13451                                 THRU 8500-EXIT
 13452           IF NO-CONVERSION-ERROR
 13453              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13454                 MOVE ER-2661       TO WS-ERROR
 13455*                PERFORM 9900-ERROR-FORMAT
 13456*                                THRU 9900-EXIT
 13457              END-IF
 13458           ELSE
 13459              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13460           END-IF
 13461        ELSE
 13462           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13463             (PB-I-LF-TERM / 12)
 13464           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13465              MOVE ER-2661       TO WS-ERROR
 13466*             PERFORM 9900-ERROR-FORMAT
 13467*                                THRU 9900-EXIT
 13468           ELSE
 13469              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13470                 MOVE ER-1571    TO WS-ERROR
 13471                 PERFORM 9900-ERROR-FORMAT
 13472                                 THRU 9900-EXIT
 13473              END-IF
 13474           END-IF
 13475        END-IF
 13476        IF WS-ERROR = ER-2661
 13477           PERFORM 9900-ERROR-FORMAT
 13478                                 THRU 9900-EXIT
 13479        END-IF
 13480     END-IF
 13481*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13482*       MOVE ER-2661             TO WS-ERROR
 13483*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13484
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 245
* EL050.cbl
 13485     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13486        MOVE ER-2662             TO WS-ERROR
 13487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13488
 13489     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13490        MOVE ER-2677             TO WS-ERROR
 13491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13492
 13493     IF CP-ERROR-LOAN-TERM
 13494        MOVE ER-2648             TO WS-ERROR
 13495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13496
 13497 3221-CHECK-ERROR-RATE-OPEN.
 13498
 13499     IF CP-ERROR-RATE-FILE-NOTOPEN
 13500         GO TO 3990-FILES-NOT-OPEN.
 13501
 13502     IF PB-COMPANY-ID NOT = 'DMD'
 13503        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13504     END-IF
 13505     .
 13506 3221-CONTINUE.
 13507     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13508                                    WS-DCC-AH-RATE
 13509     IF PB-COMPANY-ID = 'DCC'
 13510        IF WS-LF-BEN-CATEGORY = 'D'
 13511           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13512              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13513        END-IF
 13514     END-IF
 13515     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13516*   X'A4FF' = 12/31/2009
 13517     IF (PB-COMPANY-ID = 'CID')
 13518        AND (WS-LF-EARNINGS-CALC = 'B')
 13519        AND (CP-STATE-STD-ABBRV = 'MN')
 13520        AND (PB-CERT-EFF-DT > X'A4FF')
 13521        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13522     END-IF
 13523     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13524
 13525     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13526     IF (PB-COMPANY-ID = 'DCC')
 13527        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13528        AND (PB-I-POLICY-IS-MONTHLY)
 13529        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13530        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13531     END-IF
 13532     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13533     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13534     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13535     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13536     IF (PB-COMPANY-ID = 'DCC')
 13537        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13538        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13539        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13540        MOVE ER-2786             TO WS-ERROR
 13541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13542     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 246
* EL050.cbl
 13543
 13544     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13545
 13546******************************************************************
 13547*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13548******************************************************************
 13549     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13550        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13551
 13552     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13553        GO TO 3225-CHECK-ALT-LIFE-RATE
 13554     ELSE
 13555       IF PB-I-LF-RATE = ZERO
 13556          MOVE ER-2641          TO WS-ERROR
 13557          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13558
 13559 3225-CHECK-ALT-LIFE-RATE.
 13560
 13561     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13562        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13563        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13564         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13565
 13566     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13567         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13568             AND PB-COMPANY-ID NOT = 'DCC')
 13569                   OR
 13570              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13571              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13572              AND PB-COMPANY-ID NOT = 'DCC')
 13573             MOVE ER-2720        TO  WS-ERROR
 13574             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13575             GO TO 3225-RATING-CONT
 13576         ELSE
 13577             GO TO 3225-RATING-CONT.
 13578     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13579        AND (AM-GPCD = 01 OR 06 OR 15)
 13580        MOVE ER-2798             TO WS-ERROR
 13581        PERFORM 9900-ERROR-FORMAT
 13582                                 THRU 9900-EXIT
 13583*       GO TO 3225-RATING-CONT
 13584     END-IF
 13585     IF (PB-COMPANY-ID = 'CID')
 13586        AND (WS-LF-EARNINGS-CALC = 'B')
 13587        AND (CP-STATE-STD-ABBRV = 'MN')
 13588        AND (PB-CERT-EFF-DT > X'A4FF')
 13589        GO TO 3225-RATING-CONT
 13590     END-IF
 13591     IF PB-COMPANY-ID = 'DCC'
 13592        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13593           AND (PB-I-POLICY-IS-MONTHLY)
 13594           GO TO 3225-RATING-CONT
 13595        END-IF
 13596     END-IF
 13597
 13598     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13599        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13600        CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 247
* EL050.cbl
 13601        NEXT SENTENCE
 13602     ELSE
 13603        MOVE '2'                 TO CP-EARNING-METHOD.
 13604
 13605 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13606
 13607     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13608
 13609     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13610        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13611        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13612         NEXT SENTENCE
 13613     ELSE
 13614         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13615
 13616     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13617     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13618     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13619                                     CP-RATING-BENEFIT-AMT.
 13620     IF CP-STATE-STD-ABBRV = 'OR'
 13621         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13622                                         PB-I-LF-ALT-BENEFIT-AMT.
 13623     IF PB-COMPANY-ID = 'DCC'
 13624        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13625     END-IF
 13626     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13627     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13628     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13629                                    CP-REMAINING-TERM
 13630                                    CP-LOAN-TERM.
 13631     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13632        ADD +1                   TO CP-ORIGINAL-TERM
 13633                                    CP-REMAINING-TERM
 13634                                    CP-LOAN-TERM.
 13635
 13636     MOVE 'R'                   TO CP-RATE-FILE.
 13637     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13638
 13639     IF CP-ERROR-RATE-NOT-FOUND
 13640         MOVE ER-2641            TO WS-ERROR
 13641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13642         GO TO 3300-CHECK-AH-RATES.
 13643
 13644     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13645     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13646
 13647     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13648         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13649
 13650     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13651                               + PB-I-LF-ALT-BENEFIT-AMT.
 13652
 13653     IF ACCOUNT-LIFE-CHECKED  OR
 13654        PB-POLICY-IS-VOIDED   OR
 13655        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13656        GO TO 3225-CONTINUE.
 13657
 13658     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 248
* EL050.cbl
 13659        GO TO 3225-CONTINUE.
 13660
 13661     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13662                             EC-RT-LF-MAX-TOT-BEN
 13663        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13664        MOVE ER-2639       TO WS-ERROR
 13665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13666
 13667 3225-CONTINUE.
 13668     IF PB-I-LF-ALT-RATE = ZERO
 13669         MOVE ER-2659            TO WS-ERROR
 13670         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13671
 13672     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13673        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13674        MOVE ER-2698             TO WS-ERROR
 13675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13676
 13677 3225-RATING-CONT.
 13678
 13679     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13680         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13681         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13682         IF (PB-COMPANY-ID = 'DCC')
 13683            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13684            CONTINUE
 13685         ELSE
 13686            MOVE ER-2687         TO WS-ERROR
 13687            PERFORM 9900-ERROR-FORMAT
 13688                                 THRU 9900-EXIT
 13689         END-IF
 13690         GO TO 3290-EDIT-LF-REIN-RATE
 13691     END-IF
 13692
 13693* DMD RATING TEST
 13694     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13695         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13696         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13697         MOVE ER-2687                 TO WS-ERROR
 13698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13699         GO TO 3290-EDIT-LF-REIN-RATE.
 13700
 13701 3230-CLIENT-MORT-CD-SPECIALS.
 13702
 13703     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13704     SET BIN-TO-GREG          TO TRUE.
 13705*    MOVE ' '                 TO DC-OPTION-CODE.
 13706     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13707     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13708
 13709 C-POS-3230-MORT-CD.
 13710     IF PB-COMPANY-ID = 'POS' AND
 13711        PB-SV-CARRIER = '2'
 13712         NEXT SENTENCE
 13713     ELSE
 13714         GO TO C-POS-3240-MORT-CD.
 13715
 13716     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 249
* EL050.cbl
 13717        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13718         MOVE '2350' TO PB-I-MORT-CODE
 13719      ELSE
 13720         MOVE '3300' TO PB-I-MORT-CODE.
 13721
 13722
 13723 C-POS-3240-MORT-CD.
 13724     IF PB-COMPANY-ID = 'POS' AND
 13725        PB-SV-CARRIER = '1'
 13726         NEXT SENTENCE
 13727     ELSE
 13728         GO TO 3230-CONTINUE.
 13729
 13730     IF PB-SV-STATE = '45' OR '47'
 13731        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13732         MOVE '5200' TO PB-I-MORT-CODE
 13733     ELSE
 13734         MOVE '8300' TO PB-I-MORT-CODE.
 13735
 13736 3230-CONTINUE.
 13737
 13738     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13739        GO TO 3240-CONTINUE
 13740     END-IF
 13741
 13742     IF PB-CERT-EFF-DT > WS-971231
 13743        GO TO 3240-CONTINUE
 13744     END-IF
 13745
 13746     IF LF-BENEFIT-FOUND AND
 13747        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13748         MOVE 'F250'       TO PB-I-MORT-CODE
 13749     ELSE
 13750         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13751             MOVE '7250'   TO PB-I-MORT-CODE
 13752         ELSE
 13753             MOVE '4251'   TO PB-I-MORT-CODE
 13754         END-IF
 13755     END-IF
 13756
 13757     .
 13758 3240-CONTINUE.
 13759
 13760     IF PB-COMPANY-ID NOT = 'GNL'
 13761         GO TO 3256-CONTINUE.
 13762
 13763     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13764         MOVE 'A300' TO PB-I-MORT-CODE
 13765     ELSE
 13766         MOVE '8350' TO PB-I-MORT-CODE.
 13767
 13768 3256-CONTINUE.
 13769     IF PB-COMPANY-ID NOT = 'ABL'
 13770         GO TO 3260-EDIT-CONTINUE.
 13771
 13772     IF PB-I-LF-TERM GREATER THAN 59
 13773         MOVE 'F550' TO PB-I-MORT-CODE
 13774     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 250
* EL050.cbl
 13775         MOVE 'E550' TO PB-I-MORT-CODE.
 13776
 13777 3260-EDIT-CONTINUE.
 13778     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13779
 13780 3290-EDIT-LF-REIN-RATE.
 13781     IF LF-REIN-NSP-NOT-USED
 13782         GO TO 3290-RATING-CONT.
 13783
 13784     IF PB-COMPANY-ID = 'DCC'
 13785        GO TO 3290-RATING-CONT.
 13786     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13787     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13788     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13789     MOVE '3'                   TO CP-PROCESS-TYPE.
 13790     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13791
 13792******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13793     IF PB-COMPANY-ID EQUAL 'CDL'
 13794         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13795            CP-EARN-AS-NET-PAY)
 13796             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13797*            MOVE SPACE          TO DC-OPTION-CODE
 13798             SET BIN-TO-GREG     TO TRUE
 13799             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13800***  Y2K PROJ 7744
 13801             IF DC-GREG-DATE-CYMD GREATER 19931231
 13802                 MOVE '1'        TO CP-EARNING-METHOD.
 13803***  Y2K PROJ 7744
 13804*******
 13805
 13806     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13807     MOVE PB-SV-STATE           TO CP-STATE.
 13808     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13809     MOVE ZERO                  TO CP-DEVIATION-CODE
 13810                                   CP-RATE-DEV-PCT.
 13811     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13812     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13813                                   CP-RATING-BENEFIT-AMT.
 13814
 13815************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13816     IF PB-COMPANY-ID EQUAL 'NCB'
 13817         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13818            CP-EARN-AS-NET-PAY
 13819             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13820                 PB-I-LF-PREMIUM-AMT.
 13821************
 13822
 13823     IF CP-STATE-STD-ABBRV = 'OR'
 13824         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13825                                         PB-I-LF-ALT-BENEFIT-AMT.
 13826     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13827     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13828     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13829     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13830     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13831     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13832     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 251
* EL050.cbl
 13833     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13834                                   CP-REMAINING-TERM
 13835                                   CP-LOAN-TERM.
 13836     IF CP-TRUNCATED-LIFE
 13837        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13838
 13839     IF CP-TERM-IS-DAYS
 13840         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13841     ELSE
 13842         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13843
 13844     IF PB-COMPANY-ID = 'DCC'
 13845        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13846     END-IF
 13847     IF PB-COMPANY-ID NOT = 'TIC'
 13848          MOVE ZERO          TO CP-CLASS-CODE.
 13849
 13850     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13851
 13852     MOVE 'R'                   TO CP-RATE-FILE.
 13853     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13854
 13855     IF CP-ERROR-RATE-NOT-FOUND
 13856        IF PB-I-OB
 13857           MOVE ER-2625      TO WS-ERROR
 13858           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13859           GO TO 3299-EDIT-CONTINUE
 13860        ELSE
 13861           MOVE ER-2643      TO WS-ERROR
 13862           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13863           GO TO 3299-EDIT-CONTINUE.
 13864
 13865     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13866
 13867     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13868     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13869
 13870     IF PB-I-LF-REI-RATE = ZERO
 13871         MOVE ER-2643        TO WS-ERROR
 13872         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13873
 13874 3290-CHECK-ALT-REIN-RATE.
 13875
 13876     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13877        GO TO 3290-RATING-CONT.
 13878
 13879     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13880     MOVE '2'                    TO CP-EARNING-METHOD.
 13881     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13882     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13883     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13884     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13885                                     CP-RATING-BENEFIT-AMT.
 13886     IF CP-STATE-STD-ABBRV = 'OR'
 13887         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13888                                         PB-I-LF-ALT-BENEFIT-AMT.
 13889     IF PB-COMPANY-ID = 'DCC'
 13890        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 252
* EL050.cbl
 13891     END-IF
 13892     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13893     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13894     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13895                                    CP-REMAINING-TERM
 13896                                    CP-LOAN-TERM.
 13897     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13898        ADD +1                   TO CP-ORIGINAL-TERM
 13899                                    CP-REMAINING-TERM
 13900                                    CP-LOAN-TERM.
 13901
 13902     MOVE 'R'                   TO CP-RATE-FILE.
 13903     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13904
 13905     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13906
 13907     IF PB-I-LF-ALT-REI-RATE = ZERO
 13908         MOVE ER-2643            TO WS-ERROR
 13909         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13910
 13911 3290-RATING-CONT.
 13912
 13913     IF PB-I-OB
 13914*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13915        GO TO 3300-CHECK-AH-RATES.
 13916
 13917 3299-EDIT-CONTINUE.
 13918
 13919     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13920         NEXT SENTENCE
 13921     ELSE
 13922         MOVE ER-2620           TO WS-ERROR
 13923         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13924
 13925 3300-CHECK-AH-RATES.
 13926     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13927         NEXT SENTENCE
 13928     ELSE
 13929         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13930
 13931     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13932        ((CF-COMPANY-ID = 'DMD') AND
 13933                (NO-DMD-RATING))
 13934         IF (PB-COMPANY-ID = 'DCC')
 13935            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13936            CONTINUE
 13937         ELSE
 13938            MOVE ER-2687         TO WS-ERROR
 13939            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13940         END-IF
 13941         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13942         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13943     END-IF
 13944
 13945     IF PB-I-OB
 13946        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13947
 13948     IF WS-AH-SPECIAL-CALC-CD = 'M'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 253
* EL050.cbl
 13949         MOVE ER-2687             TO WS-ERROR
 13950         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13951         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13952         GO TO 3999-END-EDIT.
 13953
 13954*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13955     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13956        IF PB-I-AH-CRIT-PER = ZERO
 13957           IF PB-COMPANY-ID = 'DCC'
 13958              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13959              CONTINUE
 13960           ELSE
 13961              MOVE ER-2618       TO WS-ERROR
 13962              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13963              GO TO 3999-END-EDIT
 13964           END-IF
 13965        END-IF
 13966     END-IF
 13967     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13968     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13969     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13970     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13971     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13972     MOVE PB-SV-STATE            TO CP-STATE.
 13973     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13974     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13975     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13976*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13977     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13978     MOVE '3'                    TO CP-PROCESS-TYPE.
 13979     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13980     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13981                                    CP-RATING-BENEFIT-AMT.
 13982     IF PB-COMPANY-ID = 'CID'
 13983               OR
 13984        CP-STATE-STD-ABBRV = 'OR'
 13985         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13986                                         PB-I-AH-TERM.
 13987     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13988        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13989           AND (PB-I-POLICY-IS-MONTHLY)
 13990           MOVE PB-I-LF-BENEFIT-AMT
 13991                                 TO CP-NET-BENEFIT-AMT
 13992           move pb-i-ah-premium-amt to cp-original-premium
 13993           add pb-i-lf-premium-amt to cp-original-premium
 13994        END-IF
 13995     END-IF
 13996     MOVE SPACES                 TO CP-BEN-CATEGORY
 13997     IF PB-COMPANY-ID = 'DCC'
 13998        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13999        EVALUATE TRUE
 14000           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14001              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14002              MOVE PB-I-LF-BENEFIT-AMT
 14003                                 TO CP-RATING-BENEFIT-AMT
 14004              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14005           WHEN WS-AH-BEN-CATEGORY = 'G'
 14006              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 254
* EL050.cbl
 14007                                 TO CP-RATING-BENEFIT-AMT
 14008           WHEN WS-AH-BEN-CATEGORY = 'D'
 14009              MOVE WS-AH-PMF-COMM
 14010                                 TO CP-DCC-PMF-COMM
 14011              MOVE PB-I-AH-COMMISSION
 14012                                 TO CP-DCC-ACT-COMM
 14013        END-EVALUATE
 14014     END-IF
 14015     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14016     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14017     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14018     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14019     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14020     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14021     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14022                                    CP-REMAINING-TERM
 14023                                    WS-WORK-TERM.
 14024     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14025
 14026     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14027     SET BIN-TO-GREG             TO TRUE.
 14028*    MOVE ' '                    TO DC-OPTION-CODE.
 14029     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14030     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14031
 14032     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14033     IF NOT VALID-SKIP-CODE
 14034         MOVE ER-2683            TO WS-ERROR
 14035         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14036         GO TO 3320-RATE-CONTINUE.
 14037
 14038     IF PB-NO-MONTHS-SKIPPED
 14039         GO TO 3320-RATE-CONTINUE.
 14040
 14041     MOVE SPACE TO NUMBER-OF-MONTHS.
 14042
 14043     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14044         MOVE 'S'                TO SK-MO (6).
 14045     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14046         MOVE 'S'                TO SK-MO (7).
 14047     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14048         MOVE 'S'                TO SK-MO (8).
 14049     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14050         MOVE 'S'                TO SK-MO (9).
 14051     IF PB-I-SKIP-CODE = 'A'
 14052         MOVE 'S'                TO SK-MO (10).
 14053
 14054     MOVE 1                      TO SUB2.
 14055     MOVE PB-I-AH-TERM           TO SUB3.
 14056     MOVE WS-MONTH               TO SUB1.
 14057     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14058     GO TO 3320-RATE-CONTINUE.
 14059
 14060 3310-GET-SKIP-MO.
 14061     IF SUB1 = 13
 14062         MOVE 1                  TO SUB1.
 14063
 14064     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 255
* EL050.cbl
 14065         SUBTRACT 1 FROM WS-WORK-TERM.
 14066
 14067     ADD 1 TO SUB2
 14068              SUB1.
 14069
 14070 3320-RATE-CONTINUE.
 14071
 14072     IF WS-WORK-TERM = ZERO
 14073         MOVE 1                  TO WS-WORK-TERM.
 14074
 14075     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14076                                    CP-LOAN-TERM.
 14077
 14078     IF PB-COMPANY-ID EQUAL 'DMD'
 14079         NEXT SENTENCE
 14080     ELSE
 14081         MOVE ZERO               TO PB-I-AH-RATE
 14082                                    PB-I-AH-REI-RATE.
 14083
 14084
 14085     IF PB-COMPANY-ID EQUAL 'CRI'
 14086        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14087
 14088     IF PB-COMPANY-ID = 'CSL'
 14089         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14090         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14091         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14092         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14093
 14094     IF PB-COMPANY-ID = 'DCC'
 14095        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14096           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14097              PB-I-RATE-DEV-PCT-LF
 14098        END-IF
 14099        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14100                                 TO CP-ALTERNATE-BENEFIT
 14101        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14102        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14103        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14104     END-IF
 14105     IF (PB-COMPANY-ID = 'CID')
 14106        AND (WS-LF-EARNINGS-CALC = 'B')
 14107        AND (CP-STATE-STD-ABBRV = 'MN')
 14108        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14109     ELSE
 14110        MOVE ' '                 TO CP-AH-BALLOON-SW
 14111     END-IF
 14112     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14113     MOVE 'R'                   TO CP-RATE-FILE.
 14114     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14115
 14116     IF CP-ERROR-RATE-NOT-FOUND
 14117        IF PB-I-OB
 14118           MOVE ER-2624          TO WS-ERROR
 14119           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14120           GO TO 3340-CALCULATE-PREMIUM-AMT
 14121        ELSE
 14122          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 256
* EL050.cbl
 14123              NEXT SENTENCE
 14124          ELSE
 14125           MOVE ER-2642          TO WS-ERROR
 14126           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14127           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14128
 14129     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14130        CP-ERROR-DIV-BY-ZERO
 14131           MOVE ER-3782          TO WS-ERROR
 14132           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14133
 14134     IF PB-COMPANY-ID EQUAL 'CRI'
 14135        IF CP-ERROR-NO-LIMITS-CRI
 14136           IF NOT ACCOUNT-AH-CHECKED
 14137              MOVE ER-2607          TO WS-ERROR
 14138              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14139
 14140     IF ACCOUNT-AH-CHECKED
 14141        NEXT SENTENCE
 14142     ELSE
 14143       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14144          MOVE ER-2640           TO WS-ERROR
 14145          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14146
 14147     IF PB-COMPANY-ID = 'CRI'
 14148         IF WS-ERROR = ER-2640
 14149             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14150     IF ACCOUNT-AH-CHECKED
 14151        CONTINUE
 14152     ELSE
 14153        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14154           AND (CP-R-MAX-ATT-AGE > +0)
 14155           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14156           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14157              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14158              MOVE PB-I-AH-EXPIRE-DT
 14159                                 TO DC-BIN-DATE-2
 14160              MOVE '1'           TO DC-OPTION-CODE
 14161              PERFORM 8500-DATE-CONVERT
 14162                                 THRU 8500-EXIT
 14163              IF NO-CONVERSION-ERROR
 14164                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14165                    MOVE ER-2661       TO WS-ERROR
 14166*                   PERFORM 9900-ERROR-FORMAT
 14167*                                THRU 9900-EXIT
 14168                 END-IF
 14169              END-IF
 14170           ELSE
 14171              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14172              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14173                 MOVE ER-2661    TO WS-ERROR
 14174*                PERFORM 9900-ERROR-FORMAT
 14175*                                THRU 9900-EXIT
 14176              ELSE
 14177                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14178                    MOVE ER-1570 TO WS-ERROR
 14179                    PERFORM 9900-ERROR-FORMAT
 14180                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 257
* EL050.cbl
 14181                 END-IF
 14182              END-IF
 14183           END-IF
 14184           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14185              MOVE PB-I-JOINT-BIRTHDAY
 14186                                    TO DC-BIN-DATE-1
 14187              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14188              MOVE '1'              TO DC-OPTION-CODE
 14189              PERFORM 8500-DATE-CONVERT
 14190                                    THRU 8500-EXIT
 14191              IF NO-CONVERSION-ERROR
 14192                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14193                    MOVE ER-2661       TO WS-ERROR
 14194*                   PERFORM 9900-ERROR-FORMAT
 14195*                                   THRU 9900-EXIT
 14196                 END-IF
 14197              END-IF
 14198           ELSE
 14199              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14200                (PB-I-AH-TERM / 12)
 14201              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14202                 MOVE ER-2661       TO WS-ERROR
 14203*                PERFORM 9900-ERROR-FORMAT
 14204*                                   THRU 9900-EXIT
 14205              ELSE
 14206                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14207                    MOVE ER-1571 TO WS-ERROR
 14208                    PERFORM 9900-ERROR-FORMAT
 14209                                 THRU 9900-EXIT
 14210                 END-IF
 14211              END-IF
 14212           END-IF
 14213           IF WS-ERROR = ER-2661
 14214              PERFORM 9900-ERROR-FORMAT
 14215                                    THRU 9900-EXIT
 14216           END-IF
 14217        END-IF
 14218     END-IF
 14219*    IF ACCOUNT-AH-CHECKED
 14220*       NEXT SENTENCE
 14221*    ELSE
 14222*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14223*          MOVE ER-2661          TO WS-ERROR
 14224*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14225
 14226     IF ACCOUNT-AH-CHECKED
 14227        NEXT SENTENCE
 14228     ELSE
 14229        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14230           MOVE ER-2663          TO WS-ERROR
 14231           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14232
 14233     IF ACCOUNT-AH-CHECKED OR
 14234        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14235         PB-POLICY-IS-VOIDED
 14236        NEXT SENTENCE
 14237     ELSE
 14238        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 258
* EL050.cbl
 14239           MOVE ER-2667            TO WS-ERROR
 14240           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14241
 14242     IF PB-COMPANY-ID = 'CRI'
 14243         IF WS-ERROR = ER-2667
 14244             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14245
 14246     IF ACCOUNT-AH-CHECKED
 14247        NEXT SENTENCE
 14248     ELSE
 14249        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14250           MOVE ER-2678            TO WS-ERROR
 14251           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14252
 14253     IF CP-ERROR-RATE-FILE-NOTOPEN
 14254         GO TO 3990-FILES-NOT-OPEN.
 14255
 14256 3321-CONTINUE.
 14257     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14258     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14259     IF (PB-COMPANY-ID = 'DCC')
 14260        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14261        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14262                                    PB-I-LF-ALT-PREM-CALC
 14263        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14264        IF WS-AH-BEN-CATEGORY = 'G'
 14265           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14266           + PB-I-ADDL-CLP)
 14267           * (1 + WS-TOL-CLP-PCT)
 14268*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14269        ELSE
 14270           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14271           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14272*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14273        END-IF
 14274        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14275                                 TO PB-I-AH-PREM-CALC
 14276        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14277           MOVE ER-8152          TO WS-ERROR
 14278           PERFORM 9900-ERROR-FORMAT
 14279                                 THRU 9900-EXIT
 14280        ELSE
 14281           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14282                 PB-I-ADDL-CLP)
 14283              MOVE ER-8148       TO WS-ERROR
 14284              PERFORM 9900-ERROR-FORMAT
 14285                                 THRU 9900-EXIT
 14286           END-IF
 14287        END-IF
 14288     END-IF
 14289     IF (PB-COMPANY-ID = 'DCC')
 14290        AND (PB-I-POLICY-IS-MONTHLY)
 14291        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14292        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14293        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14294           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14295        END-IF
 14296     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 259
* EL050.cbl
 14297     IF (PB-COMPANY-ID = 'DCC')
 14298        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14299        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14300        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14301        MOVE ER-2786             TO WS-ERROR
 14302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14303     END-IF
 14304     MOVE +0                     TO PB-I-AH-CLP
 14305     IF PB-COMPANY-ID = 'DCC'
 14306        IF WS-AH-BEN-CATEGORY = 'D'
 14307           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14308              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14309        ELSE
 14310           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14311              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14312           END-IF
 14313        END-IF
 14314     END-IF
 14315     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14316
 14317     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14318         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14319
 14320     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14321         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14322
 14323     IF PB-COMPANY-ID = 'CRI'
 14324         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14325            PB-I-PAYMENT-AMOUNT = ZERO
 14326             NEXT SENTENCE
 14327         ELSE
 14328             COMPUTE PB-I-AH-PREM-CALC =
 14329                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14330                 (CP-PREMIUM-RATE / 100)
 14331             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14332                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14333                                             PB-I-RATE-DEV-PCT-AH.
 14334
 14335     IF PB-I-AH-RATE  = ZERO
 14336       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14337           NEXT SENTENCE
 14338       ELSE
 14339         MOVE ER-2642            TO WS-ERROR
 14340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14341
 14342     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14343     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14344     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14345     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14346     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14347     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14348
 14349     IF (PB-COMPANY-ID = 'DCC')
 14350        AND (WS-AH-BEN-CATEGORY = 'G')
 14351        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14352        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14353        IF CP-DEVIATION-CODE NOT = '000'
 14354           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 260
* EL050.cbl
 14355           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14356           IF NO-CP-ERROR
 14357              COMPUTE PB-I-DDF-IU-RATE-UP =
 14358              PB-I-AH-CLP - CP-CALC-PREMIUM
 14359           ELSE
 14360              MOVE ER-3057        TO WS-ERROR
 14361              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14362           END-IF
 14363        END-IF
 14364     END-IF
 14365     .
 14366 3335-EDIT-AH-REIN-NSP-RATE.
 14367     IF AH-REIN-NSP-NOT-USED
 14368         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14369
 14370     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14371     IF PB-COMPANY-ID = 'DCC'
 14372         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14373     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14374     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14375     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14376     MOVE PB-SV-STATE            TO CP-STATE.
 14377     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14378     MOVE ZERO                   TO CP-DEVIATION-CODE
 14379                                    CP-RATE-DEV-PCT.
 14380*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14381     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14382     MOVE '3'                    TO CP-PROCESS-TYPE.
 14383     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14384     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14385                                    CP-RATING-BENEFIT-AMT.
 14386     IF CP-STATE-STD-ABBRV = 'OR'
 14387         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14388                                         PB-I-AH-TERM.
 14389     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14390     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14391     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14392     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14393     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14394     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14395                                    CP-REMAINING-TERM
 14396                                    WS-WORK-TERM.
 14397     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14398     IF PB-COMPANY-ID = 'DCC'
 14399        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14400     END-IF
 14401     IF  PB-COMPANY-ID = 'TIC'
 14402         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14403            MOVE ZERO TO CP-CLASS-CODE.
 14404
 14405     IF PB-COMPANY-ID NOT = 'TIC'
 14406          MOVE ZERO          TO CP-CLASS-CODE.
 14407
 14408     MOVE ZERO               TO CP-DEVIATION-CODE.
 14409
 14410     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14411
 14412     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 261
* EL050.cbl
 14413
 14414     MOVE 'R'                   TO CP-RATE-FILE.
 14415     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14416
 14417     IF CP-ERROR-RATE-NOT-FOUND
 14418         MOVE ER-2645        TO WS-ERROR
 14419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14420         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14421
 14422     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14423
 14424     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14425     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14426
 14427     IF PB-I-AH-REI-RATE = ZERO
 14428         MOVE ER-2645        TO WS-ERROR
 14429         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14430
 14431
 14432 3340-CALCULATE-PREMIUM-AMT.
 14433
 14434     IF PB-COMPANY-ID = 'NCL'
 14435         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14436             WS-AH-SPECIAL-CALC-CD = 'O')
 14437             GO TO 3999-END-EDIT.
 14438
 14439     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14440                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14441                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14442                         OR 'AHL'
 14443         NEXT SENTENCE
 14444     ELSE
 14445         IF WS-STATE-ABBREVIATION = 'CT'
 14446             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14447                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14448                 COMPUTE PB-I-LF-PREM-CALC =
 14449                                     PB-I-LF-PREM-CALC * .90
 14450                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14451                                     PB-I-LF-ALT-PREM-CALC * .90
 14452                 COMPUTE PB-I-AH-PREM-CALC =
 14453                                     PB-I-AH-PREM-CALC * .90.
 14454
 14455     IF PB-COMP-LF-PREM
 14456        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14457        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14458
 14459     IF PB-COMP-AH-PREM
 14460        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14461
 14462 3340-CHECK-DCC-TOT-FEES.
 14463     IF (PB-COMPANY-ID = 'DCC')
 14464        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14465        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14466        AND (PB-I-POLICY-IS-MONTHLY)
 14467        CONTINUE
 14468     ELSE
 14469        GO TO 3340-EDIT-LF-AH-TOL
 14470     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 262
* EL050.cbl
 14471     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14472     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14473     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14474        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14475           PB-I-RATE-DEV-PCT-LF
 14476     END-IF
 14477     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14478        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14479           PB-I-RATE-DEV-PCT-AH
 14480     END-IF
 14481     MOVE 'N'                    TO CP-BEN-CATEGORY
 14482     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14483
 14484     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14485     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14486     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14487     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14488     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14489     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14490     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14491     MOVE '3'                    TO CP-PROCESS-TYPE.
 14492     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14493     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14494
 14495     MOVE PB-SV-STATE            TO CP-STATE.
 14496     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14497     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14498     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14499     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14500     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14501                                    CP-RATING-BENEFIT-AMT.
 14502     IF CP-STATE-STD-ABBRV = 'OR'
 14503         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14504                                         PB-I-LF-ALT-BENEFIT-AMT.
 14505     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14506     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14507     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14508     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14509     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14510     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14511     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14512     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14513     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14514                                    CP-REMAINING-TERM
 14515                                    CP-LOAN-TERM.
 14516     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14517        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14518           PB-I-LF-PREMIUM-AMT
 14519     end-if
 14520
 14521     IF CP-TRUNCATED-LIFE
 14522        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14523
 14524     IF CP-TERM-IS-DAYS
 14525         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14526     ELSE
 14527         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14528
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 263
* EL050.cbl
 14529     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14530     IF CP-SPECIAL-CALC-CD = 'H'
 14531         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14532                                    TO CP-ALTERNATE-BENEFIT
 14533         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14534     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14535     MOVE 'R'                    TO CP-RATE-FILE
 14536     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14537     IF NOT CP-ERROR-RATE-NOT-FOUND
 14538        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14539        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14540           AND (CP-BENEFIT-CD (1:1) = 'S')
 14541           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14542                                    PB-I-LF-PREMIUM-AMT
 14543        END-IF
 14544     ELSE
 14545        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14546     END-IF
 14547     .
 14548 3340-EDIT-LF-AH-TOL.
 14549
 14550***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14551***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14552***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14553***
 14554     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14555         PB-I-AH-PREMIUM-AMT
 14556          GIVING WS-CALC-WORK.
 14557
 14558     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14559        AND WS-CALC-WORK NOT = ZERO
 14560         MOVE ER-2649            TO WS-ERROR
 14561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14562
 14563     SUBTRACT PB-I-LF-PREM-CALC
 14564             FROM PB-I-LF-PREMIUM-AMT
 14565                 GIVING WS-UNSIGN-WRK1.
 14566
 14567     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14568             FROM PB-I-LF-ALT-PREMIUM-AMT
 14569                 GIVING WS-UNSIGN-WRK4.
 14570
 14571     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14572                                + WS-UNSIGN-WRK4.
 14573
 14574     SUBTRACT PB-I-AH-PREM-CALC
 14575             FROM PB-I-AH-PREMIUM-AMT
 14576                 GIVING WS-UNSIGN-WRK2.
 14577
 14578******************************************************************
 14579*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14580******************************************************************
 14581
 14582     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14583         MOVE ZERO TO WS-UNSIGN-WRK1.
 14584
 14585     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14586         MOVE ZERO TO WS-UNSIGN-WRK2.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 264
* EL050.cbl
 14587
 14588     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14589             GIVING WS-UNSIGN-WRK3.
 14590
 14591 3342-CONTINUE.
 14592
 14593     IF (PB-I-LF-RATE = ZERO  AND
 14594         PB-I-AH-RATE = ZERO)
 14595         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14596            WS-AH-SPECIAL-CALC-CD = 'O'
 14597              NEXT SENTENCE
 14598         ELSE
 14599             GO TO 3345-EDIT-CONTINUE.
 14600
 14601     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14602         NEXT SENTENCE
 14603     ELSE
 14604     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14605        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14606           IF (PB-REISSUED-CERT         OR
 14607               PB-POLICY-IS-DECLINED    OR
 14608               PB-POLICY-IS-VOIDED)
 14609              NEXT SENTENCE
 14610           ELSE
 14611              IF WS-PREM-REJECT-SW = SPACE
 14612                 MOVE ER-2652    TO WS-ERROR
 14613                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14614                 GO TO 3344-CHECK-AH
 14615              ELSE
 14616                 MOVE ER-2650    TO WS-ERROR
 14617                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14618                 GO TO 3344-CHECK-AH.
 14619
 14620***
 14621***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14622***
 14623
 14624     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14625         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14626            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14627             (1 + WS-TOL-LF-PREM-PCT)
 14628         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14629            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14630             (1 - WS-TOL-LF-PREM-PCT)
 14631     ELSE
 14632         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14633         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14634
 14635***
 14636***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14637***
 14638
 14639     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14640         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14641          WS-TOL-LF-PREM.
 14642
 14643     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14644         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 265
* EL050.cbl
 14645          WS-TOL-LF-PREM.
 14646
 14647     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14648        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14649
 14650     IF PB-REISSUED-CERT
 14651        or PB-POLICY-IS-DECLINED
 14652        or PB-POLICY-IS-VOIDED
 14653        continue
 14654     ELSE
 14655        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14656              > WS-TOL-LF-HIGH-PREM-AMT)
 14657           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14658              < WS-TOL-LF-LOW-PREM-AMT))
 14659                      or
 14660           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14661              > WS-TOL-LF-HIGH-PREM-PCT)
 14662           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14663              < WS-TOL-LF-LOW-PREM-PCT))
 14664           IF WS-PREM-REJECT-SW = SPACE
 14665              MOVE ER-2652       TO WS-ERROR
 14666              PERFORM 9900-ERROR-FORMAT
 14667                                 THRU 9900-EXIT
 14668           ELSE
 14669              MOVE ER-2650       TO WS-ERROR
 14670              PERFORM 9900-ERROR-FORMAT
 14671                                 THRU 9900-EXIT
 14672           end-if
 14673        end-if
 14674     end-if
 14675
 14676*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14677*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14678*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14679*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14680
 14681     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14682        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14683                      OR
 14684           ((PB-COMPANY-ID = 'DCC')
 14685           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14686           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14687           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14688        END-IF
 14689     END-IF
 14690
 14691     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14692        IF WS-COMP-MAX-CAP GREATER THAN +0
 14693           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14694              IF (PB-REISSUED-CERT         OR
 14695                  PB-POLICY-IS-DECLINED    OR
 14696                  PB-POLICY-IS-VOIDED)
 14697                 NEXT SENTENCE
 14698              ELSE
 14699                  MOVE ER-2646   TO  WS-ERROR
 14700                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14701
 14702 3344-CVL-TOLERANCE-CHECK.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 266
* EL050.cbl
 14703
 14704      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14705          GO TO 3344-CHECK-AH.
 14706
 14707      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14708          GO TO 3344-CHECK-AH.
 14709
 14710      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14711                                     WS-UNSIGN-WRK6.
 14712
 14713      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14714          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14715                                 + PB-I-LF-PREMIUM-AMT
 14716                                 - PB-I-LF-PREM-CALC.
 14717
 14718      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14719          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14720                                 + PB-I-LF-ALT-PREMIUM-AMT
 14721                                 - PB-I-LF-ALT-PREM-CALC.
 14722
 14723      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14724          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14725              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14726                 MOVE ER-2652    TO  WS-ERROR
 14727                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14728              ELSE
 14729                 MOVE ER-2650    TO  WS-ERROR
 14730                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14731
 14732      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14733          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14734              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14735                 MOVE ER-2652    TO  WS-ERROR
 14736                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14737              ELSE
 14738                 MOVE ER-2650    TO  WS-ERROR
 14739                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14740
 14741 3344-CHECK-AH.
 14742
 14743****************************************************************
 14744***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14745***
 14746
 14747     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14748         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14749             (1 + WS-TOL-AH-PREM-PCT)
 14750         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14751             (1 - WS-TOL-AH-PREM-PCT)
 14752     ELSE
 14753         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14754         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14755
 14756***
 14757***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14758***
 14759
 14760     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 267
* EL050.cbl
 14761         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14762
 14763     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14764         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14765
 14766     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14767        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14768
 14769     IF (PB-REISSUED-CERT)
 14770        OR (PB-POLICY-IS-DECLINED)
 14771        OR (PB-POLICY-IS-VOIDED)
 14772        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14773        CONTINUE
 14774     ELSE
 14775        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14776              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14777                          or
 14778           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14779              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14780           IF WS-PREM-REJECT-SW = SPACE
 14781              MOVE ER-3052       TO WS-ERROR
 14782              PERFORM 9900-ERROR-FORMAT
 14783                                 THRU 9900-EXIT
 14784           ELSE
 14785              MOVE ER-3050       TO WS-ERROR
 14786              PERFORM 9900-ERROR-FORMAT
 14787                                 THRU 9900-EXIT
 14788           END-IF
 14789        END-IF
 14790     END-IF
 14791     if (pb-company-id = 'DCC')
 14792        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14793        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14794        and (pb-i-policy-is-monthly)
 14795        compute ws-tol-ah-high-prem-amt =
 14796           pb-i-tot-fees-calc + ws-tol-ah-prem
 14797        compute ws-tol-ah-low-prem-amt =
 14798           pb-i-tot-fees-calc - ws-tol-ah-prem
 14799        if ws-tol-ah-prem-pct > zeros
 14800           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14801              (1 + ws-tol-ah-prem-pct)
 14802           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14803              (1 - ws-tol-ah-prem-pct)
 14804        else
 14805           move +9999999.99      to ws-tol-ah-high-prem-pct
 14806           move +0               to ws-tol-ah-low-prem-pct
 14807        end-if
 14808        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14809            or
 14810           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14811                          or
 14812           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14813           or
 14814           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14815            move er-3049         to ws-error
 14816           perform 9900-error-format
 14817                                 thru 9900-exit
 14818
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 268
* EL050.cbl
 14819        end-if
 14820     end-if
 14821     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14822         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14823             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14824             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14825
 14826     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14827        IF WS-COMP-MAX-CAP GREATER THAN +0
 14828           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14829              IF (PB-REISSUED-CERT         OR
 14830                  PB-POLICY-IS-DECLINED    OR
 14831                  PB-POLICY-IS-VOIDED)
 14832                 NEXT SENTENCE
 14833              ELSE
 14834                  MOVE ER-2646   TO  WS-ERROR
 14835                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14836
 14837     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14838        (WS-COMP-MAX-CAP EQUAL +0)
 14839           GO TO 3345-EDIT-CONTINUE.
 14840
 14841     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14842        GREATER THAN WS-COMP-MAX-CAP
 14843           MOVE ER-2646          TO  WS-ERROR
 14844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14845
 14846 3345-EDIT-CONTINUE.
 14847
 14848*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14849*       IF PB-ENTRY-BATCH   NUMERIC
 14850*          IF PB-ISSUE
 14851*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14852*          ELSE
 14853*              IF PB-CANCELLATION
 14854*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14855
 14856*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14857*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14858*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14859*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14860*        ELSE
 14861*            MOVE  ER-1909            TO  WS-ERROR
 14862*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14863
 14864     IF PB-I-POLICY-ACCEPTED
 14865        IF PB-POLICY-IS-DECLINED  OR
 14866           PB-REISSUED-CERT  OR
 14867           PB-REIN-ONLY-CERT  OR
 14868           PB-POLICY-IS-VOIDED
 14869            MOVE  ER-1891         TO  WS-ERROR
 14870            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14871        ELSE
 14872            MOVE SPACE            TO  PB-BATCH-ENTRY
 14873            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14874
 14875     IF PB-I-POLICY-DECLINED
 14876        IF PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 269
* EL050.cbl
 14877           PB-REIN-ONLY-CERT  OR
 14878           PB-POLICY-IS-VOIDED
 14879            MOVE  ER-1906         TO  WS-ERROR
 14880            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14881        ELSE
 14882            MOVE  'D'             TO  PB-BATCH-ENTRY
 14883                                      PB-I-ENTRY-STATUS.
 14884
 14885     IF PB-I-NEEDS-UNDERWRITING
 14886        IF PB-POLICY-IS-DECLINED OR
 14887           PB-REISSUED-CERT  OR
 14888           PB-REIN-ONLY-CERT  OR
 14889           PB-POLICY-IS-VOIDED
 14890            MOVE  ER-1907         TO  WS-ERROR
 14891            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14892        ELSE
 14893            MOVE 'U'              TO  PB-BATCH-ENTRY
 14894                                      PB-I-ENTRY-STATUS.
 14895
 14896     IF PB-NEEDS-UNDERWRITING
 14897        MOVE  ER-1901             TO  WS-ERROR
 14898        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14899     IF PB-COMPANY-ID = 'DCC'
 14900        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14901        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14902        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14903           AND (NOT WS-LF-CASH))
 14904                           OR
 14905           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14906           AND (NOT WS-AH-CASH)))
 14907                       AND
 14908           (PB-I-ENTRY-STATUS NOT = '5')
 14909           MOVE 'M'              TO PB-BATCH-ENTRY
 14910                                    PB-I-ENTRY-STATUS
 14911        END-IF
 14912     END-IF
 14913     IF  PB-COMPANY-ID NOT = 'NCL'
 14914         GO TO 3999-END-EDIT.
 14915
 14916     IF PB-REISSUED-CERT  OR
 14917        PB-POLICY-IS-DECLINED  OR
 14918        PB-POLICY-IS-VOIDED  OR
 14919        PB-I-OB
 14920         GO TO 3999-END-EDIT.
 14921
 14922     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14923         MOVE  ER-2644            TO  WS-ERROR
 14924         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14925         GO TO 3999-END-EDIT.
 14926
 14927     MOVE 'N'                     TO  FORM-MASTER-SW.
 14928     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14929
 14930     IF NOT FORM-MASTER-FOUND
 14931         GO TO 3999-END-EDIT.
 14932
 14933     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14934                                      FORM-MASTER-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 270
* EL050.cbl
 14935
 14936     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14937         MOVE  +1                 TO SUB6
 14938         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14939
 14940     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14941         MOVE  +1                 TO SUB6
 14942         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14943
 14944     IF LF-FORM-MASTER-FOUND  OR
 14945        AH-FORM-MASTER-FOUND
 14946         GO TO 3360-CHECK-FORM-LIMITS
 14947     ELSE
 14948         GO TO 3999-END-EDIT.
 14949
 14950******************************************************************
 14951*                  3350-GET-ERFORM                               *
 14952*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14953*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14954******************************************************************
 14955
 14956 3350-GET-ERFORM.
 14957
 14958     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14959         GO TO  3350-ERFORM-GETMAIN.
 14960
 14961     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14962     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14963     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14964     MOVE 'Y'                     TO FORM-MASTER-SW.
 14965
 14966     IF PB-CANCELLATION
 14967         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14968            PB-SV-STATE          EQUAL   FO-STATE       AND
 14969            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14970              GO TO 3350-EXIT
 14971         ELSE
 14972             NEXT SENTENCE
 14973     ELSE
 14974         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14975            PB-SV-STATE          EQUAL   FO-STATE       AND
 14976            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14977              GO TO 3350-EXIT.
 14978
 14979 3350-ERFORM-GETMAIN.
 14980
 14981     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14982     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14983
 14984 3350-ERFORM-READ.
 14985
 14986     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14987     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14988     IF PB-CANCELLATION
 14989         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14990     ELSE
 14991         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14992     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 271
* EL050.cbl
 14993
 14994     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14995
 14996     IF FORM-MASTER-FOUND
 14997       IF PB-CANCELLATION
 14998          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14999             PB-SV-STATE          EQUAL   FO-STATE       AND
 15000             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15001              GO  TO 3350-EXIT
 15002          ELSE
 15003              NEXT SENTENCE
 15004       ELSE
 15005          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15006             PB-SV-STATE          EQUAL   FO-STATE       AND
 15007             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15008              GO  TO 3350-EXIT.
 15009
 15010     MOVE  'N'                    TO  FORM-MASTER-SW.
 15011     MOVE  ER-1895                TO  WS-ERROR.
 15012     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15013
 15014 3350-EXIT.
 15015      EXIT.
 15016
 15017******************************************************************
 15018*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15019*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15020*   VALID FOR THE POLICY FORM USED.                              *
 15021******************************************************************
 15022
 15023 3355-EDIT-FORM-LF-BENEFITS.
 15024
 15025     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15026        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15027         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15028         GO TO   3355-EXIT.
 15029
 15030     IF  SUB6    LESS THAN   +40
 15031         ADD  +1      TO  SUB6
 15032         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15033
 15034     MOVE  ER-1896         TO  WS-ERROR.
 15035     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15036
 15037 3355-EXIT.
 15038      EXIT.
 15039
 15040******************************************************************
 15041*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15042*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15043*   VALID FOR THE POLICY FORM USED.                              *
 15044******************************************************************
 15045
 15046 3356-EDIT-FORM-AH-BENEFITS.
 15047
 15048     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15049        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15050         MOVE  'Y'                TO  FORM-MASTER-AH-SW
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 272
* EL050.cbl
 15051         GO TO  3356-EXIT.
 15052
 15053      IF  SUB6    LESS THAN     +40
 15054          ADD  +1      TO  SUB6
 15055          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15056
 15057     MOVE  ER-1897         TO  WS-ERROR.
 15058     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15059
 15060 3356-EXIT.
 15061      EXIT.
 15062
 15063******************************************************************
 15064*                  3357-BENEFIT-SEARCH                           *
 15065*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15066*   CANCELLATIONS ONLY.                                          *
 15067******************************************************************
 15068 3357-BENEFIT-SEARCH.
 15069     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15070         MOVE +1                          TO SUB6
 15071         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15072
 15073     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15074         MOVE +1                          TO SUB6
 15075         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15076
 15077 3357-EXIT.
 15078     EXIT.
 15079
 15080******************************************************************
 15081*                  3358-BENEFIT-LIFE-SEARCH                      *
 15082*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15083*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15084*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15085******************************************************************
 15086 3358-BENEFIT-LIFE-SEARCH.
 15087     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15088       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15089         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15090           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15091              IF FO-PLAN-REFUND-METHOD (SUB6)
 15092                     IS GREATER THAN SPACES
 15093                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15094                                          WS-LF-REFUND-CALC
 15095                 GO TO 3358-EXIT.
 15096
 15097     IF SUB6 LESS THAN +40
 15098         ADD +1                 TO SUB6
 15099         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15100
 15101 3358-EXIT.
 15102     EXIT.
 15103******************************************************************
 15104*                  3359-BENEFIT-AH-SEARCH                        *
 15105*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15106*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15107*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15108******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 273
* EL050.cbl
 15109 3359-BENEFIT-AH-SEARCH.
 15110     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15111       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15112         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15113           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15114              IF FO-PLAN-REFUND-METHOD (SUB6)
 15115                      IS GREATER THAN SPACES
 15116                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15117                                          WS-AH-REFUND-CALC
 15118                 GO TO 3359-EXIT.
 15119
 15120     IF SUB6 LESS THAN +40
 15121         ADD +1                 TO SUB6
 15122         GO TO 3359-BENEFIT-AH-SEARCH.
 15123
 15124 3359-EXIT.
 15125     EXIT.
 15126
 15127******************************************************************
 15128*                  3360-CHECK-FORM-LIMITS                        *
 15129*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15130*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15131******************************************************************
 15132
 15133 3360-CHECK-FORM-LIMITS.
 15134
 15135     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15136         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15137
 15138     IF NOT LF-FORM-MASTER-FOUND
 15139         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15140
 15141 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15142
 15143     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15144       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15145        WS-LF-JOINT-INDICATOR = 'J'  AND
 15146        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15147         IF PB-COMPANY-ID = 'NCL'
 15148            MOVE  ER-1911          TO  WS-ERROR
 15149            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15150         ELSE
 15151            MOVE  ER-1892          TO  WS-ERROR
 15152            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15153
 15154 3360-CHECK-FORM-LF-ATT-AGE.
 15155
 15156     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15157
 15158     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15159         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15160         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15161            IF PB-COMPANY-ID = 'NCL'
 15162                MOVE  ER-1913      TO  WS-ERROR
 15163                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15164            ELSE
 15165                MOVE  ER-1894      TO  WS-ERROR
 15166                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 274
* EL050.cbl
 15167
 15168 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15169
 15170     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15171         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15172         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15173            IF PB-COMPANY-ID = 'NCL'
 15174                MOVE  ER-1914      TO  WS-ERROR
 15175                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15176            ELSE
 15177                MOVE  ER-1899      TO  WS-ERROR
 15178                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15179
 15180 3360-CHECK-FORM-LF-TERM-BAMT.
 15181
 15182     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15183         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15184         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15185           IF  PB-COMPANY-ID = 'NCL'
 15186               MOVE  ER-1916       TO  WS-ERROR
 15187               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15188           ELSE
 15189               MOVE  ER-1902       TO  WS-ERROR
 15190               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15191
 15192     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15193                                    PB-I-LF-ALT-BENEFIT-AMT.
 15194
 15195     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15196         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15197         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15198             IF  PB-COMPANY-ID = 'NCL'
 15199                 MOVE  ER-1918     TO  WS-ERROR
 15200                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15201             ELSE
 15202                 MOVE  ER-1904     TO  WS-ERROR
 15203                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15204
 15205******************************************************************
 15206*                  3360-CHECK-FORM-AH-LIMITS                     *
 15207*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15208*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15209******************************************************************
 15210
 15211 3360-CHECK-FORM-AH-LIMITS.
 15212
 15213     IF NOT AH-FORM-MASTER-FOUND
 15214         GO TO 3999-END-EDIT.
 15215
 15216 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15217
 15218     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15219       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15220        WS-AH-JOINT-INDICATOR = 'J'  AND
 15221        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15222         IF PB-COMPANY-ID = 'NCL'
 15223            MOVE  ER-1912          TO  WS-ERROR
 15224            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 275
* EL050.cbl
 15225         ELSE
 15226            MOVE  ER-1893          TO  WS-ERROR
 15227            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15228
 15229 3360-CHECK-FORM-AH-ATT-AGE.
 15230
 15231     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15232
 15233     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15234         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15235         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15236            IF PB-COMPANY-ID = 'NCL'
 15237                MOVE  ER-1913      TO  WS-ERROR
 15238                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15239            ELSE
 15240                MOVE  ER-1894      TO  WS-ERROR
 15241                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15242
 15243 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15244
 15245     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15246         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15247         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15248            IF PB-COMPANY-ID = 'NCL'
 15249                MOVE  ER-1915      TO  WS-ERROR
 15250                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15251            ELSE
 15252                MOVE  ER-1900      TO  WS-ERROR
 15253                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15254
 15255 3360-CHECK-FORM-AH-TERM-BAMT.
 15256
 15257     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15258         FO-AH-MAX-TERM    GREATER THAN  +0
 15259         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15260             IF  PB-COMPANY-ID = 'NCL'
 15261                 MOVE  ER-1917     TO  WS-ERROR
 15262                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15263             ELSE
 15264                  MOVE  ER-1903    TO  WS-ERROR
 15265                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15266
 15267     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15268         FO-MAX-AH-AMT    GREATER THAN  +0
 15269         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15270             IF  PB-COMPANY-ID = 'NCL'
 15271                 MOVE  ER-1919     TO  WS-ERROR
 15272                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15273             ELSE
 15274                 MOVE  ER-1905     TO  WS-ERROR
 15275                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15276
 15277     GO TO 3999-END-EDIT.
 15278
 15279******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 276
* EL050.cbl
 15281******************************************************************
 15282*                  E D I T   C A N C E L                         *
 15283******************************************************************
 15284
 15285 3700-EDIT-CANCEL.
 15286     IF PB-COMPANY-ID = 'DMD'
 15287         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15288                                         WS-RES-MUNI-TAX
 15289                                         PB-CI-STATE-TAX
 15290                                         PB-CI-MUNI-TAX
 15291         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15292
 15293*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15294*       IF PB-ENTRY-BATCH  NUMERIC
 15295*          IF PB-CANCELLATION
 15296*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15297*          ELSE
 15298*             IF PB-ISSUE
 15299*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15300
 15301     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15302        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15303     END-IF
 15304*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15305*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15306
 15307     IF CM-ENTRY-STATUS = 'V'
 15308        MOVE ER-2780             TO WS-ERROR
 15309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15310        GO TO 3999-END-EDIT.
 15311
 15312     IF CM-ENTRY-STATUS = 'D'
 15313        MOVE ER-2781             TO WS-ERROR
 15314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15315        GO TO 3999-END-EDIT.
 15316
 15317     IF CM-ENTRY-STATUS = 'U'
 15318        MOVE ER-2782             TO WS-ERROR
 15319        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15320
 15321***************************************************************
 15322*                                                             *
 15323*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15324*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15325*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15326*   OF ANOTHER COVERAGE.                                      *
 15327*                                                             *
 15328***************************************************************
 15329
 15330     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15331                                    PB-C-AH-CANCEL-VOID-SW.
 15332
 15333     IF PB-C-LF-CANCEL-AMT = ZERO
 15334        NEXT SENTENCE
 15335     ELSE
 15336        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15337           AND
 15338           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 277
* EL050.cbl
 15339               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15340               MOVE ER-2745           TO WS-ERROR
 15341               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15342
 15343     IF PB-C-AH-CANCEL-AMT = ZERO
 15344        NEXT SENTENCE
 15345     ELSE
 15346        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15347           AND
 15348           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15349               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15350               MOVE ER-2745           TO WS-ERROR
 15351               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15352
 15353     IF WS-LF-EARNINGS-CALC = '4'
 15354        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15355
 15356     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15357     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15358     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15359     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15360     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15361     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15362
 15363     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15364                                      PB-C-AH-REF-CALC.
 15365     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15366
 15367******************************************************************
 15368*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15369*             TO VALIDATE COVERAGE.                              *
 15370******************************************************************
 15371
 15372     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15373        PB-C-LF-CANCEL-AMT = ZEROS
 15374          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15375      ELSE
 15376          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15377
 15378     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15379        PB-C-AH-CANCEL-AMT = ZEROS
 15380          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15381      ELSE
 15382          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15383
 15384     EVALUATE TRUE
 15385         WHEN PB-CANCEL-FORCE             OR
 15386              PB-CANCEL-DATE-FORCED       OR
 15387              PB-FORCE-OFF
 15388                  IF PB-COMPANY-ID = 'ACE'
 15389                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15390                  END-IF
 15391         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15392               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15393              (PB-COMPANY-ID = 'ACE' )
 15394                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15395         WHEN OTHER
 15396              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 278
* EL050.cbl
 15397                 MOVE ER-2794              TO WS-ERROR
 15398              ELSE
 15399                 MOVE ER-2749              TO WS-ERROR
 15400              END-IF
 15401              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15402     END-EVALUATE.
 15403
 15404
 15405*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15406*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15407*            MOVE  ER-1909            TO  WS-ERROR
 15408*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15409*        ELSE
 15410*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15411
 15412     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15413     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15414        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15415     ELSE
 15416        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15417     END-IF
 15418     .
 15419 3705-EDIT-CANCEL-DT.
 15420
 15421     IF LF-COVERAGE-CANCELLED
 15422        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15423         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15424         MOVE WS-CURRENT-MONTH-END
 15425                                 TO DC-BIN-DATE-2
 15426         SET ELAPSED-BETWEEN-BIN TO TRUE
 15427*        MOVE 1                  TO DC-OPTION-CODE
 15428         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15429         IF DATE-CONVERSION-ERROR
 15430            NEXT SENTENCE
 15431          ELSE
 15432             IF DC-ELAPSED-DAYS GREATER +180
 15433                IF PB-CANCEL-DATE-FORCED  OR
 15434                   PB-CANCEL-DATE-FORCED-NO-FEE
 15435                      MOVE ER-2751  TO WS-ERROR
 15436                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15437                 ELSE
 15438                   MOVE ER-2752  TO WS-ERROR
 15439                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15440
 15441     IF AH-COVERAGE-CANCELLED
 15442        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15443         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15444         MOVE WS-CURRENT-MONTH-END
 15445                                 TO DC-BIN-DATE-2
 15446         SET ELAPSED-BETWEEN-BIN TO TRUE
 15447*        MOVE 1                  TO DC-OPTION-CODE
 15448         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15449         IF DATE-CONVERSION-ERROR
 15450            NEXT SENTENCE
 15451          ELSE
 15452             IF DC-ELAPSED-DAYS GREATER +180
 15453                IF PB-CANCEL-DATE-FORCED OR
 15454                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 279
* EL050.cbl
 15455                      MOVE ER-2751  TO WS-ERROR
 15456                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15457                 ELSE
 15458                   MOVE ER-2752  TO WS-ERROR
 15459                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15460
 15461     IF WS-ERROR = ER-2752
 15462        AND (PB-COMPANY-ID = 'ABL'
 15463         OR  PB-COMPANY-ID = 'FGL'
 15464         OR  PB-COMPANY-ID = 'IST'
 15465         OR  PB-COMPANY-ID = 'JHL'
 15466         OR  PB-COMPANY-ID = 'LAP'
 15467         OR  PB-COMPANY-ID = 'LBL'
 15468         OR  PB-COMPANY-ID = 'NCB'
 15469         OR  PB-COMPANY-ID = 'NLI'
 15470         OR  PB-COMPANY-ID = 'OFI'
 15471         OR  PB-COMPANY-ID = 'PLI'
 15472         OR  PB-COMPANY-ID = 'TAO'
 15473         OR  PB-COMPANY-ID = 'TIC'
 15474         OR  PB-COMPANY-ID = 'HER'
 15475         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15476         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15477            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15478            MOVE ER-2762     TO WS-ERROR
 15479            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15480
 15481     IF LF-COVERAGE-CANCELLED
 15482        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15483        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15484             MOVE ER-2733         TO WS-ERROR
 15485             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15486
 15487     IF AH-COVERAGE-CANCELLED
 15488        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15489        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15490              MOVE ER-2733        TO WS-ERROR
 15491              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15492
 15493     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15494        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15495        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15496           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15497            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15498              IF PB-COMPANY-ID NOT = 'LAP'
 15499               MOVE ER-2704            TO WS-ERROR
 15500               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15501
 15502     IF CERT-WAS-NOT-FOUND
 15503         GO TO 3999-END-EDIT.
 15504
 15505     IF PB-COMPANY-ID EQUAL 'CDC'
 15506        IF LF-COVERAGE-CANCELLED
 15507           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15508            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15509            MOVE PB-C-LF-CANCEL-DT
 15510                                 TO DC-BIN-DATE-2
 15511            SET ELAPSED-BETWEEN-BIN TO TRUE
 15512*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 280
* EL050.cbl
 15513            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15514            IF DATE-CONVERSION-ERROR
 15515               NEXT SENTENCE
 15516             ELSE
 15517                IF DC-ELAPSED-DAYS GREATER +60
 15518                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15519
 15520     IF PB-COMPANY-ID EQUAL 'CDC'
 15521        IF AH-COVERAGE-CANCELLED
 15522           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15523            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15524            MOVE PB-C-AH-CANCEL-DT
 15525                                 TO DC-BIN-DATE-2
 15526            MOVE +0              TO DC-ELAPSED-DAYS
 15527                                    DC-ELAPSED-MONTHS
 15528            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15529*           MOVE 1               TO DC-OPTION-CODE
 15530            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15531            IF DATE-CONVERSION-ERROR
 15532               NEXT SENTENCE
 15533             ELSE
 15534                IF DC-ELAPSED-DAYS GREATER +60
 15535                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15536
 15537     MOVE +0                     TO DC-ELAPSED-DAYS
 15538                                    DC-ELAPSED-MONTHS.
 15539
 15540     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15541        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15542          MOVE 'Z'                TO PB-CI-OB-FLAG
 15543          MOVE ER-2767            TO WS-ERROR
 15544          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15545          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15546          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15547          GO TO 3775-OVER-REF-CHK
 15548        ELSE
 15549          MOVE ZEROS              TO PB-CI-LIVES
 15550                                     PB-C-LIVES
 15551          IF PB-CI-OB-FLAG NOT = 'B'
 15552             MOVE SPACE           TO PB-CI-OB-FLAG.
 15553
 15554     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15555         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15556     ELSE
 15557         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15558
 15559     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15560        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15561            MOVE ER-2760         TO WS-ERROR
 15562            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15563
 15564     IF LF-COVERAGE-CANCELLED
 15565        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15566         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15567            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15568               MOVE ER-2774       TO WS-ERROR
 15569               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15570
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 281
* EL050.cbl
 15571     IF AH-COVERAGE-CANCELLED
 15572        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15573         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15574            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15575               MOVE ER-2775       TO WS-ERROR
 15576               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15577
 15578     IF LF-COVERAGE-CANCELLED
 15579        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15580         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15581            MOVE ER-2776         TO WS-ERROR
 15582            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15583
 15584     IF AH-COVERAGE-CANCELLED
 15585        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15586         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15587            MOVE ER-2777         TO WS-ERROR
 15588            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15589
 15590     IF LF-COVERAGE-CANCELLED
 15591        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15592        if pb-ci-lf-expire-dt = low-values or spaces
 15593           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15594           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15595           MOVE PB-CI-EXTENTION-DAYS
 15596                                 TO DC-ELAPSED-DAYS
 15597           SET BIN-PLUS-ELAPSED  TO TRUE
 15598           PERFORM 8500-DATE-CONVERT
 15599                                 THRU 8500-EXIT
 15600           IF DATE-CONVERSION-ERROR
 15601              move low-values    to dc-bin-date-2
 15602           end-if
 15603        else
 15604           move pb-ci-lf-expire-dt
 15605                                 to dc-bin-date-2
 15606        end-if
 15607        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15608           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15609                             OR  'FIA'
 15610              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15611           ELSE
 15612              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15613              MOVE ER-2731       TO WS-ERROR
 15614              PERFORM 9900-ERROR-FORMAT
 15615                                 THRU 9900-EXIT
 15616           end-if
 15617        end-if
 15618     end-if
 15619*    IF LF-COVERAGE-CANCELLED
 15620*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15621*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15622*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15623*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15624*        SET BIN-PLUS-ELAPSED      TO TRUE
 15625*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15626*        IF DATE-CONVERSION-ERROR
 15627*           NEXT SENTENCE
 15628*         ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 282
* EL050.cbl
 15629*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15630*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15631*                            OR  'FIA'
 15632*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15633*              ELSE
 15634*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15635*               MOVE ER-2731       TO WS-ERROR
 15636*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15637     .
 15638 3705-EDIT-AH-CANCEL-DT.
 15639     IF AH-COVERAGE-CANCELLED
 15640        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15641        if pb-ci-AH-expire-dt = low-values or spaces
 15642           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15643           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15644           MOVE PB-CI-EXTENTION-DAYS
 15645                                 TO DC-ELAPSED-DAYS
 15646           SET BIN-PLUS-ELAPSED  TO TRUE
 15647           PERFORM 8500-DATE-CONVERT
 15648                                 THRU 8500-EXIT
 15649           IF DATE-CONVERSION-ERROR
 15650              move low-values    to dc-bin-date-2
 15651           end-if
 15652        else
 15653           move pb-ci-ah-expire-dt
 15654                                 to dc-bin-date-2
 15655        end-if
 15656        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15657           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15658                             OR  'FIA'
 15659              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15660           ELSE
 15661              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15662              MOVE ER-2771       TO WS-ERROR
 15663              PERFORM 9900-ERROR-FORMAT
 15664                                 THRU 9900-EXIT
 15665           end-if
 15666        end-if
 15667     end-if
 15668*    IF AH-COVERAGE-CANCELLED
 15669*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15670*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15671*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15672*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15673**       MOVE 6                    TO DC-OPTION-CODE
 15674*        SET BIN-PLUS-ELAPSED      TO TRUE
 15675*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15676*        IF DATE-CONVERSION-ERROR
 15677*           NEXT SENTENCE
 15678*         ELSE
 15679*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15680*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15681*                             OR 'FIA'
 15682*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15683*             ELSE
 15684*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15685*              MOVE ER-2771       TO WS-ERROR
 15686*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 283
* EL050.cbl
 15687     .
 15688 3705-EDIT-CONTINUED.
 15689
 15690*    IF LF-COVERAGE-CANCELLED
 15691*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15692*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15693*            MOVE ER-2727         TO WS-ERROR
 15694*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15695*
 15696*    IF AH-COVERAGE-CANCELLED
 15697*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15698*        IF PB-COMPANY-ID = 'ACE'
 15699*           MOVE ER-2727        TO WS-ERROR
 15700*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15701*        ELSE
 15702*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15703*              MOVE ER-2727     TO WS-ERROR
 15704*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15705
 15706     IF PB-COMPANY-ID = 'ACE'
 15707       IF AH-COVERAGE-CANCELLED
 15708         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15709           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15710              MOVE ER-2732      TO WS-ERROR
 15711              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15712
 15713     IF PB-COMPANY-ID      EQUAL   'HER'
 15714        IF WS-ERROR        EQUAL   ER-2727
 15715            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15716            MOVE  ER-2725          TO  WS-ERROR
 15717            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15718
 15719     IF PB-C-CLAIM-CREATED-CANCEL
 15720            MOVE ER-2748         TO WS-ERROR
 15721            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15722
 15723     IF PB-C-LAST-NAME NOT = SPACES
 15724         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15725            MOVE ER-2747         TO WS-ERROR
 15726            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15727
 15728 3710-EDIT-LUMP-SUM-PRIOR.
 15729
 15730     IF AH-COVERAGE-CANCELLED
 15731         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15732             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15733                MOVE ER-2735    TO WS-ERROR
 15734                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15735
 15736     IF LF-COVERAGE-CANCELLED
 15737         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15738             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15739                MOVE ER-2735    TO WS-ERROR
 15740                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15741
 15742 3710-EDIT-PRIOR-DEATH.
 15743
 15744*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 284
* EL050.cbl
 15745*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15746*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15747*           (NOT PB-CI-OB)
 15748*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15749*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15750*                   MOVE ER-2732  TO WS-ERROR
 15751*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15752*
 15753*    IF AH-COVERAGE-CANCELLED
 15754*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15755*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15756*           (NOT PB-CI-OB)
 15757*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15758*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15759*                   MOVE ER-2732  TO WS-ERROR
 15760*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15761
 15762     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15763         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15764            (NOT PB-COMP-LF-CANCEL)
 15765             NEXT SENTENCE
 15766         ELSE
 15767           IF PB-C-LF-CANCEL-VOIDED
 15768              NEXT SENTENCE
 15769           ELSE
 15770              MOVE ER-2753      TO WS-ERROR
 15771              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15772
 15773     IF CANCEL-FUTURE-DT
 15774         GO TO 3999-END-EDIT.
 15775
 15776 3715-GET-REMAIN-TERM-LF.
 15777
 15778     IF NO-LF-BENEFIT-MATCH  OR
 15779        WS-LF-BENEFIT-CD = ZEROS
 15780        GO TO 3730-GET-AH-REMAIN-TERM.
 15781
 15782     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15783     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15784     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15785     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15786     MOVE PB-SV-STATE            TO CP-STATE.
 15787     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15788     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15789     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15790     MOVE '2'                    TO CP-PROCESS-TYPE.
 15791     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15792     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15793     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15794     IF (PB-COMPANY-ID = 'CID')
 15795        AND (CP-STATE-STD-ABBRV = 'WI')
 15796        MOVE '7'                 TO CP-REM-TERM-METHOD
 15797        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15798     ELSE
 15799        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15800        MOVE WS-REM-TRM-CALC-OPTION
 15801                                 TO CP-REM-TRM-CALC-OPTION
 15802     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 285
* EL050.cbl
 15803**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15804     IF (PB-COMPANY-ID = 'CID')
 15805        AND (CP-STATE-STD-ABBRV = 'MO')
 15806        AND (PB-CERT-EFF-DT >= X'9B41')
 15807        AND (PB-CERT-EFF-DT <= X'A2FB')
 15808        MOVE '7'                 TO CP-REM-TERM-METHOD
 15809        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15810     END-IF
 15811     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15812                                    CP-LOAN-TERM.
 15813     IF CP-TRUNCATED-LIFE
 15814        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15815
 15816     IF CP-TERM-IS-DAYS
 15817         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15818     ELSE
 15819         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15820
 15821     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15822
 15823     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15824
 15825     IF LF-COVERAGE-CANCELLED
 15826        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15827        NEXT SENTENCE
 15828      ELSE
 15829          GO TO 3730-GET-AH-REMAIN-TERM.
 15830
 15831 3720-GET-LF-REFUND.
 15832
 15833     IF PB-C-LF-CANCEL-VOIDED
 15834        GO TO 3730-GET-AH-REMAIN-TERM
 15835     end-if
 15836
 15837     IF PB-COMPANY-ID EQUAL 'BOA'
 15838         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15839         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15840         GO TO 3730-GET-AH-REMAIN-TERM.
 15841
 15842     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15843        (WS-AH-SPECIAL-CALC-CD = 'M')
 15844         MOVE ER-2767            TO WS-ERROR
 15845         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15846         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15847         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15848         GO TO 3780-UPDATE-CANCEL-CERT.
 15849
 15850*    if (ws-lf-earnings-calc = '6')
 15851*       or (pb-c-lf-refund-override = '6')
 15852*       move cp-remaining-term-1 to cp-remaining-term-2
 15853*    end-if
 15854     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15855
 15856     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15857     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15858     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15859     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15860     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 286
* EL050.cbl
 15861     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15862     IF (PB-COMPANY-ID = 'DCC')
 15863        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15864        IF PDEF-MASTER-FOUND
 15865           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15866              (V1 > +8)
 15867              OR (PD-PROD-CODE (V1) = 'L')
 15868           END-PERFORM
 15869           IF V1 < +9
 15870              MOVE PD-MAX-AMT (V1)
 15871                           TO CP-R-MAX-TOT-BEN
 15872                              EC-AM-LF-MAX-TOT-BEN
 15873           END-IF
 15874        ELSE
 15875        MOVE ' '                 TO PDEF-MASTER-SW
 15876        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15877        MOVE PB-STATE            TO ERPDEF-STATE
 15878        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15879        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15880        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15881        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15882        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15883        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15884        IF PDEF-MASTER-FOUND
 15885           MOVE 'N'              TO PDEF-MASTER-SW
 15886           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15887           IF PDEF-MASTER-FOUND
 15888              IF (ERPDEF-KEY-SAVE (1:16) =
 15889                           PD-CONTROL-PRIMARY (1:16))
 15890                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15891                 CONTINUE
 15892              ELSE
 15893                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15894                 IF (ERPDEF-KEY-SAVE (1:16) =
 15895                           PD-CONTROL-PRIMARY (1:16))
 15896                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15897                    CONTINUE
 15898                 ELSE
 15899                    MOVE 'N'     TO PDEF-MASTER-SW
 15900                 END-IF
 15901              END-IF
 15902
 15903              IF PDEF-MASTER-FOUND
 15904                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15905                    (V1 > +8)
 15906                    OR (PD-PROD-CODE (V1) = 'L')
 15907                 END-PERFORM
 15908                 IF V1 < +9
 15909                    MOVE PD-MAX-AMT (V1)
 15910                                 TO CP-R-MAX-TOT-BEN
 15911                                    EC-AM-LF-MAX-TOT-BEN
 15912                 END-IF
 15913              END-IF
 15914           END-IF
 15915           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15916        END-IF
 15917        END-IF
 15918     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 287
* EL050.cbl
 15919     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15920
 15921     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15922
 15923     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15924                                    PB-C-LF-REM-TERM.
 15925
 15926     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15927     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15928
 15929     IF PB-COMPANY-ID EQUAL 'FLC'
 15930        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15931           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15932           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15933                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15934                    - CM-LF-ITD-DEATH-AMT
 15935           IF PB-C-LF-REF-CALC LESS THAN +0
 15936              MOVE +0            TO PB-C-LF-REF-CALC
 15937              GO TO 3730-GET-AH-REMAIN-TERM
 15938           ELSE
 15939              GO TO 3730-GET-AH-REMAIN-TERM.
 15940
 15941     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15942                            OR '4' OR '5' OR '6' OR '8'
 15943                            OR '9' OR 'G'
 15944        MOVE PB-C-LF-REFUND-OVERRIDE
 15945                                 TO CP-EARNING-METHOD.
 15946
 15947     if pb-company-id = 'AHL'
 15948        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15949        if cp-class-code = spaces
 15950           move zeros            to cp-class-code
 15951        end-if
 15952     ELSE
 15953        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15954     END-IF
 15955*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15956     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15957     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15958                                    CP-RATING-BENEFIT-AMT.
 15959     IF CP-STATE-STD-ABBRV = 'OR'
 15960         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15961                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15962     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15963     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15964     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15965     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15966     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15967     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15968     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15969     IF WS-DEFAULT-APR NOT NUMERIC
 15970         MOVE ZEROS TO WS-DEFAULT-APR.
 15971****   N O T E   ****
 15972*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15973*      THE OH HARD CODING IN ELCRFNDP
 15974
 15975     IF PB-COMPANY-ID = 'CID'
 15976        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 288
* EL050.cbl
 15977           MOVE WS-LF-EARNINGS-CALC
 15978                                 TO CP-EARNING-METHOD
 15979        END-IF
 15980     END-IF
 15981
 15982****   N O T E   ****
 15983
 15984     IF CP-EARN-AS-NET-PAY
 15985         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15986            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15987                MOVE WS-DEFAULT-APR
 15988                                 TO  CP-LOAN-APR
 15989                MOVE ER-3780     TO  WS-ERROR
 15990                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15991            ELSE
 15992                MOVE ER-3781     TO  WS-ERROR
 15993                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15994*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15995     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15996
 15997     IF CP-REFUND-TYPE-USED NOT = SPACE
 15998         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15999
 16000     IF CP-ERROR-RATE-IS-ZERO OR
 16001        CP-ERROR-RATE-NOT-FOUND
 16002        MOVE ER-2740             TO WS-ERROR
 16003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16004
 16005     IF CP-ERROR-RATE-FILE-NOTOPEN
 16006        MOVE ER-2617             TO WS-ERROR
 16007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16008
 16009     IF PB-COMPANY-ID = 'DCC'
 16010        AND PB-CI-ENTRY-STATUS = 'M'
 16011        MOVE +0                  TO PB-C-LF-REF-CALC
 16012     ELSE
 16013        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16014     END-IF
 16015
 16016     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16017         GO TO 3730-GET-AH-REMAIN-TERM.
 16018
 16019*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16020*       ADD +1                   TO PB-C-LF-REM-TERM
 16021*                                   CP-REMAINING-TERM
 16022*                                   CP-ORIGINAL-TERM.
 16023
 16024     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16025     MOVE '2'                    TO CP-EARNING-METHOD
 16026                                    CP-RATING-METHOD.
 16027     IF PB-COMPANY-ID = 'CID'
 16028        IF (CP-STATE-STD-ABBRV = 'MN')
 16029           AND (PB-CERT-EFF-DT > X'A4FF')
 16030           AND (WS-LF-EARNINGS-CALC = 'B')
 16031           MOVE '5'              TO CP-EARNING-METHOD
 16032           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16033        END-IF
 16034     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 289
* EL050.cbl
 16035     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16036                                        CP-REMAINING-BENEFIT
 16037                                        CP-RATING-BENEFIT-AMT.
 16038     IF CP-STATE-STD-ABBRV = 'OR'
 16039         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16040                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16041     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16042     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16043
 16044     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16045
 16046     IF CP-ERROR-RATE-IS-ZERO OR
 16047        CP-ERROR-RATE-NOT-FOUND
 16048        MOVE ER-2740             TO WS-ERROR
 16049        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16050
 16051     IF CP-ERROR-RATE-FILE-NOTOPEN
 16052        MOVE ER-2617             TO WS-ERROR
 16053        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16054
 16055     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16056
 16057******************************************************************
 16058
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 290
* EL050.cbl
 16060 3730-GET-AH-REMAIN-TERM.
 16061     IF NO-AH-BENEFIT-MATCH  OR
 16062        WS-AH-BENEFIT-CD = ZEROS
 16063         GO TO 3770-CHECK-REFUNDS.
 16064
 16065     IF PB-CI-AH-LUMP-SUM-DISAB
 16066         IF  PB-C-AH-CANCEL-AMT = ZERO
 16067            IF NOT PB-COMP-AH-CANCEL
 16068             GO TO 3770-CHECK-REFUNDS.
 16069
 16070     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16071     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16072     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16073     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16074     MOVE PB-SV-STATE            TO CP-STATE.
 16075     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16076     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16077     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16078     MOVE '2'                    TO CP-PROCESS-TYPE.
 16079     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16080     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16081     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16082     IF (PB-COMPANY-ID = 'CID')
 16083        AND (CP-STATE-STD-ABBRV = 'WI')
 16084        MOVE '7'                 TO CP-REM-TERM-METHOD
 16085        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16086     ELSE
 16087        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16088        MOVE WS-REM-TRM-CALC-OPTION
 16089                                 TO CP-REM-TRM-CALC-OPTION
 16090     END-IF
 16091     IF (PB-COMPANY-ID = 'CID')
 16092        AND (CP-STATE-STD-ABBRV = 'MO')
 16093        AND (PB-CERT-EFF-DT >= X'9B41')
 16094        AND (PB-CERT-EFF-DT <= X'A2FB')
 16095        MOVE '7'                 TO CP-REM-TERM-METHOD
 16096        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16097     END-IF
 16098     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16099                                    CP-LOAN-TERM.
 16100     IF NOT CP-TERM-IS-DAYS
 16101         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16102
 16103     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16104
 16105     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16106
 16107     IF AH-COVERAGE-CANCELLED
 16108        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16109        NEXT SENTENCE
 16110      ELSE
 16111         GO TO 3770-CHECK-REFUNDS.
 16112
 16113 3740-GET-AH-REFUND.
 16114
 16115     IF PB-C-AH-CANCEL-VOIDED
 16116        GO TO 3780-UPDATE-CANCEL-CERT
 16117     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 291
* EL050.cbl
 16118
 16119     IF PB-COMPANY-ID = 'BOA'
 16120         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16121         GO TO 3770-CHECK-REFUNDS.
 16122
 16123     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16124*    MOVE ' '                    TO DC-OPTION-CODE
 16125     SET BIN-TO-GREG             TO TRUE
 16126     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16127     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16128                                    PB-C-AH-REM-TERM.
 16129     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16130     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16131
 16132     IF PB-COMPANY-ID EQUAL 'FLC'
 16133        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16134           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16135           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16136                    - CM-AH-ITD-AH-PMT)
 16137           IF PB-C-AH-REF-CALC LESS THAN +0
 16138              MOVE +0            TO PB-C-AH-REF-CALC
 16139              GO TO 3770-CHECK-REFUNDS
 16140           ELSE
 16141              GO TO 3770-CHECK-REFUNDS.
 16142
 16143     IF PB-COMPANY-ID = 'DCC'
 16144        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16145            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16146           MOVE 'S'              TO CP-EARNING-METHOD
 16147        END-IF
 16148     END-IF
 16149     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16150                            OR '4' OR '5' OR '6' OR '8'
 16151                            OR '9' OR 'G' OR 'S'
 16152        MOVE PB-C-AH-REFUND-OVERRIDE
 16153                                 TO CP-EARNING-METHOD.
 16154
 16155     if pb-company-id = 'AHL'
 16156        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16157        if cp-class-code = spaces
 16158           move zeros            to cp-class-code
 16159        end-if
 16160     ELSE
 16161        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16162     END-IF
 16163*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16164     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16165     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16166                                    CP-RATING-BENEFIT-AMT.
 16167     IF CP-STATE-STD-ABBRV = 'OR'
 16168         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16169                                         PB-CI-AH-TERM.
 16170     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16171     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16172     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16173     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16174     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16175     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 292
* EL050.cbl
 16176
 16177     IF CP-STATE-STD-ABBRV = 'OH'
 16178        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16179                                AND 'CID' AND 'DCC' AND 'AHL')
 16180           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16181              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16182              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16183              MOVE '6' TO CP-EARNING-METHOD
 16184           END-IF
 16185        END-IF
 16186        IF PB-COMPANY-ID = 'CID'
 16187           IF NO-LIFE-COVERAGE
 16188              IF CP-CRITICAL-PERIOD
 16189                 MOVE '2'       TO CP-EARNING-METHOD
 16190              ELSE
 16191                 MOVE '6'       TO CP-EARNING-METHOD
 16192              END-IF
 16193           ELSE
 16194              IF WS-LF-COVERAGE-TYPE = 'L'
 16195                 MOVE '2'       TO CP-EARNING-METHOD
 16196              ELSE
 16197                 IF (PB-CI-LF-TERM > +60) OR
 16198                    (WS-LF-EARNINGS-CALC = '5')
 16199                    IF CP-CRITICAL-PERIOD
 16200                       MOVE '2'  TO CP-EARNING-METHOD
 16201                    ELSE
 16202                       MOVE '6'  TO CP-EARNING-METHOD
 16203                    END-IF
 16204                 ELSE
 16205                    MOVE '1'     TO CP-EARNING-METHOD
 16206                 END-IF
 16207              END-IF
 16208           END-IF
 16209        END-IF
 16210     END-IF
 16211
 16212*    IF CP-STATE-STD-ABBRV = 'VA'
 16213*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16214*          IF CP-ORIGINAL-TERM GREATER 61
 16215*             MOVE '6' TO CP-EARNING-METHOD
 16216*          ELSE
 16217*             MOVE '1' TO CP-EARNING-METHOD.
 16218
 16219     IF WS-DEFAULT-APR NOT NUMERIC
 16220         MOVE ZEROS TO WS-DEFAULT-APR.
 16221     IF CP-EARN-AS-NET-PAY
 16222         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16223            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16224                MOVE WS-DEFAULT-APR
 16225                                 TO  CP-LOAN-APR
 16226                MOVE ER-3780     TO  WS-ERROR
 16227                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16228            ELSE
 16229                MOVE ER-3781     TO  WS-ERROR
 16230                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16231     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16232     IF PB-COMPANY-ID = 'DCC'
 16233        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 293
* EL050.cbl
 16234        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16235        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16236     END-IF
 16237     IF PB-COMPANY-ID = 'DCC'
 16238        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16239        AND (CP-EARNING-METHOD = 'D')
 16240        AND (CP-CANCEL-REASON NOT = 'R')
 16241        CONTINUE
 16242     ELSE
 16243        GO TO 3750-CONTINUE
 16244     END-IF
 16245     MOVE ' '                    TO DD-IU-SW
 16246     IF NOT PDEF-MASTER-FOUND
 16247        MOVE ' '                 TO PDEF-MASTER-SW
 16248        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16249        MOVE PB-STATE            TO ERPDEF-STATE
 16250        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16251        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16252        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16253        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16254        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16255        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16256        IF PDEF-MASTER-FOUND
 16257           MOVE 'N'              TO PDEF-MASTER-SW
 16258           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16259           IF PDEF-MASTER-FOUND
 16260              IF (ERPDEF-KEY-SAVE (1:16) =
 16261                           PD-CONTROL-PRIMARY (1:16))
 16262                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16263                 CONTINUE
 16264              ELSE
 16265                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16266                 IF (ERPDEF-KEY-SAVE (1:16) =
 16267                           PD-CONTROL-PRIMARY (1:16))
 16268                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16269                    CONTINUE
 16270                 ELSE
 16271                    MOVE ER-2740 TO WS-ERROR
 16272                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16273                    GO TO 3770-CHECK-REFUNDS
 16274                 END-IF
 16275              END-IF
 16276           END-IF
 16277           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16278        END-IF
 16279     END-IF
 16280     IF PDEF-MASTER-FOUND
 16281        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16282           (V1 > +8)
 16283           OR (PD-PROD-CODE (V1) = 'I')
 16284        END-PERFORM
 16285        IF V1 < +9
 16286           SET DD-IU-PRESENT        TO TRUE
 16287        END-IF
 16288        IF WS-AH-DCC-TRUNC = 'T'
 16289           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16290        ELSE
 16291           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 294
* EL050.cbl
 16292        END-IF
 16293        EVALUATE TRUE
 16294           WHEN WS-TERM > +168
 16295              MOVE 15               TO V1
 16296           WHEN WS-TERM > +156
 16297              MOVE 14               TO V1
 16298           WHEN WS-TERM > +144
 16299              MOVE 13               TO V1
 16300           WHEN WS-TERM > +132
 16301              MOVE 12               TO V1
 16302           WHEN WS-TERM > +120
 16303              MOVE 11               TO V1
 16304           WHEN WS-TERM > +108
 16305              MOVE 10               TO V1
 16306           WHEN WS-TERM > +96
 16307              MOVE 9                TO V1
 16308           WHEN WS-TERM > +84
 16309              MOVE 8                TO V1
 16310           WHEN WS-TERM > +72
 16311              MOVE 7                TO V1
 16312           WHEN WS-TERM > +60
 16313              MOVE 6                TO V1
 16314           WHEN WS-TERM > +48
 16315              MOVE 5                TO V1
 16316           WHEN WS-TERM > +36
 16317              MOVE 4                TO V1
 16318           WHEN WS-TERM > +24
 16319              MOVE 3                TO V1
 16320           WHEN WS-TERM > +12
 16321              MOVE 2                TO V1
 16322           WHEN OTHER
 16323              MOVE 1                TO V1
 16324        END-EVALUATE
 16325
 16326        EVALUATE TRUE
 16327*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16328*             < +13)
 16329*             AND (DD-IU-PRESENT)
 16330*             MOVE 2                TO V2
 16331*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16332*             MOVE 1                TO V2
 16333           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16334              MOVE 2                TO V2
 16335           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16336              MOVE 3                TO V2
 16337           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16338              MOVE 4                TO V2
 16339           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16340              MOVE 5                TO V2
 16341           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16342              MOVE 6                TO V2
 16343           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16344              MOVE 7                TO V2
 16345           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16346              MOVE 8                TO V2
 16347           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16348              MOVE 9                TO V2
 16349           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 295
* EL050.cbl
 16350              MOVE 10               TO V2
 16351           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16352              MOVE 11               TO V2
 16353           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16354              MOVE 12               TO V2
 16355           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16356              MOVE 13               TO V2
 16357           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16358              MOVE 14               TO V2
 16359           WHEN OTHER
 16360              MOVE 15               TO V2
 16361        END-EVALUATE
 16362
 16363        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16364                                 TO CP-DDF-LO-FACT
 16365        MOVE PD-UEP-FACTOR (V1 V2)
 16366                                 TO CP-DDF-HI-FACT
 16367
 16368        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16369        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16370        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16371           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16372        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16373        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16374        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16375           + PD-1ST-YR-ADMIN-ALLOW
 16376
 16377        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16378*       IF PI-CLP-YN = 'Y'
 16379*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16380*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16381*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16382*       END-IF
 16383
 16384        IF DD-IU-PRESENT
 16385           MOVE 'I'              TO CP-EARNING-METHOD
 16386        END-IF
 16387        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16388                                     CP-CLP-RATE-UP
 16389        IF CP-IU-RATE-UP NOT = ZEROS
 16390           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16391              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16392           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16393              / (1 - WS-WORK-FACT)
 16394        END-IF
 16395     END-IF
 16396     .
 16397 3750-CONTINUE.
 16398     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16399
 16400     IF CP-REFUND-TYPE-USED NOT = SPACE
 16401         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16402
 16403     IF CP-ERROR-RATE-IS-ZERO OR
 16404        CP-ERROR-RATE-NOT-FOUND
 16405        MOVE ER-2740             TO WS-ERROR
 16406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16407
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 296
* EL050.cbl
 16408     IF CP-ERROR-RATE-FILE-NOTOPEN
 16409        MOVE ER-2617             TO WS-ERROR
 16410        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16411     IF PB-COMPANY-ID = 'DCC'
 16412        AND PB-CI-ENTRY-STATUS = 'M'
 16413        MOVE +0                  TO PB-C-AH-REF-CALC
 16414     ELSE
 16415        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16416     END-IF
 16417     IF PB-COMPANY-ID = 'DCC'
 16418        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16419        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16420        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16421        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16422        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16423        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16424        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16425        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16426*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16427     END-IF
 16428     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 297
* EL050.cbl
 16430
 16431 3770-CHECK-REFUNDS.
 16432
 16433     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16434        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16435           MOVE ER-2766          TO WS-ERROR
 16436           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16437           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16438           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16439              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16440
 16441     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16442        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16443           MOVE ER-2766          TO WS-ERROR
 16444           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16445           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16446           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16447              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16448
 16449     IF PB-COMP-LF-CANCEL
 16450        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16451        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16452           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16453              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16454
 16455     IF PB-COMP-AH-CANCEL
 16456        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16457        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16458           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16459              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16460
 16461     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16462             GIVING WS-UNSIGN-WRK1
 16463     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16464             GIVING WS-UNSIGN-WRK2.
 16465
 16466     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16467         MOVE ZERO TO WS-UNSIGN-WRK1.
 16468
 16469     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16470         MOVE ZERO TO WS-UNSIGN-WRK2.
 16471
 16472     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16473
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 298
* EL050.cbl
 16475
 16476 3772-CONTINUE.
 16477
 16478**********************************
 16479*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16480*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16481*** DOUBLES THE TOLERANCE AMOUNT.
 16482***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16483**********************************
 16484     IF PB-COMPANY-ID = 'MON'
 16485     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16486         IF WS-REF-REJECT-SW = SPACE
 16487             MOVE ER-2754        TO WS-ERROR
 16488             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16489           ELSE
 16490             MOVE ER-2736        TO WS-ERROR
 16491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16492**********************************
 16493
 16494 3773-CONTINUE.
 16495
 16496     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16497        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16498           MOVE ER-2723          TO WS-ERROR
 16499           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16500
 16501     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16502        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16503           MOVE ER-2724          TO WS-ERROR
 16504           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16505
 16506     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16507         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16508             (1 + WS-LF-REFUND-OVS-PCT)
 16509     ELSE
 16510         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16511
 16512     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16513         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16514             (1 - WS-TOL-LF-REFUND-PCT)
 16515     ELSE
 16516         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16517
 16518     IF (PB-COMPANY-ID = 'DCC')
 16519        AND (PB-CI-ENTRY-STATUS = 'M')
 16520        AND (PB-C-LF-CANCEL-AMT > +0)
 16521        MOVE ER-3843             TO WS-ERROR
 16522        PERFORM 9900-ERROR-FORMAT
 16523                                 THRU 9900-EXIT
 16524     END-IF
 16525     EVALUATE TRUE
 16526        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16527           CONTINUE
 16528        WHEN PB-C-LF-CANCEL-AMT = +0
 16529                 AND PB-C-LF-REF-CALC > +0
 16530           CONTINUE
 16531        WHEN WS-LF-REFUND-OVS-AMT = 0
 16532                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 299
* EL050.cbl
 16533           CONTINUE
 16534        WHEN OTHER
 16535           IF WS-TOL-LF-REFUND  = +0
 16536              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16537           END-IF
 16538           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16539                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16540                          (PB-C-LF-CANCEL-AMT))
 16541              CONTINUE
 16542           ELSE
 16543              IF WS-LF-REFUND-OVS-AMT = +0
 16544                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16545              END-IF
 16546              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16547                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16548                                       PB-C-LF-CANCEL-AMT)
 16549                 CONTINUE
 16550              ELSE
 16551                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16552                   MOVE ER-2754   TO  WS-ERROR
 16553                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16554                 ELSE
 16555                    MOVE ER-2736   TO  WS-ERROR
 16556                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16557                 END-IF
 16558              END-IF
 16559           END-IF
 16560     END-EVALUATE.
 16561
 16562     EVALUATE TRUE
 16563        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16564           CONTINUE
 16565        WHEN PB-C-LF-CANCEL-AMT = +0
 16566                 AND PB-C-LF-REF-CALC > +0
 16567           CONTINUE
 16568        WHEN OTHER
 16569           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16570               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16571              CONTINUE
 16572           ELSE
 16573              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16574               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16575                CONTINUE
 16576              ELSE
 16577                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16578                     MOVE ER-2754   TO  WS-ERROR
 16579                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16580                 ELSE
 16581                     MOVE ER-2736   TO  WS-ERROR
 16582                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16583                 END-IF
 16584              END-IF
 16585           END-IF
 16586     END-EVALUATE.
 16587
 16588     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16589         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16590             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 300
* EL050.cbl
 16591     ELSE
 16592         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16593
 16594     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16595         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16596             (1 - WS-TOL-AH-REFUND-PCT)
 16597     ELSE
 16598         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16599
 16600     IF (PB-COMPANY-ID = 'DCC')
 16601        AND (PB-CI-ENTRY-STATUS = 'M')
 16602        AND (PB-C-AH-CANCEL-AMT > +0)
 16603        MOVE ER-3843             TO WS-ERROR
 16604        PERFORM 9900-ERROR-FORMAT
 16605                                 THRU 9900-EXIT
 16606     END-IF
 16607     EVALUATE TRUE
 16608        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16609           CONTINUE
 16610*       WHEN PB-C-AH-REF-CALC = +0 AND
 16611*                  PB-C-AH-CANCEL-AMT > +0
 16612        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16613                   PB-C-AH-REF-CALC > +0
 16614           CONTINUE
 16615        WHEN WS-AH-REFUND-OVS-AMT = +0
 16616                AND WS-TOL-AH-REFUND = +0
 16617           CONTINUE
 16618        WHEN OTHER
 16619           IF WS-TOL-AH-REFUND = +0
 16620              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16621           END-IF
 16622           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16623               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16624                                         PB-C-AH-CANCEL-AMT)
 16625              CONTINUE
 16626           ELSE
 16627              IF WS-AH-REFUND-OVS-AMT = +0
 16628                 MOVE +9999999.99 TO
 16629                         WS-AH-REFUND-OVS-AMT
 16630              END-IF
 16631              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16632                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16633                                         PB-C-AH-CANCEL-AMT)
 16634                 CONTINUE
 16635              ELSE
 16636                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16637                    MOVE ER-2754   TO  WS-ERROR
 16638                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16639                 ELSE
 16640                    MOVE ER-2736   TO  WS-ERROR
 16641                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16642                 END-IF
 16643              END-IF
 16644           END-IF
 16645     END-EVALUATE.
 16646
 16647     EVALUATE TRUE
 16648        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 301
* EL050.cbl
 16649           CONTINUE
 16650*       WHEN PB-C-AH-REF-CALC > +0 AND
 16651*                  PB-C-AH-CANCEL-AMT = +0
 16652        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16653                   PB-C-AH-REF-CALC = +0
 16654           CONTINUE
 16655        WHEN OTHER
 16656           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16657               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16658              CONTINUE
 16659           ELSE
 16660              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16661                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16662                 CONTINUE
 16663              ELSE
 16664                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16665                     MOVE ER-2754   TO  WS-ERROR
 16666                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16667                 ELSE
 16668                     MOVE ER-2736   TO  WS-ERROR
 16669                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16670                 END-IF
 16671              END-IF
 16672           END-IF
 16673     END-EVALUATE.
 16674
 16675     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16676        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16677        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16678           AND  PB-C-LF-REF-CALC < +1.00
 16679           AND  PB-C-AH-REF-CALC < +1.00
 16680           CONTINUE
 16681        ELSE
 16682           IF (PB-COMPANY-ID = 'DCC')
 16683              AND (PB-CI-ENTRY-STATUS = 'M')
 16684              CONTINUE
 16685           ELSE
 16686              MOVE ER-2741       TO WS-ERROR
 16687              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16688           END-IF
 16689        END-IF
 16690     END-IF
 16691
 16692     IF (PB-C-LF-CANCEL-AMT = ZERO
 16693        AND WS-LF-BENEFIT-CD NOT = ZERO
 16694        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16695        AND PB-C-LF-REF-CALC NOT = ZERO)
 16696        OR
 16697        (PB-C-LF-CANCEL-AMT = ZERO
 16698        AND WS-LF-BENEFIT-CD NOT = ZERO
 16699        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16700             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16701                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16702                NEXT SENTENCE
 16703             ELSE
 16704                MOVE ER-2739        TO WS-ERROR
 16705                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16706
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 302
* EL050.cbl
 16707     IF (PB-C-AH-CANCEL-AMT = ZERO
 16708        AND WS-AH-BENEFIT-CD NOT = ZERO
 16709        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16710        AND PB-C-AH-REF-CALC NOT = ZERO)
 16711        OR
 16712        (PB-C-AH-CANCEL-AMT = ZERO
 16713        AND WS-AH-BENEFIT-CD NOT = ZERO
 16714        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16715             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16716                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16717                NEXT SENTENCE
 16718             ELSE
 16719                MOVE ER-2738        TO WS-ERROR
 16720                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16721
 16722 3775-OVER-REF-CHK.
 16723
 16724     IF PB-CI-ENTRY-STATUS = '5'
 16725        GO TO 3780-UPDATE-CANCEL-CERT.
 16726
 16727     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16728                              PB-CI-LF-ALT-PREMIUM-AMT.
 16729
 16730     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16731        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16732                                 PB-C-LF-REF-CALC
 16733      ELSE
 16734        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16735                                 PB-C-LF-CANCEL-AMT.
 16736
 16737     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16738        MOVE ER-2755             TO WS-ERROR
 16739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16740
 16741     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16742
 16743     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16744        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16745                                 PB-C-AH-REF-CALC
 16746      ELSE
 16747        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16748                                 PB-C-AH-CANCEL-AMT.
 16749
 16750     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16751        MOVE ER-2778             TO WS-ERROR
 16752        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16753
 16754     IF PB-CI-OB-FLAG NOT = 'Z'
 16755        NEXT SENTENCE
 16756       ELSE
 16757         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16758            MOVE ER-2757           TO WS-ERROR
 16759            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16760
 16761 3780-UPDATE-CANCEL-CERT.
 16762
 16763     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16764        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 303
* EL050.cbl
 16765        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16766
 16767     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16768         MOVE ER-2729              TO WS-ERROR
 16769         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16770
 16771     IF PB-CI-LF-BENEFIT-CD = ZERO
 16772         GO TO 3780-UPDATE-CONT-1.
 16773
 16774     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16775         GO TO 3780-UPDATE-CONT-1.
 16776
 16777     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16778       AND
 16779        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16780       AND
 16781        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16782       AND
 16783        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16784            NEXT SENTENCE
 16785       ELSE
 16786        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16787          AND
 16788***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16789***       AND
 16790           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16791            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16792               MOVE ER-2730      TO WS-ERROR
 16793               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16794               GO TO 3999-END-EDIT
 16795            ELSE
 16796               GO TO 3999-END-EDIT
 16797        ELSE
 16798            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16799               MOVE ER-2765           TO WS-ERROR
 16800               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16801               GO TO 3785-CHECK-NH.
 16802*              GO TO 3999-END-EDIT.
 16803
 16804 3780-UPDATE-CONT-1.
 16805     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16806
 16807     IF PB-CI-AH-BENEFIT-CD = ZERO
 16808         GO TO 3780-UPDATE-CONT-2.
 16809
 16810     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16811         GO TO 3780-UPDATE-CONT-2.
 16812
 16813     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16814
 16815     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16816       AND
 16817        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16818       AND
 16819        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16820       AND
 16821        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16822            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 304
* EL050.cbl
 16823       ELSE
 16824        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16825          AND
 16826***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16827***       AND
 16828           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16829           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16830            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16831               MOVE ER-2773      TO WS-ERROR
 16832               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16833               GO TO 3999-END-EDIT
 16834            ELSE
 16835               GO TO 3999-END-EDIT
 16836            END-IF
 16837           ELSE
 16838             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16839                MOVE ER-2890 TO WS-ERROR
 16840                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16841                GO TO 3999-END-EDIT
 16842             ELSE
 16843                GO TO 3785-CHECK-NH
 16844             END-IF
 16845           END-IF
 16846          ELSE
 16847            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16848              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16849                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16850                   MOVE ER-2890 TO WS-ERROR
 16851                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16852                   GO TO 3999-END-EDIT
 16853                ELSE
 16854                   MOVE ER-2765 TO WS-ERROR
 16855                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16856                   GO TO 3785-CHECK-NH
 16857                END-IF
 16858              ELSE
 16859               MOVE ER-2765      TO WS-ERROR
 16860               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16861               GO TO 3785-CHECK-NH.
 16862*              GO TO 3999-END-EDIT.
 16863
 16864 3780-UPDATE-CONT-2.
 16865
 16866     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16867        AND WS-LF-BENEFIT-CD = ZERO
 16868           MOVE ER-2743           TO WS-ERROR
 16869           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16870
 16871     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16872        AND WS-AH-BENEFIT-CD = ZERO
 16873           MOVE ER-2744           TO WS-ERROR
 16874           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16875
 16876     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16877        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16878        AND
 16879        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16880         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 305
* EL050.cbl
 16881           MOVE ER-2746           TO WS-ERROR
 16882           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16883
 16884     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16885       AND
 16886        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16887             MOVE ER-2737        TO WS-ERROR
 16888             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16889
 16890     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16891       AND
 16892        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16893             MOVE ER-2737        TO WS-ERROR
 16894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16895
 16896     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16897         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16898             OR 'CID' OR 'DCC' OR 'AHL'
 16899             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16900         ELSE
 16901             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16902                 MOVE ER-2768    TO WS-ERROR
 16903                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16904             ELSE
 16905                 MOVE ER-2756    TO WS-ERROR
 16906                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16907
 16908     IF CERT-PEND-ISSUE-RETURNED
 16909        MOVE ER-2772             TO WS-ERROR
 16910        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16911 3785-CHECK-NH.
 16912     IF PB-STATE NOT = 'NH'
 16913        GO TO 3999-END-EDIT
 16914     END-IF
 16915
 16916     MOVE ER-2796                TO WS-ERROR
 16917     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16918     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16919        OR (CM-NH-INTERFACE-SW = 'Y')
 16920        MOVE ER-2793             TO WS-ERROR
 16921        PERFORM 9900-ERROR-FORMAT
 16922                                 THRU 9900-EXIT
 16923     END-IF
 16924     MOVE +0                     TO WS-PAYMENT-AMT
 16925     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16926        GO TO 3999-END-EDIT
 16927     END-IF
 16928     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16929        GO TO 3999-END-EDIT
 16930     END-IF
 16931     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16932     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16933     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16934        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16935     END-IF
 16936     MOVE '1'                    TO DC-OPTION-CODE
 16937     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16938     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 306
* EL050.cbl
 16939        IF DC-ELAPSED-DAYS < +16
 16940           GO TO 3999-END-EDIT
 16941        END-IF
 16942     END-IF
 16943     MOVE +0                     TO DC-ELAPSED-DAYS
 16944     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16945     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16946     MOVE '1'                    TO DC-OPTION-CODE
 16947     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16948     IF NO-CONVERSION-ERROR
 16949        IF DC-ELAPSED-DAYS > +30
 16950           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16951        ELSE
 16952           GO TO 3999-END-EDIT
 16953        END-IF
 16954     ELSE
 16955        GO TO 3999-END-EDIT
 16956     END-IF
 16957     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16958        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16959           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16960     IF WS-PAYMENT-AMT < 600.00
 16961        GO TO 3999-END-EDIT
 16962     END-IF
 16963     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16964
 16965     IF (ERMAIL-FOUND = ' ')
 16966         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16967         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16968        GO TO 3999-END-EDIT
 16969     END-IF
 16970     MOVE ER-2795                TO WS-ERROR
 16971     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16972
 16973     GO TO 3999-END-EDIT.
 16974******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 307
* EL050.cbl
 16976 3990-FILES-NOT-OPEN.
 16977
 16978     MOVE ER-2617                TO WS-ERROR.
 16979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16980     GO TO 9990-RETURN.
 16981
 16982 3999-END-EDIT.
 16983
 16984     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16985
 16986     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16987         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16988         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16989             PERFORM 9250-UNLOCK-RETURN
 16990             GO TO 9990-RETURN
 16991          ELSE
 16992             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16993             GO TO 9990-RETURN.
 16994
 16995     IF PB-CANCELLATION
 16996          GO TO 9990-RETURN.
 16997
 16998     IF CERT-WAS-NOT-FOUND
 16999        MOVE SPACES              TO CERTIFICATE-MASTER.
 17000
 17001     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17002
 17003     IF CERT-WAS-FOUND
 17004         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17005             PERFORM 9250-UNLOCK-RETURN
 17006          ELSE
 17007            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17008      ELSE
 17009         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17010
 17011     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17012        IF PB-COMPANY-ID = 'DCC' AND
 17013           (PB-CARRIER = '2' OR '4' OR '6')
 17014              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17015        END-IF
 17016     END-IF.
 17017
 17018     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17019         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17020     END-IF.
 17021     move ' '                    to ws-ins-age-defaulted
 17022     perform 8150-read-elcrtt    thru 8150-exit
 17023     if ws-ins-age-defaulted = 'Y'
 17024        move er-1573             to ws-error
 17025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17026     end-if
 17027
 17028     if ws-jnt-age-defaulted = 'Y'
 17029        move er-1574             to ws-error
 17030        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17031     end-if
 17032
 17033     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 308
* EL050.cbl
 17034     IF ((PB-COMPANY-ID = 'DCC')
 17035        AND (WS-NO-SECURE-PAY))
 17036                  OR
 17037        (WS-LF-SPECIAL-CALC-CD = 'O'
 17038        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17039        SET SKIP-ADDR-EDIT       TO TRUE
 17040     END-IF
 17041     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17042        AND (NOT SKIP-ADDR-EDIT)
 17043        MOVE ER-2963             TO WS-ERROR
 17044        PERFORM 9900-ERROR-FORMAT
 17045                                 THRU 9900-EXIT
 17046        GO TO 9990-RETURN
 17047     END-IF
 17048     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17049     IF ERPNDM-FOUND NOT = 'X'
 17050        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17051           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17052           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17053           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17054           AND (NOT SKIP-ADDR-EDIT)
 17055           MOVE ER-2694          TO WS-ERROR
 17056           PERFORM 9900-ERROR-FORMAT
 17057                                 THRU 9900-EXIT
 17058        END-IF
 17059        MOVE ' '                 TO STATE-RECORD-ERROR
 17060        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17061        MOVE PM-STATE            TO CNTL-ACCESS
 17062        MOVE '3'                 TO CNTL-REC-TYPE
 17063        MOVE +0                  TO CNTL-SEQ-NO
 17064        MOVE '0'                 TO RC-SW-2
 17065        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17066        IF (NO-STATE-RECORD)
 17067           OR (CF-RECORD-TYPE NOT = '3')
 17068           OR (PM-STATE NOT = CF-STATE-CODE)
 17069           IF (PM-STATE = SPACES)
 17070              AND (SKIP-ADDR-EDIT)
 17071              CONTINUE
 17072           ELSE
 17073              MOVE ER-2963       TO WS-ERROR
 17074              PERFORM 9900-ERROR-FORMAT
 17075                                 THRU 9900-EXIT
 17076           END-IF
 17077        END-IF
 17078        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17079           MOVE ER-2883          TO WS-ERROR
 17080           PERFORM 9900-ERROR-FORMAT
 17081                                 THRU 9900-EXIT
 17082        END-IF
 17083        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17084           MOVE ' '                 TO STATE-RECORD-ERROR
 17085           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17086           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17087           MOVE '3'                 TO CNTL-REC-TYPE
 17088           MOVE +0                  TO CNTL-SEQ-NO
 17089           MOVE '0'                 TO RC-SW-2
 17090           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17091           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 309
* EL050.cbl
 17092              OR (CF-RECORD-TYPE NOT = '3')
 17093              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17094              MOVE ER-2964          TO WS-ERROR
 17095              PERFORM 9900-ERROR-FORMAT
 17096                                    THRU 9900-EXIT
 17097           END-IF
 17098        END-IF
 17099     ELSE
 17100        IF NOT SKIP-ADDR-EDIT
 17101           MOVE ER-2393          TO WS-ERROR
 17102           PERFORM 9900-ERROR-FORMAT
 17103                                 THRU 9900-EXIT
 17104        END-IF
 17105     END-IF
 17106
 17107     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17108
 17109     IF (ERMAIL-FOUND = ' ' AND
 17110        ERPNDM-FOUND = ' ')
 17111        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17112           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17113           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17114          OR
 17115           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17116          OR
 17117           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17118           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17119           GO TO 3999-UNLOCK-ERMAIL.
 17120
 17121     IF ERPNDM-FOUND = 'X'
 17122        GO TO 3999-UNLOCK-ERMAIL.
 17123
 17124     IF PM-INSURED-LAST-NAME      = SPACES
 17125        AND PM-INSURED-FIRST-NAME = SPACES
 17126        AND PM-ADDRESS-LINE-1     = SPACES
 17127        AND PM-ADDRESS-LINE-2     = SPACES
 17128        AND PM-CITY-STATE         = SPACES
 17129        AND PM-CRED-BENE-NAME     = SPACES
 17130        AND PM-CRED-BENE-ADDR     = SPACES
 17131        AND PM-CRED-BENE-CTYST    = SPACES
 17132        GO TO 3999-UNLOCK-ERMAIL
 17133     END-IF
 17134
 17135     MOVE SPACES                 TO MAILING-DATA.
 17136
 17137     MOVE 'MA'                   TO MA-RECORD-ID.
 17138     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17139     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17140     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17141     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17142     MOVE PB-SV-STATE            TO MA-STATE.
 17143     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17144     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17145
 17146     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17147     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17148
 17149     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 310
* EL050.cbl
 17150        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17151     ELSE
 17152        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17153        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17154        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17155
 17156     GO TO 9990-RETURN.
 17157
 17158 3999-UNLOCK-ERMAIL.
 17159     IF ERMAIL-FOUND = ' '
 17160        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17161
 17162     GO TO 9990-RETURN.
 17163******************************************************************
 17164
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 311
* EL050.cbl
 17166 4000-UPDATE-CANCELLED-CERT.
 17167     IF CERT-WAS-NOT-FOUND
 17168        GO TO 4299-EXIT.
 17169
 17170*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17171     IF PB-C-NH-INT-ON-REFS > ZEROS
 17172        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17173     END-IF
 17174     IF PB-C-REF-INTERFACE-SW = 'Y'
 17175        MOVE PB-C-REF-INTERFACE-SW
 17176                                 TO CM-NH-INTERFACE-SW
 17177     END-IF
 17178     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17179     IF ERMAIL-FOUND = 'X'
 17180        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17181        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17182        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17183        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17184           MOVE ER-2694          TO WS-ERROR
 17185           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17186     END-IF
 17187
 17188     IF PB-C-POST-CARD-IND = 'Y'
 17189        MOVE +8                  TO SUB
 17190*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17191        IF ERMAIL-FOUND = ' '
 17192           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17193              (SUB > +7)
 17194              OR (MA-MAIL-STATUS (SUB) = '1')
 17195           END-PERFORM
 17196        END-IF
 17197        IF (SUB > +7)
 17198           OR (ERMAIL-FOUND = 'X')
 17199           MOVE ER-3789          TO WS-ERROR
 17200           PERFORM 9900-ERROR-FORMAT
 17201                                 THRU 9900-EXIT
 17202        END-IF
 17203     ELSE
 17204        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17205     END-IF
 17206
 17207     IF ERMAIL-FOUND = ' '
 17208        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17209     END-IF.
 17210
 17211     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17212
 17213     IF PB-CI-OB-FLAG = 'Z'
 17214        GO TO 4150-SUMMARY-CERT-CANCEL.
 17215
 17216     IF PB-C-LF-CANCEL-VOIDED
 17217         PERFORM 4200-REVERSE-LF-CANCEL.
 17218     IF PB-C-AH-CANCEL-VOIDED
 17219         PERFORM 4200-REVERSE-AH-CANCEL.
 17220
 17221 4100-APPLY-LF-CANCEL.
 17222
 17223     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 312
* EL050.cbl
 17224
 17225 4100-CHECK-LF-ERRORS.
 17226
 17227     ADD +1                       TO WS-SUB.
 17228
 17229     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17230        IF LF-COVERAGE-CANCELLED
 17231           GO TO 4100-LF-CANCEL-CONT
 17232        ELSE
 17233           GO TO 4100-UPDATE-LF-COVERAGE.
 17234
 17235     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17236                                   ER-2729 OR
 17237                                   ER-2730 OR
 17238                                   ER-2731 OR
 17239                                   ER-2732 OR
 17240                                   ER-2737 OR
 17241                                   ER-2740 OR
 17242                                   ER-2743 OR
 17243                                   ER-2749 OR
 17244                                   ER-2750 OR
 17245                                   ER-2755 OR
 17246                                   ER-2757 OR
 17247                                   ER-2760 OR
 17248                                   ER-2772 OR
 17249                                   ER-2774 OR
 17250                                   ER-2776 OR
 17251                                   ER-2794
 17252        GO TO 4100-UPDATE-LF-COVERAGE.
 17253
 17254     GO TO 4100-CHECK-LF-ERRORS.
 17255
 17256 4100-UPDATE-LF-COVERAGE.
 17257
 17258     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17259     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17260     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17261        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17262     END-IF
 17263     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17264                                      TO CM-CREDIT-INTERFACE-SW-2.
 17265     IF CM-LF-CANCEL-DT = LOW-VALUE
 17266         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17267
 17268     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17269         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17270                                         CM-LF-STATUS-AT-CANCEL.
 17271
 17272     GO TO 4100-APPLY-AH-CANCEL.
 17273
 17274 4100-LF-CANCEL-CONT.
 17275     IF PB-C-LF-CANCEL-VOIDED
 17276         GO TO 4100-APPLY-AH-CANCEL.
 17277
 17278     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17279         GO TO 4100-APPLY-AH-CANCEL.
 17280
 17281     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 313
* EL050.cbl
 17282        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17283           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17284        ELSE
 17285           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17286
 17287     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17288     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17289
 17290     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17291         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17292
 17293     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17294        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17295         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17296         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17297
 17298     IF PB-RECORD-RETURNED
 17299        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17300      ELSE
 17301        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17302
 17303 4100-APPLY-AH-CANCEL.
 17304
 17305     MOVE +0                      TO WS-SUB.
 17306
 17307 4100-CHECK-AH-ERRORS.
 17308
 17309     ADD +1                       TO WS-SUB.
 17310
 17311     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17312        IF AH-COVERAGE-CANCELLED
 17313           GO TO 4100-AH-CANCEL-CONT
 17314        ELSE
 17315           GO TO 4100-UPDATE-AH-COVERAGE.
 17316
 17317     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17318                                   ER-2729 OR
 17319                                   ER-2732 OR
 17320                                   ER-2737 OR
 17321                                   ER-2740 OR
 17322                                   ER-2744 OR
 17323                                   ER-2749 OR
 17324                                   ER-2750 OR
 17325                                   ER-2778 OR
 17326                                   ER-2757 OR
 17327                                   ER-2760 OR
 17328                                   ER-2771 OR
 17329                                   ER-2772 OR
 17330                                   ER-2773 OR
 17331                                   ER-2775 OR
 17332                                   ER-2777 OR
 17333                                   ER-2794
 17334        GO TO 4100-UPDATE-AH-COVERAGE.
 17335
 17336     GO TO 4100-CHECK-AH-ERRORS.
 17337
 17338 4100-UPDATE-AH-COVERAGE.
 17339
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 314
* EL050.cbl
 17340     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17341     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17342     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17343     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17344                                      TO CM-CREDIT-INTERFACE-SW-2.
 17345     IF CM-AH-CANCEL-DT = LOW-VALUE
 17346         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17347
 17348     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17349         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17350                                         CM-AH-STATUS-AT-CANCEL.
 17351
 17352     IF LF-COVERAGE-CANCELLED
 17353         IF PB-RECORD-RETURNED
 17354              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17355          ELSE
 17356              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17357
 17358     GO TO 4299-EXIT.
 17359
 17360 4100-AH-CANCEL-CONT.
 17361     IF PB-C-AH-CANCEL-VOIDED
 17362         GO TO 4299-EXIT.
 17363
 17364     if cm-credit-interface-sw-2 = ' '
 17365        if pb-fatal-errors or pb-unforced-errors
 17366           move '4'              to cm-credit-interface-sw-2
 17367        else
 17368           move '1'              to cm-credit-interface-sw-2
 17369        end-if
 17370     end-if
 17371     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17372         GO TO 4299-EXIT.
 17373
 17374     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17375        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17376           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17377        ELSE
 17378           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17379
 17380     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17381     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17382
 17383     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17384         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17385
 17386     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17387         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17388         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17389
 17390     IF PB-RECORD-RETURNED
 17391        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17392      ELSE
 17393        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17394
 17395     GO TO 4299-EXIT.
 17396
 17397 4150-SUMMARY-CERT-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 315
* EL050.cbl
 17398     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17399
 17400     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17401        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17402                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17403     ELSE
 17404        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17405                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17406
 17407     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17408        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17409                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17410     ELSE
 17411        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17412                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17413
 17414     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17415        NEXT SENTENCE
 17416     ELSE
 17417        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17418
 17419     GO TO 4299-EXIT.
 17420
 17421 4200-REVERSE-LF-CANCEL.
 17422     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17423
 17424     IF CM-LF-CANCEL-APPLIED
 17425        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17426        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17427        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17428
 17429     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17430
 17431     IF PB-RECORD-RETURNED
 17432        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17433       ELSE
 17434        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17435
 17436 4200-REVERSE-LF-EXIT.
 17437       EXIT.
 17438
 17439 4200-REVERSE-AH-CANCEL.
 17440     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17441
 17442     IF CM-AH-CANCEL-APPLIED
 17443        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17444        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17445        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17446
 17447     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17448
 17449     IF PB-RECORD-RETURNED
 17450        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17451       ELSE
 17452        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17453
 17454 4200-REVERSE-AH-EXIT.
 17455       EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 316
* EL050.cbl
 17456
 17457 4299-EXIT.
 17458       EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 317
* EL050.cbl
 17460
 17461 4500-UPDATE-NEW-CERT.
 17462     IF CERT-WAS-FOUND
 17463         NEXT SENTENCE
 17464       ELSE
 17465         GO TO 4520-BUILD-NEW-KEY.
 17466
 17467     IF  CLASIC-CREATED-CERT
 17468         GO TO 4999-EXIT.
 17469
 17470     IF  CERT-WAS-CREATED-FOR-CLAIM
 17471         GO TO 4520-BUILD-NEW-KEY.
 17472
 17473     IF CERT-ADDED-BATCH
 17474        IF CM-RECORD-ID = 'CM'
 17475            GO TO 4999-EXIT.
 17476
 17477 4520-BUILD-NEW-KEY.
 17478* BUILD CONTROL PRIMARY
 17479
 17480     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17481                                       CM-COMPANY-CD-A1
 17482                                       CM-COMPANY-CD-A2
 17483                                       CM-COMPANY-CD-A4
 17484                                       CM-COMPANY-CD-A5.
 17485
 17486     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17487     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17488     MOVE PB-SV-STATE               TO CM-STATE.
 17489     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17490     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17491     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17492     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17493
 17494     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17495
 17496     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17497     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17498     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17499     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17500
 17501     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17502        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17503
 17504     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17505         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17506         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17507         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17508         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17509     ELSE
 17510         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17511
 17512     IF PB-COMPANY-ID   EQUAL  'CRI'
 17513         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17514         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17515         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17516         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17517         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 318
* EL050.cbl
 17518
 17519     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17520        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17521         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17522
 17523     IF PB-COMPANY-ID  = 'LBL'
 17524        IF PB-I-JOINT-COVERAGE
 17525            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17526                                           PB-I-MEMBER-NO
 17527            GO TO 4550-CONT-CERT-PROCESS.
 17528
 17529     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17530        NEXT SENTENCE
 17531     ELSE
 17532        GO TO 4540-BUILD-MEMBER-NO.
 17533
 17534******************************************************************
 17535*                                                                *
 17536*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17537*    FOR 'MON'.                                                  *
 17538*                                                                *
 17539******************************************************************
 17540
 17541     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17542     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17543     MOVE +1                     TO WS-SUB1
 17544                                    WS-SUB2.
 17545
 17546 4530-EDIT-MEMB-NAME.
 17547
 17548     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17549        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17550        ADD +1                       TO WS-SUB2.
 17551
 17552     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17553        ADD +1                       TO WS-SUB1
 17554        GO TO 4530-EDIT-MEMB-NAME.
 17555
 17556     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17557     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17558     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17559*    MOVE SPACE                      TO DC-OPTION-CODE.
 17560     SET  BIN-TO-GREG                TO TRUE.
 17561     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17562     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17563
 17564     GO TO 4550-CONT-CERT-PROCESS.
 17565
 17566******************************************************************
 17567*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17568******************************************************************
 17569
 17570 4540-BUILD-MEMBER-NO.
 17571
 17572     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17573         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17574         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17575         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 319
* EL050.cbl
 17576         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17577     ELSE
 17578         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17579
 17580     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17581        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17582         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17583
 17584 4550-CONT-CERT-PROCESS.
 17585
 17586*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17587*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17588*    ELSE
 17589*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17590
 17591     IF CERT-WAS-CREATED-FOR-CLAIM
 17592        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17593        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17594
 17595     IF CERT-AND-CLAIM-ONLINE
 17596        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17597        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17598
 17599     MOVE 'CM'                     TO CM-RECORD-ID.
 17600     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17601
 17602     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17603        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17604        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17605     ELSE
 17606        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17607        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17608
 17609     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17610     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17611     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17612     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17613     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17614     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17615     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17616                                      CM-LF-ITD-CANCEL-AMT
 17617                                      CM-LF-ITD-DEATH-AMT
 17618                                      CM-AH-ITD-AH-PMT
 17619                                      CM-AH-ITD-LUMP-PMT
 17620                                      CM-AH-ITD-CANCEL-AMT
 17621                                      CM-LF-NSP-PREMIUM-AMT
 17622                                      CM-AH-NSP-PREMIUM-AMT.
 17623*                                     CM-CLAIM-DEDUCT-WITHHELD
 17624*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17625     if pb-i-loan-apr = +99.9999
 17626        move zeros                 to cm-loan-apr
 17627     else
 17628        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17629     end-if
 17630     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17631     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17632     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17633     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 320
* EL050.cbl
 17634     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17635     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17636     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17637     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17638     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17639     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17640     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17641
 17642     IF PB-I-LIVES NOT NUMERIC
 17643         MOVE ZERO                 TO PB-I-LIVES.
 17644
 17645     IF PB-I-NUM-BILLED NOT NUMERIC
 17646         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17647
 17648     MOVE PB-I-LIVES               TO CM-LIVES.
 17649     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17650
 17651     IF PB-COMPANY-ID EQUAL  'DMD'
 17652         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17653         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17654
 17655     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17656     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17657     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17658     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17659     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17660     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17661
 17662     IF PB-I-LF-POLICY-FEE NUMERIC
 17663        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17664     ELSE
 17665        MOVE +0                    TO CM-LF-POLICY-FEE.
 17666
 17667     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17668        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17669        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17670     ELSE
 17671        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17672
 17673     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17674     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17675     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17676     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17677     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17678     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17679     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17680     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17681     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17682
 17683     IF PB-I-AH-POLICY-FEE NUMERIC
 17684        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17685     ELSE
 17686        MOVE +0                    TO CM-AH-POLICY-FEE.
 17687
 17688     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17689        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17690     ELSE
 17691        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 321
* EL050.cbl
 17692
 17693     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17694     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17695
 17696     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17697                                      CM-LF-DEATH-EXIT-DT
 17698                                      CM-AH-SETTLEMENT-EXIT-DT.
 17699
 17700*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17701*                       'TIH' OR 'OFL' OR 'FLA' OR
 17702*                       'TII' OR 'TMS' OR 'CRI' OR
 17703*                       'NCL'
 17704     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17705
 17706     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17707         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17708            MOVE '2'                TO CM-PREMIUM-TYPE.
 17709
 17710     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17711         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17712            MOVE '2'                TO CM-PREMIUM-TYPE.
 17713
 17714     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17715         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17716     ELSE
 17717         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17718         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17719
 17720     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17721     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17722     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17723     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17724     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17725     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17726     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17727     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17728
 17729     IF PB-NO-MONTHS-SKIPPED
 17730         MOVE SPACE                 TO CM-SKIP-CODE
 17731     ELSE
 17732         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17733
 17734     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17735     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17736                                       CM-LF-STATUS-AT-CANCEL.
 17737
 17738     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17739     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17740                                       CM-AH-STATUS-AT-CANCEL.
 17741
 17742     MOVE '1'                       TO CM-ENTRY-STATUS.
 17743
 17744     IF PB-REISSUED-CERT
 17745        MOVE '5'                    TO CM-ENTRY-STATUS.
 17746
 17747     IF PB-MONTHLY-CERT
 17748        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17749
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 322
* EL050.cbl
 17750     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17751     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17752     IF PB-POLICY-IS-DECLINED
 17753        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17754
 17755     IF PB-POLICY-IS-VOIDED
 17756        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17757
 17758     IF PB-NEEDS-UNDERWRITING
 17759        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17760
 17761     IF PB-REIN-ONLY-CERT
 17762        MOVE '9'                    TO CM-ENTRY-STATUS.
 17763
 17764     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17765         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17766     ELSE
 17767         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17768
 17769     IF PB-RECORD-RETURNED
 17770        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17771      ELSE
 17772        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17773
 17774     IF PB-I-MAIL-ADDRS-PRESENT
 17775        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17776
 17777     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17778                                       CM-ENTRY-DT.
 17779
 17780 4999-EXIT.
 17781     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 323
* EL050.cbl
 17783
 17784 5000-PROCESS-REPS.
 17785     MOVE ' '                    TO AGTC-MASTER-SW
 17786     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17787     MOVE CO-TYPE                TO AGTC-TYPE
 17788     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17789     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17790     IF (AGTC-MASTER-SW NOT = 'N')
 17791        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17792        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17793        PERFORM 8583-READ-ERAGTC-NEXT
 17794                                 THRU 8583-EXIT
 17795     END-IF
 17796     IF AGTC-MASTER-SW = 'N'
 17797        CONTINUE
 17798     ELSE
 17799        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17800           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17801              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17802              MOVE 'Y'           TO AGTC-MASTER-SW
 17803           END-IF
 17804        END-IF
 17805     END-IF
 17806     .
 17807 5000-EXIT.
 17808     EXIT.
 17809 6370-EDIT-INPUT-LF-CODE.
 17810     move ' ' to ws-benefit-cd-chg-sw
 17811     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17812        MOVE +1                  TO SUB
 17813        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17814        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17815        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17816        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17817        GO TO 6370-SEARCH-LOOP.
 17818
 17819     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17820
 17821     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17822     MOVE SPACES                 TO CNTL-ACCESS.
 17823*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17824     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17825     MOVE +0                     TO CNTL-SEQ-NO.
 17826     MOVE '4' TO RC-SW-2.
 17827     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17828
 17829     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17830        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17831        GO TO 6370-NO-LF-FOUND.
 17832
 17833     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17834     MOVE +1                     TO SUB.
 17835
 17836 6370-SEARCH-LOOP.
 17837     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17838         GO TO 6370-NO-LF-FOUND.
 17839
 17840     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 324
* EL050.cbl
 17841        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17842           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17843           set benefit-code-chg to true
 17844        end-if
 17845        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17846        GO TO 6370-HER-NET-PAY-CHECK.
 17847
 17848     ADD 1   TO SUB.
 17849*    IF SUB GREATER 120
 17850     IF SUB GREATER 200
 17851         GO TO 6370-NO-LF-FOUND.
 17852
 17853     GO TO 6370-SEARCH-LOOP.
 17854
 17855 6370-NO-LF-FOUND.
 17856
 17857     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17858        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17859        set benefit-code-chg to true
 17860     end-if
 17861     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17862
 17863 6370-HER-NET-PAY-CHECK.
 17864
 17865     IF PB-COMPANY-ID = 'CID'
 17866        IF PB-SV-STATE = 'CA' OR 'MN'
 17867           IF PB-I-LF-BENEFIT-CD = '02'
 17868              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17869           ELSE
 17870              IF PB-I-LF-BENEFIT-CD = '04'
 17871                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17872              END-IF
 17873           END-IF
 17874        END-IF
 17875     END-IF
 17876
 17877     IF PB-COMPANY-ID NOT = 'HER'
 17878         GO TO 6370-EXIT.
 17879
 17880     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17881         GO TO 6370-EXIT.
 17882
 17883     IF PB-I-LF-TERM NOT NUMERIC
 17884         MOVE ZEROS              TO PB-I-LF-TERM.
 17885
 17886     IF PB-I-LOAN-TERM NOT NUMERIC
 17887         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17888
 17889     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17890         GO TO 6370-EXIT.
 17891
 17892     IF PB-I-LF-BENEFIT-CD = '33'
 17893         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17894
 17895     IF PB-I-LF-BENEFIT-CD = '34'
 17896         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17897
 17898 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 325
* EL050.cbl
 17899     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 326
* EL050.cbl
 17901
 17902 6380-EDIT-INPUT-AH-CODE.
 17903     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17904        MOVE +1                  TO SUB
 17905        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17906        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17907        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17908        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17909        GO TO 6380-SEARCH-LOOP.
 17910
 17911     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17912
 17913     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17914     MOVE SPACES                 TO CNTL-ACCESS.
 17915     MOVE 'A'                    TO CNTL-REC-TYPE.
 17916*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17917     MOVE +0                     TO CNTL-SEQ-NO.
 17918     MOVE '5' TO RC-SW-2.
 17919     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17920
 17921     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17922        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17923        GO TO 6380-NO-AH-FOUND.
 17924
 17925     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17926     MOVE +1 TO SUB.
 17927
 17928 6380-SEARCH-LOOP.
 17929     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17930         GO TO 6380-NO-AH-FOUND.
 17931
 17932     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17933         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17934         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17935
 17936     ADD 1   TO SUB.
 17937     IF SUB GREATER THAN 96
 17938*    IF SUB GREATER THAN 300
 17939         GO TO 6380-NO-AH-FOUND.
 17940
 17941     GO TO 6380-SEARCH-LOOP.
 17942
 17943 6380-NO-AH-FOUND.
 17944
 17945     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17946
 17947     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17948         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17949     ELSE
 17950         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17951
 17952 6380-CSO-AH-ONLY-CHECKS.
 17953
 17954     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17955        NEXT SENTENCE
 17956      ELSE
 17957        GO TO 6380-EXIT.
 17958
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 327
* EL050.cbl
 17959     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17960         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17961
 17962
 17963     GO TO 6380-EXIT
 17964     .
 17965 6380-CSO-LIFE-WITH-AH-CHECKS.
 17966
 17967
 17968     .
 17969 6380-EXIT.
 17970     EXIT.
 17971
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 328
* EL050.cbl
 17973
 17974 6400-COMPUTE-EXTENSION-DAYS.
 17975
 17976******************************************************************
 17977*                                                                *
 17978*                   COMPUTE EXTENSION DAYS                       *
 17979*                                                                *
 17980*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17981*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17982*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17983*    THE EXTENSION DAYS.                                         *
 17984*                                                                *
 17985******************************************************************
 17986
 17987     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17988     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17989
 17990******************************************************************
 17991*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17992*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17993******************************************************************
 17994
 17995     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17996        COMPUTE WS-ODD-DAYS-OVER =
 17997               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17998     ELSE
 17999        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18000
 18001     IF WS-ODD-DAYS-OVER = ZEROS
 18002           GO TO 6499-EXIT
 18003     ELSE
 18004        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18005           IF WS-WDF-MONTH = 02
 18006              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18007              ADD 2       TO  WS-ODD-DAYS-OVER
 18008              GO TO 6499-EXIT
 18009           ELSE
 18010              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18011                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18012                 GO TO 6499-EXIT
 18013               ELSE
 18014                 GO TO 6499-EXIT
 18015        ELSE
 18016           GO TO 6499-EXIT.
 18017
 18018 6412-CHECK-TO-DAY.
 18019
 18020        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18021           IF WS-WDT-DAY = 28
 18022              ADD 2              TO WS-ODD-DAYS-OVER
 18023           ELSE
 18024              IF WS-WDT-DAY = 29
 18025                 ADD 1           TO WS-ODD-DAYS-OVER
 18026              ELSE
 18027                 NEXT SENTENCE
 18028        ELSE
 18029           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18030              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 329
* EL050.cbl
 18031
 18032     GO TO 6499-EXIT.
 18033
 18034
 18035 6415-CHECK-LEAP-YEAR.
 18036
 18037     IF DC-DAYS-IN-MONTH = 29
 18038        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18039
 18040 6415-EXIT.
 18041     EXIT.
 18042
 18043 6499-EXIT.
 18044      EXIT.
 18045
 18046 6500-END.
 18047     EXIT.
 18048
 18049
 18050******************************************************************
 18051************* PROCEDURE DIVISION FOR EL050 ***********************
 18052********************** ELC50PD END *******************************
 18053
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 330
* EL050.cbl
 18055
 18056**START***********************************************************
 18057*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18058*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18059******************************************************************
 18060*
 18061 6600-GET-STATE-MUNICIPAL-TAX.
 18062
 18063     IF PB-COMPANY-ID NOT = 'DMD'
 18064         GO TO 6640-EXIT.
 18065
 18066     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18067     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18068     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18069*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18070*
 18071***  Y2K PROJ 7744
 18072     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18073     SET BIN-TO-GREG          TO TRUE.
 18074     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18075
 18076     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18077
 18078     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18079     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18080
 18081
 18082* EXEC CICS HANDLE CONDITION
 18083*        INVREQ    (6610-START-BROWSE)
 18084*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18085*        NOTFND    (6630-END-OF-FILE)
 18086*    END-EXEC.
 18087*    MOVE '"$8JI                 ! # #00018069' TO DFHEIV0
 18088     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18089     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18090     MOVE X'2320233030303138303639' TO DFHEIV0(25:11)
 18091     CALL 'kxdfhei1' USING DFHEIV0
 18092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18093
 18094
 18095 6610-START-BROWSE.
 18096
 18097
 18098* EXEC CICS HANDLE CONDITION
 18099*        NOTFND    (6630-END-OF-FILE)
 18100*        DISABLED  (6630-ERRESS-PROBLEM)
 18101*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18102*        ENDFILE   (6630-END-OF-FILE)
 18103*    END-EXEC.
 18104*    MOVE '"$IcJ''                ! $ #00018077' TO DFHEIV0
 18105     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18107     MOVE X'2420233030303138303737' TO DFHEIV0(25:11)
 18108     CALL 'kxdfhei1' USING DFHEIV0
 18109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18110
 18111
 18112
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 331
* EL050.cbl
 18113* EXEC CICS STARTBR
 18114*        DATASET (FILE-ID-ERRESS)
 18115*        RIDFLD  (WS-ERRESS-KEY)
 18116*        GTEQ
 18117*    END-EXEC.
 18118     MOVE 0
 18119       TO DFHEIV11
 18120*    MOVE '&,         G          &   #00018084' TO DFHEIV0
 18121     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18122     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18123     MOVE X'2020233030303138303834' TO DFHEIV0(25:11)
 18124     CALL 'kxdfhei1' USING DFHEIV0,
 18125           FILE-ID-ERRESS,
 18126           WS-ERRESS-KEY,
 18127           DFHEIV99,
 18128           DFHEIV11,
 18129           DFHEIV99
 18130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18131
 18132
 18133 6620-READ-NEXT-ERRESS-MASTER.
 18134
 18135
 18136* EXEC CICS HANDLE CONDITION
 18137*        NOTFND    (6630-END-OF-FILE)
 18138*        ENDFILE   (6630-END-OF-FILE)
 18139*        DISABLED  (6630-ERRESS-PROBLEM)
 18140*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18141*    END-EXEC.
 18142*    MOVE '"$I''cJ                ! % #00018092' TO DFHEIV0
 18143     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18145     MOVE X'2520233030303138303932' TO DFHEIV0(25:11)
 18146     CALL 'kxdfhei1' USING DFHEIV0
 18147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18148
 18149
 18150
 18151* EXEC CICS READNEXT
 18152*        DATASET (FILE-ID-ERRESS)
 18153*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18154*        RIDFLD  (WS-ERRESS-KEY)
 18155*    END-EXEC.
 18156     MOVE LENGTH OF
 18157      RESIDENT-STATE-TAX-MASTER
 18158       TO DFHEIV12
 18159     MOVE 0
 18160       TO DFHEIV11
 18161*    MOVE '&.IL                  )   #00018099' TO DFHEIV0
 18162     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18163     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18164     MOVE X'2020233030303138303939' TO DFHEIV0(25:11)
 18165     CALL 'kxdfhei1' USING DFHEIV0,
 18166           FILE-ID-ERRESS,
 18167           RESIDENT-STATE-TAX-MASTER,
 18168           DFHEIV12,
 18169           WS-ERRESS-KEY,
 18170           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 332
* EL050.cbl
 18171           DFHEIV11,
 18172           DFHEIV99,
 18173           DFHEIV99
 18174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18175
 18176
 18177     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18178
 18179* EXEC CICS ENDBR
 18180*            DATASET (FILE-ID-ERRESS)
 18181*       END-EXEC
 18182     MOVE 0
 18183       TO DFHEIV11
 18184*    MOVE '&2                    $   #00018106' TO DFHEIV0
 18185     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18186     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18187     MOVE X'2020233030303138313036' TO DFHEIV0(25:11)
 18188     CALL 'kxdfhei1' USING DFHEIV0,
 18189           FILE-ID-ERRESS,
 18190           DFHEIV11,
 18191           DFHEIV99
 18192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18193        GO TO 6630-END-OF-FILE.
 18194
 18195     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18196        NEXT SENTENCE
 18197      ELSE
 18198        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18199
 18200*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18201*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18202*
 18203     MOVE +2                     TO WS-SUB1.
 18204
 18205     IF PB-ISSUE
 18206     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18207        MOVE +1                  TO WS-SUB1.
 18208
 18209     IF PB-CANCELLATION
 18210     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18211        MOVE +1                  TO WS-SUB1.
 18212*
 18213*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18214*
 18215***  Y2K PROJ 7744
 18216     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18217***  Y2K PROJ 7744
 18218
 18219*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18220* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18221* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18222
 18223     ADD 1                    TO WS-YEAR-YY.
 18224
 18225     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18226         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18227                              TO WS-RES-STATE-TAX
 18228         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 333
* EL050.cbl
 18229                              TO WS-RES-MUNI-TAX
 18230     ELSE
 18231         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18232                              TO WS-RES-STATE-TAX
 18233         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18234                              TO WS-RES-MUNI-TAX.
 18235
 18236*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18237
 18238     IF PB-CANCELLATION
 18239         GO TO 6640-CANCEL-TAX.
 18240
 18241     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18242         COMPUTE PB-I-STATE-TAX ROUNDED =
 18243                                   PB-I-LF-PREMIUM-AMT
 18244                                 * WS-RES-STATE-TAX
 18245         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18246                                   PB-I-LF-PREMIUM-AMT
 18247                                 * WS-RES-MUNI-TAX
 18248     ELSE
 18249     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18250         COMPUTE PB-I-STATE-TAX ROUNDED =
 18251                                   PB-I-AH-PREMIUM-AMT
 18252                                 * WS-RES-STATE-TAX
 18253         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18254                                   PB-I-AH-PREMIUM-AMT
 18255                                 * WS-RES-MUNI-TAX.
 18256
 18257
 18258* EXEC CICS ENDBR
 18259*         DATASET (FILE-ID-ERRESS)
 18260*    END-EXEC.
 18261     MOVE 0
 18262       TO DFHEIV11
 18263*    MOVE '&2                    $   #00018173' TO DFHEIV0
 18264     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18265     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18266     MOVE X'2020233030303138313733' TO DFHEIV0(25:11)
 18267     CALL 'kxdfhei1' USING DFHEIV0,
 18268           FILE-ID-ERRESS,
 18269           DFHEIV11,
 18270           DFHEIV99
 18271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18272
 18273
 18274     GO TO 6640-EXIT.
 18275
 18276 6640-CANCEL-TAX.
 18277     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18278
 18279     IF PB-C-LF-CANCEL-AMT > ZEROS
 18280         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18281                                   PB-C-LF-CANCEL-AMT
 18282                                 * WS-RES-STATE-TAX
 18283         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18284                                   PB-C-LF-CANCEL-AMT
 18285                                *  WS-RES-MUNI-TAX
 18286     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 334
* EL050.cbl
 18287     IF PB-C-AH-CANCEL-AMT > ZEROS
 18288         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18289                                   PB-C-AH-CANCEL-AMT
 18290                                 * WS-RES-STATE-TAX
 18291         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18292                                   PB-C-AH-CANCEL-AMT
 18293                                *  WS-RES-MUNI-TAX.
 18294
 18295
 18296* EXEC CICS ENDBR
 18297*         DATASET (FILE-ID-ERRESS)
 18298*    END-EXEC.
 18299     MOVE 0
 18300       TO DFHEIV11
 18301*    MOVE '&2                    $   #00018198' TO DFHEIV0
 18302     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18303     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18304     MOVE X'2020233030303138313938' TO DFHEIV0(25:11)
 18305     CALL 'kxdfhei1' USING DFHEIV0,
 18306           FILE-ID-ERRESS,
 18307           DFHEIV11,
 18308           DFHEIV99
 18309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18310
 18311
 18312     GO TO 6640-EXIT.
 18313
 18314 6630-END-OF-FILE.
 18315     MOVE ER-8002              TO WS-ERROR.
 18316     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18317
 18318     GO TO 6640-EXIT.
 18319
 18320 6630-ERRESS-PROBLEM.
 18321     MOVE ER-8044              TO WS-ERROR.
 18322     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18323
 18324 6640-EXIT.
 18325     EXIT.
 18326
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 335
* EL050.cbl
 18328 6650-GET-RES-STATE-COMM.
 18329
 18330     IF PB-COMPANY-ID NOT = 'DMD'
 18331         GO TO 6700-COMM-EXIT.
 18332
 18333     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18334     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18335     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18336     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18337     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18338     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18339     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18340
 18341*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18342*
 18343***  Y2K PROJ 7744
 18344     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18345     SET BIN-TO-GREG          TO TRUE.
 18346     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18347
 18348     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18349***  Y2K PROJ 7744
 18350
 18351     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18352
 18353
 18354* EXEC CICS HANDLE CONDITION
 18355*        INVREQ    (6660-START-BROWSE)
 18356*        DISABLED  (6690-ERRESC-PROBLEM)
 18357*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18358*        NOTFND    (6690-END-OF-FILE)
 18359*    END-EXEC.
 18360*    MOVE '"$8cJI                ! & #00018243' TO DFHEIV0
 18361     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18362     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18363     MOVE X'2620233030303138323433' TO DFHEIV0(25:11)
 18364     CALL 'kxdfhei1' USING DFHEIV0
 18365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18366
 18367
 18368
 18369* EXEC CICS RESETBR
 18370*        DATASET (FILE-ID-ERRESC)
 18371*        RIDFLD  (WS-ERRESC-KEY)
 18372*    END-EXEC.
 18373     MOVE 0
 18374       TO DFHEIV11
 18375*    MOVE '&4         G          &   #00018250' TO DFHEIV0
 18376     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18377     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18378     MOVE X'2020233030303138323530' TO DFHEIV0(25:11)
 18379     CALL 'kxdfhei1' USING DFHEIV0,
 18380           FILE-ID-ERRESC,
 18381           WS-ERRESC-KEY,
 18382           DFHEIV99,
 18383           DFHEIV11,
 18384           DFHEIV99
 18385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 336
* EL050.cbl
 18386
 18387
 18388 6660-START-BROWSE.
 18389
 18390
 18391* EXEC CICS HANDLE CONDITION
 18392*        NOTFND    (6690-END-OF-FILE)
 18393*        DISABLED  (6690-ERRESC-PROBLEM)
 18394*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18395*        ENDFILE   (6690-END-OF-FILE)
 18396*    END-EXEC.
 18397*    MOVE '"$IcJ''                ! '' #00018257' TO DFHEIV0
 18398     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18400     MOVE X'2720233030303138323537' TO DFHEIV0(25:11)
 18401     CALL 'kxdfhei1' USING DFHEIV0
 18402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18403
 18404
 18405
 18406* EXEC CICS STARTBR
 18407*        DATASET (FILE-ID-ERRESC)
 18408*        RIDFLD  (WS-ERRESC-KEY)
 18409*        GTEQ
 18410*    END-EXEC.
 18411     MOVE 0
 18412       TO DFHEIV11
 18413*    MOVE '&,         G          &   #00018264' TO DFHEIV0
 18414     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18415     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18416     MOVE X'2020233030303138323634' TO DFHEIV0(25:11)
 18417     CALL 'kxdfhei1' USING DFHEIV0,
 18418           FILE-ID-ERRESC,
 18419           WS-ERRESC-KEY,
 18420           DFHEIV99,
 18421           DFHEIV11,
 18422           DFHEIV99
 18423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18424
 18425
 18426     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18427
 18428 6670-READ-NEXT-ERRESC-MASTER.
 18429
 18430
 18431* EXEC CICS HANDLE CONDITION
 18432*        NOTFND    (6690-END-OF-FILE)
 18433*        DISABLED  (6690-ERRESC-PROBLEM)
 18434*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18435*        ENDFILE   (6690-END-OF-FILE)
 18436*    END-EXEC.
 18437*    MOVE '"$IcJ''                ! ( #00018274' TO DFHEIV0
 18438     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18440     MOVE X'2820233030303138323734' TO DFHEIV0(25:11)
 18441     CALL 'kxdfhei1' USING DFHEIV0
 18442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18443
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 337
* EL050.cbl
 18444
 18445
 18446* EXEC CICS READNEXT
 18447*        DATASET (FILE-ID-ERRESC)
 18448*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18449*        RIDFLD  (ERRESC-RECORD-KEY)
 18450*    END-EXEC.
 18451     MOVE LENGTH OF
 18452      ACCOUNT-RESIDENT-ST-COMMISSION
 18453       TO DFHEIV12
 18454     MOVE 0
 18455       TO DFHEIV11
 18456*    MOVE '&.IL                  )   #00018281' TO DFHEIV0
 18457     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18459     MOVE X'2020233030303138323831' TO DFHEIV0(25:11)
 18460     CALL 'kxdfhei1' USING DFHEIV0,
 18461           FILE-ID-ERRESC,
 18462           ACCOUNT-RESIDENT-ST-COMMISSION,
 18463           DFHEIV12,
 18464           ERRESC-RECORD-KEY,
 18465           DFHEIV99,
 18466           DFHEIV11,
 18467           DFHEIV99,
 18468           DFHEIV99
 18469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18470
 18471
 18472     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18473        NEXT SENTENCE
 18474     ELSE
 18475
 18476* EXEC CICS ENDBR
 18477*            DATASET (FILE-ID-ERRESC)
 18478*       END-EXEC
 18479     MOVE 0
 18480       TO DFHEIV11
 18481*    MOVE '&2                    $   #00018290' TO DFHEIV0
 18482     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18483     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18484     MOVE X'2020233030303138323930' TO DFHEIV0(25:11)
 18485     CALL 'kxdfhei1' USING DFHEIV0,
 18486           FILE-ID-ERRESC,
 18487           DFHEIV11,
 18488           DFHEIV99
 18489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18490        GO TO 6690-END-OF-FILE.
 18491
 18492     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18493
 18494* EXEC CICS ENDBR
 18495*            DATASET (FILE-ID-ERRESC)
 18496*       END-EXEC
 18497     MOVE 0
 18498       TO DFHEIV11
 18499*    MOVE '&2                    $   #00018296' TO DFHEIV0
 18500     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18501     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 338
* EL050.cbl
 18502     MOVE X'2020233030303138323936' TO DFHEIV0(25:11)
 18503     CALL 'kxdfhei1' USING DFHEIV0,
 18504           FILE-ID-ERRESC,
 18505           DFHEIV11,
 18506           DFHEIV99
 18507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18508        GO TO 6690-END-OF-FILE.
 18509
 18510     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18511        NEXT SENTENCE
 18512      ELSE
 18513        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18514
 18515* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18516*
 18517     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18518
 18519     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18520
 18521     IF WS-SUB1 > ZERO
 18522         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18523             PERFORM 6680-SET-COMMISSION
 18524         ELSE
 18525             PERFORM 6680-SET-TABLE-CODE.
 18526
 18527
 18528* EXEC CICS ENDBR
 18529*         DATASET (FILE-ID-ERRESC)
 18530*    END-EXEC.
 18531     MOVE 0
 18532       TO DFHEIV11
 18533*    MOVE '&2                    $   #00018318' TO DFHEIV0
 18534     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18535     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18536     MOVE X'2020233030303138333138' TO DFHEIV0(25:11)
 18537     CALL 'kxdfhei1' USING DFHEIV0,
 18538           FILE-ID-ERRESC,
 18539           DFHEIV11,
 18540           DFHEIV99
 18541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18542
 18543
 18544     GO TO 6700-COMM-EXIT.
 18545
 18546 6680-SET-TABLE-CODE.
 18547     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18548        MOVE ZEROS             TO WS-SUB1
 18549     ELSE
 18550* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18551* TO COMPUTE AH COMMISSION.
 18552        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18553        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18554        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18555        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18556        PERFORM 6680-READ-CTBL-TABLE
 18557        IF WS-CTBL-READ-SW NOT = 'Y'
 18558           MOVE ZEROS          TO WS-SUB1.
 18559
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 339
* EL050.cbl
 18560 6680-READ-CTBL-TABLE.
 18561*
 18562* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18563* TO COMPUTE LIFE COMMISSION
 18564
 18565     IF CTBL-SW = '0540'
 18566        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18567        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18568        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18569
 18570     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18571
 18572     IF CTBL-TABLE-FOUND
 18573        IF CTBL-SW = '0530'
 18574             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18575                                    * PB-I-AH-TERM
 18576             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18577             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18578        ELSE
 18579             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18580             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18581             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18582     ELSE
 18583        IF FIRST-TIME-THROUGH
 18584            GO TO 6680-READ-CTBL-TABLE
 18585        ELSE
 18586            MOVE ZEROS         TO WS-SUB1.
 18587
 18588 6680-SET-COMMISSION.
 18589     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18590           MOVE ZEROS          TO WS-SUB1
 18591       ELSE
 18592           MOVE RESC-COMMISSION-PER (WS-SUB)
 18593                               TO WS-COMMISSION
 18594           IF CTBL-SW = '0530'
 18595               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18596           ELSE
 18597               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18598
 18599 6680-SEARCH-CATEGORY.
 18600     ADD +1                   TO WS-SUB.
 18601     IF WS-SUB > +12
 18602         GO TO 6680-EXIT.
 18603
 18604     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18605          MOVE WS-SUB         TO WS-SUB1
 18606          GO TO 6680-EXIT.
 18607
 18608     GO TO 6680-SEARCH-CATEGORY.
 18609
 18610 6680-EXIT.
 18611     EXIT.
 18612
 18613 6690-END-OF-FILE.
 18614     GO TO 6700-COMM-EXIT.
 18615
 18616 6690-ERRESC-PROBLEM.
 18617      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 340
* EL050.cbl
 18618      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18619
 18620      GO TO 6700-COMM-EXIT.
 18621
 18622 6700-COMM-EXIT.
 18623     EXIT.
 18624
 18625 7000-GET-RATE.
 18626
 18627* EXEC CICS LINK
 18628*        PROGRAM    ('ELRATE')
 18629*        COMMAREA   (CALCULATION-PASS-AREA)
 18630*        LENGTH     (CP-COMM-LENGTH)
 18631*    END-EXEC.
 18632     MOVE 'ELRATE' TO DFHEIV1
 18633*    MOVE '."C                   (   #00018404' TO DFHEIV0
 18634     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18635     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18636     MOVE X'2020233030303138343034' TO DFHEIV0(25:11)
 18637     CALL 'kxdfhei1' USING DFHEIV0,
 18638           DFHEIV1,
 18639           CALCULATION-PASS-AREA,
 18640           CP-COMM-LENGTH,
 18641           DFHEIV99,
 18642           DFHEIV99,
 18643           DFHEIV99,
 18644           DFHEIV99
 18645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18646
 18647
 18648 7000-EXIT.
 18649     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 341
* EL050.cbl
 18651 7100-FIND-BENEFIT-IN-STATE.
 18652     MOVE 'N'                    TO BEN-SEARCH-SW.
 18653
 18654     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18655         VARYING SUB3 FROM 1 BY 1 UNTIL
 18656            ((SUB3 GREATER 50) OR
 18657              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18658               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18659
 18660     IF SUB3 NOT = 51
 18661         MOVE 'Y'                TO BEN-SEARCH-SW.
 18662
 18663     GO TO 7199-EXIT.
 18664
 18665 7100-BENEFIT-DUMMY.
 18666
 18667 7100-DUMMY-EXIT.
 18668     EXIT.
 18669
 18670 7199-EXIT.
 18671     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 342
* EL050.cbl
 18673 7200-FIND-BENEFIT.
 18674     MOVE 'N'                    TO BEN-SEARCH-SW.
 18675
 18676     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18677         VARYING SUB3 FROM 1 BY 1 UNTIL
 18678            ((SUB3 GREATER 8) OR
 18679            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18680
 18681     IF SUB3 NOT = 9
 18682         MOVE 'Y'                TO BEN-SEARCH-SW.
 18683
 18684     GO TO 7200-EXIT.
 18685
 18686 7200-BENEFIT-DUMMY.
 18687
 18688 7200-DUMMY-EXIT.
 18689     EXIT.
 18690
 18691 7200-EXIT.
 18692     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 343
* EL050.cbl
 18694 7250-LOOK-FOR-RESCINDED-CLAIM.
 18695     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18696                                    W-CL-COMP-CD.
 18697     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18698                                    W-CL-CERT-NO.
 18699
 18700
 18701* EXEC CICS HANDLE CONDITION
 18702*        NOTFND  (7250-CONTINUE)
 18703*        ENDFILE (7250-CONTINUE)
 18704*    END-EXEC.
 18705*    MOVE '"$I''                  ! ) #00018462' TO DFHEIV0
 18706     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18708     MOVE X'2920233030303138343632' TO DFHEIV0(25:11)
 18709     CALL 'kxdfhei1' USING DFHEIV0
 18710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18711
 18712
 18713
 18714* EXEC CICS IGNORE CONDITION
 18715*        DUPKEY
 18716*    END-EXEC.
 18717*    MOVE '"*$                   !   #00018467' TO DFHEIV0
 18718     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18720     MOVE X'2020233030303138343637' TO DFHEIV0(25:11)
 18721     CALL 'kxdfhei1' USING DFHEIV0
 18722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18723
 18724
 18725
 18726* EXEC CICS STARTBR
 18727*        DATASET   (CLMS-ID)
 18728*        RIDFLD    (ELMSTR-KEY)
 18729*        GENERIC   EQUAL
 18730*        KEYLENGTH (ELMSTR-LENGTH)
 18731*    END-EXEC.
 18732     MOVE 0
 18733       TO DFHEIV11
 18734*    MOVE '&,   KG    E          &   #00018471' TO DFHEIV0
 18735     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18736     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18737     MOVE X'2020233030303138343731' TO DFHEIV0(25:11)
 18738     CALL 'kxdfhei1' USING DFHEIV0,
 18739           CLMS-ID,
 18740           ELMSTR-KEY,
 18741           ELMSTR-LENGTH,
 18742           DFHEIV11,
 18743           DFHEIV99
 18744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18745
 18746
 18747     MOVE 'Y'                    TO W-BROWSE-SW.
 18748
 18749 7250-NEXT-CLAIM.
 18750
 18751
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 344
* EL050.cbl
 18752* EXEC CICS READNEXT
 18753*        DATASET   (CLMS-ID)
 18754*        RIDFLD    (ELMSTR-KEY)
 18755*        SET       (ADDRESS OF CLAIM-MASTER)
 18756*    END-EXEC.
 18757     MOVE 0
 18758       TO DFHEIV11
 18759*    MOVE '&.S                   )   #00018482' TO DFHEIV0
 18760     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18761     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18762     MOVE X'2020233030303138343832' TO DFHEIV0(25:11)
 18763     CALL 'kxdfhei1' USING DFHEIV0,
 18764           CLMS-ID,
 18765           DFHEIV20,
 18766           DFHEIV99,
 18767           ELMSTR-KEY,
 18768           DFHEIV99,
 18769           DFHEIV11,
 18770           DFHEIV99,
 18771           DFHEIV99
 18772     SET ADDRESS OF CLAIM-MASTER TO
 18773         DFHEIV20
 18774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18775
 18776
 18777     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18778        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18779         GO TO 7250-CONTINUE
 18780     END-IF.
 18781
 18782     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18783        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18784        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18785        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18786        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18787         GO TO 7250-NEXT-CLAIM
 18788     END-IF.
 18789
 18790     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18791        OR (CL-CLAIM-TYPE = 'I')
 18792        OR (CL-CLAIM-TYPE = 'G')
 18793          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18794              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18795              GO TO 7250-CONTINUE
 18796          END-IF
 18797     END-IF.
 18798
 18799     GO TO 7250-NEXT-CLAIM.
 18800
 18801 7250-CONTINUE.
 18802
 18803     IF W-BROWSE-SW = 'Y'
 18804
 18805* EXEC CICS ENDBR
 18806*            DATASET   (CLMS-ID)
 18807*        END-EXEC
 18808     MOVE 0
 18809       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 345
* EL050.cbl
 18810*    MOVE '&2                    $   #00018515' TO DFHEIV0
 18811     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18812     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18813     MOVE X'2020233030303138353135' TO DFHEIV0(25:11)
 18814     CALL 'kxdfhei1' USING DFHEIV0,
 18815           CLMS-ID,
 18816           DFHEIV11,
 18817           DFHEIV99
 18818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18819         MOVE 'N' TO W-BROWSE-SW
 18820     END-IF.
 18821
 18822 7250-EXIT.
 18823     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 346
* EL050.cbl
 18825 7300-CHECK-FOR-OPEN-CLMS.
 18826
 18827*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18828*    MOVE SPACES                 TO CNTL-ACCESS.
 18829*    MOVE '1'                    TO CNTL-REC-TYPE.
 18830*    MOVE +0                     TO CNTL-SEQ-NO.
 18831
 18832*    MOVE '3'                    TO RC-SW-1.
 18833*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18834
 18835*    IF NOT CF-COMPANY-MASTER
 18836*         PERFORM 0099-COMPANY-NOT-FOUND
 18837*         GO TO 7300-EXIT.
 18838
 18839     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18840                                    W-CL-COMP-CD.
 18841     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18842                                    W-CL-CERT-NO.
 18843
 18844
 18845* EXEC CICS HANDLE CONDITION
 18846*        NOTFND  (7300-CONTINUE)
 18847*        ENDFILE (7300-CONTINUE)
 18848*    END-EXEC.
 18849*    MOVE '"$I''                  ! * #00018543' TO DFHEIV0
 18850     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18852     MOVE X'2A20233030303138353433' TO DFHEIV0(25:11)
 18853     CALL 'kxdfhei1' USING DFHEIV0
 18854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18855
 18856
 18857
 18858* EXEC CICS IGNORE CONDITION
 18859*        DUPKEY
 18860*    END-EXEC.
 18861*    MOVE '"*$                   !   #00018548' TO DFHEIV0
 18862     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18864     MOVE X'2020233030303138353438' TO DFHEIV0(25:11)
 18865     CALL 'kxdfhei1' USING DFHEIV0
 18866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18867
 18868
 18869
 18870* EXEC CICS STARTBR
 18871*        DATASET   (CLMS-ID)
 18872*        RIDFLD    (ELMSTR-KEY)
 18873*        GENERIC   EQUAL
 18874*        KEYLENGTH (ELMSTR-LENGTH)
 18875*    END-EXEC.
 18876     MOVE 0
 18877       TO DFHEIV11
 18878*    MOVE '&,   KG    E          &   #00018552' TO DFHEIV0
 18879     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18880     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18881     MOVE X'2020233030303138353532' TO DFHEIV0(25:11)
 18882     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 347
* EL050.cbl
 18883           CLMS-ID,
 18884           ELMSTR-KEY,
 18885           ELMSTR-LENGTH,
 18886           DFHEIV11,
 18887           DFHEIV99
 18888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18889
 18890
 18891     MOVE 'Y'                    TO W-BROWSE-SW.
 18892
 18893 7300-NEXT-CLAIM.
 18894
 18895
 18896* EXEC CICS READNEXT
 18897*        DATASET   (CLMS-ID)
 18898*        RIDFLD    (ELMSTR-KEY)
 18899*        SET       (ADDRESS OF CLAIM-MASTER)
 18900*    END-EXEC.
 18901     MOVE 0
 18902       TO DFHEIV11
 18903*    MOVE '&.S                   )   #00018563' TO DFHEIV0
 18904     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18905     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18906     MOVE X'2020233030303138353633' TO DFHEIV0(25:11)
 18907     CALL 'kxdfhei1' USING DFHEIV0,
 18908           CLMS-ID,
 18909           DFHEIV20,
 18910           DFHEIV99,
 18911           ELMSTR-KEY,
 18912           DFHEIV99,
 18913           DFHEIV11,
 18914           DFHEIV99,
 18915           DFHEIV99
 18916     SET ADDRESS OF CLAIM-MASTER TO
 18917         DFHEIV20
 18918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18919
 18920
 18921     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18922        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18923         GO TO 7300-CONTINUE.
 18924
 18925     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18926        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18927        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18928        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18929        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18930         GO TO 7300-NEXT-CLAIM.
 18931
 18932*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18933     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18934        OR (CL-CLAIM-TYPE = 'I')
 18935        OR (CL-CLAIM-TYPE = 'G')
 18936        IF CLAIM-IS-OPEN
 18937           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18938             AND PB-C-AH-CANCEL-DT > SPACES
 18939              MOVE ER-2896        TO WS-ERROR
 18940              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 348
* EL050.cbl
 18941           END-IF
 18942           EVALUATE TRUE
 18943             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18944                 MOVE ER-2884      TO WS-ERROR
 18945             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 18946                 MOVE ER-2887      TO WS-ERROR
 18947             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18948                 MOVE ER-2886      TO WS-ERROR
 18949             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18950                 MOVE ER-2888      TO WS-ERROR
 18951             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18952                 MOVE ER-2885      TO WS-ERROR
 18953             WHEN OTHER
 18954                 MOVE ER-2768      TO WS-ERROR
 18955           END-EVALUATE
 18956           IF PB-C-AH-CANCEL-VOIDED OR
 18957              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18958                NOT AH-COVERAGE-CANCELLED)
 18959               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18960               MOVE ER-2768      TO WS-ERROR
 18961           END-IF
 18962           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18963           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18964              PB-FORCE-CODE NOT EQUAL '8'
 18965               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18966           END-IF
 18967           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18968           GO TO 7300-NEXT-CLAIM
 18969        ELSE
 18970           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18971*****THIS IS A RESCISSION OR REFORMATION
 18972              IF AH-COVERAGE-CANCELLED
 18973                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 18974                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 18975                    MOVE 1                   TO DC-ELAPSED-DAYS
 18976                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 18977                    SET BIN-PLUS-ELAPSED     TO TRUE
 18978                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 18979                    IF NO-CONVERSION-ERROR
 18980                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 18981                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 18982                          MOVE ER-2897 TO WS-ERROR
 18983                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18984                          GO TO 7300-NEXT-CLAIM
 18985                       END-IF
 18986                    END-IF
 18987                 ELSE
 18988                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 18989                     MOVE ER-2890 TO WS-ERROR
 18990                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18991                     GO TO 7300-NEXT-CLAIM
 18992                   END-IF
 18993                 END-IF
 18994              END-IF
 18995           ELSE
 18996              IF CL-DENIAL-TYPE = '1'  AND
 18997                 CL-TOTAL-PAID-AMT = 0
 18998                    GO TO 7300-NEXT-CLAIM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 349
* EL050.cbl
 18999              END-IF
 19000              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19001               AND PB-C-AH-CANCEL-DT > SPACES
 19002                 MOVE ER-2756        TO WS-ERROR
 19003                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19004                 GO TO 7300-NEXT-CLAIM
 19005              END-IF
 19006           END-IF
 19007        END-IF
 19008     ELSE
 19009*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19010        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19011           IF CLAIM-IS-OPEN
 19012              MOVE ER-2889      TO WS-ERROR
 19013              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19014              GO TO 7300-NEXT-CLAIM
 19015           ELSE
 19016              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19017*****THIS IS A RESCISSION OR REFORMATION
 19018                 IF (LF-COVERAGE-CANCELLED AND
 19019                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19020                       MOVE ER-2890 TO WS-ERROR
 19021                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19022                       GO TO 7300-NEXT-CLAIM
 19023                 END-IF
 19024              ELSE
 19025                 IF CL-DENIAL-TYPE = '1'  AND
 19026                    CL-TOTAL-PAID-AMT = 0
 19027                       GO TO 7300-NEXT-CLAIM
 19028                 END-IF
 19029                 IF (AH-COVERAGE-CANCELLED AND
 19030                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 19031                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 19032                    (LF-COVERAGE-CANCELLED AND
 19033                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 19034                     WS-ST-REFUND-CLAIM-FLAG = '4')
 19035                       MOVE ER-2965 TO WS-ERROR
 19036                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19037                       GO TO 7300-NEXT-CLAIM
 19038                 END-IF
 19039                 IF LF-COVERAGE-CANCELLED
 19040                  IF CL-TOTAL-PAID-AMT > 0
 19041                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19042                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19043                        MOVE ER-2891 TO WS-ERROR
 19044                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19045                        GO TO 7300-NEXT-CLAIM
 19046                      END-IF
 19047                    ELSE
 19048****only show this error if cert num matches exactly
 19049                      IF PB-CERT-NO = CL-CERT-NO
 19050                         MOVE ER-2892 TO WS-ERROR
 19051                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19052                         GO TO 7300-NEXT-CLAIM
 19053                      END-IF
 19054                    END-IF
 19055                  END-IF
 19056                 END-IF
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 350
* EL050.cbl
 19057              END-IF
 19058           END-IF
 19059        END-IF
 19060     END-IF
 19061
 19062     GO TO 7300-NEXT-CLAIM.
 19063
 19064 7300-CONTINUE.
 19065
 19066     IF W-BROWSE-SW = 'Y'
 19067
 19068* EXEC CICS ENDBR
 19069*            DATASET   (CLMS-ID)
 19070*        END-EXEC.
 19071     MOVE 0
 19072       TO DFHEIV11
 19073*    MOVE '&2                    $   #00018715' TO DFHEIV0
 19074     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19075     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19076     MOVE X'2020233030303138373135' TO DFHEIV0(25:11)
 19077     CALL 'kxdfhei1' USING DFHEIV0,
 19078           CLMS-ID,
 19079           DFHEIV11,
 19080           DFHEIV99
 19081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19082
 19083
 19084 7300-EXIT.
 19085     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 351
* EL050.cbl
 19087
 19088 7400-GET-REMAIN-TERM.
 19089
 19090* EXEC CICS LINK
 19091*        PROGRAM    ('ELRTRM')
 19092*        COMMAREA   (CALCULATION-PASS-AREA)
 19093*        LENGTH     (CP-COMM-LENGTH)
 19094*    END-EXEC.
 19095     MOVE 'ELRTRM' TO DFHEIV1
 19096*    MOVE '."C                   (   #00018724' TO DFHEIV0
 19097     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19099     MOVE X'2020233030303138373234' TO DFHEIV0(25:11)
 19100     CALL 'kxdfhei1' USING DFHEIV0,
 19101           DFHEIV1,
 19102           CALCULATION-PASS-AREA,
 19103           CP-COMM-LENGTH,
 19104           DFHEIV99,
 19105           DFHEIV99,
 19106           DFHEIV99,
 19107           DFHEIV99
 19108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19109
 19110
 19111 7400-EXIT.
 19112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 352
* EL050.cbl
 19114
 19115 7500-GET-REMAIN-AMOUNT.
 19116
 19117* EXEC CICS LINK
 19118*        PROGRAM    ('ELRAMT')
 19119*        COMMAREA   (CALCULATION-PASS-AREA)
 19120*        LENGTH     (CP-COMM-LENGTH)
 19121*    END-EXEC.
 19122     MOVE 'ELRAMT' TO DFHEIV1
 19123*    MOVE '."C                   (   #00018735' TO DFHEIV0
 19124     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19126     MOVE X'2020233030303138373335' TO DFHEIV0(25:11)
 19127     CALL 'kxdfhei1' USING DFHEIV0,
 19128           DFHEIV1,
 19129           CALCULATION-PASS-AREA,
 19130           CP-COMM-LENGTH,
 19131           DFHEIV99,
 19132           DFHEIV99,
 19133           DFHEIV99,
 19134           DFHEIV99
 19135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19136
 19137
 19138 7500-EXIT.
 19139     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 353
* EL050.cbl
 19141
 19142 7600-GET-REFUND.
 19143
 19144* EXEC CICS LINK
 19145*        PROGRAM    ('ELRFND')
 19146*        COMMAREA   (CALCULATION-PASS-AREA)
 19147*        LENGTH     (CP-COMM-LENGTH)
 19148*    END-EXEC.
 19149     MOVE 'ELRFND' TO DFHEIV1
 19150*    MOVE '."C                   (   #00018746' TO DFHEIV0
 19151     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19153     MOVE X'2020233030303138373436' TO DFHEIV0(25:11)
 19154     CALL 'kxdfhei1' USING DFHEIV0,
 19155           DFHEIV1,
 19156           CALCULATION-PASS-AREA,
 19157           CP-COMM-LENGTH,
 19158           DFHEIV99,
 19159           DFHEIV99,
 19160           DFHEIV99,
 19161           DFHEIV99
 19162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19163
 19164
 19165 7600-EXIT.
 19166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 354
* EL050.cbl
 19168 7700-CALL-DL1.
 19169
 19170* EXEC CICS LINK
 19171*        PROGRAM    ('DLO001')
 19172*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19173*        LENGTH     (DLO001-COMM-LENGTH)
 19174*    END-EXEC.
 19175     MOVE 'DLO001' TO DFHEIV1
 19176*    MOVE '."C                   (   #00018756' TO DFHEIV0
 19177     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19178     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19179     MOVE X'2020233030303138373536' TO DFHEIV0(25:11)
 19180     CALL 'kxdfhei1' USING DFHEIV0,
 19181           DFHEIV1,
 19182           WS-DLO-MASTER-POLICY-FORM,
 19183           DLO001-COMM-LENGTH,
 19184           DFHEIV99,
 19185           DFHEIV99,
 19186           DFHEIV99,
 19187           DFHEIV99
 19188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19189
 19190
 19191 7700-EXIT.
 19192     EXIT.
 19193
 19194 7710-CALL-DL2.
 19195
 19196* EXEC CICS LINK
 19197*        PROGRAM    ('DLO002')
 19198*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19199*        LENGTH     (DLO002-COMM-LENGTH)
 19200*    END-EXEC.
 19201     MOVE 'DLO002' TO DFHEIV1
 19202*    MOVE '."C                   (   #00018766' TO DFHEIV0
 19203     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19204     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19205     MOVE X'2020233030303138373636' TO DFHEIV0(25:11)
 19206     CALL 'kxdfhei1' USING DFHEIV0,
 19207           DFHEIV1,
 19208           WS-DLO-INTERNAL-POLICY-FORM,
 19209           DLO002-COMM-LENGTH,
 19210           DFHEIV99,
 19211           DFHEIV99,
 19212           DFHEIV99,
 19213           DFHEIV99
 19214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19215
 19216
 19217 7710-EXIT.
 19218     EXIT.
 19219
 19220 7720-CALL-DL3.
 19221
 19222* EXEC CICS LINK
 19223*        PROGRAM    ('DLO003')
 19224*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19225*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 355
* EL050.cbl
 19226*    END-EXEC.
 19227     MOVE 'DLO003' TO DFHEIV1
 19228*    MOVE '."C                   (   #00018776' TO DFHEIV0
 19229     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19231     MOVE X'2020233030303138373736' TO DFHEIV0(25:11)
 19232     CALL 'kxdfhei1' USING DFHEIV0,
 19233           DFHEIV1,
 19234           WS-DLO-VALID-BANK-ID,
 19235           DLO003-COMM-LENGTH,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99,
 19239           DFHEIV99
 19240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19241
 19242
 19243 7720-EXIT.
 19244     EXIT.
 19245
 19246 7730-CALL-DL7.
 19247
 19248* EXEC CICS LINK
 19249*        PROGRAM    ('DLO007')
 19250*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19251*        LENGTH     (DLO007-COMM-LENGTH)
 19252*    END-EXEC.
 19253     MOVE 'DLO007' TO DFHEIV1
 19254*    MOVE '."C                   (   #00018786' TO DFHEIV0
 19255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19257     MOVE X'2020233030303138373836' TO DFHEIV0(25:11)
 19258     CALL 'kxdfhei1' USING DFHEIV0,
 19259           DFHEIV1,
 19260           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19261           DLO007-COMM-LENGTH,
 19262           DFHEIV99,
 19263           DFHEIV99,
 19264           DFHEIV99,
 19265           DFHEIV99
 19266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19267
 19268
 19269 7730-EXIT.
 19270     EXIT.
 19271
 19272 7740-CALL-DL11.
 19273
 19274* EXEC CICS LINK
 19275*        PROGRAM    ('DLO011')
 19276*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19277*        LENGTH     (DLO011-COMM-LENGTH)
 19278*    END-EXEC.
 19279     MOVE 'DLO011' TO DFHEIV1
 19280*    MOVE '."C                   (   #00018796' TO DFHEIV0
 19281     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19283     MOVE X'2020233030303138373936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 356
* EL050.cbl
 19284     CALL 'kxdfhei1' USING DFHEIV0,
 19285           DFHEIV1,
 19286           WS-DLO-PREM-RATES-BEN-TYPE,
 19287           DLO011-COMM-LENGTH,
 19288           DFHEIV99,
 19289           DFHEIV99,
 19290           DFHEIV99,
 19291           DFHEIV99
 19292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19293
 19294
 19295 7740-EXIT.
 19296     EXIT.
 19297
 19298 7750-CALL-DL17.
 19299
 19300* EXEC CICS LINK
 19301*        PROGRAM    ('DLO017')
 19302*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19303*        LENGTH     (DLO017-COMM-LENGTH)
 19304*    END-EXEC.
 19305     MOVE 'DLO017' TO DFHEIV1
 19306*    MOVE '."C                   (   #00018806' TO DFHEIV0
 19307     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19309     MOVE X'2020233030303138383036' TO DFHEIV0(25:11)
 19310     CALL 'kxdfhei1' USING DFHEIV0,
 19311           DFHEIV1,
 19312           WS-DLO-VALID-RATE-CODE,
 19313           DLO017-COMM-LENGTH,
 19314           DFHEIV99,
 19315           DFHEIV99,
 19316           DFHEIV99,
 19317           DFHEIV99
 19318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19319
 19320
 19321 7750-EXIT.
 19322     EXIT.
 19323
 19324 7755-CALL-DL19.
 19325
 19326* EXEC CICS LINK
 19327*        PROGRAM    ('DLO019')
 19328*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19329*        LENGTH     (DLO019-COMM-LENGTH)
 19330*    END-EXEC.
 19331     MOVE 'DLO019' TO DFHEIV1
 19332*    MOVE '."C                   (   #00018816' TO DFHEIV0
 19333     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19335     MOVE X'2020233030303138383136' TO DFHEIV0(25:11)
 19336     CALL 'kxdfhei1' USING DFHEIV0,
 19337           DFHEIV1,
 19338           WS-DLO-ORIG-COV-CAT,
 19339           DLO019-COMM-LENGTH,
 19340           DFHEIV99,
 19341           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 357
* EL050.cbl
 19342           DFHEIV99,
 19343           DFHEIV99
 19344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19345
 19346
 19347 7755-EXIT.
 19348     EXIT.
 19349
 19350 7760-CALL-DL21.
 19351
 19352* EXEC CICS LINK
 19353*        PROGRAM    ('DLO021')
 19354*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19355*        LENGTH     (DLO021-COMM-LENGTH)
 19356*    END-EXEC.
 19357     MOVE 'DLO021' TO DFHEIV1
 19358*    MOVE '."C                   (   #00018826' TO DFHEIV0
 19359     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19361     MOVE X'2020233030303138383236' TO DFHEIV0(25:11)
 19362     CALL 'kxdfhei1' USING DFHEIV0,
 19363           DFHEIV1,
 19364           WS-DLO-VALID-LOAN-OFFICER,
 19365           DLO021-COMM-LENGTH,
 19366           DFHEIV99,
 19367           DFHEIV99,
 19368           DFHEIV99,
 19369           DFHEIV99
 19370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19371
 19372
 19373 7760-EXIT.
 19374     EXIT.
 19375
 19376 7770-CALL-DL22.
 19377
 19378* EXEC CICS LINK
 19379*        PROGRAM    ('DLO022')
 19380*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19381*        LENGTH     (DLO022-COMM-LENGTH)
 19382*    END-EXEC.
 19383     MOVE 'DLO022' TO DFHEIV1
 19384*    MOVE '."C                   (   #00018836' TO DFHEIV0
 19385     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19386     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19387     MOVE X'2020233030303138383336' TO DFHEIV0(25:11)
 19388     CALL 'kxdfhei1' USING DFHEIV0,
 19389           DFHEIV1,
 19390           WS-DLO-VALID-STATE-CODE,
 19391           DLO022-COMM-LENGTH,
 19392           DFHEIV99,
 19393           DFHEIV99,
 19394           DFHEIV99,
 19395           DFHEIV99
 19396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19397
 19398
 19399 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 358
* EL050.cbl
 19400     EXIT.
 19401
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 359
* EL050.cbl
 19403
 19404 7800-REWRITE-CERT.
 19405******************************************************************
 19406*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19407*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19408******************************************************************
 19409
 19410     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19411        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19412        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19413        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19414
 19415* EXEC CICS REWRITE
 19416*                  DATASET (CERT-ID)
 19417*                  FROM    (CERTIFICATE-MASTER)
 19418*              END-EXEC
 19419     MOVE LENGTH OF
 19420      CERTIFICATE-MASTER
 19421       TO DFHEIV11
 19422*    MOVE '&& L                  %   #00018857' TO DFHEIV0
 19423     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19424     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19425     MOVE X'2020233030303138383537' TO DFHEIV0(25:11)
 19426     CALL 'kxdfhei1' USING DFHEIV0,
 19427           CERT-ID,
 19428           CERTIFICATE-MASTER,
 19429           DFHEIV11,
 19430           DFHEIV99
 19431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19432        GO TO 7800-EXIT.
 19433
 19434       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19435       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19436
 19437 7800-EXIT.
 19438      EXIT.
 19439
 19440 7900-DELETE-CERT.
 19441
 19442* EXEC CICS DELETE
 19443*        DATASET (CERT-ID)
 19444*    END-EXEC.
 19445*    MOVE '&(                    &   #00018870' TO DFHEIV0
 19446     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19448     MOVE X'2020233030303138383730' TO DFHEIV0(25:11)
 19449     CALL 'kxdfhei1' USING DFHEIV0,
 19450           CERT-ID,
 19451           DFHEIV99,
 19452           DFHEIV99,
 19453           DFHEIV99,
 19454           DFHEIV99
 19455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19456
 19457
 19458 7900-EXIT.
 19459     EXIT.
 19460
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 360
* EL050.cbl
 19461 8000-WRITE-CERT.
 19462
 19463* EXEC CICS HANDLE CONDITION
 19464*        DUPKEY    (8000-FREE-MAIN)
 19465*    END-EXEC.
 19466*    MOVE '"$$                   ! + #00018878' TO DFHEIV0
 19467     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19469     MOVE X'2B20233030303138383738' TO DFHEIV0(25:11)
 19470     CALL 'kxdfhei1' USING DFHEIV0
 19471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19472
 19473
 19474
 19475* EXEC CICS WRITE
 19476*        DATASET     (CERT-ID)
 19477*        FROM        (CERTIFICATE-MASTER)
 19478*        RIDFLD      (ELCERT-KEY)
 19479*    END-EXEC.
 19480     MOVE LENGTH OF
 19481      CERTIFICATE-MASTER
 19482       TO DFHEIV11
 19483*    MOVE '&$ L                  ''   #00018882' TO DFHEIV0
 19484     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19485     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19486     MOVE X'2020233030303138383832' TO DFHEIV0(25:11)
 19487     CALL 'kxdfhei1' USING DFHEIV0,
 19488           CERT-ID,
 19489           CERTIFICATE-MASTER,
 19490           DFHEIV11,
 19491           ELCERT-KEY,
 19492           DFHEIV99,
 19493           DFHEIV99
 19494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19495
 19496
 19497 8000-FREE-MAIN.
 19498
 19499 8000-EXIT.
 19500      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 361
* EL050.cbl
 19502
 19503 8100-READ-ERPNDM.
 19504
 19505* EXEC CICS HANDLE CONDITION
 19506*         NOTFND     (8100-NOTFND)
 19507*         ENDFILE    (8100-NOTFND)
 19508*    END-EXEC.
 19509*    MOVE '"$I''                  ! , #00018895' TO DFHEIV0
 19510     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19512     MOVE X'2C20233030303138383935' TO DFHEIV0(25:11)
 19513     CALL 'kxdfhei1' USING DFHEIV0
 19514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19515
 19516
 19517     MOVE SPACES                 TO ERPNDM-FOUND.
 19518     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19519
 19520
 19521* EXEC CICS READ
 19522*         DATASET   (FILE-ERPNDM)
 19523*         RIDFLD    (PM-CONTROL-PRIMARY)
 19524*         INTO      (PENDING-MAILING-DATA)
 19525*    END-EXEC.
 19526     MOVE LENGTH OF
 19527      PENDING-MAILING-DATA
 19528       TO DFHEIV11
 19529*    MOVE '&"IL       E          (   #00018903' TO DFHEIV0
 19530     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19532     MOVE X'2020233030303138393033' TO DFHEIV0(25:11)
 19533     CALL 'kxdfhei1' USING DFHEIV0,
 19534           FILE-ERPNDM,
 19535           PENDING-MAILING-DATA,
 19536           DFHEIV11,
 19537           PM-CONTROL-PRIMARY,
 19538           DFHEIV99,
 19539           DFHEIV99,
 19540           DFHEIV99
 19541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19542
 19543
 19544     GO TO 8100-EXIT.
 19545
 19546 8100-NOTFND.
 19547
 19548     MOVE 'X'                    TO ERPNDM-FOUND.
 19549     MOVE ER-2694                TO WS-ERROR.
 19550     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19551     MOVE ER-2883                TO WS-ERROR
 19552     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19553     .
 19554 8100-EXIT.
 19555     EXIT.
 19556
 19557 8110-READ-ERMAIL.
 19558
 19559* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 362
* EL050.cbl
 19560*         NOTFND     (8110-NOTFND)
 19561*         ENDFILE    (8110-NOTFND)
 19562*    END-EXEC.
 19563*    MOVE '"$I''                  ! - #00018923' TO DFHEIV0
 19564     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19566     MOVE X'2D20233030303138393233' TO DFHEIV0(25:11)
 19567     CALL 'kxdfhei1' USING DFHEIV0
 19568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19569
 19570
 19571     MOVE SPACES                 TO ERMAIL-FOUND.
 19572     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19573     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19574     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19575     MOVE PB-SV-STATE            TO MA-STATE.
 19576
 19577
 19578* EXEC CICS READ
 19579*         UPDATE
 19580*         DATASET   (FILE-ERMAIL)
 19581*         RIDFLD    (MA-CONTROL-PRIMARY)
 19582*         INTO      (MAILING-DATA)
 19583*    END-EXEC.
 19584     MOVE LENGTH OF
 19585      MAILING-DATA
 19586       TO DFHEIV11
 19587*    MOVE '&"IL       EU         (   #00018934' TO DFHEIV0
 19588     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19589     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19590     MOVE X'2020233030303138393334' TO DFHEIV0(25:11)
 19591     CALL 'kxdfhei1' USING DFHEIV0,
 19592           FILE-ERMAIL,
 19593           MAILING-DATA,
 19594           DFHEIV11,
 19595           MA-CONTROL-PRIMARY,
 19596           DFHEIV99,
 19597           DFHEIV99,
 19598           DFHEIV99
 19599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19600
 19601
 19602     GO TO 8110-EXIT.
 19603
 19604 8110-NOTFND.
 19605     MOVE 'X'                    TO ERMAIL-FOUND.
 19606
 19607 8110-EXIT.
 19608     EXIT.
 19609
 19610 8120-REWRITE-ERMAIL.
 19611
 19612* EXEC CICS REWRITE
 19613*         DATASET    (FILE-ERMAIL)
 19614*         FROM       (MAILING-DATA)
 19615*    END-EXEC.
 19616     MOVE LENGTH OF
 19617      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 363
* EL050.cbl
 19618       TO DFHEIV11
 19619*    MOVE '&& L                  %   #00018950' TO DFHEIV0
 19620     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19621     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19622     MOVE X'2020233030303138393530' TO DFHEIV0(25:11)
 19623     CALL 'kxdfhei1' USING DFHEIV0,
 19624           FILE-ERMAIL,
 19625           MAILING-DATA,
 19626           DFHEIV11,
 19627           DFHEIV99
 19628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19629
 19630
 19631 8120-EXIT.
 19632     EXIT.
 19633
 19634 8130-WRITE-ERMAIL.
 19635
 19636* EXEC CICS HANDLE CONDITION
 19637*         DUPKEY   (8130-EXIT)
 19638*    END-EXEC.
 19639*    MOVE '"$$                   ! . #00018959' TO DFHEIV0
 19640     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19642     MOVE X'2E20233030303138393539' TO DFHEIV0(25:11)
 19643     CALL 'kxdfhei1' USING DFHEIV0
 19644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19645
 19646
 19647
 19648* EXEC CICS WRITE
 19649*         DATASET     (FILE-ERMAIL)
 19650*         RIDFLD      (MA-CONTROL-PRIMARY)
 19651*         FROM        (MAILING-DATA)
 19652*    END-EXEC.
 19653     MOVE LENGTH OF
 19654      MAILING-DATA
 19655       TO DFHEIV11
 19656*    MOVE '&$ L                  ''   #00018963' TO DFHEIV0
 19657     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19658     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19659     MOVE X'2020233030303138393633' TO DFHEIV0(25:11)
 19660     CALL 'kxdfhei1' USING DFHEIV0,
 19661           FILE-ERMAIL,
 19662           MAILING-DATA,
 19663           DFHEIV11,
 19664           MA-CONTROL-PRIMARY,
 19665           DFHEIV99,
 19666           DFHEIV99
 19667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19668
 19669
 19670 8130-EXIT.
 19671     EXIT.
 19672
 19673 8140-UNLOCK-ERMAIL.
 19674
 19675* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 364
* EL050.cbl
 19676*         DATASET   (FILE-ERMAIL)
 19677*    END-EXEC.
 19678*    MOVE '&*                    #   #00018973' TO DFHEIV0
 19679     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19680     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19681     MOVE X'2020233030303138393733' TO DFHEIV0(25:11)
 19682     CALL 'kxdfhei1' USING DFHEIV0,
 19683           FILE-ERMAIL,
 19684           DFHEIV99
 19685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19686
 19687
 19688 8140-EXIT.
 19689     EXIT.
 19690
 19691 8150-read-elcrtt.
 19692
 19693
 19694* EXEC CICS HANDLE CONDITION
 19695*        NOTFND   (8150-exit)
 19696*    END-EXEC
 19697*    MOVE '"$I                   ! / #00018982' TO DFHEIV0
 19698     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19700     MOVE X'2F20233030303138393832' TO DFHEIV0(25:11)
 19701     CALL 'kxdfhei1' USING DFHEIV0
 19702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19703
 19704     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19705     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19706
 19707
 19708* EXEC CICS READ
 19709*        DATASET  (CRTT-ID)
 19710*        RIDFLD   (WS-ELCRTT-KEY)
 19711*        INTO     (CERTIFICATE-TRAILERS)
 19712*    END-EXEC
 19713     MOVE LENGTH OF
 19714      CERTIFICATE-TRAILERS
 19715       TO DFHEIV11
 19716*    MOVE '&"IL       E          (   #00018989' TO DFHEIV0
 19717     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19718     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19719     MOVE X'2020233030303138393839' TO DFHEIV0(25:11)
 19720     CALL 'kxdfhei1' USING DFHEIV0,
 19721           CRTT-ID,
 19722           CERTIFICATE-TRAILERS,
 19723           DFHEIV11,
 19724           WS-ELCRTT-KEY,
 19725           DFHEIV99,
 19726           DFHEIV99,
 19727           DFHEIV99
 19728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19729
 19730     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19731     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19732
 19733     .
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 365
* EL050.cbl
 19734 8150-exit.
 19735     exit.
 19736 8180-UPDATE-VIN-NUMBER.
 19737
 19738* EXEC CICS HANDLE CONDITION
 19739*        NOTFND   (8180-NOTFND)
 19740*    END-EXEC.
 19741*    MOVE '"$I                   ! 0 #00019002' TO DFHEIV0
 19742     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19743     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19744     MOVE X'3020233030303139303032' TO DFHEIV0(25:11)
 19745     CALL 'kxdfhei1' USING DFHEIV0
 19746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19747
 19748
 19749     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19750     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19751
 19752
 19753* EXEC CICS READ
 19754*        UPDATE
 19755*        DATASET  (CRTT-ID)
 19756*        RIDFLD   (WS-ELCRTT-KEY)
 19757*        INTO     (CERTIFICATE-TRAILERS)
 19758*    END-EXEC.
 19759     MOVE LENGTH OF
 19760      CERTIFICATE-TRAILERS
 19761       TO DFHEIV11
 19762*    MOVE '&"IL       EU         (   #00019009' TO DFHEIV0
 19763     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19764     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19765     MOVE X'2020233030303139303039' TO DFHEIV0(25:11)
 19766     CALL 'kxdfhei1' USING DFHEIV0,
 19767           CRTT-ID,
 19768           CERTIFICATE-TRAILERS,
 19769           DFHEIV11,
 19770           WS-ELCRTT-KEY,
 19771           DFHEIV99,
 19772           DFHEIV99,
 19773           DFHEIV99
 19774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19775
 19776
 19777     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19778         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19779
 19780* EXEC CICS REWRITE
 19781*           DATASET  (CRTT-ID)
 19782*           FROM     (CERTIFICATE-TRAILERS)
 19783*        END-EXEC
 19784     MOVE LENGTH OF
 19785      CERTIFICATE-TRAILERS
 19786       TO DFHEIV11
 19787*    MOVE '&& L                  %   #00019018' TO DFHEIV0
 19788     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19789     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19790     MOVE X'2020233030303139303138' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 366
* EL050.cbl
 19792           CRTT-ID,
 19793           CERTIFICATE-TRAILERS,
 19794           DFHEIV11,
 19795           DFHEIV99
 19796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19797     ELSE
 19798
 19799* EXEC CICS UNLOCK
 19800*          DATASET  (CRTT-ID)
 19801*       END-EXEC
 19802*    MOVE '&*                    #   #00019023' TO DFHEIV0
 19803     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19804     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19805     MOVE X'2020233030303139303233' TO DFHEIV0(25:11)
 19806     CALL 'kxdfhei1' USING DFHEIV0,
 19807           CRTT-ID,
 19808           DFHEIV99
 19809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19810     END-IF.
 19811
 19812     GO TO 8180-EXIT.
 19813
 19814 8180-NOTFND.
 19815
 19816     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19817     MOVE 'CS'         TO CS-RECORD-ID.
 19818     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19819     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19820     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19821     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19822
 19823* EXEC CICS WRITE
 19824*       DATASET  (CRTT-ID)
 19825*       RIDFLD   (WS-ELCRTT-KEY)
 19826*       FROM     (CERTIFICATE-TRAILERS)
 19827*    END-EXEC.
 19828     MOVE LENGTH OF
 19829      CERTIFICATE-TRAILERS
 19830       TO DFHEIV11
 19831*    MOVE '&$ L                  ''   #00019038' TO DFHEIV0
 19832     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19833     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19834     MOVE X'2020233030303139303338' TO DFHEIV0(25:11)
 19835     CALL 'kxdfhei1' USING DFHEIV0,
 19836           CRTT-ID,
 19837           CERTIFICATE-TRAILERS,
 19838           DFHEIV11,
 19839           WS-ELCRTT-KEY,
 19840           DFHEIV99,
 19841           DFHEIV99
 19842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19843
 19844
 19845 8180-EXIT.
 19846     EXIT.
 19847
 19848 8190-UPDATE-REFUND-CLAIM-FLAG.
 19849
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 367
* EL050.cbl
 19850* EXEC CICS HANDLE CONDITION
 19851*        NOTFND   (8190-NOTFND)
 19852*    END-EXEC.
 19853*    MOVE '"$I                   ! 1 #00019048' TO DFHEIV0
 19854     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19856     MOVE X'3120233030303139303438' TO DFHEIV0(25:11)
 19857     CALL 'kxdfhei1' USING DFHEIV0
 19858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19859
 19860
 19861     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19862     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19863
 19864
 19865* EXEC CICS READ
 19866*        UPDATE
 19867*        DATASET  (CRTT-ID)
 19868*        RIDFLD   (WS-ELCRTT-KEY)
 19869*        INTO     (CERTIFICATE-TRAILERS)
 19870*    END-EXEC.
 19871     MOVE LENGTH OF
 19872      CERTIFICATE-TRAILERS
 19873       TO DFHEIV11
 19874*    MOVE '&"IL       EU         (   #00019055' TO DFHEIV0
 19875     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19876     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19877     MOVE X'2020233030303139303535' TO DFHEIV0(25:11)
 19878     CALL 'kxdfhei1' USING DFHEIV0,
 19879           CRTT-ID,
 19880           CERTIFICATE-TRAILERS,
 19881           DFHEIV11,
 19882           WS-ELCRTT-KEY,
 19883           DFHEIV99,
 19884           DFHEIV99,
 19885           DFHEIV99
 19886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19887
 19888
 19889     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19890
 19891* EXEC CICS REWRITE
 19892*       DATASET  (CRTT-ID)
 19893*       FROM     (CERTIFICATE-TRAILERS)
 19894*    END-EXEC.
 19895     MOVE LENGTH OF
 19896      CERTIFICATE-TRAILERS
 19897       TO DFHEIV11
 19898*    MOVE '&& L                  %   #00019063' TO DFHEIV0
 19899     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19900     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19901     MOVE X'2020233030303139303633' TO DFHEIV0(25:11)
 19902     CALL 'kxdfhei1' USING DFHEIV0,
 19903           CRTT-ID,
 19904           CERTIFICATE-TRAILERS,
 19905           DFHEIV11,
 19906           DFHEIV99
 19907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 368
* EL050.cbl
 19908
 19909
 19910     GO TO 8190-EXIT.
 19911
 19912 8190-NOTFND.
 19913
 19914     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19915     MOVE 'CS'         TO CS-RECORD-ID.
 19916     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19917     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19918     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19919     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19920
 19921* EXEC CICS WRITE
 19922*       DATASET  (CRTT-ID)
 19923*       RIDFLD   (WS-ELCRTT-KEY)
 19924*       FROM     (CERTIFICATE-TRAILERS)
 19925*    END-EXEC.
 19926     MOVE LENGTH OF
 19927      CERTIFICATE-TRAILERS
 19928       TO DFHEIV11
 19929*    MOVE '&$ L                  ''   #00019078' TO DFHEIV0
 19930     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19932     MOVE X'2020233030303139303738' TO DFHEIV0(25:11)
 19933     CALL 'kxdfhei1' USING DFHEIV0,
 19934           CRTT-ID,
 19935           CERTIFICATE-TRAILERS,
 19936           DFHEIV11,
 19937           WS-ELCRTT-KEY,
 19938           DFHEIV99,
 19939           DFHEIV99
 19940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19941
 19942
 19943 8190-EXIT.
 19944     EXIT.
 19945
 19946 8195-UPDATE-AGE-FLAGS.
 19947
 19948* EXEC CICS HANDLE CONDITION
 19949*        NOTFND   (8195-NOTFND)
 19950*    END-EXEC.
 19951*    MOVE '"$I                   ! 2 #00019088' TO DFHEIV0
 19952     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19954     MOVE X'3220233030303139303838' TO DFHEIV0(25:11)
 19955     CALL 'kxdfhei1' USING DFHEIV0
 19956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19957
 19958
 19959     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19960     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19961
 19962
 19963* EXEC CICS READ
 19964*        UPDATE
 19965*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 369
* EL050.cbl
 19966*        RIDFLD   (WS-ELCRTT-KEY)
 19967*        INTO     (CERTIFICATE-TRAILERS)
 19968*    END-EXEC.
 19969     MOVE LENGTH OF
 19970      CERTIFICATE-TRAILERS
 19971       TO DFHEIV11
 19972*    MOVE '&"IL       EU         (   #00019095' TO DFHEIV0
 19973     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19974     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19975     MOVE X'2020233030303139303935' TO DFHEIV0(25:11)
 19976     CALL 'kxdfhei1' USING DFHEIV0,
 19977           CRTT-ID,
 19978           CERTIFICATE-TRAILERS,
 19979           DFHEIV11,
 19980           WS-ELCRTT-KEY,
 19981           DFHEIV99,
 19982           DFHEIV99,
 19983           DFHEIV99
 19984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19985
 19986
 19987     IF WS-INS-AGE-SET = 'Y'
 19988        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19989     END-IF
 19990     IF WS-JNT-AGE-SET = 'Y'
 19991        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19992     END-IF
 19993
 19994
 19995* EXEC CICS REWRITE
 19996*       DATASET  (CRTT-ID)
 19997*       FROM     (CERTIFICATE-TRAILERS)
 19998*    END-EXEC.
 19999     MOVE LENGTH OF
 20000      CERTIFICATE-TRAILERS
 20001       TO DFHEIV11
 20002*    MOVE '&& L                  %   #00019109' TO DFHEIV0
 20003     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20004     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20005     MOVE X'2020233030303139313039' TO DFHEIV0(25:11)
 20006     CALL 'kxdfhei1' USING DFHEIV0,
 20007           CRTT-ID,
 20008           CERTIFICATE-TRAILERS,
 20009           DFHEIV11,
 20010           DFHEIV99
 20011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20012
 20013
 20014     GO TO 8195-EXIT.
 20015
 20016 8195-NOTFND.
 20017
 20018     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20019     MOVE 'CS'         TO CS-RECORD-ID.
 20020     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20021     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20022     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20023     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 370
* EL050.cbl
 20024     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20025
 20026* EXEC CICS WRITE
 20027*       DATASET  (CRTT-ID)
 20028*       RIDFLD   (WS-ELCRTT-KEY)
 20029*       FROM     (CERTIFICATE-TRAILERS)
 20030*    END-EXEC.
 20031     MOVE LENGTH OF
 20032      CERTIFICATE-TRAILERS
 20033       TO DFHEIV11
 20034*    MOVE '&$ L                  ''   #00019125' TO DFHEIV0
 20035     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20036     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20037     MOVE X'2020233030303139313235' TO DFHEIV0(25:11)
 20038     CALL 'kxdfhei1' USING DFHEIV0,
 20039           CRTT-ID,
 20040           CERTIFICATE-TRAILERS,
 20041           DFHEIV11,
 20042           WS-ELCRTT-KEY,
 20043           DFHEIV99,
 20044           DFHEIV99
 20045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20046
 20047
 20048 8195-EXIT.
 20049     EXIT.
 20050
 20051 8200-READ-REIN-TABLE.
 20052
 20053* EXEC CICS HANDLE CONDITION
 20054*         NOTFND   (8200-NOTFND)
 20055*    END-EXEC.
 20056*    MOVE '"$I                   ! 3 #00019135' TO DFHEIV0
 20057     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20059     MOVE X'3320233030303139313335' TO DFHEIV0(25:11)
 20060     CALL 'kxdfhei1' USING DFHEIV0
 20061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20062
 20063
 20064
 20065* EXEC CICS READ
 20066*        DATASET     (REIN-ID)
 20067*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20068*        RIDFLD      (ERREIN-KEY)
 20069*    END-EXEC.
 20070*    MOVE '&"S        E          (   #00019139' TO DFHEIV0
 20071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20073     MOVE X'2020233030303139313339' TO DFHEIV0(25:11)
 20074     CALL 'kxdfhei1' USING DFHEIV0,
 20075           REIN-ID,
 20076           DFHEIV20,
 20077           DFHEIV99,
 20078           ERREIN-KEY,
 20079           DFHEIV99,
 20080           DFHEIV99,
 20081           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 371
* EL050.cbl
 20082     SET ADDRESS OF REINSURANCE-RECORD TO
 20083         DFHEIV20
 20084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20085
 20086
 20087     GO TO 8200-EXIT.
 20088
 20089 8200-NOTFND.
 20090     MOVE 'N'             TO WS-REIN-READ-SW.
 20091
 20092 8200-EXIT.
 20093      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 372
* EL050.cbl
 20095
 20096 8300-READ-CTBL-TABLE.
 20097
 20098* EXEC CICS HANDLE CONDITION
 20099*        NOTFND    (8300-NOTFND)
 20100*        DISABLED  (8300-ERRESS-PROBLEM)
 20101*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20102*        ENDFILE   (8300-NOTFND)
 20103*    END-EXEC.
 20104*    MOVE '"$IcJ''                ! 4 #00019155' TO DFHEIV0
 20105     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20107     MOVE X'3420233030303139313535' TO DFHEIV0(25:11)
 20108     CALL 'kxdfhei1' USING DFHEIV0
 20109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20110
 20111
 20112
 20113* EXEC CICS READ
 20114*        DATASET     (CTBL-ID)
 20115*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20116*        RIDFLD      (ERCTBL-KEY)
 20117*    END-EXEC.
 20118*    MOVE '&"S        E          (   #00019162' TO DFHEIV0
 20119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20121     MOVE X'2020233030303139313632' TO DFHEIV0(25:11)
 20122     CALL 'kxdfhei1' USING DFHEIV0,
 20123           CTBL-ID,
 20124           DFHEIV20,
 20125           DFHEIV99,
 20126           ERCTBL-KEY,
 20127           DFHEIV99,
 20128           DFHEIV99,
 20129           DFHEIV99
 20130     SET ADDRESS OF COMM-TABLE-RECORD TO
 20131         DFHEIV20
 20132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20133
 20134
 20135     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20136
 20137     GO TO 8300-EXIT.
 20138
 20139 8300-NOTFND.
 20140
 20141     IF CTBL-SW = '0530'
 20142         MOVE 'AA'                     TO WS-AH-COMP-CD
 20143         MOVE '0550'                   TO CTBL-SW
 20144         MOVE '1'                      TO WS-CTBL-READ-SW
 20145         GO TO 8300-EXIT.
 20146
 20147     IF CTBL-SW = '0540'
 20148         MOVE 'AA'                     TO WS-LF-COMP-CD
 20149         MOVE '0550'                   TO CTBL-SW
 20150         MOVE '1'                      TO WS-CTBL-READ-SW
 20151         GO TO 8300-EXIT.
 20152
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 373
* EL050.cbl
 20153     IF CTBL-SW = '0550'
 20154         MOVE '2'                      TO WS-CTBL-READ-SW
 20155         GO TO 8300-EXIT.
 20156
 20157     GO TO 8300-EXIT.
 20158
 20159 8300-ERRESS-PROBLEM.
 20160
 20161      MOVE ER-8050              TO WS-ERROR.
 20162      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20163
 20164     GO TO 8300-EXIT.
 20165
 20166 8300-EXIT.
 20167      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 374
* EL050.cbl
 20169
 20170
 20171 8400-GETMAIN-ERFORM.
 20172
 20173
 20174* EXEC CICS   GETMAIN
 20175*        LENGTH  (500)
 20176*        SET     (ADDRESS OF FORM-MASTER)
 20177*    END-EXEC.
 20178     MOVE 500
 20179       TO DFHEIV11
 20180*    MOVE '," L                  $   #00019206' TO DFHEIV0
 20181     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20182     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20183     MOVE X'2020233030303139323036' TO DFHEIV0(25:11)
 20184     CALL 'kxdfhei1' USING DFHEIV0,
 20185           DFHEIV20,
 20186           DFHEIV11,
 20187           DFHEIV99
 20188     SET ADDRESS OF FORM-MASTER TO
 20189         DFHEIV20
 20190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20191
 20192
 20193     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20194
 20195 8400-EXIT.
 20196      EXIT.
 20197
 20198 8450-READ-FORM-MASTER.
 20199
 20200
 20201* EXEC CICS  HANDLE CONDITION
 20202*        NOTFND   (8450-FORM-NOT-FOUND)
 20203*        ENDFILE  (8450-FORM-NOT-FOUND)
 20204*    END-EXEC.
 20205*    MOVE '"$I''                  ! 5 #00019218' TO DFHEIV0
 20206     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20208     MOVE X'3520233030303139323138' TO DFHEIV0(25:11)
 20209     CALL 'kxdfhei1' USING DFHEIV0
 20210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20211
 20212
 20213
 20214* EXEC CICS   READ
 20215*        DATASET   (FORM-ID)
 20216*        RIDFLD    (ERFORM-KEY)
 20217*        INTO      (FORM-MASTER)
 20218*        GTEQ
 20219*    END-EXEC.
 20220     MOVE LENGTH OF
 20221      FORM-MASTER
 20222       TO DFHEIV11
 20223*    MOVE '&"IL       G          (   #00019223' TO DFHEIV0
 20224     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20225     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20226     MOVE X'2020233030303139323233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 375
* EL050.cbl
 20227     CALL 'kxdfhei1' USING DFHEIV0,
 20228           FORM-ID,
 20229           FORM-MASTER,
 20230           DFHEIV11,
 20231           ERFORM-KEY,
 20232           DFHEIV99,
 20233           DFHEIV99,
 20234           DFHEIV99
 20235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20236
 20237
 20238     MOVE  'Y'           TO  FORM-MASTER-SW.
 20239
 20240     GO TO  8450-EXIT.
 20241
 20242 8450-FORM-NOT-FOUND.
 20243
 20244     MOVE  'N'           TO  FORM-MASTER-SW.
 20245
 20246 8450-EXIT.
 20247      EXIT.
 20248
 20249 8500-DATE-CONVERT.
 20250
 20251* EXEC CICS LINK
 20252*        PROGRAM    ('ELDATCV')
 20253*        COMMAREA   (DATE-CONVERSION-DATA)
 20254*        LENGTH     (DC-COMM-LENGTH)
 20255*    END-EXEC.
 20256     MOVE 'ELDATCV' TO DFHEIV1
 20257*    MOVE '."C                   (   #00019242' TO DFHEIV0
 20258     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20259     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20260     MOVE X'2020233030303139323432' TO DFHEIV0(25:11)
 20261     CALL 'kxdfhei1' USING DFHEIV0,
 20262           DFHEIV1,
 20263           DATE-CONVERSION-DATA,
 20264           DC-COMM-LENGTH,
 20265           DFHEIV99,
 20266           DFHEIV99,
 20267           DFHEIV99,
 20268           DFHEIV99
 20269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20270
 20271
 20272 8500-EXIT.
 20273     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 376
* EL050.cbl
 20275
 20276 8555-RELOAD-CONTROL-FILE.
 20277     CONTINUE.
 20278
 20279 8555-EXIT.
 20280     EXIT.
 20281
 20282 8557-GETMAIN-ERPLAN.
 20283
 20284
 20285* EXEC CICS GETMAIN
 20286*        LENGTH    (840)
 20287*        SET       (ADDRESS OF PLAN-RECORDS)
 20288*    END-EXEC.
 20289     MOVE 840
 20290       TO DFHEIV11
 20291*    MOVE '," L                  $   #00019260' TO DFHEIV0
 20292     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20293     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20294     MOVE X'2020233030303139323630' TO DFHEIV0(25:11)
 20295     CALL 'kxdfhei1' USING DFHEIV0,
 20296           DFHEIV20,
 20297           DFHEIV11,
 20298           DFHEIV99
 20299     SET ADDRESS OF PLAN-RECORDS TO
 20300         DFHEIV20
 20301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20302
 20303
 20304     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20305
 20306 8557-EXIT.
 20307     EXIT.
 20308
 20309 8560-GETMAIN.
 20310
 20311* EXEC CICS GETMAIN
 20312*        LENGTH    (2000)
 20313*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20314*    END-EXEC.
 20315     MOVE 2000
 20316       TO DFHEIV11
 20317*    MOVE '," L                  $   #00019271' TO DFHEIV0
 20318     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20319     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20320     MOVE X'2020233030303139323731' TO DFHEIV0(25:11)
 20321     CALL 'kxdfhei1' USING DFHEIV0,
 20322           DFHEIV20,
 20323           DFHEIV11,
 20324           DFHEIV99
 20325     SET ADDRESS OF ACCOUNT-MASTER TO
 20326         DFHEIV20
 20327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20328
 20329
 20330     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20331
 20332 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 377
* EL050.cbl
 20333     EXIT.
 20334
 20335 8570-START-ACCOUNT-MASTER.
 20336
 20337* EXEC CICS HANDLE CONDITION
 20338*        NOTFND    (0199-ACCT-NOT-FOUND)
 20339*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20340*    END-EXEC.
 20341*    MOVE '"$I''                  ! 6 #00019282' TO DFHEIV0
 20342     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20343     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20344     MOVE X'3620233030303139323832' TO DFHEIV0(25:11)
 20345     CALL 'kxdfhei1' USING DFHEIV0
 20346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20347
 20348
 20349
 20350* EXEC CICS STARTBR
 20351*        DATASET    (ACCT-ID)
 20352*        RIDFLD     (ERACCT-KEY)
 20353*        GTEQ
 20354*    END-EXEC.
 20355     MOVE 0
 20356       TO DFHEIV11
 20357*    MOVE '&,         G          &   #00019287' TO DFHEIV0
 20358     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20359     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20360     MOVE X'2020233030303139323837' TO DFHEIV0(25:11)
 20361     CALL 'kxdfhei1' USING DFHEIV0,
 20362           ACCT-ID,
 20363           ERACCT-KEY,
 20364           DFHEIV99,
 20365           DFHEIV11,
 20366           DFHEIV99
 20367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20368
 20369
 20370 8570-EXIT.
 20371     EXIT.
 20372
 20373 8580-READ-ACCOUNT-MASTER.
 20374
 20375* EXEC CICS HANDLE CONDITION
 20376*        NOTFND    (0199-ACCT-NOT-FOUND)
 20377*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20378*    END-EXEC.
 20379*    MOVE '"$I''                  ! 7 #00019297' TO DFHEIV0
 20380     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20382     MOVE X'3720233030303139323937' TO DFHEIV0(25:11)
 20383     CALL 'kxdfhei1' USING DFHEIV0
 20384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20385
 20386
 20387
 20388* EXEC CICS READNEXT
 20389*        DATASET     (ACCT-ID)
 20390*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 378
* EL050.cbl
 20391*        RIDFLD      (ERACCT-KEY)
 20392*    END-EXEC.
 20393     MOVE LENGTH OF
 20394      ACCOUNT-MASTER
 20395       TO DFHEIV12
 20396     MOVE 0
 20397       TO DFHEIV11
 20398*    MOVE '&.IL                  )   #00019302' TO DFHEIV0
 20399     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20400     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20401     MOVE X'2020233030303139333032' TO DFHEIV0(25:11)
 20402     CALL 'kxdfhei1' USING DFHEIV0,
 20403           ACCT-ID,
 20404           ACCOUNT-MASTER,
 20405           DFHEIV12,
 20406           ERACCT-KEY,
 20407           DFHEIV99,
 20408           DFHEIV11,
 20409           DFHEIV99,
 20410           DFHEIV99
 20411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20412
 20413
 20414 8580-EXIT.
 20415     EXIT.
 20416
 20417 8582-READ-COMPENSATION-MASTER.
 20418
 20419* EXEC CICS HANDLE CONDITION
 20420*        NOTFND    (8582-COMP-NOT-FOUND)
 20421*        ENDFILE   (8582-COMP-NOT-FOUND)
 20422*    END-EXEC.
 20423*    MOVE '"$I''                  ! 8 #00019312' TO DFHEIV0
 20424     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20426     MOVE X'3820233030303139333132' TO DFHEIV0(25:11)
 20427     CALL 'kxdfhei1' USING DFHEIV0
 20428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20429
 20430
 20431
 20432* EXEC CICS READ
 20433*        DATASET     (COMP-ID)
 20434*        INTO        (COMPENSATION-MASTER)
 20435*        RIDFLD      (ERCOMP-KEY)
 20436*    END-EXEC.
 20437     MOVE LENGTH OF
 20438      COMPENSATION-MASTER
 20439       TO DFHEIV11
 20440*    MOVE '&"IL       E          (   #00019317' TO DFHEIV0
 20441     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20443     MOVE X'2020233030303139333137' TO DFHEIV0(25:11)
 20444     CALL 'kxdfhei1' USING DFHEIV0,
 20445           COMP-ID,
 20446           COMPENSATION-MASTER,
 20447           DFHEIV11,
 20448           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 379
* EL050.cbl
 20449           DFHEIV99,
 20450           DFHEIV99,
 20451           DFHEIV99
 20452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20453
 20454
 20455     MOVE 'Y'                    TO COMP-MASTER-SW
 20456
 20457     GO TO 8582-EXIT
 20458     .
 20459 8582-COMP-NOT-FOUND.
 20460
 20461     MOVE 'N'                    TO COMP-MASTER-SW.
 20462
 20463 8582-EXIT.
 20464     EXIT.
 20465
 20466 8583-READ-ERAGTC.
 20467
 20468* EXEC CICS HANDLE CONDITION
 20469*        NOTFND    (8583-AGTC-NOT-FOUND)
 20470*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20471*    END-EXEC.
 20472*    MOVE '"$I''                  ! 9 #00019335' TO DFHEIV0
 20473     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20475     MOVE X'3920233030303139333335' TO DFHEIV0(25:11)
 20476     CALL 'kxdfhei1' USING DFHEIV0
 20477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20478
 20479
 20480
 20481* EXEC CICS STARTBR
 20482*        DATASET    (AGTC-ID)
 20483*        RIDFLD     (ERAGTC-KEY)
 20484*        GTEQ
 20485*    END-EXEC.
 20486     MOVE 0
 20487       TO DFHEIV11
 20488*    MOVE '&,         G          &   #00019340' TO DFHEIV0
 20489     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20490     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20491     MOVE X'2020233030303139333430' TO DFHEIV0(25:11)
 20492     CALL 'kxdfhei1' USING DFHEIV0,
 20493           AGTC-ID,
 20494           ERAGTC-KEY,
 20495           DFHEIV99,
 20496           DFHEIV11,
 20497           DFHEIV99
 20498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20499
 20500
 20501 8583-READ-ERAGTC-NEXT.
 20502
 20503* EXEC CICS READNEXT
 20504*        DATASET     (AGTC-ID)
 20505*        INTO        (AGENT-COMMISSIONS)
 20506*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 380
* EL050.cbl
 20507*    END-EXEC.
 20508     MOVE LENGTH OF
 20509      AGENT-COMMISSIONS
 20510       TO DFHEIV12
 20511     MOVE 0
 20512       TO DFHEIV11
 20513*    MOVE '&.IL                  )   #00019347' TO DFHEIV0
 20514     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20515     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20516     MOVE X'2020233030303139333437' TO DFHEIV0(25:11)
 20517     CALL 'kxdfhei1' USING DFHEIV0,
 20518           AGTC-ID,
 20519           AGENT-COMMISSIONS,
 20520           DFHEIV12,
 20521           ERAGTC-KEY,
 20522           DFHEIV99,
 20523           DFHEIV11,
 20524           DFHEIV99,
 20525           DFHEIV99
 20526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20527
 20528
 20529*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20530
 20531     GO TO 8583-EXIT
 20532     .
 20533 8583-AGTC-NOT-FOUND.
 20534
 20535     MOVE 'N'                    TO AGTC-MASTER-SW.
 20536
 20537 8583-EXIT.
 20538     EXIT.
 20539
 20540 8584-READ-BANK-CROSS-REF.
 20541
 20542* EXEC CICS HANDLE CONDITION
 20543*        NOTFND    (8584-BXRF-NOT-FOUND)
 20544*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20545*    END-EXEC.
 20546*    MOVE '"$I''                  ! : #00019365' TO DFHEIV0
 20547     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20549     MOVE X'3A20233030303139333635' TO DFHEIV0(25:11)
 20550     CALL 'kxdfhei1' USING DFHEIV0
 20551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20552
 20553
 20554
 20555* EXEC CICS READ
 20556*        DATASET     (BXRF-ID)
 20557*        INTO        (BANK-CROSS-REFERENCE)
 20558*        RIDFLD      (ERBXRF-KEY)
 20559*        LENGTH      (BXRF-REC-LENGTH)
 20560*    END-EXEC.
 20561*    MOVE '&"IL       E          (   #00019370' TO DFHEIV0
 20562     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20564     MOVE X'2020233030303139333730' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 381
* EL050.cbl
 20565     CALL 'kxdfhei1' USING DFHEIV0,
 20566           BXRF-ID,
 20567           BANK-CROSS-REFERENCE,
 20568           BXRF-REC-LENGTH,
 20569           ERBXRF-KEY,
 20570           DFHEIV99,
 20571           DFHEIV99,
 20572           DFHEIV99
 20573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20574
 20575
 20576     MOVE 'Y'                    TO BXRF-MASTER-SW
 20577
 20578     GO TO 8584-EXIT
 20579     .
 20580 8584-BXRF-NOT-FOUND.
 20581
 20582     MOVE 'N'                    TO BXRF-MASTER-SW.
 20583
 20584 8584-EXIT.
 20585     EXIT.
 20586
 20587 8585-READ-PLAN-MASTER.
 20588
 20589
 20590* EXEC CICS HANDLE CONDITION
 20591*        NOTFND    (8585-PLAN-NOT-FOUND)
 20592*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20593*    END-EXEC.
 20594*    MOVE '"$I''                  ! ; #00019390' TO DFHEIV0
 20595     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20597     MOVE X'3B20233030303139333930' TO DFHEIV0(25:11)
 20598     CALL 'kxdfhei1' USING DFHEIV0
 20599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20600
 20601
 20602
 20603* EXEC CICS READ
 20604*        DATASET     (PLAN-ID)
 20605*        INTO        (PLAN-MASTER)
 20606*        RIDFLD      (ERPLAN-KEY)
 20607*    END-EXEC.
 20608     MOVE LENGTH OF
 20609      PLAN-MASTER
 20610       TO DFHEIV11
 20611*    MOVE '&"IL       E          (   #00019395' TO DFHEIV0
 20612     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20613     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20614     MOVE X'2020233030303139333935' TO DFHEIV0(25:11)
 20615     CALL 'kxdfhei1' USING DFHEIV0,
 20616           PLAN-ID,
 20617           PLAN-MASTER,
 20618           DFHEIV11,
 20619           ERPLAN-KEY,
 20620           DFHEIV99,
 20621           DFHEIV99,
 20622           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 382
* EL050.cbl
 20623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20624
 20625
 20626     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20627
 20628     GO TO 8585-EXIT.
 20629
 20630 8585-PLAN-NOT-FOUND.
 20631
 20632     MOVE 'N'                    TO PLAN-MASTER-SW.
 20633
 20634 8585-EXIT.
 20635     EXIT.
 20636
 20637 8586-READ-LOAN-OFFICER.
 20638
 20639* EXEC CICS READ
 20640*        DATASET     (LOFC-ID)
 20641*        INTO        (LOAN-OFFICER-MASTER)
 20642*        RIDFLD      (ERLOFC-KEY)
 20643*        RESP        (WS-RESPONSE)
 20644*    END-EXEC
 20645     MOVE LENGTH OF
 20646      LOAN-OFFICER-MASTER
 20647       TO DFHEIV11
 20648*    MOVE '&"IL       E          (  N#00019413' TO DFHEIV0
 20649     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20651     MOVE X'204E233030303139343133' TO DFHEIV0(25:11)
 20652     CALL 'kxdfhei1' USING DFHEIV0,
 20653           LOFC-ID,
 20654           LOAN-OFFICER-MASTER,
 20655           DFHEIV11,
 20656           ERLOFC-KEY,
 20657           DFHEIV99,
 20658           DFHEIV99,
 20659           DFHEIV99
 20660     MOVE EIBRESP  TO WS-RESPONSE
 20661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20662
 20663     IF WS-RESP-NORMAL
 20664        MOVE 'Y'                 TO LOFC-MASTER-SW
 20665     ELSE
 20666        MOVE 'N'                 TO LOFC-MASTER-SW
 20667     END-IF
 20668     .
 20669 8586-EXIT.
 20670     EXIT.
 20671 8587-START-ERPDEF.
 20672
 20673* EXEC CICS STARTBR
 20674*       DATASET   (PDEF-ID)
 20675*       RIDFLD    (ERPDEF-KEY)
 20676*       GTEQ
 20677*       RESP      (WS-RESPONSE)
 20678*    END-EXEC
 20679     MOVE 0
 20680       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 383
* EL050.cbl
 20681*    MOVE '&,         G          &  N#00019429' TO DFHEIV0
 20682     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20683     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20684     MOVE X'204E233030303139343239' TO DFHEIV0(25:11)
 20685     CALL 'kxdfhei1' USING DFHEIV0,
 20686           PDEF-ID,
 20687           ERPDEF-KEY,
 20688           DFHEIV99,
 20689           DFHEIV11,
 20690           DFHEIV99
 20691     MOVE EIBRESP  TO WS-RESPONSE
 20692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20693     IF WS-RESP-NORMAL
 20694        MOVE 'Y'                 TO PDEF-MASTER-SW
 20695     ELSE
 20696        MOVE 'N'                 TO PDEF-MASTER-SW
 20697     END-IF
 20698     .
 20699 8587-EXIT.
 20700     EXIT.
 20701 8588-READ-ERPDEF.
 20702
 20703* EXEC CICS READNEXT
 20704*       DATASET   (PDEF-ID)
 20705*       RIDFLD    (ERPDEF-KEY)
 20706*       INTO      (PRODUCT-MASTER)
 20707*       RESP      (WS-RESPONSE)
 20708*    END-EXEC
 20709     MOVE LENGTH OF
 20710      PRODUCT-MASTER
 20711       TO DFHEIV12
 20712     MOVE 0
 20713       TO DFHEIV11
 20714*    MOVE '&.IL                  )  N#00019444' TO DFHEIV0
 20715     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20716     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20717     MOVE X'204E233030303139343434' TO DFHEIV0(25:11)
 20718     CALL 'kxdfhei1' USING DFHEIV0,
 20719           PDEF-ID,
 20720           PRODUCT-MASTER,
 20721           DFHEIV12,
 20722           ERPDEF-KEY,
 20723           DFHEIV99,
 20724           DFHEIV11,
 20725           DFHEIV99,
 20726           DFHEIV99
 20727     MOVE EIBRESP  TO WS-RESPONSE
 20728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20729     IF WS-RESP-NORMAL
 20730        MOVE 'Y'                 TO PDEF-MASTER-SW
 20731     ELSE
 20732        MOVE 'N'                 TO PDEF-MASTER-SW
 20733     END-IF
 20734     .
 20735 8588-EXIT.
 20736     EXIT.
 20737 8589-ENDBR-ERPDEF.
 20738
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 384
* EL050.cbl
 20739* EXEC CICS ENDBR
 20740*       DATASET   (PDEF-ID)
 20741*    END-EXEC
 20742     MOVE 0
 20743       TO DFHEIV11
 20744*    MOVE '&2                    $   #00019459' TO DFHEIV0
 20745     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20746     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20747     MOVE X'2020233030303139343539' TO DFHEIV0(25:11)
 20748     CALL 'kxdfhei1' USING DFHEIV0,
 20749           PDEF-ID,
 20750           DFHEIV11,
 20751           DFHEIV99
 20752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20753     .
 20754 8589-EXIT.
 20755     EXIT.
 20756 8590-READ-CERT-MASTER.
 20757     IF PB-COMPANY-ID = 'UCL'
 20758         GO TO 8690-READ-CERT-MASTER-UCL.
 20759
 20760
 20761* EXEC CICS HANDLE CONDITION
 20762*         NOTFND    (0299-CERT-NOT-FOUND)
 20763*    END-EXEC.
 20764*    MOVE '"$I                   ! < #00019469' TO DFHEIV0
 20765     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20767     MOVE X'3C20233030303139343639' TO DFHEIV0(25:11)
 20768     CALL 'kxdfhei1' USING DFHEIV0
 20769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20770
 20771
 20772
 20773* EXEC CICS READ
 20774*        DATASET     (CERT-ID)
 20775*        INTO        (CERTIFICATE-MASTER)
 20776*        RIDFLD      (ELCERT-KEY)
 20777*        UPDATE
 20778*    END-EXEC.
 20779     MOVE LENGTH OF
 20780      CERTIFICATE-MASTER
 20781       TO DFHEIV11
 20782*    MOVE '&"IL       EU         (   #00019473' TO DFHEIV0
 20783     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20784     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20785     MOVE X'2020233030303139343733' TO DFHEIV0(25:11)
 20786     CALL 'kxdfhei1' USING DFHEIV0,
 20787           CERT-ID,
 20788           CERTIFICATE-MASTER,
 20789           DFHEIV11,
 20790           ELCERT-KEY,
 20791           DFHEIV99,
 20792           DFHEIV99,
 20793           DFHEIV99
 20794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20795
 20796
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 385
* EL050.cbl
 20797 8590-EXIT.
 20798     EXIT.
 20799
 20800 8690-READ-CERT-MASTER-UCL.
 20801
 20802* EXEC CICS HANDLE CONDITION
 20803*         NOTFND    (8700-READ-CERT-MASTER)
 20804*    END-EXEC.
 20805*    MOVE '"$I                   ! = #00019484' TO DFHEIV0
 20806     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20807     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20808     MOVE X'3D20233030303139343834' TO DFHEIV0(25:11)
 20809     CALL 'kxdfhei1' USING DFHEIV0
 20810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20811
 20812
 20813 8690-READ-CERT-CONT.
 20814
 20815* EXEC CICS READ
 20816*        DATASET     (CERT-ID)
 20817*        INTO        (CERTIFICATE-MASTER)
 20818*        RIDFLD      (ELCERT-KEY)
 20819*        UPDATE
 20820*    END-EXEC.
 20821     MOVE LENGTH OF
 20822      CERTIFICATE-MASTER
 20823       TO DFHEIV11
 20824*    MOVE '&"IL       EU         (   #00019489' TO DFHEIV0
 20825     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20826     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20827     MOVE X'2020233030303139343839' TO DFHEIV0(25:11)
 20828     CALL 'kxdfhei1' USING DFHEIV0,
 20829           CERT-ID,
 20830           CERTIFICATE-MASTER,
 20831           DFHEIV11,
 20832           ELCERT-KEY,
 20833           DFHEIV99,
 20834           DFHEIV99,
 20835           DFHEIV99
 20836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20837
 20838
 20839     GO TO 8590-EXIT.
 20840
 20841 8700-READ-CERT-MASTER.
 20842     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20843     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20844
 20845* EXEC CICS HANDLE CONDITION
 20846*         DUPKEY    (8720-COMP-ACCOUNTS)
 20847*         ENDFILE   (8730-END-BROWSE)
 20848*         NOTFND    (8740-NOT-FOUND)
 20849*    END-EXEC.
 20850*    MOVE '"$$''I                 ! > #00019501' TO DFHEIV0
 20851     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20853     MOVE X'3E20233030303139353031' TO DFHEIV0(25:11)
 20854     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 386
* EL050.cbl
 20855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20856
 20857
 20858
 20859* EXEC CICS STARTBR
 20860*        DATASET     ('ELCERT5')
 20861*        RIDFLD      (ELCERT2-KEY)
 20862*        EQUAL
 20863*    END-EXEC.
 20864     MOVE 'ELCERT5' TO DFHEIV1
 20865     MOVE 0
 20866       TO DFHEIV11
 20867*    MOVE '&,         E          &   #00019507' TO DFHEIV0
 20868     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20869     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20870     MOVE X'2020233030303139353037' TO DFHEIV0(25:11)
 20871     CALL 'kxdfhei1' USING DFHEIV0,
 20872           DFHEIV1,
 20873           ELCERT2-KEY,
 20874           DFHEIV99,
 20875           DFHEIV11,
 20876           DFHEIV99
 20877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20878
 20879
 20880 8710-READ-NEXT.
 20881
 20882* EXEC CICS READNEXT
 20883*        DATASET     ('ELCERT5')
 20884*        INTO        (CERTIFICATE-MASTER)
 20885*        RIDFLD      (ELCERT2-KEY)
 20886*    END-EXEC.
 20887     MOVE LENGTH OF
 20888      CERTIFICATE-MASTER
 20889       TO DFHEIV12
 20890     MOVE 'ELCERT5' TO DFHEIV1
 20891     MOVE 0
 20892       TO DFHEIV11
 20893*    MOVE '&.IL                  )   #00019514' TO DFHEIV0
 20894     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20895     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20896     MOVE X'2020233030303139353134' TO DFHEIV0(25:11)
 20897     CALL 'kxdfhei1' USING DFHEIV0,
 20898           DFHEIV1,
 20899           CERTIFICATE-MASTER,
 20900           DFHEIV12,
 20901           ELCERT2-KEY,
 20902           DFHEIV99,
 20903           DFHEIV11,
 20904           DFHEIV99,
 20905           DFHEIV99
 20906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20907
 20908
 20909 8720-COMP-ACCOUNTS.
 20910
 20911* EXEC CICS ENTER
 20912*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 387
* EL050.cbl
 20913*         FROM (PB-C-LAST-NAME)
 20914*    END-EXEC.
 20915     MOVE 001
 20916       TO DFHEIV11
 20917*    MOVE ':$F                   %   #00019521' TO DFHEIV0
 20918     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20919     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20920     MOVE X'2020233030303139353231' TO DFHEIV0(25:11)
 20921     CALL 'kxdfhei1' USING DFHEIV0,
 20922           DFHEIV11,
 20923           PB-C-LAST-NAME,
 20924           DFHEIV99,
 20925           DFHEIV99
 20926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20927
 20928
 20929
 20930* EXEC CICS ENTER
 20931*         TRACEID (002)
 20932*         FROM (CM-INSURED-LAST-NAME)
 20933*    END-EXEC.
 20934     MOVE 002
 20935       TO DFHEIV11
 20936*    MOVE ':$F                   %   #00019526' TO DFHEIV0
 20937     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20938     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20939     MOVE X'2020233030303139353236' TO DFHEIV0(25:11)
 20940     CALL 'kxdfhei1' USING DFHEIV0,
 20941           DFHEIV11,
 20942           CM-INSURED-LAST-NAME,
 20943           DFHEIV99,
 20944           DFHEIV99
 20945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20946
 20947
 20948     IF PB-CERT-NO NOT = CM-CERT-NO
 20949         GO TO 8730-END-BROWSE.
 20950
 20951     IF PB-ACCOUNT = CM-ACCOUNT
 20952         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20953             MOVE ER-2799        TO WS-ERROR
 20954             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20955             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20956             GO TO 8730-END-BROWSE.
 20957
 20958     GO TO 8710-READ-NEXT.
 20959
 20960 8730-END-BROWSE.
 20961
 20962* EXEC CICS ENDBR
 20963*         DATASET    ('ELCERT5')
 20964*    END-EXEC.
 20965     MOVE 'ELCERT5' TO DFHEIV1
 20966     MOVE 0
 20967       TO DFHEIV11
 20968*    MOVE '&2                    $   #00019544' TO DFHEIV0
 20969     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20970     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 388
* EL050.cbl
 20971     MOVE X'2020233030303139353434' TO DFHEIV0(25:11)
 20972     CALL 'kxdfhei1' USING DFHEIV0,
 20973           DFHEIV1,
 20974           DFHEIV11,
 20975           DFHEIV99
 20976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20977
 20978
 20979 8740-NOT-FOUND.
 20980     GO TO 0299-CERT-NOT-FOUND.
 20981
 20982 8750-START-ELSTAT.
 20983
 20984* EXEC CICS STARTBR
 20985*       DATASET   (STAT-ID)
 20986*       RIDFLD    (ELSTAT-KEY)
 20987*       GTEQ
 20988*       RESP      (WS-RESPONSE)
 20989*    END-EXEC
 20990     MOVE 0
 20991       TO DFHEIV11
 20992*    MOVE '&,         G          &  N#00019552' TO DFHEIV0
 20993     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20994     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20995     MOVE X'204E233030303139353532' TO DFHEIV0(25:11)
 20996     CALL 'kxdfhei1' USING DFHEIV0,
 20997           STAT-ID,
 20998           ELSTAT-KEY,
 20999           DFHEIV99,
 21000           DFHEIV11,
 21001           DFHEIV99
 21002     MOVE EIBRESP  TO WS-RESPONSE
 21003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21004     IF WS-RESP-NORMAL
 21005        MOVE 'Y'                 TO STAT-MASTER-SW
 21006     ELSE
 21007        MOVE 'N'                 TO STAT-MASTER-SW
 21008     END-IF
 21009     .
 21010 8750-EXIT.
 21011     EXIT.
 21012 8752-READ-ELSTAT.
 21013
 21014* EXEC CICS READNEXT
 21015*       DATASET   (STAT-ID)
 21016*       RIDFLD    (ELSTAT-KEY)
 21017*       INTO      (STATE-FILE)
 21018*       RESP      (WS-RESPONSE)
 21019*    END-EXEC
 21020     MOVE LENGTH OF
 21021      STATE-FILE
 21022       TO DFHEIV12
 21023     MOVE 0
 21024       TO DFHEIV11
 21025*    MOVE '&.IL                  )  N#00019567' TO DFHEIV0
 21026     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21027     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21028     MOVE X'204E233030303139353637' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 389
* EL050.cbl
 21029     CALL 'kxdfhei1' USING DFHEIV0,
 21030           STAT-ID,
 21031           STATE-FILE,
 21032           DFHEIV12,
 21033           ELSTAT-KEY,
 21034           DFHEIV99,
 21035           DFHEIV11,
 21036           DFHEIV99,
 21037           DFHEIV99
 21038     MOVE EIBRESP  TO WS-RESPONSE
 21039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21040     IF WS-RESP-NORMAL
 21041        MOVE 'Y'                 TO STAT-MASTER-SW
 21042     ELSE
 21043        MOVE 'N'                 TO STAT-MASTER-SW
 21044     END-IF
 21045     .
 21046 8752-EXIT.
 21047     EXIT.
 21048 8800-GET-COMP-RATE.
 21049     MOVE +1 TO IB.
 21050     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21051         ADD +9 TO IB
 21052         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21053             ADD +9 TO IB
 21054             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21055                MOVE ZEROS       TO WS-WK-RATE
 21056                GO TO 8800-EXIT.
 21057
 21058     IF PB-I-AGE GREATER CT-AGE (1)
 21059         ADD +3 TO IB
 21060         IF PB-I-AGE GREATER CT-AGE (2)
 21061             ADD +3 TO IB
 21062             IF PB-I-AGE GREATER CT-AGE (3)
 21063                MOVE ZEROS       TO WS-WK-RATE
 21064                GO TO 8800-EXIT.
 21065
 21066     IF WS-WORK-TERM GREATER CT-TRM (1)
 21067         ADD +1 TO IB
 21068         IF WS-WORK-TERM GREATER CT-TRM (2)
 21069             ADD +1 TO IB
 21070             IF WS-WORK-TERM GREATER CT-TRM (3)
 21071                MOVE ZEROS       TO WS-WK-RATE
 21072                GO TO 8800-EXIT.
 21073
 21074     IF CT-RT (IB) NOT NUMERIC
 21075         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21076         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21077         GO TO 8800-GET-COMP-RATE.
 21078
 21079     MOVE CT-RT (IB) TO WS-WK-RATE.
 21080
 21081 8800-EXIT.
 21082     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 390
* EL050.cbl
 21084 8900-ADDRESS-FILE.
 21085     IF ERACCT-FILE-ADDRESSED
 21086         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21087         GO TO 8900-ADDRESS-EXIT.
 21088
 21089     IF ELCNTL-FILE-ADDRESSED
 21090         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21091         GO TO 8900-ADDRESS-EXIT.
 21092
 21093     IF ERPLAN-FILE-ADDRESSED
 21094         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21095         GO TO 8900-ADDRESS-EXIT.
 21096
 21097     IF ERFORM-FILE-ADDRESSED
 21098         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21099         GO TO 8900-ADDRESS-EXIT.
 21100
 21101 8900-ADDRESS-EXIT.
 21102     EXIT.
 21103
 21104 9000-READ-CONTROL.
 21105
 21106* EXEC CICS HANDLE CONDITION
 21107*        NOTFND    (9000-NOTFND)
 21108*    END-EXEC.
 21109*    MOVE '"$I                   ! ? #00019638' TO DFHEIV0
 21110     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21112     MOVE X'3F20233030303139363338' TO DFHEIV0(25:11)
 21113     CALL 'kxdfhei1' USING DFHEIV0
 21114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21115
 21116
 21117
 21118* EXEC CICS READ
 21119*        DATASET     (CNTL-ID)
 21120*        SET         (ADDRESS OF CONTROL-FILE)
 21121*        RIDFLD      (ELCNTL-KEY)
 21122*        GTEQ
 21123*    END-EXEC.
 21124*    MOVE '&"S        G          (   #00019642' TO DFHEIV0
 21125     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21127     MOVE X'2020233030303139363432' TO DFHEIV0(25:11)
 21128     CALL 'kxdfhei1' USING DFHEIV0,
 21129           CNTL-ID,
 21130           DFHEIV20,
 21131           DFHEIV99,
 21132           ELCNTL-KEY,
 21133           DFHEIV99,
 21134           DFHEIV99,
 21135           DFHEIV99
 21136     SET ADDRESS OF CONTROL-FILE TO
 21137         DFHEIV20
 21138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21139
 21140
 21141     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 391
* EL050.cbl
 21142
 21143 9000-NOTFND.
 21144     IF RC-SW-1 = '1'
 21145        MOVE ER-2616              TO WS-ERROR
 21146        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21147        GO TO 9000-EXIT.
 21148
 21149     IF RC-SW-1 = '2'
 21150        MOVE ER-2602              TO WS-ERROR
 21151        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21152
 21153 9000-EXIT.
 21154      EXIT.
 21155
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 392
* EL050.cbl
 21157 9100-READ-CONTROL.
 21158
 21159* EXEC CICS HANDLE CONDITION
 21160*        NOTFND  (9100-NOTFND)
 21161*        ENDFILE (9100-NOTFND)
 21162*    END-EXEC.
 21163*    MOVE '"$I''                  ! @ #00019666' TO DFHEIV0
 21164     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21166     MOVE X'4020233030303139363636' TO DFHEIV0(25:11)
 21167     CALL 'kxdfhei1' USING DFHEIV0
 21168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21169
 21170
 21171
 21172* EXEC CICS READ
 21173*        DATASET     (CNTL-ID)
 21174*        INTO        (CONTROL-FILE)
 21175*        RIDFLD      (ELCNTL-KEY)
 21176*        GTEQ
 21177*    END-EXEC.
 21178     MOVE LENGTH OF
 21179      CONTROL-FILE
 21180       TO DFHEIV11
 21181*    MOVE '&"IL       G          (   #00019671' TO DFHEIV0
 21182     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21184     MOVE X'2020233030303139363731' TO DFHEIV0(25:11)
 21185     CALL 'kxdfhei1' USING DFHEIV0,
 21186           CNTL-ID,
 21187           CONTROL-FILE,
 21188           DFHEIV11,
 21189           ELCNTL-KEY,
 21190           DFHEIV99,
 21191           DFHEIV99,
 21192           DFHEIV99
 21193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21194
 21195
 21196     GO TO 9100-EXIT.
 21197
 21198 9100-NOTFND.
 21199     IF RC-SW-2 = '0'
 21200        MOVE '1'                  TO STATE-RECORD-ERROR
 21201        GO TO 9100-EXIT
 21202     END-IF
 21203     IF RC-SW-2 = '1'
 21204        MOVE '1'                  TO LF-BENEFIT-ERROR
 21205        MOVE ER-2604              TO WS-ERROR
 21206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21207        GO TO 9100-EXIT.
 21208
 21209     IF RC-SW-2 = '2'
 21210        MOVE '1'                  TO AH-BENEFIT-ERROR
 21211        MOVE ER-2605              TO WS-ERROR
 21212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21213        GO TO 9100-EXIT.
 21214
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 393
* EL050.cbl
 21215     IF RC-SW-2 = '3'
 21216         MOVE ER-2603           TO WS-ERROR
 21217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21218         GO TO 9100-EXIT.
 21219
 21220     IF RC-SW-2 = '4'
 21221         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21222         GO TO 9100-EXIT.
 21223
 21224     IF RC-SW-2 = '5'
 21225         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21226         IF WS-AH-INPUT-CD-1 = SPACE
 21227             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21228         ELSE
 21229             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21230
 21231 9100-EXIT.
 21232      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 394
* EL050.cbl
 21234 9200-CONTROL-GETMAIN.
 21235
 21236* EXEC CICS GETMAIN
 21237*         LENGTH   (750)
 21238*         SET      (ADDRESS OF CONTROL-FILE)
 21239*    END-EXEC.
 21240     MOVE 750
 21241       TO DFHEIV11
 21242*    MOVE '," L                  $   #00019717' TO DFHEIV0
 21243     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21244     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21245     MOVE X'2020233030303139373137' TO DFHEIV0(25:11)
 21246     CALL 'kxdfhei1' USING DFHEIV0,
 21247           DFHEIV20,
 21248           DFHEIV11,
 21249           DFHEIV99
 21250     SET ADDRESS OF CONTROL-FILE TO
 21251         DFHEIV20
 21252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21253
 21254
 21255     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21256
 21257 9200-EXIT.
 21258     EXIT.
 21259
 21260 9250-UNLOCK-RETURN.
 21261
 21262* EXEC CICS UNLOCK
 21263*        DATASET   (CERT-ID)
 21264*    END-EXEC.
 21265*    MOVE '&*                    #   #00019728' TO DFHEIV0
 21266     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21267     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21268     MOVE X'2020233030303139373238' TO DFHEIV0(25:11)
 21269     CALL 'kxdfhei1' USING DFHEIV0,
 21270           CERT-ID,
 21271           DFHEIV99
 21272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21273
 21274
 21275 9300-ABEND.
 21276     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21277
 21278
 21279* EXEC CICS LINK
 21280*        PROGRAM   ('EL004')
 21281*        COMMAREA  (WS-ERROR-LINE)
 21282*        LENGTH    (72)
 21283*    END-EXEC.
 21284     MOVE 'EL004' TO DFHEIV1
 21285     MOVE 72
 21286       TO DFHEIV11
 21287*    MOVE '."C                   (   #00019735' TO DFHEIV0
 21288     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21289     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21290     MOVE X'2020233030303139373335' TO DFHEIV0(25:11)
 21291     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 395
* EL050.cbl
 21292           DFHEIV1,
 21293           WS-ERROR-LINE,
 21294           DFHEIV11,
 21295           DFHEIV99,
 21296           DFHEIV99,
 21297           DFHEIV99,
 21298           DFHEIV99
 21299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21300
 21301
 21302     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21303
 21304
 21305* EXEC CICS ABEND
 21306*        ABCODE ('EL50')
 21307*    END-EXEC.
 21308     MOVE 'EL50' TO DFHEIV5
 21309*    MOVE '.,A                   "   #00019743' TO DFHEIV0
 21310     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21311     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21312     MOVE X'2020233030303139373433' TO DFHEIV0(25:11)
 21313     CALL 'kxdfhei1' USING DFHEIV0,
 21314           DFHEIV5
 21315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21316
 21317
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 396
* EL050.cbl
 21319
 21320******************************************************************
 21321*                                                                *
 21322*            E R R O R   F O R M A T   R O U T I N E             *
 21323*                                                                *
 21324******************************************************************
 21325
 21326 9900-ERROR-FORMAT.
 21327
 21328     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21329                    PB-COMMON-ERROR (2) OR
 21330                    PB-COMMON-ERROR (3) OR
 21331                    PB-COMMON-ERROR (4) OR
 21332                    PB-COMMON-ERROR (5) OR
 21333                    PB-COMMON-ERROR (6) OR
 21334                    PB-COMMON-ERROR (7) OR
 21335                    PB-COMMON-ERROR (8) OR
 21336                    PB-COMMON-ERROR (9) OR
 21337                    PB-COMMON-ERROR (10)
 21338        GO TO 9900-EXIT.
 21339
 21340     IF PB-NO-OF-ERRORS = +10
 21341        GO TO 9900-EXIT.
 21342
 21343     ADD +1  TO PB-NO-OF-ERRORS.
 21344     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21345                                       (PB-NO-OF-ERRORS).
 21346 9900-EXIT.
 21347     EXIT.
 21348
 21349 9990-RETURN.
 21350     IF BROWSE-STARTED
 21351
 21352* EXEC CICS ENDBR
 21353*            DATASET  (ACCT-ID)
 21354*       END-EXEC.
 21355     MOVE 0
 21356       TO DFHEIV11
 21357*    MOVE '&2                    $   #00019780' TO DFHEIV0
 21358     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21360     MOVE X'2020233030303139373830' TO DFHEIV0(25:11)
 21361     CALL 'kxdfhei1' USING DFHEIV0,
 21362           ACCT-ID,
 21363           DFHEIV11,
 21364           DFHEIV99
 21365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21366
 21367
 21368 9990-EXIT.
 21369     EXIT.
 21370
 21371
 21372****Check for CRTO record, add one if not found.
 21373 9991-CHECK-FOR-ELCRTO.
 21374
 21375* EXEC CICS HANDLE CONDITION
 21376*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 397
* EL050.cbl
 21377*         ENDFILE (9991-CRTO-NOT-FOUND)
 21378*     END-EXEC.
 21379*    MOVE '"$I''                  ! A #00019790' TO DFHEIV0
 21380     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21382     MOVE X'4120233030303139373930' TO DFHEIV0(25:11)
 21383     CALL 'kxdfhei1' USING DFHEIV0
 21384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21385
 21386     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21387     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21388     MOVE +0                     TO ELCRTO-SEQ-NO
 21389
 21390
 21391* EXEC CICS READ
 21392*       DATASET   ('ELCRTO')
 21393*       INTO      (ORIGINAL-CERTIFICATE)
 21394*       RIDFLD    (ELCRTO-KEY)
 21395*       GTEQ
 21396*       RESP      (WS-RESPONSE)
 21397*    END-EXEC
 21398     MOVE LENGTH OF
 21399      ORIGINAL-CERTIFICATE
 21400       TO DFHEIV11
 21401     MOVE 'ELCRTO' TO DFHEIV1
 21402*    MOVE '&"IL       G          (  N#00019798' TO DFHEIV0
 21403     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21405     MOVE X'204E233030303139373938' TO DFHEIV0(25:11)
 21406     CALL 'kxdfhei1' USING DFHEIV0,
 21407           DFHEIV1,
 21408           ORIGINAL-CERTIFICATE,
 21409           DFHEIV11,
 21410           ELCRTO-KEY,
 21411           DFHEIV99,
 21412           DFHEIV99,
 21413           DFHEIV99
 21414     MOVE EIBRESP  TO WS-RESPONSE
 21415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21416
 21417     IF WS-RESP-NORMAL
 21418        AND (OC-CONTROL-PRIMARY (1:33) =
 21419                 PB-CONTROL-BY-ACCOUNT (1:33))
 21420        AND (OC-RECORD-TYPE =  'I')
 21421           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21422               GO TO 9991-CHECK-INDICATORS
 21423           ELSE
 21424               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21425               GO TO 9991-CRTO-ADD-REC
 21426           END-IF
 21427     END-IF.
 21428
 21429 9991-CRTO-NOT-FOUND.
 21430
 21431     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21432     MOVE 'OC'                TO OC-RECORD-ID
 21433     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21434                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 398
* EL050.cbl
 21435     MOVE +4096               TO OC-KEY-SEQ-NO.
 21436
 21437 9991-CRTO-ADD-REC.
 21438
 21439     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21440     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21441     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21442     MOVE 'I'                 TO OC-RECORD-TYPE
 21443     IF PB-ISSUE
 21444         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21445         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21446         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21447         MOVE PB-I-AGE               TO OC-INS-AGE
 21448         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21449         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21450         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21451         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21452         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21453         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21454         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21455         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21456         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21457         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21458         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21459         IF PB-I-JOINT-COMMISSION > +0
 21460             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21461         ELSE
 21462             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21463         END-IF
 21464         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21465         MOVE +0                     TO OC-LF-CANCEL-AMT
 21466                                        OC-LF-ITD-CANCEL-AMT
 21467         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21468         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21469         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21470         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21471         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21472         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21473         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21474         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21475         MOVE +0                     TO OC-AH-CANCEL-AMT
 21476                                        OC-AH-ITD-CANCEL-AMT
 21477         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21478         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21479         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21480     ELSE
 21481         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21482         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21483         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21484         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21485         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21486         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21487         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21488         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21489         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21490          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21491             MOVE SPACES             TO OC-LF-BENCD
 21492             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 399
* EL050.cbl
 21493                                        OC-LF-BEN-AMT
 21494                                        OC-LF-PRM-AMT
 21495                                        OC-LF-ALT-BEN-AMT
 21496                                        OC-LF-ALT-PRM-AMT
 21497                                        OC-LF-COMM-PCT
 21498                                        OC-LF-CANCEL-AMT
 21499             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21500             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21501         ELSE
 21502             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21503             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21504             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21505             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21506             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21507             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21508             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21509             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21510             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21511             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21512         END-IF
 21513         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21514         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21515          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21516             MOVE SPACES             TO OC-AH-BENCD
 21517             MOVE ZEROS              TO OC-AH-TERM
 21518                                        OC-AH-BEN-AMT
 21519                                        OC-AH-PRM-AMT
 21520                                        OC-AH-COMM-PCT
 21521                                        OC-AH-CANCEL-AMT
 21522                                        OC-AH-CP
 21523             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21524             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21525         ELSE
 21526             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21527             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21528             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21529             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21530             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21531             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21532             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21533             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21534             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21535         END-IF
 21536         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21537         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21538         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21539         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21540     END-IF
 21541     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21542
 21543     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21544
 21545
 21546* EXEC CICS READ
 21547*         DATASET   (FILE-ERMAIL)
 21548*         RIDFLD    (MA-CONTROL-PRIMARY)
 21549*         INTO      (MAILING-DATA)
 21550*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 400
* EL050.cbl
 21551*    END-EXEC
 21552     MOVE LENGTH OF
 21553      MAILING-DATA
 21554       TO DFHEIV11
 21555*    MOVE '&"IL       E          (  N#00019934' TO DFHEIV0
 21556     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21557     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21558     MOVE X'204E233030303139393334' TO DFHEIV0(25:11)
 21559     CALL 'kxdfhei1' USING DFHEIV0,
 21560           FILE-ERMAIL,
 21561           MAILING-DATA,
 21562           DFHEIV11,
 21563           MA-CONTROL-PRIMARY,
 21564           DFHEIV99,
 21565           DFHEIV99,
 21566           DFHEIV99
 21567     MOVE EIBRESP  TO WS-RESPONSE
 21568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21569
 21570     IF WS-RESP-NORMAL
 21571         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21572     END-IF.
 21573
 21574     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21575     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21576
 21577
 21578* EXEC CICS READ
 21579*         DATASET  (CRTT-ID)
 21580*         RIDFLD   (WS-ELCRTT-KEY)
 21581*         INTO     (CERTIFICATE-TRAILERS)
 21582*         RESP     (WS-RESPONSE)
 21583*    END-EXEC
 21584     MOVE LENGTH OF
 21585      CERTIFICATE-TRAILERS
 21586       TO DFHEIV11
 21587*    MOVE '&"IL       E          (  N#00019948' TO DFHEIV0
 21588     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21590     MOVE X'204E233030303139393438' TO DFHEIV0(25:11)
 21591     CALL 'kxdfhei1' USING DFHEIV0,
 21592           CRTT-ID,
 21593           CERTIFICATE-TRAILERS,
 21594           DFHEIV11,
 21595           WS-ELCRTT-KEY,
 21596           DFHEIV99,
 21597           DFHEIV99,
 21598           DFHEIV99
 21599     MOVE EIBRESP  TO WS-RESPONSE
 21600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21601
 21602     IF WS-RESP-NORMAL
 21603         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21604         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21605     END-IF.
 21606
 21607
 21608* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 401
* EL050.cbl
 21609*       DATASET   ('ELCRTO')
 21610*       FROM      (ORIGINAL-CERTIFICATE)
 21611*       RIDFLD    (OC-CONTROL-PRIMARY)
 21612*       RESP      (WS-RESPONSE)
 21613*    END-EXEC.
 21614     MOVE LENGTH OF
 21615      ORIGINAL-CERTIFICATE
 21616       TO DFHEIV11
 21617     MOVE 'ELCRTO' TO DFHEIV1
 21618*    MOVE '&$ L                  ''  N#00019960' TO DFHEIV0
 21619     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21620     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21621     MOVE X'204E233030303139393630' TO DFHEIV0(25:11)
 21622     CALL 'kxdfhei1' USING DFHEIV0,
 21623           DFHEIV1,
 21624           ORIGINAL-CERTIFICATE,
 21625           DFHEIV11,
 21626           OC-CONTROL-PRIMARY,
 21627           DFHEIV99,
 21628           DFHEIV99
 21629     MOVE EIBRESP  TO WS-RESPONSE
 21630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21631
 21632
 21633     GO TO 9991-EXIT.
 21634
 21635 9991-CHECK-INDICATORS.
 21636
 21637     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21638         GO TO 9991-EXIT
 21639     END-IF.
 21640
 21641     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21642         GO TO 9991-EXIT
 21643     END-IF.
 21644
 21645
 21646* EXEC CICS READ
 21647*       DATASET   ('ELCRTO')
 21648*       INTO      (ORIGINAL-CERTIFICATE)
 21649*       RIDFLD    (OC-CONTROL-PRIMARY)
 21650*       UPDATE
 21651*       RESP      (WS-RESPONSE)
 21652*    END-EXEC
 21653     MOVE LENGTH OF
 21654      ORIGINAL-CERTIFICATE
 21655       TO DFHEIV11
 21656     MOVE 'ELCRTO' TO DFHEIV1
 21657*    MOVE '&"IL       EU         (  N#00019979' TO DFHEIV0
 21658     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21659     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21660     MOVE X'204E233030303139393739' TO DFHEIV0(25:11)
 21661     CALL 'kxdfhei1' USING DFHEIV0,
 21662           DFHEIV1,
 21663           ORIGINAL-CERTIFICATE,
 21664           DFHEIV11,
 21665           OC-CONTROL-PRIMARY,
 21666           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 402
* EL050.cbl
 21667           DFHEIV99,
 21668           DFHEIV99
 21669     MOVE EIBRESP  TO WS-RESPONSE
 21670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21671     IF WS-RESP-NORMAL
 21672        IF PB-ISSUE
 21673          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21674          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21675          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21676          MOVE PB-I-AGE               TO OC-INS-AGE
 21677          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21678          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21679          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21680          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21681          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21682          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21683          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21684          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21685          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21686          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21687          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21688          IF PB-I-JOINT-COMMISSION > +0
 21689              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21690          ELSE
 21691              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21692          END-IF
 21693          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21694          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21695          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21696          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21697          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21698          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21699          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21700          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21701          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21702
 21703          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21704
 21705* EXEC CICS READ
 21706*             DATASET   (FILE-ERMAIL)
 21707*             RIDFLD    (MA-CONTROL-PRIMARY)
 21708*             INTO      (MAILING-DATA)
 21709*             RESP      (WS-RESPONSE)
 21710*         END-EXEC
 21711     MOVE LENGTH OF
 21712      MAILING-DATA
 21713       TO DFHEIV11
 21714*    MOVE '&"IL       E          (  N#00020019' TO DFHEIV0
 21715     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21717     MOVE X'204E233030303230303139' TO DFHEIV0(25:11)
 21718     CALL 'kxdfhei1' USING DFHEIV0,
 21719           FILE-ERMAIL,
 21720           MAILING-DATA,
 21721           DFHEIV11,
 21722           MA-CONTROL-PRIMARY,
 21723           DFHEIV99,
 21724           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 403
* EL050.cbl
 21725           DFHEIV99
 21726     MOVE EIBRESP  TO WS-RESPONSE
 21727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21728          IF WS-RESP-NORMAL
 21729             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21730          END-IF
 21731
 21732          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21733          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21734
 21735* EXEC CICS READ
 21736*             DATASET  (CRTT-ID)
 21737*             RIDFLD   (WS-ELCRTT-KEY)
 21738*             INTO     (CERTIFICATE-TRAILERS)
 21739*             RESP     (WS-RESPONSE)
 21740*         END-EXEC
 21741     MOVE LENGTH OF
 21742      CERTIFICATE-TRAILERS
 21743       TO DFHEIV11
 21744*    MOVE '&"IL       E          (  N#00020031' TO DFHEIV0
 21745     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21746     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21747     MOVE X'204E233030303230303331' TO DFHEIV0(25:11)
 21748     CALL 'kxdfhei1' USING DFHEIV0,
 21749           CRTT-ID,
 21750           CERTIFICATE-TRAILERS,
 21751           DFHEIV11,
 21752           WS-ELCRTT-KEY,
 21753           DFHEIV99,
 21754           DFHEIV99,
 21755           DFHEIV99
 21756     MOVE EIBRESP  TO WS-RESPONSE
 21757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21758          IF WS-RESP-NORMAL
 21759             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21760                               OC-INS-AGE-DEFAULT-FLAG
 21761             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21762                               OC-JNT-AGE-DEFAULT-FLAG
 21763          END-IF
 21764
 21765        ELSE
 21766          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21767             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21768             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21769             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21770          END-IF
 21771          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21772             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21773             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21774             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21775          END-IF
 21776          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21777        END-IF
 21778
 21779* EXEC CICS REWRITE
 21780*          DATASET   ('ELCRTO')
 21781*          FROM      (ORIGINAL-CERTIFICATE)
 21782*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 404
* EL050.cbl
 21783*       END-EXEC
 21784     MOVE LENGTH OF
 21785      ORIGINAL-CERTIFICATE
 21786       TO DFHEIV11
 21787     MOVE 'ELCRTO' TO DFHEIV1
 21788*    MOVE '&& L                  %  N#00020057' TO DFHEIV0
 21789     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21790     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21791     MOVE X'204E233030303230303537' TO DFHEIV0(25:11)
 21792     CALL 'kxdfhei1' USING DFHEIV0,
 21793           DFHEIV1,
 21794           ORIGINAL-CERTIFICATE,
 21795           DFHEIV11,
 21796           DFHEIV99
 21797     MOVE EIBRESP  TO WS-RESPONSE
 21798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21799     END-IF.
 21800
 21801 9991-EXIT.
 21802     EXIT.
 21803
 21804
 21805 9999-RETURN.
 21806     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21807
 21808
 21809* EXEC CICS RETURN
 21810*    END-EXEC.
 21811*    MOVE '.(                    ''   #00020071' TO DFHEIV0
 21812     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21813     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21814     MOVE X'2020233030303230303731' TO DFHEIV0(25:11)
 21815     CALL 'kxdfhei1' USING DFHEIV0,
 21816           DFHEIV99,
 21817           DFHEIV99,
 21818           DFHEIV99,
 21819           DFHEIV99,
 21820           DFHEIV99,
 21821           DFHEIV99
 21822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21823
 21824
 21825
 21826* GOBACK.
 21827     MOVE '9%                    "   ' TO DFHEIV0
 21828     MOVE 'EL050' TO DFHEIV1
 21829     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21830     GOBACK.
 21831
 21832 9999-DFHBACK SECTION.
 21833     MOVE '9%                    "   ' TO DFHEIV0
 21834     MOVE 'EL050' TO DFHEIV1
 21835     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21836     GOBACK.
 21837 9999-DFHEXIT.
 21838     IF DFHEIGDJ EQUAL 0001
 21839         NEXT SENTENCE
 21840     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 405
* EL050.cbl
 21841         GO TO 9300-ABEND,
 21842               3990-FILES-NOT-OPEN
 21843         DEPENDING ON DFHEIGDI
 21844     ELSE IF DFHEIGDJ EQUAL 3
 21845         GO TO 6610-START-BROWSE,
 21846               6630-ERRESS-PROBLEM,
 21847               6630-END-OF-FILE
 21848         DEPENDING ON DFHEIGDI
 21849     ELSE IF DFHEIGDJ EQUAL 4
 21850         GO TO 6630-END-OF-FILE,
 21851               6630-ERRESS-PROBLEM,
 21852               6630-ERRESS-PROBLEM,
 21853               6630-END-OF-FILE
 21854         DEPENDING ON DFHEIGDI
 21855     ELSE IF DFHEIGDJ EQUAL 5
 21856         GO TO 6630-END-OF-FILE,
 21857               6630-END-OF-FILE,
 21858               6630-ERRESS-PROBLEM,
 21859               6630-ERRESS-PROBLEM
 21860         DEPENDING ON DFHEIGDI
 21861     ELSE IF DFHEIGDJ EQUAL 6
 21862         GO TO 6660-START-BROWSE,
 21863               6690-ERRESC-PROBLEM,
 21864               6690-ERRESC-PROBLEM,
 21865               6690-END-OF-FILE
 21866         DEPENDING ON DFHEIGDI
 21867     ELSE IF DFHEIGDJ EQUAL 7
 21868         GO TO 6690-END-OF-FILE,
 21869               6690-ERRESC-PROBLEM,
 21870               6690-ERRESC-PROBLEM,
 21871               6690-END-OF-FILE
 21872         DEPENDING ON DFHEIGDI
 21873     ELSE IF DFHEIGDJ EQUAL 8
 21874         GO TO 6690-END-OF-FILE,
 21875               6690-ERRESC-PROBLEM,
 21876               6690-ERRESC-PROBLEM,
 21877               6690-END-OF-FILE
 21878         DEPENDING ON DFHEIGDI
 21879     ELSE IF DFHEIGDJ EQUAL 9
 21880         GO TO 7250-CONTINUE,
 21881               7250-CONTINUE
 21882         DEPENDING ON DFHEIGDI
 21883     ELSE IF DFHEIGDJ EQUAL 10
 21884         GO TO 7300-CONTINUE,
 21885               7300-CONTINUE
 21886         DEPENDING ON DFHEIGDI
 21887     ELSE IF DFHEIGDJ EQUAL 11
 21888         GO TO 8000-FREE-MAIN
 21889         DEPENDING ON DFHEIGDI
 21890     ELSE IF DFHEIGDJ EQUAL 12
 21891         GO TO 8100-NOTFND,
 21892               8100-NOTFND
 21893         DEPENDING ON DFHEIGDI
 21894     ELSE IF DFHEIGDJ EQUAL 13
 21895         GO TO 8110-NOTFND,
 21896               8110-NOTFND
 21897         DEPENDING ON DFHEIGDI
 21898     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 406
* EL050.cbl
 21899         GO TO 8130-EXIT
 21900         DEPENDING ON DFHEIGDI
 21901     ELSE IF DFHEIGDJ EQUAL 15
 21902         GO TO 8150-exit
 21903         DEPENDING ON DFHEIGDI
 21904     ELSE IF DFHEIGDJ EQUAL 16
 21905         GO TO 8180-NOTFND
 21906         DEPENDING ON DFHEIGDI
 21907     ELSE IF DFHEIGDJ EQUAL 17
 21908         GO TO 8190-NOTFND
 21909         DEPENDING ON DFHEIGDI
 21910     ELSE IF DFHEIGDJ EQUAL 18
 21911         GO TO 8195-NOTFND
 21912         DEPENDING ON DFHEIGDI
 21913     ELSE IF DFHEIGDJ EQUAL 19
 21914         GO TO 8200-NOTFND
 21915         DEPENDING ON DFHEIGDI
 21916     ELSE IF DFHEIGDJ EQUAL 20
 21917         GO TO 8300-NOTFND,
 21918               8300-ERRESS-PROBLEM,
 21919               8300-ERRESS-PROBLEM,
 21920               8300-NOTFND
 21921         DEPENDING ON DFHEIGDI
 21922     ELSE IF DFHEIGDJ EQUAL 21
 21923         GO TO 8450-FORM-NOT-FOUND,
 21924               8450-FORM-NOT-FOUND
 21925         DEPENDING ON DFHEIGDI
 21926     ELSE IF DFHEIGDJ EQUAL 22
 21927         GO TO 0199-ACCT-NOT-FOUND,
 21928               0199-ACCT-NOT-FOUND
 21929         DEPENDING ON DFHEIGDI
 21930     ELSE IF DFHEIGDJ EQUAL 23
 21931         GO TO 0199-ACCT-NOT-FOUND,
 21932               0199-ACCT-NOT-FOUND
 21933         DEPENDING ON DFHEIGDI
 21934     ELSE IF DFHEIGDJ EQUAL 24
 21935         GO TO 8582-COMP-NOT-FOUND,
 21936               8582-COMP-NOT-FOUND
 21937         DEPENDING ON DFHEIGDI
 21938     ELSE IF DFHEIGDJ EQUAL 25
 21939         GO TO 8583-AGTC-NOT-FOUND,
 21940               8583-AGTC-NOT-FOUND
 21941         DEPENDING ON DFHEIGDI
 21942     ELSE IF DFHEIGDJ EQUAL 26
 21943         GO TO 8584-BXRF-NOT-FOUND,
 21944               8584-BXRF-NOT-FOUND
 21945         DEPENDING ON DFHEIGDI
 21946     ELSE IF DFHEIGDJ EQUAL 27
 21947         GO TO 8585-PLAN-NOT-FOUND,
 21948               8585-PLAN-NOT-FOUND
 21949         DEPENDING ON DFHEIGDI
 21950     ELSE IF DFHEIGDJ EQUAL 28
 21951         GO TO 0299-CERT-NOT-FOUND
 21952         DEPENDING ON DFHEIGDI
 21953     ELSE IF DFHEIGDJ EQUAL 29
 21954         GO TO 8700-READ-CERT-MASTER
 21955         DEPENDING ON DFHEIGDI
 21956     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 28-May-14 08:46 Page 407
* EL050.cbl
 21957         GO TO 8720-COMP-ACCOUNTS,
 21958               8730-END-BROWSE,
 21959               8740-NOT-FOUND
 21960         DEPENDING ON DFHEIGDI
 21961     ELSE IF DFHEIGDJ EQUAL 31
 21962         GO TO 9000-NOTFND
 21963         DEPENDING ON DFHEIGDI
 21964     ELSE IF DFHEIGDJ EQUAL 32
 21965         GO TO 9100-NOTFND,
 21966               9100-NOTFND
 21967         DEPENDING ON DFHEIGDI
 21968     ELSE IF DFHEIGDJ EQUAL 33
 21969         GO TO 9991-CRTO-NOT-FOUND,
 21970               9991-CRTO-NOT-FOUND
 21971         DEPENDING ON DFHEIGDI.
 21972     MOVE '9%                    "   ' TO DFHEIV0
 21973     MOVE 'EL050' TO DFHEIV1
 21974     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21975     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40032     Code:       88443
