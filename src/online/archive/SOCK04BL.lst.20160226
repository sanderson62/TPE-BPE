* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page   1
* SOCK04BL.cbl
* Options: int("SOCK04BL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK04BL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK04BL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SOCK04BL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2015 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK04BL.
     9*
    10*AUTHOR.    Cowtown.
    11*           Colleyville, TEXAS.
    12*REMARKS.
    13***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page   2
* SOCK04BL.cbl
    14***                                                            ***
    15***  This program acts as a Socket Server and expects a key    ***
    16***  to read an account master and a compensation master and   ***
    17***  will pass back a few items. It currently is designed to   ***
    18***  work with the Agent Signature Verification process.       ***
    19***                                                            ***
    20***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 031115  CR               PEMA  NEW PROGRAM
    30*-----------------------------------------------------------------
    31 environment division.
    32 data division.
    33 working-storage section.
    34 01  DFH-START PIC X(04).
    35 77  WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    36 77  WS-COMP-ID                   PIC XXX VALUE 'CID'.
    37 77  WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    38 77  WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    39 77  WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    40 77  WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    41 77  WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    42 77  a1                           PIC S999 COMP-3 VALUE +0.
    43 77  c1                           PIC S999 COMP-3 VALUE +0.
    44 77  WS-BUILD-SW                  PIC X.
    45     88  TIME-TO-BUILD               VALUE 'Y'.
    46 77  WS-SAVE-ERACCT               PIC X(2000).
    47 77  WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    48 77  ws-bin-eff-dt                pic xx  value low-values.
    49 77  ws-bin-1st-pay-dt            pic xx  value low-values.
    50 77  WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    51 77  ws-disp-rate                 pic z9.99999.
    52 77  WS-ERACCT-SW                PIC X VALUE ' '.
    53     88  END-OF-ERACCT                 VALUE 'Y'.
    54 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    55     88  END-OF-ERCTBL                 VALUE 'Y'.
    56 77  WS-STATUS                   PIC X.
    57 77  ws-bin-cert-eff-dt          pic xx   value low-values.
    58 77  ws-current-bin-dt           pic xx   value low-values.
    59 77  ws-cert-note-generic-key-len pic s9(4) comp value +34.
    60 77  note-count                  pic s999 comp-3 value +0.
    61 77  ws-build-note-sw            pic x value ' '.
    62     88  finished-with-notes      value 'Y'.
    63 77  ws-ercnot-sw                pic x  value spaces.
    64     88  ercnot-startbr            value 'Y'.
    65 01  ws-work-date.
    66     05  ws-work-ccyy            pic x(4).
    67     05  ws-work-mm              pic xx.
    68     05  ws-work-dd              pic xx.
    69 01  ws-work-date-num redefines ws-work-date
    70                                 pic 9(8).
    71 01  cert-note-records-holder.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page   3
* SOCK04BL.cbl
    72     05  cert-note-record occurs 300.
    73         10  filler              pic x(48).
    74         10  cnr-rest            pic x(102).
    75 01  WS-AM-KEY.
    76     05  WS-AM-COMPANY-CD        PIC X.
    77     05  WS-AM-CARRIER           PIC X.
    78     05  WS-AM-GROUP             PIC X(6).
    79     05  WS-AM-STATE             PIC XX.
    80     05  WS-AM-ACCOUNT           PIC X(10).
    81     05  WS-AM-EXP-DT            PIC XX.
    82     05  FILLER                  PIC X(4).
    83 01  WS-CO-KEY.
    84     05  WS-CO-COMPANY-CD        PIC X.
    85     05  WS-CO-CARRIER           PIC X.
    86     05  WS-CO-GROUP             PIC X(6).
    87     05  WS-CO-FIN-RESP          PIC X(10).
    88     05  WS-CO-ACCOUNT           PIC X(10).
    89     05  WS-CO-TYPE              PIC X.
    90 01  WS-CM-KEY.
    91     05  WS-CM-COMPANY-CD        PIC X.
    92     05  WS-CM-CARRIER           PIC X.
    93     05  WS-CM-GROUP             PIC X(6).
    94     05  WS-CM-STATE             PIC XX.
    95     05  WS-CM-ACCOUNT           PIC X(10).
    96     05  WS-CM-EFF-DT            PIC XX.
    97     05  WS-CM-CERT-NO           PIC X(11).
    98 01  WS-CZ-KEY.
    99     05  WS-CZ-COMPANY-CD        PIC X.
   100     05  WS-CZ-CARRIER           PIC X.
   101     05  WS-CZ-GROUP             PIC X(6).
   102     05  WS-CZ-STATE             PIC XX.
   103     05  WS-CZ-ACCOUNT           PIC X(10).
   104     05  WS-CZ-EFF-DT            PIC XX.
   105     05  WS-CZ-CERT-NO           PIC X(11).
   106     05  WS-CZ-REC-TYPE          PIC X.
   107     05  ws-cz-note-seq          pic s9(4) comp.
   108 01  WS-CS-KEY.
   109     05  WS-CS-COMPANY-CD        PIC X.
   110     05  WS-CS-CARRIER           PIC X.
   111     05  WS-CS-GROUP             PIC X(6).
   112     05  WS-CS-STATE             PIC XX.
   113     05  WS-CS-ACCOUNT           PIC X(10).
   114     05  WS-CS-EFF-DT            PIC XX.
   115     05  WS-CS-CERT-NO           PIC X(11).
   116     05  WS-CS-TRLR-TYPE         PIC X.
   117 01  ws-return-stuff.
   118     05  ws-am-name              pic x(30).
   119     05  ws-am-person            pic x(30).
   120     05  ws-am-control-name      pic x(30).
   121     05  ws-am-phone             pic x(10).
   122     05  ws-co-fax               pic x(10).
   123     05  ws-co-contact           pic x(30).
   124 01  WS-CID-NO                   PIC X(8).
   125 01  WS-DISP-RESP                PIC 9(5).
   126 01  WS-RESPONSE                 PIC S9(8)   COMP.
   127     88  RESP-NORMAL                  VALUE +00.
   128     88  RESP-NOTFND                  VALUE +13.
   129     88  RESP-NOTOPEN                 VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page   4
* SOCK04BL.cbl
   130     88  RESP-ENDFILE                 VALUE +20.
   131*                                 COPY ELCCERT.
   132******************************************************************
   133*                                                                *
   134*                            ELCCERT.                            *
   135*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   136*                            VMOD=2.013                          *
   137*                                                                *
   138*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   139*                                                                *
   140*   FILE TYPE = VSAM,KSDS                                        *
   141*   RECORD SIZE = 450  RECFORM = FIXED                           *
   142*                                                                *
   143*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   144*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   145*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   146*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   147*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   148*                                                                *
   149*   LOG = YES                                                    *
   150*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   151******************************************************************
   152*                   C H A N G E   L O G
   153*
   154* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   155*-----------------------------------------------------------------
   156*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   157* EFFECTIVE    NUMBER
   158*-----------------------------------------------------------------
   159* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   160* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   161* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   162* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   163* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   164* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   165* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   166* 032612  CR2011110200001  PEMA  AHL CHANGES
   167* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   168******************************************************************
   169
   170 01  CERTIFICATE-MASTER.
   171     12  CM-RECORD-ID                      PIC XX.
   172         88  VALID-CM-ID                      VALUE 'CM'.
   173
   174     12  CM-CONTROL-PRIMARY.
   175         16  CM-COMPANY-CD                 PIC X.
   176         16  CM-CARRIER                    PIC X.
   177         16  CM-GROUPING.
   178             20  CM-GROUPING-PREFIX        PIC X(3).
   179             20  CM-GROUPING-PRIME         PIC X(3).
   180         16  CM-STATE                      PIC XX.
   181         16  CM-ACCOUNT.
   182             20  CM-ACCOUNT-PREFIX         PIC X(4).
   183             20  CM-ACCOUNT-PRIME          PIC X(6).
   184         16  CM-CERT-EFF-DT                PIC XX.
   185         16  CM-CERT-NO.
   186             20  CM-CERT-PRIME             PIC X(10).
   187             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page   5
* SOCK04BL.cbl
   188
   189     12  CM-CONTROL-BY-NAME.
   190         16  CM-COMPANY-CD-A1              PIC X.
   191         16  CM-INSURED-LAST-NAME          PIC X(15).
   192         16  CM-INSURED-INITIALS.
   193             20  CM-INSURED-INITIAL1       PIC X.
   194             20  CM-INSURED-INITIAL2       PIC X.
   195
   196     12  CM-CONTROL-BY-SSN.
   197         16  CM-COMPANY-CD-A2              PIC X.
   198         16  CM-SOC-SEC-NO.
   199             20  CM-SSN-STATE              PIC XX.
   200             20  CM-SSN-ACCOUNT            PIC X(6).
   201             20  CM-SSN-LN3.
   202                 25  CM-INSURED-INITIALS-A2.
   203                     30 CM-INSURED-INITIAL1-A2   PIC X.
   204                     30 CM-INSURED-INITIAL2-A2   PIC X.
   205                 25 CM-PART-LAST-NAME-A2         PIC X.
   206
   207     12  CM-CONTROL-BY-CERT-NO.
   208         16  CM-COMPANY-CD-A4              PIC X.
   209         16  CM-CERT-NO-A4                 PIC X(11).
   210
   211     12  CM-CONTROL-BY-MEMB.
   212         16  CM-COMPANY-CD-A5              PIC X.
   213         16  CM-MEMBER-NO.
   214             20  CM-MEMB-STATE             PIC XX.
   215             20  CM-MEMB-ACCOUNT           PIC X(6).
   216             20  CM-MEMB-LN4.
   217                 25  CM-INSURED-INITIALS-A5.
   218                     30 CM-INSURED-INITIAL1-A5   PIC X.
   219                     30 CM-INSURED-INITIAL2-A5   PIC X.
   220                 25 CM-PART-LAST-NAME-A5         PIC XX.
   221
   222     12  CM-INSURED-PROFILE-DATA.
   223         16  CM-INSURED-FIRST-NAME.
   224             20  CM-INSURED-1ST-INIT       PIC X.
   225             20  FILLER                    PIC X(9).
   226         16  CM-INSURED-ISSUE-AGE          PIC 99.
   227         16  CM-INSURED-SEX                PIC X.
   228             88  CM-SEX-MALE                  VALUE 'M'.
   229             88  CM-SEX-FEMAL                 VALUE 'F'.
   230         16  CM-INSURED-JOINT-AGE          PIC 99.
   231         16  CM-JOINT-INSURED-NAME.
   232             20  CM-JT-LAST-NAME           PIC X(15).
   233             20  CM-JT-FIRST-NAME.
   234                 24  CM-JT-1ST-INIT        PIC X.
   235                 24  FILLER                PIC X(9).
   236             20  CM-JT-INITIAL             PIC X.
   237
   238     12  CM-LIFE-DATA.
   239         16  CM-LF-BENEFIT-CD              PIC XX.
   240         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   241         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   242         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   243         16  CM-LF-DEV-CODE                PIC XXX.
   244         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   245         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page   6
* SOCK04BL.cbl
   246         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   247         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   248         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   249         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   250         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   251         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   252         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   253         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   254         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   255         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   256         16  cm-temp-epiq                  pic xx.
   257             88  EPIQ-CLASS                  value 'EQ'.
   258*        16  FILLER                        PIC XX.
   259
   260     12  CM-AH-DATA.
   261         16  CM-AH-BENEFIT-CD              PIC XX.
   262         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   263         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   264         16  CM-AH-DEV-CODE                PIC XXX.
   265         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   266         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   267         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   268         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   269         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   270         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   271         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   272         16  CM-AH-PAID-THRU-DT            PIC XX.
   273             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   274         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   275         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   276         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   277         16  FILLER                        PIC X.
   278
   279     12  CM-LOAN-INFORMATION.
   280         16  CM-LIVES                      PIC S9(7)     COMP-3.
   281         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   282                                           PIC S9(5)V99  COMP-3.
   283         16  CM-BILLED                     PIC S9(7)     COMP-3.
   284         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   285         16  CM-PAY-FREQUENCY              PIC S99.
   286         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   287         16  CM-RATE-CLASS                 PIC XX.
   288         16  CM-BENEFICIARY                PIC X(25).
   289         16  CM-POLICY-FORM-NO             PIC X(12).
   290         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   291         16  CM-LAST-ADD-ON-DT             PIC XX.
   292         16  CM-DEDUCTIBLE-AMOUNTS.
   293             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   294             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   295         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   296             20  CM-RESIDENT-STATE         PIC XX.
   297             20  CM-RATE-CODE              PIC X(4).
   298             20  FILLER                    PIC XX.
   299         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   300             20  CM-LOAN-OFFICER           PIC X(5).
   301             20  FILLER                    PIC XXX.
   302         16  CM-CSR-CODE                   PIC XXX.
   303         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page   7
* SOCK04BL.cbl
   304             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   305         16  CM-POST-CARD-IND              PIC X.
   306         16  CM-NH-INTERFACE-SW            PIC X.
   307         16  CM-PREMIUM-TYPE               PIC X.
   308             88  CM-SING-PRM                  VALUE '1'.
   309             88  CM-O-B-COVERAGE              VALUE '2'.
   310             88  CM-OPEN-END                  VALUE '3'.
   311         16  CM-IND-GRP-TYPE               PIC X.
   312             88  CM-INDIVIDUAL                VALUE 'I'.
   313             88  CM-GROUP                     VALUE 'G'.
   314         16  CM-SKIP-CODE                  PIC X.
   315             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   316             88  SKIP-JULY                    VALUE '1'.
   317             88  SKIP-AUGUST                  VALUE '2'.
   318             88  SKIP-SEPTEMBER               VALUE '3'.
   319             88  SKIP-JULY-AUG                VALUE '4'.
   320             88  SKIP-AUG-SEPT                VALUE '5'.
   321             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   322             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   323             88  SKIP-JUNE                    VALUE '8'.
   324             88  SKIP-JUNE-JULY               VALUE '9'.
   325             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   326             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   327         16  CM-PAYMENT-MODE               PIC X.
   328             88  PAY-MONTHLY                  VALUE SPACE.
   329             88  PAY-WEEKLY                   VALUE '1'.
   330             88  PAY-SEMI-MONTHLY             VALUE '2'.
   331             88  PAY-BI-WEEKLY                VALUE '3'.
   332             88  PAY-SEMI-ANUALLY             VALUE '4'.
   333         16  CM-LOAN-NUMBER                PIC X(8).
   334         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   335         16  CM-OLD-LOF                    PIC XXX.
   336*        16  CM-LOAN-OFFICER               PIC XXX.
   337         16  CM-REIN-TABLE                 PIC XXX.
   338         16  CM-SPECIAL-REIN-CODE          PIC X.
   339         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   340         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   341         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   342
   343     12  CM-STATUS-DATA.
   344         16  CM-ENTRY-STATUS               PIC X.
   345         16  CM-ENTRY-DT                   PIC XX.
   346
   347         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   348         16  CM-LF-CANCEL-DT               PIC XX.
   349         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   350
   351         16  CM-LF-STATUS-AT-DEATH         PIC X.
   352         16  CM-LF-DEATH-DT                PIC XX.
   353         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   354
   355         16  CM-LF-CURRENT-STATUS          PIC X.
   356             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   357                                                'M' '4' '5' '9'.
   358             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   359             88  CM-LF-POLICY-PENDING         VALUE '2'.
   360             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   361             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page   8
* SOCK04BL.cbl
   362             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   363             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   364             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   365             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   366             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   367             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   368             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   369             88  CM-LF-DECLINED               VALUE 'D'.
   370             88  CM-LF-VOIDED                 VALUE 'V'.
   371
   372         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   373         16  CM-AH-CANCEL-DT               PIC XX.
   374         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   375
   376         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   377         16  CM-AH-SETTLEMENT-DT           PIC XX.
   378         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   379
   380         16  CM-AH-CURRENT-STATUS          PIC X.
   381             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   382                                                'M' '4' '5' '9'.
   383             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   384             88  CM-AH-POLICY-PENDING         VALUE '2'.
   385             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   386             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   387             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   388             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   389             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   390             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   391             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   392             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   393             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   394             88  CM-AH-DECLINED               VALUE 'D'.
   395             88  CM-AH-VOIDED                 VALUE 'V'.
   396
   397         16  CM-CLAIM-INTERFACE-SW         PIC X.
   398             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   399             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   400             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   401         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   402
   403         16  CM-ENTRY-BATCH                PIC X(6).
   404         16  CM-LF-EXIT-BATCH              PIC X(6).
   405         16  CM-AH-EXIT-BATCH              PIC X(6).
   406         16  CM-LAST-MONTH-END             PIC XX.
   407
   408     12  CM-NOTE-SW                        PIC X.
   409         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   410         88  CERT-NOTES-PRESENT               VALUE '1'.
   411         88  BILLING-NOTES-PRESENT            VALUE '2'.
   412         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   413         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   414         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   415         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   416         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   417     12  CM-COMP-EXCP-SW                   PIC X.
   418         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   419         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page   9
* SOCK04BL.cbl
   420     12  CM-INSURED-ADDRESS-SW             PIC X.
   421         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   422         88  INSURED-ADDR-PRESENT             VALUE '1'.
   423
   424*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   425     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   426     12  FILLER                            PIC X.
   427
   428*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   429     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   430     12  FILLER                            PIC X.
   431*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   432     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   433
   434     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   435         88  CERT-ADDED-BATCH                 VALUE ' '.
   436         88  CERT-ADDED-ONLINE                VALUE '1'.
   437         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   438         88  CERT-PURGED-OFFLINE              VALUE '3'.
   439         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   440     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   441         88  CERT-AS-LOADED                   VALUE ' '.
   442         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   443         88  CERT-CLAIM-ONLINE                VALUE '2'.
   444         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   445         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   446         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   447         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   448         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   449
   450     12  CM-ACCOUNT-COMM-PCTS.
   451         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   452         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   453
   454     12  CM-USER-FIELD                     PIC X.
   455     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   456     12  CM-CLP-STATE                      PIC XX.
   457     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   458     12  CM-USER-RESERVED                  PIC XXX.
   459     12  FILLER REDEFINES CM-USER-RESERVED.
   460         16  CM-AH-CLASS-CD                PIC XX.
   461         16  F                             PIC X.
   462******************************************************************
   463*                                 COPY ELCCRTT.
   464******************************************************************
   465*                                                                *
   466*                            ELCCRTT.                            *
   467*                                                                *
   468*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
   469*                                                                *
   470*   FILE TYPE = VSAM,KSDS                                        *
   471*   RECORD SIZE = 552  RECFORM = FIXED                           *
   472*                                                                *
   473*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
   474*                                                                *
   475*   LOG = YES                                                    *
   476*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   477******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  10
* SOCK04BL.cbl
   478*                   C H A N G E   L O G
   479*
   480* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   481*-----------------------------------------------------------------
   482*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   483* EFFECTIVE    NUMBER
   484*-----------------------------------------------------------------
   485* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
   486* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
   487* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   488* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   489* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   490* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   491* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   492* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
   493******************************************************************
   494
   495 01  CERTIFICATE-TRAILERS.
   496     12  CS-RECORD-ID                      PIC XX.
   497         88  VALID-CS-ID                      VALUE 'CS'.
   498
   499     12  CS-CONTROL-PRIMARY.
   500         16  CS-COMPANY-CD                 PIC X.
   501         16  CS-CARRIER                    PIC X.
   502         16  CS-GROUPING                   PIC X(6).
   503         16  CS-STATE                      PIC XX.
   504         16  CS-ACCOUNT                    PIC X(10).
   505         16  CS-CERT-EFF-DT                PIC XX.
   506         16  CS-CERT-NO.
   507             20  CS-CERT-PRIME             PIC X(10).
   508             20  CS-CERT-SFX               PIC X.
   509         16  CS-TRAILER-TYPE               PIC X.
   510             88  COMM-TRLR           VALUE 'A'.
   511             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
   512             88  CERT-DATA-TRLR      VALUE 'C'.
   513
   514     12  CS-DATA-AREA                      PIC X(516).
   515
   516     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
   517         16  CS-BANK-COMMISSION-AREA.
   518             20  CS-BANK-COMMS       OCCURS 10.
   519                 24  CS-AGT                PIC X(10).
   520                 24  CS-COM-TYP            PIC X.
   521                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
   522                 24  CS-RECALC-LV-INDIC    PIC X.
   523                 24  FILLER                PIC X(10).
   524         16  FILLER                        PIC X(256).
   525
   526     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
   527****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
   528         16  CS-MB-CLAIM-DATA OCCURS 24.
   529             20  CS-CLAIM-NO               PIC X(7).
   530             20  CS-CLAIM-TYPE             PIC X.
   531                 88  CS-AH-CLM               VALUE 'A'.
   532                 88  CS-IU-CLM               VALUE 'I'.
   533                 88  CS-GP-CLM               VALUE 'G'.
   534                 88  CS-LF-CLM               VALUE 'L'.
   535                 88  CS-PR-CLM               VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  11
* SOCK04BL.cbl
   536                 88  CS-FL-CLM               VALUE 'F'.
   537             20  CS-INSURED-TYPE           PIC X.
   538                 88  CS-PRIM-INSURED          VALUE 'P'.
   539                 88  CS-CO-BORROWER           VALUE 'C'.
   540             20  CS-BENEFIT-PERIOD         PIC 99.
   541             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
   542             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
   543             20  CS-REMAINING-BENS         PIC S999 COMP-3.
   544         16  FILLER                        PIC X(12).
   545     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
   546         16  CS-VIN-NUMBER                 PIC X(17).
   547         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
   548         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
   549         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
   550         16  cs-agent-name.
   551             20  cs-agent-fname            pic x(20).
   552             20  cs-agent-mi               pic x.
   553             20  cs-agent-lname            pic x(25).
   554         16  cs-license-no                 pic x(15).
   555         16  cs-npn-number                 pic x(10).
   556         16  cs-agent-edit-status          pic x.
   557             88  cs-ae-refer-to-manager      value 'M'.
   558             88  cs-ae-cover-sheet           value 'C'.
   559             88  cs-ae-sig-form              value 'S'.
   560             88  cs-ae-verified              value 'V'.
   561             88  cs-unidentified-signature   value 'U'.
   562             88  cs-cert-returned            value 'R'.
   563             88  cs-accept-no-commission     value 'N'.
   564         16  FILLER                        PIC X(424).
   565*        16  FILLER                        PIC X(496).
   566*                                 COPY ERCACCT.
   567******************************************************************
   568*                                                                *
   569*                                                                *
   570*                            ERCACCT                             *
   571*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   572*                            VMOD=2.031                          *
   573*                                                                *
   574*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   575*                                                                *
   576*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   577*   VSAM ACCOUNT MASTER FILES.                                   *
   578*                                                                *
   579*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   580*                                                                *
   581*   FILE TYPE = VSAM,KSDS                                        *
   582*   RECORD SIZE = 2000  RECFORM = FIX                            *
   583*                                                                *
   584*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   585*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   586*                                                                *
   587*   LOG = NO                                                     *
   588*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   589*                                                                *
   590*                                                                *
   591******************************************************************
   592*                   C H A N G E   L O G
   593*
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  12
* SOCK04BL.cbl
   594* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   595*-----------------------------------------------------------------
   596*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   597* EFFECTIVE    NUMBER
   598*-----------------------------------------------------------------
   599* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   600* 092705    2005050300006  PEMA  ADD SPP LEASES
   601* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   602* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   603* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   604* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   605* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   606******************************************************************
   607
   608 01  ACCOUNT-MASTER.
   609     12  AM-RECORD-ID                      PIC XX.
   610         88  VALID-AM-ID                      VALUE 'AM'.
   611
   612     12  AM-CONTROL-PRIMARY.
   613         16  AM-COMPANY-CD                 PIC X.
   614         16  AM-MSTR-CNTRL.
   615             20  AM-CONTROL-A.
   616                 24  AM-CARRIER            PIC X.
   617                 24  AM-GROUPING.
   618                     28 AM-GROUPING-PREFIX PIC XXX.
   619                     28 AM-GROUPING-PRIME  PIC XXX.
   620                 24  AM-STATE              PIC XX.
   621                 24  AM-ACCOUNT.
   622                     28  AM-ACCOUNT-PREFIX PIC X(4).
   623                     28  AM-ACCOUNT-PRIME  PIC X(6).
   624             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   625                                           PIC X(19).
   626             20  AM-CNTRL-B.
   627                 24  AM-EXPIRATION-DT      PIC XX.
   628                 24  FILLER                PIC X(4).
   629             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   630                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   631
   632     12  AM-CONTROL-BY-VAR-GRP.
   633         16  AM-COMPANY-CD-A1              PIC X.
   634         16  AM-VG-CARRIER                 PIC X.
   635         16  AM-VG-GROUPING                PIC X(6).
   636         16  AM-VG-STATE                   PIC XX.
   637         16  AM-VG-ACCOUNT                 PIC X(10).
   638         16  AM-VG-DATE.
   639             20  AM-VG-EXPIRATION-DT       PIC XX.
   640             20  FILLER                    PIC X(4).
   641         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   642                                           PIC 9(11)      COMP-3.
   643     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   644         16  FILLER                        PIC X(10).
   645         16  AM-VG-KEY3.
   646             20  AM-VG3-ACCOUNT            PIC X(10).
   647             20  AM-VG3-EXP-DT             PIC XX.
   648         16  FILLER                        PIC X(4).
   649     12  AM-MAINT-INFORMATION.
   650         16  AM-LAST-MAINT-DT              PIC XX.
   651         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  13
* SOCK04BL.cbl
   652         16  AM-LAST-MAINT-USER            PIC X(4).
   653         16  FILLER                        PIC XX.
   654
   655     12  AM-EFFECTIVE-DT                   PIC XX.
   656     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   657
   658     12  AM-PREV-DATES  COMP-3.
   659         16  AM-PREV-EXP-DT                PIC 9(11).
   660         16  AM-PREV-EFF-DT                PIC 9(11).
   661
   662     12  AM-REPORT-CODE-1                  PIC X(10).
   663     12  AM-REPORT-CODE-2                  PIC X(10).
   664
   665     12  AM-CITY-CODE                      PIC X(4).
   666     12  AM-COUNTY-PARISH                  PIC X(6).
   667
   668     12  AM-NAME                           PIC X(30).
   669     12  AM-PERSON                         PIC X(30).
   670     12  AM-ADDRS                          PIC X(30).
   671     12  AM-CITY.
   672         16  AM-ADDR-CITY                  PIC X(28).
   673         16  AM-ADDR-STATE                 PIC XX.
   674     12  AM-ZIP.
   675         16  AM-ZIP-PRIME.
   676             20  AM-ZIP-PRI-1ST            PIC X.
   677                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   678             20  FILLER                    PIC X(4).
   679         16  AM-ZIP-PLUS4                  PIC X(4).
   680     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   681         16  AM-CAN-POSTAL-1               PIC XXX.
   682         16  AM-CAN-POSTAL-2               PIC XXX.
   683         16  FILLER                        PIC XXX.
   684     12  AM-TEL-NO.
   685         16  AM-AREA-CODE                  PIC 999.
   686         16  AM-TEL-PRE                    PIC 999.
   687         16  AM-TEL-NBR                    PIC 9(4).
   688     12  AM-TEL-LOC                        PIC X.
   689         88  AM-TEL-AT-HOME                   VALUE 'H'.
   690         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   691
   692     12  AM-COMM-STRUCTURE.
   693         16  AM-DEFN-1.
   694             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   695                 24  AM-AGT.
   696                     28  AM-AGT-PREFIX     PIC X(4).
   697                     28  AM-AGT-PRIME      PIC X(6).
   698                 24  AM-COM-TYP            PIC X.
   699                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   700                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   701                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   702                 24  AM-RECALC-LV-INDIC    PIC X.
   703                 24  AM-RETRO-LV-INDIC     PIC X.
   704                 24  AM-GL-CODES           PIC X.
   705                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   706                 24  FILLER                PIC X(01).
   707         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   708             20  AM-COM-TBLS        OCCURS 10 TIMES.
   709                 24  FILLER                PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  14
* SOCK04BL.cbl
   710                 24  AM-L-COMA             PIC XXX.
   711                 24  AM-J-COMA             PIC XXX.
   712                 24  AM-A-COMA             PIC XXX.
   713                 24  FILLER                PIC X(6).
   714
   715     12  AM-COMM-CHANGE-STATUS             PIC X.
   716         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   717
   718     12  AM-CSR-CODE                       PIC X(4).
   719
   720     12  AM-BILLING-STATUS                 PIC X.
   721         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   722         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   723     12  AM-AUTO-REFUND-SW                 PIC X.
   724         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   725         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   726     12  AM-GPCD                           PIC 99.
   727     12  AM-IG                             PIC X.
   728         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   729         88  AM-HAS-GROUP                     VALUE '2'.
   730     12  AM-STATUS                         PIC X.
   731         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   732         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   733         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   734         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   735         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   736         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   737     12  AM-REMIT-TO                       PIC 99.
   738     12  AM-ID-NO                          PIC X(11).
   739
   740     12  AM-CAL-TABLE                      PIC XX.
   741     12  AM-LF-DEVIATION                   PIC XXX.
   742     12  AM-AH-DEVIATION                   PIC XXX.
   743     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   744     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   745     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   746     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   747     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   748     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   749
   750     12  AM-USER-FIELDS.
   751         16  AM-FLD-1                      PIC XX.
   752         16  AM-FLD-2                      PIC XX.
   753         16  AM-FLD-3                      PIC XX.
   754         16  AM-FLD-4                      PIC XX.
   755         16  AM-FLD-5                      PIC XX.
   756
   757     12  AM-1ST-PROD-DATE.
   758         16  AM-1ST-PROD-YR                PIC XX.
   759         16  AM-1ST-PROD-MO                PIC XX.
   760         16  AM-1ST-PROD-DA                PIC XX.
   761     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   762     12  AM-CERTS-PURGED-DATE.
   763         16  AM-PUR-YR                     PIC XX.
   764         16  AM-PUR-MO                     PIC XX.
   765         16  AM-PUR-DA                     PIC XX.
   766     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   767     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  15
* SOCK04BL.cbl
   768     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   769     12  AM-INACTIVE-DATE.
   770         16  AM-INA-MO                     PIC 99.
   771         16  AM-INA-DA                     PIC 99.
   772         16  AM-INA-YR                     PIC 99.
   773     12  AM-AR-HI-CERT-DATE                PIC XX.
   774
   775     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   776     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   777
   778     12  AM-OB-PAYMENT-MODE                PIC X.
   779         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   780         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   781         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   782         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   783
   784     12  AM-AH-ONLY-INDICATOR              PIC X.
   785         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   786         88  AM-NO-AH-ONLY                    VALUE 'N'.
   787
   788     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   789
   790     12  AM-OVER-SHORT.
   791         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   792         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   793
   794     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   795     12  AM-DCC-CLP-STATE                  PIC XX.
   796
   797     12  AM-RECALC-COMM                    PIC X.
   798     12  AM-RECALC-REIN                    PIC X.
   799
   800     12  AM-REI-TABLE                      PIC XXX.
   801     12  AM-REI-ET-LF                      PIC X.
   802     12  AM-REI-ET-AH                      PIC X.
   803     12  AM-REI-PE-LF                      PIC X.
   804     12  AM-REI-PE-AH                      PIC X.
   805     12  AM-REI-PRT-ST                     PIC X.
   806     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   807     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   808     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   809     12  AM-REI-GROUP-A                    PIC X(6).
   810     12  AM-REI-MORT                       PIC X(4).
   811     12  AM-REI-PRT-OW                     PIC X.
   812     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   813     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   814     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   815     12  AM-REI-GROUP-B                    PIC X(6).
   816
   817     12  AM-TRUST-TYPE                     PIC X(2).
   818
   819     12  AM-EMPLOYER-STMT-USED             PIC X.
   820     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   821
   822     12  AM-STD-AH-TYPE                    PIC XX.
   823     12  AM-EARN-METHODS.
   824         16  AM-EARN-METHOD-R              PIC X.
   825             88 AM-REF-RL-R78                 VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  16
* SOCK04BL.cbl
   826             88 AM-REF-RL-PR                  VALUE 'P'.
   827             88 AM-REF-RL-MEAN                VALUE 'M'.
   828             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   829         16  AM-EARN-METHOD-L              PIC X.
   830             88 AM-REF-LL-R78                 VALUE 'R'.
   831             88 AM-REF-LL-PR                  VALUE 'P'.
   832             88 AM-REF-LL-MEAN                VALUE 'M'.
   833             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   834         16  AM-EARN-METHOD-A              PIC X.
   835             88 AM-REF-AH-R78                 VALUE 'R'.
   836             88 AM-REF-AH-PR                  VALUE 'P'.
   837             88 AM-REF-AH-MEAN                VALUE 'M'.
   838             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   839             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   840             88 AM-REF-AH-NET                 VALUE 'N'.
   841
   842     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   843     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   844     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   845
   846     12  AM-RET-Y-N                        PIC X.
   847     12  AM-RET-P-E                        PIC X.
   848     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   849     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   850     12  AM-RET-GRP                        PIC X(6).
   851     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   852         16  AM-POOL-PRIME                 PIC XXX.
   853         16  AM-POOL-SUB                   PIC XXX.
   854     12  AM-RETRO-EARNINGS.
   855         16  AM-RET-EARN-R                 PIC X.
   856         16  AM-RET-EARN-L                 PIC X.
   857         16  AM-RET-EARN-A                 PIC X.
   858     12  AM-RET-ST-TAX-USE                 PIC X.
   859         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   860         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   861     12  AM-RETRO-BEG-EARNINGS.
   862         16  AM-RET-BEG-EARN-R             PIC X.
   863         16  AM-RET-BEG-EARN-L             PIC X.
   864         16  AM-RET-BEG-EARN-A             PIC X.
   865     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   866     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   867
   868     12  AM-USER-SELECT-OPTIONS.
   869         16  AM-USER-SELECT-1              PIC X(10).
   870         16  AM-USER-SELECT-2              PIC X(10).
   871         16  AM-USER-SELECT-3              PIC X(10).
   872         16  AM-USER-SELECT-4              PIC X(10).
   873         16  AM-USER-SELECT-5              PIC X(10).
   874
   875     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   876
   877     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   878
   879     12  AM-RPT045A-SWITCH                 PIC X.
   880         88  RPT045A-OFF                   VALUE 'N'.
   881
   882     12  AM-INSURANCE-LIMITS.
   883         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  17
* SOCK04BL.cbl
   884         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   885
   886     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   887         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   888
   889     12  AM-DISMBR-COVERAGE-SW             PIC X.
   890         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   891         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   892
   893     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   894
   895     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   896     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   897     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   898     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   899     12  AM-DCC-UEF-STATE                  PIC XX.
   900     12  FILLER                            PIC XXX.
   901     12  AM-REPORT-CODE-3                  PIC X(10).
   902*    12  FILLER                            PIC X(22).
   903
   904     12  AM-RESERVE-DATE.
   905         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   906         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   907         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   908
   909     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   910     12  AM-NOTIFICATION-TYPES.
   911         16  AM-NOTIF-OF-LETTERS           PIC X.
   912         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   913         16  AM-NOTIF-OF-REPORTS           PIC X.
   914         16  AM-NOTIF-OF-STATUS            PIC X.
   915
   916     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   917         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   918         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   919         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   920         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   921
   922     12  AM-BENEFIT-CONTROLS.
   923         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   924             20  AM-BENEFIT-CODE           PIC XX.
   925             20  AM-BENEFIT-TYPE           PIC X.
   926             20  AM-BENEFIT-REVISION       PIC XXX.
   927             20  AM-BENEFIT-REM-TERM       PIC X.
   928             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   929             20  FILLER                    PIC XX.
   930         16  FILLER                        PIC X(80).
   931
   932     12  AM-TRANSFER-DATA.
   933         16  AM-TRANSFERRED-FROM.
   934             20  AM-TRNFROM-CARRIER        PIC X.
   935             20  AM-TRNFROM-GROUPING.
   936                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   937                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   938             20  AM-TRNFROM-STATE          PIC XX.
   939             20  AM-TRNFROM-ACCOUNT.
   940                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   941                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  18
* SOCK04BL.cbl
   942             20  AM-TRNFROM-DTE            PIC XX.
   943         16  AM-TRANSFERRED-TO.
   944             20  AM-TRNTO-CARRIER          PIC X.
   945             20  AM-TRNTO-GROUPING.
   946                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   947                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   948             20  AM-TRNTO-STATE            PIC XX.
   949             20  AM-TRNTO-ACCOUNT.
   950                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   951                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   952             20  AM-TRNTO-DTE              PIC XX.
   953         16  FILLER                        PIC X(10).
   954
   955     12  AM-SAVED-REMIT-TO                 PIC 99.
   956
   957     12  AM-COMM-STRUCTURE-SAVED.
   958         16  AM-DEFN-1-SAVED.
   959             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   960                 24  AM-AGT-SV             PIC X(10).
   961                 24  AM-COM-TYP-SV         PIC X.
   962                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   963                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   964                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   965                 24  AM-RECALC-LV-INDIC-SV PIC X.
   966                 24  FILLER                PIC X.
   967                 24  AM-GL-CODES-SV        PIC X.
   968                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   969                 24  FILLER                PIC X.
   970         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   971             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   972                 24  FILLER                PIC X(11).
   973                 24  AM-L-COMA-SV          PIC XXX.
   974                 24  AM-J-COMA-SV          PIC XXX.
   975                 24  AM-A-COMA-SV          PIC XXX.
   976                 24  FILLER                PIC X(6).
   977
   978     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   979         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   980            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   981            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   982            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   983
   984     12  AM-ORIG-DEALER-NO                 PIC X(10).
   985     12  FILLER                            PIC X(120).
   986
   987     12  AM-ACCOUNT-EXECUTIVE-DATA.
   988         16  AM-CONTROL-NAME               PIC X(30).
   989         16  AM-EXECUTIVE-ONE.
   990             20  AM-EXEC1-NAME             PIC X(15).
   991             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   992                                                          COMP-3.
   993             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   994                                                          COMP-3.
   995         16  AM-EXECUTIVE-TWO.
   996             20  AM-EXEC2-NAME             PIC X(15).
   997             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   998                                                          COMP-3.
   999             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  19
* SOCK04BL.cbl
  1000                                                          COMP-3.
  1001
  1002     12  AM-RETRO-ADDITIONAL-DATA.
  1003         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1004         16  AM-RETRO-PREM-P-E             PIC X.
  1005         16  AM-RETRO-CLMS-P-I             PIC X.
  1006         16  AM-RETRO-RET-BRACKET-LF.
  1007             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1008                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1009                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1010             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1011                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1012                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1013             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1014                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1015                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1016         16  AM-RETRO-RET-BRACKET-AH.
  1017             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1018                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1019                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1020                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1021             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1022                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1023                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1024             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1025                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1026                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1027
  1028     12  AM-COMMENTS.
  1029         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1030
  1031     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1032         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1033         16  AM-FLI-BILLING-CODE           PIC X.
  1034         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1035         16  AM-FLI-UNITED-IDENT           PIC X.
  1036         16  AM-FLI-INTEREST-LOST-DATA.
  1037             20  AM-FLI-BANK-NO            PIC X(5).
  1038             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1039             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1040             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1041         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1042             20  AM-FLI-AGT                PIC X(9).
  1043             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1044             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1045         16  FILLER                        PIC X(102).
  1046
  1047     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1048         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1049             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1050             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1051             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1052             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1053             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1054         16  FILLER                          PIC X(10).
  1055******************************************************************
  1056*                                 COPY ERCCOMP.
  1057******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  20
* SOCK04BL.cbl
  1058*                                                                *
  1059*                                                                *
  1060*                            ERCCOMP                             *
  1061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1062*                            VMOD=2.019                          *
  1063*                                                                *
  1064*   ONLINE CREDIT SYSTEM                                         *
  1065*                                                                *
  1066*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1067*                                                                *
  1068*   FILE TYPE = VSAM,KSDS                                        *
  1069*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1070*                                                                *
  1071*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1072*       ALTERNATE PATH = NONE                                    *
  1073*                                                                *
  1074*   LOG = NO                                                     *
  1075*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1076*                                                                *
  1077******************************************************************
  1078*                   C H A N G E   L O G
  1079*
  1080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1081*-----------------------------------------------------------------
  1082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1083* EFFECTIVE    NUMBER
  1084*-----------------------------------------------------------------
  1085* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1086* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1087* 092205    2005050300006  PEMA  ADD LEASE FEE
  1088* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1089* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1090* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1091* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1092* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1093* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1094******************************************************************
  1095
  1096 01  COMPENSATION-MASTER.
  1097     12  CO-RECORD-ID                          PIC XX.
  1098         88  VALID-CO-ID                          VALUE 'CO'.
  1099
  1100     12  CO-CONTROL-PRIMARY.
  1101         16  CO-COMPANY-CD                     PIC X.
  1102         16  CO-CONTROL.
  1103             20  CO-CTL-1.
  1104                 24  CO-CARR-GROUP.
  1105                     28  CO-CARRIER            PIC X.
  1106                     28  CO-GROUPING.
  1107                         32  CO-GROUP-PREFIX   PIC XXX.
  1108                         32  CO-GROUP-PRIME    PIC XXX.
  1109                 24  CO-RESP-NO.
  1110                     28  CO-RESP-PREFIX        PIC X(4).
  1111                     28  CO-RESP-PRIME         PIC X(6).
  1112             20  CO-CTL-2.
  1113                 24  CO-ACCOUNT.
  1114                     28  CO-ACCT-PREFIX        PIC X(4).
  1115                     28  CO-ACCT-PRIME         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  21
* SOCK04BL.cbl
  1116         16  CO-TYPE                           PIC X.
  1117             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1118             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1119             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1120
  1121     12  CO-MAINT-INFORMATION.
  1122         16  CO-LAST-MAINT-DT                  PIC XX.
  1123         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1124         16  CO-LAST-MAINT-USER                PIC X(4).
  1125     12  FILLER                                PIC XX.
  1126     12  CO-STMT-TYPE                          PIC XXX.
  1127     12  CO-COMP-TYPE                          PIC X.
  1128         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1129     12  CO-STMT-OWNER                         PIC X(4).
  1130     12  CO-BALANCE-CONTROL                    PIC X.
  1131         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1132         88  CO-NO-BALANCE                        VALUE 'N'.
  1133
  1134     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1135         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1136         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1137         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1138
  1139     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1140         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1141         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1142
  1143     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1144     12  CO-GA-DIRECT-DEP                      PIC X.
  1145     12  CO-FUTURE-SPACE                       PIC X.
  1146         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1147
  1148     12  CO-ACCT-NAME                          PIC X(30).
  1149     12  CO-MAIL-NAME                          PIC X(30).
  1150     12  CO-ADDR-1                             PIC X(30).
  1151     12  CO-ADDR-2                             PIC X(30).
  1152     12  CO-ADDR-3.
  1153         16  CO-ADDR-CITY                      PIC X(27).
  1154         16  CO-ADDR-STATE                     PIC XX.
  1155     12  CO-CSO-1099                           PIC X.
  1156     12  CO-ZIP.
  1157         16  CO-ZIP-PRIME.
  1158             20  CO-ZIP-PRI-1ST                PIC X.
  1159                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1160             20  FILLER                        PIC X(4).
  1161         16  CO-ZIP-PLUS4                      PIC X(4).
  1162     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1163         16  CO-CAN-POSTAL-1                   PIC XXX.
  1164         16  CO-CAN-POSTAL-2                   PIC XXX.
  1165         16  FILLER                            PIC XXX.
  1166     12  CO-SOC-SEC                            PIC X(13).
  1167     12  CO-TELEPHONE.
  1168         16  CO-AREA-CODE                      PIC XXX.
  1169         16  CO-PREFIX                         PIC XXX.
  1170         16  CO-PHONE                          PIC X(4).
  1171
  1172     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1173
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  22
* SOCK04BL.cbl
  1174     12  CO-AR-BAL-LEVEL                       PIC X.
  1175         88  CO-AR-REF-LVL                        VALUE '1'.
  1176         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1177         88  CO-AR-BILL-LVL                       VALUE '2'.
  1178         88  CO-AR-AGT-LVL                        VALUE '3'.
  1179         88  CO-AR-FR-LVL                         VALUE '4'.
  1180
  1181     12  CO-AR-NORMAL-PRINT                    PIC X.
  1182         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1183         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1184
  1185     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1186
  1187     12  CO-AR-REPORTING                       PIC X.
  1188         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1189         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1190
  1191     12  CO-AR-PULL-CHECK                      PIC X.
  1192         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1193         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1194
  1195     12  CO-AR-BALANCE-PRINT                   PIC X.
  1196         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1197
  1198     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1199         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1200         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1201         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1202
  1203     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1204
  1205     12  CO-USER-CODE                          PIC X.
  1206     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1207
  1208******************************************************************
  1209*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1210*    THE LAST MONTH END RUN.
  1211******************************************************************
  1212
  1213     12  CO-LAST-ACTIVITY-DATE.
  1214         16  CO-ACT-YEAR                       PIC 99.
  1215         16  CO-ACT-MONTH                      PIC 99.
  1216         16  CO-ACT-DAY                        PIC 99.
  1217
  1218     12  CO-LAST-STMT-DT.
  1219         16  CO-LAST-STMT-YEAR                 PIC 99.
  1220         16  CO-LAST-STMT-MONTH                PIC 99.
  1221         16  CO-LAST-STMT-DAY                  PIC 99.
  1222
  1223     12  CO-MO-END-TOTALS.
  1224         16  CO-MONTHLY-TOTALS.
  1225             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1226             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1227             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1228             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1229             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1230
  1231         16  CO-AGING-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  23
* SOCK04BL.cbl
  1232             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1233             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1234             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1235             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1236
  1237         16  CO-YTD-TOTALS.
  1238             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1239             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1240
  1241         16  CO-OVER-UNDER-TOTALS.
  1242             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1243             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1244
  1245     12  CO-MISCELLANEOUS-TOTALS.
  1246         16  CO-FICA-TOTALS.
  1247             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1248             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1249
  1250         16  CO-CLAIM-TOTALS.
  1251             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1252             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1253
  1254******************************************************************
  1255*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1256*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1257******************************************************************
  1258
  1259     12  CO-CURRENT-TOTALS.
  1260         16  CO-CURRENT-LAST-STMT-DT.
  1261             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1262             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1263             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1264
  1265         16  CO-CURRENT-MONTHLY-TOTALS.
  1266             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1267             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1268             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1269             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1270             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1271
  1272         16  CO-CURRENT-AGING-TOTALS.
  1273             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1274             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1275             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1276             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1277
  1278         16  CO-CURRENT-YTD-TOTALS.
  1279             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1280             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1281
  1282     12  CO-PAID-COMM-TOTALS.
  1283         16  CO-YTD-PAID-COMMS.
  1284             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1285             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1286
  1287     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1288         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1289         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  24
* SOCK04BL.cbl
  1290
  1291     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1292         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1293         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1294         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1295         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1296         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1297         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1298         88  CO-FINAL-LETTER                  VALUE 'F'.
  1299         88  CO-RECONCILING                   VALUE 'R'.
  1300         88  CO-PHONE-CALL                    VALUE 'P'.
  1301         88  CO-LEGAL                         VALUE 'L'.
  1302         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1303         88  CO-WRITE-OFF                     VALUE 'W'.
  1304         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1305
  1306     12  CO-CSR-CODE                       PIC X(4).
  1307
  1308     12  CO-GA-STATUS-INFO.
  1309         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1310         16  CO-GA-TERMINATION-DT          PIC XX.
  1311         16  CO-GA-STATUS-CODE             PIC X.
  1312             88  CO-GA-ACTIVE                 VALUE 'A'.
  1313             88  CO-GA-INACTIVE               VALUE 'I'.
  1314             88  CO-GA-PENDING                VALUE 'P'.
  1315         16  CO-GA-COMMENTS.
  1316             20  CO-GA-COMMENT-1           PIC X(40).
  1317             20  CO-GA-COMMENT-2           PIC X(40).
  1318             20  CO-GA-COMMENT-3           PIC X(40).
  1319             20  CO-GA-COMMENT-4           PIC X(40).
  1320
  1321     12  CO-RPTCD2                         PIC X(10).
  1322     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1323         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1324         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1325
  1326     12  CO-TYPE-AGENT                     PIC X(01).
  1327         88  CO-CORPORATION                   VALUE 'C'.
  1328         88  CO-PARTNERSHIP                   VALUE 'P'.
  1329         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1330         88  CO-TRUST                         VALUE 'T'.
  1331         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1332
  1333     12  CO-FAXNO.
  1334         16  CO-FAX-AREA-CODE                  PIC XXX.
  1335         16  CO-FAX-PREFIX                     PIC XXX.
  1336         16  CO-FAX-PHONE                      PIC X(4).
  1337
  1338     12  CO-BANK-INFORMATION.
  1339         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1340         16  CO-BANK-TRANSIT-NON REDEFINES
  1341             CO-BANK-TRANSIT-NO                PIC 9(8).
  1342
  1343         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1344     12  CO-MISC-DEDUCT-INFO REDEFINES
  1345                  CO-BANK-INFORMATION.
  1346         16  CO-MD-GL-ACCT                     PIC X(10).
  1347         16  CO-MD-DIV                         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  25
* SOCK04BL.cbl
  1348         16  CO-MD-CENTER                      PIC X(4).
  1349         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1350         16  CO-CREATE-AP-CHECK                PIC X.
  1351         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1352         16  FILLER                            PIC XXX.
  1353     12  CO-ACH-STATUS                         PIC X.
  1354         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1355         88  CO-ACH-PENDING                        VALUE 'P'.
  1356
  1357     12  CO-BILL-SW                            PIC X.
  1358     12  CO-CONTROL-NAME                       PIC X(30).
  1359     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1360     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1361     12  CO-CLP-STATE                          PIC XX.
  1362     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1363     12  CO-SPP-REFUND-EDIT                    PIC X.
  1364
  1365******************************************************************
  1366*                                 COPY ERCCNOT.
  1367******************************************************************
  1368*                                                                *
  1369*                            ERCCNOT                             *
  1370*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1371*                            VMOD=2.003                          *
  1372*                                                                *
  1373*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1374*                                                                *
  1375*        FILE TYPE= VSAM,KSDS                                    *
  1376*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1377*                                                                *
  1378*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1379*                                                                *
  1380*        LOG = YES                                               *
  1381*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1382*                                                                *
  1383******************************************************************
  1384*                   C H A N G E   L O G
  1385*
  1386* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1387*-----------------------------------------------------------------
  1388*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1389* EFFECTIVE    NUMBER
  1390*-----------------------------------------------------------------
  1391* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1392******************************************************************
  1393
  1394 01  CERT-NOTE-FILE.
  1395     12  CZ-RECORD-ID                PIC  XX.
  1396         88  VALID-CZ-ID                  VALUE 'CZ'.
  1397
  1398     12  CZ-CONTROL-PRIMARY.
  1399         16  CZ-COMPANY-CD           PIC X.
  1400         16  CZ-CARRIER              PIC X.
  1401         16  CZ-GROUPING.
  1402             20 CZ-GROUPING-PREFIX   PIC XXX.
  1403             20 CZ-GROUPING-PRIME    PIC XXX.
  1404         16  CZ-STATE                PIC XX.
  1405         16  CZ-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  26
* SOCK04BL.cbl
  1406             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1407             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1408         16  CZ-CERT-EFF-DT          PIC XX.
  1409         16  CZ-CERT-NO.
  1410             20  CZ-CERT-PRIME       PIC X(10).
  1411             20  CZ-CERT-SFX         PIC X.
  1412         16  CZ-RECORD-TYPE          PIC X.
  1413             88  CERT-NOTE           VALUE '1'.
  1414             88  CLAIM-CERT-NOTE     VALUE '2'.
  1415         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1416
  1417     12  CZ-LAST-MAINT-DT            PIC XX.
  1418     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1419     12  CZ-LAST-MAINT-USER          PIC X(4).
  1420
  1421     12  CZ-NOTE-INFORMATION.
  1422         16  CZ-NOTE                 PIC X(63).
  1423         16  FILLER                  PIC X(39).
  1424******************************************************************
  1425*                                 COPY ELCDATE.
  1426******************************************************************
  1427*                                                                *
  1428*                                                                *
  1429*                            ELCDATE.                            *
  1430*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1431*                            VMOD=2.003
  1432*                                                                *
  1433*                                                                *
  1434*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1435*                 LENGTH = 200                                   *
  1436******************************************************************
  1437
  1438 01  DATE-CONVERSION-DATA.
  1439     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1440     12  DC-OPTION-CODE                PIC X.
  1441         88  BIN-TO-GREG                VALUE ' '.
  1442         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1443         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1444         88  YMD-GREG-TO-BIN            VALUE '3'.
  1445         88  MDY-GREG-TO-BIN            VALUE '4'.
  1446         88  JULIAN-TO-BIN              VALUE '5'.
  1447         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1448         88  FIND-CENTURY               VALUE '7'.
  1449         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1450         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1451         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1452         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1453         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1454         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1455         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1456         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1457         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1458         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1459         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1460         88  BIN-3-TO-GREG              VALUE 'I'.
  1461         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1462         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1463         88  CYMD-GREG-TO-BIN           VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  27
* SOCK04BL.cbl
  1464         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1465         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1466         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1467         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1468         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1469         88  THREE-CHARACTER-BIN
  1470                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1471         88  GREGORIAN-TO-BIN
  1472                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1473         88  BIN-TO-GREGORIAN
  1474                  VALUES ' ' '1' 'I' '8' 'G'.
  1475         88  JULIAN-TO-BINARY
  1476                  VALUES '5' 'C' 'E' 'F'.
  1477     12  DC-ERROR-CODE                 PIC X.
  1478         88  NO-CONVERSION-ERROR        VALUE ' '.
  1479         88  DATE-CONVERSION-ERROR
  1480                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1481         88  DATE-IS-ZERO               VALUE '1'.
  1482         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1483         88  DATE-IS-INVALID            VALUE '3'.
  1484         88  DATE1-GREATER-DATE2        VALUE '4'.
  1485         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1486         88  DATE-INVALID-OPTION        VALUE '9'.
  1487         88  INVALID-CENTURY            VALUE 'A'.
  1488         88  ONLY-CENTURY               VALUE 'B'.
  1489         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1490         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1491     12  DC-END-OF-MONTH               PIC X.
  1492         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1493     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1494         88  USE-NORMAL-PROCESS         VALUE ' '.
  1495         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1496         88  ADJUST-UP-100-YRS          VALUE '2'.
  1497     12  FILLER                        PIC X.
  1498     12  DC-CONVERSION-DATES.
  1499         16  DC-BIN-DATE-1             PIC XX.
  1500         16  DC-BIN-DATE-2             PIC XX.
  1501         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1502         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1503                       DC-GREG-DATE-1-EDIT.
  1504             20  DC-EDIT1-MONTH        PIC 99.
  1505             20  SLASH1-1              PIC X.
  1506             20  DC-EDIT1-DAY          PIC 99.
  1507             20  SLASH1-2              PIC X.
  1508             20  DC-EDIT1-YEAR         PIC 99.
  1509         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1510         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1511                     DC-GREG-DATE-2-EDIT.
  1512             20  DC-EDIT2-MONTH        PIC 99.
  1513             20  SLASH2-1              PIC X.
  1514             20  DC-EDIT2-DAY          PIC 99.
  1515             20  SLASH2-2              PIC X.
  1516             20  DC-EDIT2-YEAR         PIC 99.
  1517         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1518         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1519                     DC-GREG-DATE-1-YMD.
  1520             20  DC-YMD-YEAR           PIC 99.
  1521             20  DC-YMD-MONTH          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  28
* SOCK04BL.cbl
  1522             20  DC-YMD-DAY            PIC 99.
  1523         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1524         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1525                      DC-GREG-DATE-1-MDY.
  1526             20  DC-MDY-MONTH          PIC 99.
  1527             20  DC-MDY-DAY            PIC 99.
  1528             20  DC-MDY-YEAR           PIC 99.
  1529         16  DC-GREG-DATE-1-ALPHA.
  1530             20  DC-ALPHA-MONTH        PIC X(10).
  1531             20  DC-ALPHA-DAY          PIC 99.
  1532             20  FILLER                PIC XX.
  1533             20  DC-ALPHA-CENTURY.
  1534                 24 DC-ALPHA-CEN-N     PIC 99.
  1535             20  DC-ALPHA-YEAR         PIC 99.
  1536         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1537         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1538         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1539         16  DC-JULIAN-DATE            PIC 9(05).
  1540         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1541                                       PIC 9(05).
  1542         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1543             20  DC-JULIAN-YEAR        PIC 99.
  1544             20  DC-JULIAN-DAYS        PIC 999.
  1545         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1546         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1547         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1548     12  DATE-CONVERSION-VARIBLES.
  1549         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1550         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1551             20  FILLER                PIC 9(3).
  1552             20  HOLD-CEN-1-CCYY.
  1553                 24  HOLD-CEN-1-CC     PIC 99.
  1554                 24  HOLD-CEN-1-YY     PIC 99.
  1555             20  HOLD-CEN-1-MO         PIC 99.
  1556             20  HOLD-CEN-1-DA         PIC 99.
  1557         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1558             20  HOLD-CEN-1-R-MO       PIC 99.
  1559             20  HOLD-CEN-1-R-DA       PIC 99.
  1560             20  HOLD-CEN-1-R-CCYY.
  1561                 24  HOLD-CEN-1-R-CC   PIC 99.
  1562                 24  HOLD-CEN-1-R-YY   PIC 99.
  1563             20  FILLER                PIC 9(3).
  1564         16  HOLD-CENTURY-1-X.
  1565             20  FILLER                PIC X(3)  VALUE SPACES.
  1566             20  HOLD-CEN-1-X-CCYY.
  1567                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1568                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1569             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1570             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1571         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1572             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1573             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1574             20  HOLD-CEN-1-R-X-CCYY.
  1575                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1576                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1577             20  FILLER                PIC XXX.
  1578         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1579         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  29
* SOCK04BL.cbl
  1580         16  DC-JULIAN-DATE-1          PIC 9(07).
  1581         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1582             20  DC-JULIAN-1-CCYY.
  1583                 24  DC-JULIAN-1-CC    PIC 99.
  1584                 24  DC-JULIAN-1-YR    PIC 99.
  1585             20  DC-JULIAN-DA-1        PIC 999.
  1586         16  DC-JULIAN-DATE-2          PIC 9(07).
  1587         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1588             20  DC-JULIAN-2-CCYY.
  1589                 24  DC-JULIAN-2-CC    PIC 99.
  1590                 24  DC-JULIAN-2-YR    PIC 99.
  1591             20  DC-JULIAN-DA-2        PIC 999.
  1592         16  DC-GREG-DATE-A-EDIT.
  1593             20  DC-EDITA-MONTH        PIC 99.
  1594             20  SLASHA-1              PIC X VALUE '/'.
  1595             20  DC-EDITA-DAY          PIC 99.
  1596             20  SLASHA-2              PIC X VALUE '/'.
  1597             20  DC-EDITA-CCYY.
  1598                 24  DC-EDITA-CENT     PIC 99.
  1599                 24  DC-EDITA-YEAR     PIC 99.
  1600         16  DC-GREG-DATE-B-EDIT.
  1601             20  DC-EDITB-MONTH        PIC 99.
  1602             20  SLASHB-1              PIC X VALUE '/'.
  1603             20  DC-EDITB-DAY          PIC 99.
  1604             20  SLASHB-2              PIC X VALUE '/'.
  1605             20  DC-EDITB-CCYY.
  1606                 24  DC-EDITB-CENT     PIC 99.
  1607                 24  DC-EDITB-YEAR     PIC 99.
  1608         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1609         16  DC-GREG-DATE-CYMD-R REDEFINES
  1610                              DC-GREG-DATE-CYMD.
  1611             20  DC-CYMD-CEN           PIC 99.
  1612             20  DC-CYMD-YEAR          PIC 99.
  1613             20  DC-CYMD-MONTH         PIC 99.
  1614             20  DC-CYMD-DAY           PIC 99.
  1615         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1616         16  DC-GREG-DATE-MDCY-R REDEFINES
  1617                              DC-GREG-DATE-MDCY.
  1618             20  DC-MDCY-MONTH         PIC 99.
  1619             20  DC-MDCY-DAY           PIC 99.
  1620             20  DC-MDCY-CEN           PIC 99.
  1621             20  DC-MDCY-YEAR          PIC 99.
  1622    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1623        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1624    12  DC-EL310-DATE                  PIC X(21).
  1625    12  FILLER                         PIC X(28).
  1626****************************************************************
  1627*
  1628* Copyright (c) 2007 by Clerity Solutions, Inc.
  1629* All rights reserved.
  1630*
  1631****************************************************************
  1632 01  DFHEIV.
  1633   02  DFHEIV0               PIC X(35).
  1634   02  DFHEIV1               PIC X(08).
  1635   02  DFHEIV2               PIC X(08).
  1636   02  DFHEIV3               PIC X(08).
  1637   02  DFHEIV4               PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  30
* SOCK04BL.cbl
  1638   02  DFHEIV5               PIC X(04).
  1639   02  DFHEIV6               PIC X(04).
  1640   02  DFHEIV7               PIC X(02).
  1641   02  DFHEIV8               PIC X(02).
  1642   02  DFHEIV9               PIC X(01).
  1643   02  DFHEIV10              PIC S9(7) COMP-3.
  1644   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1645   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1646   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1647   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1648   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1649   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1650   02  DFHEIV17              PIC X(04).
  1651   02  DFHEIV18              PIC X(04).
  1652   02  DFHEIV19              PIC X(04).
  1653   02  DFHEIV20              USAGE IS POINTER.
  1654   02  DFHEIV21              USAGE IS POINTER.
  1655   02  DFHEIV22              USAGE IS POINTER.
  1656   02  DFHEIV23              USAGE IS POINTER.
  1657   02  DFHEIV24              USAGE IS POINTER.
  1658   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1659   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1660   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1661   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1662   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1663   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1664   02  FILLER                PIC X(02).
  1665   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1666   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1667   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1668   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1669   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1670 LINKAGE  SECTION.
  1671*****************************************************************
  1672*                                                               *
  1673* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1674* All rights reserved.                                          *
  1675*                                                               *
  1676*****************************************************************
  1677 01  dfheiblk.
  1678     02  eibtime          pic s9(7) comp-3.
  1679     02  eibdate          pic s9(7) comp-3.
  1680     02  eibtrnid         pic x(4).
  1681     02  eibtaskn         pic s9(7) comp-3.
  1682     02  eibtrmid         pic x(4).
  1683     02  dfheigdi         pic s9(4) comp.
  1684     02  eibcposn         pic s9(4) comp.
  1685     02  eibcalen         pic s9(4) comp.
  1686     02  eibaid           pic x(1).
  1687     02  eibfiller1       pic x(1).
  1688     02  eibfn            pic x(2).
  1689     02  eibfiller2       pic x(2).
  1690     02  eibrcode         pic x(6).
  1691     02  eibfiller3       pic x(2).
  1692     02  eibds            pic x(8).
  1693     02  eibreqid         pic x(8).
  1694     02  eibrsrce         pic x(8).
  1695     02  eibsync          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  31
* SOCK04BL.cbl
  1696     02  eibfree          pic x(1).
  1697     02  eibrecv          pic x(1).
  1698     02  eibsend          pic x(1).
  1699     02  eibatt           pic x(1).
  1700     02  eibeoc           pic x(1).
  1701     02  eibfmh           pic x(1).
  1702     02  eibcompl         pic x(1).
  1703     02  eibsig           pic x(1).
  1704     02  eibconf          pic x(1).
  1705     02  eiberr           pic x(1).
  1706     02  eibrldbk         pic x(1).
  1707     02  eiberrcd         pic x(4).
  1708     02  eibsynrb         pic x(1).
  1709     02  eibnodat         pic x(1).
  1710     02  eibfiller5       pic x(2).
  1711     02  eibresp          pic 9(09) comp.
  1712     02  eibresp2         pic 9(09) comp.
  1713     02  dfheigdj         pic s9(4) comp.
  1714     02  dfheigdk         pic s9(4) comp.
  1715 01  DFHCOMMAREA.
  1716*                                copy SOCK04-COMMAREA.
  1717*****************************************************************
  1718*                                                               *
  1719* Copyright (c) 2015 by CSO.                                    *
  1720* All rights reserved.                                          *
  1721*                                                               *
  1722*****************************************************************
  1723****************************************
  1724*  commarea for SOCK04.cl2
  1725*  (business logic input & output)
  1726****************************************
  1727 03  socket-commarea.
  1728     05 sock-IN-DATA.
  1729         10  sock-CAR          PIC X.
  1730         10  sock-GRP          PIC X(6).
  1731         10  sock-ST           PIC XX.
  1732         10  sock-ACT          PIC X(10).
  1733         10  sock-EFF-DT       PIC X(8).
  1734         10  sock-cert-no      pic x(11).
  1735         10  sock-ID           PIC XXX.
  1736         10  sock-proc-id      pic x(4).
  1737         10  sock-ACTION-TAKEN PIC X.
  1738         10  FILLER              PIC X(9).
  1739     05  sock-return-area.
  1740         10  sock-am-name        pic x(30).
  1741         10  sock-am-person      pic x(30).
  1742         10  sock-am-cntrl-name  pic x(30).
  1743         10  sock-am-phone       pic x(10).
  1744         10  sock-co-fax         pic x(10).
  1745         10  sock-co-contact     pic x(30).
  1746 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1747 0000-DFHEXIT SECTION.
  1748     MOVE '9#                    $   ' TO DFHEIV0.
  1749     MOVE 'SOCK04BL' TO DFHEIV1.
  1750     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1751     display ' Begin SOCK04BL =' SOCK-IN-DATA '='
  1752     perform 0010-init           thru 0010-exit
  1753     perform 0100-process-request thru 0100-exit
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  32
* SOCK04BL.cbl
  1754     GO TO cics-return
  1755     .
  1756 0010-init.
  1757
  1758* exec cics
  1759*       asktime
  1760*    end-exec
  1761*    MOVE '0"                    "   #00001753' TO DFHEIV0
  1762     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  1763     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1764     MOVE X'2020233030303031373533' TO DFHEIV0(25:11)
  1765     CALL 'kxdfhei1' USING DFHEIV0,
  1766           DFHEIV99
  1767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1768     display ' eibtime ' eibtime
  1769     display ' eibdate ' eibdate
  1770     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1771     MOVE '5'                    TO DC-OPTION-CODE
  1772     perform 9700-date-link      thru 9700-exit
  1773     IF DATE-CONVERSION-ERROR
  1774        display ' error converting eibdate '
  1775        MOVE LOW-VALUES          TO ws-current-bin-dt
  1776     ELSE
  1777        MOVE DC-BIN-DATE-1       TO ws-current-bin-dt
  1778     end-if
  1779     move sock-id                to ws-comp-id
  1780     if sock-id = 'DCC'
  1781        move X'05'               to ws-comp-cd
  1782     else
  1783        if sock-id = 'AHL'
  1784           move X'06'            to ws-comp-cd
  1785        else
  1786           move X'04'            to ws-comp-cd
  1787        end-if
  1788     end-if
  1789     move sock-eff-dt            to dc-greg-date-1-edit
  1790     move '2'                    to dc-option-code
  1791     perform 9700-date-link      thru 9700-exit
  1792     if not no-conversion-error
  1793        display ' error converting eff date '
  1794        go to cics-return
  1795     end-if
  1796     move dc-bin-date-1          to ws-bin-cert-eff-dt
  1797     .
  1798 0010-exit.
  1799     exit.
  1800 0100-process-request.
  1801     perform 0110-get-elcert     thru 0110-exit
  1802     if resp-normal
  1803        perform 0120-process-cert-trailer
  1804                                 thru 0120-exit
  1805        perform 0150-process-cert-notes
  1806                                 thru 0150-exit
  1807        perform 0200-process-acct-comp
  1808                                 thru 0200-exit
  1809     end-if
  1810     .
  1811 0100-exit.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  33
* SOCK04BL.cbl
  1812     exit.
  1813 0110-get-elcert.
  1814*    display ' made it to 0110-get-elcert '
  1815     move low-values             to ws-cm-key
  1816     move ws-comp-cd             to ws-cm-company-cd
  1817     move sock-car               to ws-cm-carrier
  1818     move sock-grp               to ws-cm-group
  1819     move sock-st                to ws-cm-state
  1820     move sock-act               to ws-cm-account
  1821     move ws-bin-cert-eff-dt     to ws-cm-eff-dt
  1822     move sock-cert-no           to ws-cm-cert-no
  1823
  1824* EXEC CICS READ
  1825*         INTO    (CERTIFICATE-MASTER)
  1826*         DATASET ('ELCERT')
  1827*         RIDFLD  (WS-CM-KEY)
  1828*         RESP    (WS-RESPONSE)
  1829*    END-EXEC
  1830     MOVE LENGTH OF
  1831      CERTIFICATE-MASTER
  1832       TO DFHEIV11
  1833     MOVE 'ELCERT' TO DFHEIV1
  1834*    MOVE '&"IL       E          (  N#00001811' TO DFHEIV0
  1835     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1836     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1837     MOVE X'204E233030303031383131' TO DFHEIV0(25:11)
  1838     CALL 'kxdfhei1' USING DFHEIV0,
  1839           DFHEIV1,
  1840           CERTIFICATE-MASTER,
  1841           DFHEIV11,
  1842           WS-CM-KEY,
  1843           DFHEIV99,
  1844           DFHEIV99,
  1845           DFHEIV99
  1846     MOVE EIBRESP  TO WS-RESPONSE
  1847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1848     .
  1849 0110-exit.
  1850     exit.
  1851 0120-process-cert-trailer.
  1852*    display ' made it to 0120-process cert '
  1853     perform 0121-read-elcrtt    thru 0121-exit
  1854     evaluate true
  1855        when resp-normal
  1856           perform 0122-upd-elcrtt
  1857                                 thru 0122-exit
  1858        when resp-notfnd
  1859           perform 0123-add-elcrtt
  1860                                 thru 0123-exit
  1861        when other
  1862           display ' error cert trlr ' ws-response
  1863           go to cics-return
  1864     end-evaluate
  1865     .
  1866 0120-exit.
  1867     exit.
  1868 0121-read-elcrtt.
  1869*    display ' made it to 0121-read elcrtt  '
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  34
* SOCK04BL.cbl
  1870     move cm-control-primary     to ws-cs-key
  1871     move 'C'                    to ws-cs-trlr-type
  1872
  1873* EXEC CICS READ
  1874*       UPDATE
  1875*       INTO    (CERTIFICATE-TRAILERS)
  1876*       DATASET ('ELCRTT')
  1877*       RIDFLD  (WS-CS-KEY)
  1878*       RESP    (WS-RESPONSE)
  1879*    END-EXEC
  1880     MOVE LENGTH OF
  1881      CERTIFICATE-TRAILERS
  1882       TO DFHEIV11
  1883     MOVE 'ELCRTT' TO DFHEIV1
  1884*    MOVE '&"IL       EU         (  N#00001841' TO DFHEIV0
  1885     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1886     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1887     MOVE X'204E233030303031383431' TO DFHEIV0(25:11)
  1888     CALL 'kxdfhei1' USING DFHEIV0,
  1889           DFHEIV1,
  1890           CERTIFICATE-TRAILERS,
  1891           DFHEIV11,
  1892           WS-CS-KEY,
  1893           DFHEIV99,
  1894           DFHEIV99,
  1895           DFHEIV99
  1896     MOVE EIBRESP  TO WS-RESPONSE
  1897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1898     .
  1899 0121-exit.
  1900     exit.
  1901 0122-upd-elcrtt.
  1902*    display ' made it to 0122-upd-elcrtt   '
  1903     move sock-action-taken      to cs-agent-edit-status
  1904     if cs-agent-edit-status = 'C' or 'S' or 'U' or 'R' or
  1905                               'M' or 'N'
  1906        move spaces              to cs-agent-name
  1907                                    cs-license-no
  1908                                    cs-npn-number
  1909     end-if
  1910     evaluate cs-agent-edit-status
  1911        when 'U'
  1912           move 'Unidentified'   to cs-agent-name
  1913        when 'R'
  1914           move 'Returned'       to cs-agent-name
  1915        when 'N'
  1916           move 'Accept with no commission'
  1917                                 to cs-agent-name
  1918     end-evaluate
  1919
  1920* EXEC CICS REWRITE
  1921*       DATASET ('ELCRTT')
  1922*       FROM    (CERTIFICATE-TRAILERS)
  1923*       RESP    (WS-RESPONSE)
  1924*    END-EXEC
  1925     MOVE LENGTH OF
  1926      CERTIFICATE-TRAILERS
  1927       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  35
* SOCK04BL.cbl
  1928     MOVE 'ELCRTT' TO DFHEIV1
  1929*    MOVE '&& L                  %  N#00001869' TO DFHEIV0
  1930     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1931     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1932     MOVE X'204E233030303031383639' TO DFHEIV0(25:11)
  1933     CALL 'kxdfhei1' USING DFHEIV0,
  1934           DFHEIV1,
  1935           CERTIFICATE-TRAILERS,
  1936           DFHEIV11,
  1937           DFHEIV99
  1938     MOVE EIBRESP  TO WS-RESPONSE
  1939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1940     .
  1941 0122-exit.
  1942     exit.
  1943 0123-add-elcrtt.
  1944*    display ' made it to 0123-add elcrtt   '
  1945     move 'CS'                   to certificate-trailers
  1946     move cm-control-primary     to cs-control-primary
  1947     move 'C'                    to cs-trailer-type
  1948     move sock-action-taken    to cs-agent-edit-status
  1949     evaluate cs-agent-edit-status
  1950        when 'U'
  1951           move 'Unidentified'   to cs-agent-name
  1952        when 'R'
  1953           move 'Returned'       to cs-agent-name
  1954        when 'N'
  1955           move 'Accept with no commission'
  1956                                 to cs-agent-name
  1957     end-evaluate
  1958
  1959* EXEC CICS WRITE
  1960*       DATASET ('ELCRTT')
  1961*       FROM    (CERTIFICATE-TRAILERS)
  1962*       RIDFLD  (cs-control-primary)
  1963*       RESP    (WS-RESPONSE)
  1964*    END-EXEC
  1965     MOVE LENGTH OF
  1966      CERTIFICATE-TRAILERS
  1967       TO DFHEIV11
  1968     MOVE 'ELCRTT' TO DFHEIV1
  1969*    MOVE '&$ L                  ''  N#00001892' TO DFHEIV0
  1970     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1971     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1972     MOVE X'204E233030303031383932' TO DFHEIV0(25:11)
  1973     CALL 'kxdfhei1' USING DFHEIV0,
  1974           DFHEIV1,
  1975           CERTIFICATE-TRAILERS,
  1976           DFHEIV11,
  1977           cs-control-primary,
  1978           DFHEIV99,
  1979           DFHEIV99
  1980     MOVE EIBRESP  TO WS-RESPONSE
  1981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1982     .
  1983 0123-exit.
  1984     exit.
  1985 0150-process-cert-notes.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  36
* SOCK04BL.cbl
  1986*    display ' made it to 0150 process cert notes '
  1987     move spaces                 to cert-note-records-holder
  1988                                    ws-build-note-sw
  1989                                    ws-ercnot-sw
  1990     move cm-control-primary     to ws-cz-key
  1991     move '1'                    to ws-cz-rec-type
  1992     move +0                     to ws-cz-note-seq
  1993                                    c1
  1994
  1995* EXEC CICS STARTBR
  1996*         DATASET    ('ERCNOT')
  1997*         RIDFLD     (WS-CZ-KEY)
  1998*         GTEQ
  1999*         RESP       (WS-RESPONSE)
  2000*    END-EXEC
  2001     MOVE 'ERCNOT' TO DFHEIV1
  2002     MOVE 0
  2003       TO DFHEIV11
  2004*    MOVE '&,         G          &  N#00001910' TO DFHEIV0
  2005     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2006     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2007     MOVE X'204E233030303031393130' TO DFHEIV0(25:11)
  2008     CALL 'kxdfhei1' USING DFHEIV0,
  2009           DFHEIV1,
  2010           WS-CZ-KEY,
  2011           DFHEIV99,
  2012           DFHEIV11,
  2013           DFHEIV99
  2014     MOVE EIBRESP  TO WS-RESPONSE
  2015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2016     IF RESP-NORMAL
  2017        set ercnot-startbr to true
  2018*       display ' resp normal startbr '
  2019        perform until finished-with-notes
  2020
  2021* EXEC CICS READNEXT
  2022*             DATASET    ('ERCNOT')
  2023*             RIDFLD     (WS-CZ-KEY)
  2024*             INTO       (cert-note-file)
  2025*             resp       (ws-response)
  2026*          end-exec
  2027     MOVE LENGTH OF
  2028      cert-note-file
  2029       TO DFHEIV12
  2030     MOVE 'ERCNOT' TO DFHEIV1
  2031     MOVE 0
  2032       TO DFHEIV11
  2033*    MOVE '&.IL                  )  N#00001920' TO DFHEIV0
  2034     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2035     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2036     MOVE X'204E233030303031393230' TO DFHEIV0(25:11)
  2037     CALL 'kxdfhei1' USING DFHEIV0,
  2038           DFHEIV1,
  2039           cert-note-file,
  2040           DFHEIV12,
  2041           WS-CZ-KEY,
  2042           DFHEIV99,
  2043           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  37
* SOCK04BL.cbl
  2044           DFHEIV99,
  2045           DFHEIV99
  2046     MOVE EIBRESP  TO ws-response
  2047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2048           if (resp-normal)
  2049              and (cz-control-primary (1:33) =
  2050                 cm-control-primary (1:33))
  2051              if cz-record-type = '1'
  2052                 add +1 to c1
  2053                 move cert-note-file
  2054                                 to cert-note-record (c1)
  2055              end-if
  2056           else
  2057              set finished-with-notes to true
  2058           end-if
  2059        end-perform
  2060     end-if
  2061     if ercnot-startbr
  2062*       display ' about to endbr ercnot '
  2063
  2064* exec cics endbr
  2065*          dataset    ('ERCNOT')
  2066*       end-exec
  2067     MOVE 'ERCNOT' TO DFHEIV1
  2068     MOVE 0
  2069       TO DFHEIV11
  2070*    MOVE '&2                    $   #00001941' TO DFHEIV0
  2071     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2072     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2073     MOVE X'2020233030303031393431' TO DFHEIV0(25:11)
  2074     CALL 'kxdfhei1' USING DFHEIV0,
  2075           DFHEIV1,
  2076           DFHEIV11,
  2077           DFHEIV99
  2078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2079     end-if
  2080     move c1                     to note-count
  2081     if c1 = +0
  2082        perform 0151-add-verify-agent-sig-note
  2083                                 thru 0151-exit
  2084     else
  2085        if ((cnr-rest (1) (1:21) = 'AGENT CHECK SIGNATURE')
  2086           and (sock-action-taken = 'C'))
  2087                         or
  2088           ((cnr-rest (1) (1:23) = 'MISSING AGENT SIGNATURE')
  2089           and (sock-action-taken = 'S'))
  2090                         or
  2091           ((cnr-rest (1) (1:22) = 'UNIDENTIFIED SIGNATURE')
  2092           and (sock-action-taken = 'U'))
  2093                         or
  2094           ((cnr-rest (1) (1:20) = 'CERTIFICATE RETURNED')
  2095           and (sock-action-taken = 'R'))
  2096                         or
  2097           ((cnr-rest (1) (1:19) = 'REFERRED TO MANAGER')
  2098           and (sock-action-taken = 'M'))
  2099                         or
  2100           ((cnr-rest (1) (1:25) = 'ACCEPT WITH NO COMMISSION')
  2101           and (sock-action-taken = 'N'))
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  38
* SOCK04BL.cbl
  2102           go to 0150-exit
  2103        else
  2104           perform 0152-delete-cert-notes
  2105                                 thru 0152-exit
  2106           if resp-normal
  2107              perform 0151-add-verify-agent-sig-note
  2108                                 thru 0151-exit
  2109              if resp-normal
  2110                 perform 0153-put-back-cert-notes
  2111                                 thru 0153-exit
  2112                 if resp-normal
  2113                    continue
  2114                 else
  2115                    display ' something wrong with put back '
  2116                       cm-cert-no
  2117                 end-if
  2118              else
  2119                 display ' something went wrong with adding note '
  2120                    cm-cert-no
  2121              end-if
  2122           else
  2123              display ' something went wrong with generic delete '
  2124                 cm-cert-no
  2125           end-if
  2126        end-if
  2127     end-if
  2128     .
  2129 0150-exit.
  2130     exit.
  2131 0151-add-verify-agent-sig-note.
  2132*    display ' made it to 0151 add '
  2133     move 'CZ'                to cert-note-file
  2134     move cm-control-primary  to cz-control-primary
  2135     move '1'                 to cz-record-type
  2136     move +1                  to cz-note-sequence
  2137     move ws-current-bin-dt   to cz-last-maint-dt
  2138     move eibtime             to cz-last-maint-hhmmss
  2139     move sock-proc-id        to cz-last-maint-user
  2140     evaluate true
  2141        when sock-action-taken = 'C'
  2142           MOVE 'AGENT CHECK SIGNATURE COVER SHEET GENERATED'
  2143                              to cz-note
  2144        when sock-action-taken = 'S'
  2145           move 'MISSING AGENT SIGNATURE FORM GENERATED'
  2146                              to cz-note
  2147        when sock-action-taken = 'U'
  2148           move 'UNIDENTIFIED SIGNATURE'
  2149                              to cz-note
  2150        when sock-action-taken = 'R'
  2151           move 'CERTIFICATE RETURNED'
  2152                              to cz-note
  2153        when sock-action-taken = 'N'
  2154           move 'ACCEPTED WITH NO COMMISSION'
  2155                              to cz-note
  2156        when other
  2157           move 'REFERRED TO MANAGER'
  2158                              to cz-note
  2159     end-evaluate
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  39
* SOCK04BL.cbl
  2160
  2161* exec cics write
  2162*       dataset   ('ERCNOT')
  2163*       from      (cert-note-file)
  2164*       ridfld    (cz-control-primary)
  2165*       resp      (ws-response)
  2166*    end-exec
  2167     MOVE LENGTH OF
  2168      cert-note-file
  2169       TO DFHEIV11
  2170     MOVE 'ERCNOT' TO DFHEIV1
  2171*    MOVE '&$ L                  ''  N#00002025' TO DFHEIV0
  2172     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2173     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2174     MOVE X'204E233030303032303235' TO DFHEIV0(25:11)
  2175     CALL 'kxdfhei1' USING DFHEIV0,
  2176           DFHEIV1,
  2177           cert-note-file,
  2178           DFHEIV11,
  2179           cz-control-primary,
  2180           DFHEIV99,
  2181           DFHEIV99
  2182     MOVE EIBRESP  TO ws-response
  2183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2184     if not resp-normal
  2185        display ' error-ercnot-write ' ws-response ' '
  2186           cz-control-primary (2:33)
  2187     end-if
  2188     .
  2189 0151-exit.
  2190     exit.
  2191 0152-delete-cert-notes.
  2192*    display ' made it to 0152 '
  2193     move cm-control-primary     to ws-cz-key
  2194     move '1'                    to ws-cz-rec-type
  2195     move +0                     to ws-cz-note-seq
  2196*    display ' about to browse delete ' ws-cz-key (2:19) ' '
  2197*       ws-cz-key (23:11)
  2198
  2199* EXEC CICS STARTBR
  2200*         DATASET    ('ERCNOT')
  2201*         RIDFLD     (WS-CZ-KEY)
  2202*         GTEQ
  2203*         RESP       (WS-RESPONSE)
  2204*    END-EXEC
  2205     MOVE 'ERCNOT' TO DFHEIV1
  2206     MOVE 0
  2207       TO DFHEIV11
  2208*    MOVE '&,         G          &  N#00002045' TO DFHEIV0
  2209     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2211     MOVE X'204E233030303032303435' TO DFHEIV0(25:11)
  2212     CALL 'kxdfhei1' USING DFHEIV0,
  2213           DFHEIV1,
  2214           WS-CZ-KEY,
  2215           DFHEIV99,
  2216           DFHEIV11,
  2217           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  40
* SOCK04BL.cbl
  2218     MOVE EIBRESP  TO WS-RESPONSE
  2219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2220     IF not RESP-NORMAL
  2221        display ' error startbr for delete ' ws-response
  2222        go to 0152-exit
  2223     end-if
  2224*    display ' good startbr '
  2225     .
  2226 0152-read-next.
  2227
  2228* EXEC CICS READNEXT
  2229*       DATASET    ('ERCNOT')
  2230*       RIDFLD     (WS-CZ-KEY)
  2231*       INTO       (cert-note-file)
  2232*       resp       (ws-response)
  2233*    end-exec
  2234     MOVE LENGTH OF
  2235      cert-note-file
  2236       TO DFHEIV12
  2237     MOVE 'ERCNOT' TO DFHEIV1
  2238     MOVE 0
  2239       TO DFHEIV11
  2240*    MOVE '&.IL                  )  N#00002058' TO DFHEIV0
  2241     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2242     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2243     MOVE X'204E233030303032303538' TO DFHEIV0(25:11)
  2244     CALL 'kxdfhei1' USING DFHEIV0,
  2245           DFHEIV1,
  2246           cert-note-file,
  2247           DFHEIV12,
  2248           WS-CZ-KEY,
  2249           DFHEIV99,
  2250           DFHEIV11,
  2251           DFHEIV99,
  2252           DFHEIV99
  2253     MOVE EIBRESP  TO ws-response
  2254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2255     if resp-normal
  2256*       display ' good readnext '
  2257        if cz-control-primary (1:33) = cm-control-primary (1:33)
  2258*          display ' primary equal '
  2259           if cz-record-type = '1'
  2260*             display ' rec type = 1, about to endbr '
  2261
  2262* exec cics endbr
  2263*                dataset    ('ERCNOT')
  2264*                resp       (ws-response)
  2265*             end-exec
  2266     MOVE 'ERCNOT' TO DFHEIV1
  2267     MOVE 0
  2268       TO DFHEIV11
  2269*    MOVE '&2                    $  N#00002070' TO DFHEIV0
  2270     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2271     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2272     MOVE X'204E233030303032303730' TO DFHEIV0(25:11)
  2273     CALL 'kxdfhei1' USING DFHEIV0,
  2274           DFHEIV1,
  2275           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  41
* SOCK04BL.cbl
  2276           DFHEIV99
  2277     MOVE EIBRESP  TO ws-response
  2278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2279              if not resp-normal
  2280                 display ' bad endbr ' ws-response
  2281                 go to 0152-exit
  2282              else
  2283*                display ' about to read update '
  2284
  2285* EXEC CICS READ
  2286*                   UPDATE
  2287*                   DATASET    ('ERCNOT')
  2288*                   RIDFLD     (WS-CZ-KEY)
  2289*                   INTO       (cert-note-file)
  2290*                   resp       (ws-response)
  2291*                end-exec
  2292     MOVE LENGTH OF
  2293      cert-note-file
  2294       TO DFHEIV11
  2295     MOVE 'ERCNOT' TO DFHEIV1
  2296*    MOVE '&"IL       EU         (  N#00002079' TO DFHEIV0
  2297     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2298     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2299     MOVE X'204E233030303032303739' TO DFHEIV0(25:11)
  2300     CALL 'kxdfhei1' USING DFHEIV0,
  2301           DFHEIV1,
  2302           cert-note-file,
  2303           DFHEIV11,
  2304           WS-CZ-KEY,
  2305           DFHEIV99,
  2306           DFHEIV99,
  2307           DFHEIV99
  2308     MOVE EIBRESP  TO ws-response
  2309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2310                 if not resp-normal
  2311                    display ' bad read update ' ws-response
  2312                    go to 0152-exit
  2313                 end-if
  2314*                display ' about to delete '
  2315
  2316* exec cics delete
  2317*                   dataset   ('ERCNOT')
  2318*                   RIDFLD     (WS-CZ-KEY)
  2319*                   resp      (ws-response)
  2320*                end-exec
  2321     MOVE 'ERCNOT' TO DFHEIV1
  2322*    MOVE '&(                    &  N#00002091' TO DFHEIV0
  2323     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2324     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2325     MOVE X'204E233030303032303931' TO DFHEIV0(25:11)
  2326     CALL 'kxdfhei1' USING DFHEIV0,
  2327           DFHEIV1,
  2328           DFHEIV99,
  2329           DFHEIV99,
  2330           DFHEIV99,
  2331           DFHEIV99
  2332     MOVE EIBRESP  TO ws-response
  2333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  42
* SOCK04BL.cbl
  2334                 if not resp-normal
  2335                    display ' bad delete ercnot ' ws-response
  2336                    go to 0152-exit
  2337                 else
  2338                    display ' good delete '
  2339                 end-if
  2340              end-if
  2341           else
  2342              display ' rec type not = 1 '
  2343           end-if
  2344           go to 0152-delete-cert-notes
  2345        else
  2346           display ' primary not = '
  2347        end-if
  2348     else
  2349        display ' error ercnot readnext delete ' ws-response
  2350     end-if
  2351*    display ' about to endbr '
  2352
  2353* exec cics endbr
  2354*       dataset    ('ERCNOT')
  2355*       resp       (ws-response)
  2356*    end-exec
  2357     MOVE 'ERCNOT' TO DFHEIV1
  2358     MOVE 0
  2359       TO DFHEIV11
  2360*    MOVE '&2                    $  N#00002114' TO DFHEIV0
  2361     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2363     MOVE X'204E233030303032313134' TO DFHEIV0(25:11)
  2364     CALL 'kxdfhei1' USING DFHEIV0,
  2365           DFHEIV1,
  2366           DFHEIV11,
  2367           DFHEIV99
  2368     MOVE EIBRESP  TO ws-response
  2369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2370     if not resp-normal
  2371        display ' bad resp endbr ercnot ' ws-response
  2372     else
  2373        display ' good endbr '
  2374     end-if
  2375     .
  2376 0152-exit.
  2377     exit.
  2378*0152-delete-cert-notes.
  2379*
  2380*    display ' made it to 0152 '
  2381*    move cm-control-primary     to ws-cz-key
  2382*    move '1'                    to ws-cz-rec-type
  2383*    move +0                     to ws-cz-note-seq
  2384*    display ' about to generic delete ' ws-cz-key (2:19) ' '
  2385*       ws-cz-key (23:11)
  2386*    exec cics delete
  2387*       dataset    ('ERCNOT')
  2388*       keylength  (ws-cert-note-generic-key-len)
  2389*       ridfld     (ws-cz-key (1:34))
  2390*       generic
  2391*       resp       (ws-response)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  43
* SOCK04BL.cbl
  2392*    end-exec
  2393*
  2394*    display ' made it back from generic delete ' ws-response
  2395*
  2396*    .
  2397*0152-exit.
  2398*    exit.
  2399 0153-put-back-cert-notes.
  2400*    display ' made it to 0153 ' note-count
  2401     perform varying c1 from +1 by +1 until
  2402        c1 > note-count
  2403        move cert-note-record (c1)
  2404                                 to cert-note-file
  2405        add +1                   to cz-note-sequence
  2406*       display ' about to write ' cz-control-primary (2:19) ' '
  2407*          cz-control-primary (23:11) ' ' cz-note-sequence ' '
  2408*           cz-record-type ' ' cz-note-information
  2409
  2410* exec cics write
  2411*          dataset ('ERCNOT')
  2412*          FROM    (cert-note-file)
  2413*          ridfld  (cz-control-primary)
  2414*          resp    (ws-response)
  2415*       end-exec
  2416     MOVE LENGTH OF
  2417      cert-note-file
  2418       TO DFHEIV11
  2419     MOVE 'ERCNOT' TO DFHEIV1
  2420*    MOVE '&$ L                  ''  N#00002157' TO DFHEIV0
  2421     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2422     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2423     MOVE X'204E233030303032313537' TO DFHEIV0(25:11)
  2424     CALL 'kxdfhei1' USING DFHEIV0,
  2425           DFHEIV1,
  2426           cert-note-file,
  2427           DFHEIV11,
  2428           cz-control-primary,
  2429           DFHEIV99,
  2430           DFHEIV99
  2431     MOVE EIBRESP  TO ws-response
  2432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2433        if not resp-normal
  2434           display ' error-ercnot-write subsequ ' ws-response ' '
  2435              cz-control-primary (2:33)
  2436           move +999             to c1
  2437        else
  2438           display ' good ercnot write ' c1
  2439        end-if
  2440     end-perform
  2441    .
  2442 0153-exit.
  2443     exit.
  2444 0200-process-acct-comp.
  2445*    display ' made it to 0200 '
  2446     move low-values             to ws-am-key
  2447     move ws-comp-cd             to ws-am-company-cd
  2448     move sock-car               to ws-am-carrier
  2449     move sock-grp               to ws-am-group
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  44
* SOCK04BL.cbl
  2450     move sock-st                to ws-am-state
  2451     move sock-act               to ws-am-account
  2452     move ws-bin-cert-eff-dt     to ws-am-exp-dt
  2453
  2454* EXEC CICS STARTBR
  2455*         DATASET    ('ERACCT')
  2456*         RIDFLD     (WS-AM-KEY)
  2457*         GTEQ
  2458*         RESP       (WS-RESPONSE)
  2459*    END-EXEC
  2460     MOVE 'ERACCT' TO DFHEIV1
  2461     MOVE 0
  2462       TO DFHEIV11
  2463*    MOVE '&,         G          &  N#00002183' TO DFHEIV0
  2464     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2466     MOVE X'204E233030303032313833' TO DFHEIV0(25:11)
  2467     CALL 'kxdfhei1' USING DFHEIV0,
  2468           DFHEIV1,
  2469           WS-AM-KEY,
  2470           DFHEIV99,
  2471           DFHEIV11,
  2472           DFHEIV99
  2473     MOVE EIBRESP  TO WS-RESPONSE
  2474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2475     if not resp-normal
  2476        display ' bad startbr ' ws-response
  2477        go to 0200-exit
  2478     end-if
  2479
  2480* EXEC CICS READNEXT
  2481*         INTO    (ACCOUNT-MASTER)
  2482*         DATASET ('ERACCT')
  2483*         RIDFLD  (WS-AM-KEY)
  2484*         RESP    (WS-RESPONSE)
  2485*    END-EXEC
  2486     MOVE LENGTH OF
  2487      ACCOUNT-MASTER
  2488       TO DFHEIV12
  2489     MOVE 'ERACCT' TO DFHEIV1
  2490     MOVE 0
  2491       TO DFHEIV11
  2492*    MOVE '&.IL                  )  N#00002193' TO DFHEIV0
  2493     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2494     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2495     MOVE X'204E233030303032313933' TO DFHEIV0(25:11)
  2496     CALL 'kxdfhei1' USING DFHEIV0,
  2497           DFHEIV1,
  2498           ACCOUNT-MASTER,
  2499           DFHEIV12,
  2500           WS-AM-KEY,
  2501           DFHEIV99,
  2502           DFHEIV11,
  2503           DFHEIV99,
  2504           DFHEIV99
  2505     MOVE EIBRESP  TO WS-RESPONSE
  2506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2507     if (resp-normal)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  45
* SOCK04BL.cbl
  2508        and (ws-am-company-cd = ws-comp-cd)
  2509        and (ws-am-carrier    = sock-car)
  2510        and (ws-am-state      = sock-st)
  2511        and (ws-am-account    = sock-act)
  2512        continue
  2513     else
  2514        display ' account not found '
  2515        go to 0200-exit
  2516     end-if
  2517     move spaces                 to ws-return-stuff
  2518     move am-name                to sock-am-name
  2519     move am-person              to sock-am-person
  2520     move am-control-name        to sock-am-cntrl-name
  2521     move am-tel-no              to sock-am-phone
  2522     MOVE LOW-VALUES             TO WS-CO-KEY
  2523     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  2524     MOVE AM-CARRIER             TO WS-CO-CARRIER
  2525     MOVE AM-GROUPING            TO WS-CO-GROUP
  2526     MOVE 'A'                    TO WS-CO-TYPE
  2527     if am-remit-to not numeric
  2528        move zeros               to am-remit-to
  2529     end-if
  2530     if am-remit-to = zeros
  2531        move 01                  to am-remit-to
  2532     end-if
  2533     move am-agt (am-remit-to)   to ws-co-fin-resp
  2534     perform varying a1 from +1 by +1 until
  2535        (a1 > +10)
  2536        or (am-com-typ (a1) = 'C' or 'D')
  2537     end-perform
  2538     if a1 < +11
  2539        move am-agt (a1)         to ws-co-account
  2540     else
  2541        move am-account          to ws-co-account
  2542     end-if
  2543
  2544* EXEC CICS READ
  2545*         INTO    (COMPENSATION-MASTER)
  2546*         DATASET ('ERCOMP')
  2547*         RIDFLD  (WS-CO-KEY)
  2548*         RESP    (WS-RESPONSE)
  2549*    END-EXEC
  2550     MOVE LENGTH OF
  2551      COMPENSATION-MASTER
  2552       TO DFHEIV11
  2553     MOVE 'ERCOMP' TO DFHEIV1
  2554*    MOVE '&"IL       E          (  N#00002235' TO DFHEIV0
  2555     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2557     MOVE X'204E233030303032323335' TO DFHEIV0(25:11)
  2558     CALL 'kxdfhei1' USING DFHEIV0,
  2559           DFHEIV1,
  2560           COMPENSATION-MASTER,
  2561           DFHEIV11,
  2562           WS-CO-KEY,
  2563           DFHEIV99,
  2564           DFHEIV99,
  2565           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  46
* SOCK04BL.cbl
  2566     MOVE EIBRESP  TO WS-RESPONSE
  2567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2568     IF RESP-NORMAL
  2569        MOVE CO-CONTROL-NAME     TO sock-co-contact
  2570        MOVE CO-faxno            TO sock-co-fax
  2571     ELSE
  2572        MOVE ' unknown     '     TO sock-co-contact
  2573     END-IF
  2574     .
  2575 0200-exit.
  2576     exit.
  2577 cics-return.
  2578     display 'SOCK04BL Finished ' sock-return-area
  2579
  2580* exec cics
  2581*       return
  2582*    end-exec
  2583*    MOVE '.(                    ''   #00002252' TO DFHEIV0
  2584     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2585     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2586     MOVE X'2020233030303032323532' TO DFHEIV0(25:11)
  2587     CALL 'kxdfhei1' USING DFHEIV0,
  2588           DFHEIV99,
  2589           DFHEIV99,
  2590           DFHEIV99,
  2591           DFHEIV99,
  2592           DFHEIV99,
  2593           DFHEIV99
  2594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2595
  2596* goback
  2597
  2598     MOVE '9%                    "   ' TO DFHEIV0
  2599     MOVE 'SOCK04BL' TO DFHEIV1
  2600     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2601     goback
  2602     .
  2603 9700-DATE-LINK.
  2604
  2605* EXEC CICS LINK
  2606*         PROGRAM  ('ELDATCV')
  2607*         COMMAREA (DATE-CONVERSION-DATA)
  2608*         LENGTH   (DC-COMM-LENGTH)
  2609*    END-EXEC.
  2610     MOVE 'ELDATCV' TO DFHEIV1
  2611*    MOVE '."C                   (   #00002258' TO DFHEIV0
  2612     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2613     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2614     MOVE X'2020233030303032323538' TO DFHEIV0(25:11)
  2615     CALL 'kxdfhei1' USING DFHEIV0,
  2616           DFHEIV1,
  2617           DATE-CONVERSION-DATA,
  2618           DC-COMM-LENGTH,
  2619           DFHEIV99,
  2620           DFHEIV99,
  2621           DFHEIV99,
  2622           DFHEIV99
  2623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:40 Page  47
* SOCK04BL.cbl
  2624
  2625 9700-EXIT.
  2626      EXIT.
  2627
  2628 9999-DFHBACK SECTION.
  2629     MOVE '9%                    "   ' TO DFHEIV0
  2630     MOVE 'SOCK04BL' TO DFHEIV1
  2631     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2632     GOBACK.
  2633 9999-DFHEXIT.
  2634     IF DFHEIGDJ EQUAL 0001
  2635         NEXT SENTENCE.
  2636     MOVE '9%                    "   ' TO DFHEIV0
  2637     MOVE 'SOCK04BL' TO DFHEIV1
  2638     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2639     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       52600     Code:        6399
