* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57******************************************************************
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page   3
* EL050.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64
    65 77  FILLER   PIC X(32) VALUE '********************************'.
    66 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    67 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    68
    69 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    70 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    71                                   USAGE POINTER.
    72 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    78                                   USAGE IS POINTER.
    79 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87*    COPY ELC50WS.
    88*****************************************************************
    89*                                                               *
    90*                            ELC50WS.                           *
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    92*                            VMOD=2.061.                        *
    93*                                                               *
    94*   THIS IS THE WORKING STORAGE FOR EL050                       *
    95*                                   EL517                       *
    96*****************************************************************
    97******************************************************************
    98*                   C H A N G E   L O G
    99*
   100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   101*-----------------------------------------------------------------
   102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   103* EFFECTIVE    NUMBER
   104*-----------------------------------------------------------------
   105* 123102                   PEMA  ADD DCC PROCESSING
   106* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   107* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   108* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   109* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   110* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   111* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   112* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   113* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   114* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   115* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   116* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   117* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   118* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   119* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page   4
* EL050.cbl
   120* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   121* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   122* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   123* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   124* 030309  CR2009021700001  PEMA  ADD ER-2883
   125* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   126* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   127* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   128* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   129* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   130* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   131* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   132* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   133* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   134* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   135* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   136* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   137* 061412  CR2011022800001  AJRA  NAPERSOFT
   138* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   139* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   140* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   141* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   142* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   143* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   144* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   145* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   146* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   147* 091114  IR2014091000001  TANA  ADD ERROR 2898
   148* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   149* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   150* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   151* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   152* 100617  CR2017062000003  PEMA  Inforce state comm cap
   153* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   154*-----------------------------------------------------------------
   155
   156 01  WORK-AREAS.
   157
   158*****************************************************************
   159*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   160*****************************************************************
   161
   162     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   163     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   164     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   165     12  WS-NAME-EDIT-WORK-AREA.
   166         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   167         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   168             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   169         16  WS-WORK-NAME.
   170             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   171             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   172             20  FILLER           PIC X(10)     VALUE SPACES.
   173         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   174             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   175
   176*****************************************************************
   177*        END OF WORKING STORAGE FOR CLIENT-MON                  *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page   5
* EL050.cbl
   178*****************************************************************
   179
   180     12  WS-ERRESC-KEY.
   181         16 WS-ERRESC-SEARCH-KEY.
   182             20  WS-ERRESC-COMPANY-CD PIC  X.
   183             20  WS-ERRESC-CARRIER    PIC  X.
   184             20  WS-ERRESC-GROUP      PIC X(6).
   185             20  WS-ERRESC-STATE      PIC XX.
   186             20  WS-ERRESC-ACCOUNT    PIC X(10).
   187         16 WS-ERRESC-RESIDUAL-KEY.
   188             20  WS-ERRESC-AGENT      PIC X(10).
   189             20  WS-ERRESC-RES-STATE  PIC XX.
   190             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   191*                                          YYYYMMDD
   192     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   193     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   194
   195*RESIDENT STATE TAX MASTER(ERRESS)
   196*
   197     12  WS-ERRESS-KEY.
   198         16  WS-ERRESS-COMPANY-CD      PIC  X.
   199         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   200         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   201         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   202*                                          YYYYMMDD
   203
   204     12  WS-CONTRACT-DATE              PIC 9(8).
   205*                                          YYYYMMDD
   206     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   207     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   208         16 WS-YEAR-YY                 PIC   9999.
   209         16 FILLER                     PIC 9(4).
   210*                                          YYYYMMDD
   211     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   212     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   213     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   214     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   215
   216     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   217         88  DPRB-1ST-TIME                      VALUE ' '.
   218
   219*****************************************************************
   220*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   221*****************************************************************
   222
   223     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   224     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   225     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   226     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   227     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   228     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   229     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   230     12  ws-st-agent-sig-edit    pic x          value spaces.
   231     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   232     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   235         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page   6
* EL050.cbl
   236         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   237     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   238         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   239         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   240     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   241
   242     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   243     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   244
   245     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   246     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   258     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   259     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   260     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   276     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   277     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   278     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   279     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   280     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   281     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   282     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   283     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   284     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   289     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   291     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   292     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   293     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page   7
* EL050.cbl
   294     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   295     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   296     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   297     12  WS-2671-SW               PIC X         VALUE SPACE.
   298     12  WS-2672-SW               PIC X         VALUE SPACE.
   299     12  ws-9813-sw               pic x         value spaces.
   300     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   301         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   302     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   303         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   304     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   305
   306     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   307         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   308         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   309         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   310         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   311
   312     12  WS-CREDIT-EDIT-CONTROLS.
   313         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   314         16  WS-MIN-AGE           PIC 99                VALUE  0.
   315         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   316         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   317         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   318         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   319
   320     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   321     12  WS-AGE-FIELDS.
   322         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   323         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   324         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   325         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   326
   327     12  WS-SAVE-ALLOWABLE-BENEFIT.
   328         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   329         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   330         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   331         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   332         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   333         16  FILLER                      PIC XX.
   334
   335     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   336     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   337     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   338     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   339     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   341     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   342     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   343     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   344     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   345
   346     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   347     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   348     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   349     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   350     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   351     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page   8
* EL050.cbl
   352     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   353     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   354         88  WS-REDUCING              VALUE 'R'.
   355         88  WS-LEVEL                 VALUE 'L' 'P'.
   356     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   357
   358     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   359     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   360     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   361     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   362     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   363     12  ws-ah-max-bens           pic 99        value zeros.
   364     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   365     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   366     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   367     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   368
   369     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   370     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   371     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   372     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   373     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   374     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   375     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   376     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   377     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   378     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   379     12  WS-ACCT-SIG-SW.
   380         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   381         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   382     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   383     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   384     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   385     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   386     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   387     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   388     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   389     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   390     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   391     12  WS-INITIALS.
   392         16  WS-INIT-1            PIC X         VALUE SPACES.
   393         16  WS-INIT-2            PIC X         VALUE SPACES.
   394
   395     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   396     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   397     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   398     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   399     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   400*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   401     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   402     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   403     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   404     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   405     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   406     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   407     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   408     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   409     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page   9
* EL050.cbl
   410     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   411     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   412     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   413     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   414     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   416     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   417     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   418     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   419     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   420     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   421     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   422     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   423******** FLA
   424     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   425     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   426     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   427     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   428     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   429********
   430     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   431     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   432     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   433     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   434     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   435     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   436     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   437     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   438     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   439     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   440
   441     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   442         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   443                                         '0' THRU '9'.
   444
   445     12  NUMBER-OF-MONTHS.
   446         16  SK-MO OCCURS 12 TIMES PIC X.
   447
   448     12  WS-WORK-DATE.
   449         16  WS-YEAR            PIC 99    VALUE 00.
   450         16  WS-MONTH           PIC 99    VALUE 00.
   451         16  WS-DAY             PIC 99    VALUE 00.
   452
   453     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   454     12  WS-WORK-CRIT-DEV       REDEFINES
   455         WS-WORK-LF-CRIT-PER    PIC X(03).
   456
   457     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   458     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   459
   460     12  WS-WORK-DATE-FROM.
   461         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   462         16  FILLER             PIC X  VALUE SPACE.
   463         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   464         16  FILLER             PIC X         VALUE SPACE.
   465         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   466
   467     12  WS-WORK-DATE-THRU.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  10
* EL050.cbl
   468         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   469         16  FILLER             PIC X         VALUE SPACE.
   470         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   471         16  FILLER             PIC X         VALUE SPACE.
   472         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   473
   474     12  WS-LF-INPUT-CD.
   475         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   476         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   477
   478     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   479     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   480         16  WS-AH-INPUT-CD-1   PIC X.
   481         16  WS-AH-INPUT-CD-2-3 PIC XX.
   482
   483     12  WS-SWITCHES.
   484         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   485         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   486             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   487         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   488             88  BANK-ACCT-FOUND          VALUE 'Y'.
   489         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   490             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   491         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   492             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   493         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   494             88  COMP-MASTER-FOUND        VALUE 'Y'.
   495         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   496             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   497         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   498             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   499         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   500             88  STAT-MASTER-FOUND        VALUE 'Y'.
   501         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   502             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   503         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   504             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   505         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   506             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   507         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   508             88  FORM-MASTER-FOUND        VALUE 'Y'.
   509         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   510             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   511         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   512             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   513         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   514             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   515         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   516             88  NO-BENEFIT-FOUND         VALUE 'N'.
   517         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   518             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   519         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   520             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   521         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   522             88  AH-BENEFIT-FOUND         VALUE ' '.
   523             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   524         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   525             88  LF-BENEFIT-FOUND         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  11
* EL050.cbl
   526             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   527         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   528             88  NO-STATE-RECORD          VALUE '1'.
   529         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   530             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   531         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   532             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   533         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   534             88  CERT-WAS-FOUND           VALUE ' '.
   535             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   536         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   537             88  BROWSE-STARTED           VALUE 'Y'.
   538         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   539             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   540         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   541             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   542         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   543             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   544         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   545             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   546         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   547             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   548         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   549             88  APP-CERT-USED            VALUE 'Y' 'A'.
   550         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   551             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   552             88  FIRST-TIME-THROUGH       VALUE '1'.
   553             88  CTBL-NOT-FOUND           VALUE '2'.
   554
   555         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   556             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   557
   558         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   559             88  DLO-ERROR-FOUND          VALUE 'Y'.
   560
   561********FLA
   562     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   563     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   564********
   565     12  RC-SW-1                  PIC X           VALUE '0'.
   566     12  RC-SW-2                  PIC X           VALUE '0'.
   567     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   568     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   569     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   570     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   571     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   572     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   573     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   574     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   575     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   576     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   577     12  LIT-SPACES               PIC X           VALUE SPACES.
   578     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   579     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   580     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   581     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   582     12  erpndm-unlock-sw         pic x           value spaces.
   583         88  need-to-unlock-erpndm  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  12
* EL050.cbl
   584     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   585     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   586     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   587         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   588         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   589     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   590         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   591
   592 01  WS-EXTRA-PERIODS-BY-STATE.
   593     12  WS-INT-PERIODS          PIC 9.
   594     12  WS-EXTRA-PMTS           PIC 9.
   595 01  ws-net-only-state           pic x value 'N'.
   596 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   597     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   598     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   599 01  WS-CRI-SSN-WORK-AREA.
   600     05  WS-CRI-SOC-SEC-NO.
   601         10  WS-SS-REPT-CD       PIC X(5).
   602         10  WS-SS-LAST-NAME     PIC X(5).
   603         10  WS-SS-INITIAL       PIC X.
   604
   605     05  WS-CRI-REPORT-CODE.
   606         10  FILLER              PIC X(5).
   607         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   608
   609     05  WS-CRI-LAST-NAME.
   610         10  WS-CRI-NAME-MOVE    PIC X(5).
   611         10  FILLER              PIC X(10).
   612
   613 01  ws-state-commission-caps.
   614     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   615     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   616     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   617     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   618     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   619     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   620     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   621     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   622     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   623     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   624     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   625     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   626     05  ws-st-cap-limit-to      pic x.
   627     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   628     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   629     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   630     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   631     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   632     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   633     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   634     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   635     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   636     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   637     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   638     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   639 01  WS-NUM-TABLE                PIC X(26)  VALUE
   640     '12345678012345070923456789'.
   641 01  FILLER REDEFINES WS-NUM-TABLE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  13
* EL050.cbl
   642     05  WS-NUM OCCURS 26        PIC 9.
   643 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   644 01  V1                          PIC S999 COMP-3.
   645 01  V2                          PIC S999 COMP-3.
   646 01  V3                          PIC S999 COMP-3.
   647 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   648 01  FILLER REDEFINES WS-WORK-VIN.
   649     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   650 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   651 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   652 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   653 01  WS-HEX-WORK.
   654     05  FILLER                  PIC X  VALUE LOW-VALUES.
   655     05  WS-HEX-BYTE             PIC X.
   656 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   657 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   658 01  WS-WORK-HIN-ROW-B.
   659     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   660
   661 01  ws-benefit-cd-chg-sw      pic x value spaces.
   662     88  benefit-code-chg           value 'Y'.
   663 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   664 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   665     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   666 01  WS-ROW-D-TABLE.
   667     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   668
   669 01  WS-HIN-TABLE-B.
   670     05  F                       PIC XX VALUE 'A2'.
   671     05  F                       PIC XX VALUE 'B3'.
   672     05  F                       PIC XX VALUE 'C4'.
   673     05  F                       PIC XX VALUE 'D5'.
   674     05  F                       PIC XX VALUE 'E6'.
   675     05  F                       PIC XX VALUE 'F7'.
   676     05  F                       PIC XX VALUE 'G8'.
   677     05  F                       PIC XX VALUE 'H9'.
   678     05  F                       PIC XX VALUE 'I1'.
   679     05  F                       PIC XX VALUE 'J2'.
   680     05  F                       PIC XX VALUE 'K3'.
   681     05  F                       PIC XX VALUE 'L4'.
   682     05  F                       PIC XX VALUE 'M5'.
   683     05  F                       PIC XX VALUE 'N6'.
   684     05  F                       PIC XX VALUE 'O0'.
   685     05  F                       PIC XX VALUE 'P7'.
   686     05  F                       PIC XX VALUE 'Q0'.
   687     05  F                       PIC XX VALUE 'R8'.
   688     05  F                       PIC XX VALUE 'S9'.
   689     05  F                       PIC XX VALUE 'T2'.
   690     05  F                       PIC XX VALUE 'U3'.
   691     05  F                       PIC XX VALUE 'V4'.
   692     05  F                       PIC XX VALUE 'W5'.
   693     05  F                       PIC XX VALUE 'X6'.
   694     05  F                       PIC XX VALUE 'Y7'.
   695     05  F                       PIC XX VALUE 'Z8'.
   696 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   697     05  WS-VAL-IN               PIC X.
   698     05  WS-VAL-OUT              PIC 9.
   699 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  14
* EL050.cbl
   700 01  WS-COMPARE-BINARY-DATES.
   701     05  WS-971231                PIC XX VALUE X'92FF'.
   702     05  WS-931231                PIC XX VALUE X'8CFF'.
   703     05  WS-791231                PIC XX VALUE X'77FF'.
   704     05  WS-771001                PIC XX VALUE X'74A1'.
   705     05  WS-820301                PIC XX VALUE X'7B41'.
   706     05  WS-831031                PIC XX VALUE X'7DBF'.
   707     05  WS-831231                PIC XX VALUE X'7DFF'.
   708     05  WS-810831                PIC XX VALUE X'7A7F'.
   709     05  WS-830901                PIC XX VALUE X'7D81'.
   710
   711 01  FILE-ACCESS-IDS.
   712     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   713     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   714     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   715     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   716     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   717     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   718     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   719     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   720     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   721     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   722     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   723     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   724     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   725     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   726     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   727     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   728     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   729 01  DD-IU-SW                    PIC X   VALUE ' '.
   730     88  DD-IU-PRESENT                 VALUE 'Y'.
   731
   732 01  ACCESS-KEYS.
   733     12  ELMSTR-KEY.
   734         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   735         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   736     12  W-CLAIM-KEY.
   737         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   738         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   739
   740     12  ELCNTL-KEY.
   741         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   742         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   743         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   744         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   745
   746     12  ELCERT-KEY.
   747         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   748         16  CERT-CARRIER         PIC X       VALUE SPACE.
   749         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   750         16  CERT-STATE           PIC XX      VALUE SPACES.
   751         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   752         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   753         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   754
   755     12  ELCERT2-KEY.
   756         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   757         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  15
* EL050.cbl
   758
   759     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   760
   761     12  ELCERT-SAVE.
   762         16  FILLER                      PIC XX    VALUE SPACES.
   763
   764         16  WCS-CONTROL-PRIMARY.
   765             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   766             20  WCS-CARRIER             PIC X     VALUE SPACE.
   767             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   768             20  WCS-STATE               PIC XX    VALUE SPACES.
   769             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   770             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   771             20  WCS-CERT-NO.
   772                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   773                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   774
   775         16  CS-CONTROL-BY-NAME.
   776             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   777             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   778             20  CS-INSURED-INITIALS.
   779                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   780                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   781
   782         16  CS-CONTROL-BY-SSN.
   783             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   784             20  CS-SOC-SEC-NO.
   785                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   786                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   787                 24  CS-SSN-LN3.
   788                     28 CS-INSURED-INITIALS-A2   PIC XX
   789                                     VALUE SPACES.
   790                     28 CS-PART-LAST-NAME-A2     PIC X
   791                                     VALUE SPACE.
   792
   793         16  CS-CONTROL-BY-CERT-NO.
   794             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   795             20  CS-CERT-NO-A4           PIC X(11)
   796                                     VALUE SPACES.
   797
   798         16  CS-CONTROL-BY-MEMB.
   799             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   800             20  CS-MEMBER-NO.
   801                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   802                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   803                 24  CS-MEMB-LN4.
   804                     28 CS-INSURED-INITIALS-A5   PIC XX
   805                                      VALUE SPACES.
   806                     28 CS-PART-LAST-NAME-A5     PIC XX
   807                                      VALUE SPACES.
   808
   809         16  FILLER              PIC X(360) VALUE SPACES.
   810
   811     12  ERACCT-KEY.
   812         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   813         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   814         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   815         16  ACCT-STATE           PIC X(02) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  16
* EL050.cbl
   816         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   817         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   818
   819     12  ERCOMP-KEY.
   820         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   821         16  COMP-CARRIER         PIC X     VALUE SPACES.
   822         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   823         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   824         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   825         16  COMP-TYPE            PIC X     VALUE SPACES.
   826
   827     12  ERLOFC-KEY.
   828         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   829         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   830         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   831         16  LOFC-STATE           PIC XX    VALUE SPACES.
   832         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   833         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   834
   835     12  WS-ELCRTT-KEY.
   836         16  WS-ELCRTT-PRIMARY       PIC X(33).
   837         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   838
   839     12  ERBXRF-KEY.
   840         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   841         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   842         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   843         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   844
   845     12  ERAGTC-KEY.
   846         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   847         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   848         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   849         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   850         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   851         16  AGTC-TYPE            PIC X     VALUE SPACES.
   852
   853     12  ERPLAN-KEY.
   854         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   855         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   856         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   857         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   858         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   859         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   860         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   861         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   862
   863     12  ERFORM-KEY.
   864         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   865         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   866         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   867         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   868
   869     12  ERREIN-KEY.
   870         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   871         16  REIN-TYPE            PIC X     VALUE SPACES.
   872         16  REIN-TABLE-CO.
   873             20  REIN-CODE-1      PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  17
* EL050.cbl
   874             20  REIN-CODE-2      PIC X     VALUE SPACE.
   875             20  REIN-CODE-3      PIC X     VALUE SPACE.
   876         16  FILLER               PIC X(3)  VALUE SPACES.
   877
   878     12  ERCTBL-KEY.
   879         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   880         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   881         16  CTBL-CNTRL-2.
   882             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   883             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   884
   885     12  ELCRTO-KEY.
   886         16  ELCRTO-COMPANY-CD       PIC X.
   887         16  ELCRTO-CARRIER          PIC X.
   888         16  ELCRTO-GROUPING         PIC X(6).
   889         16  ELCRTO-STATE            PIC XX.
   890         16  ELCRTO-ACCOUNT          PIC X(10).
   891         16  ELCRTO-CERT-EFF-DT      PIC XX.
   892         16  ELCRTO-CERT-NO.
   893             20  ELCRTO-CERT-PRIME   PIC X(10).
   894             20  ELCRTO-CERT-SFX     PIC X.
   895         16  ELCRTO-RECORD-TYPE      PIC X.
   896         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   897
   898
   899     12  WS-ACCESS.
   900         16  FILLER               PIC XX    VALUE SPACES.
   901         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   902
   903     12  WS-CARR-ACCESS.
   904         16  FILLER               PIC X(3)  VALUE SPACES.
   905         16  WS-CARR              PIC X     VALUE SPACE.
   906*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   907*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   908     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   909         88  WS-DMD-LF-RATING   VALUE 'Y'.
   910         88  WS-DMD-AH-RATING   VALUE 'Y'.
   911         88  WS-DMD-NO-RATING   VALUE 'N'.
   912
   913     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   914         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   915                                         'NJ' 'NL'
   916                                         'PJ' 'PL'
   917                                         'SJ' 'SL'.
   918     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   919         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   920                                         'NI' 'NJ' 'NL' 'NU'
   921                                         'PJ' 'PL' 'PI' 'PU'
   922                                         'SI' 'SJ' 'SL' 'SU'
   923                                         'MX' 'MY' 'MZ'.
   924 01  ERPDEF-KEY-SAVE             PIC X(18).
   925 01  ERPDEF-KEY.
   926     12  ERPDEF-COMPANY-CD       PIC X.
   927     12  ERPDEF-STATE            PIC XX.
   928     12  ERPDEF-PROD-CD          PIC XXX.
   929     12  F                       PIC X(7).
   930     12  ERPDEF-BEN-TYPE         PIC X.
   931     12  ERPDEF-BEN-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  18
* EL050.cbl
   932     12  ERPDEF-EXP-DT           PIC XX.
   933
   934 01  ELSTAT-KEY-SAVE             PIC X(20).
   935 01  ELSTAT-KEY.
   936     12  ELSTAT-COMPANY-ID       PIC XXX.
   937     12  ELSTAT-CARRIER          PIC X.
   938     12  ELSTAT-GROUP            PIC X(6).
   939     12  ELSTAT-STATE            PIC XX.
   940     12  ELSTAT-EXP-DT           PIC 9(8).
   941 01  WS-ERROR-VALUES.
   942     12  ER-1570                     PIC S9(4)   VALUE +1570.
   943     12  ER-1571                     PIC S9(4)   VALUE +1571.
   944     12  er-1572                     pic s9(4)   value +1572.
   945     12  er-1573                     pic s9(4)   value +1573.
   946     12  er-1574                     pic s9(4)   value +1574.
   947     12  ER-1575                     PIC S9(4)   VALUE +1575.
   948     12  er-1576                     pic s9(4)   value +1576.
   949     12  er-1583                     pic s9(4)   value +1583.
   950     12  er-1743                     pic s9(4)   value +1743.
   951     12  er-1744                     pic s9(4)   value +1744.
   952     12  er-1745                     pic s9(4)   value +1745.
   953     12  er-1746                     pic s9(4)   value +1746.
   954     12  er-1747                     pic s9(4)   value +1747.
   955     12  er-1748                     pic s9(4)   value +1748.
   956     12  ER-1891                     PIC S9(4)   VALUE +1891.
   957     12  ER-1892                     PIC S9(4)   VALUE +1892.
   958     12  ER-1893                     PIC S9(4)   VALUE +1893.
   959     12  ER-1894                     PIC S9(4)   VALUE +1894.
   960     12  ER-1895                     PIC S9(4)   VALUE +1895.
   961     12  ER-1896                     PIC S9(4)   VALUE +1896.
   962     12  ER-1897                     PIC S9(4)   VALUE +1897.
   963     12  ER-1898                     PIC S9(4)   VALUE +1898.
   964     12  ER-1899                     PIC S9(4)   VALUE +1899.
   965     12  ER-1900                     PIC S9(4)   VALUE +1900.
   966     12  ER-1901                     PIC S9(4)   VALUE +1901.
   967     12  ER-1902                     PIC S9(4)   VALUE +1902.
   968     12  ER-1903                     PIC S9(4)   VALUE +1903.
   969     12  ER-1904                     PIC S9(4)   VALUE +1904.
   970     12  ER-1905                     PIC S9(4)   VALUE +1905.
   971     12  ER-1906                     PIC S9(4)   VALUE +1906.
   972     12  ER-1907                     PIC S9(4)   VALUE +1907.
   973     12  ER-1909                     PIC S9(4)   VALUE +1909.
   974     12  ER-1910                     PIC S9(4)   VALUE +1910.
   975     12  ER-1911                     PIC S9(4)   VALUE +1911.
   976     12  ER-1912                     PIC S9(4)   VALUE +1912.
   977     12  ER-1913                     PIC S9(4)   VALUE +1913.
   978     12  ER-1914                     PIC S9(4)   VALUE +1914.
   979     12  ER-1915                     PIC S9(4)   VALUE +1915.
   980     12  ER-1916                     PIC S9(4)   VALUE +1916.
   981     12  ER-1917                     PIC S9(4)   VALUE +1917.
   982     12  ER-1918                     PIC S9(4)   VALUE +1918.
   983     12  ER-1919                     PIC S9(4)   VALUE +1919.
   984     12  ER-1920                     PIC S9(4)   VALUE +1920.
   985     12  ER-1921                     PIC S9(4)   VALUE +1921.
   986     12  ER-1922                     PIC S9(4)   VALUE +1922.
   987     12  ER-1923                     PIC S9(4)   VALUE +1923.
   988     12  ER-1924                     PIC S9(4)   VALUE +1924.
   989     12  ER-1925                     PIC S9(4)   VALUE +1925.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  19
* EL050.cbl
   990     12  ER-1926                     PIC S9(4)   VALUE +1926.
   991     12  ER-1927                     PIC S9(4)   VALUE +1927.
   992     12  ER-1955                     PIC s9(4)   VALUE +1955.
   993     12  ER-1956                     PIC s9(4)   VALUE +1956.
   994     12  ER-1957                     PIC s9(4)   VALUE +1957.
   995     12  ER-1958                     PIC s9(4)   VALUE +1958.
   996     12  ER-1959                     PIC s9(4)   VALUE +1959.
   997     12  ER-1960                     PIC s9(4)   VALUE +1960.
   998     12  ER-1961                     PIC s9(4)   VALUE +1961.
   999     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1000     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1001     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1002     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1003     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1004     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1005     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1006     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1007     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1008     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1009     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1010     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1011     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1012     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1013     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1014     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1015     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1016     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1017     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1018     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1019     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1020     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1021     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1022     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1023     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1024     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1025     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1026     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1027     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1028     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1029     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1030     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1031     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1032     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1033     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1034     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1035     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1036     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1037     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1038     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1039     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1040     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1041     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1042     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1043     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1044     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1045     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1046     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1047     12  ER-2645                     PIC S9(4)   VALUE +2645.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  20
* EL050.cbl
  1048     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1049     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1050     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1051     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1052     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1053     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1054     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1055     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1056     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1057     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1058     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1059     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1060     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1061     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1062     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1063     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1064     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1065     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1066     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1067     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1068     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1069     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1070     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1071     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1072     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1073     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1074     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1075     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1076     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1077     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1078     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1079     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1080     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1081     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1082     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1083     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1084     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1085     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1086     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1087     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1088     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1089     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1090     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1091     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1092     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1093     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1094     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1095     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1096     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1097     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1098     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1099     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1100     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1101     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1102     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1103     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1104     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1105     12  ER-2703                     PIC S9(4)   VALUE +2703.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  21
* EL050.cbl
  1106     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1107     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1108     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1109     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1110     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1111     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1112     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1113     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1114     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1115     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1116     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1117     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1118     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1119     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1120     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1121     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1122     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1123     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1124     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1125     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1126     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1127     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1128     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1129     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1130     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1131     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1132     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1133     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1134     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1135     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1136     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1137     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1138     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1139     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1140     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1141     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1142     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1143     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1144     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1145     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1146     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1147     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1148     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1149     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1150     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1151     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1152     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1153     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1154     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1155     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1156     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1157     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1158     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1159     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1160     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1161     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1162     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1163     12  ER-2771                     PIC S9(4)   VALUE +2771.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  22
* EL050.cbl
  1164     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1165     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1166     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1167     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1168     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1169     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1170     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1171     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1172     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1173     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1174     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1175     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1176     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1177     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1178     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1179     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1180     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1181     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1182     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1183     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1184     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1185     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1186     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1187     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1188     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1189     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1190     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1191     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1192     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1193     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1194     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1195     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1196     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1197     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1198     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1199     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1200     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1201     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1202     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1203     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1204     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1205     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1206     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1207     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1208     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1209     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1210     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1211     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1212     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1213     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1214     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1215     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1216     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1217     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1218     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1219     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1220     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1221     12  ER-3780                     PIC S9(4)   VALUE +3780.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  23
* EL050.cbl
  1222     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1223     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1224     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1225     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1226     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1227     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1228     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1229     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1230     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1231     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1232     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1233     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1234     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1235     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1236     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1237     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1238     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1239     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1240     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1241     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1242     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1243     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1244     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1245     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1246     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1247     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1248     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1249     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1250     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1251     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1252     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1253     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1254     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1255     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1256     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1257     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1258     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1259     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1260     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1261     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1262     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1263     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1264     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1265     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1266     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1267     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1268     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1269     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1270     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1271     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1272     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1273     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1274     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1275     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1276     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1277     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1278     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1279     12  ER-8092                     PIC S9(4)   VALUE +8092.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  24
* EL050.cbl
  1280     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1281     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1282     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1283     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1284     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1285     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1286     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1287     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1288     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1289     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1290     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1291     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1292     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1293     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1294     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1295     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1296     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1297     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1298     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1299     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1300     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1301     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1302     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1303     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1304     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1305     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1306     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1307     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1308     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1309     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1310     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1311     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1312     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1313     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1314     12  er-9823                     pic s9(4)   value +9823.
  1315     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1316******************************************************************
  1317***************   END OF ELC50WS     ****************************
  1318******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  25
* EL050.cbl
  1321 01  WORKING-STORAGE-WORK-AREAS.
  1322     12  WS-RESPONSE             PIC S9(8)  COMP.
  1323         88  WS-RESP-NORMAL           VALUE +00.
  1324         88  WS-RESP-ERROR            VALUE +01.
  1325         88  WS-RESP-NOTFND           VALUE +13.
  1326         88  WS-RESP-DUPREC           VALUE +14.
  1327         88  WS-RESP-ENDFILE          VALUE +20.
  1328     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1329     12  WORK-AREAS.
  1330         16  WK-CONV-GREG.
  1331             24  WCG-CENT             PIC XX.
  1332             24  WCG-REST             PIC X(4).
  1333         16  WORK-GREGORIAN-DATE.
  1334             24  WK-GREG-CENT         PIC XX.
  1335             24  WK-GREG-DATE-YYMMDD.
  1336                 28  WK-GREG-YYMM     PIC X(4).
  1337                 28  WK-GREG-DD       PIC XX.
  1338
  1339         16  WORK-SELECT-DATE.
  1340             24  WK-SELECT-CENT            PIC XX.
  1341             24  WK-SELECT-DATE-YYMMDD.
  1342                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1343                 28  FILLER                PIC XX.
  1344
  1345         16  WK-FORM-NO.
  1346             24  WK-FORM-BANK-ID       PIC X(5).
  1347             24  WK-FORM-UNDRWRTR      PIC X(1).
  1348             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1349
  1350         16  WK-MEMBER-NO.
  1351             24  WK-MEMBER-1-6        PIC X(6).
  1352             24  WK-MEMBER-7-12       PIC X(6).
  1353
  1354         16  WK-FULL-CERT-NO.
  1355             24  WK-CERT-POS-1-2      PIC X(2).
  1356             24  WK-CERT-POS-3        PIC X(1).
  1357             24  WK-CERT-POS-4        PIC X(1).
  1358             24  WK-CERT-POS-5-6      PIC X(2).
  1359             24  WK-CERT-POS-7        PIC X(1).
  1360             24  WK-CERT-POS-8-11     PIC X(4).
  1361
  1362         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1363             88  VALID-RATE-CODE        VALUE 'Y'.
  1364             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1365
  1366         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1367         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1368         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1369         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1370         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1371         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1372         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1373         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1374         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1375         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1376
  1377* DLO001
  1378 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  26
* EL050.cbl
  1379     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1380     12  DMPF-RETURN-CODE          PIC XX.
  1381         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1382         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1383         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1384         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1385         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1386         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1387
  1388* DLO002
  1389 01  WS-DLO-INTERNAL-POLICY-FORM.
  1390     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1391     12  DIPF-RETURN-CODE          PIC XX.
  1392         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1393         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1394         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1395         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1396         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1397         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1398
  1399* DLO003
  1400 01  WS-DLO-VALID-BANK-ID.
  1401     12  DVBI-BANK-ID              PIC X(5).
  1402     12  DVBI-BANK-ID-TYPE         PIC X.
  1403         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1404         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1405         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1406         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1407         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1408     12  DVBI-RETURN-CODE          PIC XX.
  1409         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1410         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1411         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1412         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1413         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1414         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1415         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1416         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1417         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1418
  1419* DLO007
  1420 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1421     12  DCUA-RES-STATE            PIC XX.
  1422     12  DCUA-BEN-TYPE             PIC XX.
  1423     12  DCUA-SYS-IDENT            PIC X.
  1424         88  DCUA-CLAIM                        VALUE 'C'.
  1425         88  DCUA-PREMIUM                      VALUE 'P'.
  1426     12  DCUA-COVERAGE-RULE        PIC X.
  1427     12  DCUA-CLIENT-ID            PIC X(10).
  1428     12  DCUA-EFF-DATE             PIC X(8).
  1429     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1430     12  DCUA-RETURN-CODE          PIC XX.
  1431         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1432     12  DCUA-CERT-NUMBER          PIC X(11).
  1433     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1434     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1435
  1436* DLO011
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  27
* EL050.cbl
  1437 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1438     12  DPRB-RATE-CODE            PIC X(4).
  1439     12  DPRB-COVERAGE-CATEG       PIC X.
  1440     12  DPRB-RETURN-CODE          PIC XX.
  1441         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1442         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1443         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1444         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1445         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1446         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1447         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1448         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1449         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1450     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1451     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1452     12  DPRB-BEN-TYPE             PIC XX.
  1453
  1454* DLO017
  1455 01  WS-DLO-VALID-RATE-CODE.
  1456     12  DVRC-RATE-CODE            PIC X(4).
  1457     12  DVRC-RETURN-CODE          PIC XX.
  1458         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1459         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1460         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1461         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1462         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1463         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1464
  1465* DLO019
  1466 01  WS-DLO-ORIG-COV-CAT.
  1467     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1468     12  DOCC-RETURN-CODE          PIC XX.
  1469     12  DOCC-ORIG-COV-CAT         PIC X.
  1470     12  DOCC-UNDERWITER           PIC XX.
  1471     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1472     12  DOCC-FILLER               PIC X(6).
  1473
  1474* DLO021
  1475 01  WS-DLO-VALID-LOAN-OFFICER.
  1476     12  DVLO-LOAN-OFFICER.
  1477         16  DVLO-BILL-TYPE        PIC X.
  1478         16  DVLO-BILL-SOURCE      PIC X.
  1479         16  DVLO-BATCH-TYPE       PIC X.
  1480     12  DVLO-RETURN-CODE          PIC XX.
  1481         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1482         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1483         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1484         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1485         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1486         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1487
  1488* DLO022
  1489 01  WS-DLO-VALID-STATE-CODE.
  1490     12  DVSC-STATE-CODE           PIC XX.
  1491     12  DVSC-RETURN-CODE          PIC XX.
  1492         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1493
  1494* DLO023
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  28
* EL050.cbl
  1495 01  WS-DLO-VALID-CODE-VALUES.
  1496     12  DVCV-SYSTEM-ID            PIC XX.
  1497         88  DVCV-CLAIMS                       VALUE 'CL'.
  1498         88  DVCV-CREDIT                       VALUE 'CR'.
  1499     12  DVCV-RECORD-TYPE          PIC XX.
  1500         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1501         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1502         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1503         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1504         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1505         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1506         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1507         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1508     12  DVCV-RECORD-KEY           PIC X(6).
  1509     12  DVCV-RETURN-CODE          PIC XX.
  1510         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1511         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1512         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1513         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1514         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1515         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1516         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1517     12  DVCV-CODE-DESC            PIC X(60).
  1518     12  DVCV-GEN-DESC-1           PIC X(20).
  1519     12  DVCV-GEN-DESC-2           PIC X(20).
  1520     12  DVCV-GEN-DESC-3           PIC X(20).
  1521
  1522 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1523 01  hldi-pass-area.
  1524     03  PA-VIN                  PIC X(17).
  1525     03  PA-ErrorCode            PIC X(10).
  1526     03  PA-ErrorDesc            PIC X(30).
  1527     03  PA-ModelYear            PIC 9(7).
  1528     03  PA-MakeName             PIC X(50).
  1529     03  PA-ModelName            PIC X(50).
  1530     03  PA-SeriesName           PIC X(50).
  1531 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1532 01  zipcd-pass-area.
  1533     03  PA-zip                  PIC X(5).
  1534     03  PA-ErrorCode-zip        PIC X(10).
  1535     03  PA-city                 PIC x(50).
  1536     03  PA-state                PIC Xx.
  1537****  this is for aggregate report.
  1538****  Length is erpndb + 100 of passed-key-area
  1539 01  ws-passed-key-length        pic s9(4) comp value +587.
  1540 01  ws-pass-to-pemaggo.
  1541     05  ws-passed-erpndb        pic x(585).
  1542     05  ws-exceed-limit-yn      pic x.
  1543     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  29
* EL050.cbl
  1545*    COPY ERCBXRF.
  1546******************************************************************
  1547*                                                                *
  1548*                                                                *
  1549*                            ERCBXRF                             *
  1550*                                                                *
  1551*   ONLINE CREDIT SYSTEM                                         *
  1552*                                                                *
  1553*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1554*                                                                *
  1555*   FILE TYPE = VSAM,KSDS                                        *
  1556*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1557*                                                                *
  1558*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1559*       ALTERNATE PATH = NONE                                    *
  1560*                                                                *
  1561*   LOG = NO                                                     *
  1562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1563*                                                                *
  1564******************************************************************
  1565
  1566 01  BANK-CROSS-REFERENCE.
  1567     12  BK-RECORD-ID                PIC XX.
  1568         88  VALID-BK-ID             VALUE 'BK'.
  1569
  1570     12  BK-CONTROL-PRIMARY.
  1571         16  BK-COMPANY-CD           PIC X.
  1572         16  BK-CARRIER              PIC X.
  1573         16  BK-GROUPING             PIC X(6).
  1574         16  BK-BANK-NO              PIC X(10).
  1575
  1576     12  BK-MAINT-INFORMATION.
  1577         16  BK-LAST-MAINT-DT        PIC XX.
  1578         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1579         16  BK-LAST-MAINT-USER      PIC X(4).
  1580         16  FILLER                  PIC X(9).
  1581
  1582     12  FILLER                      PIC X(37).
  1583
  1584     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1585
  1586     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1587                            DEPENDING ON BK-BANK-POINTER-CNT.
  1588         16  BK-AM-ACCOUNT           PIC X(10).
  1589         16  BK-AM-EXP-DT            PIC XX.
  1590         16  BK-AM-EFF-DT            PIC XX.
  1591         16  BK-AM-STATE             PIC XX.
  1592         16  FILLER                  PIC X(20).
  1593
  1594******************************************************************
  1595
  1596*    COPY ERCCOMP.
  1597******************************************************************
  1598*                                                                *
  1599*                                                                *
  1600*                            ERCCOMP                             *
  1601*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1602*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  30
* EL050.cbl
  1603*                                                                *
  1604*   ONLINE CREDIT SYSTEM                                         *
  1605*                                                                *
  1606*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1607*                                                                *
  1608*   FILE TYPE = VSAM,KSDS                                        *
  1609*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1610*                                                                *
  1611*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1612*       ALTERNATE PATH = NONE                                    *
  1613*                                                                *
  1614*   LOG = NO                                                     *
  1615*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1616*                                                                *
  1617******************************************************************
  1618*                   C H A N G E   L O G
  1619*
  1620* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1621*-----------------------------------------------------------------
  1622*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1623* EFFECTIVE    NUMBER
  1624*-----------------------------------------------------------------
  1625* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1626* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1627* 092205    2005050300006  PEMA  ADD LEASE FEE
  1628* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1629* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1630* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1631* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1632* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1633* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1634******************************************************************
  1635
  1636 01  COMPENSATION-MASTER.
  1637     12  CO-RECORD-ID                          PIC XX.
  1638         88  VALID-CO-ID                          VALUE 'CO'.
  1639
  1640     12  CO-CONTROL-PRIMARY.
  1641         16  CO-COMPANY-CD                     PIC X.
  1642         16  CO-CONTROL.
  1643             20  CO-CTL-1.
  1644                 24  CO-CARR-GROUP.
  1645                     28  CO-CARRIER            PIC X.
  1646                     28  CO-GROUPING.
  1647                         32  CO-GROUP-PREFIX   PIC XXX.
  1648                         32  CO-GROUP-PRIME    PIC XXX.
  1649                 24  CO-RESP-NO.
  1650                     28  CO-RESP-PREFIX        PIC X(4).
  1651                     28  CO-RESP-PRIME         PIC X(6).
  1652             20  CO-CTL-2.
  1653                 24  CO-ACCOUNT.
  1654                     28  CO-ACCT-PREFIX        PIC X(4).
  1655                     28  CO-ACCT-PRIME         PIC X(6).
  1656         16  CO-TYPE                           PIC X.
  1657             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1658             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1659             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1660
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  31
* EL050.cbl
  1661     12  CO-MAINT-INFORMATION.
  1662         16  CO-LAST-MAINT-DT                  PIC XX.
  1663         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1664         16  CO-LAST-MAINT-USER                PIC X(4).
  1665     12  FILLER                                PIC XX.
  1666     12  CO-STMT-TYPE                          PIC XXX.
  1667     12  CO-COMP-TYPE                          PIC X.
  1668         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1669     12  CO-STMT-OWNER                         PIC X(4).
  1670     12  CO-BALANCE-CONTROL                    PIC X.
  1671         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1672         88  CO-NO-BALANCE                        VALUE 'N'.
  1673
  1674     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1675         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1676         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1677         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1678
  1679     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1680         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1681         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1682
  1683     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1684     12  CO-GA-DIRECT-DEP                      PIC X.
  1685     12  CO-FUTURE-SPACE                       PIC X.
  1686         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1687
  1688     12  CO-ACCT-NAME                          PIC X(30).
  1689     12  CO-MAIL-NAME                          PIC X(30).
  1690     12  CO-ADDR-1                             PIC X(30).
  1691     12  CO-ADDR-2                             PIC X(30).
  1692     12  CO-ADDR-3.
  1693         16  CO-ADDR-CITY                      PIC X(27).
  1694         16  CO-ADDR-STATE                     PIC XX.
  1695     12  CO-CSO-1099                           PIC X.
  1696     12  CO-ZIP.
  1697         16  CO-ZIP-PRIME.
  1698             20  CO-ZIP-PRI-1ST                PIC X.
  1699                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1700             20  FILLER                        PIC X(4).
  1701         16  CO-ZIP-PLUS4                      PIC X(4).
  1702     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1703         16  CO-CAN-POSTAL-1                   PIC XXX.
  1704         16  CO-CAN-POSTAL-2                   PIC XXX.
  1705         16  FILLER                            PIC XXX.
  1706     12  CO-SOC-SEC                            PIC X(13).
  1707     12  CO-TELEPHONE.
  1708         16  CO-AREA-CODE                      PIC XXX.
  1709         16  CO-PREFIX                         PIC XXX.
  1710         16  CO-PHONE                          PIC X(4).
  1711
  1712     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1713
  1714     12  CO-AR-BAL-LEVEL                       PIC X.
  1715         88  CO-AR-REF-LVL                        VALUE '1'.
  1716         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1717         88  CO-AR-BILL-LVL                       VALUE '2'.
  1718         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  32
* EL050.cbl
  1719         88  CO-AR-FR-LVL                         VALUE '4'.
  1720
  1721     12  CO-AR-NORMAL-PRINT                    PIC X.
  1722         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1723         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1724
  1725     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1726
  1727     12  CO-AR-REPORTING                       PIC X.
  1728         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1729         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1730
  1731     12  CO-AR-PULL-CHECK                      PIC X.
  1732         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1733         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1734
  1735     12  CO-AR-BALANCE-PRINT                   PIC X.
  1736         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1737
  1738     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1739         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1740         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1741         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1742
  1743     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1744
  1745     12  CO-USER-CODE                          PIC X.
  1746     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1747
  1748******************************************************************
  1749*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1750*    THE LAST MONTH END RUN.
  1751******************************************************************
  1752
  1753     12  CO-LAST-ACTIVITY-DATE.
  1754         16  CO-ACT-YEAR                       PIC 99.
  1755         16  CO-ACT-MONTH                      PIC 99.
  1756         16  CO-ACT-DAY                        PIC 99.
  1757
  1758     12  CO-LAST-STMT-DT.
  1759         16  CO-LAST-STMT-YEAR                 PIC 99.
  1760         16  CO-LAST-STMT-MONTH                PIC 99.
  1761         16  CO-LAST-STMT-DAY                  PIC 99.
  1762
  1763     12  CO-MO-END-TOTALS.
  1764         16  CO-MONTHLY-TOTALS.
  1765             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1766             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1767             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1768             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1769             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1770
  1771         16  CO-AGING-TOTALS.
  1772             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1773             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1774             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1775             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1776
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  33
* EL050.cbl
  1777         16  CO-YTD-TOTALS.
  1778             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1779             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1780
  1781         16  CO-OVER-UNDER-TOTALS.
  1782             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1783             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1784
  1785     12  CO-MISCELLANEOUS-TOTALS.
  1786         16  CO-FICA-TOTALS.
  1787             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1788             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1789
  1790         16  CO-CLAIM-TOTALS.
  1791             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1792             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1793
  1794******************************************************************
  1795*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1796*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1797******************************************************************
  1798
  1799     12  CO-CURRENT-TOTALS.
  1800         16  CO-CURRENT-LAST-STMT-DT.
  1801             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1802             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1803             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1804
  1805         16  CO-CURRENT-MONTHLY-TOTALS.
  1806             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1807             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1808             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1809             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1810             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1811
  1812         16  CO-CURRENT-AGING-TOTALS.
  1813             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1814             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1815             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1816             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1817
  1818         16  CO-CURRENT-YTD-TOTALS.
  1819             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1820             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1821
  1822     12  CO-PAID-COMM-TOTALS.
  1823         16  CO-YTD-PAID-COMMS.
  1824             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1825             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1826
  1827     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1828         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1829         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1830
  1831     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1832         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1833         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1834         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  34
* EL050.cbl
  1835         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1836         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1837         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1838         88  CO-FINAL-LETTER                  VALUE 'F'.
  1839         88  CO-RECONCILING                   VALUE 'R'.
  1840         88  CO-PHONE-CALL                    VALUE 'P'.
  1841         88  CO-LEGAL                         VALUE 'L'.
  1842         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1843         88  CO-WRITE-OFF                     VALUE 'W'.
  1844         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1845
  1846     12  CO-CSR-CODE                       PIC X(4).
  1847
  1848     12  CO-GA-STATUS-INFO.
  1849         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1850         16  CO-GA-TERMINATION-DT          PIC XX.
  1851         16  CO-GA-STATUS-CODE             PIC X.
  1852             88  CO-GA-ACTIVE                 VALUE 'A'.
  1853             88  CO-GA-INACTIVE               VALUE 'I'.
  1854             88  CO-GA-PENDING                VALUE 'P'.
  1855         16  CO-GA-COMMENTS.
  1856             20  CO-GA-COMMENT-1           PIC X(40).
  1857             20  CO-GA-COMMENT-2           PIC X(40).
  1858             20  CO-GA-COMMENT-3           PIC X(40).
  1859             20  CO-GA-COMMENT-4           PIC X(40).
  1860
  1861     12  CO-RPTCD2                         PIC X(10).
  1862     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1863         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1864         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1865
  1866     12  CO-TYPE-AGENT                     PIC X(01).
  1867         88  CO-CORPORATION                   VALUE 'C'.
  1868         88  CO-PARTNERSHIP                   VALUE 'P'.
  1869         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1870         88  CO-TRUST                         VALUE 'T'.
  1871         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1872
  1873     12  CO-FAXNO.
  1874         16  CO-FAX-AREA-CODE                  PIC XXX.
  1875         16  CO-FAX-PREFIX                     PIC XXX.
  1876         16  CO-FAX-PHONE                      PIC X(4).
  1877
  1878     12  CO-BANK-INFORMATION.
  1879         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1880         16  CO-BANK-TRANSIT-NON REDEFINES
  1881             CO-BANK-TRANSIT-NO                PIC 9(8).
  1882
  1883         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1884     12  CO-MISC-DEDUCT-INFO REDEFINES
  1885                  CO-BANK-INFORMATION.
  1886         16  CO-MD-GL-ACCT                     PIC X(10).
  1887         16  CO-MD-DIV                         PIC XX.
  1888         16  CO-MD-CENTER                      PIC X(4).
  1889         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1890         16  CO-CREATE-AP-CHECK                PIC X.
  1891         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1892         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  35
* EL050.cbl
  1893     12  CO-ACH-STATUS                         PIC X.
  1894         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1895         88  CO-ACH-PENDING                        VALUE 'P'.
  1896
  1897     12  CO-BILL-SW                            PIC X.
  1898     12  CO-CONTROL-NAME                       PIC X(30).
  1899     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1900     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1901     12  CO-CLP-STATE                          PIC XX.
  1902     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1903     12  CO-SPP-REFUND-EDIT                    PIC X.
  1904
  1905******************************************************************
  1906
  1907*    COPY ERCAGTC.
  1908******************************************************************
  1909*                                                                *
  1910*                                                                *
  1911*                            ERCAGTC                             *
  1912*                            VMOD=2.001                          *
  1913*                                                                *
  1914*   ONLINE CREDIT SYSTEM                                         *
  1915*                                                                *
  1916*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1917*                                                                *
  1918*   FILE TYPE = VSAM,KSDS                                        *
  1919*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1920*                                                                *
  1921*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1922*       ALTERNATE PATH = NONE                                    *
  1923*                                                                *
  1924*   LOG = NO                                                     *
  1925*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1926*                                                                *
  1927******************************************************************
  1928*                   C H A N G E   L O G
  1929*
  1930* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1931*-----------------------------------------------------------------
  1932*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1933* EFFECTIVE    NUMBER
  1934*-----------------------------------------------------------------
  1935* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1936* 111004                         NEW FILE AND COPYBOOK
  1937* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1938******************************************************************
  1939 01  AGENT-COMMISSIONS.
  1940     12  AG-RECORD-ID                          PIC XX.
  1941         88  VALID-CO-ID                          VALUE 'AG'.
  1942     12  AG-CONTROL-PRIMARY.
  1943         16  AG-COMPANY-CD                     PIC X.
  1944         16  AG-CONTROL.
  1945             20  AG-CTL-1.
  1946                 24  AG-CARR-GROUP.
  1947                     28  AG-CARRIER            PIC X.
  1948                     28  AG-GROUPING           PIC X(6).
  1949                 24  AG-BANK                   PIC X(10).
  1950             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  36
* EL050.cbl
  1951                 24  AG-EXP-DT                 PIC XX.
  1952         16  AG-TYPE                           PIC X.
  1953             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1954             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1955     12  AG-MAINT-INFORMATION.
  1956         16  AG-LAST-MAINT-DT                  PIC XX.
  1957         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1958         16  AG-LAST-MAINT-USER                PIC X(4).
  1959         16  FILLER                            PIC X(10).
  1960     12  AG-EFF-DT                             PIC XX.
  1961     12  AG-COMM-STRUCTURE.
  1962         16  AG-AGT-COMMS OCCURS 10.
  1963             20  AG-AGT                PIC X(10).
  1964             20  AG-COM-TYP            PIC X.
  1965             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1966             20  AG-RECALC-LV-INDIC    PIC X.
  1967             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1968             20  AG-LRCALC-LV-INDIC    PIC X.
  1969             20  FILLER                PIC X(05).
  1970     12  FILLER                  PIC X(145).
  1971******************************************************************
  1972*    COPY ERCRESS.
  1973******************************************************************
  1974*                                                                *
  1975*                            ERCRESS                             *
  1976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1977*                            VMOD=2.002                          *
  1978*                                                                *
  1979*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1980*                                                                *
  1981*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1982*   VSAM RESIDENT STATE TAX MASTER                              *
  1983*                                                                *
  1984*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1985*                                                                *
  1986*   FILE TYPE = VSAM,KSDS                                        *
  1987*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1988*                                                                *
  1989*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1990*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1991*                                                                *
  1992*   LOG = NO                                                     *
  1993*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1994*                                                                *
  1995*                                                                *
  1996******************************************************************
  1997
  1998 01  RESIDENT-STATE-TAX-MASTER.
  1999
  2000     10  ERRESS-PRIMARY-KEY.
  2001         15  RES-COMPANY-CD        PIC X.
  2002         15  RES-RESIDENT-STATE    PIC XX.
  2003         15  RES-COVERAGE-CATEGORY PIC X.
  2004         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2005*                                      YYYYMMDD
  2006*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2007
  2008     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  37
* EL050.cbl
  2009
  2010         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2011         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2012         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2013         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2014
  2015     10 RES-RECALC-SW              PIC   X.
  2016         88 RECALC                VALUE 'Y'.
  2017         88 NO-RECALC             VALUE 'N'.
  2018     10  RES-MAINT-BY              PIC X(4).
  2019     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2020     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2021*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  38
* EL050.cbl
  2023*    COPY ERCRESC.
  2024******************************************************************
  2025*                                                                *
  2026*                            ERCRESC                             *
  2027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2028*                            VMOD=2.003                          *
  2029*                                                                *
  2030*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2031*                                                                *
  2032*   FILE TYPE = VSAM,KSDS                                        *
  2033*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2034*                                                                *
  2035*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2036*       ALTERNATE PATH1 = NONE                                   *
  2037*                                                                *
  2038*   LOG = NO                                                     *
  2039*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2040*                                                                *
  2041******************************************************************
  2042
  2043 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2044
  2045     10  ERRESC-RECORD-KEY.
  2046         15  RESC-COMPANY-CD           PIC   X.
  2047         15  RESC-CARRIER              PIC   X.
  2048         15  RESC-GROUP                PIC   X(6).
  2049         15  RESC-STATE                PIC   XX.
  2050         15  RESC-ACCOUNT              PIC   X(10).
  2051         15  RESC-AGENT                PIC   X(10).
  2052         15  RESC-RESIDENT-STATE       PIC   XX.
  2053         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2054*                                           YYYYMMDD
  2055     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2056
  2057     10  RESC-COMM-RECORD-DATA.
  2058         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2059             20 RESC-COVERAGE-CAT      PIC    X.
  2060             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2061             20 RESC-COMMISSION-TAB REDEFINES
  2062                RESC-COMMISSION-PER    PIC  XXX.
  2063
  2064     10  RESC-MAINT-BY                 PIC X(4).
  2065     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2066     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2067*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  39
* EL050.cbl
  2069*    COPY ERCPLAN.
  2070******************************************************************
  2071*                                                                *
  2072*                                                                *
  2073*                            ERCPLAN                             *
  2074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2075*                            VMOD=2.003                          *
  2076*                                                                *
  2077*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2078*                                                                *
  2079*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2080*   PLAN MASTER                                                  *
  2081*                                                                *
  2082*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2083*                                                                *
  2084*   FILE TYPE = VSAM,KSDS                                        *
  2085*   RECORD SIZE = 420   RECFORM = FIX                            *
  2086*                                                                *
  2087*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2088*       ALTERNATE PATH1 = N/A                                    *
  2089*                                                                *
  2090*   LOG = NO                                                     *
  2091*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2092*                                                                *
  2093*                                                                *
  2094******************************************************************
  2095
  2096 01  PLAN-MASTER.
  2097     12  PL-RECORD-ID                      PIC XX.
  2098         88  VALID-PL-ID                      VALUE 'PL'.
  2099
  2100     12  PL-CONTROL-PRIMARY.
  2101         16  PL-COMPANY-CD                 PIC X.
  2102         16  PL-MSTR-CNTRL.
  2103             20  PL-CONTROL-A.
  2104                 24  PL-CARRIER            PIC X.
  2105                 24  PL-GROUPING           PIC X(6).
  2106                 24  PL-STATE              PIC XX.
  2107                 24  PL-ACCOUNT            PIC X(10).
  2108             20  PL-BENEFIT-TYPE           PIC X.
  2109             20  PL-BENEFIT-CODE           PIC XX.
  2110             20  PL-REVISION-NO            PIC X(3).
  2111
  2112     12  PL-CONTROL-BY-VAR-GRP.
  2113         16  PL-COMPANY-CD-A1              PIC X.
  2114         16  PL-VG-CARRIER                 PIC X.
  2115         16  PL-VG-GROUPING                PIC X(6).
  2116         16  PL-VG-STATE                   PIC XX.
  2117         16  PL-VG-ACCOUNT                 PIC X(10).
  2118         16  PL-BENEFIT-TYPE-A1            PIC X.
  2119         16  PL-BENEFIT-CODE-A1            PIC XX.
  2120         16  PL-REVISION-NO-A1             PIC 999.
  2121
  2122     12  PL-MAINT-INFORMATION.
  2123         16  PL-LAST-MAINT-DT              PIC XX.
  2124         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2125         16  PL-LAST-MAINT-USER            PIC X(4).
  2126         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  40
* EL050.cbl
  2127
  2128     12  PL-LIABILITY-LIMITS.
  2129         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2130         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2131             20  PL-LM-AGE                 PIC S99        COMP-3.
  2132             20  PL-LM-DUR                 PIC S999       COMP-3.
  2133             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2134             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2135
  2136     12  FILLER                            PIC X(30).
  2137
  2138     12  PL-GL-ACCOUNT-NOS.
  2139         16  PL-PREMIUM-GL                 PIC X(8).
  2140         16  PL-COMM-GL                    PIC X(8).
  2141         16  PL-CLAIM-GL                   PIC X(8).
  2142     12  FILLER                            PIC X(24).
  2143     12  PL-TOLERANCES.
  2144         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2145         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2146         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2147         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2148         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2149         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2150     12  PL-OVER-SHORT.
  2151         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2152         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2153     12  FILLER                            PIC X(24).
  2154     12  PLAN-MISC.
  2155         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2156         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2157         16  PL-IG                         PIC X.
  2158         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2159         16  PL-POLICY-FORM                PIC X(12).
  2160         16  PL-EDIT-FOR-FORM              PIC X(01).
  2161         16  PL-DEV-CODE                   PIC XXX.
  2162         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2163         16  PL-CALC-METHOD                PIC X.
  2164         16  PL-BENEFIT-GROUP              PIC X(05).
  2165         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2166
  2167         16  FILLER                        PIC X(99).
  2168******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  41
* EL050.cbl
  2170*    COPY ELCCERT.
  2171******************************************************************
  2172*                                                                *
  2173*                            ELCCERT.                            *
  2174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2175*                            VMOD=2.013                          *
  2176*                                                                *
  2177*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2178*                                                                *
  2179*   FILE TYPE = VSAM,KSDS                                        *
  2180*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2181*                                                                *
  2182*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2183*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2184*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2185*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2186*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2187*                                                                *
  2188*   LOG = YES                                                    *
  2189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2190******************************************************************
  2191*                   C H A N G E   L O G
  2192*
  2193* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2194*-----------------------------------------------------------------
  2195*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2196* EFFECTIVE    NUMBER
  2197*-----------------------------------------------------------------
  2198* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2199* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2200* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2201* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2202* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2203* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2204* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2205* 032612  CR2011110200001  PEMA  AHL CHANGES
  2206* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2207* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2208******************************************************************
  2209
  2210 01  CERTIFICATE-MASTER.
  2211     12  CM-RECORD-ID                      PIC XX.
  2212         88  VALID-CM-ID                      VALUE 'CM'.
  2213
  2214     12  CM-CONTROL-PRIMARY.
  2215         16  CM-COMPANY-CD                 PIC X.
  2216         16  CM-CARRIER                    PIC X.
  2217         16  CM-GROUPING.
  2218             20  CM-GROUPING-PREFIX        PIC X(3).
  2219             20  CM-GROUPING-PRIME         PIC X(3).
  2220         16  CM-STATE                      PIC XX.
  2221         16  CM-ACCOUNT.
  2222             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2223             20  CM-ACCOUNT-PRIME          PIC X(6).
  2224         16  CM-CERT-EFF-DT                PIC XX.
  2225         16  CM-CERT-NO.
  2226             20  CM-CERT-PRIME             PIC X(10).
  2227             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  42
* EL050.cbl
  2228
  2229     12  CM-CONTROL-BY-NAME.
  2230         16  CM-COMPANY-CD-A1              PIC X.
  2231         16  CM-INSURED-LAST-NAME          PIC X(15).
  2232         16  CM-INSURED-INITIALS.
  2233             20  CM-INSURED-INITIAL1       PIC X.
  2234             20  CM-INSURED-INITIAL2       PIC X.
  2235
  2236     12  CM-CONTROL-BY-SSN.
  2237         16  CM-COMPANY-CD-A2              PIC X.
  2238         16  CM-SOC-SEC-NO.
  2239             20  CM-SSN-STATE              PIC XX.
  2240             20  CM-SSN-ACCOUNT            PIC X(6).
  2241             20  CM-SSN-LN3.
  2242                 25  CM-INSURED-INITIALS-A2.
  2243                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2244                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2245                 25 CM-PART-LAST-NAME-A2         PIC X.
  2246
  2247     12  CM-CONTROL-BY-CERT-NO.
  2248         16  CM-COMPANY-CD-A4              PIC X.
  2249         16  CM-CERT-NO-A4                 PIC X(11).
  2250
  2251     12  CM-CONTROL-BY-MEMB.
  2252         16  CM-COMPANY-CD-A5              PIC X.
  2253         16  CM-MEMBER-NO.
  2254             20  CM-MEMB-STATE             PIC XX.
  2255             20  CM-MEMB-ACCOUNT           PIC X(6).
  2256             20  CM-MEMB-LN4.
  2257                 25  CM-INSURED-INITIALS-A5.
  2258                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2259                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2260                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2261
  2262     12  CM-INSURED-PROFILE-DATA.
  2263         16  CM-INSURED-FIRST-NAME.
  2264             20  CM-INSURED-1ST-INIT       PIC X.
  2265             20  FILLER                    PIC X(9).
  2266         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2267         16  CM-INSURED-SEX                PIC X.
  2268             88  CM-SEX-MALE                  VALUE 'M'.
  2269             88  CM-SEX-FEMAL                 VALUE 'F'.
  2270         16  CM-INSURED-JOINT-AGE          PIC 99.
  2271         16  CM-JOINT-INSURED-NAME.
  2272             20  CM-JT-LAST-NAME           PIC X(15).
  2273             20  CM-JT-FIRST-NAME.
  2274                 24  CM-JT-1ST-INIT        PIC X.
  2275                 24  FILLER                PIC X(9).
  2276             20  CM-JT-INITIAL             PIC X.
  2277
  2278     12  CM-LIFE-DATA.
  2279         16  CM-LF-BENEFIT-CD              PIC XX.
  2280         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2281         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2282         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2283         16  CM-LF-DEV-CODE                PIC XXX.
  2284         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2285         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  43
* EL050.cbl
  2286         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2287         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2288         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2289         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2290         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2291         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2292         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2293         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2294         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2295         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2296         16  cm-temp-epiq                  pic xx.
  2297             88  EPIQ-CLASS                  value 'EQ'.
  2298*        16  FILLER                        PIC XX.
  2299
  2300     12  CM-AH-DATA.
  2301         16  CM-AH-BENEFIT-CD              PIC XX.
  2302         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2303         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2304         16  CM-AH-DEV-CODE                PIC XXX.
  2305         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2306         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2307         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2308         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2309         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2310         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2311         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2312         16  CM-AH-PAID-THRU-DT            PIC XX.
  2313             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2314         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2315         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2316         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2317         16  FILLER                        PIC X.
  2318
  2319     12  CM-LOAN-INFORMATION.
  2320         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2321         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2322                                           PIC S9(5)V99  COMP-3.
  2323         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2324         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2325         16  CM-PAY-FREQUENCY              PIC S99.
  2326         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2327         16  CM-RATE-CLASS                 PIC XX.
  2328         16  CM-BENEFICIARY                PIC X(25).
  2329         16  CM-POLICY-FORM-NO             PIC X(12).
  2330         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2331         16  CM-LAST-ADD-ON-DT             PIC XX.
  2332         16  CM-DEDUCTIBLE-AMOUNTS.
  2333             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2334             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2335         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2336             20  CM-RESIDENT-STATE         PIC XX.
  2337             20  CM-RATE-CODE              PIC X(4).
  2338             20  FILLER                    PIC XX.
  2339         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2340             20  CM-LOAN-OFFICER           PIC X(5).
  2341             20  FILLER                    PIC XXX.
  2342         16  CM-CSR-CODE                   PIC XXX.
  2343         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  44
* EL050.cbl
  2344             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2345         16  CM-POST-CARD-IND              PIC X.
  2346         16  CM-NH-INTERFACE-SW            PIC X.
  2347         16  CM-PREMIUM-TYPE               PIC X.
  2348             88  CM-SING-PRM                  VALUE '1'.
  2349             88  CM-O-B-COVERAGE              VALUE '2'.
  2350             88  CM-OPEN-END                  VALUE '3'.
  2351         16  CM-IND-GRP-TYPE               PIC X.
  2352             88  CM-INDIVIDUAL                VALUE 'I'.
  2353             88  CM-GROUP                     VALUE 'G'.
  2354         16  CM-SKIP-CODE                  PIC X.
  2355             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2356             88  SKIP-JULY                    VALUE '1'.
  2357             88  SKIP-AUGUST                  VALUE '2'.
  2358             88  SKIP-SEPTEMBER               VALUE '3'.
  2359             88  SKIP-JULY-AUG                VALUE '4'.
  2360             88  SKIP-AUG-SEPT                VALUE '5'.
  2361             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2362             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2363             88  SKIP-JUNE                    VALUE '8'.
  2364             88  SKIP-JUNE-JULY               VALUE '9'.
  2365             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2366             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2367         16  CM-PAYMENT-MODE               PIC X.
  2368             88  PAY-MONTHLY                  VALUE SPACE.
  2369             88  PAY-WEEKLY                   VALUE '1'.
  2370             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2371             88  PAY-BI-WEEKLY                VALUE '3'.
  2372             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2373         16  CM-LOAN-NUMBER                PIC X(8).
  2374         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2375         16  CM-OLD-LOF                    PIC XXX.
  2376*        16  CM-LOAN-OFFICER               PIC XXX.
  2377         16  CM-REIN-TABLE                 PIC XXX.
  2378         16  CM-SPECIAL-REIN-CODE          PIC X.
  2379         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2380         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2381         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2382
  2383     12  CM-STATUS-DATA.
  2384         16  CM-ENTRY-STATUS               PIC X.
  2385         16  CM-ENTRY-DT                   PIC XX.
  2386
  2387         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2388         16  CM-LF-CANCEL-DT               PIC XX.
  2389         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2390
  2391         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2392         16  CM-LF-DEATH-DT                PIC XX.
  2393         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2394
  2395         16  CM-LF-CURRENT-STATUS          PIC X.
  2396             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2397                                                'M' '4' '5' '9'.
  2398             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2399             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2400             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2401             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  45
* EL050.cbl
  2402             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2403             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2404             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2405             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2406             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2407             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2408             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2409             88  CM-LF-DECLINED               VALUE 'D'.
  2410             88  CM-LF-VOIDED                 VALUE 'V'.
  2411
  2412         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2413         16  CM-AH-CANCEL-DT               PIC XX.
  2414         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2415
  2416         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2417         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2418         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2419
  2420         16  CM-AH-CURRENT-STATUS          PIC X.
  2421             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2422                                                'M' '4' '5' '9'.
  2423             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2424             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2425             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2426             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2427             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2428             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2429             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2430             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2431             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2432             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2433             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2434             88  CM-AH-DECLINED               VALUE 'D'.
  2435             88  CM-AH-VOIDED                 VALUE 'V'.
  2436
  2437         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2438             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2439             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2440             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2441         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2442
  2443         16  CM-ENTRY-BATCH                PIC X(6).
  2444         16  CM-LF-EXIT-BATCH              PIC X(6).
  2445         16  CM-AH-EXIT-BATCH              PIC X(6).
  2446         16  CM-LAST-MONTH-END             PIC XX.
  2447
  2448     12  CM-NOTE-SW                        PIC X.
  2449         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2450         88  CERT-NOTES-PRESENT               VALUE '1'.
  2451         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2452         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2453         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2454         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2455         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2456         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2457     12  CM-COMP-EXCP-SW                   PIC X.
  2458         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2459         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  46
* EL050.cbl
  2460     12  CM-INSURED-ADDRESS-SW             PIC X.
  2461         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2462         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2463
  2464*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2465     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2466     12  FILLER                            PIC X.
  2467
  2468*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2469     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2470     12  FILLER                            PIC X.
  2471*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2472     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2473
  2474     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2475         88  CERT-ADDED-BATCH                 VALUE ' '.
  2476         88  CERT-ADDED-ONLINE                VALUE '1'.
  2477         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2478         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2479         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2480     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2481         88  CERT-AS-LOADED                   VALUE ' '.
  2482         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2483         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2484         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2485         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2486         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2487         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2488         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2489
  2490     12  CM-ACCOUNT-COMM-PCTS.
  2491         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2492         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2493
  2494     12  CM-USER-FIELD                     PIC X.
  2495     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2496     12  CM-CLP-STATE                      PIC XX.
  2497     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2498     12  CM-USER-RESERVED                  PIC XXX.
  2499     12  FILLER REDEFINES CM-USER-RESERVED.
  2500         16  CM-AH-CLASS-CD                PIC XX.
  2501         16  F                             PIC X.
  2502******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  47
* EL050.cbl
  2504*    COPY ERCMAIL.
  2505******************************************************************
  2506*                                                                *
  2507*                                                                *
  2508*                            ERCMAIL                             *
  2509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2510*                            VMOD=2.003                          *
  2511*                                                                *
  2512*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2513*                                                                *
  2514*   FILE TYPE = VSAM,KSDS                                        *
  2515*   RECORD SIZE = 374   RECFORM = FIX                            *
  2516*                                                                *
  2517*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2518*   ALTERNATE PATH    = NOT USED                                 *
  2519*                                                                *
  2520*   LOG = YES                                                    *
  2521*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2522******************************************************************
  2523*                   C H A N G E   L O G
  2524*
  2525* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2526*-----------------------------------------------------------------
  2527*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2528* EFFECTIVE    NUMBER
  2529*-----------------------------------------------------------------
  2530* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2531* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2532* 111108                   PEMA  ADD CRED BENE ADDR2
  2533******************************************************************
  2534
  2535 01  MAILING-DATA.
  2536     12  MA-RECORD-ID                      PIC XX.
  2537         88  VALID-MA-ID                       VALUE 'MA'.
  2538
  2539     12  MA-CONTROL-PRIMARY.
  2540         16  MA-COMPANY-CD                 PIC X.
  2541         16  MA-CARRIER                    PIC X.
  2542         16  MA-GROUPING.
  2543             20  MA-GROUPING-PREFIX        PIC XXX.
  2544             20  MA-GROUPING-PRIME         PIC XXX.
  2545         16  MA-STATE                      PIC XX.
  2546         16  MA-ACCOUNT.
  2547             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2548             20  MA-ACCOUNT-PRIME          PIC X(6).
  2549         16  MA-CERT-EFF-DT                PIC XX.
  2550         16  MA-CERT-NO.
  2551             20  MA-CERT-PRIME             PIC X(10).
  2552             20  MA-CERT-SFX               PIC X.
  2553
  2554     12  FILLER                            PIC XX.
  2555
  2556     12  MA-ACCESS-CONTROL.
  2557         16  MA-SOURCE-SYSTEM              PIC XX.
  2558             88  MA-FROM-CREDIT                VALUE 'CR'.
  2559             88  MA-FROM-VSI                   VALUE 'VS'.
  2560             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2561             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  48
* EL050.cbl
  2562         16  MA-RECORD-ADD-DT              PIC XX.
  2563         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2564         16  MA-LAST-MAINT-DT              PIC XX.
  2565         16  MA-LAST-MAINT-BY              PIC XXXX.
  2566         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2567
  2568     12  MA-PROFILE-INFO.
  2569         16  MA-QUALIFY-CODE-1             PIC XX.
  2570         16  MA-QUALIFY-CODE-2             PIC XX.
  2571         16  MA-QUALIFY-CODE-3             PIC XX.
  2572         16  MA-QUALIFY-CODE-4             PIC XX.
  2573         16  MA-QUALIFY-CODE-5             PIC XX.
  2574
  2575         16  MA-INSURED-LAST-NAME          PIC X(15).
  2576         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2577         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2578         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2579         16  MA-INSURED-BIRTH-DT           PIC XX.
  2580         16  MA-INSURED-SEX                PIC X.
  2581             88  MA-SEX-MALE                   VALUE 'M'.
  2582             88  MA-SEX-FEMALE                 VALUE 'F'.
  2583         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2584
  2585         16  MA-ADDRESS-CORRECTED          PIC X.
  2586         16  MA-JOINT-BIRTH-DT             PIC XX.
  2587*        16  FILLER                        PIC X(12).
  2588
  2589         16  MA-ADDRESS-LINE-1             PIC X(30).
  2590         16  MA-ADDRESS-LINE-2             PIC X(30).
  2591         16  MA-CITY-STATE.
  2592             20  MA-CITY                   PIC X(28).
  2593             20  MA-ADDR-STATE             PIC XX.
  2594         16  MA-ZIP.
  2595             20  MA-ZIP-CODE.
  2596                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2597                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2598                 24  FILLER                PIC X(4).
  2599             20  MA-ZIP-PLUS4              PIC X(4).
  2600         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2601             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2602             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2603             20  FILLER                    PIC X(3).
  2604
  2605         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2606
  2607         16  FILLER                        PIC XXX.
  2608*        16  FILLER                        PIC X(10).
  2609
  2610     12  MA-CRED-BENE-INFO.
  2611         16  MA-CRED-BENE-NAME                 PIC X(25).
  2612         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2613         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2614         16  MA-CRED-BENE-CTYST.
  2615             20  MA-CRED-BENE-CITY             PIC X(28).
  2616             20  MA-CRED-BENE-STATE            PIC XX.
  2617         16  MA-CRED-BENE-ZIP.
  2618             20  MA-CB-ZIP-CODE.
  2619                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  49
* EL050.cbl
  2620                     88  MA-CB-CANADIAN-POST-CODE
  2621                                           VALUE 'A' THRU 'Z'.
  2622                 24  FILLER                    PIC X(4).
  2623             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2624         16  MA-CB-CANADIAN-POSTAL-CODE
  2625                            REDEFINES MA-CRED-BENE-ZIP.
  2626             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2627             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2628             20  FILLER                        PIC X(3).
  2629     12  MA-POST-CARD-MAIL-DATA.
  2630         16  MA-MAIL-DATA OCCURS 7.
  2631             20  MA-MAIL-TYPE              PIC X.
  2632                 88  MA-12MO-MAILING           VALUE '1'.
  2633                 88  MA-EXP-MAILING            VALUE '2'.
  2634             20  MA-MAIL-STATUS            PIC X.
  2635                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2636                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2637                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2638             20  MA-MAIL-DATE              PIC XX.
  2639     12  FILLER                            PIC XX.
  2640     12  FILLER                            PIC XX.
  2641*    12  FILLER                            PIC X(30).
  2642******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  50
* EL050.cbl
  2644*    COPY ERCPNDM.
  2645******************************************************************
  2646*                                                                *
  2647*                                                                *
  2648*                            ERCPNDM                             *
  2649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2650*                            VMOD=2.003                          *
  2651*                                                                *
  2652*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2653*                                                                *
  2654*   FILE TYPE = VSAM,KSDS                                        *
  2655*   RECORD SIZE = 374   RECFORM = FIX                            *
  2656*                                                                *
  2657*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2658*   ALTERNATE PATH    = NOT USED                                 *
  2659*                                                                *
  2660*   LOG = YES                                                    *
  2661*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2662******************************************************************
  2663*                   C H A N G E   L O G
  2664*
  2665* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2666*-----------------------------------------------------------------
  2667*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2668* EFFECTIVE    NUMBER
  2669*-----------------------------------------------------------------
  2670* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2671* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2672* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2673* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2674******************************************************************
  2675
  2676 01  PENDING-MAILING-DATA.
  2677     12  PM-RECORD-ID                      PIC XX.
  2678         88  VALID-MA-ID                       VALUE 'PM'.
  2679
  2680     12  PM-CONTROL-PRIMARY.
  2681         16  PM-COMPANY-CD                 PIC X.
  2682         16  PM-ENTRY-BATCH                PIC X(6).
  2683         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2684         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2685
  2686     12  FILLER                            PIC X(14).
  2687
  2688     12  PM-ACCESS-CONTROL.
  2689         16  PM-SOURCE-SYSTEM              PIC XX.
  2690             88  PM-FROM-CREDIT                VALUE 'CR'.
  2691             88  PM-FROM-VSI                   VALUE 'VS'.
  2692             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2693             88  PM-FROM-OTHER                 VALUE 'OT'.
  2694         16  PM-RECORD-ADD-DT              PIC XX.
  2695         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2696         16  PM-LAST-MAINT-DT              PIC XX.
  2697         16  PM-LAST-MAINT-BY              PIC XXXX.
  2698         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2699
  2700     12  PM-PROFILE-INFO.
  2701         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  51
* EL050.cbl
  2702         16  PM-QUALIFY-CODE-2             PIC XX.
  2703         16  PM-QUALIFY-CODE-3             PIC XX.
  2704         16  PM-QUALIFY-CODE-4             PIC XX.
  2705         16  PM-QUALIFY-CODE-5             PIC XX.
  2706
  2707         16  PM-INSURED-LAST-NAME          PIC X(15).
  2708         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2709         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2710         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2711         16  PM-INSURED-BIRTH-DT           PIC XX.
  2712         16  PM-INSURED-SEX                PIC X.
  2713             88  PM-SEX-MALE                   VALUE 'M'.
  2714             88  PM-SEX-FEMALE                 VALUE 'F'.
  2715         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2716
  2717         16  PM-ADDRESS-CORRECTED          PIC X.
  2718         16  PM-JOINT-BIRTH-DT             PIC XX.
  2719*        16  FILLER                        PIC X(12).
  2720
  2721         16  PM-ADDRESS-LINE-1             PIC X(30).
  2722         16  PM-ADDRESS-LINE-2             PIC X(30).
  2723         16  PM-CITY-STATE.
  2724             20  PM-CITY                   PIC X(28).
  2725             20  PM-STATE                  PIC XX.
  2726         16  PM-ZIP.
  2727             20  PM-ZIP-CODE.
  2728                 24  PM-ZIP-1              PIC X.
  2729                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2730                 24  FILLER                PIC X(4).
  2731             20  PM-ZIP-PLUS4              PIC X(4).
  2732         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2733             20  PM-CAN-POST1              PIC XXX.
  2734             20  PM-CAN-POST2              PIC XXX.
  2735             20  FILLER                    PIC XXX.
  2736
  2737         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2738         16  pm-city-st-zip-verified       pic x.
  2739         16  FILLER                        PIC XX.
  2740
  2741     12  PM-CRED-BENE-INFO.
  2742         16  PM-CRED-BENE-NAME             PIC X(25).
  2743         16  PM-CRED-BENE-ADDR             PIC X(30).
  2744         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2745         16  PM-CRED-BENE-CTYST.
  2746             20  PM-CRED-BENE-CITY         PIC X(28).
  2747             20  PM-CRED-BENE-STATE        PIC XX.
  2748         16  PM-CRED-BENE-ZIP.
  2749             20  PM-CB-ZIP-CODE.
  2750                 24  PM-CB-ZIP-1           PIC X.
  2751                     88  PM-CB-CANADIAN-POST-CODE
  2752                                  VALUE 'A' THRU 'Z'.
  2753                 24  FILLER                PIC X(4).
  2754             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2755         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2756             20  PM-CB-CAN-POST1           PIC XXX.
  2757             20  PM-CB-CAN-POST2           PIC XXX.
  2758             20  FILLER                    PIC XXX.
  2759     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  52
* EL050.cbl
  2760         16  PM-MAIL-DATA OCCURS 7.
  2761             20  PM-MAIL-TYPE              PIC X.
  2762                 88  PM-12MO-MAILING           VALUE '1'.
  2763                 88  PM-EXP-MAILING            VALUE '2'.
  2764             20  PM-MAIL-STATUS            PIC X.
  2765                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2766                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2767                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2768             20  PM-MAIL-DATE              PIC XX.
  2769     12  FILLER                            PIC XX.
  2770     12  FILLER                            PIC X(12).
  2771*    12  FILLER                            PIC X(30).
  2772
  2773******************************************************************
  2774*                                COPY ERCLOFC.
  2775******************************************************************
  2776*                                                                *
  2777*                                                                *
  2778*                            ERCLOFC                             *
  2779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2780*                            VMOD=2.003                          *
  2781*                                                                *
  2782*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2783*                                                                *
  2784*   FILE TYPE = VSAM,KSDS                                        *
  2785*   RECORD SIZE = 670   RECFORM = FIX                            *
  2786*                                                                *
  2787*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2788*                                                                *
  2789*   LOG = YES                                                    *
  2790*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2791*                                                                *
  2792******************************************************************
  2793
  2794 01  LOAN-OFFICER-MASTER.
  2795     12  LO-RECORD-ID                PIC XX.
  2796         88  VALID-LO-ID                VALUE 'LO'.
  2797
  2798     12  LO-CONTROL-PRIMARY.
  2799         16  LO-COMPANY-CD           PIC X.
  2800         16  LO-CARRIER              PIC X.
  2801         16  LO-GROUPING.
  2802             20  LO-GROUPING-PREFIX  PIC XXX.
  2803             20  LO-GROUPING-PRIME   PIC XXX.
  2804         16  LO-STATE                PIC XX.
  2805         16  LO-ACCOUNT.
  2806             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2807             20  LO-ACCOUNT-PRIME    PIC X(6).
  2808         16  LO-OFFICER-CODE         PIC X(5).
  2809
  2810     12  LO-OFFICER-NAME             PIC X(30).
  2811
  2812     12  LO-LAST-MAINT-DT            PIC XX.
  2813     12  LO-LAST-USER                PIC X(4).
  2814     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2815
  2816     12  LO-COMP-CONTROL             PIC X.
  2817             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  53
* EL050.cbl
  2818             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2819     12  LO-DETAIL-CONTROL           PIC X.
  2820             88  LO-PRINT-DETAIL        VALUE 'D'.
  2821             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2822
  2823     12  LO-SV-CARRIER               PIC X.
  2824     12  LO-SV-GROUPING              PIC X(6).
  2825     12  LO-SV-STATE                 PIC XX.
  2826
  2827     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2828     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2829
  2830     12  LO-OFFICER-INFO.
  2831         16  FILLER OCCURS 12 TIMES.
  2832             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2833             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2834             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2835             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2836             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2837             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2838             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2839             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2840     12  FILLER                      PIC X(198).
  2841******************************************************************
  2842*                                COPY ERCPDEF.
  2843******************************************************************
  2844*                                                                *
  2845*                                                                *
  2846*                            ERCPDEF.                            *
  2847*                                                                *
  2848*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2849*                                                                *
  2850*    FILE TYPE = VSAM,KSDS                                       *
  2851*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2852*                                                                *
  2853*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2854*                                                                *
  2855*    LOG = YES                                                   *
  2856*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2857******************************************************************
  2858*                   C H A N G E   L O G
  2859*
  2860* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2861*-----------------------------------------------------------------
  2862*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2863* EFFECTIVE    NUMBER
  2864*-----------------------------------------------------------------
  2865* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2866* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2867* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2868******************************************************************
  2869 01  PRODUCT-MASTER.
  2870    12  PD-RECORD-ID                 PIC X(02).
  2871        88  VALID-PD-ID                  VALUE 'PD'.
  2872    12  PD-CONTROL-PRIMARY.
  2873        16  PD-COMPANY-CD            PIC X.
  2874        16  PD-STATE                 PIC XX.
  2875        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  54
* EL050.cbl
  2876        16  PD-FILLER                PIC X(7).
  2877        16  PD-BEN-TYPE              PIC X.
  2878        16  PD-BEN-CODE              PIC XX.
  2879        16  PD-PROD-EXP-DT           PIC XX.
  2880    12  FILLER                       PIC X(50).
  2881    12  PD-PRODUCT-DATA OCCURS 8.
  2882        16  PD-PROD-CODE             PIC X.
  2883            88  PD-PROD-LIFE           VALUE 'L'.
  2884            88  PD-PROD-PROP           VALUE 'P'.
  2885            88  PD-PROD-AH             VALUE 'A'.
  2886            88  PD-PROD-IU             VALUE 'I'.
  2887            88  PD-PROD-GAP            VALUE 'G'.
  2888            88  PD-PROD-FAML           VALUE 'F'.
  2889        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2890        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2891        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2892        16  PD-MAX-TERM              PIC S999        COMP-3.
  2893        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2894        16  FILLER                   PIC X.
  2895        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2896        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2897        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2898        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2899        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2900        16  PD-REC-CRIT-PERIOD       PIC 99.
  2901        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2902            20  PD-RECURRING-YN      PIC X.
  2903            20  FILLER               PIC X.
  2904        16  PD-RTW-MOS               PIC 99.
  2905        16  PD-MAX-EXTENSION         PIC 99.
  2906        16  pd-ben-pct               pic sv999 comp-3.
  2907*       16  FILLER                   PIC XX.
  2908    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2909    12  PD-TERM-LIMITS OCCURS 15.
  2910        16  PD-LOW-TERM              PIC S999        COMP-3.
  2911        16  PD-HI-TERM               PIC S999        COMP-3.
  2912*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2913    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2914        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2915        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2916    12  PD-EARN-FACTORS.
  2917        16  FILLER OCCURS 15.
  2918            20  FILLER OCCURS 15.
  2919                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2920    12  PD-PRODUCT-DESC              PIC X(80).
  2921    12  PD-TRUNCATED                 PIC X.
  2922    12  FILLER                       PIC X(59).
  2923    12  PD-MAINT-INFORMATION.
  2924        16  PD-LAST-MAINT-DT         PIC X(02).
  2925        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2926        16  PD-LAST-MAINT-BY         PIC X(04).
  2927*                                COPY ELCSTATE.
  2928******************************************************************
  2929*                                                                *
  2930*                                                                *
  2931*                            ELCSTATE.                           *
  2932*                                                                *
  2933*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  55
* EL050.cbl
  2934*                                                                *
  2935*   FILE TYPE = VSAM,KSDS                                        *
  2936*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2937*                                                                *
  2938*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2939*       ALTERNATE INDEX = NONE                                   *
  2940*                                                                *
  2941*   LOG = YES                                                    *
  2942*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2943******************************************************************
  2944*                   C H A N G E   L O G
  2945*
  2946* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2947*-----------------------------------------------------------------
  2948*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2949* EFFECTIVE    NUMBER
  2950*-----------------------------------------------------------------
  2951* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2952******************************************************************
  2953*
  2954 01  STATE-FILE.
  2955     12  SF-RECORD-ID                       PIC XX.
  2956         88  VALID-CF-ID                        VALUE 'SF'.
  2957     12  SF-CONTROL-PRIMARY.
  2958         16  SF-COMPANY-ID                  PIC XXX.
  2959         16  SF-CARRIER-CODE                PIC X.
  2960         16  SF-GROUPING                    PIC X(6).
  2961         16  SF-STATE-CODE                  PIC XX.
  2962         16  SF-EXPIRE-DATE                 PIC 9(8).
  2963****************************************************************
  2964*             STATE CONTROLS
  2965****************************************************************
  2966     12  SF-LAST-MAINT-DT                   PIC XX.
  2967     12  SF-LAST-MAINT-BY                   PIC X(4).
  2968     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2969     12  SF-STATE-RT-CONTROLS.
  2970         16  SF-ST-RT-CALC                  PIC X.
  2971     12  SF-ST-TAX-CONTROLS.
  2972         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2973         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2974         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2975     12  SF-ST-REFUND-OPTIONS.
  2976         16  SF-ST-RF-LR-CALC               PIC X.
  2977         16  SF-ST-RF-LL-CALC               PIC X.
  2978         16  SF-ST-RF-LN-CALC               PIC X.
  2979         16  SF-ST-RF-AH-CALC               PIC X.
  2980         16  SF-ST-RF-CP-CALC               PIC X.
  2981     12  SF-ST-UNEARN-PREM-OPTIONS.
  2982         16  SF-ST-LUEP-R78                 PIC X.
  2983         16  SF-ST-LUEP-PRO                 PIC X.
  2984         16  SF-ST-LUEP-ST                  PIC X.
  2985         16  SF-ST-LUEP-DOM                 PIC X.
  2986         16  SF-ST-AUEP-R78                 PIC X.
  2987         16  SF-ST-AUEP-PRO                 PIC X.
  2988         16  SF-ST-AUEP-ST                  PIC X.
  2989         16  SF-ST-AUEP-DOM                 PIC X.
  2990         16  SF-ST-CUEP-R78                 PIC X.
  2991         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  56
* EL050.cbl
  2992         16  SF-ST-CUEP-ST                  PIC X.
  2993         16  SF-ST-CUEP-DOM                 PIC X.
  2994     12  SF-ST-EARN-PREM-OPTIONS.
  2995         16  SF-ST-LEP-R78                  PIC X.
  2996         16  SF-ST-LEP-PRO                  PIC X.
  2997         16  SF-ST-LEP-ST                   PIC X.
  2998         16  SF-ST-LEP-DOM                  PIC X.
  2999         16  SF-ST-AEP-R78                  PIC X.
  3000         16  SF-ST-AEP-PRO                  PIC X.
  3001         16  SF-ST-AEP-ST                   PIC X.
  3002         16  SF-ST-AEP-DOM                  PIC X.
  3003         16  SF-ST-CEP-R78                  PIC X.
  3004         16  SF-ST-CEP-PRO                  PIC X.
  3005         16  SF-ST-CEP-ST                   PIC X.
  3006         16  SF-ST-CEP-DOM                  PIC X.
  3007     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  57
* EL050.cbl
  3009*    COPY ELCCRTT.
  3010******************************************************************
  3011*                                                                *
  3012*                            ELCCRTT.                            *
  3013*                                                                *
  3014*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3015*                                                                *
  3016*   FILE TYPE = VSAM,KSDS                                        *
  3017*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3018*                                                                *
  3019*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3020*                                                                *
  3021*   LOG = YES                                                    *
  3022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3023******************************************************************
  3024*                   C H A N G E   L O G
  3025*
  3026* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3027*-----------------------------------------------------------------
  3028*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3029* EFFECTIVE    NUMBER
  3030*-----------------------------------------------------------------
  3031* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3032* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3033* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3034* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3035* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3036* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3037* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3038* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3039* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3040******************************************************************
  3041
  3042 01  CERTIFICATE-TRAILERS.
  3043     12  CS-RECORD-ID                      PIC XX.
  3044         88  VALID-CS-ID                      VALUE 'CS'.
  3045
  3046     12  CS-CONTROL-PRIMARY.
  3047         16  CS-COMPANY-CD                 PIC X.
  3048         16  CS-CARRIER                    PIC X.
  3049         16  CS-GROUPING                   PIC X(6).
  3050         16  CS-STATE                      PIC XX.
  3051         16  CS-ACCOUNT                    PIC X(10).
  3052         16  CS-CERT-EFF-DT                PIC XX.
  3053         16  CS-CERT-NO.
  3054             20  CS-CERT-PRIME             PIC X(10).
  3055             20  CS-CERT-SFX               PIC X.
  3056         16  CS-TRAILER-TYPE               PIC X.
  3057             88  COMM-TRLR           VALUE 'A'.
  3058             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3059             88  CERT-DATA-TRLR      VALUE 'C'.
  3060
  3061     12  CS-DATA-AREA                      PIC X(516).
  3062
  3063     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3064         16  CS-BANK-COMMISSION-AREA.
  3065             20  CS-BANK-COMMS       OCCURS 10.
  3066                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  58
* EL050.cbl
  3067                 24  CS-COM-TYP            PIC X.
  3068                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3069                 24  CS-RECALC-LV-INDIC    PIC X.
  3070                 24  FILLER                PIC X(10).
  3071         16  FILLER                        PIC X(256).
  3072
  3073     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3074****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3075         16  CS-MB-CLAIM-DATA OCCURS 24.
  3076             20  CS-CLAIM-NO               PIC X(7).
  3077             20  CS-CLAIM-TYPE             PIC X.
  3078                 88  CS-AH-CLM               VALUE 'A'.
  3079                 88  CS-IU-CLM               VALUE 'I'.
  3080                 88  CS-GP-CLM               VALUE 'G'.
  3081                 88  CS-LF-CLM               VALUE 'L'.
  3082                 88  CS-PR-CLM               VALUE 'P'.
  3083                 88  CS-FL-CLM               VALUE 'F'.
  3084             20  CS-INSURED-TYPE           PIC X.
  3085                 88  CS-PRIM-INSURED          VALUE 'P'.
  3086                 88  CS-CO-BORROWER           VALUE 'C'.
  3087             20  CS-BENEFIT-PERIOD         PIC 99.
  3088             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3089             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3090             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3091         16  FILLER                        PIC X(12).
  3092     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3093         16  CS-VIN-NUMBER                 PIC X(17).
  3094         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3095         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3096         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3097         16  cs-agent-name.
  3098             20  cs-agent-fname            pic x(20).
  3099             20  cs-agent-mi               pic x.
  3100             20  cs-agent-lname            pic x(25).
  3101         16  cs-license-no                 pic x(15).
  3102         16  cs-npn-number                 pic x(10).
  3103         16  cs-agent-edit-status          pic x.
  3104             88  cs-ae-refer-to-manager      value 'M'.
  3105             88  cs-ae-cover-sheet           value 'C'.
  3106             88  cs-ae-sig-form              value 'S'.
  3107             88  cs-ae-verified              value 'V'.
  3108             88  cs-unidentified-signature   value 'U'.
  3109             88  cs-cert-returned            value 'R'.
  3110             88  cs-accept-no-commission     value 'N'.
  3111         16  cs-year                       pic 9999.
  3112         16  cs-make                       pic x(20).
  3113         16  cs-model                      pic x(20).
  3114         16  cs-future                     pic x(20).
  3115         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3116         16  FILLER                        PIC X(356). *> was 420
  3117*        16  FILLER                        PIC X(496).
  3118*    COPY ELCCRTO.
  3119******************************************************************
  3120*                                                                *
  3121*                            ELCCRTO.                            *
  3122*                                                                *
  3123*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3124*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  59
* EL050.cbl
  3125*   FILE TYPE = VSAM,KSDS                                        *
  3126*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3127*                                                                *
  3128*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3129*                                                                *
  3130*   LOG = YES                                                    *
  3131*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3132******************************************************************
  3133*                   C H A N G E   L O G
  3134*
  3135* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3136*-----------------------------------------------------------------
  3137*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3138* EFFECTIVE    NUMBER
  3139*-----------------------------------------------------------------
  3140* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3141* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3142* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3143* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3144* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3145******************************************************************
  3146 01  ORIGINAL-CERTIFICATE.
  3147     12  OC-RECORD-ID                      PIC XX.
  3148         88  VALID-OC-ID                      VALUE 'OC'.
  3149     12  OC-CONTROL-PRIMARY.
  3150         16  OC-COMPANY-CD                 PIC X.
  3151         16  OC-CARRIER                    PIC X.
  3152         16  OC-GROUPING                   PIC X(6).
  3153         16  OC-STATE                      PIC XX.
  3154         16  OC-ACCOUNT                    PIC X(10).
  3155         16  OC-CERT-EFF-DT                PIC XX.
  3156         16  OC-CERT-NO.
  3157             20  OC-CERT-PRIME             PIC X(10).
  3158             20  OC-CERT-SFX               PIC X.
  3159         16  OC-RECORD-TYPE                PIC X.
  3160         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3161     12  OC-LAST-MAINT-DT                  PIC XX.
  3162     12  OC-LAST-MAINT-BY                  PIC X(4).
  3163     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3164     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3165     12  FILLER                            PIC X(49).
  3166     12  OC-ORIG-REC.
  3167         16  OC-INS-LAST-NAME              PIC X(15).
  3168         16  OC-INS-FIRST-NAME             PIC X(10).
  3169         16  OC-INS-MIDDLE-INIT            PIC X.
  3170         16  OC-INS-AGE                    PIC S999     COMP-3.
  3171         16  OC-JNT-LAST-NAME              PIC X(15).
  3172         16  OC-JNT-FIRST-NAME             PIC X(10).
  3173         16  OC-JNT-MIDDLE-INIT            PIC X.
  3174         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3175         16  OC-LF-BENCD                   PIC XX.
  3176         16  OC-LF-TERM                    PIC S999      COMP-3.
  3177         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3178         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3179         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3180         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3181         16  OC-LF-EXP-DT                  PIC XX.
  3182         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  60
* EL050.cbl
  3183         16  OC-LF-CANCEL-DT               PIC XX.
  3184         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3185         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3186         16  OC-AH-BENCD                   PIC XX.
  3187         16  OC-AH-TERM                    PIC S999      COMP-3.
  3188         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3189         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3190         16  OC-AH-EXP-DT                  PIC XX.
  3191         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3192         16  OC-AH-CP                      PIC 99.
  3193         16  OC-AH-CANCEL-DT               PIC XX.
  3194         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3195         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3196         16  OC-CRED-BENE-NAME             PIC X(25).
  3197         16  OC-1ST-PMT-DT                 PIC XX.
  3198         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3199         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3200         16  OC-ISSUE-TRAN-IND             PIC X.
  3201         16  OC-CANCEL-TRAN-IND            PIC X.
  3202         16  FILLER                        PIC X(211).
  3203
  3204     12  FILLER                            PIC X(50).
  3205******************************************************************
  3206
  3207*    COPY ELCDATE.
  3208******************************************************************
  3209*                                                                *
  3210*                                                                *
  3211*                            ELCDATE.                            *
  3212*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3213*                            VMOD=2.003
  3214*                                                                *
  3215*                                                                *
  3216*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3217*                 LENGTH = 200                                   *
  3218******************************************************************
  3219
  3220 01  DATE-CONVERSION-DATA.
  3221     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3222     12  DC-OPTION-CODE                PIC X.
  3223         88  BIN-TO-GREG                VALUE ' '.
  3224         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3225         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3226         88  YMD-GREG-TO-BIN            VALUE '3'.
  3227         88  MDY-GREG-TO-BIN            VALUE '4'.
  3228         88  JULIAN-TO-BIN              VALUE '5'.
  3229         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3230         88  FIND-CENTURY               VALUE '7'.
  3231         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3232         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3233         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3234         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3235         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3236         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3237         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3238         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3239         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3240         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  61
* EL050.cbl
  3241         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3242         88  BIN-3-TO-GREG              VALUE 'I'.
  3243         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3244         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3245         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3246         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3247         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3248         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3249         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3250         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3251         88  THREE-CHARACTER-BIN
  3252                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3253         88  GREGORIAN-TO-BIN
  3254                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3255         88  BIN-TO-GREGORIAN
  3256                  VALUES ' ' '1' 'I' '8' 'G'.
  3257         88  JULIAN-TO-BINARY
  3258                  VALUES '5' 'C' 'E' 'F'.
  3259     12  DC-ERROR-CODE                 PIC X.
  3260         88  NO-CONVERSION-ERROR        VALUE ' '.
  3261         88  DATE-CONVERSION-ERROR
  3262                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3263         88  DATE-IS-ZERO               VALUE '1'.
  3264         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3265         88  DATE-IS-INVALID            VALUE '3'.
  3266         88  DATE1-GREATER-DATE2        VALUE '4'.
  3267         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3268         88  DATE-INVALID-OPTION        VALUE '9'.
  3269         88  INVALID-CENTURY            VALUE 'A'.
  3270         88  ONLY-CENTURY               VALUE 'B'.
  3271         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3272         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3273     12  DC-END-OF-MONTH               PIC X.
  3274         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3275     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3276         88  USE-NORMAL-PROCESS         VALUE ' '.
  3277         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3278         88  ADJUST-UP-100-YRS          VALUE '2'.
  3279     12  FILLER                        PIC X.
  3280     12  DC-CONVERSION-DATES.
  3281         16  DC-BIN-DATE-1             PIC XX.
  3282         16  DC-BIN-DATE-2             PIC XX.
  3283         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3284         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3285                       DC-GREG-DATE-1-EDIT.
  3286             20  DC-EDIT1-MONTH        PIC 99.
  3287             20  SLASH1-1              PIC X.
  3288             20  DC-EDIT1-DAY          PIC 99.
  3289             20  SLASH1-2              PIC X.
  3290             20  DC-EDIT1-YEAR         PIC 99.
  3291         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3292         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3293                     DC-GREG-DATE-2-EDIT.
  3294             20  DC-EDIT2-MONTH        PIC 99.
  3295             20  SLASH2-1              PIC X.
  3296             20  DC-EDIT2-DAY          PIC 99.
  3297             20  SLASH2-2              PIC X.
  3298             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  62
* EL050.cbl
  3299         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3300         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3301                     DC-GREG-DATE-1-YMD.
  3302             20  DC-YMD-YEAR           PIC 99.
  3303             20  DC-YMD-MONTH          PIC 99.
  3304             20  DC-YMD-DAY            PIC 99.
  3305         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3306         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3307                      DC-GREG-DATE-1-MDY.
  3308             20  DC-MDY-MONTH          PIC 99.
  3309             20  DC-MDY-DAY            PIC 99.
  3310             20  DC-MDY-YEAR           PIC 99.
  3311         16  DC-GREG-DATE-1-ALPHA.
  3312             20  DC-ALPHA-MONTH        PIC X(10).
  3313             20  DC-ALPHA-DAY          PIC 99.
  3314             20  FILLER                PIC XX.
  3315             20  DC-ALPHA-CENTURY.
  3316                 24 DC-ALPHA-CEN-N     PIC 99.
  3317             20  DC-ALPHA-YEAR         PIC 99.
  3318         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3319         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3320         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3321         16  DC-JULIAN-DATE            PIC 9(05).
  3322         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3323                                       PIC 9(05).
  3324         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3325             20  DC-JULIAN-YEAR        PIC 99.
  3326             20  DC-JULIAN-DAYS        PIC 999.
  3327         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3328         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3329         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3330     12  DATE-CONVERSION-VARIBLES.
  3331         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3332         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3333             20  FILLER                PIC 9(3).
  3334             20  HOLD-CEN-1-CCYY.
  3335                 24  HOLD-CEN-1-CC     PIC 99.
  3336                 24  HOLD-CEN-1-YY     PIC 99.
  3337             20  HOLD-CEN-1-MO         PIC 99.
  3338             20  HOLD-CEN-1-DA         PIC 99.
  3339         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3340             20  HOLD-CEN-1-R-MO       PIC 99.
  3341             20  HOLD-CEN-1-R-DA       PIC 99.
  3342             20  HOLD-CEN-1-R-CCYY.
  3343                 24  HOLD-CEN-1-R-CC   PIC 99.
  3344                 24  HOLD-CEN-1-R-YY   PIC 99.
  3345             20  FILLER                PIC 9(3).
  3346         16  HOLD-CENTURY-1-X.
  3347             20  FILLER                PIC X(3)  VALUE SPACES.
  3348             20  HOLD-CEN-1-X-CCYY.
  3349                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3350                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3351             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3352             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3353         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3354             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3355             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3356             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  63
* EL050.cbl
  3357                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3358                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3359             20  FILLER                PIC XXX.
  3360         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3361         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3362         16  DC-JULIAN-DATE-1          PIC 9(07).
  3363         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3364             20  DC-JULIAN-1-CCYY.
  3365                 24  DC-JULIAN-1-CC    PIC 99.
  3366                 24  DC-JULIAN-1-YR    PIC 99.
  3367             20  DC-JULIAN-DA-1        PIC 999.
  3368         16  DC-JULIAN-DATE-2          PIC 9(07).
  3369         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3370             20  DC-JULIAN-2-CCYY.
  3371                 24  DC-JULIAN-2-CC    PIC 99.
  3372                 24  DC-JULIAN-2-YR    PIC 99.
  3373             20  DC-JULIAN-DA-2        PIC 999.
  3374         16  DC-GREG-DATE-A-EDIT.
  3375             20  DC-EDITA-MONTH        PIC 99.
  3376             20  SLASHA-1              PIC X VALUE '/'.
  3377             20  DC-EDITA-DAY          PIC 99.
  3378             20  SLASHA-2              PIC X VALUE '/'.
  3379             20  DC-EDITA-CCYY.
  3380                 24  DC-EDITA-CENT     PIC 99.
  3381                 24  DC-EDITA-YEAR     PIC 99.
  3382         16  DC-GREG-DATE-B-EDIT.
  3383             20  DC-EDITB-MONTH        PIC 99.
  3384             20  SLASHB-1              PIC X VALUE '/'.
  3385             20  DC-EDITB-DAY          PIC 99.
  3386             20  SLASHB-2              PIC X VALUE '/'.
  3387             20  DC-EDITB-CCYY.
  3388                 24  DC-EDITB-CENT     PIC 99.
  3389                 24  DC-EDITB-YEAR     PIC 99.
  3390         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3391         16  DC-GREG-DATE-CYMD-R REDEFINES
  3392                              DC-GREG-DATE-CYMD.
  3393             20  DC-CYMD-CEN           PIC 99.
  3394             20  DC-CYMD-YEAR          PIC 99.
  3395             20  DC-CYMD-MONTH         PIC 99.
  3396             20  DC-CYMD-DAY           PIC 99.
  3397         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3398         16  DC-GREG-DATE-MDCY-R REDEFINES
  3399                              DC-GREG-DATE-MDCY.
  3400             20  DC-MDCY-MONTH         PIC 99.
  3401             20  DC-MDCY-DAY           PIC 99.
  3402             20  DC-MDCY-CEN           PIC 99.
  3403             20  DC-MDCY-YEAR          PIC 99.
  3404    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3405        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3406    12  DC-EL310-DATE                  PIC X(21).
  3407    12  FILLER                         PIC X(28).
  3408
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  64
* EL050.cbl
  3410*    COPY ELCCALC.
  3411******************************************************************
  3412*                                                                *
  3413*                           ELCCALC.                            *
  3414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3415*                            VMOD=2.025                          *
  3416*                                                                *
  3417*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3418*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3419*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3420*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3421*                                                                *
  3422*  PASSED TO ELRTRM                                              *
  3423*  -----------------                                             *
  3424*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3425*  ORIGINAL TERM                                                 *
  3426*  BEGINNING DATE                                                *
  3427*  ENDING DATE                                                   *
  3428*  COMPANY I.D.                                                  *
  3429*  ACCOUNT MASTER USER FIELD                                     *
  3430*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3431*  FREE LOOK DAYS                                                *
  3432*                                                                *
  3433*  RETURNED FROM ELRTRM                                          *
  3434*  ---------------------                                         *
  3435*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3436*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3437*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3438*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3439*----------------------------------------------------------------*
  3440*  PASSED TO ELRAMT                                              *
  3441*  ----------------                                              *
  3442*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3443*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3444*  ORIGINAL AMOUNT                                               *
  3445*  ALTERNATE BENEFIT (BALLON)                                    *
  3446*  A.P.R. - NET PAY ONLY                                         *
  3447*  METHOD
  3448*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3449*  COMPANY I.D.                                                  *
  3450*  BENEFIT TYPE                                                  *
  3451*                                                                *
  3452*  RETURNED FROM ELRAMT                                          *
  3453*  --------------------                                          *
  3454*  REMAINING AMOUNT 1 - CURRENT                                  *
  3455*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3456*  REMAINING AMOUNT FACTOR
  3457*----------------------------------------------------------------*
  3458*  PASSED TO ELRESV                                              *
  3459*  -----------------                                             *
  3460*  CERTIFICATE EFFECTIVE DATE                                    *
  3461*  VALUATION DATE                                                *
  3462*  PAID THRU DATE                                                *
  3463*  BENEFIT                                                       *
  3464*  INCURRED DATE                                                 *
  3465*  REPORTED DATE                                                 *
  3466*  ISSUE AGE                                                     *
  3467*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  65
* EL050.cbl
  3468*  CDT PERCENT                                                   *
  3469*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3470* *CLAIM TYPE (LIFE, A/H)                                        *
  3471* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3472* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3473*                                                                *
  3474*  RETURNED FROM ELRESV                                          *
  3475*  --------------------                                          *
  3476*  CDT TABLE USED                                                *
  3477*  CDT FACTOR USED                                               *
  3478*  PAY TO CURRENT RESERVE                                        *
  3479*  I.B.N.R. - A/H ONLY                                           *
  3480*  FUTURE (ACCRUED) AH ONLY                                      *
  3481*----------------------------------------------------------------*
  3482*  PASSED TO ELRATE                                              *
  3483*  ----------------                                              *
  3484*  CERT ISSUE DATE                                               *
  3485*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3486*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3487*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3488*  STATE CODE (CLIENT DEFINED)                                   *
  3489*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3490*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3491*  DEVIATION CODE                                                *
  3492*  ISSUE AGE                                                     *
  3493*  ORIGINAL BENEFIT AMOUNT                                       *
  3494*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3495*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3496*  BENEFIT KIND (LIFE OR A/H)                                    *
  3497*  A.P.R.                                                        *
  3498*  METHOD
  3499*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3500*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3501*  COMPANY I.D. (3 CHARACTER)                                    *
  3502*  BENEFIT CODE                                                  *
  3503*  BENEFIT OVERRIDE CODE                                         *
  3504*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3505*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3506*  JOINT INDICATOR (CSL ONLY)                                    *
  3507*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3508*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3509*                                                                *
  3510*  RETURNED FROM ELRATE                                          *
  3511*  --------------------                                          *
  3512*  CALCULATED PREMIUM                                            *
  3513*  PREMIUM RATE                                                  *
  3514*  MORTALITY CODE                                                *
  3515*  MAX ATTAINED AGE                                              *
  3516*  MAX AGE                                                       *
  3517*  MAX TERM                                                      *
  3518*  MAX MONTHLY BENEFIT                                           *
  3519*  MAX TOTAL BENIFIT                                             *
  3520*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3521*----------------------------------------------------------------*
  3522*  PASSED TO ELRFND                                              *
  3523*  ----------------                                              *
  3524*  CERT ISSUE DATE                                               *
  3525*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  66
* EL050.cbl
  3526*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3527*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3528*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3529*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3530*  STATE CODE (CLIENT DEFINED)                                   *
  3531*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3532*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3533*  DEVIATION CODE                                                *
  3534*  ISSUE AGE                                                     *
  3535*  ORIGINAL BENEFIT AMOUNT                                       *
  3536*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3537*  PROCESS TYPE (CANCEL)                                         *
  3538*  BENEFIT KIND (LIFE OR A/H)                                    *
  3539*  A.P.R.                                                        *
  3540*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3541*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3542*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3543*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3544*  COMPANY I.D. (3 CHARACTER)                                    *
  3545*  BENEFIT CODE                                                  *
  3546*  BENEFIT OVERRIDE CODE                                         *
  3547*                                                                *
  3548*  RETURNED FROM ELRFND                                          *
  3549*  --------------------                                          *
  3550*  CALCULATED REFUND                                             *
  3551*----------------------------------------------------------------*
  3552*  PASSED TO ELEARN                                              *
  3553*  ----------------                                              *
  3554*  CERT ISSUE DATE                                               *
  3555*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3556*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3557*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3558*  STATE CODE (CLIENT DEFINED)                                   *
  3559*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3560*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3561*  DEVIATION CODE                                                *
  3562*  ISSUE AGE                                                     *
  3563*  ORIGINAL BENEFIT AMOUNT                                       *
  3564*  BENEFIT KIND (LIFE OR A/H)                                    *
  3565*  A.P.R.                                                        *
  3566*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3567*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3568*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3569*  COMPANY I.D. (3 CHARACTER)                                    *
  3570*  BENEFIT CODE                                                  *
  3571*  BENEFIT OVERRIDE CODE                                         *
  3572*                                                                *
  3573*  RETURNED FROM ELEARN                                          *
  3574*  --------------------                                          *
  3575*  INDICATED  EARNINGS                                           *
  3576*----------------------------------------------------------------*
  3577*                 LENGTH = 450                                   *
  3578*                                                                *
  3579******************************************************************
  3580******************************************************************
  3581*                   C H A N G E   L O G
  3582*
  3583* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  67
* EL050.cbl
  3584*-----------------------------------------------------------------
  3585*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3586* EFFECTIVE    NUMBER
  3587*-----------------------------------------------------------------
  3588* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3589* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3590* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3591* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3592* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3593* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3594* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3595* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3596* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3597* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3598* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3599******************************************************************
  3600
  3601 01  CALCULATION-PASS-AREA.
  3602     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3603                                     COMP.
  3604
  3605     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3606       88  NO-CP-ERROR                             VALUE ZERO.
  3607       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3608                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3609       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3610       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3611       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3612       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3613       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3614       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3615       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3616       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3617       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3618       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3619       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3620       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3621       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3622       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3623       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3624       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3625       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3626
  3627     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3628       88  NO-CP-ERROR-2                           VALUE ZERO.
  3629***********************  INPUT AREAS ****************************
  3630
  3631     12  CP-CALCULATION-AREA.
  3632         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3633         16  CP-CERT-EFF-DT        PIC XX.
  3634         16  CP-VALUATION-DT       PIC XX.
  3635         16  CP-PAID-THRU-DT       PIC XX.
  3636         16  CP-BENEFIT-TYPE       PIC X.
  3637           88  CP-AH                               VALUE 'A' 'D'
  3638                                                   'I' 'U'.
  3639           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3640           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3641         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  68
* EL050.cbl
  3642         16  CP-REPORTED-DT        PIC XX.
  3643         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3644         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3645         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3648                                     COMP-3.
  3649         16  CP-CDT-METHOD         PIC X.
  3650           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3651           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3652           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3653         16  CP-CLAIM-TYPE         PIC X.
  3654           88  CP-AH-CLAIM                         VALUE 'A'.
  3655           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3656         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3657                                     COMP-3.
  3658         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3659                                     COMP-3.
  3660         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3663                                     COMP-3.
  3664         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3667                                     COMP-3.
  3668         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3669                                     COMP-3.
  3670         16  CP-REM-TERM-METHOD    PIC X.
  3671           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3672           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3673           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3674           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3675           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3676           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3677           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3678         16  CP-EARNING-METHOD     PIC X.
  3679           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3680           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3681           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3682           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3683           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3684           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3685           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3686           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3687           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3688           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3689           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3690           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3691           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3692           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3693         16  CP-PROCESS-TYPE       PIC X.
  3694           88  CP-CLAIM                            VALUE '1'.
  3695           88  CP-CANCEL                           VALUE '2'.
  3696           88  CP-ISSUE                            VALUE '3'.
  3697         16  CP-SPECIAL-CALC-CD    PIC X.
  3698           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3699           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  69
* EL050.cbl
  3700           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3701           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3702           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3703           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3704           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3705           88  CP-FARM-PLAN                    VALUE 'F'.
  3706           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3707           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3708           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3709           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3710           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3711           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3712           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3713           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3714           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3715           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3716                                                     'W' 'X'.
  3717           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3718           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3719           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3720           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3721           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3722           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3723           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3724           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3725           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3726           88  CP-CSL-METH-1                   VALUE '5'.
  3727           88  CP-CSL-METH-2                   VALUE '6'.
  3728           88  CP-CSL-METH-3                   VALUE '7'.
  3729           88  CP-CSL-METH-4                   VALUE '8'.
  3730
  3731         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3734         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3735         16  CP-STATE              PIC XX          VALUE SPACE.
  3736         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3737         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3738           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3739               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3740         16  CP-R78-OPTION         PIC X.
  3741           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3742           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3743
  3744         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3745         16  CP-IBNR-RESERVE-SW    PIC X.
  3746         16  CP-CLAIM-STATUS       PIC X.
  3747         16  CP-RATE-FILE          PIC X.
  3748         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3749                                     COMP-3.
  3750
  3751         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3752         16  CP-AH-OVERRIDE-CODE   PIC X.
  3753
  3754         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3755                                     COMP-3.
  3756         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3757                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  70
* EL050.cbl
  3758         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3759                                     COMP-3.
  3760         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3765                                  PIC S9(7)V99 COMP-3.
  3766
  3767         16  CP-PAID-FROM-DATE     PIC X(02).
  3768         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3769         16  CP-EXT-DAYS-CALC      PIC X.
  3770           88  CP-EXT-NO-CHG                   VALUE ' '.
  3771           88  CP-EXT-CHG-LF                   VALUE '1'.
  3772           88  CP-EXT-CHG-AH                   VALUE '2'.
  3773           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3774         16  CP-DOMICILE-STATE     PIC XX.
  3775         16  CP-CARRIER            PIC X.
  3776         16  CP-REIN-FLAG          PIC X.
  3777         16  CP-REM-TRM-CALC-OPTION PIC X.
  3778           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3779                      '2' '3' '4' '5'.
  3780           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3781           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3782           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3783           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3784           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3785           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3786           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3787           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3788         16  CP-SIG-SWITCH         PIC X.
  3789         16  CP-RATING-METHOD      PIC X.
  3790           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3791           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3792           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3793           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3794           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3795           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3796           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3797           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3798           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3799         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3800                                     COMP-3.
  3801         16  CP-BEN-CATEGORY       PIC X.
  3802         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3803         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3804                                   PIC S99V9(5) COMP-3.
  3805         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3806         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3807                                   PIC S99V9(5) COMP-3.
  3808         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3809         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3810         16  CP-EXPIRE-DT          PIC XX.
  3811         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3812         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3813         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3814         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3815         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  71
* EL050.cbl
  3816             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3817             88  CP-CALC-CLP              VALUE 'C'.
  3818         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3819         16  CP-CANCEL-REASON      PIC X.
  3820         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3821         16  CP-PMT-MODE           PIC X.
  3822         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3823         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3824         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3825         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3826         16  FILLER                PIC X.
  3827
  3828***************    OUTPUT FROM ELRESV   ************************
  3829
  3830         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3831
  3832         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3833                                     COMP-3.
  3834         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3839                                     COMP-3.
  3840         16  FILLER                PIC X(09).
  3841***************    OUTPUT FROM ELRTRM   *************************
  3842
  3843         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3844                                     COMP-3.
  3845         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3846                                     COMP-3.
  3847         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3848                                     COMP-3.
  3849         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3850                                     COMP-3.
  3851         16  FILLER                PIC X(12).
  3852
  3853***************    OUTPUT FROM ELRAMT   *************************
  3854
  3855         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3858                                     COMP-3.
  3859         16  FILLER                PIC X(12).
  3860
  3861***************    OUTPUT FROM ELRATE   *************************
  3862
  3863         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3866                                     COMP-3.
  3867         16  CP-MORTALITY-CODE     PIC X(4).
  3868         16  CP-RATE-EDIT-FLAG     PIC X.
  3869             88  CP-RATES-NEED-APR                  VALUE '1'.
  3870         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3871                                     COMP-3.
  3872         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3873         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  72
* EL050.cbl
  3874         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3875                                   PIC S9(7)V99 COMP-3.
  3876         16  FILLER                PIC X(07).
  3877
  3878***************    OUTPUT FROM ELRFND   *************************
  3879
  3880         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3881                                     COMP-3.
  3882         16  CP-REFUND-TYPE-USED   PIC X.
  3883           88  CP-R-AS-R78                         VALUE '1'.
  3884           88  CP-R-AS-PRORATA                     VALUE '2'.
  3885           88  CP-R-AS-CALIF                       VALUE '3'.
  3886           88  CP-R-AS-TEXAS                       VALUE '4'.
  3887           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3888           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3889           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3890           88  CP-R-AS-MEAN                        VALUE '8'.
  3891           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3892           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3893           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3894           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3895           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3896           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3897         16  FILLER                PIC X(12).
  3898
  3899***************    OUTPUT FROM ELEARN   *************************
  3900
  3901         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3902                                     COMP-3.
  3903         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3904                                     COMP-3.
  3905         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3906                                     COMP-3.
  3907         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3908                                     COMP-3.
  3909         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3912                                     COMP-3.
  3913         16  CP-EARNING-TYPE-USED  PIC X.
  3914           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3915           88  CP-E-AS-R78                         VALUE '1'.
  3916           88  CP-E-AS-PRORATA                     VALUE '2'.
  3917           88  CP-E-AS-TEXAS                       VALUE '4'.
  3918           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3919           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3920           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3921           88  CP-E-AS-MEAN                        VALUE '8'.
  3922           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3923         16  FILLER                PIC X(12).
  3924
  3925***************    OUTPUT FROM ELPMNT   *************************
  3926
  3927         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3928                                     COMP-3.
  3929         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3930                                     COMP-3.
  3931         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  73
* EL050.cbl
  3932
  3933***************   MISC WORK AREAS    *****************************
  3934         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3935                                     COMP-3.
  3936         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3937                                     COMP-3.
  3938         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3939                                     COMP-3.
  3940         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3943                                     COMP-3.
  3944         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3945                                     COMP-3.
  3946         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3947             88  OPEN-RATE-FILE                   VALUE 'O'.
  3948             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3949             88  IO-ERROR                         VALUE 'E'.
  3950
  3951         16  CP-FIRST-PAY-DATE     PIC XX.
  3952
  3953         16  CP-JOINT-INDICATOR    PIC X.
  3954
  3955         16  CP-RESERVE-REMAINING-TERM
  3956                                   PIC S9(4)V9    VALUE ZERO
  3957                                     COMP-3.
  3958
  3959         16  CP-INSURED-BIRTH-DT   PIC XX.
  3960
  3961         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3962                                     COMP-3.
  3963
  3964         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3965                                     COMP-3.
  3966
  3967         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3968                                     COMP-3.
  3969
  3970         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3971                                     COMP-3.
  3972
  3973         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3974                                     COMP-3.
  3975
  3976         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3977                                     COMP-3.
  3978
  3979         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3980                                     COMP-3.
  3981
  3982         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3983             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3984
  3985         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3986                                     COMP-3.
  3987         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3988                                     COMP-3.
  3989         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  74
* EL050.cbl
  3990         16  cp-extra-periods      pic 9 value zeros.
  3991         16  cp-net-only-state     pic x value spaces.
  3992         16  FILLER                PIC X(13).
  3993******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  75
* EL050.cbl
  3995******************************************************************
  3996*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3997*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3998*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3999*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4000*** MODIFICATION.                                              ***
  4001*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4002*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4003******************************************************************
  4004*    COPY ERCPNDB.
  4005******************************************************************
  4006*                                                                *
  4007*                                                                *
  4008*                            ERCPNDB.                            *
  4009*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4010*                            VMOD=2.025                          *
  4011*                                                                *
  4012*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4013*                                                                *
  4014******************************************************************
  4015*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4016*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4017******************************************************************
  4018*                                                                *
  4019*                                                                *
  4020*   FILE TYPE = VSAM,KSDS                                        *
  4021*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4022*                                                                *
  4023*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4024*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4025*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4026*                                                 RKP=13,LEN=36  *
  4027*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4028*                                      AND CHG-SEQ.)             *
  4029*                                                RKP=49,LEN=11   *
  4030*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4031*                                      AND CHG-SEQ.)             *
  4032*                                                RKP=60,LEN=15   *
  4033*                                                                *
  4034*   LOG = NO                                                     *
  4035*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4036******************************************************************
  4037******************************************************************
  4038*                   C H A N G E   L O G
  4039*
  4040* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4041*-----------------------------------------------------------------
  4042*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4043* EFFECTIVE    NUMBER
  4044*-----------------------------------------------------------------
  4045* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4046* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4047* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4048* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4049* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4050* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4051* 032306                   PEMA  ADD BOW LOAN NUMBER
  4052* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  76
* EL050.cbl
  4053* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4054* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4055* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4056* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4057* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4058* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4059* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4060* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4061* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4062* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4063******************************************************************
  4064
  4065 01  PENDING-BUSINESS.
  4066     12  PB-RECORD-ID                     PIC XX.
  4067         88  VALID-PB-ID                        VALUE 'PB'.
  4068
  4069     12  PB-CONTROL-PRIMARY.
  4070         16  PB-COMPANY-CD                PIC X.
  4071         16  PB-ENTRY-BATCH               PIC X(6).
  4072         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4073         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4074
  4075     12  PB-CONTROL-BY-ACCOUNT.
  4076         16  PB-COMPANY-CD-A1             PIC X.
  4077         16  PB-CARRIER                   PIC X.
  4078         16  PB-GROUPING.
  4079             20  PB-GROUPING-PREFIX       PIC XXX.
  4080             20  PB-GROUPING-PRIME        PIC XXX.
  4081         16  PB-STATE                     PIC XX.
  4082         16  PB-ACCOUNT.
  4083             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4084             20  PB-ACCOUNT-PRIME         PIC X(6).
  4085         16  PB-CERT-EFF-DT               PIC XX.
  4086         16  PB-CERT-NO.
  4087             20  PB-CERT-PRIME            PIC X(10).
  4088             20  PB-CERT-SFX              PIC X.
  4089         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4090
  4091         16  PB-RECORD-TYPE               PIC X.
  4092             88  PB-MAILING-DATA                VALUE '0'.
  4093             88  PB-ISSUE                       VALUE '1'.
  4094             88  PB-CANCELLATION                VALUE '2'.
  4095             88  PB-BATCH-TRAILER               VALUE '9'.
  4096
  4097     12  PB-CONTROL-BY-ORIG-BATCH.
  4098         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4099         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4100         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4101         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4102
  4103     12  PB-CONTROL-BY-CSR.
  4104         16  PB-CSR-COMPANY-CD            PIC X.
  4105         16  PB-CSR-ID                    PIC X(4).
  4106         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4107         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4108         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4109******************************************************************
  4110*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  77
* EL050.cbl
  4111******************************************************************
  4112
  4113     12  PB-LAST-MAINT-DT                 PIC XX.
  4114     12  PB-LAST-MAINT-BY                 PIC X(4).
  4115     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4116
  4117     12  PB-RECORD-BODY                   PIC X(375).
  4118
  4119     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4120         16  PB-CERT-ORIGIN               PIC X.
  4121             88  CLASIC-CREATED-CERT         VALUE '1'.
  4122         16  PB-I-NAME.
  4123             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4124             20  PB-I-INSURED-FIRST-NAME.
  4125                 24  PB-I-INSURED-1ST-INIT PIC X.
  4126                 24  FILLER                PIC X(9).
  4127             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4128         16  PB-I-AGE                     PIC S99   COMP-3.
  4129         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4130         16  PB-I-BIRTHDAY                PIC XX.
  4131         16  PB-I-INSURED-SEX             PIC X.
  4132             88  PB-SEX-MALE     VALUE 'M'.
  4133             88  PB-SEX-FEMALE   VALUE 'F'.
  4134
  4135         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4136         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4137         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4138         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4139         16  PB-I-SKIP-CODE               PIC X.
  4140             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4141             88  PB-SKIP-JULY              VALUE '1'.
  4142             88  PB-SKIP-AUGUST            VALUE '2'.
  4143             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4144             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4145             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4146             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4147             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4148             88  PB-SKIP-JUNE              VALUE '8'.
  4149             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4150             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4151             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4152         16  PB-I-TERM-TYPE               PIC X.
  4153             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4154             88  PB-PAID-WEEKLY            VALUE 'W'.
  4155             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4156             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4157             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4158         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4159         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4160         16  PB-I-DATA-ENTRY-SW           PIC X.
  4161             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4162             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4163             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4164             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4165         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4166         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4167*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4168         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  78
* EL050.cbl
  4169         16  FILLER                       PIC X.
  4170
  4171         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4172             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4173             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4174                                                   '90' THRU '99'.
  4175         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4176                                          PIC XX.
  4177         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4178         16  PB-I-AMOUNT-FINANCED REDEFINES
  4179                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4180         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4181         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4182                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4183         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4184         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4185         16  PB-I-CLP-AMOUNT REDEFINES
  4186                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4187         16  PB-I-LF-CALC-FLAG            PIC X.
  4188             88 PB-COMP-LF-PREM               VALUE '?'.
  4189         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4190         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4191         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4192         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4193         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4194         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4195         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4196         16  PB-I-LF-ABBR                 PIC XXX.
  4197         16  PB-I-LF-INPUT-CD             PIC XX.
  4198
  4199         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4200             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4201             88  PB-INVALID-AH               VALUE '  ' '00'
  4202                                                   '90' THRU '99'.
  4203         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4204         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4205         16  PB-I-AH-CALC-FLAG            PIC X.
  4206             88 PB-COMP-AH-PREM                  VALUE '?'.
  4207         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4208         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4209         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4210         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4211         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4212         16  PB-I-AH-ABBR                 PIC XXX.
  4213         16  PB-I-AH-INPUT-CD             PIC XXX.
  4214
  4215         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4216         16  PB-I-REIN-TABLE              PIC XXX.
  4217         16  PB-I-BUSINESS-TYPE           PIC 99.
  4218         16  PB-I-INDV-GRP-CD             PIC X.
  4219         16  PB-I-MORT-CODE.
  4220             20  PB-I-TABLE               PIC X.
  4221             20  PB-I-INTEREST            PIC XX.
  4222             20  PB-I-MORT-TYP            PIC X.
  4223         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4224         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4225         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4226         16  PB-I-INDV-GRP-OVRD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  79
* EL050.cbl
  4227         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4228         16  PB-I-SIG-SW                  PIC X.
  4229             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4230         16  PB-I-RATE-CLASS              PIC XX.
  4231         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4232         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4233         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4234         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4235         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4236         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4237         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4238         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4239         16  PB-I-OB-FLAG                 PIC X.
  4240             88  PB-I-OB                      VALUE 'B'.
  4241             88  PB-I-SUMMARY                 VALUE 'Z'.
  4242         16  PB-I-ENTRY-STATUS            PIC X.
  4243             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4244                                              'M' '5' '9' '2'.
  4245             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4246             88  PB-I-POLICY-PENDING          VALUE '2'.
  4247             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4248             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4249             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4250             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4251             88  PB-I-REIN-ONLY               VALUE '9'.
  4252             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4253             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4254             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4255             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4256         16  PB-I-INT-CODE                PIC X.
  4257             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4258             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4259         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4260         16  PB-I-SOC-SEC-NO              PIC X(11).
  4261         16  PB-I-MEMBER-NO               PIC X(12).
  4262         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4263*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4264         16  PB-I-OLD-LOF                 PIC XXX.
  4265         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4266         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4267         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4268         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4269         16  PB-I-LIFE-INDICATOR          PIC X.
  4270             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4271         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4272         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4273                                          PIC S9(5)V99    COMP-3.
  4274         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4275             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4276             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4277         16  PB-I-1ST-PMT-DT              PIC XX.
  4278         16  PB-I-JOINT-INSURED.
  4279             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4280             20 PB-I-JOINT-FIRST-NAME.
  4281                24  PB-I-JOINT-FIRST-INIT PIC X.
  4282                24  FILLER                PIC X(9).
  4283             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4284*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  80
* EL050.cbl
  4285         16  PB-I-BENEFICIARY-NAME.
  4286             20  PB-I-BANK-NUMBER         PIC X(10).
  4287             20  FILLER                   PIC X(15).
  4288         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4289         16  PB-I-REFERENCE               PIC X(12).
  4290         16  FILLER REDEFINES PB-I-REFERENCE.
  4291             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4292             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4293             20  PB-I-CLP-STATE           PIC XX.
  4294         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4295             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4296             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4297             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4298         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4299         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4300         16  PB-I-RESIDENT-STATE          PIC XX.
  4301         16  PB-I-RATE-CODE               PIC X(4).
  4302         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4303         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4304         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4305         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4306         16  PB-I-BANK-NOCHRGB            PIC 99.
  4307         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4308         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4309
  4310     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4311         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4312             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4313         16  PB-C-CANCEL-ORIGIN           PIC X.
  4314             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4315         16  PB-C-LF-CANCEL-DT            PIC XX.
  4316         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4317         16  PB-C-LF-CALC-REQ             PIC X.
  4318             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4319         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4320         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4321         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4322             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4323         16  PB-C-AH-CANCEL-DT            PIC XX.
  4324         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4325         16  PB-C-AH-CALC-REQ             PIC X.
  4326             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4327         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4328         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4329         16  PB-C-LAST-NAME               PIC X(15).
  4330         16  PB-C-REFUND-SW               PIC X.
  4331             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4332             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4333         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4334         16  PB-C-PAYEE-CODE              PIC X(6).
  4335         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4336         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4337         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4338         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4339         16  PB-C-REFERENCE               PIC X(12).
  4340         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4341         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4342         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  81
* EL050.cbl
  4343         16  PB-C-CANCEL-REASON           PIC X.
  4344         16  PB-C-REF-INTERFACE-SW        PIC X.
  4345         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4346         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4347         16  FILLER                       PIC X(01).
  4348*        16  FILLER                       PIC X(18).
  4349         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4350*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4351         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4352         16  PB-CANCELED-CERT-DATA.
  4353             20  PB-CI-INSURED-NAME.
  4354                 24  PB-CI-LAST-NAME      PIC X(15).
  4355                 24  PB-CI-INITIALS       PIC XX.
  4356             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4357             20  PB-CI-INSURED-SEX        PIC X.
  4358             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4359             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4360             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4361             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4362             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4363             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4364             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4365             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4366             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4367             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4368             20  PB-CI-RATE-CLASS         PIC XX.
  4369             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4370             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4371             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4372             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4373             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4374             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4375             20  PB-CI-LF-ABBR            PIC X(3).
  4376             20  PB-CI-AH-ABBR            PIC X(3).
  4377             20  PB-CI-OB-FLAG            PIC X.
  4378                 88  PB-CI-OB                VALUE 'B'.
  4379             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4380                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4381                                           'M' '4' '5' '9' '2'.
  4382                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4383                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4384                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4385                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4386                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4387                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4388                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4389                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4390                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4391                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4392                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4393                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4394                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4395             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4396                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4397                                           'M' '4' '5' '9' '2'.
  4398                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4399                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4400                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  82
* EL050.cbl
  4401                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4402                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4403                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4404                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4405                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4406                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4407                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4408                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4409                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4410                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4411             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4412             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4413             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4414             20  PB-CI-MEMBER-NO          PIC X(12).
  4415             20  PB-CI-INT-CODE           PIC X.
  4416                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4417                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4418             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4419             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4420             20  PB-CI-COMP-EXCP-SW       PIC X.
  4421                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4422                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4423             20  PB-CI-ENTRY-STATUS       PIC X.
  4424             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4425             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4426             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4427             20  PB-CI-DEATH-DT           PIC XX.
  4428             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4429             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4430             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4431             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4432             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4433             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4434             20  PB-CI-ENTRY-DT              PIC XX.
  4435             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4436             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4437             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4438             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4439             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4440             20  PB-CI-OLD-LOF               PIC XXX.
  4441*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4442             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4443             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4444             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4445             20  PB-CI-INDV-GRP-CD           PIC X.
  4446             20  PB-CI-BENEFICIARY-NAME.
  4447                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4448                 24  FILLER                  PIC X(15).
  4449             20  PB-CI-NOTE-SW               PIC X.
  4450             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4451             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4452             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4453             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4454             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4455             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4456             20  PB-CI-FIRST-NAME            PIC X(10).
  4457             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4458
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  83
* EL050.cbl
  4459         16  FILLER                       PIC X(13).
  4460*032306  16  FILLER                       PIC X(27).
  4461*        16  FILLER                       PIC X(46).
  4462
  4463     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4464         16  FILLER                       PIC X(10).
  4465         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4466         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4467         16  PB-M-INSURED-MID-INIT        PIC X.
  4468         16  PB-M-INSURED-AGE             PIC 99.
  4469         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4470         16  PB-M-INSURED-SEX             PIC X.
  4471         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4472         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4473         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4474         16  PB-M-INSURED-CITY-STATE.
  4475             20  PB-M-INSURED-CITY        PIC X(28).
  4476             20  PB-M-INSURED-STATE       PIC XX.
  4477         16  PB-M-INSURED-ZIP-CODE.
  4478             20  PB-M-INSURED-ZIP-PRIME.
  4479                 24  PB-M-INSURED-ZIP-1   PIC X.
  4480                     88  PB-M-CANADIAN-POST-CODE
  4481                                             VALUE 'A' THRU 'Z'.
  4482                 24  FILLER               PIC X(4).
  4483             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4484         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4485                                        PB-M-INSURED-ZIP-CODE.
  4486             20  PM-M-INS-CAN-POST1       PIC XXX.
  4487             20  PM-M-INS-CAN-POST2       PIC XXX.
  4488             20  FILLER                   PIC XXX.
  4489         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4490         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4491         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4492         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4493         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4494         16  PB-M-CRED-BENE-CITYST.
  4495             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4496             20  PB-M-CRED-BENE-STATE     PIC XX.
  4497         16  FILLER                       PIC X(92).
  4498
  4499     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4500         16  FILLER                       PIC X(10).
  4501         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4502         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4503         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4504         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4505         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4506         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4507         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4508         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4509         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4510         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4511         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4512         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4513         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4514         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4515         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4516         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  84
* EL050.cbl
  4517         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4518         16  PB-ACCOUNT-NAME              PIC X(30).
  4519         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4520         16  PB-REFERENCE                 PIC X(12).
  4521         16  PB-B-RECEIVED-DT             PIC XX.
  4522         16  FILLER                       PIC X(234).
  4523
  4524     12  PB-RECORD-STATUS.
  4525         16  PB-CREDIT-SELECT-DT          PIC XX.
  4526         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4527         16  PB-BILLED-DT                 PIC XX.
  4528         16  PB-BILLING-STATUS            PIC X.
  4529             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4530             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4531             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4532         16  PB-RECORD-BILL               PIC X.
  4533             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4534             88  PB-RECORD-RETURNED           VALUE 'R'.
  4535             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4536             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4537             88  PB-OVERRIDE-AH               VALUE 'A'.
  4538             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4539         16  PB-BATCH-ENTRY               PIC X.
  4540             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4541             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4542             88  PB-REISSUED-CERT             VALUE 'E'.
  4543             88  PB-CASH-CERT                 VALUE 'C'.
  4544             88  PB-MONTHLY-CERT              VALUE 'M'.
  4545             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4546             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4547             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4548         16  PB-FORCE-CODE                PIC X.
  4549             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4550             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4551             88  PB-CANCEL-FORCE              VALUE '8'.
  4552             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4553             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4554             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4555             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4556             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4557             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4558             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4559             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4560         16  PB-FATAL-FLAG                PIC X.
  4561             88  PB-FATAL-ERRORS              VALUE 'X'.
  4562         16  PB-FORCE-ER-CD               PIC X.
  4563             88  PB-FORCE-ERRORS              VALUE 'F'.
  4564             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4565         16  PB-WARN-ER-CD                PIC X.
  4566             88  PB-WARNING-ERRORS            VALUE 'W'.
  4567         16  FILLER                       PIC X.
  4568         16  PB-OUT-BAL-CD                PIC X.
  4569             88  PB-OUT-OF-BAL                VALUE 'O'.
  4570         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4571         16  PB-AH-OVERRIDE-L1            PIC X.
  4572         16  PB-INPUT-DT                  PIC XX.
  4573         16  PB-INPUT-BY                  PIC X(4).
  4574         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  85
* EL050.cbl
  4575         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4576         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4577         16  PB-LF-EARNING-METHOD         PIC X.
  4578         16  PB-AH-EARNING-METHOD         PIC X.
  4579         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4580         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4581         16  PB-REIN-CD                   PIC XXX.
  4582         16  PB-LF-REFUND-TYPE            PIC X.
  4583         16  PB-AH-REFUND-TYPE            PIC X.
  4584         16  PB-ACCT-EFF-DT               PIC XX.
  4585         16  PB-ACCT-EXP-DT               PIC XX.
  4586         16  PB-COMPANY-ID                PIC X(3).
  4587         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4588         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4589         16  PB-SV-CARRIER                PIC X.
  4590         16  PB-SV-GROUPING               PIC X(6).
  4591         16  PB-SV-STATE                  PIC XX.
  4592         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4593         16  PB-GA-BILLING-INFO.
  4594             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4595                                          PIC XX.
  4596         16  PB-SV-REMIT-TO  REDEFINES
  4597             PB-GA-BILLING-INFO           PIC X(10).
  4598         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4599         16  PB-I-LOAN-OFFICER            PIC X(5).
  4600         16  PB-I-VIN                     PIC X(17).
  4601
  4602         16  FILLER                       PIC X(04).
  4603         16  IMNET-BYPASS-SW              PIC X.
  4604
  4605******************************************************************
  4606*                COMMON EDIT ERRORS                              *
  4607******************************************************************
  4608
  4609     12  PB-COMMON-ERRORS.
  4610         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4611                                           PIC S9(4)     COMP.
  4612
  4613******************************************************************
  4614
  4615* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4616*    COPY ELC50W1.
  4617******************************************************************
  4618*                                                                *
  4619*                                                                *
  4620*                             ELC50W1                            *
  4621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4622*                            VMOD=2.004                          *
  4623*                                                                *
  4624*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4625*                                                                *
  4626*                                                                *
  4627******************************************************************
  4628
  4629     12  WK-WORK-AREA.
  4630         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4631         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4632         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  86
* EL050.cbl
  4633         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4634         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4635         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4636         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4637         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4638         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4639         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4640         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4641         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4642         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4643         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4644         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4645         16  WK-CREDIT-EDIT-CONTROLS.
  4646             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4647             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4648             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4649             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4650             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4651             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4652         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4653         16  WK-SAVE-REIN-DATA.
  4654             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4655             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4656             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4657         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4658             88  ENTRY-FROM-EL6311       VALUE '6'.
  4659         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4660         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4661     12  WK-RECORD-ADDRESSES.
  4662         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4663         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4664         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4665         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4666         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4667         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4668         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4669         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4670     12  WK-OVER-SHORT-AREA.
  4671         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4672         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4673         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4674             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4675         16  FILLER                   PIC X(5) VALUE SPACES.
  4676
  4677*    COPY ELCEDITC.
  4678******************************************************************
  4679*                                                                *
  4680*                                                                *
  4681*                            ELCEDITC                            *
  4682*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4683*                            VMOD=2.012                          *
  4684*                                                                *
  4685*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4686*                     EL6313, EL050 AND EL517.                   *
  4687*                                                                *
  4688******************************************************************
  4689******************************************************************
  4690*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  87
* EL050.cbl
  4691*
  4692* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4693*-----------------------------------------------------------------
  4694*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4695* EFFECTIVE    NUMBER
  4696*-----------------------------------------------------------------
  4697* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4698******************************************************************
  4699
  4700     12  EDIT-CRITERIA-DATA.
  4701         16  EC-CO-MONTH-END-DT       PIC XX.
  4702         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4703         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4704         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4705         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4706         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4707         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4708         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4709         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4710         16  EC-CO-REM-TERM-CALC      PIC X.
  4711               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4712               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4713               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4714               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4715
  4716         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4717               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4718               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4719               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4720               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4721               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4722               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4723               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4724               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4725               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4726               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4727
  4728         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4729               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4730               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4731               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4732               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4733               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4734               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4735               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4736               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4737
  4738         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4739                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4740                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4741
  4742         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4743                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4744                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4745                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4746                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4747                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4748                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  88
* EL050.cbl
  4749                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4750                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4751
  4752         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4753               88  EC-BR-REDUCING                   VALUE 'R'.
  4754               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4755
  4756         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4757         16  EC-BR-LF-DESC             PIC X(10).
  4758         16  EC-BR-AH-DESC             PIC X(10).
  4759         16  EC-BR-LF-COMMENT          PIC X(10).
  4760         16  EC-BR-AH-COMMENT          PIC X(10).
  4761
  4762         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4763               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4764               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4765               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4766               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4767
  4768         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4769               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4770               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4771               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4772               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4773
  4774         16  EC-BR-LF-REFUND-CALC      PIC X.
  4775                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4776                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4777                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4778                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4779                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4780                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4781                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4782
  4783         16  EC-BR-AH-REFUND-CALC      PIC X.
  4784                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4785                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4786                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4787                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4788                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4789                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4790                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4791                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4792
  4793         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4794                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4795                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4796                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4797
  4798         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4799                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4800                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4801                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4802
  4803         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4804         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4805         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4806         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  89
* EL050.cbl
  4807
  4808         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4809         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4810                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4811                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4812                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4813                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4814
  4815         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4816               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4817               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4818               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4819               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4820               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4821
  4822         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4823               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4824               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4825               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4826               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4827               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4828
  4829         16  EC-ST-LF-REFUND-CALC      PIC X.
  4830                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4831                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4832                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4833                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4834                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4835                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4836                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4837                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4838
  4839         16  EC-ST-AH-REFUND-CALC      PIC X.
  4840                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4841                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4842                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4843                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4844                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4845                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4846                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4847                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4848
  4849         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4850         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4851         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4852         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4853         16  EC-AM-EXPIRATION-DT       PIC XX.
  4854         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4855         16  EC-AM-CLASS-CD            PIC XX.
  4856         16  EC-AM-LF-DEVIATION        PIC XXX.
  4857         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4858         16  EC-AM-AH-DEVIATION        PIC XXX.
  4859         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4860         16  EC-AM-PHONE-NO            PIC X(10).
  4861
  4862         16  EC-AM-LF-REFUND-CALC      PIC X.
  4863                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4864                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  90
* EL050.cbl
  4865                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4866                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4867                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4868                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4869                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4870
  4871         16  EC-AM-AH-REFUND-CALC      PIC X.
  4872                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4873                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4874                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4875                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4876                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4877                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4878                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4879
  4880         16  EC-AM-BEN-I-G-CD          PIC X.
  4881                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4882                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4883                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4884
  4885         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4886         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4887         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4888         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4889         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4890         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4891         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4892         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4893         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4894
  4895         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4896         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4897         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4898         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4899         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4900         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4901         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4902         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4903         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4904         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4905         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4906         16  EC-RT-LF-NSP-ST           PIC XX.
  4907         16  EC-RT-AH-NSP-ST           PIC XX.
  4908         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4909         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4910
  4911         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4912             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4913                                             'M' '5' '9' '2'.
  4914             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4915             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4916             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4917             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4918             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4919             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4920             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4921             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4922             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  91
* EL050.cbl
  4923             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4924
  4925         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4926             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4927                                             'M' '5' '9' '2'.
  4928             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4929             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4930             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4931             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4932             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4933             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4934             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4935             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4936             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4937             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4938
  4939         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4940         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4941         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4942         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4943         16  EC-CM-DEATH-DT            PIC XX.
  4944
  4945*DMD CUSTOM CODING FIELDS BELOW
  4946*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4947         16  EC-BR-DMD-RATING-SW       PIC X.
  4948                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4949                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4950                 88  NO-DMD-RATING               VALUE 'N'.
  4951
  4952         16  EC-NEW-CERT               PIC X(11).
  4953         16  EC-NEW-STATE              PIC XX.
  4954         16  FILLER                    PIC X.
  4955*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4956         16  OVER-SHORT-EDIT-FIELDS.
  4957             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4958             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4959             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4960             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4961             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4962             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4963             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4964             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4965             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4966         16  FILLER                    PIC X(71).
  4967******************************************************************
  4968
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  92
* EL050.cbl
  4970*    COPY ELCDIFRD.
  4971******************************************************************
  4972*                                                                *
  4973*                                                                *
  4974*                            ELCDIFRD.                           *
  4975*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4976*                            VMOD=2.004                          *
  4977*                                                                *
  4978*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4979*                                                                *
  4980******************************************************************
  4981*
  4982  01  WS-DIFFERENCE-CALCULATION.
  4983        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4984        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4985        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4986        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4987        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4988        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4989        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4990        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4991        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4992        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4993        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4994
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  93
* EL050.cbl
  4996****************************************************************
  4997*
  4998* Copyright (c) 2007-2013 Dell Inc.
  4999* All rights reserved.
  5000*
  5001****************************************************************
  5002 01  DFHEIV.
  5003   02  DFHEIV0               PIC X(35).
  5004   02  DFHEIV1               PIC X(08).
  5005   02  DFHEIV2               PIC X(08).
  5006   02  DFHEIV3               PIC X(08).
  5007   02  DFHEIV4               PIC X(06).
  5008   02  DFHEIV5               PIC X(04).
  5009   02  DFHEIV6               PIC X(04).
  5010   02  DFHEIV7               PIC X(02).
  5011   02  DFHEIV8               PIC X(02).
  5012   02  DFHEIV9               PIC X(01).
  5013   02  DFHEIV10              PIC S9(7) COMP-3.
  5014   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5015   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5016   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5017   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5018   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5019   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5020   02  DFHEIV17              PIC X(04).
  5021   02  DFHEIV18              PIC X(04).
  5022   02  DFHEIV19              PIC X(04).
  5023   02  DFHEIV20              USAGE IS POINTER.
  5024   02  DFHEIV21              USAGE IS POINTER.
  5025   02  DFHEIV22              USAGE IS POINTER.
  5026   02  DFHEIV23              USAGE IS POINTER.
  5027   02  DFHEIV24              USAGE IS POINTER.
  5028   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5029   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5030   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5031   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5032   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5033   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5034   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5035   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5036   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5037   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5038   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5039   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5040   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5041   02  FILLER                PIC X(02).
  5042   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5043   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5044   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5045   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5046   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5047   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5048   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5049 LINKAGE  SECTION.
  5050*****************************************************************
  5051*                                                               *
  5052* Copyright (c) 2007-2013 Dell Inc.                             *
  5053* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  94
* EL050.cbl
  5054*                                                               *
  5055*****************************************************************
  5056 01  dfheiblk.
  5057     02  eibtime          pic s9(7) comp-3.
  5058     02  eibdate          pic s9(7) comp-3.
  5059     02  eibtrnid         pic x(4).
  5060     02  eibtaskn         pic s9(7) comp-3.
  5061     02  eibtrmid         pic x(4).
  5062     02  dfheigdi         pic s9(4) comp.
  5063     02  eibcposn         pic s9(4) comp.
  5064     02  eibcalen         pic s9(4) comp.
  5065     02  eibaid           pic x(1).
  5066     02  eibfiller1       pic x(1).
  5067     02  eibfn            pic x(2).
  5068     02  eibfiller2       pic x(2).
  5069     02  eibrcode         pic x(6).
  5070     02  eibfiller3       pic x(2).
  5071     02  eibds            pic x(8).
  5072     02  eibreqid         pic x(8).
  5073     02  eibrsrce         pic x(8).
  5074     02  eibsync          pic x(1).
  5075     02  eibfree          pic x(1).
  5076     02  eibrecv          pic x(1).
  5077     02  eibsend          pic x(1).
  5078     02  eibatt           pic x(1).
  5079     02  eibeoc           pic x(1).
  5080     02  eibfmh           pic x(1).
  5081     02  eibcompl         pic x(1).
  5082     02  eibsig           pic x(1).
  5083     02  eibconf          pic x(1).
  5084     02  eiberr           pic x(1).
  5085     02  eibrldbk         pic x(1).
  5086     02  eiberrcd         pic x(4).
  5087     02  eibsynrb         pic x(1).
  5088     02  eibnodat         pic x(1).
  5089     02  eibfiller5       pic x(2).
  5090     02  eibresp          pic s9(8) comp.
  5091     02  eibresp2         pic s9(8) comp.
  5092     02  dfheigdj         pic s9(4) comp.
  5093     02  dfheigdk         pic s9(4) comp.
  5094
  5095 01  DFHCOMMAREA                   PIC X(1036).
  5096
  5097*01 PARMLIST .
  5098*    02  FILLER                    PIC S9(8)   COMP.
  5099*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5100*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5101*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5102*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5103*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5104*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5105*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5106
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  95
* EL050.cbl
  5108*    COPY ELCCNTL.
  5109******************************************************************
  5110*                                                                *
  5111*                                                                *
  5112*                            ELCCNTL.                            *
  5113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5114*                            VMOD=2.059                          *
  5115*                                                                *
  5116*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5117*                                                                *
  5118*   FILE TYPE = VSAM,KSDS                                        *
  5119*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5120*                                                                *
  5121*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5122*       ALTERNATE INDEX = NONE                                   *
  5123*                                                                *
  5124*   LOG = YES                                                    *
  5125*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5126******************************************************************
  5127*                   C H A N G E   L O G
  5128*
  5129* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5130*-----------------------------------------------------------------
  5131*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5132* EFFECTIVE    NUMBER
  5133*-----------------------------------------------------------------
  5134* 082503                   PEMA  ADD BENEFIT GROUP
  5135* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5136* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5137* 092705    2005050300006  PEMA  ADD SPP LEASES
  5138* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5139* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5140* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5141* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5142* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5143* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5144* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5145* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5146* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5147* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5148* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5149******************************************************************
  5150*
  5151 01  CONTROL-FILE.
  5152     12  CF-RECORD-ID                       PIC XX.
  5153         88  VALID-CF-ID                        VALUE 'CF'.
  5154
  5155     12  CF-CONTROL-PRIMARY.
  5156         16  CF-COMPANY-ID                  PIC XXX.
  5157         16  CF-RECORD-TYPE                 PIC X.
  5158             88  CF-COMPANY-MASTER              VALUE '1'.
  5159             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5160             88  CF-STATE-MASTER                VALUE '3'.
  5161             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5162             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5163             88  CF-CARRIER-MASTER              VALUE '6'.
  5164             88  CF-MORTALITY-MASTER            VALUE '7'.
  5165             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  96
* EL050.cbl
  5166             88  CF-TERMINAL-MASTER             VALUE '9'.
  5167             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5168             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5169             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5170             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5171             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5172             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5173             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5174             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5175             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5176         16  CF-ACCESS-CD-GENL              PIC X(4).
  5177         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5178             20  CF-PROCESSOR               PIC X(4).
  5179         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5180             20  CF-STATE-CODE              PIC XX.
  5181             20  FILLER                     PIC XX.
  5182         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5183             20  FILLER                     PIC XX.
  5184             20  CF-HI-BEN-IN-REC           PIC XX.
  5185         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5186             20  FILLER                     PIC XXX.
  5187             20  CF-CARRIER-CNTL            PIC X.
  5188         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5189             20  FILLER                     PIC XX.
  5190             20  CF-HI-TYPE-IN-REC          PIC 99.
  5191         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5192             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5193                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5194             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5195             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5196         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5197             20  FILLER                     PIC X.
  5198             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5199         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5200             20  FILLER                     PIC XX.
  5201             20  CF-MORTGAGE-PLAN           PIC XX.
  5202         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5203
  5204     12  CF-LAST-MAINT-DT                   PIC XX.
  5205     12  CF-LAST-MAINT-BY                   PIC X(4).
  5206     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5207
  5208     12  CF-RECORD-BODY                     PIC X(728).
  5209
  5210
  5211****************************************************************
  5212*             COMPANY MASTER RECORD                            *
  5213****************************************************************
  5214
  5215     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5216         16  CF-COMPANY-ADDRESS.
  5217             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5218             20  CF-CL-IN-CARE-OF           PIC X(30).
  5219             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5220             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5221             20  CF-CL-CITY-STATE           PIC X(30).
  5222             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5223             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  97
* EL050.cbl
  5224         16  CF-COMPANY-CD                  PIC X.
  5225         16  CF-COMPANY-PASSWORD            PIC X(8).
  5226         16  CF-SECURITY-OPTION             PIC X.
  5227             88  ALL-SECURITY                   VALUE '1'.
  5228             88  COMPANY-VERIFY                 VALUE '2'.
  5229             88  PROCESSOR-VERIFY               VALUE '3'.
  5230             88  NO-SECURITY                    VALUE '4'.
  5231             88  ALL-BUT-TERM                   VALUE '5'.
  5232         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5233             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5234         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5235             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5236         16  CF-INFORCE-LOCATION            PIC X.
  5237             88  CERTS-ARE-ONLINE               VALUE '1'.
  5238             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5239             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5240         16  CF-LOWER-CASE-LETTERS          PIC X.
  5241         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5242             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5243             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5244             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5245             88  CF-ACCNT-CNTL                  VALUE '3'.
  5246             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5247
  5248         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5249         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5250
  5251         16  CF-LGX-CREDIT-USER             PIC X.
  5252             88  CO-IS-NOT-USER                 VALUE 'N'.
  5253             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5254
  5255         16 CF-CREDIT-CALC-CODES.
  5256             20  CF-CR-REM-TERM-CALC PIC X.
  5257               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5258               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5259               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5260               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5261               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5262               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5263               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5264             20  CF-CR-R78-METHOD           PIC X.
  5265               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5266               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5267
  5268         16  CF-CLAIM-CONTROL-COUNTS.
  5269             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5270                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5271
  5272             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5273                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5274
  5275             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5276                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5277
  5278             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5279                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5280
  5281         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  98
* EL050.cbl
  5282
  5283         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5284             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5285             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5286             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5287             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5288                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5289                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5290             20  CF-CO-PREM-REJECT-SW       PIC X.
  5291                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5292                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5293             20  CF-CO-REF-REJECT-SW        PIC X.
  5294                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5295                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5296
  5297         16  CF-CO-REPORTING-DT             PIC XX.
  5298         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5299         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5300           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5301           88  CF-CO-MONTH-END                  VALUE '1'.
  5302
  5303         16  CF-LGX-CLAIM-USER              PIC X.
  5304             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5305             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5306
  5307         16  CF-CREDIT-EDIT-CONTROLS.
  5308             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5309             20  CF-MIN-AGE                 PIC 99.
  5310             20  CF-DEFAULT-AGE             PIC 99.
  5311             20  CF-MIN-TERM                PIC S999      COMP-3.
  5312             20  CF-MAX-TERM                PIC S999      COMP-3.
  5313             20  CF-DEFAULT-SEX             PIC X.
  5314             20  CF-JOINT-AGE-INPUT         PIC X.
  5315                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5316             20  CF-BIRTH-DATE-INPUT        PIC X.
  5317                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5318             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5319                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5320                 88  CF-ZERO-CARRIER            VALUE '1'.
  5321                 88  CF-ZERO-GROUPING           VALUE '2'.
  5322                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5323             20  CF-EDIT-SW                 PIC X.
  5324                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5325             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5326             20  CF-CR-PR-METHOD            PIC X.
  5327               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5328               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5329             20  FILLER                     PIC X.
  5330
  5331         16  CF-CREDIT-MISC-CONTROLS.
  5332             20  CF-REIN-TABLE-SW           PIC X.
  5333                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5334             20  CF-COMP-TABLE-SW           PIC X.
  5335                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5336             20  CF-EXPERIENCE-RETENTION-AGE
  5337                                            PIC S9        COMP-3.
  5338             20  CF-CONVERSION-DT           PIC XX.
  5339             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page  99
* EL050.cbl
  5340             20  CF-RUN-FREQUENCY-SW        PIC X.
  5341                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5342                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5343
  5344             20  CF-CR-CHECK-NO-CONTROL.
  5345                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5346                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5347                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5348                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5349                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5350                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5351
  5352                 24  CF-CR-CHECK-COUNT       REDEFINES
  5353                     CF-CR-CHECK-COUNTER      PIC X(4).
  5354
  5355                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5356                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5357
  5358                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5359                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5360                 24  CF-MAIL-PROCESSING       PIC X.
  5361                     88  MAIL-PROCESSING          VALUE 'Y'.
  5362
  5363         16  CF-MISC-SYSTEM-CONTROL.
  5364             20  CF-SYSTEM-C                 PIC X.
  5365                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5366             20  CF-SYSTEM-D                 PIC X.
  5367                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5368             20  CF-SOC-SEC-NO-SW            PIC X.
  5369                 88  SOC-SEC-NO-USED             VALUE '1'.
  5370             20  CF-MEMBER-NO-SW             PIC X.
  5371                 88  MEMBER-NO-USED              VALUE '1'.
  5372             20  CF-TAX-ID-NUMBER            PIC X(11).
  5373             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5374             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5375                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5376                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5377                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5378                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5379             20  CF-SYSTEM-E                 PIC X.
  5380                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5381
  5382         16  CF-LGX-LIFE-USER               PIC X.
  5383             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5384             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5385
  5386         16  CF-CR-MONTH-END-DT             PIC XX.
  5387
  5388         16  CF-FILE-MAINT-DATES.
  5389             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5390                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5391             20  CF-LAST-BATCH       REDEFINES
  5392                 CF-LAST-BATCH-NO               PIC X(4).
  5393             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5394             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5395             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5396             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5397             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 100
* EL050.cbl
  5398             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5399             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5400             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5401             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5402             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5403
  5404         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5405         16  FILLER                         PIC X.
  5406
  5407         16  CF-ALT-MORT-CODE               PIC X(4).
  5408         16  CF-MEMBER-CAPTION              PIC X(10).
  5409
  5410         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5411             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5412             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5413             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5414             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5415             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5416
  5417         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5418
  5419         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5420         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5421         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5422         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5423
  5424         16  CF-AH-OVERRIDE-L1              PIC X.
  5425         16  CF-AH-OVERRIDE-L2              PIC XX.
  5426         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5427         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5428
  5429         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5430         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5431
  5432         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5433         16  CF-AR-LAST-EL860-DT            PIC XX.
  5434         16  CF-MP-MONTH-END-DT             PIC XX.
  5435
  5436         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5437         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5438             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5439
  5440         16  CF-AR-MONTH-END-DT             PIC XX.
  5441
  5442         16  CF-CRDTCRD-USER                PIC X.
  5443             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5444             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5445
  5446         16  CF-CC-MONTH-END-DT             PIC XX.
  5447
  5448         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5449
  5450         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5451             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5452             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5453             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5454         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5455         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 101
* EL050.cbl
  5456         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5457         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5458             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5459             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5460         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5461         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5462         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5463             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5464         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5465
  5466         16  CF-CL-ZIP-CODE.
  5467             20  CF-CL-ZIP-PRIME.
  5468                 24  CF-CL-ZIP-1ST          PIC X.
  5469                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5470                 24  FILLER                 PIC X(4).
  5471             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5472         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5473             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5474             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5475             20  FILLER                     PIC XXX.
  5476
  5477         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5478         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5479         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5480         16  CF-CO-OPTION-START-DATE        PIC XX.
  5481         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5482           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5483                                                      '3' '4'.
  5484           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5485           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5486           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5487           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5488           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5489           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5490
  5491         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5492
  5493         16  CF-PAYMENT-APPROVAL-LEVELS.
  5494             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5495             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5496             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5497             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5498             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5499             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5500
  5501         16  CF-END-USER-REPORTING-USER     PIC X.
  5502             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5503             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5504
  5505         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5506             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5507             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5508
  5509         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5510
  5511         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5512         16  FILLER                         PIC X.
  5513
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 102
* EL050.cbl
  5514         16  CF-CREDIT-ARCHIVE-CNTL.
  5515             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5516             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5517             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5518
  5519         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5520
  5521         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5522             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5523             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5524
  5525         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5526             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5527             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5528
  5529         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5530
  5531         16  CF-CO-ACH-ID-CODE              PIC  X.
  5532             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5533             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5534             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5535         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5536         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5537         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5538         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5539         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5540         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5541         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5542         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5543         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5544                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5545         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5546                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5547
  5548         16  CF-CO-OVER-SHORT.
  5549             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5550             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5551
  5552*         16  FILLER                         PIC X(102).
  5553         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5554             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5555             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5556
  5557         16  CF-AH-APPROVAL-DAYS.
  5558             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5559             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5560             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5561             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5562
  5563         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5564
  5565         16  CF-APPROV-LEV-5.
  5566             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5567             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5568             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5569
  5570         16  FILLER                         PIC X(68).
  5571****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 103
* EL050.cbl
  5572*             PROCESSOR/USER RECORD                            *
  5573****************************************************************
  5574
  5575     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5576         16  CF-PROCESSOR-NAME              PIC X(30).
  5577         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5578         16  CF-PROCESSOR-TITLE             PIC X(26).
  5579         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5580                 88  MESSAGE-YES                VALUE 'Y'.
  5581                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5582
  5583*****************************************************
  5584****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5585****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5586****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5587****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5588*****************************************************
  5589
  5590         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5591             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5592             20  CF-APPLICATION-FORCE       PIC X.
  5593             20  CF-INDIVIDUAL-APP.
  5594                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5595                     28  CF-BROWSE-APP      PIC X.
  5596                     28  CF-UPDATE-APP      PIC X.
  5597
  5598         16  CF-CURRENT-TERM-ON             PIC X(4).
  5599         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5600             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5601             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5602             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5603             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5604             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5605             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5606             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5607         16  CF-PROCESSOR-CARRIER           PIC X.
  5608             88  NO-CARRIER-SECURITY            VALUE ' '.
  5609         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5610             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5611         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5612             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5613         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5614             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5615
  5616         16  CF-PROC-SYS-ACCESS-SW.
  5617             20  CF-PROC-CREDIT-CLAIMS-SW.
  5618                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5619                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5620                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5621                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5622             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5623                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5624                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5625             20  CF-PROC-LIFE-GNRLDGR-SW.
  5626                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5627                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5628                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5629                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 104
* EL050.cbl
  5630             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5631                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5632                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5633         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5634             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5635             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5636         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5637
  5638         16  CF-APPROVAL-LEVEL                  PIC X.
  5639             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5640             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5641             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5642             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5643             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5644
  5645         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5646
  5647         16  CF-LANGUAGE-TYPE                   PIC X.
  5648             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5649             88  CF-LANG-IS-FR                      VALUE 'F'.
  5650
  5651         16  CF-CSR-IND                         PIC X.
  5652         16  FILLER                             PIC X(239).
  5653
  5654****************************************************************
  5655*             PROCESSOR/REMINDERS RECORD                       *
  5656****************************************************************
  5657
  5658     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5659         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5660             20  CF-START-REMIND-DT         PIC XX.
  5661             20  CF-END-REMIND-DT           PIC XX.
  5662             20  CF-REMINDER-TEXT           PIC X(50).
  5663         16  FILLER                         PIC X(296).
  5664
  5665
  5666****************************************************************
  5667*             STATE MASTER RECORD                              *
  5668****************************************************************
  5669
  5670     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5671         16  CF-STATE-ABBREVIATION          PIC XX.
  5672         16  CF-STATE-NAME                  PIC X(25).
  5673         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5674         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5675             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5676             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5677             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5678             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5679                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5680                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5681             20  CF-ST-PREM-REJECT-SW       PIC X.
  5682                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5683                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5684             20  CF-ST-REF-REJECT-SW        PIC X.
  5685                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5686                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5687         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 105
* EL050.cbl
  5688         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5689         16  CF-ST-REFUND-RULES.
  5690             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5691             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5692             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5693         16  CF-ST-FST-PMT-EXTENSION.
  5694             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5695             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5696                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5697                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5698                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5699                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5700         16  CF-ST-STATE-CALL.
  5701             20  CF-ST-CALL-UNEARNED        PIC X.
  5702             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5703             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5704         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5705             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5706             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5707         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5708         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5709         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5710         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5711         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5712         16  FILLER                         PIC X.
  5713         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5714             20  CF-ST-BENEFIT-CD           PIC XX.
  5715             20  CF-ST-BENEFIT-KIND         PIC X.
  5716                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5717                 88  CF-ST-AH-KIND              VALUE 'A'.
  5718             20  CF-ST-REM-TERM-CALC        PIC X.
  5719                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5720                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5721                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5722                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5723                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5724                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5725                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5726                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5727
  5728             20  CF-ST-REFUND-CALC          PIC X.
  5729                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5730                 88  ST-REFD-BY-R78             VALUE '1'.
  5731                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5732                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5733                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5734                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5735                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5736                 88  ST-REFD-UTAH               VALUE '7'.
  5737                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5738                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5739                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5740
  5741             20  CF-ST-EARNING-CALC         PIC X.
  5742                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5743                 88  ST-EARN-BY-R78             VALUE '1'.
  5744                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5745                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 106
* EL050.cbl
  5746                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5747                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5748                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5749                 88  ST-EARN-MEAN               VALUE '8'.
  5750                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5751
  5752             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5753                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5754                 88  ST-OVRD-BY-R78             VALUE '1'.
  5755                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5756                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5757                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5758                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5759                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5760                 88  ST-OVRD-MEAN               VALUE '8'.
  5761                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5762             20  cf-st-extra-periods        pic 9.
  5763*            20  FILLER                     PIC X.
  5764
  5765         16  CF-ST-COMMISSION-CAPS.
  5766             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5767             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5768             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5769             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5770         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5771                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5772                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5773                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5774
  5775         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5776
  5777         16  CF-ST-STATUTORY-INTEREST.
  5778             20  CF-ST-STAT-DATE-FROM       PIC X.
  5779                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5780                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5781             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5782             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5783             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5784             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5785             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5786
  5787         16  CF-ST-OVER-SHORT.
  5788             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5789             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5790
  5791         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5792
  5793         16  CF-ST-RT-CALC                  PIC X.
  5794
  5795         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5796         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5797         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5798         16  CF-ST-RF-LR-CALC               PIC X.
  5799         16  CF-ST-RF-LL-CALC               PIC X.
  5800         16  CF-ST-RF-LN-CALC               PIC X.
  5801         16  CF-ST-RF-AH-CALC               PIC X.
  5802         16  CF-ST-RF-CP-CALC               PIC X.
  5803*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 107
* EL050.cbl
  5804*CIDMOD         16  FILLER                         PIC X(192).
  5805         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5806             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5807         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5808         16  CF-ST-VFY-2ND-BENE             PIC X.
  5809         16  CF-ST-CAUSAL-STATE             PIC X.
  5810         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5811         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5812         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5813             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5814         16  CF-ST-NET-ONLY-STATE           PIC X.
  5815             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5816         16  cf-commission-cap-required     pic x.
  5817         16  CF-ST-GA-COMMISSION-CAPS.
  5818             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5819             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5820             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5821             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5822         16  CF-ST-TOT-COMMISSION-CAPS.
  5823             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5824             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5825             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5826             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5827         16  FILLER                         PIC X(156).
  5828
  5829****************************************************************
  5830*             BENEFIT MASTER RECORD                            *
  5831****************************************************************
  5832
  5833     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5834         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5835             20  CF-BENEFIT-CODE            PIC XX.
  5836             20  CF-BENEFIT-NUMERIC  REDEFINES
  5837                 CF-BENEFIT-CODE            PIC XX.
  5838             20  CF-BENEFIT-ALPHA           PIC XXX.
  5839             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5840             20  CF-BENEFIT-COMMENT         PIC X(10).
  5841
  5842             20  CF-LF-COVERAGE-TYPE        PIC X.
  5843                 88  CF-REDUCING                VALUE 'R'.
  5844                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5845
  5846             20  CF-SPECIAL-CALC-CD         PIC X.
  5847                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5848                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5849                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5850                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5851                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5852                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5853                 88  CF-FARM-PLAN               VALUE 'F'.
  5854                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5855                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5856                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5857                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5858                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5859                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5860                 88  CF-PRUDENTIAL              VALUE 'P'.
  5861                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 108
* EL050.cbl
  5862                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5863                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5864                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5865                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5866                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5867
  5868             20  CF-JOINT-INDICATOR         PIC X.
  5869                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5870
  5871*            20  FILLER                     PIC X(12).
  5872             20  cf-maximum-benefits        pic s999 comp-3.
  5873             20  FILLER                     PIC X(09).
  5874             20  CF-BENEFIT-CATEGORY        PIC X.
  5875             20  CF-LOAN-TYPE               PIC X(8).
  5876
  5877             20  CF-CO-REM-TERM-CALC        PIC X.
  5878                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5879                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5880                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5881                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5882                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5883
  5884             20  CF-CO-EARNINGS-CALC        PIC X.
  5885                 88  CO-EARN-BY-R78             VALUE '1'.
  5886                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5887                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5888                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5889                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5890                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5891                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5892                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5893
  5894             20  CF-CO-REFUND-CALC          PIC X.
  5895                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5896                 88  CO-REFD-BY-R78             VALUE '1'.
  5897                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5898                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5899                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5900                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5901                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5902                 88  CO-REFD-MEAN               VALUE '8'.
  5903                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5904                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5905                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5906
  5907             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5908                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5909                 88  CO-OVRD-BY-R78             VALUE '1'.
  5910                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5911                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5912                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5913                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5914                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5915                 88  CO-OVRD-MEAN               VALUE '8'.
  5916                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5917
  5918             20  CF-CO-BEN-I-G-CD           PIC X.
  5919                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 109
* EL050.cbl
  5920                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5921                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5922
  5923         16  FILLER                         PIC X(304).
  5924
  5925
  5926****************************************************************
  5927*             CARRIER MASTER RECORD                            *
  5928****************************************************************
  5929
  5930     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5931         16  CF-ADDRESS-DATA.
  5932             20  CF-MAIL-TO-NAME            PIC X(30).
  5933             20  CF-IN-CARE-OF              PIC X(30).
  5934             20  CF-ADDRESS-LINE-1          PIC X(30).
  5935             20  CF-ADDRESS-LINE-2          PIC X(30).
  5936             20  CF-CITY-STATE              PIC X(30).
  5937             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5938             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5939
  5940         16  CF-CLAIM-NO-CONTROL.
  5941             20  CF-CLAIM-NO-METHOD         PIC X.
  5942                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5943                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5944                 88  CLAIM-NO-SEQ               VALUE '3'.
  5945                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5946             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5947                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5948                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5949                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5950
  5951         16  CF-CHECK-NO-CONTROL.
  5952             20  CF-CHECK-NO-METHOD         PIC X.
  5953                 88  CHECK-NO-MANUAL            VALUE '1'.
  5954                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5955                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5956                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5957             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5958                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5959
  5960         16  CF-DOMICILE-STATE              PIC XX.
  5961
  5962         16  CF-EXPENSE-CONTROLS.
  5963             20  CF-EXPENSE-METHOD          PIC X.
  5964                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5965                 88  DOLLARS-PER-PMT            VALUE '2'.
  5966                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5967                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5968             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5969             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5970
  5971         16  CF-CORRESPONDENCE-CONTROL.
  5972             20  CF-LETTER-RESEND-OPT       PIC X.
  5973                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5974                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5975             20  FILLER                     PIC X(4).
  5976
  5977         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 110
* EL050.cbl
  5978             20  CF-MANUAL-SW               PIC X.
  5979                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5980             20  CF-FUTURE-SW               PIC X.
  5981                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5982             20  CF-PTC-SW                  PIC X.
  5983                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5984             20  CF-IBNR-SW                 PIC X.
  5985                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5986             20  CF-PTC-LF-SW               PIC X.
  5987                 88  CF-LF-PTC-USED             VALUE '1'.
  5988             20  CF-CDT-ACCESS-METHOD       PIC X.
  5989                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5990                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5991                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5992             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5993
  5994         16  CF-CLAIM-CALC-METHOD           PIC X.
  5995             88  360-PLUS-MONTHS                VALUE '1'.
  5996             88  365-PLUS-MONTHS                VALUE '2'.
  5997             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5998             88  360-DAILY                      VALUE '4'.
  5999             88  365-DAILY                      VALUE '5'.
  6000
  6001         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6002         16  FILLER                         PIC X(11).
  6003
  6004         16  CF-LIMIT-AMOUNTS.
  6005             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6006             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6007             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6008             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6009             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6010             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6011             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6012             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6013             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6014             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6015
  6016         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6017         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6018         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6019
  6020         16  CF-ZIP-CODE.
  6021             20  CF-ZIP-PRIME.
  6022                 24  CF-ZIP-1ST             PIC X.
  6023                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6024                 24  FILLER                 PIC X(4).
  6025             20  CF-ZIP-PLUS4               PIC X(4).
  6026         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6027             20  CF-CAN-POSTAL-1            PIC XXX.
  6028             20  CF-CAN-POSTAL-2            PIC XXX.
  6029             20  FILLER                     PIC XXX.
  6030
  6031         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6032         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6033         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6034
  6035         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 111
* EL050.cbl
  6036             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6037             88  CF-NO-RATING                   VALUE 'N'.
  6038
  6039         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6040
  6041         16  CF-CARRIER-OVER-SHORT.
  6042             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6043             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6044
  6045         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6046         16  CF-SECPAY-SWITCH               PIC X.
  6047             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6048             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6049         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6050         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6051         16  FILLER                         PIC X(444).
  6052*        16  FILLER                         PIC X(452).
  6053
  6054
  6055****************************************************************
  6056*             MORTALITY MASTER RECORD                          *
  6057****************************************************************
  6058
  6059     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6060         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6061                                INDEXED BY CF-MORT-NDX.
  6062             20  CF-MORT-TABLE              PIC X(5).
  6063             20  CF-MORT-TABLE-TYPE         PIC X.
  6064                 88  CF-MORT-JOINT              VALUE 'J'.
  6065                 88  CF-MORT-SINGLE             VALUE 'S'.
  6066                 88  CF-MORT-COMBINED           VALUE 'C'.
  6067                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6068                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6069             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6070             20  CF-MORT-AGE-METHOD         PIC XX.
  6071                 88  CF-AGE-LAST                VALUE 'AL'.
  6072                 88  CF-AGE-NEAR                VALUE 'AN'.
  6073             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6074             20  CF-MORT-ADJUSTMENT-DIRECTION
  6075                                            PIC X.
  6076                 88  CF-MINUS                   VALUE '-'.
  6077                 88  CF-PLUS                    VALUE '+'.
  6078             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6079             20  CF-MORT-JOINT-CODE         PIC X.
  6080                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6081             20  CF-MORT-PC-Q               PIC X.
  6082                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6083             20  CF-MORT-TABLE-CODE         PIC X(4).
  6084             20  CF-MORT-COMMENTS           PIC X(15).
  6085             20  FILLER                     PIC X(14).
  6086
  6087         16  FILLER                         PIC X(251).
  6088
  6089
  6090****************************************************************
  6091*             BUSSINESS TYPE MASTER RECORD                     *
  6092****************************************************************
  6093
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 112
* EL050.cbl
  6094     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6095* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6096* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6097* AND RECORD 05 IS TYPES 81-99
  6098         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6099             20  CF-BUSINESS-TITLE          PIC  X(19).
  6100             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6101                                            PIC S9V9(4) COMP-3.
  6102             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6103             20  FILLER                     PIC  X.
  6104         16  FILLER                         PIC  X(248).
  6105
  6106
  6107****************************************************************
  6108*             TERMINAL MASTER RECORD                           *
  6109****************************************************************
  6110
  6111     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6112
  6113         16  CF-COMPANY-TERMINALS.
  6114             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6115                                  PIC X(4).
  6116         16  FILLER               PIC X(248).
  6117
  6118
  6119****************************************************************
  6120*             LIFE EDIT MASTER RECORD                          *
  6121****************************************************************
  6122
  6123     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6124         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6125             20  CF-LIFE-CODE-IN            PIC XX.
  6126             20  CF-LIFE-CODE-OUT           PIC XX.
  6127         16  FILLER                         PIC X(248).
  6128
  6129
  6130****************************************************************
  6131*             AH EDIT MASTER RECORD                            *
  6132****************************************************************
  6133
  6134     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6135         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6136             20  CF-AH-CODE-IN              PIC XXX.
  6137             20  CF-AH-CODE-OUT             PIC XX.
  6138         16  FILLER                         PIC X(248).
  6139
  6140
  6141****************************************************************
  6142*             CREDIBILITY TABLES                               *
  6143****************************************************************
  6144
  6145     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6146         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6147                             INDEXED BY CF-CRDB-NDX.
  6148             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6149             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6150             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6151         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 113
* EL050.cbl
  6152
  6153
  6154****************************************************************
  6155*             REPORT CUSTOMIZATION RECORD                      *
  6156****************************************************************
  6157
  6158     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6159         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6160             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6161             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6162             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6163**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6164****       A T-TRANSFER.                                   ****
  6165             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6166
  6167         16  FILLER                         PIC XX.
  6168
  6169         16  CF-CARRIER-CNTL-OPT.
  6170             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6171                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6172                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6173             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6174                                            PIC X.
  6175         16  CF-GROUP-CNTL-OPT.
  6176             20  CF-GROUP-OPT-SEQ           PIC 9.
  6177                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6178                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6179             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6180                                            PIC X(6).
  6181         16  CF-STATE-CNTL-OPT.
  6182             20  CF-STATE-OPT-SEQ           PIC 9.
  6183                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6184                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6185             20  CF-STATE-SELECT OCCURS 3 TIMES
  6186                                            PIC XX.
  6187         16  CF-ACCOUNT-CNTL-OPT.
  6188             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6189                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6190                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6191             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6192                                            PIC X(10).
  6193         16  CF-BUS-TYP-CNTL-OPT.
  6194             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6195                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6196                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6197             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6198                                            PIC XX.
  6199         16  CF-LF-TYP-CNTL-OPT.
  6200             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6201                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6202                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6203             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6204                                            PIC XX.
  6205         16  CF-AH-TYP-CNTL-OPT.
  6206             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6207                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6208                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6209             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 114
* EL050.cbl
  6210                                            PIC XX.
  6211         16  CF-REPTCD1-CNTL-OPT.
  6212             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6213                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6214                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6215             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6216                                            PIC X(10).
  6217         16  CF-REPTCD2-CNTL-OPT.
  6218             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6219                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6220                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6221             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6222                                            PIC X(10).
  6223         16  CF-USER1-CNTL-OPT.
  6224             20  CF-USER1-OPT-SEQ           PIC 9.
  6225                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6226                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6227             20  CF-USER1-SELECT OCCURS 3 TIMES
  6228                                            PIC X(10).
  6229         16  CF-USER2-CNTL-OPT.
  6230             20  CF-USER2-OPT-SEQ           PIC 9.
  6231                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6232                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6233             20  CF-USER2-SELECT OCCURS 3 TIMES
  6234                                            PIC X(10).
  6235         16  CF-USER3-CNTL-OPT.
  6236             20  CF-USER3-OPT-SEQ           PIC 9.
  6237                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6238                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6239             20  CF-USER3-SELECT OCCURS 3 TIMES
  6240                                            PIC X(10).
  6241         16  CF-USER4-CNTL-OPT.
  6242             20  CF-USER4-OPT-SEQ           PIC 9.
  6243                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6244                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6245             20  CF-USER4-SELECT OCCURS 3 TIMES
  6246                                            PIC X(10).
  6247         16  CF-USER5-CNTL-OPT.
  6248             20  CF-USER5-OPT-SEQ           PIC 9.
  6249                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6250                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6251             20  CF-USER5-SELECT OCCURS 3 TIMES
  6252                                            PIC X(10).
  6253         16  CF-REINS-CNTL-OPT.
  6254             20  CF-REINS-OPT-SEQ           PIC 9.
  6255                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6256                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6257             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6258                 24  CF-REINS-PRIME         PIC XXX.
  6259                 24  CF-REINS-SUB           PIC XXX.
  6260
  6261         16  CF-AGENT-CNTL-OPT.
  6262             20  CF-AGENT-OPT-SEQ           PIC 9.
  6263                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6264                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6265             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6266                                            PIC X(10).
  6267
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 115
* EL050.cbl
  6268         16  FILLER                         PIC X(43).
  6269
  6270         16  CF-LOSS-RATIO-SELECT.
  6271             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6272             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6273         16  CF-ENTRY-DATE-SELECT.
  6274             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6275             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6276         16  CF-EFFECTIVE-DATE-SELECT.
  6277             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6278             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6279
  6280         16  CF-EXCEPTION-LIST-IND          PIC X.
  6281             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6282
  6283         16  FILLER                         PIC X(318).
  6284
  6285****************************************************************
  6286*                  EXCEPTION REPORTING RECORD                  *
  6287****************************************************************
  6288
  6289     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6290         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6291             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6292
  6293         16  CF-COMBINED-LIFE-AH-OPT.
  6294             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6295             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6296             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6297             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6298
  6299         16  CF-LIFE-OPT.
  6300             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6301             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6302             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6303             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6304             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6305             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6306             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6307             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6308             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6309             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6310
  6311         16  CF-AH-OPT.
  6312             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6313             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6314             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6315             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6316             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6317             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6318             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6319             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6320             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6321             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6322
  6323         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6324             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6325             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 116
* EL050.cbl
  6326             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6327
  6328         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6329
  6330         16  FILLER                         PIC X(673).
  6331
  6332
  6333****************************************************************
  6334*             MORTGAGE SYSTEM PLAN RECORD                      *
  6335****************************************************************
  6336
  6337     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6338         16  CF-PLAN-TYPE                   PIC X.
  6339             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6340             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6341             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6342         16  CF-PLAN-ABBREV                 PIC XXX.
  6343         16  CF-PLAN-DESCRIPT               PIC X(10).
  6344         16  CF-PLAN-NOTES                  PIC X(20).
  6345         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6346         16  CF-PLAN-UNDERWRITING.
  6347             20  CF-PLAN-TERM-DATA.
  6348                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6349                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6350             20  CF-PLAN-AGE-DATA.
  6351                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6352                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6353                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6354             20  CF-PLAN-BENEFIT-DATA.
  6355                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6356                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6357                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6358                                            PIC S9(7)V99  COMP-3.
  6359         16  CF-PLAN-POLICY-FORMS.
  6360             20  CF-POLICY-FORM             PIC X(12).
  6361             20  CF-MASTER-APPLICATION      PIC X(12).
  6362             20  CF-MASTER-POLICY           PIC X(12).
  6363         16  CF-PLAN-RATING.
  6364             20  CF-RATE-CODE               PIC X(5).
  6365             20  CF-SEX-RATING              PIC X.
  6366                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6367                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6368             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6369             20  CF-SUB-STD-TYPE            PIC X.
  6370                 88  CF-PCT-OF-PREM            VALUE '1'.
  6371                 88  CF-PCT-OF-BENE            VALUE '2'.
  6372         16  CF-PLAN-PREM-TOLERANCES.
  6373             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6374             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6375         16  CF-PLAN-PYMT-TOLERANCES.
  6376             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6377             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6378         16  CF-PLAN-MISC-DATA.
  6379             20  FILLER                     PIC X.
  6380             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6381             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6382         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6383         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 117
* EL050.cbl
  6384             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6385                                                     '1'.
  6386             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6387                                                     '2'.
  6388         16  CF-MIB-SEARCH-SW               PIC X.
  6389             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6390             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6391             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6392             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6393         16  CF-ALPHA-SEARCH-SW             PIC X.
  6394             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6395             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6396             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6397             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6398             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6399             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6400             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6401             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6402             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6403             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6404                                                     'A' 'B' 'C'
  6405                                                     'X' 'Y' 'Z'.
  6406         16  CF-EFF-DT-RULE-SW              PIC X.
  6407             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6408             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6409             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6410             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6411             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6412         16  FILLER                         PIC X(4).
  6413         16  CF-HEALTH-QUESTIONS            PIC X.
  6414             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6415         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6416         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6417         16  CF-PLAN-SNGL-JNT               PIC X.
  6418             88  CF-COMBINED-PLAN              VALUE 'C'.
  6419             88  CF-JNT-PLAN                   VALUE 'J'.
  6420             88  CF-SNGL-PLAN                  VALUE 'S'.
  6421         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6422         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6423         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6424         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6425         16  CF-RERATE-CNTL                 PIC  X.
  6426             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6427             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6428             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6429             88  CF-AUTO-RECALC                 VALUE '4'.
  6430         16  CF-BENEFIT-TYPE                PIC  X.
  6431             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6432             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6433         16  CF-POLICY-FEE                  PIC S999V99
  6434                                                    COMP-3.
  6435         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6436         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6437         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6438         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6439         16  FILLER                         PIC  X(32).
  6440         16  CF-TERMINATION-FORM            PIC  X(04).
  6441         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 118
* EL050.cbl
  6442         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6443                                                       COMP-3.
  6444         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6445         16  CF-ISSUE-LETTER                PIC  X(4).
  6446         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6447         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6448             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6449             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6450         16  CF-MP-REFUND-CALC              PIC X.
  6451             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6452             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6453             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6454             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6455             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6456             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6457             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6458             88  CF-MP-REFD-MEAN                VALUE '8'.
  6459         16  CF-ALT-RATE-CODE               PIC  X(5).
  6460
  6461
  6462         16  FILLER                         PIC X(498).
  6463****************************************************************
  6464*             MORTGAGE COMPANY MASTER RECORD                   *
  6465****************************************************************
  6466
  6467     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6468         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6469         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6470             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6471             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6472             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6473             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6474             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6475
  6476         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6477         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6478         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6479         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6480         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6481
  6482         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6483             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6484         16  CF-MP-RECON-USE-IND            PIC X(1).
  6485             88  CF-MP-USE-RECON             VALUE 'Y'.
  6486         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6487             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6488         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6489             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6490             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6491         16  FILLER                         PIC X(1).
  6492         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6493             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6494         16  CF-MORTG-MIB-VERSION           PIC X.
  6495             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6496             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6497             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6498         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6499             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 119
* EL050.cbl
  6500                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6501             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6502                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6503             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6504                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6505             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6506                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6507             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6508                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6509             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6510                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6511         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6512         16  FILLER                         PIC X(7).
  6513         16  CF-MORTG-DESTINATION-SYMBOL.
  6514             20  CF-MORTG-MIB-COMM          PIC X(5).
  6515             20  CF-MORTG-MIB-TERM          PIC X(5).
  6516         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6517             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6518         16  FILLER                         PIC X(03).
  6519         16  CF-MP-CHECK-NO-CONTROL.
  6520             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6521                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6522                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6523                                                ' ' LOW-VALUES.
  6524                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6525                                               VALUE '3'.
  6526         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6527         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6528         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6529             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6530                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6531             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6532                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6533             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6534                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6535             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6536                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6537             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6538                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6539             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6540                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6541         16  CF-MORTG-BILLING-AREA.
  6542             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6543                                            PIC X.
  6544         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6545         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6546         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6547         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6548             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6549             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6550         16  FILLER                         PIC X.
  6551         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6552             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6553             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6554         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6555         16  FILLER                         PIC X(8).
  6556         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6557         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 120
* EL050.cbl
  6558         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6559         16  CF-ACH-COMPANY-ID.
  6560             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6561                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6562                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6563                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6564             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6565         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6566             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6567         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6568             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6569             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6570         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6571         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6572         16  FILLER                         PIC X(536).
  6573
  6574****************************************************************
  6575*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6576****************************************************************
  6577
  6578     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6579         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6580             20  CF-FEMALE-HEIGHT.
  6581                 24  CF-FEMALE-FT           PIC 99.
  6582                 24  CF-FEMALE-IN           PIC 99.
  6583             20  CF-FEMALE-MIN-WT           PIC 999.
  6584             20  CF-FEMALE-MAX-WT           PIC 999.
  6585         16  FILLER                         PIC X(428).
  6586
  6587     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6588         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6589             20  CF-MALE-HEIGHT.
  6590                 24  CF-MALE-FT             PIC 99.
  6591                 24  CF-MALE-IN             PIC 99.
  6592             20  CF-MALE-MIN-WT             PIC 999.
  6593             20  CF-MALE-MAX-WT             PIC 999.
  6594         16  FILLER                         PIC X(428).
  6595******************************************************************
  6596*             AUTOMATIC ACTIVITY RECORD                          *
  6597******************************************************************
  6598     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6599         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6600             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6601             20  CF-SYS-LETTER-ID           PIC X(04).
  6602             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6603             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6604             20  CF-SYS-RESET-SW            PIC X(01).
  6605             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6606             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6607
  6608         16  FILLER                         PIC X(50).
  6609
  6610         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6611             20  CF-USER-ACTIVE-SW          PIC X(01).
  6612             20  CF-USER-LETTER-ID          PIC X(04).
  6613             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6614             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6615             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 121
* EL050.cbl
  6616             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6617             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6618             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6619
  6620         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 122
* EL050.cbl
  6622*    COPY ERCACCT.
  6623******************************************************************
  6624*                                                                *
  6625*                                                                *
  6626*                            ERCACCT                             *
  6627*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6628*                            VMOD=2.031                          *
  6629*                                                                *
  6630*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6631*                                                                *
  6632*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6633*   VSAM ACCOUNT MASTER FILES.                                   *
  6634*                                                                *
  6635*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6636*                                                                *
  6637*   FILE TYPE = VSAM,KSDS                                        *
  6638*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6639*                                                                *
  6640*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6641*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6642*                                                                *
  6643*   LOG = NO                                                     *
  6644*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6645*                                                                *
  6646*                                                                *
  6647******************************************************************
  6648*                   C H A N G E   L O G
  6649*
  6650* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6651*-----------------------------------------------------------------
  6652*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6653* EFFECTIVE    NUMBER
  6654*-----------------------------------------------------------------
  6655* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6656* 092705    2005050300006  PEMA  ADD SPP LEASES
  6657* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6658* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6659* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6660* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6661* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6662* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6663******************************************************************
  6664
  6665 01  ACCOUNT-MASTER.
  6666     12  AM-RECORD-ID                      PIC XX.
  6667         88  VALID-AM-ID                      VALUE 'AM'.
  6668
  6669     12  AM-CONTROL-PRIMARY.
  6670         16  AM-COMPANY-CD                 PIC X.
  6671         16  AM-MSTR-CNTRL.
  6672             20  AM-CONTROL-A.
  6673                 24  AM-CARRIER            PIC X.
  6674                 24  AM-GROUPING.
  6675                     28 AM-GROUPING-PREFIX PIC XXX.
  6676                     28 AM-GROUPING-PRIME  PIC XXX.
  6677                 24  AM-STATE              PIC XX.
  6678                 24  AM-ACCOUNT.
  6679                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 123
* EL050.cbl
  6680                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6681             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6682                                           PIC X(19).
  6683             20  AM-CNTRL-B.
  6684                 24  AM-EXPIRATION-DT      PIC XX.
  6685                 24  FILLER                PIC X(4).
  6686             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6687                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6688
  6689     12  AM-CONTROL-BY-VAR-GRP.
  6690         16  AM-COMPANY-CD-A1              PIC X.
  6691         16  AM-VG-CARRIER                 PIC X.
  6692         16  AM-VG-GROUPING                PIC X(6).
  6693         16  AM-VG-STATE                   PIC XX.
  6694         16  AM-VG-ACCOUNT                 PIC X(10).
  6695         16  AM-VG-DATE.
  6696             20  AM-VG-EXPIRATION-DT       PIC XX.
  6697             20  FILLER                    PIC X(4).
  6698         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6699                                           PIC 9(11)      COMP-3.
  6700     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6701         16  FILLER                        PIC X(10).
  6702         16  AM-VG-KEY3.
  6703             20  AM-VG3-ACCOUNT            PIC X(10).
  6704             20  AM-VG3-EXP-DT             PIC XX.
  6705         16  FILLER                        PIC X(4).
  6706     12  AM-MAINT-INFORMATION.
  6707         16  AM-LAST-MAINT-DT              PIC XX.
  6708         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6709         16  AM-LAST-MAINT-USER            PIC X(4).
  6710         16  FILLER                        PIC XX.
  6711
  6712     12  AM-EFFECTIVE-DT                   PIC XX.
  6713     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6714
  6715     12  AM-PREV-DATES  COMP-3.
  6716         16  AM-PREV-EXP-DT                PIC 9(11).
  6717         16  AM-PREV-EFF-DT                PIC 9(11).
  6718
  6719     12  AM-REPORT-CODE-1                  PIC X(10).
  6720     12  AM-REPORT-CODE-2                  PIC X(10).
  6721
  6722     12  AM-CITY-CODE                      PIC X(4).
  6723     12  AM-COUNTY-PARISH                  PIC X(6).
  6724
  6725     12  AM-NAME                           PIC X(30).
  6726     12  AM-PERSON                         PIC X(30).
  6727     12  AM-ADDRS                          PIC X(30).
  6728     12  AM-CITY.
  6729         16  AM-ADDR-CITY                  PIC X(28).
  6730         16  AM-ADDR-STATE                 PIC XX.
  6731     12  AM-ZIP.
  6732         16  AM-ZIP-PRIME.
  6733             20  AM-ZIP-PRI-1ST            PIC X.
  6734                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6735             20  FILLER                    PIC X(4).
  6736         16  AM-ZIP-PLUS4                  PIC X(4).
  6737     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 124
* EL050.cbl
  6738         16  AM-CAN-POSTAL-1               PIC XXX.
  6739         16  AM-CAN-POSTAL-2               PIC XXX.
  6740         16  FILLER                        PIC XXX.
  6741     12  AM-TEL-NO.
  6742         16  AM-AREA-CODE                  PIC 999.
  6743         16  AM-TEL-PRE                    PIC 999.
  6744         16  AM-TEL-NBR                    PIC 9(4).
  6745     12  AM-TEL-LOC                        PIC X.
  6746         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6747         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6748
  6749     12  AM-COMM-STRUCTURE.
  6750         16  AM-DEFN-1.
  6751             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6752                 24  AM-AGT.
  6753                     28  AM-AGT-PREFIX     PIC X(4).
  6754                     28  AM-AGT-PRIME      PIC X(6).
  6755                 24  AM-COM-TYP            PIC X.
  6756                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6757                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6758                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6759                 24  AM-RECALC-LV-INDIC    PIC X.
  6760                 24  AM-RETRO-LV-INDIC     PIC X.
  6761                 24  AM-GL-CODES           PIC X.
  6762                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6763                 24  FILLER                PIC X(01).
  6764         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6765             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6766                 24  FILLER                PIC X(11).
  6767                 24  AM-L-COMA             PIC XXX.
  6768                 24  AM-J-COMA             PIC XXX.
  6769                 24  AM-A-COMA             PIC XXX.
  6770                 24  FILLER                PIC X(6).
  6771
  6772     12  AM-COMM-CHANGE-STATUS             PIC X.
  6773         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6774
  6775     12  AM-CSR-CODE                       PIC X(4).
  6776
  6777     12  AM-BILLING-STATUS                 PIC X.
  6778         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6779         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6780     12  AM-AUTO-REFUND-SW                 PIC X.
  6781         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6782         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6783     12  AM-GPCD                           PIC 99.
  6784     12  AM-IG                             PIC X.
  6785         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6786         88  AM-HAS-GROUP                     VALUE '2'.
  6787     12  AM-STATUS                         PIC X.
  6788         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6789         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6790         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6791         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6792         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6793         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6794         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6795         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 125
* EL050.cbl
  6796         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6797         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6798     12  AM-REMIT-TO                       PIC 99.
  6799     12  AM-ID-NO                          PIC X(11).
  6800
  6801     12  AM-CAL-TABLE                      PIC XX.
  6802     12  AM-LF-DEVIATION                   PIC XXX.
  6803     12  AM-AH-DEVIATION                   PIC XXX.
  6804     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6805     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6806     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6807     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6808     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6809     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6810
  6811     12  AM-USER-FIELDS.
  6812         16  AM-FLD-1                      PIC XX.
  6813         16  AM-FLD-2                      PIC XX.
  6814         16  AM-FLD-3                      PIC XX.
  6815         16  AM-FLD-4                      PIC XX.
  6816         16  AM-FLD-5                      PIC XX.
  6817
  6818     12  AM-1ST-PROD-DATE.
  6819         16  AM-1ST-PROD-YR                PIC XX.
  6820         16  AM-1ST-PROD-MO                PIC XX.
  6821         16  AM-1ST-PROD-DA                PIC XX.
  6822     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6823     12  AM-CERTS-PURGED-DATE.
  6824         16  AM-PUR-YR                     PIC XX.
  6825         16  AM-PUR-MO                     PIC XX.
  6826         16  AM-PUR-DA                     PIC XX.
  6827     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6828     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6829     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6830     12  AM-INACTIVE-DATE.
  6831         16  AM-INA-MO                     PIC 99.
  6832         16  AM-INA-DA                     PIC 99.
  6833         16  AM-INA-YR                     PIC 99.
  6834     12  AM-AR-HI-CERT-DATE                PIC XX.
  6835
  6836     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6837     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6838
  6839     12  AM-OB-PAYMENT-MODE                PIC X.
  6840         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6841         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6842         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6843         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6844
  6845     12  AM-AH-ONLY-INDICATOR              PIC X.
  6846         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6847         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6848
  6849     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6850
  6851     12  AM-OVER-SHORT.
  6852         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6853         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 126
* EL050.cbl
  6854
  6855     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6856     12  AM-DCC-CLP-STATE                  PIC XX.
  6857
  6858     12  AM-RECALC-COMM                    PIC X.
  6859     12  AM-RECALC-REIN                    PIC X.
  6860
  6861     12  AM-REI-TABLE                      PIC XXX.
  6862     12  AM-REI-ET-LF                      PIC X.
  6863     12  AM-REI-ET-AH                      PIC X.
  6864     12  AM-REI-PE-LF                      PIC X.
  6865     12  AM-REI-PE-AH                      PIC X.
  6866     12  AM-REI-PRT-ST                     PIC X.
  6867     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6868     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6869     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6870     12  AM-REI-GROUP-A                    PIC X(6).
  6871     12  AM-REI-MORT                       PIC X(4).
  6872     12  AM-REI-PRT-OW                     PIC X.
  6873     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6874     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6875     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6876     12  AM-REI-GROUP-B                    PIC X(6).
  6877
  6878     12  AM-TRUST-TYPE                     PIC X(2).
  6879
  6880     12  AM-EMPLOYER-STMT-USED             PIC X.
  6881     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6882
  6883     12  AM-STD-AH-TYPE                    PIC XX.
  6884     12  AM-EARN-METHODS.
  6885         16  AM-EARN-METHOD-R              PIC X.
  6886             88 AM-REF-RL-R78                 VALUE 'R'.
  6887             88 AM-REF-RL-PR                  VALUE 'P'.
  6888             88 AM-REF-RL-MEAN                VALUE 'M'.
  6889             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6890         16  AM-EARN-METHOD-L              PIC X.
  6891             88 AM-REF-LL-R78                 VALUE 'R'.
  6892             88 AM-REF-LL-PR                  VALUE 'P'.
  6893             88 AM-REF-LL-MEAN                VALUE 'M'.
  6894             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6895         16  AM-EARN-METHOD-A              PIC X.
  6896             88 AM-REF-AH-R78                 VALUE 'R'.
  6897             88 AM-REF-AH-PR                  VALUE 'P'.
  6898             88 AM-REF-AH-MEAN                VALUE 'M'.
  6899             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6900             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6901             88 AM-REF-AH-NET                 VALUE 'N'.
  6902
  6903     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6904     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6905     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6906
  6907     12  AM-RET-Y-N                        PIC X.
  6908     12  AM-RET-P-E                        PIC X.
  6909     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6910     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6911     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 127
* EL050.cbl
  6912     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6913         16  AM-POOL-PRIME                 PIC XXX.
  6914         16  AM-POOL-SUB                   PIC XXX.
  6915     12  AM-RETRO-EARNINGS.
  6916         16  AM-RET-EARN-R                 PIC X.
  6917         16  AM-RET-EARN-L                 PIC X.
  6918         16  AM-RET-EARN-A                 PIC X.
  6919     12  AM-RET-ST-TAX-USE                 PIC X.
  6920         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6921         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6922     12  AM-RETRO-BEG-EARNINGS.
  6923         16  AM-RET-BEG-EARN-R             PIC X.
  6924         16  AM-RET-BEG-EARN-L             PIC X.
  6925         16  AM-RET-BEG-EARN-A             PIC X.
  6926     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6927     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6928
  6929     12  AM-USER-SELECT-OPTIONS.
  6930         16  AM-USER-SELECT-1              PIC X(10).
  6931         16  AM-USER-SELECT-2              PIC X(10).
  6932         16  AM-USER-SELECT-3              PIC X(10).
  6933         16  AM-USER-SELECT-4              PIC X(10).
  6934         16  AM-USER-SELECT-5              PIC X(10).
  6935
  6936     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6937
  6938     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6939
  6940     12  AM-RPT045A-SWITCH                 PIC X.
  6941         88  RPT045A-OFF                   VALUE 'N'.
  6942
  6943     12  AM-INSURANCE-LIMITS.
  6944         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6945         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6946
  6947     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6948         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6949
  6950     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6951         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6952         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6953
  6954     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6955
  6956     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6957     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6958     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6959     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6960     12  AM-DCC-UEF-STATE                  PIC XX.
  6961     12  FILLER                            PIC XXX.
  6962     12  AM-REPORT-CODE-3                  PIC X(10).
  6963*    12  FILLER                            PIC X(22).
  6964
  6965     12  AM-RESERVE-DATE.
  6966         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6967         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6968         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6969
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 128
* EL050.cbl
  6970     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6971     12  AM-NOTIFICATION-TYPES.
  6972         16  AM-NOTIF-OF-LETTERS           PIC X.
  6973         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6974         16  AM-NOTIF-OF-REPORTS           PIC X.
  6975         16  AM-NOTIF-OF-STATUS            PIC X.
  6976
  6977     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6978         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6979         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6980         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6981         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6982
  6983     12  AM-BENEFIT-CONTROLS.
  6984         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6985             20  AM-BENEFIT-CODE           PIC XX.
  6986             20  AM-BENEFIT-TYPE           PIC X.
  6987             20  AM-BENEFIT-REVISION       PIC XXX.
  6988             20  AM-BENEFIT-REM-TERM       PIC X.
  6989             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6990             20  FILLER                    PIC XX.
  6991         16  FILLER                        PIC X(80).
  6992
  6993     12  AM-TRANSFER-DATA.
  6994         16  AM-TRANSFERRED-FROM.
  6995             20  AM-TRNFROM-CARRIER        PIC X.
  6996             20  AM-TRNFROM-GROUPING.
  6997                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6998                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6999             20  AM-TRNFROM-STATE          PIC XX.
  7000             20  AM-TRNFROM-ACCOUNT.
  7001                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7002                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7003             20  AM-TRNFROM-DTE            PIC XX.
  7004         16  AM-TRANSFERRED-TO.
  7005             20  AM-TRNTO-CARRIER          PIC X.
  7006             20  AM-TRNTO-GROUPING.
  7007                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7008                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7009             20  AM-TRNTO-STATE            PIC XX.
  7010             20  AM-TRNTO-ACCOUNT.
  7011                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7012                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7013             20  AM-TRNTO-DTE              PIC XX.
  7014         16  FILLER                        PIC X(10).
  7015
  7016     12  AM-SAVED-REMIT-TO                 PIC 99.
  7017
  7018     12  AM-COMM-STRUCTURE-SAVED.
  7019         16  AM-DEFN-1-SAVED.
  7020             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7021                 24  AM-AGT-SV             PIC X(10).
  7022                 24  AM-COM-TYP-SV         PIC X.
  7023                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7024                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7025                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7026                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7027                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 129
* EL050.cbl
  7028                 24  AM-GL-CODES-SV        PIC X.
  7029                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7030                 24  FILLER                PIC X.
  7031         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7032             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7033                 24  FILLER                PIC X(11).
  7034                 24  AM-L-COMA-SV          PIC XXX.
  7035                 24  AM-J-COMA-SV          PIC XXX.
  7036                 24  AM-A-COMA-SV          PIC XXX.
  7037                 24  FILLER                PIC X(6).
  7038
  7039     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7040         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7041            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7042            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7043            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7044
  7045     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7046     12  FILLER                            PIC X(120).
  7047
  7048     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7049         16  AM-CONTROL-NAME               PIC X(30).
  7050         16  AM-EXECUTIVE-ONE.
  7051             20  AM-EXEC1-NAME             PIC X(15).
  7052             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7053                                                          COMP-3.
  7054             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7055                                                          COMP-3.
  7056         16  AM-EXECUTIVE-TWO.
  7057             20  AM-EXEC2-NAME             PIC X(15).
  7058             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7059                                                          COMP-3.
  7060             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7061                                                          COMP-3.
  7062
  7063     12  AM-RETRO-ADDITIONAL-DATA.
  7064         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7065         16  AM-RETRO-PREM-P-E             PIC X.
  7066         16  AM-RETRO-CLMS-P-I             PIC X.
  7067         16  AM-RETRO-RET-BRACKET-LF.
  7068             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7069                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7070                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7071             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7072                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7073                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7074             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7075                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7076                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7077         16  AM-RETRO-RET-BRACKET-AH.
  7078             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7079                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7080                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7081                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7082             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7083                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7084                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7085             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 130
* EL050.cbl
  7086                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7087                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7088
  7089     12  AM-COMMENTS.
  7090         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7091
  7092     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7093         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7094         16  AM-FLI-BILLING-CODE           PIC X.
  7095         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7096         16  AM-FLI-UNITED-IDENT           PIC X.
  7097         16  AM-FLI-INTEREST-LOST-DATA.
  7098             20  AM-FLI-BANK-NO            PIC X(5).
  7099             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7100             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7101             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7102         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7103             20  AM-FLI-AGT                PIC X(9).
  7104             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7105             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7106         16  FILLER                        PIC X(102).
  7107
  7108     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7109         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7110             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7111             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7112             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7113             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7114             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7115         16  FILLER                          PIC X(10).
  7116******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 131
* EL050.cbl
  7118*    COPY ERCREIN.
  7119******************************************************************
  7120*                                                                *
  7121*                            ERCREIN                             *
  7122*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7123*                            VMOD=2.010                          *
  7124*                                                                *
  7125*   ONLINE CREDIT SYSTEM                                         *
  7126*                                                                *
  7127*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7128*                                                                *
  7129*   FILE TYPE = VSAM,KSDS                                        *
  7130*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7131*                                                                *
  7132*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7133*       ALTERNATE PATH = NONE                                    *
  7134*                                                                *
  7135*   LOG = NO                                                     *
  7136*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7137*                                                                *
  7138******************************************************************
  7139*                   C H A N G E   L O G
  7140*
  7141* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7142*-----------------------------------------------------------------
  7143*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7144* EFFECTIVE    NUMBER
  7145*-----------------------------------------------------------------
  7146* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7147* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7148******************************************************************
  7149 01  REINSURANCE-RECORD.
  7150     12  RE-RECORD-ID                      PIC XX.
  7151         88  VALID-RE-ID                      VALUE 'RE'.
  7152
  7153     12  RE-CONTROL-PRIMARY.
  7154         16  RE-COMPANY-CD                 PIC X.
  7155         16  RE-KEY.
  7156             20  RE-CODE                   PIC X.
  7157                 88  RE-TABLE-RECORD          VALUE 'A'.
  7158                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7159             20  RE-TABLE                  PIC XXX.
  7160             20  FILLER                    PIC XXX.
  7161         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7162             20  FILLER                    PIC X.
  7163             20  RE-COMPANY.
  7164                 24  RE-COMP-PRIME         PIC XXX.
  7165                 24  RE-COMP-SUB           PIC XXX.
  7166
  7167     12  RE-MAINT-INFORMATION.
  7168         16  RE-LAST-MAINT-DT              PIC XX.
  7169         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7170         16  RE-LAST-MAINT-USER            PIC X(4).
  7171         16  FILLER                        PIC X(10).
  7172
  7173     12  RE-TABLE-DATA.
  7174         16  RE-100-COMP                   PIC 99.
  7175
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 132
* EL050.cbl
  7176         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7177             20  RE-REI-COMP-NO.
  7178                 24  RE-REI-COMP           PIC XXX.
  7179                 24  RE-REI-COMP-SUB       PIC XXX.
  7180             20  RE-LF-QC                  PIC X.
  7181             20  RE-AH-QC                  PIC X.
  7182             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7183             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7184             20  RE-LFAGE-LO               PIC 99.
  7185             20  RE-LFAGE-HI               PIC 99.
  7186             20  RE-AHAGE-LO               PIC 99.
  7187             20  RE-AHAGE-HI               PIC 99.
  7188             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7189             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7190             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7191             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7192             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7193             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7194             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7195             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7196             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7197             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7198             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7199             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7200             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7201             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7202             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7203             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7204             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7205             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7206             20  RE-LF-BEN-CODE            PIC X.
  7207             20  RE-AH-BEN-CODE            PIC X.
  7208             20  RE-INTERACTIVE            PIC X.
  7209             20  RE-REMAINING              PIC X.
  7210             20  RE-LF-RUNOFF-SW           PIC X.
  7211             20  RE-AH-RUNOFF-SW           PIC X.
  7212             20  FILLER                    PIC X(19).
  7213
  7214         16  RE-COMP-INFO-END              PIC X(6).
  7215         16  RE-NSP-ST-CD-LF               PIC XX.
  7216         16  RE-NSP-ST-CD-AH               PIC XX.
  7217         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7218             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7219
  7220         16  FILLER                        PIC X(27).
  7221
  7222     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7223         16  RE-NAME                       PIC X(30).
  7224         16  RE-LF-PE                      PIC X.
  7225         16  RE-AH-PE                      PIC X.
  7226         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7227         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7228         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7229         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7230         16  RE-PRT-ST                     PIC X.
  7231         16  RE-PRT-OW                     PIC X.
  7232         16  RE-MORT-CODE                  PIC X(4).
  7233         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 133
* EL050.cbl
  7234         16  RE-ZERO-LF-FEE                PIC X.
  7235         16  RE-ZERO-AH-FEE                PIC X.
  7236         16  RE-CEDE-NAME                  PIC X(30).
  7237         16  RE-LF-COMM                    PIC X.
  7238         16  RE-AH-COMM                    PIC X.
  7239         16  RE-LF-TAX                     PIC X.
  7240         16  RE-AH-TAX                     PIC X.
  7241         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7242         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7243         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7244
  7245         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7246             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7247
  7248         16  RE-LF-CEDING-FEE-BRACKETS.
  7249             20  RE-LF-FEE-METHOD          PIC X.
  7250                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7251                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7252                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7253                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7254             20  RE-LF-FEE-BASIS           PIC X.
  7255                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7256                 88  RE-LF-NET-CEDED               VALUE '2'.
  7257                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7258                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7259                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7260                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7261                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7262                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7263             20  FILLER                    PIC XXX.
  7264             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7265                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7266                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7267
  7268         16  RE-AH-CEDING-FEE-BRACKETS.
  7269             20  RE-AH-FEE-METHOD          PIC X.
  7270                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7271                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7272                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7273                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7274             20  RE-AH-FEE-BASIS           PIC X.
  7275                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7276                 88  RE-AH-NET-CEDED               VALUE '2'.
  7277                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7278                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7279                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7280                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7281                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7282                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7283             20  FILLER                    PIC XXX.
  7284             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7285                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7286                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7287
  7288         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7289
  7290         16  RE-OLD-CEDING-STMT            PIC X.
  7291
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 134
* EL050.cbl
  7292         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7293         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7294         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7295         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7296         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7297         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7298         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7299         16  RE-MORT-SW                    PIC X.
  7300         16  RE-CEDING-TYPE-FLAG           PIC X.
  7301             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7302             88  RE-CEDED                          VALUE 'C'.
  7303             88  RE-ASSUMED                        VALUE 'A'.
  7304             88  RE-PHANTOM                        VALUE 'P'.
  7305
  7306         16  RE-CEDING-STMT-OPT-A          PIC X.
  7307             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7308         16  RE-CEDING-STMT-OPT-B          PIC X.
  7309             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7310         16  RE-CEDING-STMT-OPT-C          PIC X.
  7311             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7312         16  RE-CEDING-STMT-OPT-D          PIC X.
  7313             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7314         16  RE-CEDING-STMT-OPT-E          PIC X.
  7315             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7316
  7317         16  RE-PRT-CRSV                   PIC X.
  7318
  7319         16  RE-GL-CENTER                  PIC X(4).
  7320
  7321         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7322
  7323         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7324
  7325         16  RE-EARN-STOP-CODE             PIC X.
  7326             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7327             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7328
  7329         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7330             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7331
  7332         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7333         16  FILLER                        PIC X(2281).
  7334
  7335         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7336
  7337******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 135
* EL050.cbl
  7339*    COPY ERCCTBL.
  7340******************************************************************
  7341*                                                                *
  7342*                                                                *
  7343*                            ERCCTBL                             *
  7344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7345*                            VMOD=2.003
  7346*                                                                *
  7347*   ONLINE CREDIT SYSTEM                                         *
  7348*                                                                *
  7349*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7350*                                                                *
  7351*   FILE TYPE = VSAM,KSDS                                        *
  7352*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7353*                                                                *
  7354*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7355*       ALTERNATE PATH = NONE                                    *
  7356*                                                                *
  7357*   LOG = NO                                                     *
  7358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7359*                                                                *
  7360*                                                                *
  7361******************************************************************
  7362
  7363 01  COMM-TABLE-RECORD.
  7364     12  CT-RECORD-ID                      PIC XX.
  7365         88  VALID-CT-ID                      VALUE 'CT'.
  7366
  7367     12  CT-CONTROL-PRIMARY.
  7368         16  CT-COMPANY-CD                 PIC X.
  7369         16  CT-TABLE                      PIC XXX.
  7370         16  CT-CNTRL-2.
  7371             20  CT-BEN-TYPE               PIC X.
  7372             20  CT-BEN-CODE               PIC XX.
  7373
  7374     12  CT-MAINT-INFORMATION.
  7375         16  CT-LAST-MAINT-DT              PIC XX.
  7376         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7377         16  CT-LAST-MAINT-USER            PIC X(4).
  7378         16  FILLER                        PIC X(31).
  7379
  7380     12  CT-LIMITS.
  7381         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7382
  7383         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7384
  7385         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7386
  7387     12  CT-RATES.
  7388         16  CT-RTX          OCCURS 27 TIMES.
  7389             20  CT-RT                     PIC SV9(5)     COMP-3.
  7390             20  CT-RT-R   REDEFINES
  7391                 CT-RT                     PIC XXX.
  7392
  7393     12  FILLER                            PIC  X(42).
  7394
  7395******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 136
* EL050.cbl
  7397*    COPY ERCFORM.
  7398******************************************************************
  7399*                                                                *
  7400*                                                                *
  7401*                            ERCFORM.                            *
  7402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7403*                            VMOD=2.003                          *
  7404*                                                                *
  7405*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7406*                                                                *
  7407*    FILE TYPE = VSAM,KSDS                                       *
  7408*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7409*                                                                *
  7410*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7411*                                                                *
  7412*    LOG = YES                                                   *
  7413*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7414******************************************************************
  7415 01  FORM-MASTER.
  7416    12  FO-RECORD-ID                 PIC X(02).
  7417        88  VALID-FO-ID                  VALUE 'FO'.
  7418
  7419    12  FO-CONTROL-PRIMARY.
  7420        16  FO-COMPANY-CD            PIC X(01).
  7421        16  FO-STATE                 PIC X(02).
  7422        16  FO-FORM-ID               PIC X(12).
  7423        16  FO-FORM-EXP-DT           PIC X(02).
  7424
  7425    12  FO-POLICY-FORM-DATA.
  7426        16  FO-IND-GRP-CD            PIC X(01).
  7427        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7428        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7429        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7430        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7431        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7432        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7433        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7434        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7435        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7436        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7437        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7438        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7439        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7440        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7441        16  FO-APP-CERT-USE-CD       PIC X(01).
  7442
  7443    12  FILLER                       PIC X(29).
  7444
  7445    12  FO-FORM-PLAN-TABLE.
  7446        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7447            20  FO-PLAN-TYPE         PIC X(01).
  7448            20  FO-PLAN-ID           PIC X(02).
  7449            20  FO-PLAN-TERM         PIC 9(03).
  7450            20  FO-PLAN-REFUND-METHOD
  7451                                     PIC X.
  7452
  7453    12  FILLER                       PIC X(30).
  7454
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 137
* EL050.cbl
  7455    12  FO-COMMENTS-AREA.
  7456        16  FO-COMMENT-LINE-1        PIC X(78).
  7457
  7458    12  FILLER                       PIC X(20).
  7459
  7460    12  FO-MAINT-INFORMATION.
  7461        16  FO-LAST-MAINT-DT         PIC X(02).
  7462        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7463        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 138
* EL050.cbl
  7465*    COPY ELCMSTR.
  7466******************************************************************
  7467*                                                                *
  7468*                            ELCMSTR.                            *
  7469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7470*                            VMOD=2.012                          *
  7471*                                                                *
  7472*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7473*                                                                *
  7474*   FILE TYPE = VSAM,KSDS                                        *
  7475*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7476*                                                                *
  7477*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7478*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7479*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7480*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7481*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7482*                                                 RKP=75,LEN=21  *
  7483*                                                                *
  7484*   **** NOTE ****                                               *
  7485*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7486*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7487*                                                                *
  7488*   LOG = YES                                                    *
  7489*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7490******************************************************************
  7491*                   C H A N G E   L O G
  7492*
  7493* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7494*-----------------------------------------------------------------
  7495*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7496* EFFECTIVE    NUMBER
  7497*-----------------------------------------------------------------
  7498* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7499* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7500* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7501* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7502* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7503* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7504******************************************************************
  7505 01  CLAIM-MASTER.
  7506     12  CL-RECORD-ID                PIC XX.
  7507         88  VALID-CL-ID         VALUE 'CL'.
  7508
  7509     12  CL-CONTROL-PRIMARY.
  7510         16  CL-COMPANY-CD           PIC X.
  7511         16  CL-CARRIER              PIC X.
  7512         16  CL-CLAIM-NO             PIC X(7).
  7513         16  CL-CERT-NO.
  7514             20  CL-CERT-PRIME       PIC X(10).
  7515             20  CL-CERT-SFX         PIC X.
  7516
  7517     12  CL-CONTROL-BY-NAME.
  7518         16  CL-COMPANY-CD-A1        PIC X.
  7519         16  CL-INSURED-LAST-NAME    PIC X(15).
  7520         16  CL-INSURED-NAME.
  7521             20  CL-INSURED-1ST-NAME PIC X(12).
  7522             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 139
* EL050.cbl
  7523
  7524     12  CL-CONTROL-BY-SSN.
  7525         16  CL-COMPANY-CD-A2        PIC X.
  7526         16  CL-SOC-SEC-NO.
  7527             20  CL-SSN-STATE        PIC XX.
  7528             20  CL-SSN-ACCOUNT      PIC X(6).
  7529             20  CL-SSN-LN3          PIC X(3).
  7530
  7531     12  CL-CONTROL-BY-CERT-NO.
  7532         16  CL-COMPANY-CD-A4        PIC X.
  7533         16  CL-CERT-NO-A4.
  7534             20  CL-CERT-A4-PRIME    PIC X(10).
  7535             20  CL-CERT-A4-SFX      PIC X.
  7536
  7537     12  CL-CONTROL-BY-CCN.
  7538         16  CL-COMPANY-CD-A5        PIC X.
  7539         16  CL-CCN-A5.
  7540             20  CL-CCN.
  7541                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7542                 24  CL-CCN-PRIME-A5 PIC X(12).
  7543             20  CL-CCN-FILLER-A5    PIC X(4).
  7544
  7545     12  CL-INSURED-PROFILE-DATA.
  7546         16  CL-INSURED-BIRTH-DT     PIC XX.
  7547         16  CL-INSURED-SEX-CD       PIC X.
  7548             88  INSURED-IS-MALE        VALUE 'M'.
  7549             88  INSURED-IS-FEMALE      VALUE 'F'.
  7550             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7551         16  CL-INSURED-OCC-CD       PIC X(6).
  7552         16  FILLER                  PIC X(5).
  7553
  7554     12  CL-PROCESSING-INFO.
  7555         16  CL-PROCESSOR-ID         PIC X(4).
  7556         16  CL-CLAIM-STATUS         PIC X.
  7557             88  CLAIM-IS-OPEN          VALUE 'O'.
  7558             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7559         16  CL-CLAIM-TYPE           PIC X.
  7560*            88  AH-CLAIM               VALUE 'A'.
  7561*            88  LIFE-CLAIM             VALUE 'L'.
  7562*            88  PROPERTY-CLAIM         VALUE 'P'.
  7563*            88  IUI-CLAIM              VALUE 'I'.
  7564*            88  GAP-CLAIM              VALUE 'G'.
  7565*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7566         16  CL-CLAIM-PREM-TYPE      PIC X.
  7567             88  SINGLE-PREMIUM         VALUE '1'.
  7568             88  O-B-COVERAGE           VALUE '2'.
  7569             88  OPEN-END-COVERAGE      VALUE '3'.
  7570         16  CL-INCURRED-DT          PIC XX.
  7571         16  CL-REPORTED-DT          PIC XX.
  7572         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7573         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7574         16  CL-LAST-PMT-DT          PIC XX.
  7575         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7576         16  CL-PAID-THRU-DT         PIC XX.
  7577         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7578         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7579         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7580         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 140
* EL050.cbl
  7581             88  CL-360-DAY-YR          VALUE '1'.
  7582             88  CL-365-DAY-YR          VALUE '2'.
  7583             88  CL-FULL-MONTHS         VALUE '3'.
  7584         16  CL-CAUSE-CD             PIC X(6).
  7585
  7586         16  CL-PRIME-CERT-NO.
  7587             20  CL-PRIME-CERT-PRIME PIC X(10).
  7588             20  CL-PRIME-CERT-SFX   PIC X.
  7589
  7590         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7591             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7592             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7593
  7594         16  CL-MICROFILM-NO         PIC X(10).
  7595         16  FILLER REDEFINES CL-MICROFILM-NO.
  7596             20  CL-BENEFIT-PERIOD   PIC 99.
  7597             20  FILLER              PIC X(8).
  7598         16  CL-PROG-FORM-TYPE       PIC X.
  7599         16  CL-LAST-ADD-ON-DT       PIC XX.
  7600
  7601         16  CL-LAST-REOPEN-DT       PIC XX.
  7602         16  CL-LAST-CLOSE-DT        PIC XX.
  7603         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7604             88  FINAL-PAID             VALUE '1'.
  7605             88  CLAIM-DENIED           VALUE '2'.
  7606             88  AUTO-CLOSE             VALUE '3'.
  7607             88  MANUAL-CLOSE           VALUE '4'.
  7608             88  BENEFITS-CHANGED       VALUE 'C'.
  7609             88  SETUP-ERRORS           VALUE 'E'.
  7610         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7611         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7612         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7613             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7614         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7615         16  FILLER                  PIC X.
  7616
  7617     12  CL-CERTIFICATE-DATA.
  7618         16  CL-CERT-ORIGIN          PIC X.
  7619             88  CERT-WAS-ONLINE        VALUE '1'.
  7620             88  CERT-WAS-CREATED       VALUE '2'.
  7621             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7622         16  CL-CERT-KEY-DATA.
  7623             20  CL-CERT-CARRIER     PIC X.
  7624             20  CL-CERT-GROUPING    PIC X(6).
  7625             20  CL-CERT-STATE       PIC XX.
  7626             20  CL-CERT-ACCOUNT.
  7627                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7628                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7629             20  CL-CERT-EFF-DT      PIC XX.
  7630
  7631     12  CL-STATUS-CONTROLS.
  7632         16  CL-PRIORITY-CD          PIC X.
  7633             88  CONFIDENTIAL-DATA      VALUE '8'.
  7634             88  HIGHEST-PRIORITY       VALUE '9'.
  7635         16  CL-SUPV-ATTN-CD         PIC X.
  7636             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7637             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7638         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 141
* EL050.cbl
  7639         16  CL-RESTORED-DT          PIC XX.
  7640         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7641         16  CL-NEXT-RESEND-DT       PIC XX.
  7642         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7643         16  CL-CRITICAL-PERIOD      PIC 99.
  7644*        16  FILLER                  PIC XX.
  7645         16  CL-LAST-MAINT-DT        PIC XX.
  7646         16  CL-LAST-MAINT-USER      PIC X(4).
  7647         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7648         16  CL-LAST-MAINT-TYPE      PIC X.
  7649             88  CLAIM-SET-UP           VALUE ' '.
  7650             88  PAYMENT-MADE           VALUE '1'.
  7651             88  LETTER-SENT            VALUE '2'.
  7652             88  MASTER-WAS-ALTERED     VALUE '3'.
  7653             88  MASTER-WAS-RESTORED    VALUE '4'.
  7654             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7655             88  FILE-CONVERTED         VALUE '6'.
  7656             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7657             88  ERROR-CORRECTION       VALUE 'E'.
  7658         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7659         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7660         16  CL-BENEFICIARY          PIC X(10).
  7661         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7662         16  CL-DENIAL-TYPE          PIC X.
  7663             88  CL-TYPE-DENIAL          VALUE '1'.
  7664             88  CL-TYPE-RESCISSION      VALUE '2'.
  7665             88  CL-TYPE-REFORMATION     VALUE '3'.
  7666             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7667             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7668         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7669         16  filler                  pic x(3).
  7670*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7671*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7672*        16  CL-RTW-DT               PIC XX.
  7673
  7674     12  CL-TRAILER-CONTROLS.
  7675         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7676             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7677             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7678             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7679         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7680         16  FILLER                  PIC XX.
  7681         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7682         16  CL-ADDRESS-TRAILER-CNT.
  7683             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7684                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7685             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7686                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7687             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7688                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7689             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7690                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7691             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7692                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7693             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7694                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7695             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7696                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 142
* EL050.cbl
  7697
  7698     12  CL-CV-REFERENCE-NO.
  7699         16  CL-CV-REFNO-PRIME       PIC X(18).
  7700         16  CL-CV-REFNO-SFX         PIC XX.
  7701
  7702     12  CL-FILE-LOCATION            PIC X(4).
  7703
  7704     12  CL-PROCESS-ERRORS.
  7705         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7706             88  NO-FATAL-ERRORS        VALUE ZERO.
  7707         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7708             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7709
  7710     12  CL-PRODUCT-CD               PIC X.
  7711
  7712     12  CL-CURRENT-KEY-DATA.
  7713         16  CL-CURRENT-CARRIER      PIC X.
  7714         16  CL-CURRENT-GROUPING     PIC X(6).
  7715         16  CL-CURRENT-STATE        PIC XX.
  7716         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7717
  7718     12  CL-ASSOCIATES               PIC X.
  7719         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7720         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7721         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7722         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7723
  7724     12  CL-ACTIVITY-CODE            PIC 99.
  7725     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7726     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7727
  7728     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7729     12  CL-LAG-REPORT-CODE          PIC 9.
  7730     12  CL-LOAN-TYPE                PIC XX.
  7731     12  CL-LEGAL-STATE              PIC XX.
  7732
  7733     12  CL-YESNOSW                  PIC X.
  7734     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7735         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7736         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7737         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7738     12  cl-insured-type             pic x.
  7739         88  cl-claim-on-primary         value 'P'.
  7740         88  cl-claim-on-co-borrower     value 'C'.
  7741     12  cl-benefit-expiration-dt    PIC XX.
  7742
  7743 01  PLAN-RECORDS.
  7744     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7745     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7746
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 143
* EL050.cbl
  7748 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7749                          ACCOUNT-MASTER REINSURANCE-RECORD
  7750                          COMM-TABLE-RECORD FORM-MASTER
  7751                          CLAIM-MASTER PLAN-RECORDS.
  7752 0000-DFHEXIT SECTION.
  7753     MOVE '9#                    $   ' TO DFHEIV0.
  7754     MOVE 'EL050' TO DFHEIV1.
  7755     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7756
  7757     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7758
  7759
  7760* EXEC CICS  HANDLE CONDITION
  7761*           ERROR    (9300-ABEND)
  7762*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7763*    END-EXEC.
  7764*    MOVE '"$.J                  ! " #00007755' TO DFHEIV0
  7765     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7767     MOVE X'2220233030303037373535' TO DFHEIV0(25:11)
  7768     CALL 'kxdfhei1' USING DFHEIV0
  7769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7770
  7771
  7772 0000-COPY-PROCEDURE-DIV.
  7773*                          COPY ELC50PD.
  7774******************************************************************
  7775*                                                                *
  7776*                            ELC50PD                             *
  7777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7778*                            VMOD=2.188                          *
  7779*                                                                *
  7780******************************************************************
  7781*                   C H A N G E   L O G
  7782*
  7783* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7784*-----------------------------------------------------------------
  7785*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7786* EFFECTIVE    NUMBER
  7787*-----------------------------------------------------------------
  7788* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7789* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7790* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7791*                             2709 AND 2718
  7792* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7793* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7794* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7795* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7796* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7797*                                IS OPEN OR CNC DT < PD THRU
  7798* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7799* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7800* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7801* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7802* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7803* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7804* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7805* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 144
* EL050.cbl
  7806* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7807* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7808* 020906                   PEMA  EXPAND LOAN OFFICER
  7809* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7810* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7811* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7812* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7813* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7814* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7815* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7816* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7817* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7818* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7819* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7820* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7821* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7822* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7823* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7824* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7825* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7826* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7827* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7828* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7829* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7830* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7831* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7832* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7833* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7834*                                UPDATE VIN ON CERT TRAILER
  7835* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7836* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7837* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7838* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7839* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7840* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7841* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7842* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7843* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7844* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7845* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7846* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7847* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7848* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7849* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7850* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7851* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7852* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7853* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7854* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7855* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7856* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7857* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7858* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7859* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7860* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7861* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7862* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7863* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 145
* EL050.cbl
  7864* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7865* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7866* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7867* 032912  CR2011110200001  PEMA  AHL CHANGES
  7868* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7869* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7870* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7871* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7872* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7873* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7874* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7875* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7876* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7877* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7878* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7879* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7880* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7881* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7882* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7883* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7884* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7885* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7886* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7887* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7888* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7889* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7890* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7891* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7892* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7893* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7894* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7895*                                CERT #, ADD 2898 FORCIBLE ERROR
  7896* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7897* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7898* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7899* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7900* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7901* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7902* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7903* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7904* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7905* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7906* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7907* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7908* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7909* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7910* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7911* 100617  CR2017062000003  PEMA  New comm cap edits
  7912* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7913* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7914******************************************************************
  7915************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7916******************************************************************
  7917
  7918     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7919
  7920     MOVE SPACES                 TO PB-FATAL-FLAG
  7921                                    PB-FORCE-ER-CD
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 146
* EL050.cbl
  7922                                    PB-WARN-ER-CD
  7923                                    PB-OUT-BAL-CD.
  7924
  7925     MOVE SPACE                  TO WS-IG-OVRD-AH
  7926                                    WS-IG-OVRD-LF
  7927                                    WS-IG-OVRD-AM
  7928                                    WS-IG-OVRD
  7929                                    WS-IG-OVRD-AH-PL
  7930                                    WS-IG-OVRD-LF-PL
  7931                                    WS-IG-OVRD-AH-BEN
  7932                                    WS-IG-OVRD-LF-BEN.
  7933
  7934******************************************************************
  7935*************       INITIALIZE COMMON ERRORS       ***************
  7936******************************************************************
  7937
  7938     MOVE +0                     TO PB-NO-OF-ERRORS.
  7939     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7940
  7941******************************************************************
  7942
  7943     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7944     SET JULIAN-TO-BIN           TO TRUE.
  7945*    MOVE 5                      TO DC-OPTION-CODE.
  7946     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7947     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7948
  7949     MOVE ZERO                   TO  SUB4.
  7950
  7951 0040-INITIALIZE-GA-BILL-DT.
  7952
  7953     ADD +1                      TO  SUB4.
  7954
  7955     IF  SUB4 GREATER THAN +5
  7956         GO TO 0050-CHECK-CNTL-FOUND.
  7957
  7958     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7959         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7960
  7961     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7962
  7963 0050-CHECK-CNTL-FOUND.
  7964
  7965     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7966        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7967                                         WS-AH-REM-TERM-CALC
  7968                                         EC-CO-REM-TERM-CALC
  7969        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7970        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7971        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7972                                         WS-TOL-AH-CLAIM
  7973        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7974                                         WS-TOL-AH-PREM
  7975                                         EC-CO-TOL-PREM
  7976        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7977                                         WS-TOL-AH-REFUND
  7978                                         EC-CO-TOL-REFUND
  7979        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 147
* EL050.cbl
  7980                                         WS-AH-REFUND-OVS-AMT
  7981                                         EC-CO-OVR-SHT-AMT
  7982        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7983                                         WS-TOL-AH-PREM-PCT
  7984                                         EC-CO-TOL-PREM-PCT
  7985        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7986                                         WS-TOL-AH-REFUND-PCT
  7987                                         EC-CO-TOL-REFUND-PCT
  7988        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7989                                         WS-AH-REFUND-OVS-PCT
  7990                                         EC-CO-OVR-SHT-PCT
  7991        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7992        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7993        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7994        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7995        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7996        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7997        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7998        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7999        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8000        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8001        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8002        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8003                                         EC-CO-MONTH-END-DT
  8004        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8005          GO TO 0100-READ-ACCT.
  8006
  8007     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8008     MOVE SPACES                 TO CNTL-ACCESS.
  8009     MOVE '1'                    TO CNTL-REC-TYPE.
  8010     MOVE +0                     TO CNTL-SEQ-NO.
  8011
  8012     MOVE '1' TO RC-SW-1.
  8013     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8014     IF NOT CF-COMPANY-MASTER
  8015         MOVE ZEROS             TO WK-CO-TOL-PREM
  8016                                   WK-CO-TOL-CLAIM
  8017                                   WK-CO-TOL-REFUND
  8018                                   WK-REFUND-OVS-AMT
  8019                                   WK-REFUND-OVS-PCT
  8020                                   WK-CO-TOL-PREM-PCT
  8021                                   WK-CO-TOL-REFUND-PCT
  8022                                   WK-DEFAULT-APR
  8023                                   WK-CO-MAX-CAP
  8024        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8025                                   WK-CR-R78-METHOD
  8026                                   WK-CO-REF-REJECT-SW
  8027                                   WK-CO-PREM-REJECT-SW
  8028                                   WK-REM-TRM-CALC-OPTION
  8029                                   WK-BIRTH-DATE-INPUT
  8030                                   WK-JOINT-AGE-INPUT
  8031        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8032        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8033        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8034        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8035          GO TO 0099-COMPANY-NOT-FOUND.
  8036
  8037     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 148
* EL050.cbl
  8038        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8039     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8040        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8041     IF CF-CO-TOL-CAP NOT NUMERIC
  8042        MOVE +0                    TO CF-CO-TOL-CAP.
  8043     IF CF-DEFAULT-APR NOT NUMERIC
  8044        MOVE +0                    TO CF-DEFAULT-APR.
  8045
  8046     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8047     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8048     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8049     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8050     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8051     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8052     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8053     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8054     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8055     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8056     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8057     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8058
  8059     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8060          CF-CO-OVR-SHT-AMT > +0
  8061        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8062
  8063     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8064          CF-CO-OVR-SHT-PCT > +0
  8065        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8066
  8067     IF CF-VALID-REM-TRM-OPTION
  8068         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8069     ELSE
  8070         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8071
  8072     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8073     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8074     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8075     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8076
  8077     GO TO 0050-CHECK-CNTL-FOUND.
  8078
  8079 0099-COMPANY-NOT-FOUND.
  8080
  8081     MOVE ER-2616                TO WS-ERROR.
  8082     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8083
  8084 0100-READ-ACCT.
  8085
  8086     MOVE SPACES                 TO DATE-RANGE-SW.
  8087
  8088     IF WK-ACCT-ADDR = ZEROS
  8089        GO TO 0102-ACCT-GETMAIN.
  8090
  8091     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8092     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8093     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8094
  8095     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 149
* EL050.cbl
  8096        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8097        GO TO 0105-READ-ACCT
  8098     END-IF
  8099
  8100     IF PB-CARRIER NOT = SPACES
  8101        IF PB-CARRIER NOT = AM-VG-CARRIER
  8102           GO TO 0105-READ-ACCT.
  8103
  8104     IF PB-STATE NOT = SPACES
  8105        IF PB-STATE NOT = AM-VG-STATE
  8106           GO TO 0105-READ-ACCT.
  8107
  8108     IF PB-GROUPING NOT = SPACES
  8109        IF PB-GROUPING NOT = AM-VG-GROUPING
  8110           GO TO 0105-READ-ACCT.
  8111
  8112     MOVE 'X'                 TO DATE-RANGE-SW.
  8113
  8114     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8115        MOVE 'X'                 TO DATE-RANGE-SW
  8116        GO TO 0105-READ-ACCT.
  8117
  8118     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8119        GO TO 0105-READ-ACCT.
  8120
  8121     GO TO 0180-ACCOUNT-FOUND.
  8122
  8123 0102-ACCT-GETMAIN.
  8124     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8125     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8126
  8127 0105-READ-ACCT.
  8128     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8129     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8130     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8131     MOVE PB-STATE               TO ACCT-STATE.
  8132     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8133     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8134
  8135     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8136
  8137     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8138
  8139 0110-FIND-ACCT-TOLERANCES-LOOP.
  8140     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8141
  8142     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8143        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8144        GO TO 0199-ACCT-NOT-FOUND
  8145     END-IF
  8146     IF PB-CARRIER NOT = SPACES
  8147        IF PB-CARRIER NOT = AM-VG-CARRIER
  8148           GO TO 0199-ACCT-NOT-FOUND.
  8149
  8150     IF PB-STATE NOT = SPACES
  8151        IF PB-STATE NOT = AM-VG-STATE
  8152           GO TO 0199-ACCT-NOT-FOUND.
  8153
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 150
* EL050.cbl
  8154     IF PB-GROUPING NOT = SPACES
  8155        IF PB-GROUPING NOT = AM-VG-GROUPING
  8156           GO TO 0199-ACCT-NOT-FOUND.
  8157
  8158     MOVE 'X'                    TO DATE-RANGE-SW.
  8159
  8160     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8161        MOVE 'X'                 TO DATE-RANGE-SW
  8162        GO TO 0199-ACCT-NOT-FOUND.
  8163
  8164     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8165        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8166
  8167 0180-ACCOUNT-FOUND.
  8168     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8169     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8170     MOVE AM-STATE               TO PB-SV-STATE.
  8171     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8172
  8173     IF AM-CANCEL-FEE  NOT NUMERIC
  8174        MOVE ZEROS TO AM-CANCEL-FEE.
  8175
  8176     IF AM-MAX-MON-BEN NOT NUMERIC
  8177        MOVE ZEROS TO AM-MAX-MON-BEN.
  8178
  8179     IF AM-MAX-TOT-BEN NOT NUMERIC
  8180        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8181
  8182     IF AM-CLP-TOL-PCT NOT NUMERIC
  8183        MOVE +0                  TO AM-CLP-TOL-PCT
  8184     END-IF
  8185     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8186        MOVE +0                  TO AM-SPP-LEASE-COMM
  8187     END-IF
  8188     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8189        MOVE ER-2611             TO   WS-ERROR
  8190        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8191
  8192     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8193        MOVE ER-2621             TO   WS-ERROR
  8194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8195
  8196     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8197        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8198        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8199        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8200         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8201
  8202     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8203     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8204     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8205     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8206     IF AM-CLP-TOL-PCT NOT = ZEROS
  8207        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8208     END-IF
  8209     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8210        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8211     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 151
* EL050.cbl
  8212*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8213*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8214*                                   WS-ADMIN-FEES
  8215*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8216*          (SUB5 > +10)
  8217*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8218*             AND (AM-A-COM (SUB5) NUMERIC)
  8219*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8220*                + (AM-A-COM (SUB5) * 1000)
  8221*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8222*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8223*                + (AM-A-COM (SUB5) * 1000)
  8224*             END-IF
  8225*             IF AM-COM-TYP (SUB5) = 'N'
  8226*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8227*                + (AM-A-COM (SUB5) * 1000)
  8228*             END-IF
  8229*          END-IF
  8230*       END-PERFORM
  8231*    END-IF
  8232     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8233        AND (PB-ISSUE)
  8234        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8235                                    ws-cred-union-fees
  8236        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8237           (SUB5 > +10)
  8238           MOVE +0 TO WS-WK-RATE
  8239           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8240                                   'O' OR 'S')
  8241              IF (AM-A-COM (SUB5) NUMERIC)
  8242                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8243                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8244              ELSE
  8245                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8246                 IF PB-ISSUE
  8247                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8248                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8249                 ELSE
  8250                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8251                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8252                 END-IF
  8253                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8254                 MOVE ZEROS             TO WS-SUB1
  8255                                           WS-COMMISSION
  8256                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8257                 MOVE '0530'               TO CTBL-SW
  8258                 MOVE ' '                  TO WS-CTBL-READ-SW
  8259                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8260                 IF FIRST-TIME-THROUGH
  8261                    MOVE 'AA'              TO CTBL-BEN-CODE
  8262                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8263                 END-IF
  8264                 IF CTBL-TABLE-FOUND
  8265                    IF PB-ISSUE
  8266                       COMPUTE WS-COMM-CK-AMT =
  8267                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8268                    ELSE
  8269                       COMPUTE WS-COMM-CK-AMT =
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 152
* EL050.cbl
  8270                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8271                    END-IF
  8272                    PERFORM 8800-GET-COMP-RATE
  8273                              THRU 8800-EXIT
  8274                 END-IF
  8275              END-IF
  8276              if am-com-typ (sub5) = 'O' or 'S'
  8277                 compute ws-cred-union-fees rounded =
  8278                    ws-cred-union-fees +
  8279                    (pb-i-ah-premium-amt * ws-wk-rate)
  8280              else
  8281                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8282                + (WS-WK-RATE * 1000)
  8283              end-if
  8284           END-IF
  8285        END-PERFORM
  8286     END-IF
  8287     IF PB-COMPANY-ID EQUAL 'CRI'
  8288         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8289
  8290     IF PB-COMPANY-ID EQUAL 'NCL'
  8291         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8292     END-IF
  8293
  8294     GO TO 0200-READ-CERT.
  8295
  8296 0199-ACCT-NOT-FOUND.
  8297
  8298     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8299
  8300     IF DATE-RANGE-SW NOT = SPACES
  8301        MOVE ER-2601             TO WS-ERROR
  8302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8303     ELSE
  8304        MOVE ER-2619             TO WS-ERROR
  8305        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8306
  8307     GO TO 9990-RETURN.
  8308
  8309 0200-READ-CERT.
  8310
  8311     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8312     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8313     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8314     MOVE PB-SV-STATE            TO CERT-STATE.
  8315     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8316     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8317     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8318
  8319     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8320
  8321     IF CERT-WAS-NOT-FOUND
  8322        GO TO 0299-CERT-NOT-FOUND.
  8323
  8324     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8325        MOVE ER-2759             TO WS-ERROR
  8326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8327        GO TO 0298-UNLOCK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 153
* EL050.cbl
  8328
  8329     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8330         MOVE ER-2758            TO WS-ERROR
  8331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8332         GO TO 0298-UNLOCK-RETURN.
  8333
  8334     IF PB-ISSUE
  8335        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8336           IF CERT-WAS-CREATED-FOR-CLAIM
  8337              NEXT SENTENCE
  8338            ELSE
  8339              MOVE ER-2626       TO WS-ERROR
  8340              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8341              GO TO 0298-UNLOCK-RETURN.
  8342
  8343     IF NOT PB-CANCELLATION
  8344        GO TO 0300-CONTINUE-EDIT.
  8345
  8346     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8347     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8348     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8349     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8350     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8351     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8352
  8353     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8354     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8355     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8356     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8357     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8358     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8359     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8360     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8361     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8362
  8363     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8364     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8365     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8366     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8367     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8368     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8369     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8370
  8371     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8372     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8373
  8374     MOVE CM-CREDIT-INTERFACE-SW-1
  8375                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8376     MOVE CM-CREDIT-INTERFACE-SW-2
  8377                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8378
  8379     IF CM-O-B-COVERAGE
  8380         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8381
  8382     IF CM-LIVES NOT NUMERIC
  8383         MOVE ZERO                TO CM-LIVES.
  8384
  8385     IF CM-BILLED NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 154
* EL050.cbl
  8386         MOVE ZERO                TO CM-BILLED.
  8387
  8388     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8389         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8390         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8391         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8392         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8393         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8394         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8395         MOVE CM-LIVES             TO PB-CI-LIVES
  8396*The next line causes a problem with my change  I dont think it is
  8397*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8398
  8399     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8400     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8401     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8402     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8403     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8404     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8405
  8406     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8407     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8408     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8409     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8410
  8411     IF CM-LIFE-COMM-PCT NUMERIC
  8412         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8413     ELSE
  8414         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8415
  8416     IF CM-AH-COMM-PCT NUMERIC
  8417         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8418     ELSE
  8419         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8420
  8421     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8422
  8423     IF CM-LOAN-APR       NOT NUMERIC
  8424           MOVE ZERO               TO CM-LOAN-APR.
  8425
  8426     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8427           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8428
  8429     IF CM-LOAN-TERM      NOT NUMERIC
  8430           MOVE ZERO               TO CM-LOAN-TERM.
  8431
  8432     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8433           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8434
  8435     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8436           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8437
  8438     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8439     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8440     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8441     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8442     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8443     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 155
* EL050.cbl
  8444     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8445     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8446     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8447     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8448     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8449     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8450
  8451     IF CM-STATE = CM-SSN-STATE
  8452         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8453
  8454     IF CM-STATE NOT = CM-MEMB-STATE
  8455         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8456
  8457     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8458
  8459     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8460        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8461        IF CM-ADDL-CLP NOT NUMERIC
  8462           MOVE +0               TO CM-ADDL-CLP
  8463        END-IF
  8464        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8465        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8466           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8467        END-IF
  8468     END-IF
  8469     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8470        MOVE +0                  TO WS-ADMIN-FEES
  8471                                    WS-CSO-ADMIN-FEE
  8472                                    WS-COMM-AND-MFEE
  8473                                    WS-1ST-YR-ALLOW
  8474        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8475           (SUB5 > +10)
  8476           MOVE +0 TO WS-WK-RATE
  8477           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8478              IF (AM-A-COM (SUB5) NUMERIC)
  8479                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8480                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8481              ELSE
  8482                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8483                 IF PB-ISSUE
  8484                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8485                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8486                 ELSE
  8487                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8488                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8489                 END-IF
  8490                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8491                 MOVE ZEROS             TO WS-SUB1
  8492                                           WS-COMMISSION
  8493                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8494                 MOVE '0530'               TO CTBL-SW
  8495                 MOVE ' '                  TO WS-CTBL-READ-SW
  8496                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8497                 IF FIRST-TIME-THROUGH
  8498                    MOVE 'AA'              TO CTBL-BEN-CODE
  8499                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8500                 END-IF
  8501                 IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 156
* EL050.cbl
  8502                    IF PB-ISSUE
  8503                       COMPUTE WS-COMM-CK-AMT =
  8504                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8505                    ELSE
  8506                       COMPUTE WS-COMM-CK-AMT =
  8507                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8508                    END-IF
  8509                    PERFORM 8800-GET-COMP-RATE
  8510                              THRU 8800-EXIT
  8511                 END-IF
  8512              END-IF
  8513              IF AM-COM-TYP (SUB5) = 'I'
  8514                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8515                   + (WS-WK-RATE * 1000)
  8516              END-IF
  8517              IF AM-COM-TYP (SUB5) = 'N'
  8518                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8519                   + (WS-WK-RATE * 1000)
  8520              END-IF
  8521              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8522                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8523                   + (WS-WK-RATE * 1000)
  8524              END-IF
  8525              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8526                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8527                   + (WS-WK-RATE * 1000)
  8528              END-IF
  8529           END-IF
  8530        END-PERFORM
  8531     END-IF
  8532     GO TO 0300-CONTINUE-EDIT.
  8533
  8534 0298-UNLOCK-RETURN.
  8535      PERFORM 9250-UNLOCK-RETURN
  8536      GO TO 9990-RETURN.
  8537
  8538 0299-CERT-NOT-FOUND.
  8539
  8540     MOVE '1'                     TO CERT-STATUS-SW.
  8541
  8542     IF PB-COMPANY-ID = 'UCL'
  8543         IF WS-ERROR = ER-2799
  8544             GO TO 3000-CONTINUE-EDIT.
  8545
  8546     IF NOT PB-CANCELLATION
  8547         GO TO 0300-CONTINUE-EDIT.
  8548
  8549     MOVE ER-2726                  TO  WS-ERROR.
  8550     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8551     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8552     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8553                                    PB-CI-LF-TERM
  8554                                    PB-C-LF-REM-TERM
  8555                                    PB-CI-AH-TERM
  8556                                    PB-C-AH-REM-TERM
  8557                                    PB-CI-LF-BENEFIT-CD
  8558                                    PB-CI-LF-BENEFIT-AMT
  8559                                    PB-CI-LF-ALT-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 157
* EL050.cbl
  8560                                    PB-CI-LF-PREMIUM-AMT
  8561                                    PB-CI-LF-ALT-PREMIUM-AMT
  8562                                    PB-CI-AH-BENEFIT-CD
  8563                                    PB-CI-AH-BENEFIT-AMT
  8564                                    PB-CI-AH-PREMIUM-AMT
  8565                                    PB-CI-PAY-FREQUENCY
  8566                                    PB-CI-LOAN-APR
  8567                                    PB-CI-LOAN-TERM
  8568                                    PB-CI-LIFE-COMMISSION
  8569                                    PB-CI-AH-COMMISSION
  8570                                    PB-CI-CURR-SEQ
  8571                                    PB-CI-AH-CANCEL-AMT
  8572                                    PB-CI-LF-CANCEL-AMT
  8573                                    PB-CI-RATE-DEV-PCT-LF
  8574                                    PB-CI-RATE-DEV-PCT-AH
  8575                                    PB-CI-EXTENTION-DAYS
  8576                                    PB-CI-TERM-IN-DAYS
  8577                                    PB-CI-LIVES
  8578                                    PB-CI-LF-CRIT-PER
  8579                                    PB-CI-AH-CRIT-PER
  8580                                    PB-CI-ADDL-CLP
  8581                                    PB-CI-DDF-IU-RATE-UP.
  8582
  8583     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8584                                    PB-CI-AH-SETTLEMENT-DT
  8585                                    PB-CI-DEATH-DT
  8586                                    PB-CI-LF-PRIOR-CANCEL-DT
  8587                                    PB-CI-AH-PRIOR-CANCEL-DT
  8588                                    PB-CI-ENTRY-DT
  8589                                    PB-CI-LF-EXPIRE-DT
  8590                                    PB-CI-AH-EXPIRE-DT
  8591                                    PB-CI-LOAN-1ST-PMT-DT.
  8592
  8593     IF ACCOUNT-MAST-FOUND
  8594        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8595        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8596
  8597
  8598 0300-CONTINUE-EDIT.
  8599
  8600     IF PB-ISSUE
  8601        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8602            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8603
  8604     IF PB-ISSUE
  8605        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8606            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8607
  8608     IF PB-ISSUE
  8609       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8610          (AM-NO-AH-ONLY)
  8611           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8612               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8613                   MOVE ER-2679 TO WS-ERROR
  8614                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8615
  8616     IF PB-ISSUE
  8617        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 158
* EL050.cbl
  8618        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8619        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8620     ELSE
  8621        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8622        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8623        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8624
  8625     MOVE 'N'                    TO PLAN-MASTER-SW
  8626                                    PLAN-MASTER-LIFE-SW
  8627                                    FORM-MASTER-SW
  8628                                    WS-APP-CERT-SW.
  8629
  8630     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8631                                    WS-PL-TOL-LF-REFUND
  8632                                    WS-PL-REF-OVS-AMT
  8633                                    WS-PL-TOL-LF-PREM-PCT
  8634                                    WS-PL-TOL-LF-REFUND-PCT
  8635                                    WS-PL-REF-OVS-PCT
  8636                                    WS-PL-TOL-LF-CLAIM.
  8637
  8638     IF PB-COMPANY-ID = 'NCL'
  8639       IF PB-ISSUE
  8640         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8641             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8642             IF FORM-MASTER-FOUND
  8643                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8644
  8645     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8646        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8647
  8648********************** MON CODE **********************
  8649     IF PB-COMPANY-ID = 'MON'
  8650     IF PB-ISSUE
  8651     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8652        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8653             PB-I-LOAN-APR = ZERO)
  8654               MOVE 14.0         TO PB-I-LOAN-APR.
  8655******************************************************
  8656
  8657     IF PB-COMPANY-ID = 'NCL'
  8658       IF PB-ISSUE
  8659           IF FORM-MASTER-FOUND
  8660             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8661                AM-DISMBR-COVERAGE
  8662                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8663                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8664                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8665                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8666                                           PB-I-LIFE-BENEFIT-CD.
  8667
  8668     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8669
  8670     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8671         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8672         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8673         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8674         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8675         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 159
* EL050.cbl
  8676           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8677             GO TO 0301-LIFE-BENEFIT-SEARCH
  8678         ELSE
  8679             NEXT SENTENCE
  8680     ELSE
  8681         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8682
  8683     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8684     MOVE '4'                    TO CNTL-REC-TYPE.
  8685     MOVE +0                     TO CNTL-SEQ-NO.
  8686     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8687
  8688     MOVE '1' TO RC-SW-2.
  8689     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8690
  8691     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8692        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8693         GO TO 0305-BENEFIT-NOT-FOUND.
  8694
  8695     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8696
  8697 0301-LIFE-BENEFIT-SEARCH.
  8698
  8699     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8700
  8701     IF NO-BENEFIT-FOUND
  8702        GO TO 0305-BENEFIT-NOT-FOUND.
  8703
  8704     IF WS-BEN-CD = '99'
  8705        GO TO 0305-BENEFIT-NOT-FOUND.
  8706
  8707     IF PB-COMPANY-ID = 'NCL'
  8708         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8709             GO TO 0304-LIFE-BENEFIT-FOUND.
  8710
  8711     MOVE +1                     TO SUB5.
  8712     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8713
  8714* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8715* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8716     IF PB-COMPANY-ID = 'DMD'
  8717         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8718
  8719 0302-EDIT-ACCT-LF-BENEFITS.
  8720
  8721     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8722        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8723           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8724                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8725           GO TO 03XX-GET-LIFE-ERPLAN.
  8726
  8727     IF SUB5 LESS THAN +20
  8728        ADD +1                   TO SUB5
  8729        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8730
  8731     MOVE +1                     TO SUB5.
  8732
  8733     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 160
* EL050.cbl
  8734        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8735
  8736 0303-EDIT-DMD-EXTRA-BENEFITS.
  8737
  8738     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8739        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8740           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8741                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8742           GO TO 03XX-GET-LIFE-ERPLAN.
  8743
  8744     IF SUB5 LESS THAN +30
  8745        ADD +1                   TO SUB5
  8746        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8747
  8748     MOVE +1                     TO SUB5.
  8749
  8750 03XX-EDIT-FOR-NINETY-LF.
  8751
  8752***************************************************************
  8753*                                                             *
  8754*    NINETY BENEFIT PLAN TYPES:                               *
  8755*                                                             *
  8756*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8757*      92 = ALL GROUP REDUCING BENEFITS                       *
  8758*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8759*      94 = ALL GROUP LEVEL BENEFITS                          *
  8760*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8761*           BENEFIT CONTROLS.                                 *
  8762*      99 = ALL BENEFITS                                      *
  8763*                                                             *
  8764***************************************************************
  8765
  8766     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8767                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8768
  8769     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8770       AND
  8771        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8772        GO TO 03XX-GET-LIFE-ERPLAN.
  8773
  8774     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8775       AND
  8776        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8777        IF CF-REDUCING (SUB3)
  8778           IF (PB-I-INDV-GRP-OVRD = 'I')
  8779              OR
  8780           ((AM-IG = '1') AND
  8781           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8782              OR
  8783           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8784           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8785           (AM-IG NOT = '2'))
  8786              GO TO 03XX-GET-LIFE-ERPLAN.
  8787
  8788     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8789       AND
  8790        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8791        IF CF-REDUCING (SUB3)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 161
* EL050.cbl
  8792           IF (PB-I-INDV-GRP-OVRD = 'G')
  8793              OR
  8794           ((AM-IG = '2') AND
  8795           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8796              OR
  8797           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8798           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8799           (AM-IG NOT = '1'))
  8800              GO TO 03XX-GET-LIFE-ERPLAN.
  8801
  8802     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8803       AND
  8804        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8805        IF CF-LEVEL    (SUB3)
  8806           IF (PB-I-INDV-GRP-OVRD = 'I')
  8807              OR
  8808           ((AM-IG = '1') AND
  8809           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8810              OR
  8811           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8812           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8813            (AM-IG NOT = '2'))
  8814              GO TO 03XX-GET-LIFE-ERPLAN.
  8815
  8816     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8817       AND
  8818        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8819        IF CF-LEVEL    (SUB3)
  8820           IF (PB-I-INDV-GRP-OVRD = 'G')
  8821              OR
  8822           ((AM-IG = '2') AND
  8823           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8824              OR
  8825           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8826           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8827           (AM-IG NOT = '1'))
  8828              GO TO 03XX-GET-LIFE-ERPLAN.
  8829
  8830     IF SUB5 LESS THAN +20
  8831        ADD +1                   TO SUB5
  8832        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8833
  8834     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8835
  8836     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8837        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8838
  8839     MOVE +1                     TO SUB5.
  8840
  8841 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8842
  8843     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8844                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8845
  8846     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8847       AND
  8848        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8849        GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 162
* EL050.cbl
  8850
  8851     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8852       AND
  8853        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8854        IF CF-REDUCING (SUB3)
  8855           IF (PB-I-INDV-GRP-OVRD = 'I')
  8856              OR
  8857           ((AM-IG = '1') AND
  8858           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8859              OR
  8860           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8861           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8862           (AM-IG NOT = '2'))
  8863              GO TO 03XX-GET-LIFE-ERPLAN.
  8864
  8865     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8866       AND
  8867        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8868        IF CF-REDUCING (SUB3)
  8869           IF (PB-I-INDV-GRP-OVRD = 'G')
  8870              OR
  8871           ((AM-IG = '2') AND
  8872           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8873              OR
  8874           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8875           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8876           (AM-IG NOT = '1'))
  8877              GO TO 03XX-GET-LIFE-ERPLAN.
  8878
  8879     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8880       AND
  8881        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8882        IF CF-LEVEL    (SUB3)
  8883           IF (PB-I-INDV-GRP-OVRD = 'I')
  8884              OR
  8885           ((AM-IG = '1') AND
  8886           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8887              OR
  8888           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8889           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8890            (AM-IG NOT = '2'))
  8891              GO TO 03XX-GET-LIFE-ERPLAN.
  8892
  8893     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8894       AND
  8895        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8896        IF CF-LEVEL    (SUB3)
  8897           IF (PB-I-INDV-GRP-OVRD = 'G')
  8898              OR
  8899           ((AM-IG = '2') AND
  8900           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8901              OR
  8902           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8903           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8904           (AM-IG NOT = '1'))
  8905              GO TO 03XX-GET-LIFE-ERPLAN.
  8906
  8907     IF SUB5 LESS THAN +30
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 163
* EL050.cbl
  8908        ADD +1                   TO SUB5
  8909        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8910
  8911     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8912
  8913 03XX-EDIT-FOR-NINETY-LF-CONT.
  8914
  8915     MOVE +99                    TO SUB5.
  8916
  8917     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8918        IF PB-ISSUE
  8919           MOVE ER-1924          TO  WS-ERROR
  8920           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8921
  8922     GO TO 0304-LIFE-BENEFIT-FOUND.
  8923
  8924 03XX-GET-LIFE-ERPLAN.
  8925
  8926     IF WK-PLAN-ADDR EQUAL +0
  8927        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8928
  8929     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8930     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8931     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8932     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8933     MOVE 'Y'                    TO PLAN-MASTER-SW
  8934                                    PLAN-MASTER-LIFE-SW.
  8935     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8936
  8937 03XX-ERPLAN-LIFE-GETMAIN.
  8938
  8939     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8940     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8941
  8942 03XX-ERPLAN-LIFE-READ.
  8943
  8944     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8945     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8946     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8947     MOVE PB-SV-STATE            TO PLAN-STATE.
  8948     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8949     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8950     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8951     MOVE WS-SAVE-BENEFIT-REVISION
  8952                                 TO PLAN-REVISION-NO.
  8953
  8954     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8955     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8956
  8957     IF PB-COMPANY-ID = 'NCL'
  8958       IF NOT LF-PLAN-MASTER-FOUND
  8959         IF NOT PB-POLICY-IS-DECLINED  AND
  8960            NOT PB-POLICY-IS-VOIDED
  8961             MOVE  ER-1921         TO  WS-ERROR
  8962             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8963             GO TO 0304-LIFE-BENEFIT-FOUND.
  8964
  8965     IF NOT LF-PLAN-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 164
* EL050.cbl
  8966        GO TO 0304-LIFE-BENEFIT-FOUND.
  8967
  8968 XXXX-CHECK-LF-PLAN-KEY.
  8969
  8970     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8971        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8972        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8973        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8974        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8975        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8976        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8977        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8978        MOVE 'N'                 TO PLAN-MASTER-SW
  8979          GO TO 03XX-ERPLAN-LIFE-READ.
  8980
  8981     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8982
  8983     IF  PB-CANCELLATION
  8984         GO TO  0303-LF-ACCT-BEN-FOUND.
  8985
  8986     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8987        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8988           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8989           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8990              MOVE ER-2644             TO WS-ERROR
  8991              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8992           ELSE
  8993              NEXT SENTENCE
  8994        ELSE
  8995           IF PB-COMPANY-ID NOT = 'NCL'
  8996              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8997                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8998
  8999 0303-LF-ACCT-BEN-FOUND.
  9000
  9001     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9002
  9003     IF PL-DEV-CODE NOT = SPACES
  9004        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9005
  9006     IF PL-DEV-PCT NUMERIC AND
  9007        PL-DEV-PCT NOT = ZEROS
  9008        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9009
  9010     IF PL-TOL-PREM-AMT GREATER THAN +0
  9011        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9012
  9013     IF PL-TOL-REF-AMT GREATER THAN +0
  9014        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9015
  9016     IF PL-TOL-PREM-PCT GREATER THAN +0
  9017        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9018
  9019     IF PL-TOL-REF-PCT GREATER THAN +0
  9020        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9021
  9022     IF PL-TOL-CLM-AMT GREATER THAN +0
  9023        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 165
* EL050.cbl
  9024
  9025     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9026                          PL-OVER-SHORT-AMT > +0
  9027        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9028
  9029     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9030                          PL-OVER-SHORT-PCT > +0
  9031        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9032
  9033     IF PL-SALES-TAX NUMERIC AND
  9034                          PL-SALES-TAX > +0
  9035         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9036
  9037     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9038        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9039                                    WS-IG-OVRD-AM.
  9040
  9041 0304-LIFE-BENEFIT-FOUND.
  9042
  9043     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9044
  9045     IF PB-ISSUE
  9046        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9047     ELSE
  9048        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9049
  9050     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9051     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9052     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9053     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9054     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9055                                         WS-LF-REFUND-CALC.
  9056     if (ws-lf-earnings-calc = '5')
  9057        and (pb-i-loan-apr = zeros)
  9058        and (benefit-code-chg)
  9059        move +99.9999 to pb-i-loan-apr
  9060     end-if
  9061
  9062     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9063        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9064
  9065     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9066        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9067     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9068
  9069     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9070     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9071     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9072     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9073     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9074     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9075
  9076     IF PB-COMPANY-ID = 'NCL'  AND
  9077        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9078         NEXT SENTENCE
  9079     ELSE
  9080         IF SUB5 NOT GREATER THAN +20
  9081            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 166
* EL050.cbl
  9082               MOVE WS-SAVE-BENEFIT-REM-TERM
  9083                                      TO WS-AM-LF-BENE-REM-TERM
  9084                                         EC-BR-LF-REM-TERM-CALC.
  9085
  9086     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9087     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9088
  9089     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9090
  9091 0305-BENEFIT-NOT-FOUND.
  9092
  9093     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9094     MOVE ER-2604                TO WS-ERROR.
  9095     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9096
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 167
* EL050.cbl
  9098
  9099 0310-FIND-AH-BENEFIT-RECORD.
  9100
  9101     MOVE 'N'                    TO PLAN-MASTER-SW
  9102                                    PLAN-MASTER-AH-SW.
  9103
  9104     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9105                                    WS-PL-TOL-AH-REFUND
  9106                                    WS-AH-PL-REF-OVS-AMT
  9107                                    WS-PL-TOL-AH-PREM-PCT
  9108                                    WS-PL-TOL-AH-REFUND-PCT
  9109                                    WS-AH-PL-REF-OVS-PCT
  9110                                    WS-PL-TOL-AH-CLAIM.
  9111     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9112
  9113
  9114     if pb-issue
  9115        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9116           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9117        end-if
  9118        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9119           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9120           GO TO 0399-BENEFIT-NOT-FOUND
  9121        end-if
  9122     end-if
  9123
  9124     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9125        GO TO 0400-FIND-CARRIER.
  9126
  9127     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9128
  9129     IF WK-AH-BEN-ADDR NOT = ZEROS
  9130         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9131         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9132         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9133         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9134           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9135             GO TO 0311-AH-BENEFIT-SEARCH
  9136         ELSE
  9137             NEXT SENTENCE
  9138     ELSE
  9139         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9140
  9141     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9142     MOVE '5'                    TO CNTL-REC-TYPE.
  9143     MOVE +0                     TO CNTL-SEQ-NO.
  9144     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9145
  9146     MOVE '2' TO RC-SW-2.
  9147     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9148
  9149     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9150        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9151          GO TO 0399-BENEFIT-NOT-FOUND.
  9152
  9153     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9154
  9155 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 168
* EL050.cbl
  9156
  9157     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9158
  9159     IF NO-BENEFIT-FOUND
  9160         GO TO 0399-BENEFIT-NOT-FOUND.
  9161
  9162     IF WS-BEN-CD = '99'
  9163        GO TO 0399-BENEFIT-NOT-FOUND.
  9164
  9165     IF PB-COMPANY-ID  =  'NCL'
  9166         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9167             GO TO 0314-A-H-BENEFIT-FOUND.
  9168
  9169     MOVE +1                     TO SUB5.
  9170     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9171
  9172* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9173* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9174     IF PB-COMPANY-ID = 'DMD'
  9175         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9176
  9177 0312-EDIT-ACCT-AH-BENEFITS.
  9178
  9179     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9180        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9181           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9182                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9183           GO TO 03XX-GET-AH-ERPLAN.
  9184
  9185     IF SUB5 LESS THAN +20
  9186        ADD +1                   TO SUB5
  9187        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9188
  9189     MOVE +1                     TO SUB5.
  9190
  9191     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9192        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9193
  9194 0313-EDIT-DMD-EXTRA-BENEFITS.
  9195
  9196     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9197        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9198           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9199                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9200           GO TO 03XX-GET-AH-ERPLAN.
  9201
  9202     IF SUB5 LESS THAN +30
  9203        ADD +1                   TO SUB5
  9204        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9205
  9206     MOVE +1                     TO SUB5.
  9207
  9208 03XX-EDIT-FOR-NINETY-AH.
  9209
  9210***************************************************************
  9211*                                                             *
  9212*    NINETY BENEFIT PLAN TYPES:                               *
  9213*                                                             *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 169
* EL050.cbl
  9214*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9215*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9216*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9217*           BENEFIT CONTROLS.                                 *
  9218*      99 = ALL BENEFITS.                                     *
  9219*                                                             *
  9220***************************************************************
  9221
  9222     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9223                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9224
  9225     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9226       AND
  9227        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9228        GO TO 03XX-GET-AH-ERPLAN.
  9229
  9230     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9231       AND
  9232        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9233           IF (PB-I-INDV-GRP-OVRD = 'I')
  9234              OR
  9235           ((AM-IG = '1') AND
  9236           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9237              OR
  9238           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9239           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9240           (AM-IG NOT = '2'))
  9241              GO TO 03XX-GET-AH-ERPLAN.
  9242
  9243     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9244       AND
  9245        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9246           IF (PB-I-INDV-GRP-OVRD = 'G')
  9247              OR
  9248           ((AM-IG = '2') AND
  9249           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9250              OR
  9251           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9252           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9253           (AM-IG NOT = '1'))
  9254              GO TO 03XX-GET-AH-ERPLAN.
  9255
  9256     IF SUB5 LESS THAN +20
  9257        ADD +1                   TO SUB5
  9258        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9259
  9260     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9261        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9262
  9263     MOVE +1                    TO SUB5.
  9264
  9265 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9266
  9267     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9268                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9269
  9270     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9271       AND
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 170
* EL050.cbl
  9272        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9273        GO TO 03XX-GET-AH-ERPLAN.
  9274
  9275     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9276       AND
  9277        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9278           IF (PB-I-INDV-GRP-OVRD = 'I')
  9279              OR
  9280           ((AM-IG = '1') AND
  9281           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9282              OR
  9283           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9284           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9285           (AM-IG NOT = '2'))
  9286              GO TO 03XX-GET-AH-ERPLAN.
  9287
  9288     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9289       AND
  9290        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9291           IF (PB-I-INDV-GRP-OVRD = 'G')
  9292              OR
  9293           ((AM-IG = '2') AND
  9294           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9295              OR
  9296           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9297           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9298           (AM-IG NOT = '1'))
  9299              GO TO 03XX-GET-AH-ERPLAN.
  9300
  9301     IF SUB5 LESS THAN +30
  9302        ADD +1                   TO SUB5
  9303        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9304
  9305 03XX-EDIT-FOR-NINETY-AH-CONT.
  9306
  9307     MOVE +99                    TO SUB5.
  9308
  9309     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9310
  9311     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9312        IF PB-ISSUE
  9313           MOVE ER-1925          TO  WS-ERROR
  9314           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9315
  9316     GO TO 0314-A-H-BENEFIT-FOUND.
  9317
  9318 03XX-GET-AH-ERPLAN.
  9319
  9320     IF WK-PLAN-ADDR EQUAL +0
  9321         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9322
  9323     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9324     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9325     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9326     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9327     MOVE 'Y'                    TO PLAN-MASTER-SW
  9328                                    PLAN-MASTER-AH-SW.
  9329*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 171
* EL050.cbl
  9330     GO TO 03XX-ERPLAN-AH-READ.
  9331
  9332 03XX-ERPLAN-AH-GETMAIN.
  9333
  9334     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9335     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9336
  9337 03XX-ERPLAN-AH-READ.
  9338
  9339     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9340     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9341     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9342     MOVE PB-SV-STATE            TO PLAN-STATE.
  9343     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9344     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9345     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9346     MOVE WS-SAVE-BENEFIT-REVISION
  9347                                 TO PLAN-REVISION-NO.
  9348
  9349     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9350     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9351
  9352     IF PB-COMPANY-ID = 'NCL'
  9353       IF NOT AH-PLAN-MASTER-FOUND
  9354         IF NOT PB-POLICY-IS-DECLINED  AND
  9355            NOT PB-POLICY-IS-VOIDED
  9356             MOVE  ER-1922         TO  WS-ERROR
  9357             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9358             GO TO 0314-A-H-BENEFIT-FOUND.
  9359
  9360     IF NOT AH-PLAN-MASTER-FOUND
  9361        GO TO 0314-A-H-BENEFIT-FOUND.
  9362
  9363 XXXX-CHECK-AH-PLAN-KEY.
  9364
  9365     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9366        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9367        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9368        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9369        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9370        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9371        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9372        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9373        MOVE 'N'                 TO PLAN-MASTER-SW
  9374          GO TO 03XX-ERPLAN-AH-READ.
  9375
  9376     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9377
  9378     IF  PB-CANCELLATION
  9379         GO TO  0313-AH-ACCT-BEN-FOUND.
  9380
  9381     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9382       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9383          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9384          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9385             MOVE ER-2644             TO WS-ERROR
  9386             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9387          ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 172
* EL050.cbl
  9388             NEXT SENTENCE
  9389       ELSE
  9390          IF PB-COMPANY-ID NOT = 'NCL'
  9391             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9392                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9393
  9394 0313-AH-ACCT-BEN-FOUND.
  9395
  9396     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9397
  9398     IF PL-DEV-CODE NOT = SPACES
  9399        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9400
  9401     IF PL-DEV-PCT NUMERIC AND
  9402        PL-DEV-PCT NOT = ZEROS
  9403        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9404
  9405     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9406        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9407
  9408     IF PL-TOL-REF-AMT NOT EQUAL +0
  9409        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9410
  9411     IF PL-TOL-PREM-PCT GREATER THAN +0
  9412        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9413
  9414     IF PL-TOL-REF-PCT GREATER THAN +0
  9415        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9416
  9417     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9418        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9419
  9420     IF PL-OVER-SHORT-AMT NUMERIC AND
  9421                          PL-OVER-SHORT-AMT > +0
  9422        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9423
  9424     IF PL-OVER-SHORT-PCT NUMERIC AND
  9425                          PL-OVER-SHORT-PCT > +0
  9426        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9427
  9428     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9429        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9430        IF WS-IG-OVRD-AM EQUAL SPACES
  9431            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9432
  9433 0314-A-H-BENEFIT-FOUND.
  9434
  9435     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9436
  9437     IF PB-ISSUE
  9438        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9439       ELSE
  9440        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9441
  9442     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9443     if cf-maximum-benefits (sub3) numeric
  9444        move cf-maximum-benefits (sub3)
  9445                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 173
* EL050.cbl
  9446     else
  9447        move zeros               to ws-ah-max-bens
  9448     end-if
  9449     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9450     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9451     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9452                                         WS-AH-REFUND-CALC.
  9453
  9454     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9455        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9456
  9457     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9458        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9459     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9460
  9461     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9462     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9463     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9464     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9465     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9466     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9467
  9468     IF PB-COMPANY-ID = 'NCL'  AND
  9469        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9470         NEXT SENTENCE
  9471     ELSE
  9472         IF SUB5 NOT GREATER THAN +20
  9473            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9474                MOVE WS-SAVE-BENEFIT-REM-TERM
  9475                                      TO WS-AM-AH-BENE-REM-TERM
  9476                                         EC-BR-AH-REM-TERM-CALC.
  9477
  9478     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9479     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9480
  9481     GO TO 0400-FIND-CARRIER.
  9482
  9483 0399-BENEFIT-NOT-FOUND.
  9484
  9485     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9486     MOVE ER-2605                TO WS-ERROR.
  9487     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9488
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 174
* EL050.cbl
  9490
  9491 0400-FIND-CARRIER.
  9492
  9493     MOVE PB-SV-CARRIER          TO WS-CARR.
  9494
  9495     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9496     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9497     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9498     MOVE '6'                    TO CNTL-REC-TYPE.
  9499
  9500*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9501     MOVE SPACE                  TO WS-DMD-RATING-SW
  9502                                    EC-BR-DMD-RATING-SW.
  9503
  9504     MOVE '2'                    TO RC-SW-1.
  9505     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9506
  9507     IF NOT CF-CARRIER-MASTER
  9508        GO TO 0400-CARRIER-NOT-FOUND.
  9509
  9510 0400-BUILD-CARR-TOL.
  9511
  9512     IF CF-CR-TOL-PREM NUMERIC AND
  9513        CF-CR-TOL-PREM GREATER THAN +0
  9514        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9515                                    WS-TOL-AH-PREM.
  9516
  9517     IF CF-CR-TOL-REFUND NUMERIC AND
  9518        CF-CR-TOL-REFUND GREATER THAN +0
  9519        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9520                                    WS-TOL-AH-REFUND.
  9521
  9522     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9523        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9524        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9525                                    WS-AH-REFUND-OVS-AMT.
  9526
  9527     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9528        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9529        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9530                                    WS-AH-REFUND-OVS-PCT.
  9531
  9532     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9533        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9534        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9535                                    WS-TOL-AH-PREM-PCT.
  9536
  9537     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9538        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9539        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9540                                     WS-TOL-AH-REFUND-PCT.
  9541
  9542     IF CF-COMPANY-ID EQUAL 'DMD'
  9543         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9544                                    EC-BR-DMD-RATING-SW.
  9545
  9546     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9547     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 175
* EL050.cbl
  9548        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9549     END-IF
  9550     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9551        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9552     END-IF
  9553     IF WS-TOL-CLP-PCT = ZEROS
  9554        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9555     END-IF
  9556
  9557     IF WS-SPP-LEASE-COMM = ZEROS
  9558        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9559     END-IF
  9560     GO TO 0400-FIND-ERPDEF.
  9561
  9562 0400-CARRIER-NOT-FOUND.
  9563
  9564     MOVE ER-2602                TO WS-ERROR.
  9565     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9566
  9567 0400-FIND-ERPDEF.
  9568*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9569     IF (PB-COMPANY-ID = 'DCC')
  9570        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9571        CONTINUE
  9572     ELSE
  9573        GO TO 0400-FIND-ERCOMP
  9574     END-IF
  9575     MOVE ' '                    TO PDEF-MASTER-SW
  9576     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9577     MOVE PB-STATE               TO ERPDEF-STATE
  9578     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9579        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9580     END-IF
  9581     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9582     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9583     IF PB-ISSUE
  9584        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9585     ELSE
  9586        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9587     END-IF
  9588     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9589     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9590     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9591     IF PDEF-MASTER-FOUND
  9592        MOVE 'N'                 TO PDEF-MASTER-SW
  9593        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9594        IF PDEF-MASTER-FOUND
  9595           IF (ERPDEF-KEY-SAVE (1:16) =
  9596                        PD-CONTROL-PRIMARY (1:16))
  9597              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9598              CONTINUE
  9599           ELSE
  9600              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9601              IF (ERPDEF-KEY-SAVE (1:16) =
  9602                        PD-CONTROL-PRIMARY (1:16))
  9603                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9604                 CONTINUE
  9605              ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 176
* EL050.cbl
  9606                 MOVE 'N'        TO PDEF-MASTER-SW
  9607              END-IF
  9608           END-IF
  9609        END-IF
  9610        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9611     END-IF
  9612     IF PDEF-MASTER-FOUND
  9613        IF PD-TRUNCATED = 'Y'
  9614           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9615        END-IF
  9616     END-IF
  9617     .
  9618 0400-FIND-ERCOMP.
  9619     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9620        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9621           (WS-SUB1 > +10)
  9622           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9623                 OR 'A' OR 'N'
  9624              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9625              MOVE PB-CARRIER    TO COMP-CARRIER
  9626              MOVE PB-GROUPING   TO COMP-GROUPING
  9627              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9628              MOVE AM-AGT (WS-SUB1)
  9629                                 TO COMP-FIN-RESP
  9630              MOVE 'G'           TO COMP-TYPE
  9631              PERFORM 8582-READ-COMPENSATION-MASTER
  9632                                 THRU 8582-EXIT
  9633              IF COMP-MASTER-FOUND
  9634                 IF CO-GA-INACTIVE
  9635                    MOVE ER-2763 TO WS-ERROR
  9636                    PERFORM 9900-ERROR-FORMAT
  9637                                 THRU 9900-EXIT
  9638                    MOVE +11     TO WS-SUB1
  9639                 END-IF
  9640                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9641                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9642                    MOVE ER-2788 TO WS-ERROR
  9643                    PERFORM 9900-ERROR-FORMAT
  9644                                 THRU 9900-EXIT
  9645                    MOVE +11     TO WS-SUB1
  9646                 END-IF
  9647              END-IF
  9648           END-IF
  9649        END-PERFORM
  9650     END-IF
  9651     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9652        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9653           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9654                                    WS-CLP-STATE
  9655        ELSE
  9656           MOVE SPACES           TO PB-I-CLP-STATE
  9657                                    WS-CLP-STATE
  9658        END-IF
  9659     END-IF
  9660
  9661     IF (PB-COMPANY-ID = 'DCC')
  9662        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9663        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 177
* EL050.cbl
  9664        CONTINUE
  9665     ELSE
  9666        GO TO 0400-FIND-STATE-RECORD
  9667     END-IF
  9668     MOVE SPACES                 TO WS-CLP-STATE
  9669     MOVE +0                     TO WS-BANK-FEE
  9670                                    WS-BANK-LFEE
  9671                                    WS-BANK-NOCHRGB
  9672
  9673     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9674     IF (PB-ISSUE)
  9675        AND (PB-I-BANK-NUMBER NOT =
  9676            SPACES AND ZEROS AND LOW-VALUES)
  9677        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9678     ELSE
  9679        IF (PB-CANCELLATION)
  9680           AND (PB-CI-BANK-NUMBER NOT =
  9681                SPACES AND ZEROS AND LOW-VALUES)
  9682           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9683        END-IF
  9684     END-IF
  9685     IF COMP-FIN-RESP NOT = LOW-VALUES
  9686        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9687        MOVE PB-CARRIER          TO COMP-CARRIER
  9688        MOVE PB-GROUPING         TO COMP-GROUPING
  9689        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9690        MOVE 'B'                 TO COMP-TYPE
  9691        PERFORM 8582-READ-COMPENSATION-MASTER
  9692                                 THRU 8582-EXIT
  9693        IF COMP-MASTER-FOUND
  9694           IF CO-MAX-BANK-FEE NOT NUMERIC
  9695              MOVE +0            TO CO-MAX-BANK-FEE
  9696           END-IF
  9697           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9698              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9699           END-IF
  9700           IF CO-GA-INACTIVE
  9701              MOVE ER-2763       TO WS-ERROR
  9702              PERFORM 9900-ERROR-FORMAT
  9703                                 THRU 9900-EXIT
  9704           END-IF
  9705           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9706              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9707              MOVE ER-2788 TO WS-ERROR
  9708              PERFORM 9900-ERROR-FORMAT
  9709                                 THRU 9900-EXIT
  9710              MOVE +11     TO WS-SUB1
  9711           END-IF
  9712           IF WS-AH-BEN-CATEGORY = 'G'
  9713              MOVE CO-MAX-BANK-FEE
  9714                                 TO WS-BANK-FEE
  9715                                    PB-I-BANK-FEE
  9716           ELSE
  9717              MOVE CO-MAX-BANK-FEE-LEASE
  9718                                 TO WS-BANK-LFEE
  9719                                    PB-I-BANK-FEE
  9720           END-IF
  9721           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 178
* EL050.cbl
  9722              AND (WS-AH-REFUND-CALC = 'G'))
  9723                        OR
  9724              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9725              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9726              CONTINUE
  9727           ELSE
  9728              MOVE ER-2789 TO WS-ERROR
  9729              PERFORM 9900-ERROR-FORMAT
  9730                                 THRU 9900-EXIT
  9731           END-IF
  9732           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9733                                    PB-I-CLP-STATE
  9734           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9735           MOVE CO-CARRIER       TO BXRF-CARRIER
  9736           MOVE CO-GROUPING      TO BXRF-GROUPING
  9737           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9738           MOVE BXRF-MAX-REC-LENGTH
  9739                                 TO BXRF-REC-LENGTH
  9740           PERFORM 8584-READ-BANK-CROSS-REF
  9741                                 THRU 8584-EXIT
  9742           IF BXRF-MASTER-FOUND
  9743              MOVE ' '           TO BANK-ACCT-SW
  9744              MOVE BK-BANK-POINTER-CNT
  9745                                 TO BK-BANK-POINTER-CNT
  9746              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9747                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9748                 OR (BANK-ACCT-FOUND)
  9749                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9750                    AND (BK-AM-EXP-DT (WS-SUB1)
  9751                                 > PB-CERT-EFF-DT)
  9752                    AND (BK-AM-EFF-DT (WS-SUB1)
  9753                                 NOT > PB-CERT-EFF-DT)
  9754                    SET BANK-ACCT-FOUND TO TRUE
  9755                 END-IF
  9756              END-PERFORM
  9757              IF NOT BANK-ACCT-FOUND
  9758                 MOVE ZEROS      TO WS-BANK-FEE
  9759                                    WS-BANK-LFEE
  9760                 MOVE ER-2869    TO WS-ERROR
  9761                 PERFORM 9900-ERROR-FORMAT
  9762                                 THRU 9900-EXIT
  9763              ELSE
  9764                 PERFORM 5000-PROCESS-REPS
  9765                                 THRU 5000-EXIT
  9766                 IF AGENT-MASTER-FOUND
  9767                    MOVE +0      TO WS-BANK-FEE
  9768                                    WS-BANK-LFEE
  9769*                   MOVE AG-SPP-FEES (1)
  9770*                                TO PB-I-BANK-FEE
  9771*                                   WS-BANK-FEE
  9772                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9773                       (WS-SUB1 > +10)
  9774                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9775                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9776                       END-IF
  9777                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9778                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9779                       END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 179
* EL050.cbl
  9780                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9781                          AG-SPP-FEES (WS-SUB1)
  9782                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9783                          AG-SPP-LFEES (WS-SUB1)
  9784                    END-PERFORM
  9785                    IF WS-AH-BEN-CATEGORY = 'G'
  9786                       MOVE WS-BANK-FEE
  9787                                 TO PB-I-BANK-FEE
  9788                    ELSE
  9789                       MOVE WS-BANK-LFEE
  9790                                 TO PB-I-BANK-FEE
  9791                    END-IF
  9792                 END-IF
  9793              END-IF
  9794           END-IF
  9795        ELSE
  9796           MOVE ER-2879          TO WS-ERROR
  9797           PERFORM 9900-ERROR-FORMAT
  9798                                 THRU 9900-EXIT
  9799        END-IF
  9800     ELSE
  9801        MOVE ER-2879             TO WS-ERROR
  9802        PERFORM 9900-ERROR-FORMAT
  9803                                 THRU 9900-EXIT
  9804     END-IF
  9805     IF WS-AH-BEN-CATEGORY = 'G'
  9806        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9807        + WS-BANK-FEE
  9808     ELSE
  9809        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9810        + WS-BANK-LFEE
  9811     END-IF
  9812     .
  9813 0400-FIND-STATE-RECORD.
  9814
  9815     IF WK-STATE-ADDR NOT = ZEROS
  9816         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9817         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9818         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9819         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9820         IF PB-SV-STATE = CF-STATE-CODE
  9821             GO TO 0405-CONTINUE-EDIT
  9822         ELSE
  9823             NEXT SENTENCE
  9824     ELSE
  9825         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9826
  9827     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9828     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9829     MOVE '3'                    TO CNTL-REC-TYPE.
  9830     MOVE +0                     TO CNTL-SEQ-NO.
  9831
  9832     MOVE '3'                    TO RC-SW-2.
  9833     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9834
  9835     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9836        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9837        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 180
* EL050.cbl
  9838        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9839                                    WS-TOL-AH-CLAIM
  9840                                    WS-MINIMUM-REFUND
  9841                                    WS-TOL-LF-PREM
  9842                                    WS-TOL-AH-PREM
  9843                                    WS-TOL-LF-REFUND
  9844                                    WS-TOL-AH-REFUND
  9845                                    EC-ST-TOL-PREM-PCT
  9846                                    WS-TOL-LF-PREM-PCT
  9847                                    WS-TOL-AH-PREM-PCT
  9848                                    EC-ST-TOL-REFUND-PCT
  9849                                    WS-TOL-LF-REFUND-PCT
  9850                                    WS-TOL-AH-REFUND-PCT
  9851                                    EC-ST-TOL-PREM
  9852                                    EC-ST-TOL-REFUND
  9853                                    EC-ST-FST-PMT-DAYS-MAX
  9854                                    WS-FREE-LOOK-PERIOD
  9855                                    WS-ST-LF-PREM-TAX
  9856                                    WS-ST-AH-PREM-TAX-I
  9857                                    WS-ST-AH-PREM-TAX-G
  9858                                    WS-BANK-FEE
  9859                                    WS-BANK-LFEE
  9860                                    WS-TOL-CLP-PCT
  9861                                    WS-SPP-LEASE-COMM
  9862                                    WS-INT-PERIODS
  9863                                    WS-EXTRA-PMTS
  9864        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9865                                    EC-ST-FST-PMT-DAYS-CHG
  9866                                    WS-LF-REM-TERM-CALC
  9867                                    WS-LF-REFUND-CALC
  9868                                    EC-ST-LF-REM-TERM-CALC
  9869                                    EC-ST-LF-REFUND-CALC
  9870                                    WS-AH-REM-TERM-CALC
  9871                                    WS-AH-REFUND-CALC
  9872                                    WS-LF-BEN-CATEGORY
  9873                                    WS-AH-BEN-CATEGORY
  9874                                    WS-CLP-STATE
  9875                                    WS-ST-REFUND-CLAIM-FLAG
  9876                                    WS-ST-CAUSAL-STATE
  9877                                    ws-st-agent-sig-edit
  9878                                    EC-ST-AH-REM-TERM-CALC
  9879                                    EC-ST-AH-REFUND-CALC
  9880          GO TO 0499-STATE-NOT-FOUND.
  9881
  9882     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9883
  9884 0405-CONTINUE-EDIT.
  9885
  9886     if pb-company-id = 'AHL'
  9887        continue
  9888     else
  9889        IF PB-CERT-PRIME NOT NUMERIC
  9890           MOVE ER-2722          TO WS-ERROR
  9891           PERFORM 9900-ERROR-FORMAT
  9892                                 THRU 9900-EXIT
  9893        end-if
  9894     END-IF
  9895*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 181
* EL050.cbl
  9896*       MOVE +0                  TO SUB3
  9897*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9898*       IF SUB3 > +0
  9899*          MOVE ER-2722          TO WS-ERROR
  9900*          PERFORM 9900-ERROR-FORMAT
  9901*                                THRU 9900-EXIT
  9902*       END-IF
  9903*    END-IF
  9904*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9905*       IF PB-CERT-PRIME NOT NUMERIC
  9906*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9907*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9908*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9909*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9910*
  9911*          MOVE ER-2722          TO WS-ERROR
  9912*          PERFORM 9900-ERROR-FORMAT
  9913*                                THRU 9900-EXIT
  9914*       END-IF
  9915*    END-IF
  9916
  9917     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9918
  9919     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9920        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9921                                    WS-TOL-AH-CLAIM.
  9922
  9923     IF CF-ST-REFUND-MIN NOT NUMERIC
  9924        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9925
  9926     IF CF-ST-REFUND-MIN NOT = ZEROS
  9927        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9928
  9929     IF CF-ST-TOL-PREM  NOT = ZEROS
  9930        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9931                                    WS-TOL-AH-PREM
  9932        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9933
  9934     IF CF-ST-TOL-REFUND NOT = ZEROS
  9935        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9936                                    WS-TOL-AH-REFUND
  9937        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9938
  9939     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9940        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9941        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9942                                    WS-AH-REFUND-OVS-AMT
  9943                                    EC-ST-OVR-SHT-AMT.
  9944
  9945     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9946        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9947        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9948                                    WS-TOL-LF-PREM-PCT
  9949                                    WS-TOL-AH-PREM-PCT.
  9950
  9951     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9952        CF-ST-TOL-REF-PCT GREATER THAN +0
  9953        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 182
* EL050.cbl
  9954                                    WS-TOL-LF-REFUND-PCT
  9955                                    WS-TOL-AH-REFUND-PCT.
  9956
  9957     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9958        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9959        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9960                                    WS-AH-REFUND-OVS-PCT
  9961                                    EC-ST-OVR-SHT-PCT.
  9962
  9963     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9964     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9965
  9966     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9967          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9968
  9969     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9970     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9971     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9972
  9973     IF CF-ST-LF-PREM-TAX NUMERIC
  9974        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9975     END-IF
  9976     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9977        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9978     END-IF
  9979     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9980        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9981     END-IF
  9982
  9983     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9984         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9985     END-IF.
  9986
  9987     IF CF-ST-CAUSAL-STATE > SPACES
  9988         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9989     END-IF.
  9990     if cf-st-extra-interest-periods not numeric
  9991        move zeros               to cf-st-extra-interest-periods
  9992     end-if
  9993     if cf-st-extra-payments not numeric
  9994        move zeros               to cf-st-extra-payments
  9995     end-if
  9996
  9997     move cf-st-extra-interest-periods
  9998                                 to ws-int-periods
  9999     move cf-st-extra-payments   to ws-extra-pmts
 10000     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10001     move cf-st-net-only-state   to ws-net-only-state
 10002     if cf-st-comm-cap-sl not numeric
 10003        move zeros               to cf-st-comm-cap-sl
 10004     end-if
 10005     if cf-st-comm-cap-jl not numeric
 10006        move zeros               to cf-st-comm-cap-jl
 10007     end-if
 10008     if cf-st-comm-cap-sa not numeric
 10009        move zeros               to cf-st-comm-cap-sa
 10010     end-if
 10011     if cf-st-comm-cap-ja not numeric
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 183
* EL050.cbl
 10012        move zeros               to cf-st-comm-cap-ja
 10013     end-if
 10014     if cf-st-ga-comm-cap-sl not numeric
 10015        move zeros               to cf-st-ga-comm-cap-sl
 10016     end-if
 10017     if cf-st-ga-comm-cap-jl not numeric
 10018        move zeros               to cf-st-ga-comm-cap-jl
 10019     end-if
 10020     if cf-st-ga-comm-cap-sa not numeric
 10021        move zeros               to cf-st-ga-comm-cap-sa
 10022     end-if
 10023     if cf-st-ga-comm-cap-ja not numeric
 10024        move zeros               to cf-st-ga-comm-cap-ja
 10025     end-if
 10026
 10027     if cf-st-tot-comm-cap-sl not numeric
 10028        move zeros               to cf-st-tot-comm-cap-sl
 10029     end-if
 10030     if cf-st-tot-comm-cap-jl not numeric
 10031        move zeros               to cf-st-tot-comm-cap-jl
 10032     end-if
 10033     if cf-st-tot-comm-cap-sa not numeric
 10034        move zeros               to cf-st-tot-comm-cap-sa
 10035     end-if
 10036     if cf-st-tot-comm-cap-ja not numeric
 10037        move zeros               to cf-st-tot-comm-cap-ja
 10038     end-if
 10039
 10040     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10041     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10042     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10043     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10044     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10045     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10046     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10047     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10048     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10049     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10050     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10051     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10052     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10053     IF WS-LF-BENEFIT-CD = ZEROS
 10054        GO TO 0410-CHECK-AH.
 10055
 10056     IF CF-ST-RT-CALC NOT = SPACES
 10057        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10058                                    EC-ST-LF-REM-TERM-CALC
 10059     END-IF
 10060
 10061     IF WS-LF-COVERAGE-TYPE = 'R'
 10062        IF WS-LF-EARNINGS-CALC = '5'
 10063           IF CF-ST-RF-LN-CALC > '0'
 10064              MOVE CF-ST-RF-LN-CALC
 10065                                 TO WS-LF-REFUND-CALC
 10066                                    EC-ST-LF-REFUND-CALC
 10067           END-IF
 10068        ELSE
 10069           IF CF-ST-RF-LR-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 184
* EL050.cbl
 10070              MOVE CF-ST-RF-LR-CALC
 10071                                 TO WS-LF-REFUND-CALC
 10072                                    EC-ST-LF-REFUND-CALC
 10073           END-IF
 10074        END-IF
 10075     ELSE
 10076        IF CF-ST-RF-LL-CALC > '0'
 10077           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10078                                    EC-ST-LF-REFUND-CALC
 10079        END-IF
 10080     END-IF
 10081
 10082     IF CF-ST-RT-CALC NOT = SPACES
 10083        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10084                                    EC-ST-LF-REM-TERM-CALC
 10085     END-IF
 10086
 10087     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10088     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10089
 10090     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10091
 10092     IF NO-BENEFIT-FOUND
 10093        GO TO 0410-CHECK-AH.
 10094
 10095     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10096        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10097                                 TO EC-ST-LF-REM-TERM-CALC
 10098                                    WS-LF-REM-TERM-CALC
 10099     END-IF
 10100
 10101     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10102        MOVE CF-ST-REFUND-CALC (SUB3)
 10103                                 TO WS-LF-REFUND-CALC
 10104                                    EC-ST-LF-REFUND-CALC
 10105     END-IF
 10106*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10107     if cf-st-extra-periods (sub3) not numeric
 10108        move zeros               to cf-st-extra-periods (sub3)
 10109     end-if
 10110     if cf-st-extra-periods (sub3) > zeros
 10111        if ws-lf-ben-category = 'P'
 10112           move cf-st-extra-periods (sub3)
 10113                                 to ws-extra-pmts
 10114        else
 10115           if ws-lf-ben-category = 'I'
 10116              move cf-st-extra-periods (sub3)
 10117                                 to ws-int-periods
 10118           end-if
 10119        end-if
 10120     end-if
 10121     .
 10122 0410-CHECK-AH.
 10123
 10124     IF WS-AH-BENEFIT-CD = ZEROS
 10125        GO TO 0500-SET-ACCOUNT.
 10126
 10127     IF CF-ST-RT-CALC NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 185
* EL050.cbl
 10128        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10129                                    EC-ST-AH-REM-TERM-CALC
 10130     END-IF
 10131
 10132     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10133        IF CF-ST-RF-CP-CALC > '0'
 10134           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10135                                    EC-ST-AH-REFUND-CALC
 10136        END-IF
 10137     ELSE
 10138        IF CF-ST-RF-AH-CALC > '0'
 10139           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10140                                    EC-ST-AH-REFUND-CALC
 10141        END-IF
 10142     END-IF
 10143     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10144     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10145
 10146     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10147
 10148     IF NO-BENEFIT-FOUND
 10149        GO TO 0500-SET-ACCOUNT.
 10150
 10151     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10152        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10153                                 TO WS-AH-REM-TERM-CALC
 10154                                    EC-ST-AH-REM-TERM-CALC
 10155     END-IF
 10156
 10157     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10158        MOVE CF-ST-REFUND-CALC (SUB3)
 10159                                 TO WS-AH-REFUND-CALC
 10160                                    EC-ST-AH-REFUND-CALC
 10161     END-IF
 10162
 10163*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10164
 10165     GO TO 0500-SET-ACCOUNT.
 10166
 10167 0499-STATE-NOT-FOUND.
 10168
 10169     MOVE ER-2603                TO WS-ERROR.
 10170     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10171
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 186
* EL050.cbl
 10173
 10174 0500-SET-ACCOUNT.
 10175*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10176     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10177        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10178        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10179        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10180        MOVE '3'                 TO CNTL-REC-TYPE
 10181        MOVE +0                  TO CNTL-SEQ-NO
 10182
 10183        MOVE '3'                 TO RC-SW-2
 10184        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10185
 10186        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10187           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10188           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10189           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10190                                    WS-ST-AH-PREM-TAX-I
 10191                                    WS-ST-AH-PREM-TAX-G
 10192        ELSE
 10193           IF CF-ST-LF-PREM-TAX NUMERIC
 10194              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10195           END-IF
 10196           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10197              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10198           END-IF
 10199           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10200              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10201           END-IF
 10202        END-IF
 10203        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10204     END-IF
 10205*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10206*  FOR DCC ONLY
 10207     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10208
 10209        MOVE ' '                 TO STAT-MASTER-SW
 10210        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10211        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10212        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10213        MOVE PB-STATE            TO ELSTAT-STATE
 10214        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10215           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10216        END-IF
 10217
 10218        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10219        SET BIN-TO-GREG          TO TRUE
 10220        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10221        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10222        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10223
 10224        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10225        IF STAT-MASTER-FOUND
 10226           MOVE 'N'              TO STAT-MASTER-SW
 10227           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10228           IF STAT-MASTER-FOUND
 10229              IF (ELSTAT-KEY-SAVE (1:12) =
 10230                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 187
* EL050.cbl
 10231                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10232                    MOVE 'F'        TO STAT-MASTER-SW
 10233                 ELSE
 10234                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10235                    IF (STAT-MASTER-FOUND)
 10236                       AND (ELSTAT-KEY-SAVE (1:12) =
 10237                           SF-CONTROL-PRIMARY (1:12))
 10238                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10239                       MOVE 'F'     TO STAT-MASTER-SW
 10240                    END-IF
 10241                 END-IF
 10242              END-IF
 10243           END-IF
 10244        END-IF
 10245
 10246        IF STAT-MASTER-SW = 'F'
 10247           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10248              and (sf-st-lf-prem-tax > zeros)
 10249              MOVE SF-ST-LF-PREM-TAX
 10250                                 TO WS-ST-LF-PREM-TAX
 10251           END-IF
 10252           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10253              and (sf-st-ah-prem-tax-i > zeros)
 10254              MOVE SF-ST-AH-PREM-TAX-I
 10255                                 TO WS-ST-AH-PREM-TAX-I
 10256           END-IF
 10257           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10258              and (sf-st-ah-prem-tax-g > zeros)
 10259              MOVE SF-ST-AH-PREM-TAX-G
 10260                                 TO WS-ST-AH-PREM-TAX-G
 10261           END-IF
 10262        END-IF
 10263     END-IF
 10264     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10265        AND (PB-ISSUE)
 10266        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10267        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10268        AND (AM-GPCD = 06)
 10269        MOVE 'Y'                 TO WS-GOOD-HIN
 10270        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10271           MOVE PB-I-VIN         TO WS-WORK-VIN
 10272           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10273              (V1 > 16)
 10274              IF WS-WORK-VIN (V1:1) NUMERIC
 10275                 MOVE WS-WORK-VIN-N (V1)
 10276                                 TO WS-ROW-B-VAL (V1)
 10277              ELSE
 10278                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10279                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10280                    OR (V2 > 26)
 10281                 END-PERFORM
 10282                 IF V2 < 27
 10283                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10284                 ELSE
 10285                    MOVE 'N'     TO WS-GOOD-HIN
 10286                 END-IF
 10287              END-IF
 10288              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 188
* EL050.cbl
 10289                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10290              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10291                 WS-ROW-D-VAL (V1)
 10292           END-PERFORM
 10293           MOVE ZEROS            TO WS-VIN-REMAINDER
 10294           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10295             REMAINDER WS-VIN-REMAINDER
 10296           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10297              CONTINUE
 10298           ELSE
 10299              MOVE 'N'           TO WS-GOOD-HIN
 10300           END-IF
 10301        ELSE
 10302           MOVE 'N'              TO WS-GOOD-HIN
 10303        END-IF
 10304        IF WS-GOOD-HIN NOT = 'Y'
 10305           MOVE ER-3826           TO WS-ERROR
 10306           PERFORM 9900-ERROR-FORMAT
 10307                                 THRU 9900-EXIT
 10308        END-IF
 10309     END-IF
 10310     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10311        AND (PB-ISSUE)
 10312        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10313        AND (AM-GPCD NOT = 06)
 10314        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10315           perform 3400-edit-vin thru 3400-exit
 10316        ELSE
 10317          MOVE ER-3826           TO WS-ERROR
 10318          PERFORM 9900-ERROR-FORMAT
 10319                                 THRU 9900-EXIT
 10320        END-IF
 10321     END-IF
 10322     if (pb-company-id = 'CID')
 10323        and (pb-issue)
 10324        and (pb-i-vin not = spaces and low-values and zeros)
 10325        perform 3400-edit-vin    thru 3400-exit
 10326     end-if
 10327******************************************************************
 10328******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10329******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10330******* METHODS.
 10331******************************************************************
 10332     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10333        IF PB-CANCELLATION
 10334           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10335              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10336                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10337                IF FORM-MASTER-FOUND
 10338                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10339******************************************************************
 10340
 10341     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10342     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10343
 10344     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10345     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10346     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 189
* EL050.cbl
 10347     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10348
 10349
 10350     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10351     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10352     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10353
 10354     IF AM-LF-OB-RATE NOT NUMERIC
 10355         MOVE ZERO               TO AM-LF-OB-RATE.
 10356
 10357     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10358         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10359
 10360     IF AM-AH-OB-RATE NOT NUMERIC
 10361         MOVE ZERO               TO AM-AH-OB-RATE.
 10362
 10363     IF WS-LF-JOINT-INDICATOR = 'J'
 10364         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10365     ELSE
 10366         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10367
 10368     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10369
 10370     IF WS-IG-OVRD-AM  EQUAL SPACE
 10371         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10372
 10373     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10374         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10375                                       WS-IG-OVRD
 10376     ELSE
 10377         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10378             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10379                                       WS-IG-OVRD
 10380         ELSE
 10381             MOVE AM-IG             TO WS-IG-OVRD-AH
 10382                                       WS-IG-OVRD.
 10383
 10384     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10385         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10386                                       WS-IG-OVRD
 10387     ELSE
 10388         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10389             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10390                                       WS-IG-OVRD
 10391         ELSE
 10392             MOVE AM-IG             TO WS-IG-OVRD-LF
 10393                                       WS-IG-OVRD.
 10394
 10395     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10396     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10397     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10398     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10399*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10400     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10401                                              TO 'PRLDSFCTIA'.
 10402
 10403     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10404     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 190
* EL050.cbl
 10405     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10406     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10407
 10408     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10409     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10410     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10411     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10412     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10413     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10414     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10415
 10416     IF WS-ACCT-AH-DEV-PCT > +0
 10417        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10418     ELSE
 10419        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10420
 10421     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10422        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10423     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10424        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10425
 10426        IF AM-EARN-METHOD-L = 'S'
 10427            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10428                                        WS-LF-REFUND-CALC.
 10429
 10430        IF AM-EARN-METHOD-R = 'S'
 10431            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10432                                        WS-LF-REFUND-CALC.
 10433
 10434     IF WS-LF-COVERAGE-TYPE = 'R'
 10435         IF AM-EARN-METHOD-R = 'R'
 10436            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10437                                    WS-LF-REFUND-CALC.
 10438     IF WS-LF-COVERAGE-TYPE = 'R'
 10439         IF AM-EARN-METHOD-R = 'P'
 10440            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10441                                    WS-LF-REFUND-CALC.
 10442     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10443         IF AM-EARN-METHOD-L = 'R'
 10444            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10445                                    WS-LF-REFUND-CALC.
 10446     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10447         IF AM-EARN-METHOD-L = 'P'
 10448            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10449                                    WS-LF-REFUND-CALC.
 10450     IF WS-LF-COVERAGE-TYPE = 'R'
 10451         IF AM-EARN-METHOD-R = 'A'
 10452            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10453                                    WS-LF-REFUND-CALC.
 10454     IF WS-LF-COVERAGE-TYPE = 'R'
 10455         IF AM-EARN-METHOD-R = 'M'
 10456            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10457                                    WS-LF-REFUND-CALC.
 10458     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10459         IF AM-EARN-METHOD-L = 'A'
 10460            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10461                                    WS-LF-REFUND-CALC.
 10462     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 191
* EL050.cbl
 10463         IF AM-EARN-METHOD-L = 'M'
 10464            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10465                                    WS-LF-REFUND-CALC.
 10466
 10467     IF AM-EARN-METHOD-A = 'R'
 10468        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10469                                    WS-AH-REFUND-CALC.
 10470     IF AM-EARN-METHOD-A = 'P'
 10471        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10472                                    WS-AH-REFUND-CALC.
 10473     IF AM-EARN-METHOD-A = 'C'
 10474        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10475                                    WS-AH-REFUND-CALC.
 10476     IF AM-EARN-METHOD-A = 'A'
 10477        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10478                                    WS-AH-REFUND-CALC.
 10479     IF AM-EARN-METHOD-A = 'M'
 10480        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10481                                    WS-AH-REFUND-CALC.
 10482     IF AM-EARN-METHOD-A = 'N'
 10483        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10484                                    WS-AH-REFUND-CALC.
 10485     IF AM-EARN-METHOD-A = 'S'
 10486        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10487                                    WS-AH-REFUND-CALC.
 10488
 10489     IF AM-TOL-PREM NOT = ZEROS
 10490        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10491                                    WS-TOL-AH-PREM.
 10492
 10493     IF AM-OVR-SHT-AMT NUMERIC AND
 10494                  AM-OVR-SHT-AMT > 0
 10495        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10496                                    EC-AM-LF-OVR-SHT-AMT
 10497                                    WS-AH-REFUND-OVS-AMT
 10498                                    EC-AM-AH-OVR-SHT-AMT.
 10499
 10500     IF AM-OVR-SHT-PCT NUMERIC AND
 10501                    AM-OVR-SHT-PCT > 0
 10502        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10503                                    EC-AM-LF-OVR-SHT-PCT
 10504                                    WS-AH-REFUND-OVS-PCT
 10505                                    EC-AM-AH-OVR-SHT-PCT.
 10506
 10507     IF AM-TOL-REF-PCT NUMERIC AND
 10508                  AM-TOL-REF-PCT > 0
 10509        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10510                                    WS-TOL-AH-REFUND-PCT.
 10511
 10512     IF AM-TOL-REF  NOT = ZEROS  AND
 10513                  AM-TOL-REF NUMERIC
 10514        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10515                                    EC-AM-LF-TOL-REFUND
 10516                                    WS-TOL-AH-REFUND
 10517                                    EC-AM-AH-TOL-REFUND.
 10518
 10519     IF AM-TOL-CLM  NOT = ZEROS
 10520        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 192
* EL050.cbl
 10521                                    WS-TOL-AH-CLAIM.
 10522
 10523     IF AM-CLP-TOL-PCT NOT NUMERIC
 10524        MOVE +0                  TO AM-CLP-TOL-PCT
 10525     END-IF
 10526
 10527     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10528        MOVE +0                  TO AM-SPP-LEASE-COMM
 10529     END-IF
 10530     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10531        MOVE WS-PL-TOL-LF-PREM-PCT
 10532                                 TO WS-TOL-LF-PREM-PCT.
 10533
 10534     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10535        MOVE WS-PL-TOL-AH-PREM-PCT
 10536                                 TO WS-TOL-AH-PREM-PCT.
 10537
 10538     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10539        MOVE WS-PL-TOL-LF-REFUND-PCT
 10540                                 TO WS-TOL-LF-REFUND-PCT.
 10541
 10542     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10543        MOVE WS-PL-TOL-AH-REFUND-PCT
 10544                                 TO WS-TOL-AH-REFUND-PCT.
 10545
 10546     IF WS-PL-REF-OVS-AMT > +0
 10547        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10548
 10549     IF WS-PL-REF-OVS-PCT > +0
 10550        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10551
 10552     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10553        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10554     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10555        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10556     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10557        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10558     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10559        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10560     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10561        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10562     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10563        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10564
 10565     IF WS-AH-PL-REF-OVS-AMT > +0
 10566        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10567
 10568     IF WS-AH-PL-REF-OVS-PCT > +0
 10569        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10570
 10571     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10572     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10573
 10574     IF PB-CANCELLATION
 10575        GO TO 3000-CONTINUE-EDIT.
 10576
 10577     MOVE +1 TO SUB1.
 10578     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 193
* EL050.cbl
 10579     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10580
 10581     IF CF-COMPANY-ID = 'DMD'
 10582       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10583         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10584        ELSE
 10585         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10586
 10587  0525-FIND-ACCT-COMM.
 10588     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10589        NEXT SENTENCE
 10590      ELSE
 10591         ADD +1 TO SUB1
 10592         IF SUB1 LESS +11
 10593            GO TO 0525-FIND-ACCT-COMM
 10594          ELSE
 10595             GO TO 0550-st-comm-cap-check.
 10596
 10597     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10598     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10599                                    PB-I-LIFE-COMMISSION.
 10600***  IF PB-COMPANY-ID = 'CRI'
 10601     IF PB-PREM-ACCTNG-ONLY
 10602         GO TO 0550-st-comm-cap-check.
 10603
 10604     MOVE '0530' TO CTBL-SW.
 10605     MOVE ' '    TO WS-CTBL-READ-SW.
 10606
 10607
 10608 0530-GET-AH-COMP.
 10609     IF NO-AH-COVERAGE  OR
 10610        NO-AH-BENEFIT-MATCH
 10611           GO TO 0540-NEXT-READ-STEP.
 10612
 10613     IF AM-A-COM (SUB1) NUMERIC
 10614        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10615         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10616         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10617         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10618         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10619     ELSE
 10620          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10621          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10622          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10623          MOVE ZEROS             TO WS-SUB1
 10624                                    WS-COMMISSION
 10625          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10626          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10627          IF WS-COMMISSION > ZEROS
 10628             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10629             GO TO 0540-NEXT-READ-STEP
 10630          END-IF
 10631          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10632          IF CTBL-TABLE-FOUND
 10633             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10634                                        PB-I-AH-TERM
 10635             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10636             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 194
* EL050.cbl
 10637             GO TO 0540-NEXT-READ-STEP
 10638          ELSE
 10639             IF FIRST-TIME-THROUGH
 10640                 GO TO 0530-GET-AH-COMP
 10641             ELSE
 10642                 MOVE ER-2609                TO WS-ERROR
 10643                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10644
 10645 0540-NEXT-READ-STEP.
 10646     MOVE '0540' TO CTBL-SW.
 10647     MOVE ' '    TO WS-CTBL-READ-SW.
 10648
 10649 0540-GET-LF-COMP.
 10650     IF NO-LIFE-COVERAGE  OR
 10651        NO-LF-BENEFIT-MATCH
 10652           GO TO 0550-st-comm-cap-check.
 10653
 10654     IF WS-LF-JOINT-INDICATOR = 'J'
 10655        IF AM-J-COM (SUB1) NUMERIC
 10656           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10657           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10658           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10659           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10660           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10661        ELSE
 10662           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10663           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10664           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10665           MOVE ZEROS                TO WS-SUB1
 10666                                        WS-COMMISSION
 10667           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10668           IF WS-COMMISSION > ZEROS
 10669              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10670              GO TO 0550-st-comm-cap-check
 10671           END-IF
 10672           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10673           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10674           IF CTBL-TABLE-FOUND
 10675              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10676              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10677              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10678              GO TO 0550-st-comm-cap-check
 10679           ELSE
 10680              IF FIRST-TIME-THROUGH
 10681                  GO TO 0540-GET-LF-COMP
 10682              ELSE
 10683                  MOVE ER-2609                TO WS-ERROR
 10684                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10685                  GO TO 0550-st-comm-cap-check.
 10686
 10687     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10688        IF AM-L-COM (SUB1) NUMERIC
 10689           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10690           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10691           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10692           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10693           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10694        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 195
* EL050.cbl
 10695           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10696           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10697           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10698           MOVE ZEROS                TO WS-SUB1
 10699                                        WS-COMMISSION
 10700           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10701           IF WS-COMMISSION IS GREATER THAN ZEROS
 10702              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10703              GO TO 0550-st-comm-cap-check
 10704           END-IF
 10705           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10706           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10707           IF CTBL-TABLE-FOUND
 10708              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10709              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10710              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10711              GO TO 0550-st-comm-cap-check
 10712           ELSE
 10713              IF FIRST-TIME-THROUGH
 10714                  GO TO 0540-GET-LF-COMP
 10715              ELSE
 10716                  MOVE ER-2609                TO WS-ERROR
 10717                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10718
 10719 0550-st-comm-cap-check.
 10720
 10721     move +0                     to ws-tot-sl-wk-rate
 10722                                    ws-sl-wk-rate
 10723                                    ws-ga-sl-wk-rate
 10724                                    ws-tot-jl-wk-rate
 10725                                    ws-jl-wk-rate
 10726                                    ws-ga-jl-wk-rate
 10727                                    ws-tot-sa-wk-rate
 10728                                    ws-sa-wk-rate
 10729                                    ws-ga-sa-wk-rate
 10730                                    ws-tot-ja-wk-rate
 10731                                    ws-ja-wk-rate
 10732                                    ws-ga-ja-wk-rate
 10733     perform varying sub5 from +1 by +1 until
 10734        (sub5 > +10)
 10735        move +0                  to ws-wk-rate
 10736        if (am-gl-codes (sub5) <> 'Y')
 10737           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10738           if pb-i-lf-benefit-cd <> '  ' and '00'
 10739              move zeros         to ws-wk-rate
 10740              if (am-l-com (sub5) numeric)
 10741                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10742                 move am-l-com(sub5)
 10743                                 to ws-wk-rate
 10744              else
 10745                 move pb-company-cd to ctbl-company-cd
 10746                 move pb-i-lf-benefit-cd
 10747                                 to ctbl-ben-code
 10748                 move pb-i-lf-term  to ws-work-term
 10749                 move pb-life-override-l1
 10750                                 to ctbl-ben-type
 10751                 move zeros      to ws-sub1
 10752                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 196
* EL050.cbl
 10753                 move am-l-coma (sub5)
 10754                                 to ctbl-table
 10755                 move '0540'     to ctbl-sw
 10756                 perform 0552-get-it
 10757                                 thru 0552-exit
 10758              end-if
 10759              compute ws-tot-sl-wk-rate =
 10760                 ws-tot-sl-wk-rate + ws-wk-rate
 10761              if am-com-typ(sub5) = 'C' or 'D'
 10762                 compute ws-sl-wk-rate =
 10763                    ws-sl-wk-rate + ws-wk-rate
 10764              else
 10765                 if am-com-typ(sub5) = 'O' or 'P'
 10766                    compute ws-ga-sl-wk-rate =
 10767                       ws-ga-sl-wk-rate + ws-wk-rate
 10768                 end-if
 10769              end-if
 10770
 10771              move zeros         to ws-wk-rate
 10772              if (am-j-com (sub5) numeric)
 10773                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10774                 move am-j-com(sub5)
 10775                                 to ws-wk-rate
 10776              else
 10777                 move pb-company-cd to ctbl-company-cd
 10778                 move pb-i-lf-benefit-cd
 10779                                 to ctbl-ben-code
 10780                 move pb-i-lf-term  to ws-work-term
 10781                 move pb-life-override-l1
 10782                                 to ctbl-ben-type
 10783                 move zeros      to ws-sub1
 10784                                    ws-commission
 10785                 move am-j-coma (sub5)
 10786                                 to ctbl-table
 10787                 move '0540'     to ctbl-sw
 10788                 perform 0552-get-it
 10789                                 thru 0552-exit
 10790              end-if
 10791              compute ws-tot-jl-wk-rate =
 10792                 ws-tot-jl-wk-rate + ws-wk-rate
 10793              if am-com-typ(sub5) = 'C' or 'D'
 10794                 compute ws-jl-wk-rate =
 10795                    ws-jl-wk-rate + ws-wk-rate
 10796              else
 10797                 if am-com-typ(sub5) = 'O' or 'P'
 10798                    compute ws-ga-jl-wk-rate =
 10799                       ws-ga-jl-wk-rate + ws-wk-rate
 10800                 end-if
 10801              end-if
 10802           end-if
 10803           move zeros            to ws-wk-rate
 10804
 10805           if pb-i-ah-benefit-cd <> '  ' and '00'
 10806              if (am-a-com (sub5) numeric)
 10807                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10808                 move am-a-com(sub5)
 10809                                 to ws-wk-rate
 10810              else
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 197
* EL050.cbl
 10811                 move pb-company-cd to ctbl-company-cd
 10812                 move pb-i-ah-benefit-cd
 10813                                 to ctbl-ben-code
 10814                 move pb-i-ah-term  to ws-work-term
 10815                 move pb-ah-override-l1
 10816                                 to ctbl-ben-type
 10817                 move zeros      to ws-sub1
 10818                                    ws-commission
 10819                 move am-a-coma (sub5)
 10820                                 to ctbl-table
 10821                 move '0530'     to ctbl-sw
 10822                 perform 0552-get-it
 10823                                 thru 0552-exit
 10824              end-if
 10825              compute ws-tot-sa-wk-rate =
 10826                 ws-tot-sa-wk-rate + ws-wk-rate
 10827              if am-com-typ(sub5) = 'C' or 'D'
 10828                 compute ws-sa-wk-rate =
 10829                    ws-sa-wk-rate + ws-wk-rate
 10830              else
 10831                 if am-com-typ(sub5) = 'O' or 'P'
 10832                    compute ws-ga-sa-wk-rate =
 10833                       ws-ga-sa-wk-rate + ws-wk-rate
 10834                 end-if
 10835              end-if
 10836           end-if
 10837        end-if
 10838     end-perform
 10839
 10840     go to 0550-continue
 10841
 10842     .
 10843 0552-get-it.
 10844
 10845     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10846     MOVE ZEROS                  TO WS-SUB1
 10847                                    WS-COMMISSION
 10848     MOVE ' '                    TO WS-CTBL-READ-SW
 10849     PERFORM 8300-READ-CTBL-TABLE
 10850                                 THRU 8300-EXIT
 10851     IF FIRST-TIME-THROUGH
 10852        MOVE 'AA'                TO CTBL-BEN-CODE
 10853        PERFORM 8300-READ-CTBL-TABLE
 10854                                 THRU 8300-EXIT
 10855     END-IF
 10856     IF CTBL-TABLE-FOUND
 10857        if pb-life-override-l1 = ctbl-ben-type
 10858           move pb-i-lf-benefit-amt
 10859                                 to WS-COMM-CK-AMT
 10860        else
 10861           compute ws-comm-ck-amt =
 10862              pb-I-ah-benefit-amt * pb-i-ah-term
 10863        end-if
 10864        PERFORM 8800-GET-COMP-RATE
 10865                                 THRU 8800-EXIT
 10866     else
 10867        move zeros               to ws-wk-rate
 10868     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 198
* EL050.cbl
 10869
 10870     .
 10871 0552-exit.
 10872     exit.
 10873
 10874 0550-continue.
 10875
 10876     if ws-lf-joint-indicator = 'J'
 10877        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10878           and (ws-st-comm-cap-jl <> zeros)
 10879           MOVE ER-1956          TO WS-ERROR
 10880           PERFORM 9900-ERROR-FORMAT
 10881                                 THRU 9900-EXIT
 10882        end-if
 10883        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10884           and (ws-st-ga-comm-cap-jl <> zeros)
 10885           MOVE ER-1959          TO WS-ERROR
 10886           PERFORM 9900-ERROR-FORMAT
 10887                                 THRU 9900-EXIT
 10888        end-if
 10889        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10890           and (ws-st-tot-comm-cap-jl <> zeros)
 10891           MOVE ER-1962          TO WS-ERROR
 10892           PERFORM 9900-ERROR-FORMAT
 10893                                 THRU 9900-EXIT
 10894        end-if
 10895     else
 10896        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10897           and (ws-st-comm-cap-sl <> zeros)
 10898           MOVE ER-1955          TO WS-ERROR
 10899           PERFORM 9900-ERROR-FORMAT
 10900                                 THRU 9900-EXIT
 10901        end-if
 10902        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10903           and (ws-st-ga-comm-cap-sl <> zeros)
 10904           MOVE ER-1958          TO WS-ERROR
 10905           PERFORM 9900-ERROR-FORMAT
 10906                                 THRU 9900-EXIT
 10907        end-if
 10908        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10909           and (ws-st-tot-comm-cap-sl <> zeros)
 10910           MOVE ER-1961          TO WS-ERROR
 10911           PERFORM 9900-ERROR-FORMAT
 10912                                 THRU 9900-EXIT
 10913        end-if
 10914
 10915     if ws-ah-joint-indicator = 'J'
 10916        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10917           and (ws-st-comm-cap-ja <> zeros)
 10918           MOVE ER-1957          TO WS-ERROR
 10919           PERFORM 9900-ERROR-FORMAT
 10920                                 THRU 9900-EXIT
 10921        end-if
 10922        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10923           and (ws-st-ga-comm-cap-ja <> zeros)
 10924           MOVE ER-1960          TO WS-ERROR
 10925           PERFORM 9900-ERROR-FORMAT
 10926                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 199
* EL050.cbl
 10927        end-if
 10928        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10929           and (ws-st-tot-comm-cap-ja <> zeros)
 10930           MOVE ER-1963          TO WS-ERROR
 10931           PERFORM 9900-ERROR-FORMAT
 10932                                 THRU 9900-EXIT
 10933        end-if
 10934     else
 10935        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10936           and (ws-st-comm-cap-sa <> zeros)
 10937           MOVE ER-1957          TO WS-ERROR
 10938           PERFORM 9900-ERROR-FORMAT
 10939                                 THRU 9900-EXIT
 10940        end-if
 10941        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10942           and (ws-st-ga-comm-cap-sa <> zeros)
 10943           MOVE ER-1960          TO WS-ERROR
 10944           PERFORM 9900-ERROR-FORMAT
 10945                                 THRU 9900-EXIT
 10946        end-if
 10947        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10948           and (ws-st-tot-comm-cap-sa <> zeros)
 10949           MOVE ER-1963          TO WS-ERROR
 10950           PERFORM 9900-ERROR-FORMAT
 10951                                 THRU 9900-EXIT
 10952        end-if
 10953     end-if
 10954     .
 10955 0560-EDIT-CONTINUE.
 10956     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10957                                    WS-AH-PMF-COMM
 10958*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10959*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10960     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10961        (SUB1 > +10)
 10962        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10963           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10964           MOVE '0530'           TO CTBL-SW
 10965           MOVE ' '              TO WS-CTBL-READ-SW
 10966           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10967           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10968           MOVE '0540'           TO CTBL-SW
 10969           MOVE ' '              TO WS-CTBL-READ-SW
 10970           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10971        END-IF
 10972     END-PERFORM
 10973     GO TO 0564-EDIT-CONTINUE
 10974     .
 10975 0561-CHECK-AH.
 10976     IF (NO-AH-COVERAGE)
 10977        OR (NO-AH-BENEFIT-MATCH)
 10978        CONTINUE
 10979     ELSE
 10980        IF (AM-A-COM (SUB1) NUMERIC)
 10981           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10982           IF (AM-COM-TYP (SUB1) = 'A')
 10983              AND (WS-AH-PMF-COMM = ZEROS)
 10984              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 200
* EL050.cbl
 10985           END-IF
 10986           CONTINUE
 10987        ELSE
 10988           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10989           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10990           MOVE PB-AH-OVERRIDE-L1
 10991                                 TO CTBL-BEN-TYPE
 10992           MOVE ZEROS            TO WS-SUB1
 10993                                    WS-COMMISSION
 10994           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10995           PERFORM 8300-READ-CTBL-TABLE
 10996                                 THRU 8300-EXIT
 10997           IF CTBL-TABLE-FOUND
 10998              IF (AM-COM-TYP (SUB1) = 'A')
 10999                 AND (WS-AH-PMF-COMM = ZEROS)
 11000                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11001                                        PB-I-AH-TERM
 11002                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11003                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11004              END-IF
 11005              CONTINUE
 11006           ELSE
 11007              IF FIRST-TIME-THROUGH
 11008                 GO TO 0561-CHECK-AH
 11009              ELSE
 11010                 MOVE ER-2609    TO WS-ERROR
 11011                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11012              END-IF
 11013           END-IF
 11014        END-IF
 11015     END-IF
 11016     .
 11017 0561-EXIT.
 11018     EXIT.
 11019 0563-CHECK-LF.
 11020     IF (NO-LIFE-COVERAGE)
 11021        OR (NO-LF-BENEFIT-MATCH)
 11022        CONTINUE
 11023     ELSE
 11024        IF WS-LF-JOINT-INDICATOR = 'J'
 11025           IF AM-J-COM (SUB1) NUMERIC
 11026              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11027              IF (AM-COM-TYP (SUB1) = 'A')
 11028                 AND (WS-LF-PMF-COMM = ZEROS)
 11029                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11030              END-IF
 11031              CONTINUE
 11032           ELSE
 11033              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11034              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11035              MOVE PB-LIFE-OVERRIDE-L1
 11036                                 TO CTBL-BEN-TYPE
 11037              MOVE ZEROS         TO WS-SUB1
 11038                                    WS-COMMISSION
 11039              MOVE AM-J-COMA (SUB1)
 11040                                 TO CTBL-TABLE
 11041              PERFORM 8300-READ-CTBL-TABLE
 11042                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 201
* EL050.cbl
 11043              IF CTBL-TABLE-FOUND
 11044                 IF (AM-COM-TYP (SUB1) = 'A')
 11045                    AND (WS-LF-PMF-COMM = ZEROS)
 11046                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11047                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11048                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11049                 END-IF
 11050                 CONTINUE
 11051              ELSE
 11052                 IF FIRST-TIME-THROUGH
 11053                    GO TO 0563-CHECK-LF
 11054                 ELSE
 11055                    MOVE ER-2609 TO WS-ERROR
 11056                    PERFORM 9900-ERROR-FORMAT
 11057                                 THRU 9900-EXIT
 11058*                   GO TO 0560-EDIT-CONTINUE
 11059                 END-IF
 11060              END-IF
 11061           END-IF
 11062        ELSE
 11063           IF AM-L-COM (SUB1) NUMERIC
 11064              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11065              IF (AM-COM-TYP (SUB1) = 'A')
 11066                 AND (WS-LF-PMF-COMM = ZEROS)
 11067                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11068              END-IF
 11069              CONTINUE
 11070           ELSE
 11071              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11072              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11073              MOVE PB-LIFE-OVERRIDE-L1
 11074                                 TO CTBL-BEN-TYPE
 11075              MOVE ZEROS         TO WS-SUB1
 11076                                    WS-COMMISSION
 11077              MOVE AM-L-COMA (SUB1)
 11078                                 TO CTBL-TABLE
 11079              PERFORM 8300-READ-CTBL-TABLE
 11080                                 THRU 8300-EXIT
 11081              IF CTBL-TABLE-FOUND
 11082                 CONTINUE
 11083              ELSE
 11084                 IF FIRST-TIME-THROUGH
 11085                    GO TO 0563-CHECK-LF
 11086                 ELSE
 11087                    MOVE ER-2609 TO WS-ERROR
 11088                    PERFORM 9900-ERROR-FORMAT
 11089                                 THRU 9900-EXIT
 11090                 END-IF
 11091              END-IF
 11092           END-IF
 11093        END-IF
 11094     END-IF
 11095     .
 11096 0563-EXIT.
 11097     EXIT.
 11098 0564-EDIT-CONTINUE.
 11099
 11100     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 202
* EL050.cbl
 11101         IF PB-I-NUM-BILLED EQUAL ZEROS
 11102            MOVE ER-8148       TO WS-ERROR
 11103            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11104
 11105*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11106*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11107*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11108*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11109*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11110*         IF NO-CONVERSION-ERROR
 11111*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11112*         ELSE
 11113*             IF PB-COMPANY-ID EQUAL 'HAN'
 11114*                 MOVE ZEROS     TO PB-I-AGE.
 11115     IF PB-I-BIRTHDAY > LOW-VALUES
 11116        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11117        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11118        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11119        PERFORM 8500-DATE-CONVERT
 11120                                 THRU 8500-EXIT
 11121        IF NO-CONVERSION-ERROR
 11122           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11123           IF PB-I-AGE > ZEROS
 11124              IF WS-WORK-AGE NOT = PB-I-AGE
 11125                 MOVE ER-9501    TO WS-ERROR
 11126                 PERFORM 9900-ERROR-FORMAT
 11127                                 THRU 9900-EXIT
 11128              END-IF
 11129           ELSE
 11130              MOVE WS-WORK-AGE   TO PB-I-AGE
 11131           END-IF
 11132        END-IF
 11133     END-IF
 11134     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11135                                   WS-INS-AGE-SET
 11136     IF PB-I-AGE = ZEROS
 11137        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11138           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11139                                   WS-INS-AGE-SET
 11140           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11141
 11142     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11143                                   WS-AH-EDIT-AGE.
 11144
 11145     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11146        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11147        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11148        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11149        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11150        IF NO-CONVERSION-ERROR
 11151           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11152           IF PB-I-JOINT-AGE > 0
 11153              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11154                 MOVE ER-9503    TO WS-ERROR
 11155                 PERFORM 9900-ERROR-FORMAT
 11156                                 THRU 9900-EXIT
 11157              END-IF
 11158           ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 203
* EL050.cbl
 11159              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11160           END-IF
 11161        ELSE
 11162           MOVE ZEROS            TO PB-I-JOINT-AGE
 11163        END-IF
 11164     END-IF
 11165     IF PB-I-JOINT-AGE NOT NUMERIC
 11166        MOVE ZERO               TO PB-I-JOINT-AGE.
 11167
 11168     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11169                                   WS-JNT-AGE-SET
 11170     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11171        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11172           (WS-AH-JOINT-INDICATOR = 'J')
 11173           IF PB-I-JOINT-AGE = ZEROS
 11174               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11175                                          WS-JNT-AGE-SET
 11176               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11177           END-IF
 11178        END-IF
 11179     END-IF
 11180
 11181     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11182     IF WS-LF-JOINT-INDICATOR = 'J'
 11183        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11184        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11185            IF  PB-I-JOINT-AGE = ZERO
 11186                MOVE ER-2686       TO WS-ERROR
 11187                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11188            ELSE
 11189                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11190                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11191                    IF PB-COMPANY-ID NOT = 'LBL'
 11192                        MOVE ER-2685    TO WS-ERROR
 11193                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11194
 11195     IF WS-AH-JOINT-INDICATOR = 'J'
 11196        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11197            IF  PB-I-JOINT-AGE = ZERO
 11198                MOVE ER-2686       TO WS-ERROR
 11199                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11200            ELSE
 11201                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11202                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11203                                           WS-EDIT-AGE
 11204                    IF PB-COMPANY-ID NOT = 'LBL'
 11205                        MOVE ER-2685    TO WS-ERROR
 11206                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11207
 11208******************************************************************
 11209*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11210******************************************************************
 11211
 11212     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11213        (WS-AH-SPECIAL-CALC-CD = 'O')
 11214        NEXT SENTENCE
 11215     ELSE
 11216        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 204
* EL050.cbl
 11217          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11218           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11219            WS-AH-JOINT-INDICATOR = 'J')  AND
 11220           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11221            MOVE ER-2627             TO WS-ERROR
 11222            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11223
 11224     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11225        (WS-AH-SPECIAL-CALC-CD = 'O')
 11226         NEXT SENTENCE
 11227     ELSE
 11228         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11229            WS-AH-JOINT-INDICATOR = 'J'
 11230             IF PB-I-JOINT-INSURED = SPACES
 11231                 IF PB-COMPANY-ID NOT = 'JAL'
 11232                     MOVE ER-2696    TO WS-ERROR
 11233                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11234
 11235     IF PB-COMPANY-ID NOT = 'BOA'
 11236        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11237           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11238           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11239               PB-I-JOINT-INSURED NOT = SPACES)
 11240                MOVE ER-2691         TO WS-ERROR
 11241                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11242
 11243     IF PB-COMPANY-ID = 'BOA'
 11244        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11245           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11246            IF PB-I-JOINT-AGE NOT = ZEROS
 11247                MOVE ER-2691         TO WS-ERROR
 11248                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11249
 11250     IF PB-COMPANY-ID = 'CRI'
 11251        IF PB-I-SIG-SW = 'J'
 11252           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11253              WS-AH-JOINT-INDICATOR NOT = 'J'
 11254              MOVE ER-2675       TO WS-ERROR
 11255              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11256
 11257     IF PB-COMPANY-ID = 'CRI'
 11258        IF PB-I-SIG-SW = 'S'
 11259           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11260              WS-AH-JOINT-INDICATOR = 'J'
 11261              MOVE ER-2676       TO WS-ERROR
 11262              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11263
 11264     IF PB-COMPANY-ID = 'CVL'
 11265         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11266            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11267              MOVE ER-2783           TO WS-ERROR
 11268              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11269     IF (WS-LF-JOINT-INDICATOR = 'J')
 11270        AND (WS-AH-JOINT-INDICATOR = 'J')
 11271        AND (PB-I-LF-TERM > 120)
 11272        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11273        MOVE ER-2783             TO WS-ERROR
 11274        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 205
* EL050.cbl
 11275     END-IF
 11276     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11277
 11278     IF PB-I-INDV-GRP-OVRD = 'I'
 11279        MOVE ER-2666             TO WS-ERROR
 11280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11281        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11282
 11283     IF PB-I-INDV-GRP-OVRD = 'G'
 11284        MOVE ER-2666             TO WS-ERROR
 11285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11286        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11287
 11288     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11289        NEXT SENTENCE
 11290     ELSE
 11291        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11292
 11293     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11294        IF WS-ERROR = ER-2666
 11295           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11296           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11297
 11298     IF PB-COMPANY-ID = 'CID'
 11299        IF PB-STATE = 'UT' OR 'MO'
 11300           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11301                 OR '76' OR '77')
 11302                      OR
 11303               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11304                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11305                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11306                   OR '2K' OR '2L'))
 11307              AND PB-I-INDV-GRP-CD = 'I'
 11308              MOVE ER-2721             TO WS-ERROR
 11309              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11310           END-IF
 11311        END-IF
 11312     END-IF
 11313
 11314     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11315     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11316        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11317     ELSE
 11318        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11319     END-IF
 11320
 11321*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11322*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11323     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11324                                    ACCOUNT-AH-CK-SW.
 11325
 11326     IF PB-REISSUED-CERT       OR
 11327        PB-REIN-ONLY-CERT      OR
 11328        PB-POLICY-IS-DECLINED  OR
 11329        PB-POLICY-IS-VOIDED
 11330*       OR PB-MONTHLY-CERT
 11331         GO TO 3000-CONTINUE-EDIT.
 11332
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 206
* EL050.cbl
 11333     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11334        IF WS-EDIT-AGE           > +65
 11335           MOVE ER-2709          TO WS-ERROR
 11336           PERFORM 9900-ERROR-FORMAT
 11337                                 THRU 9900-EXIT
 11338        ELSE
 11339           IF WS-EDIT-AGE        > +55
 11340              MOVE ER-2718       TO WS-ERROR
 11341              PERFORM 9900-ERROR-FORMAT
 11342                                 THRU 9900-EXIT
 11343           END-IF
 11344        END-IF
 11345     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11346        IF WS-EDIT-AGE           > +65
 11347           MOVE ER-2709          TO WS-ERROR
 11348           PERFORM 9900-ERROR-FORMAT
 11349                                 THRU 9900-EXIT
 11350        END-IF
 11351     END-IF
 11352     .
 11353
 11354 0565-LIFE-PLAN-LIMIT-EDITS.
 11355
 11356     IF NOT LF-PLAN-MASTER-FOUND
 11357        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11358                                    EC-AM-LF-MAX-TOT-BEN
 11359        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11360
 11361     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11362
 11363     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11364         IF PL-LM-AGE (1) = ZEROS
 11365             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11366
 11367     IF NO-LF-BENEFIT-MATCH          OR
 11368        WS-LF-BENEFIT-CD = ZEROS     OR
 11369        WS-LF-SPECIAL-CALC-CD = 'M'
 11370        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11371
 11372     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11373     MOVE +1                     TO SUB2.
 11374
 11375     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11376        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11377           MOVE +5   TO SUB2
 11378           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11379              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11380              (PL-LM-AGE (SUB2) EQUAL +0)
 11381              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11382              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11383
 11384     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11385
 11386     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11387                               + PB-I-LF-ALT-BENEFIT-AMT.
 11388
 11389 0568-CHECK-LIFE-ATT-AGE.
 11390
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 207
* EL050.cbl
 11391     IF PL-ATT-AGE NUMERIC AND
 11392        PL-ATT-AGE > +0
 11393        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11394     END-IF
 11395*    IF PL-ATT-AGE NUMERIC AND
 11396*       PL-ATT-AGE > +0
 11397*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11398*       IF PB-I-BIRTHDAY > LOW-VALUES
 11399*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11400*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11401*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11402*          SET BIN-PLUS-ELAPSED  TO TRUE
 11403*          PERFORM 8500-DATE-CONVERT
 11404*                                THRU 8500-EXIT
 11405*          IF NO-CONVERSION-ERROR
 11406*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11407*             MOVE ER-2669       TO WS-ERROR
 11408*             PERFORM 9900-ERROR-FORMAT
 11409*                                THRU 9900-EXIT
 11410*          END-IF
 11411*       ELSE
 11412*          IF WS-ATT-AGE >= PL-ATT-AGE
 11413*             MOVE ER-2669       TO WS-ERROR
 11414*             PERFORM 9900-ERROR-FORMAT
 11415*                                THRU 9900-EXIT
 11416*          END-IF
 11417*       END-IF
 11418*    END-IF
 11419     .
 11420 0570-CHECK-LIFE-LIMITS.
 11421
 11422     IF PB-COMPANY-ID EQUAL 'CRI'
 11423        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11424           IF SUB2 GREATER THAN +4
 11425              MOVE ER-2637 TO WS-ERROR
 11426              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11427              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11428
 11429     IF PB-COMPANY-ID  =  'NCL'
 11430        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11431            SUB2 GREATER THAN +8
 11432             MOVE 'U'         TO PB-BATCH-ENTRY
 11433             MOVE ER-2637     TO WS-ERROR
 11434             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11435             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11436
 11437     IF SUB2 > +8
 11438        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11439           AND (PB-I-SIG-SW = 'Y')
 11440           CONTINUE
 11441        ELSE
 11442           MOVE ER-2637          TO WS-ERROR
 11443           PERFORM 9900-ERROR-FORMAT
 11444                                 THRU 9900-EXIT
 11445        END-IF
 11446        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11447     END-IF
 11448     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 208
* EL050.cbl
 11449     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11450     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11451
 11452     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11453        ADD +1  TO SUB2
 11454        GO TO 0570-CHECK-LIFE-LIMITS.
 11455
 11456     IF PB-COMPANY-ID = 'NCL'
 11457         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11458
 11459     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11460        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11461        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11462           AND (PB-I-SIG-SW = 'Y')
 11463           CONTINUE
 11464        ELSE
 11465           MOVE ER-2637          TO WS-ERROR
 11466           PERFORM 9900-ERROR-FORMAT
 11467                                 THRU 9900-EXIT
 11468        END-IF
 11469     END-IF
 11470     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11471
 11472
 11473 0570-CHECK-NCL-LIFE-LIMITS.
 11474
 11475     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11476        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11477         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11478
 11479     IF APP-CERT-USED
 11480         IF SUB2  LESS THAN  +5
 11481             MOVE +5          TO SUB2
 11482             GO TO 0570-CHECK-LIFE-LIMITS.
 11483
 11484     MOVE ER-2637             TO WS-ERROR.
 11485     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11486
 11487     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11488
 11489 0575-CHECK-NCL-SIG-SWITCH.
 11490
 11491     IF NOT APP-CERT-USED
 11492         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11493
 11494     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11495        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11496        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11497        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11498         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11499
 11500     IF SUB2 GREATER THAN +4
 11501         IF PL-LM-AGE (5) = ZEROS  AND
 11502            PL-LM-AGE (6) = ZEROS  AND
 11503            PL-LM-AGE (7) = ZEROS  AND
 11504            PL-LM-AGE (8) = ZEROS
 11505             MOVE  ER-1927        TO WS-ERROR
 11506             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 209
* EL050.cbl
 11507             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11508         ELSE
 11509             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11510                 MOVE  ER-1920    TO WS-ERROR
 11511                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11512
 11513     IF PB-I-SIG-SW  = 'Y'
 11514       IF NOT PB-I-POLICY-ACCEPTED  AND
 11515          NOT PB-I-POLICY-DECLINED
 11516           MOVE 'U'               TO PB-BATCH-ENTRY
 11517           MOVE  ER-1926          TO WS-ERROR
 11518           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11519
 11520
 11521 0580-AH-PLAN-LIMIT-EDITS.
 11522
 11523     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11524        IF PB-I-AH-BENEFIT-AMT > +1250
 11525           MOVE ER-2702          TO WS-ERROR
 11526           PERFORM 9900-ERROR-FORMAT
 11527                                 THRU 9900-EXIT
 11528        END-IF
 11529     END-IF
 11530
 11531     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11532        AND (PB-MONTHLY-CERT)
 11533        IF PB-I-AH-BENEFIT-AMT > +3000
 11534           MOVE ER-2881          TO WS-ERROR
 11535           PERFORM 9900-ERROR-FORMAT
 11536                                 THRU 9900-EXIT
 11537        END-IF
 11538     END-IF
 11539     IF NOT AH-PLAN-MASTER-FOUND
 11540        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11541        GO TO 3000-CONTINUE-EDIT.
 11542
 11543     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11544
 11545     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11546         IF PL-LM-AGE (1) = ZEROS
 11547             GO TO 3000-CONTINUE-EDIT.
 11548
 11549     IF NO-AH-BENEFIT-MATCH          OR
 11550        WS-AH-BENEFIT-CD = ZEROS     OR
 11551        WS-AH-SPECIAL-CALC-CD = 'M'
 11552        GO TO 3000-CONTINUE-EDIT.
 11553
 11554     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11555     MOVE +1                     TO SUB2.
 11556
 11557     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11558        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11559           MOVE +5 TO SUB2
 11560           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11561              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11562              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11563              (PL-LM-AGE (SUB2) EQUAL +0)
 11564              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 210
* EL050.cbl
 11565              GO TO 3000-CONTINUE-EDIT.
 11566
 11567     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11568
 11569 0590-CHECK-AH-ATT-AGE.
 11570
 11571     IF PL-ATT-AGE NUMERIC AND
 11572        PL-ATT-AGE GREATER THAN +0
 11573        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11574     END-IF
 11575*       IF WS-ATT-AGE >= PL-ATT-AGE
 11576*          MOVE ER-3054          TO WS-ERROR
 11577*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11578     .
 11579 0597-CHECK-AH-LIMITS.
 11580
 11581     IF PB-COMPANY-ID EQUAL 'CRI'
 11582        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11583           IF SUB2 GREATER THAN +4
 11584              MOVE ER-2638       TO WS-ERROR
 11585              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11586              GO TO 3000-CONTINUE-EDIT.
 11587
 11588     IF PB-COMPANY-ID  =  'NCL'
 11589        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11590            SUB2 GREATER THAN +8
 11591             MOVE 'U'            TO PB-BATCH-ENTRY
 11592             MOVE ER-2638        TO WS-ERROR
 11593             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11594             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11595
 11596     IF SUB2 > +8
 11597        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11598           AND (PB-I-SIG-SW = 'Y')
 11599           CONTINUE
 11600        ELSE
 11601           MOVE ER-2638          TO WS-ERROR
 11602           PERFORM 9900-ERROR-FORMAT
 11603                                 THRU 9900-EXIT
 11604        END-IF
 11605        GO TO 3000-CONTINUE-EDIT
 11606     END-IF
 11607
 11608     IF PB-COMPANY-ID = 'CRI'
 11609        IF WS-ERROR = ER-2638
 11610           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11611
 11612     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11613     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11614     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11615     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11616
 11617     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11618        ADD +1                   TO SUB2
 11619        GO TO 0597-CHECK-AH-LIMITS.
 11620
 11621     IF PB-COMPANY-ID = 'NCL'
 11622         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 211
* EL050.cbl
 11623
 11624     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11625        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11626        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11627                                 > PL-LM-AMT (SUB2))
 11628        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11629           AND (PB-I-SIG-SW = 'Y')
 11630           CONTINUE
 11631        ELSE
 11632           MOVE ER-2638          TO WS-ERROR
 11633           PERFORM 9900-ERROR-FORMAT
 11634                                 THRU 9900-EXIT
 11635        END-IF
 11636     END-IF
 11637
 11638     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11639         IF  WS-ERROR    EQUAL    ER-2638
 11640             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11641                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11642                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11643                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11644                MOVE  ER-1910    TO  WS-ERROR
 11645                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11646
 11647     IF PB-COMPANY-ID = 'CRI'
 11648        IF WS-ERROR = ER-2638
 11649            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11650            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11651            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11652
 11653     GO TO 3000-CONTINUE-EDIT.
 11654
 11655 0597-CHECK-NCL-AH-LIMITS.
 11656
 11657     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11658        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11659        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11660                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11661         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11662
 11663     IF APP-CERT-USED
 11664         IF SUB2  LESS THAN  +5
 11665             MOVE +5             TO SUB2
 11666             GO TO 0597-CHECK-AH-LIMITS.
 11667
 11668     MOVE ER-2638                TO WS-ERROR.
 11669     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11670
 11671     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11672
 11673 0599-CHECK-NCL-SIG-SWITCH.
 11674
 11675     IF NOT APP-CERT-USED
 11676         GO TO 3000-CONTINUE-EDIT.
 11677
 11678     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11679        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11680        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 212
* EL050.cbl
 11681        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11682         GO TO 3000-CONTINUE-EDIT.
 11683
 11684     IF SUB2 GREATER THAN +4
 11685         IF PL-LM-AGE (5) = ZEROS  AND
 11686            PL-LM-AGE (6) = ZEROS  AND
 11687            PL-LM-AGE (7) = ZEROS  AND
 11688            PL-LM-AGE (8) = ZEROS
 11689             MOVE  ER-1927        TO WS-ERROR
 11690             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11691             GO TO 3000-CONTINUE-EDIT
 11692         ELSE
 11693             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11694                 MOVE  ER-1920    TO WS-ERROR
 11695                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11696
 11697     IF PB-I-SIG-SW  = 'Y'
 11698       IF NOT PB-I-POLICY-ACCEPTED  AND
 11699          NOT PB-I-POLICY-DECLINED
 11700           MOVE 'U'               TO PB-BATCH-ENTRY
 11701           MOVE  ER-1926          TO WS-ERROR
 11702           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11703
 11704******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 213
* EL050.cbl
 11706
 11707 3000-CONTINUE-EDIT.
 11708
 11709     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11710     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11711     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11712     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11713     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11714
 11715     IF BROWSE-STARTED
 11716        PERFORM 9990-RETURN THRU 9990-EXIT
 11717        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11718
 11719     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11720        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11721        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11722        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11723*       MOVE 1                   TO DC-OPTION-CODE
 11724        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11725        IF DATE-CONVERSION-ERROR
 11726           MOVE ER-2622          TO WS-ERROR
 11727           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11728        ELSE
 11729           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11730              MOVE ER-2623       TO WS-ERROR
 11731              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11732           ELSE
 11733              MOVE ER-2622       TO WS-ERROR
 11734              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11735
 11736     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11737     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11738     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11739*    MOVE 1                      TO DC-OPTION-CODE.
 11740     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11741     IF DATE-CONVERSION-ERROR
 11742        GO TO 3005-EDIT-CONTINUE
 11743     ELSE
 11744        IF DC-ELAPSED-DAYS GREATER +180
 11745           MOVE ER-2613          TO WS-ERROR
 11746           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747        ELSE
 11748           IF DC-ELAPSED-DAYS GREATER +90
 11749              MOVE ER-2612       TO WS-ERROR
 11750              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11751           ELSE
 11752             IF DC-ELAPSED-DAYS GREATER +60
 11753                MOVE ER-2614     TO WS-ERROR
 11754                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11755
 11756 3005-EDIT-CONTINUE.
 11757
 11758     IF PB-CANCELLATION
 11759         GO TO 3700-EDIT-CANCEL.
 11760
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 214
* EL050.cbl
 11762******************************************************************
 11763*                  E D I T   I S S U E                           *
 11764******************************************************************
 11765
 11766 3020-EDIT-ISSUE.
 11767
 11768      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11769      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11770      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11771      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11772      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11773
 11774     IF PB-ISSUE-FORCE
 11775        OR PB-ISSUE-DATE-FORCED
 11776        OR PB-FORCE-OFF
 11777        OR PB-OVERCHARGE-FORCE
 11778        or pb-exceeded-limit-forced
 11779        CONTINUE
 11780     ELSE
 11781        MOVE ER-2670             TO WS-ERROR
 11782        PERFORM 9900-ERROR-FORMAT
 11783                                 THRU 9900-EXIT
 11784     END-IF
 11785     .
 11786 3022-SET-POLICY-STATUS.
 11787
 11788     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11789
 11790     IF (PB-REISSUED-CERT)
 11791             OR
 11792        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11793         AND (PB-MONTHLY-CERT))
 11794         MOVE '5'                TO PB-I-ENTRY-STATUS
 11795         MOVE 'E'                TO PB-BATCH-ENTRY
 11796     END-IF
 11797
 11798     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11799        IF PB-MONTHLY-CERT
 11800           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11801        END-IF
 11802        IF PB-CASH-CERT
 11803           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11804        END-IF
 11805     END-IF
 11806     IF PB-POLICY-IS-DECLINED
 11807         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11808     IF PB-POLICY-IS-VOIDED
 11809         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11810     IF PB-NEEDS-UNDERWRITING
 11811         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11812     IF PB-REIN-ONLY-CERT
 11813         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11814     IF PB-PREM-ACCTNG-ONLY
 11815         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11816
 11817     MOVE SPACE                  TO PB-I-OB-FLAG.
 11818
 11819     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 215
* EL050.cbl
 11820         MOVE ER-2665            TO WS-ERROR
 11821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11822         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11823
 11824     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11825        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11826           MOVE 'Z'             TO PB-I-OB-FLAG.
 11827
 11828     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11829        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11830           MOVE 'Z'             TO PB-I-OB-FLAG.
 11831
 11832     IF ACCOUNT-MAST-FOUND
 11833         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11834         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11835         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11836         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11837         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11838         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11839         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11840     END-IF
 11841
 11842     IF ACCOUNT-MAST-FOUND
 11843        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11844         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11845
 11846     IF (ACCOUNT-MAST-FOUND)
 11847*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11848        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11849        IF PB-REISSUED-CERT
 11850           CONTINUE
 11851        ELSE
 11852           MOVE ER-2608          TO WS-ERROR
 11853           PERFORM 9900-ERROR-FORMAT
 11854                                 THRU 9900-EXIT
 11855         END-IF
 11856     END-IF
 11857
 11858     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11859        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11860        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11861
 11862**********   DMD CUSTOM CODE FOLLOWS  **********
 11863 3024-EDIT-DMD-FIELDS.
 11864     IF PB-COMPANY-ID NOT = 'DMD'
 11865        GO TO 3025-EDIT-REINSURANCE.
 11866
 11867*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11868*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11869*** ERROR IF THEY ARE NOT EQUAL.
 11870
 11871     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11872     SET BIN-TO-GREG               TO TRUE.
 11873     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11874     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11875**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11876
 11877     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 216
* EL050.cbl
 11878     SET BIN-TO-GREG               TO TRUE.
 11879     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11880     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11881**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11882
 11883     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11884        MOVE ER-8116               TO WS-ERROR
 11885        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11886
 11887     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11888
 11889     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11890                                      WK-FULL-CERT-NO.
 11891     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11892
 11893     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11894
 11895     IF PB-VALID-LIFE
 11896        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11897     ELSE
 11898        IF PB-VALID-AH
 11899          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11900
 11901
 11902     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11903     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11904     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11905                                      DCUA-UNDRWRTR-CODE
 11906                                      DCUA-UNDRWRTR-GROUP-CODE
 11907                                      DCUA-RETURN-CODE.
 11908
 11909****************************************************************
 11910*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11911***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11912***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11913***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11914***   TO THIS RECORD.                                        ***
 11915****************************************************************
 11916     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11917     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11918     IF DCUA-SUCCESSFUL-PROCESS
 11919        GO TO 3024-EDIT-DL7-CONT.
 11920
 11921     IF DCUA-RETURN-CODE EQUAL '01'
 11922        MOVE ER-8110               TO WS-ERROR
 11923        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11924        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11925        GO TO 3024-EDIT-DL7-CONT.
 11926
 11927     IF DCUA-RETURN-CODE EQUAL '02'
 11928        MOVE ER-8111               TO WS-ERROR
 11929        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11930        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11931        GO TO 3024-EDIT-DL7-CONT.
 11932
 11933     IF DCUA-RETURN-CODE EQUAL '03'
 11934        MOVE ER-8074               TO WS-ERROR
 11935        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 217
* EL050.cbl
 11936        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11937        GO TO 3024-EDIT-DL7-CONT.
 11938
 11939     IF DCUA-RETURN-CODE EQUAL '04'
 11940        MOVE ER-8075               TO WS-ERROR
 11941        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11942        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11943        GO TO 3024-EDIT-DL7-CONT.
 11944
 11945     IF DCUA-RETURN-CODE EQUAL '05'
 11946        MOVE ER-8076               TO WS-ERROR
 11947        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11948        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11949        GO TO 3024-EDIT-DL7-CONT.
 11950
 11951     IF DCUA-RETURN-CODE EQUAL '06'
 11952        MOVE ER-8077               TO WS-ERROR
 11953        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11954        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11955        GO TO 3024-EDIT-DL7-CONT.
 11956
 11957     IF DCUA-RETURN-CODE EQUAL '07'
 11958        MOVE ER-8078               TO WS-ERROR
 11959        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11960        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11961        GO TO 3024-EDIT-DL7-CONT.
 11962
 11963     IF DCUA-RETURN-CODE EQUAL 'E1'
 11964        MOVE ER-8079               TO WS-ERROR
 11965        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11966        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11967        GO TO 3024-EDIT-DL7-CONT.
 11968
 11969     IF DCUA-RETURN-CODE EQUAL 'E2'
 11970        MOVE ER-8080               TO WS-ERROR
 11971        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11972        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11973        GO TO 3024-EDIT-DL7-CONT.
 11974
 11975     IF DCUA-RETURN-CODE EQUAL 'E3'
 11976        MOVE ER-8098               TO WS-ERROR
 11977        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11978        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11979        GO TO 3024-EDIT-DL7-CONT.
 11980
 11981     IF DCUA-RETURN-CODE EQUAL 'C1'
 11982        MOVE ER-8099               TO WS-ERROR
 11983        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11985        GO TO 3024-EDIT-DL7-CONT.
 11986
 11987     IF DCUA-RETURN-CODE EQUAL 'U1'
 11988        MOVE ER-8109               TO WS-ERROR
 11989        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11990        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11991        GO TO 3024-EDIT-DL7-CONT.
 11992
 11993     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 218
* EL050.cbl
 11994        MOVE ER-8112               TO WS-ERROR
 11995        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11997        GO TO 3024-EDIT-DL7-CONT.
 11998
 11999     IF DCUA-RETURN-CODE EQUAL 'N2'
 12000        MOVE ER-8113               TO WS-ERROR
 12001        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12002        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12003        GO TO 3024-EDIT-DL7-CONT.
 12004
 12005     IF DCUA-RETURN-CODE EQUAL 'N3'
 12006        MOVE ER-8114               TO WS-ERROR
 12007        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12009        GO TO 3024-EDIT-DL7-CONT.
 12010
 12011     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12012     MOVE ER-8097                  TO WS-ERROR.
 12013     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12014     GO TO 3024-EDIT-DL7-CONT.
 12015
 12016 3024-EDIT-DL7-CONT.
 12017
 12018     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12019     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12020     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12021        NEXT SENTENCE
 12022     ELSE
 12023        MOVE ER-9263               TO WS-ERROR
 12024        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12025
 12026******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12027******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12028     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12029        NEXT SENTENCE
 12030     ELSE
 12031        MOVE ER-8039               TO WS-ERROR
 12032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12033
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 219
* EL050.cbl
 12035****************************************************************
 12036*** VALIDATE STATE  : DLO022                                 ***
 12037****************************************************************
 12038     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12039     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12040
 12041     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12042     IF DVSC-SUCCESSFUL-EDIT
 12043        GO TO 3024-EDIT-DL22-CONT.
 12044
 12045     IF DVSC-RETURN-CODE EQUAL '01'
 12046        MOVE ER-8300               TO WS-ERROR
 12047        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12048        GO TO 3024-EDIT-DL22-CONT.
 12049
 12050     IF DVSC-RETURN-CODE EQUAL '02'
 12051        MOVE ER-8301               TO WS-ERROR
 12052        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12053        GO TO 3024-EDIT-DL22-CONT.
 12054
 12055     IF DVSC-RETURN-CODE EQUAL '03'
 12056        MOVE ER-8302               TO WS-ERROR
 12057        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12058        GO TO 3024-EDIT-DL22-CONT.
 12059
 12060     IF DVSC-RETURN-CODE EQUAL 'N1'
 12061        MOVE ER-8304               TO WS-ERROR
 12062        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12063        GO TO 3024-EDIT-DL22-CONT.
 12064
 12065     MOVE ER-8303                  TO WS-ERROR
 12066     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12067
 12068 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 220
* EL050.cbl
 12070****************************************************************
 12071*** VALIDATE LOAN OFFICER : DLO021                           ***
 12072****************************************************************
 12073
 12074     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12075     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12076     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12077     IF DVLO-SUCCESSFUL-EDIT
 12078        GO TO 3024-EDIT-DL21-CONT.
 12079
 12080     IF DVLO-RETURN-CODE EQUAL '01'
 12081        MOVE ER-8081               TO WS-ERROR
 12082        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12083        GO TO 3024-EDIT-DL21-CONT.
 12084
 12085     IF DVLO-RETURN-CODE EQUAL '02'
 12086        MOVE ER-8082               TO WS-ERROR
 12087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12088        GO TO 3024-EDIT-DL21-CONT.
 12089
 12090     IF DVLO-RETURN-CODE EQUAL '03'
 12091        MOVE ER-8083               TO WS-ERROR
 12092        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12093        GO TO 3024-EDIT-DL21-CONT.
 12094
 12095     IF DVLO-RETURN-CODE EQUAL '04'
 12096        MOVE ER-8084               TO WS-ERROR
 12097        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12098        GO TO 3024-EDIT-DL21-CONT.
 12099
 12100     IF DVLO-RETURN-CODE EQUAL '05'
 12101        MOVE ER-8085               TO WS-ERROR
 12102        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12103        GO TO 3024-EDIT-DL21-CONT.
 12104
 12105     MOVE ER-7825                  TO WS-ERROR
 12106     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12107     GO TO 3024-EDIT-DL21-CONT.
 12108
 12109 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 221
* EL050.cbl
 12111
 12112****************************************************************
 12113*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12114****************************************************************
 12115
 12116     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12117     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12118     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12119     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12120     IF DIPF-SUCCESSFUL-EDIT
 12121        GO TO 3024-EDIT-DL02-CONT.
 12122
 12123     IF DIPF-RETURN-CODE EQUAL '01'
 12124        MOVE ER-8086               TO WS-ERROR
 12125        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12126        GO TO 3024-EDIT-DL02-CONT.
 12127
 12128     IF DIPF-RETURN-CODE EQUAL '02'
 12129        MOVE ER-8087               TO WS-ERROR
 12130        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12131        GO TO 3024-EDIT-DL02-CONT.
 12132
 12133     IF DIPF-RETURN-CODE EQUAL '03'
 12134        MOVE ER-8088               TO WS-ERROR
 12135        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12136        GO TO 3024-EDIT-DL02-CONT.
 12137
 12138     MOVE ER-8095                  TO WS-ERROR
 12139     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12140     GO TO 3024-EDIT-DL02-CONT.
 12141
 12142 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 222
* EL050.cbl
 12144
 12145****************************************************************
 12146*** VALIDATE BANK ID : DLO003                                ***
 12147****************************************************************
 12148
 12149     MOVE WK-GREG-CENT           TO WCG-CENT.
 12150     MOVE WK-GREG-YYMM           TO WCG-REST.
 12151     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12152        MOVE ER-8040               TO WS-ERROR
 12153        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12154
 12155     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12156     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12157     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12158     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12159     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12160     IF DVBI-SUCCESSFUL-EDIT
 12161        GO TO 3024-EDIT-DL03-CONT.
 12162
 12163     IF DVBI-RETURN-CODE EQUAL '01'
 12164        MOVE ER-8089               TO WS-ERROR
 12165        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12166        GO TO 3024-EDIT-DL03-CONT.
 12167
 12168     IF DVBI-RETURN-CODE EQUAL '02'
 12169        MOVE ER-8090               TO WS-ERROR
 12170        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12171        GO TO 3024-EDIT-DL03-CONT.
 12172
 12173     IF DVBI-RETURN-CODE EQUAL '03'
 12174        MOVE ER-8091               TO WS-ERROR
 12175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12176        GO TO 3024-EDIT-DL03-CONT.
 12177
 12178     IF DVBI-RETURN-CODE EQUAL '04'
 12179        MOVE ER-8092               TO WS-ERROR
 12180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12181        GO TO 3024-EDIT-DL03-CONT.
 12182
 12183     IF DVBI-RETURN-CODE EQUAL '05'
 12184        MOVE ER-8093               TO WS-ERROR
 12185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12186        GO TO 3024-EDIT-DL03-CONT.
 12187
 12188     IF DVBI-RETURN-CODE EQUAL '06'
 12189        MOVE ER-8094               TO WS-ERROR
 12190        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12191        GO TO 3024-EDIT-DL03-CONT.
 12192
 12193     MOVE ER-8096                  TO WS-ERROR
 12194     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12195     GO TO 3024-EDIT-DL03-CONT.
 12196
 12197 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 223
* EL050.cbl
 12199
 12200     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12201        NEXT SENTENCE
 12202     ELSE
 12203        MOVE ER-8042               TO WS-ERROR
 12204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12205
 12206     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12207     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12208     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12209
 12210     IF DMPF-RETURN-CODE = '01'
 12211        MOVE ER-8067               TO WS-ERROR
 12212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12213        GO TO 3024-EDIT-DL01-CONT.
 12214
 12215     IF DMPF-RETURN-CODE = '02'
 12216        MOVE ER-8068               TO WS-ERROR
 12217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12218        GO TO 3024-EDIT-DL01-CONT.
 12219
 12220     IF DMPF-RETURN-CODE = '03'
 12221        MOVE ER-8069               TO WS-ERROR
 12222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12223        GO TO 3024-EDIT-DL01-CONT.
 12224
 12225     IF DMPF-RETURN-CODE = 'E1'
 12226        MOVE ER-8070               TO WS-ERROR
 12227        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12228        GO TO 3024-EDIT-DL01-CONT.
 12229
 12230     IF DMPF-RETURN-CODE = 'N1'
 12231        MOVE ER-8071               TO WS-ERROR
 12232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12233        GO TO 3024-EDIT-DL01-CONT.
 12234
 12235     IF DMPF-RETURN-CODE NOT = 'OK'
 12236        MOVE ER-8072               TO WS-ERROR
 12237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12238
 12239 3024-EDIT-DL01-CONT.
 12240******************************************************************
 12241***  VALIDATES RATE CODES : DLO017                             ***
 12242******************************************************************
 12243
 12244      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12245      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12246      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12247      IF DVRC-SUCCESSFUL-EDIT
 12248        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12249        GO TO 3024-CHECK-VALID-RATE.
 12250
 12251      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12252
 12253      IF DVRC-RETURN-CODE EQUAL '01'
 12254         MOVE ER-7817                   TO WS-ERROR
 12255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12256         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 224
* EL050.cbl
 12257
 12258      IF DVRC-RETURN-CODE EQUAL '02'
 12259         MOVE ER-7818                   TO WS-ERROR
 12260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12261         GO TO 3025-EDIT-REINSURANCE.
 12262
 12263      IF DVRC-RETURN-CODE EQUAL '03'
 12264         MOVE ER-7819                   TO WS-ERROR
 12265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12266         GO TO 3025-EDIT-REINSURANCE.
 12267
 12268       MOVE ER-7820                     TO WS-ERROR.
 12269       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12270       GO TO 3025-EDIT-REINSURANCE.
 12271
 12272******************************************************************
 12273***  GET PREMIUM RATES : DLO011                                ***
 12274******************************************************************
 12275
 12276 3024-CHECK-VALID-RATE.
 12277
 12278     IF VALID-RATE-CODE
 12279        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12280        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12281        MOVE SPACES                TO DPRB-RETURN-CODE
 12282        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12283     ELSE
 12284         GO TO 3025-EDIT-REINSURANCE.
 12285
 12286      IF DPRB-SUCCESSFUL-PROCESS
 12287         IF PB-VALID-LIFE
 12288             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12289             GO TO 3025-EDIT-REINSURANCE
 12290         ELSE
 12291             IF PB-VALID-AH
 12292                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12293                 GO TO 3025-EDIT-REINSURANCE.
 12294
 12295      IF DPRB-RETURN-CODE EQUAL '01'
 12296         MOVE ER-7812                   TO WS-ERROR
 12297         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12298         GO TO 3025-EDIT-REINSURANCE.
 12299
 12300      IF DPRB-RETURN-CODE EQUAL '02'
 12301         MOVE ER-7813                   TO WS-ERROR
 12302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12303         GO TO 3025-EDIT-REINSURANCE.
 12304
 12305      IF DPRB-RETURN-CODE EQUAL '03'
 12306         MOVE ER-7814                   TO WS-ERROR
 12307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12308         GO TO 3025-EDIT-REINSURANCE.
 12309
 12310      IF DPRB-RETURN-CODE EQUAL '04'
 12311         IF NOT DPRB-1ST-TIME
 12312            MOVE ER-7815                   TO WS-ERROR
 12313            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12314            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 225
* EL050.cbl
 12315          ELSE
 12316         IF PB-VALID-LIFE
 12317            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12318          ELSE
 12319            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12320         END-IF
 12321         MOVE SPACES                TO DOCC-RETURN-CODE
 12322         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12323         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12324         IF DOCC-RETURN-CODE = 'OK'
 12325             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12326             GO TO 3024-CHECK-VALID-RATE
 12327           ELSE
 12328             MOVE ER-7823               TO WS-ERROR
 12329             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12330             GO TO 3025-EDIT-REINSURANCE.
 12331
 12332       MOVE ER-7816                     TO WS-ERROR.
 12333       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12334       GO TO 3025-EDIT-REINSURANCE.
 12335
 12336**********   DMD CUSTOM CODE ABOVE    **********
 12337
 12338 3025-EDIT-REINSURANCE.
 12339     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12340         GO TO 3027-EDIT-CONTINUE.
 12341
 12342     MOVE LOW-VALUES               TO ERREIN-KEY.
 12343     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12344     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12345                                      REIN-CODE-2
 12346                                      REIN-CODE-3.
 12347     MOVE 'A'                      TO REIN-TYPE.
 12348
 12349     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12350
 12351     MOVE '3026' TO REIN-SW.
 12352     MOVE ' '                   TO WS-REIN-READ-SW.
 12353
 12354     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12355     IF REIN-TABLE-NOT-FOUND
 12356         GO TO 3026-NO-SPEC-TABLE.
 12357
 12358     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12359     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12360                                   WS-NSP-ST-CD-LF.
 12361     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12362                                   WS-NSP-ST-CD-AH.
 12363
 12364     GO TO 3040-EDIT-CONTINUE.
 12365
 12366 3026-NO-SPEC-TABLE.
 12367
 12368     MOVE ER-2664                TO WS-ERROR.
 12369     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12370     GO TO 3040-EDIT-CONTINUE.
 12371
 12372 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 226
* EL050.cbl
 12373
 12374     IF PB-I-REIN-TABLE = SPACES
 12375       GO TO 3040-EDIT-CONTINUE.
 12376
 12377     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12378          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12379          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12380           GO TO 3040-EDIT-CONTINUE.
 12381
 12382     MOVE LOW-VALUES            TO ERREIN-KEY.
 12383     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12384     MOVE 'A'                   TO REIN-TYPE.
 12385     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12386
 12387     MOVE '3028'                TO REIN-SW.
 12388     MOVE ' '                   TO WS-REIN-READ-SW.
 12389
 12390     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12391     IF REIN-TABLE-NOT-FOUND
 12392         GO TO 3028-NO-REIN-TABLE.
 12393
 12394     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12395     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12396                                   WS-NSP-ST-CD-LF.
 12397     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12398                                   WS-NSP-ST-CD-AH.
 12399
 12400     GO TO 3040-EDIT-CONTINUE.
 12401
 12402 3028-NO-REIN-TABLE.
 12403
 12404     MOVE ER-2615                TO WS-ERROR.
 12405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12406     GO TO 3040-EDIT-CONTINUE.
 12407
 12408 3040-EDIT-CONTINUE.
 12409
 12410     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12411         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12412
 12413     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12414         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12415
 12416     IF (NOT PB-REISSUED-CERT)
 12417        AND (NOT PB-MONTHLY-CERT)
 12418        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12419            MOVE '001'           TO PB-I-LF-TERM
 12420            MOVE 'M'             TO PB-I-INSURED-SEX.
 12421
 12422     IF (NOT PB-REISSUED-CERT)
 12423        AND (NOT PB-MONTHLY-CERT)
 12424        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12425            MOVE '001'           TO PB-I-AH-TERM
 12426            MOVE 'M'             TO PB-I-INSURED-SEX.
 12427
 12428 3040-EDIT-1ST-PMT-DT.
 12429     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12430     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 227
* EL050.cbl
 12431         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12432
 12433******************************************************************
 12434*                                                                *
 12435*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12436*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12437*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12438*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12439*                                                                *
 12440******************************************************************
 12441
 12442     IF PB-EFF-DT-PROCESSING
 12443        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12444                                    PB-I-LF-EXPIRE-DT
 12445                                    PB-I-AH-EXPIRE-DT
 12446        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12447        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12448        MOVE ZERO                TO DC-ELAPSED-DAYS
 12449        MOVE +1                  TO DC-ELAPSED-MONTHS
 12450        SET BIN-PLUS-ELAPSED     TO TRUE
 12451*       MOVE 6                   TO DC-OPTION-CODE
 12452        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12453        IF NO-CONVERSION-ERROR
 12454           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12455
 12456******************************************************************
 12457*                                                                *
 12458*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12459*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12460*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12461*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12462*                                                                *
 12463******************************************************************
 12464
 12465     IF PB-EXT-DAYS-PROCESSING
 12466          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12467                                         PB-I-LF-EXPIRE-DT
 12468                                         PB-I-AH-EXPIRE-DT
 12469          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12470          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12471          MOVE +1                     TO DC-ELAPSED-MONTHS
 12472          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12473          SET BIN-PLUS-ELAPSED        TO TRUE
 12474*         MOVE 6                      TO DC-OPTION-CODE
 12475          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12476          IF NO-CONVERSION-ERROR
 12477             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12478
 12479******************************************************************
 12480*                                                                *
 12481*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12482*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12483*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12484*        (EXPIRE DATE - (TERM -1))  *  -1.
 12485*                                                                *
 12486******************************************************************
 12487
 12488     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 228
* EL050.cbl
 12489        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12490           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12491              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12492              MOVE PB-I-AH-TERM      TO WS-TERM
 12493           ELSE
 12494              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12495              MOVE PB-I-LF-TERM      TO WS-TERM
 12496        ELSE
 12497           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12498              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12499              MOVE PB-I-LF-TERM      TO WS-TERM
 12500           ELSE
 12501              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12502              MOVE PB-I-AH-TERM      TO WS-TERM.
 12503
 12504     IF PB-EXPIRE-DT-PROCESSING
 12505        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12506        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12507        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12508        MOVE ZERO                TO DC-ELAPSED-DAYS
 12509                                    DC-ODD-DAYS-OVER
 12510          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12511          SET BIN-PLUS-ELAPSED    TO TRUE
 12512*         MOVE 6                  TO DC-OPTION-CODE
 12513          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12514          IF NO-CONVERSION-ERROR
 12515             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12516
 12517******************************************************************
 12518*                                                                *
 12519*            1ST PAYMENT DATE PROCESSING                         *
 12520*                                                                *
 12521******************************************************************
 12522
 12523     IF PB-1ST-PMT-DT-PROCESSING
 12524        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12525                                    PB-I-AH-EXPIRE-DT
 12526        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12527
 12528     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12529         NEXT SENTENCE
 12530     ELSE
 12531         MOVE ER-2680                 TO WS-ERROR
 12532         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12533         GO TO 3060-ORIG-TERM-CHECK.
 12534
 12535     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12536     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12537     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12538*    MOVE 1                      TO DC-OPTION-CODE.
 12539     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12540                                    DC-ELAPSED-DAYS
 12541                                    DC-ODD-DAYS-OVER.
 12542
 12543     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12544
 12545     IF DATE-CONVERSION-ERROR
 12546        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 229
* EL050.cbl
 12547
 12548     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12549     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12550        AND (WS-LF-COVERAGE-TYPE = 'L')
 12551        IF (DC-ELAPSED-MONTHS > 1)
 12552                      OR
 12553           ((DC-ELAPSED-MONTHS = 1)
 12554           AND (DC-ODD-DAYS-OVER > 0))
 12555           MOVE ER-2882          TO WS-ERROR
 12556           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12557        END-IF
 12558     END-IF
 12559     if dc-elapsed-months > 0
 12560        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12561        + dc-odd-days-over
 12562     end-if
 12563     IF PB-EXT-DAYS-PROCESSING
 12564        CONTINUE
 12565     ELSE
 12566        IF DC-ELAPSED-MONTHS = +0
 12567           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12568        ELSE
 12569           IF (WS-LF-EARNINGS-CALC = '4')
 12570              AND (DC-ELAPSED-MONTHS > ZERO)
 12571              AND (DC-ELAPSED-DAYS > ZERO)
 12572              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12573           ELSE
 12574              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12575                                 THRU 6499-EXIT
 12576              MOVE WS-ODD-DAYS-OVER
 12577                                 TO PB-I-EXTENTION-DAYS
 12578           END-IF
 12579        END-IF
 12580     END-IF
 12581******************************************************************
 12582*                                                                *
 12583*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12584*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12585*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12586*            AND ANY ODD DAYS.                                   *
 12587*                                                                *
 12588******************************************************************
 12589
 12590     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12591                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12592     IF WS-LF-EARNINGS-CALC NOT = '4'
 12593        IF DC-ELAPSED-DAYS > ZEROS
 12594           MOVE ER-2681          TO WS-ERROR
 12595           PERFORM 9900-ERROR-FORMAT
 12596                                 THRU 9900-EXIT
 12597        END-IF
 12598     END-IF
 12599
 12600     IF WS-LF-EARNINGS-CALC NOT = '4'
 12601        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12602           MOVE ER-2681          TO WS-ERROR
 12603           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12604
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 230
* EL050.cbl
 12605     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12606        (PB-I-LF-TERM NOT = ZERO) AND
 12607         NOT NO-LIFE-COVERAGE
 12608          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12609          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12610          IF WS-LF-EARNINGS-CALC = '4'
 12611             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12612             PB-I-PAY-FREQUENCY
 12613          END-IF
 12614          MOVE ZERO              TO DC-ELAPSED-DAYS
 12615                                    DC-ODD-DAYS-OVER
 12616          MOVE 1                 TO DC-END-OF-MONTH
 12617          SET BIN-PLUS-ELAPSED        TO TRUE
 12618*         MOVE 6                 TO DC-OPTION-CODE
 12619          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12620          IF NO-CONVERSION-ERROR
 12621             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12622             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12623                (WS-LF-SPECIAL-CALC-CD = 'L')
 12624                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12625                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12626                  MOVE +1             TO DC-ELAPSED-MONTHS
 12627                  SET BIN-PLUS-ELAPSED  TO TRUE
 12628*                 MOVE 6              TO DC-OPTION-CODE
 12629                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12630                  IF NO-CONVERSION-ERROR
 12631                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12632
 12633* okay, i had to move the new att age edit down here because the
 12634* expiration date could get recalculated and i need the exp date
 12635     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12636        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12637        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12638        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12639           AND ZEROS
 12640           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12641           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12642           SET ELAPSED-BETWEEN-BIN TO TRUE
 12643           PERFORM 8500-DATE-CONVERT
 12644                                 THRU 8500-EXIT
 12645           IF NO-CONVERSION-ERROR
 12646              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12647                 MOVE ER-2669       TO WS-ERROR
 12648*                PERFORM 9900-ERROR-FORMAT
 12649*                                THRU 9900-EXIT
 12650              END-IF
 12651           END-IF
 12652        ELSE
 12653           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12654           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12655              MOVE ER-2669       TO WS-ERROR
 12656*             PERFORM 9900-ERROR-FORMAT
 12657*                                THRU 9900-EXIT
 12658           ELSE
 12659              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12660                 MOVE ER-1570    TO WS-ERROR
 12661                 PERFORM 9900-ERROR-FORMAT
 12662                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 231
* EL050.cbl
 12663              END-IF
 12664           END-IF
 12665        END-IF
 12666        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12667           AND ZEROS
 12668           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12669           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12670           SET ELAPSED-BETWEEN-BIN TO TRUE
 12671           PERFORM 8500-DATE-CONVERT
 12672                                 THRU 8500-EXIT
 12673           IF NO-CONVERSION-ERROR
 12674              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12675                 MOVE ER-2669       TO WS-ERROR
 12676*                PERFORM 9900-ERROR-FORMAT
 12677*                                THRU 9900-EXIT
 12678              END-IF
 12679           END-IF
 12680        ELSE
 12681           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12682             (PB-I-LF-TERM / 12)
 12683           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12684              MOVE ER-2669       TO WS-ERROR
 12685*             PERFORM 9900-ERROR-FORMAT
 12686*                                THRU 9900-EXIT
 12687           ELSE
 12688              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12689                 MOVE ER-1571    TO WS-ERROR
 12690                 PERFORM 9900-ERROR-FORMAT
 12691                                 THRU 9900-EXIT
 12692              END-IF
 12693           END-IF
 12694        END-IF
 12695        IF WS-ERROR = ER-2669
 12696           PERFORM 9900-ERROR-FORMAT
 12697                                 THRU 9900-EXIT
 12698        END-IF
 12699     END-IF
 12700     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12701        (PB-I-AH-TERM NOT = ZERO) AND
 12702         NOT NO-AH-COVERAGE
 12703          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12704             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12705             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12706             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12707          ELSE
 12708             IF WS-LF-EARNINGS-CALC = '4'
 12709                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12710                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12711                PB-I-PAY-FREQUENCY
 12712             ELSE
 12713                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12714                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12715             END-IF
 12716          END-IF
 12717          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12718                                         DC-ODD-DAYS-OVER
 12719          MOVE 1                      TO DC-END-OF-MONTH
 12720          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 232
* EL050.cbl
 12721*         MOVE 6                      TO DC-OPTION-CODE
 12722          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12723          IF NO-CONVERSION-ERROR
 12724             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12725     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12726        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12727        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12728        IF PB-I-BIRTHDAY > LOW-VALUES
 12729           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12730           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12731           SET ELAPSED-BETWEEN-BIN TO TRUE
 12732           PERFORM 8500-DATE-CONVERT
 12733                                 THRU 8500-EXIT
 12734           IF NO-CONVERSION-ERROR
 12735              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12736                 MOVE ER-3054       TO WS-ERROR
 12737*                PERFORM 9900-ERROR-FORMAT
 12738*                                THRU 9900-EXIT
 12739              END-IF
 12740           END-IF
 12741        ELSE
 12742           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12743           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12744              MOVE ER-3054       TO WS-ERROR
 12745*             PERFORM 9900-ERROR-FORMAT
 12746*                                THRU 9900-EXIT
 12747           END-IF
 12748        END-IF
 12749        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12750           AND ZEROS
 12751           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12752           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12753           SET ELAPSED-BETWEEN-BIN TO TRUE
 12754           PERFORM 8500-DATE-CONVERT
 12755                                 THRU 8500-EXIT
 12756           IF NO-CONVERSION-ERROR
 12757              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12758                 MOVE ER-3054       TO WS-ERROR
 12759*                PERFORM 9900-ERROR-FORMAT
 12760*                                THRU 9900-EXIT
 12761              END-IF
 12762           END-IF
 12763        ELSE
 12764           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12765             (PB-I-AH-TERM / 12)
 12766           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12767              MOVE ER-3054       TO WS-ERROR
 12768*             PERFORM 9900-ERROR-FORMAT
 12769*                                THRU 9900-EXIT
 12770           END-IF
 12771        END-IF
 12772        IF WS-ERROR = ER-3054
 12773           PERFORM 9900-ERROR-FORMAT
 12774                                 THRU 9900-EXIT
 12775        END-IF
 12776     END-IF
 12777     MOVE SPACE                       TO DC-END-OF-MONTH.
 12778
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 233
* EL050.cbl
 12779     IF PB-COMPANY-ID = 'NCB'
 12780        GO TO 3040-EDIT-EXTENSION-DAYS.
 12781
 12782     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12783       AND
 12784        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12785        NEXT SENTENCE
 12786     ELSE
 12787        GO TO 3040-EDIT-EXTENSION-DAYS.
 12788
 12789     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12790        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12791        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12792     ELSE
 12793        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12794        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12795
 12796     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12797*    MOVE '1'      TO DC-OPTION-CODE
 12798     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12799     IF (NO-CONVERSION-ERROR)
 12800        AND (DC-ELAPSED-MONTHS > +1)
 12801        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12802        MOVE ER-2668   TO WS-ERROR
 12803        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12804
 12805 3040-EDIT-EXTENSION-DAYS.
 12806
 12807     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12808        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12809         GO TO 3050-EDIT-TERM-IN-DAYS
 12810     ELSE
 12811         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12812
 12813     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12814         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12815     ELSE
 12816        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12817           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12818           MOVE ER-2681         TO WS-ERROR
 12819           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12820
 12821     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12822        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12823        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12824         GO TO 3060-ORIG-TERM-CHECK.
 12825
 12826     GO TO 3060-ORIG-TERM-CHECK.
 12827
 12828 3050-EDIT-TERM-IN-DAYS.
 12829
 12830     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12831
 12832     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12833         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12834     ELSE
 12835         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12836            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 234
* EL050.cbl
 12837            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12838
 12839     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12840                                       REMAINDER WS-WORK-TERM.
 12841     IF WS-WORK-TERM GREATER THAN ZERO
 12842         ADD +1 TO PB-I-LF-TERM.
 12843
 12844     IF NOT NO-AH-COVERAGE
 12845         MOVE ER-2684            TO WS-ERROR
 12846         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12847
 12848
 12849 3060-ORIG-TERM-CHECK.
 12850
 12851******************************************************************
 12852*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12853******************************************************************
 12854
 12855     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12856        NEXT SENTENCE
 12857     ELSE
 12858        IF NOT NO-LIFE-COVERAGE
 12859           IF PB-I-LF-TERM NUMERIC
 12860              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12861              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12862              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12863                  NEXT SENTENCE
 12864           ELSE
 12865              MOVE ER-2647       TO WS-ERROR
 12866              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12867
 12868     IF NOT NO-AH-COVERAGE
 12869         IF PB-I-AH-TERM NUMERIC
 12870            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12871            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12872            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12873             NEXT SENTENCE
 12874          ELSE
 12875              MOVE ER-2658       TO WS-ERROR
 12876              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12877
 12878     IF PB-COMPANY-ID = 'NCB'
 12879        GO TO 3070-LOAN-TERM-CHECK.
 12880
 12881     IF POLICY-HAS-AH
 12882       AND
 12883        POLICY-HAS-LIFE
 12884       AND
 12885        PB-I-LF-TERM NUMERIC
 12886       AND
 12887        PB-I-AH-TERM NUMERIC
 12888        NEXT SENTENCE
 12889     ELSE
 12890        GO TO 3070-LOAN-TERM-CHECK.
 12891
 12892     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12893     IF WS-TEX-FACT-2 LESS THAN +0
 12894        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 235
* EL050.cbl
 12895
 12896     IF WS-TEX-FACT-2 GREATER THAN +1
 12897        MOVE ER-2668             TO WS-ERROR
 12898        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12899
 12900 3070-LOAN-TERM-CHECK.
 12901
 12902     IF (WS-LF-BENEFIT-CD = ZERO)
 12903         OR (NO-LF-BENEFIT-MATCH)
 12904            GO TO 3125-EDIT-PMT-FREQ.
 12905*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12906*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12907*          AND 'V' AND 'W' AND 'X'
 12908*          GO TO 3125-EDIT-PMT-FREQ
 12909*       END-IF
 12910*    ELSE
 12911*       IF WS-AH-DCC-TRUNC = 'T'
 12912*          CONTINUE
 12913*       ELSE
 12914*          GO TO 3125-EDIT-PMT-FREQ
 12915*       END-IF
 12916*    END-IF
 12917     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12918                    OR
 12919        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12920        AND (WS-AH-DCC-TRUNC = 'T'))
 12921        CONTINUE
 12922     ELSE
 12923        GO TO 3125-EDIT-PMT-FREQ
 12924     END-IF
 12925     IF PB-I-LOAN-TERM NOT NUMERIC
 12926         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12927
 12928     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12929        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12930*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12931        PB-I-LOAN-TERM NOT GREATER THAN +360
 12932         NEXT SENTENCE
 12933     ELSE
 12934         MOVE ER-2648            TO WS-ERROR
 12935         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12936
 12937     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12938        MOVE ER-3058             TO WS-ERROR
 12939        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12940     end-if
 12941
 12942     IF WS-STATE-ABBREVIATION = 'NC'
 12943        IF PB-I-LOAN-TERM > +59
 12944           CONTINUE
 12945        ELSE
 12946           MOVE ER-2792          TO WS-ERROR
 12947           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12948        END-IF
 12949     END-IF
 12950
 12951     .
 12952 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 236
* EL050.cbl
 12953     IF (WS-LF-BENEFIT-CD = ZERO)
 12954         OR (NO-LF-BENEFIT-MATCH)
 12955            GO TO 3127-EDIT-LOAN-OFFICER.
 12956     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12957                    OR
 12958        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12959        AND (WS-AH-DCC-TRUNC = 'T'))
 12960                    OR
 12961         (PB-COMPANY-ID = 'AHL')
 12962        CONTINUE
 12963     ELSE
 12964        IF (PB-I-LOAN-TERM > ZEROS)
 12965           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12966           MOVE ER-1575          TO WS-ERROR
 12967           PERFORM 9900-ERROR-FORMAT
 12968                                 THRU 9900-EXIT
 12969        END-IF
 12970     END-IF
 12971     IF WS-LF-EARNINGS-CALC NOT = '4'
 12972         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12973            MOVE ER-2653         TO WS-ERROR
 12974            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12975            GO TO 3127-EDIT-LOAN-OFFICER
 12976         ELSE
 12977            GO TO 3127-EDIT-LOAN-OFFICER.
 12978
 12979     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12980         MOVE ER-2655            TO WS-ERROR
 12981         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12982         GO TO 3127-EDIT-LOAN-OFFICER.
 12983
 12984     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12985         MOVE ER-2654            TO WS-ERROR
 12986         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12987         GO TO 3127-EDIT-LOAN-OFFICER.
 12988
 12989     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12990         GIVING WS-TEX-FACT-2
 12991             REMAINDER WS-TEX-FACT-3.
 12992
 12993*    IF WS-TEX-FACT-3 NOT = ZERO
 12994*       MOVE ER-2654             TO WS-ERROR
 12995*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12996
 12997
 12998 3127-EDIT-LOAN-OFFICER.
 12999
 13000     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13001        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13002           MOVE ER-2690          TO WS-ERROR
 13003           PERFORM 9900-ERROR-FORMAT
 13004                                 THRU 9900-EXIT
 13005        ELSE
 13006           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13007           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13008           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13009           MOVE PB-SV-STATE      TO LOFC-STATE
 13010           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 237
* EL050.cbl
 13011           MOVE PB-I-LOAN-OFFICER
 13012                                 TO LOFC-CODE
 13013           PERFORM 8586-READ-LOAN-OFFICER
 13014                                 THRU 8586-EXIT
 13015           IF (NOT LOFC-MASTER-FOUND)
 13016              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13017              MOVE ER-3006       TO WS-ERROR
 13018              PERFORM 9900-ERROR-FORMAT
 13019                                 THRU 9900-EXIT
 13020           END-IF
 13021        END-IF
 13022     END-IF
 13023     .
 13024 3129-EDIT-APR.
 13025
 13026     IF (WS-LF-BENEFIT-CD = ZERO)
 13027        OR (NO-LF-BENEFIT-MATCH)
 13028        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13029           GO TO 3130-EDIT-AGE
 13030*       ELSE
 13031*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13032*             GO TO 3130-EDIT-AGE
 13033*          END-IF
 13034        END-IF
 13035     END-IF
 13036
 13037     IF (WS-STATE-ABBREVIATION = 'OH')
 13038         AND (PB-I-RATE-CLASS NOT = 'L ')
 13039         AND (PB-I-LF-TERM GREATER THAN 60)
 13040         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13041         GO TO 3129-APR-CONT.
 13042
 13043     IF (WS-STATE-ABBREVIATION = 'RI')
 13044         AND (PB-I-LF-TERM GREATER THAN 60)
 13045         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13046         GO TO 3129-APR-CONT.
 13047
 13048     IF (WS-STATE-ABBREVIATION = 'UT')
 13049         AND (PB-I-LF-TERM GREATER THAN 62)
 13050         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13051         AND (PB-CERT-EFF-DT LESS WS-830901)
 13052         GO TO 3129-APR-CONT.
 13053
 13054     IF PB-COMPANY-ID = 'LAP'
 13055        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13056           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13057              MOVE ER-2656         TO WS-ERROR
 13058              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13059              GO TO 3130-EDIT-AGE.
 13060
 13061     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13062        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13063        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13064        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13065        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13066        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13067         GO TO 3130-EDIT-AGE.
 13068
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 238
* EL050.cbl
 13069 3129-APR-CONT.
 13070     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13071         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13072         GO TO 3130-EDIT-AGE.
 13073
 13074     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13075         WS-AH-BENEFIT-CD (1:1) = 'S')
 13076        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13077        AND (PB-I-LOAN-APR = ZERO)
 13078        MOVE ER-2657             TO WS-ERROR
 13079        PERFORM 9900-ERROR-FORMAT
 13080                                 THRU 9900-EXIT
 13081        GO TO 3130-EDIT-AGE
 13082     END-IF
 13083*    IF PB-I-LOAN-APR = ZERO
 13084*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13085*    END-IF
 13086
 13087     if pb-i-loan-apr = +99.9999
 13088        move er-2656             to ws-error
 13089        PERFORM 9900-ERROR-FORMAT
 13090                                 THRU 9900-EXIT
 13091        GO TO 3130-EDIT-AGE
 13092     end-if
 13093*    IF PB-I-LOAN-APR = ZERO
 13094*       MOVE ER-2656             TO WS-ERROR
 13095*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13096*       GO TO 3130-EDIT-AGE.
 13097
 13098*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13099     if pb-i-loan-apr not = +99.9999
 13100        IF PB-I-LOAN-APR > +30.000
 13101           MOVE ER-2657          TO WS-ERROR
 13102           PERFORM 9900-ERROR-FORMAT
 13103                                 THRU 9900-EXIT
 13104        end-if
 13105     end-if
 13106     .
 13107 3130-EDIT-AGE.
 13108
 13109******************************************************************
 13110*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13111******************************************************************
 13112
 13113     IF NOT NO-LIFE-COVERAGE
 13114        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13115           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13116               MOVE ER-2628             TO WS-ERROR
 13117               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13118
 13119     IF NOT NO-AH-COVERAGE
 13120        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13121           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13122               MOVE ER-2628         TO WS-ERROR
 13123               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13124
 13125 3133-SEX-CODE.
 13126     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 239
* EL050.cbl
 13127         IF WS-DEFAULT-SEX = 'M'
 13128             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13129          ELSE
 13130             IF WS-DEFAULT-SEX = 'F'
 13131             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13132
 13133     IF PB-I-INSURED-SEX = '1'
 13134         MOVE 'M' TO PB-I-INSURED-SEX.
 13135
 13136     IF PB-I-INSURED-SEX = '2'
 13137         MOVE 'F' TO PB-I-INSURED-SEX.
 13138
 13139 3134-SIG-SW-EDIT.
 13140     IF PB-I-SIG-SW = SPACE
 13141         MOVE 'N'                TO  PB-I-SIG-SW.
 13142
 13143     IF PB-COMPANY-ID = 'NCL'
 13144         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13145             NEXT SENTENCE
 13146         ELSE
 13147             MOVE ER-1923        TO  WS-ERROR
 13148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13149     ELSE
 13150     IF PB-COMPANY-ID = 'CRI'
 13151         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13152             NEXT SENTENCE
 13153         ELSE
 13154             MOVE ER-2606        TO  WS-ERROR
 13155             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13156     ELSE
 13157     IF PB-COMPANY-ID = 'TMS'
 13158         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13159             NEXT SENTENCE
 13160         ELSE
 13161             MOVE ER-2689        TO  WS-ERROR
 13162             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13163     ELSE
 13164         IF PB-I-SIG-SW = 'Y' OR 'N'
 13165             NEXT SENTENCE
 13166         ELSE
 13167             MOVE ER-2651        TO  WS-ERROR
 13168             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13169
 13170     IF PB-COMPANY-ID = 'FLA'
 13171         IF (WS-EDIT-AGE GREATER 54  OR
 13172             WS-AH-EDIT-AGE GREATER 54)  AND
 13173            PB-I-SIG-SW = 'N'
 13174            MOVE ER-2651         TO  WS-ERROR
 13175            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13176
 13177 3135-NAME-EDIT.
 13178
 13179     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13180        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13181        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13182           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13183                                 TO PB-I-JOINT-FIRST-NAME
 13184        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 240
* EL050.cbl
 13185     END-IF
 13186     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13187        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13188        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13189           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13190                                 TO PB-I-JOINT-LAST-NAME
 13191        END-PERFORM
 13192     END-IF
 13193     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13194        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13195        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13196           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13197                                 TO PB-I-INSURED-FIRST-NAME
 13198        END-PERFORM
 13199     END-IF
 13200     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13201        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13202        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13203           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13204                                 TO PB-I-INSURED-LAST-NAME
 13205        END-PERFORM
 13206     END-IF
 13207     IF PB-I-INSURED-LAST-NAME = SPACES
 13208       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13209       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13210           MOVE ER-2660    TO WS-ERROR
 13211           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13212
 13213 3136-EDIT-SEX.
 13214
 13215******************************************************************
 13216*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13217******************************************************************
 13218
 13219     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13220        (WS-AH-SPECIAL-CALC-CD = 'O')
 13221        NEXT SENTENCE
 13222     ELSE
 13223        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13224           NEXT SENTENCE
 13225        ELSE
 13226           MOVE ER-2629            TO WS-ERROR
 13227           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13228
 13229 3137-EDIT-EFF-DATE.
 13230
 13231     IF PB-REISSUED-CERT       OR
 13232        PB-POLICY-IS-DECLINED  OR
 13233        PB-POLICY-IS-VOIDED
 13234         GO TO 3139-EDIT-COVERAGE-CODES.
 13235
 13236     MOVE SPACE                  TO WS-2671-SW
 13237                                    WS-2672-SW.
 13238
 13239     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13240         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13241             MOVE ER-2703        TO WS-ERROR
 13242             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 241
* EL050.cbl
 13243             GO TO 3139-EDIT-COVERAGE-CODES.
 13244
 13245     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13246         GO TO 3139-EDIT-COVERAGE-CODES.
 13247
 13248     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13249     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13250*    MOVE '1'                    TO DC-OPTION-CODE.
 13251     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13252     MOVE +0                     TO DC-ELAPSED-MONTHS
 13253                                    DC-ELAPSED-DAYS.
 13254     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13255
 13256     IF DATE-CONVERSION-ERROR
 13257         GO TO 3139-EDIT-COVERAGE-CODES.
 13258
 13259     IF DC-ELAPSED-DAYS GREATER +180
 13260         MOVE ER-2672            TO WS-ERROR
 13261         MOVE 'Y'                TO WS-2672-SW
 13262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13263     END-IF
 13264
 13265     IF WS-ERROR = ER-2671  AND
 13266        PB-COMPANY-ID  = 'LBL'
 13267        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13268        MOVE SPACE               TO WS-2671-SW
 13269        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13270
 13271     IF PB-ISSUE-DATE-FORCED  AND
 13272      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13273         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13274         MOVE ER-2673            TO WS-ERROR
 13275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13276         MOVE SPACE              TO WS-2671-SW
 13277                                    WS-2672-SW.
 13278
 13279     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13280         IF PB-ISSUE-DATE-FORCED
 13281             MOVE ER-2600          TO  WS-ERROR
 13282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13283         ELSE
 13284             MOVE ER-2692          TO  WS-ERROR
 13285             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13286
 13287
 13288 3139-EDIT-COVERAGE-CODES.
 13289
 13290     if pb-company-id not = 'AHL'
 13291        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13292           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13293           MOVE ER-2787          TO WS-ERROR
 13294           PERFORM 9900-ERROR-FORMAT
 13295                                 THRU 9900-EXIT
 13296        END-IF
 13297     end-if
 13298     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13299        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13300                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 242
* EL050.cbl
 13301           MOVE ER-2719          TO WS-ERROR
 13302           PERFORM 9900-ERROR-FORMAT
 13303                                 THRU 9900-EXIT
 13304        END-IF
 13305     END-IF
 13306
 13307     IF PB-POLICY-IS-DECLINED  OR
 13308        PB-POLICY-IS-VOIDED
 13309         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13310
 13311     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13312        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13313         MOVE ER-2630                TO WS-ERROR
 13314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13315
 13316     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13317        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13318        PB-I-LF-PREMIUM-AMT = ZERO
 13319         GO TO 3140-CHECK-AH-FOR-ZERO.
 13320
 13321     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13322        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13323        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13324         GO TO 3140-CHECK-AH-FOR-ZERO.
 13325
 13326     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13327        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13328        MOVE ER-2631             TO WS-ERROR
 13329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13330     END-IF
 13331
 13332
 13333******************************************************************
 13334*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13335******************************************************************
 13336
 13337     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13338        NEXT SENTENCE
 13339     ELSE
 13340        IF PB-I-LF-BENEFIT-AMT = ZERO
 13341           MOVE ER-2632             TO WS-ERROR
 13342           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13343
 13344
 13345******************************************************************
 13346*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13347******************************************************************
 13348
 13349     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13350        CONTINUE
 13351     ELSE
 13352        IF PB-I-LF-PREMIUM-AMT = ZERO
 13353           IF (NOT PB-COMP-LF-PREM)
 13354              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13355              and (ws-lf-ben-category not = 'C')
 13356              MOVE ER-2633       TO WS-ERROR
 13357              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13358           END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 243
* EL050.cbl
 13359        END-IF
 13360     END-IF
 13361     .
 13362 3140-CHECK-AH-FOR-ZERO.
 13363
 13364     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13365        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13366        PB-I-AH-PREMIUM-AMT = ZERO
 13367         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13368
 13369     IF PB-COMPANY-ID = 'CSL'  AND
 13370        PB-I-AH-BENEFIT-CD = ZERO  AND
 13371        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13372        PB-I-AH-PREMIUM-AMT = ZERO
 13373         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13374
 13375     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13376        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13377        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13378         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13379
 13380     IF PB-I-AH-BENEFIT-CD = ZERO
 13381         MOVE ER-2634            TO WS-ERROR
 13382         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13383
 13384******************************************************************
 13385*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13386******************************************************************
 13387
 13388     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13389        NEXT SENTENCE
 13390     ELSE
 13391        IF PB-I-AH-BENEFIT-AMT = ZERO
 13392           MOVE ER-2635             TO WS-ERROR
 13393           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13394
 13395******************************************************************
 13396*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13397******************************************************************
 13398
 13399     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13400        NEXT SENTENCE
 13401     ELSE
 13402        IF PB-I-AH-PREMIUM-AMT = ZERO
 13403            IF NOT PB-COMP-AH-PREM
 13404                MOVE ER-2636    TO WS-ERROR
 13405                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13406
 13407
 13408 3140-EDIT-MAX-AMT-SIZES.
 13409* CUSTOM CODE FOR CLIENT    'DMD'
 13410     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13411                                     WS-RES-MUNI-TAX
 13412                                     PB-I-STATE-TAX
 13413                                     PB-I-MUNI-TAX.
 13414
 13415     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13416
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 244
* EL050.cbl
 13417     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13418        GO TO 3150-RATE-OUTSTAND-BAL.
 13419
 13420     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13421        GO TO 3150-RATE-OUTSTAND-BAL.
 13422
 13423     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13424        GO TO 3150-RATE-OUTSTAND-BAL.
 13425
 13426     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13427                             OR 'RIC')
 13428        GO TO 3150-RATE-OUTSTAND-BAL.
 13429
 13430     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13431        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13432            GO TO 3150-RATE-OUTSTAND-BAL
 13433        ELSE
 13434           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13435               GO TO 3150-RATE-OUTSTAND-BAL.
 13436
 13437     IF NOT PB-NO-MONTHS-SKIPPED
 13438        GO TO 3150-RATE-OUTSTAND-BAL.
 13439
 13440     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13441        GO TO 3150-RATE-OUTSTAND-BAL.
 13442
 13443     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13444        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13445           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13446             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13447           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13448           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13449              MOVE ER-2693     TO WS-ERROR
 13450              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13451              GO TO 3150-RATE-OUTSTAND-BAL
 13452           ELSE
 13453              GO TO 3150-RATE-OUTSTAND-BAL.
 13454
 13455 3150-RATE-OUTSTAND-BAL.
 13456
 13457* DMD RATING TEST
 13458     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13459         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13460         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13461         MOVE ER-2687                 TO WS-ERROR
 13462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13463         MOVE 'B'                     TO PB-I-OB-FLAG
 13464         GO TO 3260-EDIT-CONTINUE.
 13465
 13466     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13467         IF  WS-ERROR    EQUAL    ER-2693
 13468             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13469                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13470                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13471                 MOVE  +0            TO  WS-ERROR.
 13472
 13473     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13474         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 245
* EL050.cbl
 13475             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13476                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13477                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13478                 MOVE  +0            TO  WS-ERROR.
 13479
 13480     IF PLAN-MASTER-AH-SW = 'Y'
 13481        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13482            IF  WS-ERROR    EQUAL    ER-2693
 13483              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13484                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13485                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13486                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13487                 MOVE  ER-1910           TO  WS-ERROR
 13488                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13489
 13490     IF PLAN-MASTER-AH-SW = 'Y'
 13491        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13492            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13493               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13494               MOVE  ER-1910           TO  WS-ERROR
 13495               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13496
 13497     IF PLAN-MASTER-AH-SW = 'Y'
 13498        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13499            IF  WS-ERROR    EQUAL    ER-2693
 13500                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13501                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13502                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13503                 MOVE  +0       TO  WS-ERROR.
 13504
 13505     IF WS-ERROR = ER-2693
 13506        IF PB-COMPANY-ID = 'JAL' AND
 13507           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13508           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13509           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13510
 13511     IF WS-ERROR = ER-2693
 13512        IF PB-COMPANY-ID = 'NCL'  AND
 13513           PB-I-AH-BENEFIT-CD = 'OA'
 13514           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13515           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13516
 13517     IF WS-ERROR = ER-2693
 13518        IF PB-COMPANY-ID = 'CNL' AND
 13519           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13520           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13521           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13522
 13523     IF WS-ERROR = ER-2693
 13524        IF PB-COMPANY-ID = 'HER'
 13525           IF WS-LEVEL
 13526              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13527              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13528
 13529     IF ((LF-BENEFIT-FOUND) AND
 13530         (NOT NO-LIFE-COVERAGE)  AND
 13531         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13532       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 246
* EL050.cbl
 13533             (NOT NO-AH-COVERAGE)    AND
 13534             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13535         NEXT SENTENCE
 13536     ELSE
 13537         GO TO 3215-EDIT-RATES.
 13538
 13539     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13540        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13541           MOVE ER-2674          TO WS-ERROR
 13542           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13543           GO TO 3215-EDIT-RATES.
 13544
 13545     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13546        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13547           MOVE ER-2674          TO WS-ERROR
 13548           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13549           GO TO 3215-EDIT-RATES.
 13550
 13551     MOVE 'B'                    TO PB-I-OB-FLAG.
 13552
 13553     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13554         NEXT SENTENCE
 13555     ELSE
 13556         IF NOT NO-LIFE-COVERAGE
 13557             IF WS-ACCT-LF-OB-RT = ZERO
 13558                MOVE ER-2641    TO WS-ERROR
 13559                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13560
 13561     IF PB-COMPANY-ID = 'CRI'
 13562       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13563         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13564         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13565         IF WS-ERROR = ER-2675
 13566            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13567            MOVE ER-2687              TO WS-ERROR
 13568            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13569         ELSE
 13570            MOVE ER-2687              TO WS-ERROR
 13571            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13572
 13573
 13574     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13575         NEXT SENTENCE
 13576     ELSE
 13577       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13578            NEXT SENTENCE
 13579       ELSE
 13580         IF NOT NO-AH-COVERAGE
 13581             IF WS-ACCT-AH-OB-RT = ZERO
 13582                MOVE ER-2642    TO WS-ERROR
 13583                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13584
 13585     IF PB-COMPANY-ID = 'CRI'
 13586       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13587         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13588         IF WS-ERROR = ER-2676
 13589            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13590            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 247
* EL050.cbl
 13591            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13592         ELSE
 13593            MOVE ER-2687              TO WS-ERROR
 13594            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13595
 13596     IF PB-COMPANY-ID NOT = 'GIC'
 13597         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13598            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13599     ELSE
 13600         IF PB-I-LF-PREM-CALC = ZEROS
 13601             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13602                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13603
 13604     IF PB-COMPANY-ID NOT = 'GIC'
 13605         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13606            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13607     ELSE
 13608         IF PB-I-AH-PREM-CALC = ZEROS
 13609             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13610                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13611
 13612     MOVE ZEROS TO PB-I-MORT-CODE.
 13613
 13614     GO TO 3260-EDIT-CONTINUE.
 13615
 13616
 13617 3215-EDIT-RATES.
 13618     IF ACCOUNT-MAST-FOUND
 13619         NEXT SENTENCE
 13620     ELSE
 13621         GO TO 3999-END-EDIT.
 13622
 13623 3220-CHECK-LF-RATES.
 13624
 13625     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13626        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13627        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13628        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13629           AND (NOT WS-LF-CASH))
 13630                           OR
 13631           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13632           AND (NOT WS-AH-CASH)))
 13633                       AND
 13634           (PB-I-ENTRY-STATUS NOT = '5')
 13635           MOVE 'M'              TO PB-BATCH-ENTRY
 13636                                    PB-I-ENTRY-STATUS
 13637        END-IF
 13638     END-IF
 13639     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13640                                    PB-I-AH-PREM-CALC
 13641                                    PB-I-LF-ALT-PREM-CALC
 13642                                    PB-I-LF-ALT-RATE
 13643                                    PB-I-LF-REI-RATE
 13644                                    PB-I-LF-ALT-REI-RATE
 13645                                    PB-I-AH-REI-RATE
 13646                                    PB-I-TOT-FEES-CALC.
 13647
 13648     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 248
* EL050.cbl
 13649        NEXT SENTENCE
 13650     ELSE
 13651        MOVE ZEROS               TO PB-I-LF-RATE
 13652                                    PB-I-AH-RATE.
 13653
 13654     IF PB-I-TOT-FEES NOT NUMERIC
 13655        MOVE ZEROS               TO PB-I-TOT-FEES
 13656     END-IF
 13657     IF PB-I-LIVES NOT NUMERIC
 13658         MOVE ZERO               TO PB-I-LIVES.
 13659
 13660     IF PB-I-NUM-BILLED NOT NUMERIC
 13661         MOVE ZERO               TO PB-I-NUM-BILLED.
 13662
 13663     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13664        MOVE +0                  TO PB-I-LF-PREM-TAX
 13665     END-IF
 13666
 13667     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13668        MOVE +0                  TO PB-I-AH-PREM-TAX
 13669     END-IF
 13670
 13671     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13672        PB-I-PAY-FREQUENCY = ZEROS
 13673            MOVE 12 TO CP-PAY-FREQUENCY
 13674     ELSE
 13675            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13676
 13677     IF PB-I-STATE-TAX NOT NUMERIC
 13678         MOVE ZEROS               TO PB-I-STATE-TAX.
 13679
 13680     IF PB-I-MUNI-TAX NOT NUMERIC
 13681         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13682
 13683     MOVE SPACES                 TO CP-BEN-CATEGORY
 13684     IF PB-COMPANY-ID  = 'CSL'  AND
 13685        PB-I-LF-TERM NOT = ZERO
 13686        COMPUTE WS-PAYMENT-AMT =
 13687             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13688        COMPUTE WS-CSL-AMT1 =
 13689             PB-I-LF-TERM * AM-MAX-MON-BEN
 13690        COMPUTE WS-CSL-AMT2 =
 13691             WS-PAYMENT-AMT * PB-I-LF-TERM
 13692        IF CP-PAY-FREQUENCY NOT = 12
 13693           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13694           MOVE '8' TO WS-CSL-CALC-CD
 13695        ELSE
 13696           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13697              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13698               AM-MAX-TOT-BEN
 13699               MOVE '6' TO WS-CSL-CALC-CD
 13700           ELSE
 13701              IF (WS-CSL-AMT1  GREATER THAN
 13702                 AM-MAX-TOT-BEN) AND
 13703                 (WS-CSL-AMT2  GREATER THAN
 13704                 AM-MAX-TOT-BEN)
 13705                 MOVE '7' TO WS-CSL-CALC-CD
 13706              ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 249
* EL050.cbl
 13707                 MOVE '5' TO WS-CSL-CALC-CD.
 13708
 13709     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13710         NEXT SENTENCE
 13711     ELSE
 13712         GO TO 3300-CHECK-AH-RATES.
 13713
 13714*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13715
 13716     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13717        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13718              OR
 13719           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13720           MOVE ER-2618          TO WS-ERROR
 13721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13722           GO TO 3300-CHECK-AH-RATES.
 13723
 13724     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13725           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13726                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13727
 13728     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13729         MOVE ER-2687             TO WS-ERROR
 13730         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13731         MOVE 'Z000'              TO PB-I-MORT-CODE
 13732         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13733         GO TO 3300-CHECK-AH-RATES.
 13734
 13735     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13736        IF PB-I-LIVES = ZERO
 13737           MOVE ER-2688          TO WS-ERROR
 13738           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13739
 13740     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13741
 13742     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13743     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13744     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13745     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13746     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13747     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13748     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13749     MOVE '3'                    TO CP-PROCESS-TYPE.
 13750     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13751     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13752
 13753******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13754     IF PB-COMPANY-ID EQUAL 'CDL'
 13755         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13756            CP-EARN-AS-NET-PAY)
 13757             IF PB-CERT-EFF-DT GREATER  WS-931231
 13758                 MOVE '1'        TO CP-EARNING-METHOD.
 13759*******
 13760
 13761     MOVE PB-SV-STATE            TO CP-STATE.
 13762     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13763     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13764     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 250
* EL050.cbl
 13765     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13766     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13767                                    CP-RATING-BENEFIT-AMT.
 13768     IF CP-STATE-STD-ABBRV = 'OR'
 13769         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13770                                         PB-I-LF-ALT-BENEFIT-AMT.
 13771     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13772     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13773     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13774     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13775     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13776     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13777     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13778     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13779     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13780                                    CP-REMAINING-TERM
 13781                                    CP-LOAN-TERM.
 13782
 13783     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13784         NEXT SENTENCE
 13785     ELSE
 13786         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13787             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13788                                           PB-I-LF-PREMIUM-AMT.
 13789
 13790     IF PB-COMPANY-ID EQUAL 'CSL'
 13791        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13792           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13793                                         PB-I-LF-PREMIUM-AMT.
 13794
 13795     IF PB-COMPANY-ID EQUAL 'NCB'
 13796         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13797            CP-EARN-AS-NET-PAY
 13798             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13799                 PB-I-LF-PREMIUM-AMT.
 13800
 13801     IF (CP-TRUNCATED-LIFE)
 13802        or ((pb-company-id = 'AHL')
 13803           and (pb-i-loan-term > pb-i-lf-term))
 13804        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13805
 13806     IF PB-COMPANY-ID EQUAL 'CRI'
 13807        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13808
 13809     IF CP-TERM-IS-DAYS
 13810         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13811     ELSE
 13812         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13813     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13814        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13815        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13816        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13817        IF WS-LF-BEN-CATEGORY = 'D'
 13818           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13819           MOVE PB-I-LIFE-COMMISSION
 13820                                 TO CP-DCC-ACT-COMM
 13821           MOVE WS-LF-BEN-CATEGORY
 13822                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 251
* EL050.cbl
 13823        END-IF
 13824        IF (CP-BENEFIT-CD (1:1) = 'P')
 13825           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13826           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13827           add pb-i-ah-premium-amt to cp-original-premium
 13828        END-IF
 13829     END-IF
 13830     IF PB-COMPANY-ID = 'CSL'
 13831         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13832         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13833         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13834
 13835     IF PB-COMPANY-ID = 'CSL'
 13836        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13837
 13838     IF (CP-SPECIAL-CALC-CD = 'H')
 13839        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13840         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13841                                    TO CP-ALTERNATE-BENEFIT
 13842         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13843     if (pb-company-id = 'CID')
 13844        and (ws-lf-earnings-calc = '4')
 13845        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13846        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13847        move pb-i-term-type      to cp-pmt-mode
 13848        move pb-i-no-of-payments to cp-no-of-pmts
 13849     end-if
 13850     move ws-net-only-state      to cp-net-only-state
 13851     IF (PB-COMPANY-ID = 'CID')
 13852        AND (WS-LF-EARNINGS-CALC = 'B')
 13853        AND (CP-STATE-STD-ABBRV = 'MN')
 13854        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13855                                 TO CP-ALTERNATE-BENEFIT
 13856        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13857     END-IF
 13858     IF (PB-COMPANY-ID = 'CID')
 13859        AND (WS-LF-EARNINGS-CALC = 'B')
 13860        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13861                                 TO CP-ALTERNATE-BENEFIT
 13862        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13863        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13864*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13865*         pb-i-lf-alt-premium-amt
 13866        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13867        IF WS-LF-BEN-CATEGORY = 'P'
 13868           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13869        ELSE
 13870           IF WS-LF-BEN-CATEGORY = 'I'
 13871              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13872           END-IF
 13873        END-IF
 13874     END-IF
 13875     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13876     MOVE 'R'                   TO CP-RATE-FILE.
 13877     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13878
 13879     IF CP-ERROR-RATE-NOT-FOUND
 13880        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 252
* EL050.cbl
 13881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13882        GO TO 3300-CHECK-AH-RATES.
 13883
 13884     IF PB-COMPANY-ID EQUAL 'CRI'
 13885        IF CP-ERROR-NO-LIMITS-CRI
 13886           IF NOT ACCOUNT-LIFE-CHECKED
 13887              MOVE ER-2607      TO WS-ERROR
 13888              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13889
 13890******************************************************************
 13891*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13892*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13893******************************************************************
 13894
 13895* CALC LIFE AGE AT EXPIRATION.
 13896
 13897     COMPUTE WS-AGE-AT-EXPIRE =
 13898          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13899
 13900*    IF PB-STATE = 'CO' OR 'UT'
 13901*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13902*        MOVE 'F'            TO PB-FATAL-FLAG
 13903*        MOVE ER-2709        TO WS-ERROR
 13904*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13905*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13906
 13907*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13908*        MOVE 'X'            TO PB-FATAL-FLAG
 13909*        MOVE ER-2718        TO WS-ERROR
 13910*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13911*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13912
 13913* CALC A & H AGE AT EXPIRATION.
 13914
 13915     COMPUTE WS-AGE-AT-EXPIRE =
 13916          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13917
 13918*    IF PB-STATE = 'CO' OR 'UT'
 13919*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13920*        MOVE 'F'            TO PB-FATAL-FLAG
 13921*        MOVE ER-2709        TO WS-ERROR
 13922*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13923*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13924
 13925*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13926*        MOVE 'X'            TO PB-FATAL-FLAG
 13927*        MOVE ER-2718        TO WS-ERROR
 13928*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13929*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13930
 13931     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13932        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13933
 13934     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13935        and (not pb-monthly-cert)
 13936        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13937     end-if
 13938
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 253
* EL050.cbl
 13939     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13940        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13941
 13942     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13943         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13944         MOVE ER-2639        TO WS-ERROR
 13945         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13946
 13947
 13948******************************************************************
 13949*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13950******************************************************************
 13951
 13952 PREMIUM-EDITING-IS-BYPASSED.
 13953     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13954        AND (CP-R-MAX-ATT-AGE > +0)
 13955        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13956        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13957           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13958           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13959           MOVE '1'              TO DC-OPTION-CODE
 13960           PERFORM 8500-DATE-CONVERT
 13961                                 THRU 8500-EXIT
 13962           IF NO-CONVERSION-ERROR
 13963              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13964                 MOVE ER-2661       TO WS-ERROR
 13965*                PERFORM 9900-ERROR-FORMAT
 13966*                                THRU 9900-EXIT
 13967              END-IF
 13968           END-IF
 13969        ELSE
 13970           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13971           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13972              MOVE ER-2661       TO WS-ERROR
 13973*             PERFORM 9900-ERROR-FORMAT
 13974*                                THRU 9900-EXIT
 13975           ELSE
 13976              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13977                 MOVE ER-1570    TO WS-ERROR
 13978                 PERFORM 9900-ERROR-FORMAT
 13979                                 THRU 9900-EXIT
 13980              END-IF
 13981           END-IF
 13982        END-IF
 13983        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13984           MOVE PB-I-JOINT-BIRTHDAY
 13985                                 TO DC-BIN-DATE-1
 13986           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13987           MOVE '1'              TO DC-OPTION-CODE
 13988           PERFORM 8500-DATE-CONVERT
 13989                                 THRU 8500-EXIT
 13990           IF NO-CONVERSION-ERROR
 13991              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13992                 MOVE ER-2661       TO WS-ERROR
 13993*                PERFORM 9900-ERROR-FORMAT
 13994*                                THRU 9900-EXIT
 13995              END-IF
 13996           ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 254
* EL050.cbl
 13997              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13998           END-IF
 13999        ELSE
 14000           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14001             (PB-I-LF-TERM / 12)
 14002           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14003              MOVE ER-2661       TO WS-ERROR
 14004*             PERFORM 9900-ERROR-FORMAT
 14005*                                THRU 9900-EXIT
 14006           ELSE
 14007              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14008                 MOVE ER-1571    TO WS-ERROR
 14009                 PERFORM 9900-ERROR-FORMAT
 14010                                 THRU 9900-EXIT
 14011              END-IF
 14012           END-IF
 14013        END-IF
 14014        IF WS-ERROR = ER-2661
 14015           PERFORM 9900-ERROR-FORMAT
 14016                                 THRU 9900-EXIT
 14017        END-IF
 14018     END-IF
 14019*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14020*       MOVE ER-2661             TO WS-ERROR
 14021*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14022
 14023     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14024        MOVE ER-2662             TO WS-ERROR
 14025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14026
 14027     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14028        MOVE ER-2677             TO WS-ERROR
 14029        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14030
 14031     IF CP-ERROR-LOAN-TERM
 14032        MOVE ER-2648             TO WS-ERROR
 14033        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14034
 14035 3221-CHECK-ERROR-RATE-OPEN.
 14036
 14037     IF CP-ERROR-RATE-FILE-NOTOPEN
 14038         GO TO 3990-FILES-NOT-OPEN.
 14039
 14040     IF PB-COMPANY-ID NOT = 'DMD'
 14041        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14042     END-IF
 14043     .
 14044 3221-CONTINUE.
 14045     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14046                                    WS-DCC-AH-RATE
 14047     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14048        IF WS-LF-BEN-CATEGORY = 'D'
 14049           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14050              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14051        END-IF
 14052     END-IF
 14053     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14054*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 255
* EL050.cbl
 14055     IF (PB-COMPANY-ID = 'CID')
 14056        AND (WS-LF-EARNINGS-CALC = 'B')
 14057        AND (CP-STATE-STD-ABBRV = 'MN')
 14058        AND (PB-CERT-EFF-DT > X'A4FF')
 14059        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14060     END-IF
 14061     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14062
 14063     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14064     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14065        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14066        AND (PB-I-POLICY-IS-MONTHLY)
 14067        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14068        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14069     END-IF
 14070     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14071     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14072     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14073     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14074     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14075        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14076        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14077        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14078        MOVE ER-2786             TO WS-ERROR
 14079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14080     END-IF
 14081
 14082     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14083
 14084******************************************************************
 14085*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14086******************************************************************
 14087     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14088        and ((not pb-monthly-cert)
 14089        or (ws-lf-ben-category = 'C'))
 14090        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14091
 14092     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14093        GO TO 3225-CHECK-ALT-LIFE-RATE
 14094     ELSE
 14095       IF PB-I-LF-RATE = ZERO
 14096          MOVE ER-2641          TO WS-ERROR
 14097          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14098
 14099 3225-CHECK-ALT-LIFE-RATE.
 14100
 14101     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14102        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14103        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14104         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14105
 14106     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14107         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14108             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14109                   OR
 14110              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14111              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14112              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 256
* EL050.cbl
 14113             MOVE ER-2720        TO  WS-ERROR
 14114             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14115             GO TO 3225-RATING-CONT
 14116         ELSE
 14117             GO TO 3225-RATING-CONT.
 14118     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14119        AND (AM-GPCD = 01 OR 06 OR 15)
 14120        MOVE ER-2798             TO WS-ERROR
 14121        PERFORM 9900-ERROR-FORMAT
 14122                                 THRU 9900-EXIT
 14123*       GO TO 3225-RATING-CONT
 14124     END-IF
 14125     if (pb-company-id = 'CID')
 14126        and (ws-lf-earnings-calc = 'B')
 14127        and (ws-lf-ben-category = 'P' or 'I')
 14128        and (ws-net-only-state = 'Y')
 14129        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14130        display ' balloon prem ' pb-i-lf-alt-prem-calc
 14131        go to 3225-rating-cont
 14132     end-if
 14133     IF (PB-COMPANY-ID = 'CID')
 14134        AND (WS-LF-EARNINGS-CALC = 'B')
 14135        AND (CP-STATE-STD-ABBRV = 'MN')
 14136        AND (PB-CERT-EFF-DT > X'A4FF')
 14137        GO TO 3225-RATING-CONT
 14138     END-IF
 14139     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14140        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14141           AND (PB-I-POLICY-IS-MONTHLY)
 14142           GO TO 3225-RATING-CONT
 14143        END-IF
 14144     END-IF
 14145
 14146     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14147        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14148        CP-EARN-AS-REG-BALLOON
 14149        NEXT SENTENCE
 14150     ELSE
 14151        MOVE '2'                 TO CP-EARNING-METHOD.
 14152
 14153 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14154
 14155     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14156
 14157     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14158        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14159        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14160         NEXT SENTENCE
 14161     ELSE
 14162         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14163
 14164     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14165     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14166     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14167                                     CP-RATING-BENEFIT-AMT.
 14168     IF CP-STATE-STD-ABBRV = 'OR'
 14169         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14170                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 257
* EL050.cbl
 14171     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14172        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14173     END-IF
 14174     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14175     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14176     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14177                                    CP-REMAINING-TERM
 14178                                    CP-LOAN-TERM.
 14179     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14180        ADD +1                   TO CP-ORIGINAL-TERM
 14181                                    CP-REMAINING-TERM
 14182                                    CP-LOAN-TERM.
 14183
 14184     MOVE 'R'                   TO CP-RATE-FILE.
 14185     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14186
 14187     IF CP-ERROR-RATE-NOT-FOUND
 14188         MOVE ER-2641            TO WS-ERROR
 14189         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14190         GO TO 3300-CHECK-AH-RATES.
 14191
 14192     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14193     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14194
 14195     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14196         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14197
 14198     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14199                               + PB-I-LF-ALT-BENEFIT-AMT.
 14200
 14201     IF ACCOUNT-LIFE-CHECKED  OR
 14202        PB-POLICY-IS-VOIDED   OR
 14203        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14204        and (not pb-monthly-cert))
 14205        GO TO 3225-CONTINUE.
 14206
 14207     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14208        GO TO 3225-CONTINUE.
 14209
 14210     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14211                             EC-RT-LF-MAX-TOT-BEN
 14212        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14213        MOVE ER-2639       TO WS-ERROR
 14214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14215
 14216 3225-CONTINUE.
 14217     IF PB-I-LF-ALT-RATE = ZERO
 14218         MOVE ER-2659            TO WS-ERROR
 14219         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14220
 14221     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14222        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14223        MOVE ER-2698             TO WS-ERROR
 14224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14225
 14226 3225-RATING-CONT.
 14227
 14228     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 258
* EL050.cbl
 14229        and (not pb-monthly-cert)
 14230         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14231         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14232         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14233            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14234            CONTINUE
 14235         ELSE
 14236            MOVE ER-2687         TO WS-ERROR
 14237            PERFORM 9900-ERROR-FORMAT
 14238                                 THRU 9900-EXIT
 14239         END-IF
 14240         GO TO 3290-EDIT-LF-REIN-RATE
 14241     END-IF
 14242
 14243* DMD RATING TEST
 14244     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14245         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14246         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14247         MOVE ER-2687                 TO WS-ERROR
 14248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14249         GO TO 3290-EDIT-LF-REIN-RATE.
 14250
 14251 3230-CLIENT-MORT-CD-SPECIALS.
 14252
 14253     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14254     SET BIN-TO-GREG          TO TRUE.
 14255*    MOVE ' '                 TO DC-OPTION-CODE.
 14256     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14257     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14258
 14259 C-POS-3230-MORT-CD.
 14260     IF PB-COMPANY-ID = 'POS' AND
 14261        PB-SV-CARRIER = '2'
 14262         NEXT SENTENCE
 14263     ELSE
 14264         GO TO C-POS-3240-MORT-CD.
 14265
 14266     IF PB-SV-GROUPING = '030'
 14267        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14268         MOVE '2350' TO PB-I-MORT-CODE
 14269      ELSE
 14270         MOVE '3300' TO PB-I-MORT-CODE.
 14271
 14272
 14273 C-POS-3240-MORT-CD.
 14274     IF PB-COMPANY-ID = 'POS' AND
 14275        PB-SV-CARRIER = '1'
 14276         NEXT SENTENCE
 14277     ELSE
 14278         GO TO 3230-CONTINUE.
 14279
 14280     IF PB-SV-STATE = '45' OR '47'
 14281        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14282         MOVE '5200' TO PB-I-MORT-CODE
 14283     ELSE
 14284         MOVE '8300' TO PB-I-MORT-CODE.
 14285
 14286 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 259
* EL050.cbl
 14287
 14288     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14289        GO TO 3240-CONTINUE
 14290     END-IF
 14291
 14292     IF PB-CERT-EFF-DT > WS-971231
 14293        GO TO 3240-CONTINUE
 14294     END-IF
 14295
 14296     IF LF-BENEFIT-FOUND AND
 14297        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14298         MOVE 'F250'       TO PB-I-MORT-CODE
 14299     ELSE
 14300         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14301             MOVE '7250'   TO PB-I-MORT-CODE
 14302         ELSE
 14303             MOVE '4251'   TO PB-I-MORT-CODE
 14304         END-IF
 14305     END-IF
 14306
 14307     .
 14308 3240-CONTINUE.
 14309
 14310     IF PB-COMPANY-ID NOT = 'GNL'
 14311         GO TO 3256-CONTINUE.
 14312
 14313     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14314         MOVE 'A300' TO PB-I-MORT-CODE
 14315     ELSE
 14316         MOVE '8350' TO PB-I-MORT-CODE.
 14317
 14318 3256-CONTINUE.
 14319     IF PB-COMPANY-ID NOT = 'ABL'
 14320         GO TO 3260-EDIT-CONTINUE.
 14321
 14322     IF PB-I-LF-TERM GREATER THAN 59
 14323         MOVE 'F550' TO PB-I-MORT-CODE
 14324     ELSE
 14325         MOVE 'E550' TO PB-I-MORT-CODE.
 14326
 14327 3260-EDIT-CONTINUE.
 14328     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14329
 14330 3290-EDIT-LF-REIN-RATE.
 14331     IF LF-REIN-NSP-NOT-USED
 14332         GO TO 3290-RATING-CONT.
 14333
 14334     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14335        GO TO 3290-RATING-CONT.
 14336     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14337     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14338     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14339     MOVE '3'                   TO CP-PROCESS-TYPE.
 14340     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14341
 14342******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14343     IF PB-COMPANY-ID EQUAL 'CDL'
 14344         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 260
* EL050.cbl
 14345            CP-EARN-AS-NET-PAY)
 14346             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14347*            MOVE SPACE          TO DC-OPTION-CODE
 14348             SET BIN-TO-GREG     TO TRUE
 14349             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14350***  Y2K PROJ 7744
 14351             IF DC-GREG-DATE-CYMD GREATER 19931231
 14352                 MOVE '1'        TO CP-EARNING-METHOD.
 14353***  Y2K PROJ 7744
 14354*******
 14355
 14356     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14357     MOVE PB-SV-STATE           TO CP-STATE.
 14358     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14359     MOVE ZERO                  TO CP-DEVIATION-CODE
 14360                                   CP-RATE-DEV-PCT.
 14361     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14362     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14363                                   CP-RATING-BENEFIT-AMT.
 14364
 14365************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14366     IF PB-COMPANY-ID EQUAL 'NCB'
 14367         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14368            CP-EARN-AS-NET-PAY
 14369             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14370                 PB-I-LF-PREMIUM-AMT.
 14371************
 14372
 14373     IF CP-STATE-STD-ABBRV = 'OR'
 14374         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14375                                         PB-I-LF-ALT-BENEFIT-AMT.
 14376     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14377     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14378     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14379     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14380     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14381     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14382     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14383     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14384                                   CP-REMAINING-TERM
 14385                                   CP-LOAN-TERM.
 14386     IF CP-TRUNCATED-LIFE
 14387        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14388
 14389     IF CP-TERM-IS-DAYS
 14390         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14391     ELSE
 14392         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14393
 14394     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14395        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14396     END-IF
 14397     IF PB-COMPANY-ID NOT = 'TIC'
 14398          MOVE ZERO          TO CP-CLASS-CODE.
 14399
 14400     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14401
 14402     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 261
* EL050.cbl
 14403     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14404
 14405     IF CP-ERROR-RATE-NOT-FOUND
 14406        IF PB-I-OB
 14407           MOVE ER-2625      TO WS-ERROR
 14408           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14409           GO TO 3299-EDIT-CONTINUE
 14410        ELSE
 14411           MOVE ER-2643      TO WS-ERROR
 14412           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14413           GO TO 3299-EDIT-CONTINUE.
 14414
 14415     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14416
 14417     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14418     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14419
 14420     IF PB-I-LF-REI-RATE = ZERO
 14421         MOVE ER-2643        TO WS-ERROR
 14422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14423
 14424 3290-CHECK-ALT-REIN-RATE.
 14425
 14426     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14427        GO TO 3290-RATING-CONT.
 14428
 14429     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14430     MOVE '2'                    TO CP-EARNING-METHOD.
 14431     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14432     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14433     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14434     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14435                                     CP-RATING-BENEFIT-AMT.
 14436     IF CP-STATE-STD-ABBRV = 'OR'
 14437         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14438                                         PB-I-LF-ALT-BENEFIT-AMT.
 14439     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14440        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14441     END-IF
 14442     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14443     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14444     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14445                                    CP-REMAINING-TERM
 14446                                    CP-LOAN-TERM.
 14447     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14448        ADD +1                   TO CP-ORIGINAL-TERM
 14449                                    CP-REMAINING-TERM
 14450                                    CP-LOAN-TERM.
 14451
 14452     MOVE 'R'                   TO CP-RATE-FILE.
 14453     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14454
 14455     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14456
 14457     IF PB-I-LF-ALT-REI-RATE = ZERO
 14458         MOVE ER-2643            TO WS-ERROR
 14459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14460
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 262
* EL050.cbl
 14461 3290-RATING-CONT.
 14462
 14463     IF PB-I-OB
 14464*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14465        GO TO 3300-CHECK-AH-RATES.
 14466
 14467 3299-EDIT-CONTINUE.
 14468
 14469     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14470         NEXT SENTENCE
 14471     ELSE
 14472         MOVE ER-2620           TO WS-ERROR
 14473         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14474
 14475 3300-CHECK-AH-RATES.
 14476     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14477         NEXT SENTENCE
 14478     ELSE
 14479         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14480
 14481     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14482        and (not pb-monthly-cert))
 14483                  or
 14484        ((CF-COMPANY-ID = 'DMD') AND
 14485                (NO-DMD-RATING))
 14486         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14487            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14488            CONTINUE
 14489         ELSE
 14490            MOVE ER-2687         TO WS-ERROR
 14491            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14492         END-IF
 14493         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14494         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14495     END-IF
 14496
 14497     IF PB-I-OB
 14498        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14499
 14500     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14501         MOVE ER-2687             TO WS-ERROR
 14502         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14503         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14504         GO TO 3999-END-EDIT.
 14505
 14506*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14507     if pb-company-id = 'AHL'
 14508        go to 3300-skip-crit-per
 14509     end-if
 14510     if (pb-i-ah-crit-per not = zeros)
 14511        and (ws-ah-special-calc-cd not = 'C')
 14512        MOVE ER-1572             TO WS-ERROR
 14513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14514        go to 3300-skip-crit-per
 14515     END-IF
 14516     if (pb-company-id = 'DCC' or 'VPP')
 14517        and (am-dcc-product-code not = spaces)
 14518        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 263
* EL050.cbl
 14519     end-if
 14520     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14521        IF PB-I-AH-CRIT-PER = ZERO
 14522           move ws-ah-max-bens   to pb-i-ah-crit-per
 14523*          MOVE ER-2618       TO WS-ERROR
 14524*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14525*          GO TO 3999-END-EDIT
 14526        END-IF
 14527     END-IF
 14528     if (ws-ah-special-calc-cd = 'C')
 14529        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14530        MOVE ER-1576             TO WS-ERROR
 14531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14532     end-if
 14533
 14534     .
 14535 3300-skip-crit-per.
 14536     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14537     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14538     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14539     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14540     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14541     MOVE PB-SV-STATE            TO CP-STATE.
 14542     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14543     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14544     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14545*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14546     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14547     MOVE '3'                    TO CP-PROCESS-TYPE.
 14548     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14549     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14550                                    CP-RATING-BENEFIT-AMT.
 14551     IF PB-COMPANY-ID = 'CID'
 14552               OR
 14553        CP-STATE-STD-ABBRV = 'OR'
 14554         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14555                                         PB-I-AH-TERM.
 14556     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14557        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14558           AND (PB-I-POLICY-IS-MONTHLY)
 14559           MOVE PB-I-LF-BENEFIT-AMT
 14560                                 TO CP-NET-BENEFIT-AMT
 14561           move pb-i-ah-premium-amt to cp-original-premium
 14562           add pb-i-lf-premium-amt to cp-original-premium
 14563        END-IF
 14564     END-IF
 14565     MOVE SPACES                 TO CP-BEN-CATEGORY
 14566     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14567        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14568        EVALUATE TRUE
 14569           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14570              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14571              MOVE PB-I-LF-BENEFIT-AMT
 14572                                 TO CP-RATING-BENEFIT-AMT
 14573              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14574           WHEN WS-AH-BEN-CATEGORY = 'G'
 14575              MOVE PB-I-UNPAID-CASH-PRICE
 14576                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 264
* EL050.cbl
 14577           WHEN WS-AH-BEN-CATEGORY = 'D'
 14578              MOVE WS-AH-PMF-COMM
 14579                                 TO CP-DCC-PMF-COMM
 14580              MOVE PB-I-AH-COMMISSION
 14581                                 TO CP-DCC-ACT-COMM
 14582        END-EVALUATE
 14583     END-IF
 14584     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14585     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14586     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14587     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14588     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14589     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14590     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14591                                    CP-REMAINING-TERM
 14592                                    WS-WORK-TERM.
 14593     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14594
 14595     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14596     SET BIN-TO-GREG             TO TRUE.
 14597*    MOVE ' '                    TO DC-OPTION-CODE.
 14598     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14599     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14600
 14601     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14602     IF NOT VALID-SKIP-CODE
 14603         MOVE ER-2683            TO WS-ERROR
 14604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14605         GO TO 3320-RATE-CONTINUE.
 14606
 14607     IF PB-NO-MONTHS-SKIPPED
 14608         GO TO 3320-RATE-CONTINUE.
 14609
 14610     MOVE SPACE TO NUMBER-OF-MONTHS.
 14611
 14612     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14613         MOVE 'S'                TO SK-MO (6).
 14614     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14615         MOVE 'S'                TO SK-MO (7).
 14616     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14617         MOVE 'S'                TO SK-MO (8).
 14618     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14619         MOVE 'S'                TO SK-MO (9).
 14620     IF PB-I-SKIP-CODE = 'A'
 14621         MOVE 'S'                TO SK-MO (10).
 14622
 14623     MOVE 1                      TO SUB2.
 14624     MOVE PB-I-AH-TERM           TO SUB3.
 14625     MOVE WS-MONTH               TO SUB1.
 14626     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14627     GO TO 3320-RATE-CONTINUE.
 14628
 14629 3310-GET-SKIP-MO.
 14630     IF SUB1 = 13
 14631         MOVE 1                  TO SUB1.
 14632
 14633     IF SK-MO (SUB1) = 'S'
 14634         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 265
* EL050.cbl
 14635
 14636     ADD 1 TO SUB2
 14637              SUB1.
 14638
 14639 3320-RATE-CONTINUE.
 14640
 14641     IF WS-WORK-TERM = ZERO
 14642         MOVE 1                  TO WS-WORK-TERM.
 14643
 14644     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14645                                    CP-LOAN-TERM.
 14646
 14647     IF PB-COMPANY-ID EQUAL 'DMD'
 14648         NEXT SENTENCE
 14649     ELSE
 14650         MOVE ZERO               TO PB-I-AH-RATE
 14651                                    PB-I-AH-REI-RATE.
 14652
 14653
 14654     IF PB-COMPANY-ID EQUAL 'CRI'
 14655        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14656
 14657     IF PB-COMPANY-ID = 'CSL'
 14658         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14659         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14660         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14661         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14662
 14663     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14664        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14665           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14666              PB-I-RATE-DEV-PCT-LF
 14667        END-IF
 14668        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14669                                 TO CP-ALTERNATE-BENEFIT
 14670        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14671        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14672        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14673     END-IF
 14674*    if ws-clp-state not = spaces
 14675*       move ws-clp-state to cp-state
 14676*    end-if
 14677     IF (PB-COMPANY-ID = 'CID')
 14678        AND (WS-LF-EARNINGS-CALC = 'B')
 14679        AND (CP-STATE-STD-ABBRV = 'MN')
 14680        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14681     ELSE
 14682        MOVE ' '                 TO CP-AH-BALLOON-SW
 14683     END-IF
 14684     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14685     MOVE 'R'                   TO CP-RATE-FILE.
 14686     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14687
 14688     IF (CP-ERROR-RATE-NOT-FOUND)
 14689        and (not pb-monthly-cert)
 14690        IF PB-I-OB
 14691           MOVE ER-2624          TO WS-ERROR
 14692           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 266
* EL050.cbl
 14693           GO TO 3340-CALCULATE-PREMIUM-AMT
 14694        ELSE
 14695          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14696              NEXT SENTENCE
 14697          ELSE
 14698           MOVE ER-2642          TO WS-ERROR
 14699           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14700           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14701
 14702     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14703        CP-ERROR-DIV-BY-ZERO
 14704           MOVE ER-3782          TO WS-ERROR
 14705           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14706
 14707     IF PB-COMPANY-ID EQUAL 'CRI'
 14708        IF CP-ERROR-NO-LIMITS-CRI
 14709           IF NOT ACCOUNT-AH-CHECKED
 14710              MOVE ER-2607          TO WS-ERROR
 14711              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14712
 14713     IF ACCOUNT-AH-CHECKED
 14714        NEXT SENTENCE
 14715     ELSE
 14716       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14717          MOVE ER-2640           TO WS-ERROR
 14718          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14719
 14720     IF PB-COMPANY-ID = 'CRI'
 14721         IF WS-ERROR = ER-2640
 14722             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14723     IF ACCOUNT-AH-CHECKED
 14724        CONTINUE
 14725     ELSE
 14726        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14727           AND (CP-R-MAX-ATT-AGE > +0)
 14728           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14729           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14730              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14731              MOVE PB-I-AH-EXPIRE-DT
 14732                                 TO DC-BIN-DATE-2
 14733              MOVE '1'           TO DC-OPTION-CODE
 14734              PERFORM 8500-DATE-CONVERT
 14735                                 THRU 8500-EXIT
 14736              IF NO-CONVERSION-ERROR
 14737                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14738                    MOVE ER-2661       TO WS-ERROR
 14739*                   PERFORM 9900-ERROR-FORMAT
 14740*                                THRU 9900-EXIT
 14741                 END-IF
 14742              END-IF
 14743           ELSE
 14744              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14745              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14746                 MOVE ER-2661    TO WS-ERROR
 14747*                PERFORM 9900-ERROR-FORMAT
 14748*                                THRU 9900-EXIT
 14749              ELSE
 14750                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 267
* EL050.cbl
 14751                    MOVE ER-1570 TO WS-ERROR
 14752                    PERFORM 9900-ERROR-FORMAT
 14753                                 THRU 9900-EXIT
 14754                 END-IF
 14755              END-IF
 14756           END-IF
 14757           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14758              MOVE PB-I-JOINT-BIRTHDAY
 14759                                    TO DC-BIN-DATE-1
 14760              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14761              MOVE '1'              TO DC-OPTION-CODE
 14762              PERFORM 8500-DATE-CONVERT
 14763                                    THRU 8500-EXIT
 14764              IF NO-CONVERSION-ERROR
 14765                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14766                    MOVE ER-2661       TO WS-ERROR
 14767*                   PERFORM 9900-ERROR-FORMAT
 14768*                                   THRU 9900-EXIT
 14769                 END-IF
 14770              END-IF
 14771           ELSE
 14772              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14773                (PB-I-AH-TERM / 12)
 14774              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14775                 MOVE ER-2661       TO WS-ERROR
 14776*                PERFORM 9900-ERROR-FORMAT
 14777*                                   THRU 9900-EXIT
 14778              ELSE
 14779                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14780                    MOVE ER-1571 TO WS-ERROR
 14781                    PERFORM 9900-ERROR-FORMAT
 14782                                 THRU 9900-EXIT
 14783                 END-IF
 14784              END-IF
 14785           END-IF
 14786           IF WS-ERROR = ER-2661
 14787              PERFORM 9900-ERROR-FORMAT
 14788                                    THRU 9900-EXIT
 14789           END-IF
 14790        END-IF
 14791     END-IF
 14792*    IF ACCOUNT-AH-CHECKED
 14793*       NEXT SENTENCE
 14794*    ELSE
 14795*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14796*          MOVE ER-2661          TO WS-ERROR
 14797*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14798
 14799     IF ACCOUNT-AH-CHECKED
 14800        NEXT SENTENCE
 14801     ELSE
 14802        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14803           MOVE ER-2663          TO WS-ERROR
 14804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14805
 14806     IF ACCOUNT-AH-CHECKED OR
 14807        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14808         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 268
* EL050.cbl
 14809        NEXT SENTENCE
 14810     ELSE
 14811        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14812           MOVE ER-2667            TO WS-ERROR
 14813           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14814
 14815     IF PB-COMPANY-ID = 'CRI'
 14816         IF WS-ERROR = ER-2667
 14817             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14818
 14819     IF ACCOUNT-AH-CHECKED
 14820        NEXT SENTENCE
 14821     ELSE
 14822        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14823           MOVE ER-2678            TO WS-ERROR
 14824           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14825
 14826     IF CP-ERROR-RATE-FILE-NOTOPEN
 14827         GO TO 3990-FILES-NOT-OPEN.
 14828
 14829 3321-CONTINUE.
 14830     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14831     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14832     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14833*    IF (PB-COMPANY-ID = 'DCC')
 14834        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14835        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14836                                    PB-I-LF-ALT-PREM-CALC
 14837        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14838        IF WS-AH-BEN-CATEGORY = 'G'
 14839           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14840           + PB-I-ADDL-CLP)
 14841           * (1 + WS-TOL-CLP-PCT)
 14842*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14843        ELSE
 14844           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14845           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14846*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14847        END-IF
 14848        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14849                                 TO PB-I-AH-PREM-CALC
 14850        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14851           MOVE ER-8152          TO WS-ERROR
 14852           PERFORM 9900-ERROR-FORMAT
 14853                                 THRU 9900-EXIT
 14854        ELSE
 14855           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14856                 PB-I-ADDL-CLP)
 14857              MOVE ER-8148       TO WS-ERROR
 14858              PERFORM 9900-ERROR-FORMAT
 14859                                 THRU 9900-EXIT
 14860           END-IF
 14861        END-IF
 14862     END-IF
 14863     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14864        AND (PB-I-POLICY-IS-MONTHLY)
 14865        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14866        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 269
* EL050.cbl
 14867        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14868           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14869        END-IF
 14870     END-IF
 14871     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14872        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14873        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14874        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14875        MOVE ER-2786             TO WS-ERROR
 14876        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14877     END-IF
 14878     MOVE +0                     TO PB-I-AH-CLP
 14879     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14880        evaluate true
 14881           when WS-AH-BEN-CATEGORY = 'D'
 14882              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14883                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14884           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14885              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14886           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14887              compute ws-cred-union-fees rounded =
 14888                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14889                    pb-i-ah-commission)
 14890              COMPUTE PB-I-AH-CLP =
 14891                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14892        end-evaluate
 14893     END-IF
 14894     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14895
 14896     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14897         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14898
 14899     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14900         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14901
 14902     if (ws-ah-special-calc-cd = 'E')
 14903        and (pb-monthly-cert)
 14904        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14905     end-if
 14906     IF PB-COMPANY-ID = 'CRI'
 14907         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14908            PB-I-PAYMENT-AMOUNT = ZERO
 14909             NEXT SENTENCE
 14910         ELSE
 14911             COMPUTE PB-I-AH-PREM-CALC =
 14912                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14913                 (CP-PREMIUM-RATE / 100)
 14914             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14915                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14916                                             PB-I-RATE-DEV-PCT-AH.
 14917
 14918     IF (PB-I-AH-RATE  = ZERO)
 14919        and (not pb-monthly-cert)
 14920       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14921           NEXT SENTENCE
 14922       ELSE
 14923         MOVE ER-2642            TO WS-ERROR
 14924         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 270
* EL050.cbl
 14925
 14926     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14927     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14928     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14929     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14930     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14931     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14932
 14933     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14934        AND (WS-AH-BEN-CATEGORY = 'G')
 14935        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14936        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14937        IF CP-DEVIATION-CODE NOT = '000'
 14938           MOVE '000'            TO CP-DEVIATION-CODE
 14939           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14940           IF NO-CP-ERROR
 14941              COMPUTE PB-I-DDF-IU-RATE-UP =
 14942              PB-I-AH-CLP - CP-CALC-PREMIUM
 14943           ELSE
 14944              MOVE ER-3057        TO WS-ERROR
 14945              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14946           END-IF
 14947        END-IF
 14948     END-IF
 14949     .
 14950 3335-EDIT-AH-REIN-NSP-RATE.
 14951     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14952        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14953              compute ws-cred-union-fees rounded =
 14954                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14955                    pb-i-ah-commission)
 14956              COMPUTE PB-I-AH-CLP =
 14957                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14958        end-if
 14959     END-IF
 14960     IF AH-REIN-NSP-NOT-USED
 14961         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14962
 14963     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14964     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14965         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14966     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14967     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14968     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14969     MOVE PB-SV-STATE            TO CP-STATE.
 14970     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14971     MOVE ZERO                   TO CP-DEVIATION-CODE
 14972                                    CP-RATE-DEV-PCT.
 14973*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14974     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14975     MOVE '3'                    TO CP-PROCESS-TYPE.
 14976     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14977     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14978                                    CP-RATING-BENEFIT-AMT.
 14979     IF CP-STATE-STD-ABBRV = 'OR'
 14980         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14981                                         PB-I-AH-TERM.
 14982     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 271
* EL050.cbl
 14983     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14984     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14985     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14986     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14987     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14988                                    CP-REMAINING-TERM
 14989                                    WS-WORK-TERM.
 14990     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14991     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14992        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14993     END-IF
 14994     IF  PB-COMPANY-ID = 'TIC'
 14995         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14996            MOVE ZERO TO CP-CLASS-CODE.
 14997
 14998     IF PB-COMPANY-ID NOT = 'TIC'
 14999          MOVE ZERO          TO CP-CLASS-CODE.
 15000
 15001     MOVE ZERO               TO CP-DEVIATION-CODE.
 15002
 15003     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15004
 15005     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15006
 15007     MOVE 'R'                   TO CP-RATE-FILE.
 15008     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15009
 15010     IF CP-ERROR-RATE-NOT-FOUND
 15011         MOVE ER-2645        TO WS-ERROR
 15012         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15013         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15014
 15015     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15016
 15017     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15018     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15019
 15020     IF PB-I-AH-REI-RATE = ZERO
 15021         MOVE ER-2645        TO WS-ERROR
 15022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15023
 15024
 15025 3340-CALCULATE-PREMIUM-AMT.
 15026
 15027     IF PB-COMPANY-ID = 'NCL'
 15028         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15029             WS-AH-SPECIAL-CALC-CD = 'O')
 15030             GO TO 3999-END-EDIT.
 15031
 15032     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15033                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15034                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15035                         OR 'AHL'
 15036         NEXT SENTENCE
 15037     ELSE
 15038         IF WS-STATE-ABBREVIATION = 'CT'
 15039             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15040                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 272
* EL050.cbl
 15041                 COMPUTE PB-I-LF-PREM-CALC =
 15042                                     PB-I-LF-PREM-CALC * .90
 15043                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15044                                     PB-I-LF-ALT-PREM-CALC * .90
 15045                 COMPUTE PB-I-AH-PREM-CALC =
 15046                                     PB-I-AH-PREM-CALC * .90.
 15047
 15048     IF PB-COMP-LF-PREM
 15049        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15050        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15051
 15052     IF PB-COMP-AH-PREM
 15053        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15054
 15055 3340-CHECK-DCC-TOT-FEES.
 15056     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15057        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15058        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15059        AND (PB-I-POLICY-IS-MONTHLY)
 15060        CONTINUE
 15061     ELSE
 15062        GO TO 3340-EDIT-LF-AH-TOL
 15063     END-IF
 15064     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15065     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15066     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15067        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15068           PB-I-RATE-DEV-PCT-LF
 15069     END-IF
 15070     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15071        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15072           PB-I-RATE-DEV-PCT-AH
 15073     END-IF
 15074     MOVE 'N'                    TO CP-BEN-CATEGORY
 15075     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15076
 15077     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15078     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15079     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15080     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15081     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15082     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15083     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15084     MOVE '3'                    TO CP-PROCESS-TYPE.
 15085     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15086     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15087
 15088     MOVE PB-SV-STATE            TO CP-STATE.
 15089     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15090     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15091     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15092     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15093     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15094                                    CP-RATING-BENEFIT-AMT.
 15095     IF CP-STATE-STD-ABBRV = 'OR'
 15096         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15097                                         PB-I-LF-ALT-BENEFIT-AMT.
 15098     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 273
* EL050.cbl
 15099     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15100     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15101     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15102     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15103     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15104     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15105     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15106     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15107                                    CP-REMAINING-TERM
 15108                                    CP-LOAN-TERM.
 15109     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15110        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15111           PB-I-LF-PREMIUM-AMT
 15112     end-if
 15113
 15114     IF CP-TRUNCATED-LIFE
 15115        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15116
 15117     IF CP-TERM-IS-DAYS
 15118         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15119     ELSE
 15120         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15121
 15122     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15123     IF CP-SPECIAL-CALC-CD = 'H'
 15124         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15125                                    TO CP-ALTERNATE-BENEFIT
 15126         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15127     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15128     MOVE 'R'                    TO CP-RATE-FILE
 15129     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15130     IF NOT CP-ERROR-RATE-NOT-FOUND
 15131        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15132        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15133           AND (CP-BENEFIT-CD (1:1) = 'S')
 15134           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15135                                    PB-I-LF-PREMIUM-AMT
 15136        END-IF
 15137     ELSE
 15138        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15139     END-IF
 15140     .
 15141 3340-EDIT-LF-AH-TOL.
 15142
 15143***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15144***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15145***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15146***
 15147     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15148         PB-I-AH-PREMIUM-AMT
 15149          GIVING WS-CALC-WORK.
 15150
 15151     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15152        AND WS-CALC-WORK NOT = ZERO
 15153         MOVE ER-2649            TO WS-ERROR
 15154         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15155
 15156     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 274
* EL050.cbl
 15157             FROM PB-I-LF-PREMIUM-AMT
 15158                 GIVING WS-UNSIGN-WRK1.
 15159
 15160     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15161             FROM PB-I-LF-ALT-PREMIUM-AMT
 15162                 GIVING WS-UNSIGN-WRK4.
 15163
 15164     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15165                                + WS-UNSIGN-WRK4.
 15166
 15167     SUBTRACT PB-I-AH-PREM-CALC
 15168             FROM PB-I-AH-PREMIUM-AMT
 15169                 GIVING WS-UNSIGN-WRK2.
 15170
 15171******************************************************************
 15172*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15173******************************************************************
 15174
 15175     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15176         MOVE ZERO TO WS-UNSIGN-WRK1.
 15177
 15178     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15179         MOVE ZERO TO WS-UNSIGN-WRK2.
 15180
 15181     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15182             GIVING WS-UNSIGN-WRK3.
 15183
 15184 3342-CONTINUE.
 15185
 15186     IF (PB-I-LF-RATE = ZERO  AND
 15187         PB-I-AH-RATE = ZERO)
 15188         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15189            WS-AH-SPECIAL-CALC-CD = 'O'
 15190              NEXT SENTENCE
 15191         ELSE
 15192             GO TO 3345-EDIT-CONTINUE.
 15193
 15194     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15195         NEXT SENTENCE
 15196     ELSE
 15197     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15198        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15199           IF (PB-REISSUED-CERT         OR
 15200               PB-POLICY-IS-DECLINED    OR
 15201               PB-POLICY-IS-VOIDED)
 15202              NEXT SENTENCE
 15203           ELSE
 15204              IF WS-PREM-REJECT-SW = SPACE
 15205                 MOVE ER-2652    TO WS-ERROR
 15206                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15207                 GO TO 3344-CHECK-AH
 15208              ELSE
 15209                 MOVE ER-2650    TO WS-ERROR
 15210                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15211                 GO TO 3344-CHECK-AH.
 15212
 15213***
 15214***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 275
* EL050.cbl
 15215***
 15216
 15217     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15218         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15219            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15220             (1 + WS-TOL-LF-PREM-PCT)
 15221         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15222            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15223             (1 - WS-TOL-LF-PREM-PCT)
 15224     ELSE
 15225         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15226         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15227
 15228***
 15229***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15230***
 15231
 15232     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15233         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15234          WS-TOL-LF-PREM.
 15235
 15236     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15237         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15238          WS-TOL-LF-PREM.
 15239
 15240     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15241        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15242
 15243     IF PB-REISSUED-CERT
 15244        or PB-POLICY-IS-DECLINED
 15245        or PB-POLICY-IS-VOIDED
 15246        continue
 15247     ELSE
 15248        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15249              > WS-TOL-LF-HIGH-PREM-AMT)
 15250           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15251              < WS-TOL-LF-LOW-PREM-AMT))
 15252                      or
 15253           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15254              > WS-TOL-LF-HIGH-PREM-PCT)
 15255           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15256              < WS-TOL-LF-LOW-PREM-PCT))
 15257           IF WS-PREM-REJECT-SW = SPACE
 15258              MOVE ER-2652       TO WS-ERROR
 15259              PERFORM 9900-ERROR-FORMAT
 15260                                 THRU 9900-EXIT
 15261           ELSE
 15262              MOVE ER-2650       TO WS-ERROR
 15263              PERFORM 9900-ERROR-FORMAT
 15264                                 THRU 9900-EXIT
 15265           end-if
 15266        end-if
 15267     end-if
 15268
 15269*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15270*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15271*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15272*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 276
* EL050.cbl
 15273
 15274     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15275        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15276                      OR
 15277           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15278           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15279           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15280           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15281        END-IF
 15282     END-IF
 15283
 15284     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15285        IF WS-COMP-MAX-CAP GREATER THAN +0
 15286           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15287              IF (PB-REISSUED-CERT         OR
 15288                  PB-POLICY-IS-DECLINED    OR
 15289                  PB-POLICY-IS-VOIDED)
 15290                 NEXT SENTENCE
 15291              ELSE
 15292                  MOVE ER-2646   TO  WS-ERROR
 15293                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15294
 15295 3344-CVL-TOLERANCE-CHECK.
 15296
 15297      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15298          GO TO 3344-CHECK-AH.
 15299
 15300      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15301          GO TO 3344-CHECK-AH.
 15302
 15303      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15304                                     WS-UNSIGN-WRK6.
 15305
 15306      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15307          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15308                                 + PB-I-LF-PREMIUM-AMT
 15309                                 - PB-I-LF-PREM-CALC.
 15310
 15311      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15312          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15313                                 + PB-I-LF-ALT-PREMIUM-AMT
 15314                                 - PB-I-LF-ALT-PREM-CALC.
 15315
 15316      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15317          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15318              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15319                 MOVE ER-2652    TO  WS-ERROR
 15320                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15321              ELSE
 15322                 MOVE ER-2650    TO  WS-ERROR
 15323                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15324
 15325      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15326          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15327              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15328                 MOVE ER-2652    TO  WS-ERROR
 15329                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15330              ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 277
* EL050.cbl
 15331                 MOVE ER-2650    TO  WS-ERROR
 15332                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15333
 15334 3344-CHECK-AH.
 15335
 15336****************************************************************
 15337***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15338***
 15339
 15340     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15341         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15342             (1 + WS-TOL-AH-PREM-PCT)
 15343         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15344             (1 - WS-TOL-AH-PREM-PCT)
 15345     ELSE
 15346         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15347         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15348
 15349***
 15350***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15351***
 15352
 15353     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15354         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15355
 15356     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15357         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15358
 15359     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15360        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15361
 15362     IF (PB-REISSUED-CERT)
 15363        OR (PB-POLICY-IS-DECLINED)
 15364        OR (PB-POLICY-IS-VOIDED)
 15365        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15366        CONTINUE
 15367     ELSE
 15368        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15369              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15370                          or
 15371           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15372              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15373           IF WS-PREM-REJECT-SW = SPACE
 15374              MOVE ER-3052       TO WS-ERROR
 15375              PERFORM 9900-ERROR-FORMAT
 15376                                 THRU 9900-EXIT
 15377           ELSE
 15378              MOVE ER-3050       TO WS-ERROR
 15379              PERFORM 9900-ERROR-FORMAT
 15380                                 THRU 9900-EXIT
 15381           END-IF
 15382        END-IF
 15383     END-IF
 15384     if (pb-company-id = 'DCC' or 'VPP')
 15385        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15386        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15387        and (pb-i-policy-is-monthly)
 15388        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 278
* EL050.cbl
 15389           pb-i-tot-fees-calc + ws-tol-ah-prem
 15390        compute ws-tol-ah-low-prem-amt =
 15391           pb-i-tot-fees-calc - ws-tol-ah-prem
 15392        if ws-tol-ah-prem-pct > zeros
 15393           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15394              (1 + ws-tol-ah-prem-pct)
 15395           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15396              (1 - ws-tol-ah-prem-pct)
 15397        else
 15398           move +9999999.99      to ws-tol-ah-high-prem-pct
 15399           move +0               to ws-tol-ah-low-prem-pct
 15400        end-if
 15401        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15402            or
 15403           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15404                          or
 15405           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15406           or
 15407           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15408            move er-3049         to ws-error
 15409           perform 9900-error-format
 15410                                 thru 9900-exit
 15411
 15412        end-if
 15413     end-if
 15414     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15415         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15416             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15417             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15418
 15419     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15420        IF WS-COMP-MAX-CAP GREATER THAN +0
 15421           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15422              IF (PB-REISSUED-CERT         OR
 15423                  PB-POLICY-IS-DECLINED    OR
 15424                  PB-POLICY-IS-VOIDED)
 15425                 NEXT SENTENCE
 15426              ELSE
 15427                  MOVE ER-2646   TO  WS-ERROR
 15428                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15429
 15430     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15431        (WS-COMP-MAX-CAP EQUAL +0)
 15432           GO TO 3345-EDIT-CONTINUE.
 15433
 15434     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15435        GREATER THAN WS-COMP-MAX-CAP
 15436           MOVE ER-2646          TO  WS-ERROR
 15437           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15438
 15439 3345-EDIT-CONTINUE.
 15440
 15441*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15442*       IF PB-ENTRY-BATCH   NUMERIC
 15443*          IF PB-ISSUE
 15444*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15445*          ELSE
 15446*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 279
* EL050.cbl
 15447*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15448
 15449*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15450*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15451*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15452*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15453*        ELSE
 15454*            MOVE  ER-1909            TO  WS-ERROR
 15455*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15456
 15457     IF PB-I-POLICY-ACCEPTED
 15458        IF PB-POLICY-IS-DECLINED  OR
 15459           PB-REISSUED-CERT  OR
 15460           PB-REIN-ONLY-CERT  OR
 15461           PB-POLICY-IS-VOIDED
 15462            MOVE  ER-1891         TO  WS-ERROR
 15463            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15464        ELSE
 15465            MOVE SPACE            TO  PB-BATCH-ENTRY
 15466            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15467
 15468     IF PB-I-POLICY-DECLINED
 15469        IF PB-REISSUED-CERT  OR
 15470           PB-REIN-ONLY-CERT  OR
 15471           PB-POLICY-IS-VOIDED
 15472            MOVE  ER-1906         TO  WS-ERROR
 15473            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15474        ELSE
 15475            MOVE  'D'             TO  PB-BATCH-ENTRY
 15476                                      PB-I-ENTRY-STATUS.
 15477
 15478     IF PB-I-NEEDS-UNDERWRITING
 15479        IF PB-POLICY-IS-DECLINED OR
 15480           PB-REISSUED-CERT  OR
 15481           PB-REIN-ONLY-CERT  OR
 15482           PB-POLICY-IS-VOIDED
 15483            MOVE  ER-1907         TO  WS-ERROR
 15484            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15485        ELSE
 15486            MOVE 'U'              TO  PB-BATCH-ENTRY
 15487                                      PB-I-ENTRY-STATUS.
 15488
 15489     IF PB-NEEDS-UNDERWRITING
 15490        MOVE  ER-1901             TO  WS-ERROR
 15491        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15492     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15493        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15494        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15495        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15496           AND (NOT WS-LF-CASH))
 15497                           OR
 15498           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15499           AND (NOT WS-AH-CASH)))
 15500                       AND
 15501           (PB-I-ENTRY-STATUS NOT = '5')
 15502           MOVE 'M'              TO PB-BATCH-ENTRY
 15503                                    PB-I-ENTRY-STATUS
 15504        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 280
* EL050.cbl
 15505     END-IF
 15506     move pending-business       to ws-passed-erpndb
 15507     move ' '                    to ws-exceed-limit-yn
 15508     perform 7780-call-agg       thru 7780-exit
 15509*    display ' el050 exceed ' ws-exceed-limit-yn
 15510     if ws-exceed-limit-yn = 'Y'
 15511        MOVE  ER-9813            TO WS-ERROR
 15512        move 'Y'                 to ws-9813-sw
 15513        PERFORM  9900-ERROR-FORMAT
 15514                                 THRU 9900-EXIT
 15515     end-if
 15516     if (PB-EXCEEDED-LIMIT-FORCED)
 15517        and (ws-9813-sw = 'Y')
 15518        subtract +1 from PB-NO-OF-ERRORS
 15519        move er-9823             to ws-error
 15520        PERFORM  9900-ERROR-FORMAT
 15521                                 THRU 9900-EXIT
 15522     end-if
 15523     IF  PB-COMPANY-ID NOT = 'NCL'
 15524         GO TO 3999-END-EDIT.
 15525
 15526     IF PB-REISSUED-CERT  OR
 15527        PB-POLICY-IS-DECLINED  OR
 15528        PB-POLICY-IS-VOIDED  OR
 15529        PB-I-OB
 15530         GO TO 3999-END-EDIT.
 15531
 15532     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15533         MOVE  ER-2644            TO  WS-ERROR
 15534         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15535         GO TO 3999-END-EDIT.
 15536
 15537     MOVE 'N'                     TO  FORM-MASTER-SW.
 15538     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15539
 15540     IF NOT FORM-MASTER-FOUND
 15541         GO TO 3999-END-EDIT.
 15542
 15543     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15544                                      FORM-MASTER-AH-SW.
 15545
 15546     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15547         MOVE  +1                 TO SUB6
 15548         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15549
 15550     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15551         MOVE  +1                 TO SUB6
 15552         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15553
 15554     IF LF-FORM-MASTER-FOUND  OR
 15555        AH-FORM-MASTER-FOUND
 15556         GO TO 3360-CHECK-FORM-LIMITS
 15557     ELSE
 15558         GO TO 3999-END-EDIT.
 15559
 15560******************************************************************
 15561*                  3350-GET-ERFORM                               *
 15562*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 281
* EL050.cbl
 15563*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15564******************************************************************
 15565
 15566 3350-GET-ERFORM.
 15567
 15568     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15569         GO TO  3350-ERFORM-GETMAIN.
 15570
 15571     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15572     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15573     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15574     MOVE 'Y'                     TO FORM-MASTER-SW.
 15575
 15576     IF PB-CANCELLATION
 15577         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15578            PB-SV-STATE          EQUAL   FO-STATE       AND
 15579            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15580              GO TO 3350-EXIT
 15581         ELSE
 15582             NEXT SENTENCE
 15583     ELSE
 15584         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15585            PB-SV-STATE          EQUAL   FO-STATE       AND
 15586            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15587              GO TO 3350-EXIT.
 15588
 15589 3350-ERFORM-GETMAIN.
 15590
 15591     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15592     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15593
 15594 3350-ERFORM-READ.
 15595
 15596     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15597     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15598     IF PB-CANCELLATION
 15599         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15600     ELSE
 15601         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15602     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15603
 15604     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15605
 15606     IF FORM-MASTER-FOUND
 15607       IF PB-CANCELLATION
 15608          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15609             PB-SV-STATE          EQUAL   FO-STATE       AND
 15610             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15611              GO  TO 3350-EXIT
 15612          ELSE
 15613              NEXT SENTENCE
 15614       ELSE
 15615          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15616             PB-SV-STATE          EQUAL   FO-STATE       AND
 15617             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15618              GO  TO 3350-EXIT.
 15619
 15620     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 282
* EL050.cbl
 15621     MOVE  ER-1895                TO  WS-ERROR.
 15622     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15623
 15624 3350-EXIT.
 15625      EXIT.
 15626
 15627******************************************************************
 15628*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15629*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15630*   VALID FOR THE POLICY FORM USED.                              *
 15631******************************************************************
 15632
 15633 3355-EDIT-FORM-LF-BENEFITS.
 15634
 15635     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15636        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15637         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15638         GO TO   3355-EXIT.
 15639
 15640     IF  SUB6    LESS THAN   +40
 15641         ADD  +1      TO  SUB6
 15642         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15643
 15644     MOVE  ER-1896         TO  WS-ERROR.
 15645     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15646
 15647 3355-EXIT.
 15648      EXIT.
 15649
 15650******************************************************************
 15651*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15652*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15653*   VALID FOR THE POLICY FORM USED.                              *
 15654******************************************************************
 15655
 15656 3356-EDIT-FORM-AH-BENEFITS.
 15657
 15658     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15659        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15660         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15661         GO TO  3356-EXIT.
 15662
 15663      IF  SUB6    LESS THAN     +40
 15664          ADD  +1      TO  SUB6
 15665          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15666
 15667     MOVE  ER-1897         TO  WS-ERROR.
 15668     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15669
 15670 3356-EXIT.
 15671      EXIT.
 15672
 15673******************************************************************
 15674*                  3357-BENEFIT-SEARCH                           *
 15675*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15676*   CANCELLATIONS ONLY.                                          *
 15677******************************************************************
 15678 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 283
* EL050.cbl
 15679     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15680         MOVE +1                          TO SUB6
 15681         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15682
 15683     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15684         MOVE +1                          TO SUB6
 15685         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15686
 15687 3357-EXIT.
 15688     EXIT.
 15689
 15690******************************************************************
 15691*                  3358-BENEFIT-LIFE-SEARCH                      *
 15692*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15693*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15694*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15695******************************************************************
 15696 3358-BENEFIT-LIFE-SEARCH.
 15697     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15698       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15699         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15700           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15701              IF FO-PLAN-REFUND-METHOD (SUB6)
 15702                     IS GREATER THAN SPACES
 15703                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15704                                          WS-LF-REFUND-CALC
 15705                 GO TO 3358-EXIT.
 15706
 15707     IF SUB6 LESS THAN +40
 15708         ADD +1                 TO SUB6
 15709         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15710
 15711 3358-EXIT.
 15712     EXIT.
 15713******************************************************************
 15714*                  3359-BENEFIT-AH-SEARCH                        *
 15715*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15716*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15717*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15718******************************************************************
 15719 3359-BENEFIT-AH-SEARCH.
 15720     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15721       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15722         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15723           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15724              IF FO-PLAN-REFUND-METHOD (SUB6)
 15725                      IS GREATER THAN SPACES
 15726                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15727                                          WS-AH-REFUND-CALC
 15728                 GO TO 3359-EXIT.
 15729
 15730     IF SUB6 LESS THAN +40
 15731         ADD +1                 TO SUB6
 15732         GO TO 3359-BENEFIT-AH-SEARCH.
 15733
 15734 3359-EXIT.
 15735     EXIT.
 15736
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 284
* EL050.cbl
 15737******************************************************************
 15738*                  3360-CHECK-FORM-LIMITS                        *
 15739*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15740*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15741******************************************************************
 15742
 15743 3360-CHECK-FORM-LIMITS.
 15744
 15745     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15746         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15747
 15748     IF NOT LF-FORM-MASTER-FOUND
 15749         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15750
 15751 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15752
 15753     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15754       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15755        WS-LF-JOINT-INDICATOR = 'J'  AND
 15756        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15757         IF PB-COMPANY-ID = 'NCL'
 15758            MOVE  ER-1911          TO  WS-ERROR
 15759            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15760         ELSE
 15761            MOVE  ER-1892          TO  WS-ERROR
 15762            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15763
 15764 3360-CHECK-FORM-LF-ATT-AGE.
 15765
 15766     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15767
 15768     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15769         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15770         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15771            IF PB-COMPANY-ID = 'NCL'
 15772                MOVE  ER-1913      TO  WS-ERROR
 15773                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15774            ELSE
 15775                MOVE  ER-1894      TO  WS-ERROR
 15776                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15777
 15778 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15779
 15780     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15781         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15782         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15783            IF PB-COMPANY-ID = 'NCL'
 15784                MOVE  ER-1914      TO  WS-ERROR
 15785                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15786            ELSE
 15787                MOVE  ER-1899      TO  WS-ERROR
 15788                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15789
 15790 3360-CHECK-FORM-LF-TERM-BAMT.
 15791
 15792     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15793         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15794         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 285
* EL050.cbl
 15795           IF  PB-COMPANY-ID = 'NCL'
 15796               MOVE  ER-1916       TO  WS-ERROR
 15797               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15798           ELSE
 15799               MOVE  ER-1902       TO  WS-ERROR
 15800               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15801
 15802     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15803                                    PB-I-LF-ALT-BENEFIT-AMT.
 15804
 15805     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15806         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15807         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15808             IF  PB-COMPANY-ID = 'NCL'
 15809                 MOVE  ER-1918     TO  WS-ERROR
 15810                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15811             ELSE
 15812                 MOVE  ER-1904     TO  WS-ERROR
 15813                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15814
 15815******************************************************************
 15816*                  3360-CHECK-FORM-AH-LIMITS                     *
 15817*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15818*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15819******************************************************************
 15820
 15821 3360-CHECK-FORM-AH-LIMITS.
 15822
 15823     IF NOT AH-FORM-MASTER-FOUND
 15824         GO TO 3999-END-EDIT.
 15825
 15826 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15827
 15828     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15829       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15830        WS-AH-JOINT-INDICATOR = 'J'  AND
 15831        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15832         IF PB-COMPANY-ID = 'NCL'
 15833            MOVE  ER-1912          TO  WS-ERROR
 15834            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15835         ELSE
 15836            MOVE  ER-1893          TO  WS-ERROR
 15837            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15838
 15839 3360-CHECK-FORM-AH-ATT-AGE.
 15840
 15841     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15842
 15843     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15844         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15845         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15846            IF PB-COMPANY-ID = 'NCL'
 15847                MOVE  ER-1913      TO  WS-ERROR
 15848                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15849            ELSE
 15850                MOVE  ER-1894      TO  WS-ERROR
 15851                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15852
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 286
* EL050.cbl
 15853 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15854
 15855     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15856         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15857         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15858            IF PB-COMPANY-ID = 'NCL'
 15859                MOVE  ER-1915      TO  WS-ERROR
 15860                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15861            ELSE
 15862                MOVE  ER-1900      TO  WS-ERROR
 15863                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15864
 15865 3360-CHECK-FORM-AH-TERM-BAMT.
 15866
 15867     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15868         FO-AH-MAX-TERM    GREATER THAN  +0
 15869         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15870             IF  PB-COMPANY-ID = 'NCL'
 15871                 MOVE  ER-1917     TO  WS-ERROR
 15872                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15873             ELSE
 15874                  MOVE  ER-1903    TO  WS-ERROR
 15875                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15876
 15877     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15878         FO-MAX-AH-AMT    GREATER THAN  +0
 15879         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15880             IF  PB-COMPANY-ID = 'NCL'
 15881                 MOVE  ER-1919     TO  WS-ERROR
 15882                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15883             ELSE
 15884                 MOVE  ER-1905     TO  WS-ERROR
 15885                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15886
 15887     GO TO 3999-END-EDIT.
 15888
 15889******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 287
* EL050.cbl
 15891 3400-edit-vin.
 15892
 15893     move spaces                 to hldi-pass-area
 15894     MOVE PB-I-VIN               TO WS-WORK-VIN
 15895     MOVE +8                     TO V2
 15896     MOVE ZEROS                  TO WS-VIN-TOTAL
 15897     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15898      (V1 > 17)
 15899        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15900           MOVE ER-3825          TO WS-ERROR
 15901           PERFORM 9900-ERROR-FORMAT
 15902                                 THRU 9900-EXIT
 15903        ELSE
 15904           IF V1 = 8
 15905              MOVE 10            TO V2
 15906           END-IF
 15907           IF V1 = 9
 15908              MOVE 0             TO V2
 15909           END-IF
 15910           IF V1 = 10
 15911              MOVE 9             TO V2
 15912           END-IF
 15913           IF WS-WORK-VIN (V1:1) NUMERIC
 15914              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15915               + (WS-WORK-VIN-N (V1) * V2)
 15916           ELSE
 15917              MOVE WS-WORK-VIN (V1:1)
 15918                            TO WS-HEX-BYTE
 15919              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15920              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15921               + (WS-NUM (V3) * V2)
 15922           END-IF
 15923           COMPUTE V2 = V2 - 1
 15924        END-IF
 15925     END-PERFORM
 15926     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15927     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15928        REMAINDER WS-VIN-REMAINDER
 15929     IF ((WS-WORK-VIN (9:1) = 'X')
 15930        AND (WS-VIN-REMAINDER = 10))
 15931                OR
 15932        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15933        if pb-company-id = 'VPP'
 15934           perform 3410-check-with-hldi
 15935                                 thru 3410-exit
 15936        end-if
 15937     ELSE
 15938        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15939           MOVE ER-3826          TO WS-ERROR
 15940           PERFORM 9900-ERROR-FORMAT
 15941                                 THRU 9900-EXIT
 15942        ELSE
 15943           MOVE ER-3827          TO WS-ERROR
 15944           PERFORM 9900-ERROR-FORMAT
 15945                                 THRU 9900-EXIT
 15946        END-IF
 15947     END-IF
 15948
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 288
* EL050.cbl
 15949     .
 15950 3400-exit.
 15951     exit.
 15952 3410-check-with-hldi.
 15953     move spaces                 to hldi-pass-area
 15954     move pb-i-vin               to pa-vin
 15955     perform 7785-call-hldi      thru 7785-exit
 15956*    display 'PA-VIN        ' PA-VIN
 15957*    display 'PA-ErrorCode  ' PA-ErrorCode
 15958*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15959*    display 'PA-ModelYear  ' PA-ModelYear
 15960*    display 'PA-MakeName   ' PA-MakeName
 15961*    display 'PA-ModelName  ' PA-ModelName
 15962*    display 'PA-SeriesName ' PA-SeriesName
 15963     if pa-errorcode (1:1) not = '0'
 15964        move spaces              to hldi-pass-area
 15965        move pb-i-vin            to pa-vin
 15966*       move pa-errordesc        to pa-seriesname
 15967*       perform 7786-call-hldim  thru 7786-exit
 15968*       display 'PA-VIN        ' PA-VIN
 15969*       display 'PA-ErrorCode  ' PA-ErrorCode
 15970*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15971*       display 'PA-ModelYear  ' PA-ModelYear
 15972*       display 'PA-MakeName   ' PA-MakeName
 15973*       display 'PA-ModelName  ' PA-ModelName
 15974*       display 'PA-SeriesName ' PA-SeriesName
 15975     end-if
 15976     .
 15977 3410-exit.
 15978     exit.
 15979******************************************************************
 15980*                  E D I T   C A N C E L                         *
 15981******************************************************************
 15982
 15983 3700-EDIT-CANCEL.
 15984     IF PB-COMPANY-ID = 'DMD'
 15985         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15986                                         WS-RES-MUNI-TAX
 15987                                         PB-CI-STATE-TAX
 15988                                         PB-CI-MUNI-TAX
 15989         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15990
 15991*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15992*       IF PB-ENTRY-BATCH  NUMERIC
 15993*          IF PB-CANCELLATION
 15994*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15995*          ELSE
 15996*             IF PB-ISSUE
 15997*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15998
 15999     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 16000        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 16001     END-IF
 16002*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16003*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16004
 16005     IF CM-ENTRY-STATUS = 'V'
 16006        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 289
* EL050.cbl
 16007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16008        GO TO 3999-END-EDIT.
 16009
 16010     IF CM-ENTRY-STATUS = 'D'
 16011        MOVE ER-2781             TO WS-ERROR
 16012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16013        GO TO 3999-END-EDIT.
 16014
 16015     IF CM-ENTRY-STATUS = 'U'
 16016        MOVE ER-2782             TO WS-ERROR
 16017        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16018
 16019***************************************************************
 16020*                                                             *
 16021*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16022*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16023*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16024*   OF ANOTHER COVERAGE.                                      *
 16025*                                                             *
 16026***************************************************************
 16027
 16028     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16029                                    PB-C-AH-CANCEL-VOID-SW.
 16030
 16031     if pb-company-id = 'DCC' or 'VPP'
 16032        if ((pb-ci-lf-cancel-amt <> zeros)
 16033                       or
 16034            (pb-ci-ah-cancel-amt <> zeros))
 16035           MOVE ER-3068          TO WS-ERROR
 16036           PERFORM 9900-ERROR-FORMAT
 16037                                 THRU 9900-EXIT
 16038           GO TO 3999-END-EDIT
 16039        end-if
 16040     end-if
 16041     IF PB-C-LF-CANCEL-AMT = ZERO
 16042        NEXT SENTENCE
 16043     ELSE
 16044        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16045           AND
 16046           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16047               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16048               MOVE ER-2745           TO WS-ERROR
 16049               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16050
 16051     IF PB-C-AH-CANCEL-AMT = ZERO
 16052        NEXT SENTENCE
 16053     ELSE
 16054        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16055           AND
 16056           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16057               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16058               MOVE ER-2745           TO WS-ERROR
 16059               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16060
 16061     IF WS-LF-EARNINGS-CALC = '4'
 16062        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16063
 16064     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 290
* EL050.cbl
 16065     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16066     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16067     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16068     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16069     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16070
 16071     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16072                                      PB-C-AH-REF-CALC.
 16073     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16074
 16075******************************************************************
 16076*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16077*             TO VALIDATE COVERAGE.                              *
 16078******************************************************************
 16079
 16080     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16081        PB-C-LF-CANCEL-AMT = ZEROS
 16082          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16083      ELSE
 16084          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16085
 16086     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16087        PB-C-AH-CANCEL-AMT = ZEROS
 16088          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16089      ELSE
 16090          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16091
 16092     EVALUATE TRUE
 16093         WHEN PB-CANCEL-FORCE             OR
 16094              PB-CANCEL-DATE-FORCED       OR
 16095              PB-FORCE-OFF
 16096                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16097                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16098                  END-IF
 16099         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16100               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16101              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16102                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16103         WHEN OTHER
 16104              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16105                 MOVE ER-2794              TO WS-ERROR
 16106              ELSE
 16107                 MOVE ER-2749              TO WS-ERROR
 16108              END-IF
 16109              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16110     END-EVALUATE.
 16111
 16112
 16113*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16114*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16115*            MOVE  ER-1909            TO  WS-ERROR
 16116*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16117*        ELSE
 16118*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16119
 16120     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16121     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16122        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 291
* EL050.cbl
 16123     ELSE
 16124        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16125     END-IF
 16126     .
 16127 3705-EDIT-CANCEL-DT.
 16128
 16129     IF LF-COVERAGE-CANCELLED
 16130        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16131         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16132         MOVE WS-CURRENT-MONTH-END
 16133                                 TO DC-BIN-DATE-2
 16134         SET ELAPSED-BETWEEN-BIN TO TRUE
 16135*        MOVE 1                  TO DC-OPTION-CODE
 16136         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16137         IF DATE-CONVERSION-ERROR
 16138            NEXT SENTENCE
 16139          ELSE
 16140             IF DC-ELAPSED-DAYS GREATER +180
 16141                IF PB-CANCEL-DATE-FORCED  OR
 16142                   PB-CANCEL-DATE-FORCED-NO-FEE
 16143                      MOVE ER-2751  TO WS-ERROR
 16144                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16145                 ELSE
 16146                   MOVE ER-2752  TO WS-ERROR
 16147                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16148
 16149     IF AH-COVERAGE-CANCELLED
 16150        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16151         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16152         MOVE WS-CURRENT-MONTH-END
 16153                                 TO DC-BIN-DATE-2
 16154         SET ELAPSED-BETWEEN-BIN TO TRUE
 16155*        MOVE 1                  TO DC-OPTION-CODE
 16156         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16157         IF DATE-CONVERSION-ERROR
 16158            NEXT SENTENCE
 16159          ELSE
 16160             IF DC-ELAPSED-DAYS GREATER +180
 16161                IF PB-CANCEL-DATE-FORCED OR
 16162                   PB-CANCEL-DATE-FORCED-NO-FEE
 16163                      MOVE ER-2751  TO WS-ERROR
 16164                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16165                 ELSE
 16166                   MOVE ER-2752  TO WS-ERROR
 16167                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16168
 16169     IF WS-ERROR = ER-2752
 16170        AND (PB-COMPANY-ID = 'ABL'
 16171         OR  PB-COMPANY-ID = 'FGL'
 16172         OR  PB-COMPANY-ID = 'IST'
 16173         OR  PB-COMPANY-ID = 'JHL'
 16174         OR  PB-COMPANY-ID = 'LAP'
 16175         OR  PB-COMPANY-ID = 'LBL'
 16176         OR  PB-COMPANY-ID = 'NCB'
 16177         OR  PB-COMPANY-ID = 'NLI'
 16178         OR  PB-COMPANY-ID = 'OFI'
 16179         OR  PB-COMPANY-ID = 'PLI'
 16180         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 292
* EL050.cbl
 16181         OR  PB-COMPANY-ID = 'TIC'
 16182         OR  PB-COMPANY-ID = 'HER'
 16183         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16184         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16185            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16186            MOVE ER-2762     TO WS-ERROR
 16187            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16188
 16189     IF LF-COVERAGE-CANCELLED
 16190        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16191        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16192             MOVE ER-2733         TO WS-ERROR
 16193             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16194
 16195     IF AH-COVERAGE-CANCELLED
 16196        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16197        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16198              MOVE ER-2733        TO WS-ERROR
 16199              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16200
 16201     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16202        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16203        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16204           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16205            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16206              IF PB-COMPANY-ID NOT = 'LAP'
 16207               MOVE ER-2704            TO WS-ERROR
 16208               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16209
 16210     IF CERT-WAS-NOT-FOUND
 16211         GO TO 3999-END-EDIT.
 16212
 16213     IF PB-COMPANY-ID EQUAL 'CDC'
 16214        IF LF-COVERAGE-CANCELLED
 16215           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16216            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16217            MOVE PB-C-LF-CANCEL-DT
 16218                                 TO DC-BIN-DATE-2
 16219            SET ELAPSED-BETWEEN-BIN TO TRUE
 16220*           MOVE 1               TO DC-OPTION-CODE
 16221            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16222            IF DATE-CONVERSION-ERROR
 16223               NEXT SENTENCE
 16224             ELSE
 16225                IF DC-ELAPSED-DAYS GREATER +60
 16226                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16227
 16228     IF PB-COMPANY-ID EQUAL 'CDC'
 16229        IF AH-COVERAGE-CANCELLED
 16230           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16231            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16232            MOVE PB-C-AH-CANCEL-DT
 16233                                 TO DC-BIN-DATE-2
 16234            MOVE +0              TO DC-ELAPSED-DAYS
 16235                                    DC-ELAPSED-MONTHS
 16236            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16237*           MOVE 1               TO DC-OPTION-CODE
 16238            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 293
* EL050.cbl
 16239            IF DATE-CONVERSION-ERROR
 16240               NEXT SENTENCE
 16241             ELSE
 16242                IF DC-ELAPSED-DAYS GREATER +60
 16243                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16244
 16245     MOVE +0                     TO DC-ELAPSED-DAYS
 16246                                    DC-ELAPSED-MONTHS.
 16247
 16248     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16249        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16250          MOVE 'Z'                TO PB-CI-OB-FLAG
 16251          MOVE ER-2767            TO WS-ERROR
 16252          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16253          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16254          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16255          GO TO 3775-OVER-REF-CHK
 16256        ELSE
 16257          MOVE ZEROS              TO PB-CI-LIVES
 16258                                     PB-C-LIVES
 16259          IF PB-CI-OB-FLAG NOT = 'B'
 16260             MOVE SPACE           TO PB-CI-OB-FLAG.
 16261
 16262     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16263         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16264     ELSE
 16265         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16266
 16267     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16268        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16269            MOVE ER-2760         TO WS-ERROR
 16270            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16271
 16272     IF LF-COVERAGE-CANCELLED
 16273        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16274         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16275            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16276               MOVE ER-2774       TO WS-ERROR
 16277               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16278
 16279     IF AH-COVERAGE-CANCELLED
 16280        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16281         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16282            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16283               MOVE ER-2775       TO WS-ERROR
 16284               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16285
 16286     IF LF-COVERAGE-CANCELLED
 16287        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16288         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16289            MOVE ER-2776         TO WS-ERROR
 16290            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16291
 16292     IF AH-COVERAGE-CANCELLED
 16293        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16294         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16295            MOVE ER-2777         TO WS-ERROR
 16296            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 294
* EL050.cbl
 16297
 16298     IF LF-COVERAGE-CANCELLED
 16299        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16300        if pb-ci-lf-expire-dt = low-values or spaces
 16301           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16302           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16303           MOVE PB-CI-EXTENTION-DAYS
 16304                                 TO DC-ELAPSED-DAYS
 16305           SET BIN-PLUS-ELAPSED  TO TRUE
 16306           PERFORM 8500-DATE-CONVERT
 16307                                 THRU 8500-EXIT
 16308           IF DATE-CONVERSION-ERROR
 16309              move low-values    to dc-bin-date-2
 16310           end-if
 16311        else
 16312           move pb-ci-lf-expire-dt
 16313                                 to dc-bin-date-2
 16314        end-if
 16315        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16316           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16317                             OR  'FIA'
 16318              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16319           ELSE
 16320              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16321              MOVE ER-2731       TO WS-ERROR
 16322              PERFORM 9900-ERROR-FORMAT
 16323                                 THRU 9900-EXIT
 16324           end-if
 16325        end-if
 16326     end-if
 16327*    IF LF-COVERAGE-CANCELLED
 16328*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16329*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16330*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16331*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16332*        SET BIN-PLUS-ELAPSED      TO TRUE
 16333*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16334*        IF DATE-CONVERSION-ERROR
 16335*           NEXT SENTENCE
 16336*         ELSE
 16337*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16338*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16339*                            OR  'FIA'
 16340*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16341*              ELSE
 16342*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16343*               MOVE ER-2731       TO WS-ERROR
 16344*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16345     .
 16346 3705-EDIT-AH-CANCEL-DT.
 16347     IF AH-COVERAGE-CANCELLED
 16348        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16349        if pb-ci-AH-expire-dt = low-values or spaces
 16350           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16351           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16352           MOVE PB-CI-EXTENTION-DAYS
 16353                                 TO DC-ELAPSED-DAYS
 16354           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 295
* EL050.cbl
 16355           PERFORM 8500-DATE-CONVERT
 16356                                 THRU 8500-EXIT
 16357           IF DATE-CONVERSION-ERROR
 16358              move low-values    to dc-bin-date-2
 16359           end-if
 16360        else
 16361           move pb-ci-ah-expire-dt
 16362                                 to dc-bin-date-2
 16363        end-if
 16364        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16365           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16366                             OR  'FIA'
 16367              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16368           ELSE
 16369              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16370              MOVE ER-2771       TO WS-ERROR
 16371              PERFORM 9900-ERROR-FORMAT
 16372                                 THRU 9900-EXIT
 16373           end-if
 16374        end-if
 16375     end-if
 16376*    IF AH-COVERAGE-CANCELLED
 16377*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16378*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16379*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16380*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16381**       MOVE 6                    TO DC-OPTION-CODE
 16382*        SET BIN-PLUS-ELAPSED      TO TRUE
 16383*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16384*        IF DATE-CONVERSION-ERROR
 16385*           NEXT SENTENCE
 16386*         ELSE
 16387*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16388*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16389*                             OR 'FIA'
 16390*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16391*             ELSE
 16392*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16393*              MOVE ER-2771       TO WS-ERROR
 16394*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16395     .
 16396 3705-EDIT-CONTINUED.
 16397
 16398*    IF LF-COVERAGE-CANCELLED
 16399*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16400*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16401*            MOVE ER-2727         TO WS-ERROR
 16402*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16403*
 16404*    IF AH-COVERAGE-CANCELLED
 16405*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16406*        IF PB-COMPANY-ID = 'ACE'
 16407*           MOVE ER-2727        TO WS-ERROR
 16408*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16409*        ELSE
 16410*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16411*              MOVE ER-2727     TO WS-ERROR
 16412*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 296
* EL050.cbl
 16413
 16414     IF PB-COMPANY-ID = 'ACE'
 16415       IF AH-COVERAGE-CANCELLED
 16416         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16417           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16418              MOVE ER-2732      TO WS-ERROR
 16419              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16420
 16421     IF PB-COMPANY-ID      EQUAL   'HER'
 16422        IF WS-ERROR        EQUAL   ER-2727
 16423            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16424            MOVE  ER-2725          TO  WS-ERROR
 16425            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16426
 16427     IF PB-C-CLAIM-CREATED-CANCEL
 16428            MOVE ER-2748         TO WS-ERROR
 16429            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16430
 16431     IF PB-C-LAST-NAME NOT = SPACES
 16432         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16433            MOVE ER-2747         TO WS-ERROR
 16434            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16435
 16436 3710-EDIT-LUMP-SUM-PRIOR.
 16437
 16438     IF AH-COVERAGE-CANCELLED
 16439         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16440             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16441                MOVE ER-2735    TO WS-ERROR
 16442                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16443
 16444     IF LF-COVERAGE-CANCELLED
 16445         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16446             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16447                MOVE ER-2735    TO WS-ERROR
 16448                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16449
 16450 3710-EDIT-PRIOR-DEATH.
 16451
 16452*    IF LF-COVERAGE-CANCELLED
 16453*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16454*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16455*           (NOT PB-CI-OB)
 16456*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16457*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16458*                   MOVE ER-2732  TO WS-ERROR
 16459*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16460*
 16461*    IF AH-COVERAGE-CANCELLED
 16462*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16463*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16464*           (NOT PB-CI-OB)
 16465*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16466*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16467*                   MOVE ER-2732  TO WS-ERROR
 16468*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16469
 16470     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 297
* EL050.cbl
 16471         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16472            (NOT PB-COMP-LF-CANCEL)
 16473             NEXT SENTENCE
 16474         ELSE
 16475           IF PB-C-LF-CANCEL-VOIDED
 16476              NEXT SENTENCE
 16477           ELSE
 16478              MOVE ER-2753      TO WS-ERROR
 16479              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16480
 16481     IF CANCEL-FUTURE-DT
 16482         GO TO 3999-END-EDIT.
 16483
 16484 3715-GET-REMAIN-TERM-LF.
 16485
 16486     IF NO-LF-BENEFIT-MATCH  OR
 16487        WS-LF-BENEFIT-CD = ZEROS
 16488        GO TO 3730-GET-AH-REMAIN-TERM.
 16489
 16490     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16491     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16492     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16493     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16494     MOVE PB-SV-STATE            TO CP-STATE.
 16495     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16496     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16497     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16498     MOVE '2'                    TO CP-PROCESS-TYPE.
 16499     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16500     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16501     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16502     IF (PB-COMPANY-ID = 'CID')
 16503        AND (CP-STATE-STD-ABBRV = 'WI')
 16504        MOVE '7'                 TO CP-REM-TERM-METHOD
 16505        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16506     ELSE
 16507        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16508        MOVE WS-REM-TRM-CALC-OPTION
 16509                                 TO CP-REM-TRM-CALC-OPTION
 16510     END-IF
 16511**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16512     IF (PB-COMPANY-ID = 'CID')
 16513        AND (CP-STATE-STD-ABBRV = 'MO')
 16514        AND (PB-CERT-EFF-DT >= X'9B41')
 16515        AND (PB-CERT-EFF-DT <= X'A2FB')
 16516        MOVE '7'                 TO CP-REM-TERM-METHOD
 16517        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16518     END-IF
 16519     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16520                                    CP-LOAN-TERM.
 16521     IF CP-TRUNCATED-LIFE
 16522        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16523
 16524     IF CP-TERM-IS-DAYS
 16525         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16526     ELSE
 16527         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16528
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 298
* EL050.cbl
 16529     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16530
 16531     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16532
 16533     IF LF-COVERAGE-CANCELLED
 16534        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16535        NEXT SENTENCE
 16536      ELSE
 16537          GO TO 3730-GET-AH-REMAIN-TERM.
 16538
 16539 3720-GET-LF-REFUND.
 16540
 16541     IF PB-C-LF-CANCEL-VOIDED
 16542        GO TO 3730-GET-AH-REMAIN-TERM
 16543     end-if
 16544
 16545     IF PB-COMPANY-ID EQUAL 'BOA'
 16546         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16547         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16548         GO TO 3730-GET-AH-REMAIN-TERM.
 16549
 16550     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16551        (WS-AH-SPECIAL-CALC-CD = 'M')
 16552         MOVE ER-2767            TO WS-ERROR
 16553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16554         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16555         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16556         GO TO 3780-UPDATE-CANCEL-CERT.
 16557
 16558*    if (ws-lf-earnings-calc = '6')
 16559*       or (pb-c-lf-refund-override = '6')
 16560*       move cp-remaining-term-1 to cp-remaining-term-2
 16561*    end-if
 16562     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16563
 16564     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16565     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16566     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16567     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16568     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16569     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16570     IF PB-COMPANY-ID = 'DCC'
 16571        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16572        IF PDEF-MASTER-FOUND
 16573           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16574              (V1 > +8)
 16575              OR (PD-PROD-CODE (V1) = 'L')
 16576           END-PERFORM
 16577           IF V1 < +9
 16578              MOVE PD-MAX-AMT (V1)
 16579                           TO CP-R-MAX-TOT-BEN
 16580                              EC-AM-LF-MAX-TOT-BEN
 16581           END-IF
 16582        ELSE
 16583        MOVE ' '                 TO PDEF-MASTER-SW
 16584        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16585        MOVE PB-STATE            TO ERPDEF-STATE
 16586        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 299
* EL050.cbl
 16587           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16588        END-IF
 16589        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16590        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16591        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16592        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16593        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16594        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16595        IF PDEF-MASTER-FOUND
 16596           MOVE 'N'              TO PDEF-MASTER-SW
 16597           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16598           IF PDEF-MASTER-FOUND
 16599              IF (ERPDEF-KEY-SAVE (1:16) =
 16600                           PD-CONTROL-PRIMARY (1:16))
 16601                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16602                 CONTINUE
 16603              ELSE
 16604                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16605                 IF (ERPDEF-KEY-SAVE (1:16) =
 16606                           PD-CONTROL-PRIMARY (1:16))
 16607                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16608                    CONTINUE
 16609                 ELSE
 16610                    MOVE 'N'     TO PDEF-MASTER-SW
 16611                 END-IF
 16612              END-IF
 16613
 16614              IF PDEF-MASTER-FOUND
 16615                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16616                    (V1 > +8)
 16617                    OR (PD-PROD-CODE (V1) = 'L')
 16618                 END-PERFORM
 16619                 IF V1 < +9
 16620                    MOVE PD-MAX-AMT (V1)
 16621                                 TO CP-R-MAX-TOT-BEN
 16622                                    EC-AM-LF-MAX-TOT-BEN
 16623                 END-IF
 16624              END-IF
 16625           END-IF
 16626           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16627        END-IF
 16628        END-IF
 16629     END-IF
 16630     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16631
 16632     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16633
 16634     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16635                                    PB-C-LF-REM-TERM.
 16636
 16637     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16638     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16639
 16640     IF PB-COMPANY-ID EQUAL 'FLC'
 16641        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16642           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16643           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16644                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 300
* EL050.cbl
 16645                    - CM-LF-ITD-DEATH-AMT
 16646           IF PB-C-LF-REF-CALC LESS THAN +0
 16647              MOVE +0            TO PB-C-LF-REF-CALC
 16648              GO TO 3730-GET-AH-REMAIN-TERM
 16649           ELSE
 16650              GO TO 3730-GET-AH-REMAIN-TERM.
 16651
 16652     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16653                            OR '4' OR '5' OR '6' OR '8'
 16654                            OR '9' OR 'G'
 16655        MOVE PB-C-LF-REFUND-OVERRIDE
 16656                                 TO CP-EARNING-METHOD.
 16657
 16658     if pb-company-id = 'AHL'
 16659        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16660        if cp-class-code = spaces
 16661           move zeros            to cp-class-code
 16662        end-if
 16663     ELSE
 16664        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16665     END-IF
 16666*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16667     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16668     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16669                                    CP-RATING-BENEFIT-AMT.
 16670     IF CP-STATE-STD-ABBRV = 'OR'
 16671         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16672                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16673     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16674     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16675     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16676     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16677     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16678     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16679     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16680     IF WS-DEFAULT-APR NOT NUMERIC
 16681         MOVE ZEROS TO WS-DEFAULT-APR.
 16682****   N O T E   ****
 16683*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16684*      THE OH HARD CODING IN ELCRFNDP
 16685
 16686     IF PB-COMPANY-ID = 'CID'
 16687        IF CP-STATE-STD-ABBRV = 'OH'
 16688           MOVE WS-LF-EARNINGS-CALC
 16689                                 TO CP-EARNING-METHOD
 16690        END-IF
 16691     END-IF
 16692
 16693****   N O T E   ****
 16694
 16695*    IF CP-EARN-AS-NET-PAY
 16696*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16697*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16698*               MOVE WS-DEFAULT-APR
 16699*                                TO  CP-LOAN-APR
 16700*               MOVE ER-3780     TO  WS-ERROR
 16701*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16702*           ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 301
* EL050.cbl
 16703*               MOVE ER-3781     TO  WS-ERROR
 16704*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16705*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16706     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16707
 16708     IF CP-REFUND-TYPE-USED NOT = SPACE
 16709         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16710
 16711     IF CP-ERROR-RATE-IS-ZERO OR
 16712        CP-ERROR-RATE-NOT-FOUND
 16713        MOVE ER-2740             TO WS-ERROR
 16714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16715
 16716     IF CP-ERROR-RATE-FILE-NOTOPEN
 16717        MOVE ER-2617             TO WS-ERROR
 16718        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16719
 16720     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16721        AND PB-CI-ENTRY-STATUS = 'M'
 16722        MOVE +0                  TO PB-C-LF-REF-CALC
 16723     ELSE
 16724        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16725     END-IF
 16726
 16727     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16728         GO TO 3730-GET-AH-REMAIN-TERM.
 16729
 16730*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16731*       ADD +1                   TO PB-C-LF-REM-TERM
 16732*                                   CP-REMAINING-TERM
 16733*                                   CP-ORIGINAL-TERM.
 16734
 16735     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16736     MOVE '2'                    TO CP-EARNING-METHOD
 16737                                    CP-RATING-METHOD.
 16738     IF PB-COMPANY-ID = 'CID'
 16739        IF (CP-STATE-STD-ABBRV = 'MN')
 16740           AND (PB-CERT-EFF-DT > X'A4FF')
 16741           AND (WS-LF-EARNINGS-CALC = 'B')
 16742           MOVE '5'              TO CP-EARNING-METHOD
 16743           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16744        END-IF
 16745     END-IF
 16746     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16747                                        CP-REMAINING-BENEFIT
 16748                                        CP-RATING-BENEFIT-AMT.
 16749     IF CP-STATE-STD-ABBRV = 'OR'
 16750         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16751                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16752     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16753     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16754
 16755     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16756
 16757     IF CP-ERROR-RATE-IS-ZERO OR
 16758        CP-ERROR-RATE-NOT-FOUND
 16759        MOVE ER-2740             TO WS-ERROR
 16760        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 302
* EL050.cbl
 16761
 16762     IF CP-ERROR-RATE-FILE-NOTOPEN
 16763        MOVE ER-2617             TO WS-ERROR
 16764        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16765
 16766     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16767
 16768******************************************************************
 16769
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 303
* EL050.cbl
 16771 3730-GET-AH-REMAIN-TERM.
 16772     IF NO-AH-BENEFIT-MATCH  OR
 16773        WS-AH-BENEFIT-CD = ZEROS
 16774         GO TO 3770-CHECK-REFUNDS.
 16775
 16776     IF PB-CI-AH-LUMP-SUM-DISAB
 16777         IF  PB-C-AH-CANCEL-AMT = ZERO
 16778            IF NOT PB-COMP-AH-CANCEL
 16779             GO TO 3770-CHECK-REFUNDS.
 16780
 16781     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16782     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16783     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16784     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16785     MOVE PB-SV-STATE            TO CP-STATE.
 16786     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16787     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16788     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16789     MOVE '2'                    TO CP-PROCESS-TYPE.
 16790     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16791     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16792     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16793     IF (PB-COMPANY-ID = 'CID')
 16794        AND (CP-STATE-STD-ABBRV = 'WI')
 16795        MOVE '7'                 TO CP-REM-TERM-METHOD
 16796        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16797     ELSE
 16798        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16799        MOVE WS-REM-TRM-CALC-OPTION
 16800                                 TO CP-REM-TRM-CALC-OPTION
 16801     END-IF
 16802     IF (PB-COMPANY-ID = 'CID')
 16803        AND (CP-STATE-STD-ABBRV = 'MO')
 16804        AND (PB-CERT-EFF-DT >= X'9B41')
 16805        AND (PB-CERT-EFF-DT <= X'A2FB')
 16806        MOVE '7'                 TO CP-REM-TERM-METHOD
 16807        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16808     END-IF
 16809     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16810                                    CP-LOAN-TERM.
 16811     IF NOT CP-TERM-IS-DAYS
 16812         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16813
 16814     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16815
 16816     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16817
 16818     IF AH-COVERAGE-CANCELLED
 16819        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16820        NEXT SENTENCE
 16821      ELSE
 16822         GO TO 3770-CHECK-REFUNDS.
 16823
 16824 3740-GET-AH-REFUND.
 16825
 16826     IF PB-C-AH-CANCEL-VOIDED
 16827        GO TO 3780-UPDATE-CANCEL-CERT
 16828     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 304
* EL050.cbl
 16829
 16830     IF PB-COMPANY-ID = 'BOA'
 16831         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16832         GO TO 3770-CHECK-REFUNDS.
 16833
 16834     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16835*    MOVE ' '                    TO DC-OPTION-CODE
 16836     SET BIN-TO-GREG             TO TRUE
 16837     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16838     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16839                                    PB-C-AH-REM-TERM.
 16840     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16841     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16842
 16843     IF PB-COMPANY-ID EQUAL 'FLC'
 16844        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16845           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16846           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16847                    - CM-AH-ITD-AH-PMT)
 16848           IF PB-C-AH-REF-CALC LESS THAN +0
 16849              MOVE +0            TO PB-C-AH-REF-CALC
 16850              GO TO 3770-CHECK-REFUNDS
 16851           ELSE
 16852              GO TO 3770-CHECK-REFUNDS.
 16853
 16854     IF PB-COMPANY-ID = 'DCC'
 16855        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16856            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16857           MOVE 'S'              TO CP-EARNING-METHOD
 16858        END-IF
 16859     END-IF
 16860     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16861                            OR '4' OR '5' OR '6' OR '8'
 16862                            OR '9' OR 'G' OR 'S'
 16863        MOVE PB-C-AH-REFUND-OVERRIDE
 16864                                 TO CP-EARNING-METHOD.
 16865
 16866     if pb-company-id = 'AHL'
 16867        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16868        if cp-class-code = spaces
 16869           move zeros            to cp-class-code
 16870        end-if
 16871     ELSE
 16872        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16873     END-IF
 16874*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16875     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16876     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16877                                    CP-RATING-BENEFIT-AMT.
 16878     IF CP-STATE-STD-ABBRV = 'OR'
 16879         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16880                                         PB-CI-AH-TERM.
 16881     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16882     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16883     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16884     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16885     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16886     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 305
* EL050.cbl
 16887
 16888     IF CP-STATE-STD-ABBRV = 'OH'
 16889        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16890                                AND 'CID' AND 'DCC' and 'VPP'
 16891                                AND 'AHL')
 16892           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16893              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16894              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16895              MOVE '6' TO CP-EARNING-METHOD
 16896           END-IF
 16897        END-IF
 16898        IF PB-COMPANY-ID = 'CID'
 16899           IF NO-LIFE-COVERAGE
 16900              IF CP-CRITICAL-PERIOD
 16901                 MOVE '2'       TO CP-EARNING-METHOD
 16902              ELSE
 16903                 MOVE '6'       TO CP-EARNING-METHOD
 16904              END-IF
 16905           ELSE
 16906              IF WS-LF-COVERAGE-TYPE = 'L'
 16907                 MOVE '2'       TO CP-EARNING-METHOD
 16908              ELSE
 16909                 IF (PB-CI-LF-TERM > +60) OR
 16910                    (WS-LF-EARNINGS-CALC = '5')
 16911                    IF CP-CRITICAL-PERIOD
 16912                       MOVE '2'  TO CP-EARNING-METHOD
 16913                    ELSE
 16914                       MOVE '6'  TO CP-EARNING-METHOD
 16915                    END-IF
 16916                 ELSE
 16917                    MOVE '1'     TO CP-EARNING-METHOD
 16918                 END-IF
 16919              END-IF
 16920           END-IF
 16921        END-IF
 16922     END-IF
 16923
 16924*    IF CP-STATE-STD-ABBRV = 'VA'
 16925*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16926*          IF CP-ORIGINAL-TERM GREATER 61
 16927*             MOVE '6' TO CP-EARNING-METHOD
 16928*          ELSE
 16929*             MOVE '1' TO CP-EARNING-METHOD.
 16930
 16931     IF WS-DEFAULT-APR NOT NUMERIC
 16932         MOVE ZEROS TO WS-DEFAULT-APR.
 16933     IF CP-EARN-AS-NET-PAY
 16934         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16935            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16936                MOVE WS-DEFAULT-APR
 16937                                 TO  CP-LOAN-APR
 16938                MOVE ER-3780     TO  WS-ERROR
 16939                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16940            ELSE
 16941                MOVE ER-3781     TO  WS-ERROR
 16942                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16943     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16944     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 306
* EL050.cbl
 16945        AND CP-CANCEL-REASON = 'R'
 16946        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16947        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16948     END-IF
 16949     IF PB-COMPANY-ID = 'DCC'
 16950        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16951        AND (CP-EARNING-METHOD = 'D')
 16952        AND (CP-CANCEL-REASON NOT = 'R')
 16953        CONTINUE
 16954     ELSE
 16955        GO TO 3750-CONTINUE
 16956     END-IF
 16957     MOVE ' '                    TO DD-IU-SW
 16958     IF NOT PDEF-MASTER-FOUND
 16959        MOVE ' '                 TO PDEF-MASTER-SW
 16960        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16961        MOVE PB-STATE            TO ERPDEF-STATE
 16962        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16963           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16964        END-IF
 16965        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16966        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16967        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16968        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16969        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16970        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16971        IF PDEF-MASTER-FOUND
 16972           MOVE 'N'              TO PDEF-MASTER-SW
 16973           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16974           IF PDEF-MASTER-FOUND
 16975              IF (ERPDEF-KEY-SAVE (1:16) =
 16976                           PD-CONTROL-PRIMARY (1:16))
 16977                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16978                 CONTINUE
 16979              ELSE
 16980                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16981                 IF (ERPDEF-KEY-SAVE (1:16) =
 16982                           PD-CONTROL-PRIMARY (1:16))
 16983                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16984                    CONTINUE
 16985                 ELSE
 16986                    MOVE ER-2740 TO WS-ERROR
 16987                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16988                    GO TO 3770-CHECK-REFUNDS
 16989                 END-IF
 16990              END-IF
 16991           END-IF
 16992           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16993        END-IF
 16994     END-IF
 16995     IF PDEF-MASTER-FOUND
 16996        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16997           (V1 > +8)
 16998           OR (PD-PROD-CODE (V1) = 'I')
 16999        END-PERFORM
 17000        IF V1 < +9
 17001           SET DD-IU-PRESENT        TO TRUE
 17002        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 307
* EL050.cbl
 17003        IF WS-AH-DCC-TRUNC = 'T'
 17004           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17005        ELSE
 17006           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17007        END-IF
 17008        EVALUATE TRUE
 17009           WHEN WS-TERM > +168
 17010              MOVE 15               TO V1
 17011           WHEN WS-TERM > +156
 17012              MOVE 14               TO V1
 17013           WHEN WS-TERM > +144
 17014              MOVE 13               TO V1
 17015           WHEN WS-TERM > +132
 17016              MOVE 12               TO V1
 17017           WHEN WS-TERM > +120
 17018              MOVE 11               TO V1
 17019           WHEN WS-TERM > +108
 17020              MOVE 10               TO V1
 17021           WHEN WS-TERM > +96
 17022              MOVE 9                TO V1
 17023           WHEN WS-TERM > +84
 17024              MOVE 8                TO V1
 17025           WHEN WS-TERM > +72
 17026              MOVE 7                TO V1
 17027           WHEN WS-TERM > +60
 17028              MOVE 6                TO V1
 17029           WHEN WS-TERM > +48
 17030              MOVE 5                TO V1
 17031           WHEN WS-TERM > +36
 17032              MOVE 4                TO V1
 17033           WHEN WS-TERM > +24
 17034              MOVE 3                TO V1
 17035           WHEN WS-TERM > +12
 17036              MOVE 2                TO V1
 17037           WHEN OTHER
 17038              MOVE 1                TO V1
 17039        END-EVALUATE
 17040
 17041        EVALUATE TRUE
 17042*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17043*             < +13)
 17044*             AND (DD-IU-PRESENT)
 17045*             MOVE 2                TO V2
 17046*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17047*             MOVE 1                TO V2
 17048           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17049              MOVE 2                TO V2
 17050           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17051              MOVE 3                TO V2
 17052           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17053              MOVE 4                TO V2
 17054           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17055              MOVE 5                TO V2
 17056           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17057              MOVE 6                TO V2
 17058           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17059              MOVE 7                TO V2
 17060           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 308
* EL050.cbl
 17061              MOVE 8                TO V2
 17062           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17063              MOVE 9                TO V2
 17064           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17065              MOVE 10               TO V2
 17066           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17067              MOVE 11               TO V2
 17068           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17069              MOVE 12               TO V2
 17070           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17071              MOVE 13               TO V2
 17072           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17073              MOVE 14               TO V2
 17074           WHEN OTHER
 17075              MOVE 15               TO V2
 17076        END-EVALUATE
 17077
 17078        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17079                                 TO CP-DDF-LO-FACT
 17080        MOVE PD-UEP-FACTOR (V1 V2)
 17081                                 TO CP-DDF-HI-FACT
 17082
 17083        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17084        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17085        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17086           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17087        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17088        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17089        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17090           + PD-1ST-YR-ADMIN-ALLOW
 17091
 17092        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17093*       IF PI-CLP-YN = 'Y'
 17094*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17095*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17096*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17097*       END-IF
 17098
 17099        IF DD-IU-PRESENT
 17100           MOVE 'I'              TO CP-EARNING-METHOD
 17101        END-IF
 17102        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17103                                     CP-CLP-RATE-UP
 17104        IF CP-IU-RATE-UP NOT = ZEROS
 17105           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17106              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17107           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17108              / (1 - WS-WORK-FACT)
 17109        END-IF
 17110     END-IF
 17111     .
 17112 3750-CONTINUE.
 17113     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17114
 17115     IF CP-REFUND-TYPE-USED NOT = SPACE
 17116         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17117
 17118     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 309
* EL050.cbl
 17119        CP-ERROR-RATE-NOT-FOUND
 17120        MOVE ER-2740             TO WS-ERROR
 17121        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17122
 17123     IF CP-ERROR-RATE-FILE-NOTOPEN
 17124        MOVE ER-2617             TO WS-ERROR
 17125        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17126     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17127        AND (PB-CI-ENTRY-STATUS = 'M')
 17128        MOVE +0                  TO PB-C-AH-REF-CALC
 17129     ELSE
 17130        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17131     END-IF
 17132     if pb-company-id = 'VPP'
 17133        MOVE cm-ah-clp           to cp-original-premium
 17134        move zeros               to cp-calc-refund
 17135        perform 7600-get-refund  thru 7600-exit
 17136        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17137           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17138        else
 17139           move zeros            to pb-c-ah-rfnd-clp
 17140        end-if
 17141        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17142           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17143           pb-ci-cancel-fee
 17144     end-if
 17145     IF PB-COMPANY-ID = 'DCC'
 17146        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17147        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17148        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17149        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17150        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17151        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17152        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17153        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17154*       if pb-c-cancel-amt < +0
 17155*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17156*       end-if
 17157*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17158     END-IF
 17159     .
 17160 3770-CHECK-REFUNDS.
 17161
 17162     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17163        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17164           MOVE ER-2766          TO WS-ERROR
 17165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17166           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17167           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17168              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17169
 17170     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17171        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17172           MOVE ER-2766          TO WS-ERROR
 17173           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17174           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17175           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17176              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 310
* EL050.cbl
 17177
 17178     IF PB-COMP-LF-CANCEL
 17179        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17180        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17181           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17182              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17183
 17184     IF PB-COMP-AH-CANCEL
 17185        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17186        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17187           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17188              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17189
 17190     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17191             GIVING WS-UNSIGN-WRK1
 17192     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17193             GIVING WS-UNSIGN-WRK2.
 17194
 17195     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17196         MOVE ZERO TO WS-UNSIGN-WRK1.
 17197
 17198     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17199         MOVE ZERO TO WS-UNSIGN-WRK2.
 17200
 17201     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17202
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 311
* EL050.cbl
 17204
 17205 3772-CONTINUE.
 17206
 17207**********************************
 17208*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17209*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17210*** DOUBLES THE TOLERANCE AMOUNT.
 17211***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17212**********************************
 17213     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17214     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17215         IF WS-REF-REJECT-SW = SPACE
 17216             MOVE ER-2754        TO WS-ERROR
 17217             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17218           ELSE
 17219             MOVE ER-2736        TO WS-ERROR
 17220             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17221**********************************
 17222
 17223 3773-CONTINUE.
 17224
 17225     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17226        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17227           MOVE ER-2723          TO WS-ERROR
 17228           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17229
 17230     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17231        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17232           MOVE ER-2724          TO WS-ERROR
 17233           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17234
 17235     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17236         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17237             (1 + WS-LF-REFUND-OVS-PCT)
 17238     ELSE
 17239         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17240
 17241     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17242         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17243             (1 - WS-TOL-LF-REFUND-PCT)
 17244     ELSE
 17245         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17246
 17247     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17248        AND (PB-CI-ENTRY-STATUS = 'M')
 17249        AND (PB-C-LF-CANCEL-AMT > +0)
 17250        MOVE ER-3843             TO WS-ERROR
 17251        PERFORM 9900-ERROR-FORMAT
 17252                                 THRU 9900-EXIT
 17253     END-IF
 17254     EVALUATE TRUE
 17255        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17256           CONTINUE
 17257        WHEN PB-C-LF-CANCEL-AMT = +0
 17258                 AND PB-C-LF-REF-CALC > +0
 17259           CONTINUE
 17260        WHEN WS-LF-REFUND-OVS-AMT = 0
 17261                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 312
* EL050.cbl
 17262           CONTINUE
 17263        WHEN OTHER
 17264           IF WS-TOL-LF-REFUND  = +0
 17265              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17266           END-IF
 17267           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17268                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17269                          (PB-C-LF-CANCEL-AMT))
 17270              CONTINUE
 17271           ELSE
 17272              IF WS-LF-REFUND-OVS-AMT = +0
 17273                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17274              END-IF
 17275              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17276                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17277                                       PB-C-LF-CANCEL-AMT)
 17278                 CONTINUE
 17279              ELSE
 17280                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17281                   MOVE ER-2754   TO  WS-ERROR
 17282                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17283                 ELSE
 17284                    MOVE ER-2736   TO  WS-ERROR
 17285                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17286                 END-IF
 17287              END-IF
 17288           END-IF
 17289     END-EVALUATE.
 17290
 17291     EVALUATE TRUE
 17292        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17293           CONTINUE
 17294        WHEN PB-C-LF-CANCEL-AMT = +0
 17295                 AND PB-C-LF-REF-CALC > +0
 17296           CONTINUE
 17297        WHEN OTHER
 17298           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17299               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17300              CONTINUE
 17301           ELSE
 17302              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17303               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17304                CONTINUE
 17305              ELSE
 17306                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17307                     MOVE ER-2754   TO  WS-ERROR
 17308                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17309                 ELSE
 17310                     MOVE ER-2736   TO  WS-ERROR
 17311                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17312                 END-IF
 17313              END-IF
 17314           END-IF
 17315     END-EVALUATE.
 17316
 17317     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17318         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17319             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 313
* EL050.cbl
 17320     ELSE
 17321         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17322
 17323     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17324         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17325             (1 - WS-TOL-AH-REFUND-PCT)
 17326     ELSE
 17327         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17328
 17329     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17330        AND (PB-CI-ENTRY-STATUS = 'M')
 17331        AND (PB-C-AH-CANCEL-AMT > +0)
 17332        MOVE ER-3843             TO WS-ERROR
 17333        PERFORM 9900-ERROR-FORMAT
 17334                                 THRU 9900-EXIT
 17335     END-IF
 17336     EVALUATE TRUE
 17337        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17338           CONTINUE
 17339*       WHEN PB-C-AH-REF-CALC = +0 AND
 17340*                  PB-C-AH-CANCEL-AMT > +0
 17341        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17342                   PB-C-AH-REF-CALC > +0
 17343           CONTINUE
 17344        WHEN WS-AH-REFUND-OVS-AMT = +0
 17345                AND WS-TOL-AH-REFUND = +0
 17346           CONTINUE
 17347        WHEN OTHER
 17348           IF WS-TOL-AH-REFUND = +0
 17349              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17350           END-IF
 17351           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17352               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17353                                         PB-C-AH-CANCEL-AMT)
 17354              CONTINUE
 17355           ELSE
 17356              IF WS-AH-REFUND-OVS-AMT = +0
 17357                 MOVE +9999999.99 TO
 17358                         WS-AH-REFUND-OVS-AMT
 17359              END-IF
 17360              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17361                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17362                                         PB-C-AH-CANCEL-AMT)
 17363                 CONTINUE
 17364              ELSE
 17365                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17366                    MOVE ER-2754   TO  WS-ERROR
 17367                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17368                 ELSE
 17369                    MOVE ER-2736   TO  WS-ERROR
 17370                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17371                 END-IF
 17372              END-IF
 17373           END-IF
 17374     END-EVALUATE.
 17375
 17376     EVALUATE TRUE
 17377        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 314
* EL050.cbl
 17378           CONTINUE
 17379*       WHEN PB-C-AH-REF-CALC > +0 AND
 17380*                  PB-C-AH-CANCEL-AMT = +0
 17381        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17382                   PB-C-AH-REF-CALC = +0
 17383           CONTINUE
 17384        WHEN OTHER
 17385           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17386               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17387              CONTINUE
 17388           ELSE
 17389              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17390                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17391                 CONTINUE
 17392              ELSE
 17393                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17394                     MOVE ER-2754   TO  WS-ERROR
 17395                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17396                 ELSE
 17397                     MOVE ER-2736   TO  WS-ERROR
 17398                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17399                 END-IF
 17400              END-IF
 17401           END-IF
 17402     END-EVALUATE.
 17403
 17404     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17405        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17406        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17407           AND  PB-C-LF-REF-CALC < +1.00
 17408           AND  PB-C-AH-REF-CALC < +1.00
 17409           CONTINUE
 17410        ELSE
 17411           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17412              AND (PB-CI-ENTRY-STATUS = 'M')
 17413              CONTINUE
 17414           ELSE
 17415              MOVE ER-2741       TO WS-ERROR
 17416              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17417           END-IF
 17418        END-IF
 17419     END-IF
 17420
 17421     IF (PB-C-LF-CANCEL-AMT = ZERO
 17422        AND WS-LF-BENEFIT-CD NOT = ZERO
 17423        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17424        AND PB-C-LF-REF-CALC NOT = ZERO)
 17425        OR
 17426        (PB-C-LF-CANCEL-AMT = ZERO
 17427        AND WS-LF-BENEFIT-CD NOT = ZERO
 17428        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17429             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17430                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17431                NEXT SENTENCE
 17432             ELSE
 17433                MOVE ER-2739        TO WS-ERROR
 17434                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17435
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 315
* EL050.cbl
 17436     IF (PB-C-AH-CANCEL-AMT = ZERO
 17437        AND WS-AH-BENEFIT-CD NOT = ZERO
 17438        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17439        AND PB-C-AH-REF-CALC NOT = ZERO)
 17440        OR
 17441        (PB-C-AH-CANCEL-AMT = ZERO
 17442        AND WS-AH-BENEFIT-CD NOT = ZERO
 17443        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17444             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17445                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17446                NEXT SENTENCE
 17447             ELSE
 17448                MOVE ER-2738        TO WS-ERROR
 17449                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17450
 17451 3775-OVER-REF-CHK.
 17452
 17453     IF PB-CI-ENTRY-STATUS = '5'
 17454        GO TO 3780-UPDATE-CANCEL-CERT.
 17455
 17456     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17457                              PB-CI-LF-ALT-PREMIUM-AMT.
 17458
 17459     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17460        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17461                                 PB-C-LF-REF-CALC
 17462      ELSE
 17463        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17464                                 PB-C-LF-CANCEL-AMT.
 17465
 17466     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17467        MOVE ER-2755             TO WS-ERROR
 17468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17469
 17470     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17471
 17472     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17473        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17474                                 PB-C-AH-REF-CALC
 17475      ELSE
 17476        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17477                                 PB-C-AH-CANCEL-AMT.
 17478
 17479     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17480        MOVE ER-2778             TO WS-ERROR
 17481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17482
 17483     IF PB-CI-OB-FLAG NOT = 'Z'
 17484        NEXT SENTENCE
 17485       ELSE
 17486         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17487            MOVE ER-2757           TO WS-ERROR
 17488            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17489
 17490 3780-UPDATE-CANCEL-CERT.
 17491
 17492     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17493        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 316
* EL050.cbl
 17494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17495
 17496     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17497         MOVE ER-2729              TO WS-ERROR
 17498         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17499
 17500     IF PB-CI-LF-BENEFIT-CD = ZERO
 17501         GO TO 3780-UPDATE-CONT-1.
 17502
 17503     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17504         GO TO 3780-UPDATE-CONT-1.
 17505
 17506     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17507       AND
 17508        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17509       AND
 17510        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17511       AND
 17512        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17513            NEXT SENTENCE
 17514       ELSE
 17515        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17516          AND
 17517***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17518***       AND
 17519           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17520            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17521               MOVE ER-2730      TO WS-ERROR
 17522               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17523               GO TO 3999-END-EDIT
 17524            ELSE
 17525               GO TO 3999-END-EDIT
 17526        ELSE
 17527            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17528               MOVE ER-2765           TO WS-ERROR
 17529               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17530               GO TO 3785-CHECK-NH.
 17531*              GO TO 3999-END-EDIT.
 17532
 17533 3780-UPDATE-CONT-1.
 17534     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17535
 17536     IF PB-CI-AH-BENEFIT-CD = ZERO
 17537         GO TO 3780-UPDATE-CONT-2.
 17538
 17539     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17540         GO TO 3780-UPDATE-CONT-2.
 17541
 17542     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17543
 17544     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17545       AND
 17546        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17547       AND
 17548        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17549       AND
 17550        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17551            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 317
* EL050.cbl
 17552       ELSE
 17553        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17554          AND
 17555***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17556***       AND
 17557           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17558           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17559            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17560               MOVE ER-2773      TO WS-ERROR
 17561               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17562               GO TO 3999-END-EDIT
 17563            ELSE
 17564               GO TO 3999-END-EDIT
 17565            END-IF
 17566           ELSE
 17567             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17568                IF MSTR-CERT-NO = W-CL-CERT-NO
 17569                   MOVE ER-2890 TO WS-ERROR
 17570                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17571                   GO TO 3999-END-EDIT
 17572                ELSE
 17573                   MOVE ER-2898 TO WS-ERROR
 17574                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17575                   GO TO 3999-END-EDIT
 17576                END-IF
 17577             ELSE
 17578                GO TO 3785-CHECK-NH
 17579             END-IF
 17580           END-IF
 17581          ELSE
 17582            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17583              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17584                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17585                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17586                      MOVE ER-2890 TO WS-ERROR
 17587                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17588                      GO TO 3999-END-EDIT
 17589                   ELSE
 17590                      MOVE ER-2898 TO WS-ERROR
 17591                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17592                      GO TO 3999-END-EDIT
 17593                   END-IF
 17594                ELSE
 17595                   MOVE ER-2765 TO WS-ERROR
 17596                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17597                   GO TO 3785-CHECK-NH
 17598                END-IF
 17599              ELSE
 17600               MOVE ER-2765      TO WS-ERROR
 17601               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17602               GO TO 3785-CHECK-NH.
 17603*              GO TO 3999-END-EDIT.
 17604
 17605 3780-UPDATE-CONT-2.
 17606
 17607     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17608        AND WS-LF-BENEFIT-CD = ZERO
 17609           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 318
* EL050.cbl
 17610           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17611
 17612     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17613        AND WS-AH-BENEFIT-CD = ZERO
 17614           MOVE ER-2744           TO WS-ERROR
 17615           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17616
 17617     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17618        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17619        AND
 17620        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17621         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17622           MOVE ER-2746           TO WS-ERROR
 17623           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17624
 17625     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17626       AND
 17627        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17628             MOVE ER-2737        TO WS-ERROR
 17629             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17630
 17631     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17632       AND
 17633        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17634             MOVE ER-2737        TO WS-ERROR
 17635             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17636
 17637     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17638         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17639             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17640             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17641         ELSE
 17642             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17643                 MOVE ER-2768    TO WS-ERROR
 17644                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17645             ELSE
 17646                 MOVE ER-2756    TO WS-ERROR
 17647                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17648
 17649     IF CERT-PEND-ISSUE-RETURNED
 17650        MOVE ER-2772             TO WS-ERROR
 17651        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17652 3785-CHECK-NH.
 17653*    IF PB-STATE NOT = 'NH' and 'TN'
 17654     IF PB-STATE NOT = 'NH'
 17655        GO TO 3999-END-EDIT
 17656     END-IF
 17657
 17658     MOVE ER-2796                TO WS-ERROR
 17659     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17660     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17661        OR (CM-NH-INTERFACE-SW = 'Y')
 17662        MOVE ER-2793             TO WS-ERROR
 17663        PERFORM 9900-ERROR-FORMAT
 17664                                 THRU 9900-EXIT
 17665     END-IF
 17666     MOVE +0                     TO WS-PAYMENT-AMT
 17667     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 319
* EL050.cbl
 17668        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17669               PB-C-AH-CANCEL-DT
 17670           GO TO 3999-END-EDIT
 17671        END-IF
 17672     end-if
 17673***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17674***-_-
 17675***-_-   For TN it's only flat cancels
 17676***-_-
 17677***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17678     if pb-state = 'TN'
 17679        if ((pb-c-lf-cancel-dt <> low-values)
 17680           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17681                      or
 17682           ((pb-c-ah-cancel-dt <> low-values)
 17683           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17684           GO TO 3999-END-EDIT
 17685        END-IF
 17686     end-if
 17687     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17688        GO TO 3999-END-EDIT
 17689     END-IF
 17690***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17691***-_-
 17692***-_-   if cancel date within 15 days of effective date, bypass
 17693***-_-
 17694***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17695     IF PB-STATE NOT = 'NH'
 17696        GO TO 3785-CONTINUE
 17697     END-IF
 17698     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17699     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17700     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17701        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17702     END-IF
 17703     MOVE '1'                    TO DC-OPTION-CODE
 17704     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17705     IF NO-CONVERSION-ERROR
 17706        IF DC-ELAPSED-DAYS < +16
 17707           GO TO 3999-END-EDIT
 17708        END-IF
 17709     END-IF
 17710***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17711***-_-
 17712***-_-   if cancel date within 30 days of current date then
 17713***-_-   bypass else subtract 15 days from period
 17714***-_-
 17715***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17716     MOVE +0                     TO DC-ELAPSED-DAYS
 17717     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17718     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17719     MOVE '1'                    TO DC-OPTION-CODE
 17720     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17721     IF NO-CONVERSION-ERROR
 17722        IF DC-ELAPSED-DAYS > +30
 17723           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17724        ELSE
 17725           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 320
* EL050.cbl
 17726        END-IF
 17727     ELSE
 17728        GO TO 3999-END-EDIT
 17729     END-IF
 17730     .
 17731 3785-CONTINUE.
 17732     if pb-state = 'TN'
 17733        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17734        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17735        MOVE '1'                 TO DC-OPTION-CODE
 17736        PERFORM 8500-DATE-CONVERT
 17737                                 THRU 8500-EXIT
 17738        IF no-CONVERSION-ERROR
 17739           IF DC-ELAPSED-DAYS < +16
 17740              GO TO 3999-END-EDIT
 17741           END-IF
 17742        END-IF
 17743     end-if
 17744***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17745***-_-
 17746***-_-   'NH' is 10%, TN is 3.5%
 17747***-_-
 17748***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17749     if pb-state = 'NH'
 17750        move +1.10               to ws-work-rate
 17751     else
 17752        move +1.035              to ws-work-rate
 17753     end-if
 17754     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17755        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17756           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17757     IF WS-PAYMENT-AMT < 600.00
 17758        GO TO 3999-END-EDIT
 17759     END-IF
 17760     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17761
 17762     IF (ERMAIL-FOUND = ' ')
 17763         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17764         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17765        GO TO 3999-END-EDIT
 17766     END-IF
 17767     MOVE ER-2795                TO WS-ERROR
 17768     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17769
 17770     GO TO 3999-END-EDIT.
 17771******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 321
* EL050.cbl
 17773 3990-FILES-NOT-OPEN.
 17774
 17775     MOVE ER-2617                TO WS-ERROR.
 17776     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17777     GO TO 9990-RETURN.
 17778
 17779 3999-END-EDIT.
 17780
 17781     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17782
 17783     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17784         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17785         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17786             PERFORM 9250-UNLOCK-RETURN
 17787             GO TO 9990-RETURN
 17788          ELSE
 17789             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17790             GO TO 9990-RETURN.
 17791
 17792     IF PB-CANCELLATION
 17793          GO TO 9990-RETURN.
 17794
 17795     IF CERT-WAS-NOT-FOUND
 17796        MOVE SPACES              TO CERTIFICATE-MASTER.
 17797
 17798     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17799
 17800     IF CERT-WAS-FOUND
 17801         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17802             PERFORM 9250-UNLOCK-RETURN
 17803          ELSE
 17804            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17805      ELSE
 17806         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17807
 17808*    if pb-company-id = 'VPP'
 17809*       perform 8150-read-elcrtt thru 8150-exit
 17810*       if ws-vehicle-odometer numeric
 17811*          if ws-vehicle-odometer > 6000
 17812*             move er-1583       to ws-error
 17813*             PERFORM 9900-ERROR-FORMAT
 17814*                                THRU 9900-EXIT
 17815*          end-if
 17816*       end-if
 17817*    end-if
 17818     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17819        IF ((PB-COMPANY-ID = 'DCC')
 17820           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17821                         or
 17822            (pb-company-id = 'CID' or 'VPP')
 17823            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17824        END-IF
 17825     END-IF.
 17826
 17827     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17828         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17829     END-IF.
 17830     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 322
* EL050.cbl
 17831     perform 8150-read-elcrtt    thru 8150-exit
 17832     if ws-ins-age-defaulted = 'Y'
 17833        move er-1573             to ws-error
 17834        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17835     end-if
 17836
 17837     if ws-jnt-age-defaulted = 'Y'
 17838        move er-1574             to ws-error
 17839        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17840     end-if
 17841***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17842***                                                           ****
 17843***  Set an error if the state requires verification of agent ****
 17844***  and agent hasn't verified yet and the status is not =    ****
 17845***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17846***  and the entry date > 09/01/2015.                         ****
 17847***                                                           ****
 17848***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17849     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17850        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17851        and (pb-account (9:2) not = 'OB')
 17852        if (ws-st-agent-sig-edit = 'Y')
 17853           and (am-report-code-1 not = 'CONLEY')
 17854           evaluate true
 17855              when cs-agent-edit-status = 'C'
 17856                 move er-1743    to ws-error
 17857                 perform 9900-error-format
 17858                                 thru 9900-exit
 17859              when cs-agent-edit-status = 'S'
 17860                 move er-1744    to ws-error
 17861                 perform 9900-error-format
 17862                                 thru 9900-exit
 17863              when cs-agent-edit-status = 'M'
 17864                 move er-1745    to ws-error
 17865                 perform 9900-error-format
 17866                                 thru 9900-exit
 17867              when cs-agent-edit-status = 'R'
 17868                 move er-1747    to ws-error
 17869                 perform 9900-error-format
 17870                                 thru 9900-exit
 17871              when cs-agent-edit-status = 'N'
 17872                 move er-1748    to ws-error
 17873                 perform 9900-error-format
 17874                                 thru 9900-exit
 17875              when cs-agent-edit-status <> 'V' and 'U' and
 17876                                           'R' and 'N'
 17877                 move er-1746    to ws-error
 17878                 perform 9900-error-format
 17879                                 thru 9900-exit
 17880           end-evaluate
 17881        end-if
 17882     end-if
 17883     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17884     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17885        AND (WS-NO-SECURE-PAY))
 17886                  OR
 17887        (WS-LF-SPECIAL-CALC-CD = 'O'
 17888        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 323
* EL050.cbl
 17889        SET SKIP-ADDR-EDIT       TO TRUE
 17890     END-IF
 17891     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17892        AND (NOT SKIP-ADDR-EDIT)
 17893        MOVE ER-2963             TO WS-ERROR
 17894        PERFORM 9900-ERROR-FORMAT
 17895                                 THRU 9900-EXIT
 17896        GO TO 9990-RETURN
 17897     END-IF
 17898     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17899     IF ERPNDM-FOUND NOT = 'X'
 17900        move 'Y'                 to erpndm-unlock-sw
 17901        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17902           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17903           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17904           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 17905           or (pm-zip-code    = zeros)
 17906           or (pm-zip-code not numeric))
 17907           AND (NOT SKIP-ADDR-EDIT)
 17908           MOVE ER-2694          TO WS-ERROR
 17909           PERFORM 9900-ERROR-FORMAT
 17910                                 THRU 9900-EXIT
 17911        END-IF
 17912        MOVE ' '                 TO STATE-RECORD-ERROR
 17913        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17914        MOVE PM-STATE            TO CNTL-ACCESS
 17915        MOVE '3'                 TO CNTL-REC-TYPE
 17916        MOVE +0                  TO CNTL-SEQ-NO
 17917        MOVE '0'                 TO RC-SW-2
 17918        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17919        IF (NO-STATE-RECORD)
 17920           OR (CF-RECORD-TYPE NOT = '3')
 17921           OR (PM-STATE NOT = CF-STATE-CODE)
 17922           IF (PM-STATE = SPACES)
 17923              AND (SKIP-ADDR-EDIT)
 17924              CONTINUE
 17925           ELSE
 17926              MOVE ER-2963       TO WS-ERROR
 17927              PERFORM 9900-ERROR-FORMAT
 17928                                 THRU 9900-EXIT
 17929           END-IF
 17930        END-IF
 17931        if (ws-error not = er-2963 and er-2694)
 17932           and (pm-city-st-zip-verified = ' ')
 17933           and (pb-company-id = 'CID')
 17934           move spaces           to zipcd-pass-area
 17935           move pm-zip-code      to pa-zip
 17936           move pm-city          to pa-city
 17937           move pm-state         to pa-state
 17938           perform 7790-call-zip-verify
 17939                                 thru 7790-exit
 17940           if pa-errorcode-zip (1:1) = ' '
 17941                    move 'Y'     to pm-city-st-zip-verified
 17942                    PERFORM 8102-REWRITE-ERPNDM
 17943                                 THRU 8102-EXIT
 17944                    move 'N'     to erpndm-unlock-sw
 17945           else
 17946              MOVE ER-3061       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 324
* EL050.cbl
 17947              PERFORM 9900-ERROR-FORMAT
 17948                                 THRU 9900-EXIT
 17949           end-if
 17950        end-if
 17951        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17952           MOVE ER-2883          TO WS-ERROR
 17953           PERFORM 9900-ERROR-FORMAT
 17954                                 THRU 9900-EXIT
 17955        END-IF
 17956        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17957           MOVE ' '                 TO STATE-RECORD-ERROR
 17958           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17959           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17960           MOVE '3'                 TO CNTL-REC-TYPE
 17961           MOVE +0                  TO CNTL-SEQ-NO
 17962           MOVE '0'                 TO RC-SW-2
 17963           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17964           IF NO-STATE-RECORD
 17965              OR (CF-RECORD-TYPE NOT = '3')
 17966              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17967              MOVE ER-2964          TO WS-ERROR
 17968              PERFORM 9900-ERROR-FORMAT
 17969                                    THRU 9900-EXIT
 17970           END-IF
 17971        END-IF
 17972     ELSE
 17973        IF NOT SKIP-ADDR-EDIT
 17974           MOVE ER-2393          TO WS-ERROR
 17975           PERFORM 9900-ERROR-FORMAT
 17976                                 THRU 9900-EXIT
 17977        END-IF
 17978     END-IF
 17979     if need-to-unlock-erpndm
 17980        perform 8104-unlock-erpndm
 17981                                 thru 8104-exit
 17982     end-if
 17983     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17984
 17985     IF (ERMAIL-FOUND = ' ' AND
 17986        ERPNDM-FOUND = ' ')
 17987        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17988           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17989           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17990          OR
 17991           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17992          OR
 17993           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17994           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17995           GO TO 3999-UNLOCK-ERMAIL.
 17996
 17997     IF ERPNDM-FOUND = 'X'
 17998        GO TO 3999-UNLOCK-ERMAIL.
 17999
 18000     IF PM-INSURED-LAST-NAME      = SPACES
 18001        AND PM-INSURED-FIRST-NAME = SPACES
 18002        AND PM-ADDRESS-LINE-1     = SPACES
 18003        AND PM-ADDRESS-LINE-2     = SPACES
 18004        AND PM-CITY-STATE         = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 325
* EL050.cbl
 18005        AND PM-CRED-BENE-NAME     = SPACES
 18006        AND PM-CRED-BENE-ADDR     = SPACES
 18007        AND PM-CRED-BENE-CTYST    = SPACES
 18008        GO TO 3999-UNLOCK-ERMAIL
 18009     END-IF
 18010
 18011     MOVE SPACES                 TO MAILING-DATA.
 18012
 18013     MOVE 'MA'                   TO MA-RECORD-ID.
 18014     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18015     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18016     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18017     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18018     MOVE PB-SV-STATE            TO MA-STATE.
 18019     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18020     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18021
 18022     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18023     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18024
 18025     IF ERMAIL-FOUND = ' '
 18026        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18027     ELSE
 18028        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18029        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18030        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18031
 18032     GO TO 9990-RETURN.
 18033
 18034 3999-UNLOCK-ERMAIL.
 18035     IF ERMAIL-FOUND = ' '
 18036        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18037
 18038     GO TO 9990-RETURN.
 18039******************************************************************
 18040
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 326
* EL050.cbl
 18042 4000-UPDATE-CANCELLED-CERT.
 18043     IF CERT-WAS-NOT-FOUND
 18044        GO TO 4299-EXIT.
 18045
 18046*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18047     IF PB-C-NH-INT-ON-REFS > ZEROS
 18048        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 18049     END-IF
 18050     IF PB-C-REF-INTERFACE-SW = 'Y'
 18051        MOVE PB-C-REF-INTERFACE-SW
 18052                                 TO CM-NH-INTERFACE-SW
 18053     END-IF
 18054     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18055     IF ERMAIL-FOUND = 'X'
 18056        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18057        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18058        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18059        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18060           MOVE ER-2694          TO WS-ERROR
 18061           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18062     END-IF
 18063
 18064     IF PB-C-POST-CARD-IND = 'Y'
 18065        MOVE +8                  TO SUB
 18066*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18067        IF ERMAIL-FOUND = ' '
 18068           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18069              (SUB > +7)
 18070              OR (MA-MAIL-STATUS (SUB) = '1')
 18071           END-PERFORM
 18072        END-IF
 18073        IF (SUB > +7)
 18074           OR (ERMAIL-FOUND = 'X')
 18075           MOVE ER-3789          TO WS-ERROR
 18076           PERFORM 9900-ERROR-FORMAT
 18077                                 THRU 9900-EXIT
 18078        END-IF
 18079     ELSE
 18080        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18081     END-IF
 18082
 18083     IF ERMAIL-FOUND = ' '
 18084        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18085     END-IF.
 18086
 18087     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18088
 18089     IF PB-CI-OB-FLAG = 'Z'
 18090        GO TO 4150-SUMMARY-CERT-CANCEL.
 18091
 18092     IF PB-C-LF-CANCEL-VOIDED
 18093         PERFORM 4200-REVERSE-LF-CANCEL.
 18094     IF PB-C-AH-CANCEL-VOIDED
 18095         PERFORM 4200-REVERSE-AH-CANCEL.
 18096
 18097 4100-APPLY-LF-CANCEL.
 18098
 18099     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 327
* EL050.cbl
 18100
 18101 4100-CHECK-LF-ERRORS.
 18102
 18103     ADD +1                       TO WS-SUB.
 18104
 18105     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18106        IF LF-COVERAGE-CANCELLED
 18107           GO TO 4100-LF-CANCEL-CONT
 18108        ELSE
 18109           GO TO 4100-UPDATE-LF-COVERAGE.
 18110
 18111     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18112                                   ER-2729 OR
 18113                                   ER-2730 OR
 18114                                   ER-2731 OR
 18115                                   ER-2732 OR
 18116                                   ER-2737 OR
 18117                                   ER-2740 OR
 18118                                   ER-2743 OR
 18119                                   ER-2749 OR
 18120                                   ER-2750 OR
 18121                                   ER-2755 OR
 18122                                   ER-2757 OR
 18123                                   ER-2760 OR
 18124                                   ER-2772 OR
 18125                                   ER-2774 OR
 18126                                   ER-2776 OR
 18127                                   ER-2794
 18128        GO TO 4100-UPDATE-LF-COVERAGE.
 18129
 18130     GO TO 4100-CHECK-LF-ERRORS.
 18131
 18132 4100-UPDATE-LF-COVERAGE.
 18133
 18134     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18135     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18136     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18137        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18138     END-IF
 18139     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18140                                      TO CM-CREDIT-INTERFACE-SW-2.
 18141     IF CM-LF-CANCEL-DT = LOW-VALUE
 18142         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18143
 18144     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18145         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18146                                         CM-LF-STATUS-AT-CANCEL.
 18147
 18148     GO TO 4100-APPLY-AH-CANCEL.
 18149
 18150 4100-LF-CANCEL-CONT.
 18151     IF PB-C-LF-CANCEL-VOIDED
 18152         GO TO 4100-APPLY-AH-CANCEL.
 18153
 18154     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18155         GO TO 4100-APPLY-AH-CANCEL.
 18156
 18157     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 328
* EL050.cbl
 18158        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18159           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18160        ELSE
 18161           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18162
 18163     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18164     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18165
 18166     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18167         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18168
 18169     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18170        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18171         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18172         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18173
 18174     IF PB-RECORD-RETURNED
 18175        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18176      ELSE
 18177        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18178
 18179 4100-APPLY-AH-CANCEL.
 18180
 18181     MOVE +0                      TO WS-SUB.
 18182
 18183 4100-CHECK-AH-ERRORS.
 18184
 18185     ADD +1                       TO WS-SUB.
 18186
 18187     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18188        IF AH-COVERAGE-CANCELLED
 18189           GO TO 4100-AH-CANCEL-CONT
 18190        ELSE
 18191           GO TO 4100-UPDATE-AH-COVERAGE.
 18192
 18193     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18194                                   ER-2729 OR
 18195                                   ER-2732 OR
 18196                                   ER-2737 OR
 18197                                   ER-2740 OR
 18198                                   ER-2744 OR
 18199                                   ER-2749 OR
 18200                                   ER-2750 OR
 18201                                   ER-2755 OR
 18202                                   ER-2757 OR
 18203                                   ER-2760 OR
 18204                                   ER-2771 OR
 18205                                   ER-2772 OR
 18206                                   ER-2773 OR
 18207                                   ER-2775 OR
 18208                                   ER-2777 OR
 18209                                   ER-2778 OR
 18210                                   ER-2794
 18211        GO TO 4100-UPDATE-AH-COVERAGE.
 18212
 18213     GO TO 4100-CHECK-AH-ERRORS.
 18214
 18215 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 329
* EL050.cbl
 18216
 18217     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18218     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18219     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18220     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18221                                      TO CM-CREDIT-INTERFACE-SW-2.
 18222     IF CM-AH-CANCEL-DT = LOW-VALUE
 18223         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18224
 18225     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18226         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18227                                         CM-AH-STATUS-AT-CANCEL.
 18228
 18229     IF LF-COVERAGE-CANCELLED
 18230         IF PB-RECORD-RETURNED
 18231              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18232          ELSE
 18233              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18234
 18235     GO TO 4299-EXIT.
 18236
 18237 4100-AH-CANCEL-CONT.
 18238     IF PB-C-AH-CANCEL-VOIDED
 18239         GO TO 4299-EXIT.
 18240
 18241     if cm-credit-interface-sw-2 = ' '
 18242        if pb-fatal-errors or pb-unforced-errors
 18243           move '4'              to cm-credit-interface-sw-2
 18244        else
 18245           move '1'              to cm-credit-interface-sw-2
 18246        end-if
 18247     end-if
 18248     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18249         GO TO 4299-EXIT.
 18250
 18251     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18252        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18253           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18254        ELSE
 18255           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18256
 18257     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18258     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18259
 18260     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18261         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18262
 18263     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18264         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18265         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18266
 18267     IF PB-RECORD-RETURNED
 18268        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18269      ELSE
 18270        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18271
 18272     GO TO 4299-EXIT.
 18273
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 330
* EL050.cbl
 18274 4150-SUMMARY-CERT-CANCEL.
 18275     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18276
 18277     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18278        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18279                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18280     ELSE
 18281        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18282                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18283
 18284     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18285        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18286                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18287     ELSE
 18288        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18289                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18290
 18291     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18292        NEXT SENTENCE
 18293     ELSE
 18294        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18295
 18296     GO TO 4299-EXIT.
 18297
 18298 4200-REVERSE-LF-CANCEL.
 18299     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18300
 18301     IF CM-LF-CANCEL-APPLIED
 18302        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18303        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18304        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 18305
 18306     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18307
 18308     IF PB-RECORD-RETURNED
 18309        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18310       ELSE
 18311        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18312
 18313 4200-REVERSE-LF-EXIT.
 18314       EXIT.
 18315
 18316 4200-REVERSE-AH-CANCEL.
 18317     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18318
 18319     IF CM-AH-CANCEL-APPLIED
 18320        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18321        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18322        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18323
 18324     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18325
 18326     IF PB-RECORD-RETURNED
 18327        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18328       ELSE
 18329        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18330
 18331 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 331
* EL050.cbl
 18332       EXIT.
 18333
 18334 4299-EXIT.
 18335       EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 332
* EL050.cbl
 18337
 18338 4500-UPDATE-NEW-CERT.
 18339     IF CERT-WAS-FOUND
 18340         NEXT SENTENCE
 18341       ELSE
 18342         GO TO 4520-BUILD-NEW-KEY.
 18343
 18344     IF  CLASIC-CREATED-CERT
 18345         GO TO 4999-EXIT.
 18346
 18347     IF  CERT-WAS-CREATED-FOR-CLAIM
 18348         GO TO 4520-BUILD-NEW-KEY.
 18349
 18350     IF CERT-ADDED-BATCH
 18351        IF CM-RECORD-ID = 'CM'
 18352            GO TO 4999-EXIT.
 18353
 18354 4520-BUILD-NEW-KEY.
 18355* BUILD CONTROL PRIMARY
 18356
 18357     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18358                                       CM-COMPANY-CD-A1
 18359                                       CM-COMPANY-CD-A2
 18360                                       CM-COMPANY-CD-A4
 18361                                       CM-COMPANY-CD-A5.
 18362
 18363     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18364     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18365     MOVE PB-SV-STATE               TO CM-STATE.
 18366     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18367     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18368     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18369     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18370
 18371     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18372
 18373     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18374     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18375     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18376     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18377
 18378     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18379        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18380
 18381     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18382         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18383         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18384         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18385         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18386     ELSE
 18387         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18388
 18389     IF PB-COMPANY-ID   EQUAL  'CRI'
 18390         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18391         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18392         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18393         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18394         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 333
* EL050.cbl
 18395
 18396     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18397        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18398         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18399
 18400     IF PB-COMPANY-ID  = 'LBL'
 18401        IF PB-I-JOINT-COVERAGE
 18402            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18403                                           PB-I-MEMBER-NO
 18404            GO TO 4550-CONT-CERT-PROCESS.
 18405
 18406     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18407        NEXT SENTENCE
 18408     ELSE
 18409        GO TO 4540-BUILD-MEMBER-NO.
 18410
 18411******************************************************************
 18412*                                                                *
 18413*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18414*    FOR 'MON'.                                                  *
 18415*                                                                *
 18416******************************************************************
 18417
 18418     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18419     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18420     MOVE +1                     TO WS-SUB1
 18421                                    WS-SUB2.
 18422
 18423 4530-EDIT-MEMB-NAME.
 18424
 18425     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18426        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18427        ADD +1                       TO WS-SUB2.
 18428
 18429     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18430        ADD +1                       TO WS-SUB1
 18431        GO TO 4530-EDIT-MEMB-NAME.
 18432
 18433     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18434     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18435     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18436*    MOVE SPACE                      TO DC-OPTION-CODE.
 18437     SET  BIN-TO-GREG                TO TRUE.
 18438     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18439     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18440
 18441     GO TO 4550-CONT-CERT-PROCESS.
 18442
 18443******************************************************************
 18444*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18445******************************************************************
 18446
 18447 4540-BUILD-MEMBER-NO.
 18448
 18449     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18450         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18451         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18452         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 334
* EL050.cbl
 18453         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18454     ELSE
 18455         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18456
 18457     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18458        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18459         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18460
 18461 4550-CONT-CERT-PROCESS.
 18462
 18463*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18464*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18465*    ELSE
 18466*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18467
 18468     IF CERT-WAS-CREATED-FOR-CLAIM
 18469        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18470        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18471
 18472     IF CERT-AND-CLAIM-ONLINE
 18473        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18474        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18475
 18476     MOVE 'CM'                     TO CM-RECORD-ID.
 18477     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18478
 18479     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18480        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18481        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18482     ELSE
 18483        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18484        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18485
 18486     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18487     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18488     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18489     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18490     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18491     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18492     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18493                                      CM-LF-ITD-CANCEL-AMT
 18494                                      CM-LF-ITD-DEATH-AMT
 18495                                      CM-AH-ITD-AH-PMT
 18496                                      CM-AH-ITD-LUMP-PMT
 18497                                      CM-AH-ITD-CANCEL-AMT
 18498                                      CM-LF-NSP-PREMIUM-AMT
 18499                                      CM-AH-NSP-PREMIUM-AMT.
 18500*                                     CM-CLAIM-DEDUCT-WITHHELD
 18501*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18502     if pb-i-loan-apr = +99.9999
 18503        move zeros                 to cm-loan-apr
 18504     else
 18505        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18506     end-if
 18507     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18508     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18509     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18510     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 335
* EL050.cbl
 18511     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18512     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18513     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18514     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18515     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18516     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18517     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18518
 18519     IF PB-I-LIVES NOT NUMERIC
 18520         MOVE ZERO                 TO PB-I-LIVES.
 18521
 18522     IF PB-I-NUM-BILLED NOT NUMERIC
 18523         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18524
 18525     MOVE PB-I-LIVES               TO CM-LIVES.
 18526     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18527
 18528     IF PB-COMPANY-ID EQUAL  'DMD'
 18529         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18530         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18531
 18532     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18533     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18534     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18535     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18536     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18537     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18538
 18539     IF PB-I-LF-POLICY-FEE NUMERIC
 18540        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18541     ELSE
 18542        MOVE +0                    TO CM-LF-POLICY-FEE.
 18543
 18544     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18545        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18546        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18547     ELSE
 18548        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18549
 18550     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18551     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18552     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18553     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18554     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18555     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18556     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18557     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18558     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18559
 18560     IF PB-I-CANCEL-FEE NUMERIC
 18561        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18562     ELSE
 18563        MOVE +0                  TO CM-CANCEL-FEE
 18564     END-IF
 18565
 18566     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18567        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18568     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 336
* EL050.cbl
 18569        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18570
 18571     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18572     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18573
 18574     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18575                                      CM-LF-DEATH-EXIT-DT
 18576                                      CM-AH-SETTLEMENT-EXIT-DT.
 18577
 18578*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18579*                       'TIH' OR 'OFL' OR 'FLA' OR
 18580*                       'TII' OR 'TMS' OR 'CRI' OR
 18581*                       'NCL'
 18582     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18583
 18584     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18585         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18586            MOVE '2'                TO CM-PREMIUM-TYPE.
 18587
 18588     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18589         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18590            MOVE '2'                TO CM-PREMIUM-TYPE.
 18591
 18592     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18593         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18594     ELSE
 18595         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18596         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18597
 18598     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18599     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18600     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18601     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18602     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18603     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18604     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18605     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18606
 18607     IF PB-NO-MONTHS-SKIPPED
 18608         MOVE SPACE                 TO CM-SKIP-CODE
 18609     ELSE
 18610         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18611
 18612     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18613     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18614                                       CM-LF-STATUS-AT-CANCEL.
 18615
 18616     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18617     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18618                                       CM-AH-STATUS-AT-CANCEL.
 18619
 18620     MOVE '1'                       TO CM-ENTRY-STATUS.
 18621
 18622     IF PB-REISSUED-CERT
 18623        MOVE '5'                    TO CM-ENTRY-STATUS.
 18624
 18625     IF PB-MONTHLY-CERT
 18626        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 337
* EL050.cbl
 18627
 18628     IF PB-CASH-CERT
 18629        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18630
 18631     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18632     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18633     IF PB-POLICY-IS-DECLINED
 18634        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18635
 18636     IF PB-POLICY-IS-VOIDED
 18637        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18638
 18639     IF PB-NEEDS-UNDERWRITING
 18640        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18641
 18642     IF PB-REIN-ONLY-CERT
 18643        MOVE '9'                    TO CM-ENTRY-STATUS.
 18644
 18645     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18646         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18647     ELSE
 18648         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18649
 18650     IF PB-RECORD-RETURNED
 18651        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18652      ELSE
 18653        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18654
 18655     IF PB-I-MAIL-ADDRS-PRESENT
 18656        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18657
 18658     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18659                                       CM-ENTRY-DT.
 18660
 18661 4999-EXIT.
 18662     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 338
* EL050.cbl
 18664
 18665 5000-PROCESS-REPS.
 18666     MOVE ' '                    TO AGTC-MASTER-SW
 18667     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18668     MOVE CO-TYPE                TO AGTC-TYPE
 18669     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18670     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18671     IF (AGTC-MASTER-SW NOT = 'N')
 18672        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18673        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18674        PERFORM 8583-READ-ERAGTC-NEXT
 18675                                 THRU 8583-EXIT
 18676     END-IF
 18677     IF AGTC-MASTER-SW = 'N'
 18678        CONTINUE
 18679     ELSE
 18680        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18681           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18682              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18683              MOVE 'Y'           TO AGTC-MASTER-SW
 18684           END-IF
 18685        END-IF
 18686     END-IF
 18687     .
 18688 5000-EXIT.
 18689     EXIT.
 18690 6370-EDIT-INPUT-LF-CODE.
 18691     move ' ' to ws-benefit-cd-chg-sw
 18692     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18693        MOVE +1                  TO SUB
 18694        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18695        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18696        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18697        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18698        GO TO 6370-SEARCH-LOOP.
 18699
 18700     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18701
 18702     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18703     MOVE SPACES                 TO CNTL-ACCESS.
 18704*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18705     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18706     MOVE +0                     TO CNTL-SEQ-NO.
 18707     MOVE '4' TO RC-SW-2.
 18708     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18709
 18710     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18711        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18712        GO TO 6370-NO-LF-FOUND.
 18713
 18714     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18715     MOVE +1                     TO SUB.
 18716
 18717 6370-SEARCH-LOOP.
 18718     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18719         GO TO 6370-NO-LF-FOUND.
 18720
 18721     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 339
* EL050.cbl
 18722        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18723           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18724           set benefit-code-chg to true
 18725        end-if
 18726        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18727        GO TO 6370-HER-NET-PAY-CHECK.
 18728
 18729     ADD 1   TO SUB.
 18730*    IF SUB GREATER 120
 18731     IF SUB GREATER 200
 18732         GO TO 6370-NO-LF-FOUND.
 18733
 18734     GO TO 6370-SEARCH-LOOP.
 18735
 18736 6370-NO-LF-FOUND.
 18737
 18738     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18739        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18740        set benefit-code-chg to true
 18741     end-if
 18742     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18743
 18744 6370-HER-NET-PAY-CHECK.
 18745
 18746     IF PB-COMPANY-ID = 'CID'
 18747        IF PB-SV-STATE = 'CA' OR 'MN'
 18748           IF PB-I-LF-BENEFIT-CD = '02'
 18749              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18750           ELSE
 18751              IF PB-I-LF-BENEFIT-CD = '04'
 18752                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18753              END-IF
 18754           END-IF
 18755        END-IF
 18756     END-IF
 18757
 18758     IF PB-COMPANY-ID NOT = 'HER'
 18759         GO TO 6370-EXIT.
 18760
 18761     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18762         GO TO 6370-EXIT.
 18763
 18764     IF PB-I-LF-TERM NOT NUMERIC
 18765         MOVE ZEROS              TO PB-I-LF-TERM.
 18766
 18767     IF PB-I-LOAN-TERM NOT NUMERIC
 18768         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18769
 18770     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18771         GO TO 6370-EXIT.
 18772
 18773     IF PB-I-LF-BENEFIT-CD = '33'
 18774         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18775
 18776     IF PB-I-LF-BENEFIT-CD = '34'
 18777         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18778
 18779 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 340
* EL050.cbl
 18780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 341
* EL050.cbl
 18782
 18783 6380-EDIT-INPUT-AH-CODE.
 18784     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18785        MOVE +1                  TO SUB
 18786        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18787        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18788        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18789        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18790        GO TO 6380-SEARCH-LOOP.
 18791
 18792     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18793
 18794     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18795     MOVE SPACES                 TO CNTL-ACCESS.
 18796     MOVE 'A'                    TO CNTL-REC-TYPE.
 18797*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18798     MOVE +0                     TO CNTL-SEQ-NO.
 18799     MOVE '5' TO RC-SW-2.
 18800     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18801
 18802     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18803        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18804        GO TO 6380-NO-AH-FOUND.
 18805
 18806     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18807     MOVE +1 TO SUB.
 18808
 18809 6380-SEARCH-LOOP.
 18810     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18811         GO TO 6380-NO-AH-FOUND.
 18812
 18813     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18814         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18815         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18816
 18817     ADD 1   TO SUB.
 18818     IF SUB GREATER THAN 96
 18819*    IF SUB GREATER THAN 300
 18820         GO TO 6380-NO-AH-FOUND.
 18821
 18822     GO TO 6380-SEARCH-LOOP.
 18823
 18824 6380-NO-AH-FOUND.
 18825
 18826     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18827
 18828     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18829         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18830     ELSE
 18831         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18832
 18833 6380-CSO-AH-ONLY-CHECKS.
 18834
 18835     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18836        NEXT SENTENCE
 18837      ELSE
 18838        GO TO 6380-EXIT.
 18839
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 342
* EL050.cbl
 18840     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18841         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18842
 18843
 18844     GO TO 6380-EXIT
 18845     .
 18846 6380-CSO-LIFE-WITH-AH-CHECKS.
 18847
 18848
 18849     .
 18850 6380-EXIT.
 18851     EXIT.
 18852
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 343
* EL050.cbl
 18854
 18855 6400-COMPUTE-EXTENSION-DAYS.
 18856
 18857******************************************************************
 18858*                                                                *
 18859*                   COMPUTE EXTENSION DAYS                       *
 18860*                                                                *
 18861*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18862*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18863*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18864*    THE EXTENSION DAYS.                                         *
 18865*                                                                *
 18866******************************************************************
 18867
 18868     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18869     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18870
 18871******************************************************************
 18872*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18873*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18874******************************************************************
 18875
 18876     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18877        COMPUTE WS-ODD-DAYS-OVER =
 18878               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18879     ELSE
 18880        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18881
 18882     IF WS-ODD-DAYS-OVER = ZEROS
 18883           GO TO 6499-EXIT
 18884     ELSE
 18885        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18886           IF WS-WDF-MONTH = 02
 18887              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18888              ADD 2       TO  WS-ODD-DAYS-OVER
 18889              GO TO 6499-EXIT
 18890           ELSE
 18891              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18892                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18893                 GO TO 6499-EXIT
 18894               ELSE
 18895                 GO TO 6499-EXIT
 18896        ELSE
 18897           GO TO 6499-EXIT.
 18898
 18899 6412-CHECK-TO-DAY.
 18900
 18901        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18902           IF WS-WDT-DAY = 28
 18903              ADD 2              TO WS-ODD-DAYS-OVER
 18904           ELSE
 18905              IF WS-WDT-DAY = 29
 18906                 ADD 1           TO WS-ODD-DAYS-OVER
 18907              ELSE
 18908                 NEXT SENTENCE
 18909        ELSE
 18910           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18911              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 344
* EL050.cbl
 18912
 18913     GO TO 6499-EXIT.
 18914
 18915
 18916 6415-CHECK-LEAP-YEAR.
 18917
 18918     IF DC-DAYS-IN-MONTH = 29
 18919        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18920
 18921 6415-EXIT.
 18922     EXIT.
 18923
 18924 6499-EXIT.
 18925      EXIT.
 18926
 18927 6500-END.
 18928     EXIT.
 18929
 18930
 18931******************************************************************
 18932************* PROCEDURE DIVISION FOR EL050 ***********************
 18933********************** ELC50PD END *******************************
 18934
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 345
* EL050.cbl
 18936
 18937**START***********************************************************
 18938*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18939*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18940******************************************************************
 18941*
 18942 6600-GET-STATE-MUNICIPAL-TAX.
 18943
 18944     IF PB-COMPANY-ID NOT = 'DMD'
 18945         GO TO 6640-EXIT.
 18946
 18947     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18948     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18949     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18950*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18951*
 18952***  Y2K PROJ 7744
 18953     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18954     SET BIN-TO-GREG          TO TRUE.
 18955     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18956
 18957     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18958
 18959     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18960     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18961
 18962
 18963* EXEC CICS HANDLE CONDITION
 18964*        INVREQ    (6610-START-BROWSE)
 18965*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18966*        NOTFND    (6630-END-OF-FILE)
 18967*    END-EXEC.
 18968*    MOVE '"$8JI                 ! # #00018952' TO DFHEIV0
 18969     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18970     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18971     MOVE X'2320233030303138393532' TO DFHEIV0(25:11)
 18972     CALL 'kxdfhei1' USING DFHEIV0
 18973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18974
 18975
 18976 6610-START-BROWSE.
 18977
 18978
 18979* EXEC CICS HANDLE CONDITION
 18980*        NOTFND    (6630-END-OF-FILE)
 18981*        DISABLED  (6630-ERRESS-PROBLEM)
 18982*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18983*        ENDFILE   (6630-END-OF-FILE)
 18984*    END-EXEC.
 18985*    MOVE '"$IcJ''                ! $ #00018960' TO DFHEIV0
 18986     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18987     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18988     MOVE X'2420233030303138393630' TO DFHEIV0(25:11)
 18989     CALL 'kxdfhei1' USING DFHEIV0
 18990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18991
 18992
 18993
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 346
* EL050.cbl
 18994* EXEC CICS STARTBR
 18995*        DATASET (FILE-ID-ERRESS)
 18996*        RIDFLD  (WS-ERRESS-KEY)
 18997*        GTEQ
 18998*    END-EXEC.
 18999     MOVE 0
 19000       TO DFHEIV11
 19001*    MOVE '&,         G          &   #00018967' TO DFHEIV0
 19002     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19003     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19004     MOVE X'2020233030303138393637' TO DFHEIV0(25:11)
 19005     CALL 'kxdfhei1' USING DFHEIV0,
 19006           FILE-ID-ERRESS,
 19007           WS-ERRESS-KEY,
 19008           DFHEIV99,
 19009           DFHEIV11,
 19010           DFHEIV99
 19011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19012
 19013
 19014 6620-READ-NEXT-ERRESS-MASTER.
 19015
 19016
 19017* EXEC CICS HANDLE CONDITION
 19018*        NOTFND    (6630-END-OF-FILE)
 19019*        ENDFILE   (6630-END-OF-FILE)
 19020*        DISABLED  (6630-ERRESS-PROBLEM)
 19021*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19022*    END-EXEC.
 19023*    MOVE '"$I''cJ                ! % #00018975' TO DFHEIV0
 19024     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19026     MOVE X'2520233030303138393735' TO DFHEIV0(25:11)
 19027     CALL 'kxdfhei1' USING DFHEIV0
 19028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19029
 19030
 19031
 19032* EXEC CICS READNEXT
 19033*        DATASET (FILE-ID-ERRESS)
 19034*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19035*        RIDFLD  (WS-ERRESS-KEY)
 19036*    END-EXEC.
 19037     MOVE LENGTH OF
 19038      RESIDENT-STATE-TAX-MASTER
 19039       TO DFHEIV12
 19040     MOVE 0
 19041       TO DFHEIV11
 19042*    MOVE '&.IL                  )   #00018982' TO DFHEIV0
 19043     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19044     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19045     MOVE X'2020233030303138393832' TO DFHEIV0(25:11)
 19046     CALL 'kxdfhei1' USING DFHEIV0,
 19047           FILE-ID-ERRESS,
 19048           RESIDENT-STATE-TAX-MASTER,
 19049           DFHEIV12,
 19050           WS-ERRESS-KEY,
 19051           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 347
* EL050.cbl
 19052           DFHEIV11,
 19053           DFHEIV99,
 19054           DFHEIV99
 19055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19056
 19057
 19058     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19059
 19060* EXEC CICS ENDBR
 19061*            DATASET (FILE-ID-ERRESS)
 19062*       END-EXEC
 19063     MOVE 0
 19064       TO DFHEIV11
 19065*    MOVE '&2                    $   #00018989' TO DFHEIV0
 19066     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19067     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19068     MOVE X'2020233030303138393839' TO DFHEIV0(25:11)
 19069     CALL 'kxdfhei1' USING DFHEIV0,
 19070           FILE-ID-ERRESS,
 19071           DFHEIV11,
 19072           DFHEIV99
 19073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19074        GO TO 6630-END-OF-FILE.
 19075
 19076     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19077        NEXT SENTENCE
 19078      ELSE
 19079        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19080
 19081*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19082*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19083*
 19084     MOVE +2                     TO WS-SUB1.
 19085
 19086     IF PB-ISSUE
 19087     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19088        MOVE +1                  TO WS-SUB1.
 19089
 19090     IF PB-CANCELLATION
 19091     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19092        MOVE +1                  TO WS-SUB1.
 19093*
 19094*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19095*
 19096***  Y2K PROJ 7744
 19097     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19098***  Y2K PROJ 7744
 19099
 19100*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19101* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19102* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19103
 19104     ADD 1                    TO WS-YEAR-YY.
 19105
 19106     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19107         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19108                              TO WS-RES-STATE-TAX
 19109         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 348
* EL050.cbl
 19110                              TO WS-RES-MUNI-TAX
 19111     ELSE
 19112         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19113                              TO WS-RES-STATE-TAX
 19114         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19115                              TO WS-RES-MUNI-TAX.
 19116
 19117*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19118
 19119     IF PB-CANCELLATION
 19120         GO TO 6640-CANCEL-TAX.
 19121
 19122     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19123         COMPUTE PB-I-STATE-TAX ROUNDED =
 19124                                   PB-I-LF-PREMIUM-AMT
 19125                                 * WS-RES-STATE-TAX
 19126         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19127                                   PB-I-LF-PREMIUM-AMT
 19128                                 * WS-RES-MUNI-TAX
 19129     ELSE
 19130     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19131         COMPUTE PB-I-STATE-TAX ROUNDED =
 19132                                   PB-I-AH-PREMIUM-AMT
 19133                                 * WS-RES-STATE-TAX
 19134         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19135                                   PB-I-AH-PREMIUM-AMT
 19136                                 * WS-RES-MUNI-TAX.
 19137
 19138
 19139* EXEC CICS ENDBR
 19140*         DATASET (FILE-ID-ERRESS)
 19141*    END-EXEC.
 19142     MOVE 0
 19143       TO DFHEIV11
 19144*    MOVE '&2                    $   #00019056' TO DFHEIV0
 19145     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19146     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19147     MOVE X'2020233030303139303536' TO DFHEIV0(25:11)
 19148     CALL 'kxdfhei1' USING DFHEIV0,
 19149           FILE-ID-ERRESS,
 19150           DFHEIV11,
 19151           DFHEIV99
 19152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19153
 19154
 19155     GO TO 6640-EXIT.
 19156
 19157 6640-CANCEL-TAX.
 19158     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19159
 19160     IF PB-C-LF-CANCEL-AMT > ZEROS
 19161         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19162                                   PB-C-LF-CANCEL-AMT
 19163                                 * WS-RES-STATE-TAX
 19164         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19165                                   PB-C-LF-CANCEL-AMT
 19166                                *  WS-RES-MUNI-TAX
 19167     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 349
* EL050.cbl
 19168     IF PB-C-AH-CANCEL-AMT > ZEROS
 19169         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19170                                   PB-C-AH-CANCEL-AMT
 19171                                 * WS-RES-STATE-TAX
 19172         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19173                                   PB-C-AH-CANCEL-AMT
 19174                                *  WS-RES-MUNI-TAX.
 19175
 19176
 19177* EXEC CICS ENDBR
 19178*         DATASET (FILE-ID-ERRESS)
 19179*    END-EXEC.
 19180     MOVE 0
 19181       TO DFHEIV11
 19182*    MOVE '&2                    $   #00019081' TO DFHEIV0
 19183     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19184     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19185     MOVE X'2020233030303139303831' TO DFHEIV0(25:11)
 19186     CALL 'kxdfhei1' USING DFHEIV0,
 19187           FILE-ID-ERRESS,
 19188           DFHEIV11,
 19189           DFHEIV99
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19191
 19192
 19193     GO TO 6640-EXIT.
 19194
 19195 6630-END-OF-FILE.
 19196     MOVE ER-8002              TO WS-ERROR.
 19197     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19198
 19199     GO TO 6640-EXIT.
 19200
 19201 6630-ERRESS-PROBLEM.
 19202     MOVE ER-8044              TO WS-ERROR.
 19203     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19204
 19205 6640-EXIT.
 19206     EXIT.
 19207
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 350
* EL050.cbl
 19209 6650-GET-RES-STATE-COMM.
 19210
 19211     IF PB-COMPANY-ID NOT = 'DMD'
 19212         GO TO 6700-COMM-EXIT.
 19213
 19214     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19215     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19216     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19217     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19218     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19219     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19220     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19221
 19222*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19223*
 19224***  Y2K PROJ 7744
 19225     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19226     SET BIN-TO-GREG          TO TRUE.
 19227     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19228
 19229     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19230***  Y2K PROJ 7744
 19231
 19232     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19233
 19234
 19235* EXEC CICS HANDLE CONDITION
 19236*        INVREQ    (6660-START-BROWSE)
 19237*        DISABLED  (6690-ERRESC-PROBLEM)
 19238*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19239*        NOTFND    (6690-END-OF-FILE)
 19240*    END-EXEC.
 19241*    MOVE '"$8cJI                ! & #00019126' TO DFHEIV0
 19242     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19244     MOVE X'2620233030303139313236' TO DFHEIV0(25:11)
 19245     CALL 'kxdfhei1' USING DFHEIV0
 19246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19247
 19248
 19249
 19250* EXEC CICS RESETBR
 19251*        DATASET (FILE-ID-ERRESC)
 19252*        RIDFLD  (WS-ERRESC-KEY)
 19253*    END-EXEC.
 19254     MOVE 0
 19255       TO DFHEIV11
 19256*    MOVE '&4         G          &   #00019133' TO DFHEIV0
 19257     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303139313333' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           FILE-ID-ERRESC,
 19262           WS-ERRESC-KEY,
 19263           DFHEIV99,
 19264           DFHEIV11,
 19265           DFHEIV99
 19266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 351
* EL050.cbl
 19267
 19268
 19269 6660-START-BROWSE.
 19270
 19271
 19272* EXEC CICS HANDLE CONDITION
 19273*        NOTFND    (6690-END-OF-FILE)
 19274*        DISABLED  (6690-ERRESC-PROBLEM)
 19275*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19276*        ENDFILE   (6690-END-OF-FILE)
 19277*    END-EXEC.
 19278*    MOVE '"$IcJ''                ! '' #00019140' TO DFHEIV0
 19279     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19281     MOVE X'2720233030303139313430' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286
 19287* EXEC CICS STARTBR
 19288*        DATASET (FILE-ID-ERRESC)
 19289*        RIDFLD  (WS-ERRESC-KEY)
 19290*        GTEQ
 19291*    END-EXEC.
 19292     MOVE 0
 19293       TO DFHEIV11
 19294*    MOVE '&,         G          &   #00019147' TO DFHEIV0
 19295     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19296     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19297     MOVE X'2020233030303139313437' TO DFHEIV0(25:11)
 19298     CALL 'kxdfhei1' USING DFHEIV0,
 19299           FILE-ID-ERRESC,
 19300           WS-ERRESC-KEY,
 19301           DFHEIV99,
 19302           DFHEIV11,
 19303           DFHEIV99
 19304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19305
 19306
 19307     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19308
 19309 6670-READ-NEXT-ERRESC-MASTER.
 19310
 19311
 19312* EXEC CICS HANDLE CONDITION
 19313*        NOTFND    (6690-END-OF-FILE)
 19314*        DISABLED  (6690-ERRESC-PROBLEM)
 19315*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19316*        ENDFILE   (6690-END-OF-FILE)
 19317*    END-EXEC.
 19318*    MOVE '"$IcJ''                ! ( #00019157' TO DFHEIV0
 19319     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19320     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19321     MOVE X'2820233030303139313537' TO DFHEIV0(25:11)
 19322     CALL 'kxdfhei1' USING DFHEIV0
 19323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19324
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 352
* EL050.cbl
 19325
 19326
 19327* EXEC CICS READNEXT
 19328*        DATASET (FILE-ID-ERRESC)
 19329*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19330*        RIDFLD  (ERRESC-RECORD-KEY)
 19331*    END-EXEC.
 19332     MOVE LENGTH OF
 19333      ACCOUNT-RESIDENT-ST-COMMISSION
 19334       TO DFHEIV12
 19335     MOVE 0
 19336       TO DFHEIV11
 19337*    MOVE '&.IL                  )   #00019164' TO DFHEIV0
 19338     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19339     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19340     MOVE X'2020233030303139313634' TO DFHEIV0(25:11)
 19341     CALL 'kxdfhei1' USING DFHEIV0,
 19342           FILE-ID-ERRESC,
 19343           ACCOUNT-RESIDENT-ST-COMMISSION,
 19344           DFHEIV12,
 19345           ERRESC-RECORD-KEY,
 19346           DFHEIV99,
 19347           DFHEIV11,
 19348           DFHEIV99,
 19349           DFHEIV99
 19350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19351
 19352
 19353     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19354        NEXT SENTENCE
 19355     ELSE
 19356
 19357* EXEC CICS ENDBR
 19358*            DATASET (FILE-ID-ERRESC)
 19359*       END-EXEC
 19360     MOVE 0
 19361       TO DFHEIV11
 19362*    MOVE '&2                    $   #00019173' TO DFHEIV0
 19363     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19365     MOVE X'2020233030303139313733' TO DFHEIV0(25:11)
 19366     CALL 'kxdfhei1' USING DFHEIV0,
 19367           FILE-ID-ERRESC,
 19368           DFHEIV11,
 19369           DFHEIV99
 19370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19371        GO TO 6690-END-OF-FILE.
 19372
 19373     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19374
 19375* EXEC CICS ENDBR
 19376*            DATASET (FILE-ID-ERRESC)
 19377*       END-EXEC
 19378     MOVE 0
 19379       TO DFHEIV11
 19380*    MOVE '&2                    $   #00019179' TO DFHEIV0
 19381     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19382     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 353
* EL050.cbl
 19383     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 19384     CALL 'kxdfhei1' USING DFHEIV0,
 19385           FILE-ID-ERRESC,
 19386           DFHEIV11,
 19387           DFHEIV99
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19389        GO TO 6690-END-OF-FILE.
 19390
 19391     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19392        NEXT SENTENCE
 19393      ELSE
 19394        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19395
 19396* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19397*
 19398     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19399
 19400     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19401
 19402     IF WS-SUB1 > ZERO
 19403         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19404             PERFORM 6680-SET-COMMISSION
 19405         ELSE
 19406             PERFORM 6680-SET-TABLE-CODE.
 19407
 19408
 19409* EXEC CICS ENDBR
 19410*         DATASET (FILE-ID-ERRESC)
 19411*    END-EXEC.
 19412     MOVE 0
 19413       TO DFHEIV11
 19414*    MOVE '&2                    $   #00019201' TO DFHEIV0
 19415     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19416     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19417     MOVE X'2020233030303139323031' TO DFHEIV0(25:11)
 19418     CALL 'kxdfhei1' USING DFHEIV0,
 19419           FILE-ID-ERRESC,
 19420           DFHEIV11,
 19421           DFHEIV99
 19422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19423
 19424
 19425     GO TO 6700-COMM-EXIT.
 19426
 19427 6680-SET-TABLE-CODE.
 19428     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19429        MOVE ZEROS             TO WS-SUB1
 19430     ELSE
 19431* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19432* TO COMPUTE AH COMMISSION.
 19433        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19434        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19435        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19436        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19437        PERFORM 6680-READ-CTBL-TABLE
 19438        IF WS-CTBL-READ-SW NOT = 'Y'
 19439           MOVE ZEROS          TO WS-SUB1.
 19440
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 354
* EL050.cbl
 19441 6680-READ-CTBL-TABLE.
 19442*
 19443* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19444* TO COMPUTE LIFE COMMISSION
 19445
 19446     IF CTBL-SW = '0540'
 19447        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19448        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19449        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19450
 19451     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19452
 19453     IF CTBL-TABLE-FOUND
 19454        IF CTBL-SW = '0530'
 19455             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19456                                    * PB-I-AH-TERM
 19457             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19458             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19459        ELSE
 19460             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19461             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19462             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19463     ELSE
 19464        IF FIRST-TIME-THROUGH
 19465            GO TO 6680-READ-CTBL-TABLE
 19466        ELSE
 19467            MOVE ZEROS         TO WS-SUB1.
 19468
 19469 6680-SET-COMMISSION.
 19470     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19471           MOVE ZEROS          TO WS-SUB1
 19472       ELSE
 19473           MOVE RESC-COMMISSION-PER (WS-SUB)
 19474                               TO WS-COMMISSION
 19475           IF CTBL-SW = '0530'
 19476               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19477           ELSE
 19478               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19479
 19480 6680-SEARCH-CATEGORY.
 19481     ADD +1                   TO WS-SUB.
 19482     IF WS-SUB > +12
 19483         GO TO 6680-EXIT.
 19484
 19485     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19486          MOVE WS-SUB         TO WS-SUB1
 19487          GO TO 6680-EXIT.
 19488
 19489     GO TO 6680-SEARCH-CATEGORY.
 19490
 19491 6680-EXIT.
 19492     EXIT.
 19493
 19494 6690-END-OF-FILE.
 19495     GO TO 6700-COMM-EXIT.
 19496
 19497 6690-ERRESC-PROBLEM.
 19498      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 355
* EL050.cbl
 19499      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19500
 19501      GO TO 6700-COMM-EXIT.
 19502
 19503 6700-COMM-EXIT.
 19504     EXIT.
 19505
 19506 7000-GET-RATE.
 19507
 19508* EXEC CICS LINK
 19509*        PROGRAM    ('ELRATE')
 19510*        COMMAREA   (CALCULATION-PASS-AREA)
 19511*        LENGTH     (CP-COMM-LENGTH)
 19512*    END-EXEC.
 19513     MOVE 'ELRATE' TO DFHEIV1
 19514*    MOVE '."C                   (   #00019287' TO DFHEIV0
 19515     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19517     MOVE X'2020233030303139323837' TO DFHEIV0(25:11)
 19518     CALL 'kxdfhei1' USING DFHEIV0,
 19519           DFHEIV1,
 19520           CALCULATION-PASS-AREA,
 19521           CP-COMM-LENGTH,
 19522           DFHEIV99,
 19523           DFHEIV99,
 19524           DFHEIV99,
 19525           DFHEIV99
 19526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19527
 19528
 19529 7000-EXIT.
 19530     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 356
* EL050.cbl
 19532 7100-FIND-BENEFIT-IN-STATE.
 19533     MOVE 'N'                    TO BEN-SEARCH-SW.
 19534
 19535     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19536         VARYING SUB3 FROM 1 BY 1 UNTIL
 19537            ((SUB3 GREATER 50) OR
 19538              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19539               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19540
 19541     IF SUB3 NOT = 51
 19542         MOVE 'Y'                TO BEN-SEARCH-SW.
 19543
 19544     GO TO 7199-EXIT.
 19545
 19546 7100-BENEFIT-DUMMY.
 19547
 19548 7100-DUMMY-EXIT.
 19549     EXIT.
 19550
 19551 7199-EXIT.
 19552     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 357
* EL050.cbl
 19554 7200-FIND-BENEFIT.
 19555     MOVE 'N'                    TO BEN-SEARCH-SW.
 19556
 19557     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19558         VARYING SUB3 FROM 1 BY 1 UNTIL
 19559            ((SUB3 GREATER 8) OR
 19560            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19561
 19562     IF SUB3 NOT = 9
 19563         MOVE 'Y'                TO BEN-SEARCH-SW.
 19564
 19565     GO TO 7200-EXIT.
 19566
 19567 7200-BENEFIT-DUMMY.
 19568
 19569 7200-DUMMY-EXIT.
 19570     EXIT.
 19571
 19572 7200-EXIT.
 19573     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 358
* EL050.cbl
 19575 7250-LOOK-FOR-RESCINDED-CLAIM.
 19576     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19577                                    W-CL-COMP-CD.
 19578     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19579                                    W-CL-CERT-NO.
 19580
 19581
 19582* EXEC CICS HANDLE CONDITION
 19583*        NOTFND  (7250-CONTINUE)
 19584*        ENDFILE (7250-CONTINUE)
 19585*    END-EXEC.
 19586*    MOVE '"$I''                  ! ) #00019345' TO DFHEIV0
 19587     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19589     MOVE X'2920233030303139333435' TO DFHEIV0(25:11)
 19590     CALL 'kxdfhei1' USING DFHEIV0
 19591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19592
 19593
 19594
 19595* EXEC CICS IGNORE CONDITION
 19596*        DUPKEY
 19597*    END-EXEC.
 19598*    MOVE '"*$                   !   #00019350' TO DFHEIV0
 19599     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19601     MOVE X'2020233030303139333530' TO DFHEIV0(25:11)
 19602     CALL 'kxdfhei1' USING DFHEIV0
 19603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19604
 19605
 19606
 19607* EXEC CICS STARTBR
 19608*        DATASET   (CLMS-ID)
 19609*        RIDFLD    (ELMSTR-KEY)
 19610*        GENERIC   EQUAL
 19611*        KEYLENGTH (ELMSTR-LENGTH)
 19612*    END-EXEC.
 19613     MOVE 0
 19614       TO DFHEIV11
 19615*    MOVE '&,   KG    E          &   #00019354' TO DFHEIV0
 19616     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19617     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19618     MOVE X'2020233030303139333534' TO DFHEIV0(25:11)
 19619     CALL 'kxdfhei1' USING DFHEIV0,
 19620           CLMS-ID,
 19621           ELMSTR-KEY,
 19622           ELMSTR-LENGTH,
 19623           DFHEIV11,
 19624           DFHEIV99
 19625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19626
 19627
 19628     MOVE 'Y'                    TO W-BROWSE-SW.
 19629
 19630 7250-NEXT-CLAIM.
 19631
 19632
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 359
* EL050.cbl
 19633* EXEC CICS READNEXT
 19634*        DATASET   (CLMS-ID)
 19635*        RIDFLD    (ELMSTR-KEY)
 19636*        SET       (ADDRESS OF CLAIM-MASTER)
 19637*    END-EXEC.
 19638     MOVE 0
 19639       TO DFHEIV11
 19640*    MOVE '&.S                   )   #00019365' TO DFHEIV0
 19641     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19642     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19643     MOVE X'2020233030303139333635' TO DFHEIV0(25:11)
 19644     CALL 'kxdfhei1' USING DFHEIV0,
 19645           CLMS-ID,
 19646           DFHEIV20,
 19647           DFHEIV99,
 19648           ELMSTR-KEY,
 19649           DFHEIV99,
 19650           DFHEIV11,
 19651           DFHEIV99,
 19652           DFHEIV99
 19653     SET ADDRESS OF CLAIM-MASTER TO
 19654         DFHEIV20
 19655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19656
 19657
 19658     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19659        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19660         GO TO 7250-CONTINUE
 19661     END-IF.
 19662
 19663     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19664        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19665        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19666        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19667        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19668         GO TO 7250-NEXT-CLAIM
 19669     END-IF.
 19670
 19671     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19672        OR (CL-CLAIM-TYPE = 'I')
 19673        OR (CL-CLAIM-TYPE = 'G')
 19674        OR (CL-CLAIM-TYPE = 'F')
 19675          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19676              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19677              GO TO 7250-CONTINUE
 19678          END-IF
 19679     END-IF.
 19680
 19681     GO TO 7250-NEXT-CLAIM.
 19682
 19683 7250-CONTINUE.
 19684
 19685     IF W-BROWSE-SW = 'Y'
 19686
 19687* EXEC CICS ENDBR
 19688*            DATASET   (CLMS-ID)
 19689*        END-EXEC
 19690     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 360
* EL050.cbl
 19691       TO DFHEIV11
 19692*    MOVE '&2                    $   #00019399' TO DFHEIV0
 19693     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19694     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19695     MOVE X'2020233030303139333939' TO DFHEIV0(25:11)
 19696     CALL 'kxdfhei1' USING DFHEIV0,
 19697           CLMS-ID,
 19698           DFHEIV11,
 19699           DFHEIV99
 19700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19701         MOVE 'N' TO W-BROWSE-SW
 19702     END-IF.
 19703
 19704 7250-EXIT.
 19705     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 361
* EL050.cbl
 19707 7300-CHECK-FOR-OPEN-CLMS.
 19708
 19709*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19710*    MOVE SPACES                 TO CNTL-ACCESS.
 19711*    MOVE '1'                    TO CNTL-REC-TYPE.
 19712*    MOVE +0                     TO CNTL-SEQ-NO.
 19713
 19714*    MOVE '3'                    TO RC-SW-1.
 19715*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19716
 19717*    IF NOT CF-COMPANY-MASTER
 19718*         PERFORM 0099-COMPANY-NOT-FOUND
 19719*         GO TO 7300-EXIT.
 19720
 19721     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19722                                    W-CL-COMP-CD.
 19723     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19724                                    W-CL-CERT-NO.
 19725
 19726
 19727* EXEC CICS HANDLE CONDITION
 19728*        NOTFND  (7300-CONTINUE)
 19729*        ENDFILE (7300-CONTINUE)
 19730*    END-EXEC.
 19731*    MOVE '"$I''                  ! * #00019427' TO DFHEIV0
 19732     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19734     MOVE X'2A20233030303139343237' TO DFHEIV0(25:11)
 19735     CALL 'kxdfhei1' USING DFHEIV0
 19736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19737
 19738
 19739
 19740* EXEC CICS IGNORE CONDITION
 19741*        DUPKEY
 19742*    END-EXEC.
 19743*    MOVE '"*$                   !   #00019432' TO DFHEIV0
 19744     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19746     MOVE X'2020233030303139343332' TO DFHEIV0(25:11)
 19747     CALL 'kxdfhei1' USING DFHEIV0
 19748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19749
 19750
 19751
 19752* EXEC CICS STARTBR
 19753*        DATASET   (CLMS-ID)
 19754*        RIDFLD    (ELMSTR-KEY)
 19755*        GENERIC   EQUAL
 19756*        KEYLENGTH (ELMSTR-LENGTH)
 19757*    END-EXEC.
 19758     MOVE 0
 19759       TO DFHEIV11
 19760*    MOVE '&,   KG    E          &   #00019436' TO DFHEIV0
 19761     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19762     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19763     MOVE X'2020233030303139343336' TO DFHEIV0(25:11)
 19764     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 362
* EL050.cbl
 19765           CLMS-ID,
 19766           ELMSTR-KEY,
 19767           ELMSTR-LENGTH,
 19768           DFHEIV11,
 19769           DFHEIV99
 19770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19771
 19772
 19773     MOVE 'Y'                    TO W-BROWSE-SW.
 19774
 19775 7300-NEXT-CLAIM.
 19776
 19777
 19778* EXEC CICS READNEXT
 19779*        DATASET   (CLMS-ID)
 19780*        RIDFLD    (ELMSTR-KEY)
 19781*        SET       (ADDRESS OF CLAIM-MASTER)
 19782*    END-EXEC.
 19783     MOVE 0
 19784       TO DFHEIV11
 19785*    MOVE '&.S                   )   #00019447' TO DFHEIV0
 19786     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19787     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19788     MOVE X'2020233030303139343437' TO DFHEIV0(25:11)
 19789     CALL 'kxdfhei1' USING DFHEIV0,
 19790           CLMS-ID,
 19791           DFHEIV20,
 19792           DFHEIV99,
 19793           ELMSTR-KEY,
 19794           DFHEIV99,
 19795           DFHEIV11,
 19796           DFHEIV99,
 19797           DFHEIV99
 19798     SET ADDRESS OF CLAIM-MASTER TO
 19799         DFHEIV20
 19800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19801
 19802
 19803     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19804        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19805         GO TO 7300-CONTINUE.
 19806
 19807     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19808        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19809        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19810        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19811        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19812         GO TO 7300-NEXT-CLAIM.
 19813
 19814*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19815     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19816        OR (CL-CLAIM-TYPE = 'I')
 19817        OR (CL-CLAIM-TYPE = 'G')
 19818        OR (CL-CLAIM-TYPE = 'F')
 19819        IF CLAIM-IS-OPEN
 19820           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19821             AND PB-C-AH-CANCEL-DT > SPACES
 19822              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 363
* EL050.cbl
 19823              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19824           END-IF
 19825           EVALUATE TRUE
 19826             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19827                 MOVE ER-2884      TO WS-ERROR
 19828             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19829                 MOVE ER-2887      TO WS-ERROR
 19830             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19831                 MOVE ER-2886      TO WS-ERROR
 19832             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19833                 MOVE ER-2888      TO WS-ERROR
 19834             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19835                 MOVE ER-2885      TO WS-ERROR
 19836             WHEN OTHER
 19837                 MOVE ER-2768      TO WS-ERROR
 19838           END-EVALUATE
 19839           IF PB-C-AH-CANCEL-VOIDED OR
 19840              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19841                NOT AH-COVERAGE-CANCELLED)
 19842               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19843               MOVE ER-2768      TO WS-ERROR
 19844           END-IF
 19845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19846           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19847              PB-FORCE-CODE NOT EQUAL '8'
 19848               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19849           END-IF
 19850           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19851           GO TO 7300-NEXT-CLAIM
 19852        ELSE
 19853           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19854*****THIS IS A RESCISSION OR REFORMATION
 19855              IF AH-COVERAGE-CANCELLED
 19856                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19857                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19858                    MOVE 1                   TO DC-ELAPSED-DAYS
 19859                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19860                    SET BIN-PLUS-ELAPSED     TO TRUE
 19861                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19862                    IF NO-CONVERSION-ERROR
 19863                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19864                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19865                          MOVE ER-2897 TO WS-ERROR
 19866                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19867                          GO TO 7300-NEXT-CLAIM
 19868                       END-IF
 19869                    END-IF
 19870                 ELSE
 19871                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19872                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19873                         MOVE ER-2890 TO WS-ERROR
 19874                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19875                         GO TO 7300-NEXT-CLAIM
 19876                      ELSE
 19877                         MOVE ER-2898 TO WS-ERROR
 19878                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19879                         GO TO 7300-NEXT-CLAIM
 19880                      END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 364
* EL050.cbl
 19881                   END-IF
 19882                 END-IF
 19883              END-IF
 19884           ELSE
 19885              IF CL-DENIAL-TYPE = '1'  AND
 19886                 CL-TOTAL-PAID-AMT = 0
 19887                    GO TO 7300-NEXT-CLAIM
 19888              END-IF
 19889              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19890               AND PB-C-AH-CANCEL-DT > SPACES
 19891                 MOVE ER-2756        TO WS-ERROR
 19892                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19893                 GO TO 7300-NEXT-CLAIM
 19894              END-IF
 19895           END-IF
 19896        END-IF
 19897     ELSE
 19898*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19899        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19900           IF (CLAIM-IS-OPEN)
 19901              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19902                 <> zeros
 19903              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19904                 <> zeros)
 19905              MOVE ER-2889      TO WS-ERROR
 19906              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19907              GO TO 7300-NEXT-CLAIM
 19908           ELSE
 19909              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19910*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19911                 IF (LF-COVERAGE-CANCELLED AND
 19912                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19913                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19914                         MOVE ER-2890 TO WS-ERROR
 19915                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19916                         GO TO 7300-NEXT-CLAIM
 19917                      ELSE
 19918                         MOVE ER-2898 TO WS-ERROR
 19919                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19920                         GO TO 7300-NEXT-CLAIM
 19921                      END-IF
 19922                 END-IF
 19923              ELSE
 19924                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19925                    and (CL-TOTAL-PAID-AMT = 0)
 19926                    GO TO 7300-NEXT-CLAIM
 19927                 END-IF
 19928                 IF (
 19929                      (AH-COVERAGE-CANCELLED)
 19930                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19931                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19932                      and (pb-ci-ah-cancel-amt +
 19933                         pb-c-ah-cancel-amt) <> zeros
 19934                    )
 19935                               OR
 19936                    (
 19937                      (LF-COVERAGE-CANCELLED)
 19938                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 365
* EL050.cbl
 19939                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19940                      and (pb-ci-lf-cancel-amt +
 19941                         pb-c-lf-cancel-amt) <> zeros
 19942                    )
 19943                       MOVE ER-2965 TO WS-ERROR
 19944                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19945                       GO TO 7300-NEXT-CLAIM
 19946                 END-IF
 19947                 IF LF-COVERAGE-CANCELLED
 19948                  IF CL-TOTAL-PAID-AMT > 0
 19949                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19950                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19951                        MOVE ER-2891 TO WS-ERROR
 19952                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19953                        GO TO 7300-NEXT-CLAIM
 19954                      END-IF
 19955                    ELSE
 19956****only show this error if cert num matches exactly
 19957                      IF PB-CERT-NO = CL-CERT-NO
 19958                         MOVE ER-2892 TO WS-ERROR
 19959                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19960                         GO TO 7300-NEXT-CLAIM
 19961                      END-IF
 19962                    END-IF
 19963                  END-IF
 19964                 END-IF
 19965              END-IF
 19966           END-IF
 19967        END-IF
 19968     END-IF
 19969
 19970     GO TO 7300-NEXT-CLAIM.
 19971
 19972 7300-CONTINUE.
 19973
 19974     IF W-BROWSE-SW = 'Y'
 19975
 19976* EXEC CICS ENDBR
 19977*            DATASET   (CLMS-ID)
 19978*        END-EXEC.
 19979     MOVE 0
 19980       TO DFHEIV11
 19981*    MOVE '&2                    $   #00019625' TO DFHEIV0
 19982     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19983     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19984     MOVE X'2020233030303139363235' TO DFHEIV0(25:11)
 19985     CALL 'kxdfhei1' USING DFHEIV0,
 19986           CLMS-ID,
 19987           DFHEIV11,
 19988           DFHEIV99
 19989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19990
 19991
 19992 7300-EXIT.
 19993     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 366
* EL050.cbl
 19995
 19996 7400-GET-REMAIN-TERM.
 19997
 19998* EXEC CICS LINK
 19999*        PROGRAM    ('ELRTRM')
 20000*        COMMAREA   (CALCULATION-PASS-AREA)
 20001*        LENGTH     (CP-COMM-LENGTH)
 20002*    END-EXEC.
 20003     MOVE 'ELRTRM' TO DFHEIV1
 20004*    MOVE '."C                   (   #00019634' TO DFHEIV0
 20005     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20006     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20007     MOVE X'2020233030303139363334' TO DFHEIV0(25:11)
 20008     CALL 'kxdfhei1' USING DFHEIV0,
 20009           DFHEIV1,
 20010           CALCULATION-PASS-AREA,
 20011           CP-COMM-LENGTH,
 20012           DFHEIV99,
 20013           DFHEIV99,
 20014           DFHEIV99,
 20015           DFHEIV99
 20016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20017
 20018
 20019 7400-EXIT.
 20020     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 367
* EL050.cbl
 20022
 20023 7500-GET-REMAIN-AMOUNT.
 20024
 20025* EXEC CICS LINK
 20026*        PROGRAM    ('ELRAMT')
 20027*        COMMAREA   (CALCULATION-PASS-AREA)
 20028*        LENGTH     (CP-COMM-LENGTH)
 20029*    END-EXEC.
 20030     MOVE 'ELRAMT' TO DFHEIV1
 20031*    MOVE '."C                   (   #00019645' TO DFHEIV0
 20032     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20034     MOVE X'2020233030303139363435' TO DFHEIV0(25:11)
 20035     CALL 'kxdfhei1' USING DFHEIV0,
 20036           DFHEIV1,
 20037           CALCULATION-PASS-AREA,
 20038           CP-COMM-LENGTH,
 20039           DFHEIV99,
 20040           DFHEIV99,
 20041           DFHEIV99,
 20042           DFHEIV99
 20043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20044
 20045
 20046 7500-EXIT.
 20047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 368
* EL050.cbl
 20049
 20050 7600-GET-REFUND.
 20051
 20052* EXEC CICS LINK
 20053*        PROGRAM    ('ELRFND')
 20054*        COMMAREA   (CALCULATION-PASS-AREA)
 20055*        LENGTH     (CP-COMM-LENGTH)
 20056*    END-EXEC.
 20057     MOVE 'ELRFND' TO DFHEIV1
 20058*    MOVE '."C                   (   #00019656' TO DFHEIV0
 20059     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20061     MOVE X'2020233030303139363536' TO DFHEIV0(25:11)
 20062     CALL 'kxdfhei1' USING DFHEIV0,
 20063           DFHEIV1,
 20064           CALCULATION-PASS-AREA,
 20065           CP-COMM-LENGTH,
 20066           DFHEIV99,
 20067           DFHEIV99,
 20068           DFHEIV99,
 20069           DFHEIV99
 20070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20071
 20072
 20073 7600-EXIT.
 20074     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 369
* EL050.cbl
 20076 7700-CALL-DL1.
 20077
 20078* EXEC CICS LINK
 20079*        PROGRAM    ('DLO001')
 20080*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20081*        LENGTH     (DLO001-COMM-LENGTH)
 20082*    END-EXEC.
 20083     MOVE 'DLO001' TO DFHEIV1
 20084*    MOVE '."C                   (   #00019666' TO DFHEIV0
 20085     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20087     MOVE X'2020233030303139363636' TO DFHEIV0(25:11)
 20088     CALL 'kxdfhei1' USING DFHEIV0,
 20089           DFHEIV1,
 20090           WS-DLO-MASTER-POLICY-FORM,
 20091           DLO001-COMM-LENGTH,
 20092           DFHEIV99,
 20093           DFHEIV99,
 20094           DFHEIV99,
 20095           DFHEIV99
 20096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20097
 20098
 20099 7700-EXIT.
 20100     EXIT.
 20101
 20102 7710-CALL-DL2.
 20103
 20104* EXEC CICS LINK
 20105*        PROGRAM    ('DLO002')
 20106*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20107*        LENGTH     (DLO002-COMM-LENGTH)
 20108*    END-EXEC.
 20109     MOVE 'DLO002' TO DFHEIV1
 20110*    MOVE '."C                   (   #00019676' TO DFHEIV0
 20111     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20113     MOVE X'2020233030303139363736' TO DFHEIV0(25:11)
 20114     CALL 'kxdfhei1' USING DFHEIV0,
 20115           DFHEIV1,
 20116           WS-DLO-INTERNAL-POLICY-FORM,
 20117           DLO002-COMM-LENGTH,
 20118           DFHEIV99,
 20119           DFHEIV99,
 20120           DFHEIV99,
 20121           DFHEIV99
 20122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20123
 20124
 20125 7710-EXIT.
 20126     EXIT.
 20127
 20128 7720-CALL-DL3.
 20129
 20130* EXEC CICS LINK
 20131*        PROGRAM    ('DLO003')
 20132*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20133*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 370
* EL050.cbl
 20134*    END-EXEC.
 20135     MOVE 'DLO003' TO DFHEIV1
 20136*    MOVE '."C                   (   #00019686' TO DFHEIV0
 20137     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20139     MOVE X'2020233030303139363836' TO DFHEIV0(25:11)
 20140     CALL 'kxdfhei1' USING DFHEIV0,
 20141           DFHEIV1,
 20142           WS-DLO-VALID-BANK-ID,
 20143           DLO003-COMM-LENGTH,
 20144           DFHEIV99,
 20145           DFHEIV99,
 20146           DFHEIV99,
 20147           DFHEIV99
 20148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20149
 20150
 20151 7720-EXIT.
 20152     EXIT.
 20153
 20154 7730-CALL-DL7.
 20155
 20156* EXEC CICS LINK
 20157*        PROGRAM    ('DLO007')
 20158*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20159*        LENGTH     (DLO007-COMM-LENGTH)
 20160*    END-EXEC.
 20161     MOVE 'DLO007' TO DFHEIV1
 20162*    MOVE '."C                   (   #00019696' TO DFHEIV0
 20163     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20165     MOVE X'2020233030303139363936' TO DFHEIV0(25:11)
 20166     CALL 'kxdfhei1' USING DFHEIV0,
 20167           DFHEIV1,
 20168           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20169           DLO007-COMM-LENGTH,
 20170           DFHEIV99,
 20171           DFHEIV99,
 20172           DFHEIV99,
 20173           DFHEIV99
 20174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20175
 20176
 20177 7730-EXIT.
 20178     EXIT.
 20179
 20180 7740-CALL-DL11.
 20181
 20182* EXEC CICS LINK
 20183*        PROGRAM    ('DLO011')
 20184*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20185*        LENGTH     (DLO011-COMM-LENGTH)
 20186*    END-EXEC.
 20187     MOVE 'DLO011' TO DFHEIV1
 20188*    MOVE '."C                   (   #00019706' TO DFHEIV0
 20189     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20191     MOVE X'2020233030303139373036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 371
* EL050.cbl
 20192     CALL 'kxdfhei1' USING DFHEIV0,
 20193           DFHEIV1,
 20194           WS-DLO-PREM-RATES-BEN-TYPE,
 20195           DLO011-COMM-LENGTH,
 20196           DFHEIV99,
 20197           DFHEIV99,
 20198           DFHEIV99,
 20199           DFHEIV99
 20200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20201
 20202
 20203 7740-EXIT.
 20204     EXIT.
 20205
 20206 7750-CALL-DL17.
 20207
 20208* EXEC CICS LINK
 20209*        PROGRAM    ('DLO017')
 20210*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20211*        LENGTH     (DLO017-COMM-LENGTH)
 20212*    END-EXEC.
 20213     MOVE 'DLO017' TO DFHEIV1
 20214*    MOVE '."C                   (   #00019716' TO DFHEIV0
 20215     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20217     MOVE X'2020233030303139373136' TO DFHEIV0(25:11)
 20218     CALL 'kxdfhei1' USING DFHEIV0,
 20219           DFHEIV1,
 20220           WS-DLO-VALID-RATE-CODE,
 20221           DLO017-COMM-LENGTH,
 20222           DFHEIV99,
 20223           DFHEIV99,
 20224           DFHEIV99,
 20225           DFHEIV99
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228
 20229 7750-EXIT.
 20230     EXIT.
 20231
 20232 7755-CALL-DL19.
 20233
 20234* EXEC CICS LINK
 20235*        PROGRAM    ('DLO019')
 20236*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20237*        LENGTH     (DLO019-COMM-LENGTH)
 20238*    END-EXEC.
 20239     MOVE 'DLO019' TO DFHEIV1
 20240*    MOVE '."C                   (   #00019726' TO DFHEIV0
 20241     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20243     MOVE X'2020233030303139373236' TO DFHEIV0(25:11)
 20244     CALL 'kxdfhei1' USING DFHEIV0,
 20245           DFHEIV1,
 20246           WS-DLO-ORIG-COV-CAT,
 20247           DLO019-COMM-LENGTH,
 20248           DFHEIV99,
 20249           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 372
* EL050.cbl
 20250           DFHEIV99,
 20251           DFHEIV99
 20252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20253
 20254
 20255 7755-EXIT.
 20256     EXIT.
 20257
 20258 7760-CALL-DL21.
 20259
 20260* EXEC CICS LINK
 20261*        PROGRAM    ('DLO021')
 20262*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20263*        LENGTH     (DLO021-COMM-LENGTH)
 20264*    END-EXEC.
 20265     MOVE 'DLO021' TO DFHEIV1
 20266*    MOVE '."C                   (   #00019736' TO DFHEIV0
 20267     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20269     MOVE X'2020233030303139373336' TO DFHEIV0(25:11)
 20270     CALL 'kxdfhei1' USING DFHEIV0,
 20271           DFHEIV1,
 20272           WS-DLO-VALID-LOAN-OFFICER,
 20273           DLO021-COMM-LENGTH,
 20274           DFHEIV99,
 20275           DFHEIV99,
 20276           DFHEIV99,
 20277           DFHEIV99
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20279
 20280
 20281 7760-EXIT.
 20282     EXIT.
 20283
 20284 7770-CALL-DL22.
 20285
 20286* EXEC CICS LINK
 20287*        PROGRAM    ('DLO022')
 20288*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20289*        LENGTH     (DLO022-COMM-LENGTH)
 20290*    END-EXEC.
 20291     MOVE 'DLO022' TO DFHEIV1
 20292*    MOVE '."C                   (   #00019746' TO DFHEIV0
 20293     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20295     MOVE X'2020233030303139373436' TO DFHEIV0(25:11)
 20296     CALL 'kxdfhei1' USING DFHEIV0,
 20297           DFHEIV1,
 20298           WS-DLO-VALID-STATE-CODE,
 20299           DLO022-COMM-LENGTH,
 20300           DFHEIV99,
 20301           DFHEIV99,
 20302           DFHEIV99,
 20303           DFHEIV99
 20304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20305
 20306
 20307 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 373
* EL050.cbl
 20308     EXIT.
 20309
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 374
* EL050.cbl
 20311
 20312 7780-CALL-AGG.
 20313
 20314* EXEC CICS LINK
 20315*        PROGRAM    ('ELAGGO')
 20316*        COMMAREA   (WS-PASS-to-pemaggo)
 20317*        LENGTH     (ws-passed-key-LENGTH)
 20318*    END-EXEC.
 20319     MOVE 'ELAGGO' TO DFHEIV1
 20320*    MOVE '."C                   (   #00019758' TO DFHEIV0
 20321     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20323     MOVE X'2020233030303139373538' TO DFHEIV0(25:11)
 20324     CALL 'kxdfhei1' USING DFHEIV0,
 20325           DFHEIV1,
 20326           WS-PASS-to-pemaggo,
 20327           ws-passed-key-LENGTH,
 20328           DFHEIV99,
 20329           DFHEIV99,
 20330           DFHEIV99,
 20331           DFHEIV99
 20332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20333
 20334 7780-EXIT.
 20335     EXIT.
 20336 7785-CALL-HLDI.
 20337
 20338* EXEC CICS LINK
 20339*        PROGRAM    ('ELHLDI')
 20340*        COMMAREA   (HLDI-PASS-AREA)
 20341*        LENGTH     (HLDI-PASS-AREA-LEN)
 20342*    END-EXEC.
 20343     MOVE 'ELHLDI' TO DFHEIV1
 20344*    MOVE '."C                   (   #00019766' TO DFHEIV0
 20345     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20347     MOVE X'2020233030303139373636' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           DFHEIV1,
 20350           HLDI-PASS-AREA,
 20351           HLDI-PASS-AREA-LEN,
 20352           DFHEIV99,
 20353           DFHEIV99,
 20354           DFHEIV99,
 20355           DFHEIV99
 20356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20357
 20358 7785-EXIT.
 20359     EXIT.
 20360 7786-CALL-HLDIM.
 20361
 20362* EXEC CICS LINK
 20363*        PROGRAM    ('ELHLDIM')
 20364*        COMMAREA   (HLDI-PASS-AREA)
 20365*        LENGTH     (HLDI-PASS-AREA-LEN)
 20366*    END-EXEC.
 20367     MOVE 'ELHLDIM' TO DFHEIV1
 20368*    MOVE '."C                   (   #00019774' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 375
* EL050.cbl
 20369     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20371     MOVE X'2020233030303139373734' TO DFHEIV0(25:11)
 20372     CALL 'kxdfhei1' USING DFHEIV0,
 20373           DFHEIV1,
 20374           HLDI-PASS-AREA,
 20375           HLDI-PASS-AREA-LEN,
 20376           DFHEIV99,
 20377           DFHEIV99,
 20378           DFHEIV99,
 20379           DFHEIV99
 20380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20381
 20382 7786-EXIT.
 20383     EXIT.
 20384 7790-CALL-ZIP-VERIFY.
 20385
 20386
 20387* EXEC CICS LINK
 20388*        PROGRAM    ('WSZIPCD')
 20389*        COMMAREA   (ZIPCD-PASS-AREA)
 20390*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20391*    END-EXEC.
 20392     MOVE 'WSZIPCD' TO DFHEIV1
 20393*    MOVE '."C                   (   #00019783' TO DFHEIV0
 20394     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20396     MOVE X'2020233030303139373833' TO DFHEIV0(25:11)
 20397     CALL 'kxdfhei1' USING DFHEIV0,
 20398           DFHEIV1,
 20399           ZIPCD-PASS-AREA,
 20400           ZIPCD-PASS-AREA-LEN,
 20401           DFHEIV99,
 20402           DFHEIV99,
 20403           DFHEIV99,
 20404           DFHEIV99
 20405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20406
 20407
 20408 7790-EXIT.
 20409     EXIT.
 20410 7800-REWRITE-CERT.
 20411******************************************************************
 20412*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20413*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20414******************************************************************
 20415
 20416     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20417        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20418        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20419        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20420
 20421* EXEC CICS REWRITE
 20422*                  DATASET (CERT-ID)
 20423*                  FROM    (CERTIFICATE-MASTER)
 20424*              END-EXEC
 20425     MOVE LENGTH OF
 20426      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 376
* EL050.cbl
 20427       TO DFHEIV11
 20428*    MOVE '&& L                  %   #00019801' TO DFHEIV0
 20429     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20430     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20431     MOVE X'2020233030303139383031' TO DFHEIV0(25:11)
 20432     CALL 'kxdfhei1' USING DFHEIV0,
 20433           CERT-ID,
 20434           CERTIFICATE-MASTER,
 20435           DFHEIV11,
 20436           DFHEIV99
 20437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20438        GO TO 7800-EXIT.
 20439
 20440       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20441       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20442
 20443 7800-EXIT.
 20444      EXIT.
 20445
 20446 7900-DELETE-CERT.
 20447
 20448* EXEC CICS DELETE
 20449*        DATASET (CERT-ID)
 20450*    END-EXEC.
 20451*    MOVE '&(                    &   #00019814' TO DFHEIV0
 20452     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20454     MOVE X'2020233030303139383134' TO DFHEIV0(25:11)
 20455     CALL 'kxdfhei1' USING DFHEIV0,
 20456           CERT-ID,
 20457           DFHEIV99,
 20458           DFHEIV99,
 20459           DFHEIV99,
 20460           DFHEIV99
 20461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20462
 20463
 20464 7900-EXIT.
 20465     EXIT.
 20466
 20467 8000-WRITE-CERT.
 20468
 20469* EXEC CICS HANDLE CONDITION
 20470*        DUPKEY    (8000-FREE-MAIN)
 20471*    END-EXEC.
 20472*    MOVE '"$$                   ! + #00019822' TO DFHEIV0
 20473     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20475     MOVE X'2B20233030303139383232' TO DFHEIV0(25:11)
 20476     CALL 'kxdfhei1' USING DFHEIV0
 20477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20478
 20479
 20480
 20481* EXEC CICS WRITE
 20482*        DATASET     (CERT-ID)
 20483*        FROM        (CERTIFICATE-MASTER)
 20484*        RIDFLD      (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 377
* EL050.cbl
 20485*    END-EXEC.
 20486     MOVE LENGTH OF
 20487      CERTIFICATE-MASTER
 20488       TO DFHEIV11
 20489*    MOVE '&$ L                  ''   #00019826' TO DFHEIV0
 20490     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20491     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20492     MOVE X'2020233030303139383236' TO DFHEIV0(25:11)
 20493     CALL 'kxdfhei1' USING DFHEIV0,
 20494           CERT-ID,
 20495           CERTIFICATE-MASTER,
 20496           DFHEIV11,
 20497           ELCERT-KEY,
 20498           DFHEIV99,
 20499           DFHEIV99
 20500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20501
 20502
 20503 8000-FREE-MAIN.
 20504
 20505 8000-EXIT.
 20506      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 378
* EL050.cbl
 20508
 20509 8100-READ-ERPNDM.
 20510
 20511* EXEC CICS HANDLE CONDITION
 20512*         NOTFND     (8100-NOTFND)
 20513*         ENDFILE    (8100-NOTFND)
 20514*    END-EXEC.
 20515*    MOVE '"$I''                  ! , #00019839' TO DFHEIV0
 20516     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20518     MOVE X'2C20233030303139383339' TO DFHEIV0(25:11)
 20519     CALL 'kxdfhei1' USING DFHEIV0
 20520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20521
 20522
 20523     MOVE SPACES                 TO ERPNDM-FOUND.
 20524     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20525
 20526
 20527* EXEC CICS READ UPDATE
 20528*         DATASET   (FILE-ERPNDM)
 20529*         RIDFLD    (PM-CONTROL-PRIMARY)
 20530*         INTO      (PENDING-MAILING-DATA)
 20531*    END-EXEC.
 20532     MOVE LENGTH OF
 20533      PENDING-MAILING-DATA
 20534       TO DFHEIV11
 20535*    MOVE '&"IL       EU         (   #00019847' TO DFHEIV0
 20536     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20537     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20538     MOVE X'2020233030303139383437' TO DFHEIV0(25:11)
 20539     CALL 'kxdfhei1' USING DFHEIV0,
 20540           FILE-ERPNDM,
 20541           PENDING-MAILING-DATA,
 20542           DFHEIV11,
 20543           PM-CONTROL-PRIMARY,
 20544           DFHEIV99,
 20545           DFHEIV99,
 20546           DFHEIV99
 20547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20548
 20549
 20550     GO TO 8100-EXIT.
 20551
 20552 8100-NOTFND.
 20553
 20554     MOVE 'X'                    TO ERPNDM-FOUND.
 20555     MOVE ER-2694                TO WS-ERROR.
 20556     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20557     MOVE ER-2883                TO WS-ERROR
 20558     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20559     .
 20560 8100-EXIT.
 20561     EXIT.
 20562 8102-REWRITE-ERPNDM.
 20563
 20564
 20565* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 379
* EL050.cbl
 20566*         DATASET    (FILE-ERPNDM)
 20567*         FROM       (PENDING-MAILING-DATA)
 20568*    END-EXEC
 20569     MOVE LENGTH OF
 20570      PENDING-MAILING-DATA
 20571       TO DFHEIV11
 20572*    MOVE '&& L                  %   #00019867' TO DFHEIV0
 20573     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20574     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20575     MOVE X'2020233030303139383637' TO DFHEIV0(25:11)
 20576     CALL 'kxdfhei1' USING DFHEIV0,
 20577           FILE-ERPNDM,
 20578           PENDING-MAILING-DATA,
 20579           DFHEIV11,
 20580           DFHEIV99
 20581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20582
 20583     .
 20584 8102-EXIT.
 20585     EXIT.
 20586 8104-UNLOCK-ERPNDM.
 20587
 20588
 20589* EXEC CICS UNLOCK
 20590*         DATASET   (FILE-ERPNDM)
 20591*    END-EXEC
 20592*    MOVE '&*                    #   #00019877' TO DFHEIV0
 20593     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20594     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20595     MOVE X'2020233030303139383737' TO DFHEIV0(25:11)
 20596     CALL 'kxdfhei1' USING DFHEIV0,
 20597           FILE-ERPNDM,
 20598           DFHEIV99
 20599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20600
 20601     .
 20602 8104-EXIT.
 20603     EXIT.
 20604 8110-READ-ERMAIL.
 20605
 20606* EXEC CICS HANDLE CONDITION
 20607*         NOTFND     (8110-NOTFND)
 20608*         ENDFILE    (8110-NOTFND)
 20609*    END-EXEC.
 20610*    MOVE '"$I''                  ! - #00019885' TO DFHEIV0
 20611     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20613     MOVE X'2D20233030303139383835' TO DFHEIV0(25:11)
 20614     CALL 'kxdfhei1' USING DFHEIV0
 20615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20616
 20617
 20618     MOVE SPACES                 TO ERMAIL-FOUND.
 20619     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20620     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20621     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20622     MOVE PB-SV-STATE            TO MA-STATE.
 20623
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 380
* EL050.cbl
 20624
 20625* EXEC CICS READ
 20626*         UPDATE
 20627*         DATASET   (FILE-ERMAIL)
 20628*         RIDFLD    (MA-CONTROL-PRIMARY)
 20629*         INTO      (MAILING-DATA)
 20630*    END-EXEC.
 20631     MOVE LENGTH OF
 20632      MAILING-DATA
 20633       TO DFHEIV11
 20634*    MOVE '&"IL       EU         (   #00019896' TO DFHEIV0
 20635     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20636     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20637     MOVE X'2020233030303139383936' TO DFHEIV0(25:11)
 20638     CALL 'kxdfhei1' USING DFHEIV0,
 20639           FILE-ERMAIL,
 20640           MAILING-DATA,
 20641           DFHEIV11,
 20642           MA-CONTROL-PRIMARY,
 20643           DFHEIV99,
 20644           DFHEIV99,
 20645           DFHEIV99
 20646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20647
 20648
 20649     GO TO 8110-EXIT.
 20650
 20651 8110-NOTFND.
 20652     MOVE 'X'                    TO ERMAIL-FOUND.
 20653
 20654 8110-EXIT.
 20655     EXIT.
 20656
 20657 8120-REWRITE-ERMAIL.
 20658
 20659* EXEC CICS REWRITE
 20660*         DATASET    (FILE-ERMAIL)
 20661*         FROM       (MAILING-DATA)
 20662*    END-EXEC.
 20663     MOVE LENGTH OF
 20664      MAILING-DATA
 20665       TO DFHEIV11
 20666*    MOVE '&& L                  %   #00019912' TO DFHEIV0
 20667     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20668     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20669     MOVE X'2020233030303139393132' TO DFHEIV0(25:11)
 20670     CALL 'kxdfhei1' USING DFHEIV0,
 20671           FILE-ERMAIL,
 20672           MAILING-DATA,
 20673           DFHEIV11,
 20674           DFHEIV99
 20675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20676
 20677
 20678 8120-EXIT.
 20679     EXIT.
 20680
 20681 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 381
* EL050.cbl
 20682
 20683* EXEC CICS HANDLE CONDITION
 20684*         DUPKEY   (8130-EXIT)
 20685*    END-EXEC.
 20686*    MOVE '"$$                   ! . #00019921' TO DFHEIV0
 20687     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20688     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20689     MOVE X'2E20233030303139393231' TO DFHEIV0(25:11)
 20690     CALL 'kxdfhei1' USING DFHEIV0
 20691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20692
 20693
 20694
 20695* EXEC CICS WRITE
 20696*         DATASET     (FILE-ERMAIL)
 20697*         RIDFLD      (MA-CONTROL-PRIMARY)
 20698*         FROM        (MAILING-DATA)
 20699*    END-EXEC.
 20700     MOVE LENGTH OF
 20701      MAILING-DATA
 20702       TO DFHEIV11
 20703*    MOVE '&$ L                  ''   #00019925' TO DFHEIV0
 20704     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20706     MOVE X'2020233030303139393235' TO DFHEIV0(25:11)
 20707     CALL 'kxdfhei1' USING DFHEIV0,
 20708           FILE-ERMAIL,
 20709           MAILING-DATA,
 20710           DFHEIV11,
 20711           MA-CONTROL-PRIMARY,
 20712           DFHEIV99,
 20713           DFHEIV99
 20714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20715
 20716
 20717 8130-EXIT.
 20718     EXIT.
 20719
 20720 8140-UNLOCK-ERMAIL.
 20721
 20722* EXEC CICS UNLOCK
 20723*         DATASET   (FILE-ERMAIL)
 20724*    END-EXEC.
 20725*    MOVE '&*                    #   #00019935' TO DFHEIV0
 20726     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20727     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20728     MOVE X'2020233030303139393335' TO DFHEIV0(25:11)
 20729     CALL 'kxdfhei1' USING DFHEIV0,
 20730           FILE-ERMAIL,
 20731           DFHEIV99
 20732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20733
 20734
 20735 8140-EXIT.
 20736     EXIT.
 20737
 20738 8150-read-elcrtt.
 20739
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 382
* EL050.cbl
 20740
 20741* EXEC CICS HANDLE CONDITION
 20742*        NOTFND   (8150-exit)
 20743*    END-EXEC
 20744*    MOVE '"$I                   ! / #00019944' TO DFHEIV0
 20745     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20746     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20747     MOVE X'2F20233030303139393434' TO DFHEIV0(25:11)
 20748     CALL 'kxdfhei1' USING DFHEIV0
 20749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20750
 20751     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20752     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20753
 20754
 20755* EXEC CICS READ
 20756*        DATASET  (CRTT-ID)
 20757*        RIDFLD   (WS-ELCRTT-KEY)
 20758*        INTO     (CERTIFICATE-TRAILERS)
 20759*    END-EXEC
 20760     MOVE LENGTH OF
 20761      CERTIFICATE-TRAILERS
 20762       TO DFHEIV11
 20763*    MOVE '&"IL       E          (   #00019951' TO DFHEIV0
 20764     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20766     MOVE X'2020233030303139393531' TO DFHEIV0(25:11)
 20767     CALL 'kxdfhei1' USING DFHEIV0,
 20768           CRTT-ID,
 20769           CERTIFICATE-TRAILERS,
 20770           DFHEIV11,
 20771           WS-ELCRTT-KEY,
 20772           DFHEIV99,
 20773           DFHEIV99,
 20774           DFHEIV99
 20775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20776
 20777     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20778     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20779     move cs-vehicle-odometer    to ws-vehicle-odometer
 20780
 20781     .
 20782 8150-exit.
 20783     exit.
 20784 8180-UPDATE-VIN-NUMBER.
 20785
 20786* EXEC CICS HANDLE CONDITION
 20787*        NOTFND   (8180-NOTFND)
 20788*    END-EXEC.
 20789*    MOVE '"$I                   ! 0 #00019965' TO DFHEIV0
 20790     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20792     MOVE X'3020233030303139393635' TO DFHEIV0(25:11)
 20793     CALL 'kxdfhei1' USING DFHEIV0
 20794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20795
 20796
 20797     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 383
* EL050.cbl
 20798     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20799
 20800
 20801* EXEC CICS READ
 20802*        UPDATE
 20803*        DATASET  (CRTT-ID)
 20804*        RIDFLD   (WS-ELCRTT-KEY)
 20805*        INTO     (CERTIFICATE-TRAILERS)
 20806*    END-EXEC.
 20807     MOVE LENGTH OF
 20808      CERTIFICATE-TRAILERS
 20809       TO DFHEIV11
 20810*    MOVE '&"IL       EU         (   #00019972' TO DFHEIV0
 20811     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20812     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20813     MOVE X'2020233030303139393732' TO DFHEIV0(25:11)
 20814     CALL 'kxdfhei1' USING DFHEIV0,
 20815           CRTT-ID,
 20816           CERTIFICATE-TRAILERS,
 20817           DFHEIV11,
 20818           WS-ELCRTT-KEY,
 20819           DFHEIV99,
 20820           DFHEIV99,
 20821           DFHEIV99
 20822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20823
 20824
 20825     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20826        or (hldi-pass-area not = spaces)
 20827        move pa-modelyear        to cs-year
 20828        move pa-makename         to cs-make
 20829        move pa-modelname        to cs-model
 20830        move pa-seriesname       to cs-future
 20831        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20832
 20833* EXEC CICS REWRITE
 20834*           DATASET  (CRTT-ID)
 20835*           FROM     (CERTIFICATE-TRAILERS)
 20836*        END-EXEC
 20837     MOVE LENGTH OF
 20838      CERTIFICATE-TRAILERS
 20839       TO DFHEIV11
 20840*    MOVE '&& L                  %   #00019986' TO DFHEIV0
 20841     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20842     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20843     MOVE X'2020233030303139393836' TO DFHEIV0(25:11)
 20844     CALL 'kxdfhei1' USING DFHEIV0,
 20845           CRTT-ID,
 20846           CERTIFICATE-TRAILERS,
 20847           DFHEIV11,
 20848           DFHEIV99
 20849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20850     ELSE
 20851
 20852* EXEC CICS UNLOCK
 20853*          DATASET  (CRTT-ID)
 20854*       END-EXEC
 20855*    MOVE '&*                    #   #00019991' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 384
* EL050.cbl
 20856     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20857     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20858     MOVE X'2020233030303139393931' TO DFHEIV0(25:11)
 20859     CALL 'kxdfhei1' USING DFHEIV0,
 20860           CRTT-ID,
 20861           DFHEIV99
 20862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20863     END-IF.
 20864
 20865     GO TO 8180-EXIT.
 20866
 20867 8180-NOTFND.
 20868
 20869     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20870     MOVE 'CS'         TO CS-RECORD-ID.
 20871     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20872     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20873     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20874     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20875
 20876* EXEC CICS WRITE
 20877*       DATASET  (CRTT-ID)
 20878*       RIDFLD   (WS-ELCRTT-KEY)
 20879*       FROM     (CERTIFICATE-TRAILERS)
 20880*    END-EXEC.
 20881     MOVE LENGTH OF
 20882      CERTIFICATE-TRAILERS
 20883       TO DFHEIV11
 20884*    MOVE '&$ L                  ''   #00020006' TO DFHEIV0
 20885     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20887     MOVE X'2020233030303230303036' TO DFHEIV0(25:11)
 20888     CALL 'kxdfhei1' USING DFHEIV0,
 20889           CRTT-ID,
 20890           CERTIFICATE-TRAILERS,
 20891           DFHEIV11,
 20892           WS-ELCRTT-KEY,
 20893           DFHEIV99,
 20894           DFHEIV99
 20895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20896
 20897
 20898 8180-EXIT.
 20899     EXIT.
 20900
 20901 8190-UPDATE-REFUND-CLAIM-FLAG.
 20902
 20903* EXEC CICS HANDLE CONDITION
 20904*        NOTFND   (8190-NOTFND)
 20905*    END-EXEC.
 20906*    MOVE '"$I                   ! 1 #00020016' TO DFHEIV0
 20907     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20909     MOVE X'3120233030303230303136' TO DFHEIV0(25:11)
 20910     CALL 'kxdfhei1' USING DFHEIV0
 20911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20912
 20913
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 385
* EL050.cbl
 20914     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20915     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20916
 20917
 20918* EXEC CICS READ
 20919*        UPDATE
 20920*        DATASET  (CRTT-ID)
 20921*        RIDFLD   (WS-ELCRTT-KEY)
 20922*        INTO     (CERTIFICATE-TRAILERS)
 20923*    END-EXEC.
 20924     MOVE LENGTH OF
 20925      CERTIFICATE-TRAILERS
 20926       TO DFHEIV11
 20927*    MOVE '&"IL       EU         (   #00020023' TO DFHEIV0
 20928     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20929     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20930     MOVE X'2020233030303230303233' TO DFHEIV0(25:11)
 20931     CALL 'kxdfhei1' USING DFHEIV0,
 20932           CRTT-ID,
 20933           CERTIFICATE-TRAILERS,
 20934           DFHEIV11,
 20935           WS-ELCRTT-KEY,
 20936           DFHEIV99,
 20937           DFHEIV99,
 20938           DFHEIV99
 20939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20940
 20941
 20942     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20943
 20944* EXEC CICS REWRITE
 20945*       DATASET  (CRTT-ID)
 20946*       FROM     (CERTIFICATE-TRAILERS)
 20947*    END-EXEC.
 20948     MOVE LENGTH OF
 20949      CERTIFICATE-TRAILERS
 20950       TO DFHEIV11
 20951*    MOVE '&& L                  %   #00020031' TO DFHEIV0
 20952     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20953     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20954     MOVE X'2020233030303230303331' TO DFHEIV0(25:11)
 20955     CALL 'kxdfhei1' USING DFHEIV0,
 20956           CRTT-ID,
 20957           CERTIFICATE-TRAILERS,
 20958           DFHEIV11,
 20959           DFHEIV99
 20960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20961
 20962
 20963     GO TO 8190-EXIT.
 20964
 20965 8190-NOTFND.
 20966
 20967     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20968     MOVE 'CS'         TO CS-RECORD-ID.
 20969     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20970     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20971     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 386
* EL050.cbl
 20972     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20973
 20974* EXEC CICS WRITE
 20975*       DATASET  (CRTT-ID)
 20976*       RIDFLD   (WS-ELCRTT-KEY)
 20977*       FROM     (CERTIFICATE-TRAILERS)
 20978*    END-EXEC.
 20979     MOVE LENGTH OF
 20980      CERTIFICATE-TRAILERS
 20981       TO DFHEIV11
 20982*    MOVE '&$ L                  ''   #00020046' TO DFHEIV0
 20983     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20985     MOVE X'2020233030303230303436' TO DFHEIV0(25:11)
 20986     CALL 'kxdfhei1' USING DFHEIV0,
 20987           CRTT-ID,
 20988           CERTIFICATE-TRAILERS,
 20989           DFHEIV11,
 20990           WS-ELCRTT-KEY,
 20991           DFHEIV99,
 20992           DFHEIV99
 20993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20994
 20995
 20996 8190-EXIT.
 20997     EXIT.
 20998
 20999 8195-UPDATE-AGE-FLAGS.
 21000
 21001* EXEC CICS HANDLE CONDITION
 21002*        NOTFND   (8195-NOTFND)
 21003*    END-EXEC.
 21004*    MOVE '"$I                   ! 2 #00020056' TO DFHEIV0
 21005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21007     MOVE X'3220233030303230303536' TO DFHEIV0(25:11)
 21008     CALL 'kxdfhei1' USING DFHEIV0
 21009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21010
 21011
 21012     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21013     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21014
 21015
 21016* EXEC CICS READ
 21017*        UPDATE
 21018*        DATASET  (CRTT-ID)
 21019*        RIDFLD   (WS-ELCRTT-KEY)
 21020*        INTO     (CERTIFICATE-TRAILERS)
 21021*    END-EXEC.
 21022     MOVE LENGTH OF
 21023      CERTIFICATE-TRAILERS
 21024       TO DFHEIV11
 21025*    MOVE '&"IL       EU         (   #00020063' TO DFHEIV0
 21026     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21027     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21028     MOVE X'2020233030303230303633' TO DFHEIV0(25:11)
 21029     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 387
* EL050.cbl
 21030           CRTT-ID,
 21031           CERTIFICATE-TRAILERS,
 21032           DFHEIV11,
 21033           WS-ELCRTT-KEY,
 21034           DFHEIV99,
 21035           DFHEIV99,
 21036           DFHEIV99
 21037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21038
 21039
 21040     IF WS-INS-AGE-SET = 'Y'
 21041        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21042     END-IF
 21043     IF WS-JNT-AGE-SET = 'Y'
 21044        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21045     END-IF
 21046
 21047
 21048* EXEC CICS REWRITE
 21049*       DATASET  (CRTT-ID)
 21050*       FROM     (CERTIFICATE-TRAILERS)
 21051*    END-EXEC.
 21052     MOVE LENGTH OF
 21053      CERTIFICATE-TRAILERS
 21054       TO DFHEIV11
 21055*    MOVE '&& L                  %   #00020077' TO DFHEIV0
 21056     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21057     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21058     MOVE X'2020233030303230303737' TO DFHEIV0(25:11)
 21059     CALL 'kxdfhei1' USING DFHEIV0,
 21060           CRTT-ID,
 21061           CERTIFICATE-TRAILERS,
 21062           DFHEIV11,
 21063           DFHEIV99
 21064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21065
 21066
 21067     GO TO 8195-EXIT.
 21068
 21069 8195-NOTFND.
 21070
 21071     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21072     MOVE 'CS'         TO CS-RECORD-ID.
 21073     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21074     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21075     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21076     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21077     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21078
 21079* EXEC CICS WRITE
 21080*       DATASET  (CRTT-ID)
 21081*       RIDFLD   (WS-ELCRTT-KEY)
 21082*       FROM     (CERTIFICATE-TRAILERS)
 21083*    END-EXEC.
 21084     MOVE LENGTH OF
 21085      CERTIFICATE-TRAILERS
 21086       TO DFHEIV11
 21087*    MOVE '&$ L                  ''   #00020093' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 388
* EL050.cbl
 21088     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21089     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21090     MOVE X'2020233030303230303933' TO DFHEIV0(25:11)
 21091     CALL 'kxdfhei1' USING DFHEIV0,
 21092           CRTT-ID,
 21093           CERTIFICATE-TRAILERS,
 21094           DFHEIV11,
 21095           WS-ELCRTT-KEY,
 21096           DFHEIV99,
 21097           DFHEIV99
 21098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21099
 21100
 21101 8195-EXIT.
 21102     EXIT.
 21103
 21104 8200-READ-REIN-TABLE.
 21105
 21106* EXEC CICS HANDLE CONDITION
 21107*         NOTFND   (8200-NOTFND)
 21108*    END-EXEC.
 21109*    MOVE '"$I                   ! 3 #00020103' TO DFHEIV0
 21110     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21112     MOVE X'3320233030303230313033' TO DFHEIV0(25:11)
 21113     CALL 'kxdfhei1' USING DFHEIV0
 21114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21115
 21116
 21117
 21118* EXEC CICS READ
 21119*        DATASET     (REIN-ID)
 21120*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21121*        RIDFLD      (ERREIN-KEY)
 21122*    END-EXEC.
 21123*    MOVE '&"S        E          (   #00020107' TO DFHEIV0
 21124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21126     MOVE X'2020233030303230313037' TO DFHEIV0(25:11)
 21127     CALL 'kxdfhei1' USING DFHEIV0,
 21128           REIN-ID,
 21129           DFHEIV20,
 21130           DFHEIV99,
 21131           ERREIN-KEY,
 21132           DFHEIV99,
 21133           DFHEIV99,
 21134           DFHEIV99
 21135     SET ADDRESS OF REINSURANCE-RECORD TO
 21136         DFHEIV20
 21137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21138
 21139
 21140     GO TO 8200-EXIT.
 21141
 21142 8200-NOTFND.
 21143     MOVE 'N'             TO WS-REIN-READ-SW.
 21144
 21145 8200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 389
* EL050.cbl
 21146      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 390
* EL050.cbl
 21148
 21149 8300-READ-CTBL-TABLE.
 21150
 21151* EXEC CICS HANDLE CONDITION
 21152*        NOTFND    (8300-NOTFND)
 21153*        DISABLED  (8300-ERRESS-PROBLEM)
 21154*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21155*        ENDFILE   (8300-NOTFND)
 21156*    END-EXEC.
 21157*    MOVE '"$IcJ''                ! 4 #00020123' TO DFHEIV0
 21158     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21160     MOVE X'3420233030303230313233' TO DFHEIV0(25:11)
 21161     CALL 'kxdfhei1' USING DFHEIV0
 21162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21163
 21164
 21165
 21166* EXEC CICS READ
 21167*        DATASET     (CTBL-ID)
 21168*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21169*        RIDFLD      (ERCTBL-KEY)
 21170*    END-EXEC.
 21171*    MOVE '&"S        E          (   #00020130' TO DFHEIV0
 21172     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21174     MOVE X'2020233030303230313330' TO DFHEIV0(25:11)
 21175     CALL 'kxdfhei1' USING DFHEIV0,
 21176           CTBL-ID,
 21177           DFHEIV20,
 21178           DFHEIV99,
 21179           ERCTBL-KEY,
 21180           DFHEIV99,
 21181           DFHEIV99,
 21182           DFHEIV99
 21183     SET ADDRESS OF COMM-TABLE-RECORD TO
 21184         DFHEIV20
 21185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21186
 21187
 21188     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21189
 21190     GO TO 8300-EXIT.
 21191
 21192 8300-NOTFND.
 21193
 21194     IF CTBL-SW = '0530'
 21195         MOVE 'AA'                     TO WS-AH-COMP-CD
 21196         MOVE '0550'                   TO CTBL-SW
 21197         MOVE '1'                      TO WS-CTBL-READ-SW
 21198         GO TO 8300-EXIT.
 21199
 21200     IF CTBL-SW = '0540'
 21201         MOVE 'AA'                     TO WS-LF-COMP-CD
 21202         MOVE '0550'                   TO CTBL-SW
 21203         MOVE '1'                      TO WS-CTBL-READ-SW
 21204         GO TO 8300-EXIT.
 21205
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 391
* EL050.cbl
 21206     IF CTBL-SW = '0550'
 21207         MOVE '2'                      TO WS-CTBL-READ-SW
 21208         GO TO 8300-EXIT.
 21209
 21210     GO TO 8300-EXIT.
 21211
 21212 8300-ERRESS-PROBLEM.
 21213
 21214      MOVE ER-8050              TO WS-ERROR.
 21215      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21216
 21217     GO TO 8300-EXIT.
 21218
 21219 8300-EXIT.
 21220      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 392
* EL050.cbl
 21222
 21223
 21224 8400-GETMAIN-ERFORM.
 21225
 21226
 21227* EXEC CICS   GETMAIN
 21228*        LENGTH  (500)
 21229*        SET     (ADDRESS OF FORM-MASTER)
 21230*    END-EXEC.
 21231     MOVE 500
 21232       TO DFHEIV11
 21233*    MOVE '," L                  $   #00020174' TO DFHEIV0
 21234     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21235     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21236     MOVE X'2020233030303230313734' TO DFHEIV0(25:11)
 21237     CALL 'kxdfhei1' USING DFHEIV0,
 21238           DFHEIV20,
 21239           DFHEIV11,
 21240           DFHEIV99
 21241     SET ADDRESS OF FORM-MASTER TO
 21242         DFHEIV20
 21243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21244
 21245
 21246     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21247
 21248 8400-EXIT.
 21249      EXIT.
 21250
 21251 8450-READ-FORM-MASTER.
 21252
 21253
 21254* EXEC CICS  HANDLE CONDITION
 21255*        NOTFND   (8450-FORM-NOT-FOUND)
 21256*        ENDFILE  (8450-FORM-NOT-FOUND)
 21257*    END-EXEC.
 21258*    MOVE '"$I''                  ! 5 #00020186' TO DFHEIV0
 21259     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21261     MOVE X'3520233030303230313836' TO DFHEIV0(25:11)
 21262     CALL 'kxdfhei1' USING DFHEIV0
 21263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21264
 21265
 21266
 21267* EXEC CICS   READ
 21268*        DATASET   (FORM-ID)
 21269*        RIDFLD    (ERFORM-KEY)
 21270*        INTO      (FORM-MASTER)
 21271*        GTEQ
 21272*    END-EXEC.
 21273     MOVE LENGTH OF
 21274      FORM-MASTER
 21275       TO DFHEIV11
 21276*    MOVE '&"IL       G          (   #00020191' TO DFHEIV0
 21277     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21278     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21279     MOVE X'2020233030303230313931' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 393
* EL050.cbl
 21280     CALL 'kxdfhei1' USING DFHEIV0,
 21281           FORM-ID,
 21282           FORM-MASTER,
 21283           DFHEIV11,
 21284           ERFORM-KEY,
 21285           DFHEIV99,
 21286           DFHEIV99,
 21287           DFHEIV99
 21288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21289
 21290
 21291     MOVE  'Y'           TO  FORM-MASTER-SW.
 21292
 21293     GO TO  8450-EXIT.
 21294
 21295 8450-FORM-NOT-FOUND.
 21296
 21297     MOVE  'N'           TO  FORM-MASTER-SW.
 21298
 21299 8450-EXIT.
 21300      EXIT.
 21301
 21302 8500-DATE-CONVERT.
 21303
 21304* EXEC CICS LINK
 21305*        PROGRAM    ('ELDATCV')
 21306*        COMMAREA   (DATE-CONVERSION-DATA)
 21307*        LENGTH     (DC-COMM-LENGTH)
 21308*    END-EXEC.
 21309     MOVE 'ELDATCV' TO DFHEIV1
 21310*    MOVE '."C                   (   #00020210' TO DFHEIV0
 21311     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21313     MOVE X'2020233030303230323130' TO DFHEIV0(25:11)
 21314     CALL 'kxdfhei1' USING DFHEIV0,
 21315           DFHEIV1,
 21316           DATE-CONVERSION-DATA,
 21317           DC-COMM-LENGTH,
 21318           DFHEIV99,
 21319           DFHEIV99,
 21320           DFHEIV99,
 21321           DFHEIV99
 21322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21323
 21324
 21325 8500-EXIT.
 21326     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 394
* EL050.cbl
 21328
 21329 8555-RELOAD-CONTROL-FILE.
 21330     CONTINUE.
 21331
 21332 8555-EXIT.
 21333     EXIT.
 21334
 21335 8557-GETMAIN-ERPLAN.
 21336
 21337
 21338* EXEC CICS GETMAIN
 21339*        LENGTH    (840)
 21340*        SET       (ADDRESS OF PLAN-RECORDS)
 21341*    END-EXEC.
 21342     MOVE 840
 21343       TO DFHEIV11
 21344*    MOVE '," L                  $   #00020228' TO DFHEIV0
 21345     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21346     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21347     MOVE X'2020233030303230323238' TO DFHEIV0(25:11)
 21348     CALL 'kxdfhei1' USING DFHEIV0,
 21349           DFHEIV20,
 21350           DFHEIV11,
 21351           DFHEIV99
 21352     SET ADDRESS OF PLAN-RECORDS TO
 21353         DFHEIV20
 21354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21355
 21356
 21357     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21358
 21359 8557-EXIT.
 21360     EXIT.
 21361
 21362 8560-GETMAIN.
 21363
 21364* EXEC CICS GETMAIN
 21365*        LENGTH    (2000)
 21366*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21367*    END-EXEC.
 21368     MOVE 2000
 21369       TO DFHEIV11
 21370*    MOVE '," L                  $   #00020239' TO DFHEIV0
 21371     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21372     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21373     MOVE X'2020233030303230323339' TO DFHEIV0(25:11)
 21374     CALL 'kxdfhei1' USING DFHEIV0,
 21375           DFHEIV20,
 21376           DFHEIV11,
 21377           DFHEIV99
 21378     SET ADDRESS OF ACCOUNT-MASTER TO
 21379         DFHEIV20
 21380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21381
 21382
 21383     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21384
 21385 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 395
* EL050.cbl
 21386     EXIT.
 21387
 21388 8570-START-ACCOUNT-MASTER.
 21389
 21390* EXEC CICS HANDLE CONDITION
 21391*        NOTFND    (0199-ACCT-NOT-FOUND)
 21392*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21393*    END-EXEC.
 21394*    MOVE '"$I''                  ! 6 #00020250' TO DFHEIV0
 21395     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21397     MOVE X'3620233030303230323530' TO DFHEIV0(25:11)
 21398     CALL 'kxdfhei1' USING DFHEIV0
 21399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21400
 21401
 21402
 21403* EXEC CICS STARTBR
 21404*        DATASET    (ACCT-ID)
 21405*        RIDFLD     (ERACCT-KEY)
 21406*        GTEQ
 21407*    END-EXEC.
 21408     MOVE 0
 21409       TO DFHEIV11
 21410*    MOVE '&,         G          &   #00020255' TO DFHEIV0
 21411     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21412     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21413     MOVE X'2020233030303230323535' TO DFHEIV0(25:11)
 21414     CALL 'kxdfhei1' USING DFHEIV0,
 21415           ACCT-ID,
 21416           ERACCT-KEY,
 21417           DFHEIV99,
 21418           DFHEIV11,
 21419           DFHEIV99
 21420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21421
 21422
 21423 8570-EXIT.
 21424     EXIT.
 21425
 21426 8580-READ-ACCOUNT-MASTER.
 21427
 21428* EXEC CICS HANDLE CONDITION
 21429*        NOTFND    (0199-ACCT-NOT-FOUND)
 21430*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21431*    END-EXEC.
 21432*    MOVE '"$I''                  ! 7 #00020265' TO DFHEIV0
 21433     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21435     MOVE X'3720233030303230323635' TO DFHEIV0(25:11)
 21436     CALL 'kxdfhei1' USING DFHEIV0
 21437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21438
 21439
 21440
 21441* EXEC CICS READNEXT
 21442*        DATASET     (ACCT-ID)
 21443*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 396
* EL050.cbl
 21444*        RIDFLD      (ERACCT-KEY)
 21445*    END-EXEC.
 21446     MOVE LENGTH OF
 21447      ACCOUNT-MASTER
 21448       TO DFHEIV12
 21449     MOVE 0
 21450       TO DFHEIV11
 21451*    MOVE '&.IL                  )   #00020270' TO DFHEIV0
 21452     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21453     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21454     MOVE X'2020233030303230323730' TO DFHEIV0(25:11)
 21455     CALL 'kxdfhei1' USING DFHEIV0,
 21456           ACCT-ID,
 21457           ACCOUNT-MASTER,
 21458           DFHEIV12,
 21459           ERACCT-KEY,
 21460           DFHEIV99,
 21461           DFHEIV11,
 21462           DFHEIV99,
 21463           DFHEIV99
 21464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21465
 21466
 21467 8580-EXIT.
 21468     EXIT.
 21469
 21470 8582-READ-COMPENSATION-MASTER.
 21471
 21472* EXEC CICS HANDLE CONDITION
 21473*        NOTFND    (8582-COMP-NOT-FOUND)
 21474*        ENDFILE   (8582-COMP-NOT-FOUND)
 21475*    END-EXEC.
 21476*    MOVE '"$I''                  ! 8 #00020280' TO DFHEIV0
 21477     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21479     MOVE X'3820233030303230323830' TO DFHEIV0(25:11)
 21480     CALL 'kxdfhei1' USING DFHEIV0
 21481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21482
 21483
 21484
 21485* EXEC CICS READ
 21486*        DATASET     (COMP-ID)
 21487*        INTO        (COMPENSATION-MASTER)
 21488*        RIDFLD      (ERCOMP-KEY)
 21489*    END-EXEC.
 21490     MOVE LENGTH OF
 21491      COMPENSATION-MASTER
 21492       TO DFHEIV11
 21493*    MOVE '&"IL       E          (   #00020285' TO DFHEIV0
 21494     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21495     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21496     MOVE X'2020233030303230323835' TO DFHEIV0(25:11)
 21497     CALL 'kxdfhei1' USING DFHEIV0,
 21498           COMP-ID,
 21499           COMPENSATION-MASTER,
 21500           DFHEIV11,
 21501           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 397
* EL050.cbl
 21502           DFHEIV99,
 21503           DFHEIV99,
 21504           DFHEIV99
 21505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21506
 21507
 21508     MOVE 'Y'                    TO COMP-MASTER-SW
 21509
 21510     GO TO 8582-EXIT
 21511     .
 21512 8582-COMP-NOT-FOUND.
 21513
 21514     MOVE 'N'                    TO COMP-MASTER-SW.
 21515
 21516 8582-EXIT.
 21517     EXIT.
 21518
 21519 8583-READ-ERAGTC.
 21520
 21521* EXEC CICS HANDLE CONDITION
 21522*        NOTFND    (8583-AGTC-NOT-FOUND)
 21523*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21524*    END-EXEC.
 21525*    MOVE '"$I''                  ! 9 #00020303' TO DFHEIV0
 21526     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21528     MOVE X'3920233030303230333033' TO DFHEIV0(25:11)
 21529     CALL 'kxdfhei1' USING DFHEIV0
 21530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21531
 21532
 21533
 21534* EXEC CICS STARTBR
 21535*        DATASET    (AGTC-ID)
 21536*        RIDFLD     (ERAGTC-KEY)
 21537*        GTEQ
 21538*    END-EXEC.
 21539     MOVE 0
 21540       TO DFHEIV11
 21541*    MOVE '&,         G          &   #00020308' TO DFHEIV0
 21542     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21543     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21544     MOVE X'2020233030303230333038' TO DFHEIV0(25:11)
 21545     CALL 'kxdfhei1' USING DFHEIV0,
 21546           AGTC-ID,
 21547           ERAGTC-KEY,
 21548           DFHEIV99,
 21549           DFHEIV11,
 21550           DFHEIV99
 21551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21552
 21553
 21554 8583-READ-ERAGTC-NEXT.
 21555
 21556* EXEC CICS READNEXT
 21557*        DATASET     (AGTC-ID)
 21558*        INTO        (AGENT-COMMISSIONS)
 21559*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 398
* EL050.cbl
 21560*    END-EXEC.
 21561     MOVE LENGTH OF
 21562      AGENT-COMMISSIONS
 21563       TO DFHEIV12
 21564     MOVE 0
 21565       TO DFHEIV11
 21566*    MOVE '&.IL                  )   #00020315' TO DFHEIV0
 21567     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21568     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21569     MOVE X'2020233030303230333135' TO DFHEIV0(25:11)
 21570     CALL 'kxdfhei1' USING DFHEIV0,
 21571           AGTC-ID,
 21572           AGENT-COMMISSIONS,
 21573           DFHEIV12,
 21574           ERAGTC-KEY,
 21575           DFHEIV99,
 21576           DFHEIV11,
 21577           DFHEIV99,
 21578           DFHEIV99
 21579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21580
 21581
 21582*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21583
 21584     GO TO 8583-EXIT
 21585     .
 21586 8583-AGTC-NOT-FOUND.
 21587
 21588     MOVE 'N'                    TO AGTC-MASTER-SW.
 21589
 21590 8583-EXIT.
 21591     EXIT.
 21592
 21593 8584-READ-BANK-CROSS-REF.
 21594
 21595* EXEC CICS HANDLE CONDITION
 21596*        NOTFND    (8584-BXRF-NOT-FOUND)
 21597*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21598*    END-EXEC.
 21599*    MOVE '"$I''                  ! : #00020333' TO DFHEIV0
 21600     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21602     MOVE X'3A20233030303230333333' TO DFHEIV0(25:11)
 21603     CALL 'kxdfhei1' USING DFHEIV0
 21604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21605
 21606
 21607
 21608* EXEC CICS READ
 21609*        DATASET     (BXRF-ID)
 21610*        INTO        (BANK-CROSS-REFERENCE)
 21611*        RIDFLD      (ERBXRF-KEY)
 21612*        LENGTH      (BXRF-REC-LENGTH)
 21613*    END-EXEC.
 21614*    MOVE '&"IL       E          (   #00020338' TO DFHEIV0
 21615     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21617     MOVE X'2020233030303230333338' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 399
* EL050.cbl
 21618     CALL 'kxdfhei1' USING DFHEIV0,
 21619           BXRF-ID,
 21620           BANK-CROSS-REFERENCE,
 21621           BXRF-REC-LENGTH,
 21622           ERBXRF-KEY,
 21623           DFHEIV99,
 21624           DFHEIV99,
 21625           DFHEIV99
 21626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21627
 21628
 21629     MOVE 'Y'                    TO BXRF-MASTER-SW
 21630
 21631     GO TO 8584-EXIT
 21632     .
 21633 8584-BXRF-NOT-FOUND.
 21634
 21635     MOVE 'N'                    TO BXRF-MASTER-SW.
 21636
 21637 8584-EXIT.
 21638     EXIT.
 21639
 21640 8585-READ-PLAN-MASTER.
 21641
 21642
 21643* EXEC CICS HANDLE CONDITION
 21644*        NOTFND    (8585-PLAN-NOT-FOUND)
 21645*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21646*    END-EXEC.
 21647*    MOVE '"$I''                  ! ; #00020358' TO DFHEIV0
 21648     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21650     MOVE X'3B20233030303230333538' TO DFHEIV0(25:11)
 21651     CALL 'kxdfhei1' USING DFHEIV0
 21652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21653
 21654
 21655
 21656* EXEC CICS READ
 21657*        DATASET     (PLAN-ID)
 21658*        INTO        (PLAN-MASTER)
 21659*        RIDFLD      (ERPLAN-KEY)
 21660*    END-EXEC.
 21661     MOVE LENGTH OF
 21662      PLAN-MASTER
 21663       TO DFHEIV11
 21664*    MOVE '&"IL       E          (   #00020363' TO DFHEIV0
 21665     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21667     MOVE X'2020233030303230333633' TO DFHEIV0(25:11)
 21668     CALL 'kxdfhei1' USING DFHEIV0,
 21669           PLAN-ID,
 21670           PLAN-MASTER,
 21671           DFHEIV11,
 21672           ERPLAN-KEY,
 21673           DFHEIV99,
 21674           DFHEIV99,
 21675           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 400
* EL050.cbl
 21676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21677
 21678
 21679     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21680
 21681     GO TO 8585-EXIT.
 21682
 21683 8585-PLAN-NOT-FOUND.
 21684
 21685     MOVE 'N'                    TO PLAN-MASTER-SW.
 21686
 21687 8585-EXIT.
 21688     EXIT.
 21689
 21690 8586-READ-LOAN-OFFICER.
 21691
 21692* EXEC CICS READ
 21693*        DATASET     (LOFC-ID)
 21694*        INTO        (LOAN-OFFICER-MASTER)
 21695*        RIDFLD      (ERLOFC-KEY)
 21696*        RESP        (WS-RESPONSE)
 21697*    END-EXEC
 21698     MOVE LENGTH OF
 21699      LOAN-OFFICER-MASTER
 21700       TO DFHEIV11
 21701*    MOVE '&"IL       E          (  N#00020381' TO DFHEIV0
 21702     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21704     MOVE X'204E233030303230333831' TO DFHEIV0(25:11)
 21705     CALL 'kxdfhei1' USING DFHEIV0,
 21706           LOFC-ID,
 21707           LOAN-OFFICER-MASTER,
 21708           DFHEIV11,
 21709           ERLOFC-KEY,
 21710           DFHEIV99,
 21711           DFHEIV99,
 21712           DFHEIV99
 21713     MOVE EIBRESP  TO WS-RESPONSE
 21714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21715
 21716     IF WS-RESP-NORMAL
 21717        MOVE 'Y'                 TO LOFC-MASTER-SW
 21718     ELSE
 21719        MOVE 'N'                 TO LOFC-MASTER-SW
 21720     END-IF
 21721     .
 21722 8586-EXIT.
 21723     EXIT.
 21724 8587-START-ERPDEF.
 21725
 21726* EXEC CICS STARTBR
 21727*       DATASET   (PDEF-ID)
 21728*       RIDFLD    (ERPDEF-KEY)
 21729*       GTEQ
 21730*       RESP      (WS-RESPONSE)
 21731*    END-EXEC
 21732     MOVE 0
 21733       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 401
* EL050.cbl
 21734*    MOVE '&,         G          &  N#00020397' TO DFHEIV0
 21735     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21736     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21737     MOVE X'204E233030303230333937' TO DFHEIV0(25:11)
 21738     CALL 'kxdfhei1' USING DFHEIV0,
 21739           PDEF-ID,
 21740           ERPDEF-KEY,
 21741           DFHEIV99,
 21742           DFHEIV11,
 21743           DFHEIV99
 21744     MOVE EIBRESP  TO WS-RESPONSE
 21745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21746     IF WS-RESP-NORMAL
 21747        MOVE 'Y'                 TO PDEF-MASTER-SW
 21748     ELSE
 21749        MOVE 'N'                 TO PDEF-MASTER-SW
 21750     END-IF
 21751     .
 21752 8587-EXIT.
 21753     EXIT.
 21754 8588-READ-ERPDEF.
 21755
 21756* EXEC CICS READNEXT
 21757*       DATASET   (PDEF-ID)
 21758*       RIDFLD    (ERPDEF-KEY)
 21759*       INTO      (PRODUCT-MASTER)
 21760*       RESP      (WS-RESPONSE)
 21761*    END-EXEC
 21762     MOVE LENGTH OF
 21763      PRODUCT-MASTER
 21764       TO DFHEIV12
 21765     MOVE 0
 21766       TO DFHEIV11
 21767*    MOVE '&.IL                  )  N#00020412' TO DFHEIV0
 21768     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21769     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21770     MOVE X'204E233030303230343132' TO DFHEIV0(25:11)
 21771     CALL 'kxdfhei1' USING DFHEIV0,
 21772           PDEF-ID,
 21773           PRODUCT-MASTER,
 21774           DFHEIV12,
 21775           ERPDEF-KEY,
 21776           DFHEIV99,
 21777           DFHEIV11,
 21778           DFHEIV99,
 21779           DFHEIV99
 21780     MOVE EIBRESP  TO WS-RESPONSE
 21781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21782     IF WS-RESP-NORMAL
 21783        MOVE 'Y'                 TO PDEF-MASTER-SW
 21784     ELSE
 21785        MOVE 'N'                 TO PDEF-MASTER-SW
 21786     END-IF
 21787     .
 21788 8588-EXIT.
 21789     EXIT.
 21790 8589-ENDBR-ERPDEF.
 21791
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 402
* EL050.cbl
 21792* EXEC CICS ENDBR
 21793*       DATASET   (PDEF-ID)
 21794*    END-EXEC
 21795     MOVE 0
 21796       TO DFHEIV11
 21797*    MOVE '&2                    $   #00020427' TO DFHEIV0
 21798     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21799     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21800     MOVE X'2020233030303230343237' TO DFHEIV0(25:11)
 21801     CALL 'kxdfhei1' USING DFHEIV0,
 21802           PDEF-ID,
 21803           DFHEIV11,
 21804           DFHEIV99
 21805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21806     .
 21807 8589-EXIT.
 21808     EXIT.
 21809 8590-READ-CERT-MASTER.
 21810     IF PB-COMPANY-ID = 'UCL'
 21811         GO TO 8690-READ-CERT-MASTER-UCL.
 21812
 21813
 21814* EXEC CICS HANDLE CONDITION
 21815*         NOTFND    (0299-CERT-NOT-FOUND)
 21816*    END-EXEC.
 21817*    MOVE '"$I                   ! < #00020437' TO DFHEIV0
 21818     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21820     MOVE X'3C20233030303230343337' TO DFHEIV0(25:11)
 21821     CALL 'kxdfhei1' USING DFHEIV0
 21822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21823
 21824
 21825
 21826* EXEC CICS READ
 21827*        DATASET     (CERT-ID)
 21828*        INTO        (CERTIFICATE-MASTER)
 21829*        RIDFLD      (ELCERT-KEY)
 21830*        UPDATE
 21831*    END-EXEC.
 21832     MOVE LENGTH OF
 21833      CERTIFICATE-MASTER
 21834       TO DFHEIV11
 21835*    MOVE '&"IL       EU         (   #00020441' TO DFHEIV0
 21836     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21837     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21838     MOVE X'2020233030303230343431' TO DFHEIV0(25:11)
 21839     CALL 'kxdfhei1' USING DFHEIV0,
 21840           CERT-ID,
 21841           CERTIFICATE-MASTER,
 21842           DFHEIV11,
 21843           ELCERT-KEY,
 21844           DFHEIV99,
 21845           DFHEIV99,
 21846           DFHEIV99
 21847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21848
 21849
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 403
* EL050.cbl
 21850 8590-EXIT.
 21851     EXIT.
 21852
 21853 8690-READ-CERT-MASTER-UCL.
 21854
 21855* EXEC CICS HANDLE CONDITION
 21856*         NOTFND    (8700-READ-CERT-MASTER)
 21857*    END-EXEC.
 21858*    MOVE '"$I                   ! = #00020452' TO DFHEIV0
 21859     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21861     MOVE X'3D20233030303230343532' TO DFHEIV0(25:11)
 21862     CALL 'kxdfhei1' USING DFHEIV0
 21863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21864
 21865
 21866 8690-READ-CERT-CONT.
 21867
 21868* EXEC CICS READ
 21869*        DATASET     (CERT-ID)
 21870*        INTO        (CERTIFICATE-MASTER)
 21871*        RIDFLD      (ELCERT-KEY)
 21872*        UPDATE
 21873*    END-EXEC.
 21874     MOVE LENGTH OF
 21875      CERTIFICATE-MASTER
 21876       TO DFHEIV11
 21877*    MOVE '&"IL       EU         (   #00020457' TO DFHEIV0
 21878     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21879     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21880     MOVE X'2020233030303230343537' TO DFHEIV0(25:11)
 21881     CALL 'kxdfhei1' USING DFHEIV0,
 21882           CERT-ID,
 21883           CERTIFICATE-MASTER,
 21884           DFHEIV11,
 21885           ELCERT-KEY,
 21886           DFHEIV99,
 21887           DFHEIV99,
 21888           DFHEIV99
 21889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21890
 21891
 21892     GO TO 8590-EXIT.
 21893
 21894 8700-READ-CERT-MASTER.
 21895     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21896     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21897
 21898* EXEC CICS HANDLE CONDITION
 21899*         DUPKEY    (8720-COMP-ACCOUNTS)
 21900*         ENDFILE   (8730-END-BROWSE)
 21901*         NOTFND    (8740-NOT-FOUND)
 21902*    END-EXEC.
 21903*    MOVE '"$$''I                 ! > #00020469' TO DFHEIV0
 21904     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21906     MOVE X'3E20233030303230343639' TO DFHEIV0(25:11)
 21907     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 404
* EL050.cbl
 21908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21909
 21910
 21911
 21912* EXEC CICS STARTBR
 21913*        DATASET     ('ELCERT5')
 21914*        RIDFLD      (ELCERT2-KEY)
 21915*        EQUAL
 21916*    END-EXEC.
 21917     MOVE 'ELCERT5' TO DFHEIV1
 21918     MOVE 0
 21919       TO DFHEIV11
 21920*    MOVE '&,         E          &   #00020475' TO DFHEIV0
 21921     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21922     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21923     MOVE X'2020233030303230343735' TO DFHEIV0(25:11)
 21924     CALL 'kxdfhei1' USING DFHEIV0,
 21925           DFHEIV1,
 21926           ELCERT2-KEY,
 21927           DFHEIV99,
 21928           DFHEIV11,
 21929           DFHEIV99
 21930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21931
 21932
 21933 8710-READ-NEXT.
 21934
 21935* EXEC CICS READNEXT
 21936*        DATASET     ('ELCERT5')
 21937*        INTO        (CERTIFICATE-MASTER)
 21938*        RIDFLD      (ELCERT2-KEY)
 21939*    END-EXEC.
 21940     MOVE LENGTH OF
 21941      CERTIFICATE-MASTER
 21942       TO DFHEIV12
 21943     MOVE 'ELCERT5' TO DFHEIV1
 21944     MOVE 0
 21945       TO DFHEIV11
 21946*    MOVE '&.IL                  )   #00020482' TO DFHEIV0
 21947     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21948     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21949     MOVE X'2020233030303230343832' TO DFHEIV0(25:11)
 21950     CALL 'kxdfhei1' USING DFHEIV0,
 21951           DFHEIV1,
 21952           CERTIFICATE-MASTER,
 21953           DFHEIV12,
 21954           ELCERT2-KEY,
 21955           DFHEIV99,
 21956           DFHEIV11,
 21957           DFHEIV99,
 21958           DFHEIV99
 21959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21960
 21961
 21962 8720-COMP-ACCOUNTS.
 21963
 21964* EXEC CICS ENTER
 21965*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 405
* EL050.cbl
 21966*         FROM (PB-C-LAST-NAME)
 21967*    END-EXEC.
 21968     MOVE 001
 21969       TO DFHEIV11
 21970*    MOVE ':$F                   %   #00020489' TO DFHEIV0
 21971     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21972     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21973     MOVE X'2020233030303230343839' TO DFHEIV0(25:11)
 21974     CALL 'kxdfhei1' USING DFHEIV0,
 21975           DFHEIV11,
 21976           PB-C-LAST-NAME,
 21977           DFHEIV99,
 21978           DFHEIV99
 21979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21980
 21981
 21982
 21983* EXEC CICS ENTER
 21984*         TRACEID (002)
 21985*         FROM (CM-INSURED-LAST-NAME)
 21986*    END-EXEC.
 21987     MOVE 002
 21988       TO DFHEIV11
 21989*    MOVE ':$F                   %   #00020494' TO DFHEIV0
 21990     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21991     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21992     MOVE X'2020233030303230343934' TO DFHEIV0(25:11)
 21993     CALL 'kxdfhei1' USING DFHEIV0,
 21994           DFHEIV11,
 21995           CM-INSURED-LAST-NAME,
 21996           DFHEIV99,
 21997           DFHEIV99
 21998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21999
 22000
 22001     IF PB-CERT-NO NOT = CM-CERT-NO
 22002         GO TO 8730-END-BROWSE.
 22003
 22004     IF PB-ACCOUNT = CM-ACCOUNT
 22005         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22006             MOVE ER-2799        TO WS-ERROR
 22007             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22008             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22009             GO TO 8730-END-BROWSE.
 22010
 22011     GO TO 8710-READ-NEXT.
 22012
 22013 8730-END-BROWSE.
 22014
 22015* EXEC CICS ENDBR
 22016*         DATASET    ('ELCERT5')
 22017*    END-EXEC.
 22018     MOVE 'ELCERT5' TO DFHEIV1
 22019     MOVE 0
 22020       TO DFHEIV11
 22021*    MOVE '&2                    $   #00020512' TO DFHEIV0
 22022     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22023     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 406
* EL050.cbl
 22024     MOVE X'2020233030303230353132' TO DFHEIV0(25:11)
 22025     CALL 'kxdfhei1' USING DFHEIV0,
 22026           DFHEIV1,
 22027           DFHEIV11,
 22028           DFHEIV99
 22029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22030
 22031
 22032 8740-NOT-FOUND.
 22033     GO TO 0299-CERT-NOT-FOUND.
 22034
 22035 8750-START-ELSTAT.
 22036
 22037* EXEC CICS STARTBR
 22038*       DATASET   (STAT-ID)
 22039*       RIDFLD    (ELSTAT-KEY)
 22040*       GTEQ
 22041*       RESP      (WS-RESPONSE)
 22042*    END-EXEC
 22043     MOVE 0
 22044       TO DFHEIV11
 22045*    MOVE '&,         G          &  N#00020520' TO DFHEIV0
 22046     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22047     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22048     MOVE X'204E233030303230353230' TO DFHEIV0(25:11)
 22049     CALL 'kxdfhei1' USING DFHEIV0,
 22050           STAT-ID,
 22051           ELSTAT-KEY,
 22052           DFHEIV99,
 22053           DFHEIV11,
 22054           DFHEIV99
 22055     MOVE EIBRESP  TO WS-RESPONSE
 22056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22057     IF WS-RESP-NORMAL
 22058        MOVE 'Y'                 TO STAT-MASTER-SW
 22059     ELSE
 22060        MOVE 'N'                 TO STAT-MASTER-SW
 22061     END-IF
 22062     .
 22063 8750-EXIT.
 22064     EXIT.
 22065 8752-READ-ELSTAT.
 22066
 22067* EXEC CICS READNEXT
 22068*       DATASET   (STAT-ID)
 22069*       RIDFLD    (ELSTAT-KEY)
 22070*       INTO      (STATE-FILE)
 22071*       RESP      (WS-RESPONSE)
 22072*    END-EXEC
 22073     MOVE LENGTH OF
 22074      STATE-FILE
 22075       TO DFHEIV12
 22076     MOVE 0
 22077       TO DFHEIV11
 22078*    MOVE '&.IL                  )  N#00020535' TO DFHEIV0
 22079     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22080     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22081     MOVE X'204E233030303230353335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 407
* EL050.cbl
 22082     CALL 'kxdfhei1' USING DFHEIV0,
 22083           STAT-ID,
 22084           STATE-FILE,
 22085           DFHEIV12,
 22086           ELSTAT-KEY,
 22087           DFHEIV99,
 22088           DFHEIV11,
 22089           DFHEIV99,
 22090           DFHEIV99
 22091     MOVE EIBRESP  TO WS-RESPONSE
 22092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22093     IF WS-RESP-NORMAL
 22094        MOVE 'Y'                 TO STAT-MASTER-SW
 22095     ELSE
 22096        MOVE 'N'                 TO STAT-MASTER-SW
 22097     END-IF
 22098     .
 22099 8752-EXIT.
 22100     EXIT.
 22101 8800-GET-COMP-RATE.
 22102     MOVE +1 TO IB.
 22103     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22104         ADD +9 TO IB
 22105         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22106             ADD +9 TO IB
 22107             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22108                MOVE ZEROS       TO WS-WK-RATE
 22109                GO TO 8800-EXIT.
 22110
 22111     IF PB-I-AGE GREATER CT-AGE (1)
 22112         ADD +3 TO IB
 22113         IF PB-I-AGE GREATER CT-AGE (2)
 22114             ADD +3 TO IB
 22115             IF PB-I-AGE GREATER CT-AGE (3)
 22116                MOVE ZEROS       TO WS-WK-RATE
 22117                GO TO 8800-EXIT.
 22118
 22119     IF WS-WORK-TERM GREATER CT-TRM (1)
 22120         ADD +1 TO IB
 22121         IF WS-WORK-TERM GREATER CT-TRM (2)
 22122             ADD +1 TO IB
 22123             IF WS-WORK-TERM GREATER CT-TRM (3)
 22124                MOVE ZEROS       TO WS-WK-RATE
 22125                GO TO 8800-EXIT.
 22126
 22127     IF CT-RT (IB) NOT NUMERIC
 22128         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22129         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22130         GO TO 8800-GET-COMP-RATE.
 22131
 22132     MOVE CT-RT (IB) TO WS-WK-RATE.
 22133
 22134 8800-EXIT.
 22135     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 408
* EL050.cbl
 22137 8900-ADDRESS-FILE.
 22138     IF ERACCT-FILE-ADDRESSED
 22139         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22140         GO TO 8900-ADDRESS-EXIT.
 22141
 22142     IF ELCNTL-FILE-ADDRESSED
 22143         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22144         GO TO 8900-ADDRESS-EXIT.
 22145
 22146     IF ERPLAN-FILE-ADDRESSED
 22147         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22148         GO TO 8900-ADDRESS-EXIT.
 22149
 22150     IF ERFORM-FILE-ADDRESSED
 22151         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22152         GO TO 8900-ADDRESS-EXIT.
 22153
 22154 8900-ADDRESS-EXIT.
 22155     EXIT.
 22156
 22157 9000-READ-CONTROL.
 22158
 22159* EXEC CICS HANDLE CONDITION
 22160*        NOTFND    (9000-NOTFND)
 22161*    END-EXEC.
 22162*    MOVE '"$I                   ! ? #00020606' TO DFHEIV0
 22163     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22165     MOVE X'3F20233030303230363036' TO DFHEIV0(25:11)
 22166     CALL 'kxdfhei1' USING DFHEIV0
 22167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22168
 22169
 22170
 22171* EXEC CICS READ
 22172*        DATASET     (CNTL-ID)
 22173*        SET         (ADDRESS OF CONTROL-FILE)
 22174*        RIDFLD      (ELCNTL-KEY)
 22175*        GTEQ
 22176*    END-EXEC.
 22177*    MOVE '&"S        G          (   #00020610' TO DFHEIV0
 22178     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22180     MOVE X'2020233030303230363130' TO DFHEIV0(25:11)
 22181     CALL 'kxdfhei1' USING DFHEIV0,
 22182           CNTL-ID,
 22183           DFHEIV20,
 22184           DFHEIV99,
 22185           ELCNTL-KEY,
 22186           DFHEIV99,
 22187           DFHEIV99,
 22188           DFHEIV99
 22189     SET ADDRESS OF CONTROL-FILE TO
 22190         DFHEIV20
 22191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22192
 22193
 22194     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 409
* EL050.cbl
 22195
 22196 9000-NOTFND.
 22197     IF RC-SW-1 = '1'
 22198        MOVE ER-2616              TO WS-ERROR
 22199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22200        GO TO 9000-EXIT.
 22201
 22202     IF RC-SW-1 = '2'
 22203        MOVE ER-2602              TO WS-ERROR
 22204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22205
 22206 9000-EXIT.
 22207      EXIT.
 22208
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 410
* EL050.cbl
 22210 9100-READ-CONTROL.
 22211
 22212* EXEC CICS HANDLE CONDITION
 22213*        NOTFND  (9100-NOTFND)
 22214*        ENDFILE (9100-NOTFND)
 22215*    END-EXEC.
 22216*    MOVE '"$I''                  ! @ #00020634' TO DFHEIV0
 22217     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22218     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22219     MOVE X'4020233030303230363334' TO DFHEIV0(25:11)
 22220     CALL 'kxdfhei1' USING DFHEIV0
 22221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22222
 22223
 22224
 22225* EXEC CICS READ
 22226*        DATASET     (CNTL-ID)
 22227*        INTO        (CONTROL-FILE)
 22228*        RIDFLD      (ELCNTL-KEY)
 22229*        GTEQ
 22230*    END-EXEC.
 22231     MOVE LENGTH OF
 22232      CONTROL-FILE
 22233       TO DFHEIV11
 22234*    MOVE '&"IL       G          (   #00020639' TO DFHEIV0
 22235     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22236     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22237     MOVE X'2020233030303230363339' TO DFHEIV0(25:11)
 22238     CALL 'kxdfhei1' USING DFHEIV0,
 22239           CNTL-ID,
 22240           CONTROL-FILE,
 22241           DFHEIV11,
 22242           ELCNTL-KEY,
 22243           DFHEIV99,
 22244           DFHEIV99,
 22245           DFHEIV99
 22246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22247
 22248
 22249     GO TO 9100-EXIT.
 22250
 22251 9100-NOTFND.
 22252     IF RC-SW-2 = '0'
 22253        MOVE '1'                  TO STATE-RECORD-ERROR
 22254        GO TO 9100-EXIT
 22255     END-IF
 22256     IF RC-SW-2 = '1'
 22257        MOVE '1'                  TO LF-BENEFIT-ERROR
 22258        MOVE ER-2604              TO WS-ERROR
 22259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22260        GO TO 9100-EXIT.
 22261
 22262     IF RC-SW-2 = '2'
 22263        MOVE '1'                  TO AH-BENEFIT-ERROR
 22264        MOVE ER-2605              TO WS-ERROR
 22265        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22266        GO TO 9100-EXIT.
 22267
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 411
* EL050.cbl
 22268     IF RC-SW-2 = '3'
 22269         MOVE ER-2603           TO WS-ERROR
 22270         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22271         GO TO 9100-EXIT.
 22272
 22273     IF RC-SW-2 = '4'
 22274         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22275         GO TO 9100-EXIT.
 22276
 22277     IF RC-SW-2 = '5'
 22278         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22279         IF WS-AH-INPUT-CD-1 = SPACE
 22280             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22281         ELSE
 22282             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22283
 22284 9100-EXIT.
 22285      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 412
* EL050.cbl
 22287 9200-CONTROL-GETMAIN.
 22288
 22289* EXEC CICS GETMAIN
 22290*         LENGTH   (750)
 22291*         SET      (ADDRESS OF CONTROL-FILE)
 22292*    END-EXEC.
 22293     MOVE 750
 22294       TO DFHEIV11
 22295*    MOVE '," L                  $   #00020685' TO DFHEIV0
 22296     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22297     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22298     MOVE X'2020233030303230363835' TO DFHEIV0(25:11)
 22299     CALL 'kxdfhei1' USING DFHEIV0,
 22300           DFHEIV20,
 22301           DFHEIV11,
 22302           DFHEIV99
 22303     SET ADDRESS OF CONTROL-FILE TO
 22304         DFHEIV20
 22305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22306
 22307
 22308     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22309
 22310 9200-EXIT.
 22311     EXIT.
 22312
 22313 9250-UNLOCK-RETURN.
 22314
 22315* EXEC CICS UNLOCK
 22316*        DATASET   (CERT-ID)
 22317*    END-EXEC.
 22318*    MOVE '&*                    #   #00020696' TO DFHEIV0
 22319     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22320     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22321     MOVE X'2020233030303230363936' TO DFHEIV0(25:11)
 22322     CALL 'kxdfhei1' USING DFHEIV0,
 22323           CERT-ID,
 22324           DFHEIV99
 22325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22326
 22327
 22328 9300-ABEND.
 22329     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22330
 22331
 22332* EXEC CICS LINK
 22333*        PROGRAM   ('EL004')
 22334*        COMMAREA  (WS-ERROR-LINE)
 22335*        LENGTH    (72)
 22336*    END-EXEC.
 22337     MOVE 'EL004' TO DFHEIV1
 22338     MOVE 72
 22339       TO DFHEIV11
 22340*    MOVE '."C                   (   #00020703' TO DFHEIV0
 22341     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22343     MOVE X'2020233030303230373033' TO DFHEIV0(25:11)
 22344     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 413
* EL050.cbl
 22345           DFHEIV1,
 22346           WS-ERROR-LINE,
 22347           DFHEIV11,
 22348           DFHEIV99,
 22349           DFHEIV99,
 22350           DFHEIV99,
 22351           DFHEIV99
 22352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22353
 22354
 22355     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22356
 22357
 22358* EXEC CICS ABEND
 22359*        ABCODE ('EL50')
 22360*    END-EXEC.
 22361     MOVE 'EL50' TO DFHEIV5
 22362*    MOVE '.,A                   "   #00020711' TO DFHEIV0
 22363     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22364     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22365     MOVE X'2020233030303230373131' TO DFHEIV0(25:11)
 22366     CALL 'kxdfhei1' USING DFHEIV0,
 22367           DFHEIV5
 22368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22369
 22370
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 414
* EL050.cbl
 22372
 22373******************************************************************
 22374*                                                                *
 22375*            E R R O R   F O R M A T   R O U T I N E             *
 22376*                                                                *
 22377******************************************************************
 22378
 22379 9900-ERROR-FORMAT.
 22380
 22381     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22382                    PB-COMMON-ERROR (2) OR
 22383                    PB-COMMON-ERROR (3) OR
 22384                    PB-COMMON-ERROR (4) OR
 22385                    PB-COMMON-ERROR (5) OR
 22386                    PB-COMMON-ERROR (6) OR
 22387                    PB-COMMON-ERROR (7) OR
 22388                    PB-COMMON-ERROR (8) OR
 22389                    PB-COMMON-ERROR (9) OR
 22390                    PB-COMMON-ERROR (10)
 22391        GO TO 9900-EXIT.
 22392
 22393     IF PB-NO-OF-ERRORS = +10
 22394        GO TO 9900-EXIT.
 22395
 22396     ADD +1  TO PB-NO-OF-ERRORS.
 22397     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22398                                       (PB-NO-OF-ERRORS).
 22399 9900-EXIT.
 22400     EXIT.
 22401
 22402 9990-RETURN.
 22403     IF BROWSE-STARTED
 22404
 22405* EXEC CICS ENDBR
 22406*            DATASET  (ACCT-ID)
 22407*       END-EXEC.
 22408     MOVE 0
 22409       TO DFHEIV11
 22410*    MOVE '&2                    $   #00020748' TO DFHEIV0
 22411     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22412     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22413     MOVE X'2020233030303230373438' TO DFHEIV0(25:11)
 22414     CALL 'kxdfhei1' USING DFHEIV0,
 22415           ACCT-ID,
 22416           DFHEIV11,
 22417           DFHEIV99
 22418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22419
 22420
 22421 9990-EXIT.
 22422     EXIT.
 22423
 22424
 22425****Check for CRTO record, add one if not found.
 22426 9991-CHECK-FOR-ELCRTO.
 22427
 22428* EXEC CICS HANDLE CONDITION
 22429*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 415
* EL050.cbl
 22430*         ENDFILE (9991-CRTO-NOT-FOUND)
 22431*     END-EXEC.
 22432*    MOVE '"$I''                  ! A #00020758' TO DFHEIV0
 22433     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22435     MOVE X'4120233030303230373538' TO DFHEIV0(25:11)
 22436     CALL 'kxdfhei1' USING DFHEIV0
 22437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22438
 22439     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22440     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22441     MOVE +0                     TO ELCRTO-SEQ-NO
 22442
 22443
 22444* EXEC CICS READ
 22445*       DATASET   ('ELCRTO')
 22446*       INTO      (ORIGINAL-CERTIFICATE)
 22447*       RIDFLD    (ELCRTO-KEY)
 22448*       GTEQ
 22449*       RESP      (WS-RESPONSE)
 22450*    END-EXEC
 22451     MOVE LENGTH OF
 22452      ORIGINAL-CERTIFICATE
 22453       TO DFHEIV11
 22454     MOVE 'ELCRTO' TO DFHEIV1
 22455*    MOVE '&"IL       G          (  N#00020766' TO DFHEIV0
 22456     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22458     MOVE X'204E233030303230373636' TO DFHEIV0(25:11)
 22459     CALL 'kxdfhei1' USING DFHEIV0,
 22460           DFHEIV1,
 22461           ORIGINAL-CERTIFICATE,
 22462           DFHEIV11,
 22463           ELCRTO-KEY,
 22464           DFHEIV99,
 22465           DFHEIV99,
 22466           DFHEIV99
 22467     MOVE EIBRESP  TO WS-RESPONSE
 22468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22469
 22470     IF WS-RESP-NORMAL
 22471        AND (OC-CONTROL-PRIMARY (1:33) =
 22472                 PB-CONTROL-BY-ACCOUNT (1:33))
 22473        AND (OC-RECORD-TYPE =  'I')
 22474           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22475               GO TO 9991-CHECK-INDICATORS
 22476           ELSE
 22477               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22478               GO TO 9991-CRTO-ADD-REC
 22479           END-IF
 22480     END-IF.
 22481
 22482 9991-CRTO-NOT-FOUND.
 22483
 22484     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22485     MOVE 'OC'                TO OC-RECORD-ID
 22486     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22487                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 416
* EL050.cbl
 22488     MOVE +4096               TO OC-KEY-SEQ-NO.
 22489
 22490 9991-CRTO-ADD-REC.
 22491
 22492     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22493     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22494     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22495     MOVE 'I'                 TO OC-RECORD-TYPE
 22496     IF PB-ISSUE
 22497         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22498         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22499         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22500         MOVE PB-I-AGE               TO OC-INS-AGE
 22501         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22502         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22503         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22504         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22505         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22506         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22507         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22508         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22509         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22510         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22511         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22512         IF PB-I-JOINT-COMMISSION > +0
 22513             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22514         ELSE
 22515             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22516         END-IF
 22517         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22518         MOVE +0                     TO OC-LF-CANCEL-AMT
 22519                                        OC-LF-ITD-CANCEL-AMT
 22520         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22521         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22522         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22523         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22524         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22525         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22526         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22527         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22528         MOVE +0                     TO OC-AH-CANCEL-AMT
 22529                                        OC-AH-ITD-CANCEL-AMT
 22530         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22531         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22532         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22533     ELSE
 22534         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22535         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22536         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22537         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22538         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22539         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22540         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22541         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22542         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22543          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22544             MOVE SPACES             TO OC-LF-BENCD
 22545             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 417
* EL050.cbl
 22546                                        OC-LF-BEN-AMT
 22547                                        OC-LF-PRM-AMT
 22548                                        OC-LF-ALT-BEN-AMT
 22549                                        OC-LF-ALT-PRM-AMT
 22550                                        OC-LF-COMM-PCT
 22551                                        OC-LF-CANCEL-AMT
 22552             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22553             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22554         ELSE
 22555             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22556             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22557             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22558             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22559             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22560             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22561             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22562             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22563             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22564             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22565         END-IF
 22566         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22567         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22568          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22569             MOVE SPACES             TO OC-AH-BENCD
 22570             MOVE ZEROS              TO OC-AH-TERM
 22571                                        OC-AH-BEN-AMT
 22572                                        OC-AH-PRM-AMT
 22573                                        OC-AH-COMM-PCT
 22574                                        OC-AH-CANCEL-AMT
 22575                                        OC-AH-CP
 22576             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22577             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22578         ELSE
 22579             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22580             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22581             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22582             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22583             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22584             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22585             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22586             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22587             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22588         END-IF
 22589         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22590         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22591         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22592         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22593     END-IF
 22594     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22595
 22596     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22597
 22598
 22599* EXEC CICS READ
 22600*         DATASET   (FILE-ERMAIL)
 22601*         RIDFLD    (MA-CONTROL-PRIMARY)
 22602*         INTO      (MAILING-DATA)
 22603*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 418
* EL050.cbl
 22604*    END-EXEC
 22605     MOVE LENGTH OF
 22606      MAILING-DATA
 22607       TO DFHEIV11
 22608*    MOVE '&"IL       E          (  N#00020902' TO DFHEIV0
 22609     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22611     MOVE X'204E233030303230393032' TO DFHEIV0(25:11)
 22612     CALL 'kxdfhei1' USING DFHEIV0,
 22613           FILE-ERMAIL,
 22614           MAILING-DATA,
 22615           DFHEIV11,
 22616           MA-CONTROL-PRIMARY,
 22617           DFHEIV99,
 22618           DFHEIV99,
 22619           DFHEIV99
 22620     MOVE EIBRESP  TO WS-RESPONSE
 22621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22622
 22623     IF WS-RESP-NORMAL
 22624         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22625     END-IF.
 22626
 22627     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22628     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22629
 22630
 22631* EXEC CICS READ
 22632*         DATASET  (CRTT-ID)
 22633*         RIDFLD   (WS-ELCRTT-KEY)
 22634*         INTO     (CERTIFICATE-TRAILERS)
 22635*         RESP     (WS-RESPONSE)
 22636*    END-EXEC
 22637     MOVE LENGTH OF
 22638      CERTIFICATE-TRAILERS
 22639       TO DFHEIV11
 22640*    MOVE '&"IL       E          (  N#00020916' TO DFHEIV0
 22641     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22643     MOVE X'204E233030303230393136' TO DFHEIV0(25:11)
 22644     CALL 'kxdfhei1' USING DFHEIV0,
 22645           CRTT-ID,
 22646           CERTIFICATE-TRAILERS,
 22647           DFHEIV11,
 22648           WS-ELCRTT-KEY,
 22649           DFHEIV99,
 22650           DFHEIV99,
 22651           DFHEIV99
 22652     MOVE EIBRESP  TO WS-RESPONSE
 22653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22654
 22655     IF WS-RESP-NORMAL
 22656         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22657         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22658     END-IF.
 22659
 22660
 22661* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 419
* EL050.cbl
 22662*       DATASET   ('ELCRTO')
 22663*       FROM      (ORIGINAL-CERTIFICATE)
 22664*       RIDFLD    (OC-CONTROL-PRIMARY)
 22665*       RESP      (WS-RESPONSE)
 22666*    END-EXEC.
 22667     MOVE LENGTH OF
 22668      ORIGINAL-CERTIFICATE
 22669       TO DFHEIV11
 22670     MOVE 'ELCRTO' TO DFHEIV1
 22671*    MOVE '&$ L                  ''  N#00020928' TO DFHEIV0
 22672     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22673     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22674     MOVE X'204E233030303230393238' TO DFHEIV0(25:11)
 22675     CALL 'kxdfhei1' USING DFHEIV0,
 22676           DFHEIV1,
 22677           ORIGINAL-CERTIFICATE,
 22678           DFHEIV11,
 22679           OC-CONTROL-PRIMARY,
 22680           DFHEIV99,
 22681           DFHEIV99
 22682     MOVE EIBRESP  TO WS-RESPONSE
 22683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22684
 22685
 22686     GO TO 9991-EXIT.
 22687
 22688 9991-CHECK-INDICATORS.
 22689
 22690     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22691         GO TO 9991-EXIT
 22692     END-IF.
 22693
 22694     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22695         GO TO 9991-EXIT
 22696     END-IF.
 22697
 22698
 22699* EXEC CICS READ
 22700*       DATASET   ('ELCRTO')
 22701*       INTO      (ORIGINAL-CERTIFICATE)
 22702*       RIDFLD    (OC-CONTROL-PRIMARY)
 22703*       UPDATE
 22704*       RESP      (WS-RESPONSE)
 22705*    END-EXEC
 22706     MOVE LENGTH OF
 22707      ORIGINAL-CERTIFICATE
 22708       TO DFHEIV11
 22709     MOVE 'ELCRTO' TO DFHEIV1
 22710*    MOVE '&"IL       EU         (  N#00020947' TO DFHEIV0
 22711     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22713     MOVE X'204E233030303230393437' TO DFHEIV0(25:11)
 22714     CALL 'kxdfhei1' USING DFHEIV0,
 22715           DFHEIV1,
 22716           ORIGINAL-CERTIFICATE,
 22717           DFHEIV11,
 22718           OC-CONTROL-PRIMARY,
 22719           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 420
* EL050.cbl
 22720           DFHEIV99,
 22721           DFHEIV99
 22722     MOVE EIBRESP  TO WS-RESPONSE
 22723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22724     IF WS-RESP-NORMAL
 22725        IF PB-ISSUE
 22726          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22727          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22728          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22729          MOVE PB-I-AGE               TO OC-INS-AGE
 22730          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22731          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22732          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22733          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22734          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22735          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22736          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22737          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22738          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22739          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22740          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22741          IF PB-I-JOINT-COMMISSION > +0
 22742              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22743          ELSE
 22744              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22745          END-IF
 22746          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22747          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22748          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22749          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22750          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22751          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22752          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22753          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22754          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22755
 22756          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22757
 22758* EXEC CICS READ
 22759*             DATASET   (FILE-ERMAIL)
 22760*             RIDFLD    (MA-CONTROL-PRIMARY)
 22761*             INTO      (MAILING-DATA)
 22762*             RESP      (WS-RESPONSE)
 22763*         END-EXEC
 22764     MOVE LENGTH OF
 22765      MAILING-DATA
 22766       TO DFHEIV11
 22767*    MOVE '&"IL       E          (  N#00020987' TO DFHEIV0
 22768     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22769     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22770     MOVE X'204E233030303230393837' TO DFHEIV0(25:11)
 22771     CALL 'kxdfhei1' USING DFHEIV0,
 22772           FILE-ERMAIL,
 22773           MAILING-DATA,
 22774           DFHEIV11,
 22775           MA-CONTROL-PRIMARY,
 22776           DFHEIV99,
 22777           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 421
* EL050.cbl
 22778           DFHEIV99
 22779     MOVE EIBRESP  TO WS-RESPONSE
 22780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22781          IF WS-RESP-NORMAL
 22782             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22783          END-IF
 22784
 22785          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22786          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22787
 22788* EXEC CICS READ
 22789*             DATASET  (CRTT-ID)
 22790*             RIDFLD   (WS-ELCRTT-KEY)
 22791*             INTO     (CERTIFICATE-TRAILERS)
 22792*             RESP     (WS-RESPONSE)
 22793*         END-EXEC
 22794     MOVE LENGTH OF
 22795      CERTIFICATE-TRAILERS
 22796       TO DFHEIV11
 22797*    MOVE '&"IL       E          (  N#00020999' TO DFHEIV0
 22798     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22800     MOVE X'204E233030303230393939' TO DFHEIV0(25:11)
 22801     CALL 'kxdfhei1' USING DFHEIV0,
 22802           CRTT-ID,
 22803           CERTIFICATE-TRAILERS,
 22804           DFHEIV11,
 22805           WS-ELCRTT-KEY,
 22806           DFHEIV99,
 22807           DFHEIV99,
 22808           DFHEIV99
 22809     MOVE EIBRESP  TO WS-RESPONSE
 22810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22811          IF WS-RESP-NORMAL
 22812             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22813                               OC-INS-AGE-DEFAULT-FLAG
 22814             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22815                               OC-JNT-AGE-DEFAULT-FLAG
 22816          END-IF
 22817
 22818        ELSE
 22819          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22820             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22821             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22822             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22823          END-IF
 22824          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22825             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22826             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22827             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22828          END-IF
 22829          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22830        END-IF
 22831
 22832* EXEC CICS REWRITE
 22833*          DATASET   ('ELCRTO')
 22834*          FROM      (ORIGINAL-CERTIFICATE)
 22835*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 422
* EL050.cbl
 22836*       END-EXEC
 22837     MOVE LENGTH OF
 22838      ORIGINAL-CERTIFICATE
 22839       TO DFHEIV11
 22840     MOVE 'ELCRTO' TO DFHEIV1
 22841*    MOVE '&& L                  %  N#00021025' TO DFHEIV0
 22842     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22843     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22844     MOVE X'204E233030303231303235' TO DFHEIV0(25:11)
 22845     CALL 'kxdfhei1' USING DFHEIV0,
 22846           DFHEIV1,
 22847           ORIGINAL-CERTIFICATE,
 22848           DFHEIV11,
 22849           DFHEIV99
 22850     MOVE EIBRESP  TO WS-RESPONSE
 22851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22852     END-IF.
 22853
 22854 9991-EXIT.
 22855     EXIT.
 22856
 22857
 22858 9999-RETURN.
 22859     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22860
 22861
 22862* EXEC CICS RETURN
 22863*    END-EXEC.
 22864*    MOVE '.(                    ''   #00021039' TO DFHEIV0
 22865     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22866     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22867     MOVE X'2020233030303231303339' TO DFHEIV0(25:11)
 22868     CALL 'kxdfhei1' USING DFHEIV0,
 22869           DFHEIV99,
 22870           DFHEIV99,
 22871           DFHEIV99,
 22872           DFHEIV99,
 22873           DFHEIV99,
 22874           DFHEIV99
 22875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22876
 22877
 22878
 22879* GOBACK.
 22880     MOVE '9%                    "   ' TO DFHEIV0
 22881     MOVE 'EL050' TO DFHEIV1
 22882     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22883     GOBACK.
 22884
 22885 9999-DFHBACK SECTION.
 22886     MOVE '9%                    "   ' TO DFHEIV0
 22887     MOVE 'EL050' TO DFHEIV1
 22888     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22889     GOBACK.
 22890 9999-DFHEXIT.
 22891     IF DFHEIGDJ EQUAL 0001
 22892         NEXT SENTENCE
 22893     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 423
* EL050.cbl
 22894         GO TO 9300-ABEND,
 22895               3990-FILES-NOT-OPEN
 22896         DEPENDING ON DFHEIGDI
 22897     ELSE IF DFHEIGDJ EQUAL 3
 22898         GO TO 6610-START-BROWSE,
 22899               6630-ERRESS-PROBLEM,
 22900               6630-END-OF-FILE
 22901         DEPENDING ON DFHEIGDI
 22902     ELSE IF DFHEIGDJ EQUAL 4
 22903         GO TO 6630-END-OF-FILE,
 22904               6630-ERRESS-PROBLEM,
 22905               6630-ERRESS-PROBLEM,
 22906               6630-END-OF-FILE
 22907         DEPENDING ON DFHEIGDI
 22908     ELSE IF DFHEIGDJ EQUAL 5
 22909         GO TO 6630-END-OF-FILE,
 22910               6630-END-OF-FILE,
 22911               6630-ERRESS-PROBLEM,
 22912               6630-ERRESS-PROBLEM
 22913         DEPENDING ON DFHEIGDI
 22914     ELSE IF DFHEIGDJ EQUAL 6
 22915         GO TO 6660-START-BROWSE,
 22916               6690-ERRESC-PROBLEM,
 22917               6690-ERRESC-PROBLEM,
 22918               6690-END-OF-FILE
 22919         DEPENDING ON DFHEIGDI
 22920     ELSE IF DFHEIGDJ EQUAL 7
 22921         GO TO 6690-END-OF-FILE,
 22922               6690-ERRESC-PROBLEM,
 22923               6690-ERRESC-PROBLEM,
 22924               6690-END-OF-FILE
 22925         DEPENDING ON DFHEIGDI
 22926     ELSE IF DFHEIGDJ EQUAL 8
 22927         GO TO 6690-END-OF-FILE,
 22928               6690-ERRESC-PROBLEM,
 22929               6690-ERRESC-PROBLEM,
 22930               6690-END-OF-FILE
 22931         DEPENDING ON DFHEIGDI
 22932     ELSE IF DFHEIGDJ EQUAL 9
 22933         GO TO 7250-CONTINUE,
 22934               7250-CONTINUE
 22935         DEPENDING ON DFHEIGDI
 22936     ELSE IF DFHEIGDJ EQUAL 10
 22937         GO TO 7300-CONTINUE,
 22938               7300-CONTINUE
 22939         DEPENDING ON DFHEIGDI
 22940     ELSE IF DFHEIGDJ EQUAL 11
 22941         GO TO 8000-FREE-MAIN
 22942         DEPENDING ON DFHEIGDI
 22943     ELSE IF DFHEIGDJ EQUAL 12
 22944         GO TO 8100-NOTFND,
 22945               8100-NOTFND
 22946         DEPENDING ON DFHEIGDI
 22947     ELSE IF DFHEIGDJ EQUAL 13
 22948         GO TO 8110-NOTFND,
 22949               8110-NOTFND
 22950         DEPENDING ON DFHEIGDI
 22951     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 424
* EL050.cbl
 22952         GO TO 8130-EXIT
 22953         DEPENDING ON DFHEIGDI
 22954     ELSE IF DFHEIGDJ EQUAL 15
 22955         GO TO 8150-exit
 22956         DEPENDING ON DFHEIGDI
 22957     ELSE IF DFHEIGDJ EQUAL 16
 22958         GO TO 8180-NOTFND
 22959         DEPENDING ON DFHEIGDI
 22960     ELSE IF DFHEIGDJ EQUAL 17
 22961         GO TO 8190-NOTFND
 22962         DEPENDING ON DFHEIGDI
 22963     ELSE IF DFHEIGDJ EQUAL 18
 22964         GO TO 8195-NOTFND
 22965         DEPENDING ON DFHEIGDI
 22966     ELSE IF DFHEIGDJ EQUAL 19
 22967         GO TO 8200-NOTFND
 22968         DEPENDING ON DFHEIGDI
 22969     ELSE IF DFHEIGDJ EQUAL 20
 22970         GO TO 8300-NOTFND,
 22971               8300-ERRESS-PROBLEM,
 22972               8300-ERRESS-PROBLEM,
 22973               8300-NOTFND
 22974         DEPENDING ON DFHEIGDI
 22975     ELSE IF DFHEIGDJ EQUAL 21
 22976         GO TO 8450-FORM-NOT-FOUND,
 22977               8450-FORM-NOT-FOUND
 22978         DEPENDING ON DFHEIGDI
 22979     ELSE IF DFHEIGDJ EQUAL 22
 22980         GO TO 0199-ACCT-NOT-FOUND,
 22981               0199-ACCT-NOT-FOUND
 22982         DEPENDING ON DFHEIGDI
 22983     ELSE IF DFHEIGDJ EQUAL 23
 22984         GO TO 0199-ACCT-NOT-FOUND,
 22985               0199-ACCT-NOT-FOUND
 22986         DEPENDING ON DFHEIGDI
 22987     ELSE IF DFHEIGDJ EQUAL 24
 22988         GO TO 8582-COMP-NOT-FOUND,
 22989               8582-COMP-NOT-FOUND
 22990         DEPENDING ON DFHEIGDI
 22991     ELSE IF DFHEIGDJ EQUAL 25
 22992         GO TO 8583-AGTC-NOT-FOUND,
 22993               8583-AGTC-NOT-FOUND
 22994         DEPENDING ON DFHEIGDI
 22995     ELSE IF DFHEIGDJ EQUAL 26
 22996         GO TO 8584-BXRF-NOT-FOUND,
 22997               8584-BXRF-NOT-FOUND
 22998         DEPENDING ON DFHEIGDI
 22999     ELSE IF DFHEIGDJ EQUAL 27
 23000         GO TO 8585-PLAN-NOT-FOUND,
 23001               8585-PLAN-NOT-FOUND
 23002         DEPENDING ON DFHEIGDI
 23003     ELSE IF DFHEIGDJ EQUAL 28
 23004         GO TO 0299-CERT-NOT-FOUND
 23005         DEPENDING ON DFHEIGDI
 23006     ELSE IF DFHEIGDJ EQUAL 29
 23007         GO TO 8700-READ-CERT-MASTER
 23008         DEPENDING ON DFHEIGDI
 23009     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 14-Dec-17 07:58 Page 425
* EL050.cbl
 23010         GO TO 8720-COMP-ACCOUNTS,
 23011               8730-END-BROWSE,
 23012               8740-NOT-FOUND
 23013         DEPENDING ON DFHEIGDI
 23014     ELSE IF DFHEIGDJ EQUAL 31
 23015         GO TO 9000-NOTFND
 23016         DEPENDING ON DFHEIGDI
 23017     ELSE IF DFHEIGDJ EQUAL 32
 23018         GO TO 9100-NOTFND,
 23019               9100-NOTFND
 23020         DEPENDING ON DFHEIGDI
 23021     ELSE IF DFHEIGDJ EQUAL 33
 23022         GO TO 9991-CRTO-NOT-FOUND,
 23023               9991-CRTO-NOT-FOUND
 23024         DEPENDING ON DFHEIGDI.
 23025     MOVE '9%                    "   ' TO DFHEIV0
 23026     MOVE 'EL050' TO DFHEIV1
 23027     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23028     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41680     Code:       94512
