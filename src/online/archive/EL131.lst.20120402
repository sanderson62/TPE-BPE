* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   1
* EL131.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL131.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   2
* EL131.cbl
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27******************************************************************
    28
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   3
* EL131.cbl
    30 ENVIRONMENT DIVISION.
    31
    32 DATA DIVISION.
    33
    34 WORKING-STORAGE SECTION.
    35 01  DFH-START PIC X(04).
    36 01  LCP-TIME-OF-DAY-XX.
    37     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    38     05  FILLER                    PIC 99.
    39 01  LCP-CICS-TIME                 PIC 9(15).
    40
    41 77  FILLER  PIC X(32)  VALUE '********************************'.
    42 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    43 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    44
    45*                            COPY ELCSCTM.
    46******************************************************************
    47*                                                                *
    48*                                                                *
    49*                            ELCSCTM                             *
    50*                            VMOD=2.001                          *
    51*                                                                *
    52*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    53*                                                                *
    54******************************************************************
    55 01  SECURITY-MESSAGE.
    56     12  FILLER                          PIC X(30)
    57            VALUE '** LOGIC SECURITY VIOLATION -'.
    58     12  SM-READ                         PIC X(6).
    59     12  FILLER                          PIC X(5)
    60            VALUE ' PGM='.
    61     12  SM-PGM                          PIC X(6).
    62     12  FILLER                          PIC X(5)
    63            VALUE ' OPR='.
    64     12  SM-PROCESSOR-ID                 PIC X(4).
    65     12  FILLER                          PIC X(6)
    66            VALUE ' TERM='.
    67     12  SM-TERMID                       PIC X(4).
    68     12  FILLER                          PIC XX   VALUE SPACE.
    69     12  SM-JUL-DATE                     PIC 9(5).
    70     12  FILLER                          PIC X    VALUE SPACE.
    71     12  SM-TIME                         PIC 99.99.
    72
    73
    74*                            COPY ELCSCRTY.
    75******************************************************************
    76*                                                                *
    77*                                                                *
    78*                            ELCSCRTY                            *
    79*                            VMOD=2.001                          *
    80*                                                                *
    81*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    82*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    83*        SAVED IN PI-SECURITY-ADDRESS.                           *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-CONTROL.
    87     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   4
* EL131.cbl
    88     12  FILLER                       PIC XX    VALUE 'SC'.
    89     12  SC-CREDIT-CODES.
    90         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    91             20  SC-CREDIT-DISPLAY    PIC X.
    92             20  SC-CREDIT-UPDATE     PIC X.
    93     12  SC-CLAIMS-CODES.
    94         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    95             20  SC-CLAIMS-DISPLAY    PIC X.
    96             20  SC-CLAIMS-UPDATE     PIC X.
    97
    98*                            COPY ELCNWA.
    99*****************************************************************
   100*                                                               *
   101*                                                               *
   102*                            ELCNWA.                            *
   103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   104*                            VMOD=2.003                         *
   105*                                                               *
   106*            M O V E   N A M E   W O R K   A R E A.             *
   107*                                                               *
   108*****************************************************************.
   109
   110 01  WS-NAME-WORK-AREA.
   111     05  WS-INSURED-LAST-NAME        PIC X(15).
   112     05  WS-INSURED-1ST-NAME         PIC X(12).
   113     05  WS-INSURED-MID-INIT         PIC X.
   114
   115     05  WS-NAME-WORK.
   116         10  WS-NW                   PIC X
   117             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   118
   119     05  WS-NAME-WORK2.
   120         10  WS-NW2                  PIC X
   121             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   122                                        NWA-INDEX0.
   123
   124     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   125                                     COMP-3.
   126
   127
   128 01  WS-DATE-AREA.
   129     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   130     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   131     12  SAVE-DATE-CCYYMMDD.
   132         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   133         16  SAVE-DATE-YMD.
   134             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   135             20  FILLER         PIC X(4)    VALUE SPACES.
   136
   137 01  WS-BLANK                   PIC X       VALUE ' '.
   138
   139 01  CSO-WORK-FIELDS.
   140     05  WS-HOLD-CLAIM-STATUS    PIC X.
   141
   142 01  LITERALS-NUMBERS.
   143     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   144     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   145     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   5
* EL131.cbl
   146     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   147     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   148     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   149     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   150
   151     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   152     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   153     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   154     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   155     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   156     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   157     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   158     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   159     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   160
   161     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   162
   163     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   164
   165     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   166     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   167     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   168     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   169     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   170     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   171     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   172     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   173     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   174     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   175     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   176
   177     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   178     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   179     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   180     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   181         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   182     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   183     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   184     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   185     12  WS-CLAIM-SEQU.
   186         16  FILLER              PIC X VALUE '('.
   187         16  WS-CURRENT-SEQU     PIC Z9.
   188         16  FILLER              PIC X(04) VALUE ' OF '.
   189         16  WS-OF-SEQU          PIC Z9.
   190         16  FILLER              PIC X VALUE ')'.
   191     12  WS-EDIT-BEN-CODE        PIC XX.
   192         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   193                                          '90' THRU '99'.
   194
   195     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   196     12  WS-EDIT-NUMBER          PIC ZZZ9.
   197
   198     12  WS-RESPONSE             PIC S9(8)   COMP.
   199         88  WS-RESP-NORMAL                  VALUE +00.
   200         88  WS-RESP-NOTFND                  VALUE +13.
   201
   202     12  WS-MOS-PAID             PIC 999.
   203     12  WS-ODD-DAYS             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   6
* EL131.cbl
   204     12  WS-REM-MOS              PIC 999.
   205     12  WS-REM-DAYS             PIC 99.
   206     12  WS-TERM-IN-DAYS         PIC 9(4).
   207     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   208
   209     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   210     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   211     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   212     12  WS-RESET-SW             PIC X       VALUE 'N'.
   213     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   214     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   215     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   216
   217 01  DMD-DATE-YYYYMMDD.
   218     12  DMD-DECADE          PIC XX      VALUE SPACES.
   219     12  DMD-YYMMDD.
   220         16  DMD-YY          PIC XX      VALUE SPACES.
   221         16  DMD-MM          PIC XX      VALUE SPACES.
   222         16  DMD-DD          PIC XX      VALUE SPACES.
   223
   224 01  DMD-DATE-MMDDYYYY.
   225     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   226     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   227     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   228     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   229     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   230     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   231
   232 01  WS-MAIL-CODE.
   233     12  FILLER              PIC X.
   234     12  DMD-MAIL-CODE.
   235         16  WS-MAIL-4       PIC X(4).
   236         16  WS-MAIL-5       PIC X.
   237     12  FILLER              PIC X(4).
   238
   239     12  W-NAME-LAST             PIC  X(15).
   240     12  W-NAME-FIRST            PIC  X(15).
   241     12  W-NAME-MIDDLE.
   242         16  FILLER              PIC  X.
   243         16  W-NAME-MIDDLE-2     PIC  X.
   244         16  FILLER              PIC  X(13).
   245
   246*    COPY ELCDCTB.
   247******************************************************************
   248*                                                                *
   249*                                                                *
   250*                            ELCDCTB.                            *
   251*                            VMOD=2.002                          *
   252*                                                                *
   253*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   254*       COMMUNICATIONS AREA                                      *
   255*                                                                *
   256******************************************************************
   257 01  DCT-COMMUNICATION-AREA.
   258     12  DCT-BILLING-BANK-ID      PIC  X(05).
   259     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   260     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   261     12  DCT-PRODUCT-CODE         PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   7
* EL131.cbl
   262     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   263     12  DCT-RETURN-CODE          PIC  X(02).
   264     12  DCT-MAIL-CODE            PIC  X(05).
   265     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   266     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   8
* EL131.cbl
   268 01  ERROR-SWITCHES.
   269     12  ERROR-SWITCH            PIC X.
   270         88  SCREEN-ERROR                    VALUE 'X'.
   271     12  MSTR-KEY-SWITCH         PIC X.
   272         88  MSTR-KEY-CHANGED                VALUE 'X'.
   273     12  CERT-KEY-SWITCH         PIC X.
   274*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   275         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   276*********SET TO Y IF PRIMARY KEY WILL CHANGE
   277         88  CERT-KEY-CHANGED                VALUE 'Y'.
   278     12  MSTR-SWITCH             PIC X.
   279         88  MSTR-UPDATES                    VALUE 'X'.
   280     12  CERT-SWITCH             PIC X.
   281         88  CERT-UPDATES                    VALUE 'X'.
   282     12  UPDATE-SWITCH           PIC X.
   283         88  UPDATES-PRESENT                 VALUE 'X'.
   284     12  TRLR-SWITCH             PIC X.
   285         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   286         88  UPDATE-MADE                     VALUE 'Y'.
   287     12  NINETY-TRLR-SWITCH      PIC X.
   288         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   289     12  EARNINGS-CALC-SWITCH    PIC X.
   290         88  TEX-REG                         VALUE '4'.
   291         88  NET-PAY                         VALUE '5'.
   292     12  DLYACTV-SW              PIC X       VALUE 'N'.
   293         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   9
* EL131.cbl
   295 01  EDIT-WORK-AREA.
   296     12  COUNT-2                 PIC 9.
   297     12  CALL-PGM                PIC X(8).
   298     12  TRANS-ID                PIC X(4).
   299     12  CHECK-PFKEYS            PIC 99.
   300     12  CHECK-MAINT             PIC X.
   301         88  ADD-ALPHA-RECORD                VALUE 'A'.
   302         88  CHANGE-CLAIM                    VALUE 'C'.
   303         88  DELETE-CLAIM                    VALUE 'D'.
   304         88  CHANGE-NAME                     VALUE 'N'.
   305         88  VALID-OPTIONS                   VALUE 'A' 'C'
   306                                                   'D' 'N'.
   307
   308     12  HOLD-BENEFIT            PIC XX.
   309     12  HOLD-FREQ               PIC XX.
   310     12  HOLD-REPORTED           PIC XX.
   311     12  HOLD-INCUR              PIC XX.
   312     12  HOLD-PDTHRU             PIC XX.
   313     12  HOLD-ADDON              PIC XX.
   314     12  HOLD-NODAYS             PIC 9(4).
   315     12  HOLD-NOPMTS             PIC 9(3).
   316     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   317     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   318     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   319     12  HOLD-BIRTH              PIC XX.
   320     12  HOLD-END                PIC XX.
   321     12  HOLD-EFF                PIC XX.
   322     12  HOLD-ENTRY              PIC XX.
   323     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   324     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   325     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   326     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   327     12  HOLD-LF-CV-CAN          PIC XX.
   328     12  HOLD-AH-CV-CAN          PIC XX.
   329     12  DIVIDE-QUOT             PIC 9(3).
   330     12  DIVIDE-REM              PIC 9(3).
   331
   332     12  WS-ALPHA-DATE.
   333         16  WS-ALPHA-YEAR.
   334             20  WS-ALPHA-YY-1   PIC 99.
   335             20  WS-ALPHA-YY-2   PIC 99.
   336         16  WS-ALPHA-MM         PIC 99.
   337         16  WS-ALPHA-DD         PIC 99.
   338
   339     12  BUILD-VALID-DATE.
   340         16  BUILD-MONTH         PIC 99.
   341         16  BUILD-DAY           PIC 99.
   342         16  BUILD-YEAR          PIC 99.
   343     12  DEEDIT-MMYY-INPUT.
   344         16  FILLER              PIC X.
   345         16  DEEDIT-MONTH        PIC XX.
   346         16  DEEDIT-YEAR         PIC XX.
   347     12  DEEDIT-BEN              PIC 9(9)V99.
   348     12  DEEDIT-DATE-INPUT.
   349         16  FILLER              PIC XX.
   350         16  DEEDIT-DATE         PIC X(6).
   351     12  WORK-DATE-MDY.
   352         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  10
* EL131.cbl
   353         16  FILLER              PIC X(4).
   354         16  YEAR-WORK           PIC XX.
   355     12  WORK-DATE-MY.
   356         16  WORK-MONTH          PIC XX.
   357         16  WORK-SLASH          PIC X       VALUE '/'.
   358         16  WORK-YEAR           PIC XX.
   359     12  HOLD-DATE.
   360         16  HOLD-MONTH          PIC 99.
   361         16  FILLER              PIC X(4).
   362         16  HOLD-YEAR           PIC 99.
   363     12  SPLIT-INFO-LINE-1.
   364         16  SPLIT-INFO-DESC     PIC X(15).
   365         16  FILLER              PIC X(5)    VALUE ' OLD='.
   366         16  SPLIT-INFO-OLD      PIC X(40).
   367     12  EFF-TERM-MO             PIC 9(4).
   368     12  CURR-MO                 PIC 9(4).
   369     12  WS-BIN-CURRENT-DT       PIC XX.
   370     12  WS-CALC-METHOD          PIC X.
   371     12  WS-INITIALS.
   372         16  WS-INIT-1           PIC X.
   373         16  WS-INIT-2           PIC X.
   374     12  WS-REIN-TABLE.
   375         16  WS-REIN-1           PIC X.
   376         16  WS-REIN-2           PIC X.
   377         16  WS-REIN-3           PIC X.
   378     12  PI-KEY.
   379         16  PI-TERM             PIC X(4).
   380         16  PI-QUAL             PIC X(4).
   381     12  CHECK-KEY               PIC X(20).
   382     12  SAVE-ACCT-KEY           PIC X(20).
   383     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   384     12  WS-SOC-SEC-NUMBER.
   385         16  WS-SOC-SEC-NO       PIC 9(9).
   386         16  WS-SOC-SEC-BLANK    PIC X(2).
   387     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   388         16  WS-SSN-1-3          PIC 9(3).
   389         16  WS-SSN-DASH1        PIC X(1).
   390         16  WS-SSN-4-5          PIC 9(2).
   391         16  WS-SSN-DASH2        PIC X(1).
   392         16  WS-SSN-6-9          PIC 9(4).
   393
   394 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   395     12  M                   PIC S9(7)V99           VALUE ZEROS.
   396     12  L                   PIC S9(7)V99           VALUE ZEROS.
   397     12  N                   PIC S9(3)              VALUE ZEROS.
   398     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   399     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   400     12  I                   PIC S99V9(5)           VALUE ZEROS.
   401     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   402     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   403     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   404     12  R                   PIC S9(3)              VALUE ZEROS.
   405     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   406     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   407     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   408     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   409     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   410     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  11
* EL131.cbl
   411     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   412     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   413     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   414
   415 01  TERM-CALC-WORK-AREA.
   416     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   417     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   418     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   419     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   420     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   421     12  V-EXPONENTS.
   422        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   423     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   424
   425 01  TIME-IN.
   426     12  UN-HOURS                PIC XX.
   427     12  UN-MINUTES              PIC XX.
   428     12  FILLER                  PIC XX.
   429
   430 01  TIME-OUT.
   431     12  FOR-HOURS               PIC XX.
   432     12  FILLER                  PIC X       VALUE '.'.
   433     12  FOR-MINUTES             PIC XX.
   434
   435 01  ERROR-NUMBERS.
   436     12  ER-0000                 PIC X(4)    VALUE '0000'.
   437     12  ER-0004                 PIC X(4)    VALUE '0004'.
   438     12  ER-0008                 PIC X(4)    VALUE '0008'.
   439     12  ER-0023                 PIC X(4)    VALUE '0023'.
   440     12  ER-0029                 PIC X(4)    VALUE '0029'.
   441     12  ER-0068                 PIC X(4)    VALUE '0068'.
   442     12  ER-0070                 PIC X(4)    VALUE '0070'.
   443     12  ER-0149                 PIC X(4)    VALUE '0149'.
   444     12  ER-0154                 PIC X(4)    VALUE '0154'.
   445     12  ER-0169                 PIC X(4)    VALUE '0169'.
   446     12  ER-0192                 PIC X(4)    VALUE '0192'.
   447     12  ER-0199                 PIC X(4)    VALUE '0199'.
   448     12  ER-0203                 PIC X(4)    VALUE '0203'.
   449     12  ER-0204                 PIC X(4)    VALUE '0204'.
   450     12  ER-0205                 PIC X(4)    VALUE '0205'.
   451     12  ER-0206                 PIC X(4)    VALUE '0206'.
   452     12  ER-0208                 PIC X(4)    VALUE '0208'.
   453     12  ER-0210                 PIC X(4)    VALUE '0210'.
   454     12  ER-0215                 PIC X(4)    VALUE '0215'.
   455     12  ER-0219                 PIC X(4)    VALUE '0219'.
   456     12  ER-0220                 PIC X(4)    VALUE '0220'.
   457     12  ER-0222                 PIC X(4)    VALUE '0222'.
   458     12  ER-0223                 PIC X(4)    VALUE '0223'.
   459     12  ER-0224                 PIC X(4)    VALUE '0224'.
   460     12  ER-0227                 PIC X(4)    VALUE '0227'.
   461     12  ER-0230                 PIC X(4)    VALUE '0230'.
   462     12  ER-0232                 PIC X(4)    VALUE '0232'.
   463     12  ER-0233                 PIC X(4)    VALUE '0233'.
   464     12  ER-0236                 PIC X(4)    VALUE '0236'.
   465     12  ER-0237                 PIC X(4)    VALUE '0237'.
   466     12  ER-0238                 PIC X(4)    VALUE '0238'.
   467     12  ER-0240                 PIC X(4)    VALUE '0240'.
   468     12  ER-0241                 PIC X(4)    VALUE '0241'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  12
* EL131.cbl
   469     12  ER-0243                 PIC X(4)    VALUE '0243'.
   470     12  ER-0244                 PIC X(4)    VALUE '0244'.
   471     12  ER-0246                 PIC X(4)    VALUE '0246'.
   472     12  ER-0247                 PIC X(4)    VALUE '0247'.
   473     12  ER-0248                 PIC X(4)    VALUE '0248'.
   474     12  ER-0250                 PIC X(4)    VALUE '0250'.
   475     12  ER-0251                 PIC X(4)    VALUE '0251'.
   476     12  ER-0253                 PIC X(4)    VALUE '0253'.
   477     12  ER-0256                 PIC X(4)    VALUE '0256'.
   478     12  ER-0257                 PIC X(4)    VALUE '0257'.
   479     12  ER-0258                 PIC X(4)    VALUE '0258'.
   480     12  ER-0259                 PIC X(4)    VALUE '0259'.
   481     12  ER-0260                 PIC X(4)    VALUE '0260'.
   482     12  ER-0261                 PIC X(4)    VALUE '0261'.
   483     12  ER-0262                 PIC X(4)    VALUE '0262'.
   484     12  ER-0263                 PIC X(4)    VALUE '0263'.
   485     12  ER-0273                 PIC X(4)    VALUE '0273'.
   486     12  ER-0274                 PIC X(4)    VALUE '0274'.
   487     12  ER-0276                 PIC X(4)    VALUE '0276'.
   488     12  ER-0282                 PIC X(4)    VALUE '0282'.
   489     12  ER-0283                 PIC X(4)    VALUE '0283'.
   490     12  ER-0309                 PIC X(4)    VALUE '0309'.
   491     12  ER-0310                 PIC X(4)    VALUE '0310'.
   492     12  ER-0311                 PIC X(4)    VALUE '0311'.
   493     12  ER-0333                 PIC X(4)    VALUE '0333'.
   494     12  ER-0360                 PIC X(4)    VALUE '0360'.
   495     12  ER-0377                 PIC X(4)    VALUE '0377'.
   496     12  ER-0402                 PIC X(4)    VALUE '0402'.
   497     12  ER-0416                 PIC X(4)    VALUE '0416'.
   498     12  ER-0426                 PIC X(4)    VALUE '0426'.
   499     12  ER-0427                 PIC X(4)    VALUE '0427'.
   500     12  ER-0428                 PIC X(4)    VALUE '0428'.
   501     12  ER-0429                 PIC X(4)    VALUE '0429'.
   502     12  ER-0430                 PIC X(4)    VALUE '0430'.
   503     12  ER-0475                 PIC X(4)    VALUE '0475'.
   504     12  ER-0491                 PIC X(4)    VALUE '0491'.
   505     12  ER-0509                 PIC X(4)    VALUE '0509'.
   506     12  ER-0510                 PIC X(4)    VALUE '0510'.
   507     12  ER-0519                 PIC X(4)    VALUE '0519'.
   508     12  ER-0520                 PIC X(4)    VALUE '0520'.
   509     12  ER-0521                 PIC X(4)    VALUE '0521'.
   510     12  ER-0547                 PIC X(4)    VALUE '0547'.
   511     12  ER-0548                 PIC X(4)    VALUE '0548'.
   512     12  ER-0549                 PIC X(4)    VALUE '0549'.
   513     12  ER-0565                 PIC X(4)    VALUE '0565'.
   514     12  ER-0598                 PIC X(4)    VALUE '0598'.
   515     12  ER-0639                 PIC X(4)    VALUE '0639'.
   516     12  ER-0797                 PIC X(4)    VALUE '0797'.
   517     12  ER-0802                 PIC X(4)    VALUE '0802'.
   518     12  ER-0803                 PIC X(4)    VALUE '0803'.
   519     12  ER-0849                 PIC X(4)    VALUE '0849'.
   520     12  ER-0885                 PIC X(4)    VALUE '0885'.
   521     12  ER-0887                 PIC X(4)    VALUE '0887'.
   522     12  ER-0919                 PIC X(4)    VALUE '0919'.
   523     12  ER-0921                 PIC X(4)    VALUE '0921'.
   524     12  ER-0938                 PIC X(4)    VALUE '0938'.
   525     12  ER-0946                 PIC X(4)    VALUE '0946'.
   526     12  ER-0947                 PIC X(4)    VALUE '0947'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  13
* EL131.cbl
   527     12  ER-0948                 PIC X(4)    VALUE '0948'.
   528     12  ER-0949                 PIC X(4)    VALUE '0949'.
   529     12  ER-0950                 PIC X(4)    VALUE '0950'.
   530     12  ER-0951                 PIC X(4)    VALUE '0951'.
   531     12  ER-0954                 PIC X(4)    VALUE '0954'.
   532     12  ER-0974                 PIC X(4)    VALUE '0974'.
   533     12  ER-0975                 PIC X(4)    VALUE '0975'.
   534     12  ER-2280                 PIC X(4)    VALUE '2280'.
   535     12  ER-2878                 PIC X(4)    VALUE '2878'.
   536     12  ER-7641                 PIC X(4)    VALUE '7641'.
   537     12  ER-7642                 PIC X(4)    VALUE '7642'.
   538     12  ER-7650                 PIC X(4)    VALUE '7650'.
   539     12  ER-7651                 PIC X(4)    VALUE '7651'.
   540     12  ER-7687                 PIC X(4)    VALUE '7687'.
   541     12  ER-7689                 PIC X(4)    VALUE '7689'.
   542     12  ER-7690                 PIC X(4)    VALUE '7690'.
   543     12  ER-7691                 PIC X(4)    VALUE '7691'.
   544     12  ER-8003                 PIC X(4)    VALUE '8003'.
   545     12  ER-8051                 PIC X(4)    VALUE '8051'.
   546     12  ER-8052                 PIC X(4)    VALUE '8052'.
   547     12  ER-8053                 PIC X(4)    VALUE '8053'.
   548     12  ER-8054                 PIC X(4)    VALUE '8054'.
   549     12  ER-8055                 PIC X(4)    VALUE '8055'.
   550     12  ER-8056                 PIC X(4)    VALUE '8056'.
   551     12  ER-8057                 PIC X(4)    VALUE '8057'.
   552     12  ER-8058                 PIC X(4)    VALUE '8058'.
   553     12  ER-8059                 PIC X(4)    VALUE '8059'.
   554     12  ER-8060                 PIC X(4)    VALUE '8060'.
   555     12  ER-8061                 PIC X(4)    VALUE '8061'.
   556     12  ER-8062                 PIC X(4)    VALUE '8062'.
   557     12  ER-8063                 PIC X(4)    VALUE '8063'.
   558     12  ER-8064                 PIC X(4)    VALUE '8064'.
   559     12  ER-8065                 PIC X(4)    VALUE '8065'.
   560     12  ER-8066                 PIC X(4)    VALUE '8066'.
   561     12  ER-8152                 PIC X(4)    VALUE '8152'.
   562     12  ER-8153                 PIC X(4)    VALUE '8153'.
   563     12  ER-8154                 PIC X(4)    VALUE '8154'.
   564     12  ER-8155                 PIC X(4)    VALUE '8155'.
   565
   566 01  MSTR-KEY.
   567     12  COMPANY-CODE            PIC X.
   568     12  CARRIER-CODE            PIC X.
   569     12  CLAIM-NO                PIC X(7).
   570     12  CERT-NO.
   571         16  CERT-NO-PRIME       PIC X(10).
   572         16  CERT-NO-SUFX        PIC X.
   573
   574 01  WS-SAVE-CLAIM-KEY.
   575     12  WS-SAVE-COMPANY-CD      PIC X.
   576     12  WS-SAVE-CARRIER         PIC X.
   577     12  WS-SAVE-CLAIM-NO        PIC X(7).
   578     12  WS-SAVE-CERT-NO.
   579         16  WS-CERT-NO-PRIME    PIC X(10).
   580         16  WS-CERT-NO-SUFX     PIC X.
   581
   582 01  CERT-KEY.
   583     12  CERT-COMPANY-CODE       PIC X.
   584     12  CERT-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  14
* EL131.cbl
   585     12  CERT-GROUP              PIC X(6).
   586     12  CERT-STATE              PIC XX.
   587     12  CERT-ACCOUNT            PIC X(10).
   588     12  CERT-DATE               PIC XX.
   589     12  CERT-CERT.
   590         16  CERT-CERT-PRIME     PIC X(10).
   591         16  CERT-CERT-SUFX      PIC X.
   592
   593 01  NOTE-KEY.
   594     12  NOTE-COMP-CD            PIC X.
   595     12  NOTE-CERT-KEY.
   596         16  NOTE-CARRIER        PIC X.
   597         16  NOTE-GROUP          PIC X(6).
   598         16  NOTE-STATE          PIC XX.
   599         16  NOTE-ACCOUNT        PIC X(10).
   600         16  NOTE-DATE           PIC XX.
   601         16  NOTE-CERT-NO        PIC X(11).
   602
   603 01  TRLR-KEY.
   604     12  TRLR-MAIN-KEY.
   605         16  TRLR-COMPANY-CD     PIC X.
   606         16  TRLR-CARRIER        PIC X.
   607         16  TRLR-CLAIM-NO       PIC X(07).
   608         16  TRLR-CERT-NO        PIC X(11).
   609     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   610
   611 01  BENEFIT-KEY.
   612     12  BEN-CO-ID               PIC X(3).
   613     12  BEN-REC-TYPE            PIC X.
   614     12  FILLER                  PIC XX.
   615     12  BEN-ACC-CD              PIC XX.
   616     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   617
   618 01  CNTL-KEY.
   619     12  CNTL-CO-ID              PIC X(3).
   620     12  CNTL-REC-TYPE           PIC X.
   621     12  CNTL-PROC-ID            PIC X(4).
   622     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   623         16  CNTL-STATE-NUMBER   PIC XX.
   624         16  FILLER              PIC XX.
   625     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   626         16  FILLER              PIC X(3).
   627         16  CNTL-CARRIER        PIC X.
   628     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   629
   630 01  ACTQ-KEY                    PIC X(20).
   631
   632 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   633
   634 01  CHKQ-KEY.
   635     12  CHKQ-COMPANY-CODE       PIC X.
   636     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   637     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   638
   639 01  ARCH-KEY.
   640     12  ARCH-COMPANY-CODE       PIC X.
   641     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   642     12  ARCH-RECORD-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  15
* EL131.cbl
   643     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   644
   645 01  ACCT-KEY.
   646     05  ACCT-PARTIAL-KEY.
   647         12  ACCT-COMPANY-CODE   PIC X.
   648         12  ACCT-CARRIER        PIC X.
   649         12  ACCT-GROUP          PIC X(6).
   650         12  ACCT-STATE          PIC XX.
   651         12  ACCT-ACCOUNT        PIC X(10).
   652     05  ACCT-DATE               PIC XX.
   653
   654 01  WS-ELBENE-KEY.
   655     12  WS-ELBENE-COMPANY-CD    PIC X.
   656     12  WS-ELBENE-RECORD-TYPE   PIC X.
   657     12  WS-ELBENE-ID            PIC X(10).
   658
   659 01  ELALPH-KEY.
   660     12  ELALPH-COMPANY-CD       PIC X.
   661     12  ELALPH-SOURCE           PIC X.
   662     12  ELALPH-NAME.
   663         16  ELALPH-LAST-NAME    PIC X(15).
   664         16  ELALPH-FIRST-NAME.
   665             20  ELALPH-FIRST-INIT   PIC X.
   666             20  FILLER              PIC X(11).
   667         16  ELALPH-MIDDLE-INIT  PIC X.
   668     12  ELALPH-DATE             PIC X(08).
   669     12  ELALPH-TIME             PIC S9(04)    COMP.
   670
   671 01  COMP-LENGTHS.
   672     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   673     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   674     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   675     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   676     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   677     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   678     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   679     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   680     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   681     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   682     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   683     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   684     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   685     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  16
* EL131.cbl
   687*                                COPY ELCLNKLT.
   688******************************************************************
   689*                                                                *
   690*                                                                *
   691*                           ELCLNKLT                             *
   692*                            VMOD=2.003                          *
   693*                                                                *
   694*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   695*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   696*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   697*                                                                *
   698*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   699*   COMPLETING THE REQUIRED FIELDS.                              *
   700*                                                                *
   701*   THE CALLING PROGRAM SHOULD CHECK:                            *
   702*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   703*                              9999 INDICATES AN UNKNOWN ABEND   *
   704*                                   WAS DETECTED.                *
   705*                              ALL OTHER VALUES ARE NORMAL ERROR *
   706*                              CODES FOUND IN THE ERROR FILE.    *
   707******************************************************************
   708 01  W-1523-LINKDATA.
   709     12  W-1523-COMMON-PI-DATA.
   710         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   711         16  FILLER              PIC  X(67).
   712         16  W-1523-COMPANY-CD   PIC  X(01).
   713         16  FILLER              PIC  X(10).
   714         16  W-1523-CONTROL-IN-PROGRESS.
   715             20  W-1523-CARRIER  PIC  X(01).
   716             20  W-1523-GROUPING PIC  X(06).
   717             20  W-1523-STATE    PIC  X(02).
   718             20  W-1523-ACCOUNT  PIC  X(10).
   719             20  W-1523-CLAIM-CERT-GRP.
   720                 24  W-1523-CLAIM-NO
   721                                 PIC  X(07).
   722                 24  W-1523-CERT-NO.
   723                     28  W-1523-CERT-PRIME
   724                                 PIC  X(10).
   725                     28  W-1523-CERT-SFX
   726                                 PIC  X(01).
   727                 24  W-1523-CERT-EFF-DT
   728                                 PIC  X(02).
   729         16  FILLER              PIC X(265).
   730
   731     12  W-1523-WORK-AREA.
   732         16  W-1523-FORM-NUMBER  PIC  X(04).
   733         16  W-1523-NUMBER-COPIES
   734                                 PIC  9(01).
   735         16  W-1523-ADDR-TYPE    PIC  X(02).
   736         16  W-1523-FOLLOW-UP-DATE
   737                                 PIC  X(02).
   738         16  W-1523-RESEND-DATE  PIC  X(02).
   739         16  W-1523-ERROR-CODE   PIC  9(04).
   740             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   741             88  W-1523-FATAL-ERROR
   742                                    VALUES  0006 0013 0042
   743                                            0154 0168 0169
   744                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  17
* EL131.cbl
   745                                            0179 0186 0281
   746                                            0332 2055 3697
   747                                            3698 3699 3770
   748                                            3771 3772 7675
   749                                            9106 9808 9883
   750                                            9887.
   751             88  W-1523-STOP-ERRORS
   752                                    VALUES  0013 0042 0154
   753                                            0168 0169 0172
   754                                            0281 0332 2055
   755                                            3698 3699 7675
   756                                            9106 9808 9883
   757                                            9999.
   758         16  W-1523-REASON       PIC  X(70).
   759         16  W-1523-ARCHIVE-NUMBER
   760                                 PIC  9(08).
   761     12  W-1523-POINTER-AREA.
   762         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   763         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   764         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   765         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   766         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  18
* EL131.cbl
   768*                                COPY ELCINTF.
   769******************************************************************
   770*                                                                *
   771*                                                                *
   772*                            ELCINTF.                            *
   773*                            VMOD=2.017                          *
   774*                                                                *
   775*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   776*                                                                *
   777*       LENGTH = 1024                                            *
   778*                                                                *
   779******************************************************************
   780 01  PROGRAM-INTERFACE-BLOCK.
   781     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   782     12  PI-CALLING-PROGRAM              PIC X(8).
   783     12  PI-SAVED-PROGRAM-1              PIC X(8).
   784     12  PI-SAVED-PROGRAM-2              PIC X(8).
   785     12  PI-SAVED-PROGRAM-3              PIC X(8).
   786     12  PI-SAVED-PROGRAM-4              PIC X(8).
   787     12  PI-SAVED-PROGRAM-5              PIC X(8).
   788     12  PI-SAVED-PROGRAM-6              PIC X(8).
   789     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   790     12  PI-COMPANY-ID                   PIC XXX.
   791     12  PI-COMPANY-CD                   PIC X.
   792
   793     12  PI-COMPANY-PASSWORD             PIC X(8).
   794
   795     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   796
   797     12  PI-CONTROL-IN-PROGRESS.
   798         16  PI-CARRIER                  PIC X.
   799         16  PI-GROUPING                 PIC X(6).
   800         16  PI-STATE                    PIC XX.
   801         16  PI-ACCOUNT                  PIC X(10).
   802         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   803                                         PIC X(10).
   804         16  PI-CLAIM-CERT-GRP.
   805             20  PI-CLAIM-NO             PIC X(7).
   806             20  PI-CERT-NO.
   807                 25  PI-CERT-PRIME       PIC X(10).
   808                 25  PI-CERT-SFX         PIC X.
   809             20  PI-CERT-EFF-DT          PIC XX.
   810         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   811             20  PI-PLAN-CODE            PIC X(2).
   812             20  PI-REVISION-NUMBER      PIC X(3).
   813             20  PI-PLAN-EFF-DT          PIC X(2).
   814             20  PI-PLAN-EXP-DT          PIC X(2).
   815             20  FILLER                  PIC X(11).
   816         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   817             20  PI-OE-REFERENCE-1.
   818                 25  PI-OE-REF-1-PRIME   PIC X(18).
   819                 25  PI-OE-REF-1-SUFF    PIC XX.
   820
   821     12  PI-SESSION-IN-PROGRESS          PIC X.
   822         88  CLAIM-SESSION                   VALUE '1'.
   823         88  CREDIT-SESSION                  VALUE '2'.
   824         88  WARRANTY-SESSION                VALUE '3'.
   825         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  19
* EL131.cbl
   826         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   827
   828
   829*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   830
   831     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   832     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   833
   834     12  PI-CREDIT-USER                  PIC X.
   835         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   836         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   837
   838     12  PI-CLAIM-USER                   PIC X.
   839         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   840         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   841
   842     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   843         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   844         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   845         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   846         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   847         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   848
   849     12  PI-PROCESSOR-ID                 PIC X(4).
   850
   851     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   852
   853     12  PI-MEMBER-CAPTION               PIC X(10).
   854
   855     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   856         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   857
   858     12  PI-LIFE-OVERRIDE-L1             PIC X.
   859     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   860     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   861     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   862
   863     12  PI-AH-OVERRIDE-L1               PIC X.
   864     12  PI-AH-OVERRIDE-L2               PIC XX.
   865     12  PI-AH-OVERRIDE-L6               PIC X(6).
   866     12  PI-AH-OVERRIDE-L12              PIC X(12).
   867
   868     12  PI-NEW-SYSTEM                   PIC X(2).
   869
   870     12  PI-PRIMARY-CERT-NO              PIC X(11).
   871     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   872         88  PI-USES-PAID-TO                 VALUE '1'.
   873     12  PI-CRDTCRD-SYSTEM.
   874         16  PI-CRDTCRD-USER             PIC X.
   875             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   876             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   877         16  PI-CC-MONTH-END-DT          PIC XX.
   878     12  PI-PROCESSOR-PRINTER            PIC X(4).
   879
   880     12  PI-OE-REFERENCE-2.
   881         16  PI-OE-REF-2-PRIME           PIC X(10).
   882         16  PI-OE-REF-2-SUFF            PIC X.
   883
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  20
* EL131.cbl
   884     12  PI-REM-TRM-CALC-OPTION          PIC X.
   885
   886     12  PI-LANGUAGE-TYPE                PIC X.
   887             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   888             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   889             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   890
   891     12  PI-POLICY-LINKAGE-IND           PIC X.
   892         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   893         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   894                                                   LOW-VALUES.
   895
   896     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   897     12  PI-CLAIM-PW-SESSION             PIC X(1).
   898         88  PI-CLAIM-CREDIT                 VALUE '1'.
   899         88  PI-CLAIM-CONVEN                 VALUE '2'.
   900     12  FILLER                          PIC X(4).
   901
   902     12  PI-SYSTEM-LEVEL                 PIC X(145).
   903
   904     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   905         PI-SYSTEM-LEVEL.
   906
   907         16  PI-ENTRY-CODES.
   908             20  PI-ENTRY-CD-1           PIC X.
   909             20  PI-ENTRY-CD-2           PIC X.
   910
   911         16  PI-RETURN-CODES.
   912             20  PI-RETURN-CD-1          PIC X.
   913             20  PI-RETURN-CD-2          PIC X.
   914
   915         16  PI-UPDATE-STATUS-SAVE.
   916             20  PI-UPDATE-BY            PIC X(4).
   917             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   918
   919         16  PI-LOWER-CASE-LETTERS       PIC X.
   920             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   921
   922*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   923*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   924*            88  CARRIER-CLM-CNTL            VALUE '2'.
   925
   926         16  PI-CERT-ACCESS-CONTROL      PIC X.
   927             88  ST-ACCNT-CNTL               VALUE ' '.
   928             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   929             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   930             88  ACCNT-CNTL                  VALUE '3'.
   931             88  CARR-ACCNT-CNTL             VALUE '4'.
   932
   933         16  PI-PROCESSOR-CAP-LIST.
   934             20  PI-SYSTEM-CONTROLS.
   935                24 PI-SYSTEM-DISPLAY     PIC X.
   936                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   937                24 PI-SYSTEM-MODIFY      PIC X.
   938                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   939             20  FILLER                  PIC XX.
   940             20  PI-DISPLAY-CAP          PIC X.
   941                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  21
* EL131.cbl
   942             20  PI-MODIFY-CAP           PIC X.
   943                 88  MODIFY-CAP              VALUE 'Y'.
   944             20  PI-MSG-AT-LOGON-CAP     PIC X.
   945                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   946             20  PI-FORCE-CAP            PIC X.
   947                 88  FORCE-CAP               VALUE 'Y'.
   948
   949         16  PI-PROGRAM-CONTROLS.
   950             20  PI-PGM-PRINT-OPT        PIC X.
   951             20  PI-PGM-FORMAT-OPT       PIC X.
   952             20  PI-PGM-PROCESS-OPT      PIC X.
   953             20  PI-PGM-TOTALS-OPT       PIC X.
   954
   955         16  PI-HELP-INTERFACE.
   956             20  PI-LAST-ERROR-NO        PIC X(4).
   957             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   958
   959         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   960             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   961
   962         16  PI-CR-CONTROL-IN-PROGRESS.
   963             20  PI-CR-CARRIER           PIC X.
   964             20  PI-CR-GROUPING          PIC X(6).
   965             20  PI-CR-STATE             PIC XX.
   966             20  PI-CR-ACCOUNT           PIC X(10).
   967             20  PI-CR-FIN-RESP          PIC X(10).
   968             20  PI-CR-TYPE              PIC X.
   969
   970         16  PI-CR-BATCH-NUMBER          PIC X(6).
   971
   972         16  PI-CR-MONTH-END-DT          PIC XX.
   973
   974         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   975             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   976             88  PI-ZERO-CARRIER             VALUE '1'.
   977             88  PI-ZERO-GROUPING            VALUE '2'.
   978             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   979
   980         16  PI-CARRIER-SECURITY         PIC X.
   981             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   982
   983         16  PI-ACCOUNT-SECURITY         PIC X(10).
   984             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   985             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   986
   987         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   988             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   989                                         INDEXED BY PI-ACCESS-NDX
   990                                         PIC X.
   991
   992         16  PI-GA-BILLING-CONTROL       PIC X.
   993             88  PI-GA-BILLING               VALUE '1'.
   994
   995         16  PI-MAIL-PROCESSING          PIC X.
   996             88  PI-MAIL-YES                 VALUE 'Y'.
   997
   998         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   999
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  22
* EL131.cbl
  1000         16  PI-AR-SYSTEM.
  1001             20  PI-AR-PROCESSING-CNTL   PIC X.
  1002                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1003             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1004             20  PI-AR-MONTH-END-DT      PIC XX.
  1005
  1006         16  PI-MP-SYSTEM.
  1007             20  PI-MORTGAGE-USER            PIC X.
  1008                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1009                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1010             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1011                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1012                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1013                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1014                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1015                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1016             20  PI-MP-MONTH-END-DT          PIC XX.
  1017             20  PI-MP-REFERENCE-NO.
  1018                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1019                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1020
  1021         16  PI-LABEL-CONTROL            PIC X(01).
  1022             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1023             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1024
  1025         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1026             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1027
  1028         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1029             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1030             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1031
  1032         16  FILLER                      PIC X(14).
  1033
  1034     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1035******************************************************************
  1036     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1037         16  PI-NO-PMTS                    PIC 9(4).
  1038         16  PI-CERT-SWITCH                PIC X.
  1039             88  CREATED-CERT              VALUE '2'.
  1040         16  PI-PREM-TYPE                  PIC X.
  1041         16  PI-SAVE-CERT-NO.
  1042             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1043             20  PI-SAVE-CERT-NO-SUFX      PIC X.
  1044         16  FILLER                        PIC X(46).
  1045         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1046         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1047         16  PI-REC-FOUND-SW               PIC X.
  1048         16  PI-LETTER-SW                  PIC X.
  1049         16  PI-PREV-TRLR-KEY              PIC X(22).
  1050         16  FILLER                        PIC X(547).
  1051
  1052 01  SAVE-RECORD                 PIC X(450).
  1053
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  23
* EL131.cbl
  1055*                                COPY ELCLOGOF SUPPRESS.
  1056******************************************************************
  1057*                                                                *
  1058*                                                                *
  1059*                            ELCLOGOF.                           *
  1060*                            VMOD=2.001                          *
  1061*                                                                *
  1062*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1063*                                                                *
  1064******************************************************************
  1065 01  CLASIC-LOGOFF.
  1066     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1067     12  LOGOFF-TEXT.
  1068         16  FILLER          PIC X(5)    VALUE SPACES.
  1069         16  LOGOFF-MSG.
  1070             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1071             20  FILLER      PIC X       VALUE SPACES.
  1072             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1073         16  FILLER          PIC X(80)
  1074           VALUE '* YOU ARE NOW LOGGED OFF'.
  1075         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1076         16  FILLER          PIC X       VALUE QUOTE.
  1077         16  LOGOFF-SYS-MSG  PIC X(17)
  1078           VALUE 'S CLAS-IC SYSTEM '.
  1079     12  TEXT-MESSAGES.
  1080         16  UNACCESS-MSG    PIC X(29)
  1081             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1082         16  PGMIDERR-MSG    PIC X(17)
  1083             VALUE 'PROGRAM NOT FOUND'.
  1084
  1085*                                COPY ELCATTR SUPPRESS.
  1086******************************************************************
  1087*                                                                *
  1088*                            ELCATTR.                            *
  1089*                            VMOD=2.001                          *
  1090*                                                                *
  1091*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1092*                                                                *
  1093*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1094*                                                                *
  1095*                   POS 1   P=PROTECTED                          *
  1096*                           U=UNPROTECTED                        *
  1097*                           S=ASKIP                              *
  1098*                   POS 2   A=ALPHA/NUMERIC                      *
  1099*                           N=NUMERIC                            *
  1100*                   POS 3   N=NORMAL                             *
  1101*                           B=BRIGHT                             *
  1102*                           D=DARK                               *
  1103*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1104*                           OF=MODIFIED DATA TAG OFF             *
  1105*                                                                *
  1106*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1107******************************************************************
  1108 01  ATTRIBUTE-LIST.
  1109     12  AL-PABOF            PIC X       VALUE 'Y'.
  1110     12  AL-PABON            PIC X       VALUE 'Z'.
  1111     12  AL-PADOF            PIC X       VALUE '%'.
  1112     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  24
* EL131.cbl
  1113     12  AL-PANOF            PIC X       VALUE '-'.
  1114     12  AL-PANON            PIC X       VALUE '/'.
  1115     12  AL-SABOF            PIC X       VALUE '8'.
  1116     12  AL-SABON            PIC X       VALUE '9'.
  1117     12  AL-SADOF            PIC X       VALUE '@'.
  1118     12  AL-SADON            PIC X       VALUE QUOTE.
  1119     12  AL-SANOF            PIC X       VALUE '0'.
  1120     12  AL-SANON            PIC X       VALUE '1'.
  1121     12  AL-UABOF            PIC X       VALUE 'H'.
  1122     12  AL-UABON            PIC X       VALUE 'I'.
  1123     12  AL-UADOF            PIC X       VALUE '<'.
  1124     12  AL-UADON            PIC X       VALUE '('.
  1125     12  AL-UANOF            PIC X       VALUE ' '.
  1126     12  AL-UANON            PIC X       VALUE 'A'.
  1127     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1128     12  AL-UNBON            PIC X       VALUE 'R'.
  1129     12  AL-UNDOF            PIC X       VALUE '*'.
  1130     12  AL-UNDON            PIC X       VALUE ')'.
  1131     12  AL-UNNOF            PIC X       VALUE '&'.
  1132     12  AL-UNNON            PIC X       VALUE 'J'.
  1133
  1134*                                COPY ELCAID SUPPRESS.
  1135******************************************************************
  1136*                                                                *
  1137*                            ELCAID.                             *
  1138*                            VMOD=2.001                          *
  1139*                                                                *
  1140*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1141*                                                                *
  1142*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1143*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1144******************************************************************
  1145
  1146 01  DFHAID.
  1147   02  DFHNULL   PIC  X  VALUE  ' '.
  1148   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1149   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1150   02  DFHPEN    PIC  X  VALUE  '='.
  1151   02  DFHOPID   PIC  X  VALUE  'W'.
  1152   02  DFHPA1    PIC  X  VALUE  '%'.
  1153   02  DFHPA2    PIC  X  VALUE  '>'.
  1154   02  DFHPA3    PIC  X  VALUE  ','.
  1155   02  DFHPF1    PIC  X  VALUE  '1'.
  1156   02  DFHPF2    PIC  X  VALUE  '2'.
  1157   02  DFHPF3    PIC  X  VALUE  '3'.
  1158   02  DFHPF4    PIC  X  VALUE  '4'.
  1159   02  DFHPF5    PIC  X  VALUE  '5'.
  1160   02  DFHPF6    PIC  X  VALUE  '6'.
  1161   02  DFHPF7    PIC  X  VALUE  '7'.
  1162   02  DFHPF8    PIC  X  VALUE  '8'.
  1163   02  DFHPF9    PIC  X  VALUE  '9'.
  1164   02  DFHPF10   PIC  X  VALUE  ':'.
  1165   02  DFHPF11   PIC  X  VALUE  '#'.
  1166   02  DFHPF12   PIC  X  VALUE  '@'.
  1167   02  DFHPF13   PIC  X  VALUE  'A'.
  1168   02  DFHPF14   PIC  X  VALUE  'B'.
  1169   02  DFHPF15   PIC  X  VALUE  'C'.
  1170   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  25
* EL131.cbl
  1171   02  DFHPF17   PIC  X  VALUE  'E'.
  1172   02  DFHPF18   PIC  X  VALUE  'F'.
  1173   02  DFHPF19   PIC  X  VALUE  'G'.
  1174   02  DFHPF20   PIC  X  VALUE  'H'.
  1175   02  DFHPF21   PIC  X  VALUE  'I'.
  1176*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1177   02  DFHPF22   PIC  X  VALUE  '['.
  1178   02  DFHPF23   PIC  X  VALUE  '.'.
  1179   02  DFHPF24   PIC  X  VALUE  '<'.
  1180   02  DFHMSRE   PIC  X  VALUE  'X'.
  1181   02  DFHSTRF   PIC  X  VALUE  'h'.
  1182   02  DFHTRIG   PIC  X  VALUE  '"'.
  1183 01  FILLER REDEFINES DFHAID.
  1184     12  FILLER                  PIC X(8).
  1185     12  AID-KEYS OCCURS 24 TIMES.
  1186         16  FILLER              PIC X.
  1187
  1188*                                COPY EL131S.
  1189 01  EL131AI.
  1190     05  FILLER            PIC  X(0012).
  1191*    -------------------------------
  1192     05  DATEL PIC S9(0004) COMP.
  1193     05  DATEF PIC  X(0001).
  1194     05  FILLER REDEFINES DATEF.
  1195         10  DATEA PIC  X(0001).
  1196     05  DATEI PIC  X(0008).
  1197*    -------------------------------
  1198     05  TIMEL PIC S9(0004) COMP.
  1199     05  TIMEF PIC  X(0001).
  1200     05  FILLER REDEFINES TIMEF.
  1201         10  TIMEA PIC  X(0001).
  1202     05  TIMEI PIC  X(0005).
  1203*    -------------------------------
  1204     05  SEQUL PIC S9(0004) COMP.
  1205     05  SEQUF PIC  X(0001).
  1206     05  FILLER REDEFINES SEQUF.
  1207         10  SEQUA PIC  X(0001).
  1208     05  SEQUI PIC  X(0010).
  1209*    -------------------------------
  1210     05  COMPL PIC S9(0004) COMP.
  1211     05  COMPF PIC  X(0001).
  1212     05  FILLER REDEFINES COMPF.
  1213         10  COMPA PIC  X(0001).
  1214     05  COMPI PIC  X(0003).
  1215*    -------------------------------
  1216     05  USERIDL PIC S9(0004) COMP.
  1217     05  USERIDF PIC  X(0001).
  1218     05  FILLER REDEFINES USERIDF.
  1219         10  USERIDA PIC  X(0001).
  1220     05  USERIDI PIC  X(0004).
  1221*    -------------------------------
  1222     05  CCNOL PIC S9(0004) COMP.
  1223     05  CCNOF PIC  X(0001).
  1224     05  FILLER REDEFINES CCNOF.
  1225         10  CCNOA PIC  X(0001).
  1226     05  CCNOI PIC  X(0016).
  1227*    -------------------------------
  1228     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  26
* EL131.cbl
  1229     05  MAINTF PIC  X(0001).
  1230     05  FILLER REDEFINES MAINTF.
  1231         10  MAINTA PIC  X(0001).
  1232     05  MAINTI PIC  X(0001).
  1233*    -------------------------------
  1234     05  CLAIML PIC S9(0004) COMP.
  1235     05  CLAIMF PIC  X(0001).
  1236     05  FILLER REDEFINES CLAIMF.
  1237         10  CLAIMA PIC  X(0001).
  1238     05  CLAIMI PIC  X(0007).
  1239*    -------------------------------
  1240     05  CARRL PIC S9(0004) COMP.
  1241     05  CARRF PIC  X(0001).
  1242     05  FILLER REDEFINES CARRF.
  1243         10  CARRA PIC  X(0001).
  1244     05  CARRI PIC  X(0001).
  1245*    -------------------------------
  1246     05  CERTL PIC S9(0004) COMP.
  1247     05  CERTF PIC  X(0001).
  1248     05  FILLER REDEFINES CERTF.
  1249         10  CERTA PIC  X(0001).
  1250     05  CERTI PIC  X(0010).
  1251*    -------------------------------
  1252     05  SUFXL PIC S9(0004) COMP.
  1253     05  SUFXF PIC  X(0001).
  1254     05  FILLER REDEFINES SUFXF.
  1255         10  SUFXA PIC  X(0001).
  1256     05  SUFXI PIC  X(0001).
  1257*    -------------------------------
  1258     05  TYPEL PIC S9(0004) COMP.
  1259     05  TYPEF PIC  X(0001).
  1260     05  FILLER REDEFINES TYPEF.
  1261         10  TYPEA PIC  X(0001).
  1262     05  TYPEI PIC  X(0001).
  1263*    -------------------------------
  1264     05  LABEL1L PIC S9(0004) COMP.
  1265     05  LABEL1F PIC  X(0001).
  1266     05  FILLER REDEFINES LABEL1F.
  1267         10  LABEL1A PIC  X(0001).
  1268     05  LABEL1I PIC  X(0011).
  1269*    -------------------------------
  1270     05  PCERTNOL PIC S9(0004) COMP.
  1271     05  PCERTNOF PIC  X(0001).
  1272     05  FILLER REDEFINES PCERTNOF.
  1273         10  PCERTNOA PIC  X(0001).
  1274     05  PCERTNOI PIC  X(0010).
  1275*    -------------------------------
  1276     05  PSUFXL PIC S9(0004) COMP.
  1277     05  PSUFXF PIC  X(0001).
  1278     05  FILLER REDEFINES PSUFXF.
  1279         10  PSUFXA PIC  X(0001).
  1280     05  PSUFXI PIC  X(0001).
  1281*    -------------------------------
  1282     05  STATUSL PIC S9(0004) COMP.
  1283     05  STATUSF PIC  X(0001).
  1284     05  FILLER REDEFINES STATUSF.
  1285         10  STATUSA PIC  X(0001).
  1286     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  27
* EL131.cbl
  1287*    -------------------------------
  1288     05  INCL PIC S9(0004) COMP.
  1289     05  INCF PIC  X(0001).
  1290     05  FILLER REDEFINES INCF.
  1291         10  INCA PIC  X(0001).
  1292     05  INCI PIC  X(0008).
  1293*    -------------------------------
  1294     05  REPL PIC S9(0004) COMP.
  1295     05  REPF PIC  X(0001).
  1296     05  FILLER REDEFINES REPF.
  1297         10  REPA PIC  X(0001).
  1298     05  REPI PIC  X(0008).
  1299*    -------------------------------
  1300     05  CAUSEL PIC S9(0004) COMP.
  1301     05  CAUSEF PIC  X(0001).
  1302     05  FILLER REDEFINES CAUSEF.
  1303         10  CAUSEA PIC  X(0001).
  1304     05  CAUSEI PIC  X(0006).
  1305*    -------------------------------
  1306     05  ENDL PIC S9(0004) COMP.
  1307     05  ENDF PIC  X(0001).
  1308     05  FILLER REDEFINES ENDF.
  1309         10  ENDA PIC  X(0001).
  1310     05  ENDI PIC  X(0008).
  1311*    -------------------------------
  1312     05  DIAGL PIC S9(0004) COMP.
  1313     05  DIAGF PIC  X(0001).
  1314     05  FILLER REDEFINES DIAGF.
  1315         10  DIAGA PIC  X(0001).
  1316     05  DIAGI PIC  X(0060).
  1317*    -------------------------------
  1318     05  BENEL PIC S9(0004) COMP.
  1319     05  BENEF PIC  X(0001).
  1320     05  FILLER REDEFINES BENEF.
  1321         10  BENEA PIC  X(0001).
  1322     05  BENEI PIC  X(0010).
  1323*    -------------------------------
  1324     05  BIRTHL PIC S9(0004) COMP.
  1325     05  BIRTHF PIC  X(0001).
  1326     05  FILLER REDEFINES BIRTHF.
  1327         10  BIRTHA PIC  X(0001).
  1328     05  BIRTHI PIC  X(0008).
  1329*    -------------------------------
  1330     05  SOCIALL PIC S9(0004) COMP.
  1331     05  SOCIALF PIC  X(0001).
  1332     05  FILLER REDEFINES SOCIALF.
  1333         10  SOCIALA PIC  X(0001).
  1334     05  SOCIALI PIC  X(0011).
  1335*    -------------------------------
  1336     05  SEXL PIC S9(0004) COMP.
  1337     05  SEXF PIC  X(0001).
  1338     05  FILLER REDEFINES SEXF.
  1339         10  SEXA PIC  X(0001).
  1340     05  SEXI PIC  X(0001).
  1341*    -------------------------------
  1342     05  MLNAMEL PIC S9(0004) COMP.
  1343     05  MLNAMEF PIC  X(0001).
  1344     05  FILLER REDEFINES MLNAMEF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  28
* EL131.cbl
  1345         10  MLNAMEA PIC  X(0001).
  1346     05  MLNAMEI PIC  X(0015).
  1347*    -------------------------------
  1348     05  MFNAMEL PIC S9(0004) COMP.
  1349     05  MFNAMEF PIC  X(0001).
  1350     05  FILLER REDEFINES MFNAMEF.
  1351         10  MFNAMEA PIC  X(0001).
  1352     05  MFNAMEI PIC  X(0012).
  1353*    -------------------------------
  1354     05  MMINITL PIC S9(0004) COMP.
  1355     05  MMINITF PIC  X(0001).
  1356     05  FILLER REDEFINES MMINITF.
  1357         10  MMINITA PIC  X(0001).
  1358     05  MMINITI PIC  X(0001).
  1359*    -------------------------------
  1360     05  LOANNOL PIC S9(0004) COMP.
  1361     05  LOANNOF PIC  X(0001).
  1362     05  FILLER REDEFINES LOANNOF.
  1363         10  LOANNOA PIC  X(0001).
  1364     05  LOANNOI PIC  X(0008).
  1365*    -------------------------------
  1366     05  CRTLNMEL PIC S9(0004) COMP.
  1367     05  CRTLNMEF PIC  X(0001).
  1368     05  FILLER REDEFINES CRTLNMEF.
  1369         10  CRTLNMEA PIC  X(0001).
  1370     05  CRTLNMEI PIC  X(0015).
  1371*    -------------------------------
  1372     05  CRTFNMEL PIC S9(0004) COMP.
  1373     05  CRTFNMEF PIC  X(0001).
  1374     05  FILLER REDEFINES CRTFNMEF.
  1375         10  CRTFNMEA PIC  X(0001).
  1376     05  CRTFNMEI PIC  X(0012).
  1377*    -------------------------------
  1378     05  CRTINITL PIC S9(0004) COMP.
  1379     05  CRTINITF PIC  X(0001).
  1380     05  FILLER REDEFINES CRTINITF.
  1381         10  CRTINITA PIC  X(0001).
  1382     05  CRTINITI PIC  X(0001).
  1383*    -------------------------------
  1384     05  LOANBALL PIC S9(0004) COMP.
  1385     05  LOANBALF PIC  X(0001).
  1386     05  FILLER REDEFINES LOANBALF.
  1387         10  LOANBALA PIC  X(0001).
  1388     05  LOANBALI PIC  9(7)V99.
  1389*    -------------------------------
  1390     05  PROCL PIC S9(0004) COMP.
  1391     05  PROCF PIC  X(0001).
  1392     05  FILLER REDEFINES PROCF.
  1393         10  PROCA PIC  X(0001).
  1394     05  PROCI PIC  X(0004).
  1395*    -------------------------------
  1396     05  SUPVL PIC S9(0004) COMP.
  1397     05  SUPVF PIC  X(0001).
  1398     05  FILLER REDEFINES SUPVF.
  1399         10  SUPVA PIC  X(0001).
  1400     05  SUPVI PIC  X(0001).
  1401*    -------------------------------
  1402     05  PRICDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  29
* EL131.cbl
  1403     05  PRICDF PIC  X(0001).
  1404     05  FILLER REDEFINES PRICDF.
  1405         10  PRICDA PIC  X(0001).
  1406     05  PRICDI PIC  X(0001).
  1407*    -------------------------------
  1408     05  FILETOL PIC S9(0004) COMP.
  1409     05  FILETOF PIC  X(0001).
  1410     05  FILLER REDEFINES FILETOF.
  1411         10  FILETOA PIC  X(0001).
  1412     05  FILETOI PIC  X(0004).
  1413*    -------------------------------
  1414     05  PTHRHDGL PIC S9(0004) COMP.
  1415     05  PTHRHDGF PIC  X(0001).
  1416     05  FILLER REDEFINES PTHRHDGF.
  1417         10  PTHRHDGA PIC  X(0001).
  1418     05  PTHRHDGI PIC  X(0010).
  1419*    -------------------------------
  1420     05  PDTHRUL PIC S9(0004) COMP.
  1421     05  PDTHRUF PIC  X(0001).
  1422     05  FILLER REDEFINES PDTHRUF.
  1423         10  PDTHRUA PIC  X(0001).
  1424     05  PDTHRUI PIC  X(0008).
  1425*    -------------------------------
  1426     05  PDAMTL PIC S9(0004) COMP.
  1427     05  PDAMTF PIC  X(0001).
  1428     05  FILLER REDEFINES PDAMTF.
  1429         10  PDAMTA PIC  X(0001).
  1430     05  PDAMTI PIC  9(7)V99.
  1431*    -------------------------------
  1432     05  NODAYSL PIC S9(0004) COMP.
  1433     05  NODAYSF PIC  X(0001).
  1434     05  FILLER REDEFINES NODAYSF.
  1435         10  NODAYSA PIC  X(0001).
  1436     05  NODAYSI PIC  9(5).
  1437*    -------------------------------
  1438     05  NOPMTSL PIC S9(0004) COMP.
  1439     05  NOPMTSF PIC  X(0001).
  1440     05  FILLER REDEFINES NOPMTSF.
  1441         10  NOPMTSA PIC  X(0001).
  1442     05  NOPMTSI PIC  9(4).
  1443*    -------------------------------
  1444     05  FORMTYPL PIC S9(0004) COMP.
  1445     05  FORMTYPF PIC  X(0001).
  1446     05  FILLER REDEFINES FORMTYPF.
  1447         10  FORMTYPA PIC  X(0001).
  1448     05  FORMTYPI PIC  X(0001).
  1449*    -------------------------------
  1450     05  ESTL PIC S9(0004) COMP.
  1451     05  ESTF PIC  X(0001).
  1452     05  FILLER REDEFINES ESTF.
  1453         10  ESTA PIC  X(0001).
  1454     05  ESTI PIC  X(0008).
  1455*    -------------------------------
  1456     05  AUIDL PIC S9(0004) COMP.
  1457     05  AUIDF PIC  X(0001).
  1458     05  FILLER REDEFINES AUIDF.
  1459         10  AUIDA PIC  X(0001).
  1460     05  AUIDI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  30
* EL131.cbl
  1461*    -------------------------------
  1462     05  OCCL PIC S9(0004) COMP.
  1463     05  OCCF PIC  X(0001).
  1464     05  FILLER REDEFINES OCCF.
  1465         10  OCCA PIC  X(0001).
  1466     05  OCCI PIC  X(0006).
  1467*    -------------------------------
  1468     05  MNTDTL PIC S9(0004) COMP.
  1469     05  MNTDTF PIC  X(0001).
  1470     05  FILLER REDEFINES MNTDTF.
  1471         10  MNTDTA PIC  X(0001).
  1472     05  MNTDTI PIC  X(0008).
  1473*    -------------------------------
  1474     05  MNTTYPEL PIC S9(0004) COMP.
  1475     05  MNTTYPEF PIC  X(0001).
  1476     05  FILLER REDEFINES MNTTYPEF.
  1477         10  MNTTYPEA PIC  X(0001).
  1478     05  MNTTYPEI PIC  X(0006).
  1479*    -------------------------------
  1480     05  CERTCARL PIC S9(0004) COMP.
  1481     05  CERTCARF PIC  X(0001).
  1482     05  FILLER REDEFINES CERTCARF.
  1483         10  CERTCARA PIC  X(0001).
  1484     05  CERTCARI PIC  X(0001).
  1485*    -------------------------------
  1486     05  CERTGRPL PIC S9(0004) COMP.
  1487     05  CERTGRPF PIC  X(0001).
  1488     05  FILLER REDEFINES CERTGRPF.
  1489         10  CERTGRPA PIC  X(0001).
  1490     05  CERTGRPI PIC  X(0006).
  1491*    -------------------------------
  1492     05  CERTSTL PIC S9(0004) COMP.
  1493     05  CERTSTF PIC  X(0001).
  1494     05  FILLER REDEFINES CERTSTF.
  1495         10  CERTSTA PIC  X(0001).
  1496     05  CERTSTI PIC  X(0002).
  1497*    -------------------------------
  1498     05  CERTACTL PIC S9(0004) COMP.
  1499     05  CERTACTF PIC  X(0001).
  1500     05  FILLER REDEFINES CERTACTF.
  1501         10  CERTACTA PIC  X(0001).
  1502     05  CERTACTI PIC  X(0010).
  1503*    -------------------------------
  1504     05  CERTEFFL PIC S9(0004) COMP.
  1505     05  CERTEFFF PIC  X(0001).
  1506     05  FILLER REDEFINES CERTEFFF.
  1507         10  CERTEFFA PIC  X(0001).
  1508     05  CERTEFFI PIC  X(0008).
  1509*    -------------------------------
  1510     05  ISSAGEL PIC S9(0004) COMP.
  1511     05  ISSAGEF PIC  X(0001).
  1512     05  FILLER REDEFINES ISSAGEF.
  1513         10  ISSAGEA PIC  X(0001).
  1514     05  ISSAGEI PIC  X(0002).
  1515*    -------------------------------
  1516     05  APRL PIC S9(0004) COMP.
  1517     05  APRF PIC  X(0001).
  1518     05  FILLER REDEFINES APRF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  31
* EL131.cbl
  1519         10  APRA PIC  X(0001).
  1520     05  APRI PIC  9(4)V9(4).
  1521*    -------------------------------
  1522     05  PMTFREQL PIC S9(0004) COMP.
  1523     05  PMTFREQF PIC  X(0001).
  1524     05  FILLER REDEFINES PMTFREQF.
  1525         10  PMTFREQA PIC  X(0001).
  1526     05  PMTFREQI PIC  99.
  1527*    -------------------------------
  1528     05  INDGRPL PIC S9(0004) COMP.
  1529     05  INDGRPF PIC  X(0001).
  1530     05  FILLER REDEFINES INDGRPF.
  1531         10  INDGRPA PIC  X(0001).
  1532     05  INDGRPI PIC  X(0001).
  1533*    -------------------------------
  1534     05  PREMTYPL PIC S9(0004) COMP.
  1535     05  PREMTYPF PIC  X(0001).
  1536     05  FILLER REDEFINES PREMTYPF.
  1537         10  PREMTYPA PIC  X(0001).
  1538     05  PREMTYPI PIC  X(0001).
  1539*    -------------------------------
  1540     05  REINCDL PIC S9(0004) COMP.
  1541     05  REINCDF PIC  X(0001).
  1542     05  FILLER REDEFINES REINCDF.
  1543         10  REINCDA PIC  X(0001).
  1544     05  REINCDI PIC  X(0001).
  1545*    -------------------------------
  1546     05  JNTLNMEL PIC S9(0004) COMP.
  1547     05  JNTLNMEF PIC  X(0001).
  1548     05  FILLER REDEFINES JNTLNMEF.
  1549         10  JNTLNMEA PIC  X(0001).
  1550     05  JNTLNMEI PIC  X(0015).
  1551*    -------------------------------
  1552     05  JNTFNMEL PIC S9(0004) COMP.
  1553     05  JNTFNMEF PIC  X(0001).
  1554     05  FILLER REDEFINES JNTFNMEF.
  1555         10  JNTFNMEA PIC  X(0001).
  1556     05  JNTFNMEI PIC  X(0012).
  1557*    -------------------------------
  1558     05  JNTINITL PIC S9(0004) COMP.
  1559     05  JNTINITF PIC  X(0001).
  1560     05  FILLER REDEFINES JNTINITF.
  1561         10  JNTINITA PIC  X(0001).
  1562     05  JNTINITI PIC  X(0001).
  1563*    -------------------------------
  1564     05  JNTAGEL PIC S9(0004) COMP.
  1565     05  JNTAGEF PIC  X(0001).
  1566     05  FILLER REDEFINES JNTAGEF.
  1567         10  JNTAGEA PIC  X(0001).
  1568     05  JNTAGEI PIC  X(0002).
  1569*    -------------------------------
  1570     05  ADDONDTL PIC S9(0004) COMP.
  1571     05  ADDONDTF PIC  X(0001).
  1572     05  FILLER REDEFINES ADDONDTF.
  1573         10  ADDONDTA PIC  X(0001).
  1574     05  ADDONDTI PIC  X(0008).
  1575*    -------------------------------
  1576     05  LCVDSCRL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  32
* EL131.cbl
  1577     05  LCVDSCRF PIC  X(0001).
  1578     05  FILLER REDEFINES LCVDSCRF.
  1579         10  LCVDSCRA PIC  X(0001).
  1580     05  LCVDSCRI PIC  X(0006).
  1581*    -------------------------------
  1582     05  LCVKINDL PIC S9(0004) COMP.
  1583     05  LCVKINDF PIC  X(0001).
  1584     05  FILLER REDEFINES LCVKINDF.
  1585         10  LCVKINDA PIC  X(0001).
  1586     05  LCVKINDI PIC  X(0003).
  1587*    -------------------------------
  1588     05  LCVCDL PIC S9(0004) COMP.
  1589     05  LCVCDF PIC  X(0001).
  1590     05  FILLER REDEFINES LCVCDF.
  1591         10  LCVCDA PIC  X(0001).
  1592     05  LCVCDI PIC  X(0002).
  1593*    -------------------------------
  1594     05  LCVOTRML PIC S9(0004) COMP.
  1595     05  LCVOTRMF PIC  X(0001).
  1596     05  FILLER REDEFINES LCVOTRMF.
  1597         10  LCVOTRMA PIC  X(0001).
  1598     05  LCVOTRMI PIC  999.
  1599*    -------------------------------
  1600     05  LCVRTRML PIC S9(0004) COMP.
  1601     05  LCVRTRMF PIC  X(0001).
  1602     05  FILLER REDEFINES LCVRTRMF.
  1603         10  LCVRTRMA PIC  X(0001).
  1604     05  LCVRTRMI PIC  X(0003).
  1605*    -------------------------------
  1606     05  LCVRATEL PIC S9(0004) COMP.
  1607     05  LCVRATEF PIC  X(0001).
  1608     05  FILLER REDEFINES LCVRATEF.
  1609         10  LCVRATEA PIC  X(0001).
  1610     05  LCVRATEI PIC  9999V99.
  1611*    -------------------------------
  1612     05  LCVBENEL PIC S9(0004) COMP.
  1613     05  LCVBENEF PIC  X(0001).
  1614     05  FILLER REDEFINES LCVBENEF.
  1615         10  LCVBENEA PIC  X(0001).
  1616     05  LCVBENEI PIC  9(9)V99.
  1617*    -------------------------------
  1618     05  LCVFORML PIC S9(0004) COMP.
  1619     05  LCVFORMF PIC  X(0001).
  1620     05  FILLER REDEFINES LCVFORMF.
  1621         10  LCVFORMA PIC  X(0001).
  1622     05  LCVFORMI PIC  X(0012).
  1623*    -------------------------------
  1624     05  LCVCNDTL PIC S9(0004) COMP.
  1625     05  LCVCNDTF PIC  X(0001).
  1626     05  FILLER REDEFINES LCVCNDTF.
  1627         10  LCVCNDTA PIC  X(0001).
  1628     05  LCVCNDTI PIC  X(0008).
  1629*    -------------------------------
  1630     05  LCVEXITL PIC S9(0004) COMP.
  1631     05  LCVEXITF PIC  X(0001).
  1632     05  FILLER REDEFINES LCVEXITF.
  1633         10  LCVEXITA PIC  X(0001).
  1634     05  LCVEXITI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  33
* EL131.cbl
  1635*    -------------------------------
  1636     05  LCVSTATL PIC S9(0004) COMP.
  1637     05  LCVSTATF PIC  X(0001).
  1638     05  FILLER REDEFINES LCVSTATF.
  1639         10  LCVSTATA PIC  X(0001).
  1640     05  LCVSTATI PIC  X(0006).
  1641*    -------------------------------
  1642     05  ACVDSCRL PIC S9(0004) COMP.
  1643     05  ACVDSCRF PIC  X(0001).
  1644     05  FILLER REDEFINES ACVDSCRF.
  1645         10  ACVDSCRA PIC  X(0001).
  1646     05  ACVDSCRI PIC  X(0006).
  1647*    -------------------------------
  1648     05  ACVKINDL PIC S9(0004) COMP.
  1649     05  ACVKINDF PIC  X(0001).
  1650     05  FILLER REDEFINES ACVKINDF.
  1651         10  ACVKINDA PIC  X(0001).
  1652     05  ACVKINDI PIC  X(0003).
  1653*    -------------------------------
  1654     05  ACVCDL PIC S9(0004) COMP.
  1655     05  ACVCDF PIC  X(0001).
  1656     05  FILLER REDEFINES ACVCDF.
  1657         10  ACVCDA PIC  X(0001).
  1658     05  ACVCDI PIC  X(0002).
  1659*    -------------------------------
  1660     05  ACVOTRML PIC S9(0004) COMP.
  1661     05  ACVOTRMF PIC  X(0001).
  1662     05  FILLER REDEFINES ACVOTRMF.
  1663         10  ACVOTRMA PIC  X(0001).
  1664     05  ACVOTRMI PIC  999.
  1665*    -------------------------------
  1666     05  ACVRTRML PIC S9(0004) COMP.
  1667     05  ACVRTRMF PIC  X(0001).
  1668     05  FILLER REDEFINES ACVRTRMF.
  1669         10  ACVRTRMA PIC  X(0001).
  1670     05  ACVRTRMI PIC  X(0003).
  1671*    -------------------------------
  1672     05  ACVRATEL PIC S9(0004) COMP.
  1673     05  ACVRATEF PIC  X(0001).
  1674     05  FILLER REDEFINES ACVRATEF.
  1675         10  ACVRATEA PIC  X(0001).
  1676     05  ACVRATEI PIC  9999V99.
  1677*    -------------------------------
  1678     05  ACVBENEL PIC S9(0004) COMP.
  1679     05  ACVBENEF PIC  X(0001).
  1680     05  FILLER REDEFINES ACVBENEF.
  1681         10  ACVBENEA PIC  X(0001).
  1682     05  ACVBENEI PIC  9(9)V99.
  1683*    -------------------------------
  1684     05  ACVFORML PIC S9(0004) COMP.
  1685     05  ACVFORMF PIC  X(0001).
  1686     05  FILLER REDEFINES ACVFORMF.
  1687         10  ACVFORMA PIC  X(0001).
  1688     05  ACVFORMI PIC  X(0012).
  1689*    -------------------------------
  1690     05  ACVCNDTL PIC S9(0004) COMP.
  1691     05  ACVCNDTF PIC  X(0001).
  1692     05  FILLER REDEFINES ACVCNDTF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  34
* EL131.cbl
  1693         10  ACVCNDTA PIC  X(0001).
  1694     05  ACVCNDTI PIC  X(0008).
  1695*    -------------------------------
  1696     05  ACVEXITL PIC S9(0004) COMP.
  1697     05  ACVEXITF PIC  X(0001).
  1698     05  FILLER REDEFINES ACVEXITF.
  1699         10  ACVEXITA PIC  X(0001).
  1700     05  ACVEXITI PIC  X(0008).
  1701*    -------------------------------
  1702     05  ACVSTATL PIC S9(0004) COMP.
  1703     05  ACVSTATF PIC  X(0001).
  1704     05  FILLER REDEFINES ACVSTATF.
  1705         10  ACVSTATA PIC  X(0001).
  1706     05  ACVSTATI PIC  X(0006).
  1707*    -------------------------------
  1708     05  DAYSPL PIC S9(0004) COMP.
  1709     05  DAYSPF PIC  X(0001).
  1710     05  FILLER REDEFINES DAYSPF.
  1711         10  DAYSPA PIC  X(0001).
  1712     05  DAYSPI PIC  X(0003).
  1713*    -------------------------------
  1714     05  LABEL2L PIC S9(0004) COMP.
  1715     05  LABEL2F PIC  X(0001).
  1716     05  FILLER REDEFINES LABEL2F.
  1717         10  LABEL2A PIC  X(0001).
  1718     05  LABEL2I PIC  X(0014).
  1719*    -------------------------------
  1720     05  BCERT1L PIC S9(0004) COMP.
  1721     05  BCERT1F PIC  X(0001).
  1722     05  FILLER REDEFINES BCERT1F.
  1723         10  BCERT1A PIC  X(0001).
  1724     05  BCERT1I PIC  X(0010).
  1725*    -------------------------------
  1726     05  BSUFX1L PIC S9(0004) COMP.
  1727     05  BSUFX1F PIC  X(0001).
  1728     05  FILLER REDEFINES BSUFX1F.
  1729         10  BSUFX1A PIC  X(0001).
  1730     05  BSUFX1I PIC  X(0001).
  1731*    -------------------------------
  1732     05  BCERT2L PIC S9(0004) COMP.
  1733     05  BCERT2F PIC  X(0001).
  1734     05  FILLER REDEFINES BCERT2F.
  1735         10  BCERT2A PIC  X(0001).
  1736     05  BCERT2I PIC  X(0010).
  1737*    -------------------------------
  1738     05  BSUFX2L PIC S9(0004) COMP.
  1739     05  BSUFX2F PIC  X(0001).
  1740     05  FILLER REDEFINES BSUFX2F.
  1741         10  BSUFX2A PIC  X(0001).
  1742     05  BSUFX2I PIC  X(0001).
  1743*    -------------------------------
  1744     05  BCERT3L PIC S9(0004) COMP.
  1745     05  BCERT3F PIC  X(0001).
  1746     05  FILLER REDEFINES BCERT3F.
  1747         10  BCERT3A PIC  X(0001).
  1748     05  BCERT3I PIC  X(0010).
  1749*    -------------------------------
  1750     05  BSUFX3L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  35
* EL131.cbl
  1751     05  BSUFX3F PIC  X(0001).
  1752     05  FILLER REDEFINES BSUFX3F.
  1753         10  BSUFX3A PIC  X(0001).
  1754     05  BSUFX3I PIC  X(0001).
  1755*    -------------------------------
  1756     05  BCERT4L PIC S9(0004) COMP.
  1757     05  BCERT4F PIC  X(0001).
  1758     05  FILLER REDEFINES BCERT4F.
  1759         10  BCERT4A PIC  X(0001).
  1760     05  BCERT4I PIC  X(0010).
  1761*    -------------------------------
  1762     05  BSUFX4L PIC S9(0004) COMP.
  1763     05  BSUFX4F PIC  X(0001).
  1764     05  FILLER REDEFINES BSUFX4F.
  1765         10  BSUFX4A PIC  X(0001).
  1766     05  BSUFX4I PIC  X(0001).
  1767*    -------------------------------
  1768     05  BCERT5L PIC S9(0004) COMP.
  1769     05  BCERT5F PIC  X(0001).
  1770     05  FILLER REDEFINES BCERT5F.
  1771         10  BCERT5A PIC  X(0001).
  1772     05  BCERT5I PIC  X(0010).
  1773*    -------------------------------
  1774     05  BSUFX5L PIC S9(0004) COMP.
  1775     05  BSUFX5F PIC  X(0001).
  1776     05  FILLER REDEFINES BSUFX5F.
  1777         10  BSUFX5A PIC  X(0001).
  1778     05  BSUFX5I PIC  X(0001).
  1779*    -------------------------------
  1780     05  MSG1L PIC S9(0004) COMP.
  1781     05  MSG1F PIC  X(0001).
  1782     05  FILLER REDEFINES MSG1F.
  1783         10  MSG1A PIC  X(0001).
  1784     05  MSG1I PIC  X(0072).
  1785*    -------------------------------
  1786     05  PFKEYL PIC S9(0004) COMP.
  1787     05  PFKEYF PIC  X(0001).
  1788     05  FILLER REDEFINES PFKEYF.
  1789         10  PFKEYA PIC  X(0001).
  1790     05  PFKEYI PIC  99.
  1791*    -------------------------------
  1792     05  PFKEY6L PIC S9(0004) COMP.
  1793     05  PFKEY6F PIC  X(0001).
  1794     05  FILLER REDEFINES PFKEY6F.
  1795         10  PFKEY6A PIC  X(0001).
  1796     05  PFKEY6I PIC  X(0016).
  1797 01  EL131AO REDEFINES EL131AI.
  1798     05  FILLER            PIC  X(0012).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  DATEO PIC  X(0008).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  TIMEO PIC  99.99.
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  SEQUO PIC  X(0010).
  1808*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  36
* EL131.cbl
  1809     05  FILLER            PIC  X(0003).
  1810     05  COMPO PIC  X(0003).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  USERIDO PIC  X(0004).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  CCNOO PIC  X(0016).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  MAINTO PIC  X(0001).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  CLAIMO PIC  X(0007).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  CARRO PIC  X(0001).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  CERTO PIC  X(0010).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  SUFXO PIC  X(0001).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  TYPEO PIC  X(0001).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  LABEL1O PIC  X(0011).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  PCERTNOO PIC  X(0010).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  PSUFXO PIC  X(0001).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  STATUSO PIC  X(0006).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  INCO PIC  X(0008).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  REPO PIC  X(0008).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  CAUSEO PIC  X(0006).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  ENDO PIC  X(0008).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  DIAGO PIC  X(0060).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  BENEO PIC  X(0010).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  37
* EL131.cbl
  1867     05  BIRTHO PIC  X(0008).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  SOCIALO PIC  X(0011).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  SEXO PIC  X(0001).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  MLNAMEO PIC  X(0015).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  MFNAMEO PIC  X(0012).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  MMINITO PIC  X(0001).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  LOANNOO PIC  X(0008).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  CRTLNMEO PIC  X(0015).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  CRTFNMEO PIC  X(0012).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  CRTINITO PIC  X(0001).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  LOANBALO PIC  ZZZZZ9.99.
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  PROCO PIC  X(0004).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  SUPVO PIC  X(0001).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  PRICDO PIC  X(0001).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  FILETOO PIC  X(0004).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  PTHRHDGO PIC  X(0010).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  PDTHRUO PIC  X(0008).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  PDAMTO PIC  Z(06).99.
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  NODAYSO PIC  ZZZ99.
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  NOPMTSO PIC  ZZ99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  38
* EL131.cbl
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  FORMTYPO PIC  X(0001).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  ESTO PIC  X(0008).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  AUIDO PIC  X(0004).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  OCCO PIC  X(0006).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  MNTDTO PIC  X(0008).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  MNTTYPEO PIC  X(0006).
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  CERTCARO PIC  X(0001).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  CERTGRPO PIC  X(0006).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  CERTSTO PIC  X(0002).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  CERTACTO PIC  X(0010).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  CERTEFFO PIC  X(0008).
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  ISSAGEO PIC  X(0002).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  APRO PIC  9(3).9(4).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  PMTFREQO PIC  99.
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  INDGRPO PIC  X(0001).
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  PREMTYPO PIC  X(0001).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  REINCDO PIC  X(0001).
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  JNTLNMEO PIC  X(0015).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  JNTFNMEO PIC  X(0012).
  1982*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  39
* EL131.cbl
  1983     05  FILLER            PIC  X(0003).
  1984     05  JNTINITO PIC  X(0001).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  JNTAGEO PIC  X(0002).
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  ADDONDTO PIC  X(0008).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  LCVDSCRO PIC  X(0006).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  LCVKINDO PIC  X(0003).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  LCVCDO PIC  X(0002).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  LCVOTRMO PIC  999.
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  LCVRTRMO PIC  999.
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  LCVRATEO PIC  ZZZ.ZZ.
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  LCVFORMO PIC  X(0012).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  LCVCNDTO PIC  X(0008).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  LCVEXITO PIC  X(0008).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  LCVSTATO PIC  X(0006).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  ACVDSCRO PIC  X(0006).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  ACVKINDO PIC  X(0003).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  ACVCDO PIC  X(0002).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  ACVOTRMO PIC  999.
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  ACVRTRMO PIC  999.
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  40
* EL131.cbl
  2041     05  ACVRATEO PIC  ZZZ.ZZ.
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  ACVFORMO PIC  X(0012).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  ACVCNDTO PIC  X(0008).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  ACVEXITO PIC  X(0008).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  ACVSTATO PIC  X(0006).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  DAYSPO PIC  X(0003).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  LABEL2O PIC  X(0014).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  BCERT1O PIC  X(0010).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  BSUFX1O PIC  X(0001).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  BCERT2O PIC  X(0010).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  BSUFX2O PIC  X(0001).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  BCERT3O PIC  X(0010).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  BSUFX3O PIC  X(0001).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  BCERT4O PIC  X(0010).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  BSUFX4O PIC  X(0001).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  BCERT5O PIC  X(0010).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  BSUFX5O PIC  X(0001).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  MSG1O PIC  X(0072).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  PFKEYO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  41
* EL131.cbl
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  PFKEY6O PIC  X(0016).
  2102*    -------------------------------
  2103
  2104*                                COPY ELCEMIB SUPPRESS.
  2105******************************************************************
  2106*                                                                *
  2107*                                                                *
  2108*                            ELCEMIB.                            *
  2109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2110*                            VMOD=2.005                          *
  2111*                                                                *
  2112*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2113*                                                                *
  2114******************************************************************
  2115 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2116     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2117     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2118     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2119     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2120     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2121     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2122     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2123     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2124     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2125         88  EMI-NO-ERRORS                    VALUE '1'.
  2126         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2127         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2128     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2129         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2130     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2131         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2132         88  EMI-AREA1-FULL                   VALUE '2'.
  2133     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2134         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2135         88  EMI-AREA2-FULL                   VALUE '2'.
  2136     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2137         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2138         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2139         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2140         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2141         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2142     12  EMI-ERROR-LINES.
  2143         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2144         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2145         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2146         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2147             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2148                 24  EMI-ERR-NUM         PIC X(4).
  2149                 24  EMI-FILLER          PIC X.
  2150                 24  EMI-SEV             PIC X.
  2151                 24  FILLER              PIC X.
  2152             20  FILLER                  PIC X(02).
  2153     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2154         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2155             20  EMI-ERROR-NUMBER    PIC X(4).
  2156             20  EMI-FILL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  42
* EL131.cbl
  2157             20  EMI-SEVERITY        PIC X.
  2158             20  FILLER              PIC X.
  2159             20  EMI-ERROR-TEXT.
  2160                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2161                 24  FILLER          PIC X(55).
  2162     12  EMI-SEVERITY-SAVE           PIC X.
  2163         88  EMI-NOTE                    VALUE 'N'.
  2164         88  EMI-WARNING                 VALUE 'W'.
  2165         88  EMI-FORCABLE                VALUE 'F'.
  2166         88  EMI-FATAL                   VALUE 'X'.
  2167     12  EMI-MESSAGE-FLAG            PIC X.
  2168         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2169         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2170     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2171     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2172         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2173         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2174         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2175     12  FILLER                      PIC X(137)  VALUE SPACES.
  2176     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2177     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2178     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2179     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2180
  2181*                                COPY ELCJPFX SUPPRESS.
  2182******************************************************************
  2183*                                                                *
  2184*                                                                *
  2185*                            ELCJPFX.                            *
  2186*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2187*                            VMOD=2.002                          *
  2188*                                                                *
  2189*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2190*                                                                *
  2191*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2192*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2193*        ELCNTL - CONTROL FILE                                   *
  2194*        ELMSTR - CLAIM MASTERS                                  *
  2195*        ELTRLR - ACTIVITY TRAILERS                              *
  2196*        ELCHKQ - CHECK QUE                                      *
  2197******************************************************************
  2198 01  JOURNAL-RECORD.
  2199     12  JP-USER-ID                  PIC X(4).
  2200     12  JP-FILE-ID                  PIC X(8).
  2201     12  JP-PROGRAM-ID               PIC X(8).
  2202     12  JP-RECORD-TYPE              PIC X.
  2203         88 JP-ADD              VALUE 'A'.
  2204         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2205         88 JP-AFTER-CHANGE     VALUE 'C'.
  2206         88 JP-DELETE           VALUE 'D'.
  2207         88 JP-GENERIC-DELETE   VALUE 'G'.
  2208         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2209         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2210     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2211     12  JP-RECORD-AREA
  2212
  2213
  2214                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  43
* EL131.cbl
  2215
  2216*                                COPY ELCCALC SUPPRESS.
  2217******************************************************************
  2218*                                                                *
  2219*                           ELCCALC.                            *
  2220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2221*                            VMOD=2.025                          *
  2222*                                                                *
  2223*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2224*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2225*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2226*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2227*                                                                *
  2228*  PASSED TO ELRTRM                                              *
  2229*  -----------------                                             *
  2230*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2231*  ORIGINAL TERM                                                 *
  2232*  BEGINNING DATE                                                *
  2233*  ENDING DATE                                                   *
  2234*  COMPANY I.D.                                                  *
  2235*  ACCOUNT MASTER USER FIELD                                     *
  2236*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2237*  FREE LOOK DAYS                                                *
  2238*                                                                *
  2239*  RETURNED FROM ELRTRM                                          *
  2240*  ---------------------                                         *
  2241*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2242*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2243*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2244*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2245*----------------------------------------------------------------*
  2246*  PASSED TO ELRAMT                                              *
  2247*  ----------------                                              *
  2248*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2249*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2250*  ORIGINAL AMOUNT                                               *
  2251*  ALTERNATE BENEFIT (BALLON)                                    *
  2252*  A.P.R. - NET PAY ONLY                                         *
  2253*  METHOD
  2254*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2255*  COMPANY I.D.                                                  *
  2256*  BENEFIT TYPE                                                  *
  2257*                                                                *
  2258*  RETURNED FROM ELRAMT                                          *
  2259*  --------------------                                          *
  2260*  REMAINING AMOUNT 1 - CURRENT                                  *
  2261*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2262*  REMAINING AMOUNT FACTOR
  2263*----------------------------------------------------------------*
  2264*  PASSED TO ELRESV                                              *
  2265*  -----------------                                             *
  2266*  CERTIFICATE EFFECTIVE DATE                                    *
  2267*  VALUATION DATE                                                *
  2268*  PAID THRU DATE                                                *
  2269*  BENEFIT                                                       *
  2270*  INCURRED DATE                                                 *
  2271*  REPORTED DATE                                                 *
  2272*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  44
* EL131.cbl
  2273*  TERM                                                          *
  2274*  CDT PERCENT                                                   *
  2275*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2276* *CLAIM TYPE (LIFE, A/H)                                        *
  2277* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2278* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2279*                                                                *
  2280*  RETURNED FROM ELRESV                                          *
  2281*  --------------------                                          *
  2282*  CDT TABLE USED                                                *
  2283*  CDT FACTOR USED                                               *
  2284*  PAY TO CURRENT RESERVE                                        *
  2285*  I.B.N.R. - A/H ONLY                                           *
  2286*  FUTURE (ACCRUED) AH ONLY                                      *
  2287*----------------------------------------------------------------*
  2288*  PASSED TO ELRATE                                              *
  2289*  ----------------                                              *
  2290*  CERT ISSUE DATE                                               *
  2291*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2292*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2293*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2294*  STATE CODE (CLIENT DEFINED)                                   *
  2295*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2296*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2297*  DEVIATION CODE                                                *
  2298*  ISSUE AGE                                                     *
  2299*  ORIGINAL BENEFIT AMOUNT                                       *
  2300*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2301*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2302*  BENEFIT KIND (LIFE OR A/H)                                    *
  2303*  A.P.R.                                                        *
  2304*  METHOD
  2305*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2306*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2307*  COMPANY I.D. (3 CHARACTER)                                    *
  2308*  BENEFIT CODE                                                  *
  2309*  BENEFIT OVERRIDE CODE                                         *
  2310*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2311*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2312*  JOINT INDICATOR (CSL ONLY)                                    *
  2313*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2314*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2315*                                                                *
  2316*  RETURNED FROM ELRATE                                          *
  2317*  --------------------                                          *
  2318*  CALCULATED PREMIUM                                            *
  2319*  PREMIUM RATE                                                  *
  2320*  MORTALITY CODE                                                *
  2321*  MAX ATTAINED AGE                                              *
  2322*  MAX AGE                                                       *
  2323*  MAX TERM                                                      *
  2324*  MAX MONTHLY BENEFIT                                           *
  2325*  MAX TOTAL BENIFIT                                             *
  2326*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2327*----------------------------------------------------------------*
  2328*  PASSED TO ELRFND                                              *
  2329*  ----------------                                              *
  2330*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  45
* EL131.cbl
  2331*  REFUND DATE                                                   *
  2332*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2333*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2334*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2335*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2336*  STATE CODE (CLIENT DEFINED)                                   *
  2337*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2338*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2339*  DEVIATION CODE                                                *
  2340*  ISSUE AGE                                                     *
  2341*  ORIGINAL BENEFIT AMOUNT                                       *
  2342*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2343*  PROCESS TYPE (CANCEL)                                         *
  2344*  BENEFIT KIND (LIFE OR A/H)                                    *
  2345*  A.P.R.                                                        *
  2346*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2347*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2348*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2349*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2350*  COMPANY I.D. (3 CHARACTER)                                    *
  2351*  BENEFIT CODE                                                  *
  2352*  BENEFIT OVERRIDE CODE                                         *
  2353*                                                                *
  2354*  RETURNED FROM ELRFND                                          *
  2355*  --------------------                                          *
  2356*  CALCULATED REFUND                                             *
  2357*----------------------------------------------------------------*
  2358*  PASSED TO ELEARN                                              *
  2359*  ----------------                                              *
  2360*  CERT ISSUE DATE                                               *
  2361*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2362*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2363*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2364*  STATE CODE (CLIENT DEFINED)                                   *
  2365*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2366*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2367*  DEVIATION CODE                                                *
  2368*  ISSUE AGE                                                     *
  2369*  ORIGINAL BENEFIT AMOUNT                                       *
  2370*  BENEFIT KIND (LIFE OR A/H)                                    *
  2371*  A.P.R.                                                        *
  2372*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2373*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2374*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2375*  COMPANY I.D. (3 CHARACTER)                                    *
  2376*  BENEFIT CODE                                                  *
  2377*  BENEFIT OVERRIDE CODE                                         *
  2378*                                                                *
  2379*  RETURNED FROM ELEARN                                          *
  2380*  --------------------                                          *
  2381*  INDICATED  EARNINGS                                           *
  2382*----------------------------------------------------------------*
  2383*                 LENGTH = 450                                   *
  2384*                                                                *
  2385******************************************************************
  2386******************************************************************
  2387*                   C H A N G E   L O G
  2388*
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  46
* EL131.cbl
  2389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2390*-----------------------------------------------------------------
  2391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2392* EFFECTIVE    NUMBER
  2393*-----------------------------------------------------------------
  2394* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2395* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2396* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2397* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2398* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2399* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2400* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2401******************************************************************
  2402
  2403 01  CALCULATION-PASS-AREA.
  2404     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2405                                     COMP.
  2406
  2407     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2408       88  NO-CP-ERROR                             VALUE ZERO.
  2409       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2410                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2411       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2412       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2413       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2414       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2415       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2416       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2417       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2418       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2419       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2420       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2421       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2422       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2423       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2424       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2425       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2426       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2427       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2428
  2429     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2430       88  NO-CP-ERROR-2                           VALUE ZERO.
  2431***********************  INPUT AREAS ****************************
  2432
  2433     12  CP-CALCULATION-AREA.
  2434         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2435         16  CP-CERT-EFF-DT        PIC XX.
  2436         16  CP-VALUATION-DT       PIC XX.
  2437         16  CP-PAID-THRU-DT       PIC XX.
  2438         16  CP-BENEFIT-TYPE       PIC X.
  2439           88  CP-AH                               VALUE 'A' 'D'
  2440                                                   'I' 'U'.
  2441           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2442           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2443         16  CP-INCURRED-DT        PIC XX.
  2444         16  CP-REPORTED-DT        PIC XX.
  2445         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2446         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  47
* EL131.cbl
  2447         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2448                                     COMP-3.
  2449         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2450                                     COMP-3.
  2451         16  CP-CDT-METHOD         PIC X.
  2452           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2453           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2454           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2455         16  CP-CLAIM-TYPE         PIC X.
  2456           88  CP-AH-CLAIM                         VALUE 'A'.
  2457           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2458         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2459                                     COMP-3.
  2460         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2461                                     COMP-3.
  2462         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2463                                     COMP-3.
  2464         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2465                                     COMP-3.
  2466         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2467                                     COMP-3.
  2468         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2469                                     COMP-3.
  2470         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2471                                     COMP-3.
  2472         16  CP-REM-TERM-METHOD    PIC X.
  2473           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2474           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2475           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2476           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2477           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2478           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2479           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2480         16  CP-EARNING-METHOD     PIC X.
  2481           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2482           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2483           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2484           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2485           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2486           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2487           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2488           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2489           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2490           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2491           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2492           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2493         16  CP-PROCESS-TYPE       PIC X.
  2494           88  CP-CLAIM                            VALUE '1'.
  2495           88  CP-CANCEL                           VALUE '2'.
  2496           88  CP-ISSUE                            VALUE '3'.
  2497         16  CP-SPECIAL-CALC-CD    PIC X.
  2498           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2499           88  CP-1-MTH-INTEREST               VALUE ' '.
  2500           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2501           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2502           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2503           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2504           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  48
* EL131.cbl
  2505           88  CP-FARM-PLAN                    VALUE 'F'.
  2506           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2507           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2508           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2509           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2510           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2511           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2512           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2513           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2514           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2515           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2516                                                     'W' 'X'.
  2517           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2518           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2519           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2520           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2521           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2522           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2523           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2524           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2525           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2526           88  CP-CSL-METH-1                   VALUE '5'.
  2527           88  CP-CSL-METH-2                   VALUE '6'.
  2528           88  CP-CSL-METH-3                   VALUE '7'.
  2529           88  CP-CSL-METH-4                   VALUE '8'.
  2530
  2531         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2532                                     COMP-3.
  2533         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2534         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2535         16  CP-STATE              PIC XX          VALUE SPACE.
  2536         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2537         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2538           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2539               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2540         16  CP-R78-OPTION         PIC X.
  2541           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2542           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2543
  2544         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2545         16  CP-IBNR-RESERVE-SW    PIC X.
  2546         16  CP-CLAIM-STATUS       PIC X.
  2547         16  CP-RATE-FILE          PIC X.
  2548         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2549                                     COMP-3.
  2550
  2551         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2552         16  CP-AH-OVERRIDE-CODE   PIC X.
  2553
  2554         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2555                                     COMP-3.
  2556         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2557                                     COMP-3.
  2558         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2559                                     COMP-3.
  2560         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2561                                     COMP-3.
  2562
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  49
* EL131.cbl
  2563         16  CP-PAID-FROM-DATE     PIC X(02).
  2564         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2565         16  CP-EXT-DAYS-CALC      PIC X.
  2566           88  CP-EXT-NO-CHG                   VALUE ' '.
  2567           88  CP-EXT-CHG-LF                   VALUE '1'.
  2568           88  CP-EXT-CHG-AH                   VALUE '2'.
  2569           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2570         16  CP-DOMICILE-STATE     PIC XX.
  2571         16  CP-CARRIER            PIC X.
  2572         16  CP-REIN-FLAG          PIC X.
  2573         16  CP-REM-TRM-CALC-OPTION PIC X.
  2574           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2575                      '2' '3' '4' '5'.
  2576           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2577           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2578           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2579           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2580           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2581           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2582           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2583           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2584         16  CP-SIG-SWITCH         PIC X.
  2585         16  CP-RATING-METHOD      PIC X.
  2586           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2587           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2588           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2589           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2590           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2591           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2592           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2593           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2594           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2595         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2596                                     COMP-3.
  2597         16  CP-BEN-CATEGORY       PIC X.
  2598         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2599         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2600                                   PIC S99V9(5) COMP-3.
  2601         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2602         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2603                                   PIC S99V9(5) COMP-3.
  2604         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2605         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2606         16  CP-EXPIRE-DT          PIC XX.
  2607         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2608         16  FILLER                PIC X(35).
  2609*        16  FILLER                PIC X(50).
  2610
  2611***************    OUTPUT FROM ELRESV   ************************
  2612
  2613         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2614
  2615         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2616                                     COMP-3.
  2617         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2618                                     COMP-3.
  2619         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2620                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  50
* EL131.cbl
  2621         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2622                                     COMP-3.
  2623         16  FILLER                PIC X(09).
  2624***************    OUTPUT FROM ELRTRM   *************************
  2625
  2626         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2627                                     COMP-3.
  2628         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2629                                     COMP-3.
  2630         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2631                                     COMP-3.
  2632         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2633                                     COMP-3.
  2634         16  FILLER                PIC X(12).
  2635
  2636***************    OUTPUT FROM ELRAMT   *************************
  2637
  2638         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2639                                     COMP-3.
  2640         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2641                                     COMP-3.
  2642         16  FILLER                PIC X(12).
  2643
  2644***************    OUTPUT FROM ELRATE   *************************
  2645
  2646         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2647                                     COMP-3.
  2648         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2649                                     COMP-3.
  2650         16  CP-MORTALITY-CODE     PIC X(4).
  2651         16  CP-RATE-EDIT-FLAG     PIC X.
  2652             88  CP-RATES-NEED-APR                  VALUE '1'.
  2653         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2654                                     COMP-3.
  2655         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2656         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2657         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2658                                   PIC S9(7)V99 COMP-3.
  2659         16  FILLER                PIC X(07).
  2660
  2661***************    OUTPUT FROM ELRFND   *************************
  2662
  2663         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2664                                     COMP-3.
  2665         16  CP-REFUND-TYPE-USED   PIC X.
  2666           88  CP-R-AS-R78                         VALUE '1'.
  2667           88  CP-R-AS-PRORATA                     VALUE '2'.
  2668           88  CP-R-AS-CALIF                       VALUE '3'.
  2669           88  CP-R-AS-TEXAS                       VALUE '4'.
  2670           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2671           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2672           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2673           88  CP-R-AS-MEAN                        VALUE '8'.
  2674           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2675           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2676           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2677         16  FILLER                PIC X(12).
  2678
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  51
* EL131.cbl
  2679***************    OUTPUT FROM ELEARN   *************************
  2680
  2681         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2682                                     COMP-3.
  2683         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2684                                     COMP-3.
  2685         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2686                                     COMP-3.
  2687         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2688                                     COMP-3.
  2689         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2690                                     COMP-3.
  2691         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2692                                     COMP-3.
  2693         16  CP-EARNING-TYPE-USED  PIC X.
  2694           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2695           88  CP-E-AS-R78                         VALUE '1'.
  2696           88  CP-E-AS-PRORATA                     VALUE '2'.
  2697           88  CP-E-AS-TEXAS                       VALUE '4'.
  2698           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2699           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2700           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2701           88  CP-E-AS-MEAN                        VALUE '8'.
  2702           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2703         16  FILLER                PIC X(12).
  2704
  2705***************    OUTPUT FROM ELPMNT   *************************
  2706
  2707         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2708                                     COMP-3.
  2709         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2710                                     COMP-3.
  2711         16  FILLER                PIC X(12).
  2712
  2713***************   MISC WORK AREAS    *****************************
  2714         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2715                                     COMP-3.
  2716         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2717                                     COMP-3.
  2718         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2719                                     COMP-3.
  2720         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2721                                     COMP-3.
  2722         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2723                                     COMP-3.
  2724         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2725                                     COMP-3.
  2726         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2727             88  OPEN-RATE-FILE                   VALUE 'O'.
  2728             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2729             88  IO-ERROR                         VALUE 'E'.
  2730
  2731         16  CP-FIRST-PAY-DATE     PIC XX.
  2732
  2733         16  CP-JOINT-INDICATOR    PIC X.
  2734
  2735         16  CP-RESERVE-REMAINING-TERM
  2736                                   PIC S9(4)V9    VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  52
* EL131.cbl
  2737                                     COMP-3.
  2738
  2739         16  CP-INSURED-BIRTH-DT   PIC XX.
  2740
  2741         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2742                                     COMP-3.
  2743
  2744         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2745                                     COMP-3.
  2746
  2747         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2748                                     COMP-3.
  2749
  2750         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2751                                     COMP-3.
  2752
  2753         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2754                                     COMP-3.
  2755
  2756         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2757                                     COMP-3.
  2758
  2759         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2760                                     COMP-3.
  2761
  2762         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2763             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2764
  2765         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2766                                     COMP-3.
  2767         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2768                                     COMP-3.
  2769         16  FILLER                PIC X(17).
  2770******************************************************************
  2771
  2772*                                COPY ELCDATE SUPPRESS.
  2773******************************************************************
  2774*                                                                *
  2775*                                                                *
  2776*                            ELCDATE.                            *
  2777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2778*                            VMOD=2.003
  2779*                                                                *
  2780*                                                                *
  2781*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2782*                 LENGTH = 200                                   *
  2783******************************************************************
  2784
  2785 01  DATE-CONVERSION-DATA.
  2786     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2787     12  DC-OPTION-CODE                PIC X.
  2788         88  BIN-TO-GREG                VALUE ' '.
  2789         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2790         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2791         88  YMD-GREG-TO-BIN            VALUE '3'.
  2792         88  MDY-GREG-TO-BIN            VALUE '4'.
  2793         88  JULIAN-TO-BIN              VALUE '5'.
  2794         88  BIN-PLUS-ELAPSED           VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  53
* EL131.cbl
  2795         88  FIND-CENTURY               VALUE '7'.
  2796         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2797         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2798         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2799         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2800         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2801         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2802         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2803         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2804         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2805         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2806         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2807         88  BIN-3-TO-GREG              VALUE 'I'.
  2808         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2809         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2810         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2811         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2812         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2813         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2814         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2815         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2816         88  THREE-CHARACTER-BIN
  2817                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2818         88  GREGORIAN-TO-BIN
  2819                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2820         88  BIN-TO-GREGORIAN
  2821                  VALUES ' ' '1' 'I' '8' 'G'.
  2822         88  JULIAN-TO-BINARY
  2823                  VALUES '5' 'C' 'E' 'F'.
  2824     12  DC-ERROR-CODE                 PIC X.
  2825         88  NO-CONVERSION-ERROR        VALUE ' '.
  2826         88  DATE-CONVERSION-ERROR
  2827                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2828         88  DATE-IS-ZERO               VALUE '1'.
  2829         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2830         88  DATE-IS-INVALID            VALUE '3'.
  2831         88  DATE1-GREATER-DATE2        VALUE '4'.
  2832         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2833         88  DATE-INVALID-OPTION        VALUE '9'.
  2834         88  INVALID-CENTURY            VALUE 'A'.
  2835         88  ONLY-CENTURY               VALUE 'B'.
  2836         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2837         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2838     12  DC-END-OF-MONTH               PIC X.
  2839         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2840     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2841         88  USE-NORMAL-PROCESS         VALUE ' '.
  2842         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2843         88  ADJUST-UP-100-YRS          VALUE '2'.
  2844     12  FILLER                        PIC X.
  2845     12  DC-CONVERSION-DATES.
  2846         16  DC-BIN-DATE-1             PIC XX.
  2847         16  DC-BIN-DATE-2             PIC XX.
  2848         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2849         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2850                       DC-GREG-DATE-1-EDIT.
  2851             20  DC-EDIT1-MONTH        PIC 99.
  2852             20  SLASH1-1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  54
* EL131.cbl
  2853             20  DC-EDIT1-DAY          PIC 99.
  2854             20  SLASH1-2              PIC X.
  2855             20  DC-EDIT1-YEAR         PIC 99.
  2856         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2857         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2858                     DC-GREG-DATE-2-EDIT.
  2859             20  DC-EDIT2-MONTH        PIC 99.
  2860             20  SLASH2-1              PIC X.
  2861             20  DC-EDIT2-DAY          PIC 99.
  2862             20  SLASH2-2              PIC X.
  2863             20  DC-EDIT2-YEAR         PIC 99.
  2864         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2865         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2866                     DC-GREG-DATE-1-YMD.
  2867             20  DC-YMD-YEAR           PIC 99.
  2868             20  DC-YMD-MONTH          PIC 99.
  2869             20  DC-YMD-DAY            PIC 99.
  2870         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2871         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2872                      DC-GREG-DATE-1-MDY.
  2873             20  DC-MDY-MONTH          PIC 99.
  2874             20  DC-MDY-DAY            PIC 99.
  2875             20  DC-MDY-YEAR           PIC 99.
  2876         16  DC-GREG-DATE-1-ALPHA.
  2877             20  DC-ALPHA-MONTH        PIC X(10).
  2878             20  DC-ALPHA-DAY          PIC 99.
  2879             20  FILLER                PIC XX.
  2880             20  DC-ALPHA-CENTURY.
  2881                 24 DC-ALPHA-CEN-N     PIC 99.
  2882             20  DC-ALPHA-YEAR         PIC 99.
  2883         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2884         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2885         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2886         16  DC-JULIAN-DATE            PIC 9(05).
  2887         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2888                                       PIC 9(05).
  2889         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2890             20  DC-JULIAN-YEAR        PIC 99.
  2891             20  DC-JULIAN-DAYS        PIC 999.
  2892         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2893         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2894         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2895     12  DATE-CONVERSION-VARIBLES.
  2896         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2897         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2898             20  FILLER                PIC 9(3).
  2899             20  HOLD-CEN-1-CCYY.
  2900                 24  HOLD-CEN-1-CC     PIC 99.
  2901                 24  HOLD-CEN-1-YY     PIC 99.
  2902             20  HOLD-CEN-1-MO         PIC 99.
  2903             20  HOLD-CEN-1-DA         PIC 99.
  2904         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2905             20  HOLD-CEN-1-R-MO       PIC 99.
  2906             20  HOLD-CEN-1-R-DA       PIC 99.
  2907             20  HOLD-CEN-1-R-CCYY.
  2908                 24  HOLD-CEN-1-R-CC   PIC 99.
  2909                 24  HOLD-CEN-1-R-YY   PIC 99.
  2910             20  FILLER                PIC 9(3).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  55
* EL131.cbl
  2911         16  HOLD-CENTURY-1-X.
  2912             20  FILLER                PIC X(3)  VALUE SPACES.
  2913             20  HOLD-CEN-1-X-CCYY.
  2914                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2915                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2916             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2917             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2918         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2919             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2920             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2921             20  HOLD-CEN-1-R-X-CCYY.
  2922                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2923                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2924             20  FILLER                PIC XXX.
  2925         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2926         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2927         16  DC-JULIAN-DATE-1          PIC 9(07).
  2928         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2929             20  DC-JULIAN-1-CCYY.
  2930                 24  DC-JULIAN-1-CC    PIC 99.
  2931                 24  DC-JULIAN-1-YR    PIC 99.
  2932             20  DC-JULIAN-DA-1        PIC 999.
  2933         16  DC-JULIAN-DATE-2          PIC 9(07).
  2934         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2935             20  DC-JULIAN-2-CCYY.
  2936                 24  DC-JULIAN-2-CC    PIC 99.
  2937                 24  DC-JULIAN-2-YR    PIC 99.
  2938             20  DC-JULIAN-DA-2        PIC 999.
  2939         16  DC-GREG-DATE-A-EDIT.
  2940             20  DC-EDITA-MONTH        PIC 99.
  2941             20  SLASHA-1              PIC X VALUE '/'.
  2942             20  DC-EDITA-DAY          PIC 99.
  2943             20  SLASHA-2              PIC X VALUE '/'.
  2944             20  DC-EDITA-CCYY.
  2945                 24  DC-EDITA-CENT     PIC 99.
  2946                 24  DC-EDITA-YEAR     PIC 99.
  2947         16  DC-GREG-DATE-B-EDIT.
  2948             20  DC-EDITB-MONTH        PIC 99.
  2949             20  SLASHB-1              PIC X VALUE '/'.
  2950             20  DC-EDITB-DAY          PIC 99.
  2951             20  SLASHB-2              PIC X VALUE '/'.
  2952             20  DC-EDITB-CCYY.
  2953                 24  DC-EDITB-CENT     PIC 99.
  2954                 24  DC-EDITB-YEAR     PIC 99.
  2955         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2956         16  DC-GREG-DATE-CYMD-R REDEFINES
  2957                              DC-GREG-DATE-CYMD.
  2958             20  DC-CYMD-CEN           PIC 99.
  2959             20  DC-CYMD-YEAR          PIC 99.
  2960             20  DC-CYMD-MONTH         PIC 99.
  2961             20  DC-CYMD-DAY           PIC 99.
  2962         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2963         16  DC-GREG-DATE-MDCY-R REDEFINES
  2964                              DC-GREG-DATE-MDCY.
  2965             20  DC-MDCY-MONTH         PIC 99.
  2966             20  DC-MDCY-DAY           PIC 99.
  2967             20  DC-MDCY-CEN           PIC 99.
  2968             20  DC-MDCY-YEAR          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  56
* EL131.cbl
  2969    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2970        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2971    12  DC-EL310-DATE                  PIC X(21).
  2972    12  FILLER                         PIC X(28).
  2973
  2974*                                COPY ELCDMO.
  2975******************************************************************
  2976*                                                                *
  2977*                                                                *
  2978*                            ELCDMO.                             *
  2979*                            VMOD=2.004                          *
  2980*                                                                *
  2981*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2982*        COMMUNICATION AREA                                      *
  2983*   FILE TYPE = NA                                               *
  2984*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2985*                                                                *
  2986******************************************************************
  2987 01  DMO-COMMUNICATION-AREA.
  2988     12  DM-RECORD-TYPE                  PIC  X(02).
  2989             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2990             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2991             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2992     12  DM-DIST-CODE                    PIC  X(04).
  2993     12  DM-MAIL-CODE                    PIC  X(05).
  2994     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2995     12  DM-INSURED-NAME                 PIC  X(30).
  2996     12  DM-CLAIM-NO                     PIC  X(07).
  2997     12  DM-CLAIM-TYPE                   PIC  X.
  2998
  2999     12  DM-STATUS-DATA-AREA.
  3000         16  DM-CLAIM-STATUS             PIC  X.
  3001             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3002             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3003             88  DM-CLOSED                        VALUE '3'.
  3004             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3005             88  DM-DEFAULT                       VALUE '9'.
  3006         16  DM-STATUS-DATE              PIC  X(08).
  3007******YYYYMMDD
  3008         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3009             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3010             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3011             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3012             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3013             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3014             88  DM-RE-OPENED                     VALUE 'R'.
  3015             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3016             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3017             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3018         16  DM-STAT-CARRIER             PIC X.
  3019
  3020     12  DM-DRAFT-DATA-AREA.
  3021         16  DM-PAYMENT-TYPE             PIC  X.
  3022             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3023         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3024         16  DM-PAYMENT-DATE             PIC  X(08).
  3025******YYYYMMDD
  3026         16  DM-CERT-NO                  PIC  X(11).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  57
* EL131.cbl
  3027         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3028         16  DM-CARRIER                  PIC  X.
  3029
  3030     12  DM-RETURN-CODE                  PIC  XX.
  3031
  3032****************************************************************
  3033*
  3034* Copyright (c) 2007 by Clerity Solutions, Inc.
  3035* All rights reserved.
  3036*
  3037****************************************************************
  3038 01  DFHEIV.
  3039   02  DFHEIV0               PIC X(35).
  3040   02  DFHEIV1               PIC X(08).
  3041   02  DFHEIV2               PIC X(08).
  3042   02  DFHEIV3               PIC X(08).
  3043   02  DFHEIV4               PIC X(06).
  3044   02  DFHEIV5               PIC X(04).
  3045   02  DFHEIV6               PIC X(04).
  3046   02  DFHEIV7               PIC X(02).
  3047   02  DFHEIV8               PIC X(02).
  3048   02  DFHEIV9               PIC X(01).
  3049   02  DFHEIV10              PIC S9(7) COMP-3.
  3050   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3051   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3052   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3053   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3054   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3055   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3056   02  DFHEIV17              PIC X(04).
  3057   02  DFHEIV18              PIC X(04).
  3058   02  DFHEIV19              PIC X(04).
  3059   02  DFHEIV20              USAGE IS POINTER.
  3060   02  DFHEIV21              USAGE IS POINTER.
  3061   02  DFHEIV22              USAGE IS POINTER.
  3062   02  DFHEIV23              USAGE IS POINTER.
  3063   02  DFHEIV24              USAGE IS POINTER.
  3064   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3065   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3066   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3067   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3068   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3069   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3070   02  FILLER                PIC X(02).
  3071   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3072   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3073   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3074   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3075   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3076 LINKAGE  SECTION.
  3077*****************************************************************
  3078*                                                               *
  3079* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3080* All rights reserved.                                          *
  3081*                                                               *
  3082*****************************************************************
  3083 01  dfheiblk.
  3084     02  eibtime          pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  58
* EL131.cbl
  3085     02  eibdate          pic s9(7) comp-3.
  3086     02  eibtrnid         pic x(4).
  3087     02  eibtaskn         pic s9(7) comp-3.
  3088     02  eibtrmid         pic x(4).
  3089     02  dfheigdi         pic s9(4) comp.
  3090     02  eibcposn         pic s9(4) comp.
  3091     02  eibcalen         pic s9(4) comp.
  3092     02  eibaid           pic x(1).
  3093     02  eibfiller1       pic x(1).
  3094     02  eibfn            pic x(2).
  3095     02  eibfiller2       pic x(2).
  3096     02  eibrcode         pic x(6).
  3097     02  eibfiller3       pic x(2).
  3098     02  eibds            pic x(8).
  3099     02  eibreqid         pic x(8).
  3100     02  eibrsrce         pic x(8).
  3101     02  eibsync          pic x(1).
  3102     02  eibfree          pic x(1).
  3103     02  eibrecv          pic x(1).
  3104     02  eibsend          pic x(1).
  3105     02  eibatt           pic x(1).
  3106     02  eibeoc           pic x(1).
  3107     02  eibfmh           pic x(1).
  3108     02  eibcompl         pic x(1).
  3109     02  eibsig           pic x(1).
  3110     02  eibconf          pic x(1).
  3111     02  eiberr           pic x(1).
  3112     02  eibrldbk         pic x(1).
  3113     02  eiberrcd         pic x(4).
  3114     02  eibsynrb         pic x(1).
  3115     02  eibnodat         pic x(1).
  3116     02  eibfiller5       pic x(2).
  3117     02  eibresp          pic 9(09) comp.
  3118     02  eibresp2         pic 9(09) comp.
  3119     02  dfheigdj         pic s9(4) comp.
  3120     02  dfheigdk         pic s9(4) comp.
  3121 01  DFHCOMMAREA                 PIC X(1024).
  3122
  3123*                                COPY ELCMSTR.
  3124******************************************************************
  3125*                                                                *
  3126*                            ELCMSTR.                            *
  3127*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3128*                            VMOD=2.012                          *
  3129*                                                                *
  3130*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3131*                                                                *
  3132*   FILE TYPE = VSAM,KSDS                                        *
  3133*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3134*                                                                *
  3135*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3136*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3137*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3138*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3139*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3140*                                                 RKP=75,LEN=21  *
  3141*                                                                *
  3142*   **** NOTE ****                                               *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  59
* EL131.cbl
  3143*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3144*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3145*                                                                *
  3146*   LOG = YES                                                    *
  3147*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3148******************************************************************
  3149*                   C H A N G E   L O G
  3150*
  3151* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3152*-----------------------------------------------------------------
  3153*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3154* EFFECTIVE    NUMBER
  3155*-----------------------------------------------------------------
  3156* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3157* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3158******************************************************************
  3159 01  CLAIM-MASTER.
  3160     12  CL-RECORD-ID                PIC XX.
  3161         88  VALID-CL-ID         VALUE 'CL'.
  3162
  3163     12  CL-CONTROL-PRIMARY.
  3164         16  CL-COMPANY-CD           PIC X.
  3165         16  CL-CARRIER              PIC X.
  3166         16  CL-CLAIM-NO             PIC X(7).
  3167         16  CL-CERT-NO.
  3168             20  CL-CERT-PRIME       PIC X(10).
  3169             20  CL-CERT-SFX         PIC X.
  3170
  3171     12  CL-CONTROL-BY-NAME.
  3172         16  CL-COMPANY-CD-A1        PIC X.
  3173         16  CL-INSURED-LAST-NAME    PIC X(15).
  3174         16  CL-INSURED-NAME.
  3175             20  CL-INSURED-1ST-NAME PIC X(12).
  3176             20  CL-INSURED-MID-INIT PIC X.
  3177
  3178     12  CL-CONTROL-BY-SSN.
  3179         16  CL-COMPANY-CD-A2        PIC X.
  3180         16  CL-SOC-SEC-NO.
  3181             20  CL-SSN-STATE        PIC XX.
  3182             20  CL-SSN-ACCOUNT      PIC X(6).
  3183             20  CL-SSN-LN3          PIC X(3).
  3184
  3185     12  CL-CONTROL-BY-CERT-NO.
  3186         16  CL-COMPANY-CD-A4        PIC X.
  3187         16  CL-CERT-NO-A4.
  3188             20  CL-CERT-A4-PRIME    PIC X(10).
  3189             20  CL-CERT-A4-SFX      PIC X.
  3190
  3191     12  CL-CONTROL-BY-CCN.
  3192         16  CL-COMPANY-CD-A5        PIC X.
  3193         16  CL-CCN-A5.
  3194             20  CL-CCN.
  3195                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3196                 24  CL-CCN-PRIME-A5 PIC X(12).
  3197             20  CL-CCN-FILLER-A5    PIC X(4).
  3198
  3199     12  CL-INSURED-PROFILE-DATA.
  3200         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  60
* EL131.cbl
  3201         16  CL-INSURED-SEX-CD       PIC X.
  3202             88  INSURED-IS-MALE        VALUE 'M'.
  3203             88  INSURED-IS-FEMALE      VALUE 'F'.
  3204             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3205         16  CL-INSURED-OCC-CD       PIC X(6).
  3206         16  FILLER                  PIC X(5).
  3207
  3208     12  CL-PROCESSING-INFO.
  3209         16  CL-PROCESSOR-ID         PIC X(4).
  3210         16  CL-CLAIM-STATUS         PIC X.
  3211             88  CLAIM-IS-OPEN          VALUE 'O'.
  3212             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3213         16  CL-CLAIM-TYPE           PIC X.
  3214*            88  AH-CLAIM               VALUE 'A'.
  3215*            88  LIFE-CLAIM             VALUE 'L'.
  3216*            88  PROPERTY-CLAIM         VALUE 'P'.
  3217*            88  IUI-CLAIM              VALUE 'I'.
  3218*            88  GAP-CLAIM              VALUE 'G'.
  3219         16  CL-CLAIM-PREM-TYPE      PIC X.
  3220             88  SINGLE-PREMIUM         VALUE '1'.
  3221             88  O-B-COVERAGE           VALUE '2'.
  3222             88  OPEN-END-COVERAGE      VALUE '3'.
  3223         16  CL-INCURRED-DT          PIC XX.
  3224         16  CL-REPORTED-DT          PIC XX.
  3225         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3226         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3227         16  CL-LAST-PMT-DT          PIC XX.
  3228         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3229         16  CL-PAID-THRU-DT         PIC XX.
  3230         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3231         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3232         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3233         16  CL-PMT-CALC-METHOD      PIC X.
  3234             88  CL-360-DAY-YR          VALUE '1'.
  3235             88  CL-365-DAY-YR          VALUE '2'.
  3236             88  CL-FULL-MONTHS         VALUE '3'.
  3237         16  CL-CAUSE-CD             PIC X(6).
  3238
  3239         16  CL-PRIME-CERT-NO.
  3240             20  CL-PRIME-CERT-PRIME PIC X(10).
  3241             20  CL-PRIME-CERT-SFX   PIC X.
  3242
  3243         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3244             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3245             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3246
  3247         16  CL-MICROFILM-NO         PIC X(10).
  3248         16  CL-PROG-FORM-TYPE       PIC X.
  3249         16  CL-LAST-ADD-ON-DT       PIC XX.
  3250
  3251         16  CL-LAST-REOPEN-DT       PIC XX.
  3252         16  CL-LAST-CLOSE-DT        PIC XX.
  3253         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3254             88  FINAL-PAID             VALUE '1'.
  3255             88  CLAIM-DENIED           VALUE '2'.
  3256             88  AUTO-CLOSE             VALUE '3'.
  3257             88  MANUAL-CLOSE           VALUE '4'.
  3258             88  BENEFITS-CHANGED       VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  61
* EL131.cbl
  3259             88  SETUP-ERRORS           VALUE 'E'.
  3260         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3261         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3262         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3263             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3264         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3265         16  FILLER                  PIC X.
  3266
  3267     12  CL-CERTIFICATE-DATA.
  3268         16  CL-CERT-ORIGIN          PIC X.
  3269             88  CERT-WAS-ONLINE        VALUE '1'.
  3270             88  CERT-WAS-CREATED       VALUE '2'.
  3271             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3272         16  CL-CERT-KEY-DATA.
  3273             20  CL-CERT-CARRIER     PIC X.
  3274             20  CL-CERT-GROUPING    PIC X(6).
  3275             20  CL-CERT-STATE       PIC XX.
  3276             20  CL-CERT-ACCOUNT.
  3277                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3278                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3279             20  CL-CERT-EFF-DT      PIC XX.
  3280
  3281     12  CL-STATUS-CONTROLS.
  3282         16  CL-PRIORITY-CD          PIC X.
  3283             88  CONFIDENTIAL-DATA      VALUE '8'.
  3284             88  HIGHEST-PRIORITY       VALUE '9'.
  3285         16  CL-SUPV-ATTN-CD         PIC X.
  3286             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3287             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3288         16  CL-PURGED-DT            PIC XX.
  3289         16  CL-RESTORED-DT          PIC XX.
  3290         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3291         16  CL-NEXT-RESEND-DT       PIC XX.
  3292         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3293         16  FILLER                  PIC XX.
  3294         16  CL-LAST-MAINT-DT        PIC XX.
  3295         16  CL-LAST-MAINT-USER      PIC X(4).
  3296         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3297         16  CL-LAST-MAINT-TYPE      PIC X.
  3298             88  CLAIM-SET-UP           VALUE ' '.
  3299             88  PAYMENT-MADE           VALUE '1'.
  3300             88  LETTER-SENT            VALUE '2'.
  3301             88  MASTER-WAS-ALTERED     VALUE '3'.
  3302             88  MASTER-WAS-RESTORED    VALUE '4'.
  3303             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3304             88  FILE-CONVERTED         VALUE '6'.
  3305             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3306             88  ERROR-CORRECTION       VALUE 'E'.
  3307         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3308         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3309         16  CL-BENEFICIARY          PIC X(10).
  3310         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3311         16  CL-DENIAL-TYPE          PIC X.
  3312             88  CL-TYPE-DENIAL          VALUE '1'.
  3313             88  CL-TYPE-RESCISSION      VALUE '2'.
  3314             88  CL-TYPE-REFORMATION     VALUE '3'.
  3315             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3316             88  CL-TYPE-RECONSIDERED    VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  62
* EL131.cbl
  3317         16  FILLER                  PIC X(5).
  3318
  3319     12  CL-TRAILER-CONTROLS.
  3320         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3321             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3322             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3323             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3324         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3325         16  FILLER                  PIC XX.
  3326         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3327         16  CL-ADDRESS-TRAILER-CNT.
  3328             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3329                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3330             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3331                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3332             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3333                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3334             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3335                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3336             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3337                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3338             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3339                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3340             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3341                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3342
  3343     12  CL-CV-REFERENCE-NO.
  3344         16  CL-CV-REFNO-PRIME       PIC X(18).
  3345         16  CL-CV-REFNO-SFX         PIC XX.
  3346
  3347     12  CL-FILE-LOCATION            PIC X(4).
  3348
  3349     12  CL-PROCESS-ERRORS.
  3350         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3351             88  NO-FATAL-ERRORS        VALUE ZERO.
  3352         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3353             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3354
  3355     12  CL-PRODUCT-CD               PIC X.
  3356
  3357     12  CL-CURRENT-KEY-DATA.
  3358         16  CL-CURRENT-CARRIER      PIC X.
  3359         16  CL-CURRENT-GROUPING     PIC X(6).
  3360         16  CL-CURRENT-STATE        PIC XX.
  3361         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3362
  3363     12  CL-ASSOCIATES               PIC X.
  3364         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3365         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3366         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3367         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3368
  3369     12  CL-ACTIVITY-CODE            PIC 99.
  3370     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3371     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3372
  3373     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3374     12  CL-LAG-REPORT-CODE          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  63
* EL131.cbl
  3375     12  CL-LOAN-TYPE                PIC XX.
  3376     12  CL-LEGAL-STATE              PIC XX.
  3377
  3378*    12  FILLER                      PIC X(5).
  3379     12  CL-YESNOSW                  PIC X.
  3380     12  FILLER                      PIC X(4).
  3381
  3382*                                COPY ELCCERT.
  3383******************************************************************
  3384*                                                                *
  3385*                            ELCCERT.                            *
  3386*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3387*                            VMOD=2.013                          *
  3388*                                                                *
  3389*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3390*                                                                *
  3391*   FILE TYPE = VSAM,KSDS                                        *
  3392*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3393*                                                                *
  3394*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3395*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3396*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3397*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3398*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3399*                                                                *
  3400*   LOG = YES                                                    *
  3401*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3402******************************************************************
  3403*                   C H A N G E   L O G
  3404*
  3405* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3406*-----------------------------------------------------------------
  3407*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3408* EFFECTIVE    NUMBER
  3409*-----------------------------------------------------------------
  3410* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3411* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3412* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3413* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3414* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3415* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3416* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3417******************************************************************
  3418
  3419 01  CERTIFICATE-MASTER.
  3420     12  CM-RECORD-ID                      PIC XX.
  3421         88  VALID-CM-ID                      VALUE 'CM'.
  3422
  3423     12  CM-CONTROL-PRIMARY.
  3424         16  CM-COMPANY-CD                 PIC X.
  3425         16  CM-CARRIER                    PIC X.
  3426         16  CM-GROUPING.
  3427             20  CM-GROUPING-PREFIX        PIC X(3).
  3428             20  CM-GROUPING-PRIME         PIC X(3).
  3429         16  CM-STATE                      PIC XX.
  3430         16  CM-ACCOUNT.
  3431             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3432             20  CM-ACCOUNT-PRIME          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  64
* EL131.cbl
  3433         16  CM-CERT-EFF-DT                PIC XX.
  3434         16  CM-CERT-NO.
  3435             20  CM-CERT-PRIME             PIC X(10).
  3436             20  CM-CERT-SFX               PIC X.
  3437
  3438     12  CM-CONTROL-BY-NAME.
  3439         16  CM-COMPANY-CD-A1              PIC X.
  3440         16  CM-INSURED-LAST-NAME          PIC X(15).
  3441         16  CM-INSURED-INITIALS.
  3442             20  CM-INSURED-INITIAL1       PIC X.
  3443             20  CM-INSURED-INITIAL2       PIC X.
  3444
  3445     12  CM-CONTROL-BY-SSN.
  3446         16  CM-COMPANY-CD-A2              PIC X.
  3447         16  CM-SOC-SEC-NO.
  3448             20  CM-SSN-STATE              PIC XX.
  3449             20  CM-SSN-ACCOUNT            PIC X(6).
  3450             20  CM-SSN-LN3.
  3451                 25  CM-INSURED-INITIALS-A2.
  3452                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3453                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3454                 25 CM-PART-LAST-NAME-A2         PIC X.
  3455
  3456     12  CM-CONTROL-BY-CERT-NO.
  3457         16  CM-COMPANY-CD-A4              PIC X.
  3458         16  CM-CERT-NO-A4                 PIC X(11).
  3459
  3460     12  CM-CONTROL-BY-MEMB.
  3461         16  CM-COMPANY-CD-A5              PIC X.
  3462         16  CM-MEMBER-NO.
  3463             20  CM-MEMB-STATE             PIC XX.
  3464             20  CM-MEMB-ACCOUNT           PIC X(6).
  3465             20  CM-MEMB-LN4.
  3466                 25  CM-INSURED-INITIALS-A5.
  3467                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3468                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3469                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3470
  3471     12  CM-INSURED-PROFILE-DATA.
  3472         16  CM-INSURED-FIRST-NAME.
  3473             20  CM-INSURED-1ST-INIT       PIC X.
  3474             20  FILLER                    PIC X(9).
  3475         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3476         16  CM-INSURED-SEX                PIC X.
  3477             88  CM-SEX-MALE                  VALUE 'M'.
  3478             88  CM-SEX-FEMAL                 VALUE 'F'.
  3479         16  CM-INSURED-JOINT-AGE          PIC 99.
  3480         16  CM-JOINT-INSURED-NAME.
  3481             20  CM-JT-LAST-NAME           PIC X(15).
  3482             20  CM-JT-FIRST-NAME.
  3483                 24  CM-JT-1ST-INIT        PIC X.
  3484                 24  FILLER                PIC X(9).
  3485             20  CM-JT-INITIAL             PIC X.
  3486
  3487     12  CM-LIFE-DATA.
  3488         16  CM-LF-BENEFIT-CD              PIC XX.
  3489         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3490         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  65
* EL131.cbl
  3491         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3492         16  CM-LF-DEV-CODE                PIC XXX.
  3493         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3494         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3495         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3496         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3497         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3498         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3499         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3500         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3501         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3502         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3503         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3504         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3505         16  FILLER                        PIC XX.
  3506
  3507     12  CM-AH-DATA.
  3508         16  CM-AH-BENEFIT-CD              PIC XX.
  3509         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3510         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3511         16  CM-AH-DEV-CODE                PIC XXX.
  3512         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3513         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3514         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3515         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3516         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3517         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3518         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3519         16  CM-AH-PAID-THRU-DT            PIC XX.
  3520             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3521         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3522         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3523         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3524         16  FILLER                        PIC X.
  3525
  3526     12  CM-LOAN-INFORMATION.
  3527         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3528         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3529         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3530         16  CM-PAY-FREQUENCY              PIC S99.
  3531         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3532         16  CM-RATE-CLASS                 PIC XX.
  3533         16  CM-BENEFICIARY                PIC X(25).
  3534         16  CM-POLICY-FORM-NO             PIC X(12).
  3535         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3536         16  CM-LAST-ADD-ON-DT             PIC XX.
  3537         16  CM-DEDUCTIBLE-AMOUNTS.
  3538             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3539             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3540         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3541             20  CM-RESIDENT-STATE         PIC XX.
  3542             20  CM-RATE-CODE              PIC X(4).
  3543             20  FILLER                    PIC XX.
  3544         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3545             20  CM-LOAN-OFFICER           PIC X(5).
  3546             20  FILLER                    PIC XXX.
  3547         16  CM-CSR-CODE                   PIC XXX.
  3548         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  66
* EL131.cbl
  3549             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3550         16  CM-POST-CARD-IND              PIC X.
  3551         16  CM-NH-INTERFACE-SW            PIC X.
  3552         16  CM-PREMIUM-TYPE               PIC X.
  3553             88  CM-SING-PRM                  VALUE '1'.
  3554             88  CM-O-B-COVERAGE              VALUE '2'.
  3555             88  CM-OPEN-END                  VALUE '3'.
  3556         16  CM-IND-GRP-TYPE               PIC X.
  3557             88  CM-INDIVIDUAL                VALUE 'I'.
  3558             88  CM-GROUP                     VALUE 'G'.
  3559         16  CM-SKIP-CODE                  PIC X.
  3560             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3561             88  SKIP-JULY                    VALUE '1'.
  3562             88  SKIP-AUGUST                  VALUE '2'.
  3563             88  SKIP-SEPTEMBER               VALUE '3'.
  3564             88  SKIP-JULY-AUG                VALUE '4'.
  3565             88  SKIP-AUG-SEPT                VALUE '5'.
  3566             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3567             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3568             88  SKIP-JUNE                    VALUE '8'.
  3569             88  SKIP-JUNE-JULY               VALUE '9'.
  3570             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3571             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3572         16  CM-PAYMENT-MODE               PIC X.
  3573             88  PAY-MONTHLY                  VALUE SPACE.
  3574             88  PAY-WEEKLY                   VALUE '1'.
  3575             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3576             88  PAY-BI-WEEKLY                VALUE '3'.
  3577             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3578         16  CM-LOAN-NUMBER                PIC X(8).
  3579         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3580         16  CM-OLD-LOF                    PIC XXX.
  3581*        16  CM-LOAN-OFFICER               PIC XXX.
  3582         16  CM-REIN-TABLE                 PIC XXX.
  3583         16  CM-SPECIAL-REIN-CODE          PIC X.
  3584         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3585         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3586         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3587
  3588     12  CM-STATUS-DATA.
  3589         16  CM-ENTRY-STATUS               PIC X.
  3590         16  CM-ENTRY-DT                   PIC XX.
  3591
  3592         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3593         16  CM-LF-CANCEL-DT               PIC XX.
  3594         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3595
  3596         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3597         16  CM-LF-DEATH-DT                PIC XX.
  3598         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3599
  3600         16  CM-LF-CURRENT-STATUS          PIC X.
  3601             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3602                                                'M' '4' '5' '9'.
  3603             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3604             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3605             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3606             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  67
* EL131.cbl
  3607             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3608             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3609             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3610             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3611             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3612             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3613             88  CM-LF-DECLINED               VALUE 'D'.
  3614             88  CM-LF-VOIDED                 VALUE 'V'.
  3615
  3616         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3617         16  CM-AH-CANCEL-DT               PIC XX.
  3618         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3619
  3620         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3621         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3622         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3623
  3624         16  CM-AH-CURRENT-STATUS          PIC X.
  3625             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3626                                                'M' '4' '5' '9'.
  3627             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3628             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3629             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3630             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3631             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3632             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3633             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3634             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3635             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3636             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  3637             88  CM-AH-DECLINED               VALUE 'D'.
  3638             88  CM-AH-VOIDED                 VALUE 'V'.
  3639
  3640         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3641             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3642             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3643             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3644         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3645
  3646         16  CM-ENTRY-BATCH                PIC X(6).
  3647         16  CM-LF-EXIT-BATCH              PIC X(6).
  3648         16  CM-AH-EXIT-BATCH              PIC X(6).
  3649         16  CM-LAST-MONTH-END             PIC XX.
  3650
  3651     12  CM-NOTE-SW                        PIC X.
  3652         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3653         88  CERT-NOTES-PRESENT               VALUE '1'.
  3654         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3655         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3656         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3657         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3658         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3659         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3660     12  CM-COMP-EXCP-SW                   PIC X.
  3661         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3662         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3663     12  CM-INSURED-ADDRESS-SW             PIC X.
  3664         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  68
* EL131.cbl
  3665         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3666
  3667*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3668     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3669     12  FILLER                            PIC X.
  3670
  3671*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3672     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3673     12  FILLER                            PIC X.
  3674*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3675     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3676
  3677     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3678         88  CERT-ADDED-BATCH                 VALUE ' '.
  3679         88  CERT-ADDED-ONLINE                VALUE '1'.
  3680         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3681         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3682         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3683     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3684         88  CERT-AS-LOADED                   VALUE ' '.
  3685         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3686         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3687         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3688         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3689         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3690         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3691         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3692
  3693     12  CM-ACCOUNT-COMM-PCTS.
  3694         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  3695         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3696
  3697     12  CM-USER-FIELD                     PIC X.
  3698     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3699     12  CM-CLP-STATE                      PIC XX.
  3700     12  CM-USER-RESERVED                  PIC XXX.
  3701******************************************************************
  3702
  3703*                                COPY ELCTRLR.
  3704******************************************************************
  3705*                                                                *
  3706*                            ELCTRLR.                            *
  3707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3708*                            VMOD=2.014                          *
  3709*                                                                *
  3710*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3711*                                                                *
  3712*   FILE TYPE = VSAM,KSDS                                        *
  3713*   RECORD SIZE = 200    RECFORM = FIXED                         *
  3714*                                                                *
  3715*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  3716*       ALTERNATE INDEX = NONE                                   *
  3717*                                                                *
  3718*   LOG = YES                                                    *
  3719*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3720******************************************************************
  3721*                   C H A N G E   L O G
  3722*
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  69
* EL131.cbl
  3723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3724*-----------------------------------------------------------------
  3725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3726* EFFECTIVE    NUMBER
  3727*-----------------------------------------------------------------
  3728* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3729* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  3730* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  3731* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  3732* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  3733* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  3734* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  3735* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  3736* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  3737* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  3738* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  3739* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  3740******************************************************************
  3741 01  ACTIVITY-TRAILERS.
  3742     12  AT-RECORD-ID                    PIC XX.
  3743         88  VALID-AT-ID                       VALUE 'AT'.
  3744
  3745     12  AT-CONTROL-PRIMARY.
  3746         16  AT-COMPANY-CD               PIC X.
  3747         16  AT-CARRIER                  PIC X.
  3748         16  AT-CLAIM-NO                 PIC X(7).
  3749         16  AT-CERT-NO.
  3750             20  AT-CERT-PRIME           PIC X(10).
  3751             20  AT-CERT-SFX             PIC X.
  3752         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  3753             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  3754             88  AT-LAST-TRL-AVAIL            VALUE +100.
  3755             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  3756             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  3757             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  3758             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  3759             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  3760             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  3761             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  3762             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  3763             88  AT-DIAGNOSIS-TRL             VALUE +90.
  3764             88  AT-BENEFICIARY-TRL           VALUE +91.
  3765             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  3766
  3767     12  AT-TRAILER-TYPE                 PIC X.
  3768         88  RESERVE-EXPENSE-TR               VALUE '1'.
  3769         88  PAYMENT-TR                       VALUE '2'.
  3770         88  AUTO-PAY-TR                      VALUE '3'.
  3771         88  CORRESPONDENCE-TR                VALUE '4'.
  3772         88  ADDRESS-TR                       VALUE '5'.
  3773         88  GENERAL-INFO-TR                  VALUE '6'.
  3774         88  AUTO-PROMPT-TR                   VALUE '7'.
  3775         88  DENIAL-TR                        VALUE '8'.
  3776         88  INCURRED-CHG-TR                  VALUE '9'.
  3777         88  FORM-CONTROL-TR                  VALUE 'A'.
  3778
  3779     12  AT-RECORDED-DT                  PIC XX.
  3780     12  AT-RECORDED-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  70
* EL131.cbl
  3781     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  3782
  3783     12  AT-TRAILER-BODY                 PIC X(165).
  3784
  3785     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  3786         16  AT-RESERVE-CONTROLS.
  3787             20  AT-MANUAL-SW            PIC X.
  3788                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  3789             20  AT-FUTURE-SW            PIC X.
  3790                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  3791             20  AT-PTC-SW               PIC X.
  3792                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  3793             20  AT-IBNR-SW              PIC X.
  3794                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  3795             20  AT-PTC-LF-SW            PIC X.
  3796                 88  AT-LF-PTC-USED          VALUE '1'.
  3797             20  AT-CDT-ACCESS-METHOD    PIC X.
  3798                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  3799                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  3800                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  3801             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  3802         16  AT-LAST-COMPUTED-DT         PIC XX.
  3803         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  3804         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  3805         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  3806         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3807         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3808         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  3809         16  AT-EXPENSE-CONTROLS.
  3810             20  AT-EXPENSE-METHOD       PIC X.
  3811                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  3812                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  3813                 88  PERCENT-OF-PMT           VALUE '3'.
  3814                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  3815             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  3816             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  3817         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  3818         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  3819
  3820         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  3821         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  3822
  3823*        16  FILLER                      PIC X(53).
  3824         16  FILLER                      PIC X(47).
  3825
  3826         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  3827         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  3828
  3829         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  3830             20  AT-OPEN-CLOSE-DATE      PIC XX.
  3831             20  AT-OPEN-CLOSE-TYPE      PIC X.
  3832*                    C = CLOSED
  3833*                    O = OPEN
  3834             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  3835*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  3836
  3837     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  3838         16  AT-PAYMENT-TYPE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  71
* EL131.cbl
  3839             88  PARTIAL-PAYMENT                VALUE '1'.
  3840             88  FINAL-PAYMENT                  VALUE '2'.
  3841             88  LUMP-SUM-PAYMENT               VALUE '3'.
  3842             88  ADDITIONAL-PAYMENT             VALUE '4'.
  3843             88  CHARGEABLE-EXPENSE             VALUE '5'.
  3844             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  3845             88  VOIDED-PAYMENT                 VALUE '9'.
  3846             88  TRANSFER                       VALUE 'T'.
  3847             88  LIFE-INTEREST                  VALUE 'I'.
  3848
  3849         16  AT-CLAIM-TYPE               PIC X.
  3850             88  PAID-FOR-AH                    VALUE 'A'.
  3851             88  PAID-FOR-LIFE                  VALUE 'L'.
  3852             88  PAID-FOR-IUI                   VALUE 'I'.
  3853             88  PAID-FOR-GAP                   VALUE 'G'.
  3854         16  AT-CLAIM-PREM-TYPE          PIC X.
  3855             88  AT-SINGLE-PREMIUM              VALUE '1'.
  3856             88  AT-O-B-COVERAGE                VALUE '2'.
  3857             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  3858         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  3859         16  AT-CHECK-NO                 PIC X(7).
  3860         16  AT-PAID-FROM-DT             PIC XX.
  3861         16  AT-PAID-THRU-DT             PIC XX.
  3862         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  3863         16  FILLER                      PIC X.
  3864         16  AT-PAYEES-NAME              PIC X(30).
  3865         16  AT-PAYMENT-ORIGIN           PIC X.
  3866             88  ONLINE-MANUAL-PMT              VALUE '1'.
  3867             88  ONLINE-AUTO-PMT                VALUE '2'.
  3868             88  OFFLINE-PMT                    VALUE '3'.
  3869         16  AT-CHECK-WRITTEN-DT         PIC XX.
  3870         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  3871         16  AT-VOID-DATA.
  3872             20  AT-VOID-DT              PIC XX.
  3873*00144       20  AT-VOID-REASON          PIC X(30).
  3874             20  AT-VOID-REASON          PIC X(26).
  3875         16  AT-PMT-APPROVED-BY          PIC X(04).
  3876         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  3877         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  3878         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  3879                                         PIC S99V9(5)  COMP-3.
  3880         16  AT-CREDIT-INTERFACE.
  3881             20  AT-PMT-SELECT-DT        PIC XX.
  3882                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  3883             20  AT-PMT-ACCEPT-DT        PIC XX.
  3884                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  3885             20  AT-VOID-SELECT-DT       PIC XX.
  3886                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  3887             20  AT-VOID-ACCEPT-DT       PIC XX.
  3888                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  3889
  3890         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  3891                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3892                 88  CONVERSION-PAYMENT           VALUE +99999999.
  3893         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  3894
  3895         16  AT-FORCE-CONTROL            PIC X.
  3896             88  PAYMENT-WAS-FORCED           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  72
* EL131.cbl
  3897         16  AT-PREV-LAST-PMT-DT         PIC XX.
  3898         16  AT-PREV-PAID-THRU-DT        PIC XX.
  3899         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  3900         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  3901         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  3902         16  AT-BENEFIT-TYPE             PIC X.
  3903
  3904         16  AT-EXPENSE-TYPE             PIC X.
  3905         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  3906
  3907         16  AT-PAYEE-TYPE-CD.
  3908             20  AT-PAYEE-TYPE           PIC X.
  3909                 88  INSURED-PAID           VALUE 'I'.
  3910                 88  BENEFICIARY-PAID       VALUE 'B'.
  3911                 88  ACCOUNT-PAID           VALUE 'A'.
  3912                 88  OTHER-1-PAID           VALUE 'O'.
  3913                 88  OTHER-2-PAID           VALUE 'Q'.
  3914                 88  DOCTOR-PAID            VALUE 'P'.
  3915                 88  EMPLOYER-PAID          VALUE 'E'.
  3916             20  AT-PAYEE-SEQ            PIC X.
  3917
  3918         16  AT-CASH-PAYMENT             PIC X.
  3919         16  AT-GROUPED-PAYMENT          PIC X.
  3920         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  3921         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  3922         16  AT-APPROVED-LEVEL           PIC X.
  3923         16  AT-VOID-TYPE                PIC X.
  3924             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  3925             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  3926         16  AT-AIG-UNEMP-IND            PIC X.
  3927             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  3928         16  AT-ASSOCIATES               PIC X.
  3929             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  3930             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  3931
  3932         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  3933         16  AT-CV-PMT-CODE              PIC X.
  3934             88  FULL-DEATH-PAYMENT         VALUE '1'.
  3935             88  HALF-DEATH-PAYMENT         VALUE '2'.
  3936             88  FULL-ADD-PAYMENT           VALUE '3'.
  3937             88  HALF-ADD-PAYMENT           VALUE '4'.
  3938             88  FULL-RIDER-PAYMENT         VALUE '5'.
  3939             88  HALF-RIDER-PAYMENT         VALUE '6'.
  3940             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  3941             88  ADDL-PAYMENT               VALUE '8'.
  3942
  3943         16  AT-EOB-CODE1                PIC XXX.
  3944         16  AT-EOB-CODE2                PIC XXX.
  3945         16  AT-EOB-CODE3                PIC XXX.
  3946         16  AT-EOB-CODE4                PIC XXX.
  3947         16  FILLER REDEFINES AT-EOB-CODE4.
  3948             20  AT-INT-PMT-SELECT-DT    PIC XX.
  3949             20  FILLER                  PIC X.
  3950         16  AT-EOB-CODE5                PIC XXX.
  3951         16  FILLER REDEFINES AT-EOB-CODE5.
  3952             20  AT-PMT-PROOF-DT         PIC XX.
  3953             20  FILLER                  PIC X.
  3954
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  73
* EL131.cbl
  3955         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  3956             88  AT-PRINT-EOB            VALUE 'Y'.
  3957
  3958         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  3959         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  3960
  3961     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  3962         16  AT-SCHEDULE-START-DT        PIC XX.
  3963         16  AT-SCHEDULE-END-DT          PIC XX.
  3964         16  AT-TERMINATED-DT            PIC XX.
  3965         16  AT-LAST-PMT-TYPE            PIC X.
  3966             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  3967             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  3968         16  AT-FIRST-PMT-DATA.
  3969             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  3970             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  3971             20  AT-1ST-PAY-THRU-DT      PIC XX.
  3972         16  AT-REGULAR-PMT-DATA.
  3973             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  3974             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  3975             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  3976         16  AT-AUTO-PAYEE-CD.
  3977             20  AT-AUTO-PAYEE-TYPE      PIC X.
  3978                 88  INSURED-PAID-AUTO      VALUE 'I'.
  3979                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  3980                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  3981                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  3982                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  3983             20  AT-AUTO-PAYEE-SEQ       PIC X.
  3984         16  AT-AUTO-PAY-DAY             PIC 99.
  3985         16  AT-AUTO-CASH                PIC X.
  3986             88  AT-CASH                      VALUE 'Y'.
  3987             88  AT-NON-CASH                  VALUE 'N'.
  3988*        16  FILLER                      PIC X(129).
  3989         16  AT-AUTO-END-LETTER          PIC X(4).
  3990         16  FILLER                      PIC X(125).
  3991
  3992         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  3993         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  3994
  3995     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  3996         16  AT-LETTER-SENT-DT           PIC XX.
  3997         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  3998         16  AT-AUTO-RE-SEND-DT          PIC XX.
  3999         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4000         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4001         16  AT-LETTER-ORIGIN            PIC X.
  4002             88  ONLINE-CREATION              VALUE '1' '3'.
  4003             88  OFFLINE-CREATION             VALUE '2' '4'.
  4004             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4005             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4006         16  AT-STD-LETTER-FORM          PIC X(4).
  4007         16  AT-REASON-TEXT              PIC X(70).
  4008         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4009         16  AT-ADDRESEE-TYPE            PIC X.
  4010              88  INSURED-ADDRESEE            VALUE 'I'.
  4011              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4012              88  ACCOUNT-ADDRESEE            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  74
* EL131.cbl
  4013              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4014              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4015              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4016              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4017         16  AT-ADDRESSEE-NAME           PIC X(30).
  4018         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4019         16  AT-RESEND-PRINT-DATE        PIC XX.
  4020         16  AT-CORR-SOL-UNSOL           PIC X.
  4021         16  AT-LETTER-PURGED-DT         PIC XX.
  4022*
  4023*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4024*
  4025         16  AT-CSO-REDEFINITION.
  4026             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4027             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4028             20  AT-LETTER-TO-BENE       PIC X(1).
  4029             20  AT-STOP-LETTER-DT       PIC X(2).
  4030             20  FILLER                  PIC X(19).
  4031*             20  FILLER                  PIC X(27).
  4032             20  AT-CSO-LETTER-STATUS    PIC X.
  4033                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4034                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4035                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4036             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4037             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4038*
  4039*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4040*
  4041*        16  FILLER                      PIC X(26).
  4042*
  4043*        16  AT-DMD-BSR-CODE             PIC X.
  4044*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4045*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4046*
  4047*        16  AT-DMD-LETTER-STATUS        PIC X.
  4048*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4049*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4050*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4051*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4052*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4053
  4054         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4055         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4056
  4057     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4058         16  AT-ADDRESS-TYPE             PIC X.
  4059             88  INSURED-ADDRESS               VALUE 'I'.
  4060             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4061             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4062             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4063             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4064             88  OTHER-ADDRESS-1               VALUE 'O'.
  4065             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4066         16  AT-MAIL-TO-NAME             PIC X(30).
  4067         16  AT-ADDRESS-LINE-1           PIC X(30).
  4068         16  AT-ADDRESS-LINE-2           PIC X(30).
  4069         16  AT-CITY-STATE.
  4070             20  AT-CITY                 PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  75
* EL131.cbl
  4071             20  AT-STATE                PIC XX.
  4072         16  AT-ZIP.
  4073             20  AT-ZIP-CODE.
  4074                 24  AT-ZIP-1ST          PIC X.
  4075                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4076                 24  FILLER              PIC X(4).
  4077             20  AT-ZIP-PLUS4            PIC X(4).
  4078         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4079             20  AT-CAN-POSTAL-1         PIC XXX.
  4080             20  AT-CAN-POSTAL-2         PIC XXX.
  4081             20  FILLER                  PIC XXX.
  4082         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4083         16  FILLER                      PIC X(23).
  4084         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4085         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4086
  4087     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4088         16  AT-INFO-LINE-1              PIC X(60).
  4089         16  AT-INFO-LINE-2              PIC X(60).
  4090         16  AT-INFO-TRAILER-TYPE        PIC X.
  4091             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4092             88  AT-CALL-NOTE            VALUE 'C'.
  4093             88  AT-MAINT-NOTE           VALUE 'M'.
  4094             88  AT-CERT-CHANGE          VALUE 'X'.
  4095             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4096             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4097         16  AT-CALL-TYPE                PIC X.
  4098             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4099             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4100         16  AT-NOTE-CONTINUATION        PIC X.
  4101             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4102         16  AT-EOB-CODES-EXIST          PIC X.
  4103             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4104         16  FILLER                      PIC X(35).
  4105         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4106         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4107
  4108     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4109         16  AT-PROMPT-LINE-1            PIC X(60).
  4110         16  AT-PROMPT-LINE-2            PIC X(60).
  4111         16  AT-PROMPT-START-DT          PIC XX.
  4112         16  AT-PROMPT-END-DT            PIC XX.
  4113         16  FILLER                      PIC X(35).
  4114         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4115         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4116
  4117     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4118         16  AT-DENIAL-INFO-1            PIC X(60).
  4119         16  AT-DENIAL-INFO-2            PIC X(60).
  4120         16  AT-DENIAL-DT                PIC XX.
  4121         16  AT-RETRACTION-DT            PIC XX.
  4122         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4123*         16  FILLER                      PIC X(31).
  4124         16  AT-DENIAL-PROOF-DT          PIC XX.
  4125         16  FILLER                      PIC X(29).
  4126         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4127         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4128
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  76
* EL131.cbl
  4129     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4130         16  AT-OLD-INCURRED-DT          PIC XX.
  4131         16  AT-OLD-REPORTED-DT          PIC XX.
  4132         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4133         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4134         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4135         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4136         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4137         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4138         16  FILLER                      PIC X(26).
  4139         16  AT-OLD-DIAG-CODE            PIC X(6).
  4140         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4141         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4142         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4143         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4144         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4145         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4146         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4147         16  FILLER                      PIC X(25).
  4148         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4149
  4150     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4151         16  AT-FORM-SEND-ON-DT          PIC XX.
  4152         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4153         16  AT-FORM-RE-SEND-DT          PIC XX.
  4154         16  AT-FORM-ANSWERED-DT         PIC XX.
  4155         16  AT-FORM-PRINTED-DT          PIC XX.
  4156         16  AT-FORM-REPRINT-DT          PIC XX.
  4157         16  AT-FORM-TYPE                PIC X.
  4158             88  INITIAL-FORM                  VALUE '1'.
  4159             88  PROGRESS-FORM                 VALUE '2'.
  4160         16  AT-INSTRUCT-LN-1            PIC X(28).
  4161         16  AT-INSTRUCT-LN-2            PIC X(28).
  4162         16  AT-INSTRUCT-LN-3            PIC X(28).
  4163         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4164         16  AT-FORM-ADDRESS             PIC X.
  4165             88  FORM-TO-INSURED              VALUE 'I'.
  4166             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4167             88  FORM-TO-OTHER-1              VALUE 'O'.
  4168             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4169         16  AT-RELATED-1.
  4170             20 AT-REL-CARR-1            PIC X.
  4171             20 AT-REL-CLAIM-1           PIC X(7).
  4172             20 AT-REL-CERT-1            PIC X(11).
  4173         16  AT-RELATED-2.
  4174             20 AT-REL-CARR-2            PIC X.
  4175             20 AT-REL-CLAIM-2           PIC X(7).
  4176             20 AT-REL-CERT-2            PIC X(11).
  4177         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4178         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4179         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4180         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4181         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4182         16  AT-STOP-FORM-DT             PIC X(2).
  4183
  4184         16  FILLER                      PIC X(09).
  4185         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4186         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  77
* EL131.cbl
  4187******************************************************************
  4188
  4189*                                COPY ELCCNTL.
  4190******************************************************************
  4191*                                                                *
  4192*                                                                *
  4193*                            ELCCNTL.                            *
  4194*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4195*                            VMOD=2.059                          *
  4196*                                                                *
  4197*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4198*                                                                *
  4199*   FILE TYPE = VSAM,KSDS                                        *
  4200*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4201*                                                                *
  4202*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4203*       ALTERNATE INDEX = NONE                                   *
  4204*                                                                *
  4205*   LOG = YES                                                    *
  4206*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4207******************************************************************
  4208*                   C H A N G E   L O G
  4209*
  4210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4211*-----------------------------------------------------------------
  4212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4213* EFFECTIVE    NUMBER
  4214*-----------------------------------------------------------------
  4215* 082503                   PEMA  ADD BENEFIT GROUP
  4216* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4217* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4218* 092705    2005050300006  PEMA  ADD SPP LEASES
  4219* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4220* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4221* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4222* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4223******************************************************************
  4224*
  4225 01  CONTROL-FILE.
  4226     12  CF-RECORD-ID                       PIC XX.
  4227         88  VALID-CF-ID                        VALUE 'CF'.
  4228
  4229     12  CF-CONTROL-PRIMARY.
  4230         16  CF-COMPANY-ID                  PIC XXX.
  4231         16  CF-RECORD-TYPE                 PIC X.
  4232             88  CF-COMPANY-MASTER              VALUE '1'.
  4233             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4234             88  CF-STATE-MASTER                VALUE '3'.
  4235             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4236             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4237             88  CF-CARRIER-MASTER              VALUE '6'.
  4238             88  CF-MORTALITY-MASTER            VALUE '7'.
  4239             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4240             88  CF-TERMINAL-MASTER             VALUE '9'.
  4241             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4242             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4243             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4244             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  78
* EL131.cbl
  4245             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4246             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4247             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4248             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4249             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4250         16  CF-ACCESS-CD-GENL              PIC X(4).
  4251         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4252             20  CF-PROCESSOR               PIC X(4).
  4253         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4254             20  CF-STATE-CODE              PIC XX.
  4255             20  FILLER                     PIC XX.
  4256         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4257             20  FILLER                     PIC XX.
  4258             20  CF-HI-BEN-IN-REC           PIC XX.
  4259         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4260             20  FILLER                     PIC XXX.
  4261             20  CF-CARRIER-CNTL            PIC X.
  4262         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4263             20  FILLER                     PIC XX.
  4264             20  CF-HI-TYPE-IN-REC          PIC 99.
  4265         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4266             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4267                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4268             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4269             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4270         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4271             20  FILLER                     PIC X.
  4272             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4273         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4274             20  FILLER                     PIC XX.
  4275             20  CF-MORTGAGE-PLAN           PIC XX.
  4276         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4277
  4278     12  CF-LAST-MAINT-DT                   PIC XX.
  4279     12  CF-LAST-MAINT-BY                   PIC X(4).
  4280     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4281
  4282     12  CF-RECORD-BODY                     PIC X(728).
  4283
  4284
  4285****************************************************************
  4286*             COMPANY MASTER RECORD                            *
  4287****************************************************************
  4288
  4289     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4290         16  CF-COMPANY-ADDRESS.
  4291             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4292             20  CF-CL-IN-CARE-OF           PIC X(30).
  4293             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4294             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4295             20  CF-CL-CITY-STATE           PIC X(30).
  4296             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4297             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4298         16  CF-COMPANY-CD                  PIC X.
  4299         16  CF-COMPANY-PASSWORD            PIC X(8).
  4300         16  CF-SECURITY-OPTION             PIC X.
  4301             88  ALL-SECURITY                   VALUE '1'.
  4302             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  79
* EL131.cbl
  4303             88  PROCESSOR-VERIFY               VALUE '3'.
  4304             88  NO-SECURITY                    VALUE '4'.
  4305             88  ALL-BUT-TERM                   VALUE '5'.
  4306         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4307             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4308         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4309             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4310         16  CF-INFORCE-LOCATION            PIC X.
  4311             88  CERTS-ARE-ONLINE               VALUE '1'.
  4312             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4313             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4314         16  CF-LOWER-CASE-LETTERS          PIC X.
  4315         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4316             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4317             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4318             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4319             88  CF-ACCNT-CNTL                  VALUE '3'.
  4320             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4321
  4322         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4323         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4324
  4325         16  CF-LGX-CREDIT-USER             PIC X.
  4326             88  CO-IS-NOT-USER                 VALUE 'N'.
  4327             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4328
  4329         16 CF-CREDIT-CALC-CODES.
  4330             20  CF-CR-REM-TERM-CALC PIC X.
  4331               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4332               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4333               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4334               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4335               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4336               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4337               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4338             20  CF-CR-R78-METHOD           PIC X.
  4339               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4340               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4341
  4342         16  CF-CLAIM-CONTROL-COUNTS.
  4343             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4344                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4345
  4346             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4347                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4348
  4349             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4350                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4351
  4352             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4353                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4354
  4355         16  CF-CURRENT-MONTH-END           PIC XX.
  4356
  4357         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4358             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4359             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4360             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  80
* EL131.cbl
  4361             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4362                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4363                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4364             20  CF-CO-PREM-REJECT-SW       PIC X.
  4365                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4366                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4367             20  CF-CO-REF-REJECT-SW        PIC X.
  4368                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4369                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4370
  4371         16  CF-CO-REPORTING-DT             PIC XX.
  4372         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4373         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4374           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4375           88  CF-CO-MONTH-END                  VALUE '1'.
  4376
  4377         16  CF-LGX-CLAIM-USER              PIC X.
  4378             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4379             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4380
  4381         16  CF-CREDIT-EDIT-CONTROLS.
  4382             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4383             20  CF-MIN-AGE                 PIC 99.
  4384             20  CF-DEFAULT-AGE             PIC 99.
  4385             20  CF-MIN-TERM                PIC S999      COMP-3.
  4386             20  CF-MAX-TERM                PIC S999      COMP-3.
  4387             20  CF-DEFAULT-SEX             PIC X.
  4388             20  CF-JOINT-AGE-INPUT         PIC X.
  4389                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4390             20  CF-BIRTH-DATE-INPUT        PIC X.
  4391                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4392             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4393                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4394                 88  CF-ZERO-CARRIER            VALUE '1'.
  4395                 88  CF-ZERO-GROUPING           VALUE '2'.
  4396                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4397             20  CF-EDIT-SW                 PIC X.
  4398                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4399             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4400             20  CF-CR-PR-METHOD            PIC X.
  4401               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4402               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4403             20  FILLER                     PIC X.
  4404
  4405         16  CF-CREDIT-MISC-CONTROLS.
  4406             20  CF-REIN-TABLE-SW           PIC X.
  4407                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4408             20  CF-COMP-TABLE-SW           PIC X.
  4409                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4410             20  CF-EXPERIENCE-RETENTION-AGE
  4411                                            PIC S9        COMP-3.
  4412             20  CF-CONVERSION-DT           PIC XX.
  4413             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4414             20  CF-RUN-FREQUENCY-SW        PIC X.
  4415                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4416                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4417
  4418             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  81
* EL131.cbl
  4419                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4420                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4421                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4422                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4423                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4424                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4425
  4426                 24  CF-CR-CHECK-COUNT       REDEFINES
  4427                     CF-CR-CHECK-COUNTER      PIC X(4).
  4428
  4429                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4430                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4431
  4432                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4433                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4434                 24  CF-MAIL-PROCESSING       PIC X.
  4435                     88  MAIL-PROCESSING          VALUE 'Y'.
  4436
  4437         16  CF-MISC-SYSTEM-CONTROL.
  4438             20  CF-SYSTEM-C                 PIC X.
  4439                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4440             20  CF-SYSTEM-D                 PIC X.
  4441                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4442             20  CF-SOC-SEC-NO-SW            PIC X.
  4443                 88  SOC-SEC-NO-USED             VALUE '1'.
  4444             20  CF-MEMBER-NO-SW             PIC X.
  4445                 88  MEMBER-NO-USED              VALUE '1'.
  4446             20  CF-TAX-ID-NUMBER            PIC X(11).
  4447             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4448             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4449                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4450                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4451                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4452                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4453             20  CF-SYSTEM-E                 PIC X.
  4454                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4455
  4456         16  CF-LGX-LIFE-USER               PIC X.
  4457             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4458             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4459
  4460         16  CF-CR-MONTH-END-DT             PIC XX.
  4461
  4462         16  CF-FILE-MAINT-DATES.
  4463             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4464                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4465             20  CF-LAST-BATCH       REDEFINES
  4466                 CF-LAST-BATCH-NO               PIC X(4).
  4467             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4468             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4469             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4470             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4471             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4472             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4473             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4474             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4475             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4476             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  82
* EL131.cbl
  4477
  4478         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4479         16  FILLER                         PIC X.
  4480
  4481         16  CF-ALT-MORT-CODE               PIC X(4).
  4482         16  CF-MEMBER-CAPTION              PIC X(10).
  4483
  4484         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4485             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4486             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4487             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4488             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4489             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4490
  4491         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4492
  4493         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4494         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4495         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4496         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4497
  4498         16  CF-AH-OVERRIDE-L1              PIC X.
  4499         16  CF-AH-OVERRIDE-L2              PIC XX.
  4500         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4501         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4502
  4503         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4504         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4505
  4506         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4507         16  CF-AR-LAST-EL860-DT            PIC XX.
  4508         16  CF-MP-MONTH-END-DT             PIC XX.
  4509
  4510         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4511         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4512             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4513
  4514         16  CF-AR-MONTH-END-DT             PIC XX.
  4515
  4516         16  CF-CRDTCRD-USER                PIC X.
  4517             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4518             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4519
  4520         16  CF-CC-MONTH-END-DT             PIC XX.
  4521
  4522         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4523
  4524         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4525             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4526             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4527             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4528         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4529         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4530         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4531         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4532             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4533             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4534         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  83
* EL131.cbl
  4535         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4536         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4537             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4538         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4539
  4540         16  CF-CL-ZIP-CODE.
  4541             20  CF-CL-ZIP-PRIME.
  4542                 24  CF-CL-ZIP-1ST          PIC X.
  4543                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4544                 24  FILLER                 PIC X(4).
  4545             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4546         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4547             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4548             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4549             20  FILLER                     PIC XXX.
  4550
  4551         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4552         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4553         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4554         16  CF-CO-OPTION-START-DATE        PIC XX.
  4555         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4556           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4557                                                      '3' '4'.
  4558           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4559           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4560           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4561           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4562           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4563           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4564
  4565         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4566
  4567         16  CF-PAYMENT-APPROVAL-LEVELS.
  4568             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4569             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4570             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4571             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4572             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4573             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4574
  4575         16  CF-END-USER-REPORTING-USER     PIC X.
  4576             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4577             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4578
  4579         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4580             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4581             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4582
  4583         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4584
  4585         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4586         16  FILLER                         PIC X.
  4587
  4588         16  CF-CREDIT-ARCHIVE-CNTL.
  4589             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4590             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4591             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4592
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  84
* EL131.cbl
  4593         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4594
  4595         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4596             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4597             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4598
  4599         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4600             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4601             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4602
  4603         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4604
  4605         16  CF-CO-ACH-ID-CODE              PIC  X.
  4606             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4607             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4608             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4609         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4610         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4611         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4612         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4613         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4614         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4615         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4616         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4617         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4618                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4619         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4620                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4621
  4622         16  CF-CO-OVER-SHORT.
  4623             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4624             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4625
  4626*         16  FILLER                         PIC X(102).
  4627         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4628             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4629             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4630
  4631         16  CF-AH-APPROVAL-DAYS.
  4632             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4633             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4634             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4635             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4636
  4637         16  FILLER                         PIC X(82).
  4638****************************************************************
  4639*             PROCESSOR/USER RECORD                            *
  4640****************************************************************
  4641
  4642     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4643         16  CF-PROCESSOR-NAME              PIC X(30).
  4644         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4645         16  CF-PROCESSOR-TITLE             PIC X(26).
  4646         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4647                 88  MESSAGE-YES                VALUE 'Y'.
  4648                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4649
  4650*****************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  85
* EL131.cbl
  4651****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4652****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4653****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4654****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4655*****************************************************
  4656
  4657         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4658             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4659             20  CF-APPLICATION-FORCE       PIC X.
  4660             20  CF-INDIVIDUAL-APP.
  4661                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4662                     28  CF-BROWSE-APP      PIC X.
  4663                     28  CF-UPDATE-APP      PIC X.
  4664
  4665         16  CF-CURRENT-TERM-ON             PIC X(4).
  4666         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4667             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4668             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4669             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4670             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4671             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4672             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4673             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4674         16  CF-PROCESSOR-CARRIER           PIC X.
  4675             88  NO-CARRIER-SECURITY            VALUE ' '.
  4676         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4677             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4678         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4679             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4680         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4681             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4682
  4683         16  CF-PROC-SYS-ACCESS-SW.
  4684             20  CF-PROC-CREDIT-CLAIMS-SW.
  4685                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4686                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4687                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4688                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4689             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4690                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4691                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4692             20  CF-PROC-LIFE-GNRLDGR-SW.
  4693                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4694                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4695                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4696                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4697             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4698                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4699                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4700         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4701             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4702             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4703         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4704
  4705         16  CF-APPROVAL-LEVEL                  PIC X.
  4706             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4707             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4708             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  86
* EL131.cbl
  4709             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4710
  4711         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4712
  4713         16  CF-LANGUAGE-TYPE                   PIC X.
  4714             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4715             88  CF-LANG-IS-FR                      VALUE 'F'.
  4716         16  FILLER                             PIC  X(240).
  4717
  4718****************************************************************
  4719*             PROCESSOR/REMINDERS RECORD                       *
  4720****************************************************************
  4721
  4722     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4723         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4724             20  CF-START-REMIND-DT         PIC XX.
  4725             20  CF-END-REMIND-DT           PIC XX.
  4726             20  CF-REMINDER-TEXT           PIC X(50).
  4727         16  FILLER                         PIC X(296).
  4728
  4729
  4730****************************************************************
  4731*             STATE MASTER RECORD                              *
  4732****************************************************************
  4733
  4734     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4735         16  CF-STATE-ABBREVIATION          PIC XX.
  4736         16  CF-STATE-NAME                  PIC X(25).
  4737         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4738         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4739             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4740             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4741             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4742             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4743                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4744                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4745             20  CF-ST-PREM-REJECT-SW       PIC X.
  4746                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4747                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4748             20  CF-ST-REF-REJECT-SW        PIC X.
  4749                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4750                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4751         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4752         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4753         16  CF-ST-REFUND-RULES.
  4754             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4755             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4756             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4757         16  CF-ST-FST-PMT-EXTENSION.
  4758             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4759             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4760                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4761                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4762                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4763                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4764         16  CF-ST-STATE-CALL.
  4765             20  CF-ST-CALL-UNEARNED        PIC X.
  4766             20  CF-ST-CALL-RPT-CNTL        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  87
* EL131.cbl
  4767             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4768         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4769             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4770             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4771         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4772         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4773         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4774         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4775         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4776         16  FILLER                         PIC X.
  4777         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4778             20  CF-ST-BENEFIT-CD           PIC XX.
  4779             20  CF-ST-BENEFIT-KIND         PIC X.
  4780                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4781                 88  CF-ST-AH-KIND              VALUE 'A'.
  4782             20  CF-ST-REM-TERM-CALC        PIC X.
  4783                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4784                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4785                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4786                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4787                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4788                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4789                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4790                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4791
  4792             20  CF-ST-REFUND-CALC          PIC X.
  4793                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4794                 88  ST-REFD-BY-R78             VALUE '1'.
  4795                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4796                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4797                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4798                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4799                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4800                 88  ST-REFD-UTAH               VALUE '7'.
  4801                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4802                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4803                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4804
  4805             20  CF-ST-EARNING-CALC         PIC X.
  4806                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4807                 88  ST-EARN-BY-R78             VALUE '1'.
  4808                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4809                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4810                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4811                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4812                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4813                 88  ST-EARN-MEAN               VALUE '8'.
  4814                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4815
  4816             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4817                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4818                 88  ST-OVRD-BY-R78             VALUE '1'.
  4819                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4820                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4821                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4822                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4823                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4824                 88  ST-OVRD-MEAN               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  88
* EL131.cbl
  4825                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4826             20  FILLER                     PIC X.
  4827
  4828         16  CF-ST-COMMISSION-CAPS.
  4829             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4830             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4831             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4832             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4833         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4834                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4835
  4836         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4837
  4838         16  CF-ST-STATUTORY-INTEREST.
  4839             20  CF-ST-STAT-DATE-FROM       PIC X.
  4840                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4841                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4842             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4843             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4844             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4845             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4846             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4847
  4848         16  CF-ST-OVER-SHORT.
  4849             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4850             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4851
  4852         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4853
  4854         16  CF-ST-RT-CALC                  PIC X.
  4855
  4856         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4857         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4858         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4859         16  CF-ST-RF-LR-CALC               PIC X.
  4860         16  CF-ST-RF-LL-CALC               PIC X.
  4861         16  CF-ST-RF-LN-CALC               PIC X.
  4862         16  CF-ST-RF-AH-CALC               PIC X.
  4863         16  CF-ST-RF-CP-CALC               PIC X.
  4864*        16  FILLER                         PIC X(206).
  4865*CIDMOD         16  FILLER                         PIC X(192).
  4866         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4867             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4868         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4869         16  FILLER                         PIC X(187).
  4870
  4871****************************************************************
  4872*             BENEFIT MASTER RECORD                            *
  4873****************************************************************
  4874
  4875     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4876         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4877             20  CF-BENEFIT-CODE            PIC XX.
  4878             20  CF-BENEFIT-NUMERIC  REDEFINES
  4879                 CF-BENEFIT-CODE            PIC XX.
  4880             20  CF-BENEFIT-ALPHA           PIC XXX.
  4881             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4882             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  89
* EL131.cbl
  4883
  4884             20  CF-LF-COVERAGE-TYPE        PIC X.
  4885                 88  CF-REDUCING                VALUE 'R'.
  4886                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4887
  4888             20  CF-SPECIAL-CALC-CD         PIC X.
  4889                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4890                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4891                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4892                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4893                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4894                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4895                 88  CF-FARM-PLAN               VALUE 'F'.
  4896                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4897                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4898                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4899                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4900                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4901                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4902                 88  CF-PRUDENTIAL              VALUE 'P'.
  4903                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4904                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4905                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4906                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4907                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4908                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4909
  4910             20  CF-JOINT-INDICATOR         PIC X.
  4911                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4912
  4913*            20  FILLER                     PIC X(12).
  4914             20  FILLER                     PIC X(11).
  4915             20  CF-BENEFIT-CATEGORY        PIC X.
  4916             20  CF-LOAN-TYPE               PIC X(8).
  4917
  4918             20  CF-CO-REM-TERM-CALC        PIC X.
  4919                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4920                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4921                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4922                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4923                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4924
  4925             20  CF-CO-EARNINGS-CALC        PIC X.
  4926                 88  CO-EARN-BY-R78             VALUE '1'.
  4927                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4928                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4929                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4930                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4931                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4932                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4933                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4934
  4935             20  CF-CO-REFUND-CALC          PIC X.
  4936                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4937                 88  CO-REFD-BY-R78             VALUE '1'.
  4938                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4939                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4940                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  90
* EL131.cbl
  4941                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4942                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4943                 88  CO-REFD-MEAN               VALUE '8'.
  4944                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4945                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4946                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4947
  4948             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4949                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4950                 88  CO-OVRD-BY-R78             VALUE '1'.
  4951                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4952                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4953                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4954                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4955                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4956                 88  CO-OVRD-MEAN               VALUE '8'.
  4957                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4958
  4959             20  CF-CO-BEN-I-G-CD           PIC X.
  4960                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4961                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4962                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4963
  4964         16  FILLER                         PIC X(304).
  4965
  4966
  4967****************************************************************
  4968*             CARRIER MASTER RECORD                            *
  4969****************************************************************
  4970
  4971     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4972         16  CF-ADDRESS-DATA.
  4973             20  CF-MAIL-TO-NAME            PIC X(30).
  4974             20  CF-IN-CARE-OF              PIC X(30).
  4975             20  CF-ADDRESS-LINE-1          PIC X(30).
  4976             20  CF-ADDRESS-LINE-2          PIC X(30).
  4977             20  CF-CITY-STATE              PIC X(30).
  4978             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4979             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4980
  4981         16  CF-CLAIM-NO-CONTROL.
  4982             20  CF-CLAIM-NO-METHOD         PIC X.
  4983                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4984                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4985                 88  CLAIM-NO-SEQ               VALUE '3'.
  4986                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4987             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4988                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4989                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4990                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4991
  4992         16  CF-CHECK-NO-CONTROL.
  4993             20  CF-CHECK-NO-METHOD         PIC X.
  4994                 88  CHECK-NO-MANUAL            VALUE '1'.
  4995                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4996                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4997                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4998             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  91
* EL131.cbl
  4999                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5000
  5001         16  CF-DOMICILE-STATE              PIC XX.
  5002
  5003         16  CF-EXPENSE-CONTROLS.
  5004             20  CF-EXPENSE-METHOD          PIC X.
  5005                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5006                 88  DOLLARS-PER-PMT            VALUE '2'.
  5007                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5008                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5009             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5010             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5011
  5012         16  CF-CORRESPONDENCE-CONTROL.
  5013             20  CF-LETTER-RESEND-OPT       PIC X.
  5014                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5015                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5016             20  FILLER                     PIC X(4).
  5017
  5018         16  CF-RESERVE-CONTROLS.
  5019             20  CF-MANUAL-SW               PIC X.
  5020                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5021             20  CF-FUTURE-SW               PIC X.
  5022                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5023             20  CF-PTC-SW                  PIC X.
  5024                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5025             20  CF-IBNR-SW                 PIC X.
  5026                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5027             20  CF-PTC-LF-SW               PIC X.
  5028                 88  CF-LF-PTC-USED             VALUE '1'.
  5029             20  CF-CDT-ACCESS-METHOD       PIC X.
  5030                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5031                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5032                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5033             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5034
  5035         16  CF-CLAIM-CALC-METHOD           PIC X.
  5036             88  360-PLUS-MONTHS                VALUE '1'.
  5037             88  365-PLUS-MONTHS                VALUE '2'.
  5038             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5039             88  360-DAILY                      VALUE '4'.
  5040             88  365-DAILY                      VALUE '5'.
  5041
  5042         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5043         16  FILLER                         PIC X(11).
  5044
  5045         16  CF-LIMIT-AMOUNTS.
  5046             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5047             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5048             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5049             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5050             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5051             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5052             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5053             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5054             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5055             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5056
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  92
* EL131.cbl
  5057         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5058         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5059         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5060
  5061         16  CF-ZIP-CODE.
  5062             20  CF-ZIP-PRIME.
  5063                 24  CF-ZIP-1ST             PIC X.
  5064                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5065                 24  FILLER                 PIC X(4).
  5066             20  CF-ZIP-PLUS4               PIC X(4).
  5067         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5068             20  CF-CAN-POSTAL-1            PIC XXX.
  5069             20  CF-CAN-POSTAL-2            PIC XXX.
  5070             20  FILLER                     PIC XXX.
  5071
  5072         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5073         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5074         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5075
  5076         16  CF-RATING-SWITCH               PIC X.
  5077             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5078             88  CF-NO-RATING                   VALUE 'N'.
  5079
  5080         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5081
  5082         16  CF-CARRIER-OVER-SHORT.
  5083             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5084             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5085
  5086         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5087         16  CF-SECPAY-SWITCH               PIC X.
  5088             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5089             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5090         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5091         16  FILLER                         PIC X(448).
  5092*        16  FILLER                         PIC X(452).
  5093
  5094
  5095****************************************************************
  5096*             MORTALITY MASTER RECORD                          *
  5097****************************************************************
  5098
  5099     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5100         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5101                                INDEXED BY CF-MORT-NDX.
  5102             20  CF-MORT-TABLE              PIC X(5).
  5103             20  CF-MORT-TABLE-TYPE         PIC X.
  5104                 88  CF-MORT-JOINT              VALUE 'J'.
  5105                 88  CF-MORT-SINGLE             VALUE 'S'.
  5106                 88  CF-MORT-COMBINED           VALUE 'C'.
  5107                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5108                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5109             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5110             20  CF-MORT-AGE-METHOD         PIC XX.
  5111                 88  CF-AGE-LAST                VALUE 'AL'.
  5112                 88  CF-AGE-NEAR                VALUE 'AN'.
  5113             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5114             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  93
* EL131.cbl
  5115                                            PIC X.
  5116                 88  CF-MINUS                   VALUE '-'.
  5117                 88  CF-PLUS                    VALUE '+'.
  5118             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5119             20  CF-MORT-JOINT-CODE         PIC X.
  5120                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5121             20  CF-MORT-PC-Q               PIC X.
  5122                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5123             20  CF-MORT-TABLE-CODE         PIC X(4).
  5124             20  CF-MORT-COMMENTS           PIC X(15).
  5125             20  FILLER                     PIC X(14).
  5126
  5127         16  FILLER                         PIC X(251).
  5128
  5129
  5130****************************************************************
  5131*             BUSSINESS TYPE MASTER RECORD                     *
  5132****************************************************************
  5133
  5134     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5135* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5136* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5137* AND RECORD 05 IS TYPES 81-99
  5138         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5139             20  CF-BUSINESS-TITLE          PIC  X(19).
  5140             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5141                                            PIC S9V9(4) COMP-3.
  5142             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5143             20  FILLER                     PIC  X.
  5144         16  FILLER                         PIC  X(248).
  5145
  5146
  5147****************************************************************
  5148*             TERMINAL MASTER RECORD                           *
  5149****************************************************************
  5150
  5151     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5152
  5153         16  CF-COMPANY-TERMINALS.
  5154             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5155                                  PIC X(4).
  5156         16  FILLER               PIC X(248).
  5157
  5158
  5159****************************************************************
  5160*             LIFE EDIT MASTER RECORD                          *
  5161****************************************************************
  5162
  5163     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5164         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5165             20  CF-LIFE-CODE-IN            PIC XX.
  5166             20  CF-LIFE-CODE-OUT           PIC XX.
  5167         16  FILLER                         PIC X(248).
  5168
  5169
  5170****************************************************************
  5171*             AH EDIT MASTER RECORD                            *
  5172****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  94
* EL131.cbl
  5173
  5174     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5175         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5176             20  CF-AH-CODE-IN              PIC XXX.
  5177             20  CF-AH-CODE-OUT             PIC XX.
  5178         16  FILLER                         PIC X(248).
  5179
  5180
  5181****************************************************************
  5182*             CREDIBILITY TABLES                               *
  5183****************************************************************
  5184
  5185     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5186         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5187                             INDEXED BY CF-CRDB-NDX.
  5188             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5189             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5190             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5191         16  FILLER                         PIC  X(332).
  5192
  5193
  5194****************************************************************
  5195*             REPORT CUSTOMIZATION RECORD                      *
  5196****************************************************************
  5197
  5198     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5199         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5200             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5201             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5202             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5203**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5204****       A T-TRANSFER.                                   ****
  5205             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5206
  5207         16  FILLER                         PIC XX.
  5208
  5209         16  CF-CARRIER-CNTL-OPT.
  5210             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5211                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5212                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5213             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5214                                            PIC X.
  5215         16  CF-GROUP-CNTL-OPT.
  5216             20  CF-GROUP-OPT-SEQ           PIC 9.
  5217                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5218                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5219             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5220                                            PIC X(6).
  5221         16  CF-STATE-CNTL-OPT.
  5222             20  CF-STATE-OPT-SEQ           PIC 9.
  5223                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5224                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5225             20  CF-STATE-SELECT OCCURS 3 TIMES
  5226                                            PIC XX.
  5227         16  CF-ACCOUNT-CNTL-OPT.
  5228             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5229                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5230                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  95
* EL131.cbl
  5231             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5232                                            PIC X(10).
  5233         16  CF-BUS-TYP-CNTL-OPT.
  5234             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5235                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5236                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5237             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5238                                            PIC XX.
  5239         16  CF-LF-TYP-CNTL-OPT.
  5240             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5241                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5242                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5243             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5244                                            PIC XX.
  5245         16  CF-AH-TYP-CNTL-OPT.
  5246             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5247                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5248                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5249             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5250                                            PIC XX.
  5251         16  CF-REPTCD1-CNTL-OPT.
  5252             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5253                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5254                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5255             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5256                                            PIC X(10).
  5257         16  CF-REPTCD2-CNTL-OPT.
  5258             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5259                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5260                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5261             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5262                                            PIC X(10).
  5263         16  CF-USER1-CNTL-OPT.
  5264             20  CF-USER1-OPT-SEQ           PIC 9.
  5265                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5266                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5267             20  CF-USER1-SELECT OCCURS 3 TIMES
  5268                                            PIC X(10).
  5269         16  CF-USER2-CNTL-OPT.
  5270             20  CF-USER2-OPT-SEQ           PIC 9.
  5271                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5272                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5273             20  CF-USER2-SELECT OCCURS 3 TIMES
  5274                                            PIC X(10).
  5275         16  CF-USER3-CNTL-OPT.
  5276             20  CF-USER3-OPT-SEQ           PIC 9.
  5277                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5278                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5279             20  CF-USER3-SELECT OCCURS 3 TIMES
  5280                                            PIC X(10).
  5281         16  CF-USER4-CNTL-OPT.
  5282             20  CF-USER4-OPT-SEQ           PIC 9.
  5283                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5284                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5285             20  CF-USER4-SELECT OCCURS 3 TIMES
  5286                                            PIC X(10).
  5287         16  CF-USER5-CNTL-OPT.
  5288             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  96
* EL131.cbl
  5289                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5290                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5291             20  CF-USER5-SELECT OCCURS 3 TIMES
  5292                                            PIC X(10).
  5293         16  CF-REINS-CNTL-OPT.
  5294             20  CF-REINS-OPT-SEQ           PIC 9.
  5295                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5296                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5297             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5298                 24  CF-REINS-PRIME         PIC XXX.
  5299                 24  CF-REINS-SUB           PIC XXX.
  5300
  5301         16  CF-AGENT-CNTL-OPT.
  5302             20  CF-AGENT-OPT-SEQ           PIC 9.
  5303                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5304                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5305             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5306                                            PIC X(10).
  5307
  5308         16  FILLER                         PIC X(43).
  5309
  5310         16  CF-LOSS-RATIO-SELECT.
  5311             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5312             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5313         16  CF-ENTRY-DATE-SELECT.
  5314             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5315             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5316         16  CF-EFFECTIVE-DATE-SELECT.
  5317             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5318             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5319
  5320         16  CF-EXCEPTION-LIST-IND          PIC X.
  5321             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5322
  5323         16  FILLER                         PIC X(318).
  5324
  5325****************************************************************
  5326*                  EXCEPTION REPORTING RECORD                  *
  5327****************************************************************
  5328
  5329     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5330         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5331             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5332
  5333         16  CF-COMBINED-LIFE-AH-OPT.
  5334             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5335             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5336             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5337             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5338
  5339         16  CF-LIFE-OPT.
  5340             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5341             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5342             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5343             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5344             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5345             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5346             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  97
* EL131.cbl
  5347             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5348             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5349             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5350
  5351         16  CF-AH-OPT.
  5352             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5353             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5354             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5355             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5356             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5357             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5358             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5359             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5360             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5361             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5362
  5363         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5364             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5365             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5366             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5367
  5368         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5369
  5370         16  FILLER                         PIC X(673).
  5371
  5372
  5373****************************************************************
  5374*             MORTGAGE SYSTEM PLAN RECORD                      *
  5375****************************************************************
  5376
  5377     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5378         16  CF-PLAN-TYPE                   PIC X.
  5379             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5380             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5381             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5382         16  CF-PLAN-ABBREV                 PIC XXX.
  5383         16  CF-PLAN-DESCRIPT               PIC X(10).
  5384         16  CF-PLAN-NOTES                  PIC X(20).
  5385         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5386         16  CF-PLAN-UNDERWRITING.
  5387             20  CF-PLAN-TERM-DATA.
  5388                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5389                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5390             20  CF-PLAN-AGE-DATA.
  5391                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5392                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5393                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5394             20  CF-PLAN-BENEFIT-DATA.
  5395                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5396                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5397                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5398                                            PIC S9(7)V99  COMP-3.
  5399         16  CF-PLAN-POLICY-FORMS.
  5400             20  CF-POLICY-FORM             PIC X(12).
  5401             20  CF-MASTER-APPLICATION      PIC X(12).
  5402             20  CF-MASTER-POLICY           PIC X(12).
  5403         16  CF-PLAN-RATING.
  5404             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  98
* EL131.cbl
  5405             20  CF-SEX-RATING              PIC X.
  5406                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5407                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5408             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5409             20  CF-SUB-STD-TYPE            PIC X.
  5410                 88  CF-PCT-OF-PREM            VALUE '1'.
  5411                 88  CF-PCT-OF-BENE            VALUE '2'.
  5412         16  CF-PLAN-PREM-TOLERANCES.
  5413             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5414             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5415         16  CF-PLAN-PYMT-TOLERANCES.
  5416             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5417             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5418         16  CF-PLAN-MISC-DATA.
  5419             20  FILLER                     PIC X.
  5420             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5421             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5422         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5423         16  CF-PLAN-IND-GRP                PIC X.
  5424             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5425                                                     '1'.
  5426             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5427                                                     '2'.
  5428         16  CF-MIB-SEARCH-SW               PIC X.
  5429             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5430             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5431             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5432             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5433         16  CF-ALPHA-SEARCH-SW             PIC X.
  5434             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5435             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5436             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5437             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5438             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5439             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5440             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5441             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5442             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5443             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5444                                                     'A' 'B' 'C'
  5445                                                     'X' 'Y' 'Z'.
  5446         16  CF-EFF-DT-RULE-SW              PIC X.
  5447             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5448             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5449             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5450             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5451             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5452         16  FILLER                         PIC X(4).
  5453         16  CF-HEALTH-QUESTIONS            PIC X.
  5454             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5455         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5456         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5457         16  CF-PLAN-SNGL-JNT               PIC X.
  5458             88  CF-COMBINED-PLAN              VALUE 'C'.
  5459             88  CF-JNT-PLAN                   VALUE 'J'.
  5460             88  CF-SNGL-PLAN                  VALUE 'S'.
  5461         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5462         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  99
* EL131.cbl
  5463         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5464         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5465         16  CF-RERATE-CNTL                 PIC  X.
  5466             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5467             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5468             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5469             88  CF-AUTO-RECALC                 VALUE '4'.
  5470         16  CF-BENEFIT-TYPE                PIC  X.
  5471             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5472             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5473         16  CF-POLICY-FEE                  PIC S999V99
  5474                                                    COMP-3.
  5475         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5476         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5477         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5478         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5479         16  FILLER                         PIC  X(32).
  5480         16  CF-TERMINATION-FORM            PIC  X(04).
  5481         16  FILLER                         PIC  X(08).
  5482         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5483                                                       COMP-3.
  5484         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5485         16  CF-ISSUE-LETTER                PIC  X(4).
  5486         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5487         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5488             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5489             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5490         16  CF-MP-REFUND-CALC              PIC X.
  5491             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5492             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5493             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5494             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5495             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5496             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5497             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5498             88  CF-MP-REFD-MEAN                VALUE '8'.
  5499         16  CF-ALT-RATE-CODE               PIC  X(5).
  5500
  5501
  5502         16  FILLER                         PIC X(498).
  5503****************************************************************
  5504*             MORTGAGE COMPANY MASTER RECORD                   *
  5505****************************************************************
  5506
  5507     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5508         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5509         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5510             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5511             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5512             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5513             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5514             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5515
  5516         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5517         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5518         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5519         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5520         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 100
* EL131.cbl
  5521
  5522         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5523             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5524         16  CF-MP-RECON-USE-IND            PIC X(1).
  5525             88  CF-MP-USE-RECON             VALUE 'Y'.
  5526         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5527             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5528         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5529             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5530             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5531         16  FILLER                         PIC X(1).
  5532         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5533             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5534         16  CF-MORTG-MIB-VERSION           PIC X.
  5535             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5536             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5537             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5538         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5539             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5540                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5541             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5542                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5543             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5544                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5545             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5546                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5547             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5548                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5549             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5550                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5551         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5552         16  FILLER                         PIC X(7).
  5553         16  CF-MORTG-DESTINATION-SYMBOL.
  5554             20  CF-MORTG-MIB-COMM          PIC X(5).
  5555             20  CF-MORTG-MIB-TERM          PIC X(5).
  5556         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5557             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5558         16  FILLER                         PIC X(03).
  5559         16  CF-MP-CHECK-NO-CONTROL.
  5560             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5561                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5562                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5563                                                ' ' LOW-VALUES.
  5564                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5565                                               VALUE '3'.
  5566         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5567         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5568         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5569             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5570                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5571             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5572                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5573             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5574                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5575             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5576                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5577             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5578                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 101
* EL131.cbl
  5579             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5580                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5581         16  CF-MORTG-BILLING-AREA.
  5582             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5583                                            PIC X.
  5584         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5585         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5586         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5587         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5588             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5589             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5590         16  FILLER                         PIC X.
  5591         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5592             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5593             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5594         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5595         16  FILLER                         PIC X(8).
  5596         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5597         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5598         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5599         16  CF-ACH-COMPANY-ID.
  5600             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5601                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5602                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5603                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5604             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5605         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5606             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5607         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5608             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5609             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5610         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5611         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5612         16  FILLER                         PIC X(536).
  5613
  5614****************************************************************
  5615*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5616****************************************************************
  5617
  5618     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5619         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5620             20  CF-FEMALE-HEIGHT.
  5621                 24  CF-FEMALE-FT           PIC 99.
  5622                 24  CF-FEMALE-IN           PIC 99.
  5623             20  CF-FEMALE-MIN-WT           PIC 999.
  5624             20  CF-FEMALE-MAX-WT           PIC 999.
  5625         16  FILLER                         PIC X(428).
  5626
  5627     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5628         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5629             20  CF-MALE-HEIGHT.
  5630                 24  CF-MALE-FT             PIC 99.
  5631                 24  CF-MALE-IN             PIC 99.
  5632             20  CF-MALE-MIN-WT             PIC 999.
  5633             20  CF-MALE-MAX-WT             PIC 999.
  5634         16  FILLER                         PIC X(428).
  5635******************************************************************
  5636*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 102
* EL131.cbl
  5637******************************************************************
  5638     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5639         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5640             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5641             20  CF-SYS-LETTER-ID           PIC X(04).
  5642             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5643             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5644             20  CF-SYS-RESET-SW            PIC X(01).
  5645             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5646             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5647
  5648         16  FILLER                         PIC X(50).
  5649
  5650         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5651             20  CF-USER-ACTIVE-SW          PIC X(01).
  5652             20  CF-USER-LETTER-ID          PIC X(04).
  5653             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5654             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5655             20  CF-USER-RESET-SW           PIC X(01).
  5656             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5657             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5658             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5659
  5660         16  FILLER                         PIC X(246).
  5661
  5662*                                COPY ELCACTQ.
  5663******************************************************************
  5664*                                                                *
  5665*                            ELCACTQ.                            *
  5666*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  5667*                            VMOD=2.004                          *
  5668*                                                                *
  5669*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  5670*                                                                *
  5671*   FILE TYPE = VSAM,KSDS                                        *
  5672*   RECORD SIZE = 60     RECFORM = FIXED                         *
  5673*                                                                *
  5674*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  5675*       ALTERNATE INDEX = NONE                                   *
  5676*                                                                *
  5677*   LOG = YES                                                    *
  5678*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5679*                                                                *
  5680*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  5681******************************************************************
  5682
  5683 01  ACTIVITY-QUE.
  5684     12  AQ-RECORD-ID                PIC XX.
  5685         88  VALID-AQ-ID                VALUE 'AQ'.
  5686
  5687     12  AQ-CONTROL-PRIMARY.
  5688         16  AQ-COMPANY-CD           PIC X.
  5689         16  AQ-CARRIER              PIC X.
  5690         16  AQ-CLAIM-NO             PIC X(7).
  5691         16  AQ-CERT-NO.
  5692             20  AQ-CERT-PRIME       PIC X(10).
  5693             20  AQ-CERT-SFX         PIC X.
  5694
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 103
* EL131.cbl
  5695     12  AQ-PENDING-ACTIVITY-FLAGS.
  5696         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  5697         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  5698             88  PENDING-PAYMENTS       VALUE '1'.
  5699         16  AQ-PENDING-STATUS-FLAG  PIC X.
  5700             88  PENDING-FULL-PRINT     VALUE '1'.
  5701             88  PENDING-PART-PRINT     VALUE '2'.
  5702         16  AQ-PENDING-LETTER-FLAG  PIC X.
  5703             88  PENDING-LETTERS        VALUE '1'.
  5704         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  5705             88  PENDING-RESTORE        VALUE 'C'.
  5706             88  PENDING-RESTORE-LETTER VALUE 'L'.
  5707
  5708     12  FILLER                      PIC X(20).
  5709
  5710     12  AQ-RESEND-DATE              PIC XX.
  5711     12  AQ-FOLLOWUP-DATE            PIC XX.
  5712     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  5713     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  5714     12  AQ-AUTO-LETTER              PIC X(4).
  5715     12  FILLER                      PIC XX.
  5716     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  5717*****************************************************************
  5718
  5719*                                COPY ERCACCT.
  5720******************************************************************
  5721*                                                                *
  5722*                                                                *
  5723*                            ERCACCT                             *
  5724*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5725*                            VMOD=2.031                          *
  5726*                                                                *
  5727*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5728*                                                                *
  5729*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5730*   VSAM ACCOUNT MASTER FILES.                                   *
  5731*                                                                *
  5732*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5733*                                                                *
  5734*   FILE TYPE = VSAM,KSDS                                        *
  5735*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5736*                                                                *
  5737*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5738*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5739*                                                                *
  5740*   LOG = NO                                                     *
  5741*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5742*                                                                *
  5743*                                                                *
  5744******************************************************************
  5745*                   C H A N G E   L O G
  5746*
  5747* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5748*-----------------------------------------------------------------
  5749*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5750* EFFECTIVE    NUMBER
  5751*-----------------------------------------------------------------
  5752* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 104
* EL131.cbl
  5753* 092705    2005050300006  PEMA  ADD SPP LEASES
  5754* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5755* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5756******************************************************************
  5757
  5758 01  ACCOUNT-MASTER.
  5759     12  AM-RECORD-ID                      PIC XX.
  5760         88  VALID-AM-ID                      VALUE 'AM'.
  5761
  5762     12  AM-CONTROL-PRIMARY.
  5763         16  AM-COMPANY-CD                 PIC X.
  5764         16  AM-MSTR-CNTRL.
  5765             20  AM-CONTROL-A.
  5766                 24  AM-CARRIER            PIC X.
  5767                 24  AM-GROUPING.
  5768                     28 AM-GROUPING-PREFIX PIC XXX.
  5769                     28 AM-GROUPING-PRIME  PIC XXX.
  5770                 24  AM-STATE              PIC XX.
  5771                 24  AM-ACCOUNT.
  5772                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5773                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5774             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5775                                           PIC X(19).
  5776             20  AM-CNTRL-B.
  5777                 24  AM-EXPIRATION-DT      PIC XX.
  5778                 24  FILLER                PIC X(4).
  5779             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5780                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5781
  5782     12  AM-CONTROL-BY-VAR-GRP.
  5783         16  AM-COMPANY-CD-A1              PIC X.
  5784         16  AM-VG-CARRIER                 PIC X.
  5785         16  AM-VG-GROUPING                PIC X(6).
  5786         16  AM-VG-STATE                   PIC XX.
  5787         16  AM-VG-ACCOUNT                 PIC X(10).
  5788         16  AM-VG-DATE.
  5789             20  AM-VG-EXPIRATION-DT       PIC XX.
  5790             20  FILLER                    PIC X(4).
  5791         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5792                                           PIC 9(11)      COMP-3.
  5793     12  AM-MAINT-INFORMATION.
  5794         16  AM-LAST-MAINT-DT              PIC XX.
  5795         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5796         16  AM-LAST-MAINT-USER            PIC X(4).
  5797         16  FILLER                        PIC XX.
  5798
  5799     12  AM-EFFECTIVE-DT                   PIC XX.
  5800     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5801
  5802     12  AM-PREV-DATES  COMP-3.
  5803         16  AM-PREV-EXP-DT                PIC 9(11).
  5804         16  AM-PREV-EFF-DT                PIC 9(11).
  5805
  5806     12  AM-REPORT-CODE-1                  PIC X(10).
  5807     12  AM-REPORT-CODE-2                  PIC X(10).
  5808
  5809     12  AM-CITY-CODE                      PIC X(4).
  5810     12  AM-COUNTY-PARISH                  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 105
* EL131.cbl
  5811
  5812     12  AM-NAME                           PIC X(30).
  5813     12  AM-PERSON                         PIC X(30).
  5814     12  AM-ADDRS                          PIC X(30).
  5815     12  AM-CITY.
  5816         16  AM-ADDR-CITY                  PIC X(28).
  5817         16  AM-ADDR-STATE                 PIC XX.
  5818     12  AM-ZIP.
  5819         16  AM-ZIP-PRIME.
  5820             20  AM-ZIP-PRI-1ST            PIC X.
  5821                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5822             20  FILLER                    PIC X(4).
  5823         16  AM-ZIP-PLUS4                  PIC X(4).
  5824     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5825         16  AM-CAN-POSTAL-1               PIC XXX.
  5826         16  AM-CAN-POSTAL-2               PIC XXX.
  5827         16  FILLER                        PIC XXX.
  5828     12  AM-TEL-NO.
  5829         16  AM-AREA-CODE                  PIC 999.
  5830         16  AM-TEL-PRE                    PIC 999.
  5831         16  AM-TEL-NBR                    PIC 9(4).
  5832     12  AM-TEL-LOC                        PIC X.
  5833         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5834         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5835
  5836     12  AM-COMM-STRUCTURE.
  5837         16  AM-DEFN-1.
  5838             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5839                 24  AM-AGT.
  5840                     28  AM-AGT-PREFIX     PIC X(4).
  5841                     28  AM-AGT-PRIME      PIC X(6).
  5842                 24  AM-COM-TYP            PIC X.
  5843                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5844                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5845                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5846                 24  AM-RECALC-LV-INDIC    PIC X.
  5847                 24  AM-RETRO-LV-INDIC     PIC X.
  5848                 24  AM-GL-CODES           PIC X.
  5849                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5850                 24  FILLER                PIC X(01).
  5851         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5852             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5853                 24  FILLER                PIC X(11).
  5854                 24  AM-L-COMA             PIC XXX.
  5855                 24  AM-J-COMA             PIC XXX.
  5856                 24  AM-A-COMA             PIC XXX.
  5857                 24  FILLER                PIC X(6).
  5858
  5859     12  AM-COMM-CHANGE-STATUS             PIC X.
  5860         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5861
  5862     12  AM-CSR-CODE                       PIC X(4).
  5863
  5864     12  AM-BILLING-STATUS                 PIC X.
  5865         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5866         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5867     12  AM-AUTO-REFUND-SW                 PIC X.
  5868         88  AUTO-REFUNDS-USED                VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 106
* EL131.cbl
  5869         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5870     12  AM-GPCD                           PIC 99.
  5871     12  AM-IG                             PIC X.
  5872         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5873         88  AM-HAS-GROUP                     VALUE '2'.
  5874     12  AM-STATUS                         PIC X.
  5875         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5876         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5877         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5878         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5879         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5880     12  AM-REMIT-TO                       PIC 99.
  5881     12  AM-ID-NO                          PIC X(11).
  5882
  5883     12  AM-CAL-TABLE                      PIC XX.
  5884     12  AM-LF-DEVIATION                   PIC XXX.
  5885     12  AM-AH-DEVIATION                   PIC XXX.
  5886     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5887     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5888     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5889     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5890     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5891     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5892
  5893     12  AM-USER-FIELDS.
  5894         16  AM-FLD-1                      PIC XX.
  5895         16  AM-FLD-2                      PIC XX.
  5896         16  AM-FLD-3                      PIC XX.
  5897         16  AM-FLD-4                      PIC XX.
  5898         16  AM-FLD-5                      PIC XX.
  5899
  5900     12  AM-1ST-PROD-DATE.
  5901         16  AM-1ST-PROD-YR                PIC XX.
  5902         16  AM-1ST-PROD-MO                PIC XX.
  5903         16  AM-1ST-PROD-DA                PIC XX.
  5904     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5905     12  AM-CERTS-PURGED-DATE.
  5906         16  AM-PUR-YR                     PIC XX.
  5907         16  AM-PUR-MO                     PIC XX.
  5908         16  AM-PUR-DA                     PIC XX.
  5909     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5910     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5911     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5912     12  AM-INACTIVE-DATE.
  5913         16  AM-INA-MO                     PIC 99.
  5914         16  AM-INA-DA                     PIC 99.
  5915         16  AM-INA-YR                     PIC 99.
  5916     12  AM-AR-HI-CERT-DATE                PIC XX.
  5917
  5918     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5919     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5920
  5921     12  AM-OB-PAYMENT-MODE                PIC X.
  5922         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5923         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5924         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5925         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5926
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 107
* EL131.cbl
  5927     12  AM-AH-ONLY-INDICATOR              PIC X.
  5928         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5929         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5930
  5931     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5932
  5933     12  AM-OVER-SHORT.
  5934         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5935         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5936
  5937     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5938     12  AM-DCC-CLP-STATE                  PIC XX.
  5939
  5940     12  AM-RECALC-COMM                    PIC X.
  5941     12  AM-RECALC-REIN                    PIC X.
  5942
  5943     12  AM-REI-TABLE                      PIC XXX.
  5944     12  AM-REI-ET-LF                      PIC X.
  5945     12  AM-REI-ET-AH                      PIC X.
  5946     12  AM-REI-PE-LF                      PIC X.
  5947     12  AM-REI-PE-AH                      PIC X.
  5948     12  AM-REI-PRT-ST                     PIC X.
  5949     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5950     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5951     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5952     12  AM-REI-GROUP-A                    PIC X(6).
  5953     12  AM-REI-MORT                       PIC X(4).
  5954     12  AM-REI-PRT-OW                     PIC X.
  5955     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5956     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5957     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5958     12  AM-REI-GROUP-B                    PIC X(6).
  5959
  5960     12  AM-TRUST-TYPE                     PIC X(2).
  5961
  5962     12  AM-EMPLOYER-STMT-USED             PIC X.
  5963     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5964
  5965     12  AM-STD-AH-TYPE                    PIC XX.
  5966     12  AM-EARN-METHODS.
  5967         16  AM-EARN-METHOD-R              PIC X.
  5968             88 AM-REF-RL-R78                 VALUE 'R'.
  5969             88 AM-REF-RL-PR                  VALUE 'P'.
  5970             88 AM-REF-RL-MEAN                VALUE 'M'.
  5971             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5972         16  AM-EARN-METHOD-L              PIC X.
  5973             88 AM-REF-LL-R78                 VALUE 'R'.
  5974             88 AM-REF-LL-PR                  VALUE 'P'.
  5975             88 AM-REF-LL-MEAN                VALUE 'M'.
  5976             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5977         16  AM-EARN-METHOD-A              PIC X.
  5978             88 AM-REF-AH-R78                 VALUE 'R'.
  5979             88 AM-REF-AH-PR                  VALUE 'P'.
  5980             88 AM-REF-AH-MEAN                VALUE 'M'.
  5981             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5982             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5983             88 AM-REF-AH-NET                 VALUE 'N'.
  5984
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 108
* EL131.cbl
  5985     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5986     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5987     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5988
  5989     12  AM-RET-Y-N                        PIC X.
  5990     12  AM-RET-P-E                        PIC X.
  5991     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5992     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5993     12  AM-RET-GRP                        PIC X(6).
  5994     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5995         16  AM-POOL-PRIME                 PIC XXX.
  5996         16  AM-POOL-SUB                   PIC XXX.
  5997     12  AM-RETRO-EARNINGS.
  5998         16  AM-RET-EARN-R                 PIC X.
  5999         16  AM-RET-EARN-L                 PIC X.
  6000         16  AM-RET-EARN-A                 PIC X.
  6001     12  AM-RET-ST-TAX-USE                 PIC X.
  6002         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6003         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6004     12  AM-RETRO-BEG-EARNINGS.
  6005         16  AM-RET-BEG-EARN-R             PIC X.
  6006         16  AM-RET-BEG-EARN-L             PIC X.
  6007         16  AM-RET-BEG-EARN-A             PIC X.
  6008     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6009     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6010
  6011     12  AM-USER-SELECT-OPTIONS.
  6012         16  AM-USER-SELECT-1              PIC X(10).
  6013         16  AM-USER-SELECT-2              PIC X(10).
  6014         16  AM-USER-SELECT-3              PIC X(10).
  6015         16  AM-USER-SELECT-4              PIC X(10).
  6016         16  AM-USER-SELECT-5              PIC X(10).
  6017
  6018     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6019
  6020     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6021
  6022     12  AM-RPT045A-SWITCH                 PIC X.
  6023         88  RPT045A-OFF                   VALUE 'N'.
  6024
  6025     12  AM-INSURANCE-LIMITS.
  6026         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6027         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6028
  6029     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6030         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6031
  6032     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6033         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6034         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6035
  6036     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6037
  6038     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6039     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6040     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6041     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6042     12  FILLER                            PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 109
* EL131.cbl
  6043     12  AM-REPORT-CODE-3                  PIC X(10).
  6044*    12  FILLER                            PIC X(22).
  6045
  6046     12  AM-RESERVE-DATE.
  6047         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6048         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6049         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6050
  6051     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6052     12  AM-NOTIFICATION-TYPES.
  6053         16  AM-NOTIF-OF-LETTERS           PIC X.
  6054         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6055         16  AM-NOTIF-OF-REPORTS           PIC X.
  6056         16  AM-NOTIF-OF-STATUS            PIC X.
  6057
  6058     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6059         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6060         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6061         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6062         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6063
  6064     12  AM-BENEFIT-CONTROLS.
  6065         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6066             20  AM-BENEFIT-CODE           PIC XX.
  6067             20  AM-BENEFIT-TYPE           PIC X.
  6068             20  AM-BENEFIT-REVISION       PIC XXX.
  6069             20  AM-BENEFIT-REM-TERM       PIC X.
  6070             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6071             20  FILLER                    PIC XX.
  6072         16  FILLER                        PIC X(80).
  6073
  6074     12  AM-TRANSFER-DATA.
  6075         16  AM-TRANSFERRED-FROM.
  6076             20  AM-TRNFROM-CARRIER        PIC X.
  6077             20  AM-TRNFROM-GROUPING.
  6078                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6079                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6080             20  AM-TRNFROM-STATE          PIC XX.
  6081             20  AM-TRNFROM-ACCOUNT.
  6082                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6083                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6084             20  AM-TRNFROM-DTE            PIC XX.
  6085         16  AM-TRANSFERRED-TO.
  6086             20  AM-TRNTO-CARRIER          PIC X.
  6087             20  AM-TRNTO-GROUPING.
  6088                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6089                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6090             20  AM-TRNTO-STATE            PIC XX.
  6091             20  AM-TRNTO-ACCOUNT.
  6092                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6093                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6094             20  AM-TRNTO-DTE              PIC XX.
  6095         16  FILLER                        PIC X(10).
  6096
  6097     12  AM-SAVED-REMIT-TO                 PIC 99.
  6098
  6099     12  AM-COMM-STRUCTURE-SAVED.
  6100         16  AM-DEFN-1-SAVED.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 110
* EL131.cbl
  6101             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6102                 24  AM-AGT-SV             PIC X(10).
  6103                 24  AM-COM-TYP-SV         PIC X.
  6104                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6105                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6106                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6107                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6108                 24  FILLER                PIC X.
  6109                 24  AM-GL-CODES-SV        PIC X.
  6110                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6111                 24  FILLER                PIC X.
  6112         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6113             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6114                 24  FILLER                PIC X(11).
  6115                 24  AM-L-COMA-SV          PIC XXX.
  6116                 24  AM-J-COMA-SV          PIC XXX.
  6117                 24  AM-A-COMA-SV          PIC XXX.
  6118                 24  FILLER                PIC X(6).
  6119
  6120     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6121         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6122            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6123            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6124            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6125
  6126     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6127     12  FILLER                            PIC X(120).
  6128
  6129     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6130         16  AM-CONTROL-NAME               PIC X(30).
  6131         16  AM-EXECUTIVE-ONE.
  6132             20  AM-EXEC1-NAME             PIC X(15).
  6133             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6134                                                          COMP-3.
  6135             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6136                                                          COMP-3.
  6137         16  AM-EXECUTIVE-TWO.
  6138             20  AM-EXEC2-NAME             PIC X(15).
  6139             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6140                                                          COMP-3.
  6141             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6142                                                          COMP-3.
  6143
  6144     12  AM-RETRO-ADDITIONAL-DATA.
  6145         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6146         16  AM-RETRO-PREM-P-E             PIC X.
  6147         16  AM-RETRO-CLMS-P-I             PIC X.
  6148         16  AM-RETRO-RET-BRACKET-LF.
  6149             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6150                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6151                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6152             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6153                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6154                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6155             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6156                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6157                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6158         16  AM-RETRO-RET-BRACKET-AH.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 111
* EL131.cbl
  6159             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6160                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6161                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6162                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6163             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6164                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6165                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6166             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6167                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6168                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6169
  6170     12  AM-COMMENTS.
  6171         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6172
  6173     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6174         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6175         16  AM-FLI-BILLING-CODE           PIC X.
  6176         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6177         16  AM-FLI-UNITED-IDENT           PIC X.
  6178         16  AM-FLI-INTEREST-LOST-DATA.
  6179             20  AM-FLI-BANK-NO            PIC X(5).
  6180             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6181             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6182             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6183         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6184             20  AM-FLI-AGT                PIC X(9).
  6185             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6186             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6187         16  FILLER                        PIC X(102).
  6188
  6189     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6190         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6191             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6192             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6193             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6194             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6195             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6196         16  FILLER                          PIC X(10).
  6197******************************************************************
  6198
  6199*                                COPY ELCCHKQ.
  6200******************************************************************
  6201*                                                                *
  6202*                                                                *
  6203*                            ELCCHKQ.                            *
  6204*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6205*                            VMOD=2.007                          *
  6206*                                                                *
  6207*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6208*                                                                *
  6209*   FILE TYPE = VSAM,KSDS                                        *
  6210*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6211*                                                                *
  6212*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6213*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6214*                                                                *
  6215*   LOG = YES                                                    *
  6216*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 112
* EL131.cbl
  6217******************************************************************
  6218 01  CHECK-QUE.
  6219     12  CQ-RECORD-ID                PIC XX.
  6220         88  VALID-CQ-ID         VALUE 'CQ'.
  6221
  6222     12  CQ-CONTROL-PRIMARY.
  6223         16  CQ-COMPANY-CD           PIC X.
  6224         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6225         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6226
  6227     12  CQ-CONTROL-BY-PAYEE.
  6228         16  CQ-CONTROL-BY-NUMBER.
  6229             20  CQ-COMPANY-CD-A1     PIC X.
  6230             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6231         16  CQ-PAYEE-CARRIER        PIC X.
  6232         16  CQ-PAYEE-GROUPING       PIC X(6).
  6233         16  CQ-PAYEE-STATE          PIC XX.
  6234         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6235         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6236
  6237     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6238         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6239         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6240         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6241         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6242         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6243         16  FILLER                  PIC X(3).
  6244
  6245     12  CQ-ENTRY-TYPE               PIC X.
  6246             88  CHECK-ON-QUE           VALUE 'Q'.
  6247             88  ALIGNMENT-CHECK        VALUE 'A'.
  6248             88  SPOILED-CHECK          VALUE 'S'.
  6249             88  PAYMENT-ABORTED        VALUE 'X'.
  6250
  6251     12  CQ-CLAIM-MAST-CNTL.
  6252         16  CQ-CARRIER              PIC X.
  6253         16  CQ-CLAIM-NO             PIC X(7).
  6254         16  CQ-CERT-NO.
  6255             20  CQ-CERT-PRIME       PIC X(10).
  6256             20  CQ-CERT-SFX         PIC X.
  6257         16  CQ-CLAIM-TYPE           PIC X.
  6258             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6259             88  CQ-AH-CLAIM            VALUE 'A'.
  6260         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6261             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6262             88  CQ-O-B-COVERAGE        VALUE '2'.
  6263             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6264
  6265     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6266     12  CQ-CHECK-NUMBER             PIC X(7).
  6267     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6268     12  CQ-PAYMENT-TYPE             PIC X.
  6269             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6270             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6271             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6272             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6273             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6274             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 113
* EL131.cbl
  6275             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6276             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6277     12  CQ-VOID-INDICATOR           PIC X.
  6278             88  CHECK-IS-STOPPED          VALUE 'S'.
  6279             88  CHECK-IS-VOID             VALUE 'V'.
  6280     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6281     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6282     12  CQ-CHECK-BY-USER            PIC X(4).
  6283     12  CQ-PRE-NUMBERING-SW         PIC X.
  6284       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6285       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6286
  6287     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6288     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6289     12  CQ-LEDGER-FLAG              PIC X(01).
  6290     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6291     12  CQ-LAST-UPDATED-DT          PIC XX.
  6292     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6293     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6294
  6295     12  FILLER                      PIC X(04).
  6296
  6297******************************************************************
  6298
  6299*                                COPY ELCARCH.
  6300******************************************************************
  6301*                                                                *
  6302*                            ELCARCH.                            *
  6303*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6304*                            VMOD=2.007                          *
  6305*                                                                *
  6306*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6307*                                                                *
  6308*   FILE TYPE = VSAM,KSDS                                        *
  6309*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6310*                                                                *
  6311*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6312*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6313*                                                                *
  6314*   LOG = NO                                                     *
  6315*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6316*                                                                *
  6317*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6318******************************************************************
  6319 01  LETTER-ARCHIVE.
  6320     12  LA-RECORD-ID                PIC XX.
  6321         88  VALID-LA-ID                VALUE 'LA'.
  6322
  6323     12  LA-CONTROL-PRIMARY.
  6324         16  LA-COMPANY-CD           PIC X.
  6325         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6326         16  LA-RECORD-TYPE          PIC X.
  6327             88  LA-HEADER-DATA         VALUE '1'.
  6328             88  LA-ADDRESS-DATA        VALUE '2'.
  6329             88  LA-TEXT-DATA           VALUE '3'.
  6330             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6331         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6332
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 114
* EL131.cbl
  6333     12  LA-CONTROL-BY-TYPE.
  6334         16  LA-COMPANY-CD-A1        PIC X.
  6335         16  LA-RECORD-TYPE-A1       PIC X.
  6336         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6337         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6338
  6339     12  LA-TEXT-RECORD.
  6340         16  LA-SKIP-CONTROL         PIC XX.
  6341             88  NO-LINES-SKIPPED       VALUE SPACES.
  6342             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6343         16  LA-TEXT-LINE            PIC X(70).
  6344
  6345     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6346         16  FILLER                  PIC XX.
  6347         16  LA-ADDRESS-LINE         PIC X(30).
  6348         16  FILLER                  PIC X(40).
  6349
  6350     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6351         16  FILLER                  PIC XX.
  6352         16  LA-CARRIER              PIC X.
  6353         16  LA-CLAIM-NO             PIC X(7).
  6354         16  LA-CERT-NO.
  6355             20  LA-CERT-PRIME       PIC X(10).
  6356             20  LA-CERT-SFX         PIC X.
  6357         16  LA-NO-OF-COPIES         PIC S9.
  6358         16  LA-RESEND-DATE          PIC XX.
  6359         16  LA-PROCESSOR-CD         PIC X(4).
  6360         16  LA-CREATION-DT          PIC XX.
  6361         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6362         16  LA-RESEND-PRINT-DATE    PIC XX.
  6363         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6364         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6365*
  6366* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6367*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6368*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6369*   I        20  LA-DMD-RES-ST           PIC XX.
  6370*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6371*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6372*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6373*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6374*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6375*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6376*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6377*   I        20  LA-DMD-UND-CODE         PIC XX.
  6378*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6379*   V    16  FILLER                  PIC X(15).
  6380* -----
  6381*
  6382* REINSERTED  CSO  MODS
  6383*
  6384         16  FILLER.
  6385             20  FILLER                  PIC X(29).
  6386             20  LA-CSO-LETTER-STATUS    PIC X.
  6387                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6388                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6389                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6390             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 115
* EL131.cbl
  6391             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6392*
  6393
  6394     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6395         16  FILLER                  PIC XX.
  6396         16  LA4-CARRIER             PIC X.
  6397         16  LA4-CLAIM-NO            PIC X(7).
  6398         16  LA4-CERT-NO.
  6399             20  LA4-CERT-PRIME      PIC X(10).
  6400             20  LA4-CERT-SFX        PIC X.
  6401         16  LA4-NO-OF-COPIES        PIC S9.
  6402         16  LA4-RESEND-DATE         PIC XX.
  6403         16  LA4-PROCESSOR-CD        PIC X(4).
  6404         16  LA4-CREATION-DT         PIC XX.
  6405         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6406         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6407         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6408         16  LA4-FORM-TYPE           PIC X.
  6409             88  LA4-INITIAL-FORM    VALUE '1'.
  6410             88  LA4-PROGRESS-FORM   VALUE '2'.
  6411         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6412         16  LA4-STATE               PIC X(02).
  6413         16  FILLER                  PIC X(31).
  6414******************************************************************
  6415
  6416*                                COPY ELCBENE.
  6417******************************************************************
  6418*                                                                *
  6419*                            ELCBENE.                            *
  6420*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6421*                            VMOD=2.006                          *
  6422*                                                                *
  6423*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6424*                                                                *
  6425*   FILE TYPE = VSAM,KSDS                                        *
  6426*   RECORD SIZE = 500   RECFORM = FIX                            *
  6427*                                                                *
  6428*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6429*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6430*                                                                *
  6431*   LOG = YES                                                    *
  6432*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6433*                                                                *
  6434*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6435******************************************************************
  6436
  6437 01  BENEFICIARY-MASTER.
  6438     12  BE-RECORD-ID                PIC XX.
  6439         88  VALID-BE-ID                VALUE 'BE'.
  6440
  6441     12  BE-CONTROL-PRIMARY.
  6442         16  BE-COMPANY-CD           PIC X.
  6443         16  BE-RECORD-TYPE          PIC X.
  6444             88  BENEFICIARY-RECORD  VALUE 'B'.
  6445             88  ADJUSTOR-RECORD     VALUE 'A'.
  6446         16  BE-BENEFICIARY          PIC X(10).
  6447     12  BE-CONTROL-BY-NAME.
  6448         16  BE-COMPANY-CD-A1        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 116
* EL131.cbl
  6449         16  BE-RECORD-TYPE-A1       PIC X.
  6450         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6451         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6452
  6453     12  BE-LAST-MAINT-DT            PIC XX.
  6454     12  BE-LAST-MAINT-BY            PIC X(4).
  6455     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6456
  6457     12  BE-ADDRESS-DATA.
  6458         16  BE-MAIL-TO-NAME         PIC X(30).
  6459         16  BE-ADDRESS-LINE-1       PIC X(30).
  6460         16  BE-ADDRESS-LINE-2       PIC X(30).
  6461         16  BE-ADDRESS-LINE-3       PIC X(30).
  6462         16  BE-CITY-STATE.
  6463             20  BE-CITY             PIC X(28).
  6464             20  BE-STATE            PIC XX.
  6465         16  BE-ZIP-CODE.
  6466             20  BE-ZIP-PRIME.
  6467                 24  BE-ZIP-1ST      PIC X.
  6468                     88  BE-CANADIAN-POST-CODE
  6469                                         VALUE 'A' THRU 'Z'.
  6470                 24  FILLER          PIC X(4).
  6471             20  BE-ZIP-PLUS4        PIC X(4).
  6472         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6473             20  BE-CAN-POSTAL-1     PIC XXX.
  6474             20  BE-CAN-POSTAL-2     PIC XXX.
  6475             20  FILLER              PIC XXX.
  6476         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6477         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6478
  6479******************************************************************
  6480*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6481*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6482******************************************************************
  6483     12  BE-CARRIER                  PIC X.
  6484
  6485     12  BE-ADDRESS-DATA2.
  6486         16  BE-MAIL-TO-NAME2        PIC X(30).
  6487         16  BE-ADDRESS-LINE-12      PIC X(30).
  6488         16  BE-ADDRESS-LINE-22      PIC X(30).
  6489         16  BE-ADDRESS-LINE-32      PIC X(30).
  6490         16  BE-CITY-STATE2.
  6491             20  BE-CITY2            PIC X(28).
  6492             20  BE-STATE2           PIC XX.
  6493         16  BE-ZIP-CODE2.
  6494             20  BE-ZIP-PRIME2.
  6495                 24  BE-ZIP-1ST2     PIC X.
  6496                     88  BE-CANADIAN-POST-CODE2
  6497                                         VALUE 'A' THRU 'Z'.
  6498                 24  FILLER          PIC X(4).
  6499             20  BE-ZIP-PLUS42       PIC X(4).
  6500         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6501             20  BE-CAN-POSTAL-12    PIC XXX.
  6502             20  BE-CAN-POSTAL-22    PIC XXX.
  6503             20  FILLER              PIC XXX.
  6504         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6505         16  BE-BILLING-STMT-DATA.
  6506             20  BE-BSR              PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 117
* EL131.cbl
  6507                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6508                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6509             20  BE-BSR-FROM         PIC X(30).
  6510             20  BE-BSR-DEPT         PIC X(30).
  6511             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6512             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6513             20  BE-OUTPUT-TYPE      PIC X.
  6514                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6515                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6516
  6517     12  FILLER                      PIC X(28).
  6518******************************************************************
  6519
  6520*                                COPY ELCDAR.
  6521******************************************************************
  6522*                                                                *
  6523*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6524*   FILE TYPE = VSAM,KSDS                                        *
  6525*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6526*   BASE CLUSTER = DLYACTV                                       *
  6527*   LOG = YES                                                    *
  6528*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6529*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6530*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6531*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6532*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6533*               BY PROGRAM "LGINFCE".                            *
  6534*                                                                *
  6535******************************************************************
  6536 01  DAILY-ACTIVITY-RECORD.
  6537     05  DA-KEY.
  6538         10  DA-COMP-CD          PIC X.
  6539         10  DA-CARRIER          PIC X.
  6540         10  DA-CLAIM-NO         PIC X(7).
  6541         10  DA-CERT-NO.
  6542             15  DA-CERT-PRIME   PIC X(10).
  6543             15  DA-CERT-SFX     PIC X.
  6544     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6545     05  DA-RECORD-TYPE          PIC X.
  6546     05  FILLER                  PIC X(2).
  6547******************************************************************
  6548
  6549*                                COPY ELCALPH.
  6550******************************************************************
  6551*                                                                *
  6552*                            ELCALPH.                            *
  6553*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6554*                            VMOD=2.003                          *
  6555*                                                                *
  6556*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6557*                                                                *
  6558*   FILE TYPE = VSAM,KSDS                                        *
  6559*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6560*                                                                *
  6561*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6562*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6563*                                                                *
  6564*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 118
* EL131.cbl
  6565*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6566*                                                                *
  6567*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6568******************************************************************
  6569
  6570 01  ALPHA-INDEX.
  6571     12  AI-RECORD-ID                         PIC XX.
  6572         88  VALID-AI-ID                  VALUE 'AI'.
  6573     12  AI-CONTROL-PRIMARY.
  6574         16  AI-COMPANY-CD                     PIC X.
  6575         16  AI-SOURCE                         PIC X.
  6576             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6577             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6578         16  AI-NAME.
  6579             20  AI-LAST-NAME                  PIC X(15).
  6580             20  AI-FIRST-NAME.
  6581                 24  AI-FIRST-INITIAL          PIC X.
  6582                 24  FILLER                    PIC X(11).
  6583             20  AI-MIDDLE-INIT                PIC X.
  6584         16  AI-DATE                           PIC X(8).
  6585         16  AI-TIME                           PIC S9(07) COMP-3.
  6586
  6587     12  AI-CONTROL-BY-ADMIN-KEY.
  6588         16  AI-CM-COMPANY-CD                  PIC X.
  6589         16  AI-CM-SOURCE                      PIC X.
  6590         16  AI-CM-CARRIER                     PIC X.
  6591         16  AI-CM-GROUPING.
  6592             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  6593             20  AI-CM-GROUPING-PRIME          PIC X(3).
  6594         16  AI-CM-STATE                       PIC XX.
  6595         16  AI-CM-PRODUCER.
  6596             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  6597             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  6598         16  AI-CM-CERT-EFF-DT                 PIC XX.
  6599         16  AI-CM-CERTIFICATE-NUMBER.
  6600             20  AI-CM-CERT-PRIME              PIC X(10).
  6601             20  AI-CM-CERT-SFX                PIC X.
  6602         16  AI-CM-DATE                        PIC X(8).
  6603         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  6604         16  FILLER                            PIC X(11).
  6605
  6606     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  6607         AI-CONTROL-BY-ADMIN-KEY.
  6608         16  AI-CL-COMPANY-CD                  PIC X.
  6609         16  AI-CL-SOURCE                      PIC X.
  6610         16  AI-CL-CARRIER                     PIC X.
  6611         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  6612         16  AI-CL-CERTIFICATE-NUMBER.
  6613             20  AI-CL-CERT-PRIME              PIC X(10).
  6614             20  AI-CL-CERT-SFX                PIC X.
  6615         16  AI-CL-DATE                        PIC X(8).
  6616         16  AI-CL-INCURRED-DATE               PIC XX.
  6617         16  AI-CL-CLOSE-DATE                  PIC XX.
  6618         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  6619         16  AI-CREDIT-CARD-NUMBER.
  6620             20  AI-CCN.
  6621                 24  AI-CCN-PREFIX             PIC X(4).
  6622                 24  AI-CCN-PRIME              PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 119
* EL131.cbl
  6623             20  AI-CCN-FILLER                 PIC X(4).
  6624
  6625     12  AI-MAINT-INFO.
  6626         16  AI-LAST-MAINT-BY                  PIC X(4).
  6627         16  AI-LAST-MAINT-DT                  PIC XX.
  6628         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6629
  6630     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  6631
  6632     12  FILLER                                PIC X(15).
  6633
  6634
  6635*                                COPY ERCDMDNT.
  6636******************************************************************
  6637*                                                                *
  6638*                            ERCDMDNT                            *
  6639*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6640*                            VMOD=2.005                          *
  6641*                                                                *
  6642*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  6643*                                                                *
  6644*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  6645*                                                                *
  6646*        FILE TYPE= VSAM,KSDS                                    *
  6647*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6648*                                                                *
  6649*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6650*                                                                *
  6651*        LOG = YES                                               *
  6652*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6653*                                                                *
  6654******************************************************************
  6655
  6656 01  CERTIFICATE-NOTE.
  6657     12  CN-RECORD-ID                     PIC  XX.
  6658         88  VALID-CN-ID                      VALUE 'CN'.
  6659
  6660     12  CN-CONTROL-PRIMARY.
  6661         16  CN-COMPANY-CD                PIC X.
  6662         16  CN-CERT-KEY.
  6663             20  CN-CARRIER               PIC X.
  6664             20  CN-GROUPING.
  6665                 24  CN-GROUPING-PREFIX   PIC XXX.
  6666                 24  CN-GROUPING-PRIME    PIC XXX.
  6667             20  CN-STATE                 PIC XX.
  6668             20  CN-ACCOUNT.
  6669                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  6670                 24  CN-ACCOUNT-PRIME     PIC X(6).
  6671             20  CN-CERT-EFF-DT           PIC XX.
  6672             20  CN-CERT-NO.
  6673                 24  CN-CERT-PRIME        PIC X(10).
  6674                 24  CN-CERT-SFX          PIC X.
  6675
  6676     12  CN-BILLING-START-LINE-NO         PIC 99.
  6677     12  CN-BILLING-END-LINE-NO           PIC 99.
  6678
  6679     12  CN-LINES.
  6680         16  CN-LINE                      PIC X(77)  OCCURS 10.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 120
* EL131.cbl
  6681
  6682     12  CN-CSI-NOTES REDEFINES CN-LINES.
  6683         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  6684         16  CN-CSI-GENERAL-DATA-AREA.
  6685             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  6686
  6687         16  CN-CSI-GENERAL-DATA-R REDEFINES
  6688             CN-CSI-GENERAL-DATA-AREA.
  6689             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  6690             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  6691             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  6692             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  6693             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  6694             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  6695             20  CN-CSI-GEN-INFRM-MI          PIC X.
  6696             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  6697             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  6698             20  FILLER                       PIC XX.
  6699             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  6700             20  FILLER                       PIC X(38).
  6701
  6702         16  CN-CSI-PRODUCT-DATA-AREA.
  6703             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  6704
  6705         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  6706             CN-CSI-PRODUCT-DATA-AREA.
  6707             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  6708             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  6709             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  6710             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  6711             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  6712             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  6713             20  FILLER                   PIC XX.
  6714             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6715             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6716             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  6717             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  6718             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6719             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6720             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6721             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6722             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  6723             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  6724             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  6725             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  6726             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  6727             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  6728             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  6729             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  6730             20  CN-CSI-CC-TERM-AGE       PIC 999.
  6731             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6732             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  6733             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  6734             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  6735             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  6736             20  FILLER                   PIC X(25).
  6737
  6738         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 121
* EL131.cbl
  6739             CN-CSI-CREDIT-CARD-DATA.
  6740             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  6741             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  6742             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  6743             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  6744             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  6745             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  6746             20  FILLER                   PIC XX.
  6747             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6748             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6749             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  6750             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  6751             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6752             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6753             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6754             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6755             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  6756             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  6757             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  6758             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  6759             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  6760             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  6761             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  6762             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  6763             20  CN-CSI-FL-TERM-AGE       PIC 999.
  6764             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6765             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  6766             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  6767             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  6768             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  6769             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  6770             20  FILLER                   PIC X(17).
  6771
  6772         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  6773             CN-CSI-FAMILY-LEAVE-DATA.
  6774             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  6775             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  6776             20  CN-CSI-SL-BENE-REL       PIC X(8).
  6777             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  6778             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  6779             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  6780             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  6781             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  6782             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  6783             20  CN-CSI-SL-INT-ON-PROCEEDS
  6784                                          PIC S9(5)V99  COMP-3.
  6785             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  6786             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  6787             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  6788             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  6789             20  CN-CSI-SL-POLICY-BENEFITS
  6790                                          PIC S9(5)V99  COMP-3.
  6791             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  6792             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  6793             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  6794             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  6795             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  6796             20  CN-CSI-SL-PREM-MODE      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 122
* EL131.cbl
  6797             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  6798             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  6799             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  6800             20  CN-CSI-SL-STATE-NOT      PIC X.
  6801             20  FILLER                   PIC XX.
  6802
  6803         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  6804             CN-CSI-SENIOR-LIFE-DATA.
  6805             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  6806             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  6807             20  CN-CSI-PP-BEN-PAID-TO-DATE
  6808                                          PIC S9(5)V99  COMP-3.
  6809             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  6810             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  6811             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  6812             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  6813             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  6814             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  6815             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  6816             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  6817             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  6818             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  6819             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  6820             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  6821             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  6822             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6823             20  CN-CSI-PP-REPAIR         PIC X.
  6824             20  CN-CSI-PP-REPLACE        PIC X.
  6825             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  6826             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  6827             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  6828             20  CN-CSI-PP-TERM-AGE       PIC 999.
  6829             20  FILLER                   PIC X(5).
  6830
  6831         16  CN-CSI-EXT-WARR-DATA REDEFINES
  6832             CN-CSI-PURCH-PROP-DATA.
  6833             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  6834             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  6835             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  6836             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  6837             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  6838             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  6839             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  6840             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  6841             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  6842             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  6843             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  6844             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  6845             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  6846             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  6847             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  6848             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6849             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  6850             20  CN-CSI-EW-REPLACE        PIC X.
  6851             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  6852             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  6853             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  6854             20  CN-CSI-EW-TERM-AGE       PIC 999.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 123
* EL131.cbl
  6855             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  6856             20  FILLER                   PIC X(4).
  6857
  6858     12  CN-LAST-MAINT-DT                 PIC XX.
  6859     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  6860     12  CN-LAST-MAINT-USER               PIC X(4).
  6861     12  FILLER                           PIC X(6).
  6862
  6863******************************************************************
  6864
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 124
* EL131.cbl
  6866 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6867                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  6868                          CONTROL-FILE ACTIVITY-QUE
  6869                          ACCOUNT-MASTER CHECK-QUE
  6870                          LETTER-ARCHIVE BENEFICIARY-MASTER
  6871                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  6872                          CERTIFICATE-NOTE.
  6873 0000-DFHEXIT SECTION.
  6874     MOVE '9#                    $   ' TO DFHEIV0.
  6875     MOVE 'EL131' TO DFHEIV1.
  6876     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6877
  6878     IF EIBCALEN = ZERO
  6879         GO TO 8800-UNAUTHORIZED-ACCESS.
  6880
  6881     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6882     MOVE '5'                    TO DC-OPTION-CODE.
  6883     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  6884     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6885     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  6886     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6887
  6888     IF SAVE-DATE-YY GREATER 70
  6889         MOVE 19                 TO SAVE-DATE-CC
  6890      ELSE
  6891         MOVE 20                 TO SAVE-DATE-CC.
  6892
  6893
  6894* EXEC CICS HANDLE CONDITION
  6895*        PGMIDERR (8820-XCTL-ERROR)
  6896*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  6897*        ERROR    (9990-ABEND)
  6898*    END-EXEC.
  6899*    MOVE '"$LI.                 ! " #00006889' TO DFHEIV0
  6900     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  6901     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6902     MOVE X'2220233030303036383839' TO DFHEIV0(25:11)
  6903     CALL 'kxdfhei1' USING DFHEIV0
  6904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6905
  6906
  6907     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  6908     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6909     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6910
  6911     INITIALIZE    EDIT-WORK-AREA.
  6912     MOVE '/'                    TO WORK-SLASH.
  6913     MOVE SPACES                 TO ERROR-SWITCHES.
  6914
  6915     MOVE TRAN-ID                TO TRANS-ID.
  6916     MOVE EIBTRMID               TO PI-TERM.
  6917     MOVE MAP-ID                 TO PI-QUAL.
  6918
  6919     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  6920
  6921     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6922         MOVE LOW-VALUES         TO EL131AO
  6923         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 125
* EL131.cbl
  6924         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6925         MOVE -1                 TO MAINTL
  6926         GO TO 8110-SEND-DATA.
  6927
  6928     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  6929         MOVE LOW-VALUES         TO EL131AO
  6930         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  6931         MOVE 'X'                TO PI-RETURN-CD-1
  6932         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  6933         MOVE -1                 TO MAINTL
  6934         GO TO 8100-SEND-MAP.
  6935
  6936     IF EIBAID = DFHCLEAR
  6937         GO TO 8200-RETURN-PRIOR.
  6938
  6939     IF PI-PROCESSOR-ID = 'LGXX'
  6940         NEXT SENTENCE
  6941     ELSE
  6942
  6943* EXEC CICS READQ TS
  6944*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6945*            INTO    (SECURITY-CONTROL)
  6946*            LENGTH  (SC-COMM-LENGTH)
  6947*            ITEM    (SC-ITEM)
  6948*        END-EXEC
  6949*    MOVE '*$II   L              ''   #00006930' TO DFHEIV0
  6950     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6951     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6952     MOVE X'2020233030303036393330' TO DFHEIV0(25:11)
  6953     CALL 'kxdfhei1' USING DFHEIV0,
  6954           PI-SECURITY-TEMP-STORE-ID,
  6955           SECURITY-CONTROL,
  6956           SC-COMM-LENGTH,
  6957           SC-ITEM,
  6958           DFHEIV99,
  6959           DFHEIV99
  6960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6961         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  6962         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  6963         IF NOT DISPLAY-CAP
  6964             MOVE 'READ'               TO  SM-READ
  6965             PERFORM 9995-SECURITY-VIOLATION
  6966             MOVE ER-0070              TO  EMI-ERROR
  6967             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6968             GO TO 8100-SEND-MAP.
  6969
  6970
  6971* EXEC CICS RECEIVE
  6972*        MAP    ('EL131A')
  6973*        MAPSET ('EL131S')
  6974*    END-EXEC.
  6975     MOVE 'EL131A' TO DFHEIV1
  6976     MOVE 'EL131S' TO DFHEIV2
  6977*    MOVE '8"T                   ''   #00006945' TO DFHEIV0
  6978     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  6979     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6980     MOVE X'2020233030303036393435' TO DFHEIV0(25:11)
  6981     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 126
* EL131.cbl
  6982           DFHEIV1,
  6983           EL131AI,
  6984           DFHEIV99,
  6985           DFHEIV2,
  6986           DFHEIV99,
  6987           DFHEIV99
  6988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6989
  6990
  6991     IF PFKEYL GREATER THAN ZERO
  6992         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  6993
  6994     IF SCREEN-ERROR
  6995         MOVE ER-0004 TO EMI-ERROR
  6996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6997         MOVE -1 TO MAINTL
  6998         GO TO 8110-SEND-DATA.
  6999
  7000     IF EIBAID = DFHPF3
  7001         GO TO 8500-TRLR-MNT.
  7002
  7003     IF EIBAID = DFHPF4
  7004         GO TO 8600-ADDR-MNT.
  7005
  7006     IF EIBAID = DFHPF5
  7007         GO TO 8700-CERT-MNT.
  7008
  7009     IF PI-COMPANY-ID = 'DMD'
  7010       IF EIBAID = DFHPF6
  7011         GO TO 8750-DMD-CLM-FIX.
  7012
  7013     IF EIBAID = DFHPF7
  7014         GO TO 4000-FORCE-ERRORS.
  7015
  7016     IF EIBAID = DFHPF12
  7017         GO TO 8300-GET-HELP.
  7018
  7019     IF EIBAID = DFHPF23
  7020         GO TO 8810-PF23-ENTERED.
  7021
  7022     IF EIBAID = DFHPF24
  7023         GO TO 8400-RETURN-MASTER.
  7024
  7025     IF EIBAID NOT = DFHENTER
  7026         MOVE ER-0029            TO EMI-ERROR
  7027         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7028         MOVE -1                 TO MAINTL
  7029         GO TO 8110-SEND-DATA.
  7030
  7031     IF PI-RETURN-CD-1 =  'X'
  7032         MOVE ER-0311            TO EMI-ERROR
  7033         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7034         MOVE -1                 TO MAINTL
  7035         GO TO 8110-SEND-DATA.
  7036
  7037     IF MAINTI = 'A'
  7038         GO TO 0500-ADD-ALPHA-ONLY.
  7039
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 127
* EL131.cbl
  7040     IF MAINTI = 'N'
  7041         GO TO 0600-CHANGE-NAME.
  7042
  7043     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7044
  7045     IF SCREEN-ERROR
  7046         GO TO 8110-SEND-DATA.
  7047
  7048     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7049         MOVE ER-0276            TO EMI-ERROR
  7050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7051         MOVE -1                 TO MAINTL
  7052         GO TO 8110-SEND-DATA.
  7053
  7054     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7055
  7056     IF SCREEN-ERROR
  7057         GO TO 8110-SEND-DATA.
  7058
  7059     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7060
  7061     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7062
  7063     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7064         GO TO 8110-SEND-DATA.
  7065
  7066     IF EMI-FATAL-CTR GREATER THAN ZERO
  7067         GO TO 8110-SEND-DATA.
  7068
  7069     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7070
  7071     IF WS-OPEN-CLOSE-SW = 'Y'
  7072         IF PI-LETTER-SW = 'Y'
  7073             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7074             MOVE 'T'            TO  CNTL-REC-TYPE
  7075             MOVE SPACES         TO  CNTL-PROC-ID
  7076             MOVE +0             TO  CNTL-SEQ-NO
  7077
  7078* EXEC CICS READ
  7079*                DATASET   (CNTL-FILE-ID)
  7080*                RIDFLD    (CNTL-KEY)
  7081*                SET       (ADDRESS OF CONTROL-FILE)
  7082*            END-EXEC
  7083*    MOVE '&"S        E          (   #00007036' TO DFHEIV0
  7084     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7085     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7086     MOVE X'2020233030303037303336' TO DFHEIV0(25:11)
  7087     CALL 'kxdfhei1' USING DFHEIV0,
  7088           CNTL-FILE-ID,
  7089           DFHEIV20,
  7090           DFHEIV99,
  7091           CNTL-KEY,
  7092           DFHEIV99,
  7093           DFHEIV99,
  7094           DFHEIV99
  7095     SET ADDRESS OF CONTROL-FILE TO
  7096         DFHEIV20
  7097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 128
* EL131.cbl
  7098             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7099
  7100     MOVE ER-0000                TO EMI-ERROR.
  7101     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7102
  7103     MOVE SPACE                  TO MAINTO.
  7104     MOVE -1                     TO MAINTL.
  7105     GO TO 8100-SEND-MAP.
  7106
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 129
* EL131.cbl
  7108 0100-UPDATE-PI.
  7109     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7110         GO TO 0110-UPDATE-UP.
  7111
  7112     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7113     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7114     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7115     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7116     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7117     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7118     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7119     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7120     GO TO 0120-UPDATE-PI-EXIT.
  7121
  7122 0110-UPDATE-UP.
  7123     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7124     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7125     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7126     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7127     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7128     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7129     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7130     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7131
  7132
  7133* EXEC CICS HANDLE CONDITION
  7134*         QIDERR    (0130-TS-ERROR)
  7135*         ITEMERR   (0130-TS-ERROR)
  7136*    END-EXEC.
  7137*    MOVE '"$N<                  ! # #00007075' TO DFHEIV0
  7138     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7140     MOVE X'2320233030303037303735' TO DFHEIV0(25:11)
  7141     CALL 'kxdfhei1' USING DFHEIV0
  7142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7143
  7144
  7145
  7146* EXEC CICS READQ TS
  7147*         QUEUE    (PI-KEY)
  7148*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7149*         LENGTH   (PI-COMM-LENGTH)
  7150*    END-EXEC.
  7151*    MOVE '*$I    L              ''   #00007080' TO DFHEIV0
  7152     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7154     MOVE X'2020233030303037303830' TO DFHEIV0(25:11)
  7155     CALL 'kxdfhei1' USING DFHEIV0,
  7156           PI-KEY,
  7157           PROGRAM-INTERFACE-BLOCK,
  7158           PI-COMM-LENGTH,
  7159           DFHEIV99,
  7160           DFHEIV99,
  7161           DFHEIV99
  7162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7163
  7164
  7165
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 130
* EL131.cbl
  7166* EXEC CICS DELETEQ TS
  7167*         QUEUE    (PI-KEY)
  7168*    END-EXEC.
  7169*    MOVE '*&                    #   #00007086' TO DFHEIV0
  7170     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7171     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7172     MOVE X'2020233030303037303836' TO DFHEIV0(25:11)
  7173     CALL 'kxdfhei1' USING DFHEIV0,
  7174           PI-KEY,
  7175           DFHEIV99
  7176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7177
  7178
  7179 0120-UPDATE-PI-EXIT.
  7180     EXIT.
  7181
  7182 0130-TS-ERROR.
  7183     MOVE LOW-VALUES             TO EL131AO.
  7184     MOVE ER-0192                TO EMI-ERROR.
  7185
  7186     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7187
  7188     GO TO 8100-SEND-MAP.
  7189
  7190 0200-TRANS-PF.
  7191     IF EIBAID NOT = DFHENTER
  7192         MOVE 'X'                TO ERROR-SWITCH
  7193         GO TO 0210-EXIT.
  7194
  7195     IF PFKEYI NOT NUMERIC
  7196         MOVE 'X'                TO ERROR-SWITCH
  7197         GO TO 0210-EXIT.
  7198
  7199     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7200
  7201     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7202         MOVE 'X' TO ERROR-SWITCH
  7203         GO TO 0210-EXIT.
  7204
  7205     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7206
  7207 0210-EXIT.
  7208     EXIT.
  7209
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 131
* EL131.cbl
  7211 0500-ADD-ALPHA-ONLY.
  7212******************************************************************
  7213*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7214*    RECORD.                                                     *
  7215******************************************************************
  7216
  7217     IF MLNAMEL = +0 AND
  7218        MFNAMEL = +0 AND
  7219        MMINITL = +0
  7220         MOVE ER-0797                TO  EMI-ERROR
  7221         MOVE -1                     TO  MAINTL
  7222         MOVE AL-UABON               TO  MAINTA
  7223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7224         GO TO 8110-SEND-DATA.
  7225
  7226     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7227     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7228     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7229     MOVE PI-CERT-NO                 TO  CERT-NO.
  7230
  7231
  7232* EXEC CICS READ
  7233*        DATASET   (CLMS-FILE-ID)
  7234*        RIDFLD    (MSTR-KEY)
  7235*        SET       (ADDRESS OF CLAIM-MASTER)
  7236*    END-EXEC.
  7237*    MOVE '&"S        E          (   #00007142' TO DFHEIV0
  7238     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7240     MOVE X'2020233030303037313432' TO DFHEIV0(25:11)
  7241     CALL 'kxdfhei1' USING DFHEIV0,
  7242           CLMS-FILE-ID,
  7243           DFHEIV20,
  7244           DFHEIV99,
  7245           MSTR-KEY,
  7246           DFHEIV99,
  7247           DFHEIV99,
  7248           DFHEIV99
  7249     SET ADDRESS OF CLAIM-MASTER TO
  7250         DFHEIV20
  7251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7252
  7253
  7254
  7255* EXEC CICS GETMAIN
  7256*        SET       (ADDRESS OF ALPHA-INDEX)
  7257*        LENGTH    (ALPH-LENGTH)
  7258*        INITIMG   (GETMAIN-SPACE)
  7259*    END-EXEC.
  7260*    MOVE ',"IL                  $   #00007148' TO DFHEIV0
  7261     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7262     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7263     MOVE X'2020233030303037313438' TO DFHEIV0(25:11)
  7264     CALL 'kxdfhei1' USING DFHEIV0,
  7265           DFHEIV20,
  7266           ALPH-LENGTH,
  7267           GETMAIN-SPACE
  7268     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 132
* EL131.cbl
  7269         DFHEIV20
  7270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7271
  7272
  7273     MOVE 'AI'                       TO  AI-RECORD-ID.
  7274     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7275                                         AI-CL-COMPANY-CD.
  7276     MOVE 'C'                        TO  AI-SOURCE
  7277                                         AI-CL-SOURCE.
  7278
  7279     IF MLNAMEL IS GREATER THAN +0
  7280         MOVE MLNAMEI                TO  AI-LAST-NAME
  7281     ELSE
  7282         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7283
  7284     IF MFNAMEL IS GREATER THAN +0
  7285         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7286     ELSE
  7287         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7288
  7289     IF MMINITL IS GREATER THAN +0
  7290         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7291     ELSE
  7292         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7293
  7294     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7295     MOVE '5'                        TO  DC-OPTION-CODE.
  7296     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7297     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7298     IF BUILD-YEAR IS GREATER THAN 50
  7299         MOVE '19'                   TO  WS-ALPHA-YY-1
  7300         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7301         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7302         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7303     ELSE
  7304         MOVE '20'                   TO  WS-ALPHA-YY-1
  7305         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7306         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7307         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7308
  7309     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7310                                         AI-CL-DATE.
  7311
  7312     MOVE EIBTIME                    TO  AI-TIME
  7313                                         AI-CL-TIME.
  7314
  7315     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7316     MOVE 'C'                        TO  AI-CL-SOURCE.
  7317     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7318     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7319     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7320     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7321     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7322
  7323     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7324     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7325     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7326
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 133
* EL131.cbl
  7327
  7328* EXEC CICS WRITE
  7329*        DATASET   (ALPH-FILE-ID)
  7330*        RIDFLD    (AI-CONTROL-PRIMARY)
  7331*        FROM      (ALPHA-INDEX)
  7332*    END-EXEC.
  7333     MOVE LENGTH OF
  7334      ALPHA-INDEX
  7335       TO DFHEIV11
  7336*    MOVE '&$ L                  ''   #00007208' TO DFHEIV0
  7337     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7338     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7339     MOVE X'2020233030303037323038' TO DFHEIV0(25:11)
  7340     CALL 'kxdfhei1' USING DFHEIV0,
  7341           ALPH-FILE-ID,
  7342           ALPHA-INDEX,
  7343           DFHEIV11,
  7344           AI-CONTROL-PRIMARY,
  7345           DFHEIV99,
  7346           DFHEIV99
  7347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7348
  7349
  7350     MOVE LOW-VALUES                 TO  EL131AO.
  7351     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7352     MOVE ER-0000                    TO  EMI-ERROR.
  7353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7354     MOVE -1                         TO  MAINTL.
  7355     GO TO 8100-SEND-MAP.
  7356
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 134
* EL131.cbl
  7358 0600-CHANGE-NAME.
  7359******************************************************************
  7360*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7361*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7362******************************************************************
  7363
  7364     IF MLNAMEL = +0 AND
  7365        MFNAMEL = +0 AND
  7366        MMINITL = +0
  7367         MOVE ER-0276                TO  EMI-ERROR
  7368         MOVE -1                     TO  MAINTL
  7369         MOVE AL-UABON               TO  MAINTA
  7370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7371         GO TO 8110-SEND-DATA.
  7372
  7373     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7374     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7375     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7376     MOVE PI-CERT-NO                 TO  CERT-NO.
  7377
  7378
  7379* EXEC CICS READ
  7380*        DATASET   (CLMS-FILE-ID)
  7381*        RIDFLD    (MSTR-KEY)
  7382*        SET       (ADDRESS OF CLAIM-MASTER)
  7383*    END-EXEC.
  7384*    MOVE '&"S        E          (   #00007242' TO DFHEIV0
  7385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7386     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7387     MOVE X'2020233030303037323432' TO DFHEIV0(25:11)
  7388     CALL 'kxdfhei1' USING DFHEIV0,
  7389           CLMS-FILE-ID,
  7390           DFHEIV20,
  7391           DFHEIV99,
  7392           MSTR-KEY,
  7393           DFHEIV99,
  7394           DFHEIV99,
  7395           DFHEIV99
  7396     SET ADDRESS OF CLAIM-MASTER TO
  7397         DFHEIV20
  7398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7399
  7400
  7401
  7402* EXEC CICS GETMAIN
  7403*        SET       (ADDRESS OF ALPHA-INDEX)
  7404*        LENGTH    (ALPH-LENGTH)
  7405*        INITIMG   (GETMAIN-SPACE)
  7406*    END-EXEC.
  7407*    MOVE ',"IL                  $   #00007248' TO DFHEIV0
  7408     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7409     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7410     MOVE X'2020233030303037323438' TO DFHEIV0(25:11)
  7411     CALL 'kxdfhei1' USING DFHEIV0,
  7412           DFHEIV20,
  7413           ALPH-LENGTH,
  7414           GETMAIN-SPACE
  7415     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 135
* EL131.cbl
  7416         DFHEIV20
  7417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7418
  7419
  7420     MOVE 'AI'                       TO  AI-RECORD-ID.
  7421     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7422                                         AI-CL-COMPANY-CD.
  7423     MOVE 'C'                        TO  AI-SOURCE
  7424                                         AI-CL-SOURCE.
  7425
  7426     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7427     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7428     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7429
  7430     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7431     MOVE '5'                        TO  DC-OPTION-CODE.
  7432     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7433     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7434     IF BUILD-YEAR IS GREATER THAN 50
  7435         MOVE '19'                   TO  WS-ALPHA-YY-1
  7436         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7437         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7438         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7439     ELSE
  7440         MOVE '20'                   TO  WS-ALPHA-YY-1
  7441         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7442         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7443         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7444
  7445     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7446                                         AI-CL-DATE.
  7447
  7448     MOVE EIBTIME                    TO  AI-TIME
  7449                                         AI-CL-TIME.
  7450
  7451     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7452     MOVE 'C'                        TO  AI-CL-SOURCE.
  7453     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7454     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7455     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7456     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7457     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7458
  7459     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7460     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7461     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7462
  7463     IF PI-COMPANY-ID = 'CID'
  7464         MOVE 'Y'                TO CL-YESNOSW
  7465     END-IF.
  7466
  7467
  7468* EXEC CICS WRITE
  7469*        DATASET   (ALPH-FILE-ID)
  7470*        RIDFLD    (AI-CONTROL-PRIMARY)
  7471*        FROM      (ALPHA-INDEX)
  7472*    END-EXEC.
  7473     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 136
* EL131.cbl
  7474      ALPHA-INDEX
  7475       TO DFHEIV11
  7476*    MOVE '&$ L                  ''   #00007301' TO DFHEIV0
  7477     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7478     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7479     MOVE X'2020233030303037333031' TO DFHEIV0(25:11)
  7480     CALL 'kxdfhei1' USING DFHEIV0,
  7481           ALPH-FILE-ID,
  7482           ALPHA-INDEX,
  7483           DFHEIV11,
  7484           AI-CONTROL-PRIMARY,
  7485           DFHEIV99,
  7486           DFHEIV99
  7487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7488
  7489
  7490
  7491* EXEC CICS READ
  7492*        DATASET   (CLMS-FILE-ID)
  7493*        RIDFLD    (MSTR-KEY)
  7494*        SET       (ADDRESS OF CLAIM-MASTER)
  7495*        UPDATE
  7496*    END-EXEC.
  7497*    MOVE '&"S        EU         (   #00007307' TO DFHEIV0
  7498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7499     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7500     MOVE X'2020233030303037333037' TO DFHEIV0(25:11)
  7501     CALL 'kxdfhei1' USING DFHEIV0,
  7502           CLMS-FILE-ID,
  7503           DFHEIV20,
  7504           DFHEIV99,
  7505           MSTR-KEY,
  7506           DFHEIV99,
  7507           DFHEIV99,
  7508           DFHEIV99
  7509     SET ADDRESS OF CLAIM-MASTER TO
  7510         DFHEIV20
  7511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7512
  7513
  7514     if (cl-priority-cd = '8')
  7515        and (pi-processor-id not = 'PEMA'and 'JMS '
  7516             AND 'AMWA')
  7517        MOVE ER-8003             TO EMI-ERROR
  7518        PERFORM 9900-ERROR-FORMAT
  7519                                 THRU 9900-EXIT
  7520        MOVE -1                  TO MAINTL
  7521        GO TO 8110-SEND-DATA
  7522     end-if
  7523
  7524     IF MLNAMEL IS GREATER THAN +0
  7525         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7526
  7527     IF MFNAMEL IS GREATER THAN +0
  7528         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7529
  7530     IF MMINITL IS GREATER THAN +0
  7531         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 137
* EL131.cbl
  7532
  7533     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7534     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7535     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7536     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7537
  7538     IF PI-COMPANY-ID = 'CID'
  7539         MOVE 'Y'                TO CL-YESNOSW
  7540     END-IF.
  7541
  7542
  7543* EXEC CICS HANDLE CONDITION
  7544*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  7545*    END-EXEC.
  7546*    MOVE '"$$                   ! $ #00007342' TO DFHEIV0
  7547     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  7548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7549     MOVE X'2420233030303037333432' TO DFHEIV0(25:11)
  7550     CALL 'kxdfhei1' USING DFHEIV0
  7551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7552
  7553
  7554
  7555* EXEC CICS REWRITE
  7556*        DATASET   (CLMS-FILE-ID)
  7557*        FROM      (CLAIM-MASTER)
  7558*    END-EXEC.
  7559     MOVE LENGTH OF
  7560      CLAIM-MASTER
  7561       TO DFHEIV11
  7562*    MOVE '&& L                  %   #00007346' TO DFHEIV0
  7563     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7564     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7565     MOVE X'2020233030303037333436' TO DFHEIV0(25:11)
  7566     CALL 'kxdfhei1' USING DFHEIV0,
  7567           CLMS-FILE-ID,
  7568           CLAIM-MASTER,
  7569           DFHEIV11,
  7570           DFHEIV99
  7571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7572
  7573
  7574 0600-CONTINUE-NAME-UPDATE.
  7575
  7576     MOVE LOW-VALUES                 TO  EL131AO.
  7577     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7578     MOVE ER-0000                    TO  EMI-ERROR.
  7579     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7580     MOVE -1                         TO  MAINTL.
  7581     GO TO 8100-SEND-MAP.
  7582
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 138
* EL131.cbl
  7584 1000-EDIT-SCREEN.
  7585
  7586     MOVE MAINTI                 TO CHECK-MAINT.
  7587
  7588     IF NOT VALID-OPTIONS
  7589         MOVE 'X'                TO ERROR-SWITCH
  7590         MOVE -1                 TO MAINTL
  7591         MOVE AL-UABON           TO MAINTA
  7592         MOVE ER-0023            TO EMI-ERROR
  7593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7594         GO TO 1010-EXIT.
  7595
  7596     IF NOT MODIFY-CAP
  7597         MOVE 'UPDATE'           TO  SM-READ
  7598         PERFORM 9995-SECURITY-VIOLATION
  7599         MOVE ER-0070               TO  EMI-ERROR
  7600         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7601         GO TO 8100-SEND-MAP.
  7602
  7603     IF DELETE-CLAIM
  7604         MOVE AL-UANON TO MAINTA
  7605         GO TO 1010-EXIT.
  7606
  7607     MOVE AL-UANON               TO MAINTA.
  7608
  7609     IF CCNOI GREATER THAN LOW-VALUES
  7610         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7611
  7612     IF PI-COMPANY-ID = 'CSL'
  7613        CONTINUE
  7614     ELSE
  7615        IF TYPEL > ZERO
  7616           IF ((PI-COMPANY-ID = 'CID')
  7617              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7618                    PI-LIFE-OVERRIDE-L1))
  7619                       OR
  7620              ((PI-COMPANY-ID = 'DCC')
  7621              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7622                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  7623              MOVE AL-UANON      TO TYPEA
  7624              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  7625           ELSE
  7626              MOVE ER-0199       TO EMI-ERROR
  7627              PERFORM 9900-ERROR-FORMAT
  7628                                 THRU 9900-EXIT
  7629              MOVE AL-UABON      TO TYPEA
  7630              MOVE -1            TO TYPEL
  7631              MOVE 'X'           TO ERROR-SWITCH
  7632           END-IF
  7633        ELSE
  7634           MOVE AL-UANOF         TO TYPEA
  7635        END-IF
  7636     END-IF
  7637     IF STATUSI GREATER THAN LOW-VALUES
  7638         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  7639             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  7640             MOVE AL-UANON       TO STATUSA
  7641             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 139
* EL131.cbl
  7642             MOVE 'Y'            TO DLYACTV-SW
  7643         ELSE
  7644             MOVE ER-0333        TO EMI-ERROR
  7645             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7646             MOVE AL-UABON       TO STATUSA
  7647             MOVE -1             TO STATUSL
  7648             MOVE 'X'            TO ERROR-SWITCH
  7649         END-IF
  7650     ELSE
  7651         MOVE SPACE              TO TRLR-SWITCH
  7652         MOVE 'N'                TO DLYACTV-SW
  7653         MOVE AL-UANOF           TO STATUSA.
  7654
  7655     IF PROCI GREATER THAN LOW-VALUES
  7656         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  7657     ELSE
  7658         MOVE AL-UANOF TO PROCA.
  7659
  7660     IF SEXI GREATER THAN LOW-VALUES
  7661         IF SEXI = 'F' OR 'M'
  7662             MOVE AL-UANON       TO SEXA
  7663             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7664           ELSE
  7665             MOVE ER-0219        TO EMI-ERROR
  7666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7667             MOVE AL-UABON       TO SEXA
  7668             MOVE -1             TO SEXL
  7669             MOVE 'X'            TO ERROR-SWITCH
  7670       ELSE
  7671         MOVE AL-UANOF           TO SEXA.
  7672
  7673     IF BIRTHL = +0
  7674         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7675         MOVE AL-UANOF           TO  BIRTHA
  7676         GO TO 1000-CONTINUE-EDITS.
  7677
  7678     IF BIRTHI = SPACES
  7679         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7680         MOVE 'X'                TO  UPDATE-SWITCH
  7681                                     MSTR-SWITCH
  7682         GO TO 1000-CONTINUE-EDITS.
  7683
  7684     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  7685     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  7686     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  7687     MOVE '4'                    TO  DC-OPTION-CODE.
  7688     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7689     IF DATE-CONVERSION-ERROR
  7690         MOVE ER-0220            TO  EMI-ERROR
  7691         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7692         MOVE AL-UABON           TO  BIRTHA
  7693         MOVE -1                 TO  BIRTHL
  7694         MOVE 'X'                TO  ERROR-SWITCH
  7695         GO TO 1000-CONTINUE-EDITS.
  7696
  7697******************************************************************
  7698**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  7699**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 140
* EL131.cbl
  7700**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  7701******************************************************************
  7702     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  7703         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  7704         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  7705         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  7706         MOVE '4'                TO  DC-OPTION-CODE
  7707         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  7708         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7709                                     DC-ELAPSED-DAYS
  7710         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7711         IF DATE-CONVERSION-ERROR
  7712             MOVE ER-0220        TO  EMI-ERROR
  7713             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7714             MOVE AL-UABON       TO  BIRTHA
  7715             MOVE -1             TO  BIRTHL
  7716             MOVE 'X'            TO  ERROR-SWITCH
  7717             GO TO 1000-CONTINUE-EDITS.
  7718
  7719     MOVE AL-UANON               TO  BIRTHA.
  7720     MOVE 'X'                    TO  UPDATE-SWITCH
  7721                                     MSTR-SWITCH.
  7722     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  7723     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  7724     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  7725
  7726 1000-CONTINUE-EDITS.
  7727
  7728     IF SOCIALI GREATER THAN LOW-VALUES
  7729         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  7730         IF WS-SOC-SEC-NO NUMERIC AND
  7731           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  7732             NEXT SENTENCE
  7733         ELSE
  7734            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  7735               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  7736               WS-SSN-DASH2 = '-'
  7737                 NEXT SENTENCE
  7738            ELSE
  7739                 MOVE ER-0887        TO  EMI-ERROR
  7740                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7741                 MOVE AL-UABON       TO  SOCIALA
  7742                 MOVE -1             TO  SOCIALL
  7743                 MOVE 'X'            TO  ERROR-SWITCH
  7744            END-IF
  7745        END-IF
  7746     END-IF.
  7747
  7748     IF SOCIALI GREATER THAN LOW-VALUES
  7749         MOVE AL-UANON           TO SOCIALA
  7750         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  7751     ELSE
  7752         MOVE AL-UANOF           TO SOCIALA.
  7753
  7754     IF OCCI GREATER THAN LOW-VALUES
  7755         MOVE AL-UANON           TO OCCA
  7756         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7757     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 141
* EL131.cbl
  7758         MOVE AL-UANOF           TO OCCA.
  7759
  7760     IF BENEL NOT GREATER THAN ZERO
  7761            GO TO 1005-CONTINUE-EDITS.
  7762
  7763     IF BENEI = SPACES
  7764        MOVE 'X'                 TO UPDATE-SWITCH MSTR-SWITCH
  7765        GO TO 1005-CONTINUE-EDITS.
  7766
  7767
  7768* EXEC CICS HANDLE CONDITION
  7769*        NOTFND (1004-BENE-NOT-FOUND)
  7770*    END-EXEC.
  7771*    MOVE '"$I                   ! % #00007544' TO DFHEIV0
  7772     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7774     MOVE X'2520233030303037353434' TO DFHEIV0(25:11)
  7775     CALL 'kxdfhei1' USING DFHEIV0
  7776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7777
  7778
  7779     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  7780     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  7781     MOVE BENEI                  TO  WS-ELBENE-ID.
  7782
  7783
  7784* EXEC CICS READ
  7785*        DATASET ('ELBENE')
  7786*        RIDFLD  (WS-ELBENE-KEY)
  7787*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  7788*    END-EXEC.
  7789     MOVE 'ELBENE' TO DFHEIV1
  7790*    MOVE '&"S        E          (   #00007552' TO DFHEIV0
  7791     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7792     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7793     MOVE X'2020233030303037353532' TO DFHEIV0(25:11)
  7794     CALL 'kxdfhei1' USING DFHEIV0,
  7795           DFHEIV1,
  7796           DFHEIV20,
  7797           DFHEIV99,
  7798           WS-ELBENE-KEY,
  7799           DFHEIV99,
  7800           DFHEIV99,
  7801           DFHEIV99
  7802     SET ADDRESS OF BENEFICIARY-MASTER TO
  7803         DFHEIV20
  7804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7805
  7806
  7807     MOVE AL-UANON               TO  BENEA.
  7808     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7809
  7810     GO TO 1005-CONTINUE-EDITS.
  7811
  7812 1004-BENE-NOT-FOUND.
  7813     MOVE ER-0565                TO  EMI-ERROR.
  7814
  7815     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 142
* EL131.cbl
  7816     MOVE 'X'                    TO ERROR-SWITCH.
  7817     MOVE AL-UABON               TO BENEA.
  7818     MOVE -1                     TO BENEL.
  7819
  7820 1005-CONTINUE-EDITS.
  7821
  7822     IF DIAGI GREATER THAN LOW-VALUES
  7823         MOVE AL-UANON           TO DIAGA
  7824         MOVE 'X'                TO UPDATE-SWITCH
  7825                                    NINETY-TRLR-SWITCH
  7826     ELSE
  7827         MOVE AL-UANOF           TO DIAGA.
  7828
  7829     IF CAUSEI GREATER THAN LOW-VALUES
  7830         MOVE AL-UANON           TO CAUSEA
  7831         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7832     ELSE
  7833         MOVE AL-UANOF           TO CAUSEA.
  7834
  7835     IF ENDL GREATER THAN ZERO
  7836         MOVE LOW-VALUES         TO HOLD-END
  7837         IF ENDI = SPACES
  7838             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7839         ELSE
  7840             MOVE ENDI           TO DEEDIT-DATE-INPUT
  7841
  7842* EXEC CICS BIF DEEDIT
  7843*                FIELD    (DEEDIT-DATE-INPUT)
  7844*                LENGTH   (DATE-LENGTH)
  7845*            END-EXEC
  7846*    MOVE '@"L                   #   #00007592' TO DFHEIV0
  7847     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7848     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7849     MOVE X'2020233030303037353932' TO DFHEIV0(25:11)
  7850     CALL 'kxdfhei1' USING DFHEIV0,
  7851           DEEDIT-DATE-INPUT,
  7852           DATE-LENGTH
  7853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7854             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7855             MOVE '4'            TO DC-OPTION-CODE
  7856             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7857             IF NOT DATE-CONVERSION-ERROR
  7858                 MOVE DC-BIN-DATE-1      TO HOLD-END
  7859                 MOVE AL-UANON   TO ENDA
  7860                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7861                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  7862             ELSE
  7863                 MOVE ER-0224    TO EMI-ERROR
  7864                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7865                 MOVE AL-UABON   TO ENDA
  7866                 MOVE -1         TO ENDL
  7867                 MOVE 'X'        TO ERROR-SWITCH
  7868       ELSE
  7869           MOVE AL-UANOF         TO ENDA.
  7870
  7871     IF INCL GREATER THAN ZERO
  7872         MOVE LOW-VALUES         TO HOLD-INCUR
  7873         IF INCI = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 143
* EL131.cbl
  7874             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7875         ELSE
  7876             MOVE INCI           TO DEEDIT-DATE-INPUT
  7877
  7878* EXEC CICS BIF DEEDIT
  7879*                FIELD    (DEEDIT-DATE-INPUT)
  7880*                LENGTH   (DATE-LENGTH)
  7881*            END-EXEC
  7882*    MOVE '@"L                   #   #00007619' TO DFHEIV0
  7883     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7884     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7885     MOVE X'2020233030303037363139' TO DFHEIV0(25:11)
  7886     CALL 'kxdfhei1' USING DFHEIV0,
  7887           DEEDIT-DATE-INPUT,
  7888           DATE-LENGTH
  7889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7890             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7891             MOVE '4'            TO DC-OPTION-CODE
  7892             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7893             IF NOT DATE-CONVERSION-ERROR
  7894                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  7895                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7896                 MOVE AL-UANON           TO INCA
  7897                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  7898             ELSE
  7899                 MOVE ER-0222    TO EMI-ERROR
  7900                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7901                 MOVE AL-UABON   TO INCA
  7902                 MOVE -1         TO INCL
  7903                 MOVE 'X'        TO ERROR-SWITCH
  7904       ELSE
  7905           IF PI-NO-PMTS = ZEROS
  7906               MOVE AL-UANOF     TO INCA.
  7907
  7908     IF REPL GREATER THAN ZERO
  7909         MOVE LOW-VALUES         TO HOLD-REPORTED
  7910         IF REPI = SPACES
  7911             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7912         ELSE
  7913             MOVE REPI           TO DEEDIT-DATE-INPUT
  7914
  7915* EXEC CICS BIF DEEDIT
  7916*                FIELD    (DEEDIT-DATE-INPUT)
  7917*                LENGTH   (DATE-LENGTH)
  7918*            END-EXEC
  7919*    MOVE '@"L                   #   #00007647' TO DFHEIV0
  7920     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7921     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7922     MOVE X'2020233030303037363437' TO DFHEIV0(25:11)
  7923     CALL 'kxdfhei1' USING DFHEIV0,
  7924           DEEDIT-DATE-INPUT,
  7925           DATE-LENGTH
  7926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7927             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7928             MOVE '4'            TO DC-OPTION-CODE
  7929             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7930             IF NOT DATE-CONVERSION-ERROR
  7931                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 144
* EL131.cbl
  7932                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7933                 MOVE AL-UANON   TO REPA
  7934                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  7935             ELSE
  7936                 MOVE ER-0223    TO EMI-ERROR
  7937                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7938                 MOVE AL-UABON   TO REPA
  7939                 MOVE -1         TO REPL
  7940                 MOVE 'X'        TO ERROR-SWITCH
  7941       ELSE
  7942         MOVE AL-UANOF TO REPA.
  7943
  7944     IF PDTHRUI GREATER THAN LOW-VALUES
  7945        MOVE LOW-VALUES         TO HOLD-PDTHRU
  7946        IF PDTHRUI = SPACES
  7947           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7948        ELSE
  7949           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  7950
  7951* EXEC CICS BIF DEEDIT
  7952*               FIELD    (DEEDIT-DATE-INPUT)
  7953*               LENGTH   (DATE-LENGTH)
  7954*          END-EXEC
  7955*    MOVE '@"L                   #   #00007674' TO DFHEIV0
  7956     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7957     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7958     MOVE X'2020233030303037363734' TO DFHEIV0(25:11)
  7959     CALL 'kxdfhei1' USING DFHEIV0,
  7960           DEEDIT-DATE-INPUT,
  7961           DATE-LENGTH
  7962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7963           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7964           MOVE '4'            TO DC-OPTION-CODE
  7965           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7966           IF NOT DATE-CONVERSION-ERROR
  7967              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  7968              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7969              MOVE AL-UANON   TO PDTHRUA
  7970              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  7971              IF PI-USES-PAID-TO
  7972                 MOVE '6'            TO DC-OPTION-CODE
  7973                 MOVE -1             TO DC-ELAPSED-DAYS
  7974                 MOVE +0             TO DC-ELAPSED-MONTHS
  7975                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7976                 IF NO-CONVERSION-ERROR
  7977                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  7978                 ELSE
  7979                    NEXT SENTENCE
  7980              ELSE
  7981                 NEXT SENTENCE
  7982           ELSE
  7983              MOVE ER-0475    TO EMI-ERROR
  7984              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7985              MOVE AL-UABON   TO PDTHRUA
  7986              MOVE -1         TO PDTHRUL
  7987              MOVE 'X'        TO ERROR-SWITCH
  7988     ELSE
  7989        IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 145
* EL131.cbl
  7990           MOVE AL-UANOF        TO PDTHRUA.
  7991
  7992     IF PDAMTL GREATER THAN +0
  7993         MOVE ZEROS              TO HOLD-PDAMT
  7994
  7995* EXEC CICS BIF DEEDIT
  7996*            FIELD    (PDAMTI)
  7997*            LENGTH   (9)
  7998*        END-EXEC
  7999     MOVE 9
  8000       TO DFHEIV11
  8001*    MOVE '@"L                   #   #00007709' TO DFHEIV0
  8002     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8003     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8004     MOVE X'2020233030303037373039' TO DFHEIV0(25:11)
  8005     CALL 'kxdfhei1' USING DFHEIV0,
  8006           PDAMTI,
  8007           DFHEIV11
  8008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8009         IF PDAMTI NUMERIC
  8010             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8011             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8012             MOVE AL-UNNON       TO PDAMTA
  8013         ELSE
  8014             MOVE ER-0547        TO EMI-ERROR
  8015             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8016             MOVE AL-UNBON       TO PDAMTA
  8017             MOVE -1             TO PDAMTL
  8018             MOVE 'X'            TO ERROR-SWITCH
  8019     ELSE
  8020         IF MODIFY-CAP
  8021            MOVE AL-UNNOF        TO PDAMTA.
  8022
  8023     IF NODAYSI GREATER THAN LOW-VALUES
  8024         MOVE ZEROS              TO HOLD-NODAYS
  8025
  8026* EXEC CICS BIF DEEDIT
  8027*            FIELD (NODAYSI)
  8028*            LENGTH (5)
  8029*        END-EXEC
  8030     MOVE 5
  8031       TO DFHEIV11
  8032*    MOVE '@"L                   #   #00007729' TO DFHEIV0
  8033     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8034     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8035     MOVE X'2020233030303037373239' TO DFHEIV0(25:11)
  8036     CALL 'kxdfhei1' USING DFHEIV0,
  8037           NODAYSI,
  8038           DFHEIV11
  8039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8040         IF NODAYSI NUMERIC
  8041             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8042             MOVE AL-UNNON       TO NODAYSA
  8043             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8044         ELSE
  8045             MOVE ER-0491        TO EMI-ERROR
  8046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8047             MOVE AL-UNBON       TO NODAYSA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 146
* EL131.cbl
  8048             MOVE -1             TO NODAYSL
  8049             MOVE 'X'            TO ERROR-SWITCH
  8050     ELSE
  8051         IF MODIFY-CAP
  8052            MOVE AL-UNNOF        TO NODAYSA.
  8053
  8054     IF NOPMTSI GREATER THAN LOW-VALUES
  8055         MOVE ZEROS              TO HOLD-NOPMTS
  8056
  8057* EXEC CICS BIF DEEDIT
  8058*            FIELD (NOPMTSI)
  8059*            LENGTH (4)
  8060*        END-EXEC
  8061     MOVE 4
  8062       TO DFHEIV11
  8063*    MOVE '@"L                   #   #00007749' TO DFHEIV0
  8064     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8065     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8066     MOVE X'2020233030303037373439' TO DFHEIV0(25:11)
  8067     CALL 'kxdfhei1' USING DFHEIV0,
  8068           NOPMTSI,
  8069           DFHEIV11
  8070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8071         IF NOPMTSI NUMERIC
  8072             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8073             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8074             MOVE AL-UNNON       TO NOPMTSA
  8075           ELSE
  8076             MOVE ER-0548        TO EMI-ERROR
  8077             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8078             MOVE AL-UNBON       TO NOPMTSA
  8079             MOVE -1             TO NOPMTSL
  8080             MOVE 'X'            TO ERROR-SWITCH
  8081       ELSE
  8082         IF MODIFY-CAP
  8083            MOVE AL-UNNOF        TO NOPMTSA.
  8084
  8085     IF FORMTYPI GREATER THAN LOW-VALUES
  8086         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8087             MOVE AL-UANON       TO FORMTYPA
  8088             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8089           ELSE
  8090             MOVE ER-7650        TO EMI-ERROR
  8091             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8092             MOVE AL-UABON       TO FORMTYPA
  8093             MOVE -1             TO FORMTYPL
  8094             MOVE 'X'            TO ERROR-SWITCH
  8095       ELSE
  8096         MOVE AL-UANOF           TO FORMTYPA.
  8097
  8098     IF PRICDL GREATER THAN ZERO
  8099         IF (PRICDI = ' ') OR
  8100            (PRICDI GREATER THAN ZERO   AND
  8101             PRICDI NOT GREATER THAN '9')
  8102             MOVE AL-UANON       TO PRICDA
  8103             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8104         ELSE
  8105             MOVE ER-0274        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 147
* EL131.cbl
  8106             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8107             MOVE AL-UABON       TO PRICDA
  8108             MOVE -1             TO PRICDL
  8109             MOVE 'X'            TO ERROR-SWITCH
  8110     ELSE
  8111         MOVE AL-UANOF TO PRICDA.
  8112
  8113     IF PI-COMPANY-ID = 'DMD'
  8114     IF PRICDL GREATER THAN ZERO
  8115       IF SYSTEM-MODIFY-CAP  OR
  8116          PI-PROCESSOR-ID = 'LGXX'
  8117             NEXT SENTENCE
  8118           ELSE
  8119            IF CL-PRIORITY-CD = '9'  OR
  8120               PRICDI         = '9'
  8121                  MOVE ER-0938        TO EMI-ERROR
  8122                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8123                  MOVE AL-UABON       TO PRICDA
  8124                  MOVE -1             TO PRICDL
  8125                  MOVE 'X'            TO ERROR-SWITCH.
  8126
  8127     IF FILETOL GREATER THAN ZERO
  8128         MOVE AL-UANON           TO FILETOA
  8129         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8130     ELSE
  8131         MOVE AL-UANOF TO FILETOA.
  8132
  8133     IF SUPVL GREATER THAN ZERO
  8134         IF SUPVI = 'Y' OR 'N' OR SPACE
  8135             MOVE AL-UANON       TO SUPVA
  8136             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8137         ELSE
  8138             MOVE ER-0230        TO EMI-ERROR
  8139             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8140             MOVE AL-UABON       TO SUPVA
  8141             MOVE -1             TO SUPVL
  8142             MOVE 'X'            TO ERROR-SWITCH
  8143     ELSE
  8144         MOVE AL-UANOF           TO SUPVA.
  8145
  8146     IF MLNAMEL GREATER THAN ZERO
  8147         IF MLNAMEI GREATER THAN SPACES
  8148            MOVE AL-UANON        TO MLNAMEA
  8149            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8150                                     MSTR-KEY-SWITCH
  8151         ELSE
  8152            MOVE ER-0236         TO EMI-ERROR
  8153            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8154            MOVE AL-UABON        TO MLNAMEA
  8155            MOVE -1              TO MLNAMEL
  8156            MOVE 'X'             TO ERROR-SWITCH
  8157     ELSE
  8158         MOVE AL-UANOF           TO MLNAMEA.
  8159
  8160     IF MFNAMEI GREATER THAN LOW-VALUES
  8161         MOVE AL-UANON           TO MFNAMEA
  8162         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8163     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 148
* EL131.cbl
  8164         MOVE AL-UANOF           TO MFNAMEA.
  8165
  8166     IF MMINITI GREATER THAN LOW-VALUES
  8167         MOVE AL-UANON           TO MMINITA
  8168         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8169     ELSE
  8170         MOVE AL-UANOF           TO MMINITA.
  8171
  8172     IF CRTLNMEI GREATER THAN LOW-VALUES
  8173         IF CRTLNMEI NOT = SPACES
  8174            MOVE AL-UANON        TO CRTLNMEA
  8175            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8176                                     CERT-KEY-SWITCH
  8177        ELSE
  8178            MOVE ER-0236         TO EMI-ERROR
  8179            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8180            MOVE AL-UABON        TO CRTLNMEA
  8181            MOVE -1              TO CRTLNMEL
  8182            MOVE 'X'             TO ERROR-SWITCH
  8183     ELSE
  8184         MOVE AL-UANOF           TO CRTLNMEA.
  8185
  8186     IF CRTFNMEI GREATER THAN LOW-VALUES
  8187         MOVE AL-UANON           TO CRTFNMEA
  8188         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8189     ELSE
  8190         MOVE AL-UANOF           TO CRTFNMEA.
  8191
  8192     IF CRTINITI GREATER THAN LOW-VALUES
  8193         MOVE AL-UANON           TO CRTINITA
  8194         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8195     ELSE
  8196         MOVE AL-UANOF           TO CRTINITA.
  8197
  8198     IF ISSAGEL GREATER THAN ZERO
  8199         IF ISSAGEI NUMERIC
  8200            MOVE AL-UANON        TO ISSAGEA
  8201            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8202         ELSE
  8203            MOVE ER-0237         TO EMI-ERROR
  8204            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8205            MOVE AL-UABON        TO ISSAGEA
  8206            MOVE -1              TO ISSAGEL
  8207            MOVE 'X'             TO ERROR-SWITCH
  8208     ELSE
  8209         MOVE AL-UANOF           TO ISSAGEA.
  8210
  8211     IF JNTFNMEI GREATER THAN LOW-VALUES
  8212         MOVE AL-UANON           TO JNTFNMEA
  8213         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8214     ELSE
  8215         MOVE AL-UANOF           TO JNTFNMEA.
  8216
  8217     IF JNTLNMEI GREATER THAN LOW-VALUES
  8218         MOVE AL-UANON           TO JNTLNMEA
  8219         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8220     ELSE
  8221         MOVE AL-UANOF           TO JNTLNMEA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 149
* EL131.cbl
  8222
  8223     IF JNTINITI GREATER THAN LOW-VALUES
  8224         MOVE AL-UANON           TO JNTINITA
  8225         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8226     ELSE
  8227         MOVE AL-UANOF           TO JNTINITA.
  8228
  8229     IF JNTAGEL GREATER THAN ZERO
  8230         IF JNTAGEI NUMERIC
  8231            MOVE AL-UANON        TO JNTAGEA
  8232            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8233         ELSE
  8234            MOVE ER-0238         TO EMI-ERROR
  8235            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8236            MOVE AL-UABON        TO JNTAGEA
  8237            MOVE -1              TO JNTAGEL
  8238            MOVE 'X'             TO ERROR-SWITCH
  8239     ELSE
  8240         MOVE AL-UANOF           TO JNTAGEA.
  8241
  8242     IF ADDONDTI GREATER THAN LOW-VALUES
  8243         MOVE LOW-VALUES         TO HOLD-ADDON
  8244         IF ADDONDTI = SPACES
  8245             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8246         ELSE
  8247             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8248
  8249* EXEC CICS BIF DEEDIT
  8250*                FIELD    (DEEDIT-DATE-INPUT)
  8251*                LENGTH   (DATE-LENGTH)
  8252*            END-EXEC
  8253*    MOVE '@"L                   #   #00007930' TO DFHEIV0
  8254     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8255     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8256     MOVE X'2020233030303037393330' TO DFHEIV0(25:11)
  8257     CALL 'kxdfhei1' USING DFHEIV0,
  8258           DEEDIT-DATE-INPUT,
  8259           DATE-LENGTH
  8260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8261             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8262             MOVE '4'            TO DC-OPTION-CODE
  8263             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8264             IF NOT DATE-CONVERSION-ERROR
  8265                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8266                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8267                                                  CERT-SWITCH
  8268                 MOVE AL-UANON   TO ADDONDTA
  8269                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8270             ELSE
  8271                 MOVE ER-7651    TO EMI-ERROR
  8272                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8273                 MOVE AL-UABON   TO ADDONDTA
  8274                 MOVE -1         TO ADDONDTL
  8275                 MOVE 'X'        TO ERROR-SWITCH
  8276       ELSE
  8277         MOVE AL-UANOF TO ADDONDTA.
  8278
  8279     IF LCVCDI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 150
* EL131.cbl
  8280         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8281         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8282     ELSE
  8283         MOVE AL-UANOF           TO LCVCDA.
  8284
  8285     IF ACVCDI GREATER THAN LOW-VALUES
  8286         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8287         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8288     ELSE
  8289         MOVE AL-UANOF           TO ACVCDA.
  8290
  8291     IF LCVOTRMI GREATER THAN LOW-VALUES
  8292
  8293* EXEC CICS BIF DEEDIT
  8294*            FIELD (LCVOTRMI)
  8295*            LENGTH(3)
  8296*        END-EXEC
  8297     MOVE 3
  8298       TO DFHEIV11
  8299*    MOVE '@"L                   #   #00007965' TO DFHEIV0
  8300     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8301     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8302     MOVE X'2020233030303037393635' TO DFHEIV0(25:11)
  8303     CALL 'kxdfhei1' USING DFHEIV0,
  8304           LCVOTRMI,
  8305           DFHEIV11
  8306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8307         IF LCVOTRMI IS NUMERIC
  8308             MOVE LCVOTRMI       TO LCVOTRMO
  8309             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8310             MOVE AL-UANON       TO LCVOTRMA
  8311         ELSE
  8312             MOVE ER-0241        TO EMI-ERROR
  8313             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8314             MOVE AL-UNBON       TO LCVOTRMA
  8315             MOVE 'X'            TO ERROR-SWITCH
  8316             MOVE -1             TO LCVOTRML
  8317     ELSE
  8318         MOVE AL-UANOF           TO LCVOTRMA.
  8319
  8320     IF ACVOTRMI GREATER THAN LOW-VALUES
  8321
  8322* EXEC CICS BIF DEEDIT
  8323*            FIELD (ACVOTRMI)
  8324*            LENGTH(3)
  8325*        END-EXEC
  8326     MOVE 3
  8327       TO DFHEIV11
  8328*    MOVE '@"L                   #   #00007983' TO DFHEIV0
  8329     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8330     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8331     MOVE X'2020233030303037393833' TO DFHEIV0(25:11)
  8332     CALL 'kxdfhei1' USING DFHEIV0,
  8333           ACVOTRMI,
  8334           DFHEIV11
  8335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8336         IF ACVOTRMI IS NUMERIC
  8337             MOVE ACVOTRMI       TO ACVOTRMO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 151
* EL131.cbl
  8338             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8339             MOVE AL-UANON       TO ACVOTRMA
  8340         ELSE
  8341             MOVE ER-0241        TO EMI-ERROR
  8342             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8343             MOVE AL-UNBON       TO ACVOTRMA
  8344             MOVE 'X'            TO ERROR-SWITCH
  8345             MOVE -1             TO ACVOTRML
  8346     ELSE
  8347         MOVE AL-UANOF           TO ACVOTRMA.
  8348
  8349     IF LCVRATEL GREATER THAN +0
  8350
  8351* EXEC CICS BIF DEEDIT
  8352*            FIELD (LCVRATEI)
  8353*            LENGTH(6)
  8354*        END-EXEC
  8355     MOVE 6
  8356       TO DFHEIV11
  8357*    MOVE '@"L                   #   #00008001' TO DFHEIV0
  8358     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8359     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8360     MOVE X'2020233030303038303031' TO DFHEIV0(25:11)
  8361     CALL 'kxdfhei1' USING DFHEIV0,
  8362           LCVRATEI,
  8363           DFHEIV11
  8364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8365         IF LCVRATEI IS NUMERIC
  8366             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8367             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8368             MOVE AL-UNNON       TO LCVRATEA
  8369         ELSE
  8370             MOVE ER-2280        TO EMI-ERROR
  8371             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8372             MOVE AL-UNBON       TO LCVRATEA
  8373             MOVE 'X'            TO ERROR-SWITCH
  8374             MOVE -1             TO LCVRATEL
  8375     ELSE
  8376         MOVE AL-UNNOF           TO LCVRATEA.
  8377
  8378     IF ACVRATEL GREATER THAN +0
  8379
  8380* EXEC CICS BIF DEEDIT
  8381*            FIELD (ACVRATEI)
  8382*            LENGTH(6)
  8383*        END-EXEC
  8384     MOVE 6
  8385       TO DFHEIV11
  8386*    MOVE '@"L                   #   #00008019' TO DFHEIV0
  8387     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8388     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8389     MOVE X'2020233030303038303139' TO DFHEIV0(25:11)
  8390     CALL 'kxdfhei1' USING DFHEIV0,
  8391           ACVRATEI,
  8392           DFHEIV11
  8393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8394         IF ACVRATEI IS NUMERIC
  8395             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 152
* EL131.cbl
  8396             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8397             MOVE AL-UNNON       TO ACVRATEA
  8398         ELSE
  8399             MOVE ER-2280        TO EMI-ERROR
  8400             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8401             MOVE AL-UNBON       TO ACVRATEA
  8402             MOVE 'X'            TO ERROR-SWITCH
  8403             MOVE -1             TO ACVRATEL
  8404     ELSE
  8405         MOVE AL-UNNOF           TO ACVRATEA.
  8406
  8407     IF LCVBENEL GREATER THAN ZERO
  8408
  8409* EXEC CICS BIF DEEDIT
  8410*            FIELD (LCVBENEI)
  8411*            LENGTH (11)
  8412*        END-EXEC
  8413     MOVE 11
  8414       TO DFHEIV11
  8415*    MOVE '@"L                   #   #00008037' TO DFHEIV0
  8416     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8417     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8418     MOVE X'2020233030303038303337' TO DFHEIV0(25:11)
  8419     CALL 'kxdfhei1' USING DFHEIV0,
  8420           LCVBENEI,
  8421           DFHEIV11
  8422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8423         IF LCVBENEI IS NUMERIC
  8424            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8425            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8426            MOVE AL-UNNON        TO LCVBENEA
  8427         ELSE
  8428            MOVE ER-0243         TO EMI-ERROR
  8429            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8430            MOVE AL-UNBON        TO LCVBENEA
  8431            MOVE -1              TO LCVBENEL
  8432            MOVE 'X'             TO ERROR-SWITCH
  8433     ELSE
  8434         MOVE AL-UANOF           TO LCVBENEA.
  8435
  8436     IF ACVBENEL GREATER THAN ZERO
  8437
  8438* EXEC CICS BIF DEEDIT
  8439*            FIELD (ACVBENEI)
  8440*            LENGTH (11)
  8441*        END-EXEC
  8442     MOVE 11
  8443       TO DFHEIV11
  8444*    MOVE '@"L                   #   #00008055' TO DFHEIV0
  8445     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8446     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8447     MOVE X'2020233030303038303535' TO DFHEIV0(25:11)
  8448     CALL 'kxdfhei1' USING DFHEIV0,
  8449           ACVBENEI,
  8450           DFHEIV11
  8451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8452         IF ACVBENEI IS NUMERIC
  8453            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 153
* EL131.cbl
  8454            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8455            MOVE AL-UNNON        TO ACVBENEA
  8456         ELSE
  8457            MOVE ER-0243         TO EMI-ERROR
  8458            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8459            MOVE AL-UNBON        TO ACVBENEA
  8460            MOVE -1              TO ACVBENEL
  8461            MOVE 'X'             TO ERROR-SWITCH
  8462     ELSE
  8463         MOVE AL-UANOF           TO ACVBENEA.
  8464
  8465     IF LCVFORMI GREATER THAN LOW-VALUES
  8466        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8467        MOVE AL-UANON            TO LCVFORMA
  8468     ELSE
  8469        MOVE AL-UANOF            TO LCVFORMA.
  8470
  8471     IF ACVFORMI GREATER THAN LOW-VALUES
  8472        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8473        MOVE AL-UANON            TO ACVFORMA
  8474     ELSE
  8475        MOVE AL-UANOF            TO ACVFORMA.
  8476
  8477     IF LCVCNDTL GREATER THAN ZERO
  8478         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8479         IF LCVCNDTI = SPACES
  8480             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8481         ELSE
  8482             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8483             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8484             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8485             MOVE '4'            TO DC-OPTION-CODE
  8486             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8487             IF NOT DATE-CONVERSION-ERROR
  8488                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8489                 MOVE AL-UANON   TO LCVCNDTA
  8490                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8491                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8492             ELSE
  8493                 MOVE ER-0246    TO EMI-ERROR
  8494                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8495                 MOVE AL-UABON   TO LCVCNDTA
  8496                 MOVE -1         TO LCVCNDTL
  8497                 MOVE 'X'        TO ERROR-SWITCH
  8498     ELSE
  8499         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8500         MOVE AL-UANOF           TO LCVCNDTA.
  8501
  8502     IF ACVCNDTL GREATER THAN ZERO
  8503         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8504         IF ACVCNDTI = SPACES
  8505             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8506         ELSE
  8507             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8508             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8509             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8510             MOVE '4'            TO DC-OPTION-CODE
  8511             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 154
* EL131.cbl
  8512             IF NOT DATE-CONVERSION-ERROR
  8513                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8514                 MOVE AL-UANON   TO ACVCNDTA
  8515                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8516                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8517             ELSE
  8518                 MOVE ER-0246    TO EMI-ERROR
  8519                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8520                 MOVE AL-UABON   TO ACVCNDTA
  8521                 MOVE -1         TO ACVCNDTL
  8522                 MOVE 'X'        TO ERROR-SWITCH
  8523     ELSE
  8524         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8525         MOVE AL-UANOF           TO ACVCNDTA.
  8526
  8527     IF APRL GREATER THAN +0
  8528
  8529* EXEC CICS BIF DEEDIT
  8530*            FIELD    (APRI)
  8531*            LENGTH   (8)
  8532*        END-EXEC
  8533     MOVE 8
  8534       TO DFHEIV11
  8535*    MOVE '@"L                   #   #00008135' TO DFHEIV0
  8536     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8537     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8538     MOVE X'2020233030303038313335' TO DFHEIV0(25:11)
  8539     CALL 'kxdfhei1' USING DFHEIV0,
  8540           APRI,
  8541           DFHEIV11
  8542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8543         IF APRI NUMERIC
  8544            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8545            MOVE APRI            TO HOLD-APR APRO
  8546            MOVE AL-UANON        TO APRA
  8547          ELSE
  8548            MOVE ER-0259         TO EMI-ERROR
  8549            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8550            MOVE AL-UABON        TO APRA
  8551            MOVE -1              TO APRL
  8552            MOVE 'X'             TO ERROR-SWITCH
  8553     ELSE
  8554         MOVE AL-UANOF           TO APRA.
  8555
  8556     IF PMTFREQL GREATER THAN ZERO
  8557
  8558* EXEC CICS BIF DEEDIT
  8559*            FIELD    (PMTFREQI)
  8560*            LENGTH   (2)
  8561*        END-EXEC
  8562     MOVE 2
  8563       TO DFHEIV11
  8564*    MOVE '@"L                   #   #00008153' TO DFHEIV0
  8565     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8566     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8567     MOVE X'2020233030303038313533' TO DFHEIV0(25:11)
  8568     CALL 'kxdfhei1' USING DFHEIV0,
  8569           PMTFREQI,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 155
* EL131.cbl
  8570           DFHEIV11
  8571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8572         IF PMTFREQI NUMERIC
  8573            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  8574            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8575            MOVE AL-UANON        TO PMTFREQA
  8576          ELSE
  8577            MOVE ER-0427         TO EMI-ERROR
  8578            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8579            MOVE AL-UABON        TO PMTFREQA
  8580            MOVE -1              TO PMTFREQL
  8581            MOVE 'X'             TO ERROR-SWITCH
  8582     ELSE
  8583         MOVE AL-UANOF           TO PMTFREQA.
  8584
  8585     IF INDGRPL GREATER THAN ZERO
  8586         IF INDGRPI = 'I' OR 'G' OR SPACE
  8587             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8588             MOVE AL-UANON       TO INDGRPA
  8589          ELSE
  8590             MOVE ER-0260        TO EMI-ERROR
  8591             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8592             MOVE AL-UABON       TO INDGRPA
  8593             MOVE -1             TO INDGRPL
  8594             MOVE 'X'            TO ERROR-SWITCH
  8595     ELSE
  8596         MOVE AL-UANOF           TO INDGRPA.
  8597
  8598     IF PREMTYPL GREATER THAN ZERO
  8599         IF PREMTYPI = '1' OR '2' OR '3'
  8600            MOVE PREMTYPI        TO PI-PREM-TYPE
  8601            MOVE AL-UNNON        TO PREMTYPA
  8602            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8603          ELSE
  8604            MOVE ER-0227         TO EMI-ERROR
  8605            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8606            MOVE AL-UNBON        TO PREMTYPA
  8607            MOVE -1              TO PREMTYPL
  8608            MOVE 'X'             TO ERROR-SWITCH
  8609     ELSE
  8610         MOVE AL-UANOF           TO PREMTYPA.
  8611
  8612     IF LOANBALL GREATER THAN ZERO
  8613
  8614* EXEC CICS BIF DEEDIT
  8615*             FIELD    (LOANBALI)
  8616*             LENGTH   (9)
  8617*        END-EXEC
  8618     MOVE 9
  8619       TO DFHEIV11
  8620*    MOVE '@"L                   #   #00008198' TO DFHEIV0
  8621     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8622     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8623     MOVE X'2020233030303038313938' TO DFHEIV0(25:11)
  8624     CALL 'kxdfhei1' USING DFHEIV0,
  8625           LOANBALI,
  8626           DFHEIV11
  8627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 156
* EL131.cbl
  8628         IF LOANBALI NUMERIC
  8629             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  8630             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  8631             MOVE AL-UNNON TO LOANBALA
  8632         ELSE
  8633             MOVE ER-0639        TO EMI-ERROR
  8634             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8635             MOVE AL-UNBON       TO LOANBALA
  8636             MOVE -1             TO LOANBALL
  8637             MOVE 'X'            TO ERROR-SWITCH
  8638     ELSE
  8639         MOVE AL-UNNOF           TO LOANBALA.
  8640
  8641     IF LOANNOL GREATER THAN ZERO
  8642        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8643        MOVE AL-UANON            TO LOANNOA
  8644     ELSE
  8645        MOVE AL-UANOF            TO LOANNOA.
  8646
  8647     IF REINCDI GREATER THAN LOW-VALUES
  8648        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8649        MOVE AL-UANON            TO REINCDA
  8650     ELSE
  8651        MOVE AL-UANOF            TO REINCDA.
  8652
  8653     IF CERTI GREATER THAN LOW-VALUES
  8654         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  8655     ELSE
  8656         MOVE AL-UANOF           TO CERTA.
  8657
  8658     IF CERTEFFI GREATER THAN LOW-VALUES
  8659         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  8660     ELSE
  8661         MOVE AL-UANOF           TO CERTEFFA.
  8662
  8663     IF CERTACTI GREATER THAN LOW-VALUES
  8664         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  8665     ELSE
  8666         MOVE AL-UANOF           TO CERTACTA.
  8667
  8668     IF CERTSTI GREATER THAN LOW-VALUES
  8669         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  8670     ELSE
  8671         MOVE AL-UANOF           TO CERTSTA.
  8672
  8673     IF CERTCARI GREATER THAN LOW-VALUES
  8674         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  8675     ELSE
  8676         MOVE AL-UANOF           TO CERTCARA.
  8677
  8678     IF DLYACTV-RECORD-NEEDED
  8679         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  8680                 1150-EXIT
  8681     END-IF.
  8682
  8683     IF CERTEFFI GREATER LOW-VALUES OR
  8684        CERTACTI GREATER LOW-VALUES OR
  8685        CERTSTI  GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 157
* EL131.cbl
  8686        CERTCARI GREATER LOW-VALUES OR
  8687        CERTGRPI GREATER LOW-VALUES
  8688        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8689
  8690*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  8691*      IF PI-PREM-TYPE NOT = '1'  AND
  8692*         PI-NO-PMTS = ZEROS
  8693*          IF LOANBALL GREATER +0 OR
  8694*             ACVBENEL GREATER +0
  8695*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8696
  8697     IF CERTL = ZEROS AND
  8698        SUFXL = ZEROS
  8699          GO TO 1010-EXIT.
  8700
  8701     IF CERTL GREATER THAN ZEROS
  8702         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  8703             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  8704             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8705             MOVE 'X'            TO ERROR-SWITCH
  8706             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8707
  8708     IF SUFXL GREATER THAN ZEROS
  8709         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  8710             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  8711             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8712             MOVE 'X'            TO ERROR-SWITCH
  8713             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8714
  8715 1010-EXIT.
  8716     EXIT.
  8717
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 158
* EL131.cbl
  8719 1120-EDIT-PROC.
  8720     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  8721     MOVE '2'                    TO CNTL-REC-TYPE.
  8722     MOVE PROCI                  TO CNTL-PROC-ID.
  8723     MOVE ZERO                   TO CNTL-SEQ-NO.
  8724
  8725
  8726* EXEC CICS HANDLE CONDITION
  8727*         NOTFND    (1120-CNTL-NOTFND)
  8728*    END-EXEC.
  8729*    MOVE '"$I                   ! & #00008299' TO DFHEIV0
  8730     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8732     MOVE X'2620233030303038323939' TO DFHEIV0(25:11)
  8733     CALL 'kxdfhei1' USING DFHEIV0
  8734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8735
  8736
  8737
  8738* EXEC CICS READ
  8739*         SET      (ADDRESS OF CONTROL-FILE)
  8740*         DATASET  (CNTL-FILE-ID)
  8741*         RIDFLD   (CNTL-KEY)
  8742*    END-EXEC.
  8743*    MOVE '&"S        E          (   #00008303' TO DFHEIV0
  8744     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8745     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8746     MOVE X'2020233030303038333033' TO DFHEIV0(25:11)
  8747     CALL 'kxdfhei1' USING DFHEIV0,
  8748           CNTL-FILE-ID,
  8749           DFHEIV20,
  8750           DFHEIV99,
  8751           CNTL-KEY,
  8752           DFHEIV99,
  8753           DFHEIV99,
  8754           DFHEIV99
  8755     SET ADDRESS OF CONTROL-FILE TO
  8756         DFHEIV20
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8758
  8759
  8760     MOVE AL-UANON               TO PROCA.
  8761     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  8762     GO TO 1120-EXIT.
  8763
  8764 1120-CNTL-NOTFND.
  8765     MOVE ER-0273                TO EMI-ERROR.
  8766     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8767     MOVE AL-UABON               TO PROCA.
  8768     MOVE -1                     TO PROCL.
  8769     MOVE 'X'                    TO ERROR-SWITCH.
  8770
  8771 1120-EXIT.
  8772     EXIT.
  8773
  8774*************************************************************
  8775*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  8776*************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 159
* EL131.cbl
  8777
  8778 1150-OUTPUT-ACTIVITY-RECORD.
  8779
  8780
  8781* EXEC CICS GETMAIN
  8782*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  8783*        LENGTH (25)
  8784*        INITIMG (WS-BLANK)
  8785*    END-EXEC.
  8786     MOVE 25
  8787       TO DFHEIV11
  8788*    MOVE ',"IL                  $   #00008329' TO DFHEIV0
  8789     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8790     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8791     MOVE X'2020233030303038333239' TO DFHEIV0(25:11)
  8792     CALL 'kxdfhei1' USING DFHEIV0,
  8793           DFHEIV20,
  8794           DFHEIV11,
  8795           WS-BLANK
  8796     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  8797         DFHEIV20
  8798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8799
  8800
  8801     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  8802     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  8803     MOVE PI-CARRIER             TO DA-CARRIER.
  8804     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  8805     MOVE PI-CERT-NO             TO DA-CERT-NO.
  8806     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  8807     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  8808
  8809
  8810* EXEC CICS HANDLE CONDITION
  8811*        NOTOPEN (1150-NOTOPEN-ERROR)
  8812*        DUPREC (1150-EXIT)
  8813*    END-EXEC.
  8814*    MOVE '"$J%                  ! '' #00008343' TO DFHEIV0
  8815     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  8816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8817     MOVE X'2720233030303038333433' TO DFHEIV0(25:11)
  8818     CALL 'kxdfhei1' USING DFHEIV0
  8819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8820
  8821     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  8822     MOVE 'DLYACTV'              TO JP-FILE-ID.
  8823     MOVE 'A'                    TO JP-RECORD-TYPE.
  8824     MOVE +48                    TO JOURNAL-LENGTH.
  8825
  8826
  8827* EXEC CICS WRITE
  8828*        DATASET ('DLYACTV')
  8829*        RIDFLD (DA-KEY)
  8830*        FROM (DAILY-ACTIVITY-RECORD)
  8831*        LENGTH (25)
  8832*    END-EXEC.
  8833     MOVE 'DLYACTV' TO DFHEIV1
  8834     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 160
* EL131.cbl
  8835       TO DFHEIV11
  8836*    MOVE '&$ L                  ''   #00008352' TO DFHEIV0
  8837     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8838     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8839     MOVE X'2020233030303038333532' TO DFHEIV0(25:11)
  8840     CALL 'kxdfhei1' USING DFHEIV0,
  8841           DFHEIV1,
  8842           DAILY-ACTIVITY-RECORD,
  8843           DFHEIV11,
  8844           DA-KEY,
  8845           DFHEIV99,
  8846           DFHEIV99
  8847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8848
  8849
  8850     GO TO 1150-EXIT.
  8851
  8852 1150-NOTOPEN-ERROR.
  8853
  8854     MOVE '2955'                 TO EMI-ERROR.
  8855     MOVE -1                     TO MAINTL.
  8856     MOVE AL-UANON               TO MAINTA.
  8857     MOVE 'X'                    TO ERROR-SWITCH.
  8858     PERFORM 9900-ERROR-FORMAT THRU
  8859             9900-EXIT.
  8860
  8861 1150-EXIT.
  8862     EXIT.
  8863
  8864*************************************************************
  8865*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  8866*************************************************************
  8867
  8868 1240-EDIT-LIFE-CODE.
  8869
  8870     IF INVALID-BENEFIT-CODE
  8871         GO TO 1240-SET-ERROR.
  8872
  8873     MOVE SPACES                 TO BENEFIT-KEY.
  8874     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  8875     MOVE '4'                    TO BEN-REC-TYPE.
  8876     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  8877     MOVE ZERO                   TO BEN-SEQ-NO.
  8878
  8879
  8880* EXEC CICS READ GTEQ
  8881*         DATASET  (CNTL-FILE-ID)
  8882*         RIDFLD   (BENEFIT-KEY)
  8883*         SET      (ADDRESS OF CONTROL-FILE)
  8884*    END-EXEC.
  8885*    MOVE '&"S        G          (   #00008388' TO DFHEIV0
  8886     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8887     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8888     MOVE X'2020233030303038333838' TO DFHEIV0(25:11)
  8889     CALL 'kxdfhei1' USING DFHEIV0,
  8890           CNTL-FILE-ID,
  8891           DFHEIV20,
  8892           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 161
* EL131.cbl
  8893           BENEFIT-KEY,
  8894           DFHEIV99,
  8895           DFHEIV99,
  8896           DFHEIV99
  8897     SET ADDRESS OF CONTROL-FILE TO
  8898         DFHEIV20
  8899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8900
  8901
  8902     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  8903        CF-RECORD-TYPE NOT = '4'
  8904         GO TO 1240-SET-ERROR.
  8905
  8906     MOVE ZERO                   TO COUNT-2.
  8907     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  8908
  8909     IF SCREEN-ERROR
  8910         GO TO 1240-SET-ERROR.
  8911
  8912 1240-SET-CODE-SWITCHES.
  8913     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  8914     MOVE AL-UANON               TO LCVCDA.
  8915     GO TO 1240-EXIT.
  8916
  8917 1240-SET-ERROR.
  8918     MOVE ER-0240                TO EMI-ERROR.
  8919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8920     MOVE 'X'                    TO ERROR-SWITCH.
  8921     MOVE AL-UABON               TO LCVCDA.
  8922     MOVE -1                     TO LCVCDL.
  8923
  8924 1240-EXIT.
  8925     EXIT.
  8926
  8927 1310-EDIT-AH-CODE.
  8928     IF INVALID-BENEFIT-CODE
  8929         GO TO 1310-SET-ERROR.
  8930
  8931     MOVE SPACES                 TO BENEFIT-KEY.
  8932     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  8933     MOVE '5'                    TO BEN-REC-TYPE.
  8934     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  8935     MOVE ZERO                   TO BEN-SEQ-NO.
  8936
  8937
  8938* EXEC CICS READ GTEQ
  8939*         DATASET  (CNTL-FILE-ID)
  8940*         RIDFLD   (BENEFIT-KEY)
  8941*         SET      (ADDRESS OF CONTROL-FILE)
  8942*    END-EXEC.
  8943*    MOVE '&"S        G          (   #00008429' TO DFHEIV0
  8944     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8945     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8946     MOVE X'2020233030303038343239' TO DFHEIV0(25:11)
  8947     CALL 'kxdfhei1' USING DFHEIV0,
  8948           CNTL-FILE-ID,
  8949           DFHEIV20,
  8950           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 162
* EL131.cbl
  8951           BENEFIT-KEY,
  8952           DFHEIV99,
  8953           DFHEIV99,
  8954           DFHEIV99
  8955     SET ADDRESS OF CONTROL-FILE TO
  8956         DFHEIV20
  8957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8958
  8959
  8960     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  8961        CF-RECORD-TYPE NOT = '5'
  8962         GO TO 1310-SET-ERROR.
  8963
  8964     MOVE ZERO                   TO COUNT-2.
  8965     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  8966     IF SCREEN-ERROR
  8967         GO TO 1310-SET-ERROR.
  8968
  8969 1310-SET-CODE-SWITCHES.
  8970     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  8971     MOVE AL-UANON               TO ACVCDA.
  8972     GO TO 1310-EXIT.
  8973
  8974 1310-SET-ERROR.
  8975     MOVE ER-0250                TO EMI-ERROR.
  8976     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8977     MOVE AL-UABON               TO ACVCDA.
  8978     MOVE 'X'                    TO ERROR-SWITCH.
  8979     MOVE -1                     TO ACVCDL.
  8980
  8981 1310-EXIT.
  8982     EXIT.
  8983
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 163
* EL131.cbl
  8985 1460-EDIT-CERT-NO.
  8986     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  8987     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  8988
  8989     IF WS-SAVE-CERT-NO = SPACES
  8990         MOVE ER-0203            TO EMI-ERROR
  8991         GO TO 1460-CERT-NO-ERROR.
  8992
  8993     IF WS-CERT-NO-PRIME = SPACES AND
  8994        WS-CERT-NO-SUFX GREATER THAN SPACE
  8995            MOVE ER-0210         TO EMI-ERROR
  8996            GO TO 1460-CERT-NO-ERROR.
  8997
  8998     MOVE 'X'                    TO UPDATE-SWITCH.
  8999     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9000     MOVE AL-UANON               TO CERTA.
  9001
  9002     IF SUFXL IS GREATER THAN 0
  9003         MOVE AL-UANON           TO SUFXA.
  9004
  9005     GO TO 1460-EXIT.
  9006
  9007 1460-CERT-NO-ERROR.
  9008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9009     MOVE AL-UABON               TO SUFXA.
  9010     MOVE AL-UABON               TO CERTA.
  9011     MOVE -1                     TO CERTL.
  9012     MOVE 'X'                    TO ERROR-SWITCH.
  9013
  9014 1460-EXIT.
  9015     EXIT.
  9016
  9017 1470-EDIT-EFF.
  9018     IF CERTEFFI = SPACES
  9019         GO TO 1470-DATE-ERROR.
  9020
  9021     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9022     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9023     IF DEEDIT-DATE = ZERO
  9024         GO TO 1470-DATE-ERROR.
  9025
  9026     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9027     MOVE '4'                    TO DC-OPTION-CODE.
  9028     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9029     IF NOT DATE-CONVERSION-ERROR
  9030         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9031         MOVE AL-UANON           TO CERTEFFA
  9032         MOVE 'X'                TO UPDATE-SWITCH
  9033         MOVE 'Y'                TO CERT-KEY-SWITCH
  9034         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9035         GO TO 1470-EXIT.
  9036
  9037 1470-DATE-ERROR.
  9038     MOVE ER-0215                TO EMI-ERROR.
  9039     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9040     MOVE AL-UABON               TO CERTEFFA.
  9041     MOVE -1                     TO CERTEFFL.
  9042     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 164
* EL131.cbl
  9043
  9044 1470-EXIT.
  9045     EXIT.
  9046
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 165
* EL131.cbl
  9048 1480-EDIT-ACCT.
  9049     IF CERTACTI = SPACES
  9050         MOVE ER-0232            TO EMI-ERROR
  9051         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9052         MOVE AL-UABON           TO CERTACTA
  9053         MOVE -1                 TO CERTACTL
  9054         MOVE 'X'                TO ERROR-SWITCH
  9055     ELSE
  9056         MOVE 'X'                TO UPDATE-SWITCH
  9057         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9058
  9059 1480-EXIT.
  9060     EXIT.
  9061
  9062 1490-EDIT-STATE.
  9063     IF CERTSTI = SPACES
  9064         MOVE ER-0233            TO EMI-ERROR
  9065         GO TO 1490-STATE-ERROR.
  9066
  9067     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9068     MOVE '3'                    TO CNTL-REC-TYPE.
  9069     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9070     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9071     MOVE ZERO                   TO CNTL-SEQ-NO.
  9072
  9073
  9074* EXEC CICS HANDLE CONDITION
  9075*         NOTFND (1490-STATE-NOTFND)
  9076*    END-EXEC.
  9077*    MOVE '"$I                   ! ( #00008548' TO DFHEIV0
  9078     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9080     MOVE X'2820233030303038353438' TO DFHEIV0(25:11)
  9081     CALL 'kxdfhei1' USING DFHEIV0
  9082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9083
  9084
  9085
  9086* EXEC CICS READ
  9087*         SET        (ADDRESS OF CONTROL-FILE)
  9088*         DATASET    ('ELCNTL')
  9089*         RIDFLD     (CNTL-KEY)
  9090*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9091*         GENERIC
  9092*    END-EXEC.
  9093     MOVE 'ELCNTL' TO DFHEIV1
  9094*    MOVE '&"S  KG    E          (   #00008552' TO DFHEIV0
  9095     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9097     MOVE X'2020233030303038353532' TO DFHEIV0(25:11)
  9098     CALL 'kxdfhei1' USING DFHEIV0,
  9099           DFHEIV1,
  9100           DFHEIV20,
  9101           DFHEIV99,
  9102           CNTL-KEY,
  9103           CNTL-GENERIC-LENGTH,
  9104           DFHEIV99,
  9105           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 166
* EL131.cbl
  9106     SET ADDRESS OF CONTROL-FILE TO
  9107         DFHEIV20
  9108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9109
  9110
  9111     MOVE AL-UANON               TO CERTSTA.
  9112     MOVE 'X'                    TO UPDATE-SWITCH.
  9113     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9114     GO TO 1490-EXIT.
  9115
  9116 1490-STATE-NOTFND.
  9117     MOVE ER-0149                TO EMI-ERROR.
  9118
  9119 1490-STATE-ERROR.
  9120     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9121     MOVE AL-UABON               TO CERTSTA.
  9122     MOVE -1                     TO CERTSTL.
  9123     MOVE 'X'                    TO ERROR-SWITCH.
  9124
  9125 1490-EXIT.
  9126     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 167
* EL131.cbl
  9128 1500-EDIT-CARR.
  9129     IF CERTCARI = SPACES
  9130         GO TO 1500-CARR-NOTFND.
  9131
  9132     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9133     MOVE '6'                    TO CNTL-REC-TYPE.
  9134     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9135     MOVE CERTCARI               TO CNTL-CARRIER.
  9136     MOVE ZERO                   TO CNTL-SEQ-NO.
  9137
  9138
  9139* EXEC CICS HANDLE CONDITION
  9140*         NOTFND   (1500-CARR-NOTFND)
  9141*    END-EXEC.
  9142*    MOVE '"$I                   ! ) #00008587' TO DFHEIV0
  9143     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9145     MOVE X'2920233030303038353837' TO DFHEIV0(25:11)
  9146     CALL 'kxdfhei1' USING DFHEIV0
  9147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9148
  9149
  9150
  9151* EXEC CICS READ
  9152*         SET        (ADDRESS OF CONTROL-FILE)
  9153*         DATASET    ('ELCNTL')
  9154*         RIDFLD     (CNTL-KEY)
  9155*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9156*         GENERIC
  9157*    END-EXEC.
  9158     MOVE 'ELCNTL' TO DFHEIV1
  9159*    MOVE '&"S  KG    E          (   #00008591' TO DFHEIV0
  9160     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9162     MOVE X'2020233030303038353931' TO DFHEIV0(25:11)
  9163     CALL 'kxdfhei1' USING DFHEIV0,
  9164           DFHEIV1,
  9165           DFHEIV20,
  9166           DFHEIV99,
  9167           CNTL-KEY,
  9168           CNTL-GENERIC-LENGTH,
  9169           DFHEIV99,
  9170           DFHEIV99
  9171     SET ADDRESS OF CONTROL-FILE TO
  9172         DFHEIV20
  9173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9174
  9175
  9176     MOVE AL-UANON               TO CERTCARA.
  9177     MOVE 'X'                    TO UPDATE-SWITCH.
  9178     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9179     GO TO 1500-EXIT.
  9180
  9181 1500-CARR-NOTFND.
  9182     MOVE ER-0360                TO EMI-ERROR.
  9183     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9184     MOVE AL-UABON               TO CERTCARA.
  9185     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 168
* EL131.cbl
  9186     MOVE 'X'                    TO ERROR-SWITCH.
  9187
  9188 1500-EXIT.
  9189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 169
* EL131.cbl
  9191 1510-DEEDIT-DATE.
  9192
  9193* EXEC CICS BIF DEEDIT
  9194*         FIELD    (DEEDIT-DATE-INPUT)
  9195*         LENGTH   (DATE-LENGTH)
  9196*    END-EXEC.
  9197*    MOVE '@"L                   #   #00008615' TO DFHEIV0
  9198     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9199     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9200     MOVE X'2020233030303038363135' TO DFHEIV0(25:11)
  9201     CALL 'kxdfhei1' USING DFHEIV0,
  9202           DEEDIT-DATE-INPUT,
  9203           DATE-LENGTH
  9204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9205
  9206
  9207 1510-EXIT.
  9208     EXIT.
  9209
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 170
* EL131.cbl
  9211 1620-VERIFY-ACCT.
  9212
  9213     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9214     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9215     MOVE PI-GROUPING            TO ACCT-GROUP.
  9216     MOVE PI-STATE               TO ACCT-STATE.
  9217     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9218
  9219     IF CERTEFFI GREATER THAN LOW-VALUES
  9220         MOVE HOLD-EFF           TO ACCT-DATE
  9221     ELSE
  9222         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9223
  9224     IF CERTACTI GREATER THAN LOW-VALUES
  9225         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9226     IF CERTSTI GREATER THAN LOW-VALUES
  9227         MOVE CERTSTI            TO  ACCT-STATE.
  9228     IF CERTCARI GREATER THAN LOW-VALUES
  9229         MOVE CERTCARI           TO  ACCT-CARRIER.
  9230     IF CERTGRPI GREATER THAN LOW-VALUES
  9231         MOVE CERTGRPI           TO ACCT-GROUP.
  9232
  9233     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9234
  9235
  9236* EXEC CICS HANDLE CONDITION
  9237*         NOTFND  (1620-ACCT-NOTFND)
  9238*    END-EXEC.
  9239*    MOVE '"$I                   ! * #00008648' TO DFHEIV0
  9240     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9242     MOVE X'2A20233030303038363438' TO DFHEIV0(25:11)
  9243     CALL 'kxdfhei1' USING DFHEIV0
  9244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9245
  9246
  9247
  9248* EXEC CICS STARTBR
  9249*         DATASET   (ACCT-FILE-ID)
  9250*         RIDFLD    (ACCT-KEY)
  9251*    END-EXEC.
  9252     MOVE 0
  9253       TO DFHEIV11
  9254*    MOVE '&,         G          &   #00008652' TO DFHEIV0
  9255     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9256     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9257     MOVE X'2020233030303038363532' TO DFHEIV0(25:11)
  9258     CALL 'kxdfhei1' USING DFHEIV0,
  9259           ACCT-FILE-ID,
  9260           ACCT-KEY,
  9261           DFHEIV99,
  9262           DFHEIV11,
  9263           DFHEIV99
  9264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9265
  9266
  9267 1620-ACCT-LOOP.
  9268
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 171
* EL131.cbl
  9269
  9270* EXEC CICS READNEXT
  9271*         DATASET  (ACCT-FILE-ID)
  9272*         RIDFLD   (ACCT-KEY)
  9273*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9274*    END-EXEC.
  9275     MOVE 0
  9276       TO DFHEIV11
  9277*    MOVE '&.S                   )   #00008659' TO DFHEIV0
  9278     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9279     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9280     MOVE X'2020233030303038363539' TO DFHEIV0(25:11)
  9281     CALL 'kxdfhei1' USING DFHEIV0,
  9282           ACCT-FILE-ID,
  9283           DFHEIV20,
  9284           DFHEIV99,
  9285           ACCT-KEY,
  9286           DFHEIV99,
  9287           DFHEIV11,
  9288           DFHEIV99,
  9289           DFHEIV99
  9290     SET ADDRESS OF ACCOUNT-MASTER TO
  9291         DFHEIV20
  9292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9293
  9294
  9295     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9296         GO TO 1620-ACCT-NOTFND.
  9297
  9298     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9299        HOLD-EFF     LESS AM-EXPIRATION-DT
  9300         NEXT SENTENCE
  9301     ELSE
  9302         GO TO 1620-ACCT-LOOP.
  9303
  9304     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9305         GO TO 1620-ACCT-END-BROWSE.
  9306
  9307     IF LOANBALL GREATER THAN +0
  9308         IF AM-MAX-TOT-BEN NUMERIC  AND
  9309            AM-MAX-TOT-BEN GREATER THAN ZERO
  9310             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9311                 MOVE AL-UNBON     TO LOANBALA
  9312                 MOVE -1           TO LOANBALL
  9313                 MOVE 'X'          TO ERROR-SWITCH
  9314                 MOVE ER-7641      TO EMI-ERROR
  9315                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9316
  9317     IF ACVBENEL GREATER THAN +0
  9318         IF AM-MAX-MON-BEN NUMERIC  AND
  9319            AM-MAX-MON-BEN GREATER THAN ZERO
  9320             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9321                 MOVE AL-UNBON     TO ACVBENEA
  9322                 MOVE -1           TO ACVBENEL
  9323                 MOVE 'X'          TO ERROR-SWITCH
  9324                 MOVE ER-7642      TO EMI-ERROR
  9325                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9326
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 172
* EL131.cbl
  9327 1620-ACCT-END-BROWSE.
  9328
  9329
  9330* EXEC CICS ENDBR
  9331*         DATASET (ACCT-FILE-ID)
  9332*    END-EXEC.
  9333     MOVE 0
  9334       TO DFHEIV11
  9335*    MOVE '&2                    $   #00008699' TO DFHEIV0
  9336     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9337     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9338     MOVE X'2020233030303038363939' TO DFHEIV0(25:11)
  9339     CALL 'kxdfhei1' USING DFHEIV0,
  9340           ACCT-FILE-ID,
  9341           DFHEIV11,
  9342           DFHEIV99
  9343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9344
  9345
  9346     GO TO 1620-EXIT.
  9347
  9348 1620-ACCT-NOTFND.
  9349
  9350     MOVE -1                     TO MAINTL.
  9351     MOVE 'X'                    TO ERROR-SWITCH.
  9352     MOVE ER-0426                TO EMI-ERROR.
  9353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9354
  9355 1620-EXIT.
  9356     EXIT.
  9357
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 173
* EL131.cbl
  9359 2000-UPDATE-CLAIM.
  9360
  9361     MOVE SPACES                 TO ERROR-SWITCH.
  9362     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9363     MOVE PI-CARRIER             TO CARRIER-CODE.
  9364     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9365     MOVE PI-CERT-NO             TO CERT-NO.
  9366
  9367     IF DELETE-CLAIM
  9368         GO TO 3000-DELETE-CLAIM.
  9369
  9370     IF  NOT MODIFY-CAP
  9371         MOVE ER-0070            TO EMI-ERROR
  9372         MOVE 'X'                TO ERROR-SWITCH
  9373         MOVE -1                 TO MAINTL
  9374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9375         GO TO 2000-EXIT.
  9376
  9377     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9378     MOVE ZERO                   TO TRLR-SEQ-NO.
  9379
  9380
  9381* EXEC CICS READ UPDATE
  9382*         SET       (ADDRESS OF CLAIM-MASTER)
  9383*         DATASET   (CLMS-FILE-ID)
  9384*         RIDFLD    (MSTR-KEY)
  9385*    END-EXEC.
  9386*    MOVE '&"S        EU         (   #00008737' TO DFHEIV0
  9387     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9388     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9389     MOVE X'2020233030303038373337' TO DFHEIV0(25:11)
  9390     CALL 'kxdfhei1' USING DFHEIV0,
  9391           CLMS-FILE-ID,
  9392           DFHEIV20,
  9393           DFHEIV99,
  9394           MSTR-KEY,
  9395           DFHEIV99,
  9396           DFHEIV99,
  9397           DFHEIV99
  9398     SET ADDRESS OF CLAIM-MASTER TO
  9399         DFHEIV20
  9400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9401
  9402
  9403     if (cl-priority-cd = '8')
  9404        and (pi-processor-id not = 'PEMA' and 'JMS '
  9405             AND 'AMWA')
  9406        MOVE ER-8003             TO EMI-ERROR
  9407        PERFORM 9900-ERROR-FORMAT
  9408                                 THRU 9900-EXIT
  9409        MOVE -1                  TO MAINTL
  9410        GO TO 8110-SEND-DATA
  9411     end-if
  9412
  9413     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9414         MOVE ER-0068            TO EMI-ERROR
  9415         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9416         GO TO 2000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 174
* EL131.cbl
  9417
  9418     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9419         MOVE ER-0068            TO EMI-ERROR
  9420         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9421         GO TO 2000-EXIT.
  9422
  9423     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9424         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9425
  9426     IF CL-PURGED-DT NOT = LOW-VALUES
  9427         MOVE ER-7691            TO EMI-ERROR
  9428         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9429         GO TO 2000-EXIT.
  9430
  9431     IF CERT-KEY-CHANGED
  9432         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9433
  9434     IF SCREEN-ERROR
  9435         MOVE ER-0068            TO EMI-ERROR
  9436         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9437         GO TO 2000-EXIT.
  9438
  9439     IF NINETY-TRLR-UPDATED
  9440         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9441
  9442     IF MSTR-KEY-CHANGED
  9443         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9444        ELSE
  9445         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9446
  9447     IF TRLR-UPDATE-REQUIRED
  9448         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9449
  9450 2000-CHECK-CERT.
  9451     IF NOT CERT-UPDATES
  9452         GO TO 2000-EXIT.
  9453
  9454     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9455     MOVE PI-CARRIER             TO CERT-CARRIER.
  9456     MOVE PI-GROUPING            TO CERT-GROUP.
  9457     MOVE PI-STATE               TO CERT-STATE.
  9458     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9459     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9460     MOVE PI-CERT-NO             TO CERT-CERT.
  9461
  9462     IF CERT-ALT-KEY-CHANGED
  9463         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9464     ELSE
  9465         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9466
  9467 2000-EXIT.
  9468     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 175
* EL131.cbl
  9470 2010-RELEASE-REC.
  9471
  9472* EXEC CICS UNLOCK
  9473*         DATASET  (CLMS-FILE-ID)
  9474*    END-EXEC
  9475*    MOVE '&*                    #   #00008811' TO DFHEIV0
  9476     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9477     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9478     MOVE X'2020233030303038383131' TO DFHEIV0(25:11)
  9479     CALL 'kxdfhei1' USING DFHEIV0,
  9480           CLMS-FILE-ID,
  9481           DFHEIV99
  9482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9483
  9484     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9485     MOVE 'X'                    TO ERROR-SWITCH.
  9486
  9487 2010-EXIT.
  9488     EXIT.
  9489
  9490 2020-NORMAL-UPDATE.
  9491     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9492
  9493     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9494
  9495     IF WS-OPEN-CLOSE-SW = 'Y'
  9496       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9497       IF PI-REC-FOUND-SW = 'Y'
  9498         IF CL-ACTIVITY-CODE = 09
  9499           NEXT SENTENCE
  9500         ELSE
  9501           IF WS-RESET-SW = 'Y'
  9502             IF CL-CLAIM-STATUS = 'C'
  9503               MOVE 07               TO  CL-ACTIVITY-CODE
  9504               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9505               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
  9506             ELSE
  9507               MOVE 08               TO  CL-ACTIVITY-CODE
  9508               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9509               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
  9510
  9511     IF PI-COMPANY-ID = 'CID'
  9512         MOVE 'Y'                TO CL-YESNOSW
  9513     END-IF.
  9514
  9515
  9516* EXEC CICS HANDLE CONDITION
  9517*         DUPKEY   (2020-EXIT)
  9518*    END-EXEC.
  9519*    MOVE '"$$                   ! + #00008846' TO DFHEIV0
  9520     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9522     MOVE X'2B20233030303038383436' TO DFHEIV0(25:11)
  9523     CALL 'kxdfhei1' USING DFHEIV0
  9524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9525
  9526
  9527
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 176
* EL131.cbl
  9528* EXEC CICS REWRITE
  9529*         DATASET   (CLMS-FILE-ID)
  9530*         FROM      (CLAIM-MASTER)
  9531*    END-EXEC.
  9532     MOVE LENGTH OF
  9533      CLAIM-MASTER
  9534       TO DFHEIV11
  9535*    MOVE '&& L                  %   #00008850' TO DFHEIV0
  9536     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9537     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9538     MOVE X'2020233030303038383530' TO DFHEIV0(25:11)
  9539     CALL 'kxdfhei1' USING DFHEIV0,
  9540           CLMS-FILE-ID,
  9541           CLAIM-MASTER,
  9542           DFHEIV11,
  9543           DFHEIV99
  9544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9545
  9546
  9547 2020-EXIT.
  9548     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 177
* EL131.cbl
  9550 2030-KEY-UPDATE.
  9551     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
  9552
  9553
  9554* EXEC CICS DELETE
  9555*        DATASET  (CLMS-FILE-ID)
  9556*    END-EXEC.
  9557*    MOVE '&(                    &   #00008861' TO DFHEIV0
  9558     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9559     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9560     MOVE X'2020233030303038383631' TO DFHEIV0(25:11)
  9561     CALL 'kxdfhei1' USING DFHEIV0,
  9562           CLMS-FILE-ID,
  9563           DFHEIV99,
  9564           DFHEIV99,
  9565           DFHEIV99,
  9566           DFHEIV99
  9567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9568
  9569
  9570
  9571* EXEC CICS GETMAIN
  9572*         SET      (ADDRESS OF CLAIM-MASTER)
  9573*         LENGTH   (MSTR-LENGTH)
  9574*         INITIMG  (GETMAIN-SPACE)
  9575*    END-EXEC.
  9576*    MOVE ',"IL                  $   #00008865' TO DFHEIV0
  9577     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9578     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9579     MOVE X'2020233030303038383635' TO DFHEIV0(25:11)
  9580     CALL 'kxdfhei1' USING DFHEIV0,
  9581           DFHEIV20,
  9582           MSTR-LENGTH,
  9583           GETMAIN-SPACE
  9584     SET ADDRESS OF CLAIM-MASTER TO
  9585         DFHEIV20
  9586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9587
  9588
  9589     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
  9590
  9591     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9592
  9593     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9594
  9595     IF WS-OPEN-CLOSE-SW = 'Y'
  9596       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9597         IF PI-REC-FOUND-SW = 'Y'
  9598           IF CL-ACTIVITY-CODE = 09
  9599             NEXT SENTENCE
  9600           ELSE
  9601             IF WS-RESET-SW = 'Y'
  9602               IF CL-CLAIM-STATUS = 'C'
  9603                 MOVE 07             TO  CL-ACTIVITY-CODE
  9604                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9605                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
  9606               ELSE
  9607                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 178
* EL131.cbl
  9608                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9609                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
  9610
  9611
  9612* EXEC CICS HANDLE CONDITION
  9613*         DUPKEY    (2030-EXIT)
  9614*    END-EXEC.
  9615*    MOVE '"$$                   ! , #00008893' TO DFHEIV0
  9616     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9618     MOVE X'2C20233030303038383933' TO DFHEIV0(25:11)
  9619     CALL 'kxdfhei1' USING DFHEIV0
  9620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9621
  9622
  9623** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
  9624*    MOVE CL-CERT-NO             TO CL-CCN-A5.
  9625
  9626     IF PI-COMPANY-ID = 'CID'
  9627         MOVE 'Y'                TO CL-YESNOSW
  9628     END-IF.
  9629
  9630
  9631* EXEC CICS WRITE
  9632*         DATASET   (CLMS-FILE-ID)
  9633*         RIDFLD    (MSTR-KEY)
  9634*         FROM      (CLAIM-MASTER)
  9635*    END-EXEC.
  9636     MOVE LENGTH OF
  9637      CLAIM-MASTER
  9638       TO DFHEIV11
  9639*    MOVE '&$ L                  ''   #00008904' TO DFHEIV0
  9640     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9641     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9642     MOVE X'2020233030303038393034' TO DFHEIV0(25:11)
  9643     CALL 'kxdfhei1' USING DFHEIV0,
  9644           CLMS-FILE-ID,
  9645           CLAIM-MASTER,
  9646           DFHEIV11,
  9647           MSTR-KEY,
  9648           DFHEIV99,
  9649           DFHEIV99
  9650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9651
  9652
  9653 2030-EXIT.
  9654     EXIT.
  9655
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 179
* EL131.cbl
  9657 2040-NORMAL-UPDATE.
  9658
  9659* EXEC CICS READ UPDATE
  9660*         DATASET  (CERT-FILE-ID)
  9661*         RIDFLD   (CERT-KEY)
  9662*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9663*    END-EXEC.
  9664*    MOVE '&"S        EU         (   #00008915' TO DFHEIV0
  9665     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9666     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9667     MOVE X'2020233030303038393135' TO DFHEIV0(25:11)
  9668     CALL 'kxdfhei1' USING DFHEIV0,
  9669           CERT-FILE-ID,
  9670           DFHEIV20,
  9671           DFHEIV99,
  9672           CERT-KEY,
  9673           DFHEIV99,
  9674           DFHEIV99,
  9675           DFHEIV99
  9676     SET ADDRESS OF CERTIFICATE-MASTER TO
  9677         DFHEIV20
  9678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9679
  9680
  9681     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9682
  9683
  9684* EXEC CICS HANDLE CONDITION
  9685*         DUPKEY   (2040-EXIT)
  9686*    END-EXEC.
  9687*    MOVE '"$$                   ! - #00008923' TO DFHEIV0
  9688     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9690     MOVE X'2D20233030303038393233' TO DFHEIV0(25:11)
  9691     CALL 'kxdfhei1' USING DFHEIV0
  9692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9693
  9694
  9695
  9696* EXEC CICS REWRITE
  9697*         DATASET  (CERT-FILE-ID)
  9698*         FROM     (CERTIFICATE-MASTER)
  9699*    END-EXEC.
  9700     MOVE LENGTH OF
  9701      CERTIFICATE-MASTER
  9702       TO DFHEIV11
  9703*    MOVE '&& L                  %   #00008927' TO DFHEIV0
  9704     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9705     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9706     MOVE X'2020233030303038393237' TO DFHEIV0(25:11)
  9707     CALL 'kxdfhei1' USING DFHEIV0,
  9708           CERT-FILE-ID,
  9709           CERTIFICATE-MASTER,
  9710           DFHEIV11,
  9711           DFHEIV99
  9712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9713
  9714
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 180
* EL131.cbl
  9715 2040-EXIT.
  9716     EXIT.
  9717
  9718 2050-KEY-UPDATE.
  9719
  9720* EXEC CICS READ UPDATE
  9721*         DATASET  (CERT-FILE-ID)
  9722*         RIDFLD   (CERT-KEY)
  9723*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9724*    END-EXEC.
  9725*    MOVE '&"S        EU         (   #00008936' TO DFHEIV0
  9726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9727     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9728     MOVE X'2020233030303038393336' TO DFHEIV0(25:11)
  9729     CALL 'kxdfhei1' USING DFHEIV0,
  9730           CERT-FILE-ID,
  9731           DFHEIV20,
  9732           DFHEIV99,
  9733           CERT-KEY,
  9734           DFHEIV99,
  9735           DFHEIV99,
  9736           DFHEIV99
  9737     SET ADDRESS OF CERTIFICATE-MASTER TO
  9738         DFHEIV20
  9739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9740
  9741
  9742     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
  9743
  9744
  9745* EXEC CICS DELETE
  9746*         DATASET   (CERT-FILE-ID)
  9747*    END-EXEC.
  9748*    MOVE '&(                    &   #00008944' TO DFHEIV0
  9749     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9751     MOVE X'2020233030303038393434' TO DFHEIV0(25:11)
  9752     CALL 'kxdfhei1' USING DFHEIV0,
  9753           CERT-FILE-ID,
  9754           DFHEIV99,
  9755           DFHEIV99,
  9756           DFHEIV99,
  9757           DFHEIV99
  9758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9759
  9760
  9761
  9762* EXEC CICS GETMAIN
  9763*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9764*         LENGTH    (CERT-LENGTH)
  9765*         INITIMG   (GETMAIN-SPACE)
  9766*    END-EXEC.
  9767*    MOVE ',"IL                  $   #00008948' TO DFHEIV0
  9768     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9769     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9770     MOVE X'2020233030303038393438' TO DFHEIV0(25:11)
  9771     CALL 'kxdfhei1' USING DFHEIV0,
  9772           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 181
* EL131.cbl
  9773           CERT-LENGTH,
  9774           GETMAIN-SPACE
  9775     SET ADDRESS OF CERTIFICATE-MASTER TO
  9776         DFHEIV20
  9777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9778
  9779
  9780     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
  9781
  9782     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9783
  9784
  9785* EXEC CICS HANDLE CONDITION
  9786*         DUPKEY (2050-EXIT)
  9787*    END-EXEC.
  9788*    MOVE '"$$                   ! . #00008958' TO DFHEIV0
  9789     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9791     MOVE X'2E20233030303038393538' TO DFHEIV0(25:11)
  9792     CALL 'kxdfhei1' USING DFHEIV0
  9793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9794
  9795
  9796
  9797* EXEC CICS WRITE
  9798*         DATASET  (CERT-FILE-ID)
  9799*         RIDFLD   (CERT-KEY)
  9800*         FROM     (CERTIFICATE-MASTER)
  9801*    END-EXEC.
  9802     MOVE LENGTH OF
  9803      CERTIFICATE-MASTER
  9804       TO DFHEIV11
  9805*    MOVE '&$ L                  ''   #00008962' TO DFHEIV0
  9806     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9807     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9808     MOVE X'2020233030303038393632' TO DFHEIV0(25:11)
  9809     CALL 'kxdfhei1' USING DFHEIV0,
  9810           CERT-FILE-ID,
  9811           CERTIFICATE-MASTER,
  9812           DFHEIV11,
  9813           CERT-KEY,
  9814           DFHEIV99,
  9815           DFHEIV99
  9816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9817
  9818
  9819 2050-EXIT.
  9820     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 182
* EL131.cbl
  9822 2060-CHANGE-CERT.
  9823     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9824     MOVE PI-CARRIER             TO CERT-CARRIER.
  9825     MOVE PI-GROUPING            TO CERT-GROUP.
  9826     MOVE PI-STATE               TO CERT-STATE.
  9827     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9828     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9829     MOVE PI-CERT-NO             TO CERT-CERT.
  9830     IF CERTEFFI GREATER THAN LOW-VALUES
  9831         MOVE HOLD-EFF           TO CERT-DATE.
  9832     IF CERTACTI GREATER THAN LOW-VALUES
  9833         MOVE CERTACTI           TO CERT-ACCOUNT.
  9834     IF CERTSTI GREATER THAN LOW-VALUES
  9835         MOVE CERTSTI            TO CERT-STATE.
  9836     IF CERTCARI GREATER THAN LOW-VALUES
  9837         MOVE CERTCARI           TO CERT-CARRIER.
  9838     IF CERTGRPI GREATER THAN LOW-VALUES
  9839         MOVE CERTGRPI           TO CERT-GROUP.
  9840     IF CERTI GREATER THAN LOW-VALUES
  9841         MOVE CERTI              TO CERT-CERT-PRIME.
  9842     IF SUFXI GREATER THAN LOW-VALUES
  9843         MOVE SUFXI              TO CERT-CERT-SUFX.
  9844
  9845
  9846* EXEC CICS HANDLE CONDITION
  9847*         NOTFND   (2060-CERT-NOTFND)
  9848*    END-EXEC.
  9849*    MOVE '"$I                   ! / #00008994' TO DFHEIV0
  9850     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9852     MOVE X'2F20233030303038393934' TO DFHEIV0(25:11)
  9853     CALL 'kxdfhei1' USING DFHEIV0
  9854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9855
  9856
  9857
  9858* EXEC CICS READ UPDATE
  9859*         DATASET  (CERT-FILE-ID)
  9860*         RIDFLD   (CERT-KEY)
  9861*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9862*    END-EXEC.
  9863*    MOVE '&"S        EU         (   #00008998' TO DFHEIV0
  9864     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9865     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9866     MOVE X'2020233030303038393938' TO DFHEIV0(25:11)
  9867     CALL 'kxdfhei1' USING DFHEIV0,
  9868           CERT-FILE-ID,
  9869           DFHEIV20,
  9870           DFHEIV99,
  9871           CERT-KEY,
  9872           DFHEIV99,
  9873           DFHEIV99,
  9874           DFHEIV99
  9875     SET ADDRESS OF CERTIFICATE-MASTER TO
  9876         DFHEIV20
  9877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9878
  9879
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 183
* EL131.cbl
  9880     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
  9881
  9882     IF CM-CLAIM-INTERFACE-SW = SPACES
  9883        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
  9884
  9885
  9886* EXEC CICS HANDLE CONDITION
  9887*         DUPKEY   (2060-DUPKEY)
  9888*    END-EXEC.
  9889*    MOVE '"$$                   ! 0 #00009009' TO DFHEIV0
  9890     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9892     MOVE X'3020233030303039303039' TO DFHEIV0(25:11)
  9893     CALL 'kxdfhei1' USING DFHEIV0
  9894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9895
  9896
  9897
  9898* EXEC CICS REWRITE
  9899*         DATASET  (CERT-FILE-ID)
  9900*         FROM     (CERTIFICATE-MASTER)
  9901*    END-EXEC.
  9902     MOVE LENGTH OF
  9903      CERTIFICATE-MASTER
  9904       TO DFHEIV11
  9905*    MOVE '&& L                  %   #00009013' TO DFHEIV0
  9906     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9907     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9908     MOVE X'2020233030303039303133' TO DFHEIV0(25:11)
  9909     CALL 'kxdfhei1' USING DFHEIV0,
  9910           CERT-FILE-ID,
  9911           CERTIFICATE-MASTER,
  9912           DFHEIV11,
  9913           DFHEIV99
  9914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9915
  9916
  9917 2060-DUPKEY.
  9918
  9919     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
  9920
  9921 2060-CHANGE-TRLR-ACTQ.
  9922     IF SCREEN-ERROR
  9923         GO TO 2060-EXIT.
  9924
  9925     IF CERTI    GREATER LOW-VALUES OR
  9926        SUFXI    GREATER LOW-VALUES OR
  9927        CERTCARI GREATER LOW-VALUES
  9928         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
  9929         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
  9930
  9931     MOVE SPACES                 TO CERT-KEY-SWITCH
  9932                                    CERT-SWITCH
  9933                                    TRLR-SWITCH
  9934                                    NINETY-TRLR-SWITCH.
  9935     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
  9936     GO TO 2060-EXIT.
  9937
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 184
* EL131.cbl
  9938 2060-CERT-NOTFND.
  9939     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
  9940
  9941     IF WS-REC-FOUND-SW = 'N'
  9942         MOVE ER-0206            TO  EMI-ERROR
  9943         MOVE -1                 TO  MAINTL
  9944         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9945
  9946* EXEC CICS UNLOCK
  9947*            DATASET   (CLMS-FILE-ID)
  9948*        END-EXEC
  9949*    MOVE '&*                    #   #00009046' TO DFHEIV0
  9950     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9951     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9952     MOVE X'2020233030303039303436' TO DFHEIV0(25:11)
  9953     CALL 'kxdfhei1' USING DFHEIV0,
  9954           CLMS-FILE-ID,
  9955           DFHEIV99
  9956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9957         GO TO 8110-SEND-DATA.
  9958
  9959     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
  9960
  9961     GO TO 2060-CHANGE-TRLR-ACTQ.
  9962
  9963 2060-EXIT.
  9964     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 185
* EL131.cbl
  9966 2070-CHECK-OLD.
  9967
  9968
  9969* EXEC CICS HANDLE CONDITION
  9970*        NOTFND   (2070-NOT-FOUND)
  9971*    END-EXEC.
  9972*    MOVE '"$I                   ! 1 #00009060' TO DFHEIV0
  9973     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9975     MOVE X'3120233030303039303630' TO DFHEIV0(25:11)
  9976     CALL 'kxdfhei1' USING DFHEIV0
  9977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9978
  9979
  9980     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9981     MOVE PI-CARRIER             TO CERT-CARRIER.
  9982     MOVE PI-GROUPING            TO CERT-GROUP.
  9983     MOVE PI-STATE               TO CERT-STATE.
  9984     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9985     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9986     MOVE PI-CERT-NO             TO CERT-CERT.
  9987
  9988
  9989* EXEC CICS READ UPDATE
  9990*         DATASET  (CERT-FILE-ID)
  9991*         RIDFLD   (CERT-KEY)
  9992*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9993*    END-EXEC.
  9994*    MOVE '&"S        EU         (   #00009072' TO DFHEIV0
  9995     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9996     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9997     MOVE X'2020233030303039303732' TO DFHEIV0(25:11)
  9998     CALL 'kxdfhei1' USING DFHEIV0,
  9999           CERT-FILE-ID,
 10000           DFHEIV20,
 10001           DFHEIV99,
 10002           CERT-KEY,
 10003           DFHEIV99,
 10004           DFHEIV99,
 10005           DFHEIV99
 10006     SET ADDRESS OF CERTIFICATE-MASTER TO
 10007         DFHEIV20
 10008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10009
 10010
 10011     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10012     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10013     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10014
 10015     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10016         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10017
 10018     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10019       AND
 10020        CERT-WAS-CREATED-FOR-CLAIM
 10021         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10022
 10023* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 186
* EL131.cbl
 10024*             DATASET   (CERT-FILE-ID)
 10025*        END-EXEC
 10026*    MOVE '&(                    &   #00009089' TO DFHEIV0
 10027     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10028     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10029     MOVE X'2020233030303039303839' TO DFHEIV0(25:11)
 10030     CALL 'kxdfhei1' USING DFHEIV0,
 10031           CERT-FILE-ID,
 10032           DFHEIV99,
 10033           DFHEIV99,
 10034           DFHEIV99,
 10035           DFHEIV99
 10036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10037         GO TO 2070-EXIT.
 10038
 10039     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10040         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10041
 10042
 10043* EXEC CICS HANDLE CONDITION
 10044*         DUPKEY   (2070-EXIT)
 10045*    END-EXEC.
 10046*    MOVE '"$$                   ! 2 #00009097' TO DFHEIV0
 10047     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10049     MOVE X'3220233030303039303937' TO DFHEIV0(25:11)
 10050     CALL 'kxdfhei1' USING DFHEIV0
 10051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10052
 10053
 10054
 10055* EXEC CICS REWRITE
 10056*         DATASET  (CERT-FILE-ID)
 10057*         FROM     (CERTIFICATE-MASTER)
 10058*    END-EXEC.
 10059     MOVE LENGTH OF
 10060      CERTIFICATE-MASTER
 10061       TO DFHEIV11
 10062*    MOVE '&& L                  %   #00009101' TO DFHEIV0
 10063     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10064     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10065     MOVE X'2020233030303039313031' TO DFHEIV0(25:11)
 10066     CALL 'kxdfhei1' USING DFHEIV0,
 10067           CERT-FILE-ID,
 10068           CERTIFICATE-MASTER,
 10069           DFHEIV11,
 10070           DFHEIV99
 10071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10072
 10073
 10074     GO TO 2070-EXIT.
 10075
 10076 2070-NOT-FOUND.
 10077     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10078
 10079 2070-EXIT.
 10080     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 187
* EL131.cbl
 10082 2080-CREATE-CERT.
 10083
 10084* EXEC CICS GETMAIN
 10085*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10086*         LENGTH    (CERT-LENGTH)
 10087*         INITIMG   (GETMAIN-SPACE)
 10088*    END-EXEC.
 10089*    MOVE ',"IL                  $   #00009115' TO DFHEIV0
 10090     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10091     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10092     MOVE X'2020233030303039313135' TO DFHEIV0(25:11)
 10093     CALL 'kxdfhei1' USING DFHEIV0,
 10094           DFHEIV20,
 10095           CERT-LENGTH,
 10096           GETMAIN-SPACE
 10097     SET ADDRESS OF CERTIFICATE-MASTER TO
 10098         DFHEIV20
 10099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10100
 10101
 10102     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10103
 10104     IF CERTEFFI GREATER THAN LOW-VALUES
 10105         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10106                                    DC-BIN-DATE-1
 10107         MOVE '6'                TO DC-OPTION-CODE
 10108         MOVE +1                 TO DC-ELAPSED-MONTHS
 10109         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10110         IF NO-CONVERSION-ERROR
 10111             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10112
 10113     IF CERTACTI GREATER THAN LOW-VALUES
 10114         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10115     IF CERTSTI GREATER THAN LOW-VALUES
 10116         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10117     IF CERTCARI GREATER THAN LOW-VALUES
 10118         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10119     IF CERTGRPI GREATER THAN LOW-VALUES
 10120         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10121     IF CERTI GREATER THAN LOW-VALUES
 10122         MOVE CERTI              TO CERT-CERT-PRIME
 10123                                    CM-CERT-PRIME
 10124         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10125
 10126     IF SUFXI GREATER THAN LOW-VALUES
 10127         MOVE SUFXI              TO CERT-CERT-SUFX
 10128                                    CM-CERT-SFX
 10129         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10130
 10131     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10132
 10133     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10134
 10135     MOVE SPACES                 TO CM-ENTRY-BATCH
 10136                                    CM-LF-EXIT-BATCH
 10137                                    CM-AH-EXIT-BATCH
 10138                                    CM-CREDIT-INTERFACE-SW-1
 10139                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 188
* EL131.cbl
 10140
 10141     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10142                               '9' OR 'D' OR 'V'
 10143         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10144
 10145     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10146                               '9' OR 'D' OR 'V'
 10147         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10148
 10149     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10150                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10151     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10152
 10153
 10154* EXEC CICS HANDLE CONDITION
 10155*         DUPKEY (2080-EXIT)
 10156*    END-EXEC.
 10157*    MOVE '"$$                   ! 3 #00009172' TO DFHEIV0
 10158     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10160     MOVE X'3320233030303039313732' TO DFHEIV0(25:11)
 10161     CALL 'kxdfhei1' USING DFHEIV0
 10162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10163
 10164
 10165
 10166* EXEC CICS WRITE
 10167*         DATASET  (CERT-FILE-ID)
 10168*         RIDFLD   (CERT-KEY)
 10169*         FROM     (CERTIFICATE-MASTER)
 10170*    END-EXEC.
 10171     MOVE LENGTH OF
 10172      CERTIFICATE-MASTER
 10173       TO DFHEIV11
 10174*    MOVE '&$ L                  ''   #00009176' TO DFHEIV0
 10175     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10176     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10177     MOVE X'2020233030303039313736' TO DFHEIV0(25:11)
 10178     CALL 'kxdfhei1' USING DFHEIV0,
 10179           CERT-FILE-ID,
 10180           CERTIFICATE-MASTER,
 10181           DFHEIV11,
 10182           CERT-KEY,
 10183           DFHEIV99,
 10184           DFHEIV99
 10185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10186
 10187
 10188 2080-EXIT.
 10189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 189
* EL131.cbl
 10191 2100-MOVE-MSTR.
 10192     IF TYPEI GREATER THAN LOW-VALUES
 10193         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10194
 10195     IF STATUSI = LOW-VALUES
 10196         GO TO 2100-NO-STATUS-CHANGE.
 10197
 10198     IF STATUSI = 'OPEN' OR 'O'
 10199         IF CL-CLAIM-STATUS = 'O'
 10200             MOVE SPACES         TO TRLR-SWITCH
 10201                 GO TO 2100-NO-STATUS-CHANGE.
 10202
 10203     IF STATUSI = 'CLOSED' OR 'C'
 10204         IF CL-CLAIM-STATUS = 'C'
 10205             MOVE SPACES         TO TRLR-SWITCH
 10206                 GO TO 2100-NO-STATUS-CHANGE.
 10207
 10208     IF PI-COMPANY-ID = 'DMD'
 10209        IF STATUSI = 'OPEN' OR 'O'
 10210           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10211              MOVE ZERO       TO STATUSL
 10212              MOVE LOW-VALUES TO STATUSI
 10213              GO TO 2100-NO-STATUS-CHANGE.
 10214
 10215     IF PI-COMPANY-ID = 'DMD'
 10216         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10217
 10218     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10219
 10220 2100-NO-STATUS-CHANGE.
 10221
 10222     IF CCNOI GREATER THAN LOW-VALUES
 10223         MOVE CCNOI              TO CL-CCN.
 10224
 10225     IF PROCI GREATER THAN LOW-VALUES
 10226         MOVE PROCI              TO CL-PROCESSOR-ID.
 10227
 10228     IF SEXI GREATER THAN LOW-VALUES
 10229         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10230
 10231     IF BIRTHI GREATER THAN LOW-VALUES
 10232         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10233
 10234     IF SOCIALI GREATER THAN LOW-VALUES
 10235       AND
 10236        SOCIALI = SPACES
 10237         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10238         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10239         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10240     ELSE
 10241         IF SOCIALI GREATER THAN LOW-VALUES
 10242             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10243
 10244     IF OCCI GREATER THAN LOW-VALUES
 10245         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10246
 10247     IF BENEL GREATER THAN ZERO
 10248         MOVE BENEI              TO CL-BENEFICIARY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 190
* EL131.cbl
 10249
 10250     IF DIAGI GREATER THAN LOW-VALUES
 10251         MOVE DIAGI              TO WS-DIAGNOSIS.
 10252
 10253     IF PREMTYPI GREATER THAN LOW-VALUES
 10254         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10255
 10256     IF CAUSEI GREATER THAN LOW-VALUES
 10257         MOVE CAUSEI             TO CL-CAUSE-CD.
 10258
 10259     IF ENDI GREATER THAN LOW-VALUES
 10260         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10261
 10262     IF PDTHRUI GREATER THAN LOW-VALUES
 10263        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10264
 10265     IF PDAMTL GREATER THAN +0
 10266        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10267
 10268     IF NODAYSI GREATER THAN LOW-VALUES
 10269        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10270
 10271     IF NOPMTSI GREATER THAN LOW-VALUES
 10272        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10273
 10274     IF FORMTYPI GREATER THAN LOW-VALUES
 10275        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10276
 10277     IF INCI GREATER THAN LOW-VALUES
 10278        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10279
 10280     IF REPI GREATER THAN LOW-VALUES
 10281        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10282
 10283     IF ADDONDTI GREATER THAN LOW-VALUES
 10284        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10285
 10286     IF PRICDI GREATER THAN LOW-VALUES
 10287         MOVE PRICDI             TO CL-PRIORITY-CD.
 10288
 10289     IF FILETOI GREATER THAN LOW-VALUES
 10290         MOVE FILETOI            TO CL-FILE-LOCATION.
 10291
 10292     IF SUPVI GREATER THAN LOW-VALUES
 10293         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10294
 10295     IF MLNAMEI GREATER THAN LOW-VALUES
 10296         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10297
 10298     IF MFNAMEI GREATER THAN LOW-VALUES
 10299         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10300
 10301     IF MMINITI GREATER THAN LOW-VALUES
 10302         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10303
 10304     IF CERTEFFI GREATER THAN LOW-VALUES
 10305         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10306
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 191
* EL131.cbl
 10307     IF CERTACTI GREATER THAN LOW-VALUES
 10308         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10309
 10310     IF CERTSTI GREATER THAN LOW-VALUES
 10311         MOVE CERTSTI            TO CL-CERT-STATE.
 10312
 10313     IF CERTCARI GREATER THAN LOW-VALUES
 10314         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10315                                    CL-CARRIER.
 10316
 10317     IF CERTGRPI GREATER THAN LOW-VALUES
 10318         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10319
 10320     IF CERTI GREATER THAN LOW-VALUES
 10321         MOVE CERTI              TO CERT-NO-PRIME.
 10322
 10323     IF SUFXI GREATER THAN LOW-VALUES
 10324         MOVE SUFXI              TO CERT-NO-SUFX.
 10325
 10326     MOVE CERT-NO                TO CL-CERT-NO
 10327                                    CL-CERT-NO-A4.
 10328
 10329     IF PI-COMPANY-ID = 'FLA'
 10330          NEXT SENTENCE
 10331     ELSE
 10332         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10333         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10334         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10335         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10336
 10337     IF TRLR-UPDATE-REQUIRED
 10338        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10339        MOVE ZEROS              TO TRLR-SEQ-NO
 10340
 10341* EXEC CICS READ
 10342*            DATASET   (TRLR-FILE-ID)
 10343*            RIDFLD    (TRLR-KEY)
 10344*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10345*       END-EXEC
 10346*    MOVE '&"S        E          (   #00009334' TO DFHEIV0
 10347     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10349     MOVE X'2020233030303039333334' TO DFHEIV0(25:11)
 10350     CALL 'kxdfhei1' USING DFHEIV0,
 10351           TRLR-FILE-ID,
 10352           DFHEIV20,
 10353           DFHEIV99,
 10354           TRLR-KEY,
 10355           DFHEIV99,
 10356           DFHEIV99,
 10357           DFHEIV99
 10358     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10359         DFHEIV20
 10360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10361        IF AT-TRAILER-TYPE = '1'
 10362           MOVE +1 TO MISC-SUB
 10363           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10364           MISC-SUB GREATER THAN +6 OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 192
* EL131.cbl
 10365           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10366           IF MISC-SUB GREATER THAN +1
 10367              SUBTRACT +1 FROM MISC-SUB
 10368              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10369                 GO TO 2100-BYPASS-LAST-UPDATE.
 10370
 10371     IF TRLR-UPDATE-REQUIRED AND
 10372        CLAIM-IS-OPEN
 10373         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10374     ELSE
 10375         IF TRLR-UPDATE-REQUIRED AND
 10376            CLAIM-IS-CLOSED
 10377             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10378             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10379
 10380 2100-BYPASS-LAST-UPDATE.
 10381     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10382     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10383
 10384     GO TO 2100-EXIT.
 10385
 10386 2100-BUMP-OPEN-CLOSE-HIST.
 10387     ADD +1                      TO MISC-SUB.
 10388
 10389 2100-EXIT.
 10390     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 193
* EL131.cbl
 10392 2200-MOVE-CERT.
 10393     IF CRTLNMEI GREATER THAN LOW-VALUES
 10394         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 10395
 10396     IF CRTFNMEI GREATER THAN LOW-VALUES
 10397         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 10398         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 10399
 10400     IF CRTINITI GREATER THAN LOW-VALUES
 10401         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 10402
 10403     IF CM-INSURED-INITIALS = SPACES
 10404         MOVE '**'               TO CM-INSURED-INITIALS.
 10405
 10406     IF ISSAGEI GREATER THAN LOW-VALUES
 10407         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 10408
 10409     IF JNTFNMEI GREATER THAN LOW-VALUES
 10410         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 10411
 10412     IF JNTLNMEI GREATER THAN LOW-VALUES
 10413         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 10414
 10415     IF JNTINITI GREATER THAN LOW-VALUES
 10416         MOVE JNTINITI           TO CM-JT-INITIAL.
 10417
 10418     IF JNTAGEI GREATER THAN LOW-VALUES
 10419         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 10420
 10421     IF ADDONDTI GREATER THAN LOW-VALUES
 10422        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 10423
 10424     IF LCVCDI GREATER THAN LOW-VALUES
 10425        IF LCVCDI = SPACES OR ZEROS
 10426           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 10427        ELSE
 10428           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 10429
 10430     IF LCVOTRMI GREATER THAN LOW-VALUES
 10431         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 10432
 10433     IF LCVRATEL GREATER THAN +0
 10434         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 10435
 10436     IF LCVBENEL GREATER THAN +0
 10437         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 10438
 10439     IF LCVFORMI GREATER THAN LOW-VALUES
 10440         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 10441
 10442     IF LCVCNDTI = LOW-VALUES
 10443        GO TO 2210-SET-STATUS.
 10444
 10445     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 10446        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10447        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 10448        GO TO 2210-SET-STATUS.
 10449
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 194
* EL131.cbl
 10450     IF CM-LF-CURRENT-STATUS = '7'
 10451        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 10452        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10453        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10454                                    CM-LF-DEATH-DT
 10455        GO TO 2210-SET-STATUS.
 10456
 10457     IF CM-LF-CURRENT-STATUS = '8'
 10458        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10459        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10460                                    CM-LF-CANCEL-DT.
 10461
 10462 2210-SET-STATUS.
 10463
 10464     IF CM-LF-CURRENT-STATUS = SPACES
 10465         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10466
 10467     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 10468         MOVE '6'                TO DC-OPTION-CODE
 10469         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10470         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10471         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10472         IF NO-CONVERSION-ERROR
 10473             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 10474         ELSE
 10475             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 10476     ELSE
 10477         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 10478
 10479 2215-PROCESS-AH-SIDE.
 10480
 10481     IF ACVCDI GREATER THAN LOW-VALUES
 10482        IF ACVCDI = SPACES OR ZEROS
 10483           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 10484        ELSE
 10485           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 10486
 10487     IF ACVOTRMI GREATER THAN LOW-VALUES
 10488         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 10489
 10490     IF ACVRATEL GREATER THAN +0
 10491         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 10492
 10493     IF ACVBENEL GREATER THAN +0
 10494         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 10495                                    PI-PAYMENT-AMT.
 10496
 10497     IF ACVFORMI GREATER THAN LOW-VALUES
 10498         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 10499
 10500     IF ACVCNDTI = LOW-VALUES
 10501        GO TO 2220-SET-STATUS.
 10502
 10503     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 10504        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10505        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 10506        GO TO 2220-SET-STATUS.
 10507
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 195
* EL131.cbl
 10508     IF CM-AH-CURRENT-STATUS = '6'
 10509        MOVE CM-AH-STATUS-AT-SETTLEMENT
 10510                                 TO CM-AH-CURRENT-STATUS
 10511        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10512        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10513                                    CM-AH-SETTLEMENT-DT
 10514        GO TO 2220-SET-STATUS.
 10515
 10516     IF CM-AH-CURRENT-STATUS = '8'
 10517        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10518        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10519                                    CM-AH-CANCEL-DT.
 10520
 10521 2220-SET-STATUS.
 10522     IF CM-AH-CURRENT-STATUS = SPACES
 10523         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10524
 10525     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 10526         MOVE '6'                TO DC-OPTION-CODE
 10527         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10528         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10529         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10530         IF NO-CONVERSION-ERROR
 10531             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 10532         ELSE
 10533             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 10534     ELSE
 10535         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 10536
 10537 2225-FINISH-CERT.
 10538     IF APRL GREATER THAN +0
 10539         MOVE HOLD-APR           TO CM-LOAN-APR.
 10540
 10541     IF PMTFREQI GREATER THAN LOW-VALUES
 10542         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 10543
 10544     IF INDGRPI GREATER THAN LOW-VALUES
 10545         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 10546
 10547     IF LOANNOI GREATER THAN LOW-VALUES
 10548        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 10549
 10550     IF LOANBALL GREATER THAN +0
 10551        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 10552
 10553     IF PREMTYPI GREATER THAN LOW-VALUES
 10554         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 10555
 10556     IF REINCDI GREATER THAN LOW-VALUES
 10557         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10558                                    WS-REIN-1
 10559                                    WS-REIN-2
 10560                                    WS-REIN-3
 10561         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 10562
 10563     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 10564
 10565     MOVE ZEROS                  TO CM-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 196
* EL131.cbl
 10566                                    CM-LIFE-COMM-PCT
 10567                                    CM-AH-COMM-PCT.
 10568
 10569*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 10570*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 10571*         PI-NO-PMTS = ZEROS
 10572*          IF LOANBALL GREATER THAN +0          OR
 10573*             ACVBENEL GREATER THAN +0          OR
 10574*             APRL     GREATER THAN +0          OR
 10575*             LCVRATEL GREATER THAN +0          OR
 10576*             ACVRATEL GREATER THAN +0
 10577*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 10578
 10579 2200-EXIT.
 10580     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 197
* EL131.cbl
 10582 2300-UPDATE-TRLR.
 10583
 10584
 10585* EXEC CICS READ UPDATE
 10586*         DATASET  (TRLR-FILE-ID)
 10587*         RIDFLD   (TRLR-KEY)
 10588*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10589*    END-EXEC.
 10590*    MOVE '&"S        EU         (   #00009562' TO DFHEIV0
 10591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10592     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10593     MOVE X'2020233030303039353632' TO DFHEIV0(25:11)
 10594     CALL 'kxdfhei1' USING DFHEIV0,
 10595           TRLR-FILE-ID,
 10596           DFHEIV20,
 10597           DFHEIV99,
 10598           TRLR-KEY,
 10599           DFHEIV99,
 10600           DFHEIV99,
 10601           DFHEIV99
 10602     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10603         DFHEIV20
 10604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10605
 10606
 10607     MOVE ZERO                   TO COUNT-2.
 10608
 10609     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 10610         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 10611
 10612     IF NOT UPDATE-MADE
 10613         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 10614
 10615
 10616* EXEC CICS REWRITE
 10617*         DATASET  (TRLR-FILE-ID)
 10618*         FROM     (ACTIVITY-TRAILERS)
 10619*    END-EXEC.
 10620     MOVE LENGTH OF
 10621      ACTIVITY-TRAILERS
 10622       TO DFHEIV11
 10623*    MOVE '&& L                  %   #00009576' TO DFHEIV0
 10624     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10625     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10626     MOVE X'2020233030303039353736' TO DFHEIV0(25:11)
 10627     CALL 'kxdfhei1' USING DFHEIV0,
 10628           TRLR-FILE-ID,
 10629           ACTIVITY-TRAILERS,
 10630           DFHEIV11,
 10631           DFHEIV99
 10632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10633
 10634
 10635 2300-EXIT.
 10636     EXIT.
 10637
 10638 2310-INS-STATUS.
 10639     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 198
* EL131.cbl
 10640     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 10641         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 10642         MOVE 'Y'                TO TRLR-SWITCH.
 10643
 10644 2310-EXIT.
 10645     EXIT.
 10646
 10647 2320-SHIFT-STATUS.
 10648     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 10649        MOVE 6                   TO COUNT-2
 10650        GO TO 2320-EXIT.
 10651
 10652     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 10653     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 10654     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 10655     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 10656     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 10657     MOVE 6       TO COUNT-2.
 10658     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 10659
 10660 2320-EXIT.
 10661     EXIT.
 10662
 10663 2330-ADD-UPDATE.
 10664
 10665     IF COUNT-2 GREATER THAN 1
 10666        COMPUTE MISC-SUB = (COUNT-2 - 1)
 10667        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10668           GO TO 2330-EXIT.
 10669
 10670     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 10671                                   AT-RESERVES-LAST-MAINT-DT
 10672
 10673     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 10674     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 10675     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 10676     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 10677
 10678 2330-EXIT.
 10679     EXIT.
 10680
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 199
* EL131.cbl
 10682 2400-UPDATE-TRLR.
 10683
 10684* EXEC CICS HANDLE CONDITION
 10685*         NOTFND    (2400-TRLR-NOTFND)
 10686*         ENDFILE   (2410-EXIT)
 10687*    END-EXEC.
 10688*    MOVE '"$I''                  ! 4 #00009629' TO DFHEIV0
 10689     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10691     MOVE X'3420233030303039363239' TO DFHEIV0(25:11)
 10692     CALL 'kxdfhei1' USING DFHEIV0
 10693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10694
 10695
 10696
 10697* EXEC CICS STARTBR
 10698*        DATASET (TRLR-FILE-ID)
 10699*        RIDFLD  (TRLR-KEY)
 10700*    END-EXEC.
 10701     MOVE 0
 10702       TO DFHEIV11
 10703*    MOVE '&,         G          &   #00009634' TO DFHEIV0
 10704     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10705     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10706     MOVE X'2020233030303039363334' TO DFHEIV0(25:11)
 10707     CALL 'kxdfhei1' USING DFHEIV0,
 10708           TRLR-FILE-ID,
 10709           TRLR-KEY,
 10710           DFHEIV99,
 10711           DFHEIV11,
 10712           DFHEIV99
 10713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10714
 10715
 10716
 10717* EXEC CICS GETMAIN
 10718*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10719*         LENGTH    (TRLR-LENGTH)
 10720*         INITIMG   (GETMAIN-SPACE)
 10721*    END-EXEC.
 10722*    MOVE ',"IL                  $   #00009639' TO DFHEIV0
 10723     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10724     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10725     MOVE X'2020233030303039363339' TO DFHEIV0(25:11)
 10726     CALL 'kxdfhei1' USING DFHEIV0,
 10727           DFHEIV20,
 10728           TRLR-LENGTH,
 10729           GETMAIN-SPACE
 10730     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10731         DFHEIV20
 10732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10733
 10734
 10735     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 10736
 10737
 10738* EXEC CICS ENDBR
 10739*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 200
* EL131.cbl
 10740*    END-EXEC.
 10741     MOVE 0
 10742       TO DFHEIV11
 10743*    MOVE '&2                    $   #00009647' TO DFHEIV0
 10744     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10745     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10746     MOVE X'2020233030303039363437' TO DFHEIV0(25:11)
 10747     CALL 'kxdfhei1' USING DFHEIV0,
 10748           TRLR-FILE-ID,
 10749           DFHEIV11,
 10750           DFHEIV99
 10751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10752
 10753
 10754     GO TO 2400-EXIT.
 10755
 10756 2400-TRLR-NOTFND.
 10757     MOVE ER-0205                TO EMI-ERROR.
 10758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10759     MOVE 'X'                    TO ERROR-SWITCH.
 10760
 10761 2400-EXIT.
 10762     EXIT.
 10763
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 201
* EL131.cbl
 10765 2410-CHANGE-TRLR.
 10766
 10767* EXEC CICS READNEXT
 10768*        DATASET (TRLR-FILE-ID)
 10769*        RIDFLD  (TRLR-KEY)
 10770*        INTO    (ACTIVITY-TRAILERS)
 10771*    END-EXEC.
 10772     MOVE LENGTH OF
 10773      ACTIVITY-TRAILERS
 10774       TO DFHEIV12
 10775     MOVE 0
 10776       TO DFHEIV11
 10777*    MOVE '&.IL                  )   #00009663' TO DFHEIV0
 10778     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 10779     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10780     MOVE X'2020233030303039363633' TO DFHEIV0(25:11)
 10781     CALL 'kxdfhei1' USING DFHEIV0,
 10782           TRLR-FILE-ID,
 10783           ACTIVITY-TRAILERS,
 10784           DFHEIV12,
 10785           TRLR-KEY,
 10786           DFHEIV99,
 10787           DFHEIV11,
 10788           DFHEIV99,
 10789           DFHEIV99
 10790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10791
 10792
 10793     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 10794        GO TO 2410-CHANGE-TRLR.
 10795
 10796     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 10797                                    CHECK-KEY.
 10798
 10799     IF CHECK-KEY NOT = MSTR-KEY
 10800         GO TO 2410-EXIT.
 10801
 10802
 10803* EXEC CICS ENDBR
 10804*        DATASET (TRLR-FILE-ID)
 10805*    END-EXEC.
 10806     MOVE 0
 10807       TO DFHEIV11
 10808*    MOVE '&2                    $   #00009678' TO DFHEIV0
 10809     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10810     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10811     MOVE X'2020233030303039363738' TO DFHEIV0(25:11)
 10812     CALL 'kxdfhei1' USING DFHEIV0,
 10813           TRLR-FILE-ID,
 10814           DFHEIV11,
 10815           DFHEIV99
 10816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10817
 10818
 10819
 10820* EXEC CICS READ UPDATE
 10821*        DATASET (TRLR-FILE-ID)
 10822*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 202
* EL131.cbl
 10823*        INTO    (ACTIVITY-TRAILERS)
 10824*    END-EXEC.
 10825     MOVE LENGTH OF
 10826      ACTIVITY-TRAILERS
 10827       TO DFHEIV11
 10828*    MOVE '&"IL       EU         (   #00009682' TO DFHEIV0
 10829     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10830     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10831     MOVE X'2020233030303039363832' TO DFHEIV0(25:11)
 10832     CALL 'kxdfhei1' USING DFHEIV0,
 10833           TRLR-FILE-ID,
 10834           ACTIVITY-TRAILERS,
 10835           DFHEIV11,
 10836           TRLR-KEY,
 10837           DFHEIV99,
 10838           DFHEIV99,
 10839           DFHEIV99
 10840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10841
 10842
 10843
 10844* EXEC CICS DELETE
 10845*        DATASET (TRLR-FILE-ID)
 10846*    END-EXEC.
 10847*    MOVE '&(                    &   #00009688' TO DFHEIV0
 10848     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10850     MOVE X'2020233030303039363838' TO DFHEIV0(25:11)
 10851     CALL 'kxdfhei1' USING DFHEIV0,
 10852           TRLR-FILE-ID,
 10853           DFHEIV99,
 10854           DFHEIV99,
 10855           DFHEIV99,
 10856           DFHEIV99
 10857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10858
 10859
 10860     IF AT-SEQUENCE-NO = ZERO AND
 10861        TRLR-UPDATE-REQUIRED
 10862         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 10863
 10864     IF CERTI GREATER THAN LOW-VALUES
 10865        MOVE CERTI               TO AT-CERT-PRIME.
 10866
 10867     IF SUFXI GREATER THAN LOW-VALUES
 10868        MOVE SUFXI               TO AT-CERT-SFX.
 10869
 10870     IF CERTCARI GREATER THAN LOW-VALUES
 10871        MOVE CERTCARI            TO AT-CARRIER.
 10872
 10873     IF PAYMENT-TR
 10874        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 10875           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 10876              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 10877
 10878     IF CORRESPONDENCE-TR
 10879        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 10880           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 203
* EL131.cbl
 10881
 10882
 10883* EXEC CICS WRITE
 10884*         DATASET  (TRLR-FILE-ID)
 10885*         RIDFLD   (AT-CONTROL-PRIMARY)
 10886*         FROM     (ACTIVITY-TRAILERS)
 10887*    END-EXEC.
 10888     MOVE LENGTH OF
 10889      ACTIVITY-TRAILERS
 10890       TO DFHEIV11
 10891*    MOVE '&$ L                  ''   #00009714' TO DFHEIV0
 10892     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10893     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10894     MOVE X'2020233030303039373134' TO DFHEIV0(25:11)
 10895     CALL 'kxdfhei1' USING DFHEIV0,
 10896           TRLR-FILE-ID,
 10897           ACTIVITY-TRAILERS,
 10898           DFHEIV11,
 10899           AT-CONTROL-PRIMARY,
 10900           DFHEIV99,
 10901           DFHEIV99
 10902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10903
 10904
 10905
 10906* EXEC CICS STARTBR
 10907*         DATASET  (TRLR-FILE-ID)
 10908*         RIDFLD   (TRLR-KEY)
 10909*    END-EXEC.
 10910     MOVE 0
 10911       TO DFHEIV11
 10912*    MOVE '&,         G          &   #00009720' TO DFHEIV0
 10913     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10914     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10915     MOVE X'2020233030303039373230' TO DFHEIV0(25:11)
 10916     CALL 'kxdfhei1' USING DFHEIV0,
 10917           TRLR-FILE-ID,
 10918           TRLR-KEY,
 10919           DFHEIV99,
 10920           DFHEIV11,
 10921           DFHEIV99
 10922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10923
 10924
 10925     GO TO 2410-CHANGE-TRLR.
 10926
 10927 2410-EXIT.
 10928     EXIT.
 10929
 10930 2420-UPDATE-TRLR.
 10931     MOVE ZERO TO COUNT-2.
 10932     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 10933         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 10934
 10935     IF NOT UPDATE-MADE
 10936         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 10937
 10938 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 204
* EL131.cbl
 10939     EXIT.
 10940
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 205
* EL131.cbl
 10942 2425-UPDATE-NINETY-TRLR.
 10943
 10944     MOVE +90                    TO TRLR-SEQ-NO.
 10945
 10946
 10947* EXEC CICS HANDLE CONDITION
 10948*         NOTFND    (2425-NINETY-NOTFND)
 10949*         ENDFILE   (2425-NINETY-NOTFND)
 10950*    END-EXEC.
 10951*    MOVE '"$I''                  ! 5 #00009746' TO DFHEIV0
 10952     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10954     MOVE X'3520233030303039373436' TO DFHEIV0(25:11)
 10955     CALL 'kxdfhei1' USING DFHEIV0
 10956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10957
 10958
 10959
 10960* EXEC CICS READ UPDATE
 10961*        DATASET (TRLR-FILE-ID)
 10962*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 10963*        RIDFLD  (TRLR-KEY)
 10964*    END-EXEC.
 10965*    MOVE '&"S        EU         (   #00009751' TO DFHEIV0
 10966     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10967     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10968     MOVE X'2020233030303039373531' TO DFHEIV0(25:11)
 10969     CALL 'kxdfhei1' USING DFHEIV0,
 10970           TRLR-FILE-ID,
 10971           DFHEIV20,
 10972           DFHEIV99,
 10973           TRLR-KEY,
 10974           DFHEIV99,
 10975           DFHEIV99,
 10976           DFHEIV99
 10977     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10978         DFHEIV20
 10979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10980
 10981
 10982     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 10983
 10984     MOVE DIAGI                 TO AT-INFO-LINE-1.
 10985
 10986
 10987* EXEC CICS REWRITE
 10988*        DATASET (TRLR-FILE-ID)
 10989*        FROM    (ACTIVITY-TRAILERS)
 10990*    END-EXEC.
 10991     MOVE LENGTH OF
 10992      ACTIVITY-TRAILERS
 10993       TO DFHEIV11
 10994*    MOVE '&& L                  %   #00009761' TO DFHEIV0
 10995     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10996     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10997     MOVE X'2020233030303039373631' TO DFHEIV0(25:11)
 10998     CALL 'kxdfhei1' USING DFHEIV0,
 10999           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 206
* EL131.cbl
 11000           ACTIVITY-TRAILERS,
 11001           DFHEIV11,
 11002           DFHEIV99
 11003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11004
 11005
 11006     IF DIAGI NOT = WS-DIAGNOSIS
 11007         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11008         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11009         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11010
 11011     GO TO 2425-EXIT.
 11012
 11013 2425-NINETY-NOTFND.
 11014
 11015
 11016* EXEC CICS GETMAIN
 11017*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11018*         LENGTH    (TRLR-LENGTH)
 11019*         INITIMG   (GETMAIN-SPACE)
 11020*    END-EXEC.
 11021*    MOVE ',"IL                  $   #00009775' TO DFHEIV0
 11022     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11023     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11024     MOVE X'2020233030303039373735' TO DFHEIV0(25:11)
 11025     CALL 'kxdfhei1' USING DFHEIV0,
 11026           DFHEIV20,
 11027           TRLR-LENGTH,
 11028           GETMAIN-SPACE
 11029     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11030         DFHEIV20
 11031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11032
 11033
 11034     MOVE +90                  TO TRLR-SEQ-NO.
 11035     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11036
 11037     MOVE 'AT'                 TO AT-RECORD-ID
 11038     MOVE '6'                  TO AT-TRAILER-TYPE
 11039     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11040                                  AT-GEN-INFO-LAST-MAINT-DT
 11041     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11042                                  AT-GEN-INFO-LAST-UPDATED-BY
 11043     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11044     MOVE DIAGI                TO AT-INFO-LINE-1.
 11045
 11046
 11047* EXEC CICS WRITE
 11048*        DATASET (TRLR-FILE-ID)
 11049*        FROM    (ACTIVITY-TRAILERS)
 11050*        RIDFLD  (TRLR-KEY)
 11051*    END-EXEC.
 11052     MOVE LENGTH OF
 11053      ACTIVITY-TRAILERS
 11054       TO DFHEIV11
 11055*    MOVE '&$ L                  ''   #00009793' TO DFHEIV0
 11056     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11057     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 207
* EL131.cbl
 11058     MOVE X'2020233030303039373933' TO DFHEIV0(25:11)
 11059     CALL 'kxdfhei1' USING DFHEIV0,
 11060           TRLR-FILE-ID,
 11061           ACTIVITY-TRAILERS,
 11062           DFHEIV11,
 11063           TRLR-KEY,
 11064           DFHEIV99,
 11065           DFHEIV99
 11066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11067
 11068
 11069 2425-EXIT.
 11070     EXIT.
 11071
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 208
* EL131.cbl
 11073 2430-UPDATE-ACTQ.
 11074
 11075* EXEC CICS HANDLE CONDITION
 11076*         NOTFND    (2430-EXIT)
 11077*         ENDFILE   (2440-EXIT)
 11078*    END-EXEC.
 11079*    MOVE '"$I''                  ! 6 #00009804' TO DFHEIV0
 11080     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11082     MOVE X'3620233030303039383034' TO DFHEIV0(25:11)
 11083     CALL 'kxdfhei1' USING DFHEIV0
 11084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11085
 11086
 11087
 11088* EXEC CICS STARTBR
 11089*         DATASET  (ACTQ-FILE-ID)
 11090*         RIDFLD   (ACTQ-KEY)
 11091*    END-EXEC.
 11092     MOVE 0
 11093       TO DFHEIV11
 11094*    MOVE '&,         G          &   #00009809' TO DFHEIV0
 11095     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11096     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11097     MOVE X'2020233030303039383039' TO DFHEIV0(25:11)
 11098     CALL 'kxdfhei1' USING DFHEIV0,
 11099           ACTQ-FILE-ID,
 11100           ACTQ-KEY,
 11101           DFHEIV99,
 11102           DFHEIV11,
 11103           DFHEIV99
 11104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11105
 11106
 11107
 11108* EXEC CICS GETMAIN
 11109*         SET      (ADDRESS OF ACTIVITY-QUE)
 11110*         LENGTH   (ACTQ-LENGTH)
 11111*         INITIMG  (GETMAIN-SPACE)
 11112*    END-EXEC.
 11113*    MOVE ',"IL                  $   #00009814' TO DFHEIV0
 11114     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11115     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11116     MOVE X'2020233030303039383134' TO DFHEIV0(25:11)
 11117     CALL 'kxdfhei1' USING DFHEIV0,
 11118           DFHEIV20,
 11119           ACTQ-LENGTH,
 11120           GETMAIN-SPACE
 11121     SET ADDRESS OF ACTIVITY-QUE TO
 11122         DFHEIV20
 11123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11124
 11125
 11126     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11127
 11128 2430-EXIT.
 11129     EXIT.
 11130
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 209
* EL131.cbl
 11131 2440-CHANGE-ACTQ.
 11132
 11133
 11134* EXEC CICS READNEXT
 11135*         DATASET  (ACTQ-FILE-ID)
 11136*         RIDFLD   (ACTQ-KEY)
 11137*         INTO     (ACTIVITY-QUE)
 11138*    END-EXEC.
 11139     MOVE LENGTH OF
 11140      ACTIVITY-QUE
 11141       TO DFHEIV12
 11142     MOVE 0
 11143       TO DFHEIV11
 11144*    MOVE '&.IL                  )   #00009827' TO DFHEIV0
 11145     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11146     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11147     MOVE X'2020233030303039383237' TO DFHEIV0(25:11)
 11148     CALL 'kxdfhei1' USING DFHEIV0,
 11149           ACTQ-FILE-ID,
 11150           ACTIVITY-QUE,
 11151           DFHEIV12,
 11152           ACTQ-KEY,
 11153           DFHEIV99,
 11154           DFHEIV11,
 11155           DFHEIV99,
 11156           DFHEIV99
 11157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11158
 11159
 11160
 11161* EXEC CICS ENDBR
 11162*         DATASET (ACTQ-FILE-ID)
 11163*    END-EXEC.
 11164     MOVE 0
 11165       TO DFHEIV11
 11166*    MOVE '&2                    $   #00009833' TO DFHEIV0
 11167     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11168     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11169     MOVE X'2020233030303039383333' TO DFHEIV0(25:11)
 11170     CALL 'kxdfhei1' USING DFHEIV0,
 11171           ACTQ-FILE-ID,
 11172           DFHEIV11,
 11173           DFHEIV99
 11174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11175
 11176
 11177     IF ACTQ-KEY NOT = MSTR-KEY
 11178         GO TO 2440-EXIT.
 11179
 11180
 11181* EXEC CICS READ UPDATE
 11182*         DATASET  (ACTQ-FILE-ID)
 11183*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11184*         SET      (ADDRESS OF ACTIVITY-QUE)
 11185*    END-EXEC.
 11186*    MOVE '&"S        EU         (   #00009840' TO DFHEIV0
 11187     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11188     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 210
* EL131.cbl
 11189     MOVE X'2020233030303039383430' TO DFHEIV0(25:11)
 11190     CALL 'kxdfhei1' USING DFHEIV0,
 11191           ACTQ-FILE-ID,
 11192           DFHEIV20,
 11193           DFHEIV99,
 11194           AQ-CONTROL-PRIMARY,
 11195           DFHEIV99,
 11196           DFHEIV99,
 11197           DFHEIV99
 11198     SET ADDRESS OF ACTIVITY-QUE TO
 11199         DFHEIV20
 11200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11201
 11202
 11203     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11204
 11205
 11206* EXEC CICS DELETE
 11207*         DATASET (ACTQ-FILE-ID)
 11208*    END-EXEC.
 11209*    MOVE '&(                    &   #00009848' TO DFHEIV0
 11210     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11211     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11212     MOVE X'2020233030303039383438' TO DFHEIV0(25:11)
 11213     CALL 'kxdfhei1' USING DFHEIV0,
 11214           ACTQ-FILE-ID,
 11215           DFHEIV99,
 11216           DFHEIV99,
 11217           DFHEIV99,
 11218           DFHEIV99
 11219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11220
 11221
 11222     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11223     IF CERTI GREATER THAN LOW-VALUES
 11224        MOVE CERTI               TO AQ-CERT-PRIME.
 11225     IF SUFXI GREATER THAN LOW-VALUES
 11226        MOVE SUFXI               TO AQ-CERT-SFX.
 11227     IF CERTCARI GREATER THAN LOW-VALUES
 11228        MOVE CERTCARI            TO AQ-CARRIER.
 11229
 11230
 11231* EXEC CICS HANDLE CONDITION
 11232*         DUPREC   (2440-EXIT)
 11233*    END-EXEC.
 11234*    MOVE '"$%                   ! 7 #00009860' TO DFHEIV0
 11235     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11237     MOVE X'3720233030303039383630' TO DFHEIV0(25:11)
 11238     CALL 'kxdfhei1' USING DFHEIV0
 11239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11240
 11241
 11242
 11243* EXEC CICS WRITE
 11244*         DATASET  (ACTQ-FILE-ID)
 11245*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11246*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 211
* EL131.cbl
 11247*    END-EXEC.
 11248     MOVE LENGTH OF
 11249      ACTIVITY-QUE
 11250       TO DFHEIV11
 11251*    MOVE '&$ L                  ''   #00009864' TO DFHEIV0
 11252     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11253     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11254     MOVE X'2020233030303039383634' TO DFHEIV0(25:11)
 11255     CALL 'kxdfhei1' USING DFHEIV0,
 11256           ACTQ-FILE-ID,
 11257           ACTIVITY-QUE,
 11258           DFHEIV11,
 11259           AQ-CONTROL-PRIMARY,
 11260           DFHEIV99,
 11261           DFHEIV99
 11262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11263
 11264
 11265 2440-EXIT.
 11266     EXIT.
 11267
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 212
* EL131.cbl
 11269 2460-UPDATE-CHECKQ.
 11270
 11271* EXEC CICS HANDLE CONDITION
 11272*         NOTFND   (2460-EXIT)
 11273*    END-EXEC.
 11274*    MOVE '"$I                   ! 8 #00009875' TO DFHEIV0
 11275     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11277     MOVE X'3820233030303039383735' TO DFHEIV0(25:11)
 11278     CALL 'kxdfhei1' USING DFHEIV0
 11279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11280
 11281
 11282     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 11283     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 11284     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 11285
 11286
 11287* EXEC CICS READ UPDATE
 11288*         DATASET   (CHKQ-FILE-ID)
 11289*         RIDFLD    (CHKQ-KEY)
 11290*         SET       (ADDRESS OF CHECK-QUE)
 11291*    END-EXEC.
 11292*    MOVE '&"S        EU         (   #00009883' TO DFHEIV0
 11293     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11294     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11295     MOVE X'2020233030303039383833' TO DFHEIV0(25:11)
 11296     CALL 'kxdfhei1' USING DFHEIV0,
 11297           CHKQ-FILE-ID,
 11298           DFHEIV20,
 11299           DFHEIV99,
 11300           CHKQ-KEY,
 11301           DFHEIV99,
 11302           DFHEIV99,
 11303           DFHEIV99
 11304     SET ADDRESS OF CHECK-QUE TO
 11305         DFHEIV20
 11306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11307
 11308
 11309     IF CERTI GREATER THAN LOW-VALUES
 11310        MOVE CERTI               TO CQ-CERT-PRIME.
 11311     IF SUFXI GREATER THAN LOW-VALUES
 11312        MOVE SUFXI               TO CQ-CERT-SFX.
 11313     IF CERTCARI GREATER THAN LOW-VALUES
 11314        MOVE CERTCARI            TO CQ-CARRIER.
 11315
 11316
 11317* EXEC CICS REWRITE
 11318*         DATASET  (CHKQ-FILE-ID)
 11319*         FROM     (CHECK-QUE)
 11320*    END-EXEC.
 11321     MOVE LENGTH OF
 11322      CHECK-QUE
 11323       TO DFHEIV11
 11324*    MOVE '&& L                  %   #00009896' TO DFHEIV0
 11325     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11326     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 213
* EL131.cbl
 11327     MOVE X'2020233030303039383936' TO DFHEIV0(25:11)
 11328     CALL 'kxdfhei1' USING DFHEIV0,
 11329           CHKQ-FILE-ID,
 11330           CHECK-QUE,
 11331           DFHEIV11,
 11332           DFHEIV99
 11333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11334
 11335
 11336 2460-EXIT.
 11337     EXIT.
 11338
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 214
* EL131.cbl
 11340 2475-UPDATE-LETTER.
 11341
 11342* EXEC CICS HANDLE CONDITION
 11343*         NOTFND   (2475-EXIT)
 11344*    END-EXEC.
 11345*    MOVE '"$I                   ! 9 #00009906' TO DFHEIV0
 11346     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11348     MOVE X'3920233030303039393036' TO DFHEIV0(25:11)
 11349     CALL 'kxdfhei1' USING DFHEIV0
 11350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11351
 11352
 11353     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 11354     MOVE '1'                    TO ARCH-RECORD-TYPE.
 11355     MOVE ZEROS                  TO ARCH-SEQ-NO.
 11356     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 11357
 11358
 11359* EXEC CICS READ UPDATE
 11360*         DATASET   (ARCH-FILE-ID)
 11361*         RIDFLD    (ARCH-KEY)
 11362*         SET       (ADDRESS OF LETTER-ARCHIVE)
 11363*    END-EXEC.
 11364*    MOVE '&"S        EU         (   #00009915' TO DFHEIV0
 11365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11366     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11367     MOVE X'2020233030303039393135' TO DFHEIV0(25:11)
 11368     CALL 'kxdfhei1' USING DFHEIV0,
 11369           ARCH-FILE-ID,
 11370           DFHEIV20,
 11371           DFHEIV99,
 11372           ARCH-KEY,
 11373           DFHEIV99,
 11374           DFHEIV99,
 11375           DFHEIV99
 11376     SET ADDRESS OF LETTER-ARCHIVE TO
 11377         DFHEIV20
 11378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11379
 11380
 11381* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 11382* TO THIS MASTER-KEY INFORMATION.
 11383
 11384     IF LA-CARRIER  = CARRIER-CODE AND
 11385        LA-CLAIM-NO = CLAIM-NO     AND
 11386        LA-CERT-NO  = CERT-NO
 11387        NEXT SENTENCE
 11388     ELSE
 11389        GO TO 2475-UNLOCK.
 11390
 11391     IF CERTI GREATER THAN LOW-VALUES
 11392        MOVE CERTI               TO LA-CERT-PRIME.
 11393     IF SUFXI GREATER THAN LOW-VALUES
 11394        MOVE SUFXI               TO LA-CERT-SFX.
 11395     IF CERTCARI GREATER THAN LOW-VALUES
 11396        MOVE CERTCARI            TO LA-CARRIER.
 11397
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 215
* EL131.cbl
 11398
 11399* EXEC CICS REWRITE
 11400*         DATASET  (ARCH-FILE-ID)
 11401*         FROM     (LETTER-ARCHIVE)
 11402*    END-EXEC.
 11403     MOVE LENGTH OF
 11404      LETTER-ARCHIVE
 11405       TO DFHEIV11
 11406*    MOVE '&& L                  %   #00009938' TO DFHEIV0
 11407     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11408     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11409     MOVE X'2020233030303039393338' TO DFHEIV0(25:11)
 11410     CALL 'kxdfhei1' USING DFHEIV0,
 11411           ARCH-FILE-ID,
 11412           LETTER-ARCHIVE,
 11413           DFHEIV11,
 11414           DFHEIV99
 11415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11416
 11417
 11418     GO TO 2475-EXIT.
 11419
 11420 2475-UNLOCK.
 11421
 11422* EXEC CICS UNLOCK
 11423*         DATASET  (ARCH-FILE-ID)
 11424*    END-EXEC.
 11425*    MOVE '&*                    #   #00009946' TO DFHEIV0
 11426     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11427     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11428     MOVE X'2020233030303039393436' TO DFHEIV0(25:11)
 11429     CALL 'kxdfhei1' USING DFHEIV0,
 11430           ARCH-FILE-ID,
 11431           DFHEIV99
 11432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11433
 11434
 11435 2475-EXIT.
 11436     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 216
* EL131.cbl
 11438 2600-CREATE-MAINT-NOTE.
 11439     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 11440     MOVE '1'                    TO CNTL-REC-TYPE.
 11441     MOVE SPACES                 TO CNTL-PROC-ID.
 11442     MOVE ZERO                   TO CNTL-SEQ-NO.
 11443
 11444
 11445* EXEC CICS READ
 11446*         SET        (ADDRESS OF CONTROL-FILE)
 11447*         DATASET    ('ELCNTL')
 11448*         RIDFLD     (CNTL-KEY)
 11449*    END-EXEC.
 11450     MOVE 'ELCNTL' TO DFHEIV1
 11451*    MOVE '&"S        E          (   #00009959' TO DFHEIV0
 11452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11454     MOVE X'2020233030303039393539' TO DFHEIV0(25:11)
 11455     CALL 'kxdfhei1' USING DFHEIV0,
 11456           DFHEIV1,
 11457           DFHEIV20,
 11458           DFHEIV99,
 11459           CNTL-KEY,
 11460           DFHEIV99,
 11461           DFHEIV99,
 11462           DFHEIV99
 11463     SET ADDRESS OF CONTROL-FILE TO
 11464         DFHEIV20
 11465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11466
 11467
 11468     IF CO-NO-USE-AUDIT-CHANGES
 11469         GO TO 2600-EXIT.
 11470
 11471     IF PROCL GREATER ZERO
 11472     IF PROCI NOT = LOW-VALUES
 11473     IF PROCI NOT = CL-PROCESSOR-ID
 11474         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 11475         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 11476         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11477
 11478     IF SEXL GREATER ZERO
 11479     IF SEXI NOT = LOW-VALUES
 11480     IF SEXI NOT = CL-INSURED-SEX-CD
 11481         MOVE 'SEX'                TO SPLIT-INFO-DESC
 11482         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 11483         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11484
 11485     IF BIRTHL GREATER ZERO
 11486     IF HOLD-BIRTH NOT = LOW-VALUES
 11487     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 11488         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 11489         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 11490         MOVE SPACES               TO DC-OPTION-CODE
 11491         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11492         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11493         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11494
 11495     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 217
* EL131.cbl
 11496     IF SOCIALI NOT = LOW-VALUES
 11497     IF SOCIALI NOT = CL-SOC-SEC-NO
 11498         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 11499         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 11500         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11501
 11502     IF OCCL GREATER ZERO
 11503     IF OCCI NOT = LOW-VALUES
 11504     IF OCCI NOT = CL-INSURED-OCC-CD
 11505         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 11506         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 11507         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11508
 11509     IF BENEL GREATER ZERO
 11510     IF BENEI NOT = LOW-VALUES
 11511     IF BENEI NOT = CL-BENEFICIARY
 11512         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 11513         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 11514         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11515
 11516     IF PREMTYPL GREATER ZERO
 11517     IF PREMTYPI NOT = LOW-VALUES
 11518     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 11519         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 11520         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 11521         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11522
 11523     IF CAUSEL GREATER ZERO
 11524     IF CAUSEI NOT = LOW-VALUES
 11525     IF CAUSEI NOT = CL-CAUSE-CD
 11526         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 11527         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 11528         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11529
 11530     IF ENDL GREATER ZERO
 11531     IF HOLD-END NOT = LOW-VALUES
 11532     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 11533         MOVE 'END DT'             TO SPLIT-INFO-DESC
 11534         MOVE CL-EST-END-OF-DISAB-DT
 11535                                   TO DC-BIN-DATE-1
 11536         MOVE SPACES               TO DC-OPTION-CODE
 11537         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11538         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11539         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11540
 11541     IF PDTHRUL GREATER ZERO
 11542     IF HOLD-PDTHRU NOT = LOW-VALUES
 11543     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 11544         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 11545         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 11546         MOVE SPACES               TO DC-OPTION-CODE
 11547         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11548         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11549         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11550
 11551     IF PDAMTL GREATER ZERO
 11552     IF HOLD-PDAMT NOT = ZEROS
 11553     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 218
* EL131.cbl
 11554         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 11555         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 11556         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 11557         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11558
 11559     IF NODAYSL GREATER ZERO
 11560     IF HOLD-NODAYS NOT = ZEROS
 11561     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 11562         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 11563         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 11564         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11565         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11566
 11567     IF NOPMTSL GREATER ZERO
 11568     IF HOLD-NOPMTS NOT = ZEROS
 11569     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 11570         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 11571         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 11572         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11573         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11574
 11575     IF FORMTYPL GREATER ZERO
 11576     IF FORMTYPI NOT = LOW-VALUES
 11577     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 11578         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 11579         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 11580         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11581
 11582     IF REPL GREATER ZERO
 11583     IF HOLD-REPORTED NOT = LOW-VALUES
 11584     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 11585         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 11586         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 11587         MOVE SPACES               TO DC-OPTION-CODE
 11588         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11589         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11590         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11591
 11592     IF ADDONDTL GREATER ZERO
 11593     IF HOLD-ADDON NOT = LOW-VALUES
 11594     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 11595         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 11596         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 11597         MOVE SPACES               TO DC-OPTION-CODE
 11598         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11599         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11600         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11601
 11602     IF PRICDL GREATER ZERO
 11603     IF PRICDI NOT = LOW-VALUES
 11604     IF PRICDI NOT = CL-PRIORITY-CD
 11605         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 11606         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 11607         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11608
 11609     IF FILETOL GREATER ZERO
 11610     IF FILETOI NOT = LOW-VALUES
 11611     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 219
* EL131.cbl
 11612         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 11613         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 11614         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11615
 11616     IF SUPVL GREATER ZERO
 11617     IF SUPVI NOT = LOW-VALUES
 11618     IF SUPVI NOT = CL-SUPV-ATTN-CD
 11619         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 11620         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 11621         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11622
 11623     IF MLNAMEL GREATER ZERO
 11624     IF MLNAMEI NOT = LOW-VALUES
 11625     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 11626         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 11627         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 11628         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11629
 11630     IF MFNAMEL GREATER ZERO
 11631     IF MFNAMEI NOT = LOW-VALUES
 11632     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 11633         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 11634         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 11635         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11636
 11637     IF MMINITL GREATER ZERO
 11638     IF MMINITI NOT = LOW-VALUES
 11639     IF MMINITI NOT = CL-INSURED-MID-INIT
 11640         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 11641         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 11642         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11643
 11644     IF CERTEFFL GREATER ZERO
 11645     IF HOLD-EFF NOT = LOW-VALUES
 11646     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 11647         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 11648         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 11649         MOVE SPACES               TO DC-OPTION-CODE
 11650         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11651         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11652         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11653
 11654     IF CERTACTL GREATER ZERO
 11655     IF CERTACTI NOT = LOW-VALUES
 11656     IF CERTACTI NOT = CL-CERT-ACCOUNT
 11657         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 11658         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 11659         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11660
 11661     IF CERTSTL GREATER ZERO
 11662     IF CERTSTI NOT = LOW-VALUES
 11663     IF CERTSTI NOT = CL-CERT-STATE
 11664         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 11665         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 11666         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11667
 11668     IF CERTCARL GREATER ZERO
 11669     IF CERTCARI NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 220
* EL131.cbl
 11670     IF CERTCARI NOT = CL-CERT-CARRIER
 11671         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 11672         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 11673         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11674
 11675     IF CERTGRPL GREATER ZERO
 11676     IF CERTGRPI NOT = LOW-VALUES
 11677     IF CERTGRPI NOT = CL-CERT-GROUPING
 11678         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 11679         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 11680         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11681
 11682     IF CERTL GREATER ZERO OR
 11683        SUFXL GREATER ZERO
 11684     IF (CERTI NOT = LOW-VALUES AND
 11685                     CL-CERT-PRIME)
 11686                OR
 11687        (SUFXI NOT = LOW-VALUES AND
 11688                     CL-CERT-SFX)
 11689         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 11690         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 11691         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11692
 11693 2600-EXIT.
 11694      EXIT.
 11695
 11696 2650-WRITE-MAINT-NOTE.
 11697
 11698* EXEC CICS GETMAIN
 11699*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11700*         LENGTH   (TRLR-LENGTH)
 11701*         INITIMG  (GETMAIN-SPACE)
 11702*    END-EXEC.
 11703*    MOVE ',"IL                  $   #00010194' TO DFHEIV0
 11704     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11705     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11706     MOVE X'2020233030303130313934' TO DFHEIV0(25:11)
 11707     CALL 'kxdfhei1' USING DFHEIV0,
 11708           DFHEIV20,
 11709           TRLR-LENGTH,
 11710           GETMAIN-SPACE
 11711     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11712         DFHEIV20
 11713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11714
 11715
 11716
 11717* EXEC CICS HANDLE CONDITION
 11718*         DUPREC   (2650-EXIT)
 11719*    END-EXEC.
 11720*    MOVE '"$%                   ! : #00010200' TO DFHEIV0
 11721     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11723     MOVE X'3A20233030303130323030' TO DFHEIV0(25:11)
 11724     CALL 'kxdfhei1' USING DFHEIV0
 11725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11726
 11727
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 221
* EL131.cbl
 11728     MOVE SPACES             TO ACTIVITY-TRAILERS.
 11729
 11730     IF CERTL GREATER ZERO
 11731         MOVE CERTI          TO CL-CERT-PRIME.
 11732
 11733     IF SUFXL GREATER ZERO
 11734         MOVE SUFXI          TO CL-CERT-SFX.
 11735
 11736     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 11737
 11738     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 11739     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 11740
 11741     MOVE 'AT'               TO AT-RECORD-ID.
 11742
 11743     MOVE '6'                TO AT-TRAILER-TYPE.
 11744     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 11745                                AT-GEN-INFO-LAST-MAINT-DT.
 11746     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 11747                                AT-GEN-INFO-LAST-UPDATED-BY.
 11748     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 11749     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 11750     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 11751
 11752
 11753* EXEC CICS WRITE
 11754*         DATASET  (TRLR-FILE-ID)
 11755*         RIDFLD   (AT-CONTROL-PRIMARY)
 11756*         FROM     (ACTIVITY-TRAILERS)
 11757*    END-EXEC.
 11758     MOVE LENGTH OF
 11759      ACTIVITY-TRAILERS
 11760       TO DFHEIV11
 11761*    MOVE '&$ L                  ''   #00010228' TO DFHEIV0
 11762     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11763     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11764     MOVE X'2020233030303130323238' TO DFHEIV0(25:11)
 11765     CALL 'kxdfhei1' USING DFHEIV0,
 11766           TRLR-FILE-ID,
 11767           ACTIVITY-TRAILERS,
 11768           DFHEIV11,
 11769           AT-CONTROL-PRIMARY,
 11770           DFHEIV99,
 11771           DFHEIV99
 11772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11773
 11774
 11775 2650-EXIT.
 11776      EXIT.
 11777
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 222
* EL131.cbl
 11779 3000-DELETE-CLAIM.
 11780     IF  NOT MODIFY-CAP
 11781         MOVE ER-0070            TO EMI-ERROR
 11782         MOVE -1                 TO MAINTL
 11783         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11784         GO TO 8110-SEND-DATA.
 11785
 11786
 11787* EXEC CICS READ
 11788*         SET      (ADDRESS OF CLAIM-MASTER)
 11789*         DATASET  (CLMS-FILE-ID)
 11790*         RIDFLD   (MSTR-KEY)
 11791*    END-EXEC.
 11792*    MOVE '&"S        E          (   #00010245' TO DFHEIV0
 11793     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11794     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11795     MOVE X'2020233030303130323435' TO DFHEIV0(25:11)
 11796     CALL 'kxdfhei1' USING DFHEIV0,
 11797           CLMS-FILE-ID,
 11798           DFHEIV20,
 11799           DFHEIV99,
 11800           MSTR-KEY,
 11801           DFHEIV99,
 11802           DFHEIV99,
 11803           DFHEIV99
 11804     SET ADDRESS OF CLAIM-MASTER TO
 11805         DFHEIV20
 11806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11807
 11808
 11809     IF CL-1ST-TRL-AVAIL
 11810         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 11811     ELSE
 11812        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 11813        MOVE 0                   TO TRLR-SEQ-NO
 11814
 11815* EXEC CICS STARTBR
 11816*            DATASET (TRLR-FILE-ID)
 11817*            RIDFLD  (TRLR-KEY)
 11818*        END-EXEC
 11819     MOVE 0
 11820       TO DFHEIV11
 11821*    MOVE '&,         G          &   #00010256' TO DFHEIV0
 11822     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11823     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11824     MOVE X'2020233030303130323536' TO DFHEIV0(25:11)
 11825     CALL 'kxdfhei1' USING DFHEIV0,
 11826           TRLR-FILE-ID,
 11827           TRLR-KEY,
 11828           DFHEIV99,
 11829           DFHEIV11,
 11830           DFHEIV99
 11831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11832         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 11833
 11834* EXEC CICS ENDBR
 11835*            DATASET (TRLR-FILE-ID)
 11836*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 223
* EL131.cbl
 11837     MOVE 0
 11838       TO DFHEIV11
 11839*    MOVE '&2                    $   #00010261' TO DFHEIV0
 11840     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11841     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11842     MOVE X'2020233030303130323631' TO DFHEIV0(25:11)
 11843     CALL 'kxdfhei1' USING DFHEIV0,
 11844           TRLR-FILE-ID,
 11845           DFHEIV11,
 11846           DFHEIV99
 11847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11848        IF SCREEN-ERROR
 11849            MOVE ER-0208         TO EMI-ERROR
 11850            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11851            MOVE -1              TO MAINTL
 11852            GO TO 8110-SEND-DATA
 11853        ELSE
 11854            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 11855
 11856     IF SCREEN-ERROR
 11857         MOVE -1                 TO MAINTL
 11858         GO TO 8110-SEND-DATA.
 11859
 11860     MOVE -1                     TO ONE-OR-MIN1.
 11861     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 11862
 11863     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 11864         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 11865                                    WS-SAVE-CLAIM-KEY
 11866         MOVE +1                 TO ONE-OR-MIN1
 11867         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 11868
 11869     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 11870
 11871     MOVE LOW-VALUES             TO EL131AO.
 11872     MOVE ER-0000                TO EMI-ERROR.
 11873     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11874     MOVE 'X'                    TO PI-RETURN-CD-1.
 11875     MOVE -1                     TO MAINTL.
 11876     GO TO 8100-SEND-MAP.
 11877
 11878 3010-DEL-MSTR-TRLR.
 11879
 11880* EXEC CICS READ UPDATE
 11881*         SET       (ADDRESS OF CLAIM-MASTER)
 11882*         DATASET   (CLMS-FILE-ID)
 11883*         RIDFLD    (MSTR-KEY)
 11884*    END-EXEC.
 11885*    MOVE '&"S        EU         (   #00010295' TO DFHEIV0
 11886     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11887     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11888     MOVE X'2020233030303130323935' TO DFHEIV0(25:11)
 11889     CALL 'kxdfhei1' USING DFHEIV0,
 11890           CLMS-FILE-ID,
 11891           DFHEIV20,
 11892           DFHEIV99,
 11893           MSTR-KEY,
 11894           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 224
* EL131.cbl
 11895           DFHEIV99,
 11896           DFHEIV99
 11897     SET ADDRESS OF CLAIM-MASTER TO
 11898         DFHEIV20
 11899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11900
 11901
 11902     if (cl-priority-cd = '8')
 11903        and (pi-processor-id not = 'PEMA' and 'JMS '
 11904             AND 'AMWA')
 11905        MOVE ER-8003             TO EMI-ERROR
 11906        PERFORM 9900-ERROR-FORMAT
 11907                                 THRU 9900-EXIT
 11908        MOVE -1                  TO MAINTL
 11909        GO TO 8110-SEND-DATA
 11910     end-if
 11911
 11912     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 11913     MOVE ZERO                   TO TRLR-SEQ-NO.
 11914
 11915
 11916* EXEC CICS HANDLE CONDITION
 11917*         NOTFND    (3010-DEL-ACTQ)
 11918*         ENDFILE   (3040-EXIT)
 11919*    END-EXEC.
 11920*    MOVE '"$I''                  ! ; #00010314' TO DFHEIV0
 11921     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11923     MOVE X'3B20233030303130333134' TO DFHEIV0(25:11)
 11924     CALL 'kxdfhei1' USING DFHEIV0
 11925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11926
 11927
 11928     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 11929
 11930 3010-DEL-ACTQ.
 11931
 11932
 11933* EXEC CICS HANDLE CONDITION
 11934*         NOTFND    (3010-NO-ACTIVITY)
 11935*         ENDFILE   (3050-EXIT)
 11936*    END-EXEC.
 11937*    MOVE '"$I''                  ! < #00010323' TO DFHEIV0
 11938     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11939     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11940     MOVE X'3C20233030303130333233' TO DFHEIV0(25:11)
 11941     CALL 'kxdfhei1' USING DFHEIV0
 11942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11943
 11944
 11945
 11946* EXEC CICS STARTBR
 11947*         DATASET  (ACTQ-FILE-ID)
 11948*         RIDFLD   (ACTQ-KEY)
 11949*    END-EXEC.
 11950     MOVE 0
 11951       TO DFHEIV11
 11952*    MOVE '&,         G          &   #00010328' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 225
* EL131.cbl
 11953     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11954     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11955     MOVE X'2020233030303130333238' TO DFHEIV0(25:11)
 11956     CALL 'kxdfhei1' USING DFHEIV0,
 11957           ACTQ-FILE-ID,
 11958           ACTQ-KEY,
 11959           DFHEIV99,
 11960           DFHEIV11,
 11961           DFHEIV99
 11962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11963
 11964
 11965
 11966* EXEC CICS GETMAIN
 11967*         SET      (ADDRESS OF ACTIVITY-QUE)
 11968*         LENGTH   (ACTQ-LENGTH)
 11969*         INITIMG  (GETMAIN-SPACE)
 11970*    END-EXEC.
 11971*    MOVE ',"IL                  $   #00010333' TO DFHEIV0
 11972     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11973     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11974     MOVE X'2020233030303130333333' TO DFHEIV0(25:11)
 11975     CALL 'kxdfhei1' USING DFHEIV0,
 11976           DFHEIV20,
 11977           ACTQ-LENGTH,
 11978           GETMAIN-SPACE
 11979     SET ADDRESS OF ACTIVITY-QUE TO
 11980         DFHEIV20
 11981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11982
 11983
 11984     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 11985
 11986
 11987* EXEC CICS ENDBR
 11988*         DATASET (ACTQ-FILE-ID)
 11989*    END-EXEC.
 11990     MOVE 0
 11991       TO DFHEIV11
 11992*    MOVE '&2                    $   #00010341' TO DFHEIV0
 11993     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11994     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11995     MOVE X'2020233030303130333431' TO DFHEIV0(25:11)
 11996     CALL 'kxdfhei1' USING DFHEIV0,
 11997           ACTQ-FILE-ID,
 11998           DFHEIV11,
 11999           DFHEIV99
 12000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12001
 12002
 12003 3010-NO-ACTIVITY.
 12004
 12005
 12006* EXEC CICS HANDLE CONDITION
 12007*        NOTFND   (3010-CERT-NOT-FOUND)
 12008*    END-EXEC.
 12009*    MOVE '"$I                   ! = #00010347' TO DFHEIV0
 12010     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 226
* EL131.cbl
 12011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12012     MOVE X'3D20233030303130333437' TO DFHEIV0(25:11)
 12013     CALL 'kxdfhei1' USING DFHEIV0
 12014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12015
 12016
 12017     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12018     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12019     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12020     MOVE CL-CERT-STATE          TO CERT-STATE.
 12021     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12022     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12023     MOVE CL-CERT-NO             TO CERT-CERT.
 12024
 12025
 12026* EXEC CICS READ
 12027*        DATASET   (CERT-FILE-ID)
 12028*        RIDFLD    (CERT-KEY)
 12029*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12030*    END-EXEC.
 12031*    MOVE '&"S        E          (   #00010359' TO DFHEIV0
 12032     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12034     MOVE X'2020233030303130333539' TO DFHEIV0(25:11)
 12035     CALL 'kxdfhei1' USING DFHEIV0,
 12036           CERT-FILE-ID,
 12037           DFHEIV20,
 12038           DFHEIV99,
 12039           CERT-KEY,
 12040           DFHEIV99,
 12041           DFHEIV99,
 12042           DFHEIV99
 12043     SET ADDRESS OF CERTIFICATE-MASTER TO
 12044         DFHEIV20
 12045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12046
 12047
 12048     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12049         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12050     ELSE
 12051         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12052
 12053 3010-CERT-NOT-FOUND.
 12054
 12055
 12056* EXEC CICS DELETE
 12057*        DATASET  (CLMS-FILE-ID)
 12058*    END-EXEC.
 12059*    MOVE '&(                    &   #00010372' TO DFHEIV0
 12060     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12061     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12062     MOVE X'2020233030303130333732' TO DFHEIV0(25:11)
 12063     CALL 'kxdfhei1' USING DFHEIV0,
 12064           CLMS-FILE-ID,
 12065           DFHEIV99,
 12066           DFHEIV99,
 12067           DFHEIV99,
 12068           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 227
* EL131.cbl
 12069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12070
 12071
 12072 3010-EXIT.
 12073      EXIT.
 12074
 12075 3020-UPDATE-CERT.
 12076
 12077* EXEC CICS READ UPDATE
 12078*         DATASET  (CERT-FILE-ID)
 12079*         RIDFLD   (CERT-KEY)
 12080*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12081*    END-EXEC.
 12082*    MOVE '&"S        EU         (   #00010380' TO DFHEIV0
 12083     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12084     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12085     MOVE X'2020233030303130333830' TO DFHEIV0(25:11)
 12086     CALL 'kxdfhei1' USING DFHEIV0,
 12087           CERT-FILE-ID,
 12088           DFHEIV20,
 12089           DFHEIV99,
 12090           CERT-KEY,
 12091           DFHEIV99,
 12092           DFHEIV99,
 12093           DFHEIV99
 12094     SET ADDRESS OF CERTIFICATE-MASTER TO
 12095         DFHEIV20
 12096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12097
 12098
 12099     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 12100
 12101
 12102* EXEC CICS HANDLE CONDITION
 12103*         DUPKEY   (3020-EXIT)
 12104*    END-EXEC.
 12105*    MOVE '"$$                   ! > #00010388' TO DFHEIV0
 12106     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12108     MOVE X'3E20233030303130333838' TO DFHEIV0(25:11)
 12109     CALL 'kxdfhei1' USING DFHEIV0
 12110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12111
 12112
 12113
 12114* EXEC CICS REWRITE
 12115*         DATASET  (CERT-FILE-ID)
 12116*         FROM     (CERTIFICATE-MASTER)
 12117*    END-EXEC.
 12118     MOVE LENGTH OF
 12119      CERTIFICATE-MASTER
 12120       TO DFHEIV11
 12121*    MOVE '&& L                  %   #00010392' TO DFHEIV0
 12122     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12123     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12124     MOVE X'2020233030303130333932' TO DFHEIV0(25:11)
 12125     CALL 'kxdfhei1' USING DFHEIV0,
 12126           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 228
* EL131.cbl
 12127           CERTIFICATE-MASTER,
 12128           DFHEIV11,
 12129           DFHEIV99
 12130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12131
 12132
 12133 3020-EXIT.
 12134     EXIT.
 12135
 12136 3030-DELETE-CERT.
 12137
 12138* EXEC CICS READ UPDATE
 12139*         DATASET  (CERT-FILE-ID)
 12140*         RIDFLD   (CERT-KEY)
 12141*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12142*    END-EXEC.
 12143*    MOVE '&"S        EU         (   #00010401' TO DFHEIV0
 12144     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12145     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12146     MOVE X'2020233030303130343031' TO DFHEIV0(25:11)
 12147     CALL 'kxdfhei1' USING DFHEIV0,
 12148           CERT-FILE-ID,
 12149           DFHEIV20,
 12150           DFHEIV99,
 12151           CERT-KEY,
 12152           DFHEIV99,
 12153           DFHEIV99,
 12154           DFHEIV99
 12155     SET ADDRESS OF CERTIFICATE-MASTER TO
 12156         DFHEIV20
 12157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12158
 12159
 12160
 12161* EXEC CICS DELETE
 12162*         DATASET   (CERT-FILE-ID)
 12163*    END-EXEC.
 12164*    MOVE '&(                    &   #00010407' TO DFHEIV0
 12165     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12166     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12167     MOVE X'2020233030303130343037' TO DFHEIV0(25:11)
 12168     CALL 'kxdfhei1' USING DFHEIV0,
 12169           CERT-FILE-ID,
 12170           DFHEIV99,
 12171           DFHEIV99,
 12172           DFHEIV99,
 12173           DFHEIV99
 12174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12175
 12176
 12177 3030-EXIT.
 12178     EXIT.
 12179
 12180 3040-DELETE-TRLR.
 12181
 12182* EXEC CICS READ
 12183*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12184*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 229
* EL131.cbl
 12185*         RIDFLD   (TRLR-KEY)
 12186*         GTEQ
 12187*    END-EXEC.
 12188*    MOVE '&"S        G          (   #00010415' TO DFHEIV0
 12189     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12191     MOVE X'2020233030303130343135' TO DFHEIV0(25:11)
 12192     CALL 'kxdfhei1' USING DFHEIV0,
 12193           TRLR-FILE-ID,
 12194           DFHEIV20,
 12195           DFHEIV99,
 12196           TRLR-KEY,
 12197           DFHEIV99,
 12198           DFHEIV99,
 12199           DFHEIV99
 12200     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12201         DFHEIV20
 12202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12203
 12204
 12205     IF PI-COMPANY-CD = AT-COMPANY-CD
 12206        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 12207        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12208           GO TO 3040-EXIT
 12209        ELSE
 12210           NEXT SENTENCE
 12211     ELSE
 12212        GO TO 3040-EXIT.
 12213
 12214
 12215* EXEC CICS DELETE
 12216*         DATASET  (TRLR-FILE-ID)
 12217*         RIDFLD   (TRLR-KEY)
 12218*    END-EXEC.
 12219*    MOVE '&(  R                 &   #00010431' TO DFHEIV0
 12220     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12221     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12222     MOVE X'2020233030303130343331' TO DFHEIV0(25:11)
 12223     CALL 'kxdfhei1' USING DFHEIV0,
 12224           TRLR-FILE-ID,
 12225           TRLR-KEY,
 12226           DFHEIV99,
 12227           DFHEIV99,
 12228           DFHEIV99
 12229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12230
 12231
 12232     GO TO 3040-DELETE-TRLR.
 12233
 12234 3040-EXIT.
 12235     EXIT.
 12236
 12237 3050-DELETE-ACTQ.
 12238
 12239* EXEC CICS READNEXT
 12240*         DATASET  (ACTQ-FILE-ID)
 12241*         RIDFLD   (ACTQ-KEY)
 12242*         INTO     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 230
* EL131.cbl
 12243*    END-EXEC.
 12244     MOVE LENGTH OF
 12245      ACTIVITY-QUE
 12246       TO DFHEIV12
 12247     MOVE 0
 12248       TO DFHEIV11
 12249*    MOVE '&.IL                  )   #00010442' TO DFHEIV0
 12250     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12251     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12252     MOVE X'2020233030303130343432' TO DFHEIV0(25:11)
 12253     CALL 'kxdfhei1' USING DFHEIV0,
 12254           ACTQ-FILE-ID,
 12255           ACTIVITY-QUE,
 12256           DFHEIV12,
 12257           ACTQ-KEY,
 12258           DFHEIV99,
 12259           DFHEIV11,
 12260           DFHEIV99,
 12261           DFHEIV99
 12262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12263
 12264
 12265     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 12266         GO TO 3050-EXIT.
 12267
 12268
 12269* EXEC CICS ENDBR
 12270*         DATASET  (ACTQ-FILE-ID)
 12271*    END-EXEC.
 12272     MOVE 0
 12273       TO DFHEIV11
 12274*    MOVE '&2                    $   #00010451' TO DFHEIV0
 12275     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12276     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12277     MOVE X'2020233030303130343531' TO DFHEIV0(25:11)
 12278     CALL 'kxdfhei1' USING DFHEIV0,
 12279           ACTQ-FILE-ID,
 12280           DFHEIV11,
 12281           DFHEIV99
 12282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12283
 12284
 12285
 12286* EXEC CICS DELETE
 12287*         DATASET   (ACTQ-FILE-ID)
 12288*         RIDFLD    (ACTQ-KEY)
 12289*    END-EXEC.
 12290*    MOVE '&(  R                 &   #00010455' TO DFHEIV0
 12291     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12292     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12293     MOVE X'2020233030303130343535' TO DFHEIV0(25:11)
 12294     CALL 'kxdfhei1' USING DFHEIV0,
 12295           ACTQ-FILE-ID,
 12296           ACTQ-KEY,
 12297           DFHEIV99,
 12298           DFHEIV99,
 12299           DFHEIV99
 12300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 231
* EL131.cbl
 12301
 12302
 12303
 12304* EXEC CICS STARTBR
 12305*         DATASET   (ACTQ-FILE-ID)
 12306*         RIDFLD    (ACTQ-KEY)
 12307*    END-EXEC.
 12308     MOVE 0
 12309       TO DFHEIV11
 12310*    MOVE '&,         G          &   #00010460' TO DFHEIV0
 12311     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12312     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12313     MOVE X'2020233030303130343630' TO DFHEIV0(25:11)
 12314     CALL 'kxdfhei1' USING DFHEIV0,
 12315           ACTQ-FILE-ID,
 12316           ACTQ-KEY,
 12317           DFHEIV99,
 12318           DFHEIV11,
 12319           DFHEIV99
 12320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12321
 12322
 12323     GO TO 3050-DELETE-ACTQ.
 12324
 12325 3050-EXIT.
 12326     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 232
* EL131.cbl
 12328 3060-READ-TRLR.
 12329
 12330* EXEC CICS HANDLE CONDITION
 12331*         NOTFND    (3060-EXIT)
 12332*         ENDFILE   (3060-EXIT)
 12333*    END-EXEC.
 12334*    MOVE '"$I''                  ! ? #00010471' TO DFHEIV0
 12335     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12337     MOVE X'3F20233030303130343731' TO DFHEIV0(25:11)
 12338     CALL 'kxdfhei1' USING DFHEIV0
 12339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12340
 12341
 12342 3060-LOOP.
 12343
 12344* EXEC CICS READNEXT
 12345*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12346*         DATASET  (TRLR-FILE-ID)
 12347*         RIDFLD   (TRLR-KEY)
 12348*    END-EXEC.
 12349     MOVE 0
 12350       TO DFHEIV11
 12351*    MOVE '&.S                   )   #00010477' TO DFHEIV0
 12352     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12353     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12354     MOVE X'2020233030303130343737' TO DFHEIV0(25:11)
 12355     CALL 'kxdfhei1' USING DFHEIV0,
 12356           TRLR-FILE-ID,
 12357           DFHEIV20,
 12358           DFHEIV99,
 12359           TRLR-KEY,
 12360           DFHEIV99,
 12361           DFHEIV11,
 12362           DFHEIV99,
 12363           DFHEIV99
 12364     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12365         DFHEIV20
 12366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12367
 12368
 12369     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12370         GO TO 3060-EXIT.
 12371
 12372     IF FORM-CONTROL-TR
 12373         IF AT-RECORDED-DT = SAVE-BIN-DATE
 12374             NEXT SENTENCE
 12375         ELSE
 12376             MOVE 'X'            TO ERROR-SWITCH
 12377             GO TO 3060-EXIT
 12378     ELSE
 12379         IF PAYMENT-TR OR CORRESPONDENCE-TR
 12380            MOVE 'X'                 TO ERROR-SWITCH
 12381            GO TO 3060-EXIT.
 12382
 12383     GO TO 3060-LOOP.
 12384
 12385 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 233
* EL131.cbl
 12386     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 234
* EL131.cbl
 12388 4000-FORCE-ERRORS.
 12389     IF PI-RETURN-CD-1 = 'X'
 12390         MOVE ER-0311            TO EMI-ERROR
 12391         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12392         MOVE -1                 TO MAINTL
 12393         GO TO 8110-SEND-DATA.
 12394
 12395     IF NOT FORCE-CAP
 12396         MOVE ER-0416            TO EMI-ERROR
 12397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12398         MOVE -1                 TO MAINTL
 12399         GO TO 8110-SEND-DATA.
 12400
 12401     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 12402     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 12403     IF EMI-FATAL-CTR GREATER THAN ZERO
 12404         GO TO 4000-FATAL-ERRORS.
 12405
 12406     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 12407
 12408     IF EMI-FATAL-CTR GREATER THAN ZERO
 12409         GO TO 4000-FATAL-ERRORS.
 12410
 12411     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 12412
 12413     IF EMI-FATAL-CTR GREATER THAN ZERO
 12414         GO TO 4000-FATAL-ERRORS.
 12415
 12416     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 12417     MOVE AL-UANOF               TO CERTA.
 12418     MOVE ER-0000 TO EMI-ERROR.
 12419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12420
 12421 4000-FATAL-ERRORS.
 12422     MOVE -1                     TO MAINTL.
 12423     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 235
* EL131.cbl
 12425 5000-BUILD-MAP.
 12426     IF PI-RETURN-CD-1 = SPACE
 12427         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 12428
 12429     MOVE SPACE                  TO PI-RETURN-CD-1.
 12430
 12431     MOVE LOW-VALUES             TO EL131AI.
 12432
 12433     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 12434     MOVE PI-CARRIER             TO CARRIER-CODE.
 12435     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 12436     MOVE PI-CERT-NO             TO CERT-NO.
 12437
 12438 5000-READ-CLAIM-MASTER.
 12439
 12440
 12441* EXEC CICS READ
 12442*         SET      (ADDRESS OF CLAIM-MASTER)
 12443*         DATASET  (CLMS-FILE-ID)
 12444*         RIDFLD   (MSTR-KEY)
 12445*    END-EXEC.
 12446*    MOVE '&"S        E          (   #00010554' TO DFHEIV0
 12447     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12448     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12449     MOVE X'2020233030303130353534' TO DFHEIV0(25:11)
 12450     CALL 'kxdfhei1' USING DFHEIV0,
 12451           CLMS-FILE-ID,
 12452           DFHEIV20,
 12453           DFHEIV99,
 12454           MSTR-KEY,
 12455           DFHEIV99,
 12456           DFHEIV99,
 12457           DFHEIV99
 12458     SET ADDRESS OF CLAIM-MASTER TO
 12459         DFHEIV20
 12460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12461
 12462
 12463     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 12464
 12465 5000-READ-DIAGNOSIS-TRAILER.
 12466
 12467
 12468* EXEC CICS HANDLE CONDITION
 12469*         NOTFND (5000-TRLR-NOT-FOUND)
 12470*    END-EXEC.
 12471*    MOVE '"$I                   ! @ #00010564' TO DFHEIV0
 12472     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12474     MOVE X'4020233030303130353634' TO DFHEIV0(25:11)
 12475     CALL 'kxdfhei1' USING DFHEIV0
 12476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12477
 12478
 12479     MOVE MSTR-KEY               TO TRLR-KEY.
 12480     MOVE NINETY                 TO TRLR-SEQ-NO.
 12481
 12482
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 236
* EL131.cbl
 12483* EXEC CICS READ
 12484*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12485*         DATASET  (TRLR-FILE-ID)
 12486*         RIDFLD   (TRLR-KEY)
 12487*    END-EXEC.
 12488*    MOVE '&"S        E          (   #00010571' TO DFHEIV0
 12489     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12491     MOVE X'2020233030303130353731' TO DFHEIV0(25:11)
 12492     CALL 'kxdfhei1' USING DFHEIV0,
 12493           TRLR-FILE-ID,
 12494           DFHEIV20,
 12495           DFHEIV99,
 12496           TRLR-KEY,
 12497           DFHEIV99,
 12498           DFHEIV99,
 12499           DFHEIV99
 12500     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12501         DFHEIV20
 12502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12503
 12504
 12505     MOVE AT-INFO-LINE-1         TO DIAGO.
 12506
 12507 5000-READ-CERTIFICATE-MASTER.
 12508
 12509     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 12510     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 12511     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 12512     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 12513     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 12514     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 12515     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 12516
 12517
 12518* EXEC CICS HANDLE CONDITION
 12519*         NOTFND (5000-CERT-NOT-FOUND)
 12520*    END-EXEC.
 12521*    MOVE '"$I                   ! A #00010589' TO DFHEIV0
 12522     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12523     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12524     MOVE X'4120233030303130353839' TO DFHEIV0(25:11)
 12525     CALL 'kxdfhei1' USING DFHEIV0
 12526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12527
 12528
 12529
 12530* EXEC CICS READ
 12531*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12532*         DATASET  (CERT-FILE-ID)
 12533*         RIDFLD   (CERT-KEY)
 12534*    END-EXEC.
 12535*    MOVE '&"S        E          (   #00010593' TO DFHEIV0
 12536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12538     MOVE X'2020233030303130353933' TO DFHEIV0(25:11)
 12539     CALL 'kxdfhei1' USING DFHEIV0,
 12540           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 237
* EL131.cbl
 12541           DFHEIV20,
 12542           DFHEIV99,
 12543           CERT-KEY,
 12544           DFHEIV99,
 12545           DFHEIV99,
 12546           DFHEIV99
 12547     SET ADDRESS OF CERTIFICATE-MASTER TO
 12548         DFHEIV20
 12549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12550
 12551
 12552     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 12553     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 12554
 12555     GO TO 5000-EXIT.
 12556
 12557 5000-TRLR-NOT-FOUND.
 12558     MOVE ER-7687                TO EMI-ERROR.
 12559     MOVE -1                     TO DIAGL.
 12560     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12561     GO TO 5000-EXIT.
 12562
 12563 5000-CERT-NOT-FOUND.
 12564     MOVE ER-0206                TO EMI-ERROR.
 12565     MOVE -1                     TO CERTL.
 12566     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12567
 12568 5000-EXIT.
 12569     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 238
* EL131.cbl
 12571 5010-RESET-PI-AREA.
 12572     IF CERTI GREATER THAN LOW-VALUES
 12573         MOVE CERTI              TO PI-CERT-PRIME.
 12574
 12575     IF SUFXI GREATER THAN LOW-VALUES
 12576         MOVE SUFXI              TO PI-CERT-SFX.
 12577
 12578     IF CERTEFFI GREATER THAN LOW-VALUES
 12579         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 12580
 12581     IF CERTACTI GREATER THAN LOW-VALUES
 12582         MOVE CERTACTI           TO PI-ACCOUNT.
 12583
 12584     IF CERTSTI GREATER THAN LOW-VALUES
 12585         MOVE CERTSTI            TO PI-STATE.
 12586
 12587     IF CERTCARI GREATER THAN LOW-VALUES
 12588         MOVE CERTCARI           TO PI-CARRIER.
 12589
 12590     IF CERTGRPI GREATER THAN LOW-VALUES
 12591         MOVE CERTGRPI           TO PI-GROUPING.
 12592
 12593 5010-EXIT.
 12594     EXIT.
 12595
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 239
* EL131.cbl
 12597 5020-MOVE-MSTR.
 12598
 12599     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 12600     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 12601     MOVE WS-CLAIM-SEQU          TO SEQUO.
 12602     MOVE AL-SABON               TO SEQUA.
 12603     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 12604     MOVE CL-CLAIM-TYPE          TO TYPEO.
 12605
 12606     IF CL-TOTAL-PAID-AMT  = +0 AND
 12607        CL-LAST-PMT-AMT    = +0 AND
 12608        CL-NO-OF-PMTS-MADE = +0
 12609          MOVE AL-UANON          TO TYPEA.
 12610
 12611     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 12612     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 12613     MOVE CL-CERT-PRIME          TO CERTO.
 12614     MOVE CL-CERT-SFX            TO SUFXO.
 12615     MOVE CL-CERT-CARRIER        TO CARRO.
 12616
 12617     IF CL-CLAIM-STATUS = 'C'
 12618         MOVE 'CLOSED'           TO STATUSO
 12619     ELSE
 12620         MOVE 'OPEN  '           TO STATUSO.
 12621
 12622     MOVE CL-PROCESSOR-ID        TO PROCO.
 12623
 12624     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 12625     MOVE CL-CCN                 TO CCNOO.
 12626
 12627     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 12628     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 12629     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 12630     MOVE CL-INSURED-SEX-CD      TO SEXO.
 12631
 12632     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 12633         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 12634         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12635         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12636         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 12637     ELSE
 12638         MOVE SPACES             TO BIRTHO.
 12639
 12640     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 12641        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 12642         NEXT SENTENCE
 12643       ELSE
 12644         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 12645
 12646     IF PI-COMPANY-ID = 'DMD'
 12647       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 12648          IF SOCIALO = SPACES OR LOW-VALUES
 12649            MOVE ER-0885         TO EMI-ERROR
 12650            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12651
 12652     MOVE CL-INSURED-OCC-CD      TO OCCO.
 12653     MOVE CL-CAUSE-CD            TO CAUSEO.
 12654
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 240
* EL131.cbl
 12655     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 12656         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 12657         MOVE SPACES                 TO DC-OPTION-CODE
 12658         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12659         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 12660     ELSE
 12661         MOVE SPACES             TO ENDO.
 12662
 12663     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 12664        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12665        MOVE SPACES             TO DC-OPTION-CODE
 12666        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12667        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12668        IF PI-USES-PAID-TO
 12669           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12670           MOVE '6'                TO DC-OPTION-CODE
 12671           MOVE +1                 TO DC-ELAPSED-DAYS
 12672           MOVE +0                 TO DC-ELAPSED-MONTHS
 12673           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12674           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12675        ELSE
 12676           NEXT SENTENCE
 12677     ELSE
 12678        MOVE SPACES             TO PDTHRUO.
 12679
 12680     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 12681     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 12682     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 12683     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 12684
 12685     IF MODIFY-CAP
 12686        MOVE AL-UNNOF            TO PDAMTA
 12687                                    NODAYSA
 12688                                    NOPMTSA
 12689        MOVE AL-UANOF            TO PDTHRUA.
 12690
 12691     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 12692         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12693         MOVE SPACES             TO DC-OPTION-CODE
 12694         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12695         MOVE DC-GREG-DATE-1-EDIT TO INCO
 12696     ELSE
 12697         MOVE SPACES             TO INCO.
 12698
 12699     IF CL-NO-OF-PMTS-MADE = ZEROS
 12700        MOVE AL-UANOF            TO INCA.
 12701
 12702     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 12703
 12704     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 12705         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 12706         MOVE SPACES             TO DC-OPTION-CODE
 12707         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12708         MOVE DC-GREG-DATE-1-EDIT TO REPO
 12709     ELSE
 12710         MOVE SPACES             TO REPO.
 12711
 12712     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 241
* EL131.cbl
 12713         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 12714         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12715         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12716         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 12717     ELSE
 12718         MOVE SPACES             TO ESTO.
 12719
 12720     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 12721         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 12722         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12723         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12724         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 12725     ELSE
 12726         MOVE SPACES             TO MNTDTO.
 12727
 12728
 12729     IF CL-LAST-MAINT-TYPE = SPACE
 12730         MOVE 'SET-UP'           TO MNTTYPEO
 12731     ELSE
 12732     IF CL-LAST-MAINT-TYPE = '1'
 12733         MOVE 'PAYMNT'           TO MNTTYPEO
 12734     ELSE
 12735     IF CL-LAST-MAINT-TYPE = '2'
 12736         MOVE 'LETTER'           TO MNTTYPEO
 12737     ELSE
 12738     IF CL-LAST-MAINT-TYPE = '3'
 12739         MOVE 'UPDATE'           TO MNTTYPEO
 12740     ELSE
 12741     IF CL-LAST-MAINT-TYPE = '4'
 12742         MOVE 'RESTOR'           TO MNTTYPEO
 12743     ELSE
 12744     IF CL-LAST-MAINT-TYPE = '5'
 12745         MOVE 'INC DT'           TO MNTTYPEO
 12746     ELSE
 12747     IF CL-LAST-MAINT-TYPE = '6'
 12748         MOVE ' CONV'            TO MNTTYPEO
 12749     ELSE
 12750     IF CL-LAST-MAINT-TYPE = 'C'
 12751         MOVE 'CHGBEN'           TO MNTTYPEO
 12752     ELSE
 12753     IF CL-LAST-MAINT-TYPE = 'E'
 12754         MOVE 'ERRCOR'           TO MNTTYPEO
 12755     ELSE
 12756         MOVE SPACES             TO MNTTYPEO.
 12757
 12758     MOVE CL-BENEFICIARY         TO BENEO.
 12759     MOVE CL-FILE-LOCATION       TO FILETOO.
 12760     MOVE CL-PRIORITY-CD         TO PRICDO.
 12761     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 12762     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 12763     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 12764
 12765 5020-EXIT.
 12766     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 242
* EL131.cbl
 12768 5030-MOVE-CERT.
 12769
 12770     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 12771         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12772         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12773         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12774         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 12775       ELSE
 12776         MOVE SPACES             TO CERTEFFO
 12777         MOVE ZERO               TO HOLD-DATE.
 12778
 12779     MOVE CM-ACCOUNT             TO CERTACTO.
 12780     MOVE CM-STATE               TO CERTSTO PI-STATE.
 12781     MOVE CM-GROUPING            TO CERTGRPO.
 12782     MOVE CM-CARRIER             TO CERTCARO.
 12783     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 12784     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 12785     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 12786     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 12787     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 12788     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 12789     MOVE CM-JT-INITIAL          TO JNTINITO.
 12790     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 12791
 12792*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 12793     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12794     MOVE '3'                    TO CNTL-REC-TYPE.
 12795     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 12796     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 12797     MOVE ZERO                   TO CNTL-SEQ-NO.
 12798
 12799
 12800* EXEC CICS READ
 12801*         SET        (ADDRESS OF CONTROL-FILE)
 12802*         DATASET    ('ELCNTL')
 12803*         RIDFLD     (CNTL-KEY)
 12804*         RESP       (WS-RESPONSE)
 12805*    END-EXEC.
 12806     MOVE 'ELCNTL' TO DFHEIV1
 12807*    MOVE '&"S        E          (  N#00010846' TO DFHEIV0
 12808     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12810     MOVE X'204E233030303130383436' TO DFHEIV0(25:11)
 12811     CALL 'kxdfhei1' USING DFHEIV0,
 12812           DFHEIV1,
 12813           DFHEIV20,
 12814           DFHEIV99,
 12815           CNTL-KEY,
 12816           DFHEIV99,
 12817           DFHEIV99,
 12818           DFHEIV99
 12819     SET ADDRESS OF CONTROL-FILE TO
 12820         DFHEIV20
 12821     MOVE EIBRESP  TO WS-RESPONSE
 12822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12823
 12824
 12825     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 243
* EL131.cbl
 12826        MOVE ZERO                TO CP-FREE-LOOK
 12827     ELSE
 12828        MOVE CF-ST-FREE-LOOK-PERIOD
 12829                                 TO CP-FREE-LOOK.
 12830
 12831     IF CM-LF-BENEFIT-CD = '00'
 12832        GO TO 5030-MOVE-CERT-AH.
 12833
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 244
* EL131.cbl
 12835     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 12836     MOVE '5'                    TO DC-OPTION-CODE
 12837     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12838     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 12839     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 12840     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 12841     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 12842     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 12843     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12844     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 12845     MOVE '4'                    TO CP-REM-TERM-METHOD
 12846     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 12847     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12848     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 12849
 12850     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 12851     IF CM-LF-PREMIUM-RATE NUMERIC
 12852         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 12853     ELSE
 12854         MOVE ZEROS              TO LCVRATEO.
 12855
 12856     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 12857         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 12858
 12859     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 12860
 12861     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 12862
 12863     IF CM-LF-CURRENT-STATUS = '8'
 12864        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 12865            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 12866            MOVE ' '             TO DC-OPTION-CODE
 12867            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12868            IF NOT DATE-CONVERSION-ERROR
 12869                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 12870
 12871     IF CM-LF-CURRENT-STATUS = '7'
 12872        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12873            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 12874            MOVE ' '             TO DC-OPTION-CODE
 12875            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12876            IF NOT DATE-CONVERSION-ERROR
 12877                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 12878
 12879     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 12880         MOVE ' '                TO DC-OPTION-CODE
 12881         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 12882         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12883         IF NOT DATE-CONVERSION-ERROR
 12884             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 12885             MOVE HOLD-MONTH     TO WORK-MONTH
 12886             MOVE HOLD-YEAR      TO WORK-YEAR
 12887             MOVE WORK-DATE-MY   TO LCVEXITO.
 12888
 12889     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 12890        IF CP-REMAINING-TERM-3 = ZEROS
 12891           MOVE 'EXPIRED'        TO LCVSTATO
 12892        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 245
* EL131.cbl
 12893           MOVE 'ACTIVE'         TO LCVSTATO.
 12894
 12895     IF CM-LF-CURRENT-STATUS = '2'
 12896        MOVE 'PEND   '           TO LCVSTATO.
 12897     IF CM-LF-CURRENT-STATUS = '3'
 12898        MOVE 'RESTORE'           TO LCVSTATO.
 12899     IF CM-LF-CURRENT-STATUS = '5'
 12900        MOVE 'REISSUE'           TO LCVSTATO.
 12901     IF CM-LF-CURRENT-STATUS = '6'
 12902        MOVE 'LMP DIS'           TO LCVSTATO.
 12903     IF CM-LF-CURRENT-STATUS = '7'
 12904        MOVE 'DEATH  '           TO LCVSTATO.
 12905     IF CM-LF-CURRENT-STATUS = '8'
 12906        MOVE 'CANCEL '           TO LCVSTATO.
 12907     IF CM-LF-CURRENT-STATUS = '9'
 12908        MOVE 'RE-ONLY'           TO LCVSTATO.
 12909     IF CM-LF-CURRENT-STATUS = 'V'
 12910        MOVE 'VOID   '           TO LCVSTATO.
 12911     IF CM-LF-CURRENT-STATUS = 'D'
 12912        MOVE 'DECLINE'           TO LCVSTATO.
 12913
 12914     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 12915     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 12916     MOVE '4'                    TO BEN-REC-TYPE.
 12917     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 12918     MOVE ZERO                   TO BEN-SEQ-NO.
 12919
 12920
 12921* EXEC CICS READ GTEQ
 12922*         DATASET  (CNTL-FILE-ID)
 12923*         RIDFLD   (BENEFIT-KEY)
 12924*         SET      (ADDRESS OF CONTROL-FILE)
 12925*    END-EXEC.
 12926*    MOVE '&"S        G          (   #00010948' TO DFHEIV0
 12927     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12928     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12929     MOVE X'2020233030303130393438' TO DFHEIV0(25:11)
 12930     CALL 'kxdfhei1' USING DFHEIV0,
 12931           CNTL-FILE-ID,
 12932           DFHEIV20,
 12933           DFHEIV99,
 12934           BENEFIT-KEY,
 12935           DFHEIV99,
 12936           DFHEIV99,
 12937           DFHEIV99
 12938     SET ADDRESS OF CONTROL-FILE TO
 12939         DFHEIV20
 12940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12941
 12942
 12943     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 12944        CF-RECORD-TYPE NOT = '4'
 12945         MOVE ER-0240            TO EMI-ERROR
 12946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12947         GO TO 5030-MOVE-CERT-FINISH.
 12948
 12949     MOVE ZERO                   TO COUNT-2.
 12950     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 246
* EL131.cbl
 12951
 12952     IF SCREEN-ERROR
 12953         MOVE ER-0282            TO EMI-ERROR
 12954         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12955        ELSE
 12956         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 12957
 12958 5030-MOVE-CERT-AH.
 12959
 12960     IF CM-LF-BENEFIT-CD = '00'
 12961         IF CM-AH-BENEFIT-CD = '00'
 12962             GO TO 5030-MOVE-CERT-FINISH.
 12963
 12964     IF CM-AH-BENEFIT-CD = '00'
 12965        MOVE SPACES             TO ACVKINDO
 12966        COMPUTE PI-PAYMENT-AMT =
 12967                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 12968        GO TO 5030-MOVE-CERT-FINISH.
 12969
 12970     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 12971     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 12972     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 12973     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 12974     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 12975     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12976     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12977     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 12978
 12979**DMD **********************************************
 12980     IF PI-COMPANY-ID = 'DMD'
 12981         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 12982                                   CM-PMT-EXTENSION-DAYS
 12983         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 12984                                      CL-NO-OF-DAYS-PAID
 12985         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 12986             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 12987         MOVE WS-REM-MOS         TO ACVRTRMO
 12988                                    CP-REMAINING-TERM-3
 12989         MOVE WS-REM-DAYS        TO DAYSPO
 12990         GO TO 5030-SKIP-RTRM.
 12991**DMD **********************************************
 12992
 12993     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12994     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12995     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 12996     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 12997
 12998 5030-SKIP-RTRM.
 12999     IF CM-AH-PREMIUM-RATE NUMERIC
 13000         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13001     ELSE
 13002         MOVE ZEROS              TO ACVRATEO.
 13003
 13004     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 13005     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 13006
 13007     IF CM-AH-CURRENT-STATUS = '8'
 13008        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 247
* EL131.cbl
 13009            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13010            MOVE ' '             TO DC-OPTION-CODE
 13011            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13012            IF NOT DATE-CONVERSION-ERROR
 13013                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13014
 13015     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13016        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13017            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 13018            MOVE ' '             TO DC-OPTION-CODE
 13019            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13020            IF NOT DATE-CONVERSION-ERROR
 13021                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13022
 13023     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13024        IF CP-REMAINING-TERM-3 = ZEROS
 13025           MOVE 'EXPIRED'        TO ACVSTATO
 13026        ELSE
 13027           MOVE 'ACTIVE'         TO ACVSTATO.
 13028
 13029     IF CM-AH-CURRENT-STATUS = '2'
 13030        MOVE 'PEND   '           TO ACVSTATO.
 13031     IF CM-AH-CURRENT-STATUS = '3'
 13032        MOVE 'RESTORE'           TO ACVSTATO.
 13033     IF CM-AH-CURRENT-STATUS = '5'
 13034        MOVE 'REISSUE'           TO ACVSTATO.
 13035     IF CM-AH-CURRENT-STATUS = '6'
 13036        MOVE 'LMP DIS'           TO ACVSTATO.
 13037     IF CM-AH-CURRENT-STATUS = '7'
 13038        MOVE 'DEATH  '           TO ACVSTATO.
 13039     IF CM-AH-CURRENT-STATUS = '8'
 13040        MOVE 'CANCEL '           TO ACVSTATO.
 13041     IF CM-AH-CURRENT-STATUS = '9'
 13042        MOVE 'RE-ONLY'           TO ACVSTATO.
 13043     IF CM-AH-CURRENT-STATUS = 'V'
 13044        MOVE 'VOID   '           TO ACVSTATO.
 13045     IF CM-AH-CURRENT-STATUS = '9'
 13046        MOVE 'DECLINE'           TO ACVSTATO.
 13047
 13048     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13049         MOVE ' '                TO DC-OPTION-CODE
 13050         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13051         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13052         IF NOT DATE-CONVERSION-ERROR
 13053             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 13054             MOVE HOLD-MONTH     TO WORK-MONTH
 13055             MOVE HOLD-YEAR      TO WORK-YEAR
 13056             MOVE WORK-DATE-MY   TO ACVEXITO.
 13057
 13058     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13059
 13060     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13061     MOVE '5'                    TO BEN-REC-TYPE.
 13062     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 13063     MOVE ZERO                   TO BEN-SEQ-NO.
 13064
 13065
 13066* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 248
* EL131.cbl
 13067*         DATASET  (CNTL-FILE-ID)
 13068*         RIDFLD   (BENEFIT-KEY)
 13069*         SET      (ADDRESS OF CONTROL-FILE)
 13070*    END-EXEC.
 13071*    MOVE '&"S        G          (   #00011076' TO DFHEIV0
 13072     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13073     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13074     MOVE X'2020233030303131303736' TO DFHEIV0(25:11)
 13075     CALL 'kxdfhei1' USING DFHEIV0,
 13076           CNTL-FILE-ID,
 13077           DFHEIV20,
 13078           DFHEIV99,
 13079           BENEFIT-KEY,
 13080           DFHEIV99,
 13081           DFHEIV99,
 13082           DFHEIV99
 13083     SET ADDRESS OF CONTROL-FILE TO
 13084         DFHEIV20
 13085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13086
 13087
 13088     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13089        CF-RECORD-TYPE NOT = '5'
 13090         MOVE ER-0250            TO EMI-ERROR
 13091         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13092         GO TO 5030-MOVE-CERT-FINISH.
 13093
 13094     MOVE ZERO                   TO COUNT-2.
 13095     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 13096
 13097     IF SCREEN-ERROR
 13098         MOVE ER-0283            TO EMI-ERROR
 13099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13100       ELSE
 13101         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 13102
 13103 5030-MOVE-CERT-FINISH.
 13104
 13105     MOVE CM-LOAN-APR            TO APRO.
 13106     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13107     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13108     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 13109     MOVE CM-LOAN-NUMBER         TO LOANNOO
 13110     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 13111     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 13112
 13113     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 13114         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13115         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13116         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13117         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 13118     ELSE
 13119         MOVE SPACES               TO ADDONDTO.
 13120
 13121     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 13122
 13123 5030-EXIT.
 13124     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 249
* EL131.cbl
 13126 5040-FIND-BENEFIT.
 13127     ADD 1                       TO COUNT-2.
 13128     IF COUNT-2 GREATER THAN 8
 13129         GO TO 5050-BENEFIT-NOTFND.
 13130
 13131     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 13132         GO TO 5060-EXIT.
 13133
 13134     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 13135         GO TO 5050-BENEFIT-NOTFND.
 13136
 13137     GO TO 5040-FIND-BENEFIT.
 13138
 13139 5050-BENEFIT-NOTFND.
 13140     MOVE 'X'                    TO ERROR-SWITCH.
 13141
 13142 5060-EXIT.
 13143     EXIT.
 13144
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 250
* EL131.cbl
 13146 6000-CALCULATE-CERT-TERM.
 13147
 13148     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 13149         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 13150     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 13151         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 13152     IF CM-LOAN-APR NOT NUMERIC
 13153         MOVE ZEROS              TO CM-LOAN-APR.
 13154
 13155*    IF WS-CALC-METHOD  = 'G'
 13156         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 13157*     ELSE
 13158*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 13159
 13160     IF N GREATER 120
 13161         MOVE 120                TO N.
 13162
 13163     MOVE '6'                    TO DC-OPTION-CODE.
 13164     MOVE N                      TO DC-ELAPSED-MONTHS.
 13165     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13166     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13167
 13168     IF CM-LF-BENEFIT-CD NOT = ZERO
 13169         MOVE N                  TO CM-LF-ORIG-TERM
 13170         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 13171         IF NO-CONVERSION-ERROR
 13172             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 13173
 13174     IF CM-AH-BENEFIT-CD NOT = ZERO
 13175         MOVE N                  TO CM-AH-ORIG-TERM
 13176         IF NO-CONVERSION-ERROR
 13177             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 13178
 13179 6000-EXIT.
 13180      EXIT.
 13181
 13182 6100-CALC-GROSS-TERM.
 13183     MOVE CM-LOAN-BALANCE         TO L.
 13184     MOVE PI-PAYMENT-AMT          TO M.
 13185
 13186     COMPUTE N = L / M.
 13187     IF N LESS 1
 13188         MOVE 1  TO N.
 13189
 13190     IF CM-LF-BENEFIT-CD NOT = ZERO
 13191         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 13192     ELSE
 13193         MOVE ZEROS               TO WS-LF-RATE.
 13194
 13195     IF CM-AH-BENEFIT-CD NOT = ZERO
 13196         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 13197     ELSE
 13198         MOVE ZEROS               TO WS-AH-RATE.
 13199
 13200     COMPUTE I = CM-LOAN-APR / +1200.
 13201
 13202 6105-LOOP.
 13203     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 251
* EL131.cbl
 13204         GO TO 6200-EXIT.
 13205     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 13206     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 13207         ADD 1 TO N
 13208         GO TO 6105-LOOP.
 13209
 13210 6200-EXIT.
 13211      EXIT.
 13212
 13213 6210-CALC-LEFT-RIGHTONE.
 13214      MOVE L         TO LEFT-TOT-1.
 13215      SUBTRACT 1 FROM N.
 13216      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13217      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 13218      ADD 1 TO N.
 13219 6211-CALC-TERM1.
 13220      MOVE N         TO TERM1.
 13221      MULTIPLY M BY TERM1.
 13222 6212-LOOP.
 13223      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 13224      ADD 1 TO A-N.
 13225      MULTIPLY A-N BY TERM1.
 13226      SUBTRACT 1 FROM A-N.
 13227      ADD TERM1 TO LEFT-TOT-1.
 13228 6213-CALC-TERM2.
 13229      MOVE M         TO TERM2.
 13230      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 13231      MULTIPLY IA-N BY TERM2.
 13232      SUBTRACT TERM2 FROM LEFT-TOT-1.
 13233 6215-CALC-RIGHTONE.
 13234      MOVE M         TO RIGHT-TOT-1.
 13235      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13236      MULTIPLY A-N BY RIGHT-TOT-1.
 13237 6220-EXIT.
 13238      EXIT.
 13239
 13240 6300-CALC-A-N.
 13241     IF N LESS 1
 13242         MOVE 0     TO A-N
 13243         GO TO 6300-EXIT.
 13244     IF I = 0
 13245         MOVE .00001 TO I.
 13246     ADD 1 TO I.
 13247     DIVIDE I INTO 1 GIVING V.
 13248     SUBTRACT 1 FROM I.
 13249     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13250     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 13251     DIVIDE I INTO TERM3 GIVING A-N.
 13252 6300-EXIT.
 13253      EXIT.
 13254
 13255 6350-CALC-IA-N.
 13256     IF N LESS 1
 13257         MOVE 0      TO IA-N
 13258         GO TO 6400-EXIT.
 13259     ADD 1 TO N.
 13260     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13261     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 252
* EL131.cbl
 13262     MULTIPLY N BY V-EX-N GIVING TERM3.
 13263     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 13264     SUBTRACT V FROM 1 GIVING TERM4.
 13265     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 13266 6400-EXIT.
 13267      EXIT.
 13268
 13269 6450-CALC-V-EX-N.
 13270     IF N LESS 1
 13271         MOVE 1    TO V-EX-N
 13272         GO TO 6490-EXIT.
 13273     MOVE N        TO NV-STORE.
 13274     IF V-EX-ONETIME = 1  OR
 13275        V NOT = V-EXPONENT (1)
 13276          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 13277 6460-LOOP.
 13278     IF N GREATER 248
 13279         MOVE 248 TO N.
 13280     IF N = 1
 13281         MOVE V               TO V-EX-N
 13282      ELSE
 13283         MOVE V-EXPONENT (N)  TO V-EX-N.
 13284     GO TO 6490-EXIT.
 13285
 13286 6470-BUILD-V-EX-TABLE.
 13287     MOVE 2      TO N.
 13288     MOVE V      TO V-EXPONENT (1)
 13289                    V-EX-N.
 13290 6471-LOOP.
 13291     MULTIPLY V BY V-EX-N.
 13292     MOVE V-EX-N   TO V-EXPONENT (N).
 13293     ADD 1 TO N.
 13294     IF N LESS 248
 13295         GO TO 6471-LOOP.
 13296     MOVE NV-STORE     TO N.
 13297     MOVE 0            TO V-EX-ONETIME.
 13298 6480-EXIT.
 13299      EXIT.
 13300
 13301 6490-EXIT.
 13302      EXIT.
 13303
 13304 6500-CALC-NET-TERM.
 13305     MOVE CM-LOAN-BALANCE         TO L.
 13306     MOVE PI-PAYMENT-AMT          TO M.
 13307
 13308     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 13309     IF WS-REMAIN GREATER ZERO
 13310         ADD 1 TO N.
 13311     IF N = 0
 13312         MOVE 1 TO N.
 13313
 13314 6700-EXIT.
 13315      EXIT.
 13316
 13317 6999-CALC-TERM-EXIT.
 13318     EXIT.
 13319
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 253
* EL131.cbl
 13321 7000-RESET-ATTRIBUTE.
 13322
 13323     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 13324                                    CERTSTA   CERTCARA
 13325                                    CERTGRPA.
 13326     MOVE -1                     TO CERTCARL.
 13327
 13328 7000-EXIT.
 13329     EXIT.
 13330
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 254
* EL131.cbl
 13332 7600-BROWSE-CLAIM.
 13333
 13334
 13335* EXEC CICS READ
 13336*        DATASET(CLMS-FILE-ID)
 13337*        SET    (ADDRESS OF CLAIM-MASTER)
 13338*        RIDFLD (MSTR-KEY)
 13339*        GENERIC
 13340*        EQUAL
 13341*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13342*    END-EXEC.
 13343*    MOVE '&"S  KG    E          (   #00011328' TO DFHEIV0
 13344     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13346     MOVE X'2020233030303131333238' TO DFHEIV0(25:11)
 13347     CALL 'kxdfhei1' USING DFHEIV0,
 13348           CLMS-FILE-ID,
 13349           DFHEIV20,
 13350           DFHEIV99,
 13351           MSTR-KEY,
 13352           ELMSTR-GENERIC-LENGTH,
 13353           DFHEIV99,
 13354           DFHEIV99
 13355     SET ADDRESS OF CLAIM-MASTER TO
 13356         DFHEIV20
 13357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13358
 13359
 13360     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 13361
 13362     IF CL-ASSOC-CERT-TOTAL = 1
 13363         MOVE AL-SADOF           TO BCERT1A
 13364                                    BSUFX1A
 13365                                    BCERT2A
 13366                                    BSUFX2A
 13367                                    BCERT3A
 13368                                    BSUFX3A
 13369                                    BCERT4A
 13370                                    BSUFX4A
 13371                                    BCERT5A
 13372                                    BSUFX5A
 13373                                    PCERTNOA
 13374                                    PSUFXA
 13375                                    LABEL1A
 13376                                    LABEL2A
 13377         GO TO 7699-EXIT.
 13378
 13379 7610-BROWSE-CLAIM-LOOP.
 13380
 13381     MOVE LOW-VALUES             TO BCERT1O
 13382                                    BSUFX1O
 13383                                    BCERT2O
 13384                                    BSUFX2O
 13385                                    BCERT3O
 13386                                    BSUFX3O
 13387                                    BCERT4O
 13388                                    BSUFX4O
 13389                                    BCERT5O
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 255
* EL131.cbl
 13390                                    BSUFX5O.
 13391
 13392
 13393* EXEC CICS HANDLE CONDITION
 13394*        ENDFILE  (7630-END-BROWSE)
 13395*    END-EXEC.
 13396*    MOVE '"$''                   ! B #00011369' TO DFHEIV0
 13397     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13399     MOVE X'4220233030303131333639' TO DFHEIV0(25:11)
 13400     CALL 'kxdfhei1' USING DFHEIV0
 13401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13402
 13403
 13404
 13405* EXEC CICS STARTBR
 13406*        DATASET    (CLMS-FILE-ID)
 13407*        RIDFLD     (MSTR-KEY)
 13408*    END-EXEC.
 13409     MOVE 0
 13410       TO DFHEIV11
 13411*    MOVE '&,         G          &   #00011373' TO DFHEIV0
 13412     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13413     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13414     MOVE X'2020233030303131333733' TO DFHEIV0(25:11)
 13415     CALL 'kxdfhei1' USING DFHEIV0,
 13416           CLMS-FILE-ID,
 13417           MSTR-KEY,
 13418           DFHEIV99,
 13419           DFHEIV11,
 13420           DFHEIV99
 13421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13422
 13423
 13424     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 13425
 13426 7620-READ-CLAIM-LOOP.
 13427
 13428
 13429* EXEC CICS READNEXT
 13430*        DATASET   (CLMS-FILE-ID)
 13431*        SET       (ADDRESS OF CLAIM-MASTER)
 13432*        RIDFLD    (MSTR-KEY)
 13433*    END-EXEC.
 13434     MOVE 0
 13435       TO DFHEIV11
 13436*    MOVE '&.S                   )   #00011382' TO DFHEIV0
 13437     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13438     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13439     MOVE X'2020233030303131333832' TO DFHEIV0(25:11)
 13440     CALL 'kxdfhei1' USING DFHEIV0,
 13441           CLMS-FILE-ID,
 13442           DFHEIV20,
 13443           DFHEIV99,
 13444           MSTR-KEY,
 13445           DFHEIV99,
 13446           DFHEIV11,
 13447           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 256
* EL131.cbl
 13448           DFHEIV99
 13449     SET ADDRESS OF CLAIM-MASTER TO
 13450         DFHEIV20
 13451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13452
 13453
 13454     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 13455        CL-CARRIER     NOT = CARRI           OR
 13456        CL-CLAIM-NO    NOT = CLAIMI
 13457        GO TO 7630-END-BROWSE.
 13458
 13459     IF WS-ASSOCIATED-CERTS = 1
 13460         MOVE CL-CERT-PRIME      TO BCERT1O
 13461         MOVE CL-CERT-SFX        TO BSUFX1O.
 13462
 13463     IF WS-ASSOCIATED-CERTS = 2
 13464         MOVE CL-CERT-PRIME      TO BCERT2O
 13465         MOVE CL-CERT-SFX        TO BSUFX2O.
 13466
 13467     IF WS-ASSOCIATED-CERTS = 3
 13468         MOVE CL-CERT-PRIME      TO BCERT3O
 13469         MOVE CL-CERT-SFX        TO BSUFX3O.
 13470
 13471     IF WS-ASSOCIATED-CERTS = 4
 13472         MOVE CL-CERT-PRIME      TO BCERT4O
 13473         MOVE CL-CERT-SFX        TO BSUFX4O.
 13474
 13475     IF WS-ASSOCIATED-CERTS = 5
 13476         MOVE CL-CERT-PRIME      TO BCERT5O
 13477         MOVE CL-CERT-SFX        TO BSUFX5O
 13478     ELSE
 13479         ADD +1                  TO WS-ASSOCIATED-CERTS
 13480         GO TO 7620-READ-CLAIM-LOOP.
 13481
 13482 7630-END-BROWSE.
 13483
 13484
 13485* EXEC CICS ENDBR
 13486*        DATASET   (CLMS-FILE-ID)
 13487*    END-EXEC.
 13488     MOVE 0
 13489       TO DFHEIV11
 13490*    MOVE '&2                    $   #00011418' TO DFHEIV0
 13491     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13492     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13493     MOVE X'2020233030303131343138' TO DFHEIV0(25:11)
 13494     CALL 'kxdfhei1' USING DFHEIV0,
 13495           CLMS-FILE-ID,
 13496           DFHEIV11,
 13497           DFHEIV99
 13498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13499
 13500
 13501 7640-HIGHLIGHT-CERT-DISPLAYED.
 13502
 13503     MOVE AL-SANON               TO BCERT1A
 13504                                    BSUFX1A
 13505                                    BCERT2A
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 257
* EL131.cbl
 13506                                    BSUFX2A
 13507                                    BCERT3A
 13508                                    BSUFX3A
 13509                                    BCERT4A
 13510                                    BSUFX4A
 13511                                    BCERT5A
 13512                                    BSUFX5A.
 13513
 13514     IF BCERT1O = CERTI AND
 13515        BSUFX1O = SUFXI
 13516            MOVE AL-SABON        TO BCERT1A
 13517                                    BSUFX1A.
 13518
 13519     IF BCERT2O = CERTI AND
 13520        BSUFX2O = SUFXI
 13521            MOVE AL-SABON        TO BCERT2A
 13522                                    BSUFX2A.
 13523
 13524     IF BCERT3O = CERTI AND
 13525        BSUFX3O = SUFXI
 13526            MOVE AL-SABON        TO BCERT3A
 13527                                    BSUFX3A.
 13528
 13529     IF BCERT4O = CERTI AND
 13530        BSUFX4O = SUFXI
 13531            MOVE AL-SABON        TO BCERT4A
 13532                                    BSUFX4A.
 13533
 13534     IF BCERT5O = CERTI AND
 13535        BSUFX5O = SUFXI
 13536            MOVE AL-SABON        TO BCERT5A
 13537                                    BSUFX5A.
 13538
 13539 7699-EXIT.
 13540     EXIT.
 13541
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 258
* EL131.cbl
 13543 7700-CHECK-SEQUENCE.
 13544
 13545
 13546* EXEC CICS HANDLE CONDITION
 13547*        ENDFILE  (7799-EXIT)
 13548*        NOTFND   (7799-EXIT)
 13549*    END-EXEC.
 13550*    MOVE '"$''I                  ! C #00011466' TO DFHEIV0
 13551     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 13552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13553     MOVE X'4320233030303131343636' TO DFHEIV0(25:11)
 13554     CALL 'kxdfhei1' USING DFHEIV0
 13555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13556
 13557
 13558
 13559* EXEC CICS READ
 13560*        DATASET(CLMS-FILE-ID)
 13561*        SET    (ADDRESS OF CLAIM-MASTER)
 13562*        RIDFLD (MSTR-KEY)
 13563*        GENERIC
 13564*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13565*    END-EXEC.
 13566*    MOVE '&"S  KG    E          (   #00011471' TO DFHEIV0
 13567     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13568     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13569     MOVE X'2020233030303131343731' TO DFHEIV0(25:11)
 13570     CALL 'kxdfhei1' USING DFHEIV0,
 13571           CLMS-FILE-ID,
 13572           DFHEIV20,
 13573           DFHEIV99,
 13574           MSTR-KEY,
 13575           ELMSTR-GENERIC-LENGTH,
 13576           DFHEIV99,
 13577           DFHEIV99
 13578     SET ADDRESS OF CLAIM-MASTER TO
 13579         DFHEIV20
 13580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13581
 13582
 13583     COMPUTE WS-ASSOC-CERT-TOTAL =
 13584             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 13585
 13586     GO TO 7799-EXIT.
 13587
 13588 7710-RESEQUENCE-CLAIMS.
 13589
 13590
 13591* EXEC CICS HANDLE CONDITION
 13592*        ENDFILE  (7799-EXIT)
 13593*    END-EXEC.
 13594*    MOVE '"$''                   ! D #00011486' TO DFHEIV0
 13595     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13597     MOVE X'4420233030303131343836' TO DFHEIV0(25:11)
 13598     CALL 'kxdfhei1' USING DFHEIV0
 13599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13600
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 259
* EL131.cbl
 13601
 13602
 13603* EXEC CICS STARTBR
 13604*        DATASET(CLMS-FILE-ID)
 13605*        RIDFLD (MSTR-KEY)
 13606*    END-EXEC.
 13607     MOVE 0
 13608       TO DFHEIV11
 13609*    MOVE '&,         G          &   #00011490' TO DFHEIV0
 13610     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13611     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13612     MOVE X'2020233030303131343930' TO DFHEIV0(25:11)
 13613     CALL 'kxdfhei1' USING DFHEIV0,
 13614           CLMS-FILE-ID,
 13615           MSTR-KEY,
 13616           DFHEIV99,
 13617           DFHEIV11,
 13618           DFHEIV99
 13619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13620
 13621
 13622     COMPUTE WS-ASSOC-CERT-SEQU =
 13623             WS-ASSOC-CERT-SEQU + 1.
 13624
 13625     COMPUTE WS-READNEXT-SWITCH =
 13626             WS-READNEXT-SWITCH + 1.
 13627
 13628 7720-READ-CLAIM-LOOP.
 13629
 13630
 13631* EXEC CICS READNEXT
 13632*        DATASET(CLMS-FILE-ID)
 13633*        SET    (ADDRESS OF CLAIM-MASTER)
 13634*        RIDFLD (MSTR-KEY)
 13635*    END-EXEC.
 13636     MOVE 0
 13637       TO DFHEIV11
 13638*    MOVE '&.S                   )   #00011503' TO DFHEIV0
 13639     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13640     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13641     MOVE X'2020233030303131353033' TO DFHEIV0(25:11)
 13642     CALL 'kxdfhei1' USING DFHEIV0,
 13643           CLMS-FILE-ID,
 13644           DFHEIV20,
 13645           DFHEIV99,
 13646           MSTR-KEY,
 13647           DFHEIV99,
 13648           DFHEIV11,
 13649           DFHEIV99,
 13650           DFHEIV99
 13651     SET ADDRESS OF CLAIM-MASTER TO
 13652         DFHEIV20
 13653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13654
 13655
 13656     IF WS-READNEXT-SWITCH = 1
 13657         ADD 1                   TO WS-READNEXT-SWITCH
 13658         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 260
* EL131.cbl
 13659
 13660 7730-END-BROWSE.
 13661
 13662
 13663* EXEC CICS ENDBR
 13664*        DATASET(CLMS-FILE-ID)
 13665*    END-EXEC.
 13666     MOVE 0
 13667       TO DFHEIV11
 13668*    MOVE '&2                    $   #00011515' TO DFHEIV0
 13669     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13670     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13671     MOVE X'2020233030303131353135' TO DFHEIV0(25:11)
 13672     CALL 'kxdfhei1' USING DFHEIV0,
 13673           CLMS-FILE-ID,
 13674           DFHEIV11,
 13675           DFHEIV99
 13676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13677
 13678
 13679 7740-READ-CLAIM-UPDATE.
 13680
 13681     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 13682        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 13683        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 13684        GO TO 7799-EXIT
 13685     ELSE
 13686        MOVE ZERO                TO WS-READNEXT-SWITCH.
 13687
 13688
 13689* EXEC CICS READ
 13690*        DATASET(CLMS-FILE-ID)
 13691*        SET    (ADDRESS OF CLAIM-MASTER)
 13692*        RIDFLD (MSTR-KEY)
 13693*        UPDATE
 13694*    END-EXEC.
 13695*    MOVE '&"S        EU         (   #00011528' TO DFHEIV0
 13696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13697     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13698     MOVE X'2020233030303131353238' TO DFHEIV0(25:11)
 13699     CALL 'kxdfhei1' USING DFHEIV0,
 13700           CLMS-FILE-ID,
 13701           DFHEIV20,
 13702           DFHEIV99,
 13703           MSTR-KEY,
 13704           DFHEIV99,
 13705           DFHEIV99,
 13706           DFHEIV99
 13707     SET ADDRESS OF CLAIM-MASTER TO
 13708         DFHEIV20
 13709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13710
 13711
 13712     if (cl-priority-cd = '8')
 13713        and (pi-processor-id not = 'PEMA' and 'JMS '
 13714             AND 'AMWA')
 13715        MOVE ER-8003             TO EMI-ERROR
 13716        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 261
* EL131.cbl
 13717                                 THRU 9900-EXIT
 13718        MOVE -1                  TO MAINTL
 13719        GO TO 8110-SEND-DATA
 13720     end-if
 13721
 13722     IF PI-COMPANY-ID = 'CID'
 13723         MOVE 'Y'                TO CL-YESNOSW
 13724     END-IF.
 13725
 13726     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 13727     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 13728
 13729
 13730* EXEC CICS REWRITE
 13731*         DATASET(CLMS-FILE-ID)
 13732*         FROM   (CLAIM-MASTER)
 13733*    END-EXEC.
 13734     MOVE LENGTH OF
 13735      CLAIM-MASTER
 13736       TO DFHEIV11
 13737*    MOVE '&& L                  %   #00011552' TO DFHEIV0
 13738     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13739     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13740     MOVE X'2020233030303131353532' TO DFHEIV0(25:11)
 13741     CALL 'kxdfhei1' USING DFHEIV0,
 13742           CLMS-FILE-ID,
 13743           CLAIM-MASTER,
 13744           DFHEIV11,
 13745           DFHEIV99
 13746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13747
 13748
 13749     GO TO 7710-RESEQUENCE-CLAIMS.
 13750
 13751 7799-EXIT.
 13752     EXIT.
 13753
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 262
* EL131.cbl
 13755 7800-CHECK-AUTO-ACTIVITY.
 13756
 13757
 13758* EXEC CICS HANDLE CONDITION
 13759*        NOTFND   (7800-NOT-FOUND)
 13760*    END-EXEC.
 13761*    MOVE '"$I                   ! E #00011565' TO DFHEIV0
 13762     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13764     MOVE X'4520233030303131353635' TO DFHEIV0(25:11)
 13765     CALL 'kxdfhei1' USING DFHEIV0
 13766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13767
 13768
 13769     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 13770     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13771     MOVE SPACES                     TO  CNTL-PROC-ID.
 13772     MOVE +0                         TO  CNTL-SEQ-NO.
 13773
 13774
 13775* EXEC CICS READ
 13776*        DATASET   (CNTL-FILE-ID)
 13777*        RIDFLD    (CNTL-KEY)
 13778*        SET       (ADDRESS OF CONTROL-FILE)
 13779*    END-EXEC.
 13780*    MOVE '&"S        E          (   #00011574' TO DFHEIV0
 13781     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13783     MOVE X'2020233030303131353734' TO DFHEIV0(25:11)
 13784     CALL 'kxdfhei1' USING DFHEIV0,
 13785           CNTL-FILE-ID,
 13786           DFHEIV20,
 13787           DFHEIV99,
 13788           CNTL-KEY,
 13789           DFHEIV99,
 13790           DFHEIV99,
 13791           DFHEIV99
 13792     SET ADDRESS OF CONTROL-FILE TO
 13793         DFHEIV20
 13794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13795
 13796
 13797     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 13798         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 13799
 13800     IF CL-ACTIVITY-CODE NOT = ZEROS
 13801         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 13802         IF MISC-SUB IS GREATER THAN +9
 13803             SUBTRACT +9 FROM MISC-SUB
 13804             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 13805         ELSE
 13806             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 13807     ELSE
 13808         MOVE 'Y'                              TO  WS-RESET-SW.
 13809
 13810     IF STATUSI = 'C' OR 'CLOSED'
 13811         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 13812             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 263
* EL131.cbl
 13813                                         PI-LETTER-SW
 13814             GO TO 7800-EXIT.
 13815
 13816     IF STATUSI = 'C' OR 'CLOSED'
 13817         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 13818             MOVE 'N'                TO  PI-LETTER-SW
 13819         ELSE
 13820             MOVE 'Y'                TO  PI-LETTER-SW.
 13821
 13822     IF STATUSI = 'O' OR 'OPEN'
 13823         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 13824             MOVE 'N'                TO  PI-REC-FOUND-SW
 13825                                         PI-LETTER-SW
 13826             GO TO 7800-EXIT.
 13827
 13828     IF STATUSI = 'O' OR 'OPEN'
 13829         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 13830             MOVE 'N'                TO  PI-LETTER-SW
 13831         ELSE
 13832             MOVE 'Y'                TO  PI-LETTER-SW.
 13833
 13834     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 13835     GO TO 7800-EXIT.
 13836
 13837 7800-NOT-FOUND.
 13838
 13839     MOVE 'N'                        TO  PI-REC-FOUND-SW
 13840                                         PI-LETTER-SW.
 13841
 13842 7800-EXIT.
 13843     EXIT.
 13844
 13845 7850-AUTO-LETTER-WRITER.
 13846
 13847     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 13848     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 13849
 13850     IF STATUSI = 'C' OR 'CLOSED'
 13851         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 13852     ELSE
 13853         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 13854
 13855     IF STATUSI = 'C' OR 'CLOSED'
 13856         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 13857             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13858             MOVE '6'                TO  DC-OPTION-CODE
 13859             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 13860             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13861             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13862             IF NO-CONVERSION-ERROR
 13863                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 13864             ELSE
 13865                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 13866
 13867     IF STATUSI = 'C' OR 'CLOSED'
 13868         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 13869             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13870             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 264
* EL131.cbl
 13871             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 13872             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13873             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13874             IF NO-CONVERSION-ERROR
 13875                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 13876             ELSE
 13877                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 13878
 13879     IF STATUSI = 'O' OR 'OPEN'
 13880         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 13881             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13882             MOVE '6'                TO  DC-OPTION-CODE
 13883             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 13884             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13885             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13886             IF NO-CONVERSION-ERROR
 13887                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 13888             ELSE
 13889                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 13890
 13891     IF STATUSI = 'O' OR 'OPEN'
 13892         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 13893             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13894             MOVE '6'                TO  DC-OPTION-CODE
 13895             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 13896             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13897             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13898             IF NO-CONVERSION-ERROR
 13899                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 13900             ELSE
 13901                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 13902
 13903
 13904* EXEC CICS LINK
 13905*        PROGRAM    (LINK-1523)
 13906*        COMMAREA   (W-1523-LINKDATA)
 13907*        LENGTH     (W-1523-COMM-LENGTH)
 13908*    END-EXEC.
 13909*    MOVE '."C                   ''   #00011686' TO DFHEIV0
 13910     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13911     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13912     MOVE X'2020233030303131363836' TO DFHEIV0(25:11)
 13913     CALL 'kxdfhei1' USING DFHEIV0,
 13914           LINK-1523,
 13915           W-1523-LINKDATA,
 13916           W-1523-COMM-LENGTH,
 13917           DFHEIV99,
 13918           DFHEIV99,
 13919           DFHEIV99
 13920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13921
 13922
 13923     IF W-1523-ERROR-CODE = ZEROS
 13924         GO TO 7850-EXIT.
 13925
 13926     IF W-1523-FATAL-ERROR
 13927         MOVE ER-0802                TO  EMI-ERROR
 13928         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 265
* EL131.cbl
 13929
 13930     IF W-1523-ERROR-CODE = 0191
 13931         MOVE ER-0803                TO  EMI-ERROR
 13932         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13933
 13934 7850-EXIT.
 13935     EXIT.
 13936
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 266
* EL131.cbl
 13938 8000-CREATE-DMO-REC.
 13939     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 13940     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 13941     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 13942
 13943
 13944* EXEC CICS HANDLE CONDITION
 13945*         NOTFND   (8000-NOTE-NOT-FOUND)
 13946*    END-EXEC.
 13947*    MOVE '"$I                   ! F #00011712' TO DFHEIV0
 13948     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13950     MOVE X'4620233030303131373132' TO DFHEIV0(25:11)
 13951     CALL 'kxdfhei1' USING DFHEIV0
 13952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13953
 13954
 13955
 13956* EXEC CICS READ
 13957*         DATASET(NOTE-FILE-ID)
 13958*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 13959*         RIDFLD (NOTE-KEY)
 13960*    END-EXEC.
 13961*    MOVE '&"S        E          (   #00011716' TO DFHEIV0
 13962     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13964     MOVE X'2020233030303131373136' TO DFHEIV0(25:11)
 13965     CALL 'kxdfhei1' USING DFHEIV0,
 13966           NOTE-FILE-ID,
 13967           DFHEIV20,
 13968           DFHEIV99,
 13969           NOTE-KEY,
 13970           DFHEIV99,
 13971           DFHEIV99,
 13972           DFHEIV99
 13973     SET ADDRESS OF CERTIFICATE-NOTE TO
 13974         DFHEIV20
 13975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13976
 13977
 13978     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 13979     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 13980     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 13981
 13982     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 13983         MOVE 'CC'               TO DCT-PRODUCT-CODE
 13984     ELSE
 13985         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 13986
 13987     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 13988     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 13989
 13990
 13991* EXEC CICS LINK
 13992*        PROGRAM    ('DLO006')
 13993*        COMMAREA   (DCT-COMMUNICATION-AREA)
 13994*        LENGTH     (WS-DCT-LENGTH)
 13995*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 267
* EL131.cbl
 13996     MOVE 'DLO006' TO DFHEIV1
 13997*    MOVE '."C                   ''   #00011734' TO DFHEIV0
 13998     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13999     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14000     MOVE X'2020233030303131373334' TO DFHEIV0(25:11)
 14001     CALL 'kxdfhei1' USING DFHEIV0,
 14002           DFHEIV1,
 14003           DCT-COMMUNICATION-AREA,
 14004           WS-DCT-LENGTH,
 14005           DFHEIV99,
 14006           DFHEIV99,
 14007           DFHEIV99
 14008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14009
 14010
 14011     IF  DCT-RETURN-CODE = 'OK'
 14012         GO TO 8000-CONT.
 14013
 14014     IF DCT-RETURN-CODE = '01' OR '02'
 14015         GO TO 8000-EXIT.
 14016
 14017     IF DCT-RETURN-CODE = '03'
 14018         MOVE ER-0951            TO EMI-ERROR
 14019         MOVE -1                 TO MAINTL
 14020         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14021         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14022         GO TO 8110-SEND-DATA.
 14023
 14024     IF DCT-RETURN-CODE = '04'
 14025         MOVE ER-0946            TO EMI-ERROR
 14026         MOVE -1                 TO MAINTL
 14027         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14028         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14029         GO TO 8110-SEND-DATA.
 14030
 14031     IF DCT-RETURN-CODE = '05'
 14032         MOVE ER-0947            TO EMI-ERROR
 14033         MOVE -1                 TO MAINTL
 14034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14035         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14036         GO TO 8110-SEND-DATA.
 14037
 14038     IF DCT-RETURN-CODE = '06'
 14039         MOVE ER-0921            TO EMI-ERROR
 14040         MOVE -1                 TO MAINTL
 14041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14042         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14043         GO TO 8110-SEND-DATA.
 14044
 14045     IF DCT-RETURN-CODE = '07'
 14046         MOVE ER-0919            TO EMI-ERROR
 14047         MOVE -1                 TO MAINTL
 14048         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14049         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14050         GO TO 8110-SEND-DATA.
 14051
 14052     IF DCT-RETURN-CODE = '08'
 14053         MOVE ER-0948            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 268
* EL131.cbl
 14054         MOVE -1                 TO MAINTL
 14055         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14056         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14057         GO TO 8110-SEND-DATA.
 14058
 14059     IF DCT-RETURN-CODE = 'N1'
 14060         MOVE ER-0950            TO EMI-ERROR
 14061         MOVE -1                 TO MAINTL
 14062         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14063         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14064         GO TO 8110-SEND-DATA.
 14065
 14066     IF DCT-RETURN-CODE = 'E1'
 14067         MOVE ER-0974            TO EMI-ERROR
 14068         MOVE -1                 TO MAINTL
 14069         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14070         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14071         GO TO 8110-SEND-DATA.
 14072
 14073     IF DCT-RETURN-CODE = 'E2'
 14074         MOVE ER-0975            TO EMI-ERROR
 14075         MOVE -1                 TO MAINTL
 14076         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14077         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14078         GO TO 8110-SEND-DATA.
 14079
 14080     IF DCT-RETURN-CODE NOT = 'OK'
 14081         MOVE ER-0949            TO EMI-ERROR
 14082         MOVE -1                 TO MAINTL
 14083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14084         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14085         GO TO 8110-SEND-DATA.
 14086
 14087 8000-CONT.
 14088
 14089     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14090     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14091     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14092     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14093     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14094     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14095     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14096     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14097
 14098     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14099     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14100     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14101     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 14102     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14103
 14104     IF STATUSI = 'OPEN' OR 'O'
 14105         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 14106      ELSE
 14107         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 14108
 14109     IF STATUSI = 'OPEN' OR 'O'
 14110        IF CL-NO-OF-PMTS-MADE = 0
 14111         MOVE '1'                TO DM-CLAIM-STATUS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 269
* EL131.cbl
 14112      ELSE
 14113         MOVE '2'                TO DM-CLAIM-STATUS.
 14114
 14115     IF STATUSI = 'CLOSED' OR 'C'
 14116        IF NOT FINAL-PAID
 14117         MOVE '3'                TO DM-CLAIM-STATUS
 14118      ELSE
 14119         MOVE '4'                TO DM-CLAIM-STATUS.
 14120
 14121     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14122
 14123
 14124* EXEC CICS LINK
 14125*        PROGRAM    ('DLO025')
 14126*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14127*        LENGTH     (WS-DMO-LENGTH)
 14128*    END-EXEC.
 14129     MOVE 'DLO025' TO DFHEIV1
 14130*    MOVE '."C                   ''   #00011852' TO DFHEIV0
 14131     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14132     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14133     MOVE X'2020233030303131383532' TO DFHEIV0(25:11)
 14134     CALL 'kxdfhei1' USING DFHEIV0,
 14135           DFHEIV1,
 14136           DMO-COMMUNICATION-AREA,
 14137           WS-DMO-LENGTH,
 14138           DFHEIV99,
 14139           DFHEIV99,
 14140           DFHEIV99
 14141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14142
 14143
 14144     IF  DM-RETURN-CODE = 'OK'
 14145         GO TO 8000-EXIT.
 14146
 14147     IF DM-RETURN-CODE = '01'
 14148         MOVE ER-8051            TO EMI-ERROR
 14149         MOVE -1                 TO MAINTL
 14150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14151         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14152         GO TO 8110-SEND-DATA.
 14153
 14154     IF DM-RETURN-CODE = '02'
 14155         MOVE ER-8052            TO EMI-ERROR
 14156         MOVE -1                 TO MAINTL
 14157         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14158         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14159         GO TO 8110-SEND-DATA.
 14160
 14161     IF DM-RETURN-CODE = '03'
 14162         MOVE ER-8053            TO EMI-ERROR
 14163         MOVE -1                 TO MAINTL
 14164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14165         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14166         GO TO 8110-SEND-DATA.
 14167
 14168     IF DM-RETURN-CODE = '04'
 14169         MOVE ER-8054            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 270
* EL131.cbl
 14170         MOVE -1                 TO MAINTL
 14171         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14172         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14173         GO TO 8110-SEND-DATA.
 14174
 14175     IF DM-RETURN-CODE = '05'
 14176         MOVE ER-8055            TO EMI-ERROR
 14177         MOVE -1                 TO MAINTL
 14178         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14179         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14180         GO TO 8110-SEND-DATA.
 14181
 14182     IF DM-RETURN-CODE = '06'
 14183         MOVE ER-8056            TO EMI-ERROR
 14184         MOVE -1                 TO MAINTL
 14185         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14186         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14187         GO TO 8110-SEND-DATA.
 14188
 14189     IF DM-RETURN-CODE = '07'
 14190         MOVE ER-8057            TO EMI-ERROR
 14191         MOVE -1                 TO MAINTL
 14192         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14193         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14194         GO TO 8110-SEND-DATA.
 14195
 14196     IF DM-RETURN-CODE = '08'
 14197         MOVE ER-8058            TO EMI-ERROR
 14198         MOVE -1                 TO MAINTL
 14199         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14200         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14201         GO TO 8110-SEND-DATA.
 14202
 14203     IF DM-RETURN-CODE = '09'
 14204         MOVE ER-8059            TO EMI-ERROR
 14205         MOVE -1                 TO MAINTL
 14206         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14207         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14208         GO TO 8110-SEND-DATA.
 14209
 14210     IF DM-RETURN-CODE = '10'
 14211         MOVE ER-8060            TO EMI-ERROR
 14212         MOVE -1                 TO MAINTL
 14213         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14214         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14215         GO TO 8110-SEND-DATA.
 14216
 14217     IF DM-RETURN-CODE = '11'
 14218         MOVE ER-8061            TO EMI-ERROR
 14219         MOVE -1                 TO MAINTL
 14220         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14221         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14222         GO TO 8110-SEND-DATA.
 14223
 14224     IF DM-RETURN-CODE = '12'
 14225         MOVE ER-8062            TO EMI-ERROR
 14226         MOVE -1                 TO MAINTL
 14227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 271
* EL131.cbl
 14228         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14229         GO TO 8110-SEND-DATA.
 14230
 14231     IF DM-RETURN-CODE = '13'
 14232         MOVE ER-8063            TO EMI-ERROR
 14233         MOVE -1                 TO MAINTL
 14234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14235         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14236         GO TO 8110-SEND-DATA.
 14237
 14238     IF DM-RETURN-CODE = '14'
 14239         MOVE ER-8064            TO EMI-ERROR
 14240         MOVE -1                 TO MAINTL
 14241         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14242         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14243         GO TO 8110-SEND-DATA.
 14244
 14245     IF DM-RETURN-CODE = '15'
 14246         MOVE ER-8065            TO EMI-ERROR
 14247         MOVE -1                 TO MAINTL
 14248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14249         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14250         GO TO 8110-SEND-DATA.
 14251
 14252     IF DM-RETURN-CODE = '16'
 14253         MOVE ER-8154            TO EMI-ERROR
 14254         MOVE -1                 TO MAINTL
 14255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14256         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14257         GO TO 8110-SEND-DATA.
 14258
 14259     IF DM-RETURN-CODE = '17'
 14260         MOVE ER-8155            TO EMI-ERROR
 14261         MOVE -1                 TO MAINTL
 14262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14263         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14264         GO TO 8110-SEND-DATA.
 14265
 14266     IF DM-RETURN-CODE = 'N1'
 14267         MOVE ER-8152            TO EMI-ERROR
 14268         MOVE -1                 TO MAINTL
 14269         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14270         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14271         GO TO 8110-SEND-DATA.
 14272
 14273     IF DM-RETURN-CODE = 'E1'
 14274         MOVE ER-8153            TO EMI-ERROR
 14275         MOVE -1                 TO MAINTL
 14276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14277         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14278         GO TO 8110-SEND-DATA.
 14279
 14280     MOVE ER-8066                TO EMI-ERROR.
 14281     MOVE -1                     TO MAINTL.
 14282     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14283     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
 14284     GO TO 8110-SEND-DATA.
 14285
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 272
* EL131.cbl
 14286 8000-NOTE-NOT-FOUND.
 14287
 14288* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14289*    MOVE '6"R                   !   #00012001' TO DFHEIV0
 14290     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14292     MOVE X'2020233030303132303031' TO DFHEIV0(25:11)
 14293     CALL 'kxdfhei1' USING DFHEIV0
 14294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14295
 14296     MOVE ER-0954                TO EMI-ERROR.
 14297     MOVE -1                     TO MAINTL.
 14298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14299     GO TO 8110-SEND-DATA.
 14300
 14301 8000-EXIT.
 14302     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 273
* EL131.cbl
 14304 8050-FORMAT-LAST-NAME-1ST.
 14305*****************************************************************
 14306*             M O V E   N A M E   R O U T I N E                 *
 14307*                                                               *
 14308*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14309*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14310*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 14311*                                                               *
 14312*                  FIELD               VALUE                    *
 14313*                  -----               -----                    *
 14314*           W-NAME-LAST    (CL15)      SMITH                    *
 14315*           W-NAME-FIRST   (CL15)      JOHN                     *
 14316*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14317*                                                               *
 14318*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 14319*                SMITH, JOHN ALLEN                              *
 14320*                     OR                                        *
 14321*                SMITH, JOHN A.                                 *
 14322*                                                               *
 14323*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 14324*     COPYBOOK, ELCNWA.                                         *
 14325*****************************************************************.
 14326
 14327     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14328     MOVE ZERO                   TO WS-NAME-SW.
 14329     SET NWA-INDEX               TO +1.
 14330
 14331     IF W-NAME-LAST   = SPACES  AND
 14332        W-NAME-MIDDLE = SPACES
 14333          MOVE +1                TO WS-NAME-SW.
 14334
 14335     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14336     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14337
 14338     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14339     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14340
 14341     SET NWA-INDEX UP BY +1.
 14342
 14343     IF W-NAME-MIDDLE NOT = SPACES
 14344         IF W-NAME-MIDDLE-2 = SPACES
 14345             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14346             SET NWA-INDEX UP BY +1
 14347             MOVE '.'            TO WS-NW (NWA-INDEX)
 14348             SET NWA-INDEX UP BY +2
 14349         ELSE
 14350             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14351             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14352
 14353 8050-EXIT.
 14354     EXIT.
 14355
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 274
* EL131.cbl
 14357 8060-MOVE-NAME.
 14358     IF WS-NAME-SW GREATER THAN +1
 14359         GO TO 8060-EXIT.
 14360
 14361     IF WS-NAME-WORK2 = SPACES
 14362         GO TO 8060-EXIT.
 14363
 14364     SET NWA-INDEX2            TO +1.
 14365     SET NWA-INDEX3            TO +2.
 14366
 14367 8060-MOVE-NAME-CYCLE.
 14368     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14369
 14370     IF NWA-INDEX LESS THAN +30
 14371         SET NWA-INDEX UP BY +1
 14372     ELSE
 14373         ADD +2 TO  WS-NAME-SW
 14374         GO TO 8060-EXIT.
 14375
 14376     IF NWA-INDEX2 LESS THAN +20
 14377         SET NWA-INDEX3 UP BY +1
 14378         SET NWA-INDEX2 UP BY +1.
 14379
 14380     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 14381        WS-NW2 (NWA-INDEX3) = SPACES
 14382         IF WS-NAME-SW = ZERO
 14383             MOVE ','            TO WS-NW (NWA-INDEX)
 14384             SET NWA-INDEX UP BY +2
 14385             MOVE +1             TO WS-NAME-SW
 14386             GO TO 8060-EXIT
 14387         ELSE
 14388             GO TO 8060-EXIT.
 14389
 14390     GO TO 8060-MOVE-NAME-CYCLE.
 14391
 14392 8060-EXIT.
 14393     EXIT.
 14394
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 275
* EL131.cbl
 14396
 14397 8070-UNLOCK-CLAIM-MSTR.
 14398
 14399* EXEC CICS UNLOCK
 14400*        DATASET   (CLMS-FILE-ID)
 14401*    END-EXEC.
 14402*    MOVE '&*                    #   #00012104' TO DFHEIV0
 14403     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 14404     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14405     MOVE X'2020233030303132313034' TO DFHEIV0(25:11)
 14406     CALL 'kxdfhei1' USING DFHEIV0,
 14407           CLMS-FILE-ID,
 14408           DFHEIV99
 14409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14410
 14411
 14412 8070-EXIT.
 14413      EXIT.
 14414
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 276
* EL131.cbl
 14416 8100-SEND-MAP.
 14417     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14418
 14419     IF NOT PI-NO-CARRIER-SECURITY
 14420        MOVE AL-SANOF            TO CERTCARA.
 14421     IF NOT PI-NO-ACCOUNT-SECURITY
 14422        MOVE AL-SANOF            TO CERTACTA.
 14423
 14424     IF PI-PROCESSOR-ID = 'LGXX'
 14425        MOVE AL-UANON            TO CCNOA.
 14426
 14427     IF PI-COMPANY-ID = 'DMD'
 14428        NEXT SENTENCE
 14429     ELSE
 14430        MOVE AL-SADOF            TO PFKEY6A.
 14431
 14432     IF PI-USES-PAID-TO
 14433        MOVE 'PAID TO  :' TO PTHRHDGO.
 14434
 14435
 14436* EXEC CICS SEND
 14437*         MAP     ('EL131A')
 14438*         MAPSET  ('EL131S')
 14439*         ERASE
 14440*         FREEKB
 14441*         CURSOR
 14442*    END-EXEC.
 14443     MOVE 'EL131A' TO DFHEIV1
 14444     MOVE -1
 14445       TO DFHEIV11
 14446     MOVE 'EL131S' TO DFHEIV2
 14447*    MOVE '8$     CT  E F  H     ,   #00012131' TO DFHEIV0
 14448     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 14449     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14450     MOVE X'2020233030303132313331' TO DFHEIV0(25:11)
 14451     CALL 'kxdfhei1' USING DFHEIV0,
 14452           DFHEIV1,
 14453           EL131AO,
 14454           DFHEIV99,
 14455           DFHEIV2,
 14456           DFHEIV99,
 14457           DFHEIV99,
 14458           DFHEIV99,
 14459           DFHEIV11,
 14460           DFHEIV99,
 14461           DFHEIV99,
 14462           DFHEIV99
 14463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14464
 14465
 14466     GO TO 9000-RETURN-TRANS.
 14467
 14468 8110-SEND-DATA.
 14469     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14470
 14471     IF PI-USES-PAID-TO
 14472        MOVE 'PAID TO  :' TO PTHRHDGO.
 14473
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 277
* EL131.cbl
 14474     IF PI-PROCESSOR-ID = 'LGXX'
 14475        MOVE AL-UANON            TO CCNOA.
 14476
 14477     IF PI-COMPANY-ID = 'DMD'
 14478        NEXT SENTENCE
 14479     ELSE
 14480        MOVE AL-SADOF            TO PFKEY6A.
 14481
 14482
 14483* EXEC CICS SEND
 14484*         MAP      ('EL131A')
 14485*         MAPSET   ('EL131S')
 14486*         DATAONLY
 14487*         FREEKB
 14488*         CURSOR
 14489*    END-EXEC.
 14490     MOVE 'EL131A' TO DFHEIV1
 14491     MOVE -1
 14492       TO DFHEIV11
 14493     MOVE 'EL131S' TO DFHEIV2
 14494*    MOVE '8$D    CT    F  H     ,   #00012155' TO DFHEIV0
 14495     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 14496     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14497     MOVE X'2020233030303132313535' TO DFHEIV0(25:11)
 14498     CALL 'kxdfhei1' USING DFHEIV0,
 14499           DFHEIV1,
 14500           EL131AO,
 14501           DFHEIV99,
 14502           DFHEIV2,
 14503           DFHEIV99,
 14504           DFHEIV99,
 14505           DFHEIV99,
 14506           DFHEIV11,
 14507           DFHEIV99,
 14508           DFHEIV99,
 14509           DFHEIV99
 14510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14511
 14512
 14513     GO TO 9000-RETURN-TRANS.
 14514
 14515 8120-FORMAT-TIME-DATE.
 14516
 14517     IF SKIP-ATTRIBUTE = 'Y'
 14518        MOVE SPACES              TO SKIP-ATTRIBUTE
 14519        MOVE ER-0598             TO EMI-ERROR
 14520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14521        GO TO 8125-SKIP-ATTRIBUTE.
 14522
 14523     IF PI-COMPANY-ID = 'DMD'
 14524         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 14525                                    CERTCARA  CERTGRPA.
 14526
 14527     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 14528                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 14529                                    JNTINITA  JNTAGEA   APRA
 14530                                    LCVCDA    LCVOTRMA  LCVRTRMA
 14531                                    LCVBENEA  LCVFORMA  LCVCNDTA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 278
* EL131.cbl
 14532                                    LCVEXITA  LCVSTATA  LCVKINDA
 14533                                    ACVCDA    ACVOTRMA  ACVRTRMA
 14534                                    ACVBENEA  ACVFORMA  ACVCNDTA
 14535                                    ACVEXITA  ACVSTATA  ACVKINDA
 14536                                    PMTFREQA  INDGRPA   PREMTYPA
 14537                                    REINCDA   LCVRATEA  ACVRATEA
 14538                                    ADDONDTA.
 14539
 14540*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 14541*       IF PI-COMPANY-ID = 'DMD'
 14542*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 14543*                                   SUFXA
 14544*                                   PDAMTA    NODAYSA   NOPMTSA
 14545*                                   INCA      OCCA
 14546*          IF NOT SYSTEM-MODIFY-CAP
 14547*              MOVE AL-SANOF         TO PDTHRUA.
 14548
 14549     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 14550         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 14551
 14552 8125-SKIP-ATTRIBUTE.
 14553
 14554     MOVE SAVE-DATE              TO DATEO.
 14555
 14556* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 14557*    END-EXEC
 14558*    MOVE '0"A                   "   #00012205' TO DFHEIV0
 14559     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 14560     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 14561     MOVE X'2020233030303132323035' TO DFHEIV0(25:11)
 14562     CALL 'kxdfhei1' USING DFHEIV0,
 14563           LCP-CICS-TIME
 14564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14565
 14566* EXEC CICS FORMATTIME
 14567*              ABSTIME(LCP-CICS-TIME)
 14568*              TIME(LCP-TIME-OF-DAY-XX)
 14569*    END-EXEC
 14570*    MOVE 'j$(     (             #   #00012207' TO DFHEIV0
 14571     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 14572     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14573     MOVE X'2020233030303132323037' TO DFHEIV0(25:11)
 14574     CALL 'kxdfhei1' USING DFHEIV0,
 14575           LCP-CICS-TIME,
 14576           LCP-TIME-OF-DAY-XX
 14577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14578     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 14579     MOVE UN-HOURS               TO FOR-HOURS.
 14580     MOVE UN-MINUTES             TO FOR-MINUTES.
 14581     MOVE TIME-OUT               TO TIMEO.
 14582     MOVE PI-COMPANY-ID          TO COMPO.
 14583     MOVE PI-PROCESSOR-ID        TO USERIDO.
 14584     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 14585     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 14586     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 14587
 14588 8130-EXIT.
 14589     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 279
* EL131.cbl
 14590
 14591 8150-ENTERED-CLAIM-NOTFOUND.
 14592
 14593     MOVE ER-0204                TO EMI-ERROR.
 14594     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14595     MOVE -1                     TO MAINTL.
 14596     GO TO 8100-SEND-MAP.
 14597
 14598 8200-RETURN-PRIOR.
 14599     MOVE SPACE                  TO PI-RETURN-CD-1.
 14600     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 14601     GO TO 9200-XCTL.
 14602
 14603 8300-GET-HELP.
 14604     MOVE XCTL-EL010             TO CALL-PGM.
 14605     GO TO 9200-XCTL.
 14606
 14607 8400-RETURN-MASTER.
 14608     MOVE SPACE                  TO PI-RETURN-CD-1.
 14609     MOVE XCTL-EL126             TO CALL-PGM.
 14610     GO TO 9200-XCTL.
 14611
 14612 8500-TRLR-MNT.
 14613     IF PI-RETURN-CD-1 = 'X'
 14614         MOVE ER-0311            TO EMI-ERROR
 14615         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14616         MOVE -1                 TO MAINTL
 14617         GO TO 8110-SEND-DATA.
 14618
 14619
 14620* EXEC CICS WRITEQ TS
 14621*         QUEUE     (PI-KEY)
 14622*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14623*         LENGTH    (PI-COMM-LENGTH)
 14624*    END-EXEC.
 14625*    MOVE '*"                    ''   #00012252' TO DFHEIV0
 14626     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14627     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14628     MOVE X'2020233030303132323532' TO DFHEIV0(25:11)
 14629     CALL 'kxdfhei1' USING DFHEIV0,
 14630           PI-KEY,
 14631           PROGRAM-INTERFACE-BLOCK,
 14632           PI-COMM-LENGTH,
 14633           DFHEIV99,
 14634           DFHEIV99,
 14635           DFHEIV99
 14636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14637
 14638
 14639     MOVE XCTL-EL142             TO CALL-PGM.
 14640     GO TO 9200-XCTL.
 14641
 14642 8600-ADDR-MNT.
 14643     IF PI-RETURN-CD-1 = 'X'
 14644         MOVE ER-0311            TO EMI-ERROR
 14645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14646         MOVE -1                 TO MAINTL
 14647         GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 280
* EL131.cbl
 14648
 14649
 14650* EXEC CICS WRITEQ TS
 14651*         QUEUE     (PI-KEY)
 14652*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14653*         LENGTH    (PI-COMM-LENGTH)
 14654*    END-EXEC.
 14655*    MOVE '*"                    ''   #00012268' TO DFHEIV0
 14656     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14657     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14658     MOVE X'2020233030303132323638' TO DFHEIV0(25:11)
 14659     CALL 'kxdfhei1' USING DFHEIV0,
 14660           PI-KEY,
 14661           PROGRAM-INTERFACE-BLOCK,
 14662           PI-COMM-LENGTH,
 14663           DFHEIV99,
 14664           DFHEIV99,
 14665           DFHEIV99
 14666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14667
 14668
 14669     MOVE XCTL-EL141             TO CALL-PGM.
 14670     GO TO 9200-XCTL.
 14671
 14672 8700-CERT-MNT.
 14673     IF PI-RETURN-CD-1 = 'X'
 14674         MOVE ER-7690            TO EMI-ERROR
 14675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14676         MOVE -1                 TO MAINTL
 14677         GO TO 8110-SEND-DATA.
 14678
 14679
 14680* EXEC CICS WRITEQ TS
 14681*         QUEUE     (PI-KEY)
 14682*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14683*         LENGTH    (PI-COMM-LENGTH)
 14684*    END-EXEC.
 14685*    MOVE '*"                    ''   #00012284' TO DFHEIV0
 14686     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14687     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14688     MOVE X'2020233030303132323834' TO DFHEIV0(25:11)
 14689     CALL 'kxdfhei1' USING DFHEIV0,
 14690           PI-KEY,
 14691           PROGRAM-INTERFACE-BLOCK,
 14692           PI-COMM-LENGTH,
 14693           DFHEIV99,
 14694           DFHEIV99,
 14695           DFHEIV99
 14696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14697
 14698
 14699     MOVE XCTL-EL1273            TO CALL-PGM.
 14700     GO TO 9200-XCTL.
 14701
 14702 8750-DMD-CLM-FIX.
 14703
 14704* EXEC CICS WRITEQ TS
 14705*         QUEUE     (PI-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 281
* EL131.cbl
 14706*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14707*         LENGTH    (PI-COMM-LENGTH)
 14708*    END-EXEC.
 14709*    MOVE '*"                    ''   #00012294' TO DFHEIV0
 14710     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14711     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14712     MOVE X'2020233030303132323934' TO DFHEIV0(25:11)
 14713     CALL 'kxdfhei1' USING DFHEIV0,
 14714           PI-KEY,
 14715           PROGRAM-INTERFACE-BLOCK,
 14716           PI-COMM-LENGTH,
 14717           DFHEIV99,
 14718           DFHEIV99,
 14719           DFHEIV99
 14720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14721
 14722
 14723     MOVE XCTL-EL400DMD          TO CALL-PGM.
 14724     GO TO 9200-XCTL.
 14725
 14726 8800-UNAUTHORIZED-ACCESS.
 14727     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 14728     GO TO 8990-SEND-TEXT.
 14729
 14730 8810-PF23-ENTERED.
 14731     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 14732     MOVE XCTL-EL005             TO CALL-PGM.
 14733     GO TO 9200-XCTL.
 14734
 14735 8820-XCTL-ERROR.
 14736
 14737* EXEC CICS HANDLE CONDITION
 14738*        PGMIDERR (8990-SEND-TEXT)
 14739*    END-EXEC.
 14740*    MOVE '"$L                   ! G #00012313' TO DFHEIV0
 14741     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 14742     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14743     MOVE X'4720233030303132333133' TO DFHEIV0(25:11)
 14744     CALL 'kxdfhei1' USING DFHEIV0
 14745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14746
 14747
 14748     MOVE SPACE                 TO PI-ENTRY-CD-1.
 14749     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 14750     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 14751     MOVE XCTL-EL005            TO CALL-PGM.
 14752     GO TO 9200-XCTL.
 14753
 14754 8990-SEND-TEXT.
 14755
 14756* EXEC CICS SEND TEXT
 14757*         FROM      (LOGOFF-TEXT)
 14758*         LENGTH    (LOGOFF-LENGTH)
 14759*         ERASE
 14760*         FREEKB
 14761*    END-EXEC.
 14762*    MOVE '8&      T  E F  H   F -   #00012324' TO DFHEIV0
 14763     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 282
* EL131.cbl
 14764     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 14765     MOVE X'2020233030303132333234' TO DFHEIV0(25:11)
 14766     CALL 'kxdfhei1' USING DFHEIV0,
 14767           LOGOFF-TEXT,
 14768           LOGOFF-LENGTH,
 14769           DFHEIV99,
 14770           DFHEIV99,
 14771           DFHEIV99,
 14772           DFHEIV99,
 14773           DFHEIV99,
 14774           DFHEIV99,
 14775           DFHEIV99,
 14776           DFHEIV99,
 14777           DFHEIV99,
 14778           DFHEIV99
 14779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14780
 14781
 14782     GO TO 9100-RETURN-CICS.
 14783
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 283
* EL131.cbl
 14785 9000-RETURN-TRANS.
 14786
 14787* EXEC CICS RETURN
 14788*         TRANSID   (TRANS-ID)
 14789*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 14790*         LENGTH    (PI-COMM-LENGTH)
 14791*    END-EXEC.
 14792*    MOVE '.(CT                  &   #00012335' TO DFHEIV0
 14793     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 14794     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14795     MOVE X'2020233030303132333335' TO DFHEIV0(25:11)
 14796     CALL 'kxdfhei1' USING DFHEIV0,
 14797           TRANS-ID,
 14798           PROGRAM-INTERFACE-BLOCK,
 14799           PI-COMM-LENGTH,
 14800           DFHEIV99,
 14801           DFHEIV99
 14802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14803
 14804
 14805
 14806* GOBACK.
 14807     MOVE '9%                    "   ' TO DFHEIV0
 14808     MOVE 'EL131' TO DFHEIV1
 14809     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14810     GOBACK.
 14811
 14812 9100-RETURN-CICS.
 14813
 14814* EXEC CICS RETURN
 14815*    END-EXEC.
 14816*    MOVE '.(                    &   #00012344' TO DFHEIV0
 14817     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14818     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14819     MOVE X'2020233030303132333434' TO DFHEIV0(25:11)
 14820     CALL 'kxdfhei1' USING DFHEIV0,
 14821           DFHEIV99,
 14822           DFHEIV99,
 14823           DFHEIV99,
 14824           DFHEIV99,
 14825           DFHEIV99
 14826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14827
 14828
 14829
 14830* GOBACK.
 14831     MOVE '9%                    "   ' TO DFHEIV0
 14832     MOVE 'EL131' TO DFHEIV1
 14833     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14834     GOBACK.
 14835
 14836 9200-XCTL.
 14837
 14838* EXEC CICS XCTL
 14839*         PROGRAM    (CALL-PGM)
 14840*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 14841*         LENGTH     (PI-COMM-LENGTH)
 14842*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 284
* EL131.cbl
 14843*    MOVE '.$C                   $   #00012350' TO DFHEIV0
 14844     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 14845     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14846     MOVE X'2020233030303132333530' TO DFHEIV0(25:11)
 14847     CALL 'kxdfhei1' USING DFHEIV0,
 14848           CALL-PGM,
 14849           PROGRAM-INTERFACE-BLOCK,
 14850           PI-COMM-LENGTH
 14851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14852
 14853
 14854 9700-LINK-RTRM-FILE-ID.
 14855
 14856* EXEC CICS LINK
 14857*        PROGRAM  (RTRM-FILE-ID)
 14858*        COMMAREA (CALCULATION-PASS-AREA)
 14859*        LENGTH   (CP-COMM-LENGTH)
 14860*    END-EXEC.
 14861*    MOVE '."C                   ''   #00012357' TO DFHEIV0
 14862     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14863     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14864     MOVE X'2020233030303132333537' TO DFHEIV0(25:11)
 14865     CALL 'kxdfhei1' USING DFHEIV0,
 14866           RTRM-FILE-ID,
 14867           CALCULATION-PASS-AREA,
 14868           CP-COMM-LENGTH,
 14869           DFHEIV99,
 14870           DFHEIV99,
 14871           DFHEIV99
 14872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14873
 14874
 14875 9700-EXIT.
 14876      EXIT.
 14877
 14878 9800-CONVERT-DATE.
 14879     MOVE SPACES TO DC-ERROR-CODE.
 14880
 14881* EXEC CICS LINK
 14882*         PROGRAM    (DATE-CONV)
 14883*         COMMAREA   (DATE-CONVERSION-DATA)
 14884*         LENGTH     (DC-COMM-LENGTH)
 14885*    END-EXEC.
 14886*    MOVE '."C                   ''   #00012368' TO DFHEIV0
 14887     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14888     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14889     MOVE X'2020233030303132333638' TO DFHEIV0(25:11)
 14890     CALL 'kxdfhei1' USING DFHEIV0,
 14891           DATE-CONV,
 14892           DATE-CONVERSION-DATA,
 14893           DC-COMM-LENGTH,
 14894           DFHEIV99,
 14895           DFHEIV99,
 14896           DFHEIV99
 14897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14898
 14899
 14900 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 285
* EL131.cbl
 14901     EXIT.
 14902
 14903 9900-ERROR-FORMAT.
 14904
 14905* EXEC CICS LINK
 14906*         PROGRAM    (XCTL-EL001)
 14907*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 14908*         LENGTH     (EMI-COMM-LENGTH)
 14909*    END-EXEC.
 14910*    MOVE '."C                   ''   #00012378' TO DFHEIV0
 14911     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14912     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14913     MOVE X'2020233030303132333738' TO DFHEIV0(25:11)
 14914     CALL 'kxdfhei1' USING DFHEIV0,
 14915           XCTL-EL001,
 14916           ERROR-MESSAGE-INTERFACE-BLOCK,
 14917           EMI-COMM-LENGTH,
 14918           DFHEIV99,
 14919           DFHEIV99,
 14920           DFHEIV99
 14921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14922
 14923
 14924 9900-EXIT.
 14925     EXIT.
 14926
 14927 9990-ABEND.
 14928     MOVE DFHEIBLK               TO EMI-LINE1.
 14929
 14930* EXEC CICS LINK
 14931*         PROGRAM   (XCTL-EL004)
 14932*         COMMAREA  (EMI-LINE1)
 14933*         LENGTH    (72)
 14934*     END-EXEC.
 14935     MOVE 72
 14936       TO DFHEIV11
 14937*    MOVE '."C                   ''   #00012389' TO DFHEIV0
 14938     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14940     MOVE X'2020233030303132333839' TO DFHEIV0(25:11)
 14941     CALL 'kxdfhei1' USING DFHEIV0,
 14942           XCTL-EL004,
 14943           EMI-LINE1,
 14944           DFHEIV11,
 14945           DFHEIV99,
 14946           DFHEIV99,
 14947           DFHEIV99
 14948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14949
 14950
 14951     MOVE -1                     TO  MAINTL
 14952
 14953     GO TO 8110-SEND-DATA.
 14954
 14955 9995-SECURITY-VIOLATION.
 14956*           COPY ELCSCTP.
 14957******************************************************************
 14958*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 286
* EL131.cbl
 14959*                            ELCSCTP                             *
 14960*                            VMOD=2.001                          *
 14961*                                                                *
 14962*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 14963******************************************************************
 14964
 14965
 14966     MOVE EIBDATE          TO SM-JUL-DATE.
 14967     MOVE EIBTRMID         TO SM-TERMID.
 14968     MOVE THIS-PGM         TO SM-PGM.
 14969     MOVE EIBTIME          TO TIME-IN.
 14970     MOVE TIME-OUT         TO SM-TIME.
 14971     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 14972
 14973
 14974* EXEC CICS LINK
 14975*         PROGRAM  ('EL003')
 14976*         COMMAREA (SECURITY-MESSAGE)
 14977*         LENGTH   (80)
 14978*    END-EXEC.
 14979     MOVE 'EL003' TO DFHEIV1
 14980     MOVE 80
 14981       TO DFHEIV11
 14982*    MOVE '."C                   ''   #00012417' TO DFHEIV0
 14983     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14985     MOVE X'2020233030303132343137' TO DFHEIV0(25:11)
 14986     CALL 'kxdfhei1' USING DFHEIV0,
 14987           DFHEIV1,
 14988           SECURITY-MESSAGE,
 14989           DFHEIV11,
 14990           DFHEIV99,
 14991           DFHEIV99,
 14992           DFHEIV99
 14993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14994
 14995
 14996******************************************************************
 14997
 14998
 14999
 15000 9999-DFHBACK SECTION.
 15001     MOVE '9%                    "   ' TO DFHEIV0
 15002     MOVE 'EL131' TO DFHEIV1
 15003     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15004     GOBACK.
 15005 9999-DFHEXIT.
 15006     IF DFHEIGDJ EQUAL 0001
 15007         NEXT SENTENCE
 15008     ELSE IF DFHEIGDJ EQUAL 2
 15009         GO TO 8820-XCTL-ERROR,
 15010               8150-ENTERED-CLAIM-NOTFOUND,
 15011               9990-ABEND
 15012         DEPENDING ON DFHEIGDI
 15013     ELSE IF DFHEIGDJ EQUAL 3
 15014         GO TO 0130-TS-ERROR,
 15015               0130-TS-ERROR
 15016         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 287
* EL131.cbl
 15017     ELSE IF DFHEIGDJ EQUAL 4
 15018         GO TO 0600-CONTINUE-NAME-UPDATE
 15019         DEPENDING ON DFHEIGDI
 15020     ELSE IF DFHEIGDJ EQUAL 5
 15021         GO TO 1004-BENE-NOT-FOUND
 15022         DEPENDING ON DFHEIGDI
 15023     ELSE IF DFHEIGDJ EQUAL 6
 15024         GO TO 1120-CNTL-NOTFND
 15025         DEPENDING ON DFHEIGDI
 15026     ELSE IF DFHEIGDJ EQUAL 7
 15027         GO TO 1150-NOTOPEN-ERROR,
 15028               1150-EXIT
 15029         DEPENDING ON DFHEIGDI
 15030     ELSE IF DFHEIGDJ EQUAL 8
 15031         GO TO 1490-STATE-NOTFND
 15032         DEPENDING ON DFHEIGDI
 15033     ELSE IF DFHEIGDJ EQUAL 9
 15034         GO TO 1500-CARR-NOTFND
 15035         DEPENDING ON DFHEIGDI
 15036     ELSE IF DFHEIGDJ EQUAL 10
 15037         GO TO 1620-ACCT-NOTFND
 15038         DEPENDING ON DFHEIGDI
 15039     ELSE IF DFHEIGDJ EQUAL 11
 15040         GO TO 2020-EXIT
 15041         DEPENDING ON DFHEIGDI
 15042     ELSE IF DFHEIGDJ EQUAL 12
 15043         GO TO 2030-EXIT
 15044         DEPENDING ON DFHEIGDI
 15045     ELSE IF DFHEIGDJ EQUAL 13
 15046         GO TO 2040-EXIT
 15047         DEPENDING ON DFHEIGDI
 15048     ELSE IF DFHEIGDJ EQUAL 14
 15049         GO TO 2050-EXIT
 15050         DEPENDING ON DFHEIGDI
 15051     ELSE IF DFHEIGDJ EQUAL 15
 15052         GO TO 2060-CERT-NOTFND
 15053         DEPENDING ON DFHEIGDI
 15054     ELSE IF DFHEIGDJ EQUAL 16
 15055         GO TO 2060-DUPKEY
 15056         DEPENDING ON DFHEIGDI
 15057     ELSE IF DFHEIGDJ EQUAL 17
 15058         GO TO 2070-NOT-FOUND
 15059         DEPENDING ON DFHEIGDI
 15060     ELSE IF DFHEIGDJ EQUAL 18
 15061         GO TO 2070-EXIT
 15062         DEPENDING ON DFHEIGDI
 15063     ELSE IF DFHEIGDJ EQUAL 19
 15064         GO TO 2080-EXIT
 15065         DEPENDING ON DFHEIGDI
 15066     ELSE IF DFHEIGDJ EQUAL 20
 15067         GO TO 2400-TRLR-NOTFND,
 15068               2410-EXIT
 15069         DEPENDING ON DFHEIGDI
 15070     ELSE IF DFHEIGDJ EQUAL 21
 15071         GO TO 2425-NINETY-NOTFND,
 15072               2425-NINETY-NOTFND
 15073         DEPENDING ON DFHEIGDI
 15074     ELSE IF DFHEIGDJ EQUAL 22
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 288
* EL131.cbl
 15075         GO TO 2430-EXIT,
 15076               2440-EXIT
 15077         DEPENDING ON DFHEIGDI
 15078     ELSE IF DFHEIGDJ EQUAL 23
 15079         GO TO 2440-EXIT
 15080         DEPENDING ON DFHEIGDI
 15081     ELSE IF DFHEIGDJ EQUAL 24
 15082         GO TO 2460-EXIT
 15083         DEPENDING ON DFHEIGDI
 15084     ELSE IF DFHEIGDJ EQUAL 25
 15085         GO TO 2475-EXIT
 15086         DEPENDING ON DFHEIGDI
 15087     ELSE IF DFHEIGDJ EQUAL 26
 15088         GO TO 2650-EXIT
 15089         DEPENDING ON DFHEIGDI
 15090     ELSE IF DFHEIGDJ EQUAL 27
 15091         GO TO 3010-DEL-ACTQ,
 15092               3040-EXIT
 15093         DEPENDING ON DFHEIGDI
 15094     ELSE IF DFHEIGDJ EQUAL 28
 15095         GO TO 3010-NO-ACTIVITY,
 15096               3050-EXIT
 15097         DEPENDING ON DFHEIGDI
 15098     ELSE IF DFHEIGDJ EQUAL 29
 15099         GO TO 3010-CERT-NOT-FOUND
 15100         DEPENDING ON DFHEIGDI
 15101     ELSE IF DFHEIGDJ EQUAL 30
 15102         GO TO 3020-EXIT
 15103         DEPENDING ON DFHEIGDI
 15104     ELSE IF DFHEIGDJ EQUAL 31
 15105         GO TO 3060-EXIT,
 15106               3060-EXIT
 15107         DEPENDING ON DFHEIGDI
 15108     ELSE IF DFHEIGDJ EQUAL 32
 15109         GO TO 5000-TRLR-NOT-FOUND
 15110         DEPENDING ON DFHEIGDI
 15111     ELSE IF DFHEIGDJ EQUAL 33
 15112         GO TO 5000-CERT-NOT-FOUND
 15113         DEPENDING ON DFHEIGDI
 15114     ELSE IF DFHEIGDJ EQUAL 34
 15115         GO TO 7630-END-BROWSE
 15116         DEPENDING ON DFHEIGDI
 15117     ELSE IF DFHEIGDJ EQUAL 35
 15118         GO TO 7799-EXIT,
 15119               7799-EXIT
 15120         DEPENDING ON DFHEIGDI
 15121     ELSE IF DFHEIGDJ EQUAL 36
 15122         GO TO 7799-EXIT
 15123         DEPENDING ON DFHEIGDI
 15124     ELSE IF DFHEIGDJ EQUAL 37
 15125         GO TO 7800-NOT-FOUND
 15126         DEPENDING ON DFHEIGDI
 15127     ELSE IF DFHEIGDJ EQUAL 38
 15128         GO TO 8000-NOTE-NOT-FOUND
 15129         DEPENDING ON DFHEIGDI
 15130     ELSE IF DFHEIGDJ EQUAL 39
 15131         GO TO 8990-SEND-TEXT
 15132         DEPENDING ON DFHEIGDI.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 289
* EL131.cbl
 15133     MOVE '9%                    "   ' TO DFHEIV0
 15134     MOVE 'EL131' TO DFHEIV1
 15135     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15136     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       10884     Code:       51492
