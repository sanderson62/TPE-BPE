* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41******************************************************************
    42
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   3
* EL131.cbl
    44 ENVIRONMENT DIVISION.
    45
    46 DATA DIVISION.
    47
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    53 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    54 77  s1                          pic s999 comp-3 value+0.
    55 77  s2                          pic s999 comp-3 value+0.
    56 77  a1                          pic s999 comp-3 value+0.
    57 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    58 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    59 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    60 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    61 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    62 77  ws-max-extension            pic s999 comp-3 value +0.
    63 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    64 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    65 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    66     88  ERPDEF-FOUND                 VALUE 'Y'.
    67 77  ws-eracct-sw                pic x  value ' '.
    68     88  acct-found                value 'Y'.
    69 77  ws-benper-sw                pic x   value ' '.
    70     88  good-benper               value 'Y'.
    71 77  ws-claim-type               pic x value ' '.
    72 77  ws-ben-per                  pic 99 value 00.
    73 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    74 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    75 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    76 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    77
    78 01  LCP-TIME-OF-DAY-XX.
    79     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    80     05  FILLER                    PIC 99.
    81 01  LCP-CICS-TIME                 PIC 9(15).
    82*                            COPY ELCSCTM.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCSCTM                             *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    90*                                                                *
    91******************************************************************
    92 01  SECURITY-MESSAGE.
    93     12  FILLER                          PIC X(30)
    94            VALUE '** LOGIC SECURITY VIOLATION -'.
    95     12  SM-READ                         PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' PGM='.
    98     12  SM-PGM                          PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' OPR='.
   101     12  SM-PROCESSOR-ID                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   4
* EL131.cbl
   102     12  FILLER                          PIC X(6)
   103            VALUE ' TERM='.
   104     12  SM-TERMID                       PIC X(4).
   105     12  FILLER                          PIC XX   VALUE SPACE.
   106     12  SM-JUL-DATE                     PIC 9(5).
   107     12  FILLER                          PIC X    VALUE SPACE.
   108     12  SM-TIME                         PIC 99.99.
   109
   110
   111*                            COPY ELCSCRTY.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCSCRTY                            *
   116*                            VMOD=2.001                          *
   117*                                                                *
   118*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   119*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   120*        SAVED IN PI-SECURITY-ADDRESS.                           *
   121*                                                                *
   122******************************************************************
   123 01  SECURITY-CONTROL.
   124     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   125     12  FILLER                       PIC XX    VALUE 'SC'.
   126     12  SC-CREDIT-CODES.
   127         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   128             20  SC-CREDIT-DISPLAY    PIC X.
   129             20  SC-CREDIT-UPDATE     PIC X.
   130     12  SC-CLAIMS-CODES.
   131         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   132             20  SC-CLAIMS-DISPLAY    PIC X.
   133             20  SC-CLAIMS-UPDATE     PIC X.
   134
   135*                            COPY ELCNWA.
   136*****************************************************************
   137*                                                               *
   138*                                                               *
   139*                            ELCNWA.                            *
   140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   141*                            VMOD=2.003                         *
   142*                                                               *
   143*            M O V E   N A M E   W O R K   A R E A.             *
   144*                                                               *
   145*****************************************************************.
   146
   147 01  WS-NAME-WORK-AREA.
   148     05  WS-INSURED-LAST-NAME        PIC X(15).
   149     05  WS-INSURED-1ST-NAME         PIC X(12).
   150     05  WS-INSURED-MID-INIT         PIC X.
   151
   152     05  WS-NAME-WORK.
   153         10  WS-NW                   PIC X
   154             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   155
   156     05  WS-NAME-WORK2.
   157         10  WS-NW2                  PIC X
   158             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   159                                        NWA-INDEX0.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   5
* EL131.cbl
   160
   161     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   162                                     COMP-3.
   163
   164
   165 01  ws-dcc-error-line.
   166     05  filler occurs 15.
   167         10  ws-error-no        pic x(4).
   168 01  WS-DATE-AREA.
   169     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   170     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   171     12  SAVE-DATE-CCYYMMDD.
   172         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   173         16  SAVE-DATE-YMD.
   174             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   175             20  FILLER         PIC X(4)    VALUE SPACES.
   176
   177 01  WS-BLANK                   PIC X       VALUE ' '.
   178
   179 01  CSO-WORK-FIELDS.
   180     05  WS-HOLD-CLAIM-STATUS    PIC X.
   181     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   182     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   183         10  WS-RECURRENT-YN     PIC X.
   184         10  FILLER              PIC X.
   185
   186 01  LITERALS-NUMBERS.
   187     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   188     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   189     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   190     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   191     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   192     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   193     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   194     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   195
   196     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   197     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   198     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   199     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   200     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   201     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   202     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   203     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   204     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   205     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   206
   207     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   208
   209     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   210
   211     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   212     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   213     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   214     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   215     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   216     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   217     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   6
* EL131.cbl
   218     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   219     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   220     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   221     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   222
   223     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   224     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   225     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   226     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   227         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   228     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   229     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   230     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   231     12  WS-ICD-CODE-1           PIC X(8).
   232     12  WS-ICD-CODE-2           PIC X(8).
   233     12  WS-CLAIM-SEQU.
   234         16  FILLER              PIC X VALUE '('.
   235         16  WS-CURRENT-SEQU     PIC Z9.
   236         16  FILLER              PIC X(04) VALUE ' OF '.
   237         16  WS-OF-SEQU          PIC Z9.
   238         16  FILLER              PIC X VALUE ')'.
   239     12  WS-EDIT-BEN-CODE        PIC XX.
   240         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   241                                          '90' THRU '99'.
   242
   243     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   244     12  WS-EDIT-NUMBER          PIC ZZZ9.
   245
   246     12  WS-RESPONSE             PIC S9(8)   COMP.
   247         88  WS-RESP-NORMAL              VALUE +00.
   248         88  WS-RESP-ERROR               VALUE +01.
   249         88  WS-RESP-NOTFND              VALUE +13.
   250         88  WS-RESP-DUPKEY              VALUE +15.
   251         88  WS-RESP-NOTOPEN             VALUE +19.
   252         88  WS-RESP-ENDFILE             VALUE +20.
   253
   254     12  WS-MOS-PAID             PIC 999.
   255     12  WS-ODD-DAYS             PIC 99.
   256     12  WS-REM-MOS              PIC 999.
   257     12  WS-REM-DAYS             PIC 99.
   258     12  WS-TERM-IN-DAYS         PIC 9(4).
   259     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   260
   261     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   262     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   263     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   264     12  WS-RESET-SW             PIC X       VALUE 'N'.
   265     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   266     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   267     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   268
   269 01  DMD-DATE-YYYYMMDD.
   270     12  DMD-DECADE          PIC XX      VALUE SPACES.
   271     12  DMD-YYMMDD.
   272         16  DMD-YY          PIC XX      VALUE SPACES.
   273         16  DMD-MM          PIC XX      VALUE SPACES.
   274         16  DMD-DD          PIC XX      VALUE SPACES.
   275
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   7
* EL131.cbl
   276 01  DMD-DATE-MMDDYYYY.
   277     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   278     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   279     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   280     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   281     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   282     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   283
   284 01  WS-MAIL-CODE.
   285     12  FILLER              PIC X.
   286     12  DMD-MAIL-CODE.
   287         16  WS-MAIL-4       PIC X(4).
   288         16  WS-MAIL-5       PIC X.
   289     12  FILLER              PIC X(4).
   290
   291     12  W-NAME-LAST             PIC  X(15).
   292     12  W-NAME-FIRST            PIC  X(15).
   293     12  W-NAME-MIDDLE.
   294         16  FILLER              PIC  X.
   295         16  W-NAME-MIDDLE-2     PIC  X.
   296         16  FILLER              PIC  X(13).
   297
   298*    COPY ELCDCTB.
   299******************************************************************
   300*                                                                *
   301*                                                                *
   302*                            ELCDCTB.                            *
   303*                            VMOD=2.002                          *
   304*                                                                *
   305*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   306*       COMMUNICATIONS AREA                                      *
   307*                                                                *
   308******************************************************************
   309 01  DCT-COMMUNICATION-AREA.
   310     12  DCT-BILLING-BANK-ID      PIC  X(05).
   311     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   312     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   313     12  DCT-PRODUCT-CODE         PIC  X(02).
   314     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   315     12  DCT-RETURN-CODE          PIC  X(02).
   316     12  DCT-MAIL-CODE            PIC  X(05).
   317     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   318     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   8
* EL131.cbl
   320 01  ERROR-SWITCHES.
   321     12  ERROR-SWITCH            PIC X.
   322         88  SCREEN-ERROR                    VALUE 'X'.
   323     12  MSTR-KEY-SWITCH         PIC X.
   324         88  MSTR-KEY-CHANGED                VALUE 'X'.
   325     12  CERT-KEY-SWITCH         PIC X.
   326*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   327         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   328*********SET TO Y IF PRIMARY KEY WILL CHANGE
   329         88  CERT-KEY-CHANGED                VALUE 'Y'.
   330     12  MSTR-SWITCH             PIC X.
   331         88  MSTR-UPDATES                    VALUE 'X'.
   332     12  crtt-switch             pic x value spaces.
   333         88  crtt-update             value 'X'.
   334     12  CERT-SWITCH             PIC X.
   335         88  CERT-UPDATES                    VALUE 'X'.
   336     12  UPDATE-SWITCH           PIC X.
   337         88  UPDATES-PRESENT                 VALUE 'X'.
   338     12  TRLR-SWITCH             PIC X.
   339         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   340         88  UPDATE-MADE                     VALUE 'Y'.
   341     12  NINETY-TRLR-SWITCH      PIC X.
   342         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   343     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   344         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   345     12  EARNINGS-CALC-SWITCH    PIC X.
   346         88  TEX-REG                         VALUE '4'.
   347         88  NET-PAY                         VALUE '5'.
   348     12  DLYACTV-SW              PIC X       VALUE 'N'.
   349         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page   9
* EL131.cbl
   351 01  EDIT-WORK-AREA.
   352     12  COUNT-2                 PIC 9.
   353     12  CALL-PGM                PIC X(8).
   354     12  TRANS-ID                PIC X(4).
   355     12  CHECK-PFKEYS            PIC 99.
   356     12  CHECK-MAINT             PIC X.
   357         88  ADD-ALPHA-RECORD                VALUE 'A'.
   358         88  CHANGE-CLAIM                    VALUE 'C'.
   359         88  DELETE-CLAIM                    VALUE 'D'.
   360         88  CHANGE-NAME                     VALUE 'N'.
   361         88  VALID-OPTIONS                   VALUE 'A' 'C'
   362                                                   'D' 'N'.
   363
   364     12  HOLD-BENEFIT            PIC XX.
   365     12  HOLD-FREQ               PIC XX.
   366     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   367     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   368     12  HOLD-PDTHRU             PIC XX.
   369     12  HOLD-ADDON              PIC XX.
   370     12  HOLD-NODAYS             PIC 9(4).
   371     12  HOLD-NOPMTS             PIC 9(3).
   372     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   373     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   374     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   375     12  HOLD-BIRTH              PIC XX.
   376     12  HOLD-END                PIC XX.
   377     12  HOLD-EFF                PIC XX.
   378     12  HOLD-ENTRY              PIC XX.
   379     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   380     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   381     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   382     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   383     12  HOLD-LF-CV-CAN          PIC XX.
   384     12  HOLD-AH-CV-CAN          PIC XX.
   385     12  DIVIDE-QUOT             PIC 9(3).
   386     12  DIVIDE-REM              PIC 9(3).
   387
   388     12  WS-ALPHA-DATE.
   389         16  WS-ALPHA-YEAR.
   390             20  WS-ALPHA-YY-1   PIC 99.
   391             20  WS-ALPHA-YY-2   PIC 99.
   392         16  WS-ALPHA-MM         PIC 99.
   393         16  WS-ALPHA-DD         PIC 99.
   394
   395     12  BUILD-VALID-DATE.
   396         16  BUILD-MONTH         PIC 99.
   397         16  BUILD-DAY           PIC 99.
   398         16  BUILD-YEAR          PIC 99.
   399     12  DEEDIT-MMYY-INPUT.
   400         16  FILLER              PIC X.
   401         16  DEEDIT-MONTH        PIC XX.
   402         16  DEEDIT-YEAR         PIC XX.
   403     12  DEEDIT-BEN              PIC 9(9)V99.
   404     12  DEEDIT-DATE-INPUT.
   405         16  FILLER              PIC XX.
   406         16  DEEDIT-DATE         PIC X(6).
   407     12  WORK-DATE-MDY.
   408         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  10
* EL131.cbl
   409         16  FILLER              PIC X(4).
   410         16  YEAR-WORK           PIC XX.
   411     12  WORK-DATE-MY.
   412         16  WORK-MONTH          PIC XX.
   413         16  WORK-SLASH          PIC X       VALUE '/'.
   414         16  WORK-YEAR           PIC XX.
   415     12  HOLD-DATE.
   416         16  HOLD-MONTH          PIC 99.
   417         16  FILLER              PIC X(4).
   418         16  HOLD-YEAR           PIC 99.
   419     12  SPLIT-INFO-LINE-1.
   420         16  SPLIT-INFO-DESC     PIC X(15).
   421         16  FILLER              PIC X(5)    VALUE ' OLD='.
   422         16  SPLIT-INFO-OLD      PIC X(40).
   423     12  EFF-TERM-MO             PIC 9(4).
   424     12  CURR-MO                 PIC 9(4).
   425     12  WS-BIN-CURRENT-DT       PIC XX.
   426     12  WS-CALC-METHOD          PIC X.
   427     12  WS-INITIALS.
   428         16  WS-INIT-1           PIC X.
   429         16  WS-INIT-2           PIC X.
   430     12  WS-REIN-TABLE.
   431         16  WS-REIN-1           PIC X.
   432         16  WS-REIN-2           PIC X.
   433         16  WS-REIN-3           PIC X.
   434     12  PI-KEY.
   435         16  PI-TERM             PIC X(4).
   436         16  PI-QUAL             PIC X(4).
   437     12  CHECK-KEY               PIC X(20).
   438     12  SAVE-ACCT-KEY           PIC X(20).
   439     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   440     12  WS-SOC-SEC-NUMBER.
   441         16  WS-SOC-SEC-NO       PIC 9(9).
   442         16  WS-SOC-SEC-BLANK    PIC X(2).
   443     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   444         16  WS-SSN-1-3          PIC 9(3).
   445         16  WS-SSN-DASH1        PIC X(1).
   446         16  WS-SSN-4-5          PIC 9(2).
   447         16  WS-SSN-DASH2        PIC X(1).
   448         16  WS-SSN-6-9          PIC 9(4).
   449     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   450     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   451
   452 01  WS-SAVE-FIELDS.
   453     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   454     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   455     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   456     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   457     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   458     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   459     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   460     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   461     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   462     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   463     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   464     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   465     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   466     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  11
* EL131.cbl
   467     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   468     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   469     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   470     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   471     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   472     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   473     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   474     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   475     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   476     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   477     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   478     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   479     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   480     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   481     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   483     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   485     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   487     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   489     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   491     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   493     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   495     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   497     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   499     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   501     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   503     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   505     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   506     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   507     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   508
   509 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   510     12  M                   PIC S9(7)V99           VALUE ZEROS.
   511     12  L                   PIC S9(7)V99           VALUE ZEROS.
   512     12  N                   PIC S9(3)              VALUE ZEROS.
   513     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   514     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   515     12  I                   PIC S99V9(5)           VALUE ZEROS.
   516     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   517     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   518     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   519     12  R                   PIC S9(3)              VALUE ZEROS.
   520     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   521     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   522     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   523     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   524     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  12
* EL131.cbl
   525     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   526     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   527     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   528     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   529
   530 01  TERM-CALC-WORK-AREA.
   531     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   532     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   533     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   534     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   535     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   536     12  V-EXPONENTS.
   537        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   538     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   539
   540 01  TIME-IN.
   541     12  UN-HOURS                PIC XX.
   542     12  UN-MINUTES              PIC XX.
   543     12  FILLER                  PIC XX.
   544
   545 01  TIME-OUT.
   546     12  FOR-HOURS               PIC XX.
   547     12  FILLER                  PIC X       VALUE '.'.
   548     12  FOR-MINUTES             PIC XX.
   549
   550 01  ERROR-NUMBERS.
   551     12  ER-0000                 PIC X(4)    VALUE '0000'.
   552     12  ER-0004                 PIC X(4)    VALUE '0004'.
   553     12  ER-0008                 PIC X(4)    VALUE '0008'.
   554     12  ER-0023                 PIC X(4)    VALUE '0023'.
   555     12  ER-0029                 PIC X(4)    VALUE '0029'.
   556     12  ER-0068                 PIC X(4)    VALUE '0068'.
   557     12  ER-0070                 PIC X(4)    VALUE '0070'.
   558     12  ER-0149                 PIC X(4)    VALUE '0149'.
   559     12  ER-0154                 PIC X(4)    VALUE '0154'.
   560     12  ER-0169                 PIC X(4)    VALUE '0169'.
   561     12  ER-0192                 PIC X(4)    VALUE '0192'.
   562     12  ER-0199                 PIC X(4)    VALUE '0199'.
   563     12  ER-0203                 PIC X(4)    VALUE '0203'.
   564     12  ER-0204                 PIC X(4)    VALUE '0204'.
   565     12  ER-0205                 PIC X(4)    VALUE '0205'.
   566     12  ER-0206                 PIC X(4)    VALUE '0206'.
   567     12  ER-0208                 PIC X(4)    VALUE '0208'.
   568     12  ER-0210                 PIC X(4)    VALUE '0210'.
   569     12  ER-0215                 PIC X(4)    VALUE '0215'.
   570     12  ER-0219                 PIC X(4)    VALUE '0219'.
   571     12  ER-0220                 PIC X(4)    VALUE '0220'.
   572     12  ER-0222                 PIC X(4)    VALUE '0222'.
   573     12  ER-0223                 PIC X(4)    VALUE '0223'.
   574     12  ER-0224                 PIC X(4)    VALUE '0224'.
   575     12  ER-0227                 PIC X(4)    VALUE '0227'.
   576     12  ER-0230                 PIC X(4)    VALUE '0230'.
   577     12  ER-0232                 PIC X(4)    VALUE '0232'.
   578     12  ER-0233                 PIC X(4)    VALUE '0233'.
   579     12  ER-0236                 PIC X(4)    VALUE '0236'.
   580     12  ER-0237                 PIC X(4)    VALUE '0237'.
   581     12  ER-0238                 PIC X(4)    VALUE '0238'.
   582     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  13
* EL131.cbl
   583     12  ER-0241                 PIC X(4)    VALUE '0241'.
   584     12  ER-0243                 PIC X(4)    VALUE '0243'.
   585     12  ER-0244                 PIC X(4)    VALUE '0244'.
   586     12  ER-0246                 PIC X(4)    VALUE '0246'.
   587     12  ER-0247                 PIC X(4)    VALUE '0247'.
   588     12  ER-0248                 PIC X(4)    VALUE '0248'.
   589     12  ER-0250                 PIC X(4)    VALUE '0250'.
   590     12  ER-0251                 PIC X(4)    VALUE '0251'.
   591     12  ER-0253                 PIC X(4)    VALUE '0253'.
   592     12  ER-0256                 PIC X(4)    VALUE '0256'.
   593     12  ER-0257                 PIC X(4)    VALUE '0257'.
   594     12  ER-0258                 PIC X(4)    VALUE '0258'.
   595     12  ER-0259                 PIC X(4)    VALUE '0259'.
   596     12  ER-0260                 PIC X(4)    VALUE '0260'.
   597     12  ER-0261                 PIC X(4)    VALUE '0261'.
   598     12  ER-0262                 PIC X(4)    VALUE '0262'.
   599     12  ER-0263                 PIC X(4)    VALUE '0263'.
   600     12  ER-0273                 PIC X(4)    VALUE '0273'.
   601     12  ER-0274                 PIC X(4)    VALUE '0274'.
   602     12  ER-0276                 PIC X(4)    VALUE '0276'.
   603     12  ER-0282                 PIC X(4)    VALUE '0282'.
   604     12  ER-0283                 PIC X(4)    VALUE '0283'.
   605     12  ER-0309                 PIC X(4)    VALUE '0309'.
   606     12  ER-0310                 PIC X(4)    VALUE '0310'.
   607     12  ER-0311                 PIC X(4)    VALUE '0311'.
   608     12  ER-0333                 PIC X(4)    VALUE '0333'.
   609     12  ER-0360                 PIC X(4)    VALUE '0360'.
   610     12  ER-0377                 PIC X(4)    VALUE '0377'.
   611     12  ER-0402                 PIC X(4)    VALUE '0402'.
   612     12  ER-0416                 PIC X(4)    VALUE '0416'.
   613     12  ER-0426                 PIC X(4)    VALUE '0426'.
   614     12  ER-0427                 PIC X(4)    VALUE '0427'.
   615     12  ER-0428                 PIC X(4)    VALUE '0428'.
   616     12  ER-0429                 PIC X(4)    VALUE '0429'.
   617     12  ER-0430                 PIC X(4)    VALUE '0430'.
   618     12  ER-0458                 PIC X(4)    VALUE '0458'.
   619     12  ER-0475                 PIC X(4)    VALUE '0475'.
   620     12  ER-0491                 PIC X(4)    VALUE '0491'.
   621     12  ER-0509                 PIC X(4)    VALUE '0509'.
   622     12  ER-0510                 PIC X(4)    VALUE '0510'.
   623     12  ER-0511                 PIC X(4)    VALUE '0511'.
   624     12  ER-0512                 PIC X(4)    VALUE '0512'.
   625     12  ER-0519                 PIC X(4)    VALUE '0519'.
   626     12  ER-0520                 PIC X(4)    VALUE '0520'.
   627     12  ER-0521                 PIC X(4)    VALUE '0521'.
   628     12  ER-0547                 PIC X(4)    VALUE '0547'.
   629     12  ER-0548                 PIC X(4)    VALUE '0548'.
   630     12  ER-0549                 PIC X(4)    VALUE '0549'.
   631     12  ER-0565                 PIC X(4)    VALUE '0565'.
   632     12  ER-0598                 PIC X(4)    VALUE '0598'.
   633     12  ER-0639                 PIC X(4)    VALUE '0639'.
   634     12  ER-0797                 PIC X(4)    VALUE '0797'.
   635     12  ER-0802                 PIC X(4)    VALUE '0802'.
   636     12  ER-0803                 PIC X(4)    VALUE '0803'.
   637     12  ER-0849                 PIC X(4)    VALUE '0849'.
   638     12  ER-0885                 PIC X(4)    VALUE '0885'.
   639     12  ER-0887                 PIC X(4)    VALUE '0887'.
   640     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  14
* EL131.cbl
   641     12  ER-0921                 PIC X(4)    VALUE '0921'.
   642     12  ER-0938                 PIC X(4)    VALUE '0938'.
   643     12  ER-0946                 PIC X(4)    VALUE '0946'.
   644     12  ER-0947                 PIC X(4)    VALUE '0947'.
   645     12  ER-0948                 PIC X(4)    VALUE '0948'.
   646     12  ER-0949                 PIC X(4)    VALUE '0949'.
   647     12  ER-0950                 PIC X(4)    VALUE '0950'.
   648     12  ER-0951                 PIC X(4)    VALUE '0951'.
   649     12  ER-0954                 PIC X(4)    VALUE '0954'.
   650     12  ER-0974                 PIC X(4)    VALUE '0974'.
   651     12  ER-0975                 PIC X(4)    VALUE '0975'.
   652     12  ER-0992                 PIC X(4)    VALUE '0992'.
   653     12  ER-1651                 PIC X(4)    VALUE '1651'.
   654     12  ER-1652                 PIC X(4)    VALUE '1652'.
   655     12  ER-1653                 PIC X(4)    VALUE '1653'.
   656     12  ER-1654                 PIC X(4)    VALUE '1654'.
   657     12  ER-1655                 PIC X(4)    VALUE '1655'.
   658     12  er-1656                 pic x(4)    value '1656'.
   659     12  ER-1661                 PIC X(4)    VALUE '1661'.
   660     12  ER-1662                 PIC X(4)    VALUE '1662'.
   661     12  ER-1663                 PIC X(4)    VALUE '1663'.
   662     12  er-1664                 pic x(4)    value '1664'.
   663     12  er-1665                 pic x(4)    value '1665'.
   664     12  er-1666                 pic x(4)    value '1666'.
   665     12  er-1668                 pic x(4)    value '1668'.
   666     12  er-1669                 pic x(4)    value '1669'.
   667     12  er-1676                 pic x(4)    value '1676'.
   668     12  ER-1773                 PIC X(4)    VALUE '1773'.
   669     12  ER-2280                 PIC X(4)    VALUE '2280'.
   670     12  ER-2878                 PIC X(4)    VALUE '2878'.
   671     12  ER-7641                 PIC X(4)    VALUE '7641'.
   672     12  ER-7642                 PIC X(4)    VALUE '7642'.
   673     12  ER-7650                 PIC X(4)    VALUE '7650'.
   674     12  ER-7651                 PIC X(4)    VALUE '7651'.
   675     12  ER-7687                 PIC X(4)    VALUE '7687'.
   676     12  ER-7689                 PIC X(4)    VALUE '7689'.
   677     12  ER-7690                 PIC X(4)    VALUE '7690'.
   678     12  ER-7691                 PIC X(4)    VALUE '7691'.
   679     12  ER-8003                 PIC X(4)    VALUE '8003'.
   680     12  ER-8051                 PIC X(4)    VALUE '8051'.
   681     12  ER-8052                 PIC X(4)    VALUE '8052'.
   682     12  ER-8053                 PIC X(4)    VALUE '8053'.
   683     12  ER-8054                 PIC X(4)    VALUE '8054'.
   684     12  ER-8055                 PIC X(4)    VALUE '8055'.
   685     12  ER-8056                 PIC X(4)    VALUE '8056'.
   686     12  ER-8057                 PIC X(4)    VALUE '8057'.
   687     12  ER-8058                 PIC X(4)    VALUE '8058'.
   688     12  ER-8059                 PIC X(4)    VALUE '8059'.
   689     12  ER-8060                 PIC X(4)    VALUE '8060'.
   690     12  ER-8061                 PIC X(4)    VALUE '8061'.
   691     12  ER-8062                 PIC X(4)    VALUE '8062'.
   692     12  ER-8063                 PIC X(4)    VALUE '8063'.
   693     12  ER-8064                 PIC X(4)    VALUE '8064'.
   694     12  ER-8065                 PIC X(4)    VALUE '8065'.
   695     12  ER-8066                 PIC X(4)    VALUE '8066'.
   696     12  ER-8152                 PIC X(4)    VALUE '8152'.
   697     12  ER-8153                 PIC X(4)    VALUE '8153'.
   698     12  ER-8154                 PIC X(4)    VALUE '8154'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  15
* EL131.cbl
   699     12  ER-8155                 PIC X(4)    VALUE '8155'.
   700 01  ERPDEF-KEY-SAVE             PIC X(18).
   701 01  ERPDEF-KEY.
   702     12  ERPDEF-COMPANY-CD       PIC X.
   703     12  ERPDEF-STATE            PIC XX.
   704     12  ERPDEF-PROD-CD          PIC XXX.
   705     12  F                       PIC X(7).
   706     12  ERPDEF-BEN-TYPE         PIC X.
   707     12  ERPDEF-BEN-CODE         PIC XX.
   708     12  ERPDEF-EXP-DT           PIC XX.
   709 01  MSTR-KEY.
   710     12  COMPANY-CODE            PIC X.
   711     12  CARRIER-CODE            PIC X.
   712     12  CLAIM-NO                PIC X(7).
   713     12  CERT-NO.
   714         16  CERT-NO-PRIME       PIC X(10).
   715         16  CERT-NO-SUFX        PIC X.
   716
   717 01  WS-SAVE-CLAIM-KEY.
   718     12  WS-SAVE-COMPANY-CD      PIC X.
   719     12  WS-SAVE-CARRIER         PIC X.
   720     12  WS-SAVE-CLAIM-NO        PIC X(7).
   721     12  WS-SAVE-CERT-NO.
   722         16  WS-CERT-NO-PRIME    PIC X(10).
   723         16  WS-CERT-NO-SUFX     PIC X.
   724
   725 01  CERT-KEY.
   726     12  CERT-COMPANY-CODE       PIC X.
   727     12  CERT-CARRIER            PIC X.
   728     12  CERT-GROUP              PIC X(6).
   729     12  CERT-STATE              PIC XX.
   730     12  CERT-ACCOUNT            PIC X(10).
   731     12  CERT-DATE               PIC XX.
   732     12  CERT-CERT.
   733         16  CERT-CERT-PRIME     PIC X(10).
   734         16  CERT-CERT-SUFX      PIC X.
   735
   736 01  ELCRTT-KEY.
   737     05  CTRLR-COMP-CD       PIC X.
   738     05  CTRLR-CARRIER       PIC X.
   739     05  CTRLR-GROUPING      PIC X(6).
   740     05  CTRLR-STATE         PIC X(2).
   741     05  CTRLR-ACCOUNT       PIC X(10).
   742     05  CTRLR-EFF-DT        PIC XX.
   743     05  CTRLR-CERT-NO       PIC X(11).
   744     05  CTRLR-REC-TYPE      PIC X.
   745 01  NOTE-KEY.
   746     12  NOTE-COMP-CD            PIC X.
   747     12  NOTE-CERT-KEY.
   748         16  NOTE-CARRIER        PIC X.
   749         16  NOTE-GROUP          PIC X(6).
   750         16  NOTE-STATE          PIC XX.
   751         16  NOTE-ACCOUNT        PIC X(10).
   752         16  NOTE-DATE           PIC XX.
   753         16  NOTE-CERT-NO        PIC X(11).
   754
   755 01  TRLR-KEY.
   756     12  TRLR-MAIN-KEY.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  16
* EL131.cbl
   757         16  TRLR-COMPANY-CD     PIC X.
   758         16  TRLR-CARRIER        PIC X.
   759         16  TRLR-CLAIM-NO       PIC X(07).
   760         16  TRLR-CERT-NO        PIC X(11).
   761     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   762
   763 01  BENEFIT-KEY.
   764     12  BEN-CO-ID               PIC X(3).
   765     12  BEN-REC-TYPE            PIC X.
   766     12  FILLER                  PIC XX.
   767     12  BEN-ACC-CD              PIC XX.
   768     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   769
   770 01  CNTL-KEY.
   771     12  CNTL-CO-ID              PIC X(3).
   772     12  CNTL-REC-TYPE           PIC X.
   773     12  CNTL-PROC-ID            PIC X(4).
   774     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   775         16  CNTL-STATE-NUMBER   PIC XX.
   776         16  FILLER              PIC XX.
   777     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   778         16  FILLER              PIC X(3).
   779         16  CNTL-CARRIER        PIC X.
   780     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   781
   782 01  ACTQ-KEY                    PIC X(20).
   783
   784 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   785
   786 01  CHKQ-KEY.
   787     12  CHKQ-COMPANY-CODE       PIC X.
   788     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   789     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   790
   791 01  ARCH-KEY.
   792     12  ARCH-COMPANY-CODE       PIC X.
   793     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   794     12  ARCH-RECORD-TYPE        PIC X.
   795     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   796
   797 01  ACCT-KEY.
   798     05  ACCT-PARTIAL-KEY.
   799         12  ACCT-COMPANY-CODE   PIC X.
   800         12  ACCT-CARRIER        PIC X.
   801         12  ACCT-GROUP          PIC X(6).
   802         12  ACCT-STATE          PIC XX.
   803         12  ACCT-ACCOUNT        PIC X(10).
   804     05  ACCT-DATE               PIC XX.
   805
   806 01  WS-ELBENE-KEY.
   807     12  WS-ELBENE-COMPANY-CD    PIC X.
   808     12  WS-ELBENE-RECORD-TYPE   PIC X.
   809     12  WS-ELBENE-ID            PIC X(10).
   810
   811 01  ELALPH-KEY.
   812     12  ELALPH-COMPANY-CD       PIC X.
   813     12  ELALPH-SOURCE           PIC X.
   814     12  ELALPH-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  17
* EL131.cbl
   815         16  ELALPH-LAST-NAME    PIC X(15).
   816         16  ELALPH-FIRST-NAME.
   817             20  ELALPH-FIRST-INIT   PIC X.
   818             20  FILLER              PIC X(11).
   819         16  ELALPH-MIDDLE-INIT  PIC X.
   820     12  ELALPH-DATE             PIC X(08).
   821     12  ELALPH-TIME             PIC S9(04)    COMP.
   822
   823 01  COMP-LENGTHS.
   824     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   825     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   826     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   827     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   828     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   829     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   830     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   831     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   832     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   833     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   834     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   835     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   836     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   837     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  18
* EL131.cbl
   839*                                COPY ELCLNKLT.
   840******************************************************************
   841*                                                                *
   842*                                                                *
   843*                           ELCLNKLT                             *
   844*                            VMOD=2.003                          *
   845*                                                                *
   846*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   847*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   848*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   849*                                                                *
   850*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   851*   COMPLETING THE REQUIRED FIELDS.                              *
   852*                                                                *
   853*   THE CALLING PROGRAM SHOULD CHECK:                            *
   854*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   855*                              9999 INDICATES AN UNKNOWN ABEND   *
   856*                                   WAS DETECTED.                *
   857*                              ALL OTHER VALUES ARE NORMAL ERROR *
   858*                              CODES FOUND IN THE ERROR FILE.    *
   859******************************************************************
   860 01  W-1523-LINKDATA.
   861     12  W-1523-COMMON-PI-DATA.
   862         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   863         16  FILLER              PIC  X(67).
   864         16  W-1523-COMPANY-CD   PIC  X(01).
   865         16  FILLER              PIC  X(10).
   866         16  W-1523-CONTROL-IN-PROGRESS.
   867             20  W-1523-CARRIER  PIC  X(01).
   868             20  W-1523-GROUPING PIC  X(06).
   869             20  W-1523-STATE    PIC  X(02).
   870             20  W-1523-ACCOUNT  PIC  X(10).
   871             20  W-1523-CLAIM-CERT-GRP.
   872                 24  W-1523-CLAIM-NO
   873                                 PIC  X(07).
   874                 24  W-1523-CERT-NO.
   875                     28  W-1523-CERT-PRIME
   876                                 PIC  X(10).
   877                     28  W-1523-CERT-SFX
   878                                 PIC  X(01).
   879                 24  W-1523-CERT-EFF-DT
   880                                 PIC  X(02).
   881         16  FILLER              PIC X(265).
   882
   883     12  W-1523-WORK-AREA.
   884         16  W-1523-FORM-NUMBER  PIC  X(04).
   885         16  W-1523-NUMBER-COPIES
   886                                 PIC  9(01).
   887         16  W-1523-ADDR-TYPE    PIC  X(02).
   888         16  W-1523-FOLLOW-UP-DATE
   889                                 PIC  X(02).
   890         16  W-1523-RESEND-DATE  PIC  X(02).
   891         16  W-1523-ERROR-CODE   PIC  9(04).
   892             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   893             88  W-1523-FATAL-ERROR
   894                                    VALUES  0006 0013 0042
   895                                            0154 0168 0169
   896                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  19
* EL131.cbl
   897                                            0179 0186 0281
   898                                            0332 2055 3697
   899                                            3698 3699 3770
   900                                            3771 3772 7675
   901                                            9106 9808 9883
   902                                            9887.
   903             88  W-1523-STOP-ERRORS
   904                                    VALUES  0013 0042 0154
   905                                            0168 0169 0172
   906                                            0281 0332 2055
   907                                            3698 3699 7675
   908                                            9106 9808 9883
   909                                            9999.
   910         16  W-1523-REASON       PIC  X(70).
   911         16  W-1523-ARCHIVE-NUMBER
   912                                 PIC  9(08).
   913     12  W-1523-POINTER-AREA.
   914         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   915         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   916         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   917         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   918         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  20
* EL131.cbl
   920*                                COPY ELCINTF.
   921******************************************************************
   922*                                                                *
   923*                                                                *
   924*                            ELCINTF.                            *
   925*                            VMOD=2.017                          *
   926*                                                                *
   927*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   928*                                                                *
   929*       LENGTH = 1024                                            *
   930*                                                                *
   931******************************************************************
   932*                   C H A N G E   L O G
   933*
   934* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   935*-----------------------------------------------------------------
   936*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   937* EFFECTIVE    NUMBER
   938*-----------------------------------------------------------------
   939* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   940******************************************************************
   941 01  PROGRAM-INTERFACE-BLOCK.
   942     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   943     12  PI-CALLING-PROGRAM              PIC X(8).
   944     12  PI-SAVED-PROGRAM-1              PIC X(8).
   945     12  PI-SAVED-PROGRAM-2              PIC X(8).
   946     12  PI-SAVED-PROGRAM-3              PIC X(8).
   947     12  PI-SAVED-PROGRAM-4              PIC X(8).
   948     12  PI-SAVED-PROGRAM-5              PIC X(8).
   949     12  PI-SAVED-PROGRAM-6              PIC X(8).
   950     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   951     12  PI-COMPANY-ID                   PIC XXX.
   952     12  PI-COMPANY-CD                   PIC X.
   953
   954     12  PI-COMPANY-PASSWORD             PIC X(8).
   955
   956     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   957
   958     12  PI-CONTROL-IN-PROGRESS.
   959         16  PI-CARRIER                  PIC X.
   960         16  PI-GROUPING                 PIC X(6).
   961         16  PI-STATE                    PIC XX.
   962         16  PI-ACCOUNT                  PIC X(10).
   963         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   964                                         PIC X(10).
   965         16  PI-CLAIM-CERT-GRP.
   966             20  PI-CLAIM-NO             PIC X(7).
   967             20  PI-CERT-NO.
   968                 25  PI-CERT-PRIME       PIC X(10).
   969                 25  PI-CERT-SFX         PIC X.
   970             20  PI-CERT-EFF-DT          PIC XX.
   971         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   972             20  PI-PLAN-CODE            PIC X(2).
   973             20  PI-REVISION-NUMBER      PIC X(3).
   974             20  PI-PLAN-EFF-DT          PIC X(2).
   975             20  PI-PLAN-EXP-DT          PIC X(2).
   976             20  FILLER                  PIC X(11).
   977         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  21
* EL131.cbl
   978             20  PI-OE-REFERENCE-1.
   979                 25  PI-OE-REF-1-PRIME   PIC X(18).
   980                 25  PI-OE-REF-1-SUFF    PIC XX.
   981
   982     12  PI-SESSION-IN-PROGRESS          PIC X.
   983         88  CLAIM-SESSION                   VALUE '1'.
   984         88  CREDIT-SESSION                  VALUE '2'.
   985         88  WARRANTY-SESSION                VALUE '3'.
   986         88  MORTGAGE-SESSION                VALUE '4'.
   987         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   988
   989
   990*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   991
   992     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   993     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   994
   995     12  PI-CREDIT-USER                  PIC X.
   996         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   997         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   998
   999     12  PI-CLAIM-USER                   PIC X.
  1000         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1001         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1002
  1003     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1004         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1005         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1006         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1007         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1008         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1009
  1010     12  PI-PROCESSOR-ID                 PIC X(4).
  1011
  1012     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1013
  1014     12  PI-MEMBER-CAPTION               PIC X(10).
  1015
  1016     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1017         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1018
  1019     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1020     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1021     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1022     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1023
  1024     12  PI-AH-OVERRIDE-L1               PIC X.
  1025     12  PI-AH-OVERRIDE-L2               PIC XX.
  1026     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1027     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1028
  1029     12  PI-NEW-SYSTEM                   PIC X(2).
  1030
  1031     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1032     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1033         88  PI-USES-PAID-TO                 VALUE '1'.
  1034     12  PI-CRDTCRD-SYSTEM.
  1035         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  22
* EL131.cbl
  1036             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1037             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1038         16  PI-CC-MONTH-END-DT          PIC XX.
  1039     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1040
  1041     12  PI-OE-REFERENCE-2.
  1042         16  PI-OE-REF-2-PRIME           PIC X(10).
  1043         16  PI-OE-REF-2-SUFF            PIC X.
  1044
  1045     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1046
  1047     12  PI-LANGUAGE-TYPE                PIC X.
  1048             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1049             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1050             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1051
  1052     12  PI-POLICY-LINKAGE-IND           PIC X.
  1053         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1054         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1055                                                   LOW-VALUES.
  1056
  1057     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1058     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1059         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1060         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1061
  1062     12  PI-PROCESSOR-CSR-IND            PIC X.
  1063         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1064         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1065
  1066     12  FILLER                          PIC X(3).
  1067
  1068     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1069
  1070     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1071         PI-SYSTEM-LEVEL.
  1072
  1073         16  PI-ENTRY-CODES.
  1074             20  PI-ENTRY-CD-1           PIC X.
  1075             20  PI-ENTRY-CD-2           PIC X.
  1076
  1077         16  PI-RETURN-CODES.
  1078             20  PI-RETURN-CD-1          PIC X.
  1079             20  PI-RETURN-CD-2          PIC X.
  1080
  1081         16  PI-UPDATE-STATUS-SAVE.
  1082             20  PI-UPDATE-BY            PIC X(4).
  1083             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1084
  1085         16  PI-LOWER-CASE-LETTERS       PIC X.
  1086             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1087
  1088*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1089*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1090*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1091
  1092         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1093             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  23
* EL131.cbl
  1094             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1095             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1096             88  ACCNT-CNTL                  VALUE '3'.
  1097             88  CARR-ACCNT-CNTL             VALUE '4'.
  1098
  1099         16  PI-PROCESSOR-CAP-LIST.
  1100             20  PI-SYSTEM-CONTROLS.
  1101                24 PI-SYSTEM-DISPLAY     PIC X.
  1102                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1103                24 PI-SYSTEM-MODIFY      PIC X.
  1104                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1105             20  FILLER                  PIC XX.
  1106             20  PI-DISPLAY-CAP          PIC X.
  1107                 88  DISPLAY-CAP             VALUE 'Y'.
  1108             20  PI-MODIFY-CAP           PIC X.
  1109                 88  MODIFY-CAP              VALUE 'Y'.
  1110             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1111                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1112             20  PI-FORCE-CAP            PIC X.
  1113                 88  FORCE-CAP               VALUE 'Y'.
  1114
  1115         16  PI-PROGRAM-CONTROLS.
  1116             20  PI-PGM-PRINT-OPT        PIC X.
  1117             20  PI-PGM-FORMAT-OPT       PIC X.
  1118             20  PI-PGM-PROCESS-OPT      PIC X.
  1119             20  PI-PGM-TOTALS-OPT       PIC X.
  1120
  1121         16  PI-HELP-INTERFACE.
  1122             20  PI-LAST-ERROR-NO        PIC X(4).
  1123             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1124
  1125         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1126             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1127
  1128         16  PI-CR-CONTROL-IN-PROGRESS.
  1129             20  PI-CR-CARRIER           PIC X.
  1130             20  PI-CR-GROUPING          PIC X(6).
  1131             20  PI-CR-STATE             PIC XX.
  1132             20  PI-CR-ACCOUNT           PIC X(10).
  1133             20  PI-CR-FIN-RESP          PIC X(10).
  1134             20  PI-CR-TYPE              PIC X.
  1135
  1136         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1137
  1138         16  PI-CR-MONTH-END-DT          PIC XX.
  1139
  1140         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1141             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1142             88  PI-ZERO-CARRIER             VALUE '1'.
  1143             88  PI-ZERO-GROUPING            VALUE '2'.
  1144             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1145
  1146         16  PI-CARRIER-SECURITY         PIC X.
  1147             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1148
  1149         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1150             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1151             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  24
* EL131.cbl
  1152
  1153         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1154             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1155                                         INDEXED BY PI-ACCESS-NDX
  1156                                         PIC X.
  1157
  1158         16  PI-GA-BILLING-CONTROL       PIC X.
  1159             88  PI-GA-BILLING               VALUE '1'.
  1160
  1161         16  PI-MAIL-PROCESSING          PIC X.
  1162             88  PI-MAIL-YES                 VALUE 'Y'.
  1163
  1164         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1165
  1166         16  PI-AR-SYSTEM.
  1167             20  PI-AR-PROCESSING-CNTL   PIC X.
  1168                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1169             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1170             20  PI-AR-MONTH-END-DT      PIC XX.
  1171
  1172         16  PI-MP-SYSTEM.
  1173             20  PI-MORTGAGE-USER            PIC X.
  1174                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1175                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1176             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1177                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1178                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1179                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1180                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1181                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1182             20  PI-MP-MONTH-END-DT          PIC XX.
  1183             20  PI-MP-REFERENCE-NO.
  1184                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1185                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1186
  1187         16  PI-LABEL-CONTROL            PIC X(01).
  1188             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1189             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1190
  1191         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1192             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1193
  1194         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1195             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1196             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1197
  1198         16  FILLER                      PIC X(14).
  1199
  1200     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1201******************************************************************
  1202     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1203         16  PI-NO-PMTS                    PIC 9(4).
  1204         16  PI-CERT-SWITCH                PIC X.
  1205             88  CREATED-CERT              VALUE '2'.
  1206         16  PI-PREM-TYPE                  PIC X.
  1207         16  PI-SAVE-CERT-NO.
  1208             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1209             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  25
* EL131.cbl
  1210         16  FILLER                        PIC X(46).
  1211         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1212         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1213         16  PI-REC-FOUND-SW               PIC X.
  1214         16  PI-LETTER-SW                  PIC X.
  1215         16  PI-PREV-TRLR-KEY              PIC X(22).
  1216         16  pi-claim-type                 pic x.
  1217         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1218         16  pi-approval-level             pic x.
  1219         16  FILLER                        PIC X(543).
  1220
  1221 01  SAVE-RECORD                 PIC X(450).
  1222
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  26
* EL131.cbl
  1224*                                COPY ELCLOGOF SUPPRESS.
  1225******************************************************************
  1226*                                                                *
  1227*                                                                *
  1228*                            ELCLOGOF.                           *
  1229*                            VMOD=2.001                          *
  1230*                                                                *
  1231*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1232*                                                                *
  1233******************************************************************
  1234 01  CLASIC-LOGOFF.
  1235     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1236     12  LOGOFF-TEXT.
  1237         16  FILLER          PIC X(5)    VALUE SPACES.
  1238         16  LOGOFF-MSG.
  1239             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1240             20  FILLER      PIC X       VALUE SPACES.
  1241             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1242         16  FILLER          PIC X(80)
  1243           VALUE '* YOU ARE NOW LOGGED OFF'.
  1244         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1245         16  FILLER          PIC X       VALUE QUOTE.
  1246         16  LOGOFF-SYS-MSG  PIC X(17)
  1247           VALUE 'S CLAS-IC SYSTEM '.
  1248     12  TEXT-MESSAGES.
  1249         16  UNACCESS-MSG    PIC X(29)
  1250             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1251         16  PGMIDERR-MSG    PIC X(17)
  1252             VALUE 'PROGRAM NOT FOUND'.
  1253
  1254*                                COPY ELCATTR SUPPRESS.
  1255******************************************************************
  1256*                                                                *
  1257*                            ELCATTR.                            *
  1258*                            VMOD=2.001                          *
  1259*                                                                *
  1260*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1261*                                                                *
  1262*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1263*                                                                *
  1264*                   POS 1   P=PROTECTED                          *
  1265*                           U=UNPROTECTED                        *
  1266*                           S=ASKIP                              *
  1267*                   POS 2   A=ALPHA/NUMERIC                      *
  1268*                           N=NUMERIC                            *
  1269*                   POS 3   N=NORMAL                             *
  1270*                           B=BRIGHT                             *
  1271*                           D=DARK                               *
  1272*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1273*                           OF=MODIFIED DATA TAG OFF             *
  1274*                                                                *
  1275*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1276******************************************************************
  1277 01  ATTRIBUTE-LIST.
  1278     12  AL-PABOF            PIC X       VALUE 'Y'.
  1279     12  AL-PABON            PIC X       VALUE 'Z'.
  1280     12  AL-PADOF            PIC X       VALUE '%'.
  1281     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  27
* EL131.cbl
  1282     12  AL-PANOF            PIC X       VALUE '-'.
  1283     12  AL-PANON            PIC X       VALUE '/'.
  1284     12  AL-SABOF            PIC X       VALUE '8'.
  1285     12  AL-SABON            PIC X       VALUE '9'.
  1286     12  AL-SADOF            PIC X       VALUE '@'.
  1287     12  AL-SADON            PIC X       VALUE QUOTE.
  1288     12  AL-SANOF            PIC X       VALUE '0'.
  1289     12  AL-SANON            PIC X       VALUE '1'.
  1290     12  AL-UABOF            PIC X       VALUE 'H'.
  1291     12  AL-UABON            PIC X       VALUE 'I'.
  1292     12  AL-UADOF            PIC X       VALUE '<'.
  1293     12  AL-UADON            PIC X       VALUE '('.
  1294     12  AL-UANOF            PIC X       VALUE ' '.
  1295     12  AL-UANON            PIC X       VALUE 'A'.
  1296     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1297     12  AL-UNBON            PIC X       VALUE 'R'.
  1298     12  AL-UNDOF            PIC X       VALUE '*'.
  1299     12  AL-UNDON            PIC X       VALUE ')'.
  1300     12  AL-UNNOF            PIC X       VALUE '&'.
  1301     12  AL-UNNON            PIC X       VALUE 'J'.
  1302
  1303*                                COPY ELCAID SUPPRESS.
  1304******************************************************************
  1305*                                                                *
  1306*                            ELCAID.                             *
  1307*                            VMOD=2.001                          *
  1308*                                                                *
  1309*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1310*                                                                *
  1311*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1312*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1313******************************************************************
  1314
  1315 01  DFHAID.
  1316   02  DFHNULL   PIC  X  VALUE  ' '.
  1317   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1318   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1319   02  DFHPEN    PIC  X  VALUE  '='.
  1320   02  DFHOPID   PIC  X  VALUE  'W'.
  1321   02  DFHPA1    PIC  X  VALUE  '%'.
  1322   02  DFHPA2    PIC  X  VALUE  '>'.
  1323   02  DFHPA3    PIC  X  VALUE  ','.
  1324   02  DFHPF1    PIC  X  VALUE  '1'.
  1325   02  DFHPF2    PIC  X  VALUE  '2'.
  1326   02  DFHPF3    PIC  X  VALUE  '3'.
  1327   02  DFHPF4    PIC  X  VALUE  '4'.
  1328   02  DFHPF5    PIC  X  VALUE  '5'.
  1329   02  DFHPF6    PIC  X  VALUE  '6'.
  1330   02  DFHPF7    PIC  X  VALUE  '7'.
  1331   02  DFHPF8    PIC  X  VALUE  '8'.
  1332   02  DFHPF9    PIC  X  VALUE  '9'.
  1333   02  DFHPF10   PIC  X  VALUE  ':'.
  1334   02  DFHPF11   PIC  X  VALUE  '#'.
  1335   02  DFHPF12   PIC  X  VALUE  '@'.
  1336   02  DFHPF13   PIC  X  VALUE  'A'.
  1337   02  DFHPF14   PIC  X  VALUE  'B'.
  1338   02  DFHPF15   PIC  X  VALUE  'C'.
  1339   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  28
* EL131.cbl
  1340   02  DFHPF17   PIC  X  VALUE  'E'.
  1341   02  DFHPF18   PIC  X  VALUE  'F'.
  1342   02  DFHPF19   PIC  X  VALUE  'G'.
  1343   02  DFHPF20   PIC  X  VALUE  'H'.
  1344   02  DFHPF21   PIC  X  VALUE  'I'.
  1345*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1346   02  DFHPF22   PIC  X  VALUE  '['.
  1347   02  DFHPF23   PIC  X  VALUE  '.'.
  1348   02  DFHPF24   PIC  X  VALUE  '<'.
  1349   02  DFHMSRE   PIC  X  VALUE  'X'.
  1350   02  DFHSTRF   PIC  X  VALUE  'h'.
  1351   02  DFHTRIG   PIC  X  VALUE  '"'.
  1352 01  FILLER REDEFINES DFHAID.
  1353     12  FILLER                  PIC X(8).
  1354     12  AID-KEYS OCCURS 24 TIMES.
  1355         16  FILLER              PIC X.
  1356
  1357*                                COPY EL131S.
  1358 01  EL131AI.
  1359     05  FILLER            PIC  X(0012).
  1360*    -------------------------------
  1361     05  DATEL PIC S9(0004) COMP.
  1362     05  DATEF PIC  X(0001).
  1363     05  FILLER REDEFINES DATEF.
  1364         10  DATEA PIC  X(0001).
  1365     05  DATEI PIC  X(0008).
  1366*    -------------------------------
  1367     05  TIMEL PIC S9(0004) COMP.
  1368     05  TIMEF PIC  X(0001).
  1369     05  FILLER REDEFINES TIMEF.
  1370         10  TIMEA PIC  X(0001).
  1371     05  TIMEI PIC  X(0005).
  1372*    -------------------------------
  1373     05  SEQUL PIC S9(0004) COMP.
  1374     05  SEQUF PIC  X(0001).
  1375     05  FILLER REDEFINES SEQUF.
  1376         10  SEQUA PIC  X(0001).
  1377     05  SEQUI PIC  X(0010).
  1378*    -------------------------------
  1379     05  COMPL PIC S9(0004) COMP.
  1380     05  COMPF PIC  X(0001).
  1381     05  FILLER REDEFINES COMPF.
  1382         10  COMPA PIC  X(0001).
  1383     05  COMPI PIC  X(0003).
  1384*    -------------------------------
  1385     05  USERIDL PIC S9(0004) COMP.
  1386     05  USERIDF PIC  X(0001).
  1387     05  FILLER REDEFINES USERIDF.
  1388         10  USERIDA PIC  X(0001).
  1389     05  USERIDI PIC  X(0004).
  1390*    -------------------------------
  1391     05  LABEL1L PIC S9(0004) COMP.
  1392     05  LABEL1F PIC  X(0001).
  1393     05  FILLER REDEFINES LABEL1F.
  1394         10  LABEL1A PIC  X(0001).
  1395     05  LABEL1I PIC  X(0011).
  1396*    -------------------------------
  1397     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  29
* EL131.cbl
  1398     05  PCERTNOF PIC  X(0001).
  1399     05  FILLER REDEFINES PCERTNOF.
  1400         10  PCERTNOA PIC  X(0001).
  1401     05  PCERTNOI PIC  X(0010).
  1402*    -------------------------------
  1403     05  PSUFXL PIC S9(0004) COMP.
  1404     05  PSUFXF PIC  X(0001).
  1405     05  FILLER REDEFINES PSUFXF.
  1406         10  PSUFXA PIC  X(0001).
  1407     05  PSUFXI PIC  X(0001).
  1408*    -------------------------------
  1409     05  CCNOL PIC S9(0004) COMP.
  1410     05  CCNOF PIC  X(0001).
  1411     05  FILLER REDEFINES CCNOF.
  1412         10  CCNOA PIC  X(0001).
  1413     05  CCNOI PIC  X(0016).
  1414*    -------------------------------
  1415     05  MAINTL PIC S9(0004) COMP.
  1416     05  MAINTF PIC  X(0001).
  1417     05  FILLER REDEFINES MAINTF.
  1418         10  MAINTA PIC  X(0001).
  1419     05  MAINTI PIC  X(0001).
  1420*    -------------------------------
  1421     05  CLAIML PIC S9(0004) COMP.
  1422     05  CLAIMF PIC  X(0001).
  1423     05  FILLER REDEFINES CLAIMF.
  1424         10  CLAIMA PIC  X(0001).
  1425     05  CLAIMI PIC  X(0007).
  1426*    -------------------------------
  1427     05  CARRL PIC S9(0004) COMP.
  1428     05  CARRF PIC  X(0001).
  1429     05  FILLER REDEFINES CARRF.
  1430         10  CARRA PIC  X(0001).
  1431     05  CARRI PIC  X(0001).
  1432*    -------------------------------
  1433     05  CERTL PIC S9(0004) COMP.
  1434     05  CERTF PIC  X(0001).
  1435     05  FILLER REDEFINES CERTF.
  1436         10  CERTA PIC  X(0001).
  1437     05  CERTI PIC  X(0010).
  1438*    -------------------------------
  1439     05  SUFXL PIC S9(0004) COMP.
  1440     05  SUFXF PIC  X(0001).
  1441     05  FILLER REDEFINES SUFXF.
  1442         10  SUFXA PIC  X(0001).
  1443     05  SUFXI PIC  X(0001).
  1444*    -------------------------------
  1445     05  TYPEL PIC S9(0004) COMP.
  1446     05  TYPEF PIC  X(0001).
  1447     05  FILLER REDEFINES TYPEF.
  1448         10  TYPEA PIC  X(0001).
  1449     05  TYPEI PIC  X(0001).
  1450*    -------------------------------
  1451     05  BENPERL PIC S9(0004) COMP.
  1452     05  BENPERF PIC  X(0001).
  1453     05  FILLER REDEFINES BENPERF.
  1454         10  BENPERA PIC  X(0001).
  1455     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  30
* EL131.cbl
  1456*    -------------------------------
  1457     05  INSTYPEL PIC S9(0004) COMP.
  1458     05  INSTYPEF PIC  X(0001).
  1459     05  FILLER REDEFINES INSTYPEF.
  1460         10  INSTYPEA PIC  X(0001).
  1461     05  INSTYPEI PIC  X(0001).
  1462*    -------------------------------
  1463     05  STATUSL PIC S9(0004) COMP.
  1464     05  STATUSF PIC  X(0001).
  1465     05  FILLER REDEFINES STATUSF.
  1466         10  STATUSA PIC  X(0001).
  1467     05  STATUSI PIC  X(0006).
  1468*    -------------------------------
  1469     05  INCL PIC S9(0004) COMP.
  1470     05  INCF PIC  X(0001).
  1471     05  FILLER REDEFINES INCF.
  1472         10  INCA PIC  X(0001).
  1473     05  INCI PIC  X(0008).
  1474*    -------------------------------
  1475     05  REPL PIC S9(0004) COMP.
  1476     05  REPF PIC  X(0001).
  1477     05  FILLER REDEFINES REPF.
  1478         10  REPA PIC  X(0001).
  1479     05  REPI PIC  X(0008).
  1480*    -------------------------------
  1481     05  ICD1L PIC S9(0004) COMP.
  1482     05  ICD1F PIC  X(0001).
  1483     05  FILLER REDEFINES ICD1F.
  1484         10  ICD1A PIC  X(0001).
  1485     05  ICD1I PIC  X(0008).
  1486*    -------------------------------
  1487     05  ICD2L PIC S9(0004) COMP.
  1488     05  ICD2F PIC  X(0001).
  1489     05  FILLER REDEFINES ICD2F.
  1490         10  ICD2A PIC  X(0001).
  1491     05  ICD2I PIC  X(0008).
  1492*    -------------------------------
  1493     05  DIAGL PIC S9(0004) COMP.
  1494     05  DIAGF PIC  X(0001).
  1495     05  FILLER REDEFINES DIAGF.
  1496         10  DIAGA PIC  X(0001).
  1497     05  DIAGI PIC  X(0060).
  1498*    -------------------------------
  1499     05  ACCSWL PIC S9(0004) COMP.
  1500     05  ACCSWF PIC  X(0001).
  1501     05  FILLER REDEFINES ACCSWF.
  1502         10  ACCSWA PIC  X(0001).
  1503     05  ACCSWI PIC  X(0001).
  1504*    -------------------------------
  1505     05  BENEL PIC S9(0004) COMP.
  1506     05  BENEF PIC  X(0001).
  1507     05  FILLER REDEFINES BENEF.
  1508         10  BENEA PIC  X(0001).
  1509     05  BENEI PIC  X(0010).
  1510*    -------------------------------
  1511     05  BIRTHL PIC S9(0004) COMP.
  1512     05  BIRTHF PIC  X(0001).
  1513     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  31
* EL131.cbl
  1514         10  BIRTHA PIC  X(0001).
  1515     05  BIRTHI PIC  X(0008).
  1516*    -------------------------------
  1517     05  SOCIALL PIC S9(0004) COMP.
  1518     05  SOCIALF PIC  X(0001).
  1519     05  FILLER REDEFINES SOCIALF.
  1520         10  SOCIALA PIC  X(0001).
  1521     05  SOCIALI PIC  X(0011).
  1522*    -------------------------------
  1523     05  SEXL PIC S9(0004) COMP.
  1524     05  SEXF PIC  X(0001).
  1525     05  FILLER REDEFINES SEXF.
  1526         10  SEXA PIC  X(0001).
  1527     05  SEXI PIC  X(0001).
  1528*    -------------------------------
  1529     05  MLNAMEL PIC S9(0004) COMP.
  1530     05  MLNAMEF PIC  X(0001).
  1531     05  FILLER REDEFINES MLNAMEF.
  1532         10  MLNAMEA PIC  X(0001).
  1533     05  MLNAMEI PIC  X(0015).
  1534*    -------------------------------
  1535     05  MFNAMEL PIC S9(0004) COMP.
  1536     05  MFNAMEF PIC  X(0001).
  1537     05  FILLER REDEFINES MFNAMEF.
  1538         10  MFNAMEA PIC  X(0001).
  1539     05  MFNAMEI PIC  X(0012).
  1540*    -------------------------------
  1541     05  MMINITL PIC S9(0004) COMP.
  1542     05  MMINITF PIC  X(0001).
  1543     05  FILLER REDEFINES MMINITF.
  1544         10  MMINITA PIC  X(0001).
  1545     05  MMINITI PIC  X(0001).
  1546*    -------------------------------
  1547     05  LOANNOL PIC S9(0004) COMP.
  1548     05  LOANNOF PIC  X(0001).
  1549     05  FILLER REDEFINES LOANNOF.
  1550         10  LOANNOA PIC  X(0001).
  1551     05  LOANNOI PIC  X(0008).
  1552*    -------------------------------
  1553     05  CRTLNMEL PIC S9(0004) COMP.
  1554     05  CRTLNMEF PIC  X(0001).
  1555     05  FILLER REDEFINES CRTLNMEF.
  1556         10  CRTLNMEA PIC  X(0001).
  1557     05  CRTLNMEI PIC  X(0015).
  1558*    -------------------------------
  1559     05  CRTFNMEL PIC S9(0004) COMP.
  1560     05  CRTFNMEF PIC  X(0001).
  1561     05  FILLER REDEFINES CRTFNMEF.
  1562         10  CRTFNMEA PIC  X(0001).
  1563     05  CRTFNMEI PIC  X(0012).
  1564*    -------------------------------
  1565     05  CRTINITL PIC S9(0004) COMP.
  1566     05  CRTINITF PIC  X(0001).
  1567     05  FILLER REDEFINES CRTINITF.
  1568         10  CRTINITA PIC  X(0001).
  1569     05  CRTINITI PIC  X(0001).
  1570*    -------------------------------
  1571     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  32
* EL131.cbl
  1572     05  LOANBALF PIC  X(0001).
  1573     05  FILLER REDEFINES LOANBALF.
  1574         10  LOANBALA PIC  X(0001).
  1575     05  LOANBALI PIC  9(7)V99.
  1576*    -------------------------------
  1577     05  PROCL PIC S9(0004) COMP.
  1578     05  PROCF PIC  X(0001).
  1579     05  FILLER REDEFINES PROCF.
  1580         10  PROCA PIC  X(0001).
  1581     05  PROCI PIC  X(0004).
  1582*    -------------------------------
  1583     05  SUPVL PIC S9(0004) COMP.
  1584     05  SUPVF PIC  X(0001).
  1585     05  FILLER REDEFINES SUPVF.
  1586         10  SUPVA PIC  X(0001).
  1587     05  SUPVI PIC  X(0001).
  1588*    -------------------------------
  1589     05  PRICDL PIC S9(0004) COMP.
  1590     05  PRICDF PIC  X(0001).
  1591     05  FILLER REDEFINES PRICDF.
  1592         10  PRICDA PIC  X(0001).
  1593     05  PRICDI PIC  X(0001).
  1594*    -------------------------------
  1595     05  CRITPL PIC S9(0004) COMP.
  1596     05  CRITPF PIC  X(0001).
  1597     05  FILLER REDEFINES CRITPF.
  1598         10  CRITPA PIC  X(0001).
  1599     05  CRITPI PIC  X(0002).
  1600*    -------------------------------
  1601     05  CRITPTL PIC S9(0004) COMP.
  1602     05  CRITPTF PIC  X(0001).
  1603     05  FILLER REDEFINES CRITPTF.
  1604         10  CRITPTA PIC  X(0001).
  1605     05  CRITPTI PIC  X(0002).
  1606*    -------------------------------
  1607     05  RTWMOSL PIC S9(0004) COMP.
  1608     05  RTWMOSF PIC  X(0001).
  1609     05  FILLER REDEFINES RTWMOSF.
  1610         10  RTWMOSA PIC  X(0001).
  1611     05  RTWMOSI PIC  X(0002).
  1612*    -------------------------------
  1613     05  FILETOL PIC S9(0004) COMP.
  1614     05  FILETOF PIC  X(0001).
  1615     05  FILLER REDEFINES FILETOF.
  1616         10  FILETOA PIC  X(0001).
  1617     05  FILETOI PIC  X(0004).
  1618*    -------------------------------
  1619     05  PTHRHDGL PIC S9(0004) COMP.
  1620     05  PTHRHDGF PIC  X(0001).
  1621     05  FILLER REDEFINES PTHRHDGF.
  1622         10  PTHRHDGA PIC  X(0001).
  1623     05  PTHRHDGI PIC  X(0010).
  1624*    -------------------------------
  1625     05  PDTHRUL PIC S9(0004) COMP.
  1626     05  PDTHRUF PIC  X(0001).
  1627     05  FILLER REDEFINES PDTHRUF.
  1628         10  PDTHRUA PIC  X(0001).
  1629     05  PDTHRUI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  33
* EL131.cbl
  1630*    -------------------------------
  1631     05  PDAMTL PIC S9(0004) COMP.
  1632     05  PDAMTF PIC  X(0001).
  1633     05  FILLER REDEFINES PDAMTF.
  1634         10  PDAMTA PIC  X(0001).
  1635     05  PDAMTI PIC  9(7)V99.
  1636*    -------------------------------
  1637     05  NODAYSL PIC S9(0004) COMP.
  1638     05  NODAYSF PIC  X(0001).
  1639     05  FILLER REDEFINES NODAYSF.
  1640         10  NODAYSA PIC  X(0001).
  1641     05  NODAYSI PIC  9(5).
  1642*    -------------------------------
  1643     05  NOPMTSL PIC S9(0004) COMP.
  1644     05  NOPMTSF PIC  X(0001).
  1645     05  FILLER REDEFINES NOPMTSF.
  1646         10  NOPMTSA PIC  X(0001).
  1647     05  NOPMTSI PIC  9(4).
  1648*    -------------------------------
  1649     05  FORMTYPL PIC S9(0004) COMP.
  1650     05  FORMTYPF PIC  X(0001).
  1651     05  FILLER REDEFINES FORMTYPF.
  1652         10  FORMTYPA PIC  X(0001).
  1653     05  FORMTYPI PIC  X(0001).
  1654*    -------------------------------
  1655     05  ESTL PIC S9(0004) COMP.
  1656     05  ESTF PIC  X(0001).
  1657     05  FILLER REDEFINES ESTF.
  1658         10  ESTA PIC  X(0001).
  1659     05  ESTI PIC  X(0008).
  1660*    -------------------------------
  1661     05  AUIDL PIC S9(0004) COMP.
  1662     05  AUIDF PIC  X(0001).
  1663     05  FILLER REDEFINES AUIDF.
  1664         10  AUIDA PIC  X(0001).
  1665     05  AUIDI PIC  X(0004).
  1666*    -------------------------------
  1667     05  OCCL PIC S9(0004) COMP.
  1668     05  OCCF PIC  X(0001).
  1669     05  FILLER REDEFINES OCCF.
  1670         10  OCCA PIC  X(0001).
  1671     05  OCCI PIC  X(0006).
  1672*    -------------------------------
  1673     05  MNTDTL PIC S9(0004) COMP.
  1674     05  MNTDTF PIC  X(0001).
  1675     05  FILLER REDEFINES MNTDTF.
  1676         10  MNTDTA PIC  X(0001).
  1677     05  MNTDTI PIC  X(0008).
  1678*    -------------------------------
  1679     05  MNTTYPEL PIC S9(0004) COMP.
  1680     05  MNTTYPEF PIC  X(0001).
  1681     05  FILLER REDEFINES MNTTYPEF.
  1682         10  MNTTYPEA PIC  X(0001).
  1683     05  MNTTYPEI PIC  X(0006).
  1684*    -------------------------------
  1685     05  CERTCARL PIC S9(0004) COMP.
  1686     05  CERTCARF PIC  X(0001).
  1687     05  FILLER REDEFINES CERTCARF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  34
* EL131.cbl
  1688         10  CERTCARA PIC  X(0001).
  1689     05  CERTCARI PIC  X(0001).
  1690*    -------------------------------
  1691     05  CERTGRPL PIC S9(0004) COMP.
  1692     05  CERTGRPF PIC  X(0001).
  1693     05  FILLER REDEFINES CERTGRPF.
  1694         10  CERTGRPA PIC  X(0001).
  1695     05  CERTGRPI PIC  X(0006).
  1696*    -------------------------------
  1697     05  CERTSTL PIC S9(0004) COMP.
  1698     05  CERTSTF PIC  X(0001).
  1699     05  FILLER REDEFINES CERTSTF.
  1700         10  CERTSTA PIC  X(0001).
  1701     05  CERTSTI PIC  X(0002).
  1702*    -------------------------------
  1703     05  CERTACTL PIC S9(0004) COMP.
  1704     05  CERTACTF PIC  X(0001).
  1705     05  FILLER REDEFINES CERTACTF.
  1706         10  CERTACTA PIC  X(0001).
  1707     05  CERTACTI PIC  X(0010).
  1708*    -------------------------------
  1709     05  CERTEFFL PIC S9(0004) COMP.
  1710     05  CERTEFFF PIC  X(0001).
  1711     05  FILLER REDEFINES CERTEFFF.
  1712         10  CERTEFFA PIC  X(0001).
  1713     05  CERTEFFI PIC  X(0008).
  1714*    -------------------------------
  1715     05  ISSAGEL PIC S9(0004) COMP.
  1716     05  ISSAGEF PIC  X(0001).
  1717     05  FILLER REDEFINES ISSAGEF.
  1718         10  ISSAGEA PIC  X(0001).
  1719     05  ISSAGEI PIC  X(0002).
  1720*    -------------------------------
  1721     05  APRL PIC S9(0004) COMP.
  1722     05  APRF PIC  X(0001).
  1723     05  FILLER REDEFINES APRF.
  1724         10  APRA PIC  X(0001).
  1725     05  APRI PIC  9(4)V9(4).
  1726*    -------------------------------
  1727     05  PMTFREQL PIC S9(0004) COMP.
  1728     05  PMTFREQF PIC  X(0001).
  1729     05  FILLER REDEFINES PMTFREQF.
  1730         10  PMTFREQA PIC  X(0001).
  1731     05  PMTFREQI PIC  99.
  1732*    -------------------------------
  1733     05  INDGRPL PIC S9(0004) COMP.
  1734     05  INDGRPF PIC  X(0001).
  1735     05  FILLER REDEFINES INDGRPF.
  1736         10  INDGRPA PIC  X(0001).
  1737     05  INDGRPI PIC  X(0001).
  1738*    -------------------------------
  1739     05  PREMTYPL PIC S9(0004) COMP.
  1740     05  PREMTYPF PIC  X(0001).
  1741     05  FILLER REDEFINES PREMTYPF.
  1742         10  PREMTYPA PIC  X(0001).
  1743     05  PREMTYPI PIC  X(0001).
  1744*    -------------------------------
  1745     05  REINCDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  35
* EL131.cbl
  1746     05  REINCDF PIC  X(0001).
  1747     05  FILLER REDEFINES REINCDF.
  1748         10  REINCDA PIC  X(0001).
  1749     05  REINCDI PIC  X(0001).
  1750*    -------------------------------
  1751     05  JNTLNMEL PIC S9(0004) COMP.
  1752     05  JNTLNMEF PIC  X(0001).
  1753     05  FILLER REDEFINES JNTLNMEF.
  1754         10  JNTLNMEA PIC  X(0001).
  1755     05  JNTLNMEI PIC  X(0015).
  1756*    -------------------------------
  1757     05  JNTFNMEL PIC S9(0004) COMP.
  1758     05  JNTFNMEF PIC  X(0001).
  1759     05  FILLER REDEFINES JNTFNMEF.
  1760         10  JNTFNMEA PIC  X(0001).
  1761     05  JNTFNMEI PIC  X(0012).
  1762*    -------------------------------
  1763     05  JNTINITL PIC S9(0004) COMP.
  1764     05  JNTINITF PIC  X(0001).
  1765     05  FILLER REDEFINES JNTINITF.
  1766         10  JNTINITA PIC  X(0001).
  1767     05  JNTINITI PIC  X(0001).
  1768*    -------------------------------
  1769     05  JNTAGEL PIC S9(0004) COMP.
  1770     05  JNTAGEF PIC  X(0001).
  1771     05  FILLER REDEFINES JNTAGEF.
  1772         10  JNTAGEA PIC  X(0001).
  1773     05  JNTAGEI PIC  X(0002).
  1774*    -------------------------------
  1775     05  ADDONDTL PIC S9(0004) COMP.
  1776     05  ADDONDTF PIC  X(0001).
  1777     05  FILLER REDEFINES ADDONDTF.
  1778         10  ADDONDTA PIC  X(0001).
  1779     05  ADDONDTI PIC  X(0008).
  1780*    -------------------------------
  1781     05  LCVDSCRL PIC S9(0004) COMP.
  1782     05  LCVDSCRF PIC  X(0001).
  1783     05  FILLER REDEFINES LCVDSCRF.
  1784         10  LCVDSCRA PIC  X(0001).
  1785     05  LCVDSCRI PIC  X(0006).
  1786*    -------------------------------
  1787     05  LCVKINDL PIC S9(0004) COMP.
  1788     05  LCVKINDF PIC  X(0001).
  1789     05  FILLER REDEFINES LCVKINDF.
  1790         10  LCVKINDA PIC  X(0001).
  1791     05  LCVKINDI PIC  X(0003).
  1792*    -------------------------------
  1793     05  LCVCDL PIC S9(0004) COMP.
  1794     05  LCVCDF PIC  X(0001).
  1795     05  FILLER REDEFINES LCVCDF.
  1796         10  LCVCDA PIC  X(0001).
  1797     05  LCVCDI PIC  X(0002).
  1798*    -------------------------------
  1799     05  LCVOTRML PIC S9(0004) COMP.
  1800     05  LCVOTRMF PIC  X(0001).
  1801     05  FILLER REDEFINES LCVOTRMF.
  1802         10  LCVOTRMA PIC  X(0001).
  1803     05  LCVOTRMI PIC  999.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  36
* EL131.cbl
  1804*    -------------------------------
  1805     05  LCVRTRML PIC S9(0004) COMP.
  1806     05  LCVRTRMF PIC  X(0001).
  1807     05  FILLER REDEFINES LCVRTRMF.
  1808         10  LCVRTRMA PIC  X(0001).
  1809     05  LCVRTRMI PIC  X(0003).
  1810*    -------------------------------
  1811     05  LCVRATEL PIC S9(0004) COMP.
  1812     05  LCVRATEF PIC  X(0001).
  1813     05  FILLER REDEFINES LCVRATEF.
  1814         10  LCVRATEA PIC  X(0001).
  1815     05  LCVRATEI PIC  9999V99.
  1816*    -------------------------------
  1817     05  LCVBENEL PIC S9(0004) COMP.
  1818     05  LCVBENEF PIC  X(0001).
  1819     05  FILLER REDEFINES LCVBENEF.
  1820         10  LCVBENEA PIC  X(0001).
  1821     05  LCVBENEI PIC  9(9)V99.
  1822*    -------------------------------
  1823     05  LCVFORML PIC S9(0004) COMP.
  1824     05  LCVFORMF PIC  X(0001).
  1825     05  FILLER REDEFINES LCVFORMF.
  1826         10  LCVFORMA PIC  X(0001).
  1827     05  LCVFORMI PIC  X(0012).
  1828*    -------------------------------
  1829     05  LCVCNDTL PIC S9(0004) COMP.
  1830     05  LCVCNDTF PIC  X(0001).
  1831     05  FILLER REDEFINES LCVCNDTF.
  1832         10  LCVCNDTA PIC  X(0001).
  1833     05  LCVCNDTI PIC  X(0008).
  1834*    -------------------------------
  1835     05  LCVEXITL PIC S9(0004) COMP.
  1836     05  LCVEXITF PIC  X(0001).
  1837     05  FILLER REDEFINES LCVEXITF.
  1838         10  LCVEXITA PIC  X(0001).
  1839     05  LCVEXITI PIC  X(0008).
  1840*    -------------------------------
  1841     05  LCVSTATL PIC S9(0004) COMP.
  1842     05  LCVSTATF PIC  X(0001).
  1843     05  FILLER REDEFINES LCVSTATF.
  1844         10  LCVSTATA PIC  X(0001).
  1845     05  LCVSTATI PIC  X(0006).
  1846*    -------------------------------
  1847     05  ACVDSCRL PIC S9(0004) COMP.
  1848     05  ACVDSCRF PIC  X(0001).
  1849     05  FILLER REDEFINES ACVDSCRF.
  1850         10  ACVDSCRA PIC  X(0001).
  1851     05  ACVDSCRI PIC  X(0006).
  1852*    -------------------------------
  1853     05  ACVKINDL PIC S9(0004) COMP.
  1854     05  ACVKINDF PIC  X(0001).
  1855     05  FILLER REDEFINES ACVKINDF.
  1856         10  ACVKINDA PIC  X(0001).
  1857     05  ACVKINDI PIC  X(0003).
  1858*    -------------------------------
  1859     05  ACVCDL PIC S9(0004) COMP.
  1860     05  ACVCDF PIC  X(0001).
  1861     05  FILLER REDEFINES ACVCDF.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  37
* EL131.cbl
  1862         10  ACVCDA PIC  X(0001).
  1863     05  ACVCDI PIC  X(0002).
  1864*    -------------------------------
  1865     05  ACVOTRML PIC S9(0004) COMP.
  1866     05  ACVOTRMF PIC  X(0001).
  1867     05  FILLER REDEFINES ACVOTRMF.
  1868         10  ACVOTRMA PIC  X(0001).
  1869     05  ACVOTRMI PIC  999.
  1870*    -------------------------------
  1871     05  ACVRTRML PIC S9(0004) COMP.
  1872     05  ACVRTRMF PIC  X(0001).
  1873     05  FILLER REDEFINES ACVRTRMF.
  1874         10  ACVRTRMA PIC  X(0001).
  1875     05  ACVRTRMI PIC  X(0003).
  1876*    -------------------------------
  1877     05  ACVRATEL PIC S9(0004) COMP.
  1878     05  ACVRATEF PIC  X(0001).
  1879     05  FILLER REDEFINES ACVRATEF.
  1880         10  ACVRATEA PIC  X(0001).
  1881     05  ACVRATEI PIC  9999V99.
  1882*    -------------------------------
  1883     05  ACVBENEL PIC S9(0004) COMP.
  1884     05  ACVBENEF PIC  X(0001).
  1885     05  FILLER REDEFINES ACVBENEF.
  1886         10  ACVBENEA PIC  X(0001).
  1887     05  ACVBENEI PIC  9(9)V99.
  1888*    -------------------------------
  1889     05  ACVFORML PIC S9(0004) COMP.
  1890     05  ACVFORMF PIC  X(0001).
  1891     05  FILLER REDEFINES ACVFORMF.
  1892         10  ACVFORMA PIC  X(0001).
  1893     05  ACVFORMI PIC  X(0012).
  1894*    -------------------------------
  1895     05  ACVCNDTL PIC S9(0004) COMP.
  1896     05  ACVCNDTF PIC  X(0001).
  1897     05  FILLER REDEFINES ACVCNDTF.
  1898         10  ACVCNDTA PIC  X(0001).
  1899     05  ACVCNDTI PIC  X(0008).
  1900*    -------------------------------
  1901     05  ACVEXITL PIC S9(0004) COMP.
  1902     05  ACVEXITF PIC  X(0001).
  1903     05  FILLER REDEFINES ACVEXITF.
  1904         10  ACVEXITA PIC  X(0001).
  1905     05  ACVEXITI PIC  X(0008).
  1906*    -------------------------------
  1907     05  ACVSTATL PIC S9(0004) COMP.
  1908     05  ACVSTATF PIC  X(0001).
  1909     05  FILLER REDEFINES ACVSTATF.
  1910         10  ACVSTATA PIC  X(0001).
  1911     05  ACVSTATI PIC  X(0006).
  1912*    -------------------------------
  1913     05  LABEL2L PIC S9(0004) COMP.
  1914     05  LABEL2F PIC  X(0001).
  1915     05  FILLER REDEFINES LABEL2F.
  1916         10  LABEL2A PIC  X(0001).
  1917     05  LABEL2I PIC  X(0014).
  1918*    -------------------------------
  1919     05  BCERT1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  38
* EL131.cbl
  1920     05  BCERT1F PIC  X(0001).
  1921     05  FILLER REDEFINES BCERT1F.
  1922         10  BCERT1A PIC  X(0001).
  1923     05  BCERT1I PIC  X(0010).
  1924*    -------------------------------
  1925     05  BSUFX1L PIC S9(0004) COMP.
  1926     05  BSUFX1F PIC  X(0001).
  1927     05  FILLER REDEFINES BSUFX1F.
  1928         10  BSUFX1A PIC  X(0001).
  1929     05  BSUFX1I PIC  X(0001).
  1930*    -------------------------------
  1931     05  BCERT2L PIC S9(0004) COMP.
  1932     05  BCERT2F PIC  X(0001).
  1933     05  FILLER REDEFINES BCERT2F.
  1934         10  BCERT2A PIC  X(0001).
  1935     05  BCERT2I PIC  X(0010).
  1936*    -------------------------------
  1937     05  BSUFX2L PIC S9(0004) COMP.
  1938     05  BSUFX2F PIC  X(0001).
  1939     05  FILLER REDEFINES BSUFX2F.
  1940         10  BSUFX2A PIC  X(0001).
  1941     05  BSUFX2I PIC  X(0001).
  1942*    -------------------------------
  1943     05  BCERT3L PIC S9(0004) COMP.
  1944     05  BCERT3F PIC  X(0001).
  1945     05  FILLER REDEFINES BCERT3F.
  1946         10  BCERT3A PIC  X(0001).
  1947     05  BCERT3I PIC  X(0010).
  1948*    -------------------------------
  1949     05  BSUFX3L PIC S9(0004) COMP.
  1950     05  BSUFX3F PIC  X(0001).
  1951     05  FILLER REDEFINES BSUFX3F.
  1952         10  BSUFX3A PIC  X(0001).
  1953     05  BSUFX3I PIC  X(0001).
  1954*    -------------------------------
  1955     05  BCERT4L PIC S9(0004) COMP.
  1956     05  BCERT4F PIC  X(0001).
  1957     05  FILLER REDEFINES BCERT4F.
  1958         10  BCERT4A PIC  X(0001).
  1959     05  BCERT4I PIC  X(0010).
  1960*    -------------------------------
  1961     05  BSUFX4L PIC S9(0004) COMP.
  1962     05  BSUFX4F PIC  X(0001).
  1963     05  FILLER REDEFINES BSUFX4F.
  1964         10  BSUFX4A PIC  X(0001).
  1965     05  BSUFX4I PIC  X(0001).
  1966*    -------------------------------
  1967     05  BCERT5L PIC S9(0004) COMP.
  1968     05  BCERT5F PIC  X(0001).
  1969     05  FILLER REDEFINES BCERT5F.
  1970         10  BCERT5A PIC  X(0001).
  1971     05  BCERT5I PIC  X(0010).
  1972*    -------------------------------
  1973     05  BSUFX5L PIC S9(0004) COMP.
  1974     05  BSUFX5F PIC  X(0001).
  1975     05  FILLER REDEFINES BSUFX5F.
  1976         10  BSUFX5A PIC  X(0001).
  1977     05  BSUFX5I PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  39
* EL131.cbl
  1978*    -------------------------------
  1979     05  MSG1L PIC S9(0004) COMP.
  1980     05  MSG1F PIC  X(0001).
  1981     05  FILLER REDEFINES MSG1F.
  1982         10  MSG1A PIC  X(0001).
  1983     05  MSG1I PIC  X(0072).
  1984*    -------------------------------
  1985     05  MSG2L PIC S9(0004) COMP.
  1986     05  MSG2F PIC  X(0001).
  1987     05  FILLER REDEFINES MSG2F.
  1988         10  MSG2A PIC  X(0001).
  1989     05  MSG2I PIC  X(0072).
  1990*    -------------------------------
  1991     05  PFKEYL PIC S9(0004) COMP.
  1992     05  PFKEYF PIC  X(0001).
  1993     05  FILLER REDEFINES PFKEYF.
  1994         10  PFKEYA PIC  X(0001).
  1995     05  PFKEYI PIC  99.
  1996*    -------------------------------
  1997     05  PFKEY6L PIC S9(0004) COMP.
  1998     05  PFKEY6F PIC  X(0001).
  1999     05  FILLER REDEFINES PFKEY6F.
  2000         10  PFKEY6A PIC  X(0001).
  2001     05  PFKEY6I PIC  X(0016).
  2002 01  EL131AO REDEFINES EL131AI.
  2003     05  FILLER            PIC  X(0012).
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  DATEO PIC  X(0008).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  TIMEO PIC  99.99.
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  SEQUO PIC  X(0010).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  COMPO PIC  X(0003).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  USERIDO PIC  X(0004).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  LABEL1O PIC  X(0011).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  PCERTNOO PIC  X(0010).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  PSUFXO PIC  X(0001).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  CCNOO PIC  X(0016).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  MAINTO PIC  X(0001).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  40
* EL131.cbl
  2036     05  CLAIMO PIC  X(0007).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  CARRO PIC  X(0001).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  CERTO PIC  X(0010).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  SUFXO PIC  X(0001).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  TYPEO PIC  X(0001).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  BENPERO PIC  X(0002).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  INSTYPEO PIC  X(0001).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  STATUSO PIC  X(0006).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  INCO PIC  X(0008).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  REPO PIC  X(0008).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  ICD1O PIC  X(0008).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  ICD2O PIC  X(0008).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  DIAGO PIC  X(0060).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  ACCSWO PIC  X(0001).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  BENEO PIC  X(0010).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  BIRTHO PIC  X(0008).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  SOCIALO PIC  X(0011).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  SEXO PIC  X(0001).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  MLNAMEO PIC  X(0015).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  MFNAMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  41
* EL131.cbl
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  MMINITO PIC  X(0001).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  LOANNOO PIC  X(0008).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  CRTLNMEO PIC  X(0015).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  CRTFNMEO PIC  X(0012).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  CRTINITO PIC  X(0001).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  LOANBALO PIC  ZZZZZ9.99.
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  PROCO PIC  X(0004).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  SUPVO PIC  X(0001).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  PRICDO PIC  X(0001).
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  CRITPO PIC  X(0002).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  CRITPTO PIC  X(0002).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  RTWMOSO PIC  X(0002).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  FILETOO PIC  X(0004).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  PTHRHDGO PIC  X(0010).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  PDTHRUO PIC  X(0008).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  PDAMTO PIC  Z(06).99.
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  NODAYSO PIC  ZZZ99.
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  NOPMTSO PIC  ZZ99.
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  FORMTYPO PIC  X(0001).
  2151*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  42
* EL131.cbl
  2152     05  FILLER            PIC  X(0003).
  2153     05  ESTO PIC  X(0008).
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  AUIDO PIC  X(0004).
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  OCCO PIC  X(0006).
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  MNTDTO PIC  X(0008).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  MNTTYPEO PIC  X(0006).
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  CERTCARO PIC  X(0001).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  CERTGRPO PIC  X(0006).
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
  2174     05  CERTSTO PIC  X(0002).
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  CERTACTO PIC  X(0010).
  2178*    -------------------------------
  2179     05  FILLER            PIC  X(0003).
  2180     05  CERTEFFO PIC  X(0008).
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  ISSAGEO PIC  X(0002).
  2184*    -------------------------------
  2185     05  FILLER            PIC  X(0003).
  2186     05  APRO PIC  9(3).9(4).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  PMTFREQO PIC  99.
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  INDGRPO PIC  X(0001).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  PREMTYPO PIC  X(0001).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  REINCDO PIC  X(0001).
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  JNTLNMEO PIC  X(0015).
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  JNTFNMEO PIC  X(0012).
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  JNTINITO PIC  X(0001).
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  43
* EL131.cbl
  2210     05  JNTAGEO PIC  X(0002).
  2211*    -------------------------------
  2212     05  FILLER            PIC  X(0003).
  2213     05  ADDONDTO PIC  X(0008).
  2214*    -------------------------------
  2215     05  FILLER            PIC  X(0003).
  2216     05  LCVDSCRO PIC  X(0006).
  2217*    -------------------------------
  2218     05  FILLER            PIC  X(0003).
  2219     05  LCVKINDO PIC  X(0003).
  2220*    -------------------------------
  2221     05  FILLER            PIC  X(0003).
  2222     05  LCVCDO PIC  X(0002).
  2223*    -------------------------------
  2224     05  FILLER            PIC  X(0003).
  2225     05  LCVOTRMO PIC  999.
  2226*    -------------------------------
  2227     05  FILLER            PIC  X(0003).
  2228     05  LCVRTRMO PIC  999.
  2229*    -------------------------------
  2230     05  FILLER            PIC  X(0003).
  2231     05  LCVRATEO PIC  ZZZ.ZZ.
  2232*    -------------------------------
  2233     05  FILLER            PIC  X(0003).
  2234     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2235*    -------------------------------
  2236     05  FILLER            PIC  X(0003).
  2237     05  LCVFORMO PIC  X(0012).
  2238*    -------------------------------
  2239     05  FILLER            PIC  X(0003).
  2240     05  LCVCNDTO PIC  X(0008).
  2241*    -------------------------------
  2242     05  FILLER            PIC  X(0003).
  2243     05  LCVEXITO PIC  X(0008).
  2244*    -------------------------------
  2245     05  FILLER            PIC  X(0003).
  2246     05  LCVSTATO PIC  X(0006).
  2247*    -------------------------------
  2248     05  FILLER            PIC  X(0003).
  2249     05  ACVDSCRO PIC  X(0006).
  2250*    -------------------------------
  2251     05  FILLER            PIC  X(0003).
  2252     05  ACVKINDO PIC  X(0003).
  2253*    -------------------------------
  2254     05  FILLER            PIC  X(0003).
  2255     05  ACVCDO PIC  X(0002).
  2256*    -------------------------------
  2257     05  FILLER            PIC  X(0003).
  2258     05  ACVOTRMO PIC  999.
  2259*    -------------------------------
  2260     05  FILLER            PIC  X(0003).
  2261     05  ACVRTRMO PIC  999.
  2262*    -------------------------------
  2263     05  FILLER            PIC  X(0003).
  2264     05  ACVRATEO PIC  ZZZ.ZZ.
  2265*    -------------------------------
  2266     05  FILLER            PIC  X(0003).
  2267     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  44
* EL131.cbl
  2268*    -------------------------------
  2269     05  FILLER            PIC  X(0003).
  2270     05  ACVFORMO PIC  X(0012).
  2271*    -------------------------------
  2272     05  FILLER            PIC  X(0003).
  2273     05  ACVCNDTO PIC  X(0008).
  2274*    -------------------------------
  2275     05  FILLER            PIC  X(0003).
  2276     05  ACVEXITO PIC  X(0008).
  2277*    -------------------------------
  2278     05  FILLER            PIC  X(0003).
  2279     05  ACVSTATO PIC  X(0006).
  2280*    -------------------------------
  2281     05  FILLER            PIC  X(0003).
  2282     05  LABEL2O PIC  X(0014).
  2283*    -------------------------------
  2284     05  FILLER            PIC  X(0003).
  2285     05  BCERT1O PIC  X(0010).
  2286*    -------------------------------
  2287     05  FILLER            PIC  X(0003).
  2288     05  BSUFX1O PIC  X(0001).
  2289*    -------------------------------
  2290     05  FILLER            PIC  X(0003).
  2291     05  BCERT2O PIC  X(0010).
  2292*    -------------------------------
  2293     05  FILLER            PIC  X(0003).
  2294     05  BSUFX2O PIC  X(0001).
  2295*    -------------------------------
  2296     05  FILLER            PIC  X(0003).
  2297     05  BCERT3O PIC  X(0010).
  2298*    -------------------------------
  2299     05  FILLER            PIC  X(0003).
  2300     05  BSUFX3O PIC  X(0001).
  2301*    -------------------------------
  2302     05  FILLER            PIC  X(0003).
  2303     05  BCERT4O PIC  X(0010).
  2304*    -------------------------------
  2305     05  FILLER            PIC  X(0003).
  2306     05  BSUFX4O PIC  X(0001).
  2307*    -------------------------------
  2308     05  FILLER            PIC  X(0003).
  2309     05  BCERT5O PIC  X(0010).
  2310*    -------------------------------
  2311     05  FILLER            PIC  X(0003).
  2312     05  BSUFX5O PIC  X(0001).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  MSG1O PIC  X(0072).
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  MSG2O PIC  X(0072).
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  PFKEYO PIC  X(0002).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  PFKEY6O PIC  X(0016).
  2325*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  45
* EL131.cbl
  2326
  2327*                                COPY ELCEMIB SUPPRESS.
  2328******************************************************************
  2329*                                                                *
  2330*                                                                *
  2331*                            ELCEMIB.                            *
  2332*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2333*                            VMOD=2.005                          *
  2334*                                                                *
  2335*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2336*                                                                *
  2337******************************************************************
  2338 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2339     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2340     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2341     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2342     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2343     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2344     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2345     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2346     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2347     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2348         88  EMI-NO-ERRORS                    VALUE '1'.
  2349         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2350         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2351     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2352         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2353     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2354         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2355         88  EMI-AREA1-FULL                   VALUE '2'.
  2356     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2357         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2358         88  EMI-AREA2-FULL                   VALUE '2'.
  2359     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2360         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2361         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2362         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2363         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2364         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2365     12  EMI-ERROR-LINES.
  2366         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2367         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2368         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2369         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2370             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2371                 24  EMI-ERR-NUM         PIC X(4).
  2372                 24  EMI-FILLER          PIC X.
  2373                 24  EMI-SEV             PIC X.
  2374                 24  FILLER              PIC X.
  2375             20  FILLER                  PIC X(02).
  2376     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2377         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2378             20  EMI-ERROR-NUMBER    PIC X(4).
  2379             20  EMI-FILL            PIC X.
  2380             20  EMI-SEVERITY        PIC X.
  2381             20  FILLER              PIC X.
  2382             20  EMI-ERROR-TEXT.
  2383                 24  EMI-TEXT-VARIABLE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  46
* EL131.cbl
  2384                 24  FILLER          PIC X(55).
  2385     12  EMI-SEVERITY-SAVE           PIC X.
  2386         88  EMI-NOTE                    VALUE 'N'.
  2387         88  EMI-WARNING                 VALUE 'W'.
  2388         88  EMI-FORCABLE                VALUE 'F'.
  2389         88  EMI-FATAL                   VALUE 'X'.
  2390     12  EMI-MESSAGE-FLAG            PIC X.
  2391         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2392         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2393     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2394     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2395         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2396         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2397         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2398     12  emi-claim-no                pic x(7).
  2399     12  emi-claim-type              pic x(6).
  2400     12  FILLER                      PIC X(124)  VALUE SPACES.
  2401     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2402     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2403     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2404     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2405
  2406*                                COPY ELCJPFX SUPPRESS.
  2407******************************************************************
  2408*                                                                *
  2409*                                                                *
  2410*                            ELCJPFX.                            *
  2411*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2412*                            VMOD=2.002                          *
  2413*                                                                *
  2414*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2415*                                                                *
  2416*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2417*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2418*        ELCNTL - CONTROL FILE                                   *
  2419*        ELMSTR - CLAIM MASTERS                                  *
  2420*        ELTRLR - ACTIVITY TRAILERS                              *
  2421*        ELCHKQ - CHECK QUE                                      *
  2422******************************************************************
  2423 01  JOURNAL-RECORD.
  2424     12  jp-date                     pic s9(5) comp-3.
  2425     12  jp-time                     pic s9(7) comp-3.
  2426     12  JP-USER-ID                  PIC X(4).
  2427     12  JP-FILE-ID                  PIC X(8).
  2428     12  JP-PROGRAM-ID               PIC X(8).
  2429     12  JP-RECORD-TYPE              PIC X.
  2430         88 JP-ADD              VALUE 'A'.
  2431         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2432         88 JP-AFTER-CHANGE     VALUE 'C'.
  2433         88 JP-DELETE           VALUE 'D'.
  2434         88 JP-GENERIC-DELETE   VALUE 'G'.
  2435         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2436         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2437     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2438     12  JP-RECORD-AREA
  2439
  2440
  2441                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  47
* EL131.cbl
  2442
  2443*                                COPY ELCCALC.
  2444******************************************************************
  2445*                                                                *
  2446*                           ELCCALC.                            *
  2447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2448*                            VMOD=2.025                          *
  2449*                                                                *
  2450*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2451*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2452*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2453*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2454*                                                                *
  2455*  PASSED TO ELRTRM                                              *
  2456*  -----------------                                             *
  2457*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2458*  ORIGINAL TERM                                                 *
  2459*  BEGINNING DATE                                                *
  2460*  ENDING DATE                                                   *
  2461*  COMPANY I.D.                                                  *
  2462*  ACCOUNT MASTER USER FIELD                                     *
  2463*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2464*  FREE LOOK DAYS                                                *
  2465*                                                                *
  2466*  RETURNED FROM ELRTRM                                          *
  2467*  ---------------------                                         *
  2468*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2469*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2470*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2471*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2472*----------------------------------------------------------------*
  2473*  PASSED TO ELRAMT                                              *
  2474*  ----------------                                              *
  2475*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2476*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2477*  ORIGINAL AMOUNT                                               *
  2478*  ALTERNATE BENEFIT (BALLON)                                    *
  2479*  A.P.R. - NET PAY ONLY                                         *
  2480*  METHOD
  2481*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2482*  COMPANY I.D.                                                  *
  2483*  BENEFIT TYPE                                                  *
  2484*                                                                *
  2485*  RETURNED FROM ELRAMT                                          *
  2486*  --------------------                                          *
  2487*  REMAINING AMOUNT 1 - CURRENT                                  *
  2488*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2489*  REMAINING AMOUNT FACTOR
  2490*----------------------------------------------------------------*
  2491*  PASSED TO ELRESV                                              *
  2492*  -----------------                                             *
  2493*  CERTIFICATE EFFECTIVE DATE                                    *
  2494*  VALUATION DATE                                                *
  2495*  PAID THRU DATE                                                *
  2496*  BENEFIT                                                       *
  2497*  INCURRED DATE                                                 *
  2498*  REPORTED DATE                                                 *
  2499*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  48
* EL131.cbl
  2500*  TERM                                                          *
  2501*  CDT PERCENT                                                   *
  2502*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2503* *CLAIM TYPE (LIFE, A/H)                                        *
  2504* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2505* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2506*                                                                *
  2507*  RETURNED FROM ELRESV                                          *
  2508*  --------------------                                          *
  2509*  CDT TABLE USED                                                *
  2510*  CDT FACTOR USED                                               *
  2511*  PAY TO CURRENT RESERVE                                        *
  2512*  I.B.N.R. - A/H ONLY                                           *
  2513*  FUTURE (ACCRUED) AH ONLY                                      *
  2514*----------------------------------------------------------------*
  2515*  PASSED TO ELRATE                                              *
  2516*  ----------------                                              *
  2517*  CERT ISSUE DATE                                               *
  2518*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2519*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2520*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2521*  STATE CODE (CLIENT DEFINED)                                   *
  2522*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2523*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2524*  DEVIATION CODE                                                *
  2525*  ISSUE AGE                                                     *
  2526*  ORIGINAL BENEFIT AMOUNT                                       *
  2527*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2528*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2529*  BENEFIT KIND (LIFE OR A/H)                                    *
  2530*  A.P.R.                                                        *
  2531*  METHOD
  2532*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2533*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2534*  COMPANY I.D. (3 CHARACTER)                                    *
  2535*  BENEFIT CODE                                                  *
  2536*  BENEFIT OVERRIDE CODE                                         *
  2537*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2538*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2539*  JOINT INDICATOR (CSL ONLY)                                    *
  2540*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2541*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2542*                                                                *
  2543*  RETURNED FROM ELRATE                                          *
  2544*  --------------------                                          *
  2545*  CALCULATED PREMIUM                                            *
  2546*  PREMIUM RATE                                                  *
  2547*  MORTALITY CODE                                                *
  2548*  MAX ATTAINED AGE                                              *
  2549*  MAX AGE                                                       *
  2550*  MAX TERM                                                      *
  2551*  MAX MONTHLY BENEFIT                                           *
  2552*  MAX TOTAL BENIFIT                                             *
  2553*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2554*----------------------------------------------------------------*
  2555*  PASSED TO ELRFND                                              *
  2556*  ----------------                                              *
  2557*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  49
* EL131.cbl
  2558*  REFUND DATE                                                   *
  2559*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2560*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2561*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2562*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2563*  STATE CODE (CLIENT DEFINED)                                   *
  2564*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2565*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2566*  DEVIATION CODE                                                *
  2567*  ISSUE AGE                                                     *
  2568*  ORIGINAL BENEFIT AMOUNT                                       *
  2569*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2570*  PROCESS TYPE (CANCEL)                                         *
  2571*  BENEFIT KIND (LIFE OR A/H)                                    *
  2572*  A.P.R.                                                        *
  2573*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2574*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2575*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2576*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2577*  COMPANY I.D. (3 CHARACTER)                                    *
  2578*  BENEFIT CODE                                                  *
  2579*  BENEFIT OVERRIDE CODE                                         *
  2580*                                                                *
  2581*  RETURNED FROM ELRFND                                          *
  2582*  --------------------                                          *
  2583*  CALCULATED REFUND                                             *
  2584*----------------------------------------------------------------*
  2585*  PASSED TO ELEARN                                              *
  2586*  ----------------                                              *
  2587*  CERT ISSUE DATE                                               *
  2588*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2589*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2590*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2591*  STATE CODE (CLIENT DEFINED)                                   *
  2592*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2593*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2594*  DEVIATION CODE                                                *
  2595*  ISSUE AGE                                                     *
  2596*  ORIGINAL BENEFIT AMOUNT                                       *
  2597*  BENEFIT KIND (LIFE OR A/H)                                    *
  2598*  A.P.R.                                                        *
  2599*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2600*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2601*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2602*  COMPANY I.D. (3 CHARACTER)                                    *
  2603*  BENEFIT CODE                                                  *
  2604*  BENEFIT OVERRIDE CODE                                         *
  2605*                                                                *
  2606*  RETURNED FROM ELEARN                                          *
  2607*  --------------------                                          *
  2608*  INDICATED  EARNINGS                                           *
  2609*----------------------------------------------------------------*
  2610*                 LENGTH = 450                                   *
  2611*                                                                *
  2612******************************************************************
  2613******************************************************************
  2614*                   C H A N G E   L O G
  2615*
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  50
* EL131.cbl
  2616* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2617*-----------------------------------------------------------------
  2618*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2619* EFFECTIVE    NUMBER
  2620*-----------------------------------------------------------------
  2621* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2622* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2623* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2624* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2625* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2626* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2627* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2628* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2629* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2630******************************************************************
  2631
  2632 01  CALCULATION-PASS-AREA.
  2633     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2634                                     COMP.
  2635
  2636     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2637       88  NO-CP-ERROR                             VALUE ZERO.
  2638       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2639                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2640       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2641       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2642       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2643       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2644       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2645       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2646       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2647       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2648       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2649       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2650       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2651       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2652       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2653       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2654       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2655       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2656       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2657
  2658     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2659       88  NO-CP-ERROR-2                           VALUE ZERO.
  2660***********************  INPUT AREAS ****************************
  2661
  2662     12  CP-CALCULATION-AREA.
  2663         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2664         16  CP-CERT-EFF-DT        PIC XX.
  2665         16  CP-VALUATION-DT       PIC XX.
  2666         16  CP-PAID-THRU-DT       PIC XX.
  2667         16  CP-BENEFIT-TYPE       PIC X.
  2668           88  CP-AH                               VALUE 'A' 'D'
  2669                                                   'I' 'U'.
  2670           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2671           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2672         16  CP-INCURRED-DT        PIC XX.
  2673         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  51
* EL131.cbl
  2674         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2675         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2676         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2677                                     COMP-3.
  2678         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2679                                     COMP-3.
  2680         16  CP-CDT-METHOD         PIC X.
  2681           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2682           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2683           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2684         16  CP-CLAIM-TYPE         PIC X.
  2685           88  CP-AH-CLAIM                         VALUE 'A'.
  2686           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2687         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2688                                     COMP-3.
  2689         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2690                                     COMP-3.
  2691         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2692                                     COMP-3.
  2693         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2694                                     COMP-3.
  2695         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2696                                     COMP-3.
  2697         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2698                                     COMP-3.
  2699         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2700                                     COMP-3.
  2701         16  CP-REM-TERM-METHOD    PIC X.
  2702           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2703           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2704           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2705           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2706           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2707           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2708           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2709         16  CP-EARNING-METHOD     PIC X.
  2710           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2711           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2712           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2713           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2714           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2715           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2716           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2717           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2718           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2719           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2720           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2721           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2722           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2723           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2724         16  CP-PROCESS-TYPE       PIC X.
  2725           88  CP-CLAIM                            VALUE '1'.
  2726           88  CP-CANCEL                           VALUE '2'.
  2727           88  CP-ISSUE                            VALUE '3'.
  2728         16  CP-SPECIAL-CALC-CD    PIC X.
  2729           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2730           88  CP-1-MTH-INTEREST               VALUE ' '.
  2731           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  52
* EL131.cbl
  2732           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2733           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2734           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2735           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2736           88  CP-FARM-PLAN                    VALUE 'F'.
  2737           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2738           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2739           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2740           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2741           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2742           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2743           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2744           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2745           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2746           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2747                                                     'W' 'X'.
  2748           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2749           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2750           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2751           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2752           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2753           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2754           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2755           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2756           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2757           88  CP-CSL-METH-1                   VALUE '5'.
  2758           88  CP-CSL-METH-2                   VALUE '6'.
  2759           88  CP-CSL-METH-3                   VALUE '7'.
  2760           88  CP-CSL-METH-4                   VALUE '8'.
  2761
  2762         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2763                                     COMP-3.
  2764         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2765         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2766         16  CP-STATE              PIC XX          VALUE SPACE.
  2767         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2768         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2769           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2770               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2771         16  CP-R78-OPTION         PIC X.
  2772           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2773           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2774
  2775         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2776         16  CP-IBNR-RESERVE-SW    PIC X.
  2777         16  CP-CLAIM-STATUS       PIC X.
  2778         16  CP-RATE-FILE          PIC X.
  2779         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2780                                     COMP-3.
  2781
  2782         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2783         16  CP-AH-OVERRIDE-CODE   PIC X.
  2784
  2785         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2786                                     COMP-3.
  2787         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2788                                   PIC S9(5)V99 COMP-3.
  2789         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  53
* EL131.cbl
  2790                                     COMP-3.
  2791         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2792                                     COMP-3.
  2793         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2794                                     COMP-3.
  2795         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2796                                  PIC S9(7)V99 COMP-3.
  2797
  2798         16  CP-PAID-FROM-DATE     PIC X(02).
  2799         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2800         16  CP-EXT-DAYS-CALC      PIC X.
  2801           88  CP-EXT-NO-CHG                   VALUE ' '.
  2802           88  CP-EXT-CHG-LF                   VALUE '1'.
  2803           88  CP-EXT-CHG-AH                   VALUE '2'.
  2804           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2805         16  CP-DOMICILE-STATE     PIC XX.
  2806         16  CP-CARRIER            PIC X.
  2807         16  CP-REIN-FLAG          PIC X.
  2808         16  CP-REM-TRM-CALC-OPTION PIC X.
  2809           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2810                      '2' '3' '4' '5'.
  2811           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2812           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2813           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2814           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2815           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2816           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2817           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2818           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2819         16  CP-SIG-SWITCH         PIC X.
  2820         16  CP-RATING-METHOD      PIC X.
  2821           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2822           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2823           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2824           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2825           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2826           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2827           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2828           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2829           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2830         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2831                                     COMP-3.
  2832         16  CP-BEN-CATEGORY       PIC X.
  2833         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2834         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2835                                   PIC S99V9(5) COMP-3.
  2836         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2837         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2838                                   PIC S99V9(5) COMP-3.
  2839         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2840         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2841         16  CP-EXPIRE-DT          PIC XX.
  2842         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2843         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2844         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2845         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2846         16  CP-DDF-SPEC-CALC      PIC X.
  2847             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  54
* EL131.cbl
  2848             88  CP-CALC-CLP              VALUE 'C'.
  2849         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2850         16  CP-CANCEL-REASON      PIC X.
  2851         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2852         16  CP-PMT-MODE           PIC X.
  2853         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2854         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2855         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2856         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2857         16  FILLER                PIC X.
  2858
  2859***************    OUTPUT FROM ELRESV   ************************
  2860
  2861         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2862
  2863         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2864                                     COMP-3.
  2865         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2866                                     COMP-3.
  2867         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2868                                     COMP-3.
  2869         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2870                                     COMP-3.
  2871         16  FILLER                PIC X(09).
  2872***************    OUTPUT FROM ELRTRM   *************************
  2873
  2874         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2875                                     COMP-3.
  2876         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2877                                     COMP-3.
  2878         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2879                                     COMP-3.
  2880         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2881                                     COMP-3.
  2882         16  FILLER                PIC X(12).
  2883
  2884***************    OUTPUT FROM ELRAMT   *************************
  2885
  2886         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2887                                     COMP-3.
  2888         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2889                                     COMP-3.
  2890         16  FILLER                PIC X(12).
  2891
  2892***************    OUTPUT FROM ELRATE   *************************
  2893
  2894         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2895                                     COMP-3.
  2896         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2897                                     COMP-3.
  2898         16  CP-MORTALITY-CODE     PIC X(4).
  2899         16  CP-RATE-EDIT-FLAG     PIC X.
  2900             88  CP-RATES-NEED-APR                  VALUE '1'.
  2901         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2902                                     COMP-3.
  2903         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2904         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2905         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  55
* EL131.cbl
  2906                                   PIC S9(7)V99 COMP-3.
  2907         16  FILLER                PIC X(07).
  2908
  2909***************    OUTPUT FROM ELRFND   *************************
  2910
  2911         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2912                                     COMP-3.
  2913         16  CP-REFUND-TYPE-USED   PIC X.
  2914           88  CP-R-AS-R78                         VALUE '1'.
  2915           88  CP-R-AS-PRORATA                     VALUE '2'.
  2916           88  CP-R-AS-CALIF                       VALUE '3'.
  2917           88  CP-R-AS-TEXAS                       VALUE '4'.
  2918           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2919           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2920           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2921           88  CP-R-AS-MEAN                        VALUE '8'.
  2922           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2923           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2924           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2925           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2926           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2927           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2928         16  FILLER                PIC X(12).
  2929
  2930***************    OUTPUT FROM ELEARN   *************************
  2931
  2932         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2933                                     COMP-3.
  2934         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2935                                     COMP-3.
  2936         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2937                                     COMP-3.
  2938         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2939                                     COMP-3.
  2940         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2941                                     COMP-3.
  2942         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2943                                     COMP-3.
  2944         16  CP-EARNING-TYPE-USED  PIC X.
  2945           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2946           88  CP-E-AS-R78                         VALUE '1'.
  2947           88  CP-E-AS-PRORATA                     VALUE '2'.
  2948           88  CP-E-AS-TEXAS                       VALUE '4'.
  2949           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2950           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2951           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2952           88  CP-E-AS-MEAN                        VALUE '8'.
  2953           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2954         16  FILLER                PIC X(12).
  2955
  2956***************    OUTPUT FROM ELPMNT   *************************
  2957
  2958         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2959                                     COMP-3.
  2960         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2961                                     COMP-3.
  2962         16  FILLER                PIC X(12).
  2963
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  56
* EL131.cbl
  2964***************   MISC WORK AREAS    *****************************
  2965         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2966                                     COMP-3.
  2967         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2968                                     COMP-3.
  2969         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2970                                     COMP-3.
  2971         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2972                                     COMP-3.
  2973         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2974                                     COMP-3.
  2975         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2976                                     COMP-3.
  2977         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2978             88  OPEN-RATE-FILE                   VALUE 'O'.
  2979             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2980             88  IO-ERROR                         VALUE 'E'.
  2981
  2982         16  CP-FIRST-PAY-DATE     PIC XX.
  2983
  2984         16  CP-JOINT-INDICATOR    PIC X.
  2985
  2986         16  CP-RESERVE-REMAINING-TERM
  2987                                   PIC S9(4)V9    VALUE ZERO
  2988                                     COMP-3.
  2989
  2990         16  CP-INSURED-BIRTH-DT   PIC XX.
  2991
  2992         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2993                                     COMP-3.
  2994
  2995         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2996                                     COMP-3.
  2997
  2998         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2999                                     COMP-3.
  3000
  3001         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3002                                     COMP-3.
  3003
  3004         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3005                                     COMP-3.
  3006
  3007         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3008                                     COMP-3.
  3009
  3010         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3011                                     COMP-3.
  3012
  3013         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3014             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3015
  3016         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3017                                     COMP-3.
  3018         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3019                                     COMP-3.
  3020         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3021         16  FILLER                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  57
* EL131.cbl
  3022******************************************************************
  3023
  3024*                                COPY ELCDATE.
  3025******************************************************************
  3026*                                                                *
  3027*                                                                *
  3028*                            ELCDATE.                            *
  3029*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3030*                            VMOD=2.003
  3031*                                                                *
  3032*                                                                *
  3033*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3034*                 LENGTH = 200                                   *
  3035******************************************************************
  3036
  3037 01  DATE-CONVERSION-DATA.
  3038     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3039     12  DC-OPTION-CODE                PIC X.
  3040         88  BIN-TO-GREG                VALUE ' '.
  3041         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3042         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3043         88  YMD-GREG-TO-BIN            VALUE '3'.
  3044         88  MDY-GREG-TO-BIN            VALUE '4'.
  3045         88  JULIAN-TO-BIN              VALUE '5'.
  3046         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3047         88  FIND-CENTURY               VALUE '7'.
  3048         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3049         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3050         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3051         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3052         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3053         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3054         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3055         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3056         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3057         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3058         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3059         88  BIN-3-TO-GREG              VALUE 'I'.
  3060         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3061         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3062         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3063         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3064         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3065         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3066         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3067         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3068         88  THREE-CHARACTER-BIN
  3069                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3070         88  GREGORIAN-TO-BIN
  3071                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3072         88  BIN-TO-GREGORIAN
  3073                  VALUES ' ' '1' 'I' '8' 'G'.
  3074         88  JULIAN-TO-BINARY
  3075                  VALUES '5' 'C' 'E' 'F'.
  3076     12  DC-ERROR-CODE                 PIC X.
  3077         88  NO-CONVERSION-ERROR        VALUE ' '.
  3078         88  DATE-CONVERSION-ERROR
  3079                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  58
* EL131.cbl
  3080         88  DATE-IS-ZERO               VALUE '1'.
  3081         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3082         88  DATE-IS-INVALID            VALUE '3'.
  3083         88  DATE1-GREATER-DATE2        VALUE '4'.
  3084         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3085         88  DATE-INVALID-OPTION        VALUE '9'.
  3086         88  INVALID-CENTURY            VALUE 'A'.
  3087         88  ONLY-CENTURY               VALUE 'B'.
  3088         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3089         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3090     12  DC-END-OF-MONTH               PIC X.
  3091         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3092     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3093         88  USE-NORMAL-PROCESS         VALUE ' '.
  3094         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3095         88  ADJUST-UP-100-YRS          VALUE '2'.
  3096     12  FILLER                        PIC X.
  3097     12  DC-CONVERSION-DATES.
  3098         16  DC-BIN-DATE-1             PIC XX.
  3099         16  DC-BIN-DATE-2             PIC XX.
  3100         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3101         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3102                       DC-GREG-DATE-1-EDIT.
  3103             20  DC-EDIT1-MONTH        PIC 99.
  3104             20  SLASH1-1              PIC X.
  3105             20  DC-EDIT1-DAY          PIC 99.
  3106             20  SLASH1-2              PIC X.
  3107             20  DC-EDIT1-YEAR         PIC 99.
  3108         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3109         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3110                     DC-GREG-DATE-2-EDIT.
  3111             20  DC-EDIT2-MONTH        PIC 99.
  3112             20  SLASH2-1              PIC X.
  3113             20  DC-EDIT2-DAY          PIC 99.
  3114             20  SLASH2-2              PIC X.
  3115             20  DC-EDIT2-YEAR         PIC 99.
  3116         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3117         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3118                     DC-GREG-DATE-1-YMD.
  3119             20  DC-YMD-YEAR           PIC 99.
  3120             20  DC-YMD-MONTH          PIC 99.
  3121             20  DC-YMD-DAY            PIC 99.
  3122         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3123         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3124                      DC-GREG-DATE-1-MDY.
  3125             20  DC-MDY-MONTH          PIC 99.
  3126             20  DC-MDY-DAY            PIC 99.
  3127             20  DC-MDY-YEAR           PIC 99.
  3128         16  DC-GREG-DATE-1-ALPHA.
  3129             20  DC-ALPHA-MONTH        PIC X(10).
  3130             20  DC-ALPHA-DAY          PIC 99.
  3131             20  FILLER                PIC XX.
  3132             20  DC-ALPHA-CENTURY.
  3133                 24 DC-ALPHA-CEN-N     PIC 99.
  3134             20  DC-ALPHA-YEAR         PIC 99.
  3135         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3136         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3137         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  59
* EL131.cbl
  3138         16  DC-JULIAN-DATE            PIC 9(05).
  3139         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3140                                       PIC 9(05).
  3141         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3142             20  DC-JULIAN-YEAR        PIC 99.
  3143             20  DC-JULIAN-DAYS        PIC 999.
  3144         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3145         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3146         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3147     12  DATE-CONVERSION-VARIBLES.
  3148         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3149         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3150             20  FILLER                PIC 9(3).
  3151             20  HOLD-CEN-1-CCYY.
  3152                 24  HOLD-CEN-1-CC     PIC 99.
  3153                 24  HOLD-CEN-1-YY     PIC 99.
  3154             20  HOLD-CEN-1-MO         PIC 99.
  3155             20  HOLD-CEN-1-DA         PIC 99.
  3156         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3157             20  HOLD-CEN-1-R-MO       PIC 99.
  3158             20  HOLD-CEN-1-R-DA       PIC 99.
  3159             20  HOLD-CEN-1-R-CCYY.
  3160                 24  HOLD-CEN-1-R-CC   PIC 99.
  3161                 24  HOLD-CEN-1-R-YY   PIC 99.
  3162             20  FILLER                PIC 9(3).
  3163         16  HOLD-CENTURY-1-X.
  3164             20  FILLER                PIC X(3)  VALUE SPACES.
  3165             20  HOLD-CEN-1-X-CCYY.
  3166                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3167                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3168             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3169             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3170         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3171             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3172             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3173             20  HOLD-CEN-1-R-X-CCYY.
  3174                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3175                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3176             20  FILLER                PIC XXX.
  3177         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3178         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3179         16  DC-JULIAN-DATE-1          PIC 9(07).
  3180         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3181             20  DC-JULIAN-1-CCYY.
  3182                 24  DC-JULIAN-1-CC    PIC 99.
  3183                 24  DC-JULIAN-1-YR    PIC 99.
  3184             20  DC-JULIAN-DA-1        PIC 999.
  3185         16  DC-JULIAN-DATE-2          PIC 9(07).
  3186         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3187             20  DC-JULIAN-2-CCYY.
  3188                 24  DC-JULIAN-2-CC    PIC 99.
  3189                 24  DC-JULIAN-2-YR    PIC 99.
  3190             20  DC-JULIAN-DA-2        PIC 999.
  3191         16  DC-GREG-DATE-A-EDIT.
  3192             20  DC-EDITA-MONTH        PIC 99.
  3193             20  SLASHA-1              PIC X VALUE '/'.
  3194             20  DC-EDITA-DAY          PIC 99.
  3195             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  60
* EL131.cbl
  3196             20  DC-EDITA-CCYY.
  3197                 24  DC-EDITA-CENT     PIC 99.
  3198                 24  DC-EDITA-YEAR     PIC 99.
  3199         16  DC-GREG-DATE-B-EDIT.
  3200             20  DC-EDITB-MONTH        PIC 99.
  3201             20  SLASHB-1              PIC X VALUE '/'.
  3202             20  DC-EDITB-DAY          PIC 99.
  3203             20  SLASHB-2              PIC X VALUE '/'.
  3204             20  DC-EDITB-CCYY.
  3205                 24  DC-EDITB-CENT     PIC 99.
  3206                 24  DC-EDITB-YEAR     PIC 99.
  3207         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3208         16  DC-GREG-DATE-CYMD-R REDEFINES
  3209                              DC-GREG-DATE-CYMD.
  3210             20  DC-CYMD-CEN           PIC 99.
  3211             20  DC-CYMD-YEAR          PIC 99.
  3212             20  DC-CYMD-MONTH         PIC 99.
  3213             20  DC-CYMD-DAY           PIC 99.
  3214         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3215         16  DC-GREG-DATE-MDCY-R REDEFINES
  3216                              DC-GREG-DATE-MDCY.
  3217             20  DC-MDCY-MONTH         PIC 99.
  3218             20  DC-MDCY-DAY           PIC 99.
  3219             20  DC-MDCY-CEN           PIC 99.
  3220             20  DC-MDCY-YEAR          PIC 99.
  3221    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3222        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3223    12  DC-EL310-DATE                  PIC X(21).
  3224    12  FILLER                         PIC X(28).
  3225
  3226*                                COPY ELCDMO.
  3227******************************************************************
  3228*                                                                *
  3229*                                                                *
  3230*                            ELCDMO.                             *
  3231*                            VMOD=2.004                          *
  3232*                                                                *
  3233*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3234*        COMMUNICATION AREA                                      *
  3235*   FILE TYPE = NA                                               *
  3236*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3237*                                                                *
  3238******************************************************************
  3239 01  DMO-COMMUNICATION-AREA.
  3240     12  DM-RECORD-TYPE                  PIC  X(02).
  3241             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3242             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3243             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3244     12  DM-DIST-CODE                    PIC  X(04).
  3245     12  DM-MAIL-CODE                    PIC  X(05).
  3246     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3247     12  DM-INSURED-NAME                 PIC  X(30).
  3248     12  DM-CLAIM-NO                     PIC  X(07).
  3249     12  DM-CLAIM-TYPE                   PIC  X.
  3250
  3251     12  DM-STATUS-DATA-AREA.
  3252         16  DM-CLAIM-STATUS             PIC  X.
  3253             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  61
* EL131.cbl
  3254             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3255             88  DM-CLOSED                        VALUE '3'.
  3256             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3257             88  DM-DEFAULT                       VALUE '9'.
  3258         16  DM-STATUS-DATE              PIC  X(08).
  3259******YYYYMMDD
  3260         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3261             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3262             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3263             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3264             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3265             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3266             88  DM-RE-OPENED                     VALUE 'R'.
  3267             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3268             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3269             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3270         16  DM-STAT-CARRIER             PIC X.
  3271
  3272     12  DM-DRAFT-DATA-AREA.
  3273         16  DM-PAYMENT-TYPE             PIC  X.
  3274             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3275         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3276         16  DM-PAYMENT-DATE             PIC  X(08).
  3277******YYYYMMDD
  3278         16  DM-CERT-NO                  PIC  X(11).
  3279         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3280         16  DM-CARRIER                  PIC  X.
  3281
  3282     12  DM-RETURN-CODE                  PIC  XX.
  3283*                                COPY ERCPDEF.
  3284******************************************************************
  3285*                                                                *
  3286*                                                                *
  3287*                            ERCPDEF.                            *
  3288*                                                                *
  3289*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3290*                                                                *
  3291*    FILE TYPE = VSAM,KSDS                                       *
  3292*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3293*                                                                *
  3294*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3295*                                                                *
  3296*    LOG = YES                                                   *
  3297*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3298******************************************************************
  3299*                   C H A N G E   L O G
  3300*
  3301* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3302*-----------------------------------------------------------------
  3303*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3304* EFFECTIVE    NUMBER
  3305*-----------------------------------------------------------------
  3306* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3307* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3308******************************************************************
  3309 01  PRODUCT-MASTER.
  3310    12  PD-RECORD-ID                 PIC X(02).
  3311        88  VALID-PD-ID                  VALUE 'PD'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  62
* EL131.cbl
  3312    12  PD-CONTROL-PRIMARY.
  3313        16  PD-COMPANY-CD            PIC X.
  3314        16  PD-STATE                 PIC XX.
  3315        16  PD-PRODUCT-CD            PIC XXX.
  3316        16  PD-FILLER                PIC X(7).
  3317        16  PD-BEN-TYPE              PIC X.
  3318        16  PD-BEN-CODE              PIC XX.
  3319        16  PD-PROD-EXP-DT           PIC XX.
  3320    12  FILLER                       PIC X(50).
  3321    12  PD-PRODUCT-DATA OCCURS 8.
  3322        16  PD-PROD-CODE             PIC X.
  3323            88  PD-PROD-LIFE           VALUE 'L'.
  3324            88  PD-PROD-PROP           VALUE 'P'.
  3325            88  PD-PROD-AH             VALUE 'A'.
  3326            88  PD-PROD-IU             VALUE 'I'.
  3327            88  PD-PROD-GAP            VALUE 'G'.
  3328            88  PD-PROD-FAML           VALUE 'F'.
  3329        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3330        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3331        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3332        16  PD-MAX-TERM              PIC S999        COMP-3.
  3333        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3334        16  FILLER                   PIC X.
  3335        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3336        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3337        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3338        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3339        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3340        16  PD-REC-CRIT-PERIOD       PIC 99.
  3341        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3342            20  PD-RECURRING-YN      PIC X.
  3343            20  FILLER               PIC X.
  3344        16  PD-RTW-MOS               PIC 99.
  3345        16  PD-MAX-EXTENSION         PIC 99.
  3346        16  FILLER                   PIC XX.
  3347    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3348    12  PD-TERM-LIMITS OCCURS 15.
  3349        16  PD-LOW-TERM              PIC S999        COMP-3.
  3350        16  PD-HI-TERM               PIC S999        COMP-3.
  3351*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3352    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3353        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3354        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3355    12  PD-EARN-FACTORS.
  3356        16  FILLER OCCURS 15.
  3357            20  FILLER OCCURS 15.
  3358                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3359    12  PD-PRODUCT-DESC              PIC X(80).
  3360    12  PD-TRUNCATED                 PIC X.
  3361    12  FILLER                       PIC X(59).
  3362    12  PD-MAINT-INFORMATION.
  3363        16  PD-LAST-MAINT-DT         PIC X(02).
  3364        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3365        16  PD-LAST-MAINT-BY         PIC X(04).
  3366*                                COPY ELCCRTT.
  3367******************************************************************
  3368*                                                                *
  3369*                            ELCCRTT.                            *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  63
* EL131.cbl
  3370*                                                                *
  3371*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3372*                                                                *
  3373*   FILE TYPE = VSAM,KSDS                                        *
  3374*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3375*                                                                *
  3376*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3377*                                                                *
  3378*   LOG = YES                                                    *
  3379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3380******************************************************************
  3381*                   C H A N G E   L O G
  3382*
  3383* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3384*-----------------------------------------------------------------
  3385*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3386* EFFECTIVE    NUMBER
  3387*-----------------------------------------------------------------
  3388* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3389* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3390* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3391* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3392* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3393* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3394* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3395******************************************************************
  3396
  3397 01  CERTIFICATE-TRAILERS.
  3398     12  CS-RECORD-ID                      PIC XX.
  3399         88  VALID-CS-ID                      VALUE 'CS'.
  3400
  3401     12  CS-CONTROL-PRIMARY.
  3402         16  CS-COMPANY-CD                 PIC X.
  3403         16  CS-CARRIER                    PIC X.
  3404         16  CS-GROUPING                   PIC X(6).
  3405         16  CS-STATE                      PIC XX.
  3406         16  CS-ACCOUNT                    PIC X(10).
  3407         16  CS-CERT-EFF-DT                PIC XX.
  3408         16  CS-CERT-NO.
  3409             20  CS-CERT-PRIME             PIC X(10).
  3410             20  CS-CERT-SFX               PIC X.
  3411         16  CS-TRAILER-TYPE               PIC X.
  3412             88  COMM-TRLR           VALUE 'A'.
  3413             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3414             88  CERT-DATA-TRLR      VALUE 'C'.
  3415
  3416     12  CS-DATA-AREA                      PIC X(516).
  3417
  3418     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3419         16  CS-BANK-COMMISSION-AREA.
  3420             20  CS-BANK-COMMS       OCCURS 10.
  3421                 24  CS-AGT                PIC X(10).
  3422                 24  CS-COM-TYP            PIC X.
  3423                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3424                 24  CS-RECALC-LV-INDIC    PIC X.
  3425                 24  FILLER                PIC X(10).
  3426         16  FILLER                        PIC X(256).
  3427
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  64
* EL131.cbl
  3428     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3429****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3430         16  CS-MB-CLAIM-DATA OCCURS 24.
  3431             20  CS-CLAIM-NO               PIC X(7).
  3432             20  CS-CLAIM-TYPE             PIC X.
  3433                 88  CS-AH-CLM               VALUE 'A'.
  3434                 88  CS-IU-CLM               VALUE 'I'.
  3435                 88  CS-GP-CLM               VALUE 'G'.
  3436                 88  CS-LF-CLM               VALUE 'L'.
  3437                 88  CS-PR-CLM               VALUE 'P'.
  3438                 88  CS-FL-CLM               VALUE 'F'.
  3439             20  CS-INSURED-TYPE           PIC X.
  3440                 88  CS-PRIM-INSURED          VALUE 'P'.
  3441                 88  CS-CO-BORROWER           VALUE 'C'.
  3442             20  CS-BENEFIT-PERIOD         PIC 99.
  3443             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3444             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3445             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3446         16  FILLER                        PIC X(12).
  3447     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3448         16  CS-VIN-NUMBER                 PIC X(17).
  3449         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3450         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3451         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3452         16  FILLER                        PIC X(496).
  3453
  3454****************************************************************
  3455*
  3456* Copyright (c) 2007 by Clerity Solutions, Inc.
  3457* All rights reserved.
  3458*
  3459****************************************************************
  3460 01  DFHEIV.
  3461   02  DFHEIV0               PIC X(35).
  3462   02  DFHEIV1               PIC X(08).
  3463   02  DFHEIV2               PIC X(08).
  3464   02  DFHEIV3               PIC X(08).
  3465   02  DFHEIV4               PIC X(06).
  3466   02  DFHEIV5               PIC X(04).
  3467   02  DFHEIV6               PIC X(04).
  3468   02  DFHEIV7               PIC X(02).
  3469   02  DFHEIV8               PIC X(02).
  3470   02  DFHEIV9               PIC X(01).
  3471   02  DFHEIV10              PIC S9(7) COMP-3.
  3472   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3473   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3474   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3475   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3476   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3477   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3478   02  DFHEIV17              PIC X(04).
  3479   02  DFHEIV18              PIC X(04).
  3480   02  DFHEIV19              PIC X(04).
  3481   02  DFHEIV20              USAGE IS POINTER.
  3482   02  DFHEIV21              USAGE IS POINTER.
  3483   02  DFHEIV22              USAGE IS POINTER.
  3484   02  DFHEIV23              USAGE IS POINTER.
  3485   02  DFHEIV24              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  65
* EL131.cbl
  3486   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3487   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3488   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3489   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3490   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3491   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3492   02  FILLER                PIC X(02).
  3493   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3494   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3495   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3496   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3497   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3498 LINKAGE  SECTION.
  3499*****************************************************************
  3500*                                                               *
  3501* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3502* All rights reserved.                                          *
  3503*                                                               *
  3504*****************************************************************
  3505 01  dfheiblk.
  3506     02  eibtime          pic s9(7) comp-3.
  3507     02  eibdate          pic s9(7) comp-3.
  3508     02  eibtrnid         pic x(4).
  3509     02  eibtaskn         pic s9(7) comp-3.
  3510     02  eibtrmid         pic x(4).
  3511     02  dfheigdi         pic s9(4) comp.
  3512     02  eibcposn         pic s9(4) comp.
  3513     02  eibcalen         pic s9(4) comp.
  3514     02  eibaid           pic x(1).
  3515     02  eibfiller1       pic x(1).
  3516     02  eibfn            pic x(2).
  3517     02  eibfiller2       pic x(2).
  3518     02  eibrcode         pic x(6).
  3519     02  eibfiller3       pic x(2).
  3520     02  eibds            pic x(8).
  3521     02  eibreqid         pic x(8).
  3522     02  eibrsrce         pic x(8).
  3523     02  eibsync          pic x(1).
  3524     02  eibfree          pic x(1).
  3525     02  eibrecv          pic x(1).
  3526     02  eibsend          pic x(1).
  3527     02  eibatt           pic x(1).
  3528     02  eibeoc           pic x(1).
  3529     02  eibfmh           pic x(1).
  3530     02  eibcompl         pic x(1).
  3531     02  eibsig           pic x(1).
  3532     02  eibconf          pic x(1).
  3533     02  eiberr           pic x(1).
  3534     02  eibrldbk         pic x(1).
  3535     02  eiberrcd         pic x(4).
  3536     02  eibsynrb         pic x(1).
  3537     02  eibnodat         pic x(1).
  3538     02  eibfiller5       pic x(2).
  3539     02  eibresp          pic 9(09) comp.
  3540     02  eibresp2         pic 9(09) comp.
  3541     02  dfheigdj         pic s9(4) comp.
  3542     02  dfheigdk         pic s9(4) comp.
  3543 01  DFHCOMMAREA                 PIC X(1024).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  66
* EL131.cbl
  3544
  3545*                                COPY ELCMSTR.
  3546******************************************************************
  3547*                                                                *
  3548*                            ELCMSTR.                            *
  3549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3550*                            VMOD=2.012                          *
  3551*                                                                *
  3552*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3553*                                                                *
  3554*   FILE TYPE = VSAM,KSDS                                        *
  3555*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3556*                                                                *
  3557*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3558*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3559*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3560*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3561*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3562*                                                 RKP=75,LEN=21  *
  3563*                                                                *
  3564*   **** NOTE ****                                               *
  3565*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3566*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3567*                                                                *
  3568*   LOG = YES                                                    *
  3569*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3570******************************************************************
  3571*                   C H A N G E   L O G
  3572*
  3573* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3574*-----------------------------------------------------------------
  3575*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3576* EFFECTIVE    NUMBER
  3577*-----------------------------------------------------------------
  3578* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3579* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3580* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3581* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3582* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3583******************************************************************
  3584 01  CLAIM-MASTER.
  3585     12  CL-RECORD-ID                PIC XX.
  3586         88  VALID-CL-ID         VALUE 'CL'.
  3587
  3588     12  CL-CONTROL-PRIMARY.
  3589         16  CL-COMPANY-CD           PIC X.
  3590         16  CL-CARRIER              PIC X.
  3591         16  CL-CLAIM-NO             PIC X(7).
  3592         16  CL-CERT-NO.
  3593             20  CL-CERT-PRIME       PIC X(10).
  3594             20  CL-CERT-SFX         PIC X.
  3595
  3596     12  CL-CONTROL-BY-NAME.
  3597         16  CL-COMPANY-CD-A1        PIC X.
  3598         16  CL-INSURED-LAST-NAME    PIC X(15).
  3599         16  CL-INSURED-NAME.
  3600             20  CL-INSURED-1ST-NAME PIC X(12).
  3601             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  67
* EL131.cbl
  3602
  3603     12  CL-CONTROL-BY-SSN.
  3604         16  CL-COMPANY-CD-A2        PIC X.
  3605         16  CL-SOC-SEC-NO.
  3606             20  CL-SSN-STATE        PIC XX.
  3607             20  CL-SSN-ACCOUNT      PIC X(6).
  3608             20  CL-SSN-LN3          PIC X(3).
  3609
  3610     12  CL-CONTROL-BY-CERT-NO.
  3611         16  CL-COMPANY-CD-A4        PIC X.
  3612         16  CL-CERT-NO-A4.
  3613             20  CL-CERT-A4-PRIME    PIC X(10).
  3614             20  CL-CERT-A4-SFX      PIC X.
  3615
  3616     12  CL-CONTROL-BY-CCN.
  3617         16  CL-COMPANY-CD-A5        PIC X.
  3618         16  CL-CCN-A5.
  3619             20  CL-CCN.
  3620                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3621                 24  CL-CCN-PRIME-A5 PIC X(12).
  3622             20  CL-CCN-FILLER-A5    PIC X(4).
  3623
  3624     12  CL-INSURED-PROFILE-DATA.
  3625         16  CL-INSURED-BIRTH-DT     PIC XX.
  3626         16  CL-INSURED-SEX-CD       PIC X.
  3627             88  INSURED-IS-MALE        VALUE 'M'.
  3628             88  INSURED-IS-FEMALE      VALUE 'F'.
  3629             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3630         16  CL-INSURED-OCC-CD       PIC X(6).
  3631         16  FILLER                  PIC X(5).
  3632
  3633     12  CL-PROCESSING-INFO.
  3634         16  CL-PROCESSOR-ID         PIC X(4).
  3635         16  CL-CLAIM-STATUS         PIC X.
  3636             88  CLAIM-IS-OPEN          VALUE 'O'.
  3637             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3638         16  CL-CLAIM-TYPE           PIC X.
  3639*            88  AH-CLAIM               VALUE 'A'.
  3640*            88  LIFE-CLAIM             VALUE 'L'.
  3641*            88  PROPERTY-CLAIM         VALUE 'P'.
  3642*            88  IUI-CLAIM              VALUE 'I'.
  3643*            88  GAP-CLAIM              VALUE 'G'.
  3644*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3645         16  CL-CLAIM-PREM-TYPE      PIC X.
  3646             88  SINGLE-PREMIUM         VALUE '1'.
  3647             88  O-B-COVERAGE           VALUE '2'.
  3648             88  OPEN-END-COVERAGE      VALUE '3'.
  3649         16  CL-INCURRED-DT          PIC XX.
  3650         16  CL-REPORTED-DT          PIC XX.
  3651         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3652         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3653         16  CL-LAST-PMT-DT          PIC XX.
  3654         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3655         16  CL-PAID-THRU-DT         PIC XX.
  3656         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3657         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3658         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3659         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  68
* EL131.cbl
  3660             88  CL-360-DAY-YR          VALUE '1'.
  3661             88  CL-365-DAY-YR          VALUE '2'.
  3662             88  CL-FULL-MONTHS         VALUE '3'.
  3663         16  CL-CAUSE-CD             PIC X(6).
  3664
  3665         16  CL-PRIME-CERT-NO.
  3666             20  CL-PRIME-CERT-PRIME PIC X(10).
  3667             20  CL-PRIME-CERT-SFX   PIC X.
  3668
  3669         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3670             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3671             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3672
  3673         16  CL-MICROFILM-NO         PIC X(10).
  3674         16  FILLER REDEFINES CL-MICROFILM-NO.
  3675             20  CL-BENEFIT-PERIOD   PIC 99.
  3676             20  FILLER              PIC X(8).
  3677         16  CL-PROG-FORM-TYPE       PIC X.
  3678         16  CL-LAST-ADD-ON-DT       PIC XX.
  3679
  3680         16  CL-LAST-REOPEN-DT       PIC XX.
  3681         16  CL-LAST-CLOSE-DT        PIC XX.
  3682         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3683             88  FINAL-PAID             VALUE '1'.
  3684             88  CLAIM-DENIED           VALUE '2'.
  3685             88  AUTO-CLOSE             VALUE '3'.
  3686             88  MANUAL-CLOSE           VALUE '4'.
  3687             88  BENEFITS-CHANGED       VALUE 'C'.
  3688             88  SETUP-ERRORS           VALUE 'E'.
  3689         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3690         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3691         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3692             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3693         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3694         16  FILLER                  PIC X.
  3695
  3696     12  CL-CERTIFICATE-DATA.
  3697         16  CL-CERT-ORIGIN          PIC X.
  3698             88  CERT-WAS-ONLINE        VALUE '1'.
  3699             88  CERT-WAS-CREATED       VALUE '2'.
  3700             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3701         16  CL-CERT-KEY-DATA.
  3702             20  CL-CERT-CARRIER     PIC X.
  3703             20  CL-CERT-GROUPING    PIC X(6).
  3704             20  CL-CERT-STATE       PIC XX.
  3705             20  CL-CERT-ACCOUNT.
  3706                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3707                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3708             20  CL-CERT-EFF-DT      PIC XX.
  3709
  3710     12  CL-STATUS-CONTROLS.
  3711         16  CL-PRIORITY-CD          PIC X.
  3712             88  CONFIDENTIAL-DATA      VALUE '8'.
  3713             88  HIGHEST-PRIORITY       VALUE '9'.
  3714         16  CL-SUPV-ATTN-CD         PIC X.
  3715             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3716             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3717         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  69
* EL131.cbl
  3718         16  CL-RESTORED-DT          PIC XX.
  3719         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3720         16  CL-NEXT-RESEND-DT       PIC XX.
  3721         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3722         16  CL-CRITICAL-PERIOD      PIC 99.
  3723*        16  FILLER                  PIC XX.
  3724         16  CL-LAST-MAINT-DT        PIC XX.
  3725         16  CL-LAST-MAINT-USER      PIC X(4).
  3726         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3727         16  CL-LAST-MAINT-TYPE      PIC X.
  3728             88  CLAIM-SET-UP           VALUE ' '.
  3729             88  PAYMENT-MADE           VALUE '1'.
  3730             88  LETTER-SENT            VALUE '2'.
  3731             88  MASTER-WAS-ALTERED     VALUE '3'.
  3732             88  MASTER-WAS-RESTORED    VALUE '4'.
  3733             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3734             88  FILE-CONVERTED         VALUE '6'.
  3735             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3736             88  ERROR-CORRECTION       VALUE 'E'.
  3737         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3738         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3739         16  CL-BENEFICIARY          PIC X(10).
  3740         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3741         16  CL-DENIAL-TYPE          PIC X.
  3742             88  CL-TYPE-DENIAL          VALUE '1'.
  3743             88  CL-TYPE-RESCISSION      VALUE '2'.
  3744             88  CL-TYPE-REFORMATION     VALUE '3'.
  3745             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3746             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3747         16  filler                  pic x(5).
  3748*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3749*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3750*        16  CL-RTW-DT               PIC XX.
  3751
  3752     12  CL-TRAILER-CONTROLS.
  3753         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3754             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3755             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3756             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3757         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3758         16  FILLER                  PIC XX.
  3759         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3760         16  CL-ADDRESS-TRAILER-CNT.
  3761             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3762                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3763             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3764                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3765             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3766                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3767             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3768                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3769             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3770                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3771             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3772                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3773             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3774                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3775
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  70
* EL131.cbl
  3776     12  CL-CV-REFERENCE-NO.
  3777         16  CL-CV-REFNO-PRIME       PIC X(18).
  3778         16  CL-CV-REFNO-SFX         PIC XX.
  3779
  3780     12  CL-FILE-LOCATION            PIC X(4).
  3781
  3782     12  CL-PROCESS-ERRORS.
  3783         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3784             88  NO-FATAL-ERRORS        VALUE ZERO.
  3785         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3786             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3787
  3788     12  CL-PRODUCT-CD               PIC X.
  3789
  3790     12  CL-CURRENT-KEY-DATA.
  3791         16  CL-CURRENT-CARRIER      PIC X.
  3792         16  CL-CURRENT-GROUPING     PIC X(6).
  3793         16  CL-CURRENT-STATE        PIC XX.
  3794         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3795
  3796     12  CL-ASSOCIATES               PIC X.
  3797         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3798         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3799         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3800         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3801
  3802     12  CL-ACTIVITY-CODE            PIC 99.
  3803     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3804     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3805
  3806     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3807     12  CL-LAG-REPORT-CODE          PIC 9.
  3808     12  CL-LOAN-TYPE                PIC XX.
  3809     12  CL-LEGAL-STATE              PIC XX.
  3810
  3811     12  CL-YESNOSW                  PIC X.
  3812     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3813         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3814         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3815         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3816     12  cl-insured-type             pic x.
  3817         88  cl-claim-on-primary         value 'P'.
  3818         88  cl-claim-on-co-borrower     value 'C'.
  3819     12  cl-benefit-expiration-dt    PIC XX.
  3820
  3821*                                COPY ELCCERT.
  3822******************************************************************
  3823*                                                                *
  3824*                            ELCCERT.                            *
  3825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3826*                            VMOD=2.013                          *
  3827*                                                                *
  3828*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3829*                                                                *
  3830*   FILE TYPE = VSAM,KSDS                                        *
  3831*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3832*                                                                *
  3833*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  71
* EL131.cbl
  3834*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3835*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3836*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3837*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3838*                                                                *
  3839*   LOG = YES                                                    *
  3840*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3841******************************************************************
  3842*                   C H A N G E   L O G
  3843*
  3844* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3845*-----------------------------------------------------------------
  3846*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3847* EFFECTIVE    NUMBER
  3848*-----------------------------------------------------------------
  3849* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3850* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3851* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3852* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3853* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3854* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3855* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3856* 032612  CR2011110200001  PEMA  AHL CHANGES
  3857* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3858******************************************************************
  3859
  3860 01  CERTIFICATE-MASTER.
  3861     12  CM-RECORD-ID                      PIC XX.
  3862         88  VALID-CM-ID                      VALUE 'CM'.
  3863
  3864     12  CM-CONTROL-PRIMARY.
  3865         16  CM-COMPANY-CD                 PIC X.
  3866         16  CM-CARRIER                    PIC X.
  3867         16  CM-GROUPING.
  3868             20  CM-GROUPING-PREFIX        PIC X(3).
  3869             20  CM-GROUPING-PRIME         PIC X(3).
  3870         16  CM-STATE                      PIC XX.
  3871         16  CM-ACCOUNT.
  3872             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3873             20  CM-ACCOUNT-PRIME          PIC X(6).
  3874         16  CM-CERT-EFF-DT                PIC XX.
  3875         16  CM-CERT-NO.
  3876             20  CM-CERT-PRIME             PIC X(10).
  3877             20  CM-CERT-SFX               PIC X.
  3878
  3879     12  CM-CONTROL-BY-NAME.
  3880         16  CM-COMPANY-CD-A1              PIC X.
  3881         16  CM-INSURED-LAST-NAME          PIC X(15).
  3882         16  CM-INSURED-INITIALS.
  3883             20  CM-INSURED-INITIAL1       PIC X.
  3884             20  CM-INSURED-INITIAL2       PIC X.
  3885
  3886     12  CM-CONTROL-BY-SSN.
  3887         16  CM-COMPANY-CD-A2              PIC X.
  3888         16  CM-SOC-SEC-NO.
  3889             20  CM-SSN-STATE              PIC XX.
  3890             20  CM-SSN-ACCOUNT            PIC X(6).
  3891             20  CM-SSN-LN3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  72
* EL131.cbl
  3892                 25  CM-INSURED-INITIALS-A2.
  3893                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3894                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3895                 25 CM-PART-LAST-NAME-A2         PIC X.
  3896
  3897     12  CM-CONTROL-BY-CERT-NO.
  3898         16  CM-COMPANY-CD-A4              PIC X.
  3899         16  CM-CERT-NO-A4                 PIC X(11).
  3900
  3901     12  CM-CONTROL-BY-MEMB.
  3902         16  CM-COMPANY-CD-A5              PIC X.
  3903         16  CM-MEMBER-NO.
  3904             20  CM-MEMB-STATE             PIC XX.
  3905             20  CM-MEMB-ACCOUNT           PIC X(6).
  3906             20  CM-MEMB-LN4.
  3907                 25  CM-INSURED-INITIALS-A5.
  3908                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3909                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3910                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3911
  3912     12  CM-INSURED-PROFILE-DATA.
  3913         16  CM-INSURED-FIRST-NAME.
  3914             20  CM-INSURED-1ST-INIT       PIC X.
  3915             20  FILLER                    PIC X(9).
  3916         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3917         16  CM-INSURED-SEX                PIC X.
  3918             88  CM-SEX-MALE                  VALUE 'M'.
  3919             88  CM-SEX-FEMAL                 VALUE 'F'.
  3920         16  CM-INSURED-JOINT-AGE          PIC 99.
  3921         16  CM-JOINT-INSURED-NAME.
  3922             20  CM-JT-LAST-NAME           PIC X(15).
  3923             20  CM-JT-FIRST-NAME.
  3924                 24  CM-JT-1ST-INIT        PIC X.
  3925                 24  FILLER                PIC X(9).
  3926             20  CM-JT-INITIAL             PIC X.
  3927
  3928     12  CM-LIFE-DATA.
  3929         16  CM-LF-BENEFIT-CD              PIC XX.
  3930         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3931         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3932         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3933         16  CM-LF-DEV-CODE                PIC XXX.
  3934         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3935         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3936         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3937         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3938         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3939         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3940         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3941         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3942         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3943         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3944         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3945         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3946         16  cm-temp-epiq                  pic xx.
  3947             88  EPIQ-CLASS                  value 'EQ'.
  3948*        16  FILLER                        PIC XX.
  3949
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  73
* EL131.cbl
  3950     12  CM-AH-DATA.
  3951         16  CM-AH-BENEFIT-CD              PIC XX.
  3952         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3953         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3954         16  CM-AH-DEV-CODE                PIC XXX.
  3955         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3956         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3957         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3958         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3959         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3960         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3961         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3962         16  CM-AH-PAID-THRU-DT            PIC XX.
  3963             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3964         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3965         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3966         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3967         16  FILLER                        PIC X.
  3968
  3969     12  CM-LOAN-INFORMATION.
  3970         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3971         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3972                                           PIC S9(5)V99  COMP-3.
  3973         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3974         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3975         16  CM-PAY-FREQUENCY              PIC S99.
  3976         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3977         16  CM-RATE-CLASS                 PIC XX.
  3978         16  CM-BENEFICIARY                PIC X(25).
  3979         16  CM-POLICY-FORM-NO             PIC X(12).
  3980         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3981         16  CM-LAST-ADD-ON-DT             PIC XX.
  3982         16  CM-DEDUCTIBLE-AMOUNTS.
  3983             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3984             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3985         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3986             20  CM-RESIDENT-STATE         PIC XX.
  3987             20  CM-RATE-CODE              PIC X(4).
  3988             20  FILLER                    PIC XX.
  3989         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3990             20  CM-LOAN-OFFICER           PIC X(5).
  3991             20  FILLER                    PIC XXX.
  3992         16  CM-CSR-CODE                   PIC XXX.
  3993         16  CM-UNDERWRITING-CODE          PIC X.
  3994             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3995         16  CM-POST-CARD-IND              PIC X.
  3996         16  CM-NH-INTERFACE-SW            PIC X.
  3997         16  CM-PREMIUM-TYPE               PIC X.
  3998             88  CM-SING-PRM                  VALUE '1'.
  3999             88  CM-O-B-COVERAGE              VALUE '2'.
  4000             88  CM-OPEN-END                  VALUE '3'.
  4001         16  CM-IND-GRP-TYPE               PIC X.
  4002             88  CM-INDIVIDUAL                VALUE 'I'.
  4003             88  CM-GROUP                     VALUE 'G'.
  4004         16  CM-SKIP-CODE                  PIC X.
  4005             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4006             88  SKIP-JULY                    VALUE '1'.
  4007             88  SKIP-AUGUST                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  74
* EL131.cbl
  4008             88  SKIP-SEPTEMBER               VALUE '3'.
  4009             88  SKIP-JULY-AUG                VALUE '4'.
  4010             88  SKIP-AUG-SEPT                VALUE '5'.
  4011             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4012             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4013             88  SKIP-JUNE                    VALUE '8'.
  4014             88  SKIP-JUNE-JULY               VALUE '9'.
  4015             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4016             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4017         16  CM-PAYMENT-MODE               PIC X.
  4018             88  PAY-MONTHLY                  VALUE SPACE.
  4019             88  PAY-WEEKLY                   VALUE '1'.
  4020             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4021             88  PAY-BI-WEEKLY                VALUE '3'.
  4022             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4023         16  CM-LOAN-NUMBER                PIC X(8).
  4024         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4025         16  CM-OLD-LOF                    PIC XXX.
  4026*        16  CM-LOAN-OFFICER               PIC XXX.
  4027         16  CM-REIN-TABLE                 PIC XXX.
  4028         16  CM-SPECIAL-REIN-CODE          PIC X.
  4029         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4030         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4031         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4032
  4033     12  CM-STATUS-DATA.
  4034         16  CM-ENTRY-STATUS               PIC X.
  4035         16  CM-ENTRY-DT                   PIC XX.
  4036
  4037         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4038         16  CM-LF-CANCEL-DT               PIC XX.
  4039         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4040
  4041         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4042         16  CM-LF-DEATH-DT                PIC XX.
  4043         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4044
  4045         16  CM-LF-CURRENT-STATUS          PIC X.
  4046             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4047                                                'M' '4' '5' '9'.
  4048             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4049             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4050             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4051             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4052             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4053             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4054             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4055             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4056             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4057             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4058             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4059             88  CM-LF-DECLINED               VALUE 'D'.
  4060             88  CM-LF-VOIDED                 VALUE 'V'.
  4061
  4062         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4063         16  CM-AH-CANCEL-DT               PIC XX.
  4064         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4065
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  75
* EL131.cbl
  4066         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4067         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4068         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4069
  4070         16  CM-AH-CURRENT-STATUS          PIC X.
  4071             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4072                                                'M' '4' '5' '9'.
  4073             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4074             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4075             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4076             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4077             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4078             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4079             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4080             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4081             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4082             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4083             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4084             88  CM-AH-DECLINED               VALUE 'D'.
  4085             88  CM-AH-VOIDED                 VALUE 'V'.
  4086
  4087         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4088             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4089             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4090             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4091         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4092
  4093         16  CM-ENTRY-BATCH                PIC X(6).
  4094         16  CM-LF-EXIT-BATCH              PIC X(6).
  4095         16  CM-AH-EXIT-BATCH              PIC X(6).
  4096         16  CM-LAST-MONTH-END             PIC XX.
  4097
  4098     12  CM-NOTE-SW                        PIC X.
  4099         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4100         88  CERT-NOTES-PRESENT               VALUE '1'.
  4101         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4102         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4103         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4104         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4105         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4106         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4107     12  CM-COMP-EXCP-SW                   PIC X.
  4108         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4109         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4110     12  CM-INSURED-ADDRESS-SW             PIC X.
  4111         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4112         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4113
  4114*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4115     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4116     12  FILLER                            PIC X.
  4117
  4118*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4119     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4120     12  FILLER                            PIC X.
  4121*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4122     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4123
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  76
* EL131.cbl
  4124     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4125         88  CERT-ADDED-BATCH                 VALUE ' '.
  4126         88  CERT-ADDED-ONLINE                VALUE '1'.
  4127         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4128         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4129         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4130     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4131         88  CERT-AS-LOADED                   VALUE ' '.
  4132         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4133         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4134         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4135         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4136         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4137         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4138         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4139
  4140     12  CM-ACCOUNT-COMM-PCTS.
  4141         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4142         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4143
  4144     12  CM-USER-FIELD                     PIC X.
  4145     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4146     12  CM-CLP-STATE                      PIC XX.
  4147     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4148     12  CM-USER-RESERVED                  PIC XXX.
  4149     12  FILLER REDEFINES CM-USER-RESERVED.
  4150         16  CM-AH-CLASS-CD                PIC XX.
  4151         16  F                             PIC X.
  4152******************************************************************
  4153
  4154*                                COPY ELCTRLR.
  4155******************************************************************
  4156*                                                                *
  4157*                            ELCTRLR.                            *
  4158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4159*                            VMOD=2.014                          *
  4160*                                                                *
  4161*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4162*                                                                *
  4163*   FILE TYPE = VSAM,KSDS                                        *
  4164*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4165*                                                                *
  4166*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4167*       ALTERNATE INDEX = NONE                                   *
  4168*                                                                *
  4169*   LOG = YES                                                    *
  4170*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4171******************************************************************
  4172*                   C H A N G E   L O G
  4173*
  4174* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4175*-----------------------------------------------------------------
  4176*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4177* EFFECTIVE    NUMBER
  4178*-----------------------------------------------------------------
  4179* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4180* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4181* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  77
* EL131.cbl
  4182* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4183* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4184* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4185* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4186* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4187* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4188* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4189* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4190* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4191* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4192* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4193* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4194* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4195* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4196* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4197* 040814    2014030500002  AJRA  ADD ICD CODES
  4198* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4199******************************************************************
  4200 01  ACTIVITY-TRAILERS.
  4201     12  AT-RECORD-ID                    PIC XX.
  4202         88  VALID-AT-ID                       VALUE 'AT'.
  4203
  4204     12  AT-CONTROL-PRIMARY.
  4205         16  AT-COMPANY-CD               PIC X.
  4206         16  AT-CARRIER                  PIC X.
  4207         16  AT-CLAIM-NO                 PIC X(7).
  4208         16  AT-CERT-NO.
  4209             20  AT-CERT-PRIME           PIC X(10).
  4210             20  AT-CERT-SFX             PIC X.
  4211         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4212             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4213             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4214             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4215             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4216             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4217             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4218             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4219             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4220             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4221             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4222             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4223             88  AT-BENEFICIARY-TRL           VALUE +91.
  4224             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4225             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4226             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4227             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4228
  4229     12  AT-TRAILER-TYPE                 PIC X.
  4230         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4231         88  PAYMENT-TR                       VALUE '2'.
  4232         88  AUTO-PAY-TR                      VALUE '3'.
  4233         88  CORRESPONDENCE-TR                VALUE '4'.
  4234         88  ADDRESS-TR                       VALUE '5'.
  4235         88  GENERAL-INFO-TR                  VALUE '6'.
  4236         88  AUTO-PROMPT-TR                   VALUE '7'.
  4237         88  DENIAL-TR                        VALUE '8'.
  4238         88  INCURRED-CHG-TR                  VALUE '9'.
  4239         88  FORM-CONTROL-TR                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  78
* EL131.cbl
  4240
  4241     12  AT-RECORDED-DT                  PIC XX.
  4242     12  AT-RECORDED-BY                  PIC X(4).
  4243     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4244
  4245     12  AT-TRAILER-BODY                 PIC X(165).
  4246
  4247     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4248         16  AT-RESERVE-CONTROLS.
  4249             20  AT-MANUAL-SW            PIC X.
  4250                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4251             20  AT-FUTURE-SW            PIC X.
  4252                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4253             20  AT-PTC-SW               PIC X.
  4254                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4255             20  AT-IBNR-SW              PIC X.
  4256                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4257             20  AT-PTC-LF-SW            PIC X.
  4258                 88  AT-LF-PTC-USED          VALUE '1'.
  4259             20  AT-CDT-ACCESS-METHOD    PIC X.
  4260                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4261                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4262                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4263             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4264         16  AT-LAST-COMPUTED-DT         PIC XX.
  4265         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4266         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4267         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4268         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4269         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4270         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4271         16  AT-EXPENSE-CONTROLS.
  4272             20  AT-EXPENSE-METHOD       PIC X.
  4273                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4274                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4275                 88  PERCENT-OF-PMT           VALUE '3'.
  4276                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4277             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4278             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4279         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4280         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4281
  4282         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4283         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4284
  4285*        16  FILLER                      PIC X(53).
  4286         16  FILLER                      PIC X(47).
  4287
  4288         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4289         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4290
  4291         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4292             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4293             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4294*                    C = CLOSED
  4295*                    O = OPEN
  4296             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4297*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  79
* EL131.cbl
  4298
  4299     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4300         16  AT-PAYMENT-TYPE             PIC X.
  4301             88  PARTIAL-PAYMENT                VALUE '1'.
  4302             88  FINAL-PAYMENT                  VALUE '2'.
  4303             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4304             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4305             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4306             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4307             88  VOIDED-PAYMENT                 VALUE '9'.
  4308             88  TRANSFER                       VALUE 'T'.
  4309             88  LIFE-INTEREST                  VALUE 'I'.
  4310
  4311         16  AT-CLAIM-TYPE               PIC X.
  4312             88  PAID-FOR-AH                    VALUE 'A'.
  4313             88  PAID-FOR-LIFE                  VALUE 'L'.
  4314             88  PAID-FOR-IUI                   VALUE 'I'.
  4315             88  PAID-FOR-GAP                   VALUE 'G'.
  4316             88  PAID-FOR-FAM                   VALUE 'F'.
  4317         16  AT-CLAIM-PREM-TYPE          PIC X.
  4318             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4319             88  AT-O-B-COVERAGE                VALUE '2'.
  4320             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4321         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4322         16  AT-CHECK-NO                 PIC X(7).
  4323         16  AT-PAID-FROM-DT             PIC XX.
  4324         16  AT-PAID-THRU-DT             PIC XX.
  4325         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4326         16  FILLER                      PIC X.
  4327         16  AT-PAYEES-NAME              PIC X(30).
  4328         16  AT-PAYMENT-ORIGIN           PIC X.
  4329             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4330             88  ONLINE-AUTO-PMT                VALUE '2'.
  4331             88  OFFLINE-PMT                    VALUE '3'.
  4332         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4333         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4334         16  AT-VOID-DATA.
  4335             20  AT-VOID-DT              PIC XX.
  4336*00144       20  AT-VOID-REASON          PIC X(30).
  4337             20  AT-VOID-REASON          PIC X(26).
  4338         16  AT-PMT-APPROVED-BY          PIC X(04).
  4339         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4340         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4341         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4342                                         PIC S99V9(5)  COMP-3.
  4343         16  AT-CREDIT-INTERFACE.
  4344             20  AT-PMT-SELECT-DT        PIC XX.
  4345                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4346             20  AT-PMT-ACCEPT-DT        PIC XX.
  4347                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4348             20  AT-VOID-SELECT-DT       PIC XX.
  4349                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4350             20  AT-VOID-ACCEPT-DT       PIC XX.
  4351                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4352
  4353         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4354                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4355                 88  CONVERSION-PAYMENT           VALUE +99999999.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  80
* EL131.cbl
  4356         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4357
  4358         16  AT-FORCE-CONTROL            PIC X.
  4359             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4360         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4361         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4362         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4363         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4364         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4365         16  AT-BENEFIT-TYPE             PIC X.
  4366
  4367         16  AT-EXPENSE-TYPE             PIC X.
  4368         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4369
  4370         16  AT-PAYEE-TYPE-CD.
  4371             20  AT-PAYEE-TYPE           PIC X.
  4372                 88  INSURED-PAID           VALUE 'I'.
  4373                 88  BENEFICIARY-PAID       VALUE 'B'.
  4374                 88  ACCOUNT-PAID           VALUE 'A'.
  4375                 88  OTHER-1-PAID           VALUE 'O'.
  4376                 88  OTHER-2-PAID           VALUE 'Q'.
  4377                 88  DOCTOR-PAID            VALUE 'P'.
  4378                 88  EMPLOYER-PAID          VALUE 'E'.
  4379             20  AT-PAYEE-SEQ            PIC X.
  4380
  4381         16  AT-CASH-PAYMENT             PIC X.
  4382         16  AT-GROUPED-PAYMENT          PIC X.
  4383         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4384         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4385         16  AT-APPROVED-LEVEL           PIC X.
  4386         16  AT-VOID-TYPE                PIC X.
  4387             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4388             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4389         16  AT-AIG-UNEMP-IND            PIC X.
  4390             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4391         16  AT-ASSOCIATES               PIC X.
  4392             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4393             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4394
  4395         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4396         16  AT-CV-PMT-CODE              PIC X.
  4397             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4398             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4399             88  FULL-ADD-PAYMENT           VALUE '3'.
  4400             88  HALF-ADD-PAYMENT           VALUE '4'.
  4401             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4402             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4403             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4404             88  ADDL-PAYMENT               VALUE '8'.
  4405
  4406         16  AT-EOB-CODE1                PIC XXX.
  4407         16  AT-EOB-CODE2                PIC XXX.
  4408         16  AT-EOB-CODE3                PIC XXX.
  4409         16  FILLER REDEFINES AT-EOB-CODE3.
  4410             20  AT-PRINT-CLM-FORM       PIC X.
  4411             20  AT-PRINT-SURVEY         PIC X.
  4412             20  AT-SPECIAL-RELEASE      PIC X.
  4413         16  AT-EOB-CODE4                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  81
* EL131.cbl
  4414         16  FILLER REDEFINES AT-EOB-CODE4.
  4415             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4416             20  FILLER                  PIC X.
  4417         16  AT-EOB-CODE5                PIC XXX.
  4418         16  FILLER REDEFINES AT-EOB-CODE5.
  4419             20  AT-PMT-PROOF-DT         PIC XX.
  4420             20  FILLER                  PIC X.
  4421
  4422         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4423             88  AT-PRINT-EOB            VALUE 'Y'.
  4424
  4425         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4426         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4427
  4428     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4429         16  AT-SCHEDULE-START-DT        PIC XX.
  4430         16  AT-SCHEDULE-END-DT          PIC XX.
  4431         16  AT-TERMINATED-DT            PIC XX.
  4432         16  AT-LAST-PMT-TYPE            PIC X.
  4433             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4434             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4435         16  AT-FIRST-PMT-DATA.
  4436             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4437             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4438             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4439         16  AT-REGULAR-PMT-DATA.
  4440             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4441             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4442             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4443         16  AT-AUTO-PAYEE-CD.
  4444             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4445                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4446                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4447                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4448                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4449                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4450             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4451         16  AT-AUTO-PAY-DAY             PIC 99.
  4452         16  AT-AUTO-CASH                PIC X.
  4453             88  AT-CASH                      VALUE 'Y'.
  4454             88  AT-NON-CASH                  VALUE 'N'.
  4455*        16  FILLER                      PIC X(129).
  4456         16  AT-AUTO-END-LETTER          PIC X(4).
  4457         16  FILLER                      PIC X(125).
  4458
  4459         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4460         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4461
  4462     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4463         16  AT-LETTER-SENT-DT           PIC XX.
  4464         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4465         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4466         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4467         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4468         16  AT-LETTER-ORIGIN            PIC X.
  4469             88  ONLINE-CREATION              VALUE '1' '3'.
  4470             88  OFFLINE-CREATION             VALUE '2' '4'.
  4471             88  NAPER-ONLINE-CREATION        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  82
* EL131.cbl
  4472             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4473         16  AT-STD-LETTER-FORM          PIC X(4).
  4474         16  AT-REASON-TEXT              PIC X(70).
  4475         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4476         16  AT-ADDRESEE-TYPE            PIC X.
  4477              88  INSURED-ADDRESEE            VALUE 'I'.
  4478              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4479              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4480              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4481              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4482              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4483              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4484         16  AT-ADDRESSEE-NAME           PIC X(30).
  4485         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4486         16  AT-RESEND-PRINT-DATE        PIC XX.
  4487         16  AT-CORR-SOL-UNSOL           PIC X.
  4488         16  AT-LETTER-PURGED-DT         PIC XX.
  4489*
  4490*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4491*
  4492         16  AT-CSO-REDEFINITION.
  4493             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4494             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4495             20  AT-LETTER-TO-BENE       PIC X(1).
  4496             20  AT-STOP-LETTER-DT       PIC X(2).
  4497             20  FILLER                  PIC X(19).
  4498*             20  FILLER                  PIC X(27).
  4499             20  AT-CSO-LETTER-STATUS    PIC X.
  4500                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4501                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4502                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4503             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4504             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4505*
  4506*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4507*
  4508*        16  FILLER                      PIC X(26).
  4509*
  4510*        16  AT-DMD-BSR-CODE             PIC X.
  4511*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4512*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4513*
  4514*        16  AT-DMD-LETTER-STATUS        PIC X.
  4515*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4516*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4517*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4518*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4519*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4520
  4521         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4522         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4523
  4524     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4525         16  AT-ADDRESS-TYPE             PIC X.
  4526             88  INSURED-ADDRESS               VALUE 'I'.
  4527             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4528             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4529             88  PHYSICIAN-ADDRESS             VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  83
* EL131.cbl
  4530             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4531             88  OTHER-ADDRESS-1               VALUE 'O'.
  4532             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4533         16  AT-MAIL-TO-NAME             PIC X(30).
  4534         16  AT-ADDRESS-LINE-1           PIC X(30).
  4535         16  AT-ADDRESS-LINE-2           PIC X(30).
  4536         16  AT-CITY-STATE.
  4537             20  AT-CITY                 PIC X(28).
  4538             20  AT-STATE                PIC XX.
  4539         16  AT-ZIP.
  4540             20  AT-ZIP-CODE.
  4541                 24  AT-ZIP-1ST          PIC X.
  4542                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4543                 24  FILLER              PIC X(4).
  4544             20  AT-ZIP-PLUS4            PIC X(4).
  4545         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4546             20  AT-CAN-POSTAL-1         PIC XXX.
  4547             20  AT-CAN-POSTAL-2         PIC XXX.
  4548             20  FILLER                  PIC XXX.
  4549         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4550*         16  FILLER                      PIC X(23).
  4551         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4552         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4553         16  FILLER                      PIC X(13).
  4554         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4555         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4556
  4557     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4558         16  AT-INFO-LINE-1              PIC X(60).
  4559         16  FILLER REDEFINES AT-INFO-LINE-1.
  4560             20  AT-NOTE-ERROR-NO OCCURS 15
  4561                                         PIC X(4).
  4562         16  AT-INFO-LINE-2              PIC X(60).
  4563         16  FILLER REDEFINES AT-INFO-LINE-2.
  4564             20  AT-ICD-CODE-1           PIC X(8).
  4565             20  AT-ICD-CODE-2           PIC X(8).
  4566             20  FILLER                  PIC X(44).
  4567         16  AT-INFO-TRAILER-TYPE        PIC X.
  4568             88  AT-ERRORS-NOTE          VALUE 'E'.
  4569             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4570             88  AT-CALL-NOTE            VALUE 'C'.
  4571             88  AT-MAINT-NOTE           VALUE 'M'.
  4572             88  AT-CERT-CHANGE          VALUE 'X'.
  4573             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4574             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4575             88  AT-CERT-CANCELLED       VALUE 'T'.
  4576         16  AT-CALL-TYPE                PIC X.
  4577             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4578             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4579         16  AT-NOTE-CONTINUATION        PIC X.
  4580             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4581         16  AT-EOB-CODES-EXIST          PIC X.
  4582             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4583         16  FILLER                      PIC X(35).
  4584         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4585         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4586
  4587     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  84
* EL131.cbl
  4588         16  AT-PROMPT-LINE-1            PIC X(60).
  4589         16  AT-PROMPT-LINE-2            PIC X(60).
  4590         16  AT-PROMPT-START-DT          PIC XX.
  4591         16  AT-PROMPT-END-DT            PIC XX.
  4592         16  FILLER                      PIC X(35).
  4593         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4594         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4595
  4596     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4597         16  AT-DENIAL-INFO-1            PIC X(60).
  4598         16  AT-DENIAL-INFO-2            PIC X(60).
  4599         16  AT-DENIAL-DT                PIC XX.
  4600         16  AT-RETRACTION-DT            PIC XX.
  4601         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4602*         16  FILLER                      PIC X(31).
  4603         16  AT-DENIAL-PROOF-DT          PIC XX.
  4604         16  FILLER                      PIC X(29).
  4605         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4606         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4607
  4608     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4609         16  AT-OLD-INCURRED-DT          PIC XX.
  4610         16  AT-OLD-REPORTED-DT          PIC XX.
  4611         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4612         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4613         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4614         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4615         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4616         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4617         16  FILLER                      PIC X(26).
  4618         16  AT-OLD-DIAG-CODE            PIC X(6).
  4619         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4620         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4621         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4622         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4623         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4624         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4625         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4626         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4627         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4628         16  FILLER                      PIC X(9).
  4629         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4630
  4631     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4632         16  AT-FORM-SEND-ON-DT          PIC XX.
  4633         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4634         16  AT-FORM-RE-SEND-DT          PIC XX.
  4635         16  AT-FORM-ANSWERED-DT         PIC XX.
  4636         16  AT-FORM-PRINTED-DT          PIC XX.
  4637         16  AT-FORM-REPRINT-DT          PIC XX.
  4638         16  AT-FORM-TYPE                PIC X.
  4639             88  INITIAL-FORM                  VALUE '1'.
  4640             88  PROGRESS-FORM                 VALUE '2'.
  4641         16  AT-INSTRUCT-LN-1            PIC X(28).
  4642         16  AT-INSTRUCT-LN-2            PIC X(28).
  4643         16  AT-INSTRUCT-LN-3            PIC X(28).
  4644         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4645         16  AT-FORM-ADDRESS             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  85
* EL131.cbl
  4646             88  FORM-TO-INSURED              VALUE 'I'.
  4647             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4648             88  FORM-TO-OTHER-1              VALUE 'O'.
  4649             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4650         16  AT-RELATED-1.
  4651             20 AT-REL-CARR-1            PIC X.
  4652             20 AT-REL-CLAIM-1           PIC X(7).
  4653             20 AT-REL-CERT-1            PIC X(11).
  4654         16  AT-RELATED-2.
  4655             20 AT-REL-CARR-2            PIC X.
  4656             20 AT-REL-CLAIM-2           PIC X(7).
  4657             20 AT-REL-CERT-2            PIC X(11).
  4658         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4659         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4660         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4661         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4662         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4663         16  AT-STOP-FORM-DT             PIC X(2).
  4664
  4665         16  FILLER                      PIC X(09).
  4666         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4667         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4668******************************************************************
  4669
  4670*                                COPY ELCCNTL.
  4671******************************************************************
  4672*                                                                *
  4673*                                                                *
  4674*                            ELCCNTL.                            *
  4675*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4676*                            VMOD=2.059                          *
  4677*                                                                *
  4678*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4679*                                                                *
  4680*   FILE TYPE = VSAM,KSDS                                        *
  4681*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4682*                                                                *
  4683*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4684*       ALTERNATE INDEX = NONE                                   *
  4685*                                                                *
  4686*   LOG = YES                                                    *
  4687*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4688******************************************************************
  4689*                   C H A N G E   L O G
  4690*
  4691* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4692*-----------------------------------------------------------------
  4693*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4694* EFFECTIVE    NUMBER
  4695*-----------------------------------------------------------------
  4696* 082503                   PEMA  ADD BENEFIT GROUP
  4697* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4698* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4699* 092705    2005050300006  PEMA  ADD SPP LEASES
  4700* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4701* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4702* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4703* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  86
* EL131.cbl
  4704* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4705* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4706* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4707* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4708* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4709* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4710******************************************************************
  4711*
  4712 01  CONTROL-FILE.
  4713     12  CF-RECORD-ID                       PIC XX.
  4714         88  VALID-CF-ID                        VALUE 'CF'.
  4715
  4716     12  CF-CONTROL-PRIMARY.
  4717         16  CF-COMPANY-ID                  PIC XXX.
  4718         16  CF-RECORD-TYPE                 PIC X.
  4719             88  CF-COMPANY-MASTER              VALUE '1'.
  4720             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4721             88  CF-STATE-MASTER                VALUE '3'.
  4722             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4723             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4724             88  CF-CARRIER-MASTER              VALUE '6'.
  4725             88  CF-MORTALITY-MASTER            VALUE '7'.
  4726             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4727             88  CF-TERMINAL-MASTER             VALUE '9'.
  4728             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4729             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4730             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4731             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4732             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4733             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4734             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4735             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4736             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4737         16  CF-ACCESS-CD-GENL              PIC X(4).
  4738         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4739             20  CF-PROCESSOR               PIC X(4).
  4740         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4741             20  CF-STATE-CODE              PIC XX.
  4742             20  FILLER                     PIC XX.
  4743         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4744             20  FILLER                     PIC XX.
  4745             20  CF-HI-BEN-IN-REC           PIC XX.
  4746         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4747             20  FILLER                     PIC XXX.
  4748             20  CF-CARRIER-CNTL            PIC X.
  4749         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4750             20  FILLER                     PIC XX.
  4751             20  CF-HI-TYPE-IN-REC          PIC 99.
  4752         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4753             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4754                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4755             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4756             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4757         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4758             20  FILLER                     PIC X.
  4759             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4760         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4761             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  87
* EL131.cbl
  4762             20  CF-MORTGAGE-PLAN           PIC XX.
  4763         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4764
  4765     12  CF-LAST-MAINT-DT                   PIC XX.
  4766     12  CF-LAST-MAINT-BY                   PIC X(4).
  4767     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4768
  4769     12  CF-RECORD-BODY                     PIC X(728).
  4770
  4771
  4772****************************************************************
  4773*             COMPANY MASTER RECORD                            *
  4774****************************************************************
  4775
  4776     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4777         16  CF-COMPANY-ADDRESS.
  4778             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4779             20  CF-CL-IN-CARE-OF           PIC X(30).
  4780             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4781             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4782             20  CF-CL-CITY-STATE           PIC X(30).
  4783             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4784             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4785         16  CF-COMPANY-CD                  PIC X.
  4786         16  CF-COMPANY-PASSWORD            PIC X(8).
  4787         16  CF-SECURITY-OPTION             PIC X.
  4788             88  ALL-SECURITY                   VALUE '1'.
  4789             88  COMPANY-VERIFY                 VALUE '2'.
  4790             88  PROCESSOR-VERIFY               VALUE '3'.
  4791             88  NO-SECURITY                    VALUE '4'.
  4792             88  ALL-BUT-TERM                   VALUE '5'.
  4793         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4794             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4795         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4796             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4797         16  CF-INFORCE-LOCATION            PIC X.
  4798             88  CERTS-ARE-ONLINE               VALUE '1'.
  4799             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4800             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4801         16  CF-LOWER-CASE-LETTERS          PIC X.
  4802         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4803             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4804             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4805             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4806             88  CF-ACCNT-CNTL                  VALUE '3'.
  4807             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4808
  4809         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4810         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4811
  4812         16  CF-LGX-CREDIT-USER             PIC X.
  4813             88  CO-IS-NOT-USER                 VALUE 'N'.
  4814             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4815
  4816         16 CF-CREDIT-CALC-CODES.
  4817             20  CF-CR-REM-TERM-CALC PIC X.
  4818               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4819               88  CR-EARN-ON-HALF-MO           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  88
* EL131.cbl
  4820               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4821               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4822               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4823               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4824               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4825             20  CF-CR-R78-METHOD           PIC X.
  4826               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4827               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4828
  4829         16  CF-CLAIM-CONTROL-COUNTS.
  4830             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4831                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4832
  4833             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4834                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4835
  4836             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4837                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4838
  4839             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4840                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4841
  4842         16  CF-CURRENT-MONTH-END           PIC XX.
  4843
  4844         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4845             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4846             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4847             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4848             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4849                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4850                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4851             20  CF-CO-PREM-REJECT-SW       PIC X.
  4852                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4853                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4854             20  CF-CO-REF-REJECT-SW        PIC X.
  4855                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4856                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4857
  4858         16  CF-CO-REPORTING-DT             PIC XX.
  4859         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4860         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4861           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4862           88  CF-CO-MONTH-END                  VALUE '1'.
  4863
  4864         16  CF-LGX-CLAIM-USER              PIC X.
  4865             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4866             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4867
  4868         16  CF-CREDIT-EDIT-CONTROLS.
  4869             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4870             20  CF-MIN-AGE                 PIC 99.
  4871             20  CF-DEFAULT-AGE             PIC 99.
  4872             20  CF-MIN-TERM                PIC S999      COMP-3.
  4873             20  CF-MAX-TERM                PIC S999      COMP-3.
  4874             20  CF-DEFAULT-SEX             PIC X.
  4875             20  CF-JOINT-AGE-INPUT         PIC X.
  4876                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4877             20  CF-BIRTH-DATE-INPUT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  89
* EL131.cbl
  4878                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4879             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4880                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4881                 88  CF-ZERO-CARRIER            VALUE '1'.
  4882                 88  CF-ZERO-GROUPING           VALUE '2'.
  4883                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4884             20  CF-EDIT-SW                 PIC X.
  4885                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4886             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4887             20  CF-CR-PR-METHOD            PIC X.
  4888               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4889               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4890             20  FILLER                     PIC X.
  4891
  4892         16  CF-CREDIT-MISC-CONTROLS.
  4893             20  CF-REIN-TABLE-SW           PIC X.
  4894                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4895             20  CF-COMP-TABLE-SW           PIC X.
  4896                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4897             20  CF-EXPERIENCE-RETENTION-AGE
  4898                                            PIC S9        COMP-3.
  4899             20  CF-CONVERSION-DT           PIC XX.
  4900             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4901             20  CF-RUN-FREQUENCY-SW        PIC X.
  4902                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4903                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4904
  4905             20  CF-CR-CHECK-NO-CONTROL.
  4906                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4907                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4908                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4909                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4910                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4911                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4912
  4913                 24  CF-CR-CHECK-COUNT       REDEFINES
  4914                     CF-CR-CHECK-COUNTER      PIC X(4).
  4915
  4916                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4917                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4918
  4919                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4920                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4921                 24  CF-MAIL-PROCESSING       PIC X.
  4922                     88  MAIL-PROCESSING          VALUE 'Y'.
  4923
  4924         16  CF-MISC-SYSTEM-CONTROL.
  4925             20  CF-SYSTEM-C                 PIC X.
  4926                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4927             20  CF-SYSTEM-D                 PIC X.
  4928                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4929             20  CF-SOC-SEC-NO-SW            PIC X.
  4930                 88  SOC-SEC-NO-USED             VALUE '1'.
  4931             20  CF-MEMBER-NO-SW             PIC X.
  4932                 88  MEMBER-NO-USED              VALUE '1'.
  4933             20  CF-TAX-ID-NUMBER            PIC X(11).
  4934             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4935             20  CF-PAYMENT-APPROVAL-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  90
* EL131.cbl
  4936                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4937                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4938                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4939                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4940             20  CF-SYSTEM-E                 PIC X.
  4941                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4942
  4943         16  CF-LGX-LIFE-USER               PIC X.
  4944             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4945             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4946
  4947         16  CF-CR-MONTH-END-DT             PIC XX.
  4948
  4949         16  CF-FILE-MAINT-DATES.
  4950             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4951                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4952             20  CF-LAST-BATCH       REDEFINES
  4953                 CF-LAST-BATCH-NO               PIC X(4).
  4954             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4955             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4956             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4957             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4958             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4959             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4960             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4961             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4962             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4963             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4964
  4965         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4966         16  FILLER                         PIC X.
  4967
  4968         16  CF-ALT-MORT-CODE               PIC X(4).
  4969         16  CF-MEMBER-CAPTION              PIC X(10).
  4970
  4971         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4972             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4973             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4974             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4975             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4976             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4977
  4978         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4979
  4980         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4981         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4982         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4983         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4984
  4985         16  CF-AH-OVERRIDE-L1              PIC X.
  4986         16  CF-AH-OVERRIDE-L2              PIC XX.
  4987         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4988         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4989
  4990         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4991         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4992
  4993         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  91
* EL131.cbl
  4994         16  CF-AR-LAST-EL860-DT            PIC XX.
  4995         16  CF-MP-MONTH-END-DT             PIC XX.
  4996
  4997         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4998         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4999             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5000
  5001         16  CF-AR-MONTH-END-DT             PIC XX.
  5002
  5003         16  CF-CRDTCRD-USER                PIC X.
  5004             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5005             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5006
  5007         16  CF-CC-MONTH-END-DT             PIC XX.
  5008
  5009         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5010
  5011         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5012             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5013             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5014             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5015         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5016         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5017         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5018         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5019             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5020             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5021         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5022         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5023         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5024             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5025         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5026
  5027         16  CF-CL-ZIP-CODE.
  5028             20  CF-CL-ZIP-PRIME.
  5029                 24  CF-CL-ZIP-1ST          PIC X.
  5030                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5031                 24  FILLER                 PIC X(4).
  5032             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5033         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5034             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5035             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5036             20  FILLER                     PIC XXX.
  5037
  5038         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5039         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5040         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5041         16  CF-CO-OPTION-START-DATE        PIC XX.
  5042         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5043           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5044                                                      '3' '4'.
  5045           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5046           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5047           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5048           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5049           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5050           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5051
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  92
* EL131.cbl
  5052         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5053
  5054         16  CF-PAYMENT-APPROVAL-LEVELS.
  5055             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5056             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5057             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5058             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5059             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5060             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5061
  5062         16  CF-END-USER-REPORTING-USER     PIC X.
  5063             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5064             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5065
  5066         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5067             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5068             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5069
  5070         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5071
  5072         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5073         16  FILLER                         PIC X.
  5074
  5075         16  CF-CREDIT-ARCHIVE-CNTL.
  5076             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5077             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5078             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5079
  5080         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5081
  5082         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5083             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5084             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5085
  5086         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5087             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5088             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5089
  5090         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5091
  5092         16  CF-CO-ACH-ID-CODE              PIC  X.
  5093             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5094             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5095             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5096         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5097         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5098         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5099         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5100         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5101         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5102         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5103         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5104         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5105                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5106         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5107                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5108
  5109         16  CF-CO-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  93
* EL131.cbl
  5110             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5111             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5112
  5113*         16  FILLER                         PIC X(102).
  5114         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5115             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5116             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5117
  5118         16  CF-AH-APPROVAL-DAYS.
  5119             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5120             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5121             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5122             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5123
  5124         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5125
  5126         16  CF-APPROV-LEV-5.
  5127             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5128             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5129             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5130
  5131         16  FILLER                         PIC X(68).
  5132****************************************************************
  5133*             PROCESSOR/USER RECORD                            *
  5134****************************************************************
  5135
  5136     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5137         16  CF-PROCESSOR-NAME              PIC X(30).
  5138         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5139         16  CF-PROCESSOR-TITLE             PIC X(26).
  5140         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5141                 88  MESSAGE-YES                VALUE 'Y'.
  5142                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5143
  5144*****************************************************
  5145****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5146****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5147****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5148****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5149*****************************************************
  5150
  5151         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5152             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5153             20  CF-APPLICATION-FORCE       PIC X.
  5154             20  CF-INDIVIDUAL-APP.
  5155                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5156                     28  CF-BROWSE-APP      PIC X.
  5157                     28  CF-UPDATE-APP      PIC X.
  5158
  5159         16  CF-CURRENT-TERM-ON             PIC X(4).
  5160         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5161             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5162             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5163             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5164             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5165             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5166             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5167             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  94
* EL131.cbl
  5168         16  CF-PROCESSOR-CARRIER           PIC X.
  5169             88  NO-CARRIER-SECURITY            VALUE ' '.
  5170         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5171             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5172         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5173             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5174         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5175             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5176
  5177         16  CF-PROC-SYS-ACCESS-SW.
  5178             20  CF-PROC-CREDIT-CLAIMS-SW.
  5179                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5180                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5181                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5182                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5183             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5184                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5185                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5186             20  CF-PROC-LIFE-GNRLDGR-SW.
  5187                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5188                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5189                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5190                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5191             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5192                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5193                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5194         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5195             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5196             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5197         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5198
  5199         16  CF-APPROVAL-LEVEL                  PIC X.
  5200             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5201             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5202             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5203             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5204             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5205
  5206         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5207
  5208         16  CF-LANGUAGE-TYPE                   PIC X.
  5209             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5210             88  CF-LANG-IS-FR                      VALUE 'F'.
  5211
  5212         16  CF-CSR-IND                         PIC X.
  5213         16  FILLER                             PIC X(239).
  5214
  5215****************************************************************
  5216*             PROCESSOR/REMINDERS RECORD                       *
  5217****************************************************************
  5218
  5219     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5220         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5221             20  CF-START-REMIND-DT         PIC XX.
  5222             20  CF-END-REMIND-DT           PIC XX.
  5223             20  CF-REMINDER-TEXT           PIC X(50).
  5224         16  FILLER                         PIC X(296).
  5225
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  95
* EL131.cbl
  5226
  5227****************************************************************
  5228*             STATE MASTER RECORD                              *
  5229****************************************************************
  5230
  5231     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5232         16  CF-STATE-ABBREVIATION          PIC XX.
  5233         16  CF-STATE-NAME                  PIC X(25).
  5234         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5235         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5236             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5237             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5238             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5239             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5240                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5241                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5242             20  CF-ST-PREM-REJECT-SW       PIC X.
  5243                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5244                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5245             20  CF-ST-REF-REJECT-SW        PIC X.
  5246                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5247                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5248         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5249         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5250         16  CF-ST-REFUND-RULES.
  5251             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5252             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5253             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5254         16  CF-ST-FST-PMT-EXTENSION.
  5255             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5256             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5257                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5258                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5259                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5260                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5261         16  CF-ST-STATE-CALL.
  5262             20  CF-ST-CALL-UNEARNED        PIC X.
  5263             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5264             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5265         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5266             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5267             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5268         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5269         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5270         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5271         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5272         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5273         16  FILLER                         PIC X.
  5274         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5275             20  CF-ST-BENEFIT-CD           PIC XX.
  5276             20  CF-ST-BENEFIT-KIND         PIC X.
  5277                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5278                 88  CF-ST-AH-KIND              VALUE 'A'.
  5279             20  CF-ST-REM-TERM-CALC        PIC X.
  5280                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5281                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5282                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5283                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  96
* EL131.cbl
  5284                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5285                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5286                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5287                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5288
  5289             20  CF-ST-REFUND-CALC          PIC X.
  5290                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5291                 88  ST-REFD-BY-R78             VALUE '1'.
  5292                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5293                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5294                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5295                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5296                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5297                 88  ST-REFD-UTAH               VALUE '7'.
  5298                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5299                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5300                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5301
  5302             20  CF-ST-EARNING-CALC         PIC X.
  5303                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5304                 88  ST-EARN-BY-R78             VALUE '1'.
  5305                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5306                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5307                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5308                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5309                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5310                 88  ST-EARN-MEAN               VALUE '8'.
  5311                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5312
  5313             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5314                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5315                 88  ST-OVRD-BY-R78             VALUE '1'.
  5316                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5317                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5318                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5319                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5320                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5321                 88  ST-OVRD-MEAN               VALUE '8'.
  5322                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5323             20  FILLER                     PIC X.
  5324
  5325         16  CF-ST-COMMISSION-CAPS.
  5326             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5327             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5328             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5329             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5330         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5331                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5332
  5333         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5334
  5335         16  CF-ST-STATUTORY-INTEREST.
  5336             20  CF-ST-STAT-DATE-FROM       PIC X.
  5337                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5338                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5339             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5340             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5341             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  97
* EL131.cbl
  5342             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5343             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5344
  5345         16  CF-ST-OVER-SHORT.
  5346             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5347             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5348
  5349         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5350
  5351         16  CF-ST-RT-CALC                  PIC X.
  5352
  5353         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5354         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5355         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5356         16  CF-ST-RF-LR-CALC               PIC X.
  5357         16  CF-ST-RF-LL-CALC               PIC X.
  5358         16  CF-ST-RF-LN-CALC               PIC X.
  5359         16  CF-ST-RF-AH-CALC               PIC X.
  5360         16  CF-ST-RF-CP-CALC               PIC X.
  5361*        16  FILLER                         PIC X(206).
  5362*CIDMOD         16  FILLER                         PIC X(192).
  5363         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5364             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5365         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5366         16  CF-ST-VFY-2ND-BENE             PIC X.
  5367         16  CF-ST-CAUSAL-STATE             PIC X.
  5368         16  FILLER                         PIC X(185).
  5369
  5370****************************************************************
  5371*             BENEFIT MASTER RECORD                            *
  5372****************************************************************
  5373
  5374     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5375         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5376             20  CF-BENEFIT-CODE            PIC XX.
  5377             20  CF-BENEFIT-NUMERIC  REDEFINES
  5378                 CF-BENEFIT-CODE            PIC XX.
  5379             20  CF-BENEFIT-ALPHA           PIC XXX.
  5380             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5381             20  CF-BENEFIT-COMMENT         PIC X(10).
  5382
  5383             20  CF-LF-COVERAGE-TYPE        PIC X.
  5384                 88  CF-REDUCING                VALUE 'R'.
  5385                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5386
  5387             20  CF-SPECIAL-CALC-CD         PIC X.
  5388                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5389                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5390                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5391                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5392                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5393                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5394                 88  CF-FARM-PLAN               VALUE 'F'.
  5395                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5396                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5397                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5398                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5399                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  98
* EL131.cbl
  5400                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5401                 88  CF-PRUDENTIAL              VALUE 'P'.
  5402                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5403                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5404                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5405                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5406                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5407                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5408
  5409             20  CF-JOINT-INDICATOR         PIC X.
  5410                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5411
  5412*            20  FILLER                     PIC X(12).
  5413             20  cf-maximum-benefits        pic s999 comp-3.
  5414             20  FILLER                     PIC X(09).
  5415             20  CF-BENEFIT-CATEGORY        PIC X.
  5416             20  CF-LOAN-TYPE               PIC X(8).
  5417
  5418             20  CF-CO-REM-TERM-CALC        PIC X.
  5419                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5420                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5421                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5422                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5423                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5424
  5425             20  CF-CO-EARNINGS-CALC        PIC X.
  5426                 88  CO-EARN-BY-R78             VALUE '1'.
  5427                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5428                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5429                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5430                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5431                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5432                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5433                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5434
  5435             20  CF-CO-REFUND-CALC          PIC X.
  5436                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5437                 88  CO-REFD-BY-R78             VALUE '1'.
  5438                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5439                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5440                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5441                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5442                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5443                 88  CO-REFD-MEAN               VALUE '8'.
  5444                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5445                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5446                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5447
  5448             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5449                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5450                 88  CO-OVRD-BY-R78             VALUE '1'.
  5451                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5452                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5453                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5454                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5455                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5456                 88  CO-OVRD-MEAN               VALUE '8'.
  5457                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page  99
* EL131.cbl
  5458
  5459             20  CF-CO-BEN-I-G-CD           PIC X.
  5460                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5461                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5462                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5463
  5464         16  FILLER                         PIC X(304).
  5465
  5466
  5467****************************************************************
  5468*             CARRIER MASTER RECORD                            *
  5469****************************************************************
  5470
  5471     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5472         16  CF-ADDRESS-DATA.
  5473             20  CF-MAIL-TO-NAME            PIC X(30).
  5474             20  CF-IN-CARE-OF              PIC X(30).
  5475             20  CF-ADDRESS-LINE-1          PIC X(30).
  5476             20  CF-ADDRESS-LINE-2          PIC X(30).
  5477             20  CF-CITY-STATE              PIC X(30).
  5478             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5479             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5480
  5481         16  CF-CLAIM-NO-CONTROL.
  5482             20  CF-CLAIM-NO-METHOD         PIC X.
  5483                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5484                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5485                 88  CLAIM-NO-SEQ               VALUE '3'.
  5486                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5487             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5488                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5489                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5490                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5491
  5492         16  CF-CHECK-NO-CONTROL.
  5493             20  CF-CHECK-NO-METHOD         PIC X.
  5494                 88  CHECK-NO-MANUAL            VALUE '1'.
  5495                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5496                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5497                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5498             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5499                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5500
  5501         16  CF-DOMICILE-STATE              PIC XX.
  5502
  5503         16  CF-EXPENSE-CONTROLS.
  5504             20  CF-EXPENSE-METHOD          PIC X.
  5505                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5506                 88  DOLLARS-PER-PMT            VALUE '2'.
  5507                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5508                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5509             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5510             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5511
  5512         16  CF-CORRESPONDENCE-CONTROL.
  5513             20  CF-LETTER-RESEND-OPT       PIC X.
  5514                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5515                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 100
* EL131.cbl
  5516             20  FILLER                     PIC X(4).
  5517
  5518         16  CF-RESERVE-CONTROLS.
  5519             20  CF-MANUAL-SW               PIC X.
  5520                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5521             20  CF-FUTURE-SW               PIC X.
  5522                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5523             20  CF-PTC-SW                  PIC X.
  5524                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5525             20  CF-IBNR-SW                 PIC X.
  5526                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5527             20  CF-PTC-LF-SW               PIC X.
  5528                 88  CF-LF-PTC-USED             VALUE '1'.
  5529             20  CF-CDT-ACCESS-METHOD       PIC X.
  5530                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5531                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5532                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5533             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5534
  5535         16  CF-CLAIM-CALC-METHOD           PIC X.
  5536             88  360-PLUS-MONTHS                VALUE '1'.
  5537             88  365-PLUS-MONTHS                VALUE '2'.
  5538             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5539             88  360-DAILY                      VALUE '4'.
  5540             88  365-DAILY                      VALUE '5'.
  5541
  5542         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5543         16  FILLER                         PIC X(11).
  5544
  5545         16  CF-LIMIT-AMOUNTS.
  5546             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5547             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5548             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5549             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5550             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5551             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5552             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5553             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5554             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5555             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5556
  5557         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5558         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5559         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5560
  5561         16  CF-ZIP-CODE.
  5562             20  CF-ZIP-PRIME.
  5563                 24  CF-ZIP-1ST             PIC X.
  5564                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5565                 24  FILLER                 PIC X(4).
  5566             20  CF-ZIP-PLUS4               PIC X(4).
  5567         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5568             20  CF-CAN-POSTAL-1            PIC XXX.
  5569             20  CF-CAN-POSTAL-2            PIC XXX.
  5570             20  FILLER                     PIC XXX.
  5571
  5572         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5573         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 101
* EL131.cbl
  5574         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5575
  5576         16  CF-RATING-SWITCH               PIC X.
  5577             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5578             88  CF-NO-RATING                   VALUE 'N'.
  5579
  5580         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5581
  5582         16  CF-CARRIER-OVER-SHORT.
  5583             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5584             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5585
  5586         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5587         16  CF-SECPAY-SWITCH               PIC X.
  5588             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5589             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5590         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5591         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5592         16  FILLER                         PIC X(444).
  5593*        16  FILLER                         PIC X(452).
  5594
  5595
  5596****************************************************************
  5597*             MORTALITY MASTER RECORD                          *
  5598****************************************************************
  5599
  5600     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5601         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5602                                INDEXED BY CF-MORT-NDX.
  5603             20  CF-MORT-TABLE              PIC X(5).
  5604             20  CF-MORT-TABLE-TYPE         PIC X.
  5605                 88  CF-MORT-JOINT              VALUE 'J'.
  5606                 88  CF-MORT-SINGLE             VALUE 'S'.
  5607                 88  CF-MORT-COMBINED           VALUE 'C'.
  5608                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5609                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5610             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5611             20  CF-MORT-AGE-METHOD         PIC XX.
  5612                 88  CF-AGE-LAST                VALUE 'AL'.
  5613                 88  CF-AGE-NEAR                VALUE 'AN'.
  5614             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5615             20  CF-MORT-ADJUSTMENT-DIRECTION
  5616                                            PIC X.
  5617                 88  CF-MINUS                   VALUE '-'.
  5618                 88  CF-PLUS                    VALUE '+'.
  5619             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5620             20  CF-MORT-JOINT-CODE         PIC X.
  5621                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5622             20  CF-MORT-PC-Q               PIC X.
  5623                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5624             20  CF-MORT-TABLE-CODE         PIC X(4).
  5625             20  CF-MORT-COMMENTS           PIC X(15).
  5626             20  FILLER                     PIC X(14).
  5627
  5628         16  FILLER                         PIC X(251).
  5629
  5630
  5631****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 102
* EL131.cbl
  5632*             BUSSINESS TYPE MASTER RECORD                     *
  5633****************************************************************
  5634
  5635     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5636* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5637* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5638* AND RECORD 05 IS TYPES 81-99
  5639         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5640             20  CF-BUSINESS-TITLE          PIC  X(19).
  5641             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5642                                            PIC S9V9(4) COMP-3.
  5643             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5644             20  FILLER                     PIC  X.
  5645         16  FILLER                         PIC  X(248).
  5646
  5647
  5648****************************************************************
  5649*             TERMINAL MASTER RECORD                           *
  5650****************************************************************
  5651
  5652     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5653
  5654         16  CF-COMPANY-TERMINALS.
  5655             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5656                                  PIC X(4).
  5657         16  FILLER               PIC X(248).
  5658
  5659
  5660****************************************************************
  5661*             LIFE EDIT MASTER RECORD                          *
  5662****************************************************************
  5663
  5664     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5665         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5666             20  CF-LIFE-CODE-IN            PIC XX.
  5667             20  CF-LIFE-CODE-OUT           PIC XX.
  5668         16  FILLER                         PIC X(248).
  5669
  5670
  5671****************************************************************
  5672*             AH EDIT MASTER RECORD                            *
  5673****************************************************************
  5674
  5675     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5676         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5677             20  CF-AH-CODE-IN              PIC XXX.
  5678             20  CF-AH-CODE-OUT             PIC XX.
  5679         16  FILLER                         PIC X(248).
  5680
  5681
  5682****************************************************************
  5683*             CREDIBILITY TABLES                               *
  5684****************************************************************
  5685
  5686     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5687         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5688                             INDEXED BY CF-CRDB-NDX.
  5689             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 103
* EL131.cbl
  5690             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5691             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5692         16  FILLER                         PIC  X(332).
  5693
  5694
  5695****************************************************************
  5696*             REPORT CUSTOMIZATION RECORD                      *
  5697****************************************************************
  5698
  5699     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5700         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5701             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5702             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5703             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5704**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5705****       A T-TRANSFER.                                   ****
  5706             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5707
  5708         16  FILLER                         PIC XX.
  5709
  5710         16  CF-CARRIER-CNTL-OPT.
  5711             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5712                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5713                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5714             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5715                                            PIC X.
  5716         16  CF-GROUP-CNTL-OPT.
  5717             20  CF-GROUP-OPT-SEQ           PIC 9.
  5718                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5719                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5720             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5721                                            PIC X(6).
  5722         16  CF-STATE-CNTL-OPT.
  5723             20  CF-STATE-OPT-SEQ           PIC 9.
  5724                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5725                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5726             20  CF-STATE-SELECT OCCURS 3 TIMES
  5727                                            PIC XX.
  5728         16  CF-ACCOUNT-CNTL-OPT.
  5729             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5730                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5731                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5732             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5733                                            PIC X(10).
  5734         16  CF-BUS-TYP-CNTL-OPT.
  5735             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5736                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5737                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5738             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5739                                            PIC XX.
  5740         16  CF-LF-TYP-CNTL-OPT.
  5741             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5742                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5743                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5744             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5745                                            PIC XX.
  5746         16  CF-AH-TYP-CNTL-OPT.
  5747             20  CF-AH-TYP-OPT-SEQ          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 104
* EL131.cbl
  5748                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5749                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5750             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5751                                            PIC XX.
  5752         16  CF-REPTCD1-CNTL-OPT.
  5753             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5754                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5755                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5756             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5757                                            PIC X(10).
  5758         16  CF-REPTCD2-CNTL-OPT.
  5759             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5760                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5761                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5762             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5763                                            PIC X(10).
  5764         16  CF-USER1-CNTL-OPT.
  5765             20  CF-USER1-OPT-SEQ           PIC 9.
  5766                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5767                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5768             20  CF-USER1-SELECT OCCURS 3 TIMES
  5769                                            PIC X(10).
  5770         16  CF-USER2-CNTL-OPT.
  5771             20  CF-USER2-OPT-SEQ           PIC 9.
  5772                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5773                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5774             20  CF-USER2-SELECT OCCURS 3 TIMES
  5775                                            PIC X(10).
  5776         16  CF-USER3-CNTL-OPT.
  5777             20  CF-USER3-OPT-SEQ           PIC 9.
  5778                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5779                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5780             20  CF-USER3-SELECT OCCURS 3 TIMES
  5781                                            PIC X(10).
  5782         16  CF-USER4-CNTL-OPT.
  5783             20  CF-USER4-OPT-SEQ           PIC 9.
  5784                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5785                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5786             20  CF-USER4-SELECT OCCURS 3 TIMES
  5787                                            PIC X(10).
  5788         16  CF-USER5-CNTL-OPT.
  5789             20  CF-USER5-OPT-SEQ           PIC 9.
  5790                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5791                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5792             20  CF-USER5-SELECT OCCURS 3 TIMES
  5793                                            PIC X(10).
  5794         16  CF-REINS-CNTL-OPT.
  5795             20  CF-REINS-OPT-SEQ           PIC 9.
  5796                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5797                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5798             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5799                 24  CF-REINS-PRIME         PIC XXX.
  5800                 24  CF-REINS-SUB           PIC XXX.
  5801
  5802         16  CF-AGENT-CNTL-OPT.
  5803             20  CF-AGENT-OPT-SEQ           PIC 9.
  5804                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5805                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 105
* EL131.cbl
  5806             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5807                                            PIC X(10).
  5808
  5809         16  FILLER                         PIC X(43).
  5810
  5811         16  CF-LOSS-RATIO-SELECT.
  5812             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5813             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5814         16  CF-ENTRY-DATE-SELECT.
  5815             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5816             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5817         16  CF-EFFECTIVE-DATE-SELECT.
  5818             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5819             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5820
  5821         16  CF-EXCEPTION-LIST-IND          PIC X.
  5822             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5823
  5824         16  FILLER                         PIC X(318).
  5825
  5826****************************************************************
  5827*                  EXCEPTION REPORTING RECORD                  *
  5828****************************************************************
  5829
  5830     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5831         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5832             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5833
  5834         16  CF-COMBINED-LIFE-AH-OPT.
  5835             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5836             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5837             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5838             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5839
  5840         16  CF-LIFE-OPT.
  5841             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5842             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5843             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5844             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5845             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5846             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5847             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5848             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5849             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5850             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5851
  5852         16  CF-AH-OPT.
  5853             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5854             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5855             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5856             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5857             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5858             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5859             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5860             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5861             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5862             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5863
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 106
* EL131.cbl
  5864         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5865             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5866             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5867             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5868
  5869         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5870
  5871         16  FILLER                         PIC X(673).
  5872
  5873
  5874****************************************************************
  5875*             MORTGAGE SYSTEM PLAN RECORD                      *
  5876****************************************************************
  5877
  5878     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5879         16  CF-PLAN-TYPE                   PIC X.
  5880             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5881             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5882             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5883         16  CF-PLAN-ABBREV                 PIC XXX.
  5884         16  CF-PLAN-DESCRIPT               PIC X(10).
  5885         16  CF-PLAN-NOTES                  PIC X(20).
  5886         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5887         16  CF-PLAN-UNDERWRITING.
  5888             20  CF-PLAN-TERM-DATA.
  5889                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5890                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5891             20  CF-PLAN-AGE-DATA.
  5892                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5893                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5894                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5895             20  CF-PLAN-BENEFIT-DATA.
  5896                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5897                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5898                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5899                                            PIC S9(7)V99  COMP-3.
  5900         16  CF-PLAN-POLICY-FORMS.
  5901             20  CF-POLICY-FORM             PIC X(12).
  5902             20  CF-MASTER-APPLICATION      PIC X(12).
  5903             20  CF-MASTER-POLICY           PIC X(12).
  5904         16  CF-PLAN-RATING.
  5905             20  CF-RATE-CODE               PIC X(5).
  5906             20  CF-SEX-RATING              PIC X.
  5907                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5908                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5909             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5910             20  CF-SUB-STD-TYPE            PIC X.
  5911                 88  CF-PCT-OF-PREM            VALUE '1'.
  5912                 88  CF-PCT-OF-BENE            VALUE '2'.
  5913         16  CF-PLAN-PREM-TOLERANCES.
  5914             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5915             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5916         16  CF-PLAN-PYMT-TOLERANCES.
  5917             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5918             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5919         16  CF-PLAN-MISC-DATA.
  5920             20  FILLER                     PIC X.
  5921             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 107
* EL131.cbl
  5922             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5923         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5924         16  CF-PLAN-IND-GRP                PIC X.
  5925             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5926                                                     '1'.
  5927             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5928                                                     '2'.
  5929         16  CF-MIB-SEARCH-SW               PIC X.
  5930             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5931             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5932             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5933             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5934         16  CF-ALPHA-SEARCH-SW             PIC X.
  5935             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5936             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5937             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5938             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5939             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5940             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5941             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5942             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5943             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5944             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5945                                                     'A' 'B' 'C'
  5946                                                     'X' 'Y' 'Z'.
  5947         16  CF-EFF-DT-RULE-SW              PIC X.
  5948             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5949             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5950             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5951             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5952             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5953         16  FILLER                         PIC X(4).
  5954         16  CF-HEALTH-QUESTIONS            PIC X.
  5955             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5956         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5957         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5958         16  CF-PLAN-SNGL-JNT               PIC X.
  5959             88  CF-COMBINED-PLAN              VALUE 'C'.
  5960             88  CF-JNT-PLAN                   VALUE 'J'.
  5961             88  CF-SNGL-PLAN                  VALUE 'S'.
  5962         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5963         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5964         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5965         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5966         16  CF-RERATE-CNTL                 PIC  X.
  5967             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5968             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5969             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5970             88  CF-AUTO-RECALC                 VALUE '4'.
  5971         16  CF-BENEFIT-TYPE                PIC  X.
  5972             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5973             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5974         16  CF-POLICY-FEE                  PIC S999V99
  5975                                                    COMP-3.
  5976         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5977         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5978         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5979         16  CF-4TH-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 108
* EL131.cbl
  5980         16  FILLER                         PIC  X(32).
  5981         16  CF-TERMINATION-FORM            PIC  X(04).
  5982         16  FILLER                         PIC  X(08).
  5983         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5984                                                       COMP-3.
  5985         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5986         16  CF-ISSUE-LETTER                PIC  X(4).
  5987         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5988         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5989             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5990             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5991         16  CF-MP-REFUND-CALC              PIC X.
  5992             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5993             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5994             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5995             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5996             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5997             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5998             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5999             88  CF-MP-REFD-MEAN                VALUE '8'.
  6000         16  CF-ALT-RATE-CODE               PIC  X(5).
  6001
  6002
  6003         16  FILLER                         PIC X(498).
  6004****************************************************************
  6005*             MORTGAGE COMPANY MASTER RECORD                   *
  6006****************************************************************
  6007
  6008     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6009         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6010         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6011             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6012             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6013             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6014             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6015             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6016
  6017         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6018         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6019         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6020         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6021         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6022
  6023         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6024             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6025         16  CF-MP-RECON-USE-IND            PIC X(1).
  6026             88  CF-MP-USE-RECON             VALUE 'Y'.
  6027         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6028             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6029         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6030             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6031             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6032         16  FILLER                         PIC X(1).
  6033         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6034             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6035         16  CF-MORTG-MIB-VERSION           PIC X.
  6036             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6037             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 109
* EL131.cbl
  6038             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6039         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6040             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6041                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6042             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6043                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6044             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6045                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6046             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6047                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6048             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6049                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6050             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6051                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6052         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6053         16  FILLER                         PIC X(7).
  6054         16  CF-MORTG-DESTINATION-SYMBOL.
  6055             20  CF-MORTG-MIB-COMM          PIC X(5).
  6056             20  CF-MORTG-MIB-TERM          PIC X(5).
  6057         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6058             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6059         16  FILLER                         PIC X(03).
  6060         16  CF-MP-CHECK-NO-CONTROL.
  6061             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6062                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6063                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6064                                                ' ' LOW-VALUES.
  6065                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6066                                               VALUE '3'.
  6067         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6068         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6069         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6070             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6071                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6072             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6073                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6074             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6075                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6076             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6077                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6078             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6079                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6080             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6081                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6082         16  CF-MORTG-BILLING-AREA.
  6083             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6084                                            PIC X.
  6085         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6086         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6087         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6088         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6089             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6090             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6091         16  FILLER                         PIC X.
  6092         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6093             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6094             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6095         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 110
* EL131.cbl
  6096         16  FILLER                         PIC X(8).
  6097         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6098         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6099         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6100         16  CF-ACH-COMPANY-ID.
  6101             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6102                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6103                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6104                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6105             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6106         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6107             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6108         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6109             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6110             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6111         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6112         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6113         16  FILLER                         PIC X(536).
  6114
  6115****************************************************************
  6116*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6117****************************************************************
  6118
  6119     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6120         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6121             20  CF-FEMALE-HEIGHT.
  6122                 24  CF-FEMALE-FT           PIC 99.
  6123                 24  CF-FEMALE-IN           PIC 99.
  6124             20  CF-FEMALE-MIN-WT           PIC 999.
  6125             20  CF-FEMALE-MAX-WT           PIC 999.
  6126         16  FILLER                         PIC X(428).
  6127
  6128     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6129         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6130             20  CF-MALE-HEIGHT.
  6131                 24  CF-MALE-FT             PIC 99.
  6132                 24  CF-MALE-IN             PIC 99.
  6133             20  CF-MALE-MIN-WT             PIC 999.
  6134             20  CF-MALE-MAX-WT             PIC 999.
  6135         16  FILLER                         PIC X(428).
  6136******************************************************************
  6137*             AUTOMATIC ACTIVITY RECORD                          *
  6138******************************************************************
  6139     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6140         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6141             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6142             20  CF-SYS-LETTER-ID           PIC X(04).
  6143             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6144             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6145             20  CF-SYS-RESET-SW            PIC X(01).
  6146             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6147             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6148
  6149         16  FILLER                         PIC X(50).
  6150
  6151         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6152             20  CF-USER-ACTIVE-SW          PIC X(01).
  6153             20  CF-USER-LETTER-ID          PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 111
* EL131.cbl
  6154             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6155             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6156             20  CF-USER-RESET-SW           PIC X(01).
  6157             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6158             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6159             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6160
  6161         16  FILLER                         PIC X(246).
  6162
  6163*                                COPY ELCACTQ.
  6164******************************************************************
  6165*                                                                *
  6166*                            ELCACTQ.                            *
  6167*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6168*                            VMOD=2.004                          *
  6169*                                                                *
  6170*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6171*                                                                *
  6172*   FILE TYPE = VSAM,KSDS                                        *
  6173*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6174*                                                                *
  6175*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6176*       ALTERNATE INDEX = NONE                                   *
  6177*                                                                *
  6178*   LOG = YES                                                    *
  6179*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6180*                                                                *
  6181*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6182******************************************************************
  6183
  6184 01  ACTIVITY-QUE.
  6185     12  AQ-RECORD-ID                PIC XX.
  6186         88  VALID-AQ-ID                VALUE 'AQ'.
  6187
  6188     12  AQ-CONTROL-PRIMARY.
  6189         16  AQ-COMPANY-CD           PIC X.
  6190         16  AQ-CARRIER              PIC X.
  6191         16  AQ-CLAIM-NO             PIC X(7).
  6192         16  AQ-CERT-NO.
  6193             20  AQ-CERT-PRIME       PIC X(10).
  6194             20  AQ-CERT-SFX         PIC X.
  6195
  6196     12  AQ-PENDING-ACTIVITY-FLAGS.
  6197         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6198         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6199             88  PENDING-PAYMENTS       VALUE '1'.
  6200         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6201             88  PENDING-FULL-PRINT     VALUE '1'.
  6202             88  PENDING-PART-PRINT     VALUE '2'.
  6203         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6204             88  PENDING-LETTERS        VALUE '1'.
  6205         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6206             88  PENDING-RESTORE        VALUE 'C'.
  6207             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6208
  6209     12  FILLER                      PIC X(20).
  6210
  6211     12  AQ-RESEND-DATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 112
* EL131.cbl
  6212     12  AQ-FOLLOWUP-DATE            PIC XX.
  6213     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6214     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6215     12  AQ-AUTO-LETTER              PIC X(4).
  6216     12  FILLER                      PIC XX.
  6217     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6218*****************************************************************
  6219
  6220*                                COPY ERCACCT.
  6221******************************************************************
  6222*                                                                *
  6223*                                                                *
  6224*                            ERCACCT                             *
  6225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6226*                            VMOD=2.031                          *
  6227*                                                                *
  6228*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6229*                                                                *
  6230*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6231*   VSAM ACCOUNT MASTER FILES.                                   *
  6232*                                                                *
  6233*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6234*                                                                *
  6235*   FILE TYPE = VSAM,KSDS                                        *
  6236*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6237*                                                                *
  6238*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6239*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6240*                                                                *
  6241*   LOG = NO                                                     *
  6242*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6243*                                                                *
  6244*                                                                *
  6245******************************************************************
  6246*                   C H A N G E   L O G
  6247*
  6248* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6249*-----------------------------------------------------------------
  6250*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6251* EFFECTIVE    NUMBER
  6252*-----------------------------------------------------------------
  6253* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6254* 092705    2005050300006  PEMA  ADD SPP LEASES
  6255* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6256* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6257* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6258* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6259* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6260******************************************************************
  6261
  6262 01  ACCOUNT-MASTER.
  6263     12  AM-RECORD-ID                      PIC XX.
  6264         88  VALID-AM-ID                      VALUE 'AM'.
  6265
  6266     12  AM-CONTROL-PRIMARY.
  6267         16  AM-COMPANY-CD                 PIC X.
  6268         16  AM-MSTR-CNTRL.
  6269             20  AM-CONTROL-A.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 113
* EL131.cbl
  6270                 24  AM-CARRIER            PIC X.
  6271                 24  AM-GROUPING.
  6272                     28 AM-GROUPING-PREFIX PIC XXX.
  6273                     28 AM-GROUPING-PRIME  PIC XXX.
  6274                 24  AM-STATE              PIC XX.
  6275                 24  AM-ACCOUNT.
  6276                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6277                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6278             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6279                                           PIC X(19).
  6280             20  AM-CNTRL-B.
  6281                 24  AM-EXPIRATION-DT      PIC XX.
  6282                 24  FILLER                PIC X(4).
  6283             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6284                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6285
  6286     12  AM-CONTROL-BY-VAR-GRP.
  6287         16  AM-COMPANY-CD-A1              PIC X.
  6288         16  AM-VG-CARRIER                 PIC X.
  6289         16  AM-VG-GROUPING                PIC X(6).
  6290         16  AM-VG-STATE                   PIC XX.
  6291         16  AM-VG-ACCOUNT                 PIC X(10).
  6292         16  AM-VG-DATE.
  6293             20  AM-VG-EXPIRATION-DT       PIC XX.
  6294             20  FILLER                    PIC X(4).
  6295         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6296                                           PIC 9(11)      COMP-3.
  6297     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6298         16  FILLER                        PIC X(10).
  6299         16  AM-VG-KEY3.
  6300             20  AM-VG3-ACCOUNT            PIC X(10).
  6301             20  AM-VG3-EXP-DT             PIC XX.
  6302         16  FILLER                        PIC X(4).
  6303     12  AM-MAINT-INFORMATION.
  6304         16  AM-LAST-MAINT-DT              PIC XX.
  6305         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6306         16  AM-LAST-MAINT-USER            PIC X(4).
  6307         16  FILLER                        PIC XX.
  6308
  6309     12  AM-EFFECTIVE-DT                   PIC XX.
  6310     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6311
  6312     12  AM-PREV-DATES  COMP-3.
  6313         16  AM-PREV-EXP-DT                PIC 9(11).
  6314         16  AM-PREV-EFF-DT                PIC 9(11).
  6315
  6316     12  AM-REPORT-CODE-1                  PIC X(10).
  6317     12  AM-REPORT-CODE-2                  PIC X(10).
  6318
  6319     12  AM-CITY-CODE                      PIC X(4).
  6320     12  AM-COUNTY-PARISH                  PIC X(6).
  6321
  6322     12  AM-NAME                           PIC X(30).
  6323     12  AM-PERSON                         PIC X(30).
  6324     12  AM-ADDRS                          PIC X(30).
  6325     12  AM-CITY.
  6326         16  AM-ADDR-CITY                  PIC X(28).
  6327         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 114
* EL131.cbl
  6328     12  AM-ZIP.
  6329         16  AM-ZIP-PRIME.
  6330             20  AM-ZIP-PRI-1ST            PIC X.
  6331                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6332             20  FILLER                    PIC X(4).
  6333         16  AM-ZIP-PLUS4                  PIC X(4).
  6334     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6335         16  AM-CAN-POSTAL-1               PIC XXX.
  6336         16  AM-CAN-POSTAL-2               PIC XXX.
  6337         16  FILLER                        PIC XXX.
  6338     12  AM-TEL-NO.
  6339         16  AM-AREA-CODE                  PIC 999.
  6340         16  AM-TEL-PRE                    PIC 999.
  6341         16  AM-TEL-NBR                    PIC 9(4).
  6342     12  AM-TEL-LOC                        PIC X.
  6343         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6344         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6345
  6346     12  AM-COMM-STRUCTURE.
  6347         16  AM-DEFN-1.
  6348             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6349                 24  AM-AGT.
  6350                     28  AM-AGT-PREFIX     PIC X(4).
  6351                     28  AM-AGT-PRIME      PIC X(6).
  6352                 24  AM-COM-TYP            PIC X.
  6353                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6354                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6355                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6356                 24  AM-RECALC-LV-INDIC    PIC X.
  6357                 24  AM-RETRO-LV-INDIC     PIC X.
  6358                 24  AM-GL-CODES           PIC X.
  6359                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6360                 24  FILLER                PIC X(01).
  6361         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6362             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6363                 24  FILLER                PIC X(11).
  6364                 24  AM-L-COMA             PIC XXX.
  6365                 24  AM-J-COMA             PIC XXX.
  6366                 24  AM-A-COMA             PIC XXX.
  6367                 24  FILLER                PIC X(6).
  6368
  6369     12  AM-COMM-CHANGE-STATUS             PIC X.
  6370         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6371
  6372     12  AM-CSR-CODE                       PIC X(4).
  6373
  6374     12  AM-BILLING-STATUS                 PIC X.
  6375         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6376         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6377     12  AM-AUTO-REFUND-SW                 PIC X.
  6378         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6379         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6380     12  AM-GPCD                           PIC 99.
  6381     12  AM-IG                             PIC X.
  6382         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6383         88  AM-HAS-GROUP                     VALUE '2'.
  6384     12  AM-STATUS                         PIC X.
  6385         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 115
* EL131.cbl
  6386         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6387         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6388         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6389         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6390         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6391     12  AM-REMIT-TO                       PIC 99.
  6392     12  AM-ID-NO                          PIC X(11).
  6393
  6394     12  AM-CAL-TABLE                      PIC XX.
  6395     12  AM-LF-DEVIATION                   PIC XXX.
  6396     12  AM-AH-DEVIATION                   PIC XXX.
  6397     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6398     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6399     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6400     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6401     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6402     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6403
  6404     12  AM-USER-FIELDS.
  6405         16  AM-FLD-1                      PIC XX.
  6406         16  AM-FLD-2                      PIC XX.
  6407         16  AM-FLD-3                      PIC XX.
  6408         16  AM-FLD-4                      PIC XX.
  6409         16  AM-FLD-5                      PIC XX.
  6410
  6411     12  AM-1ST-PROD-DATE.
  6412         16  AM-1ST-PROD-YR                PIC XX.
  6413         16  AM-1ST-PROD-MO                PIC XX.
  6414         16  AM-1ST-PROD-DA                PIC XX.
  6415     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6416     12  AM-CERTS-PURGED-DATE.
  6417         16  AM-PUR-YR                     PIC XX.
  6418         16  AM-PUR-MO                     PIC XX.
  6419         16  AM-PUR-DA                     PIC XX.
  6420     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6421     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6422     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6423     12  AM-INACTIVE-DATE.
  6424         16  AM-INA-MO                     PIC 99.
  6425         16  AM-INA-DA                     PIC 99.
  6426         16  AM-INA-YR                     PIC 99.
  6427     12  AM-AR-HI-CERT-DATE                PIC XX.
  6428
  6429     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6430     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6431
  6432     12  AM-OB-PAYMENT-MODE                PIC X.
  6433         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6434         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6435         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6436         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6437
  6438     12  AM-AH-ONLY-INDICATOR              PIC X.
  6439         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6440         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6441
  6442     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6443
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 116
* EL131.cbl
  6444     12  AM-OVER-SHORT.
  6445         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6446         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6447
  6448     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6449     12  AM-DCC-CLP-STATE                  PIC XX.
  6450
  6451     12  AM-RECALC-COMM                    PIC X.
  6452     12  AM-RECALC-REIN                    PIC X.
  6453
  6454     12  AM-REI-TABLE                      PIC XXX.
  6455     12  AM-REI-ET-LF                      PIC X.
  6456     12  AM-REI-ET-AH                      PIC X.
  6457     12  AM-REI-PE-LF                      PIC X.
  6458     12  AM-REI-PE-AH                      PIC X.
  6459     12  AM-REI-PRT-ST                     PIC X.
  6460     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6461     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6462     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6463     12  AM-REI-GROUP-A                    PIC X(6).
  6464     12  AM-REI-MORT                       PIC X(4).
  6465     12  AM-REI-PRT-OW                     PIC X.
  6466     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6467     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6468     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6469     12  AM-REI-GROUP-B                    PIC X(6).
  6470
  6471     12  AM-TRUST-TYPE                     PIC X(2).
  6472
  6473     12  AM-EMPLOYER-STMT-USED             PIC X.
  6474     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6475
  6476     12  AM-STD-AH-TYPE                    PIC XX.
  6477     12  AM-EARN-METHODS.
  6478         16  AM-EARN-METHOD-R              PIC X.
  6479             88 AM-REF-RL-R78                 VALUE 'R'.
  6480             88 AM-REF-RL-PR                  VALUE 'P'.
  6481             88 AM-REF-RL-MEAN                VALUE 'M'.
  6482             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6483         16  AM-EARN-METHOD-L              PIC X.
  6484             88 AM-REF-LL-R78                 VALUE 'R'.
  6485             88 AM-REF-LL-PR                  VALUE 'P'.
  6486             88 AM-REF-LL-MEAN                VALUE 'M'.
  6487             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6488         16  AM-EARN-METHOD-A              PIC X.
  6489             88 AM-REF-AH-R78                 VALUE 'R'.
  6490             88 AM-REF-AH-PR                  VALUE 'P'.
  6491             88 AM-REF-AH-MEAN                VALUE 'M'.
  6492             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6493             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6494             88 AM-REF-AH-NET                 VALUE 'N'.
  6495
  6496     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6497     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6498     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6499
  6500     12  AM-RET-Y-N                        PIC X.
  6501     12  AM-RET-P-E                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 117
* EL131.cbl
  6502     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6503     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6504     12  AM-RET-GRP                        PIC X(6).
  6505     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6506         16  AM-POOL-PRIME                 PIC XXX.
  6507         16  AM-POOL-SUB                   PIC XXX.
  6508     12  AM-RETRO-EARNINGS.
  6509         16  AM-RET-EARN-R                 PIC X.
  6510         16  AM-RET-EARN-L                 PIC X.
  6511         16  AM-RET-EARN-A                 PIC X.
  6512     12  AM-RET-ST-TAX-USE                 PIC X.
  6513         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6514         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6515     12  AM-RETRO-BEG-EARNINGS.
  6516         16  AM-RET-BEG-EARN-R             PIC X.
  6517         16  AM-RET-BEG-EARN-L             PIC X.
  6518         16  AM-RET-BEG-EARN-A             PIC X.
  6519     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6520     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6521
  6522     12  AM-USER-SELECT-OPTIONS.
  6523         16  AM-USER-SELECT-1              PIC X(10).
  6524         16  AM-USER-SELECT-2              PIC X(10).
  6525         16  AM-USER-SELECT-3              PIC X(10).
  6526         16  AM-USER-SELECT-4              PIC X(10).
  6527         16  AM-USER-SELECT-5              PIC X(10).
  6528
  6529     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6530
  6531     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6532
  6533     12  AM-RPT045A-SWITCH                 PIC X.
  6534         88  RPT045A-OFF                   VALUE 'N'.
  6535
  6536     12  AM-INSURANCE-LIMITS.
  6537         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6538         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6539
  6540     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6541         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6542
  6543     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6544         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6545         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6546
  6547     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6548
  6549     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6550     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6551     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6552     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6553     12  AM-DCC-UEF-STATE                  PIC XX.
  6554     12  FILLER                            PIC XXX.
  6555     12  AM-REPORT-CODE-3                  PIC X(10).
  6556*    12  FILLER                            PIC X(22).
  6557
  6558     12  AM-RESERVE-DATE.
  6559         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 118
* EL131.cbl
  6560         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6561         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6562
  6563     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6564     12  AM-NOTIFICATION-TYPES.
  6565         16  AM-NOTIF-OF-LETTERS           PIC X.
  6566         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6567         16  AM-NOTIF-OF-REPORTS           PIC X.
  6568         16  AM-NOTIF-OF-STATUS            PIC X.
  6569
  6570     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6571         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6572         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6573         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6574         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6575
  6576     12  AM-BENEFIT-CONTROLS.
  6577         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6578             20  AM-BENEFIT-CODE           PIC XX.
  6579             20  AM-BENEFIT-TYPE           PIC X.
  6580             20  AM-BENEFIT-REVISION       PIC XXX.
  6581             20  AM-BENEFIT-REM-TERM       PIC X.
  6582             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6583             20  FILLER                    PIC XX.
  6584         16  FILLER                        PIC X(80).
  6585
  6586     12  AM-TRANSFER-DATA.
  6587         16  AM-TRANSFERRED-FROM.
  6588             20  AM-TRNFROM-CARRIER        PIC X.
  6589             20  AM-TRNFROM-GROUPING.
  6590                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6591                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6592             20  AM-TRNFROM-STATE          PIC XX.
  6593             20  AM-TRNFROM-ACCOUNT.
  6594                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6595                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6596             20  AM-TRNFROM-DTE            PIC XX.
  6597         16  AM-TRANSFERRED-TO.
  6598             20  AM-TRNTO-CARRIER          PIC X.
  6599             20  AM-TRNTO-GROUPING.
  6600                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6601                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6602             20  AM-TRNTO-STATE            PIC XX.
  6603             20  AM-TRNTO-ACCOUNT.
  6604                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6605                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6606             20  AM-TRNTO-DTE              PIC XX.
  6607         16  FILLER                        PIC X(10).
  6608
  6609     12  AM-SAVED-REMIT-TO                 PIC 99.
  6610
  6611     12  AM-COMM-STRUCTURE-SAVED.
  6612         16  AM-DEFN-1-SAVED.
  6613             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6614                 24  AM-AGT-SV             PIC X(10).
  6615                 24  AM-COM-TYP-SV         PIC X.
  6616                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6617                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 119
* EL131.cbl
  6618                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6619                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6620                 24  FILLER                PIC X.
  6621                 24  AM-GL-CODES-SV        PIC X.
  6622                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6623                 24  FILLER                PIC X.
  6624         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6625             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6626                 24  FILLER                PIC X(11).
  6627                 24  AM-L-COMA-SV          PIC XXX.
  6628                 24  AM-J-COMA-SV          PIC XXX.
  6629                 24  AM-A-COMA-SV          PIC XXX.
  6630                 24  FILLER                PIC X(6).
  6631
  6632     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6633         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6634            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6635            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6636            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6637
  6638     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6639     12  FILLER                            PIC X(120).
  6640
  6641     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6642         16  AM-CONTROL-NAME               PIC X(30).
  6643         16  AM-EXECUTIVE-ONE.
  6644             20  AM-EXEC1-NAME             PIC X(15).
  6645             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6646                                                          COMP-3.
  6647             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6648                                                          COMP-3.
  6649         16  AM-EXECUTIVE-TWO.
  6650             20  AM-EXEC2-NAME             PIC X(15).
  6651             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6652                                                          COMP-3.
  6653             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6654                                                          COMP-3.
  6655
  6656     12  AM-RETRO-ADDITIONAL-DATA.
  6657         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6658         16  AM-RETRO-PREM-P-E             PIC X.
  6659         16  AM-RETRO-CLMS-P-I             PIC X.
  6660         16  AM-RETRO-RET-BRACKET-LF.
  6661             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6662                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6663                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6664             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6665                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6666                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6667             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6668                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6669                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6670         16  AM-RETRO-RET-BRACKET-AH.
  6671             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6672                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6673                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6674                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6675             20  AM-RETRO-RET-BASIS-AH     PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 120
* EL131.cbl
  6676                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6677                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6678             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6679                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6680                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6681
  6682     12  AM-COMMENTS.
  6683         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6684
  6685     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6686         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6687         16  AM-FLI-BILLING-CODE           PIC X.
  6688         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6689         16  AM-FLI-UNITED-IDENT           PIC X.
  6690         16  AM-FLI-INTEREST-LOST-DATA.
  6691             20  AM-FLI-BANK-NO            PIC X(5).
  6692             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6693             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6694             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6695         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6696             20  AM-FLI-AGT                PIC X(9).
  6697             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6698             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6699         16  FILLER                        PIC X(102).
  6700
  6701     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6702         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6703             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6704             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6705             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6706             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6707             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6708         16  FILLER                          PIC X(10).
  6709******************************************************************
  6710
  6711*                                COPY ELCCHKQ.
  6712******************************************************************
  6713*                                                                *
  6714*                                                                *
  6715*                            ELCCHKQ.                            *
  6716*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6717*                            VMOD=2.007                          *
  6718*                                                                *
  6719*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6720*                                                                *
  6721*   FILE TYPE = VSAM,KSDS                                        *
  6722*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6723*                                                                *
  6724*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6725*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6726*                                                                *
  6727*   LOG = YES                                                    *
  6728*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6729******************************************************************
  6730 01  CHECK-QUE.
  6731     12  CQ-RECORD-ID                PIC XX.
  6732         88  VALID-CQ-ID         VALUE 'CQ'.
  6733
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 121
* EL131.cbl
  6734     12  CQ-CONTROL-PRIMARY.
  6735         16  CQ-COMPANY-CD           PIC X.
  6736         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6737         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6738
  6739     12  CQ-CONTROL-BY-PAYEE.
  6740         16  CQ-CONTROL-BY-NUMBER.
  6741             20  CQ-COMPANY-CD-A1     PIC X.
  6742             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6743         16  CQ-PAYEE-CARRIER        PIC X.
  6744         16  CQ-PAYEE-GROUPING       PIC X(6).
  6745         16  CQ-PAYEE-STATE          PIC XX.
  6746         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6747         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6748
  6749     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6750         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6751         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6752         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6753         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6754         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6755         16  FILLER                  PIC X(3).
  6756
  6757     12  CQ-ENTRY-TYPE               PIC X.
  6758             88  CHECK-ON-QUE           VALUE 'Q'.
  6759             88  ALIGNMENT-CHECK        VALUE 'A'.
  6760             88  SPOILED-CHECK          VALUE 'S'.
  6761             88  PAYMENT-ABORTED        VALUE 'X'.
  6762
  6763     12  CQ-CLAIM-MAST-CNTL.
  6764         16  CQ-CARRIER              PIC X.
  6765         16  CQ-CLAIM-NO             PIC X(7).
  6766         16  CQ-CERT-NO.
  6767             20  CQ-CERT-PRIME       PIC X(10).
  6768             20  CQ-CERT-SFX         PIC X.
  6769         16  CQ-CLAIM-TYPE           PIC X.
  6770             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6771             88  CQ-AH-CLAIM            VALUE 'A'.
  6772         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6773             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6774             88  CQ-O-B-COVERAGE        VALUE '2'.
  6775             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6776
  6777     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6778     12  CQ-CHECK-NUMBER             PIC X(7).
  6779     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6780     12  CQ-PAYMENT-TYPE             PIC X.
  6781             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6782             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6783             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6784             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6785             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6786             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6787             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6788             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6789     12  CQ-VOID-INDICATOR           PIC X.
  6790             88  CHECK-IS-STOPPED          VALUE 'S'.
  6791             88  CHECK-IS-VOID             VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 122
* EL131.cbl
  6792     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6793     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6794     12  CQ-CHECK-BY-USER            PIC X(4).
  6795     12  CQ-PRE-NUMBERING-SW         PIC X.
  6796       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6797       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6798
  6799     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6800     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6801     12  CQ-LEDGER-FLAG              PIC X(01).
  6802     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6803     12  CQ-LAST-UPDATED-DT          PIC XX.
  6804     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6805     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6806
  6807     12  FILLER                      PIC X(04).
  6808
  6809******************************************************************
  6810
  6811*                                COPY ELCARCH.
  6812******************************************************************
  6813*                                                                *
  6814*                            ELCARCH.                            *
  6815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6816*                            VMOD=2.007                          *
  6817*                                                                *
  6818*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6819*                                                                *
  6820*   FILE TYPE = VSAM,KSDS                                        *
  6821*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6822*                                                                *
  6823*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6824*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6825*                                                                *
  6826*   LOG = NO                                                     *
  6827*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6828*                                                                *
  6829*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6830******************************************************************
  6831 01  LETTER-ARCHIVE.
  6832     12  LA-RECORD-ID                PIC XX.
  6833         88  VALID-LA-ID                VALUE 'LA'.
  6834
  6835     12  LA-CONTROL-PRIMARY.
  6836         16  LA-COMPANY-CD           PIC X.
  6837         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6838         16  LA-RECORD-TYPE          PIC X.
  6839             88  LA-HEADER-DATA         VALUE '1'.
  6840             88  LA-ADDRESS-DATA        VALUE '2'.
  6841             88  LA-TEXT-DATA           VALUE '3'.
  6842             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6843         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6844
  6845     12  LA-CONTROL-BY-TYPE.
  6846         16  LA-COMPANY-CD-A1        PIC X.
  6847         16  LA-RECORD-TYPE-A1       PIC X.
  6848         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6849         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 123
* EL131.cbl
  6850
  6851     12  LA-TEXT-RECORD.
  6852         16  LA-SKIP-CONTROL         PIC XX.
  6853             88  NO-LINES-SKIPPED       VALUE SPACES.
  6854             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6855         16  LA-TEXT-LINE            PIC X(70).
  6856
  6857     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6858         16  FILLER                  PIC XX.
  6859         16  LA-ADDRESS-LINE         PIC X(30).
  6860         16  FILLER                  PIC X(40).
  6861
  6862     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6863         16  FILLER                  PIC XX.
  6864         16  LA-CARRIER              PIC X.
  6865         16  LA-CLAIM-NO             PIC X(7).
  6866         16  LA-CERT-NO.
  6867             20  LA-CERT-PRIME       PIC X(10).
  6868             20  LA-CERT-SFX         PIC X.
  6869         16  LA-NO-OF-COPIES         PIC S9.
  6870         16  LA-RESEND-DATE          PIC XX.
  6871         16  LA-PROCESSOR-CD         PIC X(4).
  6872         16  LA-CREATION-DT          PIC XX.
  6873         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6874         16  LA-RESEND-PRINT-DATE    PIC XX.
  6875         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6876         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6877*
  6878* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6879*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6880*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6881*   I        20  LA-DMD-RES-ST           PIC XX.
  6882*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6883*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6884*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6885*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6886*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6887*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6888*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6889*   I        20  LA-DMD-UND-CODE         PIC XX.
  6890*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6891*   V    16  FILLER                  PIC X(15).
  6892* -----
  6893*
  6894* REINSERTED  CSO  MODS
  6895*
  6896         16  FILLER.
  6897             20  FILLER                  PIC X(29).
  6898             20  LA-CSO-LETTER-STATUS    PIC X.
  6899                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6900                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6901                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6902             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6903             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6904*
  6905
  6906     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6907         16  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 124
* EL131.cbl
  6908         16  LA4-CARRIER             PIC X.
  6909         16  LA4-CLAIM-NO            PIC X(7).
  6910         16  LA4-CERT-NO.
  6911             20  LA4-CERT-PRIME      PIC X(10).
  6912             20  LA4-CERT-SFX        PIC X.
  6913         16  LA4-NO-OF-COPIES        PIC S9.
  6914         16  LA4-RESEND-DATE         PIC XX.
  6915         16  LA4-PROCESSOR-CD        PIC X(4).
  6916         16  LA4-CREATION-DT         PIC XX.
  6917         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6918         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6919         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6920         16  LA4-FORM-TYPE           PIC X.
  6921             88  LA4-INITIAL-FORM    VALUE '1'.
  6922             88  LA4-PROGRESS-FORM   VALUE '2'.
  6923         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6924         16  LA4-STATE               PIC X(02).
  6925         16  FILLER                  PIC X(31).
  6926******************************************************************
  6927
  6928*                                COPY ELCBENE.
  6929******************************************************************
  6930*                                                                *
  6931*                            ELCBENE.                            *
  6932*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6933*                            VMOD=2.006                          *
  6934*                                                                *
  6935*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6936*                                                                *
  6937*   FILE TYPE = VSAM,KSDS                                        *
  6938*   RECORD SIZE = 500   RECFORM = FIX                            *
  6939*                                                                *
  6940*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6941*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6942*                                                                *
  6943*   LOG = YES                                                    *
  6944*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6945*                                                                *
  6946*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6947******************************************************************
  6948
  6949 01  BENEFICIARY-MASTER.
  6950     12  BE-RECORD-ID                PIC XX.
  6951         88  VALID-BE-ID                VALUE 'BE'.
  6952
  6953     12  BE-CONTROL-PRIMARY.
  6954         16  BE-COMPANY-CD           PIC X.
  6955         16  BE-RECORD-TYPE          PIC X.
  6956             88  BENEFICIARY-RECORD  VALUE 'B'.
  6957             88  ADJUSTOR-RECORD     VALUE 'A'.
  6958         16  BE-BENEFICIARY          PIC X(10).
  6959     12  BE-CONTROL-BY-NAME.
  6960         16  BE-COMPANY-CD-A1        PIC X.
  6961         16  BE-RECORD-TYPE-A1       PIC X.
  6962         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6963         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6964
  6965     12  BE-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 125
* EL131.cbl
  6966     12  BE-LAST-MAINT-BY            PIC X(4).
  6967     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6968
  6969     12  BE-ADDRESS-DATA.
  6970         16  BE-MAIL-TO-NAME         PIC X(30).
  6971         16  BE-ADDRESS-LINE-1       PIC X(30).
  6972         16  BE-ADDRESS-LINE-2       PIC X(30).
  6973         16  BE-ADDRESS-LINE-3       PIC X(30).
  6974         16  BE-CITY-STATE.
  6975             20  BE-CITY             PIC X(28).
  6976             20  BE-STATE            PIC XX.
  6977         16  BE-ZIP-CODE.
  6978             20  BE-ZIP-PRIME.
  6979                 24  BE-ZIP-1ST      PIC X.
  6980                     88  BE-CANADIAN-POST-CODE
  6981                                         VALUE 'A' THRU 'Z'.
  6982                 24  FILLER          PIC X(4).
  6983             20  BE-ZIP-PLUS4        PIC X(4).
  6984         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6985             20  BE-CAN-POSTAL-1     PIC XXX.
  6986             20  BE-CAN-POSTAL-2     PIC XXX.
  6987             20  FILLER              PIC XXX.
  6988         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6989         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6990
  6991******************************************************************
  6992*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6993*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6994******************************************************************
  6995     12  BE-CARRIER                  PIC X.
  6996
  6997     12  BE-ADDRESS-DATA2.
  6998         16  BE-MAIL-TO-NAME2        PIC X(30).
  6999         16  BE-ADDRESS-LINE-12      PIC X(30).
  7000         16  BE-ADDRESS-LINE-22      PIC X(30).
  7001         16  BE-ADDRESS-LINE-32      PIC X(30).
  7002         16  BE-CITY-STATE2.
  7003             20  BE-CITY2            PIC X(28).
  7004             20  BE-STATE2           PIC XX.
  7005         16  BE-ZIP-CODE2.
  7006             20  BE-ZIP-PRIME2.
  7007                 24  BE-ZIP-1ST2     PIC X.
  7008                     88  BE-CANADIAN-POST-CODE2
  7009                                         VALUE 'A' THRU 'Z'.
  7010                 24  FILLER          PIC X(4).
  7011             20  BE-ZIP-PLUS42       PIC X(4).
  7012         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7013             20  BE-CAN-POSTAL-12    PIC XXX.
  7014             20  BE-CAN-POSTAL-22    PIC XXX.
  7015             20  FILLER              PIC XXX.
  7016         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7017         16  BE-BILLING-STMT-DATA.
  7018             20  BE-BSR              PIC X.
  7019                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7020                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7021             20  BE-BSR-FROM         PIC X(30).
  7022             20  BE-BSR-DEPT         PIC X(30).
  7023             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 126
* EL131.cbl
  7024             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7025             20  BE-OUTPUT-TYPE      PIC X.
  7026                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7027                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7028
  7029     12  FILLER                      PIC X(28).
  7030******************************************************************
  7031
  7032*                                COPY ELCDAR.
  7033******************************************************************
  7034*                                                                *
  7035*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7036*   FILE TYPE = VSAM,KSDS                                        *
  7037*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7038*   BASE CLUSTER = DLYACTV                                       *
  7039*   LOG = YES                                                    *
  7040*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7041*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7042*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7043*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7044*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7045*               BY PROGRAM "LGINFCE".                            *
  7046*                                                                *
  7047******************************************************************
  7048 01  DAILY-ACTIVITY-RECORD.
  7049     05  DA-KEY.
  7050         10  DA-COMP-CD          PIC X.
  7051         10  DA-CARRIER          PIC X.
  7052         10  DA-CLAIM-NO         PIC X(7).
  7053         10  DA-CERT-NO.
  7054             15  DA-CERT-PRIME   PIC X(10).
  7055             15  DA-CERT-SFX     PIC X.
  7056     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7057     05  DA-RECORD-TYPE          PIC X.
  7058     05  FILLER                  PIC X(2).
  7059******************************************************************
  7060
  7061*                                COPY ELCALPH.
  7062******************************************************************
  7063*                                                                *
  7064*                            ELCALPH.                            *
  7065*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7066*                            VMOD=2.003                          *
  7067*                                                                *
  7068*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7069*                                                                *
  7070*   FILE TYPE = VSAM,KSDS                                        *
  7071*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7072*                                                                *
  7073*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7074*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7075*                                                                *
  7076*   LOG = YES                                                    *
  7077*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7078*                                                                *
  7079*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7080******************************************************************
  7081
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 127
* EL131.cbl
  7082 01  ALPHA-INDEX.
  7083     12  AI-RECORD-ID                         PIC XX.
  7084         88  VALID-AI-ID                  VALUE 'AI'.
  7085     12  AI-CONTROL-PRIMARY.
  7086         16  AI-COMPANY-CD                     PIC X.
  7087         16  AI-SOURCE                         PIC X.
  7088             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7089             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7090         16  AI-NAME.
  7091             20  AI-LAST-NAME                  PIC X(15).
  7092             20  AI-FIRST-NAME.
  7093                 24  AI-FIRST-INITIAL          PIC X.
  7094                 24  FILLER                    PIC X(11).
  7095             20  AI-MIDDLE-INIT                PIC X.
  7096         16  AI-DATE                           PIC X(8).
  7097         16  AI-TIME                           PIC S9(07) COMP-3.
  7098
  7099     12  AI-CONTROL-BY-ADMIN-KEY.
  7100         16  AI-CM-COMPANY-CD                  PIC X.
  7101         16  AI-CM-SOURCE                      PIC X.
  7102         16  AI-CM-CARRIER                     PIC X.
  7103         16  AI-CM-GROUPING.
  7104             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7105             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7106         16  AI-CM-STATE                       PIC XX.
  7107         16  AI-CM-PRODUCER.
  7108             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7109             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7110         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7111         16  AI-CM-CERTIFICATE-NUMBER.
  7112             20  AI-CM-CERT-PRIME              PIC X(10).
  7113             20  AI-CM-CERT-SFX                PIC X.
  7114         16  AI-CM-DATE                        PIC X(8).
  7115         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7116         16  FILLER                            PIC X(11).
  7117
  7118     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7119         AI-CONTROL-BY-ADMIN-KEY.
  7120         16  AI-CL-COMPANY-CD                  PIC X.
  7121         16  AI-CL-SOURCE                      PIC X.
  7122         16  AI-CL-CARRIER                     PIC X.
  7123         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7124         16  AI-CL-CERTIFICATE-NUMBER.
  7125             20  AI-CL-CERT-PRIME              PIC X(10).
  7126             20  AI-CL-CERT-SFX                PIC X.
  7127         16  AI-CL-DATE                        PIC X(8).
  7128         16  AI-CL-INCURRED-DATE               PIC XX.
  7129         16  AI-CL-CLOSE-DATE                  PIC XX.
  7130         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7131         16  AI-CREDIT-CARD-NUMBER.
  7132             20  AI-CCN.
  7133                 24  AI-CCN-PREFIX             PIC X(4).
  7134                 24  AI-CCN-PRIME              PIC X(12).
  7135             20  AI-CCN-FILLER                 PIC X(4).
  7136
  7137     12  AI-MAINT-INFO.
  7138         16  AI-LAST-MAINT-BY                  PIC X(4).
  7139         16  AI-LAST-MAINT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 128
* EL131.cbl
  7140         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7141
  7142     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7143
  7144     12  FILLER                                PIC X(15).
  7145
  7146
  7147*                                COPY ERCDMDNT.
  7148******************************************************************
  7149*                                                                *
  7150*                            ERCDMDNT                            *
  7151*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7152*                            VMOD=2.005                          *
  7153*                                                                *
  7154*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7155*                                                                *
  7156*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7157*                                                                *
  7158*        FILE TYPE= VSAM,KSDS                                    *
  7159*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7160*                                                                *
  7161*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7162*                                                                *
  7163*        LOG = YES                                               *
  7164*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7165*                                                                *
  7166******************************************************************
  7167
  7168 01  CERTIFICATE-NOTE.
  7169     12  CN-RECORD-ID                     PIC  XX.
  7170         88  VALID-CN-ID                      VALUE 'CN'.
  7171
  7172     12  CN-CONTROL-PRIMARY.
  7173         16  CN-COMPANY-CD                PIC X.
  7174         16  CN-CERT-KEY.
  7175             20  CN-CARRIER               PIC X.
  7176             20  CN-GROUPING.
  7177                 24  CN-GROUPING-PREFIX   PIC XXX.
  7178                 24  CN-GROUPING-PRIME    PIC XXX.
  7179             20  CN-STATE                 PIC XX.
  7180             20  CN-ACCOUNT.
  7181                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7182                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7183             20  CN-CERT-EFF-DT           PIC XX.
  7184             20  CN-CERT-NO.
  7185                 24  CN-CERT-PRIME        PIC X(10).
  7186                 24  CN-CERT-SFX          PIC X.
  7187
  7188     12  CN-BILLING-START-LINE-NO         PIC 99.
  7189     12  CN-BILLING-END-LINE-NO           PIC 99.
  7190
  7191     12  CN-LINES.
  7192         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7193
  7194     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7195         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7196         16  CN-CSI-GENERAL-DATA-AREA.
  7197             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 129
* EL131.cbl
  7198
  7199         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7200             CN-CSI-GENERAL-DATA-AREA.
  7201             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7202             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7203             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7204             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7205             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7206             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7207             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7208             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7209             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7210             20  FILLER                       PIC XX.
  7211             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7212             20  FILLER                       PIC X(38).
  7213
  7214         16  CN-CSI-PRODUCT-DATA-AREA.
  7215             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7216
  7217         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7218             CN-CSI-PRODUCT-DATA-AREA.
  7219             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7220             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7221             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7222             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7223             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7224             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7225             20  FILLER                   PIC XX.
  7226             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7227             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7228             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7229             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7230             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7231             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7232             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7233             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7234             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7235             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7236             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7237             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7238             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7239             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7240             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7241             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7242             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7243             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7244             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7245             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7246             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7247             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7248             20  FILLER                   PIC X(25).
  7249
  7250         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7251             CN-CSI-CREDIT-CARD-DATA.
  7252             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7253             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7254             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7255             20  CN-CSI-FL-CARD-TYPE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 130
* EL131.cbl
  7256             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7257             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7258             20  FILLER                   PIC XX.
  7259             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7260             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7261             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7262             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7263             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7264             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7265             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7266             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7267             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7268             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7269             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7270             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7271             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7272             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7273             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7274             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7275             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7276             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7277             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7278             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7279             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7280             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7281             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7282             20  FILLER                   PIC X(17).
  7283
  7284         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7285             CN-CSI-FAMILY-LEAVE-DATA.
  7286             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7287             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7288             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7289             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7290             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7291             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7292             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7293             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7294             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7295             20  CN-CSI-SL-INT-ON-PROCEEDS
  7296                                          PIC S9(5)V99  COMP-3.
  7297             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7298             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7299             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7300             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7301             20  CN-CSI-SL-POLICY-BENEFITS
  7302                                          PIC S9(5)V99  COMP-3.
  7303             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7304             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7305             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7306             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7307             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7308             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7309             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7310             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7311             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7312             20  CN-CSI-SL-STATE-NOT      PIC X.
  7313             20  FILLER                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 131
* EL131.cbl
  7314
  7315         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7316             CN-CSI-SENIOR-LIFE-DATA.
  7317             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7318             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7319             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7320                                          PIC S9(5)V99  COMP-3.
  7321             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7322             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7323             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7324             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7325             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7326             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7327             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7328             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7329             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7330             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7331             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7332             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7333             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7334             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7335             20  CN-CSI-PP-REPAIR         PIC X.
  7336             20  CN-CSI-PP-REPLACE        PIC X.
  7337             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7338             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7339             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7340             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7341             20  FILLER                   PIC X(5).
  7342
  7343         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7344             CN-CSI-PURCH-PROP-DATA.
  7345             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7346             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7347             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7348             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7349             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7350             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7351             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7352             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7353             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7354             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7355             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7356             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7357             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7358             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7359             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7360             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7361             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7362             20  CN-CSI-EW-REPLACE        PIC X.
  7363             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7364             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7365             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7366             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7367             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7368             20  FILLER                   PIC X(4).
  7369
  7370     12  CN-LAST-MAINT-DT                 PIC XX.
  7371     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 132
* EL131.cbl
  7372     12  CN-LAST-MAINT-USER               PIC X(4).
  7373     12  FILLER                           PIC X(6).
  7374
  7375******************************************************************
  7376
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 133
* EL131.cbl
  7378 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7379                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7380                          CONTROL-FILE ACTIVITY-QUE
  7381                          ACCOUNT-MASTER CHECK-QUE
  7382                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7383                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7384                          CERTIFICATE-NOTE.
  7385 0000-DFHEXIT SECTION.
  7386     MOVE '9#                    $   ' TO DFHEIV0.
  7387     MOVE 'EL131' TO DFHEIV1.
  7388     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7389
  7390     IF EIBCALEN = ZERO
  7391         GO TO 8800-UNAUTHORIZED-ACCESS.
  7392
  7393     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7394     MOVE '5'                    TO DC-OPTION-CODE.
  7395     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7396     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7397     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7398     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7399
  7400     IF SAVE-DATE-YY GREATER 70
  7401         MOVE 19                 TO SAVE-DATE-CC
  7402      ELSE
  7403         MOVE 20                 TO SAVE-DATE-CC.
  7404
  7405
  7406* EXEC CICS HANDLE CONDITION
  7407*        PGMIDERR (8820-XCTL-ERROR)
  7408*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7409*        ERROR    (9990-ABEND)
  7410*    END-EXEC.
  7411*    MOVE '"$LI.                 ! " #00007401' TO DFHEIV0
  7412     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7414     MOVE X'2220233030303037343031' TO DFHEIV0(25:11)
  7415     CALL 'kxdfhei1' USING DFHEIV0
  7416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7417
  7418
  7419     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7420     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7421     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7422
  7423     INITIALIZE    EDIT-WORK-AREA.
  7424     MOVE '/'                    TO WORK-SLASH.
  7425     MOVE SPACES                 TO ERROR-SWITCHES.
  7426
  7427     MOVE TRAN-ID                TO TRANS-ID.
  7428     MOVE EIBTRMID               TO PI-TERM.
  7429     MOVE MAP-ID                 TO PI-QUAL.
  7430
  7431     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7432
  7433     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7434         MOVE LOW-VALUES         TO EL131AO
  7435         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 134
* EL131.cbl
  7436         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7437         MOVE -1                 TO MAINTL
  7438         GO TO 8110-SEND-DATA.
  7439
  7440     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7441         MOVE LOW-VALUES         TO EL131AO
  7442         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7443         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7444         MOVE 'X'                TO PI-RETURN-CD-1
  7445         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7446         MOVE -1                 TO MAINTL
  7447         IF WS-RETURNED-FROM = XCTL-EL114
  7448             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7449         END-IF
  7450         GO TO 8100-SEND-MAP.
  7451
  7452     IF EIBAID = DFHCLEAR
  7453         GO TO 8200-RETURN-PRIOR.
  7454
  7455     IF PI-PROCESSOR-ID = 'LGXX'
  7456         NEXT SENTENCE
  7457     ELSE
  7458
  7459* EXEC CICS READQ TS
  7460*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7461*            INTO    (SECURITY-CONTROL)
  7462*            LENGTH  (SC-COMM-LENGTH)
  7463*            ITEM    (SC-ITEM)
  7464*        END-EXEC
  7465*    MOVE '*$II   L              ''   #00007446' TO DFHEIV0
  7466     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7467     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7468     MOVE X'2020233030303037343436' TO DFHEIV0(25:11)
  7469     CALL 'kxdfhei1' USING DFHEIV0,
  7470           PI-SECURITY-TEMP-STORE-ID,
  7471           SECURITY-CONTROL,
  7472           SC-COMM-LENGTH,
  7473           SC-ITEM,
  7474           DFHEIV99,
  7475           DFHEIV99
  7476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7477         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7478         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7479         IF NOT DISPLAY-CAP
  7480             MOVE 'READ'               TO  SM-READ
  7481             PERFORM 9995-SECURITY-VIOLATION
  7482             MOVE ER-0070              TO  EMI-ERROR
  7483             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7484             GO TO 8100-SEND-MAP.
  7485
  7486
  7487* EXEC CICS RECEIVE
  7488*        MAP    ('EL131A')
  7489*        MAPSET ('EL131S')
  7490*    END-EXEC.
  7491     MOVE 'EL131A' TO DFHEIV1
  7492     MOVE 'EL131S' TO DFHEIV2
  7493*    MOVE '8"T                   ''   #00007461' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 135
* EL131.cbl
  7494     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7495     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7496     MOVE X'2020233030303037343631' TO DFHEIV0(25:11)
  7497     CALL 'kxdfhei1' USING DFHEIV0,
  7498           DFHEIV1,
  7499           EL131AI,
  7500           DFHEIV99,
  7501           DFHEIV2,
  7502           DFHEIV99,
  7503           DFHEIV99
  7504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7505
  7506
  7507     IF PFKEYL GREATER THAN ZERO
  7508         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7509
  7510     IF SCREEN-ERROR
  7511         MOVE ER-0004 TO EMI-ERROR
  7512         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7513         MOVE -1 TO MAINTL
  7514         GO TO 8110-SEND-DATA.
  7515
  7516     IF EIBAID = DFHPF3
  7517         GO TO 8500-TRLR-MNT.
  7518
  7519     IF EIBAID = DFHPF4
  7520         GO TO 8600-ADDR-MNT.
  7521
  7522     IF EIBAID = DFHPF5
  7523         GO TO 8700-CERT-MNT.
  7524
  7525     IF PI-COMPANY-ID = 'DMD'
  7526       IF EIBAID = DFHPF6
  7527         GO TO 8750-DMD-CLM-FIX.
  7528
  7529     IF EIBAID = DFHPF7
  7530         GO TO 4000-FORCE-ERRORS.
  7531
  7532     IF EIBAID = DFHPF12
  7533         GO TO 8300-GET-HELP.
  7534
  7535     IF EIBAID = DFHPF15
  7536         GO TO 8725-BENEFICIARY-MNT
  7537     END-IF.
  7538
  7539     IF EIBAID = DFHPF23
  7540         GO TO 8810-PF23-ENTERED.
  7541
  7542     IF EIBAID = DFHPF24
  7543         GO TO 8400-RETURN-MASTER.
  7544
  7545     IF EIBAID NOT = DFHENTER
  7546         MOVE ER-0029            TO EMI-ERROR
  7547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7548         MOVE -1                 TO MAINTL
  7549         GO TO 8110-SEND-DATA.
  7550
  7551     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 136
* EL131.cbl
  7552         MOVE ER-0311            TO EMI-ERROR
  7553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7554         MOVE -1                 TO MAINTL
  7555         GO TO 8110-SEND-DATA.
  7556
  7557     IF MAINTI = 'A'
  7558         GO TO 0500-ADD-ALPHA-ONLY.
  7559
  7560     IF MAINTI = 'N'
  7561         GO TO 0600-CHANGE-NAME.
  7562
  7563     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7564
  7565     IF SCREEN-ERROR
  7566         GO TO 8110-SEND-DATA.
  7567
  7568     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7569         MOVE ER-0276            TO EMI-ERROR
  7570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7571         MOVE -1                 TO MAINTL
  7572         GO TO 8110-SEND-DATA.
  7573
  7574     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7575
  7576     IF SCREEN-ERROR
  7577         GO TO 8110-SEND-DATA.
  7578
  7579     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7580
  7581     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7582
  7583     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7584         GO TO 8110-SEND-DATA.
  7585
  7586     IF EMI-FATAL-CTR GREATER THAN ZERO
  7587         GO TO 8110-SEND-DATA.
  7588
  7589     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7590
  7591     IF WS-OPEN-CLOSE-SW = 'Y'
  7592         IF PI-LETTER-SW = 'Y'
  7593             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7594             MOVE 'T'            TO  CNTL-REC-TYPE
  7595             MOVE SPACES         TO  CNTL-PROC-ID
  7596             MOVE +0             TO  CNTL-SEQ-NO
  7597
  7598* EXEC CICS READ
  7599*                DATASET   (CNTL-FILE-ID)
  7600*                RIDFLD    (CNTL-KEY)
  7601*                SET       (ADDRESS OF CONTROL-FILE)
  7602*            END-EXEC
  7603*    MOVE '&"S        E          (   #00007556' TO DFHEIV0
  7604     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7605     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7606     MOVE X'2020233030303037353536' TO DFHEIV0(25:11)
  7607     CALL 'kxdfhei1' USING DFHEIV0,
  7608           CNTL-FILE-ID,
  7609           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 137
* EL131.cbl
  7610           DFHEIV99,
  7611           CNTL-KEY,
  7612           DFHEIV99,
  7613           DFHEIV99,
  7614           DFHEIV99
  7615     SET ADDRESS OF CONTROL-FILE TO
  7616         DFHEIV20
  7617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7618             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7619
  7620     MOVE ER-0000                TO EMI-ERROR.
  7621     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7622
  7623     MOVE SPACE                  TO MAINTO.
  7624     MOVE -1                     TO MAINTL.
  7625     GO TO 8100-SEND-MAP.
  7626
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 138
* EL131.cbl
  7628 0100-UPDATE-PI.
  7629
  7630     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7631     IF WS-RETURNED-FROM = XCTL-EL114
  7632***sometimes there is crap in positions 7-10 when no code was sele
  7633        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7634          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7635        END-IF
  7636     END-IF.
  7637
  7638     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7639         GO TO 0110-UPDATE-UP.
  7640
  7641     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7642     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7643     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7644     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7645     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7646     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7647     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7648     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7649     GO TO 0120-UPDATE-PI-EXIT.
  7650
  7651 0110-UPDATE-UP.
  7652     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7653     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7654     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7655     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7656     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7657     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7658     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7659     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7660
  7661
  7662* EXEC CICS HANDLE CONDITION
  7663*         QIDERR    (0130-TS-ERROR)
  7664*         ITEMERR   (0130-TS-ERROR)
  7665*    END-EXEC.
  7666*    MOVE '"$N<                  ! # #00007604' TO DFHEIV0
  7667     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7669     MOVE X'2320233030303037363034' TO DFHEIV0(25:11)
  7670     CALL 'kxdfhei1' USING DFHEIV0
  7671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7672
  7673
  7674     IF WS-RETURNED-FROM = XCTL-EL114
  7675
  7676* EXEC CICS READQ TS
  7677*            QUEUE    (PI-KEY)
  7678*            INTO     (EL131AI)
  7679*            LENGTH   (MAP-LENGTH)
  7680*       END-EXEC
  7681*    MOVE '*$I    L              ''   #00007610' TO DFHEIV0
  7682     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7683     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7684     MOVE X'2020233030303037363130' TO DFHEIV0(25:11)
  7685     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 139
* EL131.cbl
  7686           PI-KEY,
  7687           EL131AI,
  7688           MAP-LENGTH,
  7689           DFHEIV99,
  7690           DFHEIV99,
  7691           DFHEIV99
  7692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7693
  7694        IF WS-SAVE-BENEFICIARY > SPACES
  7695            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7696            MOVE +10            TO BENEL
  7697            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7698        END-IF
  7699        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7700     END-IF.
  7701
  7702
  7703* EXEC CICS READQ TS
  7704*         QUEUE    (PI-KEY)
  7705*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7706*         LENGTH   (PI-COMM-LENGTH)
  7707*    END-EXEC.
  7708*    MOVE '*$I    L              ''   #00007624' TO DFHEIV0
  7709     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7710     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7711     MOVE X'2020233030303037363234' TO DFHEIV0(25:11)
  7712     CALL 'kxdfhei1' USING DFHEIV0,
  7713           PI-KEY,
  7714           PROGRAM-INTERFACE-BLOCK,
  7715           PI-COMM-LENGTH,
  7716           DFHEIV99,
  7717           DFHEIV99,
  7718           DFHEIV99
  7719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7720
  7721
  7722
  7723* EXEC CICS DELETEQ TS
  7724*         QUEUE    (PI-KEY)
  7725*    END-EXEC.
  7726*    MOVE '*&                    #   #00007630' TO DFHEIV0
  7727     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7728     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7729     MOVE X'2020233030303037363330' TO DFHEIV0(25:11)
  7730     CALL 'kxdfhei1' USING DFHEIV0,
  7731           PI-KEY,
  7732           DFHEIV99
  7733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7734
  7735
  7736 0120-UPDATE-PI-EXIT.
  7737     EXIT.
  7738
  7739 0130-TS-ERROR.
  7740     MOVE LOW-VALUES             TO EL131AO.
  7741     MOVE ER-0192                TO EMI-ERROR.
  7742
  7743     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 140
* EL131.cbl
  7744
  7745     GO TO 8100-SEND-MAP.
  7746
  7747 0200-TRANS-PF.
  7748     IF EIBAID NOT = DFHENTER
  7749         MOVE 'X'                TO ERROR-SWITCH
  7750         GO TO 0210-EXIT.
  7751
  7752     IF PFKEYI NOT NUMERIC
  7753         MOVE 'X'                TO ERROR-SWITCH
  7754         GO TO 0210-EXIT.
  7755
  7756     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7757
  7758     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7759         MOVE 'X' TO ERROR-SWITCH
  7760         GO TO 0210-EXIT.
  7761
  7762     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7763
  7764 0210-EXIT.
  7765     EXIT.
  7766
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 141
* EL131.cbl
  7768 0500-ADD-ALPHA-ONLY.
  7769******************************************************************
  7770*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7771*    RECORD.                                                     *
  7772******************************************************************
  7773
  7774     IF MLNAMEL = +0 AND
  7775        MFNAMEL = +0 AND
  7776        MMINITL = +0
  7777         MOVE ER-0797                TO  EMI-ERROR
  7778         MOVE -1                     TO  MAINTL
  7779         MOVE AL-UABON               TO  MAINTA
  7780         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7781         GO TO 8110-SEND-DATA.
  7782
  7783     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7784     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7785     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7786     MOVE PI-CERT-NO                 TO  CERT-NO.
  7787
  7788
  7789* EXEC CICS READ
  7790*        DATASET   (CLMS-FILE-ID)
  7791*        RIDFLD    (MSTR-KEY)
  7792*        SET       (ADDRESS OF CLAIM-MASTER)
  7793*    END-EXEC.
  7794*    MOVE '&"S        E          (   #00007686' TO DFHEIV0
  7795     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7797     MOVE X'2020233030303037363836' TO DFHEIV0(25:11)
  7798     CALL 'kxdfhei1' USING DFHEIV0,
  7799           CLMS-FILE-ID,
  7800           DFHEIV20,
  7801           DFHEIV99,
  7802           MSTR-KEY,
  7803           DFHEIV99,
  7804           DFHEIV99,
  7805           DFHEIV99
  7806     SET ADDRESS OF CLAIM-MASTER TO
  7807         DFHEIV20
  7808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7809
  7810
  7811
  7812* EXEC CICS GETMAIN
  7813*        SET       (ADDRESS OF ALPHA-INDEX)
  7814*        LENGTH    (ALPH-LENGTH)
  7815*        INITIMG   (GETMAIN-SPACE)
  7816*    END-EXEC.
  7817*    MOVE ',"IL                  $   #00007692' TO DFHEIV0
  7818     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7819     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7820     MOVE X'2020233030303037363932' TO DFHEIV0(25:11)
  7821     CALL 'kxdfhei1' USING DFHEIV0,
  7822           DFHEIV20,
  7823           ALPH-LENGTH,
  7824           GETMAIN-SPACE
  7825     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 142
* EL131.cbl
  7826         DFHEIV20
  7827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7828
  7829
  7830     MOVE 'AI'                       TO  AI-RECORD-ID.
  7831     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7832                                         AI-CL-COMPANY-CD.
  7833     MOVE 'C'                        TO  AI-SOURCE
  7834                                         AI-CL-SOURCE.
  7835
  7836     IF MLNAMEL IS GREATER THAN +0
  7837         MOVE MLNAMEI                TO  AI-LAST-NAME
  7838     ELSE
  7839         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7840
  7841     IF MFNAMEL IS GREATER THAN +0
  7842         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7843     ELSE
  7844         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7845
  7846     IF MMINITL IS GREATER THAN +0
  7847         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7848     ELSE
  7849         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7850
  7851     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7852     MOVE '5'                        TO  DC-OPTION-CODE.
  7853     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7854     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7855     IF BUILD-YEAR IS GREATER THAN 50
  7856         MOVE '19'                   TO  WS-ALPHA-YY-1
  7857         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7858         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7859         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7860     ELSE
  7861         MOVE '20'                   TO  WS-ALPHA-YY-1
  7862         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7863         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7864         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7865
  7866     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7867                                         AI-CL-DATE.
  7868
  7869     MOVE EIBTIME                    TO  AI-TIME
  7870                                         AI-CL-TIME.
  7871
  7872     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7873     MOVE 'C'                        TO  AI-CL-SOURCE.
  7874     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7875     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7876     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7877     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7878     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7879
  7880     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7881     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7882     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7883
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 143
* EL131.cbl
  7884
  7885* EXEC CICS WRITE
  7886*        DATASET   (ALPH-FILE-ID)
  7887*        RIDFLD    (AI-CONTROL-PRIMARY)
  7888*        FROM      (ALPHA-INDEX)
  7889*    END-EXEC.
  7890     MOVE LENGTH OF
  7891      ALPHA-INDEX
  7892       TO DFHEIV11
  7893*    MOVE '&$ L                  ''   #00007752' TO DFHEIV0
  7894     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7895     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7896     MOVE X'2020233030303037373532' TO DFHEIV0(25:11)
  7897     CALL 'kxdfhei1' USING DFHEIV0,
  7898           ALPH-FILE-ID,
  7899           ALPHA-INDEX,
  7900           DFHEIV11,
  7901           AI-CONTROL-PRIMARY,
  7902           DFHEIV99,
  7903           DFHEIV99
  7904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7905
  7906
  7907     MOVE LOW-VALUES                 TO  EL131AO.
  7908     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7909     MOVE ER-0000                    TO  EMI-ERROR.
  7910     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7911     MOVE -1                         TO  MAINTL.
  7912     GO TO 8100-SEND-MAP.
  7913
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 144
* EL131.cbl
  7915 0600-CHANGE-NAME.
  7916******************************************************************
  7917*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7918*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7919******************************************************************
  7920
  7921     IF MLNAMEL = +0 AND
  7922        MFNAMEL = +0 AND
  7923        MMINITL = +0
  7924         MOVE ER-0276                TO  EMI-ERROR
  7925         MOVE -1                     TO  MAINTL
  7926         MOVE AL-UABON               TO  MAINTA
  7927         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7928         GO TO 8110-SEND-DATA.
  7929
  7930     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7931     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7932     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7933     MOVE PI-CERT-NO                 TO  CERT-NO.
  7934
  7935
  7936* EXEC CICS READ
  7937*        DATASET   (CLMS-FILE-ID)
  7938*        RIDFLD    (MSTR-KEY)
  7939*        SET       (ADDRESS OF CLAIM-MASTER)
  7940*    END-EXEC.
  7941*    MOVE '&"S        E          (   #00007786' TO DFHEIV0
  7942     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7944     MOVE X'2020233030303037373836' TO DFHEIV0(25:11)
  7945     CALL 'kxdfhei1' USING DFHEIV0,
  7946           CLMS-FILE-ID,
  7947           DFHEIV20,
  7948           DFHEIV99,
  7949           MSTR-KEY,
  7950           DFHEIV99,
  7951           DFHEIV99,
  7952           DFHEIV99
  7953     SET ADDRESS OF CLAIM-MASTER TO
  7954         DFHEIV20
  7955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7956
  7957
  7958
  7959* EXEC CICS GETMAIN
  7960*        SET       (ADDRESS OF ALPHA-INDEX)
  7961*        LENGTH    (ALPH-LENGTH)
  7962*        INITIMG   (GETMAIN-SPACE)
  7963*    END-EXEC.
  7964*    MOVE ',"IL                  $   #00007792' TO DFHEIV0
  7965     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7966     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7967     MOVE X'2020233030303037373932' TO DFHEIV0(25:11)
  7968     CALL 'kxdfhei1' USING DFHEIV0,
  7969           DFHEIV20,
  7970           ALPH-LENGTH,
  7971           GETMAIN-SPACE
  7972     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 145
* EL131.cbl
  7973         DFHEIV20
  7974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7975
  7976
  7977     MOVE 'AI'                       TO  AI-RECORD-ID.
  7978     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7979                                         AI-CL-COMPANY-CD.
  7980     MOVE 'C'                        TO  AI-SOURCE
  7981                                         AI-CL-SOURCE.
  7982
  7983     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7984     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7985     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7986
  7987     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7988     MOVE '5'                        TO  DC-OPTION-CODE.
  7989     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7990     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7991     IF BUILD-YEAR IS GREATER THAN 50
  7992         MOVE '19'                   TO  WS-ALPHA-YY-1
  7993         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7994         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7995         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7996     ELSE
  7997         MOVE '20'                   TO  WS-ALPHA-YY-1
  7998         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7999         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8000         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8001
  8002     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8003                                         AI-CL-DATE.
  8004
  8005     MOVE EIBTIME                    TO  AI-TIME
  8006                                         AI-CL-TIME.
  8007
  8008     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8009     MOVE 'C'                        TO  AI-CL-SOURCE.
  8010     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8011     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8012     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8013     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8014     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8015
  8016     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8017     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8018     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8019
  8020     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8021         MOVE 'Y'                TO CL-YESNOSW
  8022     END-IF.
  8023
  8024
  8025* EXEC CICS WRITE
  8026*        DATASET   (ALPH-FILE-ID)
  8027*        RIDFLD    (AI-CONTROL-PRIMARY)
  8028*        FROM      (ALPHA-INDEX)
  8029*    END-EXEC.
  8030     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 146
* EL131.cbl
  8031      ALPHA-INDEX
  8032       TO DFHEIV11
  8033*    MOVE '&$ L                  ''   #00007845' TO DFHEIV0
  8034     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8035     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8036     MOVE X'2020233030303037383435' TO DFHEIV0(25:11)
  8037     CALL 'kxdfhei1' USING DFHEIV0,
  8038           ALPH-FILE-ID,
  8039           ALPHA-INDEX,
  8040           DFHEIV11,
  8041           AI-CONTROL-PRIMARY,
  8042           DFHEIV99,
  8043           DFHEIV99
  8044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8045
  8046
  8047
  8048* EXEC CICS READ
  8049*        DATASET   (CLMS-FILE-ID)
  8050*        RIDFLD    (MSTR-KEY)
  8051*        SET       (ADDRESS OF CLAIM-MASTER)
  8052*        UPDATE
  8053*    END-EXEC.
  8054*    MOVE '&"S        EU         (   #00007851' TO DFHEIV0
  8055     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8056     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8057     MOVE X'2020233030303037383531' TO DFHEIV0(25:11)
  8058     CALL 'kxdfhei1' USING DFHEIV0,
  8059           CLMS-FILE-ID,
  8060           DFHEIV20,
  8061           DFHEIV99,
  8062           MSTR-KEY,
  8063           DFHEIV99,
  8064           DFHEIV99,
  8065           DFHEIV99
  8066     SET ADDRESS OF CLAIM-MASTER TO
  8067         DFHEIV20
  8068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8069
  8070
  8071     if (cl-priority-cd = '8')
  8072        and (pi-processor-id not = 'PEMA'and 'JMS '
  8073             AND 'AMWA' AND 'KMSB')
  8074        MOVE ER-8003             TO EMI-ERROR
  8075        PERFORM 9900-ERROR-FORMAT
  8076                                 THRU 9900-EXIT
  8077        MOVE -1                  TO MAINTL
  8078        GO TO 8110-SEND-DATA
  8079     end-if
  8080
  8081     IF MLNAMEL IS GREATER THAN +0
  8082         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8083
  8084     IF MFNAMEL IS GREATER THAN +0
  8085         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8086
  8087     IF MMINITL IS GREATER THAN +0
  8088         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 147
* EL131.cbl
  8089
  8090     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8091     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8092     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8093     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8094
  8095     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8096         MOVE 'Y'                TO CL-YESNOSW
  8097     END-IF.
  8098
  8099
  8100* EXEC CICS HANDLE CONDITION
  8101*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8102*    END-EXEC.
  8103*    MOVE '"$$                   ! $ #00007886' TO DFHEIV0
  8104     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8106     MOVE X'2420233030303037383836' TO DFHEIV0(25:11)
  8107     CALL 'kxdfhei1' USING DFHEIV0
  8108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8109
  8110
  8111
  8112* EXEC CICS REWRITE
  8113*        DATASET   (CLMS-FILE-ID)
  8114*        FROM      (CLAIM-MASTER)
  8115*    END-EXEC.
  8116     MOVE LENGTH OF
  8117      CLAIM-MASTER
  8118       TO DFHEIV11
  8119*    MOVE '&& L                  %   #00007890' TO DFHEIV0
  8120     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8121     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8122     MOVE X'2020233030303037383930' TO DFHEIV0(25:11)
  8123     CALL 'kxdfhei1' USING DFHEIV0,
  8124           CLMS-FILE-ID,
  8125           CLAIM-MASTER,
  8126           DFHEIV11,
  8127           DFHEIV99
  8128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8129
  8130
  8131 0600-CONTINUE-NAME-UPDATE.
  8132
  8133     MOVE LOW-VALUES                 TO  EL131AO.
  8134     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8135     MOVE ER-0000                    TO  EMI-ERROR.
  8136     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8137     MOVE -1                         TO  MAINTL.
  8138     GO TO 8100-SEND-MAP.
  8139
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 148
* EL131.cbl
  8141 1000-EDIT-SCREEN.
  8142
  8143     MOVE MAINTI                 TO CHECK-MAINT.
  8144
  8145     IF NOT VALID-OPTIONS
  8146         MOVE 'X'                TO ERROR-SWITCH
  8147         MOVE -1                 TO MAINTL
  8148         MOVE AL-UABON           TO MAINTA
  8149         MOVE ER-0023            TO EMI-ERROR
  8150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8151         GO TO 1010-EXIT.
  8152
  8153     IF NOT MODIFY-CAP
  8154         MOVE 'UPDATE'           TO  SM-READ
  8155         PERFORM 9995-SECURITY-VIOLATION
  8156         MOVE ER-0070               TO  EMI-ERROR
  8157         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8158         GO TO 8100-SEND-MAP.
  8159
  8160     IF DELETE-CLAIM
  8161         MOVE AL-UANON TO MAINTA
  8162         GO TO 1010-EXIT.
  8163
  8164     MOVE AL-UANON               TO MAINTA.
  8165
  8166     IF CCNOI GREATER THAN LOW-VALUES
  8167         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8168
  8169     IF PI-COMPANY-ID = 'CSL'
  8170        CONTINUE
  8171     ELSE
  8172        IF TYPEL > ZERO
  8173           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8174              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8175                    PI-LIFE-OVERRIDE-L1))
  8176                       OR
  8177              ((PI-COMPANY-ID = 'DCC')
  8178              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8179                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8180              MOVE AL-UANON      TO TYPEA
  8181              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8182           ELSE
  8183              MOVE ER-0199       TO EMI-ERROR
  8184              PERFORM 9900-ERROR-FORMAT
  8185                                 THRU 9900-EXIT
  8186              MOVE AL-UABON      TO TYPEA
  8187              MOVE -1            TO TYPEL
  8188              MOVE 'X'           TO ERROR-SWITCH
  8189           END-IF
  8190        ELSE
  8191           MOVE AL-UANOF         TO TYPEA
  8192        END-IF
  8193     END-IF
  8194     IF STATUSI GREATER THAN LOW-VALUES
  8195         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8196             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8197             MOVE AL-UANON       TO STATUSA
  8198             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 149
* EL131.cbl
  8199             MOVE 'Y'            TO DLYACTV-SW
  8200         ELSE
  8201             MOVE ER-0333        TO EMI-ERROR
  8202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8203             MOVE AL-UABON       TO STATUSA
  8204             MOVE -1             TO STATUSL
  8205             MOVE 'X'            TO ERROR-SWITCH
  8206         END-IF
  8207     ELSE
  8208         MOVE SPACE              TO TRLR-SWITCH
  8209         MOVE 'N'                TO DLYACTV-SW
  8210         MOVE AL-UANOF           TO STATUSA.
  8211
  8212     IF PROCI GREATER THAN LOW-VALUES
  8213         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8214     ELSE
  8215         MOVE AL-UANOF TO PROCA.
  8216
  8217     IF SEXI GREATER THAN LOW-VALUES
  8218         IF SEXI = 'F' OR 'M'
  8219             MOVE AL-UANON       TO SEXA
  8220             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8221           ELSE
  8222             MOVE ER-0219        TO EMI-ERROR
  8223             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8224             MOVE AL-UABON       TO SEXA
  8225             MOVE -1             TO SEXL
  8226             MOVE 'X'            TO ERROR-SWITCH
  8227       ELSE
  8228         MOVE AL-UANOF           TO SEXA.
  8229
  8230     IF BIRTHL = +0
  8231         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8232         MOVE AL-UANOF           TO  BIRTHA
  8233         GO TO 1000-CONTINUE-EDITS.
  8234
  8235     IF BIRTHI = SPACES
  8236         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8237         MOVE 'X'                TO  UPDATE-SWITCH
  8238                                     MSTR-SWITCH
  8239         GO TO 1000-CONTINUE-EDITS.
  8240
  8241     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8242     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8243     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8244     MOVE '4'                    TO  DC-OPTION-CODE.
  8245     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8246     IF DATE-CONVERSION-ERROR
  8247         MOVE ER-0220            TO  EMI-ERROR
  8248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8249         MOVE AL-UABON           TO  BIRTHA
  8250         MOVE -1                 TO  BIRTHL
  8251         MOVE 'X'                TO  ERROR-SWITCH
  8252         GO TO 1000-CONTINUE-EDITS.
  8253
  8254******************************************************************
  8255**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8256**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 150
* EL131.cbl
  8257**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8258******************************************************************
  8259     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8260         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8261         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8262         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8263         MOVE '4'                TO  DC-OPTION-CODE
  8264         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8265         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8266                                     DC-ELAPSED-DAYS
  8267         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8268         IF DATE-CONVERSION-ERROR
  8269             MOVE ER-0220        TO  EMI-ERROR
  8270             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8271             MOVE AL-UABON       TO  BIRTHA
  8272             MOVE -1             TO  BIRTHL
  8273             MOVE 'X'            TO  ERROR-SWITCH
  8274             GO TO 1000-CONTINUE-EDITS.
  8275
  8276     MOVE AL-UANON               TO  BIRTHA.
  8277     MOVE 'X'                    TO  UPDATE-SWITCH
  8278                                     MSTR-SWITCH.
  8279     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8280     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8281     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8282
  8283 1000-CONTINUE-EDITS.
  8284
  8285     IF SOCIALI GREATER THAN LOW-VALUES
  8286         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8287         IF WS-SOC-SEC-NO NUMERIC AND
  8288           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8289             NEXT SENTENCE
  8290         ELSE
  8291            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8292               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8293               WS-SSN-DASH2 = '-'
  8294                 NEXT SENTENCE
  8295            ELSE
  8296                 MOVE ER-0887        TO  EMI-ERROR
  8297                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8298                 MOVE AL-UABON       TO  SOCIALA
  8299                 MOVE -1             TO  SOCIALL
  8300                 MOVE 'X'            TO  ERROR-SWITCH
  8301            END-IF
  8302        END-IF
  8303     END-IF.
  8304
  8305     IF SOCIALI GREATER THAN LOW-VALUES
  8306         MOVE AL-UANON           TO SOCIALA
  8307         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8308     ELSE
  8309         MOVE AL-UANOF           TO SOCIALA.
  8310
  8311     IF OCCI GREATER THAN LOW-VALUES
  8312         MOVE AL-UANON           TO OCCA
  8313         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8314     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 151
* EL131.cbl
  8315         MOVE AL-UANOF           TO OCCA.
  8316
  8317     IF BENEL NOT GREATER THAN ZERO
  8318            GO TO 1005-CONTINUE-EDITS.
  8319
  8320     IF BENEI = SPACES
  8321        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8322           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8323           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8324           IF AUTO-PAY-TO-BENE = 'Y'
  8325               MOVE ER-1773      TO  EMI-ERROR
  8326               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8327               MOVE 'X'          TO ERROR-SWITCH
  8328               MOVE AL-UABON     TO BENEA
  8329               MOVE -1           TO BENEL
  8330           ELSE
  8331               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8332           END-IF
  8333        ELSE
  8334           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8335        END-IF
  8336        GO TO 1005-CONTINUE-EDITS.
  8337
  8338
  8339* EXEC CICS HANDLE CONDITION
  8340*        NOTFND (1004-BENE-NOT-FOUND)
  8341*    END-EXEC.
  8342*    MOVE '"$I                   ! % #00008102' TO DFHEIV0
  8343     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8345     MOVE X'2520233030303038313032' TO DFHEIV0(25:11)
  8346     CALL 'kxdfhei1' USING DFHEIV0
  8347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8348
  8349
  8350     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8351     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8352     MOVE BENEI                  TO  WS-ELBENE-ID.
  8353
  8354
  8355* EXEC CICS READ
  8356*        DATASET ('ELBENE')
  8357*        RIDFLD  (WS-ELBENE-KEY)
  8358*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8359*    END-EXEC.
  8360     MOVE 'ELBENE' TO DFHEIV1
  8361*    MOVE '&"S        E          (   #00008110' TO DFHEIV0
  8362     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8363     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8364     MOVE X'2020233030303038313130' TO DFHEIV0(25:11)
  8365     CALL 'kxdfhei1' USING DFHEIV0,
  8366           DFHEIV1,
  8367           DFHEIV20,
  8368           DFHEIV99,
  8369           WS-ELBENE-KEY,
  8370           DFHEIV99,
  8371           DFHEIV99,
  8372           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 152
* EL131.cbl
  8373     SET ADDRESS OF BENEFICIARY-MASTER TO
  8374         DFHEIV20
  8375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8376
  8377
  8378     MOVE AL-UANON               TO  BENEA.
  8379     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8380
  8381     GO TO 1005-CONTINUE-EDITS.
  8382
  8383 1004-BENE-NOT-FOUND.
  8384     MOVE ER-0565                TO  EMI-ERROR.
  8385
  8386     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8387     MOVE 'X'                    TO ERROR-SWITCH.
  8388     MOVE AL-UABON               TO BENEA.
  8389     MOVE -1                     TO BENEL.
  8390
  8391 1005-CONTINUE-EDITS.
  8392
  8393     IF DIAGI GREATER THAN LOW-VALUES
  8394         MOVE AL-UANON           TO DIAGA
  8395         MOVE 'X'                TO UPDATE-SWITCH
  8396                                    NINETY-TRLR-SWITCH
  8397     ELSE
  8398         MOVE AL-UANOF           TO DIAGA.
  8399
  8400     IF ICD1I GREATER THAN LOW-VALUES
  8401         IF (ICD1I GREATER THAN SPACES) AND
  8402            (ICD1I(4:1) NOT = '.')
  8403             IF ICD1I(4:1) = ' '
  8404                 MOVE '.' TO ICD1I(4:1)
  8405             ELSE
  8406                 IF ICD1I(8:1) = ' '
  8407                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8408                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8409                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8410                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8411                     MOVE '.'        TO ICD1I(4:1)
  8412                 END-IF
  8413             END-IF
  8414         END-IF
  8415         IF (ICD1I GREATER THAN SPACES) AND
  8416            (ICD1I(1:1) NOT > ' ' OR
  8417             ICD1I(2:1) NOT > ' ' OR
  8418             ICD1I(3:1) NOT > ' ' OR
  8419             ICD1I(4:1) NOT = '.')
  8420              MOVE ER-0992        TO  EMI-ERROR
  8421              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8422              MOVE 'X'            TO ERROR-SWITCH
  8423              MOVE AL-UABON       TO ICD1A
  8424              MOVE -1             TO ICD1L
  8425         ELSE
  8426             MOVE AL-UANON       TO ICD1A
  8427             MOVE 'X'            TO UPDATE-SWITCH
  8428                                    NINETY-TRLR-SWITCH
  8429         END-IF
  8430     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 153
* EL131.cbl
  8431         MOVE AL-UANOF           TO ICD1A
  8432     END-IF.
  8433
  8434     IF ICD2I GREATER THAN LOW-VALUES
  8435         IF (ICD2I GREATER THAN SPACES) AND
  8436            (ICD2I(4:1) NOT = '.')
  8437             IF ICD2I(4:1) = ' '
  8438                 MOVE '.' TO ICD2I(4:1)
  8439             ELSE
  8440                 IF ICD2I(8:1) = ' '
  8441                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8442                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8443                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8444                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8445                     MOVE '.'        TO ICD2I(4:1)
  8446                 END-IF
  8447             END-IF
  8448         END-IF
  8449         IF (ICD2I GREATER THAN SPACES) AND
  8450            (ICD2I(1:1) NOT > ' ' OR
  8451             ICD2I(2:1) NOT > ' ' OR
  8452             ICD2I(3:1) NOT > ' ' OR
  8453             ICD2I(4:1) NOT = '.')
  8454              MOVE ER-0992        TO EMI-ERROR
  8455              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8456              MOVE 'X'            TO ERROR-SWITCH
  8457              MOVE AL-UABON       TO ICD2A
  8458              MOVE -1             TO ICD2L
  8459         ELSE
  8460             MOVE AL-UANON       TO ICD2A
  8461             MOVE 'X'            TO UPDATE-SWITCH
  8462                                    NINETY-TRLR-SWITCH
  8463         END-IF
  8464     ELSE
  8465         MOVE AL-UANOF           TO ICD2A
  8466     END-IF.
  8467
  8468*    IF CAUSEI GREATER THAN LOW-VALUES
  8469*        MOVE AL-UANON           TO CAUSEA
  8470*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8471*    ELSE
  8472*        MOVE AL-UANOF           TO CAUSEA.
  8473
  8474*    IF ENDL GREATER THAN ZERO
  8475*        MOVE LOW-VALUES         TO HOLD-END
  8476*        IF ENDI = SPACES
  8477*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8478*        ELSE
  8479*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8480*            EXEC CICS BIF DEEDIT
  8481*                FIELD    (DEEDIT-DATE-INPUT)
  8482*                LENGTH   (DATE-LENGTH)
  8483*            END-EXEC
  8484*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8485*            MOVE '4'            TO DC-OPTION-CODE
  8486*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8487*            IF NOT DATE-CONVERSION-ERROR
  8488*                MOVE DC-BIN-DATE-1      TO HOLD-END
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 154
* EL131.cbl
  8489*                MOVE AL-UANON   TO ENDA
  8490*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8491*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8492*            ELSE
  8493*                MOVE ER-0224    TO EMI-ERROR
  8494*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8495*                MOVE AL-UABON   TO ENDA
  8496*                MOVE -1         TO ENDL
  8497*                MOVE 'X'        TO ERROR-SWITCH
  8498*      ELSE
  8499*          MOVE AL-UANOF         TO ENDA.
  8500
  8501     IF INCL GREATER THAN ZERO
  8502         MOVE LOW-VALUES         TO HOLD-INCUR
  8503         IF INCI = SPACES
  8504             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8505         ELSE
  8506             MOVE INCI           TO DEEDIT-DATE-INPUT
  8507
  8508* EXEC CICS BIF DEEDIT
  8509*                FIELD    (DEEDIT-DATE-INPUT)
  8510*                LENGTH   (DATE-LENGTH)
  8511*            END-EXEC
  8512*    MOVE '@"L                   #   #00008245' TO DFHEIV0
  8513     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8514     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8515     MOVE X'2020233030303038323435' TO DFHEIV0(25:11)
  8516     CALL 'kxdfhei1' USING DFHEIV0,
  8517           DEEDIT-DATE-INPUT,
  8518           DATE-LENGTH
  8519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8520             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8521             MOVE '4'            TO DC-OPTION-CODE
  8522             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8523             IF NOT DATE-CONVERSION-ERROR
  8524                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8525                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8526                 MOVE AL-UANON           TO INCA
  8527                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8528             ELSE
  8529                 MOVE ER-0222    TO EMI-ERROR
  8530                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8531                 MOVE AL-UABON   TO INCA
  8532                 MOVE -1         TO INCL
  8533                 MOVE 'X'        TO ERROR-SWITCH
  8534       ELSE
  8535           IF PI-NO-PMTS = ZEROS
  8536               MOVE AL-UANOF     TO INCA.
  8537
  8538     IF REPL GREATER THAN ZERO
  8539         MOVE LOW-VALUES         TO HOLD-REPORTED
  8540         IF REPI = SPACES
  8541             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8542         ELSE
  8543             MOVE REPI           TO DEEDIT-DATE-INPUT
  8544
  8545* EXEC CICS BIF DEEDIT
  8546*                FIELD    (DEEDIT-DATE-INPUT)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 155
* EL131.cbl
  8547*                LENGTH   (DATE-LENGTH)
  8548*            END-EXEC
  8549*    MOVE '@"L                   #   #00008273' TO DFHEIV0
  8550     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8551     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8552     MOVE X'2020233030303038323733' TO DFHEIV0(25:11)
  8553     CALL 'kxdfhei1' USING DFHEIV0,
  8554           DEEDIT-DATE-INPUT,
  8555           DATE-LENGTH
  8556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8557             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8558             MOVE '4'            TO DC-OPTION-CODE
  8559             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8560             IF NOT DATE-CONVERSION-ERROR
  8561                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8562                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8563                 MOVE AL-UANON   TO REPA
  8564                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8565             ELSE
  8566                 MOVE ER-0223    TO EMI-ERROR
  8567                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8568                 MOVE AL-UABON   TO REPA
  8569                 MOVE -1         TO REPL
  8570                 MOVE 'X'        TO ERROR-SWITCH
  8571       ELSE
  8572         MOVE AL-UANOF TO REPA.
  8573
  8574     IF PDTHRUI GREATER THAN LOW-VALUES
  8575        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8576        IF PDTHRUI = SPACES
  8577           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8578        ELSE
  8579           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8580
  8581* EXEC CICS BIF DEEDIT
  8582*               FIELD    (DEEDIT-DATE-INPUT)
  8583*               LENGTH   (DATE-LENGTH)
  8584*          END-EXEC
  8585*    MOVE '@"L                   #   #00008300' TO DFHEIV0
  8586     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8587     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8588     MOVE X'2020233030303038333030' TO DFHEIV0(25:11)
  8589     CALL 'kxdfhei1' USING DFHEIV0,
  8590           DEEDIT-DATE-INPUT,
  8591           DATE-LENGTH
  8592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8593           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8594           MOVE '4'            TO DC-OPTION-CODE
  8595           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8596           IF NOT DATE-CONVERSION-ERROR
  8597              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8598              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8599              MOVE AL-UANON   TO PDTHRUA
  8600              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8601              IF PI-USES-PAID-TO
  8602                 MOVE '6'            TO DC-OPTION-CODE
  8603                 MOVE -1             TO DC-ELAPSED-DAYS
  8604                 MOVE +0             TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 156
* EL131.cbl
  8605                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8606                 IF NO-CONVERSION-ERROR
  8607                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8608                 ELSE
  8609                    NEXT SENTENCE
  8610              ELSE
  8611                 NEXT SENTENCE
  8612           ELSE
  8613              MOVE ER-0475    TO EMI-ERROR
  8614              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8615              MOVE AL-UABON   TO PDTHRUA
  8616              MOVE -1         TO PDTHRUL
  8617              MOVE 'X'        TO ERROR-SWITCH
  8618     ELSE
  8619        IF MODIFY-CAP
  8620           MOVE AL-UANOF        TO PDTHRUA.
  8621
  8622     IF PDAMTL GREATER THAN +0
  8623         MOVE ZEROS              TO HOLD-PDAMT
  8624
  8625* EXEC CICS BIF DEEDIT
  8626*            FIELD    (PDAMTI)
  8627*            LENGTH   (9)
  8628*        END-EXEC
  8629     MOVE 9
  8630       TO DFHEIV11
  8631*    MOVE '@"L                   #   #00008335' TO DFHEIV0
  8632     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8633     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8634     MOVE X'2020233030303038333335' TO DFHEIV0(25:11)
  8635     CALL 'kxdfhei1' USING DFHEIV0,
  8636           PDAMTI,
  8637           DFHEIV11
  8638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8639         IF PDAMTI NUMERIC
  8640             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8641             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8642             MOVE AL-UNNON       TO PDAMTA
  8643         ELSE
  8644             MOVE ER-0547        TO EMI-ERROR
  8645             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8646             MOVE AL-UNBON       TO PDAMTA
  8647             MOVE -1             TO PDAMTL
  8648             MOVE 'X'            TO ERROR-SWITCH
  8649     ELSE
  8650         IF MODIFY-CAP
  8651            MOVE AL-UNNOF        TO PDAMTA.
  8652
  8653     IF NODAYSI GREATER THAN LOW-VALUES
  8654         MOVE ZEROS              TO HOLD-NODAYS
  8655
  8656* EXEC CICS BIF DEEDIT
  8657*            FIELD (NODAYSI)
  8658*            LENGTH (5)
  8659*        END-EXEC
  8660     MOVE 5
  8661       TO DFHEIV11
  8662*    MOVE '@"L                   #   #00008355' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 157
* EL131.cbl
  8663     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8665     MOVE X'2020233030303038333535' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           NODAYSI,
  8668           DFHEIV11
  8669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8670         IF NODAYSI NUMERIC
  8671             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8672             MOVE AL-UNNON       TO NODAYSA
  8673             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8674         ELSE
  8675             MOVE ER-0491        TO EMI-ERROR
  8676             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8677             MOVE AL-UNBON       TO NODAYSA
  8678             MOVE -1             TO NODAYSL
  8679             MOVE 'X'            TO ERROR-SWITCH
  8680     ELSE
  8681         IF MODIFY-CAP
  8682            MOVE AL-UNNOF        TO NODAYSA.
  8683
  8684     IF NOPMTSI GREATER THAN LOW-VALUES
  8685         MOVE ZEROS              TO HOLD-NOPMTS
  8686
  8687* EXEC CICS BIF DEEDIT
  8688*            FIELD (NOPMTSI)
  8689*            LENGTH (4)
  8690*        END-EXEC
  8691     MOVE 4
  8692       TO DFHEIV11
  8693*    MOVE '@"L                   #   #00008375' TO DFHEIV0
  8694     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8695     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8696     MOVE X'2020233030303038333735' TO DFHEIV0(25:11)
  8697     CALL 'kxdfhei1' USING DFHEIV0,
  8698           NOPMTSI,
  8699           DFHEIV11
  8700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8701         IF NOPMTSI NUMERIC
  8702             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8703             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8704             MOVE AL-UNNON       TO NOPMTSA
  8705           ELSE
  8706             MOVE ER-0548        TO EMI-ERROR
  8707             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8708             MOVE AL-UNBON       TO NOPMTSA
  8709             MOVE -1             TO NOPMTSL
  8710             MOVE 'X'            TO ERROR-SWITCH
  8711       ELSE
  8712         IF MODIFY-CAP
  8713            MOVE AL-UNNOF        TO NOPMTSA.
  8714
  8715     IF FORMTYPI GREATER THAN LOW-VALUES
  8716         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8717             MOVE AL-UANON       TO FORMTYPA
  8718             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8719           ELSE
  8720             MOVE ER-7650        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 158
* EL131.cbl
  8721             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8722             MOVE AL-UABON       TO FORMTYPA
  8723             MOVE -1             TO FORMTYPL
  8724             MOVE 'X'            TO ERROR-SWITCH
  8725       ELSE
  8726         MOVE AL-UANOF           TO FORMTYPA.
  8727
  8728     IF PRICDL GREATER THAN ZERO
  8729         IF (PRICDI = ' ') OR
  8730            (PRICDI GREATER THAN ZERO   AND
  8731             PRICDI NOT GREATER THAN '9')
  8732             MOVE AL-UANON       TO PRICDA
  8733             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8734         ELSE
  8735             MOVE ER-0274        TO EMI-ERROR
  8736             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8737             MOVE AL-UABON       TO PRICDA
  8738             MOVE -1             TO PRICDL
  8739             MOVE 'X'            TO ERROR-SWITCH
  8740     ELSE
  8741         MOVE AL-UANOF TO PRICDA.
  8742
  8743     IF PI-COMPANY-ID = 'DMD'
  8744     IF PRICDL GREATER THAN ZERO
  8745       IF SYSTEM-MODIFY-CAP  OR
  8746          PI-PROCESSOR-ID = 'LGXX'
  8747             NEXT SENTENCE
  8748           ELSE
  8749            IF CL-PRIORITY-CD = '9'  OR
  8750               PRICDI         = '9'
  8751                  MOVE ER-0938        TO EMI-ERROR
  8752                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8753                  MOVE AL-UABON       TO PRICDA
  8754                  MOVE -1             TO PRICDL
  8755                  MOVE 'X'            TO ERROR-SWITCH.
  8756
  8757     IF FILETOL GREATER THAN ZERO
  8758         MOVE AL-UANON           TO FILETOA
  8759         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8760     ELSE
  8761         MOVE AL-UANOF TO FILETOA.
  8762
  8763     IF SUPVL GREATER THAN ZERO
  8764         IF SUPVI = 'Y' OR 'N' OR SPACE
  8765             MOVE AL-UANON       TO SUPVA
  8766             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8767         ELSE
  8768             MOVE ER-0230        TO EMI-ERROR
  8769             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8770             MOVE AL-UABON       TO SUPVA
  8771             MOVE -1             TO SUPVL
  8772             MOVE 'X'            TO ERROR-SWITCH
  8773     ELSE
  8774         MOVE AL-UANOF           TO SUPVA.
  8775
  8776     IF MLNAMEL GREATER THAN ZERO
  8777         IF MLNAMEI GREATER THAN SPACES
  8778            MOVE AL-UANON        TO MLNAMEA
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 159
* EL131.cbl
  8779            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8780                                     MSTR-KEY-SWITCH
  8781         ELSE
  8782            MOVE ER-0236         TO EMI-ERROR
  8783            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8784            MOVE AL-UABON        TO MLNAMEA
  8785            MOVE -1              TO MLNAMEL
  8786            MOVE 'X'             TO ERROR-SWITCH
  8787     ELSE
  8788         MOVE AL-UANOF           TO MLNAMEA.
  8789
  8790     IF MFNAMEI GREATER THAN LOW-VALUES
  8791         MOVE AL-UANON           TO MFNAMEA
  8792         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8793     ELSE
  8794         MOVE AL-UANOF           TO MFNAMEA.
  8795
  8796     IF MMINITI GREATER THAN LOW-VALUES
  8797         MOVE AL-UANON           TO MMINITA
  8798         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8799     ELSE
  8800         MOVE AL-UANOF           TO MMINITA.
  8801
  8802     IF CRTLNMEI GREATER THAN LOW-VALUES
  8803         IF CRTLNMEI NOT = SPACES
  8804            MOVE AL-UANON        TO CRTLNMEA
  8805            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8806                                     CERT-KEY-SWITCH
  8807        ELSE
  8808            MOVE ER-0236         TO EMI-ERROR
  8809            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8810            MOVE AL-UABON        TO CRTLNMEA
  8811            MOVE -1              TO CRTLNMEL
  8812            MOVE 'X'             TO ERROR-SWITCH
  8813     ELSE
  8814         MOVE AL-UANOF           TO CRTLNMEA.
  8815
  8816     IF CRTFNMEI GREATER THAN LOW-VALUES
  8817         MOVE AL-UANON           TO CRTFNMEA
  8818         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8819     ELSE
  8820         MOVE AL-UANOF           TO CRTFNMEA.
  8821
  8822     IF CRTINITI GREATER THAN LOW-VALUES
  8823         MOVE AL-UANON           TO CRTINITA
  8824         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8825     ELSE
  8826         MOVE AL-UANOF           TO CRTINITA.
  8827
  8828     IF ISSAGEL GREATER THAN ZERO
  8829         IF ISSAGEI NUMERIC
  8830            MOVE AL-UANON        TO ISSAGEA
  8831            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8832         ELSE
  8833            MOVE ER-0237         TO EMI-ERROR
  8834            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8835            MOVE AL-UABON        TO ISSAGEA
  8836            MOVE -1              TO ISSAGEL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 160
* EL131.cbl
  8837            MOVE 'X'             TO ERROR-SWITCH
  8838     ELSE
  8839         MOVE AL-UANOF           TO ISSAGEA.
  8840
  8841     IF JNTFNMEI GREATER THAN LOW-VALUES
  8842         MOVE AL-UANON           TO JNTFNMEA
  8843         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8844     ELSE
  8845         MOVE AL-UANOF           TO JNTFNMEA.
  8846
  8847     IF JNTLNMEI GREATER THAN LOW-VALUES
  8848         MOVE AL-UANON           TO JNTLNMEA
  8849         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8850     ELSE
  8851         MOVE AL-UANOF           TO JNTLNMEA.
  8852
  8853     IF JNTINITI GREATER THAN LOW-VALUES
  8854         MOVE AL-UANON           TO JNTINITA
  8855         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8856     ELSE
  8857         MOVE AL-UANOF           TO JNTINITA.
  8858
  8859     IF JNTAGEL GREATER THAN ZERO
  8860         IF JNTAGEI NUMERIC
  8861            MOVE AL-UANON        TO JNTAGEA
  8862            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8863         ELSE
  8864            MOVE ER-0238         TO EMI-ERROR
  8865            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8866            MOVE AL-UABON        TO JNTAGEA
  8867            MOVE -1              TO JNTAGEL
  8868            MOVE 'X'             TO ERROR-SWITCH
  8869     ELSE
  8870         MOVE AL-UANOF           TO JNTAGEA.
  8871
  8872     IF ADDONDTI GREATER THAN LOW-VALUES
  8873         MOVE LOW-VALUES         TO HOLD-ADDON
  8874         IF ADDONDTI = SPACES
  8875             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8876         ELSE
  8877             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8878
  8879* EXEC CICS BIF DEEDIT
  8880*                FIELD    (DEEDIT-DATE-INPUT)
  8881*                LENGTH   (DATE-LENGTH)
  8882*            END-EXEC
  8883*    MOVE '@"L                   #   #00008556' TO DFHEIV0
  8884     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8885     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8886     MOVE X'2020233030303038353536' TO DFHEIV0(25:11)
  8887     CALL 'kxdfhei1' USING DFHEIV0,
  8888           DEEDIT-DATE-INPUT,
  8889           DATE-LENGTH
  8890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8891             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8892             MOVE '4'            TO DC-OPTION-CODE
  8893             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8894             IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 161
* EL131.cbl
  8895                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8896                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8897                                                  CERT-SWITCH
  8898                 MOVE AL-UANON   TO ADDONDTA
  8899                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8900             ELSE
  8901                 MOVE ER-7651    TO EMI-ERROR
  8902                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8903                 MOVE AL-UABON   TO ADDONDTA
  8904                 MOVE -1         TO ADDONDTL
  8905                 MOVE 'X'        TO ERROR-SWITCH
  8906       ELSE
  8907         MOVE AL-UANOF TO ADDONDTA.
  8908
  8909     IF LCVCDI GREATER THAN LOW-VALUES
  8910         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8911         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8912     ELSE
  8913         MOVE AL-UANOF           TO LCVCDA.
  8914
  8915     IF ACVCDI GREATER THAN LOW-VALUES
  8916         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8917         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8918     ELSE
  8919         MOVE AL-UANOF           TO ACVCDA.
  8920
  8921     IF LCVOTRMI GREATER THAN LOW-VALUES
  8922
  8923* EXEC CICS BIF DEEDIT
  8924*            FIELD (LCVOTRMI)
  8925*            LENGTH(3)
  8926*        END-EXEC
  8927     MOVE 3
  8928       TO DFHEIV11
  8929*    MOVE '@"L                   #   #00008591' TO DFHEIV0
  8930     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8931     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8932     MOVE X'2020233030303038353931' TO DFHEIV0(25:11)
  8933     CALL 'kxdfhei1' USING DFHEIV0,
  8934           LCVOTRMI,
  8935           DFHEIV11
  8936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8937         IF LCVOTRMI IS NUMERIC
  8938             MOVE LCVOTRMI       TO LCVOTRMO
  8939             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8940             MOVE AL-UANON       TO LCVOTRMA
  8941         ELSE
  8942             MOVE ER-0241        TO EMI-ERROR
  8943             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8944             MOVE AL-UNBON       TO LCVOTRMA
  8945             MOVE 'X'            TO ERROR-SWITCH
  8946             MOVE -1             TO LCVOTRML
  8947     ELSE
  8948         MOVE AL-UANOF           TO LCVOTRMA.
  8949
  8950     IF ACVOTRMI GREATER THAN LOW-VALUES
  8951
  8952* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 162
* EL131.cbl
  8953*            FIELD (ACVOTRMI)
  8954*            LENGTH(3)
  8955*        END-EXEC
  8956     MOVE 3
  8957       TO DFHEIV11
  8958*    MOVE '@"L                   #   #00008609' TO DFHEIV0
  8959     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8960     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8961     MOVE X'2020233030303038363039' TO DFHEIV0(25:11)
  8962     CALL 'kxdfhei1' USING DFHEIV0,
  8963           ACVOTRMI,
  8964           DFHEIV11
  8965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8966         IF ACVOTRMI IS NUMERIC
  8967             MOVE ACVOTRMI       TO ACVOTRMO
  8968             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8969             MOVE AL-UANON       TO ACVOTRMA
  8970         ELSE
  8971             MOVE ER-0241        TO EMI-ERROR
  8972             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8973             MOVE AL-UNBON       TO ACVOTRMA
  8974             MOVE 'X'            TO ERROR-SWITCH
  8975             MOVE -1             TO ACVOTRML
  8976     ELSE
  8977         MOVE AL-UANOF           TO ACVOTRMA.
  8978
  8979     IF LCVRATEL GREATER THAN +0
  8980
  8981* EXEC CICS BIF DEEDIT
  8982*            FIELD (LCVRATEI)
  8983*            LENGTH(6)
  8984*        END-EXEC
  8985     MOVE 6
  8986       TO DFHEIV11
  8987*    MOVE '@"L                   #   #00008627' TO DFHEIV0
  8988     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8989     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8990     MOVE X'2020233030303038363237' TO DFHEIV0(25:11)
  8991     CALL 'kxdfhei1' USING DFHEIV0,
  8992           LCVRATEI,
  8993           DFHEIV11
  8994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8995         IF LCVRATEI IS NUMERIC
  8996             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8997             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8998             MOVE AL-UNNON       TO LCVRATEA
  8999         ELSE
  9000             MOVE ER-2280        TO EMI-ERROR
  9001             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9002             MOVE AL-UNBON       TO LCVRATEA
  9003             MOVE 'X'            TO ERROR-SWITCH
  9004             MOVE -1             TO LCVRATEL
  9005     ELSE
  9006         MOVE AL-UNNOF           TO LCVRATEA.
  9007
  9008     IF ACVRATEL GREATER THAN +0
  9009
  9010* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 163
* EL131.cbl
  9011*            FIELD (ACVRATEI)
  9012*            LENGTH(6)
  9013*        END-EXEC
  9014     MOVE 6
  9015       TO DFHEIV11
  9016*    MOVE '@"L                   #   #00008645' TO DFHEIV0
  9017     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9018     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9019     MOVE X'2020233030303038363435' TO DFHEIV0(25:11)
  9020     CALL 'kxdfhei1' USING DFHEIV0,
  9021           ACVRATEI,
  9022           DFHEIV11
  9023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9024         IF ACVRATEI IS NUMERIC
  9025             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9026             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9027             MOVE AL-UNNON       TO ACVRATEA
  9028         ELSE
  9029             MOVE ER-2280        TO EMI-ERROR
  9030             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9031             MOVE AL-UNBON       TO ACVRATEA
  9032             MOVE 'X'            TO ERROR-SWITCH
  9033             MOVE -1             TO ACVRATEL
  9034     ELSE
  9035         MOVE AL-UNNOF           TO ACVRATEA.
  9036
  9037     IF LCVBENEL GREATER THAN ZERO
  9038
  9039* EXEC CICS BIF DEEDIT
  9040*            FIELD (LCVBENEI)
  9041*            LENGTH (11)
  9042*        END-EXEC
  9043     MOVE 11
  9044       TO DFHEIV11
  9045*    MOVE '@"L                   #   #00008663' TO DFHEIV0
  9046     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9047     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9048     MOVE X'2020233030303038363633' TO DFHEIV0(25:11)
  9049     CALL 'kxdfhei1' USING DFHEIV0,
  9050           LCVBENEI,
  9051           DFHEIV11
  9052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9053         IF LCVBENEI IS NUMERIC
  9054            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9055            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9056            MOVE AL-UNNON        TO LCVBENEA
  9057         ELSE
  9058            MOVE ER-0243         TO EMI-ERROR
  9059            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9060            MOVE AL-UNBON        TO LCVBENEA
  9061            MOVE -1              TO LCVBENEL
  9062            MOVE 'X'             TO ERROR-SWITCH
  9063     ELSE
  9064         MOVE AL-UANOF           TO LCVBENEA.
  9065
  9066     IF ACVBENEL GREATER THAN ZERO
  9067
  9068* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 164
* EL131.cbl
  9069*            FIELD (ACVBENEI)
  9070*            LENGTH (11)
  9071*        END-EXEC
  9072     MOVE 11
  9073       TO DFHEIV11
  9074*    MOVE '@"L                   #   #00008681' TO DFHEIV0
  9075     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9076     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9077     MOVE X'2020233030303038363831' TO DFHEIV0(25:11)
  9078     CALL 'kxdfhei1' USING DFHEIV0,
  9079           ACVBENEI,
  9080           DFHEIV11
  9081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9082         IF ACVBENEI IS NUMERIC
  9083            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9084            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9085            MOVE AL-UNNON        TO ACVBENEA
  9086         ELSE
  9087            MOVE ER-0243         TO EMI-ERROR
  9088            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9089            MOVE AL-UNBON        TO ACVBENEA
  9090            MOVE -1              TO ACVBENEL
  9091            MOVE 'X'             TO ERROR-SWITCH
  9092     ELSE
  9093         MOVE AL-UANOF           TO ACVBENEA.
  9094
  9095     IF LCVFORMI GREATER THAN LOW-VALUES
  9096        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9097        MOVE AL-UANON            TO LCVFORMA
  9098     ELSE
  9099        MOVE AL-UANOF            TO LCVFORMA.
  9100
  9101     IF ACVFORMI GREATER THAN LOW-VALUES
  9102        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9103        MOVE AL-UANON            TO ACVFORMA
  9104     ELSE
  9105        MOVE AL-UANOF            TO ACVFORMA.
  9106
  9107     IF LCVCNDTL GREATER THAN ZERO
  9108         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9109         IF LCVCNDTI = SPACES
  9110             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9111         ELSE
  9112             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9113             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9114             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9115             MOVE '4'            TO DC-OPTION-CODE
  9116             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9117             IF NOT DATE-CONVERSION-ERROR
  9118                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9119                 MOVE AL-UANON   TO LCVCNDTA
  9120                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9121                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9122             ELSE
  9123                 MOVE ER-0246    TO EMI-ERROR
  9124                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9125                 MOVE AL-UABON   TO LCVCNDTA
  9126                 MOVE -1         TO LCVCNDTL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 165
* EL131.cbl
  9127                 MOVE 'X'        TO ERROR-SWITCH
  9128     ELSE
  9129         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9130         MOVE AL-UANOF           TO LCVCNDTA.
  9131
  9132     IF ACVCNDTL GREATER THAN ZERO
  9133         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9134         IF ACVCNDTI = SPACES
  9135             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9136         ELSE
  9137             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9138             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9139             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9140             MOVE '4'            TO DC-OPTION-CODE
  9141             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9142             IF NOT DATE-CONVERSION-ERROR
  9143                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9144                 MOVE AL-UANON   TO ACVCNDTA
  9145                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9146                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9147             ELSE
  9148                 MOVE ER-0246    TO EMI-ERROR
  9149                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9150                 MOVE AL-UABON   TO ACVCNDTA
  9151                 MOVE -1         TO ACVCNDTL
  9152                 MOVE 'X'        TO ERROR-SWITCH
  9153     ELSE
  9154         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9155         MOVE AL-UANOF           TO ACVCNDTA.
  9156
  9157     IF APRL GREATER THAN +0
  9158
  9159* EXEC CICS BIF DEEDIT
  9160*            FIELD    (APRI)
  9161*            LENGTH   (8)
  9162*        END-EXEC
  9163     MOVE 8
  9164       TO DFHEIV11
  9165*    MOVE '@"L                   #   #00008761' TO DFHEIV0
  9166     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9167     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9168     MOVE X'2020233030303038373631' TO DFHEIV0(25:11)
  9169     CALL 'kxdfhei1' USING DFHEIV0,
  9170           APRI,
  9171           DFHEIV11
  9172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9173         IF APRI NUMERIC
  9174            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9175            MOVE APRI            TO HOLD-APR APRO
  9176            MOVE AL-UANON        TO APRA
  9177          ELSE
  9178            MOVE ER-0259         TO EMI-ERROR
  9179            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9180            MOVE AL-UABON        TO APRA
  9181            MOVE -1              TO APRL
  9182            MOVE 'X'             TO ERROR-SWITCH
  9183     ELSE
  9184         MOVE AL-UANOF           TO APRA.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 166
* EL131.cbl
  9185
  9186     IF PMTFREQL GREATER THAN ZERO
  9187
  9188* EXEC CICS BIF DEEDIT
  9189*            FIELD    (PMTFREQI)
  9190*            LENGTH   (2)
  9191*        END-EXEC
  9192     MOVE 2
  9193       TO DFHEIV11
  9194*    MOVE '@"L                   #   #00008779' TO DFHEIV0
  9195     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9196     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9197     MOVE X'2020233030303038373739' TO DFHEIV0(25:11)
  9198     CALL 'kxdfhei1' USING DFHEIV0,
  9199           PMTFREQI,
  9200           DFHEIV11
  9201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9202         IF PMTFREQI NUMERIC
  9203            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9204            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9205            MOVE AL-UANON        TO PMTFREQA
  9206          ELSE
  9207            MOVE ER-0427         TO EMI-ERROR
  9208            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9209            MOVE AL-UABON        TO PMTFREQA
  9210            MOVE -1              TO PMTFREQL
  9211            MOVE 'X'             TO ERROR-SWITCH
  9212     ELSE
  9213         MOVE AL-UANOF           TO PMTFREQA.
  9214
  9215     IF INDGRPL GREATER THAN ZERO
  9216         IF INDGRPI = 'I' OR 'G' OR SPACE
  9217             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9218             MOVE AL-UANON       TO INDGRPA
  9219          ELSE
  9220             MOVE ER-0260        TO EMI-ERROR
  9221             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9222             MOVE AL-UABON       TO INDGRPA
  9223             MOVE -1             TO INDGRPL
  9224             MOVE 'X'            TO ERROR-SWITCH
  9225     ELSE
  9226         MOVE AL-UANOF           TO INDGRPA.
  9227
  9228     IF PREMTYPL GREATER THAN ZERO
  9229         IF PREMTYPI = '1' OR '2' OR '3'
  9230            MOVE PREMTYPI        TO PI-PREM-TYPE
  9231            MOVE AL-UNNON        TO PREMTYPA
  9232            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9233          ELSE
  9234            MOVE ER-0227         TO EMI-ERROR
  9235            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9236            MOVE AL-UNBON        TO PREMTYPA
  9237            MOVE -1              TO PREMTYPL
  9238            MOVE 'X'             TO ERROR-SWITCH
  9239     ELSE
  9240         MOVE AL-UANOF           TO PREMTYPA.
  9241
  9242     IF LOANBALL GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 167
* EL131.cbl
  9243
  9244* EXEC CICS BIF DEEDIT
  9245*             FIELD    (LOANBALI)
  9246*             LENGTH   (9)
  9247*        END-EXEC
  9248     MOVE 9
  9249       TO DFHEIV11
  9250*    MOVE '@"L                   #   #00008824' TO DFHEIV0
  9251     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9252     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9253     MOVE X'2020233030303038383234' TO DFHEIV0(25:11)
  9254     CALL 'kxdfhei1' USING DFHEIV0,
  9255           LOANBALI,
  9256           DFHEIV11
  9257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9258         IF LOANBALI NUMERIC
  9259             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9260             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9261             MOVE AL-UNNON TO LOANBALA
  9262         ELSE
  9263             MOVE ER-0639        TO EMI-ERROR
  9264             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9265             MOVE AL-UNBON       TO LOANBALA
  9266             MOVE -1             TO LOANBALL
  9267             MOVE 'X'            TO ERROR-SWITCH
  9268     ELSE
  9269         MOVE AL-UNNOF           TO LOANBALA.
  9270
  9271     IF LOANNOL GREATER THAN ZERO
  9272        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9273        MOVE AL-UANON            TO LOANNOA
  9274     ELSE
  9275        MOVE AL-UANOF            TO LOANNOA.
  9276
  9277     IF REINCDI GREATER THAN LOW-VALUES
  9278        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9279        MOVE AL-UANON            TO REINCDA
  9280     ELSE
  9281        MOVE AL-UANOF            TO REINCDA.
  9282
  9283     IF CERTI GREATER THAN LOW-VALUES
  9284         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9285     ELSE
  9286         MOVE AL-UANOF           TO CERTA.
  9287
  9288     IF CERTEFFI GREATER THAN LOW-VALUES
  9289         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9290     ELSE
  9291         MOVE AL-UANOF           TO CERTEFFA.
  9292
  9293     IF CERTACTI GREATER THAN LOW-VALUES
  9294         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9295     ELSE
  9296         MOVE AL-UANOF           TO CERTACTA.
  9297
  9298     IF CERTSTI GREATER THAN LOW-VALUES
  9299         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9300     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 168
* EL131.cbl
  9301         MOVE AL-UANOF           TO CERTSTA.
  9302
  9303     IF CERTCARI GREATER THAN LOW-VALUES
  9304         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9305     ELSE
  9306         MOVE AL-UANOF           TO CERTCARA.
  9307
  9308     IF DLYACTV-RECORD-NEEDED
  9309         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9310                 1150-EXIT
  9311     END-IF.
  9312
  9313     IF CERTEFFI GREATER LOW-VALUES OR
  9314        CERTACTI GREATER LOW-VALUES OR
  9315        CERTSTI  GREATER LOW-VALUES OR
  9316        CERTCARI GREATER LOW-VALUES OR
  9317        CERTGRPI GREATER LOW-VALUES
  9318        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9319
  9320*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9321*      IF PI-PREM-TYPE NOT = '1'  AND
  9322*         PI-NO-PMTS = ZEROS
  9323*          IF LOANBALL GREATER +0 OR
  9324*             ACVBENEL GREATER +0
  9325*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9326     if not acct-found
  9327        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9328     end-if
  9329     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9330     MOVE PI-CARRIER             TO CARRIER-CODE
  9331     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9332     MOVE PI-CERT-NO             TO CERT-NO
  9333
  9334* EXEC CICS READ
  9335*        DATASET   (CLMS-FILE-ID)
  9336*        RIDFLD    (MSTR-KEY)
  9337*        SET       (ADDRESS OF CLAIM-MASTER)
  9338*        RESP      (WS-RESPONSE)
  9339*    END-EXEC
  9340*    MOVE '&"S        E          (  N#00008903' TO DFHEIV0
  9341     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9343     MOVE X'204E233030303038393033' TO DFHEIV0(25:11)
  9344     CALL 'kxdfhei1' USING DFHEIV0,
  9345           CLMS-FILE-ID,
  9346           DFHEIV20,
  9347           DFHEIV99,
  9348           MSTR-KEY,
  9349           DFHEIV99,
  9350           DFHEIV99,
  9351           DFHEIV99
  9352     SET ADDRESS OF CLAIM-MASTER TO
  9353         DFHEIV20
  9354     MOVE EIBRESP  TO WS-RESPONSE
  9355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9356     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9357     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9358     MOVE CL-CERT-GROUPING       TO CERT-GROUP
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 169
* EL131.cbl
  9359     MOVE CL-CERT-STATE          TO CERT-STATE
  9360     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9361     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9362     MOVE CL-CERT-NO             TO CERT-CERT
  9363
  9364* EXEC CICS READ
  9365*       DATASET   (CERT-FILE-ID)
  9366*       RIDFLD    (CERT-KEY)
  9367*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9368*       RESP      (WS-RESPONSE)
  9369*    END-EXEC
  9370*    MOVE '&"S        E          (  N#00008916' TO DFHEIV0
  9371     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9372     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9373     MOVE X'204E233030303038393136' TO DFHEIV0(25:11)
  9374     CALL 'kxdfhei1' USING DFHEIV0,
  9375           CERT-FILE-ID,
  9376           DFHEIV20,
  9377           DFHEIV99,
  9378           CERT-KEY,
  9379           DFHEIV99,
  9380           DFHEIV99,
  9381           DFHEIV99
  9382     SET ADDRESS OF CERTIFICATE-MASTER TO
  9383         DFHEIV20
  9384     MOVE EIBRESP  TO WS-RESPONSE
  9385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9386     if mfnamei > low-values
  9387        move mfnamei to w-name-first
  9388     else
  9389        move cl-insured-1st-name to w-name-first
  9390     end-if
  9391     if mlnamei > low-values
  9392        move mlnamei to w-name-last
  9393     else
  9394        move cl-insured-last-name to w-name-last
  9395     end-if
  9396     if instypel > zeros
  9397        evaluate true
  9398           when cl-no-of-days-paid > zeros
  9399              move er-1668       to emi-error
  9400              perform 9900-error-format
  9401                                 thru 9900-exit
  9402              move al-uabon      to instypea
  9403              move -1            to instypel
  9404              move 'X'           to error-switch
  9405           when instypei = 'C'
  9406              if w-name-first (1:10) = cm-insured-first-name
  9407                 move er-1666    to emi-error
  9408                 PERFORM 9900-ERROR-FORMAT
  9409                                 THRU 9900-EXIT
  9410                 move al-uabon   to instypea
  9411                 move -1         to instypel
  9412                 move 'X'        to error-switch
  9413              end-if
  9414           when instypei = 'P'
  9415              if (w-name-first (1:10) <> cm-insured-first-name)
  9416                 or (w-name-last <> cm-insured-last-name)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 170
* EL131.cbl
  9417                 move er-1676    to emi-error
  9418                 PERFORM 9900-ERROR-FORMAT
  9419                                 THRU 9900-EXIT
  9420                 move al-uabon   to instypea
  9421                 move -1         to instypel
  9422                 move 'X'        to error-switch
  9423              end-if
  9424        end-evaluate
  9425     end-if
  9426*    if (instypel > zeros)
  9427*       and (cl-no-of-days-paid > zero)
  9428*       move er-1668             to emi-error
  9429*       perform 9900-error-format thru 9900-exit
  9430*       move al-uabon            to instypea
  9431*       move -1                  to instypel
  9432*       move 'X'                 to error-switch
  9433*    end-if
  9434*
  9435*    if instypel > zero
  9436*       if instypei = 'C'
  9437*          if w-name-first (1:10) = cm-insured-first-name
  9438*             move er-1666          to emi-error
  9439*             PERFORM 9900-ERROR-FORMAT
  9440*                                   THRU 9900-EXIT
  9441*             move al-uabon         to instypea
  9442*             move -1               to instypel
  9443*             move 'X'              to error-switch
  9444*          end-if
  9445*       end-if
  9446*    end-if
  9447
  9448     if (pi-company-id = 'DCC')
  9449        and (acct-found)
  9450        perform 2120-check-pdef  thru 2120-exit
  9451     end-if
  9452     if benperl > zeros
  9453        move al-uanon            to benpera
  9454     end-if
  9455     if benperl > zeros
  9456        if benperi numeric
  9457           perform 1015-edit-benefit-period
  9458                                 thru 1015-exit
  9459        else
  9460           move er-1669          to emi-error
  9461           PERFORM 9900-ERROR-FORMAT
  9462                                 THRU 9900-EXIT
  9463           move al-uabon         to benpera
  9464           move -1               to benperl
  9465           move 'X'              to error-switch
  9466        end-if
  9467    end-if
  9468     if instypel > zeros
  9469        if instypei = 'P' OR 'C'
  9470           move 'X'              to update-switch
  9471                                    mstr-switch
  9472           move al-uanon         to instypea
  9473        else
  9474            move er-1654          to emi-error
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 171
* EL131.cbl
  9475           PERFORM 9900-ERROR-FORMAT
  9476                                 THRU 9900-EXIT
  9477           move al-uabon         to instypea
  9478           move -1               to instypel
  9479           move 'X'              to error-switch
  9480        end-if
  9481    end-if
  9482     if accswl > zeros
  9483        if accswi = 'Y' OR 'N'
  9484           MOVE 'X'              TO UPDATE-SWITCH
  9485                                    MSTR-SWITCH
  9486           MOVE AL-UANON         TO accswa
  9487*       else
  9488*          move er-1656          to emi-error
  9489*          PERFORM 9900-ERROR-FORMAT
  9490*                                THRU 9900-EXIT
  9491*          move al-uabon         to accswa
  9492*          move -1               to accswl
  9493*          move 'X'              to error-switch
  9494*          move al-uanof         to accswa
  9495        end-if
  9496     end-if
  9497     IF CERTL = ZEROS AND
  9498        SUFXL = ZEROS
  9499          GO TO 1010-EXIT.
  9500
  9501     IF CERTL GREATER THAN ZEROS
  9502         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9503             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9504             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9505             MOVE 'X'            TO ERROR-SWITCH
  9506             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9507
  9508     IF SUFXL GREATER THAN ZEROS
  9509         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9510             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9511             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9512             MOVE 'X'            TO ERROR-SWITCH
  9513             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9514
  9515 1010-EXIT.
  9516     EXIT.
  9517
  9518 1015-edit-benefit-period.
  9519     move ' '                    to ws-benper-sw
  9520     evaluate true
  9521        when not erpdef-found
  9522           set good-benper       to true
  9523        when pd-recurring-yn (a1) = 'Y'
  9524           set good-benper       to true
  9525        when pd-recurring-yn (a1) = 'N'
  9526           if benperi < 02
  9527              set good-benper    to true
  9528           end-if
  9529        when pd-rec-crit-period (a1) numeric
  9530           if benperi <= pd-rec-crit-period (a1)
  9531              set good-benper    to true
  9532           end-if
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 172
* EL131.cbl
  9533     end-evaluate
  9534     MOVE CERT-KEY               TO ELCRTT-KEY
  9535     MOVE 'B'                    TO CTRLR-REC-TYPE
  9536
  9537* EXEC CICS READ
  9538*       DATASET   ('ELCRTT')
  9539*       RIDFLD    (ELCRTT-KEY)
  9540*       INTO      (CERTIFICATE-TRAILERS)
  9541*       RESP      (WS-RESPONSE)
  9542*    END-EXEC
  9543     MOVE LENGTH OF
  9544      CERTIFICATE-TRAILERS
  9545       TO DFHEIV11
  9546     MOVE 'ELCRTT' TO DFHEIV1
  9547*    MOVE '&"IL       E          (  N#00009072' TO DFHEIV0
  9548     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9549     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9550     MOVE X'204E233030303039303732' TO DFHEIV0(25:11)
  9551     CALL 'kxdfhei1' USING DFHEIV0,
  9552           DFHEIV1,
  9553           CERTIFICATE-TRAILERS,
  9554           DFHEIV11,
  9555           ELCRTT-KEY,
  9556           DFHEIV99,
  9557           DFHEIV99,
  9558           DFHEIV99
  9559     MOVE EIBRESP  TO WS-RESPONSE
  9560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9561     IF WS-RESP-NORMAL
  9562        perform varying s1 from +1 by +1 until
  9563           (s1 > +24)
  9564           or ((cs-claim-type (s1) = cl-claim-type)
  9565           and (cs-insured-type (s1) = cl-insured-type)
  9566           and (cs-benefit-period (s1) > benperi))
  9567        end-perform
  9568        if s1 < +25
  9569           move er-1665          to emi-error
  9570           PERFORM 9900-ERROR-FORMAT
  9571                                 THRU 9900-EXIT
  9572           move al-uabon         to benpera
  9573           move -1               to benperl
  9574           move 'X'              to error-switch
  9575           go to 1015-exit
  9576*       else
  9577*          set good-benper       to true
  9578        end-if
  9579     end-if
  9580     if good-benper
  9581        move 'X'                 to update-switch
  9582                                    mstr-switch
  9583        move al-uanon            to benpera
  9584     else
  9585        move er-1669             to emi-error
  9586        PERFORM 9900-ERROR-FORMAT
  9587                                 THRU 9900-EXIT
  9588        move al-uabon            to benpera
  9589        move -1                  to benperl
  9590        move 'X'                 to error-switch
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 173
* EL131.cbl
  9591     end-if
  9592     .
  9593 1015-exit.
  9594     exit.
  9595 1120-EDIT-PROC.
  9596     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9597     MOVE '2'                    TO CNTL-REC-TYPE.
  9598     MOVE PROCI                  TO CNTL-PROC-ID.
  9599     MOVE ZERO                   TO CNTL-SEQ-NO.
  9600
  9601
  9602* EXEC CICS HANDLE CONDITION
  9603*         NOTFND    (1120-CNTL-NOTFND)
  9604*    END-EXEC.
  9605*    MOVE '"$I                   ! & #00009118' TO DFHEIV0
  9606     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9608     MOVE X'2620233030303039313138' TO DFHEIV0(25:11)
  9609     CALL 'kxdfhei1' USING DFHEIV0
  9610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9611
  9612
  9613
  9614* EXEC CICS READ
  9615*         SET      (ADDRESS OF CONTROL-FILE)
  9616*         DATASET  (CNTL-FILE-ID)
  9617*         RIDFLD   (CNTL-KEY)
  9618*    END-EXEC.
  9619*    MOVE '&"S        E          (   #00009122' TO DFHEIV0
  9620     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9621     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9622     MOVE X'2020233030303039313232' TO DFHEIV0(25:11)
  9623     CALL 'kxdfhei1' USING DFHEIV0,
  9624           CNTL-FILE-ID,
  9625           DFHEIV20,
  9626           DFHEIV99,
  9627           CNTL-KEY,
  9628           DFHEIV99,
  9629           DFHEIV99,
  9630           DFHEIV99
  9631     SET ADDRESS OF CONTROL-FILE TO
  9632         DFHEIV20
  9633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9634
  9635
  9636     MOVE AL-UANON               TO PROCA.
  9637     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9638     GO TO 1120-EXIT.
  9639
  9640 1120-CNTL-NOTFND.
  9641     MOVE ER-0273                TO EMI-ERROR.
  9642     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9643     MOVE AL-UABON               TO PROCA.
  9644     MOVE -1                     TO PROCL.
  9645     MOVE 'X'                    TO ERROR-SWITCH.
  9646
  9647 1120-EXIT.
  9648     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 174
* EL131.cbl
  9649
  9650*************************************************************
  9651*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9652*************************************************************
  9653
  9654 1150-OUTPUT-ACTIVITY-RECORD.
  9655
  9656
  9657* EXEC CICS GETMAIN
  9658*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9659*        LENGTH (25)
  9660*        INITIMG (WS-BLANK)
  9661*    END-EXEC.
  9662     MOVE 25
  9663       TO DFHEIV11
  9664*    MOVE ',"IL                  $   #00009148' TO DFHEIV0
  9665     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9666     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9667     MOVE X'2020233030303039313438' TO DFHEIV0(25:11)
  9668     CALL 'kxdfhei1' USING DFHEIV0,
  9669           DFHEIV20,
  9670           DFHEIV11,
  9671           WS-BLANK
  9672     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9673         DFHEIV20
  9674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9675
  9676
  9677     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9678     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9679     MOVE PI-CARRIER             TO DA-CARRIER.
  9680     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9681     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9682     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9683     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9684
  9685
  9686* EXEC CICS HANDLE CONDITION
  9687*        NOTOPEN (1150-NOTOPEN-ERROR)
  9688*        DUPREC (1150-EXIT)
  9689*    END-EXEC.
  9690*    MOVE '"$J%                  ! '' #00009162' TO DFHEIV0
  9691     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9692     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9693     MOVE X'2720233030303039313632' TO DFHEIV0(25:11)
  9694     CALL 'kxdfhei1' USING DFHEIV0
  9695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9696
  9697     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9698     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9699     MOVE 'A'                    TO JP-RECORD-TYPE.
  9700     MOVE +48                    TO JOURNAL-LENGTH.
  9701
  9702
  9703* EXEC CICS WRITE
  9704*        DATASET ('DLYACTV')
  9705*        RIDFLD (DA-KEY)
  9706*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 175
* EL131.cbl
  9707*        LENGTH (25)
  9708*    END-EXEC.
  9709     MOVE 'DLYACTV' TO DFHEIV1
  9710     MOVE 25
  9711       TO DFHEIV11
  9712*    MOVE '&$ L                  ''   #00009171' TO DFHEIV0
  9713     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9714     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9715     MOVE X'2020233030303039313731' TO DFHEIV0(25:11)
  9716     CALL 'kxdfhei1' USING DFHEIV0,
  9717           DFHEIV1,
  9718           DAILY-ACTIVITY-RECORD,
  9719           DFHEIV11,
  9720           DA-KEY,
  9721           DFHEIV99,
  9722           DFHEIV99
  9723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9724
  9725
  9726     GO TO 1150-EXIT.
  9727
  9728 1150-NOTOPEN-ERROR.
  9729
  9730     MOVE '2955'                 TO EMI-ERROR.
  9731     MOVE -1                     TO MAINTL.
  9732     MOVE AL-UANON               TO MAINTA.
  9733     MOVE 'X'                    TO ERROR-SWITCH.
  9734     PERFORM 9900-ERROR-FORMAT THRU
  9735             9900-EXIT.
  9736
  9737 1150-EXIT.
  9738     EXIT.
  9739
  9740*************************************************************
  9741*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9742*************************************************************
  9743
  9744 1240-EDIT-LIFE-CODE.
  9745
  9746     IF INVALID-BENEFIT-CODE
  9747         GO TO 1240-SET-ERROR.
  9748
  9749     MOVE SPACES                 TO BENEFIT-KEY.
  9750     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9751     MOVE '4'                    TO BEN-REC-TYPE.
  9752     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9753     MOVE ZERO                   TO BEN-SEQ-NO.
  9754
  9755
  9756* EXEC CICS READ GTEQ
  9757*         DATASET  (CNTL-FILE-ID)
  9758*         RIDFLD   (BENEFIT-KEY)
  9759*         SET      (ADDRESS OF CONTROL-FILE)
  9760*    END-EXEC.
  9761*    MOVE '&"S        G          (   #00009207' TO DFHEIV0
  9762     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9764     MOVE X'2020233030303039323037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 176
* EL131.cbl
  9765     CALL 'kxdfhei1' USING DFHEIV0,
  9766           CNTL-FILE-ID,
  9767           DFHEIV20,
  9768           DFHEIV99,
  9769           BENEFIT-KEY,
  9770           DFHEIV99,
  9771           DFHEIV99,
  9772           DFHEIV99
  9773     SET ADDRESS OF CONTROL-FILE TO
  9774         DFHEIV20
  9775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9776
  9777
  9778     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9779        CF-RECORD-TYPE NOT = '4'
  9780         GO TO 1240-SET-ERROR.
  9781
  9782     MOVE ZERO                   TO COUNT-2.
  9783     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9784
  9785     IF SCREEN-ERROR
  9786         GO TO 1240-SET-ERROR.
  9787
  9788 1240-SET-CODE-SWITCHES.
  9789     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9790     MOVE AL-UANON               TO LCVCDA.
  9791     GO TO 1240-EXIT.
  9792
  9793 1240-SET-ERROR.
  9794     MOVE ER-0240                TO EMI-ERROR.
  9795     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9796     MOVE 'X'                    TO ERROR-SWITCH.
  9797     MOVE AL-UABON               TO LCVCDA.
  9798     MOVE -1                     TO LCVCDL.
  9799
  9800 1240-EXIT.
  9801     EXIT.
  9802
  9803 1310-EDIT-AH-CODE.
  9804     IF INVALID-BENEFIT-CODE
  9805         GO TO 1310-SET-ERROR.
  9806
  9807     MOVE SPACES                 TO BENEFIT-KEY.
  9808     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9809     MOVE '5'                    TO BEN-REC-TYPE.
  9810     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9811     MOVE ZERO                   TO BEN-SEQ-NO.
  9812
  9813
  9814* EXEC CICS READ GTEQ
  9815*         DATASET  (CNTL-FILE-ID)
  9816*         RIDFLD   (BENEFIT-KEY)
  9817*         SET      (ADDRESS OF CONTROL-FILE)
  9818*    END-EXEC.
  9819*    MOVE '&"S        G          (   #00009248' TO DFHEIV0
  9820     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9822     MOVE X'2020233030303039323438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 177
* EL131.cbl
  9823     CALL 'kxdfhei1' USING DFHEIV0,
  9824           CNTL-FILE-ID,
  9825           DFHEIV20,
  9826           DFHEIV99,
  9827           BENEFIT-KEY,
  9828           DFHEIV99,
  9829           DFHEIV99,
  9830           DFHEIV99
  9831     SET ADDRESS OF CONTROL-FILE TO
  9832         DFHEIV20
  9833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9834
  9835
  9836     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9837        CF-RECORD-TYPE NOT = '5'
  9838         GO TO 1310-SET-ERROR.
  9839
  9840     MOVE ZERO                   TO COUNT-2.
  9841     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9842     IF SCREEN-ERROR
  9843         GO TO 1310-SET-ERROR.
  9844
  9845 1310-SET-CODE-SWITCHES.
  9846     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9847     MOVE AL-UANON               TO ACVCDA.
  9848     GO TO 1310-EXIT.
  9849
  9850 1310-SET-ERROR.
  9851     MOVE ER-0250                TO EMI-ERROR.
  9852     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9853     MOVE AL-UABON               TO ACVCDA.
  9854     MOVE 'X'                    TO ERROR-SWITCH.
  9855     MOVE -1                     TO ACVCDL.
  9856
  9857 1310-EXIT.
  9858     EXIT.
  9859
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 178
* EL131.cbl
  9861 1460-EDIT-CERT-NO.
  9862     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9863     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9864
  9865     IF WS-SAVE-CERT-NO = SPACES
  9866         MOVE ER-0203            TO EMI-ERROR
  9867         GO TO 1460-CERT-NO-ERROR.
  9868
  9869     IF WS-CERT-NO-PRIME = SPACES AND
  9870        WS-CERT-NO-SUFX GREATER THAN SPACE
  9871            MOVE ER-0210         TO EMI-ERROR
  9872            GO TO 1460-CERT-NO-ERROR.
  9873
  9874     MOVE 'X'                    TO UPDATE-SWITCH.
  9875     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9876     MOVE AL-UANON               TO CERTA.
  9877
  9878     IF SUFXL IS GREATER THAN 0
  9879         MOVE AL-UANON           TO SUFXA.
  9880
  9881     GO TO 1460-EXIT.
  9882
  9883 1460-CERT-NO-ERROR.
  9884     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9885     MOVE AL-UABON               TO SUFXA.
  9886     MOVE AL-UABON               TO CERTA.
  9887     MOVE -1                     TO CERTL.
  9888     MOVE 'X'                    TO ERROR-SWITCH.
  9889
  9890 1460-EXIT.
  9891     EXIT.
  9892
  9893 1470-EDIT-EFF.
  9894     IF CERTEFFI = SPACES
  9895         GO TO 1470-DATE-ERROR.
  9896
  9897     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9898     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9899     IF DEEDIT-DATE = ZERO
  9900         GO TO 1470-DATE-ERROR.
  9901
  9902     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9903     MOVE '4'                    TO DC-OPTION-CODE.
  9904     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9905     IF NOT DATE-CONVERSION-ERROR
  9906         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9907         MOVE AL-UANON           TO CERTEFFA
  9908         MOVE 'X'                TO UPDATE-SWITCH
  9909         MOVE 'Y'                TO CERT-KEY-SWITCH
  9910         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9911         GO TO 1470-EXIT.
  9912
  9913 1470-DATE-ERROR.
  9914     MOVE ER-0215                TO EMI-ERROR.
  9915     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9916     MOVE AL-UABON               TO CERTEFFA.
  9917     MOVE -1                     TO CERTEFFL.
  9918     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 179
* EL131.cbl
  9919
  9920 1470-EXIT.
  9921     EXIT.
  9922
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 180
* EL131.cbl
  9924 1480-EDIT-ACCT.
  9925     IF CERTACTI = SPACES
  9926         MOVE ER-0232            TO EMI-ERROR
  9927         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9928         MOVE AL-UABON           TO CERTACTA
  9929         MOVE -1                 TO CERTACTL
  9930         MOVE 'X'                TO ERROR-SWITCH
  9931     ELSE
  9932         MOVE 'X'                TO UPDATE-SWITCH
  9933         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9934
  9935 1480-EXIT.
  9936     EXIT.
  9937
  9938 1490-EDIT-STATE.
  9939     IF CERTSTI = SPACES
  9940         MOVE ER-0233            TO EMI-ERROR
  9941         GO TO 1490-STATE-ERROR.
  9942
  9943     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9944     MOVE '3'                    TO CNTL-REC-TYPE.
  9945     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9946     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9947     MOVE ZERO                   TO CNTL-SEQ-NO.
  9948
  9949
  9950* EXEC CICS HANDLE CONDITION
  9951*         NOTFND (1490-STATE-NOTFND)
  9952*    END-EXEC.
  9953*    MOVE '"$I                   ! ( #00009367' TO DFHEIV0
  9954     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9956     MOVE X'2820233030303039333637' TO DFHEIV0(25:11)
  9957     CALL 'kxdfhei1' USING DFHEIV0
  9958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9959
  9960
  9961
  9962* EXEC CICS READ
  9963*         SET        (ADDRESS OF CONTROL-FILE)
  9964*         DATASET    ('ELCNTL')
  9965*         RIDFLD     (CNTL-KEY)
  9966*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9967*         GENERIC
  9968*    END-EXEC.
  9969     MOVE 'ELCNTL' TO DFHEIV1
  9970*    MOVE '&"S  KG    E          (   #00009371' TO DFHEIV0
  9971     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9973     MOVE X'2020233030303039333731' TO DFHEIV0(25:11)
  9974     CALL 'kxdfhei1' USING DFHEIV0,
  9975           DFHEIV1,
  9976           DFHEIV20,
  9977           DFHEIV99,
  9978           CNTL-KEY,
  9979           CNTL-GENERIC-LENGTH,
  9980           DFHEIV99,
  9981           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 181
* EL131.cbl
  9982     SET ADDRESS OF CONTROL-FILE TO
  9983         DFHEIV20
  9984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9985
  9986
  9987     MOVE AL-UANON               TO CERTSTA.
  9988     MOVE 'X'                    TO UPDATE-SWITCH.
  9989     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9990     GO TO 1490-EXIT.
  9991
  9992 1490-STATE-NOTFND.
  9993     MOVE ER-0149                TO EMI-ERROR.
  9994
  9995 1490-STATE-ERROR.
  9996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9997     MOVE AL-UABON               TO CERTSTA.
  9998     MOVE -1                     TO CERTSTL.
  9999     MOVE 'X'                    TO ERROR-SWITCH.
 10000
 10001 1490-EXIT.
 10002     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 182
* EL131.cbl
 10004 1500-EDIT-CARR.
 10005     IF CERTCARI = SPACES
 10006         GO TO 1500-CARR-NOTFND.
 10007
 10008     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10009     MOVE '6'                    TO CNTL-REC-TYPE.
 10010     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10011     MOVE CERTCARI               TO CNTL-CARRIER.
 10012     MOVE ZERO                   TO CNTL-SEQ-NO.
 10013
 10014
 10015* EXEC CICS HANDLE CONDITION
 10016*         NOTFND   (1500-CARR-NOTFND)
 10017*    END-EXEC.
 10018*    MOVE '"$I                   ! ) #00009406' TO DFHEIV0
 10019     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10021     MOVE X'2920233030303039343036' TO DFHEIV0(25:11)
 10022     CALL 'kxdfhei1' USING DFHEIV0
 10023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10024
 10025
 10026
 10027* EXEC CICS READ
 10028*         SET        (ADDRESS OF CONTROL-FILE)
 10029*         DATASET    ('ELCNTL')
 10030*         RIDFLD     (CNTL-KEY)
 10031*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10032*         GENERIC
 10033*    END-EXEC.
 10034     MOVE 'ELCNTL' TO DFHEIV1
 10035*    MOVE '&"S  KG    E          (   #00009410' TO DFHEIV0
 10036     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10038     MOVE X'2020233030303039343130' TO DFHEIV0(25:11)
 10039     CALL 'kxdfhei1' USING DFHEIV0,
 10040           DFHEIV1,
 10041           DFHEIV20,
 10042           DFHEIV99,
 10043           CNTL-KEY,
 10044           CNTL-GENERIC-LENGTH,
 10045           DFHEIV99,
 10046           DFHEIV99
 10047     SET ADDRESS OF CONTROL-FILE TO
 10048         DFHEIV20
 10049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10050
 10051
 10052     MOVE AL-UANON               TO CERTCARA.
 10053     MOVE 'X'                    TO UPDATE-SWITCH.
 10054     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10055     GO TO 1500-EXIT.
 10056
 10057 1500-CARR-NOTFND.
 10058     MOVE ER-0360                TO EMI-ERROR.
 10059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10060     MOVE AL-UABON               TO CERTCARA.
 10061     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 183
* EL131.cbl
 10062     MOVE 'X'                    TO ERROR-SWITCH.
 10063
 10064 1500-EXIT.
 10065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 184
* EL131.cbl
 10067 1510-DEEDIT-DATE.
 10068
 10069* EXEC CICS BIF DEEDIT
 10070*         FIELD    (DEEDIT-DATE-INPUT)
 10071*         LENGTH   (DATE-LENGTH)
 10072*    END-EXEC.
 10073*    MOVE '@"L                   #   #00009434' TO DFHEIV0
 10074     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10075     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10076     MOVE X'2020233030303039343334' TO DFHEIV0(25:11)
 10077     CALL 'kxdfhei1' USING DFHEIV0,
 10078           DEEDIT-DATE-INPUT,
 10079           DATE-LENGTH
 10080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10081
 10082
 10083 1510-EXIT.
 10084     EXIT.
 10085
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 185
* EL131.cbl
 10087 1620-VERIFY-ACCT.
 10088
 10089     move ' '                    to ws-eracct-sw
 10090     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10091     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10092     MOVE PI-GROUPING            TO ACCT-GROUP.
 10093     MOVE PI-STATE               TO ACCT-STATE.
 10094     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10095
 10096     IF CERTEFFI GREATER THAN LOW-VALUES
 10097         MOVE HOLD-EFF           TO ACCT-DATE
 10098     ELSE
 10099         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10100
 10101     IF CERTACTI GREATER THAN LOW-VALUES
 10102         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10103     IF CERTSTI GREATER THAN LOW-VALUES
 10104         MOVE CERTSTI            TO  ACCT-STATE.
 10105     IF CERTCARI GREATER THAN LOW-VALUES
 10106         MOVE CERTCARI           TO  ACCT-CARRIER.
 10107     IF CERTGRPI GREATER THAN LOW-VALUES
 10108         MOVE CERTGRPI           TO ACCT-GROUP.
 10109
 10110     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10111
 10112
 10113* EXEC CICS HANDLE CONDITION
 10114*         NOTFND  (1620-ACCT-NOTFND)
 10115*    END-EXEC.
 10116*    MOVE '"$I                   ! * #00009468' TO DFHEIV0
 10117     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10118     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10119     MOVE X'2A20233030303039343638' TO DFHEIV0(25:11)
 10120     CALL 'kxdfhei1' USING DFHEIV0
 10121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10122
 10123
 10124
 10125* EXEC CICS STARTBR
 10126*         DATASET   (ACCT-FILE-ID)
 10127*         RIDFLD    (ACCT-KEY)
 10128*    END-EXEC.
 10129     MOVE 0
 10130       TO DFHEIV11
 10131*    MOVE '&,         G          &   #00009472' TO DFHEIV0
 10132     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10133     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10134     MOVE X'2020233030303039343732' TO DFHEIV0(25:11)
 10135     CALL 'kxdfhei1' USING DFHEIV0,
 10136           ACCT-FILE-ID,
 10137           ACCT-KEY,
 10138           DFHEIV99,
 10139           DFHEIV11,
 10140           DFHEIV99
 10141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10142
 10143
 10144 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 186
* EL131.cbl
 10145
 10146
 10147* EXEC CICS READNEXT
 10148*         DATASET  (ACCT-FILE-ID)
 10149*         RIDFLD   (ACCT-KEY)
 10150*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10151*    END-EXEC.
 10152     MOVE 0
 10153       TO DFHEIV11
 10154*    MOVE '&.S                   )   #00009479' TO DFHEIV0
 10155     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10156     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10157     MOVE X'2020233030303039343739' TO DFHEIV0(25:11)
 10158     CALL 'kxdfhei1' USING DFHEIV0,
 10159           ACCT-FILE-ID,
 10160           DFHEIV20,
 10161           DFHEIV99,
 10162           ACCT-KEY,
 10163           DFHEIV99,
 10164           DFHEIV11,
 10165           DFHEIV99,
 10166           DFHEIV99
 10167     SET ADDRESS OF ACCOUNT-MASTER TO
 10168         DFHEIV20
 10169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10170
 10171
 10172     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10173         GO TO 1620-ACCT-NOTFND.
 10174
 10175     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10176        HOLD-EFF     LESS AM-EXPIRATION-DT
 10177         NEXT SENTENCE
 10178     ELSE
 10179         GO TO 1620-ACCT-LOOP.
 10180
 10181     set acct-found to true
 10182     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10183         GO TO 1620-ACCT-END-BROWSE.
 10184
 10185     IF LOANBALL GREATER THAN +0
 10186         IF AM-MAX-TOT-BEN NUMERIC  AND
 10187            AM-MAX-TOT-BEN GREATER THAN ZERO
 10188             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10189                 MOVE AL-UNBON     TO LOANBALA
 10190                 MOVE -1           TO LOANBALL
 10191                 MOVE 'X'          TO ERROR-SWITCH
 10192                 MOVE ER-7641      TO EMI-ERROR
 10193                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10194
 10195     IF ACVBENEL GREATER THAN +0
 10196         IF AM-MAX-MON-BEN NUMERIC  AND
 10197            AM-MAX-MON-BEN GREATER THAN ZERO
 10198             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10199                 MOVE AL-UNBON     TO ACVBENEA
 10200                 MOVE -1           TO ACVBENEL
 10201                 MOVE 'X'          TO ERROR-SWITCH
 10202                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 187
* EL131.cbl
 10203                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10204
 10205 1620-ACCT-END-BROWSE.
 10206
 10207
 10208* EXEC CICS ENDBR
 10209*         DATASET (ACCT-FILE-ID)
 10210*    END-EXEC.
 10211     MOVE 0
 10212       TO DFHEIV11
 10213*    MOVE '&2                    $   #00009520' TO DFHEIV0
 10214     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10215     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10216     MOVE X'2020233030303039353230' TO DFHEIV0(25:11)
 10217     CALL 'kxdfhei1' USING DFHEIV0,
 10218           ACCT-FILE-ID,
 10219           DFHEIV11,
 10220           DFHEIV99
 10221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10222
 10223
 10224     GO TO 1620-EXIT.
 10225
 10226 1620-ACCT-NOTFND.
 10227
 10228     MOVE -1                     TO MAINTL.
 10229     MOVE 'X'                    TO ERROR-SWITCH.
 10230     MOVE ER-0426                TO EMI-ERROR.
 10231     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10232
 10233 1620-EXIT.
 10234     EXIT.
 10235
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 188
* EL131.cbl
 10237 2000-UPDATE-CLAIM.
 10238
 10239     MOVE SPACES                 TO ERROR-SWITCH.
 10240     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10241     MOVE PI-CARRIER             TO CARRIER-CODE.
 10242     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10243     MOVE PI-CERT-NO             TO CERT-NO.
 10244
 10245     IF DELETE-CLAIM
 10246         GO TO 3000-DELETE-CLAIM.
 10247
 10248     IF  NOT MODIFY-CAP
 10249         MOVE ER-0070            TO EMI-ERROR
 10250         MOVE 'X'                TO ERROR-SWITCH
 10251         MOVE -1                 TO MAINTL
 10252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10253         GO TO 2000-EXIT.
 10254
 10255     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10256     MOVE ZERO                   TO TRLR-SEQ-NO.
 10257
 10258
 10259* EXEC CICS READ UPDATE
 10260*         SET       (ADDRESS OF CLAIM-MASTER)
 10261*         DATASET   (CLMS-FILE-ID)
 10262*         RIDFLD    (MSTR-KEY)
 10263*    END-EXEC.
 10264*    MOVE '&"S        EU         (   #00009558' TO DFHEIV0
 10265     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10266     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10267     MOVE X'2020233030303039353538' TO DFHEIV0(25:11)
 10268     CALL 'kxdfhei1' USING DFHEIV0,
 10269           CLMS-FILE-ID,
 10270           DFHEIV20,
 10271           DFHEIV99,
 10272           MSTR-KEY,
 10273           DFHEIV99,
 10274           DFHEIV99,
 10275           DFHEIV99
 10276     SET ADDRESS OF CLAIM-MASTER TO
 10277         DFHEIV20
 10278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10279
 10280
 10281     if (incl > zeros)
 10282        and (cl-no-of-pmts-made > 0)
 10283        and (hold-incur > low-values)
 10284        and (hold-incur not = cl-incurred-dt)
 10285        if hold-incur > cl-incurred-dt
 10286           move cl-incurred-dt   to dc-bin-date-1
 10287           move hold-incur       to dc-bin-date-2
 10288        else
 10289           move hold-incur       to dc-bin-date-1
 10290           move cl-incurred-dt   to dc-bin-date-2
 10291        end-if
 10292        move '1'                 to dc-option-code
 10293        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10294        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 189
* EL131.cbl
 10295           MOVE ER-1663             TO EMI-ERROR
 10296           PERFORM 9900-ERROR-FORMAT
 10297                                 THRU 9900-EXIT
 10298           MOVE -1                  TO MAINTL
 10299           GO TO 8110-SEND-DATA
 10300        end-if
 10301     end-if
 10302     IF (CL-PRIORITY-CD = '8')
 10303        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10304             AND 'AMWA' AND 'KMSB')
 10305        MOVE ER-8003             TO EMI-ERROR
 10306        PERFORM 9900-ERROR-FORMAT
 10307                                 THRU 9900-EXIT
 10308        MOVE -1                  TO MAINTL
 10309        GO TO 8110-SEND-DATA
 10310     END-IF
 10311
 10312     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10313         MOVE ER-0068            TO EMI-ERROR
 10314         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10315         GO TO 2000-EXIT.
 10316
 10317     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10318         MOVE ER-0068            TO EMI-ERROR
 10319         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10320         GO TO 2000-EXIT.
 10321
 10322     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10323         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10324
 10325     IF CL-PURGED-DT NOT = LOW-VALUES
 10326         MOVE ER-7691            TO EMI-ERROR
 10327         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10328         GO TO 2000-EXIT.
 10329
 10330     IF CERT-KEY-CHANGED
 10331         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10332
 10333     IF SCREEN-ERROR
 10334         MOVE ER-0068            TO EMI-ERROR
 10335         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10336         GO TO 2000-EXIT.
 10337
 10338     IF NINETY-TRLR-UPDATED
 10339         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10340
 10341     IF MSTR-KEY-CHANGED
 10342         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10343        ELSE
 10344         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10345
 10346     IF TRLR-UPDATE-REQUIRED
 10347         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10348
 10349 2000-CHECK-CERT.
 10350     IF NOT CERT-UPDATES
 10351         GO TO 2000-EXIT.
 10352
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 190
* EL131.cbl
 10353     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10354     MOVE PI-CARRIER             TO CERT-CARRIER.
 10355     MOVE PI-GROUPING            TO CERT-GROUP.
 10356     MOVE PI-STATE               TO CERT-STATE.
 10357     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10358     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10359     MOVE PI-CERT-NO             TO CERT-CERT.
 10360
 10361     IF CERT-ALT-KEY-CHANGED
 10362         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10363     ELSE
 10364         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10365
 10366 2000-EXIT.
 10367     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 191
* EL131.cbl
 10369 2010-RELEASE-REC.
 10370
 10371* EXEC CICS UNLOCK
 10372*         DATASET  (CLMS-FILE-ID)
 10373*    END-EXEC
 10374*    MOVE '&*                    #   #00009653' TO DFHEIV0
 10375     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10376     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10377     MOVE X'2020233030303039363533' TO DFHEIV0(25:11)
 10378     CALL 'kxdfhei1' USING DFHEIV0,
 10379           CLMS-FILE-ID,
 10380           DFHEIV99
 10381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10382
 10383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10384     MOVE 'X'                    TO ERROR-SWITCH.
 10385
 10386 2010-EXIT.
 10387     EXIT.
 10388
 10389 2020-NORMAL-UPDATE.
 10390     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10391
 10392     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10393
 10394     IF WS-OPEN-CLOSE-SW = 'Y'
 10395       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10396       IF PI-REC-FOUND-SW = 'Y'
 10397         IF CL-ACTIVITY-CODE = 09
 10398           NEXT SENTENCE
 10399         ELSE
 10400           IF WS-RESET-SW = 'Y'
 10401             IF CL-CLAIM-STATUS = 'C'
 10402               MOVE 07               TO  CL-ACTIVITY-CODE
 10403               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10404               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10405             ELSE
 10406               MOVE 08               TO  CL-ACTIVITY-CODE
 10407               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10408               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10409
 10410     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10411         MOVE 'Y'                TO CL-YESNOSW
 10412     END-IF.
 10413
 10414     if pi-company-id = 'DCC'
 10415        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10416        perform 2120-check-pdef  thru 2120-exit
 10417     end-if
 10418     if ((benperl <> zeros)
 10419        and (benperi numeric))
 10420                  or
 10421            (instypel <> zeros)
 10422        perform 2140-update-elcrtt thru 2140-exit
 10423     end-if
 10424
 10425* EXEC CICS HANDLE CONDITION
 10426*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 192
* EL131.cbl
 10427*    END-EXEC.
 10428*    MOVE '"$$                   ! + #00009698' TO DFHEIV0
 10429     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10431     MOVE X'2B20233030303039363938' TO DFHEIV0(25:11)
 10432     CALL 'kxdfhei1' USING DFHEIV0
 10433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10434
 10435
 10436
 10437* EXEC CICS REWRITE
 10438*         DATASET   (CLMS-FILE-ID)
 10439*         FROM      (CLAIM-MASTER)
 10440*    END-EXEC.
 10441     MOVE LENGTH OF
 10442      CLAIM-MASTER
 10443       TO DFHEIV11
 10444*    MOVE '&& L                  %   #00009702' TO DFHEIV0
 10445     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10446     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10447     MOVE X'2020233030303039373032' TO DFHEIV0(25:11)
 10448     CALL 'kxdfhei1' USING DFHEIV0,
 10449           CLMS-FILE-ID,
 10450           CLAIM-MASTER,
 10451           DFHEIV11,
 10452           DFHEIV99
 10453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10454
 10455
 10456 2020-EXIT.
 10457     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 193
* EL131.cbl
 10459 2030-KEY-UPDATE.
 10460     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10461
 10462
 10463* EXEC CICS DELETE
 10464*        DATASET  (CLMS-FILE-ID)
 10465*    END-EXEC.
 10466*    MOVE '&(                    &   #00009713' TO DFHEIV0
 10467     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10468     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10469     MOVE X'2020233030303039373133' TO DFHEIV0(25:11)
 10470     CALL 'kxdfhei1' USING DFHEIV0,
 10471           CLMS-FILE-ID,
 10472           DFHEIV99,
 10473           DFHEIV99,
 10474           DFHEIV99,
 10475           DFHEIV99
 10476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10477
 10478
 10479
 10480* EXEC CICS GETMAIN
 10481*         SET      (ADDRESS OF CLAIM-MASTER)
 10482*         LENGTH   (MSTR-LENGTH)
 10483*         INITIMG  (GETMAIN-SPACE)
 10484*    END-EXEC.
 10485*    MOVE ',"IL                  $   #00009717' TO DFHEIV0
 10486     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10487     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10488     MOVE X'2020233030303039373137' TO DFHEIV0(25:11)
 10489     CALL 'kxdfhei1' USING DFHEIV0,
 10490           DFHEIV20,
 10491           MSTR-LENGTH,
 10492           GETMAIN-SPACE
 10493     SET ADDRESS OF CLAIM-MASTER TO
 10494         DFHEIV20
 10495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10496
 10497
 10498     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10499
 10500     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10501
 10502     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10503
 10504     IF WS-OPEN-CLOSE-SW = 'Y'
 10505       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10506         IF PI-REC-FOUND-SW = 'Y'
 10507           IF CL-ACTIVITY-CODE = 09
 10508             NEXT SENTENCE
 10509           ELSE
 10510             IF WS-RESET-SW = 'Y'
 10511               IF CL-CLAIM-STATUS = 'C'
 10512                 MOVE 07             TO  CL-ACTIVITY-CODE
 10513                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10514                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10515               ELSE
 10516                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 194
* EL131.cbl
 10517                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10518                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10519
 10520
 10521* EXEC CICS HANDLE CONDITION
 10522*         DUPKEY    (2030-EXIT)
 10523*    END-EXEC.
 10524*    MOVE '"$$                   ! , #00009745' TO DFHEIV0
 10525     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10527     MOVE X'2C20233030303039373435' TO DFHEIV0(25:11)
 10528     CALL 'kxdfhei1' USING DFHEIV0
 10529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10530
 10531
 10532** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10533*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10534
 10535     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10536         MOVE 'Y'                TO CL-YESNOSW
 10537     END-IF.
 10538
 10539
 10540* EXEC CICS WRITE
 10541*         DATASET   (CLMS-FILE-ID)
 10542*         RIDFLD    (MSTR-KEY)
 10543*         FROM      (CLAIM-MASTER)
 10544*    END-EXEC.
 10545     MOVE LENGTH OF
 10546      CLAIM-MASTER
 10547       TO DFHEIV11
 10548*    MOVE '&$ L                  ''   #00009756' TO DFHEIV0
 10549     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10550     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10551     MOVE X'2020233030303039373536' TO DFHEIV0(25:11)
 10552     CALL 'kxdfhei1' USING DFHEIV0,
 10553           CLMS-FILE-ID,
 10554           CLAIM-MASTER,
 10555           DFHEIV11,
 10556           MSTR-KEY,
 10557           DFHEIV99,
 10558           DFHEIV99
 10559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10560
 10561
 10562 2030-EXIT.
 10563     EXIT.
 10564
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 195
* EL131.cbl
 10566 2040-NORMAL-UPDATE.
 10567
 10568* EXEC CICS READ UPDATE
 10569*         DATASET  (CERT-FILE-ID)
 10570*         RIDFLD   (CERT-KEY)
 10571*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10572*    END-EXEC.
 10573*    MOVE '&"S        EU         (   #00009767' TO DFHEIV0
 10574     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10575     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10576     MOVE X'2020233030303039373637' TO DFHEIV0(25:11)
 10577     CALL 'kxdfhei1' USING DFHEIV0,
 10578           CERT-FILE-ID,
 10579           DFHEIV20,
 10580           DFHEIV99,
 10581           CERT-KEY,
 10582           DFHEIV99,
 10583           DFHEIV99,
 10584           DFHEIV99
 10585     SET ADDRESS OF CERTIFICATE-MASTER TO
 10586         DFHEIV20
 10587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10588
 10589
 10590     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10591
 10592
 10593* EXEC CICS HANDLE CONDITION
 10594*         DUPKEY   (2040-EXIT)
 10595*    END-EXEC.
 10596*    MOVE '"$$                   ! - #00009775' TO DFHEIV0
 10597     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10599     MOVE X'2D20233030303039373735' TO DFHEIV0(25:11)
 10600     CALL 'kxdfhei1' USING DFHEIV0
 10601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10602
 10603
 10604
 10605* EXEC CICS REWRITE
 10606*         DATASET  (CERT-FILE-ID)
 10607*         FROM     (CERTIFICATE-MASTER)
 10608*    END-EXEC.
 10609     MOVE LENGTH OF
 10610      CERTIFICATE-MASTER
 10611       TO DFHEIV11
 10612*    MOVE '&& L                  %   #00009779' TO DFHEIV0
 10613     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10614     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10615     MOVE X'2020233030303039373739' TO DFHEIV0(25:11)
 10616     CALL 'kxdfhei1' USING DFHEIV0,
 10617           CERT-FILE-ID,
 10618           CERTIFICATE-MASTER,
 10619           DFHEIV11,
 10620           DFHEIV99
 10621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10622
 10623
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 196
* EL131.cbl
 10624 2040-EXIT.
 10625     EXIT.
 10626
 10627 2050-KEY-UPDATE.
 10628
 10629* EXEC CICS READ UPDATE
 10630*         DATASET  (CERT-FILE-ID)
 10631*         RIDFLD   (CERT-KEY)
 10632*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10633*    END-EXEC.
 10634*    MOVE '&"S        EU         (   #00009788' TO DFHEIV0
 10635     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10636     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10637     MOVE X'2020233030303039373838' TO DFHEIV0(25:11)
 10638     CALL 'kxdfhei1' USING DFHEIV0,
 10639           CERT-FILE-ID,
 10640           DFHEIV20,
 10641           DFHEIV99,
 10642           CERT-KEY,
 10643           DFHEIV99,
 10644           DFHEIV99,
 10645           DFHEIV99
 10646     SET ADDRESS OF CERTIFICATE-MASTER TO
 10647         DFHEIV20
 10648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10649
 10650
 10651     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10652
 10653
 10654* EXEC CICS DELETE
 10655*         DATASET   (CERT-FILE-ID)
 10656*    END-EXEC.
 10657*    MOVE '&(                    &   #00009796' TO DFHEIV0
 10658     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10659     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10660     MOVE X'2020233030303039373936' TO DFHEIV0(25:11)
 10661     CALL 'kxdfhei1' USING DFHEIV0,
 10662           CERT-FILE-ID,
 10663           DFHEIV99,
 10664           DFHEIV99,
 10665           DFHEIV99,
 10666           DFHEIV99
 10667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10668
 10669
 10670
 10671* EXEC CICS GETMAIN
 10672*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10673*         LENGTH    (CERT-LENGTH)
 10674*         INITIMG   (GETMAIN-SPACE)
 10675*    END-EXEC.
 10676*    MOVE ',"IL                  $   #00009800' TO DFHEIV0
 10677     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10678     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10679     MOVE X'2020233030303039383030' TO DFHEIV0(25:11)
 10680     CALL 'kxdfhei1' USING DFHEIV0,
 10681           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 197
* EL131.cbl
 10682           CERT-LENGTH,
 10683           GETMAIN-SPACE
 10684     SET ADDRESS OF CERTIFICATE-MASTER TO
 10685         DFHEIV20
 10686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10687
 10688
 10689     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10690
 10691     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10692
 10693
 10694* EXEC CICS HANDLE CONDITION
 10695*         DUPKEY (2050-EXIT)
 10696*    END-EXEC.
 10697*    MOVE '"$$                   ! . #00009810' TO DFHEIV0
 10698     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10700     MOVE X'2E20233030303039383130' TO DFHEIV0(25:11)
 10701     CALL 'kxdfhei1' USING DFHEIV0
 10702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10703
 10704
 10705
 10706* EXEC CICS WRITE
 10707*         DATASET  (CERT-FILE-ID)
 10708*         RIDFLD   (CERT-KEY)
 10709*         FROM     (CERTIFICATE-MASTER)
 10710*    END-EXEC.
 10711     MOVE LENGTH OF
 10712      CERTIFICATE-MASTER
 10713       TO DFHEIV11
 10714*    MOVE '&$ L                  ''   #00009814' TO DFHEIV0
 10715     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10716     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10717     MOVE X'2020233030303039383134' TO DFHEIV0(25:11)
 10718     CALL 'kxdfhei1' USING DFHEIV0,
 10719           CERT-FILE-ID,
 10720           CERTIFICATE-MASTER,
 10721           DFHEIV11,
 10722           CERT-KEY,
 10723           DFHEIV99,
 10724           DFHEIV99
 10725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10726
 10727
 10728 2050-EXIT.
 10729     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 198
* EL131.cbl
 10731 2060-CHANGE-CERT.
 10732     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10733     MOVE PI-CARRIER             TO CERT-CARRIER.
 10734     MOVE PI-GROUPING            TO CERT-GROUP.
 10735     MOVE PI-STATE               TO CERT-STATE.
 10736     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10737     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10738     MOVE PI-CERT-NO             TO CERT-CERT.
 10739     IF CERTEFFI GREATER THAN LOW-VALUES
 10740         MOVE HOLD-EFF           TO CERT-DATE.
 10741     IF CERTACTI GREATER THAN LOW-VALUES
 10742         MOVE CERTACTI           TO CERT-ACCOUNT.
 10743     IF CERTSTI GREATER THAN LOW-VALUES
 10744         MOVE CERTSTI            TO CERT-STATE.
 10745     IF CERTCARI GREATER THAN LOW-VALUES
 10746         MOVE CERTCARI           TO CERT-CARRIER.
 10747     IF CERTGRPI GREATER THAN LOW-VALUES
 10748         MOVE CERTGRPI           TO CERT-GROUP.
 10749     IF CERTI GREATER THAN LOW-VALUES
 10750         MOVE CERTI              TO CERT-CERT-PRIME.
 10751     IF SUFXI GREATER THAN LOW-VALUES
 10752         MOVE SUFXI              TO CERT-CERT-SUFX.
 10753
 10754
 10755* EXEC CICS HANDLE CONDITION
 10756*         NOTFND   (2060-CERT-NOTFND)
 10757*    END-EXEC.
 10758*    MOVE '"$I                   ! / #00009846' TO DFHEIV0
 10759     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10760     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10761     MOVE X'2F20233030303039383436' TO DFHEIV0(25:11)
 10762     CALL 'kxdfhei1' USING DFHEIV0
 10763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10764
 10765
 10766
 10767* EXEC CICS READ UPDATE
 10768*         DATASET  (CERT-FILE-ID)
 10769*         RIDFLD   (CERT-KEY)
 10770*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10771*    END-EXEC.
 10772*    MOVE '&"S        EU         (   #00009850' TO DFHEIV0
 10773     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10774     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10775     MOVE X'2020233030303039383530' TO DFHEIV0(25:11)
 10776     CALL 'kxdfhei1' USING DFHEIV0,
 10777           CERT-FILE-ID,
 10778           DFHEIV20,
 10779           DFHEIV99,
 10780           CERT-KEY,
 10781           DFHEIV99,
 10782           DFHEIV99,
 10783           DFHEIV99
 10784     SET ADDRESS OF CERTIFICATE-MASTER TO
 10785         DFHEIV20
 10786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10787
 10788
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 199
* EL131.cbl
 10789     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10790
 10791     IF CM-CLAIM-INTERFACE-SW = SPACES
 10792        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10793
 10794
 10795* EXEC CICS HANDLE CONDITION
 10796*         DUPKEY   (2060-DUPKEY)
 10797*    END-EXEC.
 10798*    MOVE '"$$                   ! 0 #00009861' TO DFHEIV0
 10799     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10800     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10801     MOVE X'3020233030303039383631' TO DFHEIV0(25:11)
 10802     CALL 'kxdfhei1' USING DFHEIV0
 10803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10804
 10805
 10806
 10807* EXEC CICS REWRITE
 10808*         DATASET  (CERT-FILE-ID)
 10809*         FROM     (CERTIFICATE-MASTER)
 10810*    END-EXEC.
 10811     MOVE LENGTH OF
 10812      CERTIFICATE-MASTER
 10813       TO DFHEIV11
 10814*    MOVE '&& L                  %   #00009865' TO DFHEIV0
 10815     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10816     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10817     MOVE X'2020233030303039383635' TO DFHEIV0(25:11)
 10818     CALL 'kxdfhei1' USING DFHEIV0,
 10819           CERT-FILE-ID,
 10820           CERTIFICATE-MASTER,
 10821           DFHEIV11,
 10822           DFHEIV99
 10823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10824
 10825
 10826 2060-DUPKEY.
 10827
 10828     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10829
 10830 2060-CHANGE-TRLR-ACTQ.
 10831     IF SCREEN-ERROR
 10832         GO TO 2060-EXIT.
 10833
 10834     IF CERTI    GREATER LOW-VALUES OR
 10835        SUFXI    GREATER LOW-VALUES OR
 10836        CERTCARI GREATER LOW-VALUES
 10837         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10838         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10839
 10840     MOVE SPACES                 TO CERT-KEY-SWITCH
 10841                                    CERT-SWITCH
 10842                                    TRLR-SWITCH
 10843                                    NINETY-TRLR-SWITCH.
 10844     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10845     GO TO 2060-EXIT.
 10846
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 200
* EL131.cbl
 10847 2060-CERT-NOTFND.
 10848     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10849
 10850     IF WS-REC-FOUND-SW = 'N'
 10851         MOVE ER-0206            TO  EMI-ERROR
 10852         MOVE -1                 TO  MAINTL
 10853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10854
 10855* EXEC CICS UNLOCK
 10856*            DATASET   (CLMS-FILE-ID)
 10857*        END-EXEC
 10858*    MOVE '&*                    #   #00009898' TO DFHEIV0
 10859     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10860     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10861     MOVE X'2020233030303039383938' TO DFHEIV0(25:11)
 10862     CALL 'kxdfhei1' USING DFHEIV0,
 10863           CLMS-FILE-ID,
 10864           DFHEIV99
 10865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10866         GO TO 8110-SEND-DATA.
 10867
 10868     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10869
 10870     GO TO 2060-CHANGE-TRLR-ACTQ.
 10871
 10872 2060-EXIT.
 10873     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 201
* EL131.cbl
 10875 2070-CHECK-OLD.
 10876
 10877
 10878* EXEC CICS HANDLE CONDITION
 10879*        NOTFND   (2070-NOT-FOUND)
 10880*    END-EXEC.
 10881*    MOVE '"$I                   ! 1 #00009912' TO DFHEIV0
 10882     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10883     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10884     MOVE X'3120233030303039393132' TO DFHEIV0(25:11)
 10885     CALL 'kxdfhei1' USING DFHEIV0
 10886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10887
 10888
 10889     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10890     MOVE PI-CARRIER             TO CERT-CARRIER.
 10891     MOVE PI-GROUPING            TO CERT-GROUP.
 10892     MOVE PI-STATE               TO CERT-STATE.
 10893     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10894     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10895     MOVE PI-CERT-NO             TO CERT-CERT.
 10896
 10897
 10898* EXEC CICS READ UPDATE
 10899*         DATASET  (CERT-FILE-ID)
 10900*         RIDFLD   (CERT-KEY)
 10901*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10902*    END-EXEC.
 10903*    MOVE '&"S        EU         (   #00009924' TO DFHEIV0
 10904     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10905     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10906     MOVE X'2020233030303039393234' TO DFHEIV0(25:11)
 10907     CALL 'kxdfhei1' USING DFHEIV0,
 10908           CERT-FILE-ID,
 10909           DFHEIV20,
 10910           DFHEIV99,
 10911           CERT-KEY,
 10912           DFHEIV99,
 10913           DFHEIV99,
 10914           DFHEIV99
 10915     SET ADDRESS OF CERTIFICATE-MASTER TO
 10916         DFHEIV20
 10917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10918
 10919
 10920     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10921     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10922     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10923
 10924     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10925         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10926
 10927     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10928       AND
 10929        CERT-WAS-CREATED-FOR-CLAIM
 10930         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10931
 10932* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 202
* EL131.cbl
 10933*             DATASET   (CERT-FILE-ID)
 10934*        END-EXEC
 10935*    MOVE '&(                    &   #00009941' TO DFHEIV0
 10936     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10937     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10938     MOVE X'2020233030303039393431' TO DFHEIV0(25:11)
 10939     CALL 'kxdfhei1' USING DFHEIV0,
 10940           CERT-FILE-ID,
 10941           DFHEIV99,
 10942           DFHEIV99,
 10943           DFHEIV99,
 10944           DFHEIV99
 10945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10946         GO TO 2070-EXIT.
 10947
 10948     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10949         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10950
 10951
 10952* EXEC CICS HANDLE CONDITION
 10953*         DUPKEY   (2070-EXIT)
 10954*    END-EXEC.
 10955*    MOVE '"$$                   ! 2 #00009949' TO DFHEIV0
 10956     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10958     MOVE X'3220233030303039393439' TO DFHEIV0(25:11)
 10959     CALL 'kxdfhei1' USING DFHEIV0
 10960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10961
 10962
 10963
 10964* EXEC CICS REWRITE
 10965*         DATASET  (CERT-FILE-ID)
 10966*         FROM     (CERTIFICATE-MASTER)
 10967*    END-EXEC.
 10968     MOVE LENGTH OF
 10969      CERTIFICATE-MASTER
 10970       TO DFHEIV11
 10971*    MOVE '&& L                  %   #00009953' TO DFHEIV0
 10972     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10973     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10974     MOVE X'2020233030303039393533' TO DFHEIV0(25:11)
 10975     CALL 'kxdfhei1' USING DFHEIV0,
 10976           CERT-FILE-ID,
 10977           CERTIFICATE-MASTER,
 10978           DFHEIV11,
 10979           DFHEIV99
 10980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10981
 10982
 10983     GO TO 2070-EXIT.
 10984
 10985 2070-NOT-FOUND.
 10986     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10987
 10988 2070-EXIT.
 10989     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 203
* EL131.cbl
 10991 2080-CREATE-CERT.
 10992
 10993* EXEC CICS GETMAIN
 10994*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10995*         LENGTH    (CERT-LENGTH)
 10996*         INITIMG   (GETMAIN-SPACE)
 10997*    END-EXEC.
 10998*    MOVE ',"IL                  $   #00009967' TO DFHEIV0
 10999     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11000     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11001     MOVE X'2020233030303039393637' TO DFHEIV0(25:11)
 11002     CALL 'kxdfhei1' USING DFHEIV0,
 11003           DFHEIV20,
 11004           CERT-LENGTH,
 11005           GETMAIN-SPACE
 11006     SET ADDRESS OF CERTIFICATE-MASTER TO
 11007         DFHEIV20
 11008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11009
 11010
 11011     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11012
 11013     IF CERTEFFI GREATER THAN LOW-VALUES
 11014         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11015                                    DC-BIN-DATE-1
 11016         MOVE '6'                TO DC-OPTION-CODE
 11017         MOVE +1                 TO DC-ELAPSED-MONTHS
 11018         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11019         IF NO-CONVERSION-ERROR
 11020             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11021
 11022     IF CERTACTI GREATER THAN LOW-VALUES
 11023         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11024     IF CERTSTI GREATER THAN LOW-VALUES
 11025         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11026     IF CERTCARI GREATER THAN LOW-VALUES
 11027         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11028     IF CERTGRPI GREATER THAN LOW-VALUES
 11029         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11030     IF CERTI GREATER THAN LOW-VALUES
 11031         MOVE CERTI              TO CERT-CERT-PRIME
 11032                                    CM-CERT-PRIME
 11033         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11034
 11035     IF SUFXI GREATER THAN LOW-VALUES
 11036         MOVE SUFXI              TO CERT-CERT-SUFX
 11037                                    CM-CERT-SFX
 11038         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11039
 11040     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11041
 11042     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11043
 11044     MOVE SPACES                 TO CM-ENTRY-BATCH
 11045                                    CM-LF-EXIT-BATCH
 11046                                    CM-AH-EXIT-BATCH
 11047                                    CM-CREDIT-INTERFACE-SW-1
 11048                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 204
* EL131.cbl
 11049
 11050     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11051                               '9' OR 'D' OR 'V'
 11052         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11053
 11054     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11055                               '9' OR 'D' OR 'V'
 11056         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11057
 11058     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11059                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11060     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11061
 11062
 11063* EXEC CICS HANDLE CONDITION
 11064*         DUPKEY (2080-EXIT)
 11065*    END-EXEC.
 11066*    MOVE '"$$                   ! 3 #00010024' TO DFHEIV0
 11067     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11069     MOVE X'3320233030303130303234' TO DFHEIV0(25:11)
 11070     CALL 'kxdfhei1' USING DFHEIV0
 11071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11072
 11073
 11074
 11075* EXEC CICS WRITE
 11076*         DATASET  (CERT-FILE-ID)
 11077*         RIDFLD   (CERT-KEY)
 11078*         FROM     (CERTIFICATE-MASTER)
 11079*    END-EXEC.
 11080     MOVE LENGTH OF
 11081      CERTIFICATE-MASTER
 11082       TO DFHEIV11
 11083*    MOVE '&$ L                  ''   #00010028' TO DFHEIV0
 11084     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11085     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11086     MOVE X'2020233030303130303238' TO DFHEIV0(25:11)
 11087     CALL 'kxdfhei1' USING DFHEIV0,
 11088           CERT-FILE-ID,
 11089           CERTIFICATE-MASTER,
 11090           DFHEIV11,
 11091           CERT-KEY,
 11092           DFHEIV99,
 11093           DFHEIV99
 11094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11095
 11096
 11097 2080-EXIT.
 11098     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 205
* EL131.cbl
 11100 2100-MOVE-MSTR.
 11101     IF TYPEI GREATER THAN LOW-VALUES
 11102         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11103
 11104     IF STATUSI = LOW-VALUES
 11105         GO TO 2100-NO-STATUS-CHANGE.
 11106
 11107     IF STATUSI = 'OPEN' OR 'O'
 11108         IF CL-CLAIM-STATUS = 'O'
 11109             MOVE SPACES         TO TRLR-SWITCH
 11110                 GO TO 2100-NO-STATUS-CHANGE.
 11111
 11112     IF STATUSI = 'CLOSED' OR 'C'
 11113         IF CL-CLAIM-STATUS = 'C'
 11114             MOVE SPACES         TO TRLR-SWITCH
 11115                 GO TO 2100-NO-STATUS-CHANGE.
 11116
 11117     IF PI-COMPANY-ID = 'DMD'
 11118        IF STATUSI = 'OPEN' OR 'O'
 11119           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11120              MOVE ZERO       TO STATUSL
 11121              MOVE LOW-VALUES TO STATUSI
 11122              GO TO 2100-NO-STATUS-CHANGE.
 11123
 11124     IF PI-COMPANY-ID = 'DMD'
 11125         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11126
 11127     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11128
 11129 2100-NO-STATUS-CHANGE.
 11130
 11131     IF CCNOI GREATER THAN LOW-VALUES
 11132         MOVE CCNOI              TO CL-CCN.
 11133
 11134     IF PROCI GREATER THAN LOW-VALUES
 11135         MOVE PROCI              TO CL-PROCESSOR-ID.
 11136
 11137     if (accswi > low-values)
 11138        and (accswi = 'Y' OR 'N')
 11139        move accswi              to cl-accident-claim-sw
 11140     end-if
 11141     if benperi > low-values
 11142        and benperi numeric
 11143        move benperi             to cl-benefit-period
 11144     end-if
 11145     if instypei > low-values
 11146        move instypei            to cl-insured-type
 11147     end-if
 11148     IF SEXI GREATER THAN LOW-VALUES
 11149         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11150
 11151     IF BIRTHI GREATER THAN LOW-VALUES
 11152         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11153
 11154     IF SOCIALI GREATER THAN LOW-VALUES
 11155       AND
 11156        SOCIALI = SPACES
 11157         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 206
* EL131.cbl
 11158         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11159         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11160     ELSE
 11161         IF SOCIALI GREATER THAN LOW-VALUES
 11162             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11163
 11164     IF OCCI GREATER THAN LOW-VALUES
 11165         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11166
 11167     IF BENEL GREATER THAN ZERO
 11168         MOVE BENEI              TO CL-BENEFICIARY.
 11169
 11170     IF DIAGI GREATER THAN LOW-VALUES
 11171         MOVE DIAGI              TO WS-DIAGNOSIS.
 11172
 11173     IF ICD1I GREATER THAN LOW-VALUES
 11174         MOVE ICD1I              TO WS-ICD-CODE-1
 11175     END-IF.
 11176
 11177     IF ICD2I GREATER THAN LOW-VALUES
 11178         MOVE ICD2I              TO WS-ICD-CODE-2
 11179     END-IF.
 11180
 11181     IF PREMTYPI GREATER THAN LOW-VALUES
 11182         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11183
 11184*    IF CAUSEI GREATER THAN LOW-VALUES
 11185*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11186
 11187*    IF ENDI GREATER THAN LOW-VALUES
 11188*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11189
 11190     IF PDTHRUI GREATER THAN LOW-VALUES
 11191        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11192
 11193     IF PDAMTL GREATER THAN +0
 11194        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11195
 11196     IF NODAYSI GREATER THAN LOW-VALUES
 11197        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11198
 11199     IF NOPMTSI GREATER THAN LOW-VALUES
 11200        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11201
 11202     IF FORMTYPI GREATER THAN LOW-VALUES
 11203        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11204
 11205     IF INCI GREATER THAN LOW-VALUES
 11206        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11207
 11208     IF REPI GREATER THAN LOW-VALUES
 11209        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11210
 11211     IF ADDONDTI GREATER THAN LOW-VALUES
 11212        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11213
 11214     IF PRICDI GREATER THAN LOW-VALUES
 11215         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 207
* EL131.cbl
 11216
 11217     IF CRITPL  > ZEROS
 11218        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11219     END-IF
 11220
 11221*    IF CRITPTL > ZEROS
 11222*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11223*    END-IF
 11224
 11225*    IF RTWMOSL > ZEROS
 11226*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11227*    END-IF
 11228     IF FILETOI GREATER THAN LOW-VALUES
 11229         MOVE FILETOI            TO CL-FILE-LOCATION.
 11230
 11231     IF SUPVI GREATER THAN LOW-VALUES
 11232         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11233
 11234     IF MLNAMEI GREATER THAN LOW-VALUES
 11235         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11236
 11237     IF MFNAMEI GREATER THAN LOW-VALUES
 11238         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11239
 11240     IF MMINITI GREATER THAN LOW-VALUES
 11241         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11242
 11243     IF CERTEFFI GREATER THAN LOW-VALUES
 11244         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11245
 11246     IF CERTACTI GREATER THAN LOW-VALUES
 11247         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11248
 11249     IF CERTSTI GREATER THAN LOW-VALUES
 11250         MOVE CERTSTI            TO CL-CERT-STATE.
 11251
 11252     IF CERTCARI GREATER THAN LOW-VALUES
 11253         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11254                                    CL-CARRIER.
 11255
 11256     IF CERTGRPI GREATER THAN LOW-VALUES
 11257         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11258
 11259     IF CERTI GREATER THAN LOW-VALUES
 11260         MOVE CERTI              TO CERT-NO-PRIME.
 11261
 11262     IF SUFXI GREATER THAN LOW-VALUES
 11263         MOVE SUFXI              TO CERT-NO-SUFX.
 11264
 11265     MOVE CERT-NO                TO CL-CERT-NO
 11266                                    CL-CERT-NO-A4.
 11267
 11268     IF PI-COMPANY-ID = 'FLA'
 11269          NEXT SENTENCE
 11270     ELSE
 11271         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11272         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11273         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 208
* EL131.cbl
 11274         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11275
 11276     IF TRLR-UPDATE-REQUIRED
 11277        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11278        MOVE ZEROS              TO TRLR-SEQ-NO
 11279
 11280* EXEC CICS READ
 11281*            DATASET   (TRLR-FILE-ID)
 11282*            RIDFLD    (TRLR-KEY)
 11283*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11284*       END-EXEC
 11285*    MOVE '&"S        E          (   #00010216' TO DFHEIV0
 11286     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11287     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11288     MOVE X'2020233030303130323136' TO DFHEIV0(25:11)
 11289     CALL 'kxdfhei1' USING DFHEIV0,
 11290           TRLR-FILE-ID,
 11291           DFHEIV20,
 11292           DFHEIV99,
 11293           TRLR-KEY,
 11294           DFHEIV99,
 11295           DFHEIV99,
 11296           DFHEIV99
 11297     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11298         DFHEIV20
 11299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11300        IF AT-TRAILER-TYPE = '1'
 11301           MOVE +1 TO MISC-SUB
 11302           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11303           MISC-SUB GREATER THAN +6 OR
 11304           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11305           IF MISC-SUB GREATER THAN +1
 11306              SUBTRACT +1 FROM MISC-SUB
 11307              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11308                 GO TO 2100-BYPASS-LAST-UPDATE.
 11309
 11310     IF TRLR-UPDATE-REQUIRED AND
 11311        CLAIM-IS-OPEN
 11312         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11313     ELSE
 11314         IF TRLR-UPDATE-REQUIRED AND
 11315            CLAIM-IS-CLOSED
 11316             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11317             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11318
 11319 2100-BYPASS-LAST-UPDATE.
 11320     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11321     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11322
 11323     GO TO 2100-EXIT.
 11324
 11325 2100-BUMP-OPEN-CLOSE-HIST.
 11326     ADD +1                      TO MISC-SUB.
 11327
 11328 2100-EXIT.
 11329     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 209
* EL131.cbl
 11331 2120-check-pdef.
 11332     move +0                     to s1
 11333     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11334     move spaces                 to ws-dcc-error-line
 11335     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11336     IF ERPDEF-FOUND
 11337        perform 2130-check-trlr  thru 2130-exit
 11338        move +1                  to s1
 11339*       if cl-accident-claim-sw = ' '
 11340*          move er-1655             to ws-error-no (s1)
 11341*          add +1 to s1
 11342*       end-if
 11343        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11344        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11345        if (hold-incur > low-values)
 11346           and (incl > zeros)
 11347           and (hold-incur not = cl-incurred-dt)
 11348           move hold-incur       to dc-bin-date-2
 11349        end-if
 11350        MOVE '1'                 TO DC-OPTION-CODE
 11351        MOVE +0                  TO DC-ELAPSED-MONTHS
 11352                                    DC-ELAPSED-DAYS
 11353        PERFORM 9800-CONVERT-DATE
 11354                                 THRU 9800-EXIT
 11355        IF NO-CONVERSION-ERROR
 11356           MOVE DC-ELAPSED-MONTHS
 11357                                 TO WS-MONTHS-BETWEEN
 11358           IF DC-ELAPSED-DAYS > 1
 11359              ADD 1 TO WS-MONTHS-BETWEEN
 11360           END-IF
 11361        ELSE
 11362           display ' dte conv error ' dc-error-code
 11363           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11364        END-IF
 11365        IF (WS-EXCL-PERIOD = ZEROS)
 11366           OR (WS-MONTHS-BETWEEN = ZEROS)
 11367           CONTINUE
 11368        ELSE
 11369           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11370              MOVE ER-1651       TO ws-error-no (s1)
 11371              add +1             to s1
 11372           END-IF
 11373        END-IF
 11374        IF (WS-COV-ENDS = ZEROS)
 11375           OR (WS-MONTHS-BETWEEN = ZEROS)
 11376           CONTINUE
 11377        ELSE
 11378           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11379              MOVE -1            TO MAINTL
 11380              MOVE ER-1653       TO ws-error-no (s1)
 11381              add +1 to s1
 11382           END-IF
 11383        END-IF
 11384        IF (WS-ACC-PERIOD = ZEROS)
 11385           OR (WS-MONTHS-BETWEEN = ZEROS)
 11386           CONTINUE
 11387        ELSE
 11388           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 210
* EL131.cbl
 11389              and (accswi = spaces or low-values)
 11390*             and (cl-accident-claim-sw = ' ')
 11391              move er-1655       to ws-error-no (s1)
 11392              add +1             to s1
 11393           end-if
 11394           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11395*             if (cl-accident-claim-sw not = 'Y')
 11396              if (accswi not = 'Y')
 11397                 MOVE ER-1652    TO ws-error-no (s1)
 11398              else
 11399                 move er-1662    to ws-error-no (s1)
 11400              end-if
 11401              MOVE -1            TO MAINTL
 11402              add +1             to s1
 11403           END-IF
 11404        END-IF
 11405        if cl-claim-type  = 'I'
 11406           move er-1661          to ws-error-no (s1)
 11407           add +1                to s1
 11408        end-if
 11409        perform 2130-check-trlr  thru 2130-exit
 11410     END-IF
 11411
 11412     .
 11413 2120-exit.
 11414     exit.
 11415
 11416 2130-check-trlr.
 11417
 11418     evaluate true
 11419        when s1 = +0
 11420           move cl-control-primary
 11421                                 to trlr-key
 11422           MOVE +95              TO TRLR-SEQ-NO
 11423
 11424* EXEC CICS READ
 11425*             update
 11426*             DATASET  ('ELTRLR')
 11427*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11428*             RIDFLD   (TRLR-KEY)
 11429*             RESP     (WS-RESPONSE)
 11430*          END-EXEC
 11431     MOVE 'ELTRLR' TO DFHEIV1
 11432*    MOVE '&"S        EU         (  N#00010344' TO DFHEIV0
 11433     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11434     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11435     MOVE X'204E233030303130333434' TO DFHEIV0(25:11)
 11436     CALL 'kxdfhei1' USING DFHEIV0,
 11437           DFHEIV1,
 11438           DFHEIV20,
 11439           DFHEIV99,
 11440           TRLR-KEY,
 11441           DFHEIV99,
 11442           DFHEIV99,
 11443           DFHEIV99
 11444     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11445         DFHEIV20
 11446     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 211
* EL131.cbl
 11447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11448           if ws-resp-normal
 11449              move spaces        to at-info-line-1
 11450           end-if
 11451        when s1 = +1
 11452           if ws-resp-normal
 11453
 11454* exec cics rewrite
 11455*                dataset   ('ELTRLR')
 11456*                from      (activity-trailers)
 11457*             end-exec
 11458     MOVE LENGTH OF
 11459      activity-trailers
 11460       TO DFHEIV11
 11461     MOVE 'ELTRLR' TO DFHEIV1
 11462*    MOVE '&& L                  %   #00010356' TO DFHEIV0
 11463     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11464     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11465     MOVE X'2020233030303130333536' TO DFHEIV0(25:11)
 11466     CALL 'kxdfhei1' USING DFHEIV0,
 11467           DFHEIV1,
 11468           activity-trailers,
 11469           DFHEIV11,
 11470           DFHEIV99
 11471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11472           end-if
 11473        when s1 > +1
 11474           if ws-resp-normal
 11475              move ws-dcc-error-line
 11476                                 to at-info-line-1
 11477
 11478* exec cics rewrite
 11479*                dataset   ('ELTRLR')
 11480*                from      (activity-trailers)
 11481*             end-exec
 11482     MOVE LENGTH OF
 11483      activity-trailers
 11484       TO DFHEIV11
 11485     MOVE 'ELTRLR' TO DFHEIV1
 11486*    MOVE '&& L                  %   #00010365' TO DFHEIV0
 11487     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11488     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11489     MOVE X'2020233030303130333635' TO DFHEIV0(25:11)
 11490     CALL 'kxdfhei1' USING DFHEIV0,
 11491           DFHEIV1,
 11492           activity-trailers,
 11493           DFHEIV11,
 11494           DFHEIV99
 11495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11496           else
 11497
 11498* EXEC CICS GETMAIN
 11499*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11500*                LENGTH   (TRLR-LENGTH)
 11501*                INITIMG  (GETMAIN-SPACE)
 11502*             END-EXEC
 11503*    MOVE ',"IL                  $   #00010370' TO DFHEIV0
 11504     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 212
* EL131.cbl
 11505     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11506     MOVE X'2020233030303130333730' TO DFHEIV0(25:11)
 11507     CALL 'kxdfhei1' USING DFHEIV0,
 11508           DFHEIV20,
 11509           TRLR-LENGTH,
 11510           GETMAIN-SPACE
 11511     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11512         DFHEIV20
 11513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11514              move 'AT'          to at-record-id
 11515              move cl-control-primary
 11516                                 to at-control-primary
 11517              move +95           to at-sequence-no
 11518              move '6'           to at-trailer-type
 11519              move ws-dcc-error-line
 11520                                 to at-info-line-1
 11521              move 'E'           to at-info-trailer-type
 11522              move save-bin-date to at-recorded-dt
 11523                                    at-gen-info-last-maint-dt
 11524              move pi-processor-id
 11525                                 to at-recorded-by
 11526                                    at-gen-info-last-updated-by
 11527              move eibtime       to at-last-maint-hhmmss
 11528
 11529* exec cics write
 11530*                dataset   ('ELTRLR')
 11531*                from      (activity-trailers)
 11532*                ridfld    (trlr-key)
 11533*             end-exec
 11534     MOVE LENGTH OF
 11535      activity-trailers
 11536       TO DFHEIV11
 11537     MOVE 'ELTRLR' TO DFHEIV1
 11538*    MOVE '&$ L                  ''   #00010389' TO DFHEIV0
 11539     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11540     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11541     MOVE X'2020233030303130333839' TO DFHEIV0(25:11)
 11542     CALL 'kxdfhei1' USING DFHEIV0,
 11543           DFHEIV1,
 11544           activity-trailers,
 11545           DFHEIV11,
 11546           trlr-key,
 11547           DFHEIV99,
 11548           DFHEIV99
 11549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11550              perform varying s1 from +1 by +1 until
 11551                 ws-error-no (s1) = spaces
 11552                 move ws-error-no (s1)
 11553                                 to emi-error
 11554                 PERFORM 9900-ERROR-FORMAT
 11555                                 THRU 9900-EXIT
 11556              end-perform
 11557           end-if
 11558     end-evaluate
 11559
 11560     .
 11561 2130-exit.
 11562     exit.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 213
* EL131.cbl
 11563 2140-update-elcrtt.
 11564     move ' '                    to crtt-switch
 11565     MOVE CERT-KEY               TO ELCRTT-KEY
 11566     MOVE 'B'                    TO CTRLR-REC-TYPE
 11567
 11568* EXEC CICS READ
 11569*       UPDATE
 11570*       DATASET   ('ELCRTT')
 11571*       RIDFLD    (ELCRTT-KEY)
 11572*       INTO      (CERTIFICATE-TRAILERS)
 11573*       RESP      (WS-RESPONSE)
 11574*    END-EXEC
 11575     MOVE LENGTH OF
 11576      CERTIFICATE-TRAILERS
 11577       TO DFHEIV11
 11578     MOVE 'ELCRTT' TO DFHEIV1
 11579*    MOVE '&"IL       EU         (  N#00010411' TO DFHEIV0
 11580     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11581     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11582     MOVE X'204E233030303130343131' TO DFHEIV0(25:11)
 11583     CALL 'kxdfhei1' USING DFHEIV0,
 11584           DFHEIV1,
 11585           CERTIFICATE-TRAILERS,
 11586           DFHEIV11,
 11587           ELCRTT-KEY,
 11588           DFHEIV99,
 11589           DFHEIV99,
 11590           DFHEIV99
 11591     MOVE EIBRESP  TO WS-RESPONSE
 11592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11593     IF WS-RESP-NORMAL
 11594        perform varying s1 from +1 by +1 until
 11595           (s1 > +24)
 11596           or (cs-claim-no (s1) = cl-claim-no)
 11597        end-perform
 11598        if (s1 < +25)
 11599           if (benperl <> zeros)
 11600              and (cs-benefit-period (s1) not = benperi)
 11601              move benperi       to cs-benefit-period (s1)
 11602              set crtt-update    to true
 11603          end-if
 11604          if (instypel <> zeros)
 11605             and (instypei not = cs-insured-type (s1))
 11606             move instypei      to cs-insured-type (s1)
 11607             set crtt-update    to true
 11608          end-if
 11609          move cs-claim-type (s1) to ws-claim-type
 11610          move cs-benefit-period (s1) to ws-ben-per
 11611        end-if
 11612        if crtt-update
 11613           perform 2150-accum    thru 2150-exit
 11614
 11615* EXEC CICS REWRITE
 11616*             DATASET   ('ELCRTT')
 11617*             FROM      (CERTIFICATE-TRAILERS)
 11618*          END-EXEC
 11619     MOVE LENGTH OF
 11620      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 214
* EL131.cbl
 11621       TO DFHEIV11
 11622     MOVE 'ELCRTT' TO DFHEIV1
 11623*    MOVE '&& L                  %   #00010439' TO DFHEIV0
 11624     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11625     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11626     MOVE X'2020233030303130343339' TO DFHEIV0(25:11)
 11627     CALL 'kxdfhei1' USING DFHEIV0,
 11628           DFHEIV1,
 11629           CERTIFICATE-TRAILERS,
 11630           DFHEIV11,
 11631           DFHEIV99
 11632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11633        else
 11634
 11635* exec cics unlock
 11636*             dataset   ('ELCRTT')
 11637*          end-exec
 11638     MOVE 'ELCRTT' TO DFHEIV1
 11639*    MOVE '&*                    #   #00010444' TO DFHEIV0
 11640     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11641     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11642     MOVE X'2020233030303130343434' TO DFHEIV0(25:11)
 11643     CALL 'kxdfhei1' USING DFHEIV0,
 11644           DFHEIV1,
 11645           DFHEIV99
 11646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11647        end-if
 11648     end-if
 11649     .
 11650 2140-exit.
 11651     exit.
 11652 2150-accum.
 11653     if not erpdef-found
 11654        perform 3997-get-erpdef  thru 3997-exit
 11655     end-if
 11656     if (erpdef-found)
 11657        and (ws-max-moben not = zeros)
 11658        and (ws-max-moben < cm-ah-benefit-amt)
 11659        continue
 11660     else
 11661        move cm-ah-benefit-amt   to ws-max-moben
 11662     end-if
 11663     move cm-ah-orig-term        to ws-max-bens
 11664     if cl-critical-period not = zeros and spaces
 11665        move cl-critical-period  to ws-max-bens
 11666     end-if
 11667     move zeros to ws-tot-days-paid ws-tot-amt-paid
 11668     perform varying s2 from +1 by +1 until
 11669        (s2 > +24)
 11670        or (cs-claim-no (s2) = spaces)
 11671        if (cs-benefit-period (s2) = ws-ben-per)
 11672           and (cs-claim-type (s2) = ws-claim-type)
 11673           and (cs-insured-type (s2) = cl-insured-type)
 11674*          compute ws-tot-days-paid =
 11675*             ws-tot-days-paid + cs-days-paid (s2)
 11676           compute ws-tot-amt-paid =
 11677              ws-tot-amt-paid + cs-total-paid (s2)
 11678        end-if
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 215
* EL131.cbl
 11679     end-perform
 11680     if s2 < +25
 11681        compute ws-pd-bens rounded =
 11682           ws-tot-amt-paid / ws-max-moben
 11683        compute cs-remaining-bens (s1) =
 11684           ws-max-bens - ws-pd-bens
 11685        if cs-remaining-bens (s1) < zeros
 11686           move zeros            to cs-remaining-bens (s1)
 11687        end-if
 11688     end-if
 11689     .
 11690 2150-exit.
 11691     exit.
 11692 2200-MOVE-CERT.
 11693     IF CRTLNMEI GREATER THAN LOW-VALUES
 11694         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11695
 11696     IF CRTFNMEI GREATER THAN LOW-VALUES
 11697         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 11698         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11699
 11700     IF CRTINITI GREATER THAN LOW-VALUES
 11701         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11702
 11703     IF CM-INSURED-INITIALS = SPACES
 11704         MOVE '**'               TO CM-INSURED-INITIALS.
 11705
 11706     IF ISSAGEI GREATER THAN LOW-VALUES
 11707         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11708
 11709     IF JNTFNMEI GREATER THAN LOW-VALUES
 11710         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11711
 11712     IF JNTLNMEI GREATER THAN LOW-VALUES
 11713         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11714
 11715     IF JNTINITI GREATER THAN LOW-VALUES
 11716         MOVE JNTINITI           TO CM-JT-INITIAL.
 11717
 11718     IF JNTAGEI GREATER THAN LOW-VALUES
 11719         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11720
 11721     IF ADDONDTI GREATER THAN LOW-VALUES
 11722        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11723
 11724     IF LCVCDI GREATER THAN LOW-VALUES
 11725        IF LCVCDI = SPACES OR ZEROS
 11726           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11727        ELSE
 11728           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11729
 11730     IF LCVOTRMI GREATER THAN LOW-VALUES
 11731         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11732
 11733     IF LCVRATEL GREATER THAN +0
 11734         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11735
 11736     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 216
* EL131.cbl
 11737         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11738
 11739     IF LCVFORMI GREATER THAN LOW-VALUES
 11740         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11741
 11742     IF LCVCNDTI = LOW-VALUES
 11743        GO TO 2210-SET-STATUS.
 11744
 11745     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11746        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11747        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11748        GO TO 2210-SET-STATUS.
 11749
 11750     IF CM-LF-CURRENT-STATUS = '7'
 11751        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11752        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11753        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11754                                    CM-LF-DEATH-DT
 11755        GO TO 2210-SET-STATUS.
 11756
 11757     IF CM-LF-CURRENT-STATUS = '8'
 11758        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11759        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11760                                    CM-LF-CANCEL-DT.
 11761
 11762 2210-SET-STATUS.
 11763
 11764     IF CM-LF-CURRENT-STATUS = SPACES
 11765         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11766
 11767     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11768         MOVE '6'                TO DC-OPTION-CODE
 11769         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11770         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11771         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11772         IF NO-CONVERSION-ERROR
 11773             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11774         ELSE
 11775             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11776     ELSE
 11777         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11778
 11779 2215-PROCESS-AH-SIDE.
 11780
 11781     IF ACVCDI GREATER THAN LOW-VALUES
 11782        IF ACVCDI = SPACES OR ZEROS
 11783           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11784        ELSE
 11785           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11786
 11787     IF ACVOTRMI GREATER THAN LOW-VALUES
 11788         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11789
 11790     IF ACVRATEL GREATER THAN +0
 11791         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11792
 11793     IF ACVBENEL GREATER THAN +0
 11794         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 217
* EL131.cbl
 11795                                    PI-PAYMENT-AMT.
 11796
 11797     IF ACVFORMI GREATER THAN LOW-VALUES
 11798         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11799
 11800     IF ACVCNDTI = LOW-VALUES
 11801        GO TO 2220-SET-STATUS.
 11802
 11803     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11804        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11805        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11806        GO TO 2220-SET-STATUS.
 11807
 11808     IF CM-AH-CURRENT-STATUS = '6'
 11809        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11810                                 TO CM-AH-CURRENT-STATUS
 11811        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11812        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11813                                    CM-AH-SETTLEMENT-DT
 11814        GO TO 2220-SET-STATUS.
 11815
 11816     IF CM-AH-CURRENT-STATUS = '8'
 11817        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11818        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11819                                    CM-AH-CANCEL-DT.
 11820
 11821 2220-SET-STATUS.
 11822     IF CM-AH-CURRENT-STATUS = SPACES
 11823         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11824
 11825     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11826         MOVE '6'                TO DC-OPTION-CODE
 11827         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11828         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11829         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11830         IF NO-CONVERSION-ERROR
 11831             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11832         ELSE
 11833             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11834     ELSE
 11835         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11836
 11837 2225-FINISH-CERT.
 11838     IF APRL GREATER THAN +0
 11839         MOVE HOLD-APR           TO CM-LOAN-APR.
 11840
 11841     IF PMTFREQI GREATER THAN LOW-VALUES
 11842         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11843
 11844     IF INDGRPI GREATER THAN LOW-VALUES
 11845         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11846
 11847     IF LOANNOI GREATER THAN LOW-VALUES
 11848        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11849
 11850     IF LOANBALL GREATER THAN +0
 11851        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11852
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 218
* EL131.cbl
 11853     IF PREMTYPI GREATER THAN LOW-VALUES
 11854         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11855
 11856     IF REINCDI GREATER THAN LOW-VALUES
 11857         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11858                                    WS-REIN-1
 11859                                    WS-REIN-2
 11860                                    WS-REIN-3
 11861         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11862
 11863     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11864
 11865     MOVE ZEROS                  TO CM-LOAN-TERM
 11866                                    CM-LIFE-COMM-PCT
 11867                                    CM-AH-COMM-PCT.
 11868
 11869*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11870*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11871*         PI-NO-PMTS = ZEROS
 11872*          IF LOANBALL GREATER THAN +0          OR
 11873*             ACVBENEL GREATER THAN +0          OR
 11874*             APRL     GREATER THAN +0          OR
 11875*             LCVRATEL GREATER THAN +0          OR
 11876*             ACVRATEL GREATER THAN +0
 11877*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11878
 11879 2200-EXIT.
 11880     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 219
* EL131.cbl
 11882 2300-UPDATE-TRLR.
 11883     MOVE ZERO                   TO TRLR-SEQ-NO.
 11884
 11885* EXEC CICS READ UPDATE
 11886*         DATASET  (TRLR-FILE-ID)
 11887*         RIDFLD   (TRLR-KEY)
 11888*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11889*    END-EXEC.
 11890*    MOVE '&"S        EU         (   #00010684' TO DFHEIV0
 11891     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11892     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11893     MOVE X'2020233030303130363834' TO DFHEIV0(25:11)
 11894     CALL 'kxdfhei1' USING DFHEIV0,
 11895           TRLR-FILE-ID,
 11896           DFHEIV20,
 11897           DFHEIV99,
 11898           TRLR-KEY,
 11899           DFHEIV99,
 11900           DFHEIV99,
 11901           DFHEIV99
 11902     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11903         DFHEIV20
 11904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11905
 11906
 11907     MOVE ZERO                   TO COUNT-2.
 11908
 11909     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11910         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11911
 11912     IF NOT UPDATE-MADE
 11913         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11914
 11915
 11916* EXEC CICS REWRITE
 11917*         DATASET  (TRLR-FILE-ID)
 11918*         FROM     (ACTIVITY-TRAILERS)
 11919*    END-EXEC.
 11920     MOVE LENGTH OF
 11921      ACTIVITY-TRAILERS
 11922       TO DFHEIV11
 11923*    MOVE '&& L                  %   #00010698' TO DFHEIV0
 11924     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11925     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11926     MOVE X'2020233030303130363938' TO DFHEIV0(25:11)
 11927     CALL 'kxdfhei1' USING DFHEIV0,
 11928           TRLR-FILE-ID,
 11929           ACTIVITY-TRAILERS,
 11930           DFHEIV11,
 11931           DFHEIV99
 11932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11933
 11934
 11935 2300-EXIT.
 11936     EXIT.
 11937
 11938 2310-INS-STATUS.
 11939     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 220
* EL131.cbl
 11940     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11941         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11942         MOVE 'Y'                TO TRLR-SWITCH.
 11943
 11944 2310-EXIT.
 11945     EXIT.
 11946
 11947 2320-SHIFT-STATUS.
 11948     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11949        MOVE 6                   TO COUNT-2
 11950        GO TO 2320-EXIT.
 11951
 11952     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11953     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11954     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11955     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11956     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11957     MOVE 6       TO COUNT-2.
 11958     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11959
 11960 2320-EXIT.
 11961     EXIT.
 11962
 11963 2330-ADD-UPDATE.
 11964
 11965     IF COUNT-2 GREATER THAN 1
 11966        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11967        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11968           GO TO 2330-EXIT.
 11969
 11970     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11971                                   AT-RESERVES-LAST-MAINT-DT
 11972
 11973     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11974     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11975     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11976     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11977
 11978 2330-EXIT.
 11979     EXIT.
 11980
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 221
* EL131.cbl
 11982 2400-UPDATE-TRLR.
 11983
 11984* EXEC CICS HANDLE CONDITION
 11985*         NOTFND    (2400-TRLR-NOTFND)
 11986*         ENDFILE   (2410-EXIT)
 11987*    END-EXEC.
 11988*    MOVE '"$I''                  ! 4 #00010751' TO DFHEIV0
 11989     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11991     MOVE X'3420233030303130373531' TO DFHEIV0(25:11)
 11992     CALL 'kxdfhei1' USING DFHEIV0
 11993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11994
 11995
 11996
 11997* EXEC CICS STARTBR
 11998*        DATASET (TRLR-FILE-ID)
 11999*        RIDFLD  (TRLR-KEY)
 12000*    END-EXEC.
 12001     MOVE 0
 12002       TO DFHEIV11
 12003*    MOVE '&,         G          &   #00010756' TO DFHEIV0
 12004     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12005     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12006     MOVE X'2020233030303130373536' TO DFHEIV0(25:11)
 12007     CALL 'kxdfhei1' USING DFHEIV0,
 12008           TRLR-FILE-ID,
 12009           TRLR-KEY,
 12010           DFHEIV99,
 12011           DFHEIV11,
 12012           DFHEIV99
 12013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12014
 12015
 12016
 12017* EXEC CICS GETMAIN
 12018*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12019*         LENGTH    (TRLR-LENGTH)
 12020*         INITIMG   (GETMAIN-SPACE)
 12021*    END-EXEC.
 12022*    MOVE ',"IL                  $   #00010761' TO DFHEIV0
 12023     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12025     MOVE X'2020233030303130373631' TO DFHEIV0(25:11)
 12026     CALL 'kxdfhei1' USING DFHEIV0,
 12027           DFHEIV20,
 12028           TRLR-LENGTH,
 12029           GETMAIN-SPACE
 12030     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12031         DFHEIV20
 12032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12033
 12034
 12035     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12036
 12037
 12038* EXEC CICS ENDBR
 12039*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 222
* EL131.cbl
 12040*    END-EXEC.
 12041     MOVE 0
 12042       TO DFHEIV11
 12043*    MOVE '&2                    $   #00010769' TO DFHEIV0
 12044     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12045     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12046     MOVE X'2020233030303130373639' TO DFHEIV0(25:11)
 12047     CALL 'kxdfhei1' USING DFHEIV0,
 12048           TRLR-FILE-ID,
 12049           DFHEIV11,
 12050           DFHEIV99
 12051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12052
 12053
 12054     GO TO 2400-EXIT.
 12055
 12056 2400-TRLR-NOTFND.
 12057     MOVE ER-0205                TO EMI-ERROR.
 12058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12059     MOVE 'X'                    TO ERROR-SWITCH.
 12060
 12061 2400-EXIT.
 12062     EXIT.
 12063
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 223
* EL131.cbl
 12065 2410-CHANGE-TRLR.
 12066
 12067* EXEC CICS READNEXT
 12068*        DATASET (TRLR-FILE-ID)
 12069*        RIDFLD  (TRLR-KEY)
 12070*        INTO    (ACTIVITY-TRAILERS)
 12071*    END-EXEC.
 12072     MOVE LENGTH OF
 12073      ACTIVITY-TRAILERS
 12074       TO DFHEIV12
 12075     MOVE 0
 12076       TO DFHEIV11
 12077*    MOVE '&.IL                  )   #00010785' TO DFHEIV0
 12078     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12079     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12080     MOVE X'2020233030303130373835' TO DFHEIV0(25:11)
 12081     CALL 'kxdfhei1' USING DFHEIV0,
 12082           TRLR-FILE-ID,
 12083           ACTIVITY-TRAILERS,
 12084           DFHEIV12,
 12085           TRLR-KEY,
 12086           DFHEIV99,
 12087           DFHEIV11,
 12088           DFHEIV99,
 12089           DFHEIV99
 12090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12091
 12092
 12093     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12094        GO TO 2410-CHANGE-TRLR.
 12095
 12096     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12097                                    CHECK-KEY.
 12098
 12099     IF CHECK-KEY NOT = MSTR-KEY
 12100         GO TO 2410-EXIT.
 12101
 12102
 12103* EXEC CICS ENDBR
 12104*        DATASET (TRLR-FILE-ID)
 12105*    END-EXEC.
 12106     MOVE 0
 12107       TO DFHEIV11
 12108*    MOVE '&2                    $   #00010800' TO DFHEIV0
 12109     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12110     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12111     MOVE X'2020233030303130383030' TO DFHEIV0(25:11)
 12112     CALL 'kxdfhei1' USING DFHEIV0,
 12113           TRLR-FILE-ID,
 12114           DFHEIV11,
 12115           DFHEIV99
 12116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12117
 12118
 12119
 12120* EXEC CICS READ UPDATE
 12121*        DATASET (TRLR-FILE-ID)
 12122*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 224
* EL131.cbl
 12123*        INTO    (ACTIVITY-TRAILERS)
 12124*    END-EXEC.
 12125     MOVE LENGTH OF
 12126      ACTIVITY-TRAILERS
 12127       TO DFHEIV11
 12128*    MOVE '&"IL       EU         (   #00010804' TO DFHEIV0
 12129     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12130     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12131     MOVE X'2020233030303130383034' TO DFHEIV0(25:11)
 12132     CALL 'kxdfhei1' USING DFHEIV0,
 12133           TRLR-FILE-ID,
 12134           ACTIVITY-TRAILERS,
 12135           DFHEIV11,
 12136           TRLR-KEY,
 12137           DFHEIV99,
 12138           DFHEIV99,
 12139           DFHEIV99
 12140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12141
 12142
 12143
 12144* EXEC CICS DELETE
 12145*        DATASET (TRLR-FILE-ID)
 12146*    END-EXEC.
 12147*    MOVE '&(                    &   #00010810' TO DFHEIV0
 12148     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12149     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12150     MOVE X'2020233030303130383130' TO DFHEIV0(25:11)
 12151     CALL 'kxdfhei1' USING DFHEIV0,
 12152           TRLR-FILE-ID,
 12153           DFHEIV99,
 12154           DFHEIV99,
 12155           DFHEIV99,
 12156           DFHEIV99
 12157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12158
 12159
 12160     IF AT-SEQUENCE-NO = ZERO AND
 12161        TRLR-UPDATE-REQUIRED
 12162         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12163
 12164     IF CERTI GREATER THAN LOW-VALUES
 12165        MOVE CERTI               TO AT-CERT-PRIME.
 12166
 12167     IF SUFXI GREATER THAN LOW-VALUES
 12168        MOVE SUFXI               TO AT-CERT-SFX.
 12169
 12170     IF CERTCARI GREATER THAN LOW-VALUES
 12171        MOVE CERTCARI            TO AT-CARRIER.
 12172
 12173     IF PAYMENT-TR
 12174        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12175           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12176              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12177
 12178     IF CORRESPONDENCE-TR
 12179        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12180           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 225
* EL131.cbl
 12181
 12182
 12183* EXEC CICS WRITE
 12184*         DATASET  (TRLR-FILE-ID)
 12185*         RIDFLD   (AT-CONTROL-PRIMARY)
 12186*         FROM     (ACTIVITY-TRAILERS)
 12187*    END-EXEC.
 12188     MOVE LENGTH OF
 12189      ACTIVITY-TRAILERS
 12190       TO DFHEIV11
 12191*    MOVE '&$ L                  ''   #00010836' TO DFHEIV0
 12192     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12193     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12194     MOVE X'2020233030303130383336' TO DFHEIV0(25:11)
 12195     CALL 'kxdfhei1' USING DFHEIV0,
 12196           TRLR-FILE-ID,
 12197           ACTIVITY-TRAILERS,
 12198           DFHEIV11,
 12199           AT-CONTROL-PRIMARY,
 12200           DFHEIV99,
 12201           DFHEIV99
 12202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12203
 12204
 12205
 12206* EXEC CICS STARTBR
 12207*         DATASET  (TRLR-FILE-ID)
 12208*         RIDFLD   (TRLR-KEY)
 12209*    END-EXEC.
 12210     MOVE 0
 12211       TO DFHEIV11
 12212*    MOVE '&,         G          &   #00010842' TO DFHEIV0
 12213     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12214     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12215     MOVE X'2020233030303130383432' TO DFHEIV0(25:11)
 12216     CALL 'kxdfhei1' USING DFHEIV0,
 12217           TRLR-FILE-ID,
 12218           TRLR-KEY,
 12219           DFHEIV99,
 12220           DFHEIV11,
 12221           DFHEIV99
 12222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12223
 12224
 12225     GO TO 2410-CHANGE-TRLR.
 12226
 12227 2410-EXIT.
 12228     EXIT.
 12229
 12230 2420-UPDATE-TRLR.
 12231     MOVE ZERO TO COUNT-2.
 12232     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12233         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12234
 12235     IF NOT UPDATE-MADE
 12236         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12237
 12238 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 226
* EL131.cbl
 12239     EXIT.
 12240
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 227
* EL131.cbl
 12242 2425-UPDATE-NINETY-TRLR.
 12243
 12244     MOVE +90                    TO TRLR-SEQ-NO.
 12245
 12246
 12247* EXEC CICS HANDLE CONDITION
 12248*         NOTFND    (2425-NINETY-NOTFND)
 12249*         ENDFILE   (2425-NINETY-NOTFND)
 12250*    END-EXEC.
 12251*    MOVE '"$I''                  ! 5 #00010868' TO DFHEIV0
 12252     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12254     MOVE X'3520233030303130383638' TO DFHEIV0(25:11)
 12255     CALL 'kxdfhei1' USING DFHEIV0
 12256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12257
 12258
 12259
 12260* EXEC CICS READ UPDATE
 12261*        DATASET (TRLR-FILE-ID)
 12262*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12263*        RIDFLD  (TRLR-KEY)
 12264*    END-EXEC.
 12265*    MOVE '&"S        EU         (   #00010873' TO DFHEIV0
 12266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12267     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12268     MOVE X'2020233030303130383733' TO DFHEIV0(25:11)
 12269     CALL 'kxdfhei1' USING DFHEIV0,
 12270           TRLR-FILE-ID,
 12271           DFHEIV20,
 12272           DFHEIV99,
 12273           TRLR-KEY,
 12274           DFHEIV99,
 12275           DFHEIV99,
 12276           DFHEIV99
 12277     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12278         DFHEIV20
 12279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12280
 12281
 12282     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 12283     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12284     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12285
 12286     IF DIAGI GREATER THAN LOW-VALUES
 12287         MOVE DIAGI             TO AT-INFO-LINE-1
 12288     END-IF.
 12289
 12290     IF ICD1I GREATER THAN LOW-VALUES
 12291         MOVE ICD1I             TO AT-ICD-CODE-1
 12292     END-IF.
 12293
 12294     IF ICD2I GREATER THAN LOW-VALUES
 12295         MOVE ICD2I             TO AT-ICD-CODE-2
 12296     END-IF.
 12297
 12298
 12299* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 228
* EL131.cbl
 12300*        DATASET (TRLR-FILE-ID)
 12301*        FROM    (ACTIVITY-TRAILERS)
 12302*    END-EXEC.
 12303     MOVE LENGTH OF
 12304      ACTIVITY-TRAILERS
 12305       TO DFHEIV11
 12306*    MOVE '&& L                  %   #00010895' TO DFHEIV0
 12307     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12308     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12309     MOVE X'2020233030303130383935' TO DFHEIV0(25:11)
 12310     CALL 'kxdfhei1' USING DFHEIV0,
 12311           TRLR-FILE-ID,
 12312           ACTIVITY-TRAILERS,
 12313           DFHEIV11,
 12314           DFHEIV99
 12315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12316
 12317
 12318     IF DIAGI GREATER THAN LOW-VALUES
 12319       AND DIAGI NOT = WS-DIAGNOSIS
 12320         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12321         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12322         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12323
 12324     IF ICD1I GREATER THAN LOW-VALUES
 12325       AND ICD1I NOT = WS-ICD-CODE-1
 12326         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12327         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12328         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12329     END-IF.
 12330
 12331     IF ICD2I GREATER THAN LOW-VALUES
 12332       AND ICD2I NOT = WS-ICD-CODE-2
 12333         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12334         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12335         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12336     END-IF.
 12337
 12338     GO TO 2425-EXIT.
 12339
 12340 2425-NINETY-NOTFND.
 12341
 12342
 12343* EXEC CICS GETMAIN
 12344*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12345*         LENGTH    (TRLR-LENGTH)
 12346*         INITIMG   (GETMAIN-SPACE)
 12347*    END-EXEC.
 12348*    MOVE ',"IL                  $   #00010924' TO DFHEIV0
 12349     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12350     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12351     MOVE X'2020233030303130393234' TO DFHEIV0(25:11)
 12352     CALL 'kxdfhei1' USING DFHEIV0,
 12353           DFHEIV20,
 12354           TRLR-LENGTH,
 12355           GETMAIN-SPACE
 12356     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12357         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 229
* EL131.cbl
 12358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12359
 12360
 12361     MOVE +90                  TO TRLR-SEQ-NO.
 12362     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12363
 12364     MOVE 'AT'                 TO AT-RECORD-ID
 12365     MOVE '6'                  TO AT-TRAILER-TYPE
 12366     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12367                                  AT-GEN-INFO-LAST-MAINT-DT
 12368     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12369                                  AT-GEN-INFO-LAST-UPDATED-BY
 12370     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12371     MOVE DIAGI                TO AT-INFO-LINE-1.
 12372     MOVE ICD1I                TO AT-ICD-CODE-1.
 12373     MOVE ICD2I                TO AT-ICD-CODE-2.
 12374
 12375
 12376* EXEC CICS WRITE
 12377*        DATASET (TRLR-FILE-ID)
 12378*        FROM    (ACTIVITY-TRAILERS)
 12379*        RIDFLD  (TRLR-KEY)
 12380*    END-EXEC.
 12381     MOVE LENGTH OF
 12382      ACTIVITY-TRAILERS
 12383       TO DFHEIV11
 12384*    MOVE '&$ L                  ''   #00010944' TO DFHEIV0
 12385     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12386     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12387     MOVE X'2020233030303130393434' TO DFHEIV0(25:11)
 12388     CALL 'kxdfhei1' USING DFHEIV0,
 12389           TRLR-FILE-ID,
 12390           ACTIVITY-TRAILERS,
 12391           DFHEIV11,
 12392           TRLR-KEY,
 12393           DFHEIV99,
 12394           DFHEIV99
 12395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12396
 12397
 12398 2425-EXIT.
 12399     EXIT.
 12400
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 230
* EL131.cbl
 12402 2430-UPDATE-ACTQ.
 12403
 12404* EXEC CICS HANDLE CONDITION
 12405*         NOTFND    (2430-EXIT)
 12406*         ENDFILE   (2440-EXIT)
 12407*    END-EXEC.
 12408*    MOVE '"$I''                  ! 6 #00010955' TO DFHEIV0
 12409     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12410     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12411     MOVE X'3620233030303130393535' TO DFHEIV0(25:11)
 12412     CALL 'kxdfhei1' USING DFHEIV0
 12413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12414
 12415
 12416
 12417* EXEC CICS STARTBR
 12418*         DATASET  (ACTQ-FILE-ID)
 12419*         RIDFLD   (ACTQ-KEY)
 12420*    END-EXEC.
 12421     MOVE 0
 12422       TO DFHEIV11
 12423*    MOVE '&,         G          &   #00010960' TO DFHEIV0
 12424     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12425     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12426     MOVE X'2020233030303130393630' TO DFHEIV0(25:11)
 12427     CALL 'kxdfhei1' USING DFHEIV0,
 12428           ACTQ-FILE-ID,
 12429           ACTQ-KEY,
 12430           DFHEIV99,
 12431           DFHEIV11,
 12432           DFHEIV99
 12433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12434
 12435
 12436
 12437* EXEC CICS GETMAIN
 12438*         SET      (ADDRESS OF ACTIVITY-QUE)
 12439*         LENGTH   (ACTQ-LENGTH)
 12440*         INITIMG  (GETMAIN-SPACE)
 12441*    END-EXEC.
 12442*    MOVE ',"IL                  $   #00010965' TO DFHEIV0
 12443     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12444     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12445     MOVE X'2020233030303130393635' TO DFHEIV0(25:11)
 12446     CALL 'kxdfhei1' USING DFHEIV0,
 12447           DFHEIV20,
 12448           ACTQ-LENGTH,
 12449           GETMAIN-SPACE
 12450     SET ADDRESS OF ACTIVITY-QUE TO
 12451         DFHEIV20
 12452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12453
 12454
 12455     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12456
 12457 2430-EXIT.
 12458     EXIT.
 12459
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 231
* EL131.cbl
 12460 2440-CHANGE-ACTQ.
 12461
 12462
 12463* EXEC CICS READNEXT
 12464*         DATASET  (ACTQ-FILE-ID)
 12465*         RIDFLD   (ACTQ-KEY)
 12466*         INTO     (ACTIVITY-QUE)
 12467*    END-EXEC.
 12468     MOVE LENGTH OF
 12469      ACTIVITY-QUE
 12470       TO DFHEIV12
 12471     MOVE 0
 12472       TO DFHEIV11
 12473*    MOVE '&.IL                  )   #00010978' TO DFHEIV0
 12474     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12475     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12476     MOVE X'2020233030303130393738' TO DFHEIV0(25:11)
 12477     CALL 'kxdfhei1' USING DFHEIV0,
 12478           ACTQ-FILE-ID,
 12479           ACTIVITY-QUE,
 12480           DFHEIV12,
 12481           ACTQ-KEY,
 12482           DFHEIV99,
 12483           DFHEIV11,
 12484           DFHEIV99,
 12485           DFHEIV99
 12486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12487
 12488
 12489
 12490* EXEC CICS ENDBR
 12491*         DATASET (ACTQ-FILE-ID)
 12492*    END-EXEC.
 12493     MOVE 0
 12494       TO DFHEIV11
 12495*    MOVE '&2                    $   #00010984' TO DFHEIV0
 12496     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12497     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12498     MOVE X'2020233030303130393834' TO DFHEIV0(25:11)
 12499     CALL 'kxdfhei1' USING DFHEIV0,
 12500           ACTQ-FILE-ID,
 12501           DFHEIV11,
 12502           DFHEIV99
 12503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12504
 12505
 12506     IF ACTQ-KEY NOT = MSTR-KEY
 12507         GO TO 2440-EXIT.
 12508
 12509
 12510* EXEC CICS READ UPDATE
 12511*         DATASET  (ACTQ-FILE-ID)
 12512*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12513*         SET      (ADDRESS OF ACTIVITY-QUE)
 12514*    END-EXEC.
 12515*    MOVE '&"S        EU         (   #00010991' TO DFHEIV0
 12516     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12517     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 232
* EL131.cbl
 12518     MOVE X'2020233030303130393931' TO DFHEIV0(25:11)
 12519     CALL 'kxdfhei1' USING DFHEIV0,
 12520           ACTQ-FILE-ID,
 12521           DFHEIV20,
 12522           DFHEIV99,
 12523           AQ-CONTROL-PRIMARY,
 12524           DFHEIV99,
 12525           DFHEIV99,
 12526           DFHEIV99
 12527     SET ADDRESS OF ACTIVITY-QUE TO
 12528         DFHEIV20
 12529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12530
 12531
 12532     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12533
 12534
 12535* EXEC CICS DELETE
 12536*         DATASET (ACTQ-FILE-ID)
 12537*    END-EXEC.
 12538*    MOVE '&(                    &   #00010999' TO DFHEIV0
 12539     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12540     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12541     MOVE X'2020233030303130393939' TO DFHEIV0(25:11)
 12542     CALL 'kxdfhei1' USING DFHEIV0,
 12543           ACTQ-FILE-ID,
 12544           DFHEIV99,
 12545           DFHEIV99,
 12546           DFHEIV99,
 12547           DFHEIV99
 12548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12549
 12550
 12551     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12552     IF CERTI GREATER THAN LOW-VALUES
 12553        MOVE CERTI               TO AQ-CERT-PRIME.
 12554     IF SUFXI GREATER THAN LOW-VALUES
 12555        MOVE SUFXI               TO AQ-CERT-SFX.
 12556     IF CERTCARI GREATER THAN LOW-VALUES
 12557        MOVE CERTCARI            TO AQ-CARRIER.
 12558
 12559
 12560* EXEC CICS HANDLE CONDITION
 12561*         DUPREC   (2440-EXIT)
 12562*    END-EXEC.
 12563*    MOVE '"$%                   ! 7 #00011011' TO DFHEIV0
 12564     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12566     MOVE X'3720233030303131303131' TO DFHEIV0(25:11)
 12567     CALL 'kxdfhei1' USING DFHEIV0
 12568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12569
 12570
 12571
 12572* EXEC CICS WRITE
 12573*         DATASET  (ACTQ-FILE-ID)
 12574*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12575*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 233
* EL131.cbl
 12576*    END-EXEC.
 12577     MOVE LENGTH OF
 12578      ACTIVITY-QUE
 12579       TO DFHEIV11
 12580*    MOVE '&$ L                  ''   #00011015' TO DFHEIV0
 12581     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12582     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12583     MOVE X'2020233030303131303135' TO DFHEIV0(25:11)
 12584     CALL 'kxdfhei1' USING DFHEIV0,
 12585           ACTQ-FILE-ID,
 12586           ACTIVITY-QUE,
 12587           DFHEIV11,
 12588           AQ-CONTROL-PRIMARY,
 12589           DFHEIV99,
 12590           DFHEIV99
 12591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12592
 12593
 12594 2440-EXIT.
 12595     EXIT.
 12596
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 234
* EL131.cbl
 12598 2460-UPDATE-CHECKQ.
 12599
 12600* EXEC CICS HANDLE CONDITION
 12601*         NOTFND   (2460-EXIT)
 12602*    END-EXEC.
 12603*    MOVE '"$I                   ! 8 #00011026' TO DFHEIV0
 12604     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12606     MOVE X'3820233030303131303236' TO DFHEIV0(25:11)
 12607     CALL 'kxdfhei1' USING DFHEIV0
 12608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12609
 12610
 12611     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12612     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12613     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12614
 12615
 12616* EXEC CICS READ UPDATE
 12617*         DATASET   (CHKQ-FILE-ID)
 12618*         RIDFLD    (CHKQ-KEY)
 12619*         SET       (ADDRESS OF CHECK-QUE)
 12620*    END-EXEC.
 12621*    MOVE '&"S        EU         (   #00011034' TO DFHEIV0
 12622     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12623     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12624     MOVE X'2020233030303131303334' TO DFHEIV0(25:11)
 12625     CALL 'kxdfhei1' USING DFHEIV0,
 12626           CHKQ-FILE-ID,
 12627           DFHEIV20,
 12628           DFHEIV99,
 12629           CHKQ-KEY,
 12630           DFHEIV99,
 12631           DFHEIV99,
 12632           DFHEIV99
 12633     SET ADDRESS OF CHECK-QUE TO
 12634         DFHEIV20
 12635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12636
 12637
 12638     IF CERTI GREATER THAN LOW-VALUES
 12639        MOVE CERTI               TO CQ-CERT-PRIME.
 12640     IF SUFXI GREATER THAN LOW-VALUES
 12641        MOVE SUFXI               TO CQ-CERT-SFX.
 12642     IF CERTCARI GREATER THAN LOW-VALUES
 12643        MOVE CERTCARI            TO CQ-CARRIER.
 12644
 12645
 12646* EXEC CICS REWRITE
 12647*         DATASET  (CHKQ-FILE-ID)
 12648*         FROM     (CHECK-QUE)
 12649*    END-EXEC.
 12650     MOVE LENGTH OF
 12651      CHECK-QUE
 12652       TO DFHEIV11
 12653*    MOVE '&& L                  %   #00011047' TO DFHEIV0
 12654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 235
* EL131.cbl
 12656     MOVE X'2020233030303131303437' TO DFHEIV0(25:11)
 12657     CALL 'kxdfhei1' USING DFHEIV0,
 12658           CHKQ-FILE-ID,
 12659           CHECK-QUE,
 12660           DFHEIV11,
 12661           DFHEIV99
 12662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12663
 12664
 12665 2460-EXIT.
 12666     EXIT.
 12667
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 236
* EL131.cbl
 12669 2475-UPDATE-LETTER.
 12670
 12671* EXEC CICS HANDLE CONDITION
 12672*         NOTFND   (2475-EXIT)
 12673*    END-EXEC.
 12674*    MOVE '"$I                   ! 9 #00011057' TO DFHEIV0
 12675     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12677     MOVE X'3920233030303131303537' TO DFHEIV0(25:11)
 12678     CALL 'kxdfhei1' USING DFHEIV0
 12679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12680
 12681
 12682     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12683     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12684     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12685     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12686
 12687
 12688* EXEC CICS READ UPDATE
 12689*         DATASET   (ARCH-FILE-ID)
 12690*         RIDFLD    (ARCH-KEY)
 12691*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12692*    END-EXEC.
 12693*    MOVE '&"S        EU         (   #00011066' TO DFHEIV0
 12694     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12695     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12696     MOVE X'2020233030303131303636' TO DFHEIV0(25:11)
 12697     CALL 'kxdfhei1' USING DFHEIV0,
 12698           ARCH-FILE-ID,
 12699           DFHEIV20,
 12700           DFHEIV99,
 12701           ARCH-KEY,
 12702           DFHEIV99,
 12703           DFHEIV99,
 12704           DFHEIV99
 12705     SET ADDRESS OF LETTER-ARCHIVE TO
 12706         DFHEIV20
 12707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12708
 12709
 12710* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12711* TO THIS MASTER-KEY INFORMATION.
 12712
 12713     IF LA-CARRIER  = CARRIER-CODE AND
 12714        LA-CLAIM-NO = CLAIM-NO     AND
 12715        LA-CERT-NO  = CERT-NO
 12716        NEXT SENTENCE
 12717     ELSE
 12718        GO TO 2475-UNLOCK.
 12719
 12720     IF CERTI GREATER THAN LOW-VALUES
 12721        MOVE CERTI               TO LA-CERT-PRIME.
 12722     IF SUFXI GREATER THAN LOW-VALUES
 12723        MOVE SUFXI               TO LA-CERT-SFX.
 12724     IF CERTCARI GREATER THAN LOW-VALUES
 12725        MOVE CERTCARI            TO LA-CARRIER.
 12726
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 237
* EL131.cbl
 12727
 12728* EXEC CICS REWRITE
 12729*         DATASET  (ARCH-FILE-ID)
 12730*         FROM     (LETTER-ARCHIVE)
 12731*    END-EXEC.
 12732     MOVE LENGTH OF
 12733      LETTER-ARCHIVE
 12734       TO DFHEIV11
 12735*    MOVE '&& L                  %   #00011089' TO DFHEIV0
 12736     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12737     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12738     MOVE X'2020233030303131303839' TO DFHEIV0(25:11)
 12739     CALL 'kxdfhei1' USING DFHEIV0,
 12740           ARCH-FILE-ID,
 12741           LETTER-ARCHIVE,
 12742           DFHEIV11,
 12743           DFHEIV99
 12744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12745
 12746
 12747     GO TO 2475-EXIT.
 12748
 12749 2475-UNLOCK.
 12750
 12751* EXEC CICS UNLOCK
 12752*         DATASET  (ARCH-FILE-ID)
 12753*    END-EXEC.
 12754*    MOVE '&*                    #   #00011097' TO DFHEIV0
 12755     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12756     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12757     MOVE X'2020233030303131303937' TO DFHEIV0(25:11)
 12758     CALL 'kxdfhei1' USING DFHEIV0,
 12759           ARCH-FILE-ID,
 12760           DFHEIV99
 12761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12762
 12763
 12764 2475-EXIT.
 12765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 238
* EL131.cbl
 12767 2600-CREATE-MAINT-NOTE.
 12768     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12769     MOVE '1'                    TO CNTL-REC-TYPE.
 12770     MOVE SPACES                 TO CNTL-PROC-ID.
 12771     MOVE ZERO                   TO CNTL-SEQ-NO.
 12772
 12773
 12774* EXEC CICS READ
 12775*         SET        (ADDRESS OF CONTROL-FILE)
 12776*         DATASET    ('ELCNTL')
 12777*         RIDFLD     (CNTL-KEY)
 12778*    END-EXEC.
 12779     MOVE 'ELCNTL' TO DFHEIV1
 12780*    MOVE '&"S        E          (   #00011110' TO DFHEIV0
 12781     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12783     MOVE X'2020233030303131313130' TO DFHEIV0(25:11)
 12784     CALL 'kxdfhei1' USING DFHEIV0,
 12785           DFHEIV1,
 12786           DFHEIV20,
 12787           DFHEIV99,
 12788           CNTL-KEY,
 12789           DFHEIV99,
 12790           DFHEIV99,
 12791           DFHEIV99
 12792     SET ADDRESS OF CONTROL-FILE TO
 12793         DFHEIV20
 12794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12795
 12796
 12797     IF CO-NO-USE-AUDIT-CHANGES
 12798         GO TO 2600-EXIT.
 12799
 12800     IF PROCL GREATER ZERO
 12801     IF PROCI NOT = LOW-VALUES
 12802     IF PROCI NOT = CL-PROCESSOR-ID
 12803         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12804         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12805         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12806
 12807     IF SEXL GREATER ZERO
 12808     IF SEXI NOT = LOW-VALUES
 12809     IF SEXI NOT = CL-INSURED-SEX-CD
 12810         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12811         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12812         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12813
 12814     IF BIRTHL GREATER ZERO
 12815     IF HOLD-BIRTH NOT = LOW-VALUES
 12816     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12817         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12818         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12819         MOVE SPACES               TO DC-OPTION-CODE
 12820         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12821         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12822         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12823
 12824     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 239
* EL131.cbl
 12825     IF SOCIALI NOT = LOW-VALUES
 12826     IF SOCIALI NOT = CL-SOC-SEC-NO
 12827         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12828         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12829         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12830
 12831     IF OCCL GREATER ZERO
 12832     IF OCCI NOT = LOW-VALUES
 12833     IF OCCI NOT = CL-INSURED-OCC-CD
 12834         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12835         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12836         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12837
 12838     IF BENEL GREATER ZERO
 12839     IF BENEI NOT = LOW-VALUES
 12840     IF BENEI NOT = CL-BENEFICIARY
 12841         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12842         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12843         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12844
 12845     IF PREMTYPL GREATER ZERO
 12846     IF PREMTYPI NOT = LOW-VALUES
 12847     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12848         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12849         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12850         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12851
 12852*    IF CAUSEL GREATER ZERO
 12853*    IF CAUSEI NOT = LOW-VALUES
 12854*    IF CAUSEI NOT = CL-CAUSE-CD
 12855*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12856*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12857*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12858
 12859*    IF ENDL GREATER ZERO
 12860*    IF HOLD-END NOT = LOW-VALUES
 12861*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12862*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 12863*        MOVE CL-EST-END-OF-DISAB-DT
 12864*                                  TO DC-BIN-DATE-1
 12865*        MOVE SPACES               TO DC-OPTION-CODE
 12866*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12867*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12868*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12869
 12870     IF PDTHRUL GREATER ZERO
 12871     IF HOLD-PDTHRU NOT = LOW-VALUES
 12872     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12873         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12874         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12875         MOVE SPACES               TO DC-OPTION-CODE
 12876         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12877         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12878         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12879
 12880     IF PDAMTL GREATER ZERO
 12881     IF HOLD-PDAMT NOT = ZEROS
 12882     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 240
* EL131.cbl
 12883         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12884         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12885         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12886         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12887
 12888     IF NODAYSL GREATER ZERO
 12889     IF HOLD-NODAYS NOT = ZEROS
 12890     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12891         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12892         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12893         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12894         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12895
 12896     IF NOPMTSL GREATER ZERO
 12897     IF HOLD-NOPMTS NOT = ZEROS
 12898     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12899         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12900         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12901         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12902         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12903
 12904     IF FORMTYPL GREATER ZERO
 12905     IF FORMTYPI NOT = LOW-VALUES
 12906     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12907         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12908         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12909         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12910
 12911     IF REPL GREATER ZERO
 12912     IF HOLD-REPORTED NOT = LOW-VALUES
 12913     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12914         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12915         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12916         MOVE SPACES               TO DC-OPTION-CODE
 12917         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12918         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12919         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12920
 12921     IF ADDONDTL GREATER ZERO
 12922     IF HOLD-ADDON NOT = LOW-VALUES
 12923     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12924         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12925         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12926         MOVE SPACES               TO DC-OPTION-CODE
 12927         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12928         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12929         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12930
 12931     IF PRICDL GREATER ZERO
 12932     IF PRICDI NOT = LOW-VALUES
 12933     IF PRICDI NOT = CL-PRIORITY-CD
 12934         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12935         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12936         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12937
 12938     IF FILETOL GREATER ZERO
 12939     IF FILETOI NOT = LOW-VALUES
 12940     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 241
* EL131.cbl
 12941         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12942         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12943         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12944
 12945     IF SUPVL GREATER ZERO
 12946     IF SUPVI NOT = LOW-VALUES
 12947     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12948         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12949         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12950         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12951*    IF (CRITPTL > ZERO)
 12952*       AND (CRITPTI NOT = LOW-VALUES)
 12953*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12954*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12955*       MOVE CL-CRIT-PER-RECURRENT
 12956*                                TO SPLIT-INFO-OLD
 12957*       PERFORM 2650-WRITE-MAINT-NOTE
 12958*                                THRU 2650-EXIT
 12959*    END-IF
 12960
 12961*    IF (RTWMOSL > ZERO)
 12962*       AND (RTWMOSI NOT = LOW-VALUES)
 12963*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12964*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12965*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12966*       PERFORM 2650-WRITE-MAINT-NOTE
 12967*                                THRU 2650-EXIT
 12968*    END-IF
 12969     IF MLNAMEL GREATER ZERO
 12970     IF MLNAMEI NOT = LOW-VALUES
 12971     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12972         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12973         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12974         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12975
 12976     IF MFNAMEL GREATER ZERO
 12977     IF MFNAMEI NOT = LOW-VALUES
 12978     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12979         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12980         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12981         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12982
 12983     IF MMINITL GREATER ZERO
 12984     IF MMINITI NOT = LOW-VALUES
 12985     IF MMINITI NOT = CL-INSURED-MID-INIT
 12986         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12987         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12988         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12989
 12990     IF CERTEFFL GREATER ZERO
 12991     IF HOLD-EFF NOT = LOW-VALUES
 12992     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12993         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12994         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12995         MOVE SPACES               TO DC-OPTION-CODE
 12996         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12997         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12998         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 242
* EL131.cbl
 12999
 13000     IF CERTACTL GREATER ZERO
 13001     IF CERTACTI NOT = LOW-VALUES
 13002     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13003         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13004         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13005         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13006
 13007     IF CERTSTL GREATER ZERO
 13008     IF CERTSTI NOT = LOW-VALUES
 13009     IF CERTSTI NOT = CL-CERT-STATE
 13010         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13011         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13012         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13013
 13014     IF CERTCARL GREATER ZERO
 13015     IF CERTCARI NOT = LOW-VALUES
 13016     IF CERTCARI NOT = CL-CERT-CARRIER
 13017         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13018         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13019         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13020
 13021     IF CERTGRPL GREATER ZERO
 13022     IF CERTGRPI NOT = LOW-VALUES
 13023     IF CERTGRPI NOT = CL-CERT-GROUPING
 13024         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13025         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13026         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13027
 13028     IF CERTL GREATER ZERO OR
 13029        SUFXL GREATER ZERO
 13030     IF (CERTI NOT = LOW-VALUES AND
 13031                     CL-CERT-PRIME)
 13032                OR
 13033        (SUFXI NOT = LOW-VALUES AND
 13034                     CL-CERT-SFX)
 13035         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13036         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13037         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13038     IF incl > zeros
 13039        IF (HOLD-INCUR NOT = LOW-VALUES)
 13040           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13041           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13042           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13043           MOVE SPACES           TO DC-OPTION-CODE
 13044           PERFORM 9800-CONVERT-DATE
 13045                                 THRU 9800-EXIT
 13046           MOVE DC-GREG-DATE-1-EDIT
 13047                                 TO SPLIT-INFO-OLD
 13048           PERFORM 2650-WRITE-MAINT-NOTE
 13049                                 THRU 2650-EXIT
 13050        END-IF
 13051     END-IF
 13052     .
 13053 2600-EXIT.
 13054      EXIT.
 13055
 13056 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 243
* EL131.cbl
 13057
 13058* EXEC CICS GETMAIN
 13059*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13060*         LENGTH   (TRLR-LENGTH)
 13061*         INITIMG  (GETMAIN-SPACE)
 13062*    END-EXEC.
 13063*    MOVE ',"IL                  $   #00011376' TO DFHEIV0
 13064     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13065     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13066     MOVE X'2020233030303131333736' TO DFHEIV0(25:11)
 13067     CALL 'kxdfhei1' USING DFHEIV0,
 13068           DFHEIV20,
 13069           TRLR-LENGTH,
 13070           GETMAIN-SPACE
 13071     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13072         DFHEIV20
 13073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13074
 13075
 13076
 13077* EXEC CICS HANDLE CONDITION
 13078*         DUPREC   (2650-EXIT)
 13079*    END-EXEC.
 13080*    MOVE '"$%                   ! : #00011382' TO DFHEIV0
 13081     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13083     MOVE X'3A20233030303131333832' TO DFHEIV0(25:11)
 13084     CALL 'kxdfhei1' USING DFHEIV0
 13085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13086
 13087
 13088     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13089
 13090     IF CERTL GREATER ZERO
 13091         MOVE CERTI          TO CL-CERT-PRIME.
 13092
 13093     IF SUFXL GREATER ZERO
 13094         MOVE SUFXI          TO CL-CERT-SFX.
 13095
 13096     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13097
 13098     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13099     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13100
 13101     MOVE 'AT'               TO AT-RECORD-ID.
 13102
 13103     MOVE '6'                TO AT-TRAILER-TYPE.
 13104     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13105                                AT-GEN-INFO-LAST-MAINT-DT.
 13106     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13107                                AT-GEN-INFO-LAST-UPDATED-BY.
 13108     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13109     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13110     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13111
 13112
 13113* EXEC CICS WRITE
 13114*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 244
* EL131.cbl
 13115*         RIDFLD   (AT-CONTROL-PRIMARY)
 13116*         FROM     (ACTIVITY-TRAILERS)
 13117*    END-EXEC.
 13118     MOVE LENGTH OF
 13119      ACTIVITY-TRAILERS
 13120       TO DFHEIV11
 13121*    MOVE '&$ L                  ''   #00011410' TO DFHEIV0
 13122     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13123     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13124     MOVE X'2020233030303131343130' TO DFHEIV0(25:11)
 13125     CALL 'kxdfhei1' USING DFHEIV0,
 13126           TRLR-FILE-ID,
 13127           ACTIVITY-TRAILERS,
 13128           DFHEIV11,
 13129           AT-CONTROL-PRIMARY,
 13130           DFHEIV99,
 13131           DFHEIV99
 13132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13133
 13134
 13135 2650-EXIT.
 13136      EXIT.
 13137
 13138 2800-CHECK-AUTO-PAY.
 13139
 13140     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13141     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13142     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13143     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13144     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13145
 13146
 13147* EXEC CICS HANDLE CONDITION
 13148*         NOTFND    (2800-EXIT)
 13149*         ENDFILE   (2800-EXIT)
 13150*    END-EXEC.
 13151*    MOVE '"$I''                  ! ; #00011427' TO DFHEIV0
 13152     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13154     MOVE X'3B20233030303131343237' TO DFHEIV0(25:11)
 13155     CALL 'kxdfhei1' USING DFHEIV0
 13156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13157
 13158
 13159
 13160* EXEC CICS READ
 13161*        DATASET (TRLR-FILE-ID)
 13162*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13163*        RIDFLD  (TRLR-KEY)
 13164*    END-EXEC.
 13165*    MOVE '&"S        E          (   #00011432' TO DFHEIV0
 13166     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13167     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13168     MOVE X'2020233030303131343332' TO DFHEIV0(25:11)
 13169     CALL 'kxdfhei1' USING DFHEIV0,
 13170           TRLR-FILE-ID,
 13171           DFHEIV20,
 13172           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 245
* EL131.cbl
 13173           TRLR-KEY,
 13174           DFHEIV99,
 13175           DFHEIV99,
 13176           DFHEIV99
 13177     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13178         DFHEIV20
 13179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13180
 13181
 13182     IF BENEFICIARY-PAID-AUTO
 13183         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13184     END-IF.
 13185
 13186 2800-EXIT.
 13187      EXIT.
 13188
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 246
* EL131.cbl
 13190 3000-DELETE-CLAIM.
 13191     IF  NOT MODIFY-CAP
 13192         MOVE ER-0070            TO EMI-ERROR
 13193         MOVE -1                 TO MAINTL
 13194         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13195         GO TO 8110-SEND-DATA.
 13196
 13197
 13198* EXEC CICS READ
 13199*         SET      (ADDRESS OF CLAIM-MASTER)
 13200*         DATASET  (CLMS-FILE-ID)
 13201*         RIDFLD   (MSTR-KEY)
 13202*    END-EXEC.
 13203*    MOVE '&"S        E          (   #00011453' TO DFHEIV0
 13204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13206     MOVE X'2020233030303131343533' TO DFHEIV0(25:11)
 13207     CALL 'kxdfhei1' USING DFHEIV0,
 13208           CLMS-FILE-ID,
 13209           DFHEIV20,
 13210           DFHEIV99,
 13211           MSTR-KEY,
 13212           DFHEIV99,
 13213           DFHEIV99,
 13214           DFHEIV99
 13215     SET ADDRESS OF CLAIM-MASTER TO
 13216         DFHEIV20
 13217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13218
 13219
 13220     IF CL-1ST-TRL-AVAIL
 13221         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13222     ELSE
 13223        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13224        MOVE 0                   TO TRLR-SEQ-NO
 13225
 13226* EXEC CICS STARTBR
 13227*            DATASET (TRLR-FILE-ID)
 13228*            RIDFLD  (TRLR-KEY)
 13229*        END-EXEC
 13230     MOVE 0
 13231       TO DFHEIV11
 13232*    MOVE '&,         G          &   #00011464' TO DFHEIV0
 13233     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13234     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13235     MOVE X'2020233030303131343634' TO DFHEIV0(25:11)
 13236     CALL 'kxdfhei1' USING DFHEIV0,
 13237           TRLR-FILE-ID,
 13238           TRLR-KEY,
 13239           DFHEIV99,
 13240           DFHEIV11,
 13241           DFHEIV99
 13242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13243         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13244
 13245* EXEC CICS ENDBR
 13246*            DATASET (TRLR-FILE-ID)
 13247*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 247
* EL131.cbl
 13248     MOVE 0
 13249       TO DFHEIV11
 13250*    MOVE '&2                    $   #00011469' TO DFHEIV0
 13251     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13252     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13253     MOVE X'2020233030303131343639' TO DFHEIV0(25:11)
 13254     CALL 'kxdfhei1' USING DFHEIV0,
 13255           TRLR-FILE-ID,
 13256           DFHEIV11,
 13257           DFHEIV99
 13258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13259        IF SCREEN-ERROR
 13260            MOVE ER-0208         TO EMI-ERROR
 13261            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13262            MOVE -1              TO MAINTL
 13263            GO TO 8110-SEND-DATA
 13264        ELSE
 13265            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13266
 13267     IF SCREEN-ERROR
 13268         MOVE -1                 TO MAINTL
 13269         GO TO 8110-SEND-DATA.
 13270
 13271     MOVE -1                     TO ONE-OR-MIN1.
 13272     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13273
 13274     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13275         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13276                                    WS-SAVE-CLAIM-KEY
 13277         MOVE +1                 TO ONE-OR-MIN1
 13278         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13279
 13280     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13281
 13282     MOVE LOW-VALUES             TO EL131AO.
 13283     MOVE ER-0000                TO EMI-ERROR.
 13284     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13285     MOVE 'X'                    TO PI-RETURN-CD-1.
 13286     MOVE -1                     TO MAINTL.
 13287     GO TO 8100-SEND-MAP.
 13288
 13289 3010-DEL-MSTR-TRLR.
 13290
 13291* EXEC CICS READ UPDATE
 13292*         SET       (ADDRESS OF CLAIM-MASTER)
 13293*         DATASET   (CLMS-FILE-ID)
 13294*         RIDFLD    (MSTR-KEY)
 13295*    END-EXEC.
 13296*    MOVE '&"S        EU         (   #00011503' TO DFHEIV0
 13297     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13298     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13299     MOVE X'2020233030303131353033' TO DFHEIV0(25:11)
 13300     CALL 'kxdfhei1' USING DFHEIV0,
 13301           CLMS-FILE-ID,
 13302           DFHEIV20,
 13303           DFHEIV99,
 13304           MSTR-KEY,
 13305           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 248
* EL131.cbl
 13306           DFHEIV99,
 13307           DFHEIV99
 13308     SET ADDRESS OF CLAIM-MASTER TO
 13309         DFHEIV20
 13310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13311
 13312
 13313     if (cl-priority-cd = '8')
 13314        and (pi-processor-id not = 'PEMA' and 'JMS '
 13315             AND 'AMWA')
 13316        MOVE ER-8003             TO EMI-ERROR
 13317        PERFORM 9900-ERROR-FORMAT
 13318                                 THRU 9900-EXIT
 13319        MOVE -1                  TO MAINTL
 13320        GO TO 8110-SEND-DATA
 13321     end-if
 13322
 13323     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13324     MOVE ZERO                   TO TRLR-SEQ-NO.
 13325
 13326
 13327* EXEC CICS HANDLE CONDITION
 13328*         NOTFND    (3010-DEL-ACTQ)
 13329*         ENDFILE   (3040-EXIT)
 13330*    END-EXEC.
 13331*    MOVE '"$I''                  ! < #00011522' TO DFHEIV0
 13332     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13333     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13334     MOVE X'3C20233030303131353232' TO DFHEIV0(25:11)
 13335     CALL 'kxdfhei1' USING DFHEIV0
 13336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13337
 13338
 13339     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13340
 13341 3010-DEL-ACTQ.
 13342
 13343
 13344* EXEC CICS HANDLE CONDITION
 13345*         NOTFND    (3010-NO-ACTIVITY)
 13346*         ENDFILE   (3050-EXIT)
 13347*    END-EXEC.
 13348*    MOVE '"$I''                  ! = #00011531' TO DFHEIV0
 13349     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13351     MOVE X'3D20233030303131353331' TO DFHEIV0(25:11)
 13352     CALL 'kxdfhei1' USING DFHEIV0
 13353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13354
 13355
 13356
 13357* EXEC CICS STARTBR
 13358*         DATASET  (ACTQ-FILE-ID)
 13359*         RIDFLD   (ACTQ-KEY)
 13360*    END-EXEC.
 13361     MOVE 0
 13362       TO DFHEIV11
 13363*    MOVE '&,         G          &   #00011536' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 249
* EL131.cbl
 13364     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13365     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13366     MOVE X'2020233030303131353336' TO DFHEIV0(25:11)
 13367     CALL 'kxdfhei1' USING DFHEIV0,
 13368           ACTQ-FILE-ID,
 13369           ACTQ-KEY,
 13370           DFHEIV99,
 13371           DFHEIV11,
 13372           DFHEIV99
 13373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13374
 13375
 13376
 13377* EXEC CICS GETMAIN
 13378*         SET      (ADDRESS OF ACTIVITY-QUE)
 13379*         LENGTH   (ACTQ-LENGTH)
 13380*         INITIMG  (GETMAIN-SPACE)
 13381*    END-EXEC.
 13382*    MOVE ',"IL                  $   #00011541' TO DFHEIV0
 13383     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13384     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13385     MOVE X'2020233030303131353431' TO DFHEIV0(25:11)
 13386     CALL 'kxdfhei1' USING DFHEIV0,
 13387           DFHEIV20,
 13388           ACTQ-LENGTH,
 13389           GETMAIN-SPACE
 13390     SET ADDRESS OF ACTIVITY-QUE TO
 13391         DFHEIV20
 13392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13393
 13394
 13395     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13396
 13397
 13398* EXEC CICS ENDBR
 13399*         DATASET (ACTQ-FILE-ID)
 13400*    END-EXEC.
 13401     MOVE 0
 13402       TO DFHEIV11
 13403*    MOVE '&2                    $   #00011549' TO DFHEIV0
 13404     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13405     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13406     MOVE X'2020233030303131353439' TO DFHEIV0(25:11)
 13407     CALL 'kxdfhei1' USING DFHEIV0,
 13408           ACTQ-FILE-ID,
 13409           DFHEIV11,
 13410           DFHEIV99
 13411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13412
 13413
 13414 3010-NO-ACTIVITY.
 13415
 13416
 13417* EXEC CICS HANDLE CONDITION
 13418*        NOTFND   (3010-CERT-NOT-FOUND)
 13419*    END-EXEC.
 13420*    MOVE '"$I                   ! > #00011555' TO DFHEIV0
 13421     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 250
* EL131.cbl
 13422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13423     MOVE X'3E20233030303131353535' TO DFHEIV0(25:11)
 13424     CALL 'kxdfhei1' USING DFHEIV0
 13425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13426
 13427
 13428     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13429     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13430     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13431     MOVE CL-CERT-STATE          TO CERT-STATE.
 13432     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13433     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13434     MOVE CL-CERT-NO             TO CERT-CERT.
 13435
 13436
 13437* EXEC CICS READ
 13438*        DATASET   (CERT-FILE-ID)
 13439*        RIDFLD    (CERT-KEY)
 13440*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13441*    END-EXEC.
 13442*    MOVE '&"S        E          (   #00011567' TO DFHEIV0
 13443     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13445     MOVE X'2020233030303131353637' TO DFHEIV0(25:11)
 13446     CALL 'kxdfhei1' USING DFHEIV0,
 13447           CERT-FILE-ID,
 13448           DFHEIV20,
 13449           DFHEIV99,
 13450           CERT-KEY,
 13451           DFHEIV99,
 13452           DFHEIV99,
 13453           DFHEIV99
 13454     SET ADDRESS OF CERTIFICATE-MASTER TO
 13455         DFHEIV20
 13456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13457
 13458
 13459     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 13460       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 13461         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 13462     ELSE
 13463         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13464
 13465 3010-UPDATE-CERT-TRLR.
 13466
 13467     MOVE CERT-KEY               TO ELCRTT-KEY
 13468     MOVE 'B'                    TO CTRLR-REC-TYPE
 13469
 13470* EXEC CICS READ
 13471*       UPDATE
 13472*       DATASET   ('ELCRTT')
 13473*       RIDFLD    (ELCRTT-KEY)
 13474*       INTO      (CERTIFICATE-TRAILERS)
 13475*       RESP      (WS-RESPONSE)
 13476*    END-EXEC
 13477     MOVE LENGTH OF
 13478      CERTIFICATE-TRAILERS
 13479       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 251
* EL131.cbl
 13480     MOVE 'ELCRTT' TO DFHEIV1
 13481*    MOVE '&"IL       EU         (  N#00011583' TO DFHEIV0
 13482     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13483     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13484     MOVE X'204E233030303131353833' TO DFHEIV0(25:11)
 13485     CALL 'kxdfhei1' USING DFHEIV0,
 13486           DFHEIV1,
 13487           CERTIFICATE-TRAILERS,
 13488           DFHEIV11,
 13489           ELCRTT-KEY,
 13490           DFHEIV99,
 13491           DFHEIV99,
 13492           DFHEIV99
 13493     MOVE EIBRESP  TO WS-RESPONSE
 13494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13495     IF WS-RESP-NORMAL
 13496        perform varying s1 from +1 by +1 until
 13497           (s1 > +24)
 13498           or (cs-claim-no (s1) = cl-claim-no)
 13499        end-perform
 13500        if s1 < +25
 13501           move spaces           to cs-claim-no (s1)
 13502                                    cs-claim-type (s1)
 13503                                    cs-insured-type (s1)
 13504           move zeros            to cs-days-paid (s1)
 13505                                    cs-total-paid (s1)
 13506                                    cs-benefit-period (s1)
 13507           if s1 not = +24
 13508              compute s2 = s1 + +1
 13509              perform 3015-bump  thru 3015-exit
 13510           end-if
 13511
 13512* EXEC CICS REWRITE
 13513*             DATASET   ('ELCRTT')
 13514*             FROM      (CERTIFICATE-TRAILERS)
 13515*          END-EXEC
 13516     MOVE LENGTH OF
 13517      CERTIFICATE-TRAILERS
 13518       TO DFHEIV11
 13519     MOVE 'ELCRTT' TO DFHEIV1
 13520*    MOVE '&& L                  %   #00011606' TO DFHEIV0
 13521     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13522     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13523     MOVE X'2020233030303131363036' TO DFHEIV0(25:11)
 13524     CALL 'kxdfhei1' USING DFHEIV0,
 13525           DFHEIV1,
 13526           CERTIFICATE-TRAILERS,
 13527           DFHEIV11,
 13528           DFHEIV99
 13529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13530        end-if
 13531     end-if
 13532     .
 13533 3010-CERT-NOT-FOUND.
 13534
 13535
 13536* EXEC CICS DELETE
 13537*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 252
* EL131.cbl
 13538*    END-EXEC.
 13539*    MOVE '&(                    &   #00011615' TO DFHEIV0
 13540     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13542     MOVE X'2020233030303131363135' TO DFHEIV0(25:11)
 13543     CALL 'kxdfhei1' USING DFHEIV0,
 13544           CLMS-FILE-ID,
 13545           DFHEIV99,
 13546           DFHEIV99,
 13547           DFHEIV99,
 13548           DFHEIV99
 13549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13550
 13551
 13552 3010-EXIT.
 13553      EXIT.
 13554
 13555 3015-bump.
 13556     perform varying s2 from s2 by +1 until s2 > +24
 13557        move cs-mb-claim-data (s2)
 13558                                 to cs-mb-claim-data (s1)
 13559        move spaces              to cs-mb-claim-data (s2)
 13560        add +1 to s1
 13561     end-perform
 13562     .
 13563 3015-exit.
 13564     exit.
 13565 3020-UPDATE-CERT.
 13566
 13567* EXEC CICS READ UPDATE
 13568*         DATASET  (CERT-FILE-ID)
 13569*         RIDFLD   (CERT-KEY)
 13570*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13571*    END-EXEC.
 13572*    MOVE '&"S        EU         (   #00011633' TO DFHEIV0
 13573     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13574     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13575     MOVE X'2020233030303131363333' TO DFHEIV0(25:11)
 13576     CALL 'kxdfhei1' USING DFHEIV0,
 13577           CERT-FILE-ID,
 13578           DFHEIV20,
 13579           DFHEIV99,
 13580           CERT-KEY,
 13581           DFHEIV99,
 13582           DFHEIV99,
 13583           DFHEIV99
 13584     SET ADDRESS OF CERTIFICATE-MASTER TO
 13585         DFHEIV20
 13586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13587
 13588
 13589     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13590
 13591
 13592* EXEC CICS HANDLE CONDITION
 13593*         DUPKEY   (3020-EXIT)
 13594*    END-EXEC.
 13595*    MOVE '"$$                   ! ? #00011641' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 253
* EL131.cbl
 13596     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13597     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13598     MOVE X'3F20233030303131363431' TO DFHEIV0(25:11)
 13599     CALL 'kxdfhei1' USING DFHEIV0
 13600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13601
 13602
 13603
 13604* EXEC CICS REWRITE
 13605*         DATASET  (CERT-FILE-ID)
 13606*         FROM     (CERTIFICATE-MASTER)
 13607*    END-EXEC.
 13608     MOVE LENGTH OF
 13609      CERTIFICATE-MASTER
 13610       TO DFHEIV11
 13611*    MOVE '&& L                  %   #00011645' TO DFHEIV0
 13612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13614     MOVE X'2020233030303131363435' TO DFHEIV0(25:11)
 13615     CALL 'kxdfhei1' USING DFHEIV0,
 13616           CERT-FILE-ID,
 13617           CERTIFICATE-MASTER,
 13618           DFHEIV11,
 13619           DFHEIV99
 13620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13621
 13622
 13623 3020-EXIT.
 13624     EXIT.
 13625
 13626 3030-DELETE-CERT.
 13627
 13628* EXEC CICS READ UPDATE
 13629*         DATASET  (CERT-FILE-ID)
 13630*         RIDFLD   (CERT-KEY)
 13631*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13632*    END-EXEC.
 13633*    MOVE '&"S        EU         (   #00011654' TO DFHEIV0
 13634     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13635     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13636     MOVE X'2020233030303131363534' TO DFHEIV0(25:11)
 13637     CALL 'kxdfhei1' USING DFHEIV0,
 13638           CERT-FILE-ID,
 13639           DFHEIV20,
 13640           DFHEIV99,
 13641           CERT-KEY,
 13642           DFHEIV99,
 13643           DFHEIV99,
 13644           DFHEIV99
 13645     SET ADDRESS OF CERTIFICATE-MASTER TO
 13646         DFHEIV20
 13647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13648
 13649
 13650
 13651* EXEC CICS DELETE
 13652*         DATASET   (CERT-FILE-ID)
 13653*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 254
* EL131.cbl
 13654*    MOVE '&(                    &   #00011660' TO DFHEIV0
 13655     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13656     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13657     MOVE X'2020233030303131363630' TO DFHEIV0(25:11)
 13658     CALL 'kxdfhei1' USING DFHEIV0,
 13659           CERT-FILE-ID,
 13660           DFHEIV99,
 13661           DFHEIV99,
 13662           DFHEIV99,
 13663           DFHEIV99
 13664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13665
 13666
 13667 3030-EXIT.
 13668     EXIT.
 13669
 13670 3040-DELETE-TRLR.
 13671
 13672* EXEC CICS READ
 13673*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13674*         DATASET  (TRLR-FILE-ID)
 13675*         RIDFLD   (TRLR-KEY)
 13676*         GTEQ
 13677*    END-EXEC.
 13678*    MOVE '&"S        G          (   #00011668' TO DFHEIV0
 13679     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13680     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13681     MOVE X'2020233030303131363638' TO DFHEIV0(25:11)
 13682     CALL 'kxdfhei1' USING DFHEIV0,
 13683           TRLR-FILE-ID,
 13684           DFHEIV20,
 13685           DFHEIV99,
 13686           TRLR-KEY,
 13687           DFHEIV99,
 13688           DFHEIV99,
 13689           DFHEIV99
 13690     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13691         DFHEIV20
 13692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13693
 13694
 13695     IF PI-COMPANY-CD = AT-COMPANY-CD
 13696        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13697        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13698           GO TO 3040-EXIT
 13699        ELSE
 13700           NEXT SENTENCE
 13701     ELSE
 13702        GO TO 3040-EXIT.
 13703
 13704
 13705* EXEC CICS DELETE
 13706*         DATASET  (TRLR-FILE-ID)
 13707*         RIDFLD   (TRLR-KEY)
 13708*    END-EXEC.
 13709*    MOVE '&(  R                 &   #00011684' TO DFHEIV0
 13710     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13711     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 255
* EL131.cbl
 13712     MOVE X'2020233030303131363834' TO DFHEIV0(25:11)
 13713     CALL 'kxdfhei1' USING DFHEIV0,
 13714           TRLR-FILE-ID,
 13715           TRLR-KEY,
 13716           DFHEIV99,
 13717           DFHEIV99,
 13718           DFHEIV99
 13719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13720
 13721
 13722     GO TO 3040-DELETE-TRLR.
 13723
 13724 3040-EXIT.
 13725     EXIT.
 13726
 13727 3050-DELETE-ACTQ.
 13728
 13729* EXEC CICS READNEXT
 13730*         DATASET  (ACTQ-FILE-ID)
 13731*         RIDFLD   (ACTQ-KEY)
 13732*         INTO     (ACTIVITY-QUE)
 13733*    END-EXEC.
 13734     MOVE LENGTH OF
 13735      ACTIVITY-QUE
 13736       TO DFHEIV12
 13737     MOVE 0
 13738       TO DFHEIV11
 13739*    MOVE '&.IL                  )   #00011695' TO DFHEIV0
 13740     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13741     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13742     MOVE X'2020233030303131363935' TO DFHEIV0(25:11)
 13743     CALL 'kxdfhei1' USING DFHEIV0,
 13744           ACTQ-FILE-ID,
 13745           ACTIVITY-QUE,
 13746           DFHEIV12,
 13747           ACTQ-KEY,
 13748           DFHEIV99,
 13749           DFHEIV11,
 13750           DFHEIV99,
 13751           DFHEIV99
 13752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13753
 13754
 13755     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13756         GO TO 3050-EXIT.
 13757
 13758
 13759* EXEC CICS ENDBR
 13760*         DATASET  (ACTQ-FILE-ID)
 13761*    END-EXEC.
 13762     MOVE 0
 13763       TO DFHEIV11
 13764*    MOVE '&2                    $   #00011704' TO DFHEIV0
 13765     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13766     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13767     MOVE X'2020233030303131373034' TO DFHEIV0(25:11)
 13768     CALL 'kxdfhei1' USING DFHEIV0,
 13769           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 256
* EL131.cbl
 13770           DFHEIV11,
 13771           DFHEIV99
 13772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13773
 13774
 13775
 13776* EXEC CICS DELETE
 13777*         DATASET   (ACTQ-FILE-ID)
 13778*         RIDFLD    (ACTQ-KEY)
 13779*    END-EXEC.
 13780*    MOVE '&(  R                 &   #00011708' TO DFHEIV0
 13781     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13782     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13783     MOVE X'2020233030303131373038' TO DFHEIV0(25:11)
 13784     CALL 'kxdfhei1' USING DFHEIV0,
 13785           ACTQ-FILE-ID,
 13786           ACTQ-KEY,
 13787           DFHEIV99,
 13788           DFHEIV99,
 13789           DFHEIV99
 13790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13791
 13792
 13793
 13794* EXEC CICS STARTBR
 13795*         DATASET   (ACTQ-FILE-ID)
 13796*         RIDFLD    (ACTQ-KEY)
 13797*    END-EXEC.
 13798     MOVE 0
 13799       TO DFHEIV11
 13800*    MOVE '&,         G          &   #00011713' TO DFHEIV0
 13801     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13802     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13803     MOVE X'2020233030303131373133' TO DFHEIV0(25:11)
 13804     CALL 'kxdfhei1' USING DFHEIV0,
 13805           ACTQ-FILE-ID,
 13806           ACTQ-KEY,
 13807           DFHEIV99,
 13808           DFHEIV11,
 13809           DFHEIV99
 13810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13811
 13812
 13813     GO TO 3050-DELETE-ACTQ.
 13814
 13815 3050-EXIT.
 13816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 257
* EL131.cbl
 13818 3060-READ-TRLR.
 13819
 13820* EXEC CICS HANDLE CONDITION
 13821*         NOTFND    (3060-EXIT)
 13822*         ENDFILE   (3060-EXIT)
 13823*    END-EXEC.
 13824*    MOVE '"$I''                  ! @ #00011724' TO DFHEIV0
 13825     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13827     MOVE X'4020233030303131373234' TO DFHEIV0(25:11)
 13828     CALL 'kxdfhei1' USING DFHEIV0
 13829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13830
 13831
 13832 3060-LOOP.
 13833
 13834* EXEC CICS READNEXT
 13835*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13836*         DATASET  (TRLR-FILE-ID)
 13837*         RIDFLD   (TRLR-KEY)
 13838*    END-EXEC.
 13839     MOVE 0
 13840       TO DFHEIV11
 13841*    MOVE '&.S                   )   #00011730' TO DFHEIV0
 13842     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13843     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13844     MOVE X'2020233030303131373330' TO DFHEIV0(25:11)
 13845     CALL 'kxdfhei1' USING DFHEIV0,
 13846           TRLR-FILE-ID,
 13847           DFHEIV20,
 13848           DFHEIV99,
 13849           TRLR-KEY,
 13850           DFHEIV99,
 13851           DFHEIV11,
 13852           DFHEIV99,
 13853           DFHEIV99
 13854     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13855         DFHEIV20
 13856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13857
 13858
 13859     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13860         GO TO 3060-EXIT.
 13861
 13862     IF FORM-CONTROL-TR
 13863         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13864             NEXT SENTENCE
 13865         ELSE
 13866             MOVE 'X'            TO ERROR-SWITCH
 13867             GO TO 3060-EXIT
 13868     ELSE
 13869         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13870            MOVE 'X'                 TO ERROR-SWITCH
 13871            GO TO 3060-EXIT.
 13872
 13873     GO TO 3060-LOOP.
 13874
 13875 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 258
* EL131.cbl
 13876     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 259
* EL131.cbl
 13878 3997-GET-ERPDEF.
 13879
 13880     move cl-company-cd          to cert-company-code
 13881     move cl-cert-key-data       to cert-key (2:21)
 13882     move cl-cert-no             to cert-cert
 13883
 13884
 13885* EXEC CICS READ
 13886*        DATASET   (CERT-FILE-ID)
 13887*        RIDFLD    (CERT-KEY)
 13888*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13889*        resp      (ws-response)
 13890*    END-EXEC
 13891*    MOVE '&"S        E          (  N#00011761' TO DFHEIV0
 13892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13894     MOVE X'204E233030303131373631' TO DFHEIV0(25:11)
 13895     CALL 'kxdfhei1' USING DFHEIV0,
 13896           CERT-FILE-ID,
 13897           DFHEIV20,
 13898           DFHEIV99,
 13899           CERT-KEY,
 13900           DFHEIV99,
 13901           DFHEIV99,
 13902           DFHEIV99
 13903     SET ADDRESS OF CERTIFICATE-MASTER TO
 13904         DFHEIV20
 13905     MOVE EIBRESP  TO ws-response
 13906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13907
 13908     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 13909                                    WS-ERPDEF-SW
 13910     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13911                                    WS-CRIT-PER-RTW-MOS
 13912
 13913     if cm-clp-state = spaces or low-values or zeros
 13914        move cm-state            to cm-clp-state
 13915     end-if
 13916     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13917     MOVE CM-clp-state           TO ERPDEF-STATE
 13918     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13919     evaluate true
 13920        when (cl-claim-type = 'L' or 'P')
 13921           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 13922             and 'CU')
 13923           move 'L'              to erpdef-ben-type
 13924           move cm-lf-benefit-cd to erpdef-ben-code
 13925        when (cl-claim-type not = 'L' and 'P')
 13926           and (cm-ah-benefit-cd not = '00' and '  ')
 13927           move 'A'              to erpdef-ben-type
 13928           move cm-ah-benefit-cd to erpdef-ben-code
 13929        when (cl-claim-type not = 'L' and 'P')
 13930           and (cm-ah-benefit-cd = '00' or '  ')
 13931           move 'L'              to erpdef-ben-type
 13932           move cm-lf-benefit-cd to erpdef-ben-code
 13933        when (cl-claim-type = 'L' or 'P')
 13934           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 13935           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 260
* EL131.cbl
 13936           move cm-ah-benefit-cd to erpdef-ben-code
 13937        when other
 13938           move 'A'              to erpdef-ben-type
 13939           move cm-ah-benefit-cd to erpdef-ben-code
 13940     end-evaluate
 13941
 13942*    if (cl-claim-type = 'L' or 'P')
 13943*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 13944*          and 'CU')
 13945*       move 'L'                 to erpdef-ben-type
 13946*       move cm-lf-benefit-cd    to erpdef-ben-code
 13947*    else
 13948*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 13949*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 13950*    end-if
 13951     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13952     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13953
 13954
 13955* EXEC CICS STARTBR
 13956*        DATASET  ('ERPDEF')
 13957*        RIDFLD   (ERPDEF-KEY)
 13958*        GTEQ
 13959*        RESP     (WS-RESPONSE)
 13960*    END-EXEC
 13961     MOVE 'ERPDEF' TO DFHEIV1
 13962     MOVE 0
 13963       TO DFHEIV11
 13964*    MOVE '&,         G          &  N#00011814' TO DFHEIV0
 13965     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13966     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13967     MOVE X'204E233030303131383134' TO DFHEIV0(25:11)
 13968     CALL 'kxdfhei1' USING DFHEIV0,
 13969           DFHEIV1,
 13970           ERPDEF-KEY,
 13971           DFHEIV99,
 13972           DFHEIV11,
 13973           DFHEIV99
 13974     MOVE EIBRESP  TO WS-RESPONSE
 13975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13976
 13977     IF WS-RESP-NORMAL
 13978
 13979* EXEC CICS READNEXT
 13980*          DATASET  ('ERPDEF')
 13981*          INTO     (PRODUCT-MASTER)
 13982*          RIDFLD   (ERPDEF-KEY)
 13983*          RESP     (WS-RESPONSE)
 13984*       END-EXEC
 13985     MOVE LENGTH OF
 13986      PRODUCT-MASTER
 13987       TO DFHEIV12
 13988     MOVE 'ERPDEF' TO DFHEIV1
 13989     MOVE 0
 13990       TO DFHEIV11
 13991*    MOVE '&.IL                  )  N#00011822' TO DFHEIV0
 13992     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13993     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 261
* EL131.cbl
 13994     MOVE X'204E233030303131383232' TO DFHEIV0(25:11)
 13995     CALL 'kxdfhei1' USING DFHEIV0,
 13996           DFHEIV1,
 13997           PRODUCT-MASTER,
 13998           DFHEIV12,
 13999           ERPDEF-KEY,
 14000           DFHEIV99,
 14001           DFHEIV11,
 14002           DFHEIV99,
 14003           DFHEIV99
 14004     MOVE EIBRESP  TO WS-RESPONSE
 14005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14006        IF WS-RESP-NORMAL
 14007           IF (ERPDEF-KEY-SAVE (1:16) =
 14008              PD-CONTROL-PRIMARY (1:16))
 14009              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14010              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14011                 (A1 > +8)
 14012                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14013              END-PERFORM
 14014              IF A1 < +9
 14015                 SET ERPDEF-FOUND TO TRUE
 14016                 MOVE PD-CRIT-PERIOD (A1)
 14017                              TO WS-CRITICAL-PERIOD
 14018                 MOVE PD-REC-CRIT-PERIOD (A1)
 14019                              TO WS-CRIT-PER-RECURRENT
 14020                 IF PD-RTW-MOS (A1) NUMERIC
 14021                    MOVE PD-RTW-MOS (A1)
 14022                              TO WS-CRIT-PER-RTW-MOS
 14023                 ELSE
 14024                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14025                 END-IF
 14026                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14027                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14028                                 TO WS-EXCL-PERIOD
 14029                 END-IF
 14030                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14031                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14032                                 TO WS-COV-ENDS
 14033                 END-IF
 14034                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14035                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14036                                 TO WS-ACC-PERIOD
 14037                 END-IF
 14038                 if pd-max-extension (a1) numeric
 14039                    move pd-max-extension (a1)
 14040                                 to ws-max-extension
 14041                 end-if
 14042                 if pd-max-amt (a1) numeric
 14043                    move pd-max-amt (a1)
 14044                                 to ws-max-moben
 14045                 end-if
 14046              END-IF
 14047           END-IF
 14048        END-IF
 14049     END-IF
 14050
 14051     .
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 262
* EL131.cbl
 14052 3997-EXIT.
 14053     EXIT.
 14054 4000-FORCE-ERRORS.
 14055     IF PI-RETURN-CD-1 = 'X'
 14056         MOVE ER-0311            TO EMI-ERROR
 14057         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14058         MOVE -1                 TO MAINTL
 14059         GO TO 8110-SEND-DATA.
 14060
 14061     IF NOT FORCE-CAP
 14062         MOVE ER-0416            TO EMI-ERROR
 14063         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14064         MOVE -1                 TO MAINTL
 14065         GO TO 8110-SEND-DATA.
 14066
 14067     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14068     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14069     IF EMI-FATAL-CTR GREATER THAN ZERO
 14070         GO TO 4000-FATAL-ERRORS.
 14071
 14072     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14073
 14074     IF EMI-FATAL-CTR GREATER THAN ZERO
 14075         GO TO 4000-FATAL-ERRORS.
 14076
 14077     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14078
 14079     IF EMI-FATAL-CTR GREATER THAN ZERO
 14080         GO TO 4000-FATAL-ERRORS.
 14081
 14082     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14083     MOVE AL-UANOF               TO CERTA.
 14084     MOVE ER-0000 TO EMI-ERROR.
 14085     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14086
 14087 4000-FATAL-ERRORS.
 14088     MOVE -1                     TO MAINTL.
 14089     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 263
* EL131.cbl
 14091
 14092 4100-SAVE-CHANGES.
 14093     IF MAINTL > 0
 14094         MOVE MAINTI  TO WS-SAVE-MAINTI
 14095         MOVE MAINTL  TO WS-SAVE-MAINTL
 14096     END-IF
 14097     IF STATUSL > 0
 14098         MOVE STATUSI  TO WS-SAVE-STATUSI
 14099         MOVE STATUSL  TO WS-SAVE-STATUSL
 14100     END-IF
 14101     IF REPL > 0
 14102         MOVE REPI  TO WS-SAVE-REPI
 14103         MOVE REPL  TO WS-SAVE-REPL
 14104     END-IF
 14105*    IF CAUSEL > 0
 14106*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14107*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14108*    END-IF
 14109*    IF ENDL > 0
 14110*        MOVE ENDI  TO WS-SAVE-ENDI
 14111*        MOVE ENDL  TO WS-SAVE-ENDL
 14112*    END-IF
 14113     IF DIAGL > 0
 14114         MOVE DIAGI  TO WS-SAVE-DIAGI
 14115         MOVE DIAGL  TO WS-SAVE-DIAGL
 14116     END-IF
 14117     IF ICD1L > 0
 14118         MOVE ICD1I  TO WS-SAVE-ICD1I
 14119         MOVE ICD1L  TO WS-SAVE-ICD1L
 14120     END-IF
 14121     IF ICD2L > 0
 14122         MOVE ICD2I  TO WS-SAVE-ICD2I
 14123         MOVE ICD2L  TO WS-SAVE-ICD2L
 14124     END-IF
 14125     IF BENEL > 0
 14126         MOVE BENEI  TO WS-SAVE-BENEI
 14127         MOVE BENEL  TO WS-SAVE-BENEL
 14128     END-IF
 14129     IF BIRTHL > 0
 14130         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14131         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14132     END-IF
 14133     IF SOCIALL > 0
 14134         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14135         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14136     END-IF
 14137     IF SEXL > 0
 14138         MOVE SEXI  TO WS-SAVE-SEXI
 14139         MOVE SEXL  TO WS-SAVE-SEXL
 14140     END-IF
 14141     IF MLNAMEL > 0
 14142         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14143         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14144     END-IF
 14145     IF MFNAMEL > 0
 14146         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14147         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14148     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 264
* EL131.cbl
 14149     IF MMINITL > 0
 14150         MOVE MMINITI  TO WS-SAVE-MMINITI
 14151         MOVE MMINITL  TO WS-SAVE-MMINITL
 14152     END-IF
 14153     IF LOANNOL > 0
 14154         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14155         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14156     END-IF
 14157     IF LOANBALL > 0
 14158         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14159         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14160     END-IF
 14161     IF PROCL > 0
 14162         MOVE PROCI  TO WS-SAVE-PROCI
 14163         MOVE PROCL  TO WS-SAVE-PROCL
 14164     END-IF
 14165     IF SUPVL > 0
 14166         MOVE SUPVI  TO WS-SAVE-SUPVI
 14167         MOVE SUPVL  TO WS-SAVE-SUPVL
 14168     END-IF
 14169     IF PRICDL > 0
 14170         MOVE PRICDI  TO WS-SAVE-PRICDI
 14171         MOVE PRICDL  TO WS-SAVE-PRICDL
 14172     END-IF
 14173     IF FILETOL > 0
 14174         MOVE FILETOI  TO WS-SAVE-FILETOI
 14175         MOVE FILETOL  TO WS-SAVE-FILETOL
 14176     END-IF
 14177     IF PDTHRUL > 0
 14178         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14179         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14180     END-IF
 14181     IF PDAMTL > 0
 14182         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14183         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14184     END-IF
 14185     IF NODAYSL > 0
 14186         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14187         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14188     END-IF
 14189     IF NOPMTSL > 0
 14190         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14191         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14192     END-IF
 14193     IF FORMTYPL > 0
 14194         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14195         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14196     END-IF
 14197     IF OCCL > 0
 14198         MOVE OCCI  TO WS-SAVE-OCCI
 14199         MOVE OCCL  TO WS-SAVE-OCCL
 14200     END-IF.
 14201 4100-EXIT.
 14202      EXIT.
 14203
 14204 4200-LOAD-CHANGES.
 14205     IF WS-SAVE-MAINTL > 0
 14206         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 265
* EL131.cbl
 14207         MOVE WS-SAVE-MAINTL  TO MAINTL
 14208         MOVE AL-UANON        TO MAINTA
 14209     END-IF
 14210     IF WS-SAVE-STATUSL > 0
 14211         MOVE WS-SAVE-STATUSI  TO STATUSI
 14212         MOVE WS-SAVE-STATUSL  TO STATUSL
 14213         MOVE AL-UANON         TO STATUSA
 14214     END-IF
 14215     IF WS-SAVE-REPL > 0
 14216         MOVE WS-SAVE-REPI  TO REPI
 14217         MOVE WS-SAVE-REPL  TO REPL
 14218         MOVE AL-UANON      TO REPA
 14219     END-IF
 14220*    IF WS-SAVE-CAUSEL > 0
 14221*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14222*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14223*        MOVE AL-UANON        TO CAUSEA
 14224*    END-IF
 14225*    IF WS-SAVE-ENDL > 0
 14226*        MOVE WS-SAVE-ENDI  TO ENDI
 14227*        MOVE WS-SAVE-ENDL  TO ENDL
 14228*        MOVE AL-UANON      TO ENDA
 14229*    END-IF
 14230     IF WS-SAVE-DIAGL > 0
 14231         MOVE WS-SAVE-DIAGI  TO DIAGI
 14232         MOVE WS-SAVE-DIAGL  TO DIAGL
 14233         MOVE AL-UANON       TO DIAGA
 14234     END-IF
 14235     IF WS-SAVE-ICD1L > 0
 14236         MOVE WS-SAVE-ICD1I  TO ICD1I
 14237         MOVE WS-SAVE-ICD1L  TO ICD1L
 14238         MOVE AL-UANON       TO ICD1A
 14239     END-IF
 14240     IF WS-SAVE-ICD2L > 0
 14241         MOVE WS-SAVE-ICD2I  TO ICD2I
 14242         MOVE WS-SAVE-ICD2L  TO ICD2L
 14243         MOVE AL-UANON       TO ICD2A
 14244     END-IF
 14245     IF WS-SAVE-BENEL > 0
 14246         MOVE WS-SAVE-BENEI  TO BENEI
 14247         MOVE WS-SAVE-BENEL  TO BENEL
 14248         MOVE AL-UANON       TO BENEA
 14249     END-IF
 14250     IF WS-SAVE-BIRTHL > 0
 14251         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14252         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14253         MOVE AL-UANON        TO BIRTHA
 14254     END-IF
 14255     IF WS-SAVE-SOCIALL > 0
 14256         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14257         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14258         MOVE AL-UANON         TO SOCIALA
 14259     END-IF
 14260     IF WS-SAVE-SEXL > 0
 14261         MOVE WS-SAVE-SEXI  TO SEXI
 14262         MOVE WS-SAVE-SEXL  TO SEXL
 14263         MOVE AL-UANON      TO SEXA
 14264     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 266
* EL131.cbl
 14265     IF WS-SAVE-MLNAMEL > 0
 14266         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14267         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14268         MOVE AL-UANON         TO MLNAMEA
 14269     END-IF
 14270     IF WS-SAVE-MFNAMEL > 0
 14271         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14272         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14273         MOVE AL-UANON         TO MFNAMEA
 14274     END-IF
 14275     IF WS-SAVE-MMINITL > 0
 14276         MOVE WS-SAVE-MMINITI  TO MMINITI
 14277         MOVE WS-SAVE-MMINITL  TO MMINITL
 14278         MOVE AL-UANON         TO MMINITA
 14279     END-IF
 14280     IF WS-SAVE-LOANNOL > 0
 14281         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14282         MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14283         MOVE AL-UANON         TO LOANNOA
 14284     END-IF
 14285     IF WS-SAVE-LOANBALL > 0
 14286         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14287         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14288         MOVE AL-UANON          TO LOANBALA
 14289     END-IF
 14290     IF WS-SAVE-PROCL > 0
 14291         MOVE WS-SAVE-PROCI  TO PROCI
 14292         MOVE WS-SAVE-PROCL  TO PROCL
 14293         MOVE AL-UANON       TO PROCA
 14294     END-IF
 14295     IF WS-SAVE-SUPVL > 0
 14296         MOVE WS-SAVE-SUPVI  TO SUPVI
 14297         MOVE WS-SAVE-SUPVL  TO SUPVL
 14298         MOVE AL-UANON       TO SUPVA
 14299     END-IF
 14300     IF WS-SAVE-PRICDL > 0
 14301         MOVE WS-SAVE-PRICDI  TO PRICDI
 14302         MOVE WS-SAVE-PRICDL  TO PRICDL
 14303         MOVE AL-UANON        TO PRICDA
 14304     END-IF
 14305     IF WS-SAVE-FILETOL > 0
 14306         MOVE WS-SAVE-FILETOI  TO FILETOI
 14307         MOVE WS-SAVE-FILETOL  TO FILETOL
 14308         MOVE AL-UANON         TO FILETOA
 14309     END-IF
 14310     IF WS-SAVE-PDTHRUL > 0
 14311         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14312         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14313         MOVE AL-UANON         TO PDTHRUA
 14314     END-IF
 14315     IF WS-SAVE-PDAMTL > 0
 14316         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14317         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14318         MOVE AL-UANON        TO PDAMTA
 14319     END-IF
 14320     IF WS-SAVE-NODAYSL > 0
 14321         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14322         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 267
* EL131.cbl
 14323         MOVE AL-UANON         TO NODAYSA
 14324     END-IF
 14325     IF WS-SAVE-NOPMTSL > 0
 14326         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14327         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14328         MOVE AL-UANON         TO NOPMTSA
 14329     END-IF
 14330     IF WS-SAVE-FORMTYPL > 0
 14331         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14332         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14333         MOVE AL-UANON          TO FORMTYPA
 14334     END-IF
 14335     IF WS-SAVE-OCCL > 0
 14336         MOVE WS-SAVE-OCCI  TO OCCI
 14337         MOVE WS-SAVE-OCCL  TO OCCL
 14338         MOVE AL-UANON      TO OCCA
 14339     END-IF.
 14340 4200-EXIT.
 14341      EXIT.
 14342
 14343 5000-BUILD-MAP.
 14344     IF PI-RETURN-CD-1 = SPACE
 14345         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14346
 14347     MOVE SPACE                  TO PI-RETURN-CD-1.
 14348
 14349     MOVE LOW-VALUES             TO EL131AI.
 14350
 14351     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14352     MOVE PI-CARRIER             TO CARRIER-CODE.
 14353     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14354     MOVE PI-CERT-NO             TO CERT-NO.
 14355
 14356 5000-READ-CLAIM-MASTER.
 14357
 14358
 14359* EXEC CICS READ
 14360*         SET      (ADDRESS OF CLAIM-MASTER)
 14361*         DATASET  (CLMS-FILE-ID)
 14362*         RIDFLD   (MSTR-KEY)
 14363*    END-EXEC.
 14364*    MOVE '&"S        E          (   #00012180' TO DFHEIV0
 14365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14367     MOVE X'2020233030303132313830' TO DFHEIV0(25:11)
 14368     CALL 'kxdfhei1' USING DFHEIV0,
 14369           CLMS-FILE-ID,
 14370           DFHEIV20,
 14371           DFHEIV99,
 14372           MSTR-KEY,
 14373           DFHEIV99,
 14374           DFHEIV99,
 14375           DFHEIV99
 14376     SET ADDRESS OF CLAIM-MASTER TO
 14377         DFHEIV20
 14378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14379
 14380
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 268
* EL131.cbl
 14381     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14382
 14383 5000-READ-DIAGNOSIS-TRAILER.
 14384
 14385
 14386* EXEC CICS HANDLE CONDITION
 14387*         NOTFND (5000-TRLR-NOT-FOUND)
 14388*    END-EXEC.
 14389*    MOVE '"$I                   ! A #00012190' TO DFHEIV0
 14390     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14392     MOVE X'4120233030303132313930' TO DFHEIV0(25:11)
 14393     CALL 'kxdfhei1' USING DFHEIV0
 14394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14395
 14396
 14397     MOVE MSTR-KEY               TO TRLR-KEY.
 14398     MOVE NINETY                 TO TRLR-SEQ-NO.
 14399
 14400
 14401* EXEC CICS READ
 14402*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14403*         DATASET  (TRLR-FILE-ID)
 14404*         RIDFLD   (TRLR-KEY)
 14405*    END-EXEC.
 14406*    MOVE '&"S        E          (   #00012197' TO DFHEIV0
 14407     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14408     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14409     MOVE X'2020233030303132313937' TO DFHEIV0(25:11)
 14410     CALL 'kxdfhei1' USING DFHEIV0,
 14411           TRLR-FILE-ID,
 14412           DFHEIV20,
 14413           DFHEIV99,
 14414           TRLR-KEY,
 14415           DFHEIV99,
 14416           DFHEIV99,
 14417           DFHEIV99
 14418     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14419         DFHEIV20
 14420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14421
 14422
 14423     MOVE AT-INFO-LINE-1         TO DIAGO.
 14424     MOVE AT-ICD-CODE-1          TO ICD1O.
 14425     MOVE AT-ICD-CODE-2          TO ICD2O.
 14426
 14427 5000-READ-CERTIFICATE-MASTER.
 14428
 14429     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14430     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14431     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14432     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14433     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14434     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 14435     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 14436
 14437
 14438* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 269
* EL131.cbl
 14439*         NOTFND (5000-CERT-NOT-FOUND)
 14440*    END-EXEC.
 14441*    MOVE '"$I                   ! B #00012217' TO DFHEIV0
 14442     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14444     MOVE X'4220233030303132323137' TO DFHEIV0(25:11)
 14445     CALL 'kxdfhei1' USING DFHEIV0
 14446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14447
 14448
 14449
 14450* EXEC CICS READ
 14451*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14452*         DATASET  (CERT-FILE-ID)
 14453*         RIDFLD   (CERT-KEY)
 14454*    END-EXEC.
 14455*    MOVE '&"S        E          (   #00012221' TO DFHEIV0
 14456     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14458     MOVE X'2020233030303132323231' TO DFHEIV0(25:11)
 14459     CALL 'kxdfhei1' USING DFHEIV0,
 14460           CERT-FILE-ID,
 14461           DFHEIV20,
 14462           DFHEIV99,
 14463           CERT-KEY,
 14464           DFHEIV99,
 14465           DFHEIV99,
 14466           DFHEIV99
 14467     SET ADDRESS OF CERTIFICATE-MASTER TO
 14468         DFHEIV20
 14469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14470
 14471
 14472     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 14473     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 14474
 14475     GO TO 5000-EXIT.
 14476
 14477 5000-TRLR-NOT-FOUND.
 14478     MOVE ER-7687                TO EMI-ERROR.
 14479     MOVE -1                     TO DIAGL.
 14480     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14481     GO TO 5000-EXIT.
 14482
 14483 5000-CERT-NOT-FOUND.
 14484     MOVE ER-0206                TO EMI-ERROR.
 14485     MOVE -1                     TO CERTL.
 14486     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14487
 14488 5000-EXIT.
 14489     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 270
* EL131.cbl
 14491 5010-RESET-PI-AREA.
 14492     IF CERTI GREATER THAN LOW-VALUES
 14493         MOVE CERTI              TO PI-CERT-PRIME.
 14494
 14495     IF SUFXI GREATER THAN LOW-VALUES
 14496         MOVE SUFXI              TO PI-CERT-SFX.
 14497
 14498     IF CERTEFFI GREATER THAN LOW-VALUES
 14499         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 14500
 14501     IF CERTACTI GREATER THAN LOW-VALUES
 14502         MOVE CERTACTI           TO PI-ACCOUNT.
 14503
 14504     IF CERTSTI GREATER THAN LOW-VALUES
 14505         MOVE CERTSTI            TO PI-STATE.
 14506
 14507     IF CERTCARI GREATER THAN LOW-VALUES
 14508         MOVE CERTCARI           TO PI-CARRIER.
 14509
 14510     IF CERTGRPI GREATER THAN LOW-VALUES
 14511         MOVE CERTGRPI           TO PI-GROUPING.
 14512
 14513 5010-EXIT.
 14514     EXIT.
 14515
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 271
* EL131.cbl
 14517 5020-MOVE-MSTR.
 14518
 14519     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14520     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14521     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14522     MOVE AL-SABON               TO SEQUA.
 14523     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14524     MOVE CL-CLAIM-TYPE          TO TYPEO
 14525                                    pi-claim-type
 14526
 14527     IF CL-TOTAL-PAID-AMT  = +0 AND
 14528        CL-LAST-PMT-AMT    = +0 AND
 14529        CL-NO-OF-PMTS-MADE = +0
 14530          MOVE AL-UANON          TO TYPEA.
 14531
 14532     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14533     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14534     MOVE CL-CERT-PRIME          TO CERTO.
 14535     MOVE CL-CERT-SFX            TO SUFXO.
 14536     MOVE CL-CERT-CARRIER        TO CARRO.
 14537
 14538     IF CL-CLAIM-STATUS = 'C'
 14539         MOVE 'CLOSED'           TO STATUSO
 14540     ELSE
 14541         MOVE 'OPEN  '           TO STATUSO.
 14542
 14543     move cl-accident-claim-sw   to accswo
 14544     if cl-benefit-period not numeric
 14545        move zeros               to cl-benefit-period
 14546     end-if
 14547     move cl-benefit-period      to benpero
 14548     move cl-insured-type        to instypeo
 14549     MOVE CL-PROCESSOR-ID        TO PROCO.
 14550
 14551     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 14552     MOVE CL-CCN                 TO CCNOO.
 14553
 14554     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 14555     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 14556     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 14557     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14558
 14559     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 14560         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14561         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14562         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14563         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 14564     ELSE
 14565         MOVE SPACES             TO BIRTHO.
 14566
 14567     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 14568        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 14569         NEXT SENTENCE
 14570       ELSE
 14571         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 14572
 14573     IF PI-COMPANY-ID = 'DMD'
 14574       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 272
* EL131.cbl
 14575          IF SOCIALO = SPACES OR LOW-VALUES
 14576            MOVE ER-0885         TO EMI-ERROR
 14577            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14578
 14579     MOVE CL-INSURED-OCC-CD      TO OCCO.
 14580*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14581
 14582*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 14583*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14584*        MOVE SPACES                 TO DC-OPTION-CODE
 14585*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14586*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 14587*    ELSE
 14588*        MOVE SPACES             TO ENDO.
 14589
 14590     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 14591        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14592        MOVE SPACES             TO DC-OPTION-CODE
 14593        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14594        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14595        IF PI-USES-PAID-TO
 14596           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14597           MOVE '6'                TO DC-OPTION-CODE
 14598           MOVE +1                 TO DC-ELAPSED-DAYS
 14599           MOVE +0                 TO DC-ELAPSED-MONTHS
 14600           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14601           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14602        ELSE
 14603           NEXT SENTENCE
 14604     ELSE
 14605        MOVE SPACES             TO PDTHRUO.
 14606
 14607     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 14608     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 14609     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 14610     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 14611
 14612     IF MODIFY-CAP
 14613        MOVE AL-UNNOF            TO PDAMTA
 14614                                    NODAYSA
 14615                                    NOPMTSA
 14616        MOVE AL-UANOF            TO PDTHRUA.
 14617     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 14618     MOVE '2'                    TO CNTL-REC-TYPE
 14619     MOVE +0                     TO CNTL-SEQ-NO
 14620     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 14621
 14622
 14623* EXEC CICS READ
 14624*         DATASET  (CNTL-FILE-ID)
 14625*         SET      (ADDRESS OF CONTROL-FILE)
 14626*         RIDFLD   (CNTL-KEY)
 14627*         RESP     (WS-RESPONSE)
 14628*    END-EXEC
 14629*    MOVE '&"S        E          (  N#00012377' TO DFHEIV0
 14630     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14632     MOVE X'204E233030303132333737' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 273
* EL131.cbl
 14633     CALL 'kxdfhei1' USING DFHEIV0,
 14634           CNTL-FILE-ID,
 14635           DFHEIV20,
 14636           DFHEIV99,
 14637           CNTL-KEY,
 14638           DFHEIV99,
 14639           DFHEIV99,
 14640           DFHEIV99
 14641     SET ADDRESS OF CONTROL-FILE TO
 14642         DFHEIV20
 14643     MOVE EIBRESP  TO WS-RESPONSE
 14644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14645
 14646     IF WS-RESP-NORMAL
 14647        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14648     end-if
 14649     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14650         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14651         MOVE SPACES             TO DC-OPTION-CODE
 14652         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14653         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14654     ELSE
 14655         MOVE SPACES             TO INCO.
 14656
 14657     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14658        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14659        MOVE AL-UANOF            TO INCA
 14660     end-if
 14661     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14662
 14663     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14664         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14665         MOVE SPACES             TO DC-OPTION-CODE
 14666         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14667         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14668     ELSE
 14669         MOVE SPACES             TO REPO.
 14670
 14671     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14672         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14673         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14674         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14675         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14676     ELSE
 14677         MOVE SPACES             TO ESTO.
 14678
 14679     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14680         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14681         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14682         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14683         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14684     ELSE
 14685         MOVE SPACES             TO MNTDTO.
 14686
 14687
 14688     IF CL-LAST-MAINT-TYPE = SPACE
 14689         MOVE 'SET-UP'           TO MNTTYPEO
 14690     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 274
* EL131.cbl
 14691     IF CL-LAST-MAINT-TYPE = '1'
 14692         MOVE 'PAYMNT'           TO MNTTYPEO
 14693     ELSE
 14694     IF CL-LAST-MAINT-TYPE = '2'
 14695         MOVE 'LETTER'           TO MNTTYPEO
 14696     ELSE
 14697     IF CL-LAST-MAINT-TYPE = '3'
 14698         MOVE 'UPDATE'           TO MNTTYPEO
 14699     ELSE
 14700     IF CL-LAST-MAINT-TYPE = '4'
 14701         MOVE 'RESTOR'           TO MNTTYPEO
 14702     ELSE
 14703     IF CL-LAST-MAINT-TYPE = '5'
 14704         MOVE 'INC DT'           TO MNTTYPEO
 14705     ELSE
 14706     IF CL-LAST-MAINT-TYPE = '6'
 14707         MOVE ' CONV'            TO MNTTYPEO
 14708     ELSE
 14709     IF CL-LAST-MAINT-TYPE = 'C'
 14710         MOVE 'CHGBEN'           TO MNTTYPEO
 14711     ELSE
 14712     IF CL-LAST-MAINT-TYPE = 'E'
 14713         MOVE 'ERRCOR'           TO MNTTYPEO
 14714     ELSE
 14715         MOVE SPACES             TO MNTTYPEO.
 14716
 14717     MOVE CL-BENEFICIARY         TO BENEO.
 14718     MOVE CL-FILE-LOCATION       TO FILETOO.
 14719     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14720        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14721     END-IF
 14722     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14723*    MOVE CL-CRIT-PER-RECURRENT
 14724*                                TO CRITPTO
 14725*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14726*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14727*    END-IF
 14728*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14729     MOVE CL-PRIORITY-CD         TO PRICDO.
 14730     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14731     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14732     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14733     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14734
 14735 5020-EXIT.
 14736     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 275
* EL131.cbl
 14738 5030-MOVE-CERT.
 14739
 14740     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14741         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14742         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14743         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14744         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14745       ELSE
 14746         MOVE SPACES             TO CERTEFFO
 14747         MOVE ZERO               TO HOLD-DATE.
 14748
 14749     MOVE CM-ACCOUNT             TO CERTACTO.
 14750     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14751     MOVE CM-GROUPING            TO CERTGRPO.
 14752     MOVE CM-CARRIER             TO CERTCARO.
 14753     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14754     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14755     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14756     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14757     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14758     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14759     MOVE CM-JT-INITIAL          TO JNTINITO.
 14760     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14761
 14762*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14763     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14764     MOVE '3'                    TO CNTL-REC-TYPE.
 14765     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14766     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14767     MOVE ZERO                   TO CNTL-SEQ-NO.
 14768
 14769
 14770* EXEC CICS READ
 14771*         SET        (ADDRESS OF CONTROL-FILE)
 14772*         DATASET    ('ELCNTL')
 14773*         RIDFLD     (CNTL-KEY)
 14774*         RESP       (WS-RESPONSE)
 14775*    END-EXEC.
 14776     MOVE 'ELCNTL' TO DFHEIV1
 14777*    MOVE '&"S        E          (  N#00012507' TO DFHEIV0
 14778     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14780     MOVE X'204E233030303132353037' TO DFHEIV0(25:11)
 14781     CALL 'kxdfhei1' USING DFHEIV0,
 14782           DFHEIV1,
 14783           DFHEIV20,
 14784           DFHEIV99,
 14785           CNTL-KEY,
 14786           DFHEIV99,
 14787           DFHEIV99,
 14788           DFHEIV99
 14789     SET ADDRESS OF CONTROL-FILE TO
 14790         DFHEIV20
 14791     MOVE EIBRESP  TO WS-RESPONSE
 14792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14793
 14794
 14795     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 276
* EL131.cbl
 14796        MOVE ZERO                TO CP-FREE-LOOK
 14797     ELSE
 14798        MOVE CF-ST-FREE-LOOK-PERIOD
 14799                                 TO CP-FREE-LOOK.
 14800
 14801     IF CM-LF-BENEFIT-CD = '00'
 14802        GO TO 5030-MOVE-CERT-AH.
 14803
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 277
* EL131.cbl
 14805     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 14806     MOVE '5'                    TO DC-OPTION-CODE
 14807     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14808     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 14809     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14810     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 14811     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 14812     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14813     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14814     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 14815     MOVE '4'                    TO CP-REM-TERM-METHOD
 14816     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 14817     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14818     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14819
 14820     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14821     IF CM-LF-PREMIUM-RATE NUMERIC
 14822         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14823     ELSE
 14824         MOVE ZEROS              TO LCVRATEO.
 14825
 14826     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14827         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 14828
 14829     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 14830
 14831     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 14832
 14833     IF CM-LF-CURRENT-STATUS = '8'
 14834        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14835            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14836            MOVE ' '             TO DC-OPTION-CODE
 14837            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14838            IF NOT DATE-CONVERSION-ERROR
 14839                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14840
 14841     IF CM-LF-CURRENT-STATUS = '7'
 14842        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14843            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 14844            MOVE ' '             TO DC-OPTION-CODE
 14845            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14846            IF NOT DATE-CONVERSION-ERROR
 14847                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14848
 14849     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14850         MOVE ' '                TO DC-OPTION-CODE
 14851         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 14852         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14853         IF NOT DATE-CONVERSION-ERROR
 14854             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 14855             MOVE HOLD-MONTH     TO WORK-MONTH
 14856             MOVE HOLD-YEAR      TO WORK-YEAR
 14857             MOVE WORK-DATE-MY   TO LCVEXITO.
 14858
 14859     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14860        IF CP-REMAINING-TERM-3 = ZEROS
 14861           MOVE 'EXPIRED'        TO LCVSTATO
 14862        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 278
* EL131.cbl
 14863           MOVE 'ACTIVE'         TO LCVSTATO.
 14864
 14865     IF CM-LF-CURRENT-STATUS = '2'
 14866        MOVE 'PEND   '           TO LCVSTATO.
 14867     IF CM-LF-CURRENT-STATUS = '3'
 14868        MOVE 'RESTORE'           TO LCVSTATO.
 14869     IF CM-LF-CURRENT-STATUS = '5'
 14870        MOVE 'REISSUE'           TO LCVSTATO.
 14871     IF CM-LF-CURRENT-STATUS = '6'
 14872        MOVE 'LMP DIS'           TO LCVSTATO.
 14873     IF CM-LF-CURRENT-STATUS = '7'
 14874        MOVE 'DEATH  '           TO LCVSTATO.
 14875     IF CM-LF-CURRENT-STATUS = '8'
 14876        MOVE 'CANCEL '           TO LCVSTATO.
 14877     IF CM-LF-CURRENT-STATUS = '9'
 14878        MOVE 'RE-ONLY'           TO LCVSTATO.
 14879     IF CM-LF-CURRENT-STATUS = 'V'
 14880        MOVE 'VOID   '           TO LCVSTATO.
 14881     IF CM-LF-CURRENT-STATUS = 'D'
 14882        MOVE 'DECLINE'           TO LCVSTATO.
 14883
 14884     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14885     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14886     MOVE '4'                    TO BEN-REC-TYPE.
 14887     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 14888     MOVE ZERO                   TO BEN-SEQ-NO.
 14889
 14890
 14891* EXEC CICS READ GTEQ
 14892*         DATASET  (CNTL-FILE-ID)
 14893*         RIDFLD   (BENEFIT-KEY)
 14894*         SET      (ADDRESS OF CONTROL-FILE)
 14895*    END-EXEC.
 14896*    MOVE '&"S        G          (   #00012609' TO DFHEIV0
 14897     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14899     MOVE X'2020233030303132363039' TO DFHEIV0(25:11)
 14900     CALL 'kxdfhei1' USING DFHEIV0,
 14901           CNTL-FILE-ID,
 14902           DFHEIV20,
 14903           DFHEIV99,
 14904           BENEFIT-KEY,
 14905           DFHEIV99,
 14906           DFHEIV99,
 14907           DFHEIV99
 14908     SET ADDRESS OF CONTROL-FILE TO
 14909         DFHEIV20
 14910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14911
 14912
 14913     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14914        CF-RECORD-TYPE NOT = '4'
 14915         MOVE ER-0240            TO EMI-ERROR
 14916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14917         GO TO 5030-MOVE-CERT-FINISH.
 14918
 14919     MOVE ZERO                   TO COUNT-2.
 14920     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 279
* EL131.cbl
 14921
 14922     IF SCREEN-ERROR
 14923         MOVE ER-0282            TO EMI-ERROR
 14924         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14925        ELSE
 14926         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 14927
 14928 5030-MOVE-CERT-AH.
 14929
 14930     IF CM-LF-BENEFIT-CD = '00'
 14931         IF CM-AH-BENEFIT-CD = '00'
 14932             GO TO 5030-MOVE-CERT-FINISH.
 14933
 14934     IF CM-AH-BENEFIT-CD = '00'
 14935        MOVE SPACES             TO ACVKINDO
 14936        COMPUTE PI-PAYMENT-AMT =
 14937                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 14938        GO TO 5030-MOVE-CERT-FINISH.
 14939
 14940     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14941     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 14942     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 14943     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 14944     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14945     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14946     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14947     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 14948
 14949**DMD **********************************************
 14950     IF PI-COMPANY-ID = 'DMD'
 14951         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 14952                                   CM-PMT-EXTENSION-DAYS
 14953         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 14954                                      CL-NO-OF-DAYS-PAID
 14955         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 14956             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 14957         MOVE WS-REM-MOS         TO ACVRTRMO
 14958                                    CP-REMAINING-TERM-3
 14959*        MOVE WS-REM-DAYS        TO DAYSPO
 14960         GO TO 5030-SKIP-RTRM.
 14961**DMD **********************************************
 14962
 14963     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14964     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14965     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14966     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14967
 14968 5030-SKIP-RTRM.
 14969     IF CM-AH-PREMIUM-RATE NUMERIC
 14970         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14971     ELSE
 14972         MOVE ZEROS              TO ACVRATEO.
 14973
 14974     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 14975     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 14976
 14977     IF CM-AH-CURRENT-STATUS = '8'
 14978        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 280
* EL131.cbl
 14979            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14980            MOVE ' '             TO DC-OPTION-CODE
 14981            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14982            IF NOT DATE-CONVERSION-ERROR
 14983                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14984
 14985     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14986        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14987            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 14988            MOVE ' '             TO DC-OPTION-CODE
 14989            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14990            IF NOT DATE-CONVERSION-ERROR
 14991                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14992
 14993     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14994        IF CP-REMAINING-TERM-3 = ZEROS
 14995           MOVE 'EXPIRED'        TO ACVSTATO
 14996        ELSE
 14997           MOVE 'ACTIVE'         TO ACVSTATO.
 14998
 14999     IF CM-AH-CURRENT-STATUS = '2'
 15000        MOVE 'PEND   '           TO ACVSTATO.
 15001     IF CM-AH-CURRENT-STATUS = '3'
 15002        MOVE 'RESTORE'           TO ACVSTATO.
 15003     IF CM-AH-CURRENT-STATUS = '5'
 15004        MOVE 'REISSUE'           TO ACVSTATO.
 15005     IF CM-AH-CURRENT-STATUS = '6'
 15006        MOVE 'LMP DIS'           TO ACVSTATO.
 15007     IF CM-AH-CURRENT-STATUS = '7'
 15008        MOVE 'DEATH  '           TO ACVSTATO.
 15009     IF CM-AH-CURRENT-STATUS = '8'
 15010        MOVE 'CANCEL '           TO ACVSTATO.
 15011     IF CM-AH-CURRENT-STATUS = '9'
 15012        MOVE 'RE-ONLY'           TO ACVSTATO.
 15013     IF CM-AH-CURRENT-STATUS = 'V'
 15014        MOVE 'VOID   '           TO ACVSTATO.
 15015     IF CM-AH-CURRENT-STATUS = '9'
 15016        MOVE 'DECLINE'           TO ACVSTATO.
 15017
 15018     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15019         MOVE ' '                TO DC-OPTION-CODE
 15020         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15021         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15022         IF NOT DATE-CONVERSION-ERROR
 15023             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15024             MOVE HOLD-MONTH     TO WORK-MONTH
 15025             MOVE HOLD-YEAR      TO WORK-YEAR
 15026             MOVE WORK-DATE-MY   TO ACVEXITO.
 15027
 15028     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15029
 15030     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15031     MOVE '5'                    TO BEN-REC-TYPE.
 15032     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15033     MOVE ZERO                   TO BEN-SEQ-NO.
 15034
 15035
 15036* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 281
* EL131.cbl
 15037*         DATASET  (CNTL-FILE-ID)
 15038*         RIDFLD   (BENEFIT-KEY)
 15039*         SET      (ADDRESS OF CONTROL-FILE)
 15040*    END-EXEC.
 15041*    MOVE '&"S        G          (   #00012737' TO DFHEIV0
 15042     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15043     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15044     MOVE X'2020233030303132373337' TO DFHEIV0(25:11)
 15045     CALL 'kxdfhei1' USING DFHEIV0,
 15046           CNTL-FILE-ID,
 15047           DFHEIV20,
 15048           DFHEIV99,
 15049           BENEFIT-KEY,
 15050           DFHEIV99,
 15051           DFHEIV99,
 15052           DFHEIV99
 15053     SET ADDRESS OF CONTROL-FILE TO
 15054         DFHEIV20
 15055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15056
 15057
 15058     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15059        CF-RECORD-TYPE NOT = '5'
 15060         MOVE ER-0250            TO EMI-ERROR
 15061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15062         GO TO 5030-MOVE-CERT-FINISH.
 15063
 15064     MOVE ZERO                   TO COUNT-2.
 15065     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15066
 15067     IF SCREEN-ERROR
 15068         MOVE ER-0283            TO EMI-ERROR
 15069         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15070       ELSE
 15071         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15072
 15073 5030-MOVE-CERT-FINISH.
 15074
 15075     MOVE CM-LOAN-APR            TO APRO.
 15076     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15077     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15078     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15079     MOVE CM-LOAN-NUMBER         TO LOANNOO
 15080     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15081     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15082
 15083     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15084         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15085         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15086         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15087         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15088     ELSE
 15089         MOVE SPACES               TO ADDONDTO.
 15090
 15091     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15092
 15093 5030-EXIT.
 15094     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 282
* EL131.cbl
 15096 5040-FIND-BENEFIT.
 15097     ADD 1                       TO COUNT-2.
 15098     IF COUNT-2 GREATER THAN 8
 15099         GO TO 5050-BENEFIT-NOTFND.
 15100
 15101     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15102         GO TO 5060-EXIT.
 15103
 15104     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15105         GO TO 5050-BENEFIT-NOTFND.
 15106
 15107     GO TO 5040-FIND-BENEFIT.
 15108
 15109 5050-BENEFIT-NOTFND.
 15110     MOVE 'X'                    TO ERROR-SWITCH.
 15111
 15112 5060-EXIT.
 15113     EXIT.
 15114
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 283
* EL131.cbl
 15116 6000-CALCULATE-CERT-TERM.
 15117
 15118     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15119         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15120     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15121         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15122     IF CM-LOAN-APR NOT NUMERIC
 15123         MOVE ZEROS              TO CM-LOAN-APR.
 15124
 15125*    IF WS-CALC-METHOD  = 'G'
 15126         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15127*     ELSE
 15128*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15129
 15130     IF N GREATER 120
 15131         MOVE 120                TO N.
 15132
 15133     MOVE '6'                    TO DC-OPTION-CODE.
 15134     MOVE N                      TO DC-ELAPSED-MONTHS.
 15135     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15136     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15137
 15138     IF CM-LF-BENEFIT-CD NOT = ZERO
 15139         MOVE N                  TO CM-LF-ORIG-TERM
 15140         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15141         IF NO-CONVERSION-ERROR
 15142             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15143
 15144     IF CM-AH-BENEFIT-CD NOT = ZERO
 15145         MOVE N                  TO CM-AH-ORIG-TERM
 15146         IF NO-CONVERSION-ERROR
 15147             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15148
 15149 6000-EXIT.
 15150      EXIT.
 15151
 15152 6100-CALC-GROSS-TERM.
 15153     MOVE CM-LOAN-BALANCE         TO L.
 15154     MOVE PI-PAYMENT-AMT          TO M.
 15155
 15156     COMPUTE N = L / M.
 15157     IF N LESS 1
 15158         MOVE 1  TO N.
 15159
 15160     IF CM-LF-BENEFIT-CD NOT = ZERO
 15161         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15162     ELSE
 15163         MOVE ZEROS               TO WS-LF-RATE.
 15164
 15165     IF CM-AH-BENEFIT-CD NOT = ZERO
 15166         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15167     ELSE
 15168         MOVE ZEROS               TO WS-AH-RATE.
 15169
 15170     COMPUTE I = CM-LOAN-APR / +1200.
 15171
 15172 6105-LOOP.
 15173     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 284
* EL131.cbl
 15174         GO TO 6200-EXIT.
 15175     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15176     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15177         ADD 1 TO N
 15178         GO TO 6105-LOOP.
 15179
 15180 6200-EXIT.
 15181      EXIT.
 15182
 15183 6210-CALC-LEFT-RIGHTONE.
 15184      MOVE L         TO LEFT-TOT-1.
 15185      SUBTRACT 1 FROM N.
 15186      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15187      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15188      ADD 1 TO N.
 15189 6211-CALC-TERM1.
 15190      MOVE N         TO TERM1.
 15191      MULTIPLY M BY TERM1.
 15192 6212-LOOP.
 15193      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15194      ADD 1 TO A-N.
 15195      MULTIPLY A-N BY TERM1.
 15196      SUBTRACT 1 FROM A-N.
 15197      ADD TERM1 TO LEFT-TOT-1.
 15198 6213-CALC-TERM2.
 15199      MOVE M         TO TERM2.
 15200      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15201      MULTIPLY IA-N BY TERM2.
 15202      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15203 6215-CALC-RIGHTONE.
 15204      MOVE M         TO RIGHT-TOT-1.
 15205      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15206      MULTIPLY A-N BY RIGHT-TOT-1.
 15207 6220-EXIT.
 15208      EXIT.
 15209
 15210 6300-CALC-A-N.
 15211     IF N LESS 1
 15212         MOVE 0     TO A-N
 15213         GO TO 6300-EXIT.
 15214     IF I = 0
 15215         MOVE .00001 TO I.
 15216     ADD 1 TO I.
 15217     DIVIDE I INTO 1 GIVING V.
 15218     SUBTRACT 1 FROM I.
 15219     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15220     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15221     DIVIDE I INTO TERM3 GIVING A-N.
 15222 6300-EXIT.
 15223      EXIT.
 15224
 15225 6350-CALC-IA-N.
 15226     IF N LESS 1
 15227         MOVE 0      TO IA-N
 15228         GO TO 6400-EXIT.
 15229     ADD 1 TO N.
 15230     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15231     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 285
* EL131.cbl
 15232     MULTIPLY N BY V-EX-N GIVING TERM3.
 15233     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15234     SUBTRACT V FROM 1 GIVING TERM4.
 15235     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15236 6400-EXIT.
 15237      EXIT.
 15238
 15239 6450-CALC-V-EX-N.
 15240     IF N LESS 1
 15241         MOVE 1    TO V-EX-N
 15242         GO TO 6490-EXIT.
 15243     MOVE N        TO NV-STORE.
 15244     IF V-EX-ONETIME = 1  OR
 15245        V NOT = V-EXPONENT (1)
 15246          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15247 6460-LOOP.
 15248     IF N GREATER 248
 15249         MOVE 248 TO N.
 15250     IF N = 1
 15251         MOVE V               TO V-EX-N
 15252      ELSE
 15253         MOVE V-EXPONENT (N)  TO V-EX-N.
 15254     GO TO 6490-EXIT.
 15255
 15256 6470-BUILD-V-EX-TABLE.
 15257     MOVE 2      TO N.
 15258     MOVE V      TO V-EXPONENT (1)
 15259                    V-EX-N.
 15260 6471-LOOP.
 15261     MULTIPLY V BY V-EX-N.
 15262     MOVE V-EX-N   TO V-EXPONENT (N).
 15263     ADD 1 TO N.
 15264     IF N LESS 248
 15265         GO TO 6471-LOOP.
 15266     MOVE NV-STORE     TO N.
 15267     MOVE 0            TO V-EX-ONETIME.
 15268 6480-EXIT.
 15269      EXIT.
 15270
 15271 6490-EXIT.
 15272      EXIT.
 15273
 15274 6500-CALC-NET-TERM.
 15275     MOVE CM-LOAN-BALANCE         TO L.
 15276     MOVE PI-PAYMENT-AMT          TO M.
 15277
 15278     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15279     IF WS-REMAIN GREATER ZERO
 15280         ADD 1 TO N.
 15281     IF N = 0
 15282         MOVE 1 TO N.
 15283
 15284 6700-EXIT.
 15285      EXIT.
 15286
 15287 6999-CALC-TERM-EXIT.
 15288     EXIT.
 15289
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 286
* EL131.cbl
 15291 7000-RESET-ATTRIBUTE.
 15292
 15293     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15294                                    CERTSTA   CERTCARA
 15295                                    CERTGRPA.
 15296     MOVE -1                     TO CERTCARL.
 15297
 15298 7000-EXIT.
 15299     EXIT.
 15300
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 287
* EL131.cbl
 15302 7600-BROWSE-CLAIM.
 15303
 15304
 15305* EXEC CICS READ
 15306*        DATASET(CLMS-FILE-ID)
 15307*        SET    (ADDRESS OF CLAIM-MASTER)
 15308*        RIDFLD (MSTR-KEY)
 15309*        GENERIC
 15310*        EQUAL
 15311*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15312*    END-EXEC.
 15313*    MOVE '&"S  KG    E          (   #00012989' TO DFHEIV0
 15314     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15315     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15316     MOVE X'2020233030303132393839' TO DFHEIV0(25:11)
 15317     CALL 'kxdfhei1' USING DFHEIV0,
 15318           CLMS-FILE-ID,
 15319           DFHEIV20,
 15320           DFHEIV99,
 15321           MSTR-KEY,
 15322           ELMSTR-GENERIC-LENGTH,
 15323           DFHEIV99,
 15324           DFHEIV99
 15325     SET ADDRESS OF CLAIM-MASTER TO
 15326         DFHEIV20
 15327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15328
 15329
 15330     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15331
 15332     if cl-assoc-cert-total = 0
 15333        move 1 to cl-assoc-cert-total
 15334     end-if
 15335     IF CL-ASSOC-CERT-SEQU = 0
 15336        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15337     END-IF
 15338
 15339     IF CL-ASSOC-CERT-TOTAL = 1
 15340         MOVE AL-SADOF           TO BCERT1A
 15341                                    BSUFX1A
 15342                                    BCERT2A
 15343                                    BSUFX2A
 15344                                    BCERT3A
 15345                                    BSUFX3A
 15346                                    BCERT4A
 15347                                    BSUFX4A
 15348                                    BCERT5A
 15349                                    BSUFX5A
 15350                                    PCERTNOA
 15351                                    PSUFXA
 15352                                    LABEL1A
 15353                                    LABEL2A
 15354         GO TO 7699-EXIT.
 15355
 15356 7610-BROWSE-CLAIM-LOOP.
 15357
 15358     MOVE LOW-VALUES             TO BCERT1O
 15359                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 288
* EL131.cbl
 15360                                    BCERT2O
 15361                                    BSUFX2O
 15362                                    BCERT3O
 15363                                    BSUFX3O
 15364                                    BCERT4O
 15365                                    BSUFX4O
 15366                                    BCERT5O
 15367                                    BSUFX5O.
 15368
 15369
 15370* EXEC CICS HANDLE CONDITION
 15371*        ENDFILE  (7630-END-BROWSE)
 15372*    END-EXEC.
 15373*    MOVE '"$''                   ! C #00013037' TO DFHEIV0
 15374     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15376     MOVE X'4320233030303133303337' TO DFHEIV0(25:11)
 15377     CALL 'kxdfhei1' USING DFHEIV0
 15378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15379
 15380
 15381
 15382* EXEC CICS STARTBR
 15383*        DATASET    (CLMS-FILE-ID)
 15384*        RIDFLD     (MSTR-KEY)
 15385*    END-EXEC.
 15386     MOVE 0
 15387       TO DFHEIV11
 15388*    MOVE '&,         G          &   #00013041' TO DFHEIV0
 15389     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15390     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15391     MOVE X'2020233030303133303431' TO DFHEIV0(25:11)
 15392     CALL 'kxdfhei1' USING DFHEIV0,
 15393           CLMS-FILE-ID,
 15394           MSTR-KEY,
 15395           DFHEIV99,
 15396           DFHEIV11,
 15397           DFHEIV99
 15398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15399
 15400
 15401     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15402
 15403 7620-READ-CLAIM-LOOP.
 15404
 15405
 15406* EXEC CICS READNEXT
 15407*        DATASET   (CLMS-FILE-ID)
 15408*        SET       (ADDRESS OF CLAIM-MASTER)
 15409*        RIDFLD    (MSTR-KEY)
 15410*    END-EXEC.
 15411     MOVE 0
 15412       TO DFHEIV11
 15413*    MOVE '&.S                   )   #00013050' TO DFHEIV0
 15414     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15415     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15416     MOVE X'2020233030303133303530' TO DFHEIV0(25:11)
 15417     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 289
* EL131.cbl
 15418           CLMS-FILE-ID,
 15419           DFHEIV20,
 15420           DFHEIV99,
 15421           MSTR-KEY,
 15422           DFHEIV99,
 15423           DFHEIV11,
 15424           DFHEIV99,
 15425           DFHEIV99
 15426     SET ADDRESS OF CLAIM-MASTER TO
 15427         DFHEIV20
 15428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15429
 15430
 15431     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 15432        CL-CARRIER     NOT = CARRI           OR
 15433        CL-CLAIM-NO    NOT = CLAIMI
 15434        GO TO 7630-END-BROWSE.
 15435
 15436     IF WS-ASSOCIATED-CERTS = 1
 15437         MOVE CL-CERT-PRIME      TO BCERT1O
 15438         MOVE CL-CERT-SFX        TO BSUFX1O.
 15439
 15440     IF WS-ASSOCIATED-CERTS = 2
 15441         MOVE CL-CERT-PRIME      TO BCERT2O
 15442         MOVE CL-CERT-SFX        TO BSUFX2O.
 15443
 15444     IF WS-ASSOCIATED-CERTS = 3
 15445         MOVE CL-CERT-PRIME      TO BCERT3O
 15446         MOVE CL-CERT-SFX        TO BSUFX3O.
 15447
 15448     IF WS-ASSOCIATED-CERTS = 4
 15449         MOVE CL-CERT-PRIME      TO BCERT4O
 15450         MOVE CL-CERT-SFX        TO BSUFX4O.
 15451
 15452     IF WS-ASSOCIATED-CERTS = 5
 15453         MOVE CL-CERT-PRIME      TO BCERT5O
 15454         MOVE CL-CERT-SFX        TO BSUFX5O
 15455     ELSE
 15456         ADD +1                  TO WS-ASSOCIATED-CERTS
 15457         GO TO 7620-READ-CLAIM-LOOP.
 15458
 15459 7630-END-BROWSE.
 15460
 15461
 15462* EXEC CICS ENDBR
 15463*        DATASET   (CLMS-FILE-ID)
 15464*    END-EXEC.
 15465     MOVE 0
 15466       TO DFHEIV11
 15467*    MOVE '&2                    $   #00013086' TO DFHEIV0
 15468     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15469     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15470     MOVE X'2020233030303133303836' TO DFHEIV0(25:11)
 15471     CALL 'kxdfhei1' USING DFHEIV0,
 15472           CLMS-FILE-ID,
 15473           DFHEIV11,
 15474           DFHEIV99
 15475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 290
* EL131.cbl
 15476
 15477
 15478 7640-HIGHLIGHT-CERT-DISPLAYED.
 15479
 15480     MOVE AL-SANON               TO BCERT1A
 15481                                    BSUFX1A
 15482                                    BCERT2A
 15483                                    BSUFX2A
 15484                                    BCERT3A
 15485                                    BSUFX3A
 15486                                    BCERT4A
 15487                                    BSUFX4A
 15488                                    BCERT5A
 15489                                    BSUFX5A.
 15490
 15491     IF BCERT1O = CERTI AND
 15492        BSUFX1O = SUFXI
 15493            MOVE AL-SABON        TO BCERT1A
 15494                                    BSUFX1A.
 15495
 15496     IF BCERT2O = CERTI AND
 15497        BSUFX2O = SUFXI
 15498            MOVE AL-SABON        TO BCERT2A
 15499                                    BSUFX2A.
 15500
 15501     IF BCERT3O = CERTI AND
 15502        BSUFX3O = SUFXI
 15503            MOVE AL-SABON        TO BCERT3A
 15504                                    BSUFX3A.
 15505
 15506     IF BCERT4O = CERTI AND
 15507        BSUFX4O = SUFXI
 15508            MOVE AL-SABON        TO BCERT4A
 15509                                    BSUFX4A.
 15510
 15511     IF BCERT5O = CERTI AND
 15512        BSUFX5O = SUFXI
 15513            MOVE AL-SABON        TO BCERT5A
 15514                                    BSUFX5A.
 15515
 15516 7699-EXIT.
 15517     EXIT.
 15518
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 291
* EL131.cbl
 15520 7700-CHECK-SEQUENCE.
 15521
 15522
 15523* EXEC CICS HANDLE CONDITION
 15524*        ENDFILE  (7799-EXIT)
 15525*        NOTFND   (7799-EXIT)
 15526*    END-EXEC.
 15527*    MOVE '"$''I                  ! D #00013134' TO DFHEIV0
 15528     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15530     MOVE X'4420233030303133313334' TO DFHEIV0(25:11)
 15531     CALL 'kxdfhei1' USING DFHEIV0
 15532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15533
 15534
 15535
 15536* EXEC CICS READ
 15537*        DATASET(CLMS-FILE-ID)
 15538*        SET    (ADDRESS OF CLAIM-MASTER)
 15539*        RIDFLD (MSTR-KEY)
 15540*        GENERIC
 15541*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15542*    END-EXEC.
 15543*    MOVE '&"S  KG    E          (   #00013139' TO DFHEIV0
 15544     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15545     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15546     MOVE X'2020233030303133313339' TO DFHEIV0(25:11)
 15547     CALL 'kxdfhei1' USING DFHEIV0,
 15548           CLMS-FILE-ID,
 15549           DFHEIV20,
 15550           DFHEIV99,
 15551           MSTR-KEY,
 15552           ELMSTR-GENERIC-LENGTH,
 15553           DFHEIV99,
 15554           DFHEIV99
 15555     SET ADDRESS OF CLAIM-MASTER TO
 15556         DFHEIV20
 15557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15558
 15559
 15560     COMPUTE WS-ASSOC-CERT-TOTAL =
 15561             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15562
 15563     GO TO 7799-EXIT.
 15564
 15565 7710-RESEQUENCE-CLAIMS.
 15566
 15567
 15568* EXEC CICS HANDLE CONDITION
 15569*        ENDFILE  (7799-EXIT)
 15570*    END-EXEC.
 15571*    MOVE '"$''                   ! E #00013154' TO DFHEIV0
 15572     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15574     MOVE X'4520233030303133313534' TO DFHEIV0(25:11)
 15575     CALL 'kxdfhei1' USING DFHEIV0
 15576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15577
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 292
* EL131.cbl
 15578
 15579
 15580* EXEC CICS STARTBR
 15581*        DATASET(CLMS-FILE-ID)
 15582*        RIDFLD (MSTR-KEY)
 15583*    END-EXEC.
 15584     MOVE 0
 15585       TO DFHEIV11
 15586*    MOVE '&,         G          &   #00013158' TO DFHEIV0
 15587     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15588     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15589     MOVE X'2020233030303133313538' TO DFHEIV0(25:11)
 15590     CALL 'kxdfhei1' USING DFHEIV0,
 15591           CLMS-FILE-ID,
 15592           MSTR-KEY,
 15593           DFHEIV99,
 15594           DFHEIV11,
 15595           DFHEIV99
 15596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15597
 15598
 15599     COMPUTE WS-ASSOC-CERT-SEQU =
 15600             WS-ASSOC-CERT-SEQU + 1.
 15601
 15602     COMPUTE WS-READNEXT-SWITCH =
 15603             WS-READNEXT-SWITCH + 1.
 15604
 15605 7720-READ-CLAIM-LOOP.
 15606
 15607
 15608* EXEC CICS READNEXT
 15609*        DATASET(CLMS-FILE-ID)
 15610*        SET    (ADDRESS OF CLAIM-MASTER)
 15611*        RIDFLD (MSTR-KEY)
 15612*    END-EXEC.
 15613     MOVE 0
 15614       TO DFHEIV11
 15615*    MOVE '&.S                   )   #00013171' TO DFHEIV0
 15616     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15617     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15618     MOVE X'2020233030303133313731' TO DFHEIV0(25:11)
 15619     CALL 'kxdfhei1' USING DFHEIV0,
 15620           CLMS-FILE-ID,
 15621           DFHEIV20,
 15622           DFHEIV99,
 15623           MSTR-KEY,
 15624           DFHEIV99,
 15625           DFHEIV11,
 15626           DFHEIV99,
 15627           DFHEIV99
 15628     SET ADDRESS OF CLAIM-MASTER TO
 15629         DFHEIV20
 15630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15631
 15632
 15633     IF WS-READNEXT-SWITCH = 1
 15634         ADD 1                   TO WS-READNEXT-SWITCH
 15635         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 293
* EL131.cbl
 15636
 15637 7730-END-BROWSE.
 15638
 15639
 15640* EXEC CICS ENDBR
 15641*        DATASET(CLMS-FILE-ID)
 15642*    END-EXEC.
 15643     MOVE 0
 15644       TO DFHEIV11
 15645*    MOVE '&2                    $   #00013183' TO DFHEIV0
 15646     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15647     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15648     MOVE X'2020233030303133313833' TO DFHEIV0(25:11)
 15649     CALL 'kxdfhei1' USING DFHEIV0,
 15650           CLMS-FILE-ID,
 15651           DFHEIV11,
 15652           DFHEIV99
 15653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15654
 15655
 15656 7740-READ-CLAIM-UPDATE.
 15657
 15658     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15659        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15660        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15661        GO TO 7799-EXIT
 15662     ELSE
 15663        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15664
 15665
 15666* EXEC CICS READ
 15667*        DATASET(CLMS-FILE-ID)
 15668*        SET    (ADDRESS OF CLAIM-MASTER)
 15669*        RIDFLD (MSTR-KEY)
 15670*        UPDATE
 15671*    END-EXEC.
 15672*    MOVE '&"S        EU         (   #00013196' TO DFHEIV0
 15673     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15674     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15675     MOVE X'2020233030303133313936' TO DFHEIV0(25:11)
 15676     CALL 'kxdfhei1' USING DFHEIV0,
 15677           CLMS-FILE-ID,
 15678           DFHEIV20,
 15679           DFHEIV99,
 15680           MSTR-KEY,
 15681           DFHEIV99,
 15682           DFHEIV99,
 15683           DFHEIV99
 15684     SET ADDRESS OF CLAIM-MASTER TO
 15685         DFHEIV20
 15686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15687
 15688
 15689     if (cl-priority-cd = '8')
 15690        and (pi-processor-id not = 'PEMA' and 'JMS '
 15691             AND 'AMWA')
 15692        MOVE ER-8003             TO EMI-ERROR
 15693        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 294
* EL131.cbl
 15694                                 THRU 9900-EXIT
 15695        MOVE -1                  TO MAINTL
 15696        GO TO 8110-SEND-DATA
 15697     end-if
 15698
 15699     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15700         MOVE 'Y'                TO CL-YESNOSW
 15701     END-IF.
 15702
 15703     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15704     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15705
 15706
 15707* EXEC CICS REWRITE
 15708*         DATASET(CLMS-FILE-ID)
 15709*         FROM   (CLAIM-MASTER)
 15710*    END-EXEC.
 15711     MOVE LENGTH OF
 15712      CLAIM-MASTER
 15713       TO DFHEIV11
 15714*    MOVE '&& L                  %   #00013220' TO DFHEIV0
 15715     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15716     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15717     MOVE X'2020233030303133323230' TO DFHEIV0(25:11)
 15718     CALL 'kxdfhei1' USING DFHEIV0,
 15719           CLMS-FILE-ID,
 15720           CLAIM-MASTER,
 15721           DFHEIV11,
 15722           DFHEIV99
 15723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15724
 15725
 15726     GO TO 7710-RESEQUENCE-CLAIMS.
 15727
 15728 7799-EXIT.
 15729     EXIT.
 15730
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 295
* EL131.cbl
 15732 7800-CHECK-AUTO-ACTIVITY.
 15733
 15734
 15735* EXEC CICS HANDLE CONDITION
 15736*        NOTFND   (7800-NOT-FOUND)
 15737*    END-EXEC.
 15738*    MOVE '"$I                   ! F #00013233' TO DFHEIV0
 15739     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15741     MOVE X'4620233030303133323333' TO DFHEIV0(25:11)
 15742     CALL 'kxdfhei1' USING DFHEIV0
 15743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15744
 15745
 15746     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15747     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15748     MOVE SPACES                     TO  CNTL-PROC-ID.
 15749     MOVE +0                         TO  CNTL-SEQ-NO.
 15750
 15751
 15752* EXEC CICS READ
 15753*        DATASET   (CNTL-FILE-ID)
 15754*        RIDFLD    (CNTL-KEY)
 15755*        SET       (ADDRESS OF CONTROL-FILE)
 15756*    END-EXEC.
 15757*    MOVE '&"S        E          (   #00013242' TO DFHEIV0
 15758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15760     MOVE X'2020233030303133323432' TO DFHEIV0(25:11)
 15761     CALL 'kxdfhei1' USING DFHEIV0,
 15762           CNTL-FILE-ID,
 15763           DFHEIV20,
 15764           DFHEIV99,
 15765           CNTL-KEY,
 15766           DFHEIV99,
 15767           DFHEIV99,
 15768           DFHEIV99
 15769     SET ADDRESS OF CONTROL-FILE TO
 15770         DFHEIV20
 15771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15772
 15773
 15774     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15775         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15776
 15777     IF CL-ACTIVITY-CODE NOT = ZEROS
 15778         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15779         IF MISC-SUB IS GREATER THAN +9
 15780             SUBTRACT +9 FROM MISC-SUB
 15781             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15782         ELSE
 15783             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15784     ELSE
 15785         MOVE 'Y'                              TO  WS-RESET-SW.
 15786
 15787     IF STATUSI = 'C' OR 'CLOSED'
 15788         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15789             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 296
* EL131.cbl
 15790                                         PI-LETTER-SW
 15791             GO TO 7800-EXIT.
 15792
 15793     IF STATUSI = 'C' OR 'CLOSED'
 15794         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15795             MOVE 'N'                TO  PI-LETTER-SW
 15796         ELSE
 15797             MOVE 'Y'                TO  PI-LETTER-SW.
 15798
 15799     IF STATUSI = 'O' OR 'OPEN'
 15800         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 15801             MOVE 'N'                TO  PI-REC-FOUND-SW
 15802                                         PI-LETTER-SW
 15803             GO TO 7800-EXIT.
 15804
 15805     IF STATUSI = 'O' OR 'OPEN'
 15806         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 15807             MOVE 'N'                TO  PI-LETTER-SW
 15808         ELSE
 15809             MOVE 'Y'                TO  PI-LETTER-SW.
 15810
 15811     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 15812     GO TO 7800-EXIT.
 15813
 15814 7800-NOT-FOUND.
 15815
 15816     MOVE 'N'                        TO  PI-REC-FOUND-SW
 15817                                         PI-LETTER-SW.
 15818
 15819 7800-EXIT.
 15820     EXIT.
 15821
 15822 7850-AUTO-LETTER-WRITER.
 15823
 15824     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 15825     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 15826
 15827     IF STATUSI = 'C' OR 'CLOSED'
 15828         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 15829     ELSE
 15830         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 15831
 15832     IF STATUSI = 'C' OR 'CLOSED'
 15833         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 15834             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15835             MOVE '6'                TO  DC-OPTION-CODE
 15836             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 15837             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15838             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15839             IF NO-CONVERSION-ERROR
 15840                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15841             ELSE
 15842                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15843
 15844     IF STATUSI = 'C' OR 'CLOSED'
 15845         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 15846             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15847             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 297
* EL131.cbl
 15848             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 15849             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15850             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15851             IF NO-CONVERSION-ERROR
 15852                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15853             ELSE
 15854                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15855
 15856     IF STATUSI = 'O' OR 'OPEN'
 15857         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 15858             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15859             MOVE '6'                TO  DC-OPTION-CODE
 15860             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 15861             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15862             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15863             IF NO-CONVERSION-ERROR
 15864                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15865             ELSE
 15866                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15867
 15868     IF STATUSI = 'O' OR 'OPEN'
 15869         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 15870             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15871             MOVE '6'                TO  DC-OPTION-CODE
 15872             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 15873             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15874             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15875             IF NO-CONVERSION-ERROR
 15876                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15877             ELSE
 15878                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15879
 15880
 15881* EXEC CICS LINK
 15882*        PROGRAM    (LINK-1523)
 15883*        COMMAREA   (W-1523-LINKDATA)
 15884*        LENGTH     (W-1523-COMM-LENGTH)
 15885*    END-EXEC.
 15886*    MOVE '."C                   (   #00013354' TO DFHEIV0
 15887     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15888     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15889     MOVE X'2020233030303133333534' TO DFHEIV0(25:11)
 15890     CALL 'kxdfhei1' USING DFHEIV0,
 15891           LINK-1523,
 15892           W-1523-LINKDATA,
 15893           W-1523-COMM-LENGTH,
 15894           DFHEIV99,
 15895           DFHEIV99,
 15896           DFHEIV99,
 15897           DFHEIV99
 15898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15899
 15900
 15901     IF W-1523-ERROR-CODE = ZEROS
 15902         GO TO 7850-EXIT.
 15903
 15904     IF W-1523-FATAL-ERROR
 15905         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 298
* EL131.cbl
 15906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15907
 15908     IF W-1523-ERROR-CODE = 0191
 15909         MOVE ER-0803                TO  EMI-ERROR
 15910         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15911
 15912 7850-EXIT.
 15913     EXIT.
 15914
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 299
* EL131.cbl
 15916 8000-CREATE-DMO-REC.
 15917     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 15918     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 15919     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 15920
 15921
 15922* EXEC CICS HANDLE CONDITION
 15923*         NOTFND   (8000-NOTE-NOT-FOUND)
 15924*    END-EXEC.
 15925*    MOVE '"$I                   ! G #00013380' TO DFHEIV0
 15926     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15928     MOVE X'4720233030303133333830' TO DFHEIV0(25:11)
 15929     CALL 'kxdfhei1' USING DFHEIV0
 15930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15931
 15932
 15933
 15934* EXEC CICS READ
 15935*         DATASET(NOTE-FILE-ID)
 15936*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 15937*         RIDFLD (NOTE-KEY)
 15938*    END-EXEC.
 15939*    MOVE '&"S        E          (   #00013384' TO DFHEIV0
 15940     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15942     MOVE X'2020233030303133333834' TO DFHEIV0(25:11)
 15943     CALL 'kxdfhei1' USING DFHEIV0,
 15944           NOTE-FILE-ID,
 15945           DFHEIV20,
 15946           DFHEIV99,
 15947           NOTE-KEY,
 15948           DFHEIV99,
 15949           DFHEIV99,
 15950           DFHEIV99
 15951     SET ADDRESS OF CERTIFICATE-NOTE TO
 15952         DFHEIV20
 15953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15954
 15955
 15956     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 15957     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 15958     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 15959
 15960     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 15961         MOVE 'CC'               TO DCT-PRODUCT-CODE
 15962     ELSE
 15963         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 15964
 15965     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 15966     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 15967
 15968
 15969* EXEC CICS LINK
 15970*        PROGRAM    ('DLO006')
 15971*        COMMAREA   (DCT-COMMUNICATION-AREA)
 15972*        LENGTH     (WS-DCT-LENGTH)
 15973*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 300
* EL131.cbl
 15974     MOVE 'DLO006' TO DFHEIV1
 15975*    MOVE '."C                   (   #00013402' TO DFHEIV0
 15976     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15977     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15978     MOVE X'2020233030303133343032' TO DFHEIV0(25:11)
 15979     CALL 'kxdfhei1' USING DFHEIV0,
 15980           DFHEIV1,
 15981           DCT-COMMUNICATION-AREA,
 15982           WS-DCT-LENGTH,
 15983           DFHEIV99,
 15984           DFHEIV99,
 15985           DFHEIV99,
 15986           DFHEIV99
 15987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15988
 15989
 15990     IF  DCT-RETURN-CODE = 'OK'
 15991         GO TO 8000-CONT.
 15992
 15993     IF DCT-RETURN-CODE = '01' OR '02'
 15994         GO TO 8000-EXIT.
 15995
 15996     IF DCT-RETURN-CODE = '03'
 15997         MOVE ER-0951            TO EMI-ERROR
 15998         MOVE -1                 TO MAINTL
 15999         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16000         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16001         GO TO 8110-SEND-DATA.
 16002
 16003     IF DCT-RETURN-CODE = '04'
 16004         MOVE ER-0946            TO EMI-ERROR
 16005         MOVE -1                 TO MAINTL
 16006         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16007         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16008         GO TO 8110-SEND-DATA.
 16009
 16010     IF DCT-RETURN-CODE = '05'
 16011         MOVE ER-0947            TO EMI-ERROR
 16012         MOVE -1                 TO MAINTL
 16013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16014         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16015         GO TO 8110-SEND-DATA.
 16016
 16017     IF DCT-RETURN-CODE = '06'
 16018         MOVE ER-0921            TO EMI-ERROR
 16019         MOVE -1                 TO MAINTL
 16020         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16021         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16022         GO TO 8110-SEND-DATA.
 16023
 16024     IF DCT-RETURN-CODE = '07'
 16025         MOVE ER-0919            TO EMI-ERROR
 16026         MOVE -1                 TO MAINTL
 16027         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16028         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16029         GO TO 8110-SEND-DATA.
 16030
 16031     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 301
* EL131.cbl
 16032         MOVE ER-0948            TO EMI-ERROR
 16033         MOVE -1                 TO MAINTL
 16034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16035         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16036         GO TO 8110-SEND-DATA.
 16037
 16038     IF DCT-RETURN-CODE = 'N1'
 16039         MOVE ER-0950            TO EMI-ERROR
 16040         MOVE -1                 TO MAINTL
 16041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16042         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16043         GO TO 8110-SEND-DATA.
 16044
 16045     IF DCT-RETURN-CODE = 'E1'
 16046         MOVE ER-0974            TO EMI-ERROR
 16047         MOVE -1                 TO MAINTL
 16048         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16049         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16050         GO TO 8110-SEND-DATA.
 16051
 16052     IF DCT-RETURN-CODE = 'E2'
 16053         MOVE ER-0975            TO EMI-ERROR
 16054         MOVE -1                 TO MAINTL
 16055         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16056         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16057         GO TO 8110-SEND-DATA.
 16058
 16059     IF DCT-RETURN-CODE NOT = 'OK'
 16060         MOVE ER-0949            TO EMI-ERROR
 16061         MOVE -1                 TO MAINTL
 16062         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16063         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16064         GO TO 8110-SEND-DATA.
 16065
 16066 8000-CONT.
 16067
 16068     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16069     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16070     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16071     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16072     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16073     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16074     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16075     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16076
 16077     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16078     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16079     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16080     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16081     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16082
 16083     IF STATUSI = 'OPEN' OR 'O'
 16084         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16085      ELSE
 16086         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16087
 16088     IF STATUSI = 'OPEN' OR 'O'
 16089        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 302
* EL131.cbl
 16090         MOVE '1'                TO DM-CLAIM-STATUS
 16091      ELSE
 16092         MOVE '2'                TO DM-CLAIM-STATUS.
 16093
 16094     IF STATUSI = 'CLOSED' OR 'C'
 16095        IF NOT FINAL-PAID
 16096         MOVE '3'                TO DM-CLAIM-STATUS
 16097      ELSE
 16098         MOVE '4'                TO DM-CLAIM-STATUS.
 16099
 16100     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16101
 16102
 16103* EXEC CICS LINK
 16104*        PROGRAM    ('DLO025')
 16105*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16106*        LENGTH     (WS-DMO-LENGTH)
 16107*    END-EXEC.
 16108     MOVE 'DLO025' TO DFHEIV1
 16109*    MOVE '."C                   (   #00013520' TO DFHEIV0
 16110     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16112     MOVE X'2020233030303133353230' TO DFHEIV0(25:11)
 16113     CALL 'kxdfhei1' USING DFHEIV0,
 16114           DFHEIV1,
 16115           DMO-COMMUNICATION-AREA,
 16116           WS-DMO-LENGTH,
 16117           DFHEIV99,
 16118           DFHEIV99,
 16119           DFHEIV99,
 16120           DFHEIV99
 16121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16122
 16123
 16124     IF  DM-RETURN-CODE = 'OK'
 16125         GO TO 8000-EXIT.
 16126
 16127     IF DM-RETURN-CODE = '01'
 16128         MOVE ER-8051            TO EMI-ERROR
 16129         MOVE -1                 TO MAINTL
 16130         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16131         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16132         GO TO 8110-SEND-DATA.
 16133
 16134     IF DM-RETURN-CODE = '02'
 16135         MOVE ER-8052            TO EMI-ERROR
 16136         MOVE -1                 TO MAINTL
 16137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16138         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16139         GO TO 8110-SEND-DATA.
 16140
 16141     IF DM-RETURN-CODE = '03'
 16142         MOVE ER-8053            TO EMI-ERROR
 16143         MOVE -1                 TO MAINTL
 16144         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16145         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16146         GO TO 8110-SEND-DATA.
 16147
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 303
* EL131.cbl
 16148     IF DM-RETURN-CODE = '04'
 16149         MOVE ER-8054            TO EMI-ERROR
 16150         MOVE -1                 TO MAINTL
 16151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16152         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16153         GO TO 8110-SEND-DATA.
 16154
 16155     IF DM-RETURN-CODE = '05'
 16156         MOVE ER-8055            TO EMI-ERROR
 16157         MOVE -1                 TO MAINTL
 16158         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16159         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16160         GO TO 8110-SEND-DATA.
 16161
 16162     IF DM-RETURN-CODE = '06'
 16163         MOVE ER-8056            TO EMI-ERROR
 16164         MOVE -1                 TO MAINTL
 16165         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16166         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16167         GO TO 8110-SEND-DATA.
 16168
 16169     IF DM-RETURN-CODE = '07'
 16170         MOVE ER-8057            TO EMI-ERROR
 16171         MOVE -1                 TO MAINTL
 16172         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16173         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16174         GO TO 8110-SEND-DATA.
 16175
 16176     IF DM-RETURN-CODE = '08'
 16177         MOVE ER-8058            TO EMI-ERROR
 16178         MOVE -1                 TO MAINTL
 16179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16180         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16181         GO TO 8110-SEND-DATA.
 16182
 16183     IF DM-RETURN-CODE = '09'
 16184         MOVE ER-8059            TO EMI-ERROR
 16185         MOVE -1                 TO MAINTL
 16186         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16187         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16188         GO TO 8110-SEND-DATA.
 16189
 16190     IF DM-RETURN-CODE = '10'
 16191         MOVE ER-8060            TO EMI-ERROR
 16192         MOVE -1                 TO MAINTL
 16193         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16194         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16195         GO TO 8110-SEND-DATA.
 16196
 16197     IF DM-RETURN-CODE = '11'
 16198         MOVE ER-8061            TO EMI-ERROR
 16199         MOVE -1                 TO MAINTL
 16200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16201         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16202         GO TO 8110-SEND-DATA.
 16203
 16204     IF DM-RETURN-CODE = '12'
 16205         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 304
* EL131.cbl
 16206         MOVE -1                 TO MAINTL
 16207         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16208         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16209         GO TO 8110-SEND-DATA.
 16210
 16211     IF DM-RETURN-CODE = '13'
 16212         MOVE ER-8063            TO EMI-ERROR
 16213         MOVE -1                 TO MAINTL
 16214         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16215         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16216         GO TO 8110-SEND-DATA.
 16217
 16218     IF DM-RETURN-CODE = '14'
 16219         MOVE ER-8064            TO EMI-ERROR
 16220         MOVE -1                 TO MAINTL
 16221         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16222         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16223         GO TO 8110-SEND-DATA.
 16224
 16225     IF DM-RETURN-CODE = '15'
 16226         MOVE ER-8065            TO EMI-ERROR
 16227         MOVE -1                 TO MAINTL
 16228         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16229         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16230         GO TO 8110-SEND-DATA.
 16231
 16232     IF DM-RETURN-CODE = '16'
 16233         MOVE ER-8154            TO EMI-ERROR
 16234         MOVE -1                 TO MAINTL
 16235         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16236         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16237         GO TO 8110-SEND-DATA.
 16238
 16239     IF DM-RETURN-CODE = '17'
 16240         MOVE ER-8155            TO EMI-ERROR
 16241         MOVE -1                 TO MAINTL
 16242         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16243         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16244         GO TO 8110-SEND-DATA.
 16245
 16246     IF DM-RETURN-CODE = 'N1'
 16247         MOVE ER-8152            TO EMI-ERROR
 16248         MOVE -1                 TO MAINTL
 16249         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16250         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16251         GO TO 8110-SEND-DATA.
 16252
 16253     IF DM-RETURN-CODE = 'E1'
 16254         MOVE ER-8153            TO EMI-ERROR
 16255         MOVE -1                 TO MAINTL
 16256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16257         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16258         GO TO 8110-SEND-DATA.
 16259
 16260     MOVE ER-8066                TO EMI-ERROR.
 16261     MOVE -1                     TO MAINTL.
 16262     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16263     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 305
* EL131.cbl
 16264     GO TO 8110-SEND-DATA.
 16265
 16266 8000-NOTE-NOT-FOUND.
 16267
 16268* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16269*    MOVE '6"R                   !   #00013669' TO DFHEIV0
 16270     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16271     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16272     MOVE X'2020233030303133363639' TO DFHEIV0(25:11)
 16273     CALL 'kxdfhei1' USING DFHEIV0
 16274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16275
 16276     MOVE ER-0954                TO EMI-ERROR.
 16277     MOVE -1                     TO MAINTL.
 16278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16279     GO TO 8110-SEND-DATA.
 16280
 16281 8000-EXIT.
 16282     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 306
* EL131.cbl
 16284 8050-FORMAT-LAST-NAME-1ST.
 16285*****************************************************************
 16286*             M O V E   N A M E   R O U T I N E                 *
 16287*                                                               *
 16288*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16289*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16290*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16291*                                                               *
 16292*                  FIELD               VALUE                    *
 16293*                  -----               -----                    *
 16294*           W-NAME-LAST    (CL15)      SMITH                    *
 16295*           W-NAME-FIRST   (CL15)      JOHN                     *
 16296*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16297*                                                               *
 16298*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16299*                SMITH, JOHN ALLEN                              *
 16300*                     OR                                        *
 16301*                SMITH, JOHN A.                                 *
 16302*                                                               *
 16303*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16304*     COPYBOOK, ELCNWA.                                         *
 16305*****************************************************************.
 16306
 16307     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16308     MOVE ZERO                   TO WS-NAME-SW.
 16309     SET NWA-INDEX               TO +1.
 16310
 16311     IF W-NAME-LAST   = SPACES  AND
 16312        W-NAME-MIDDLE = SPACES
 16313          MOVE +1                TO WS-NAME-SW.
 16314
 16315     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16316     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16317
 16318     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16319     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16320
 16321     SET NWA-INDEX UP BY +1.
 16322
 16323     IF W-NAME-MIDDLE NOT = SPACES
 16324         IF W-NAME-MIDDLE-2 = SPACES
 16325             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16326             SET NWA-INDEX UP BY +1
 16327             MOVE '.'            TO WS-NW (NWA-INDEX)
 16328             SET NWA-INDEX UP BY +2
 16329         ELSE
 16330             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16331             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16332
 16333 8050-EXIT.
 16334     EXIT.
 16335
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 307
* EL131.cbl
 16337 8060-MOVE-NAME.
 16338     IF WS-NAME-SW GREATER THAN +1
 16339         GO TO 8060-EXIT.
 16340
 16341     IF WS-NAME-WORK2 = SPACES
 16342         GO TO 8060-EXIT.
 16343
 16344     SET NWA-INDEX2            TO +1.
 16345     SET NWA-INDEX3            TO +2.
 16346
 16347 8060-MOVE-NAME-CYCLE.
 16348     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16349
 16350     IF NWA-INDEX LESS THAN +30
 16351         SET NWA-INDEX UP BY +1
 16352     ELSE
 16353         ADD +2 TO  WS-NAME-SW
 16354         GO TO 8060-EXIT.
 16355
 16356     IF NWA-INDEX2 LESS THAN +20
 16357         SET NWA-INDEX3 UP BY +1
 16358         SET NWA-INDEX2 UP BY +1.
 16359
 16360     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 16361        WS-NW2 (NWA-INDEX3) = SPACES
 16362         IF WS-NAME-SW = ZERO
 16363             MOVE ','            TO WS-NW (NWA-INDEX)
 16364             SET NWA-INDEX UP BY +2
 16365             MOVE +1             TO WS-NAME-SW
 16366             GO TO 8060-EXIT
 16367         ELSE
 16368             GO TO 8060-EXIT.
 16369
 16370     GO TO 8060-MOVE-NAME-CYCLE.
 16371
 16372 8060-EXIT.
 16373     EXIT.
 16374
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 308
* EL131.cbl
 16376
 16377 8070-UNLOCK-CLAIM-MSTR.
 16378
 16379* EXEC CICS UNLOCK
 16380*        DATASET   (CLMS-FILE-ID)
 16381*    END-EXEC.
 16382*    MOVE '&*                    #   #00013772' TO DFHEIV0
 16383     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16384     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16385     MOVE X'2020233030303133373732' TO DFHEIV0(25:11)
 16386     CALL 'kxdfhei1' USING DFHEIV0,
 16387           CLMS-FILE-ID,
 16388           DFHEIV99
 16389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16390
 16391
 16392 8070-EXIT.
 16393      EXIT.
 16394
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 309
* EL131.cbl
 16396 8100-SEND-MAP.
 16397     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16398
 16399     move al-uanon               to accswa
 16400     IF NOT PI-NO-CARRIER-SECURITY
 16401        MOVE AL-SANOF            TO CERTCARA.
 16402     IF NOT PI-NO-ACCOUNT-SECURITY
 16403        MOVE AL-SANOF            TO CERTACTA.
 16404
 16405     IF PI-PROCESSOR-ID = 'LGXX'
 16406        MOVE AL-UANON            TO CCNOA.
 16407
 16408     IF PI-COMPANY-ID = 'DMD'
 16409        NEXT SENTENCE
 16410     ELSE
 16411        MOVE AL-SADOF            TO PFKEY6A.
 16412
 16413     IF PI-USES-PAID-TO
 16414        MOVE 'PAID TO  :' TO PTHRHDGO.
 16415
 16416
 16417* EXEC CICS SEND
 16418*         MAP     ('EL131A')
 16419*         MAPSET  ('EL131S')
 16420*         ERASE
 16421*         FREEKB
 16422*         CURSOR
 16423*    END-EXEC.
 16424     MOVE 'EL131A' TO DFHEIV1
 16425     MOVE -1
 16426       TO DFHEIV11
 16427     MOVE 'EL131S' TO DFHEIV2
 16428*    MOVE '8$     CT  E F  H     ,   #00013800' TO DFHEIV0
 16429     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16430     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16431     MOVE X'2020233030303133383030' TO DFHEIV0(25:11)
 16432     CALL 'kxdfhei1' USING DFHEIV0,
 16433           DFHEIV1,
 16434           EL131AO,
 16435           DFHEIV99,
 16436           DFHEIV2,
 16437           DFHEIV99,
 16438           DFHEIV99,
 16439           DFHEIV99,
 16440           DFHEIV11,
 16441           DFHEIV99,
 16442           DFHEIV99,
 16443           DFHEIV99
 16444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16445
 16446
 16447     GO TO 9000-RETURN-TRANS.
 16448
 16449 8110-SEND-DATA.
 16450     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16451
 16452     IF PI-USES-PAID-TO
 16453        MOVE 'PAID TO  :' TO PTHRHDGO.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 310
* EL131.cbl
 16454
 16455     IF PI-PROCESSOR-ID = 'LGXX'
 16456        MOVE AL-UANON            TO CCNOA.
 16457
 16458     IF PI-COMPANY-ID = 'DMD'
 16459        NEXT SENTENCE
 16460     ELSE
 16461        MOVE AL-SADOF            TO PFKEY6A.
 16462
 16463
 16464* EXEC CICS SEND
 16465*         MAP      ('EL131A')
 16466*         MAPSET   ('EL131S')
 16467*         DATAONLY
 16468*         FREEKB
 16469*         CURSOR
 16470*    END-EXEC.
 16471     MOVE 'EL131A' TO DFHEIV1
 16472     MOVE -1
 16473       TO DFHEIV11
 16474     MOVE 'EL131S' TO DFHEIV2
 16475*    MOVE '8$D    CT    F  H     ,   #00013824' TO DFHEIV0
 16476     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16477     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16478     MOVE X'2020233030303133383234' TO DFHEIV0(25:11)
 16479     CALL 'kxdfhei1' USING DFHEIV0,
 16480           DFHEIV1,
 16481           EL131AO,
 16482           DFHEIV99,
 16483           DFHEIV2,
 16484           DFHEIV99,
 16485           DFHEIV99,
 16486           DFHEIV99,
 16487           DFHEIV11,
 16488           DFHEIV99,
 16489           DFHEIV99,
 16490           DFHEIV99
 16491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16492
 16493
 16494     GO TO 9000-RETURN-TRANS.
 16495
 16496 8120-FORMAT-TIME-DATE.
 16497     perform 8140-check-for-prev-errors
 16498                                 thru 8140-exit
 16499     IF SKIP-ATTRIBUTE = 'Y'
 16500        MOVE SPACES              TO SKIP-ATTRIBUTE
 16501        MOVE ER-0598             TO EMI-ERROR
 16502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16503        GO TO 8125-SKIP-ATTRIBUTE.
 16504
 16505*     IF PI-COMPANY-ID = 'DMD'
 16506      IF PI-PROCESSOR-ID <> 'EMER'
 16507         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 16508                                    CERTCARA  CERTGRPA CERTA SUFXA
 16509
 16510     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 16511                                    ISSAGEA   JNTLNMEA  JNTFNMEA
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 311
* EL131.cbl
 16512                                    JNTINITA  JNTAGEA   APRA
 16513                                    LCVCDA    LCVOTRMA  LCVRTRMA
 16514                                    LCVBENEA  LCVFORMA  LCVCNDTA
 16515                                    LCVEXITA  LCVSTATA  LCVKINDA
 16516                                    ACVCDA    ACVOTRMA  ACVRTRMA
 16517                                    ACVBENEA  ACVFORMA  ACVCNDTA
 16518                                    ACVEXITA  ACVSTATA  ACVKINDA
 16519                                    PMTFREQA  INDGRPA   PREMTYPA
 16520                                    REINCDA   LCVRATEA  ACVRATEA
 16521                                    ADDONDTA.
 16522
 16523*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 16524*       IF PI-COMPANY-ID = 'DMD'
 16525*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 16526*                                   SUFXA
 16527*                                   PDAMTA    NODAYSA   NOPMTSA
 16528*                                   INCA      OCCA
 16529*          IF NOT SYSTEM-MODIFY-CAP
 16530*              MOVE AL-SANOF         TO PDTHRUA.
 16531
 16532     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 16533         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 16534
 16535 8125-SKIP-ATTRIBUTE.
 16536
 16537     MOVE SAVE-DATE              TO DATEO.
 16538
 16539* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 16540*    END-EXEC
 16541*    MOVE '0"A                   "   #00013876' TO DFHEIV0
 16542     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 16543     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 16544     MOVE X'2020233030303133383736' TO DFHEIV0(25:11)
 16545     CALL 'kxdfhei1' USING DFHEIV0,
 16546           LCP-CICS-TIME
 16547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16548
 16549* EXEC CICS FORMATTIME
 16550*              ABSTIME(LCP-CICS-TIME)
 16551*              TIME(LCP-TIME-OF-DAY-XX)
 16552*    END-EXEC
 16553*    MOVE 'j$(     (             #   #00013878' TO DFHEIV0
 16554     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 16555     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16556     MOVE X'2020233030303133383738' TO DFHEIV0(25:11)
 16557     CALL 'kxdfhei1' USING DFHEIV0,
 16558           LCP-CICS-TIME,
 16559           LCP-TIME-OF-DAY-XX
 16560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16561     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 16562     MOVE UN-HOURS               TO FOR-HOURS.
 16563     MOVE UN-MINUTES             TO FOR-MINUTES.
 16564     MOVE TIME-OUT               TO TIMEO.
 16565     MOVE PI-COMPANY-ID          TO COMPO.
 16566     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16567     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 16568     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16569     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 312
* EL131.cbl
 16570     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 16571
 16572 8130-EXIT.
 16573     EXIT.
 16574
 16575 8140-check-for-prev-errors.
 16576
 16577     MOVE PI-COMPANY-CD          TO trlr-company-cd
 16578     MOVE PI-CARRIER             TO trlr-carrier
 16579     MOVE PI-CLAIM-NO            TO trlr-claim-no
 16580     MOVE PI-CERT-NO             TO trlr-cert-no
 16581     MOVE +95                    TO TRLR-SEQ-NO
 16582
 16583
 16584* EXEC CICS READ
 16585*       DATASET  ('ELTRLR')
 16586*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16587*       RIDFLD   (TRLR-KEY)
 16588*       RESP     (WS-RESPONSE)
 16589*    END-EXEC
 16590     MOVE 'ELTRLR' TO DFHEIV1
 16591*    MOVE '&"S        E          (  N#00013904' TO DFHEIV0
 16592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16593     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16594     MOVE X'204E233030303133393034' TO DFHEIV0(25:11)
 16595     CALL 'kxdfhei1' USING DFHEIV0,
 16596           DFHEIV1,
 16597           DFHEIV20,
 16598           DFHEIV99,
 16599           TRLR-KEY,
 16600           DFHEIV99,
 16601           DFHEIV99,
 16602           DFHEIV99
 16603     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16604         DFHEIV20
 16605     MOVE EIBRESP  TO WS-RESPONSE
 16606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16607
 16608     if ws-resp-normal
 16609        perform varying s1 from +1 by +1 until
 16610           at-note-error-no (s1) = spaces
 16611           if at-note-error-no (s1) = '1652'
 16612              continue
 16613           else
 16614              move at-note-error-no (s1)
 16615                                 to emi-error
 16616              move -1 to maintl
 16617              if at-note-error-no (s1) = '1653'
 16618                 evaluate true
 16619                    when pi-claim-type = 'L'
 16620                       move '  LF  '
 16621                        to emi-claim-type
 16622                    when pi-claim-type = 'I'
 16623                       move '  IU  '
 16624                        to emi-claim-type
 16625                    WHEN PI-CLAIM-TYPE = 'F'
 16626                       MOVE '  FL  '
 16627                        TO EMI-CLAIM-TYPE
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 313
* EL131.cbl
 16628                    when other
 16629                       move '  AH  '
 16630                        to emi-claim-type
 16631                 end-evaluate
 16632              end-if
 16633              PERFORM 9900-ERROR-FORMAT
 16634                                 THRU 9900-EXIT
 16635           end-if
 16636*          if at-note-error-no (s1) = '1653'
 16637*             perform varying emi-sub from 1 by 1 until
 16638*                emi-sub > 3
 16639*                if emi-error-number (emi-sub) = '1653'
 16640*                   evaluate true
 16641*                      when pi-claim-type = 'L'
 16642*                         move '  LF  '
 16643*                          to emi-claim-type
 16644*                      when pi-claim-type = 'I'
 16645*                         move '  IU  '
 16646*                          to emi-claim-type
 16647*                      when other
 16648*                         move '  AH  '
 16649*                          to emi-claim-type
 16650*                   end-evaluate
 16651*                end-if
 16652*             end-perform
 16653*          end-if
 16654        end-perform
 16655     else
 16656        display ' resp not normal ' ws-response ' '
 16657        trlr-key (2:19)
 16658     end-if
 16659
 16660     .
 16661 8140-exit.
 16662     exit.
 16663 8150-ENTERED-CLAIM-NOTFOUND.
 16664
 16665     MOVE ER-0204                TO EMI-ERROR.
 16666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16667     MOVE -1                     TO MAINTL.
 16668     GO TO 8100-SEND-MAP.
 16669
 16670 8200-RETURN-PRIOR.
 16671     MOVE SPACE                  TO PI-RETURN-CD-1.
 16672     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16673     GO TO 9200-XCTL.
 16674
 16675 8300-GET-HELP.
 16676     MOVE XCTL-EL010             TO CALL-PGM.
 16677     GO TO 9200-XCTL.
 16678
 16679 8400-RETURN-MASTER.
 16680     MOVE SPACE                  TO PI-RETURN-CD-1.
 16681     MOVE XCTL-EL126             TO CALL-PGM.
 16682     GO TO 9200-XCTL.
 16683
 16684 8500-TRLR-MNT.
 16685     IF PI-RETURN-CD-1 = 'X'
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 314
* EL131.cbl
 16686         MOVE ER-0311            TO EMI-ERROR
 16687         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16688         MOVE -1                 TO MAINTL
 16689         GO TO 8110-SEND-DATA.
 16690
 16691
 16692* EXEC CICS WRITEQ TS
 16693*         QUEUE     (PI-KEY)
 16694*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16695*         LENGTH    (PI-COMM-LENGTH)
 16696*    END-EXEC.
 16697*    MOVE '*"                    ''   #00013994' TO DFHEIV0
 16698     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16699     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16700     MOVE X'2020233030303133393934' TO DFHEIV0(25:11)
 16701     CALL 'kxdfhei1' USING DFHEIV0,
 16702           PI-KEY,
 16703           PROGRAM-INTERFACE-BLOCK,
 16704           PI-COMM-LENGTH,
 16705           DFHEIV99,
 16706           DFHEIV99,
 16707           DFHEIV99
 16708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16709
 16710
 16711     MOVE XCTL-EL142             TO CALL-PGM.
 16712     GO TO 9200-XCTL.
 16713
 16714 8600-ADDR-MNT.
 16715     IF PI-RETURN-CD-1 = 'X'
 16716         MOVE ER-0311            TO EMI-ERROR
 16717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16718         MOVE -1                 TO MAINTL
 16719         GO TO 8110-SEND-DATA.
 16720
 16721
 16722* EXEC CICS WRITEQ TS
 16723*         QUEUE     (PI-KEY)
 16724*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16725*         LENGTH    (PI-COMM-LENGTH)
 16726*    END-EXEC.
 16727*    MOVE '*"                    ''   #00014010' TO DFHEIV0
 16728     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16729     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16730     MOVE X'2020233030303134303130' TO DFHEIV0(25:11)
 16731     CALL 'kxdfhei1' USING DFHEIV0,
 16732           PI-KEY,
 16733           PROGRAM-INTERFACE-BLOCK,
 16734           PI-COMM-LENGTH,
 16735           DFHEIV99,
 16736           DFHEIV99,
 16737           DFHEIV99
 16738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16739
 16740
 16741     MOVE XCTL-EL141             TO CALL-PGM.
 16742     GO TO 9200-XCTL.
 16743
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 315
* EL131.cbl
 16744 8700-CERT-MNT.
 16745     IF PI-RETURN-CD-1 = 'X'
 16746         MOVE ER-7690            TO EMI-ERROR
 16747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16748         MOVE -1                 TO MAINTL
 16749         GO TO 8110-SEND-DATA.
 16750
 16751
 16752* EXEC CICS WRITEQ TS
 16753*         QUEUE     (PI-KEY)
 16754*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16755*         LENGTH    (PI-COMM-LENGTH)
 16756*    END-EXEC.
 16757*    MOVE '*"                    ''   #00014026' TO DFHEIV0
 16758     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16760     MOVE X'2020233030303134303236' TO DFHEIV0(25:11)
 16761     CALL 'kxdfhei1' USING DFHEIV0,
 16762           PI-KEY,
 16763           PROGRAM-INTERFACE-BLOCK,
 16764           PI-COMM-LENGTH,
 16765           DFHEIV99,
 16766           DFHEIV99,
 16767           DFHEIV99
 16768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16769
 16770
 16771     MOVE XCTL-EL1273            TO CALL-PGM.
 16772     GO TO 9200-XCTL.
 16773
 16774 8725-BENEFICIARY-MNT.
 16775     IF PI-RETURN-CD-1 = 'X'
 16776         MOVE ER-0311            TO EMI-ERROR
 16777         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16778         MOVE -1                 TO MAINTL
 16779         GO TO 8110-SEND-DATA.
 16780
 16781
 16782* EXEC CICS WRITEQ TS
 16783*         QUEUE     (PI-KEY)
 16784*         FROM      (EL131AI)
 16785*         LENGTH    (MAP-LENGTH)
 16786*    END-EXEC.
 16787*    MOVE '*"                    ''   #00014042' TO DFHEIV0
 16788     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16790     MOVE X'2020233030303134303432' TO DFHEIV0(25:11)
 16791     CALL 'kxdfhei1' USING DFHEIV0,
 16792           PI-KEY,
 16793           EL131AI,
 16794           MAP-LENGTH,
 16795           DFHEIV99,
 16796           DFHEIV99,
 16797           DFHEIV99
 16798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16799
 16800
 16801
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 316
* EL131.cbl
 16802* EXEC CICS WRITEQ TS
 16803*         QUEUE     (PI-KEY)
 16804*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16805*         LENGTH    (PI-COMM-LENGTH)
 16806*    END-EXEC.
 16807*    MOVE '*"                    ''   #00014048' TO DFHEIV0
 16808     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16809     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16810     MOVE X'2020233030303134303438' TO DFHEIV0(25:11)
 16811     CALL 'kxdfhei1' USING DFHEIV0,
 16812           PI-KEY,
 16813           PROGRAM-INTERFACE-BLOCK,
 16814           PI-COMM-LENGTH,
 16815           DFHEIV99,
 16816           DFHEIV99,
 16817           DFHEIV99
 16818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16819
 16820
 16821     MOVE XCTL-EL114             TO CALL-PGM.
 16822     GO TO 9200-XCTL.
 16823
 16824 8750-DMD-CLM-FIX.
 16825
 16826* EXEC CICS WRITEQ TS
 16827*         QUEUE     (PI-KEY)
 16828*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16829*         LENGTH    (PI-COMM-LENGTH)
 16830*    END-EXEC.
 16831*    MOVE '*"                    ''   #00014058' TO DFHEIV0
 16832     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16833     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16834     MOVE X'2020233030303134303538' TO DFHEIV0(25:11)
 16835     CALL 'kxdfhei1' USING DFHEIV0,
 16836           PI-KEY,
 16837           PROGRAM-INTERFACE-BLOCK,
 16838           PI-COMM-LENGTH,
 16839           DFHEIV99,
 16840           DFHEIV99,
 16841           DFHEIV99
 16842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16843
 16844
 16845     MOVE XCTL-EL400DMD          TO CALL-PGM.
 16846     GO TO 9200-XCTL.
 16847
 16848 8800-UNAUTHORIZED-ACCESS.
 16849     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16850     GO TO 8990-SEND-TEXT.
 16851
 16852 8810-PF23-ENTERED.
 16853     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 16854     MOVE XCTL-EL005             TO CALL-PGM.
 16855     GO TO 9200-XCTL.
 16856
 16857 8820-XCTL-ERROR.
 16858
 16859* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 317
* EL131.cbl
 16860*        PGMIDERR (8990-SEND-TEXT)
 16861*    END-EXEC.
 16862*    MOVE '"$L                   ! H #00014077' TO DFHEIV0
 16863     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16865     MOVE X'4820233030303134303737' TO DFHEIV0(25:11)
 16866     CALL 'kxdfhei1' USING DFHEIV0
 16867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16868
 16869
 16870     MOVE SPACE                 TO PI-ENTRY-CD-1.
 16871     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 16872     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 16873     MOVE XCTL-EL005            TO CALL-PGM.
 16874     GO TO 9200-XCTL.
 16875
 16876 8990-SEND-TEXT.
 16877
 16878* EXEC CICS SEND TEXT
 16879*         FROM      (LOGOFF-TEXT)
 16880*         LENGTH    (LOGOFF-LENGTH)
 16881*         ERASE
 16882*         FREEKB
 16883*    END-EXEC.
 16884*    MOVE '8&      T  E F  H   F -   #00014088' TO DFHEIV0
 16885     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16886     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16887     MOVE X'2020233030303134303838' TO DFHEIV0(25:11)
 16888     CALL 'kxdfhei1' USING DFHEIV0,
 16889           LOGOFF-TEXT,
 16890           LOGOFF-LENGTH,
 16891           DFHEIV99,
 16892           DFHEIV99,
 16893           DFHEIV99,
 16894           DFHEIV99,
 16895           DFHEIV99,
 16896           DFHEIV99,
 16897           DFHEIV99,
 16898           DFHEIV99,
 16899           DFHEIV99,
 16900           DFHEIV99
 16901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16902
 16903
 16904     GO TO 9100-RETURN-CICS.
 16905
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 318
* EL131.cbl
 16907 9000-RETURN-TRANS.
 16908
 16909* EXEC CICS RETURN
 16910*         TRANSID   (TRANS-ID)
 16911*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16912*         LENGTH    (PI-COMM-LENGTH)
 16913*    END-EXEC.
 16914*    MOVE '.(CT                  ''   #00014099' TO DFHEIV0
 16915     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16916     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16917     MOVE X'2020233030303134303939' TO DFHEIV0(25:11)
 16918     CALL 'kxdfhei1' USING DFHEIV0,
 16919           TRANS-ID,
 16920           PROGRAM-INTERFACE-BLOCK,
 16921           PI-COMM-LENGTH,
 16922           DFHEIV99,
 16923           DFHEIV99,
 16924           DFHEIV99
 16925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16926
 16927
 16928
 16929* GOBACK.
 16930     MOVE '9%                    "   ' TO DFHEIV0
 16931     MOVE 'EL131' TO DFHEIV1
 16932     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16933     GOBACK.
 16934
 16935 9100-RETURN-CICS.
 16936
 16937* EXEC CICS RETURN
 16938*    END-EXEC.
 16939*    MOVE '.(                    ''   #00014108' TO DFHEIV0
 16940     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16941     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16942     MOVE X'2020233030303134313038' TO DFHEIV0(25:11)
 16943     CALL 'kxdfhei1' USING DFHEIV0,
 16944           DFHEIV99,
 16945           DFHEIV99,
 16946           DFHEIV99,
 16947           DFHEIV99,
 16948           DFHEIV99,
 16949           DFHEIV99
 16950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16951
 16952
 16953
 16954* GOBACK.
 16955     MOVE '9%                    "   ' TO DFHEIV0
 16956     MOVE 'EL131' TO DFHEIV1
 16957     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16958     GOBACK.
 16959
 16960 9200-XCTL.
 16961
 16962* EXEC CICS XCTL
 16963*         PROGRAM    (CALL-PGM)
 16964*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 319
* EL131.cbl
 16965*         LENGTH     (PI-COMM-LENGTH)
 16966*    END-EXEC.
 16967*    MOVE '.$C                   %   #00014114' TO DFHEIV0
 16968     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16969     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16970     MOVE X'2020233030303134313134' TO DFHEIV0(25:11)
 16971     CALL 'kxdfhei1' USING DFHEIV0,
 16972           CALL-PGM,
 16973           PROGRAM-INTERFACE-BLOCK,
 16974           PI-COMM-LENGTH,
 16975           DFHEIV99
 16976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16977
 16978
 16979 9700-LINK-RTRM-FILE-ID.
 16980
 16981* EXEC CICS LINK
 16982*        PROGRAM  (RTRM-FILE-ID)
 16983*        COMMAREA (CALCULATION-PASS-AREA)
 16984*        LENGTH   (CP-COMM-LENGTH)
 16985*    END-EXEC.
 16986*    MOVE '."C                   (   #00014121' TO DFHEIV0
 16987     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16989     MOVE X'2020233030303134313231' TO DFHEIV0(25:11)
 16990     CALL 'kxdfhei1' USING DFHEIV0,
 16991           RTRM-FILE-ID,
 16992           CALCULATION-PASS-AREA,
 16993           CP-COMM-LENGTH,
 16994           DFHEIV99,
 16995           DFHEIV99,
 16996           DFHEIV99,
 16997           DFHEIV99
 16998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16999
 17000
 17001 9700-EXIT.
 17002      EXIT.
 17003
 17004 9800-CONVERT-DATE.
 17005     MOVE SPACES TO DC-ERROR-CODE.
 17006
 17007* EXEC CICS LINK
 17008*         PROGRAM    (DATE-CONV)
 17009*         COMMAREA   (DATE-CONVERSION-DATA)
 17010*         LENGTH     (DC-COMM-LENGTH)
 17011*    END-EXEC.
 17012*    MOVE '."C                   (   #00014132' TO DFHEIV0
 17013     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17014     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17015     MOVE X'2020233030303134313332' TO DFHEIV0(25:11)
 17016     CALL 'kxdfhei1' USING DFHEIV0,
 17017           DATE-CONV,
 17018           DATE-CONVERSION-DATA,
 17019           DC-COMM-LENGTH,
 17020           DFHEIV99,
 17021           DFHEIV99,
 17022           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 320
* EL131.cbl
 17023           DFHEIV99
 17024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17025
 17026
 17027 9800-EXIT.
 17028     EXIT.
 17029
 17030 9900-ERROR-FORMAT.
 17031
 17032* EXEC CICS LINK
 17033*         PROGRAM    (XCTL-EL001)
 17034*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17035*         LENGTH     (EMI-COMM-LENGTH)
 17036*    END-EXEC.
 17037*    MOVE '."C                   (   #00014142' TO DFHEIV0
 17038     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17039     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17040     MOVE X'2020233030303134313432' TO DFHEIV0(25:11)
 17041     CALL 'kxdfhei1' USING DFHEIV0,
 17042           XCTL-EL001,
 17043           ERROR-MESSAGE-INTERFACE-BLOCK,
 17044           EMI-COMM-LENGTH,
 17045           DFHEIV99,
 17046           DFHEIV99,
 17047           DFHEIV99,
 17048           DFHEIV99
 17049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17050
 17051
 17052 9900-EXIT.
 17053     EXIT.
 17054
 17055 9990-ABEND.
 17056     MOVE DFHEIBLK               TO EMI-LINE1.
 17057
 17058* EXEC CICS LINK
 17059*         PROGRAM   (XCTL-EL004)
 17060*         COMMAREA  (EMI-LINE1)
 17061*         LENGTH    (72)
 17062*     END-EXEC.
 17063     MOVE 72
 17064       TO DFHEIV11
 17065*    MOVE '."C                   (   #00014153' TO DFHEIV0
 17066     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17067     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17068     MOVE X'2020233030303134313533' TO DFHEIV0(25:11)
 17069     CALL 'kxdfhei1' USING DFHEIV0,
 17070           XCTL-EL004,
 17071           EMI-LINE1,
 17072           DFHEIV11,
 17073           DFHEIV99,
 17074           DFHEIV99,
 17075           DFHEIV99,
 17076           DFHEIV99
 17077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17078
 17079
 17080     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 321
* EL131.cbl
 17081
 17082     GO TO 8110-SEND-DATA.
 17083
 17084 9995-SECURITY-VIOLATION.
 17085*           COPY ELCSCTP.
 17086******************************************************************
 17087*                                                                *
 17088*                            ELCSCTP                             *
 17089*                            VMOD=2.001                          *
 17090*                                                                *
 17091*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17092******************************************************************
 17093
 17094
 17095     MOVE EIBDATE          TO SM-JUL-DATE.
 17096     MOVE EIBTRMID         TO SM-TERMID.
 17097     MOVE THIS-PGM         TO SM-PGM.
 17098     MOVE EIBTIME          TO TIME-IN.
 17099     MOVE TIME-OUT         TO SM-TIME.
 17100     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17101
 17102
 17103* EXEC CICS LINK
 17104*         PROGRAM  ('EL003')
 17105*         COMMAREA (SECURITY-MESSAGE)
 17106*         LENGTH   (80)
 17107*    END-EXEC.
 17108     MOVE 'EL003' TO DFHEIV1
 17109     MOVE 80
 17110       TO DFHEIV11
 17111*    MOVE '."C                   (   #00014181' TO DFHEIV0
 17112     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17114     MOVE X'2020233030303134313831' TO DFHEIV0(25:11)
 17115     CALL 'kxdfhei1' USING DFHEIV0,
 17116           DFHEIV1,
 17117           SECURITY-MESSAGE,
 17118           DFHEIV11,
 17119           DFHEIV99,
 17120           DFHEIV99,
 17121           DFHEIV99,
 17122           DFHEIV99
 17123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17124
 17125
 17126******************************************************************
 17127
 17128
 17129
 17130 9999-DFHBACK SECTION.
 17131     MOVE '9%                    "   ' TO DFHEIV0
 17132     MOVE 'EL131' TO DFHEIV1
 17133     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17134     GOBACK.
 17135 9999-DFHEXIT.
 17136     IF DFHEIGDJ EQUAL 0001
 17137         NEXT SENTENCE
 17138     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 322
* EL131.cbl
 17139         GO TO 8820-XCTL-ERROR,
 17140               8150-ENTERED-CLAIM-NOTFOUND,
 17141               9990-ABEND
 17142         DEPENDING ON DFHEIGDI
 17143     ELSE IF DFHEIGDJ EQUAL 3
 17144         GO TO 0130-TS-ERROR,
 17145               0130-TS-ERROR
 17146         DEPENDING ON DFHEIGDI
 17147     ELSE IF DFHEIGDJ EQUAL 4
 17148         GO TO 0600-CONTINUE-NAME-UPDATE
 17149         DEPENDING ON DFHEIGDI
 17150     ELSE IF DFHEIGDJ EQUAL 5
 17151         GO TO 1004-BENE-NOT-FOUND
 17152         DEPENDING ON DFHEIGDI
 17153     ELSE IF DFHEIGDJ EQUAL 6
 17154         GO TO 1120-CNTL-NOTFND
 17155         DEPENDING ON DFHEIGDI
 17156     ELSE IF DFHEIGDJ EQUAL 7
 17157         GO TO 1150-NOTOPEN-ERROR,
 17158               1150-EXIT
 17159         DEPENDING ON DFHEIGDI
 17160     ELSE IF DFHEIGDJ EQUAL 8
 17161         GO TO 1490-STATE-NOTFND
 17162         DEPENDING ON DFHEIGDI
 17163     ELSE IF DFHEIGDJ EQUAL 9
 17164         GO TO 1500-CARR-NOTFND
 17165         DEPENDING ON DFHEIGDI
 17166     ELSE IF DFHEIGDJ EQUAL 10
 17167         GO TO 1620-ACCT-NOTFND
 17168         DEPENDING ON DFHEIGDI
 17169     ELSE IF DFHEIGDJ EQUAL 11
 17170         GO TO 2020-EXIT
 17171         DEPENDING ON DFHEIGDI
 17172     ELSE IF DFHEIGDJ EQUAL 12
 17173         GO TO 2030-EXIT
 17174         DEPENDING ON DFHEIGDI
 17175     ELSE IF DFHEIGDJ EQUAL 13
 17176         GO TO 2040-EXIT
 17177         DEPENDING ON DFHEIGDI
 17178     ELSE IF DFHEIGDJ EQUAL 14
 17179         GO TO 2050-EXIT
 17180         DEPENDING ON DFHEIGDI
 17181     ELSE IF DFHEIGDJ EQUAL 15
 17182         GO TO 2060-CERT-NOTFND
 17183         DEPENDING ON DFHEIGDI
 17184     ELSE IF DFHEIGDJ EQUAL 16
 17185         GO TO 2060-DUPKEY
 17186         DEPENDING ON DFHEIGDI
 17187     ELSE IF DFHEIGDJ EQUAL 17
 17188         GO TO 2070-NOT-FOUND
 17189         DEPENDING ON DFHEIGDI
 17190     ELSE IF DFHEIGDJ EQUAL 18
 17191         GO TO 2070-EXIT
 17192         DEPENDING ON DFHEIGDI
 17193     ELSE IF DFHEIGDJ EQUAL 19
 17194         GO TO 2080-EXIT
 17195         DEPENDING ON DFHEIGDI
 17196     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 323
* EL131.cbl
 17197         GO TO 2400-TRLR-NOTFND,
 17198               2410-EXIT
 17199         DEPENDING ON DFHEIGDI
 17200     ELSE IF DFHEIGDJ EQUAL 21
 17201         GO TO 2425-NINETY-NOTFND,
 17202               2425-NINETY-NOTFND
 17203         DEPENDING ON DFHEIGDI
 17204     ELSE IF DFHEIGDJ EQUAL 22
 17205         GO TO 2430-EXIT,
 17206               2440-EXIT
 17207         DEPENDING ON DFHEIGDI
 17208     ELSE IF DFHEIGDJ EQUAL 23
 17209         GO TO 2440-EXIT
 17210         DEPENDING ON DFHEIGDI
 17211     ELSE IF DFHEIGDJ EQUAL 24
 17212         GO TO 2460-EXIT
 17213         DEPENDING ON DFHEIGDI
 17214     ELSE IF DFHEIGDJ EQUAL 25
 17215         GO TO 2475-EXIT
 17216         DEPENDING ON DFHEIGDI
 17217     ELSE IF DFHEIGDJ EQUAL 26
 17218         GO TO 2650-EXIT
 17219         DEPENDING ON DFHEIGDI
 17220     ELSE IF DFHEIGDJ EQUAL 27
 17221         GO TO 2800-EXIT,
 17222               2800-EXIT
 17223         DEPENDING ON DFHEIGDI
 17224     ELSE IF DFHEIGDJ EQUAL 28
 17225         GO TO 3010-DEL-ACTQ,
 17226               3040-EXIT
 17227         DEPENDING ON DFHEIGDI
 17228     ELSE IF DFHEIGDJ EQUAL 29
 17229         GO TO 3010-NO-ACTIVITY,
 17230               3050-EXIT
 17231         DEPENDING ON DFHEIGDI
 17232     ELSE IF DFHEIGDJ EQUAL 30
 17233         GO TO 3010-CERT-NOT-FOUND
 17234         DEPENDING ON DFHEIGDI
 17235     ELSE IF DFHEIGDJ EQUAL 31
 17236         GO TO 3020-EXIT
 17237         DEPENDING ON DFHEIGDI
 17238     ELSE IF DFHEIGDJ EQUAL 32
 17239         GO TO 3060-EXIT,
 17240               3060-EXIT
 17241         DEPENDING ON DFHEIGDI
 17242     ELSE IF DFHEIGDJ EQUAL 33
 17243         GO TO 5000-TRLR-NOT-FOUND
 17244         DEPENDING ON DFHEIGDI
 17245     ELSE IF DFHEIGDJ EQUAL 34
 17246         GO TO 5000-CERT-NOT-FOUND
 17247         DEPENDING ON DFHEIGDI
 17248     ELSE IF DFHEIGDJ EQUAL 35
 17249         GO TO 7630-END-BROWSE
 17250         DEPENDING ON DFHEIGDI
 17251     ELSE IF DFHEIGDJ EQUAL 36
 17252         GO TO 7799-EXIT,
 17253               7799-EXIT
 17254         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 12-Sep-14 12:52 Page 324
* EL131.cbl
 17255     ELSE IF DFHEIGDJ EQUAL 37
 17256         GO TO 7799-EXIT
 17257         DEPENDING ON DFHEIGDI
 17258     ELSE IF DFHEIGDJ EQUAL 38
 17259         GO TO 7800-NOT-FOUND
 17260         DEPENDING ON DFHEIGDI
 17261     ELSE IF DFHEIGDJ EQUAL 39
 17262         GO TO 8000-NOTE-NOT-FOUND
 17263         DEPENDING ON DFHEIGDI
 17264     ELSE IF DFHEIGDJ EQUAL 40
 17265         GO TO 8990-SEND-TEXT
 17266         DEPENDING ON DFHEIGDI.
 17267     MOVE '9%                    "   ' TO DFHEIV0
 17268     MOVE 'EL131' TO DFHEIV1
 17269     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17270     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13572     Code:       59733
