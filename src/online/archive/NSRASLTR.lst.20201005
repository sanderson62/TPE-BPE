* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page   1
* NSRASLTR.cbl
* Options: int("NSRASLTR.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASLTR.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASLTR.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRASLTR.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASLTR.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM INDEX.HTML
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page   2
* NSRASLTR.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 080612    2011022800001  AJRA  ADD AHL
    16* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    17* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    18******************************************************************
    19 ENVIRONMENT DIVISION.
    20 DATA DIVISION.
    21 working-storage section.
    22 01  DFH-START PIC X(04).
    23 77  ws-comm-length      pic 9(4) BINARY.
    24 01  P pointer.
    25 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    26 01  WS-KIXHOST                  PIC X(10).
    27 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    28 01  var-ptr pointer.
    29 01  env-var-len                 pic 9(4)  binary.
    30 01  rc                          pic 9(9)  binary.
    31 01  bl-length                   pic s9(5) value +0 comp-3.
    32 01  sl-length                   pic 9(8) binary.
    33 01  WS-KIXSYS.
    34     05  WS-KIX-FIL1             PIC X(10).
    35     05  WS-KIX-APPS             PIC X(10).
    36     05  WS-KIX-ENV              PIC X(10).
    37     05  WS-KIX-MYENV            PIC X(10).
    38     05  WS-KIX-SYS              PIC X(10).
    39************************************************
    40* commarea passed to the business logic
    41************************************************
    42 01 srch-commarea.
    43*                                copy ELCADLTRSPI.
    44******************************************************************
    45*                   C H A N G E   L O G
    46*
    47* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    48*-----------------------------------------------------------------
    49*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    50* EFFECTIVE    NUMBER
    51*-----------------------------------------------------------------
    52* 060611    2011022800001  PEMA  NEW COPYBOOK
    53* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
    54* 110612    2012101700002  AJRA  EXPAND PASSED DATA
    55******************************************************************
    56****************************************
    57*  commarea for NaperSoft On Demand Admin services letters
    58*  (business logic input & output)
    59****************************************
    60     03  BL-INPUT.
    61         05  BL-DATA-SRCE        PIC X.
    62         05  BL-LETTER-ID        PIC XXXX.
    63         05  BL-CARRIER          PIC X.
    64         05  BL-GROUP            PIC X(6).
    65         05  BL-STATE            PIC XX.
    66         05  BL-ACCOUNT          PIC X(10).
    67         05  BL-EFF-DT           PIC X(10).
    68         05  BL-CERT-NO          PIC X(11).
    69         05  BL-BATCH-NO         PIC X(6).
    70         05  BL-BATCH-SEQ        PIC 9(8).
    71         05  BL-RESP-NO          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page   3
* NSRASLTR.cbl
    72         05  BL-NO-OF-COPIES     PIC 99.
    73         05  BL-PROC-ID          PIC XXXX.
    74         05  BL-COMP-ID          PIC XXX.
    75         05  BL-PRINT-NOW-SW     PIC X.
    76         05  BL-ENC-CD           PIC XXX.
    77         05  BL-RESEND-DT        PIC X(10).
    78         05  BL-FOLLOW-UP-DT     PIC X(10).
    79         05  BL-ARCHIVE-NO       PIC 9(8).
    80         05  BL-FUNC             PIC X(8).
    81         05  BL-COMMENTS         PIC X(100).
    82         05  FILLER REDEFINES BL-COMMENTS.
    83             10  BL-REASON-CODE OCCURS 12 PIC X(4).
    84             10  BL-LETTER-TO-ACCT PIC X.
    85             10  BL-LETTER-TO-BENE PIC X.
    86             10  BL-WRITE-ERARCH   PIC X.
    87                 88  ERARCH-QWS      VALUE 'Q'.
    88                 88  ERARCH-BATCH    VALUE 'B'.
    89                 88  ERARCH-TEMP     VALUE 'T'.
    90             10  BL-PROCESS-TYPE PIC X(07).
    91             10  BL-CERT-FORM-ID PIC X(05).
    92             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
    93             10  BL-SOURCE-SCREEN PIC X(8).
    94             10  FILLER          PIC X(25).
    95     03  BL-OUTPUT.
    96         05  BL-STATUS                   PIC X.
    97             88  BL-OK                      VALUE "P".
    98             88  BL-FAIL                  VALUE "F".
    99         05  BL-MESSAGE          PIC X(50).
   100     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   101     03  FILLER                  PIC X(31).
   102 01  INPUT-FROM-FORM.
   103     05  IFF-DATA-SRCE           PIC X.
   104     05  IFF-LETTER-ID           PIC XXXX.
   105     05  IFF-CARRIER             PIC X.
   106     05  IFF-GROUP               PIC X(6).
   107     05  IFF-STATE               PIC XX.
   108     05  IFF-ACCOUNT             PIC X(10).
   109     05  IFF-EFF-DT              PIC X(10).
   110     05  IFF-CERT-NO             PIC X(11).
   111     05  IFF-BATCH-NO            PIC X(6).
   112     05  IFF-BATCH-SEQ           PIC 9(8).
   113     05  IFF-RESP-NO             PIC X(10).
   114     05  IFF-NO-OF-COPIES        PIC 99.
   115     05  IFF-PROC-ID             PIC XXXX.
   116     05  IFF-COMP-ID             PIC XXX.
   117     05  IFF-PRINT-NOW-SW        PIC X.
   118     05  IFF-ENC-CD              PIC XXX.
   119     05  IFF-RESEND-DT           PIC X(10).
   120     05  IFF-FOLLOW-UP-DT        PIC X(10).
   121     05  IFF-ARCHIVE-NO          PIC 9(08).
   122     05  IFF-FUNC                PIC X(08).
   123*    05  IFF-COMMENTS            PIC X(70).
   124     05  IFF-ENDT-ARCH-NO        PIC 9(08).
   125************************************
   126* fields used to read web data
   127************************************
   128 01  w-form-name       pic x(80).
   129 01  w-form-value      pic x(80).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page   4
* NSRASLTR.cbl
   130 01  w-form-name-len   pic s9(8) comp.
   131 01  w-form-value-len  pic s9(8) comp.
   132 01  w-resp            pic s9(8) comp.
   133 01  w-doctoken        pic x(16).
   134* COMP ID TPE REGION   GROUP NAME       HOST          HTTP PORT
   135*
   136*  CID      CID1P      AcctServCID     ntcso3            7001
   137*  CID      MDOFF      AcctServCID     ntnapersofttst    7003
   138*  CID      CID1T      AcctServCID     ntnapersofttst    6002
   139*  CID      PAUL       AcctServCID     ntnapersofttst    5002
   140*  CID      TONY       AcctServCID     ntnapersofttst    6003
   141*  DCC      CID1P      AcctServDCC     ntcso3            7001
   142*  DCC      MDOFF      AcctServDCC     ntnapersofttst    7003
   143*  DCC      CID1T      AcctServDCC     ntnapersofttst    6002
   144*  DCC      PAUL       AcctServDCC     ntnapersofttst    5002
   145*  DCC      TONY       AcctServDCC     ntnapersofttst    6003
   146*  AHL      CID1P      AcctServAHL     ntcso3            7001
   147*  AHL      MDOFF      AcctServAHL     ntnapersofttst    7003
   148*  AHL      CID1T      AcctServAHL     ntnapersofttst    6002
   149*  AHL      PAUL       AcctServAHL     ntnapersofttst    5002
   150*  AHL      TONY       AcctServAHL     ntnapersofttst    6003
   151******************************************
   152* symbol list text for ASERR template
   153******************************************
   154 01  WS-ASERR.
   155     05  F                       PIC X(6)  VALUE "PGMDT=".
   156     05  ASERR-DT                PIC X(12) VALUE ' '.
   157     05  F                       PIC X(5)  VALUE '&MSG='.
   158     05  ASERR-MESS              PIC X(50) VALUE ' '.
   159******************************************
   160* symbol list text for ASHDR template
   161******************************************
   162 01  WS-PROD-CID-ASHDR.
   163     05  F                       PIC X(7)  VALUE "SERVER=".
   164     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   165     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   166     05  F                       PIC X(11) VALUE 'AcctServCID'.
   167     05  F                       PIC X(7)  VALUE '&UNAME='.
   168     05  F                       PIC X(8)  VALUE 'batchjob'.
   169     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   170     05  F                       PIC X(8)  VALUE 'batchjob'.
   171 01  WS-PROD-DCC-ASHDR.
   172     05  F                       PIC X(7)  VALUE "SERVER=".
   173     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   174     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   175     05  F                       PIC X(11) VALUE 'AcctServDCC'.
   176     05  F                       PIC X(7)  VALUE '&UNAME='.
   177     05  F                       PIC X(8)  VALUE 'batchjob'.
   178     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   179     05  F                       PIC X(8)  VALUE 'batchjob'.
   180 01  WS-PROD-VPP-ASHDR.
   181     05  F                       PIC X(7)  VALUE "SERVER=".
   182     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   183     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   184     05  F                       PIC X(11) VALUE 'AcctServVPP'.
   185     05  F                       PIC X(7)  VALUE '&UNAME='.
   186     05  F                       PIC X(8)  VALUE 'batchjob'.
   187     05  F                       PIC X(11) VALUE '&UPASSWORD='.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page   5
* NSRASLTR.cbl
   188     05  F                       PIC X(8)  VALUE 'batchjob'.
   189 01  WS-PROD-AHL-ASHDR.
   190     05  F                       PIC X(7)  VALUE "SERVER=".
   191     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   192     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   193     05  F                       PIC X(11) VALUE 'AcctServAHL'.
   194     05  F                       PIC X(7)  VALUE '&UNAME='.
   195     05  F                       PIC X(8)  VALUE 'batchjob'.
   196     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   197     05  F                       PIC X(8)  VALUE 'batchjob'.
   198 01  WS-TEST-CID-ASHDR.
   199     05  F                       PIC X(7)  VALUE "SERVER=".
   200     05  F                       PIC X(19) VALUE
   201                          'ntnapersofttst:8080'.
   202     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   203     05  F                       PIC X(11) VALUE 'AcctServCID'.
   204     05  F                       PIC X(7)  VALUE '&UNAME='.
   205     05  F                       PIC X(8)  VALUE 'batchjob'.
   206     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   207     05  F                       PIC X(8)  VALUE 'batchjob'.
   208 01  WS-TEST-DCC-ASHDR.
   209     05  F                       PIC X(7)  VALUE "SERVER=".
   210     05  F                       PIC X(19) VALUE
   211                            'ntnapersofttst:8080'.
   212     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   213     05  F                       PIC X(11) VALUE 'AcctServDCC'.
   214     05  F                       PIC X(7)  VALUE '&UNAME='.
   215     05  F                       PIC X(8)  VALUE 'batchjob'.
   216     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   217     05  F                       PIC X(8)  VALUE 'batchjob'.
   218
   219 01  WS-TEST-VPP-ASHDR.
   220     05  F                       PIC X(7)  VALUE "SERVER=".
   221     05  F                       PIC X(19) VALUE
   222                            'ntnapersofttst:8080'.
   223     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   224     05  F                       PIC X(11) VALUE 'AcctServVPP'.
   225     05  F                       PIC X(7)  VALUE '&UNAME='.
   226     05  F                       PIC X(8)  VALUE 'batchjob'.
   227     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   228     05  F                       PIC X(8)  VALUE 'batchjob'.
   229
   230 01  WS-TEST-AHL-ASHDR.
   231     05  F                       PIC X(7)  VALUE "SERVER=".
   232     05  F                       PIC X(19) VALUE
   233                            'ntnapersofttst:8080'.
   234     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   235     05  F                       PIC X(11) VALUE 'AcctServAHL'.
   236     05  F                       PIC X(7)  VALUE '&UNAME='.
   237     05  F                       PIC X(8)  VALUE 'batchjob'.
   238     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   239     05  F                       PIC X(8)  VALUE 'batchjob'.
   240******************************************
   241* symbol list text for ASFTR template
   242******************************************
   243 01  WS-VAR-SLUNIKIX.
   244     05  FILLER                  PIC X(18) VALUE
   245                                 "HOSTINFO=slunikix:".
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page   6
* NSRASLTR.cbl
   246     05  WS-SL-PORT              PIC XXXX  VALUE '7001'.
   247     05  FILLER                  PIC X(11)  VALUE "&URLVARLST=".
   248     05  WS-SL-KEY               PIC X(20)  VALUE SPACES.
   249*    05  FILLER                  PIC X(20) VALUE
   250*                                "&HOSTINFO2=slunikix:".
   251*    05  WS-SL-PORT2             PIC XXXX  VALUE '7001'.
   252*    05  FILLER                  PIC X(12)  VALUE "&URLVARLST2=".
   253*    05  WS-SL-KEY2              PIC X(12)  VALUE SPACES.
   254 01  WS-VAR-LOGICTEST.
   255     05  FILLER                  PIC X(19) VALUE
   256                                 "HOSTINFO=logictest:".
   257     05  WS-LT-PORT              PIC XXXX  VALUE '6002'.
   258     05  FILLER                  PIC X(11)  VALUE "&URLVARLST=".
   259     05  WS-LT-KEY               PIC X(20)  VALUE SPACES.
   260*    05  FILLER                  PIC X(21) VALUE
   261*                                "&HOSTINFO2=logictest:".
   262*    05  WS-LT-PORT2             PIC XXXX  VALUE '6002'.
   263*    05  FILLER                  PIC X(12)  VALUE "&URLVARLST2=".
   264*    05  WS-LT-KEY2              PIC X(12)  VALUE SPACES.
   265 01 WS-ASFTR.
   266    05  OT-COMP-ID           PIC XXX.
   267    05  OT-PRINT-NOW-SW      PIC X.
   268    05  OT-ARCHIVE-NO        PIC 9(08).
   269    05  OT-FUNC              PIC X(08).
   270 01 output-msg.
   271    05 filler              pic x(4) value "MSG=".
   272    05 out-msg-text        pic x(50).
   273 01  MISC.
   274     12  WS-RESPONSE             PIC S9(8)   COMP.
   275         88  RESP-NORMAL                  VALUE +00.
   276         88  RESP-NOTFND                  VALUE +13.
   277         88  RESP-DUPREC                  VALUE +14.
   278         88  RESP-DUPKEY                  VALUE +15.
   279         88  RESP-NOTOPEN                 VALUE +19.
   280         88  RESP-ENDFILE                 VALUE +20.
   281*                                COPY ELCDATE.
   282******************************************************************
   283*                                                                *
   284*                                                                *
   285*                            ELCDATE.                            *
   286*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   287*                            VMOD=2.003
   288*                                                                *
   289*                                                                *
   290*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   291*                 LENGTH = 200                                   *
   292******************************************************************
   293
   294 01  DATE-CONVERSION-DATA.
   295     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   296     12  DC-OPTION-CODE                PIC X.
   297         88  BIN-TO-GREG                VALUE ' '.
   298         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   299         88  EDIT-GREG-TO-BIN           VALUE '2'.
   300         88  YMD-GREG-TO-BIN            VALUE '3'.
   301         88  MDY-GREG-TO-BIN            VALUE '4'.
   302         88  JULIAN-TO-BIN              VALUE '5'.
   303         88  BIN-PLUS-ELAPSED           VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page   7
* NSRASLTR.cbl
   304         88  FIND-CENTURY               VALUE '7'.
   305         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   306         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   307         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   308         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   309         88  JULIAN-TO-BIN-3            VALUE 'C'.
   310         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   311         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   312         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   313         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   314         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   315         88  CHECK-LEAP-YEAR            VALUE 'H'.
   316         88  BIN-3-TO-GREG              VALUE 'I'.
   317         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   318         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   319         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   320         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   321         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   322         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   323         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   324         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   325         88  THREE-CHARACTER-BIN
   326                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   327         88  GREGORIAN-TO-BIN
   328                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   329         88  BIN-TO-GREGORIAN
   330                  VALUES ' ' '1' 'I' '8' 'G'.
   331         88  JULIAN-TO-BINARY
   332                  VALUES '5' 'C' 'E' 'F'.
   333     12  DC-ERROR-CODE                 PIC X.
   334         88  NO-CONVERSION-ERROR        VALUE ' '.
   335         88  DATE-CONVERSION-ERROR
   336                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   337         88  DATE-IS-ZERO               VALUE '1'.
   338         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   339         88  DATE-IS-INVALID            VALUE '3'.
   340         88  DATE1-GREATER-DATE2        VALUE '4'.
   341         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   342         88  DATE-INVALID-OPTION        VALUE '9'.
   343         88  INVALID-CENTURY            VALUE 'A'.
   344         88  ONLY-CENTURY               VALUE 'B'.
   345         88  ONLY-LEAP-YEAR             VALUE 'C'.
   346         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   347     12  DC-END-OF-MONTH               PIC X.
   348         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   349     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   350         88  USE-NORMAL-PROCESS         VALUE ' '.
   351         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   352         88  ADJUST-UP-100-YRS          VALUE '2'.
   353     12  FILLER                        PIC X.
   354     12  DC-CONVERSION-DATES.
   355         16  DC-BIN-DATE-1             PIC XX.
   356         16  DC-BIN-DATE-2             PIC XX.
   357         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   358         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   359                       DC-GREG-DATE-1-EDIT.
   360             20  DC-EDIT1-MONTH        PIC 99.
   361             20  SLASH1-1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page   8
* NSRASLTR.cbl
   362             20  DC-EDIT1-DAY          PIC 99.
   363             20  SLASH1-2              PIC X.
   364             20  DC-EDIT1-YEAR         PIC 99.
   365         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   366         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   367                     DC-GREG-DATE-2-EDIT.
   368             20  DC-EDIT2-MONTH        PIC 99.
   369             20  SLASH2-1              PIC X.
   370             20  DC-EDIT2-DAY          PIC 99.
   371             20  SLASH2-2              PIC X.
   372             20  DC-EDIT2-YEAR         PIC 99.
   373         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   374         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   375                     DC-GREG-DATE-1-YMD.
   376             20  DC-YMD-YEAR           PIC 99.
   377             20  DC-YMD-MONTH          PIC 99.
   378             20  DC-YMD-DAY            PIC 99.
   379         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   380         16  DC-GREG-DATE-1-MDY-R REDEFINES
   381                      DC-GREG-DATE-1-MDY.
   382             20  DC-MDY-MONTH          PIC 99.
   383             20  DC-MDY-DAY            PIC 99.
   384             20  DC-MDY-YEAR           PIC 99.
   385         16  DC-GREG-DATE-1-ALPHA.
   386             20  DC-ALPHA-MONTH        PIC X(10).
   387             20  DC-ALPHA-DAY          PIC 99.
   388             20  FILLER                PIC XX.
   389             20  DC-ALPHA-CENTURY.
   390                 24 DC-ALPHA-CEN-N     PIC 99.
   391             20  DC-ALPHA-YEAR         PIC 99.
   392         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   393         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   394         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   395         16  DC-JULIAN-DATE            PIC 9(05).
   396         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   397                                       PIC 9(05).
   398         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   399             20  DC-JULIAN-YEAR        PIC 99.
   400             20  DC-JULIAN-DAYS        PIC 999.
   401         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   402         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   403         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   404     12  DATE-CONVERSION-VARIBLES.
   405         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   406         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   407             20  FILLER                PIC 9(3).
   408             20  HOLD-CEN-1-CCYY.
   409                 24  HOLD-CEN-1-CC     PIC 99.
   410                 24  HOLD-CEN-1-YY     PIC 99.
   411             20  HOLD-CEN-1-MO         PIC 99.
   412             20  HOLD-CEN-1-DA         PIC 99.
   413         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   414             20  HOLD-CEN-1-R-MO       PIC 99.
   415             20  HOLD-CEN-1-R-DA       PIC 99.
   416             20  HOLD-CEN-1-R-CCYY.
   417                 24  HOLD-CEN-1-R-CC   PIC 99.
   418                 24  HOLD-CEN-1-R-YY   PIC 99.
   419             20  FILLER                PIC 9(3).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page   9
* NSRASLTR.cbl
   420         16  HOLD-CENTURY-1-X.
   421             20  FILLER                PIC X(3)  VALUE SPACES.
   422             20  HOLD-CEN-1-X-CCYY.
   423                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   424                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   425             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   426             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   427         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   428             20  HOLD-CEN-1-R-X-MO     PIC XX.
   429             20  HOLD-CEN-1-R-X-DA     PIC XX.
   430             20  HOLD-CEN-1-R-X-CCYY.
   431                 24  HOLD-CEN-1-R-X-CC PIC XX.
   432                 24  HOLD-CEN-1-R-X-YY PIC XX.
   433             20  FILLER                PIC XXX.
   434         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   435         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   436         16  DC-JULIAN-DATE-1          PIC 9(07).
   437         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   438             20  DC-JULIAN-1-CCYY.
   439                 24  DC-JULIAN-1-CC    PIC 99.
   440                 24  DC-JULIAN-1-YR    PIC 99.
   441             20  DC-JULIAN-DA-1        PIC 999.
   442         16  DC-JULIAN-DATE-2          PIC 9(07).
   443         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   444             20  DC-JULIAN-2-CCYY.
   445                 24  DC-JULIAN-2-CC    PIC 99.
   446                 24  DC-JULIAN-2-YR    PIC 99.
   447             20  DC-JULIAN-DA-2        PIC 999.
   448         16  DC-GREG-DATE-A-EDIT.
   449             20  DC-EDITA-MONTH        PIC 99.
   450             20  SLASHA-1              PIC X VALUE '/'.
   451             20  DC-EDITA-DAY          PIC 99.
   452             20  SLASHA-2              PIC X VALUE '/'.
   453             20  DC-EDITA-CCYY.
   454                 24  DC-EDITA-CENT     PIC 99.
   455                 24  DC-EDITA-YEAR     PIC 99.
   456         16  DC-GREG-DATE-B-EDIT.
   457             20  DC-EDITB-MONTH        PIC 99.
   458             20  SLASHB-1              PIC X VALUE '/'.
   459             20  DC-EDITB-DAY          PIC 99.
   460             20  SLASHB-2              PIC X VALUE '/'.
   461             20  DC-EDITB-CCYY.
   462                 24  DC-EDITB-CENT     PIC 99.
   463                 24  DC-EDITB-YEAR     PIC 99.
   464         16  DC-GREG-DATE-CYMD         PIC 9(08).
   465         16  DC-GREG-DATE-CYMD-R REDEFINES
   466                              DC-GREG-DATE-CYMD.
   467             20  DC-CYMD-CEN           PIC 99.
   468             20  DC-CYMD-YEAR          PIC 99.
   469             20  DC-CYMD-MONTH         PIC 99.
   470             20  DC-CYMD-DAY           PIC 99.
   471         16  DC-GREG-DATE-MDCY         PIC 9(08).
   472         16  DC-GREG-DATE-MDCY-R REDEFINES
   473                              DC-GREG-DATE-MDCY.
   474             20  DC-MDCY-MONTH         PIC 99.
   475             20  DC-MDCY-DAY           PIC 99.
   476             20  DC-MDCY-CEN           PIC 99.
   477             20  DC-MDCY-YEAR          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  10
* NSRASLTR.cbl
   478    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   479        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   480    12  DC-EL310-DATE                  PIC X(21).
   481    12  FILLER                         PIC X(28).
   482*****************************************
   483* symbol list for the ASBOD template
   484*****************************************
   485*                                COPY NSCASVARS.
   486******************************************************************
   487*                   C H A N G E   L O G
   488*
   489*        CURRENT SIZE - 6180
   490*
   491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   492*-----------------------------------------------------------------
   493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   494* EFFECTIVE    NUMBER
   495*-----------------------------------------------------------------
   496* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
   497* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
   498* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
   499* 121015  CR2015100900001  TANA  ADD VIN NUMBER
   500******************************************************************
   501 01 NAPER-OUTPUT-DATA.
   502    05  F                       PIC X(07) VALUE "LETTER=".
   503    05  OUT-LETTER              PIC X(06) VALUE SPACES.
   504    05  F                       PIC X(08) VALUE "~PROCID=".
   505    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
   506    05  F                       PIC X(10) VALUE "~PROCNAME=".
   507    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
   508    05  F                       PIC X(11) VALUE "~PROCTITLE=".
   509    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
   510    05  F                       PIC X(09) VALUE "~CSRNAME=".
   511    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
   512    05  F                       PIC X(10) VALUE "~CSRTITLE=".
   513    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
   514    05  F                       PIC X(06) VALUE "~CARR=".
   515    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
   516    05  F                       PIC X(10) VALUE "~GROUPING=".
   517    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
   518    05  F                       PIC X(08) VALUE "~CERTST=".
   519    05  OUT-STATE               PIC X(02) VALUE SPACES.
   520    05  F                       PIC X(09) VALUE "~ACCOUNT=".
   521    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
   522    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
   523    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
   524    05  F                       PIC X(07) VALUE "~CRTNO=".
   525    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
   526    05  F                       PIC X(08) VALUE "~CRTSUF=".
   527    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
   528    05  F                       PIC X(08) VALUE "~ILNAME=".
   529    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
   530    05  F                       PIC X(08) VALUE "~IFNAME=".
   531    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
   532    05  F                       PIC X(08) VALUE "~IFINIT=".
   533    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
   534    05  F                       PIC X(08) VALUE "~IMINIT=".
   535    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  11
* NSRASLTR.cbl
   536    05  F                       PIC X(09) VALUE "~IISSAGE=".
   537    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
   538    05  F                       PIC X(06) VALUE "~ISEX=".
   539    05  OUT-ISEX                PIC X(01) VALUE SPACES.
   540    05  F                       PIC X(10) VALUE "~INSADDR1=".
   541    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
   542    05  F                       PIC X(10) VALUE "~INSADDR2=".
   543    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
   544    05  F                       PIC X(09) VALUE "~INSCITY=".
   545    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
   546    05  F                       PIC X(10) VALUE "~INSSTATE=".
   547    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
   548    05  F                       PIC X(08) VALUE "~INSZIP=".
   549    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
   550    05  F                       PIC X(05) VALUE "~SSN=".
   551    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
   552    05  F                       PIC X(07) VALUE "~MEMNO=".
   553    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
   554    05  F                       PIC X(08) VALUE "~JLNAME=".
   555    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
   556    05  F                       PIC X(08) VALUE "~JFNAME=".
   557    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
   558    05  F                       PIC X(08) VALUE "~JMINIT=".
   559    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
   560    05  F                       PIC X(08) VALUE "~JNTAGE=".
   561    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
   562    05  F                       PIC X(10) VALUE "~ACCTNAME=".
   563    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
   564    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
   565    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
   566    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
   567    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
   568    05  F                       PIC X(10) VALUE "~ACCTCITY=".
   569    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
   570    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
   571    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
   572    05  F                       PIC X(09) VALUE "~ACCTZIP=".
   573    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
   574    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
   575    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
   576    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
   577    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
   578    05  F                       PIC X(09) VALUE "~BUSTYPE=".
   579    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
   580    05  F                       PIC X(10) VALUE "~BENENAME=".
   581    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
   582    05  F                       PIC X(11) VALUE "~BENEADDR1=".
   583    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
   584    05  F                       PIC X(11) VALUE "~BENEADDR2=".
   585    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
   586    05  F                       PIC X(10) VALUE "~BENECITY=".
   587    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
   588    05  F                       PIC X(11) VALUE "~BENESTATE=".
   589    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
   590    05  F                       PIC X(09) VALUE "~BENEZIP=".
   591    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
   592    05  F                       PIC X(10) VALUE "~CARRNAME=".
   593    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  12
* NSRASLTR.cbl
   594    05  F                       PIC X(08) VALUE "~RESPNO=".
   595    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
   596    05  F                       PIC X(12) VALUE "~COACCTNAME=".
   597    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
   598    05  F                       PIC X(12) VALUE "~COMAILNAME=".
   599    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
   600    05  F                       PIC X(11) VALUE "~COMPADDR1=".
   601    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
   602    05  F                       PIC X(11) VALUE "~COMPADDR2=".
   603    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
   604    05  F                       PIC X(10) VALUE "~COMPCITY=".
   605    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
   606    05  F                       PIC X(11) VALUE "~COMPSTATE=".
   607    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
   608    05  F                       PIC X(09) VALUE "~COMPZIP=".
   609    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
   610    05  F                       PIC X(11) VALUE "~COMPPHONE=".
   611    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
   612    05  F                       PIC X(09) VALUE "~COMPFAX=".
   613    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
   614    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
   615    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
   616    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
   617    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
   618    05  F                       PIC X(08) VALUE "~RPTCD1=".
   619    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
   620    05  F                       PIC X(08) VALUE "~RPTCD2=".
   621    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
   622    05  F                       PIC X(09) VALUE "~ENTRYDT=".
   623    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
   624    05  F                       PIC X(07) VALUE "~BATCH=".
   625    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
   626    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
   627    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
   628    05  F                       PIC X(10) VALUE "~1STPMTDT=".
   629    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
   630    05  F                       PIC X(05) VALUE "~APR=".
   631    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
   632    05  F                       PIC X(08) VALUE "~LNTERM=".
   633    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
   634    05  F                       PIC X(11) VALUE "~RATECLASS=".
   635    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
   636    05  F                       PIC X(09) VALUE "~EXTDAYS=".
   637    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
   638    05  F                       PIC X(09) VALUE "~CSRCODE=".
   639    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
   640    05  F                       PIC X(07) VALUE "~UCODE=".
   641    05  OUT-UCODE               PIC X(01) VALUE SPACES.
   642    05  F                       PIC X(10) VALUE "~PREMTYPE=".
   643    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
   644    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
   645    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
   646    05  F                       PIC X(06) VALUE "~SKIP=".
   647    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
   648    05  F                       PIC X(06) VALUE "~MODE=".
   649    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
   650    05  F                       PIC X(09) VALUE "~LOANOFF=".
   651    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  13
* NSRASLTR.cbl
   652    05  F                       PIC X(06) VALUE "~RTBL=".
   653    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
   654    05  F                       PIC X(10) VALUE "~SPECREIN=".
   655    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
   656    05  F                       PIC X(09) VALUE "~LFBENCD=".
   657    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
   658    05  F                       PIC X(08) VALUE "~LFTERM=".
   659    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
   660    05  F                       PIC X(07) VALUE "~LFDEV=".
   661    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
   662    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
   663    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
   664    05  F                       PIC X(07) VALUE "~LFBEN=".
   665    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
   666    05  F                       PIC X(08) VALUE "~LFPREM=".
   667    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
   668    05  F                       PIC X(08) VALUE "~LFABEN=".
   669    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   670    05  F                       PIC X(09) VALUE "~LFAPREM=".
   671    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
   672    05  F                       PIC X(07) VALUE "~LFNSP=".
   673    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
   674    05  F                       PIC X(08) VALUE "~LFRBEN=".
   675    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   676    05  F                       PIC X(07) VALUE "~LFCAN=".
   677    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
   678    05  F                       PIC X(07) VALUE "~LFDTH=".
   679    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
   680    05  F                       PIC X(08) VALUE "~LFRATE=".
   681    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
   682    05  F                       PIC X(09) VALUE "~LFARATE=".
   683    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
   684    05  F                       PIC X(09) VALUE "~LFEXPDT=".
   685    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
   686    05  F                       PIC X(08) VALUE "~LFSTAT=".
   687    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
   688    05  F                       PIC X(09) VALUE "~LFCANDT=".
   689    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
   690    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
   691    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
   692    05  F                       PIC X(07) VALUE "~DTHDT=".
   693    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
   694    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
   695    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
   696    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
   697    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
   698    05  F                       PIC X(08) VALUE "~LFCOMM=".
   699    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
   700    05  F                       PIC X(11) VALUE "~LFBENDESC=".
   701    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
   702    05  F                       PIC X(11) VALUE "~LFBENABRV=".
   703    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
   704    05  F                       PIC X(09) VALUE "~AHBENCD=".
   705    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
   706    05  F                       PIC X(08) VALUE "~AHTERM=".
   707    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
   708    05  F                       PIC X(11) VALUE "~AHCRITPER=".
   709    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  14
* NSRASLTR.cbl
   710    05  F                       PIC X(09) VALUE "~AHDEVCD=".
   711    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
   712    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
   713    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
   714    05  F                       PIC X(07) VALUE "~AHBEN=".
   715    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
   716    05  F                       PIC X(08) VALUE "~AHPREM=".
   717    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
   718    05  F                       PIC X(07) VALUE "~AHNSP=".
   719    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
   720    05  F                       PIC X(07) VALUE "~AHCAN=".
   721    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
   722    05  F                       PIC X(10) VALUE "~AHITDPMT=".
   723    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
   724    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
   725    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   726    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
   727    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
   728    05  F                       PIC X(08) VALUE "~AHRATE=".
   729    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
   730    05  F                       PIC X(09) VALUE "~AHEXPDT=".
   731    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
   732    05  F                       PIC X(08) VALUE "~AHSTAT=".
   733    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
   734    05  F                       PIC X(09) VALUE "~AHCANDT=".
   735    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
   736    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
   737    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
   738    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
   739    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
   740    05  F                       PIC X(08) VALUE "~AHCOMM=".
   741    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
   742    05  F                       PIC X(11) VALUE "~AHBENDESC=".
   743    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
   744    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
   745    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
   746    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
   747    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
   748    05  F                       PIC X(08) VALUE "~AHWAIT=".
   749    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
   750    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
   751    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
   752    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
   753                                PIC X(2).
   754    05  F                       PIC X(09) VALUE "~TOTPREM=".
   755    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
   756    05  F                       PIC X(08) VALUE "~TOTREF=".
   757    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
   758    05  F                       PIC X(08) VALUE "~SEXPDT=".
   759    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
   760    05  F                       PIC X(07) VALUE "~STERM=".
   761    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
   762    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
   763    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
   764    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
   765    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
   766    05  F                       PIC X(11) VALUE "~IORIGINIT=".
   767    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  15
* NSRASLTR.cbl
   768    05  F                       PIC X(10) VALUE "~IORIGAGE=".
   769    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
   770    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
   771    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
   772    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
   773    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
   774    05  F                       PIC X(11) VALUE "~JORIGINIT=".
   775    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
   776    05  F                       PIC X(10) VALUE "~JORIGAGE=".
   777    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
   778    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
   779    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
   780    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
   781    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
   782    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
   783    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
   784    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
   785                                PIC X(12).
   786    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
   787    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
   788    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
   789                                PIC X(12).
   790    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
   791    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
   792    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
   793    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
   794    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
   795    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
   796    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
   797    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
   798    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
   799                                PIC X(12).
   800    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
   801    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
   802    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
   803                                PIC X(10).
   804    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
   805    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
   806    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
   807    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
   808    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
   809    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
   810    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
   811    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
   812    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
   813    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
   814    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
   815    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
   816    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
   817                                PIC X(10).
   818    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
   819    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
   820    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
   821                                PIC X(10).
   822    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
   823    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
   824    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
   825    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  16
* NSRASLTR.cbl
   826    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
   827    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
   828    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
   829    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
   830    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
   831    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
   832    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
   833    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
   834    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
   835    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
   836    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
   837    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
   838    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
   839    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
   840    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
   841                                PIC X(2).
   842    05  F                       PIC X(09) VALUE "~OSEXPDT=".
   843    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
   844    05  F                       PIC X(08) VALUE "~OSTERM=".
   845    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
   846    05  F                       PIC X(11) VALUE "~INEWLNAME=".
   847    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
   848    05  F                       PIC X(11) VALUE "~INEWFNAME=".
   849    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
   850    05  F                       PIC X(10) VALUE "~INEWINIT=".
   851    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
   852    05  F                       PIC X(09) VALUE "~INEWAGE=".
   853    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
   854    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
   855                                PIC X(09).
   856    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
   857    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
   858    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
   859    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
   860    05  F                       PIC X(10) VALUE "~JNEWINIT=".
   861    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
   862    05  F                       PIC X(09) VALUE "~JNEWAGE=".
   863    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
   864    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
   865                                PIC X(09).
   866    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
   867    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
   868    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
   869    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
   870    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
   871                                PIC X(09).
   872    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
   873    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
   874    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
   875                                PIC X(12).
   876    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
   877    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
   878    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
   879                                PIC X(10).
   880    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
   881    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
   882    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
   883    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  17
* NSRASLTR.cbl
   884    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
   885                                PIC X(12).
   886    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
   887    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
   888    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
   889                                PIC X(10).
   890    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
   891    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
   892    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
   893    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
   894    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
   895    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
   896    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
   897    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
   898    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
   899                                PIC X(09).
   900    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
   901    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
   902    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
   903                                PIC X(09).
   904    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
   905    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
   906    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
   907                                PIC X(10).
   908    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
   909    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
   910    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
   911                                PIC X(10).
   912    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
   913    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
   914    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
   915    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
   916    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
   917    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
   918    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
   919    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
   920    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
   921    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
   922    05  F                       PIC X(09) VALUE "~NEWWAIT=".
   923    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
   924    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
   925    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
   926    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
   927                                PIC X(09).
   928    05  F                       PIC X(09) VALUE "~NSEXPDT=".
   929    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
   930    05  F                       PIC X(08) VALUE "~NSTERM=".
   931    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
   932    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
   933                                PIC X(09).
   934    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
   935    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
   936    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
   937    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
   938    05  F                       PIC X(11) VALUE "~PAYABLETO=".
   939    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
   940    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
   941    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  18
* NSRASLTR.cbl
   942    05  F                       PIC X(09) VALUE "~BALLOON=".
   943    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
   944    05  F                       PIC X(10) VALUE "~LEASEIND=".
   945    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
   946    05  F                       PIC X(09) VALUE "~RESCIND=".
   947    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
   948    05  F                       PIC X(07) VALUE "~RCD01=".
   949    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
   950    05  F                       PIC X(07) VALUE "~RCD02=".
   951    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
   952    05  F                       PIC X(07) VALUE "~RCD03=".
   953    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
   954    05  F                       PIC X(07) VALUE "~RCD04=".
   955    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
   956    05  F                       PIC X(07) VALUE "~RCD05=".
   957    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
   958    05  F                       PIC X(07) VALUE "~RCD06=".
   959    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
   960    05  F                       PIC X(07) VALUE "~RCD07=".
   961    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
   962    05  F                       PIC X(07) VALUE "~RCD08=".
   963    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
   964    05  F                       PIC X(07) VALUE "~RCD09=".
   965    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
   966    05  F                       PIC X(07) VALUE "~RCD10=".
   967    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
   968    05  F                       PIC X(07) VALUE "~RCD11=".
   969    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
   970    05  F                       PIC X(07) VALUE "~RCD12=".
   971    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
   972    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
   973    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
   974    05  F                       PIC X(08) VALUE "~ARCHNO=".
   975    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
   976    05  F                       PIC X(06) VALUE "~FORM=".
   977    05  OUT-FORM                PIC X(03) VALUE SPACES.
   978    05  F                       PIC X(09) VALUE "~ENCLINE=".
   979    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
   980    05  F                       PIC X(08) VALUE "~ATTACH=".
   981    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
   982    05  F                       PIC X(10) VALUE "~OUTSTACK=".
   983    05  OUT-STACK               PIC X(10) VALUE SPACES.
   984    05  F                       PIC X(11) VALUE "~STATENAME=".
   985    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
   986    05  F                       PIC X(08) VALUE "~PRTNOW=".
   987    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
   988    05  F                       PIC X(05) VALUE "~NCB=".
   989    05  OUT-CHGBACK             PIC X     VALUE ' '.
   990    05  F                       PIC X(8) VALUE "~CSOAMT=".
   991    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
   992    05  F                       PIC X(9) VALUE "~ACCTAMT=".
   993    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
   994    05  F                       PIC X(09) VALUE "~LETRTYP=".
   995    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
   996    05  F                       PIC X(10) VALUE "~PRNTCERT=".
   997    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
   998    05  F                       PIC X(08) VALUE "~INSBDT=".
   999    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  19
* NSRASLTR.cbl
  1000    05  F                       PIC X(08) VALUE "~JNTBDT=".
  1001    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  1002    05  F                       PIC X(08) VALUE "~TOTINT=".
  1003    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  1004    05  F                       PIC X(8) VALUE "~TOPREM=".
  1005    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  1006    05  F                       PIC X(7) VALUE "~TOREF=".
  1007    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  1008    05  F                       PIC X(7) VALUE "~CANDT=".
  1009    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  1010    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  1011    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  1012    05  F                       PIC X(08) VALUE "~CERTID=".
  1013    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  1014    05  F                       PIC X(08) VALUE "~UNDWID=".
  1015    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  1016    05  F                       PIC X(8) VALUE "~TNPREM=".
  1017    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  1018    05  F                       PIC X(7) VALUE "~TNREF=".
  1019    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  1020    05  F                       PIC X(8)  VALUE "~COVIND=".
  1021    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  1022    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  1023    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  1024    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  1025    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  1026    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  1027    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  1028    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  1029    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  1030    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  1031    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  1032    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  1033                                PIC X(10).
  1034    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  1035    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  1036    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  1037    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  1038    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  1039    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  1040    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  1041    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  1042    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  1043    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  1044    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  1045    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  1046    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  1047    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  1048    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  1049    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1050    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  1051    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1052    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  1053    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  1054    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  1055    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  1056    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  1057    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  20
* NSRASLTR.cbl
  1058    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  1059    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  1060    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  1061    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  1062    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  1063    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  1064    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  1065    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1066    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  1067    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1068    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  1069    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  1070    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  1071    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  1072    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  1073    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1074    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  1075    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1076    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  1077    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1078    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  1079    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  1080    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  1081    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  1082    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  1083    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  1084    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  1085    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1086    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  1087    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1088    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  1089    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  1090    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  1091    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  1092    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  1093    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  1094    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  1095    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1096    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  1097    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  1098    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  1099    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  1100    05  F                       PIC X(09) VALUE "~CSONAMT=".
  1101    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  1102    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  1103    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  1104    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  1105    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1106    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  1107    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1108    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  1109    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  1110    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  1111    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  1112    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  1113    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  1114    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  1115    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  21
* NSRASLTR.cbl
  1116    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  1117    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  1118    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  1119    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  1120    05  F                       PIC X(08) VALUE "~CSOCHG=".
  1121    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  1122    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  1123    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  1124    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  1125    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  1126    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  1127    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  1128    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  1129    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  1130    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  1131    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  1132    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  1133    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  1134    05  F                       PIC X(8)  VALUE "~SCREEN=".
  1135    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  1136    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  1137    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  1138    05  F                       PIC X(7)  VALUE "~VINNO=".
  1139    05  OUT-VIN-NUMBER          PIC X(17) VALUE SPACES.
  1140    05  F                       PIC X(11) VALUE 'EndOfString'.
  1141    05  f                       pic x(2) value spaces.
  1142****************************************************************
  1143*
  1144* Copyright (c) 2007 by Clerity Solutions, Inc.
  1145* All rights reserved.
  1146*
  1147****************************************************************
  1148 01  DFHEIV.
  1149   02  DFHEIV0               PIC X(35).
  1150   02  DFHEIV1               PIC X(08).
  1151   02  DFHEIV2               PIC X(08).
  1152   02  DFHEIV3               PIC X(08).
  1153   02  DFHEIV4               PIC X(06).
  1154   02  DFHEIV5               PIC X(04).
  1155   02  DFHEIV6               PIC X(04).
  1156   02  DFHEIV7               PIC X(02).
  1157   02  DFHEIV8               PIC X(02).
  1158   02  DFHEIV9               PIC X(01).
  1159   02  DFHEIV10              PIC S9(7) COMP-3.
  1160   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1161   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1162   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1163   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1164   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1165   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1166   02  DFHEIV17              PIC X(04).
  1167   02  DFHEIV18              PIC X(04).
  1168   02  DFHEIV19              PIC X(04).
  1169   02  DFHEIV20              USAGE IS POINTER.
  1170   02  DFHEIV21              USAGE IS POINTER.
  1171   02  DFHEIV22              USAGE IS POINTER.
  1172   02  DFHEIV23              USAGE IS POINTER.
  1173   02  DFHEIV24              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  22
* NSRASLTR.cbl
  1174   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1175   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1176   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1177   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1178   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1179   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1180   02  FILLER                PIC X(02).
  1181   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1182   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1183   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1184   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1185   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1186 LINKAGE  SECTION.
  1187*****************************************************************
  1188*                                                               *
  1189* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1190* All rights reserved.                                          *
  1191*                                                               *
  1192*****************************************************************
  1193 01  dfheiblk.
  1194     02  eibtime          pic s9(7) comp-3.
  1195     02  eibdate          pic s9(7) comp-3.
  1196     02  eibtrnid         pic x(4).
  1197     02  eibtaskn         pic s9(7) comp-3.
  1198     02  eibtrmid         pic x(4).
  1199     02  dfheigdi         pic s9(4) comp.
  1200     02  eibcposn         pic s9(4) comp.
  1201     02  eibcalen         pic s9(4) comp.
  1202     02  eibaid           pic x(1).
  1203     02  eibfiller1       pic x(1).
  1204     02  eibfn            pic x(2).
  1205     02  eibfiller2       pic x(2).
  1206     02  eibrcode         pic x(6).
  1207     02  eibfiller3       pic x(2).
  1208     02  eibds            pic x(8).
  1209     02  eibreqid         pic x(8).
  1210     02  eibrsrce         pic x(8).
  1211     02  eibsync          pic x(1).
  1212     02  eibfree          pic x(1).
  1213     02  eibrecv          pic x(1).
  1214     02  eibsend          pic x(1).
  1215     02  eibatt           pic x(1).
  1216     02  eibeoc           pic x(1).
  1217     02  eibfmh           pic x(1).
  1218     02  eibcompl         pic x(1).
  1219     02  eibsig           pic x(1).
  1220     02  eibconf          pic x(1).
  1221     02  eiberr           pic x(1).
  1222     02  eibrldbk         pic x(1).
  1223     02  eiberrcd         pic x(4).
  1224     02  eibsynrb         pic x(1).
  1225     02  eibnodat         pic x(1).
  1226     02  eibfiller5       pic x(2).
  1227     02  eibresp          pic 9(09) comp.
  1228     02  eibresp2         pic 9(09) comp.
  1229     02  dfheigdj         pic s9(4) comp.
  1230     02  dfheigdk         pic s9(4) comp.
  1231 01  DFHCOMMAREA       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  23
* NSRASLTR.cbl
  1232 01  var  pic x(30).
  1233 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  1234 0000-DFHEXIT SECTION.
  1235     MOVE '9#                    $   ' TO DFHEIV0.
  1236     MOVE 'NSRASLTR' TO DFHEIV1.
  1237     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1238*********************
  1239* Receive web input
  1240*********************
  1241     DISPLAY ' ENTERING NSRASLTR '
  1242     set P to address of KIXSYS
  1243     CALL "getenv" using by value P returning var-ptr
  1244     if var-ptr = null then
  1245        display ' kixsys not set '
  1246     else
  1247        set address of var to var-ptr
  1248        move 0 to env-var-len
  1249        inspect var tallying env-var-len
  1250          for characters before X'00'
  1251        DISPLAY '  KIXSYS = ' var (1:env-var-len)
  1252        unstring var (1:env-var-len) delimited by '/'
  1253           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  1254              WS-KIX-SYS
  1255        end-unstring
  1256*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  1257*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  1258     end-if
  1259     set P to address of KIXHOST
  1260     CALL "getenv" using by value P returning var-ptr
  1261     if var-ptr = null then
  1262        display ' kixhost not set '
  1263     else
  1264        set address of var to var-ptr
  1265        move 0 to env-var-len
  1266        inspect var tallying env-var-len
  1267          for characters before X'00'
  1268        MOVE var(1:env-var-len)  to ws-kixhost
  1269        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  1270     end-if
  1271     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1272     MOVE '5'                    TO DC-OPTION-CODE
  1273     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1274     MOVE DC-GREG-DATE-A-EDIT    TO ASERR-DT
  1275
  1276* exec cics web
  1277*       startbr formfield resp(w-resp)
  1278*     end-exec.
  1279*    MOVE 'X(f                   &  N#00001271' TO DFHEIV0
  1280     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
  1281     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1282     MOVE X'204E233030303031323731' TO DFHEIV0(25:11)
  1283     CALL 'kxdfhei1' USING DFHEIV0,
  1284           DFHEIV99,
  1285           DFHEIV99,
  1286           DFHEIV99,
  1287           DFHEIV99,
  1288           DFHEIV99
  1289     MOVE EIBRESP  TO w-resp
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  24
* NSRASLTR.cbl
  1290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1291
  1292      perform read-form thru read-form-exit
  1293         until w-resp not = 0 .
  1294*   dfhresp(normal)
  1295
  1296* exec cics web
  1297*       endbr formfield
  1298*     end-exec
  1299*    MOVE 'X,f                   #   #00001276' TO DFHEIV0
  1300     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
  1301     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1302     MOVE X'2020233030303031323736' TO DFHEIV0(25:11)
  1303     CALL 'kxdfhei1' USING DFHEIV0,
  1304           DFHEIV99,
  1305           DFHEIV99
  1306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1307     display ' form input ' INPUT-FROM-FORM
  1308     MOVE SPACES                  TO BL-INPUT
  1309     MOVE IFF-DATA-SRCE           TO BL-DATA-SRCE
  1310     MOVE IFF-CARRIER             TO BL-CARRIER
  1311     MOVE IFF-GROUP               TO BL-GROUP
  1312     MOVE IFF-STATE               TO BL-STATE
  1313     MOVE IFF-ACCOUNT             TO BL-ACCOUNT
  1314     MOVE IFF-EFF-DT              TO BL-EFF-DT
  1315     MOVE IFF-CERT-NO             TO BL-CERT-NO
  1316     MOVE IFF-BATCH-NO            TO BL-BATCH-NO
  1317     MOVE IFF-BATCH-SEQ           TO BL-BATCH-SEQ
  1318     MOVE IFF-RESP-NO             TO BL-RESP-NO
  1319     MOVE IFF-LETTER-ID           TO BL-LETTER-ID
  1320     MOVE IFF-NO-OF-COPIES        TO BL-NO-OF-COPIES
  1321     MOVE IFF-PROC-ID             TO BL-PROC-ID
  1322     MOVE IFF-COMP-ID             TO OT-COMP-ID
  1323                                     BL-COMP-ID
  1324     MOVE IFF-PRINT-NOW-SW        TO OT-PRINT-NOW-SW
  1325                                     BL-PRINT-NOW-SW
  1326     MOVE IFF-ENC-CD              TO BL-ENC-CD
  1327     MOVE IFF-RESEND-DT           TO BL-RESEND-DT
  1328     MOVE IFF-FOLLOW-UP-DT        TO BL-FOLLOW-UP-DT
  1329*    MOVE IFF-COMMENTS            TO BL-COMMENTS
  1330     MOVE IFF-ARCHIVE-NO          TO BL-ARCHIVE-NO
  1331     MOVE IFF-FUNC                TO BL-FUNC
  1332                                     OT-FUNC
  1333     MOVE IFF-ENDT-ARCH-NO        TO BL-ENDT-ARCH-NO
  1334
  1335     EVALUATE BL-FUNC
  1336         WHEN 'Letter'
  1337             MOVE 'LETTER'        TO BL-SOURCE-SCREEN
  1338         WHEN 'CrtVerif'
  1339             MOVE 'VERIFY'        TO BL-SOURCE-SCREEN
  1340         WHEN 'Endorse'
  1341             MOVE 'ISS ENDT'      TO BL-SOURCE-SCREEN
  1342         WHEN 'CancChg'
  1343             MOVE 'CAN ENDT'      TO BL-SOURCE-SCREEN
  1344         WHEN OTHER
  1345             MOVE 'UNKNOWN'       TO BL-SOURCE-SCREEN
  1346     END-EVALUATE
  1347
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  25
* NSRASLTR.cbl
  1348*****************************************
  1349* Since this program was called from the webservice
  1350* we really don't know if a real letter is being created
  1351* a "T" below will create temporary erarch and nsasextr
  1352* records and "X" we won't create anything
  1353*****************************************
  1354     MOVE 'T'                    TO BL-WRITE-ERARCH
  1355     IF BL-PRINT-NOW-SW = 'P'
  1356        MOVE 'X'                 TO BL-WRITE-ERARCH
  1357     END-IF
  1358     MOVE 'X'                 TO BL-WRITE-ERARCH
  1359*    DISPLAY ' INPUT FORM ' WS-KEY
  1360*****************************************
  1361* Invoke the LETTER business logic
  1362*****************************************
  1363     DISPLAY ' BL INPUT ' BL-INPUT
  1364     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  1365     DISPLAY ' BL INPUT ' BL-INPUT
  1366     display ' srch commarea ' srch-commarea
  1367     display ' length ' ws-comm-length
  1368
  1369* exec cics link
  1370*       program('NSRASBL')
  1371*       commarea(srch-commarea)
  1372*       LENGTH  (WS-COMM-LENGTH)
  1373*    end-exec.
  1374     MOVE 'NSRASBL' TO DFHEIV1
  1375*    MOVE '."C                   (   #00001340' TO DFHEIV0
  1376     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1378     MOVE X'2020233030303031333430' TO DFHEIV0(25:11)
  1379     CALL 'kxdfhei1' USING DFHEIV0,
  1380           DFHEIV1,
  1381           srch-commarea,
  1382           WS-COMM-LENGTH,
  1383           DFHEIV99,
  1384           DFHEIV99,
  1385           DFHEIV99,
  1386           DFHEIV99
  1387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1388
  1389     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-output
  1390     IF BL-OK
  1391        perform varying bl-length from +6200 by -1 until
  1392           (bl-record-passed-data (bl-length:1) not = ' ')
  1393           or (bl-length = +1)
  1394        end-perform
  1395*       DISPLAY ' BL OK ' BL-ARCHIVE-NO
  1396        display ' bl length ' bl-length
  1397        move bl-length to sl-length
  1398        move spaces to naper-output-data
  1399        MOVE BL-RECORD-PASSED-DATA (1:bl-length)
  1400                                 TO NAPER-OUTPUT-DATA
  1401        MOVE BL-ARCHIVE-NO          TO OT-ARCHIVE-NO
  1402     ELSE
  1403        MOVE BL-MESSAGE          TO ASERR-MESS
  1404
  1405* exec cics document create
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  26
* NSRASLTR.cbl
  1406*          doctoken   (w-doctoken)
  1407*          template   ('ASERR')
  1408*          symbollist (WS-ASERR)
  1409*          resp       (WS-RESPONSE)
  1410*       end-exec
  1411     MOVE LENGTH OF
  1412      WS-ASERR
  1413       TO DFHEIV16
  1414     MOVE 'ASERR'
  1415      TO DFHEIVL0
  1416*    MOVE '\"D tSL               )  N#00001360' TO DFHEIV0
  1417     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1418     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1419     MOVE X'204E233030303031333630' TO DFHEIV0(25:11)
  1420     CALL 'kxdfhei1' USING DFHEIV0,
  1421           w-doctoken,
  1422           DFHEIV99,
  1423           DFHEIVL0,
  1424           WS-ASERR,
  1425           DFHEIV16,
  1426           DFHEIV99,
  1427           DFHEIV99,
  1428           DFHEIV99
  1429     MOVE EIBRESP  TO WS-RESPONSE
  1430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1431        display ' doc create ' ws-response
  1432
  1433* exec cics web send
  1434*          doctoken(w-doctoken)
  1435*                      resp   (WS-RESPONSE)
  1436*       end-exec
  1437*    MOVE 'X$D                   *  N#00001367' TO DFHEIV0
  1438     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1439     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1440     MOVE X'204E233030303031333637' TO DFHEIV0(25:11)
  1441     CALL 'kxdfhei1' USING DFHEIV0,
  1442           w-doctoken,
  1443           DFHEIV99,
  1444           DFHEIV99,
  1445           DFHEIV99,
  1446           DFHEIV99,
  1447           DFHEIV99,
  1448           DFHEIV99,
  1449           DFHEIV99,
  1450           DFHEIV99
  1451     MOVE EIBRESP  TO WS-RESPONSE
  1452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1453        display ' web send ' ws-response
  1454
  1455* exec cics
  1456*          return
  1457*       end-exec
  1458*    MOVE '.(                    ''   #00001372' TO DFHEIV0
  1459     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1460     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1461     MOVE X'2020233030303031333732' TO DFHEIV0(25:11)
  1462     CALL 'kxdfhei1' USING DFHEIV0,
  1463           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  27
* NSRASLTR.cbl
  1464           DFHEIV99,
  1465           DFHEIV99,
  1466           DFHEIV99,
  1467           DFHEIV99,
  1468           DFHEIV99
  1469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1470     END-IF
  1471     evaluate ws-kixhost
  1472        when 'slunikix'
  1473           evaluate ws-kix-myenv
  1474              when 'cid1p'
  1475                 move '7001'     to ws-sl-port
  1476*                                   ws-sl-port2
  1477              when 'mdoff'
  1478                 move '7003'     to ws-sl-port
  1479*                                   ws-sl-port2
  1480              when 'cid1t'
  1481                 move '7002'     to ws-sl-port
  1482*                                   ws-sl-port2
  1483           end-evaluate
  1484           move ws-asftr         to ws-sl-key
  1485*                                   ws-sl-key2
  1486        when 'logictest'
  1487           evaluate ws-kix-myenv
  1488              when 'cid1t'
  1489                 move '6002'     to ws-lt-port
  1490*                                   ws-lt-port2
  1491              when 'tony'
  1492                 move '6003'     to ws-lt-port
  1493*                                   ws-lt-port2
  1494              when 'paul'
  1495                 move '5002'     to ws-lt-port
  1496*                                   ws-lt-port2
  1497              when 'ahltst'
  1498                 move '6007'     to ws-lt-port
  1499*                                   ws-lt-port2
  1500           end-evaluate
  1501           move ws-asftr         to ws-lt-key
  1502*                                   ws-lt-key2
  1503     end-evaluate
  1504***********************************************************
  1505* Build output document.  There are three templates used
  1506* for this document.  ASHDR and ASFTR are the header
  1507* and footer, respectively.  ASBOD is used for the
  1508* actual data.  For each array entry in the business
  1509* logic output, set the symbol list from the array
  1510* entry and insert into the document using the ASBOD
  1511* template.
  1512***********************************************************
  1513*    move bl-output-message to out-msg-text.
  1514     evaluate true
  1515        when iff-comp-id = 'DCC'
  1516           IF WS-KIX-MYENV = 'cid1p'
  1517
  1518* exec cics document create
  1519*                doctoken   (w-doctoken)
  1520*                template   ('ASHDR')
  1521*                symbollist (WS-PROD-DCC-ASHDR)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  28
* NSRASLTR.cbl
  1522*                resp       (WS-RESPONSE)
  1523*             end-exec
  1524     MOVE LENGTH OF
  1525      WS-PROD-DCC-ASHDR
  1526       TO DFHEIV16
  1527     MOVE 'ASHDR'
  1528      TO DFHEIVL0
  1529*    MOVE '\"D tSL               )  N#00001422' TO DFHEIV0
  1530     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1531     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1532     MOVE X'204E233030303031343232' TO DFHEIV0(25:11)
  1533     CALL 'kxdfhei1' USING DFHEIV0,
  1534           w-doctoken,
  1535           DFHEIV99,
  1536           DFHEIVL0,
  1537           WS-PROD-DCC-ASHDR,
  1538           DFHEIV16,
  1539           DFHEIV99,
  1540           DFHEIV99,
  1541           DFHEIV99
  1542     MOVE EIBRESP  TO WS-RESPONSE
  1543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1544           ELSE
  1545
  1546* exec cics document create
  1547*                doctoken   (w-doctoken)
  1548*                template   ('ASHDR')
  1549*                symbollist (WS-TEST-DCC-ASHDR)
  1550*                resp       (WS-RESPONSE)
  1551*             end-exec
  1552     MOVE LENGTH OF
  1553      WS-TEST-DCC-ASHDR
  1554       TO DFHEIV16
  1555     MOVE 'ASHDR'
  1556      TO DFHEIVL0
  1557*    MOVE '\"D tSL               )  N#00001429' TO DFHEIV0
  1558     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1559     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1560     MOVE X'204E233030303031343239' TO DFHEIV0(25:11)
  1561     CALL 'kxdfhei1' USING DFHEIV0,
  1562           w-doctoken,
  1563           DFHEIV99,
  1564           DFHEIVL0,
  1565           WS-TEST-DCC-ASHDR,
  1566           DFHEIV16,
  1567           DFHEIV99,
  1568           DFHEIV99,
  1569           DFHEIV99
  1570     MOVE EIBRESP  TO WS-RESPONSE
  1571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1572           END-IF
  1573        when iff-comp-id = 'AHL'
  1574           IF WS-KIX-MYENV = 'cid1p'
  1575
  1576* exec cics document create
  1577*                doctoken   (w-doctoken)
  1578*                template   ('ASHDR')
  1579*                symbollist (WS-PROD-AHL-ASHDR)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  29
* NSRASLTR.cbl
  1580*                resp       (WS-RESPONSE)
  1581*             end-exec
  1582     MOVE LENGTH OF
  1583      WS-PROD-AHL-ASHDR
  1584       TO DFHEIV16
  1585     MOVE 'ASHDR'
  1586      TO DFHEIVL0
  1587*    MOVE '\"D tSL               )  N#00001438' TO DFHEIV0
  1588     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1589     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1590     MOVE X'204E233030303031343338' TO DFHEIV0(25:11)
  1591     CALL 'kxdfhei1' USING DFHEIV0,
  1592           w-doctoken,
  1593           DFHEIV99,
  1594           DFHEIVL0,
  1595           WS-PROD-AHL-ASHDR,
  1596           DFHEIV16,
  1597           DFHEIV99,
  1598           DFHEIV99,
  1599           DFHEIV99
  1600     MOVE EIBRESP  TO WS-RESPONSE
  1601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1602           ELSE
  1603
  1604* exec cics document create
  1605*                doctoken   (w-doctoken)
  1606*                template   ('ASHDR')
  1607*                symbollist (WS-TEST-AHL-ASHDR)
  1608*                resp       (WS-RESPONSE)
  1609*             end-exec
  1610     MOVE LENGTH OF
  1611      WS-TEST-AHL-ASHDR
  1612       TO DFHEIV16
  1613     MOVE 'ASHDR'
  1614      TO DFHEIVL0
  1615*    MOVE '\"D tSL               )  N#00001445' TO DFHEIV0
  1616     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1617     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1618     MOVE X'204E233030303031343435' TO DFHEIV0(25:11)
  1619     CALL 'kxdfhei1' USING DFHEIV0,
  1620           w-doctoken,
  1621           DFHEIV99,
  1622           DFHEIVL0,
  1623           WS-TEST-AHL-ASHDR,
  1624           DFHEIV16,
  1625           DFHEIV99,
  1626           DFHEIV99,
  1627           DFHEIV99
  1628     MOVE EIBRESP  TO WS-RESPONSE
  1629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1630           END-IF
  1631        when iff-comp-id = 'VPP'
  1632           IF WS-KIX-MYENV = 'cid1p'
  1633
  1634* exec cics document create
  1635*                doctoken   (w-doctoken)
  1636*                template   ('ASHDR')
  1637*                symbollist (WS-PROD-VPP-ASHDR)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  30
* NSRASLTR.cbl
  1638*                resp       (WS-RESPONSE)
  1639*             end-exec
  1640     MOVE LENGTH OF
  1641      WS-PROD-VPP-ASHDR
  1642       TO DFHEIV16
  1643     MOVE 'ASHDR'
  1644      TO DFHEIVL0
  1645*    MOVE '\"D tSL               )  N#00001454' TO DFHEIV0
  1646     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1647     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1648     MOVE X'204E233030303031343534' TO DFHEIV0(25:11)
  1649     CALL 'kxdfhei1' USING DFHEIV0,
  1650           w-doctoken,
  1651           DFHEIV99,
  1652           DFHEIVL0,
  1653           WS-PROD-VPP-ASHDR,
  1654           DFHEIV16,
  1655           DFHEIV99,
  1656           DFHEIV99,
  1657           DFHEIV99
  1658     MOVE EIBRESP  TO WS-RESPONSE
  1659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1660           ELSE
  1661
  1662* exec cics document create
  1663*                doctoken   (w-doctoken)
  1664*                template   ('ASHDR')
  1665*                symbollist (WS-TEST-VPP-ASHDR)
  1666*                resp       (WS-RESPONSE)
  1667*             end-exec
  1668     MOVE LENGTH OF
  1669      WS-TEST-VPP-ASHDR
  1670       TO DFHEIV16
  1671     MOVE 'ASHDR'
  1672      TO DFHEIVL0
  1673*    MOVE '\"D tSL               )  N#00001461' TO DFHEIV0
  1674     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1675     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1676     MOVE X'204E233030303031343631' TO DFHEIV0(25:11)
  1677     CALL 'kxdfhei1' USING DFHEIV0,
  1678           w-doctoken,
  1679           DFHEIV99,
  1680           DFHEIVL0,
  1681           WS-TEST-VPP-ASHDR,
  1682           DFHEIV16,
  1683           DFHEIV99,
  1684           DFHEIV99,
  1685           DFHEIV99
  1686     MOVE EIBRESP  TO WS-RESPONSE
  1687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1688           END-IF
  1689        when OTHER
  1690           IF WS-KIX-MYENV = 'cid1p'
  1691
  1692* exec cics document create
  1693*               doctoken   (w-doctoken)
  1694*               template   ('ASHDR')
  1695*               symbollist (WS-PROD-CID-ASHDR)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  31
* NSRASLTR.cbl
  1696*               resp       (WS-RESPONSE)
  1697*            end-exec
  1698     MOVE LENGTH OF
  1699      WS-PROD-CID-ASHDR
  1700       TO DFHEIV16
  1701     MOVE 'ASHDR'
  1702      TO DFHEIVL0
  1703*    MOVE '\"D tSL               )  N#00001470' TO DFHEIV0
  1704     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1705     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1706     MOVE X'204E233030303031343730' TO DFHEIV0(25:11)
  1707     CALL 'kxdfhei1' USING DFHEIV0,
  1708           w-doctoken,
  1709           DFHEIV99,
  1710           DFHEIVL0,
  1711           WS-PROD-CID-ASHDR,
  1712           DFHEIV16,
  1713           DFHEIV99,
  1714           DFHEIV99,
  1715           DFHEIV99
  1716     MOVE EIBRESP  TO WS-RESPONSE
  1717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1718           ELSE
  1719
  1720* exec cics document create
  1721*               doctoken   (w-doctoken)
  1722*               template   ('ASHDR')
  1723*               symbollist (WS-TEST-CID-ASHDR)
  1724*               resp       (WS-RESPONSE)
  1725*            end-exec
  1726     MOVE LENGTH OF
  1727      WS-TEST-CID-ASHDR
  1728       TO DFHEIV16
  1729     MOVE 'ASHDR'
  1730      TO DFHEIVL0
  1731*    MOVE '\"D tSL               )  N#00001477' TO DFHEIV0
  1732     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1733     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1734     MOVE X'204E233030303031343737' TO DFHEIV0(25:11)
  1735     CALL 'kxdfhei1' USING DFHEIV0,
  1736           w-doctoken,
  1737           DFHEIV99,
  1738           DFHEIVL0,
  1739           WS-TEST-CID-ASHDR,
  1740           DFHEIV16,
  1741           DFHEIV99,
  1742           DFHEIV99,
  1743           DFHEIV99
  1744     MOVE EIBRESP  TO WS-RESPONSE
  1745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1746           END-IF
  1747     end-evaluate
  1748*    DISPLAY ' ASHDR DOC CREATE ' WS-RESPONSE
  1749*    move 1 to bl-index.
  1750*
  1751*    perform bl-output-record-count times
  1752*
  1753*        move bl-output-account-number(bl-index)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  32
* NSRASLTR.cbl
  1754*          to out-account-number
  1755*        move bl-output-last-name(bl-index)
  1756*          to out-last-name
  1757*        move bl-output-first-name(bl-index)
  1758*          to out-first-name
  1759*        move bl-output-middle-initial(bl-index)
  1760*          to out-middle-initial
  1761*
  1762*    MOVE 'EL01'                 TO OUT-TEMP
  1763*    MOVE 'ALWA'                 TO OUT-PROC-ID
  1764*    MOVE 'EL01'                 TO OUT-LETTER
  1765*    MOVE '9'                    TO OUT-CARRIER
  1766*    MOVE 'MCDANIEL'             TO OUT-ILNAME
  1767*    MOVE 'KATHI'                TO OUT-IFNAME
  1768*
  1769*    MOVE '0009235906 '          TO OUT-CERT-NO
  1770*    MOVE '0990000208'           TO OUT-ACCOUNT
  1771
  1772* exec cics document set
  1773*       doctoken(w-doctoken)
  1774*       symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1775*       delimiter ('?')
  1776*       length(length of NAPER-OUTPUT-DATA)
  1777*       length(sl-length)
  1778*                   resp   (WS-RESPONSE)
  1779*     unescaped
  1780*    end-exec
  1781*    MOVE '\(Ds L                ''  N#00001508' TO DFHEIV0
  1782     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1783     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1784     MOVE X'204E233030303031353038' TO DFHEIV0(25:11)
  1785     CALL 'kxdfhei1' USING DFHEIV0,
  1786           w-doctoken,
  1787           NAPER-OUTPUT-DATA(1 : bl-length),
  1788           DFHEIV99,
  1789           sl-length,
  1790           DFHEIV99,
  1791           DFHEIV99
  1792     MOVE EIBRESP  TO WS-RESPONSE
  1793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1794*    DISPLAY ' DOC SET    ' WS-RESPONSE
  1795
  1796* exec cics document insert
  1797*       doctoken(w-doctoken)
  1798*       template('ASBOD')
  1799*                   resp   (WS-RESPONSE)
  1800*    end-exec
  1801     MOVE 'ASBOD'
  1802      TO DFHEIVL0
  1803*    MOVE '\$Dt                  (  N#00001518' TO DFHEIV0
  1804     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1806     MOVE X'204E233030303031353138' TO DFHEIV0(25:11)
  1807     CALL 'kxdfhei1' USING DFHEIV0,
  1808           w-doctoken,
  1809           DFHEIVL0,
  1810           DFHEIV99,
  1811           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  33
* NSRASLTR.cbl
  1812           DFHEIV99,
  1813           DFHEIV99,
  1814           DFHEIV99
  1815     MOVE EIBRESP  TO WS-RESPONSE
  1816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1817     IF BL-LETTER-TO-ACCT NOT = SPACES
  1818        MOVE BL-LETTER-TO-ACCT   TO NAPER-OUTPUT-DATA (12:1)
  1819*       MOVE 'EL01T'             TO NAPER-OUTPUT-DATA (8:6)
  1820
  1821* exec cics document set
  1822*          doctoken(w-doctoken)
  1823*          symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1824*          length(sl-length)
  1825*          resp   (WS-RESPONSE)
  1826*       end-exec
  1827*    MOVE '\(Ds L                ''  N#00001526' TO DFHEIV0
  1828     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1830     MOVE X'204E233030303031353236' TO DFHEIV0(25:11)
  1831     CALL 'kxdfhei1' USING DFHEIV0,
  1832           w-doctoken,
  1833           NAPER-OUTPUT-DATA(1 : bl-length),
  1834           DFHEIV99,
  1835           sl-length,
  1836           DFHEIV99,
  1837           DFHEIV99
  1838     MOVE EIBRESP  TO WS-RESPONSE
  1839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1840
  1841* exec cics document insert
  1842*          doctoken(w-doctoken)
  1843*          template('ASBOD')
  1844*          resp   (WS-RESPONSE)
  1845*       end-exec
  1846     MOVE 'ASBOD'
  1847      TO DFHEIVL0
  1848*    MOVE '\$Dt                  (  N#00001532' TO DFHEIV0
  1849     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1850     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1851     MOVE X'204E233030303031353332' TO DFHEIV0(25:11)
  1852     CALL 'kxdfhei1' USING DFHEIV0,
  1853           w-doctoken,
  1854           DFHEIVL0,
  1855           DFHEIV99,
  1856           DFHEIV99,
  1857           DFHEIV99,
  1858           DFHEIV99,
  1859           DFHEIV99
  1860     MOVE EIBRESP  TO WS-RESPONSE
  1861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1862     END-IF
  1863     IF BL-LETTER-TO-BENE NOT = SPACES
  1864        MOVE BL-LETTER-TO-BENE   TO NAPER-OUTPUT-DATA (12:1)
  1865*       MOVE 'EL01T'             TO NAPER-OUTPUT-DATA (8:6)
  1866
  1867* exec cics document set
  1868*          doctoken(w-doctoken)
  1869*          symbollist(NAPER-OUTPUT-DATA (1:bl-length))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  34
* NSRASLTR.cbl
  1870*          length(sl-length)
  1871*          resp   (WS-RESPONSE)
  1872*       end-exec
  1873*    MOVE '\(Ds L                ''  N#00001541' TO DFHEIV0
  1874     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1875     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1876     MOVE X'204E233030303031353431' TO DFHEIV0(25:11)
  1877     CALL 'kxdfhei1' USING DFHEIV0,
  1878           w-doctoken,
  1879           NAPER-OUTPUT-DATA(1 : bl-length),
  1880           DFHEIV99,
  1881           sl-length,
  1882           DFHEIV99,
  1883           DFHEIV99
  1884     MOVE EIBRESP  TO WS-RESPONSE
  1885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1886
  1887* exec cics document insert
  1888*          doctoken(w-doctoken)
  1889*          template('ASBOD')
  1890*          resp   (WS-RESPONSE)
  1891*       end-exec
  1892     MOVE 'ASBOD'
  1893      TO DFHEIVL0
  1894*    MOVE '\$Dt                  (  N#00001547' TO DFHEIV0
  1895     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1897     MOVE X'204E233030303031353437' TO DFHEIV0(25:11)
  1898     CALL 'kxdfhei1' USING DFHEIV0,
  1899           w-doctoken,
  1900           DFHEIVL0,
  1901           DFHEIV99,
  1902           DFHEIV99,
  1903           DFHEIV99,
  1904           DFHEIV99,
  1905           DFHEIV99
  1906     MOVE EIBRESP  TO WS-RESPONSE
  1907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1908     END-IF
  1909*    DISPLAY ' ASBOD DOC INSERT ' WS-RESPONSE
  1910*
  1911*        add 1 to bl-index
  1912*
  1913*    end-perform.
  1914*    MOVE BL-CARRIER  TO OT-CARRIER
  1915*    MOVE BL-CLAIM-NO TO OT-CLMNO
  1916*    MOVE BL-CERT-NO  TO OT-CRTNO
  1917*    MOVE BL-ARCHIVE-NO TO OT-ARCHNO
  1918     IF WS-KIXHOST = 'slunikix'
  1919        display ' host slunikix ' ws-kixhost
  1920
  1921* exec cics document set
  1922*          doctoken(w-doctoken)
  1923*          symbollist(WS-VAR-SLUNIKIX)
  1924*          length(length of WS-VAR-SLUNIKIX)
  1925*                      resp   (WS-RESPONSE)
  1926*       end-exec
  1927     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  35
* NSRASLTR.cbl
  1928      WS-VAR-SLUNIKIX TO DFHEIV16
  1929*    MOVE '\(Ds L                ''  N#00001564' TO DFHEIV0
  1930     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1932     MOVE X'204E233030303031353634' TO DFHEIV0(25:11)
  1933     CALL 'kxdfhei1' USING DFHEIV0,
  1934           w-doctoken,
  1935           WS-VAR-SLUNIKIX,
  1936           DFHEIV99,
  1937           DFHEIV16,
  1938           DFHEIV99,
  1939           DFHEIV99
  1940     MOVE EIBRESP  TO WS-RESPONSE
  1941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1942     else
  1943        display ' host logictest ' ws-kixhost
  1944
  1945* exec cics document set
  1946*          doctoken(w-doctoken)
  1947*          symbollist(WS-VAR-LOGICTEST)
  1948*          length(length of WS-VAR-LOGICTEST)
  1949*                      resp   (WS-RESPONSE)
  1950*       end-exec
  1951     MOVE LENGTH OF
  1952      WS-VAR-LOGICTEST TO DFHEIV16
  1953*    MOVE '\(Ds L                ''  N#00001572' TO DFHEIV0
  1954     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1955     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1956     MOVE X'204E233030303031353732' TO DFHEIV0(25:11)
  1957     CALL 'kxdfhei1' USING DFHEIV0,
  1958           w-doctoken,
  1959           WS-VAR-LOGICTEST,
  1960           DFHEIV99,
  1961           DFHEIV16,
  1962           DFHEIV99,
  1963           DFHEIV99
  1964     MOVE EIBRESP  TO WS-RESPONSE
  1965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1966     end-if
  1967*    DISPLAY ' DOC SET ' WS-RESPONSE
  1968
  1969* exec cics document insert
  1970*       doctoken(w-doctoken)
  1971*       template('ASFTR')
  1972*                   resp   (WS-RESPONSE)
  1973*    end-exec
  1974     MOVE 'ASFTR'
  1975      TO DFHEIVL0
  1976*    MOVE '\$Dt                  (  N#00001580' TO DFHEIV0
  1977     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1978     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1979     MOVE X'204E233030303031353830' TO DFHEIV0(25:11)
  1980     CALL 'kxdfhei1' USING DFHEIV0,
  1981           w-doctoken,
  1982           DFHEIVL0,
  1983           DFHEIV99,
  1984           DFHEIV99,
  1985           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  36
* NSRASLTR.cbl
  1986           DFHEIV99,
  1987           DFHEIV99
  1988     MOVE EIBRESP  TO WS-RESPONSE
  1989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1990*    DISPLAY ' ASFTR DOC INSERT ' WS-RESPONSE
  1991*    if bl-fail
  1992*       exec cics syncpoint rollback
  1993*       end-exec
  1994*    end-if.
  1995****************************************
  1996* Send the document and return.
  1997****************************************
  1998
  1999* exec cics web send
  2000*       doctoken(w-doctoken)
  2001*                   resp   (WS-RESPONSE)
  2002*    end-exec.
  2003*    MOVE 'X$D                   *  N#00001593' TO DFHEIV0
  2004     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2005     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2006     MOVE X'204E233030303031353933' TO DFHEIV0(25:11)
  2007     CALL 'kxdfhei1' USING DFHEIV0,
  2008           w-doctoken,
  2009           DFHEIV99,
  2010           DFHEIV99,
  2011           DFHEIV99,
  2012           DFHEIV99,
  2013           DFHEIV99,
  2014           DFHEIV99,
  2015           DFHEIV99,
  2016           DFHEIV99
  2017     MOVE EIBRESP  TO WS-RESPONSE
  2018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2019
  2020*    DISPLAY ' WEB SEND  ' WS-RESPONSE
  2021*    DISPLAY ' ABOUT TO RETURN '
  2022
  2023* exec cics
  2024*       return
  2025*    end-exec.
  2026*    MOVE '.(                    ''   #00001599' TO DFHEIV0
  2027     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2028     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2029     MOVE X'2020233030303031353939' TO DFHEIV0(25:11)
  2030     CALL 'kxdfhei1' USING DFHEIV0,
  2031           DFHEIV99,
  2032           DFHEIV99,
  2033           DFHEIV99,
  2034           DFHEIV99,
  2035           DFHEIV99,
  2036           DFHEIV99
  2037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2038
  2039******************************************************
  2040* Read all fields of the incoming form, moving
  2041* each to the corresponding field of the commarea
  2042* (business logic input fields).
  2043******************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  37
* NSRASLTR.cbl
  2044 read-form.
  2045     move spaces to w-form-name.
  2046     move length of w-form-name to w-form-name-len.
  2047           move spaces to w-form-value.
  2048     move length of w-form-value to w-form-value-len.
  2049
  2050* exec cics web readnext
  2051*                  formfield(w-form-name)
  2052*                  namelength(w-form-name-len)
  2053*                  value(w-form-value)
  2054*                  valuelength(w-form-value-len)
  2055*                  resp(w-resp)
  2056*    end-exec.
  2057*    MOVE 'X*FLVL                &  N#00001612' TO DFHEIV0
  2058     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  2059     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2060     MOVE X'204E233030303031363132' TO DFHEIV0(25:11)
  2061     CALL 'kxdfhei1' USING DFHEIV0,
  2062           w-form-name,
  2063           w-form-name-len,
  2064           w-form-value,
  2065           w-form-value-len,
  2066           DFHEIV99
  2067     MOVE EIBRESP  TO w-resp
  2068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2069
  2070     evaluate w-resp
  2071        when 0
  2072*   dfhresp(normal)
  2073           evaluate w-form-name(1:w-form-name-len)
  2074              when 'data_src'
  2075                 if w-form-value-len not = 0
  2076                    move w-form-value(1:w-form-value-len)
  2077                                 to IFF-DATA-SRCE
  2078                 else
  2079                                move spaces to IFF-DATA-SRCE
  2080                 end-if
  2081              when 'letter_id'
  2082                 if w-form-value-len not = 0
  2083                    move w-form-value(1:w-form-value-len)
  2084                                 to IFF-LETTER-ID
  2085                 else
  2086                                move spaces to IFF-LETTER-ID
  2087                 end-if
  2088              when 'carrier'
  2089                 if w-form-value-len not = 0
  2090                    move w-form-value(1:w-form-value-len)
  2091                             to IFF-CARRIER
  2092                 else
  2093                                move spaces to IFF-CARRIER
  2094                 end-if
  2095              when 'grouping'
  2096                             if w-form-value-len not = 0
  2097                    move w-form-value(1:w-form-value-len)
  2098                                                   to IFF-GROUP
  2099                 else
  2100                                move spaces  to IFF-GROUP
  2101                 end-if
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  38
* NSRASLTR.cbl
  2102              when 'state_cd'
  2103                             if w-form-value-len not = 0
  2104                    move w-form-value(1:w-form-value-len)
  2105                                 to IFF-STATE
  2106                 else
  2107                                move spaces  to IFF-STATE
  2108                 end-if
  2109              when 'acct_no'
  2110                             if w-form-value-len not = 0
  2111                    move w-form-value(1:w-form-value-len)
  2112                                 to IFF-ACCOUNT
  2113                 else
  2114                    move spaces  to IFF-ACCOUNT
  2115                 end-if
  2116              when 'eff_date'
  2117                             if w-form-value-len not = 0
  2118                    move w-form-value(1:w-form-value-len)
  2119                                 to IFF-EFF-DT
  2120                 else
  2121                                move spaces  to IFF-EFF-DT
  2122                 end-if
  2123              when 'cert_no'
  2124                             if w-form-value-len not = 0
  2125                    move w-form-value(1:w-form-value-len)
  2126                                 to IFF-CERT-NO
  2127                 else
  2128                                move spaces  to IFF-CERT-NO
  2129                 end-if
  2130              when 'batch_no'
  2131                             if w-form-value-len not = 0
  2132                    move w-form-value(1:w-form-value-len)
  2133                                 to IFF-BATCH-NO
  2134                 else
  2135                                move spaces  to IFF-BATCH-NO
  2136                 end-if
  2137              when 'batch_seq'
  2138                             if w-form-value-len not = 0
  2139                    move w-form-value(1:w-form-value-len)
  2140                                 to IFF-BATCH-SEQ
  2141                 else
  2142                                move zeros   to IFF-BATCH-SEQ
  2143                 end-if
  2144              when 'resp_no'
  2145                             if w-form-value-len not = 0
  2146                    move w-form-value(1:w-form-value-len)
  2147                                 to IFF-RESP-NO
  2148                 else
  2149                                move spaces  to IFF-RESP-NO
  2150                 end-if
  2151              when 'no_copies'
  2152                             if w-form-value-len not = 0
  2153                    move w-form-value(1:w-form-value-len)
  2154                                 to IFF-NO-OF-COPIES
  2155                 else
  2156                    move zeros   to IFF-NO-OF-COPIES
  2157                 end-if
  2158              when 'proc_id'
  2159                             if w-form-value-len not = 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  39
* NSRASLTR.cbl
  2160                    move w-form-value(1:w-form-value-len)
  2161                                 to IFF-PROC-ID
  2162                 else
  2163                    move 'JJVA'  to IFF-PROC-ID
  2164                 end-if
  2165              when 'comp_id'
  2166                             if w-form-value-len not = 0
  2167                    move w-form-value(1:w-form-value-len)
  2168                                 to IFF-COMP-ID
  2169                 else
  2170                    move 'CID'   to IFF-COMP-ID
  2171                 end-if
  2172              when 'prt_now'
  2173                             if w-form-value-len not = 0
  2174                    move w-form-value(1:w-form-value-len)
  2175                                 to IFF-PRINT-NOW-SW
  2176                 else
  2177                    move 'N'     to IFF-PRINT-NOW-SW
  2178                 end-if
  2179              when 'enc_cd'
  2180                             if w-form-value-len not = 0
  2181                    move w-form-value(1:w-form-value-len)
  2182                                 to IFF-ENC-CD
  2183                 else
  2184                    move '0'     to IFF-ENC-CD
  2185                 end-if
  2186              when 'resend_dt'
  2187                             if w-form-value-len not = 0
  2188                    move w-form-value(1:w-form-value-len)
  2189                                 to IFF-RESEND-DT
  2190                 else
  2191                    move SPACES  to IFF-RESEND-DT
  2192                 end-if
  2193              when 'follow_dt'
  2194                             if w-form-value-len not = 0
  2195                    move w-form-value(1:w-form-value-len)
  2196                                 to IFF-FOLLOW-UP-DT
  2197                 else
  2198                    move SPACES  to IFF-FOLLOW-UP-DT
  2199                 end-if
  2200              when 'arch_no'
  2201                             if w-form-value-len not = 0
  2202                    move w-form-value(1:w-form-value-len)
  2203                                 to IFF-ARCHIVE-NO
  2204                 else
  2205                    move ZEROS   to IFF-ARCHIVE-NO
  2206                 end-if
  2207              when 'pgm_func'
  2208                             if w-form-value-len not = 0
  2209                    move w-form-value(1:w-form-value-len)
  2210                                 to IFF-FUNC
  2211                 else
  2212                    move ZEROS   to IFF-FUNC
  2213                 end-if
  2214*             when 'ltr_comments'
  2215*                if w-form-value-len not = 0
  2216*                   move w-form-value(1:w-form-value-len)
  2217*                                to IFF-COMMENTS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:23 Page  40
* NSRASLTR.cbl
  2218*                else
  2219*                   move SPACES  to IFF-COMMENTS
  2220*                end-if
  2221              when 'end_arch'
  2222                 if w-form-value-len not = 0
  2223                    move w-form-value(1:w-form-value-len)
  2224                                 to IFF-ENDT-ARCH-NO
  2225                 else
  2226                    move ZEROS  to IFF-ENDT-ARCH-NO
  2227                 end-if
  2228           end-evaluate
  2229        when other
  2230           continue
  2231     end-evaluate.
  2232 read-form-exit.
  2233 9700-DATE-LINK.
  2234
  2235* EXEC CICS LINK
  2236*        PROGRAM   ('ELDATCV')
  2237*        COMMAREA  (DATE-CONVERSION-DATA)
  2238*        LENGTH    (DC-COMM-LENGTH)
  2239*    END-EXEC.
  2240     MOVE 'ELDATCV' TO DFHEIV1
  2241*    MOVE '."C                   (   #00001782' TO DFHEIV0
  2242     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2244     MOVE X'2020233030303031373832' TO DFHEIV0(25:11)
  2245     CALL 'kxdfhei1' USING DFHEIV0,
  2246           DFHEIV1,
  2247           DATE-CONVERSION-DATA,
  2248           DC-COMM-LENGTH,
  2249           DFHEIV99,
  2250           DFHEIV99,
  2251           DFHEIV99,
  2252           DFHEIV99
  2253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2254
  2255 9700-EXIT.
  2256      EXIT.
  2257
  2258 9999-DFHBACK SECTION.
  2259     MOVE '9%                    "   ' TO DFHEIV0
  2260     MOVE 'NSRASLTR' TO DFHEIV1
  2261     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2262     GOBACK.
  2263 9999-DFHEXIT.
  2264     IF DFHEIGDJ EQUAL 0001
  2265         NEXT SENTENCE.
  2266     MOVE '9%                    "   ' TO DFHEIV0
  2267     MOVE 'NSRASLTR' TO DFHEIV1
  2268     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2269     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15284     Code:        6951
